<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>OpenTracing API | APM Go Agent Reference [2.x] | Elastic</title>
<meta class="elastic" name="content" content="OpenTracing API | APM Go Agent Reference [2.x]">

<link rel="home" href="index.html" title="APM Go Agent Reference [2.x]"/>
<link rel="up" href="index.html" title="APM Go Agent Reference [2.x]"/>
<link rel="prev" href="opentelemetry.html" title="OpenTelemetry API"/>
<link rel="next" href="contributing.html" title="Contributing"/>
<meta class="elastic" name="product_version" content="2.x"/>
<meta class="elastic" name="product_name" content="APM"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/APM Go Agent/Reference/2.x"/>
<meta name="DC.subject" content="APM"/>
<meta name="DC.identifier" content="2.x"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="icon" href="/favicon.ico" sizes="32x32"/>
    <link rel="icon" href="/favicon.svg" type="image/svg+xml"/>
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" sizes="180x180"/>
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles-v1.css" />
  </head>

  <!--© 2015-2025 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div class="navheader">
<span class="prev">
<a href="opentelemetry.html">« OpenTelemetry API</a>
</span>
<span class="next">
<a href="contributing.html">Contributing »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link">
  <div id="related-products" class="dropdown">
  <div class="related-products-title">APM:</div>
  <div class="dropdown-anchor" tabindex="0">Go Agent Reference<span class="dropdown-icon"></span></div>
  <div class="dropdown-content">
  <ul>
  <li class="dropdown-category">APM</li>
  <ul>
  <li><a href="/guide/en/observability/current/apm.html">Observability › APM</a></li>
  </ul>
  <li class="dropdown-category">APM agents</li>
  <ul>
  <li><a href="/guide/en/apm/agent/android/current/intro.html">Android Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/go/current/introduction.html">Go Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/swift/current/intro.html">iOS Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/java/current/intro.html">Java Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/dotnet/current/intro.html">.NET Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/nodejs/current/intro.html">Node.js Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/php/current/intro.html">PHP Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/python/current/getting-started.html">Python Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/ruby/current/introduction.html">Ruby Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/rum-js/current/intro.html">Real User Monitoring JavaScript Agent Reference</a></li>
  </ul>
  <li class="dropdown-category">APM extensions</li>
  <ul>
  <li><a href="/guide/en/apm/lambda/current/aws-lambda-arch.html">AWS Lambda extension</a></li>
  <li><a href="/guide/en/apm/attacher/current/apm-attacher.html">Attacher</a></li>
  </ul>
  </ul>
  </div>
  </div>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>OpenTracing API</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/do-not-delete_legacy-docs/docs/opentracing.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div id="url-to-v3" class="version-warning">
    <strong>IMPORTANT</strong>: This documentation is no longer updated. Refer to <a href="https://www.elastic.co/support/eol">Elastic's version policy</a> and the <a href="https://www.elastic.co/docs/reference/apm/agents/go/opentracing-api">latest documentation</a>.
</div>
<div class="chapter">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="opentracing"></a>OpenTracing API</h2><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/do-not-delete_legacy-docs/docs/opentracing.asciidoc">edit</a></div>
</div></div></div>
<p>The Elastic APM Go agent provides an implementation of the <a href="https://opentracing.io" class="ulink" target="_top">OpenTracing API</a>,
building on top of the core Elastic APM API.</p>
<p>Spans created through the OpenTracing API will be translated to Elastic APM transactions or spans.
Root spans, and spans created with a remote span context, will be translated to Elastic APM
transactions. All others will be created as Elastic APM spans.</p>
<div class="position-relative"><h3><a id="opentracing-init"></a>Initializing the tracer</h3><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/do-not-delete_legacy-docs/docs/opentracing.asciidoc">edit</a></div>
<p>The OpenTracing API implementation is implemented as a bridge on top of the core Elastic APM API.
To initialize the OpenTracing tracer implementation, you must first import the <code class="literal">apmot</code> package:</p>
<div class="pre_wrapper lang-go">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-go">import (
	"go.elastic.co/apm/module/apmot/v2"
)</pre>
</div>
<p>The apmot package exports a function, "New", which returns an implementation of the
<code class="literal">opentracing.Tracer</code> interface. If you call <code class="literal">apmot.New()</code> without any arguments,
the returned tracer will wrap <code class="literal">apm.DefaultTracer()</code>. If you wish to use a different
<code class="literal">apm.Tracer</code>, then you can pass it with <code class="literal">apmot.New(apmot.WithTracer(t))</code>.</p>
<div class="pre_wrapper lang-go">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-go">otTracer := apmot.New()</pre>
</div>
<p>Once you have obtained an <code class="literal">opentracing.Tracer</code>, use the standard OpenTracing API
to report spans to Elastic APM. Please refer to <a href="https://github.com/opentracing/opentracing-go" class="ulink" target="_top">opentracing-go</a>
for documentation on the OpenTracing Go API.</p>
<div class="pre_wrapper lang-go">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-go">import (
	"context"

	"go.elastic.co/apm/module/apmot/v2"

	"github.com/opentracing/opentracing-go"
)

func main() {
	opentracing.SetGlobalTracer(apmot.New())

	parent, ctx := opentracing.StartSpanFromContext(context.Background(), "parent")
	child, _ := opentracing.StartSpanFromContext(ctx, "child")
	child.Finish()
	parent.Finish()
}</pre>
</div>
<div class="position-relative"><h3><a id="opentracing-mixed"></a>Mixing Native and OpenTracing APIs</h3><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/do-not-delete_legacy-docs/docs/opentracing.asciidoc">edit</a></div>
<p>When you import <code class="literal">apmot</code>, transactions and spans created with the <a class="xref" href="api.html" title="API Documentation">native API</a>
will be made available as OpenTracing spans, enabling you to mix the use of the
native and OpenTracing APIs. e.g.:</p>
<div class="pre_wrapper lang-go">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-go">// Transaction created through native API.
transaction := apm.DefaultTracer().StartTransaction("GET /", "request")
ctx := apm.ContextWithTransaction(context.Background(), transaction)

// Span created through OpenTracing API will be a child of the transaction.
otSpan, ctx := opentracing.StartSpanFromContext(ctx, "ot-span")

// Span created through the native API will be a child of the span created
// above via the OpenTracing API.
apmSpan, ctx := apm.StartSpan(ctx, "apm-span", "apm-span")</pre>
</div>
<p>The <code class="literal">opentracing.SpanFromContext</code> function will return an <code class="literal">opentracing.Span</code>
that wraps either an <code class="literal">apm.Span</code> or <code class="literal">apm.Transaction</code>. These span objects are
intended only for passing in context when creating a new span through the
OpenTracing API, and are not fully functional spans. In particular, the <code class="literal">Finish</code>
and <code class="literal">Log*</code> methods are no-ops, and the <code class="literal">Tracer</code> method returns a no-op tracer.</p>
<div class="position-relative"><h3><a id="opentracing-apm-tags"></a>Elastic APM specific tags</h3><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/do-not-delete_legacy-docs/docs/opentracing.asciidoc">edit</a></div>
<p>Elastic APM defines some tags which are not included in the OpenTracing API,
but are relevant in the context of Elastic APM. Some tags are relevant only
to Elastic APM transactions.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">type</code> - sets the type of the transaction or span, e.g. "request", or "ext.http".
If <code class="literal">type</code> is not specified, then the type may be inferred from other
tags. e.g. if "http.url" is specified, then the type will be "request"
for transactions, and "ext.http" for spans. If no type can be inferred,
it is set to "unknown".
</li>
</ul>
</div>
<p>The following tags are relevant only to root or service-entry spans, which are
translated to Elastic APM transactions:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">user.id</code> - sets the user ID, which appears in the "User" tab in the transaction details in the Elastic APM app
</li>
<li class="listitem">
<code class="literal">user.email</code> - sets the user email, which appears in the "User" tab in the transaction details in the Elastic APM app
</li>
<li class="listitem">
<code class="literal">user.username</code> - sets the user name, which appears in the "User" tab in the transaction details in the Elastic APM app
</li>
<li class="listitem">
<code class="literal">result</code> - sets the result of the transaction. If <code class="literal">result</code> is <em>not</em> specified, but <code class="literal">error</code> tag is set to <code class="literal">true</code>,
then the transaction result will be set to "error"
</li>
</ul>
</div>
<div class="position-relative"><h3><a id="opentracing-logs"></a>Span Logs</h3><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/do-not-delete_legacy-docs/docs/opentracing.asciidoc">edit</a></div>
<p>The <code class="literal">Span.LogKV</code> and <code class="literal">Span.LogFields</code> methods will send error events to Elastic APM for logs
with the "event" field set to "error".</p>
<p>The deprecated log methods <code class="literal">Span.Log</code>, <code class="literal">Span.LogEvent</code>, and <code class="literal">Span.LogEventWithPayload</code> are no-ops.</p>
<div class="position-relative"><h3><a id="opentracing-caveats"></a>Caveats</h3><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/do-not-delete_legacy-docs/docs/opentracing.asciidoc">edit</a></div>
<div class="position-relative"><h4><a id="opentracing-caveats-propagation"></a>Context Propagation</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/do-not-delete_legacy-docs/docs/opentracing.asciidoc">edit</a></div>
<p>We support the <code class="literal">TextMap</code> and <code class="literal">HTTPHeaders</code> propagation formats; <code class="literal">Binary</code> is not currently supported.</p>
<div class="position-relative"><h4><a id="opentracing-caveats-spanrefs"></a>Span References</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/do-not-delete_legacy-docs/docs/opentracing.asciidoc">edit</a></div>
<p>We support only <code class="literal">ChildOf</code> references. Other references, e.g. <code class="literal">FollowsFrom</code>, are not currently supported.</p>
<div class="position-relative"><h4><a id="opentracing-caveats-baggage"></a>Baggage</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/do-not-delete_legacy-docs/docs/opentracing.asciidoc">edit</a></div>
<p><code class="literal">Span.SetBaggageItem</code> is a no-op; baggage items are silently dropped.</p>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="opentelemetry.html">« OpenTelemetry API</a>
</span>
<span class="next">
<a href="contributing.html">Contributing »</a>
</span>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>

                        <!-- Feedback widget -->
                        <div id="feedbackWidgetContainer"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


        <div id='elastic-footer'></div>
        <script src='https://www.elastic.co/elastic-footer.js'></script>
        <!-- Footer Section end-->

      </section>
    </div>

    <!-- Feedback modal -->
    <div id="feedbackModalContainer"></div>

    <script src="/guide/static/jquery.js"></script>
    <script type="text/javascript" src="/guide/static/docs-v1.js"></script>
    <script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
