<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Core configuration options | APM Java Agent Reference [1.x] | Elastic</title>
<meta class="elastic" name="content" content="Core configuration options | APM Java Agent Reference [1.x]">

<link rel="home" href="index.html" title="APM Java Agent Reference [1.x]"/>
<link rel="up" href="configuration.html" title="Configuration"/>
<link rel="prev" href="config-circuit-breaker.html" title="Circuit-Breaker configuration options"/>
<link rel="next" href="config-datastore.html" title="Datastore configuration options"/>
<meta class="elastic" name="product_version" content="1.x"/>
<meta class="elastic" name="product_name" content="APM"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/APM Java Agent/Reference/1.x"/>
<meta name="DC.subject" content="APM"/>
<meta name="DC.identifier" content="1.x"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles-v1.css" />
  </head>

  <!--© 2015-2025 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div class="navheader">
<span class="prev">
<a href="config-circuit-breaker.html">« Circuit-Breaker configuration options</a>
</span>
<span class="next">
<a href="config-datastore.html">Datastore configuration options »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link">
  <div id="related-products" class="dropdown">
  <div class="related-products-title">APM:</div>
  <div class="dropdown-anchor" tabindex="0">Java Agent Reference<span class="dropdown-icon"></span></div>
  <div class="dropdown-content">
  <ul>
  <li class="dropdown-category">APM</li>
  <ul>
  <li><a href="/guide/en/observability/current/apm.html">Observability › APM</a></li>
  </ul>
  <li class="dropdown-category">APM agents</li>
  <ul>
  <li><a href="/guide/en/apm/agent/android/current/intro.html">Android Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/go/current/introduction.html">Go Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/swift/current/intro.html">iOS Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/java/current/intro.html">Java Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/dotnet/current/intro.html">.NET Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/nodejs/current/intro.html">Node.js Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/php/current/intro.html">PHP Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/python/current/getting-started.html">Python Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/ruby/current/introduction.html">Ruby Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/rum-js/current/intro.html">Real User Monitoring JavaScript Agent Reference</a></li>
  </ul>
  <li class="dropdown-category">APM extensions</li>
  <ul>
  <li><a href="/guide/en/apm/lambda/current/aws-lambda-arch.html">AWS Lambda extension</a></li>
  <li><a href="/guide/en/apm/attacher/current/apm-attacher.html">Attacher</a></li>
  </ul>
  </ul>
  </div>
  </div>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="configuration.html">Configuration</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Core configuration options</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/1.x/docs/configuration.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="config-core"></a>Core configuration options<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/1.x/docs/configuration.asciidoc">edit</a></h2>
</div></div></div>

<h4><a id="config-recording"></a><code class="literal">recording</code> (<span class="Admonishment Admonishment--change">
[<span class="Admonishment-version u-mono">1.15.0</span>]
<span class="Admonishment-detail">
Added in 1.15.0.
</span>
</span>)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/1.x/docs/configuration.asciidoc">edit</a></h4>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This option was available in older versions through the <code class="literal">active</code> key. The old key is still
supported in newer versions, but it is now deprecated.</p>
</div>
</div>
<p>A boolean specifying if the agent should be recording or not.
When recording, the agent instruments incoming HTTP requests, tracks errors and collects and sends metrics.
When not recording, the agent works as a noop, not collecting data and not communicating with the APM sever,
except for polling the central configuration endpoint.
Note that trace context propagation, baggage and log correlation will also be disabled when recording is disabled.
As this is a reversible switch, agent threads are not being killed when inactivated, but they will be
mostly idle in this state, so the overhead should be negligible.</p>
<p>You can use this setting to dynamically disable Elastic APM at runtime.</p>
<p><a class="xref" href="configuration.html#configuration-dynamic" title="Dynamic configuration"><span class="image"><img src="./images/dynamic-config.svg" alt="dynamic config"></span> </a></p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Dynamic</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">true</code></p></td>
<td align="left" valign="top"><p>Boolean</p></td>
<td align="left" valign="top"><p>true</p></td>
</tr>
</tbody>
</table>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Java System Properties</th>
<th align="left" valign="top">Property file</th>
<th align="left" valign="top">Environment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">elastic.apm.recording</code></p></td>
<td align="left" valign="top"><p><code class="literal">recording</code></p></td>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_RECORDING</code></p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="config-enabled"></a><code class="literal">enabled</code> (<span class="Admonishment Admonishment--change">
[<span class="Admonishment-version u-mono">1.18.0</span>]
<span class="Admonishment-detail">
Added in 1.18.0.
</span>
</span>)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/1.x/docs/configuration.asciidoc">edit</a></h4>
<p>Setting to false will completely disable the agent, including instrumentation and remote config polling.
If you want to dynamically change the status of the agent, use <a class="xref" href="config-core.html#config-recording" title="recording ()"><code class="literal">recording</code></a> instead.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Dynamic</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">true</code></p></td>
<td align="left" valign="top"><p>Boolean</p></td>
<td align="left" valign="top"><p>false</p></td>
</tr>
</tbody>
</table>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Java System Properties</th>
<th align="left" valign="top">Property file</th>
<th align="left" valign="top">Environment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">elastic.apm.enabled</code></p></td>
<td align="left" valign="top"><p><code class="literal">enabled</code></p></td>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_ENABLED</code></p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="config-instrument"></a><code class="literal">instrument</code> (<span class="Admonishment Admonishment--change">
[<span class="Admonishment-version u-mono">1.0.0</span>]
<span class="Admonishment-detail">
Added in 1.0.0. Changing this value at runtime is possible since version 1.15.0
</span>
</span>)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/1.x/docs/configuration.asciidoc">edit</a></h4>
<p>A boolean specifying if the agent should instrument the application to collect traces for the app.
 When set to <code class="literal">false</code>, most built-in instrumentation plugins are disabled, which would minimize the effect on
your application. However, the agent would still apply instrumentation related to manual tracing options and it
would still collect and send metrics to APM Server.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Both active and instrument needs to be true for instrumentation to be running.</p>
</div>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Changing this value at runtime can slow down the application temporarily.</p>
</div>
</div>
<p><a class="xref" href="configuration.html#configuration-dynamic" title="Dynamic configuration"><span class="image"><img src="./images/dynamic-config.svg" alt="dynamic config"></span> </a></p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Dynamic</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">true</code></p></td>
<td align="left" valign="top"><p>Boolean</p></td>
<td align="left" valign="top"><p>true</p></td>
</tr>
</tbody>
</table>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Java System Properties</th>
<th align="left" valign="top">Property file</th>
<th align="left" valign="top">Environment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">elastic.apm.instrument</code></p></td>
<td align="left" valign="top"><p><code class="literal">instrument</code></p></td>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_INSTRUMENT</code></p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="config-service-name"></a><code class="literal">service_name</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/1.x/docs/configuration.asciidoc">edit</a></h4>
<p>This is used to keep all the errors and transactions of your service together
and is the primary filter in the Elastic APM user interface.</p>
<p>Instead of configuring the service name manually,
you can also choose to rely on the service name auto-detection mechanisms of the agent.
If <code class="literal">service_name</code> is set explicitly, all auto-detection mechanisms are disabled.</p>
<p>This is how the service name auto-detection works:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>For standalone applications</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
The agent uses <code class="literal">Implementation-Title</code> in the <code class="literal">META-INF/MANIFEST.MF</code> file if the application is started via <code class="literal">java -jar</code>.
</li>
<li class="listitem">
Falls back to the name of the main class or jar file.
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>For applications that are deployed to a servlet container/application server, the agent auto-detects the name for each application.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For Spring-based applications, the agent uses the <code class="literal">spring.application.name</code> property, if set.
</li>
<li class="listitem">
For servlet-based applications, falls back to the <code class="literal">Implementation-Title</code> in the <code class="literal">META-INF/MANIFEST.MF</code> file.
</li>
<li class="listitem">
Falls back to the <code class="literal">display-name</code> of the <code class="literal">web.xml</code>, if available.
</li>
<li class="listitem">
Falls back to the servlet context path the application is mapped to (unless mapped to the root context).
</li>
</ul>
</div>
</li>
</ul>
</div>
<p>Generally, it is recommended to rely on the service name detection based on <code class="literal">META-INF/MANIFEST.MF</code>.
Spring Boot automatically adds the relevant manifest entries.
For other applications that are built with Maven, this is how you add the manifest entries:</p>
<p><strong>pom.xml.</strong></p>
<div class="pre_wrapper lang-xml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-xml">    &lt;build&gt;
        &lt;plugins&gt;
            &lt;plugin&gt;
                &lt;!-- replace with 'maven-war-plugin' if you're building a war --&gt;
                &lt;artifactId&gt;maven-jar-plugin&lt;/artifactId&gt;
                &lt;configuration&gt;
                    &lt;archive&gt;
                        &lt;!-- Adds
                        Implementation-Title based on ${project.name} and
                        Implementation-Version based on ${project.version}
                        --&gt;
                        &lt;manifest&gt;
                            &lt;addDefaultImplementationEntries&gt;true&lt;/addDefaultImplementationEntries&gt;
                        &lt;/manifest&gt;
                        &lt;!-- To customize the Implementation-* entries, remove addDefaultImplementationEntries and add them manually
                        &lt;manifestEntries&gt;
                            &lt;Implementation-Title&gt;foo&lt;/Implementation-Title&gt;
                            &lt;Implementation-Version&gt;4.2.0&lt;/Implementation-Version&gt;
                        &lt;/manifestEntries&gt;
                        --&gt;
                    &lt;/archive&gt;
                &lt;/configuration&gt;
            &lt;/plugin&gt;
        &lt;/plugins&gt;
    &lt;/build&gt;</pre>
</div>
<p>The service name must conform to this regular expression: <code class="literal">^[a-zA-Z0-9 _-]+$</code>.
In less regexy terms:
Your service name must only contain characters from the ASCII alphabet, numbers, dashes, underscores and spaces.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Service name auto discovery mechanisms require APM Server 7.0+.</p>
</div>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Dynamic</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>Auto-detected based on the rules described above</p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>false</p></td>
</tr>
</tbody>
</table>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Java System Properties</th>
<th align="left" valign="top">Property file</th>
<th align="left" valign="top">Environment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">elastic.apm.service_name</code></p></td>
<td align="left" valign="top"><p><code class="literal">service_name</code></p></td>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_SERVICE_NAME</code></p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="config-service-node-name"></a><code class="literal">service_node_name</code> (<span class="Admonishment Admonishment--change">
[<span class="Admonishment-version u-mono">1.11.0</span>]
<span class="Admonishment-detail">
Added in 1.11.0.
</span>
</span>)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/1.x/docs/configuration.asciidoc">edit</a></h4>
<p>If set, this name is used to distinguish between different nodes of a service,
therefore it should be unique for each JVM within a service.
If not set, data aggregations will be done based on a container ID (where valid) or on the reported
hostname (automatically discovered or manually configured through <a class="xref" href="config-core.html#config-hostname" title="hostname ()"><code class="literal">hostname</code></a>).</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>JVM metrics views rely on aggregations that are based on the service node name.
If you have multiple JVMs installed on the same host reporting data for the same service name,
you must set a unique node name for each in order to view metrics at the JVM level.</p>
</div>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Metrics views can utilize this configuration since APM Server 7.5</p>
</div>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Dynamic</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">&lt;none&gt;</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>false</p></td>
</tr>
</tbody>
</table>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Java System Properties</th>
<th align="left" valign="top">Property file</th>
<th align="left" valign="top">Environment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">elastic.apm.service_node_name</code></p></td>
<td align="left" valign="top"><p><code class="literal">service_node_name</code></p></td>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_SERVICE_NODE_NAME</code></p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="config-service-version"></a><code class="literal">service_version</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/1.x/docs/configuration.asciidoc">edit</a></h4>
<p>A version string for the currently deployed version of the service. If you don’t version your deployments, the recommended value for this field is the commit identifier of the deployed revision, e.g. the output of git rev-parse HEAD.</p>
<p>Similar to the auto-detection of <a class="xref" href="config-core.html#config-service-name" title="service_name"><code class="literal">service_name</code></a>, the agent can auto-detect the service version based on the <code class="literal">Implementation-Title</code> attribute in <code class="literal">META-INF/MANIFEST.MF</code>.
See <a class="xref" href="config-core.html#config-service-name" title="service_name"><code class="literal">service_name</code></a> on how to set this attribute.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Dynamic</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">&lt;none&gt;</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>false</p></td>
</tr>
</tbody>
</table>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Java System Properties</th>
<th align="left" valign="top">Property file</th>
<th align="left" valign="top">Environment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">elastic.apm.service_version</code></p></td>
<td align="left" valign="top"><p><code class="literal">service_version</code></p></td>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_SERVICE_VERSION</code></p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="config-hostname"></a><code class="literal">hostname</code> (<span class="Admonishment Admonishment--change">
[<span class="Admonishment-version u-mono">1.10.0</span>]
<span class="Admonishment-detail">
Added in 1.10.0.
</span>
</span>)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/1.x/docs/configuration.asciidoc">edit</a></h4>
<p>Allows for the reported hostname to be manually specified. If unset the hostname will be looked up.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Dynamic</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">&lt;none&gt;</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>false</p></td>
</tr>
</tbody>
</table>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Java System Properties</th>
<th align="left" valign="top">Property file</th>
<th align="left" valign="top">Environment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">elastic.apm.hostname</code></p></td>
<td align="left" valign="top"><p><code class="literal">hostname</code></p></td>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_HOSTNAME</code></p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="config-environment"></a><code class="literal">environment</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/1.x/docs/configuration.asciidoc">edit</a></h4>
<p>The name of the environment this service is deployed in, e.g. "production" or "staging".</p>
<p>Environments allow you to easily filter data on a global level in the APM app.
It&#8217;s important to be consistent when naming environments across agents.
See <a href="/guide/en/kibana/8.15/filters.html#environment-selector" class="ulink" target="_top">environment selector</a> in the APM app for more information.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This feature is fully supported in the APM app in Kibana versions &gt;= 7.2.
You must use the query bar to filter for a specific environment in versions prior to 7.2.</p>
</div>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Dynamic</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">&lt;none&gt;</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>false</p></td>
</tr>
</tbody>
</table>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Java System Properties</th>
<th align="left" valign="top">Property file</th>
<th align="left" valign="top">Environment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">elastic.apm.environment</code></p></td>
<td align="left" valign="top"><p><code class="literal">environment</code></p></td>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_ENVIRONMENT</code></p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="config-transaction-sample-rate"></a><code class="literal">transaction_sample_rate</code> (performance)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/1.x/docs/configuration.asciidoc">edit</a></h4>
<p>By default, the agent will sample every transaction (e.g. request to your service). To reduce overhead and storage requirements, you can set the sample rate to a value between 0.0 and 1.0. (For pre-8.0 servers the agent still records and sends overall time and the result for unsampled transactions, but no context information, labels, or spans. When connecting to 8.0+ servers, the unsampled requests are not sent at all).</p>
<p>Value will be rounded with 4 significant digits, as an example, value <em>0.55555</em> will be rounded to <code class="literal">0.5556</code></p>
<p><a class="xref" href="configuration.html#configuration-dynamic" title="Dynamic configuration"><span class="image"><img src="./images/dynamic-config.svg" alt="dynamic config"></span> </a></p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Dynamic</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">1</code></p></td>
<td align="left" valign="top"><p>Double</p></td>
<td align="left" valign="top"><p>true</p></td>
</tr>
</tbody>
</table>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Java System Properties</th>
<th align="left" valign="top">Property file</th>
<th align="left" valign="top">Environment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">elastic.apm.transaction_sample_rate</code></p></td>
<td align="left" valign="top"><p><code class="literal">transaction_sample_rate</code></p></td>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_TRANSACTION_SAMPLE_RATE</code></p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="config-transaction-max-spans"></a><code class="literal">transaction_max_spans</code> (performance)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/1.x/docs/configuration.asciidoc">edit</a></h4>
<p>Limits the amount of spans that are recorded per transaction.</p>
<p>This is helpful in cases where a transaction creates a very high amount of spans (e.g. thousands of SQL queries).</p>
<p>Setting an upper limit will prevent overloading the agent and the APM server with too much work for such edge cases.</p>
<p>A message will be logged when the max number of spans has been exceeded but only at a rate of once every 5 minutes to ensure performance is not impacted.</p>
<p><a class="xref" href="configuration.html#configuration-dynamic" title="Dynamic configuration"><span class="image"><img src="./images/dynamic-config.svg" alt="dynamic config"></span> </a></p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Dynamic</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">500</code></p></td>
<td align="left" valign="top"><p>Integer</p></td>
<td align="left" valign="top"><p>true</p></td>
</tr>
</tbody>
</table>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Java System Properties</th>
<th align="left" valign="top">Property file</th>
<th align="left" valign="top">Environment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">elastic.apm.transaction_max_spans</code></p></td>
<td align="left" valign="top"><p><code class="literal">transaction_max_spans</code></p></td>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_TRANSACTION_MAX_SPANS</code></p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="config-long-field-max-length"></a><code class="literal">long_field_max_length</code> (performance <span class="Admonishment Admonishment--change">
[<span class="Admonishment-version u-mono">1.37.0</span>]
<span class="Admonishment-detail">
Added in 1.37.0.
</span>
</span>)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/1.x/docs/configuration.asciidoc">edit</a></h4>
<p>The following transaction, span, and error fields will be truncated at this number of unicode characters before being sent to APM server:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">transaction.context.request.body</code>, <code class="literal">error.context.request.body</code>
</li>
<li class="listitem">
<code class="literal">transaction.context.message.body</code>, <code class="literal">error.context.message.body</code>
</li>
<li class="listitem">
<code class="literal">span.context.db.statement</code>
</li>
</ul>
</div>
<p>Note that tracing data is limited at the upstream APM server to
<a href="/guide/en/apm/guide/8.15/configuration-process.html#max_event_size" class="ulink" target="_top"><code class="literal">max_event_size</code></a>,
which defaults to 300kB. If you configure <code class="literal">long_field_max_length</code> too large, it
could result in transactions, spans, or errors that are rejected by APM server.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Dynamic</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">10000</code></p></td>
<td align="left" valign="top"><p>Integer</p></td>
<td align="left" valign="top"><p>false</p></td>
</tr>
</tbody>
</table>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Java System Properties</th>
<th align="left" valign="top">Property file</th>
<th align="left" valign="top">Environment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">elastic.apm.long_field_max_length</code></p></td>
<td align="left" valign="top"><p><code class="literal">long_field_max_length</code></p></td>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_LONG_FIELD_MAX_LENGTH</code></p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="config-sanitize-field-names"></a><code class="literal">sanitize_field_names</code> (security)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/1.x/docs/configuration.asciidoc">edit</a></h4>
<p>Sometimes it is necessary to sanitize the data sent to Elastic APM,
e.g. remove sensitive data.</p>
<p>Configure a list of wildcard patterns of field names which should be sanitized.
These apply for example to HTTP headers and <code class="literal">application/x-www-form-urlencoded</code> data.</p>
<p>This option supports the wildcard <code class="literal">*</code>, which matches zero or more characters.
Examples: <code class="literal">/foo/*/bar/*/baz*</code>, <code class="literal">*foo*</code>.
Matching is case insensitive by default.
Prepending an element with <code class="literal">(?-i)</code> makes the matching case sensitive.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Data in the query string is considered non-sensitive,
as sensitive information should not be sent in the query string.
See <a href="https://www.owasp.org/index.php/Information_exposure_through_query_strings_in_url" class="ulink" target="_top">https://www.owasp.org/index.php/Information_exposure_through_query_strings_in_url</a> for more information</p>
</div>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Review the data captured by Elastic APM carefully to make sure it does not capture sensitive information.
If you do find sensitive data in the Elasticsearch index,
you should add an additional entry to this list (make sure to also include the default entries).</p>
</div>
</div>
<p><a class="xref" href="configuration.html#configuration-dynamic" title="Dynamic configuration"><span class="image"><img src="./images/dynamic-config.svg" alt="dynamic config"></span> </a></p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Dynamic</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">password, passwd, pwd, secret, *key, *token*, *session*, *credit*, *card*, *auth*, *principal*, set-cookie</code></p></td>
<td align="left" valign="top"><p>List</p></td>
<td align="left" valign="top"><p>true</p></td>
</tr>
</tbody>
</table>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Java System Properties</th>
<th align="left" valign="top">Property file</th>
<th align="left" valign="top">Environment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">elastic.apm.sanitize_field_names</code></p></td>
<td align="left" valign="top"><p><code class="literal">sanitize_field_names</code></p></td>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_SANITIZE_FIELD_NAMES</code></p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="config-enable-instrumentations"></a><code class="literal">enable_instrumentations</code> (<span class="Admonishment Admonishment--change">
[<span class="Admonishment-version u-mono">1.28.0</span>]
<span class="Admonishment-detail">
Added in 1.28.0.
</span>
</span>)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/1.x/docs/configuration.asciidoc">edit</a></h4>
<p>A list of instrumentations which should be selectively enabled.
Valid options are <code class="literal">annotations</code>, <code class="literal">annotations-capture-span</code>, <code class="literal">annotations-capture-transaction</code>, <code class="literal">annotations-traced</code>, <code class="literal">apache-commons-exec</code>, <code class="literal">apache-httpclient</code>, <code class="literal">asynchttpclient</code>, <code class="literal">aws-lambda</code>, <code class="literal">aws-sdk</code>, <code class="literal">cassandra</code>, <code class="literal">concurrent</code>, <code class="literal">dubbo</code>, <code class="literal">elasticsearch-restclient</code>, <code class="literal">exception-handler</code>, <code class="literal">executor</code>, <code class="literal">executor-collection</code>, <code class="literal">experimental</code>, <code class="literal">finagle-httpclient</code>, <code class="literal">fork-join</code>, <code class="literal">grails</code>, <code class="literal">grpc</code>, <code class="literal">hibernate-search</code>, <code class="literal">http-client</code>, <code class="literal">jakarta-websocket</code>, <code class="literal">java-ldap</code>, <code class="literal">javalin</code>, <code class="literal">javax-websocket</code>, <code class="literal">jax-rs</code>, <code class="literal">jax-ws</code>, <code class="literal">jdbc</code>, <code class="literal">jdk-httpclient</code>, <code class="literal">jdk-httpserver</code>, <code class="literal">jedis</code>, <code class="literal">jms</code>, <code class="literal">jsf</code>, <code class="literal">kafka</code>, <code class="literal">lettuce</code>, <code class="literal">log-correlation</code>, <code class="literal">log-error</code>, <code class="literal">log-reformatting</code>, <code class="literal">logging</code>, <code class="literal">micrometer</code>, <code class="literal">mongodb</code>, <code class="literal">mongodb-client</code>, <code class="literal">okhttp</code>, <code class="literal">opentelemetry</code>, <code class="literal">opentelemetry-annotations</code>, <code class="literal">opentelemetry-metrics</code>, <code class="literal">opentracing</code>, <code class="literal">process</code>, <code class="literal">public-api</code>, <code class="literal">quartz</code>, <code class="literal">rabbitmq</code>, <code class="literal">reactor</code>, <code class="literal">redis</code>, <code class="literal">redisson</code>, <code class="literal">render</code>, <code class="literal">scala-future</code>, <code class="literal">scheduled</code>, <code class="literal">servlet-api</code>, <code class="literal">servlet-api-async</code>, <code class="literal">servlet-api-dispatch</code>, <code class="literal">servlet-input-stream</code>, <code class="literal">servlet-service-name</code>, <code class="literal">servlet-version</code>, <code class="literal">sparkjava</code>, <code class="literal">spring-amqp</code>, <code class="literal">spring-mvc</code>, <code class="literal">spring-resttemplate</code>, <code class="literal">spring-service-name</code>, <code class="literal">spring-view-render</code>, <code class="literal">spring-webclient</code>, <code class="literal">spring-webflux</code>, <code class="literal">ssl-context</code>, <code class="literal">struts</code>, <code class="literal">timer-task</code>, <code class="literal">urlconnection</code>, <code class="literal">vertx</code>, <code class="literal">vertx-web</code>, <code class="literal">vertx-webclient</code>, <code class="literal">websocket</code>.
When set to non-empty value, only listed instrumentations will be enabled if they are not disabled through <a class="xref" href="config-core.html#config-disable-instrumentations" title="disable_instrumentations ()"><code class="literal">disable_instrumentations</code> (<span class="Admonishment Admonishment--change">
[<span class="Admonishment-version u-mono">1.0.0</span>]
<span class="Admonishment-detail">
Added in 1.0.0. Changing this value at runtime is possible since version 1.15.0
</span>
</span>)</a> or <a class="xref" href="config-core.html#config-enable-experimental-instrumentations" title="enable_experimental_instrumentations ()"><code class="literal">enable_experimental_instrumentations</code> (<span class="Admonishment Admonishment--change">
[<span class="Admonishment-version u-mono">1.25.0</span>]
<span class="Admonishment-detail">
Added in 1.25.0.
</span>
</span>)</a>.
When not set or empty (default), all instrumentations enabled by default will be enabled unless they are disabled through <a class="xref" href="config-core.html#config-disable-instrumentations" title="disable_instrumentations ()"><code class="literal">disable_instrumentations</code> (<span class="Admonishment Admonishment--change">
[<span class="Admonishment-version u-mono">1.0.0</span>]
<span class="Admonishment-detail">
Added in 1.0.0. Changing this value at runtime is possible since version 1.15.0
</span>
</span>)</a> or <a class="xref" href="config-core.html#config-enable-experimental-instrumentations" title="enable_experimental_instrumentations ()"><code class="literal">enable_experimental_instrumentations</code> (<span class="Admonishment Admonishment--change">
[<span class="Admonishment-version u-mono">1.25.0</span>]
<span class="Admonishment-detail">
Added in 1.25.0.
</span>
</span>)</a>.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Changing this value at runtime can slow down the application temporarily.</p>
</div>
</div>
<p><a class="xref" href="configuration.html#configuration-dynamic" title="Dynamic configuration"><span class="image"><img src="./images/dynamic-config.svg" alt="dynamic config"></span> </a></p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Dynamic</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">&lt;none&gt;</code></p></td>
<td align="left" valign="top"><p>Collection</p></td>
<td align="left" valign="top"><p>true</p></td>
</tr>
</tbody>
</table>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Java System Properties</th>
<th align="left" valign="top">Property file</th>
<th align="left" valign="top">Environment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">elastic.apm.enable_instrumentations</code></p></td>
<td align="left" valign="top"><p><code class="literal">enable_instrumentations</code></p></td>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_ENABLE_INSTRUMENTATIONS</code></p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="config-disable-instrumentations"></a><code class="literal">disable_instrumentations</code> (<span class="Admonishment Admonishment--change">
[<span class="Admonishment-version u-mono">1.0.0</span>]
<span class="Admonishment-detail">
Added in 1.0.0. Changing this value at runtime is possible since version 1.15.0
</span>
</span>)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/1.x/docs/configuration.asciidoc">edit</a></h4>
<p>A list of instrumentations which should be disabled.
Valid options are <code class="literal">annotations</code>, <code class="literal">annotations-capture-span</code>, <code class="literal">annotations-capture-transaction</code>, <code class="literal">annotations-traced</code>, <code class="literal">apache-commons-exec</code>, <code class="literal">apache-httpclient</code>, <code class="literal">asynchttpclient</code>, <code class="literal">aws-lambda</code>, <code class="literal">aws-sdk</code>, <code class="literal">cassandra</code>, <code class="literal">concurrent</code>, <code class="literal">dubbo</code>, <code class="literal">elasticsearch-restclient</code>, <code class="literal">exception-handler</code>, <code class="literal">executor</code>, <code class="literal">executor-collection</code>, <code class="literal">experimental</code>, <code class="literal">finagle-httpclient</code>, <code class="literal">fork-join</code>, <code class="literal">grails</code>, <code class="literal">grpc</code>, <code class="literal">hibernate-search</code>, <code class="literal">http-client</code>, <code class="literal">jakarta-websocket</code>, <code class="literal">java-ldap</code>, <code class="literal">javalin</code>, <code class="literal">javax-websocket</code>, <code class="literal">jax-rs</code>, <code class="literal">jax-ws</code>, <code class="literal">jdbc</code>, <code class="literal">jdk-httpclient</code>, <code class="literal">jdk-httpserver</code>, <code class="literal">jedis</code>, <code class="literal">jms</code>, <code class="literal">jsf</code>, <code class="literal">kafka</code>, <code class="literal">lettuce</code>, <code class="literal">log-correlation</code>, <code class="literal">log-error</code>, <code class="literal">log-reformatting</code>, <code class="literal">logging</code>, <code class="literal">micrometer</code>, <code class="literal">mongodb</code>, <code class="literal">mongodb-client</code>, <code class="literal">okhttp</code>, <code class="literal">opentelemetry</code>, <code class="literal">opentelemetry-annotations</code>, <code class="literal">opentelemetry-metrics</code>, <code class="literal">opentracing</code>, <code class="literal">process</code>, <code class="literal">public-api</code>, <code class="literal">quartz</code>, <code class="literal">rabbitmq</code>, <code class="literal">reactor</code>, <code class="literal">redis</code>, <code class="literal">redisson</code>, <code class="literal">render</code>, <code class="literal">scala-future</code>, <code class="literal">scheduled</code>, <code class="literal">servlet-api</code>, <code class="literal">servlet-api-async</code>, <code class="literal">servlet-api-dispatch</code>, <code class="literal">servlet-input-stream</code>, <code class="literal">servlet-service-name</code>, <code class="literal">servlet-version</code>, <code class="literal">sparkjava</code>, <code class="literal">spring-amqp</code>, <code class="literal">spring-mvc</code>, <code class="literal">spring-resttemplate</code>, <code class="literal">spring-service-name</code>, <code class="literal">spring-view-render</code>, <code class="literal">spring-webclient</code>, <code class="literal">spring-webflux</code>, <code class="literal">ssl-context</code>, <code class="literal">struts</code>, <code class="literal">timer-task</code>, <code class="literal">urlconnection</code>, <code class="literal">vertx</code>, <code class="literal">vertx-web</code>, <code class="literal">vertx-webclient</code>, <code class="literal">websocket</code>.
For version <code class="literal">1.25.0</code> and later, use <a class="xref" href="config-core.html#config-enable-experimental-instrumentations" title="enable_experimental_instrumentations ()"><code class="literal">enable_experimental_instrumentations</code> (<span class="Admonishment Admonishment--change">
[<span class="Admonishment-version u-mono">1.25.0</span>]
<span class="Admonishment-detail">
Added in 1.25.0.
</span>
</span>)</a> to enable experimental instrumentations.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Changing this value at runtime can slow down the application temporarily.</p>
</div>
</div>
<p><a class="xref" href="configuration.html#configuration-dynamic" title="Dynamic configuration"><span class="image"><img src="./images/dynamic-config.svg" alt="dynamic config"></span> </a></p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Dynamic</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">&lt;none&gt;</code></p></td>
<td align="left" valign="top"><p>Collection</p></td>
<td align="left" valign="top"><p>true</p></td>
</tr>
</tbody>
</table>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Java System Properties</th>
<th align="left" valign="top">Property file</th>
<th align="left" valign="top">Environment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">elastic.apm.disable_instrumentations</code></p></td>
<td align="left" valign="top"><p><code class="literal">disable_instrumentations</code></p></td>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_DISABLE_INSTRUMENTATIONS</code></p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="config-enable-experimental-instrumentations"></a><code class="literal">enable_experimental_instrumentations</code> (<span class="Admonishment Admonishment--change">
[<span class="Admonishment-version u-mono">1.25.0</span>]
<span class="Admonishment-detail">
Added in 1.25.0.
</span>
</span>)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/1.x/docs/configuration.asciidoc">edit</a></h4>
<p>Whether to apply experimental instrumentations.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Changing this value at runtime can slow down the application temporarily.
Setting to <code class="literal">true</code> will enable instrumentations in the <code class="literal">experimental</code> group.</p>
</div>
</div>
<p><a class="xref" href="configuration.html#configuration-dynamic" title="Dynamic configuration"><span class="image"><img src="./images/dynamic-config.svg" alt="dynamic config"></span> </a></p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Dynamic</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Boolean</p></td>
<td align="left" valign="top"><p>true</p></td>
</tr>
</tbody>
</table>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Java System Properties</th>
<th align="left" valign="top">Property file</th>
<th align="left" valign="top">Environment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">elastic.apm.enable_experimental_instrumentations</code></p></td>
<td align="left" valign="top"><p><code class="literal">enable_experimental_instrumentations</code></p></td>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_ENABLE_EXPERIMENTAL_INSTRUMENTATIONS</code></p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="config-unnest-exceptions"></a><code class="literal">unnest_exceptions</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/1.x/docs/configuration.asciidoc">edit</a></h4>
<p>When reporting exceptions,
un-nests the exceptions matching the wildcard pattern.
This can come in handy for Spring&#8217;s <code class="literal">org.springframework.web.util.NestedServletException</code>,
for example.</p>
<p>This option supports the wildcard <code class="literal">*</code>, which matches zero or more characters.
Examples: <code class="literal">/foo/*/bar/*/baz*</code>, <code class="literal">*foo*</code>.
Matching is case insensitive by default.
Prepending an element with <code class="literal">(?-i)</code> makes the matching case sensitive.</p>
<p><a class="xref" href="configuration.html#configuration-dynamic" title="Dynamic configuration"><span class="image"><img src="./images/dynamic-config.svg" alt="dynamic config"></span> </a></p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Dynamic</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">(?-i)*Nested*Exception</code></p></td>
<td align="left" valign="top"><p>List</p></td>
<td align="left" valign="top"><p>true</p></td>
</tr>
</tbody>
</table>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Java System Properties</th>
<th align="left" valign="top">Property file</th>
<th align="left" valign="top">Environment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">elastic.apm.unnest_exceptions</code></p></td>
<td align="left" valign="top"><p><code class="literal">unnest_exceptions</code></p></td>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_UNNEST_EXCEPTIONS</code></p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="config-ignore-exceptions"></a><code class="literal">ignore_exceptions</code> (<span class="Admonishment Admonishment--change">
[<span class="Admonishment-version u-mono">1.11.0</span>]
<span class="Admonishment-detail">
Added in 1.11.0.
</span>
</span>)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/1.x/docs/configuration.asciidoc">edit</a></h4>
<p>A list of exceptions that should be ignored and not reported as errors.
This allows to ignore exceptions thrown in regular control flow that are not actual errors</p>
<p>This option supports the wildcard <code class="literal">*</code>, which matches zero or more characters.
Examples: <code class="literal">/foo/*/bar/*/baz*</code>, <code class="literal">*foo*</code>.
Matching is case insensitive by default.
Prepending an element with <code class="literal">(?-i)</code> makes the matching case sensitive.</p>
<p>Examples:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">com.mycompany.ExceptionToIgnore</code>: using fully qualified name
</li>
<li class="listitem">
<code class="literal">*ExceptionToIgnore</code>: using wildcard to avoid package name
</li>
<li class="listitem">
<code class="literal">*exceptiontoignore</code>: case-insensitive by default
</li>
</ul>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Exception inheritance is not supported, thus you have to explicitly list all the thrown exception types</p>
</div>
</div>
<p><a class="xref" href="configuration.html#configuration-dynamic" title="Dynamic configuration"><span class="image"><img src="./images/dynamic-config.svg" alt="dynamic config"></span> </a></p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Dynamic</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">&lt;none&gt;</code></p></td>
<td align="left" valign="top"><p>List</p></td>
<td align="left" valign="top"><p>true</p></td>
</tr>
</tbody>
</table>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Java System Properties</th>
<th align="left" valign="top">Property file</th>
<th align="left" valign="top">Environment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">elastic.apm.ignore_exceptions</code></p></td>
<td align="left" valign="top"><p><code class="literal">ignore_exceptions</code></p></td>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_IGNORE_EXCEPTIONS</code></p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="config-capture-body"></a><code class="literal">capture_body</code> (performance)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/1.x/docs/configuration.asciidoc">edit</a></h4>
<p>For transactions that are HTTP requests, the Java agent can optionally capture the request body (e.g. POST
variables). For transactions that are initiated by receiving a message from a message broker, the agent can
capture the textual message body.</p>
<p>If the HTTP request or the message has a body and this setting is disabled, the body will be shown as [REDACTED].</p>
<p>This option is case-insensitive.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Currently, the body length is limited to 10000 characters and it is not configurable.
If the body size exceeds the limit, it will be truncated.</p>
</div>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Currently, only UTF-8 encoded plain text HTTP content types are supported.
The option <a class="xref" href="config-http.html#config-capture-body-content-types" title="capture_body_content_types ( performance)"><code class="literal">capture_body_content_types</code> (<span class="Admonishment Admonishment--change">
[<span class="Admonishment-version u-mono">1.5.0</span>]
<span class="Admonishment-detail">
Added in 1.5.0.
</span>
</span> performance)</a> determines which content types are captured.</p>
</div>
</div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>Request bodies often contain sensitive values like passwords, credit card numbers etc.
If your service handles data like this, we advise to only enable this feature with care.
Turning on body capturing can also significantly increase the overhead in terms of heap usage,
network utilisation and Elasticsearch index size.</p>
</div>
</div>
<p><a class="xref" href="configuration.html#configuration-dynamic" title="Dynamic configuration"><span class="image"><img src="./images/dynamic-config.svg" alt="dynamic config"></span> </a></p>
<p>Valid options: <code class="literal">off</code>, <code class="literal">errors</code>, <code class="literal">transactions</code>, <code class="literal">all</code></p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Dynamic</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">OFF</code></p></td>
<td align="left" valign="top"><p>EventType</p></td>
<td align="left" valign="top"><p>true</p></td>
</tr>
</tbody>
</table>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Java System Properties</th>
<th align="left" valign="top">Property file</th>
<th align="left" valign="top">Environment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">elastic.apm.capture_body</code></p></td>
<td align="left" valign="top"><p><code class="literal">capture_body</code></p></td>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_CAPTURE_BODY</code></p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="config-capture-headers"></a><code class="literal">capture_headers</code> (performance)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/1.x/docs/configuration.asciidoc">edit</a></h4>
<p>If set to <code class="literal">true</code>, the agent will capture HTTP request and response headers (including cookies),
as well as messages' headers/properties when using messaging frameworks like Kafka or JMS.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Setting this to <code class="literal">false</code> reduces network bandwidth, disk space and object allocations.</p>
</div>
</div>
<p><a class="xref" href="configuration.html#configuration-dynamic" title="Dynamic configuration"><span class="image"><img src="./images/dynamic-config.svg" alt="dynamic config"></span> </a></p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Dynamic</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">true</code></p></td>
<td align="left" valign="top"><p>Boolean</p></td>
<td align="left" valign="top"><p>true</p></td>
</tr>
</tbody>
</table>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Java System Properties</th>
<th align="left" valign="top">Property file</th>
<th align="left" valign="top">Environment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">elastic.apm.capture_headers</code></p></td>
<td align="left" valign="top"><p><code class="literal">capture_headers</code></p></td>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_CAPTURE_HEADERS</code></p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="config-global-labels"></a><code class="literal">global_labels</code> (<span class="Admonishment Admonishment--change">
[<span class="Admonishment-version u-mono">1.7.0</span>]
<span class="Admonishment-detail">
Added in 1.7.0. Requires APM Server 7.2+
</span>
</span>)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/1.x/docs/configuration.asciidoc">edit</a></h4>
<p>Labels added to all events, with the format <code class="literal">key=value[,key=value[,...]]</code>.
Any labels set by application via the API will override global labels with the same keys.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This feature requires APM Server 7.2+</p>
</div>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Dynamic</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">&lt;none&gt;</code></p></td>
<td align="left" valign="top"><p>Map</p></td>
<td align="left" valign="top"><p>false</p></td>
</tr>
</tbody>
</table>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Java System Properties</th>
<th align="left" valign="top">Property file</th>
<th align="left" valign="top">Environment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">elastic.apm.global_labels</code></p></td>
<td align="left" valign="top"><p><code class="literal">global_labels</code></p></td>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_GLOBAL_LABELS</code></p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="config-instrument-ancient-bytecode"></a><code class="literal">instrument_ancient_bytecode</code> (<span class="Admonishment Admonishment--change">
[<span class="Admonishment-version u-mono">1.35.0</span>]
<span class="Admonishment-detail">
Added in 1.35.0.
</span>
</span>)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/1.x/docs/configuration.asciidoc">edit</a></h4>
<p>A boolean specifying if the agent should instrument pre-Java-1.4 bytecode.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Dynamic</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Boolean</p></td>
<td align="left" valign="top"><p>false</p></td>
</tr>
</tbody>
</table>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Java System Properties</th>
<th align="left" valign="top">Property file</th>
<th align="left" valign="top">Environment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">elastic.apm.instrument_ancient_bytecode</code></p></td>
<td align="left" valign="top"><p><code class="literal">instrument_ancient_bytecode</code></p></td>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_INSTRUMENT_ANCIENT_BYTECODE</code></p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="config-context-propagation-only"></a><code class="literal">context_propagation_only</code> (<span class="Admonishment Admonishment--change">
[<span class="Admonishment-version u-mono">1.44.0</span>]
<span class="Admonishment-detail">
Added in 1.44.0.
</span>
</span>)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/1.x/docs/configuration.asciidoc">edit</a></h4>
<p>When set to true, disables log sending, metrics and trace collection.
Trace context propagation and log correlation will stay active.
Note that in contrast to <a class="xref" href="config-reporter.html#config-disable-send" title="disable_send"><code class="literal">disable_send</code></a> the agent will still connect to the APM-server for fetching configuration updates and health checks.</p>
<p><a class="xref" href="configuration.html#configuration-dynamic" title="Dynamic configuration"><span class="image"><img src="./images/dynamic-config.svg" alt="dynamic config"></span> </a></p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Dynamic</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Boolean</p></td>
<td align="left" valign="top"><p>true</p></td>
</tr>
</tbody>
</table>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Java System Properties</th>
<th align="left" valign="top">Property file</th>
<th align="left" valign="top">Environment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">elastic.apm.context_propagation_only</code></p></td>
<td align="left" valign="top"><p><code class="literal">context_propagation_only</code></p></td>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_CONTEXT_PROPAGATION_ONLY</code></p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="config-classes-excluded-from-instrumentation"></a><code class="literal">classes_excluded_from_instrumentation</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/1.x/docs/configuration.asciidoc">edit</a></h4>
<p>Use to exclude specific classes from being instrumented. In order to exclude entire packages,
use wildcards, as in: <code class="literal">com.project.exclude.*</code>
This option supports the wildcard <code class="literal">*</code>, which matches zero or more characters.
Examples: <code class="literal">/foo/*/bar/*/baz*</code>, <code class="literal">*foo*</code>.
Matching is case insensitive by default.
Prepending an element with <code class="literal">(?-i)</code> makes the matching case sensitive.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Dynamic</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">&lt;none&gt;</code></p></td>
<td align="left" valign="top"><p>List</p></td>
<td align="left" valign="top"><p>false</p></td>
</tr>
</tbody>
</table>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Java System Properties</th>
<th align="left" valign="top">Property file</th>
<th align="left" valign="top">Environment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">elastic.apm.classes_excluded_from_instrumentation</code></p></td>
<td align="left" valign="top"><p><code class="literal">classes_excluded_from_instrumentation</code></p></td>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_CLASSES_EXCLUDED_FROM_INSTRUMENTATION</code></p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="config-trace-methods"></a><code class="literal">trace_methods</code> (<span class="Admonishment Admonishment--change">
[<span class="Admonishment-version u-mono">1.0.0</span>]
<span class="Admonishment-detail">
Added in 1.0.0. Changing this value at runtime is possible since version 1.15.0
</span>
</span>)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/1.x/docs/configuration.asciidoc">edit</a></h4>
<p>A list of methods for which to create a transaction or span.</p>
<p>If you want to monitor a large number of methods,
use  <a class="xref" href="config-profiling.html#config-profiling-inferred-spans-enabled" title="profiling_inferred_spans_enabled ( experimental)"><code class="literal">profiling_inferred_spans_enabled</code></a> instead.</p>
<p>This works by instrumenting each matching method to include code that creates a span for the method.
While creating a span is quite cheap in terms of performance,
instrumenting a whole code base or a method which is executed in a tight loop leads to significant overhead.</p>
<p>Using a pointcut-like syntax, you can match based on</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Method modifier (optional)<br>
Example: <code class="literal">public</code>, <code class="literal">protected</code>, <code class="literal">private</code> or <code class="literal">*</code>
</li>
<li class="listitem">
Package and class name (wildcards include sub-packages)<br>
Example: <code class="literal">org.example.*</code>
</li>
<li class="listitem">
Method name (optional since 1.4.0)<br>
Example: <code class="literal">myMeth*d</code>
</li>
<li class="listitem">
Method argument types (optional)<br>
Example: <code class="literal">(*lang.String, int[])</code>
</li>
<li class="listitem">
Classes with a specific annotation (optional)<br>
Example: <code class="literal">@*ApplicationScoped</code>
</li>
<li class="listitem">
Classes with a specific annotation that is itself annotated with the given meta-annotation (optional)<br>
Example: <code class="literal">@@javax.enterpr*se.context.NormalScope</code>
</li>
</ul>
</div>
<p>The syntax is <code class="literal">modifier @fully.qualified.AnnotationName fully.qualified.ClassName#methodName(fully.qualified.ParameterType)</code>.</p>
<p>A few examples:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">org.example.*</code> <span class="Admonishment Admonishment--change">
[<span class="Admonishment-version u-mono">1.4.0</span>]
<span class="Admonishment-detail">
Added in 1.4.0. Omitting the method is possible since 1.4.0
</span>
</span>
</li>
<li class="listitem">
<code class="literal">org.example.*#*</code> (before 1.4.0, you need to specify a method matcher)
</li>
<li class="listitem">
<code class="literal">org.example.MyClass#myMethod</code>
</li>
<li class="listitem">
<code class="literal">org.example.MyClass#myMethod()</code>
</li>
<li class="listitem">
<code class="literal">org.example.MyClass#myMethod(java.lang.String)</code>
</li>
<li class="listitem">
<code class="literal">org.example.MyClass#myMe*od(java.lang.String, int)</code>
</li>
<li class="listitem">
<code class="literal">private org.example.MyClass#myMe*od(java.lang.String, *)</code>
</li>
<li class="listitem">
<code class="literal">* org.example.MyClas*#myMe*od(*.String, int[])</code>
</li>
<li class="listitem">
<code class="literal">public org.example.services.*Service#*</code>
</li>
<li class="listitem">
<code class="literal">public @java.inject.ApplicationScoped org.example.*</code>
</li>
<li class="listitem">
<code class="literal">public @java.inject.* org.example.*</code>
</li>
<li class="listitem">
<code class="literal">public @@javax.enterprise.context.NormalScope org.example.*, public @@jakarta.enterprise.context.NormalScope org.example.*</code>
</li>
</ul>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Only use wildcards if necessary.
The more methods you match the more overhead will be caused by the agent.
Also note that there is a maximum amount of spans per transaction (see <a class="xref" href="config-core.html#config-transaction-max-spans" title="transaction_max_spans (performance)"><code class="literal">transaction_max_spans</code></a>).</p>
</div>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The agent will create stack traces for spans which took longer than
<a class="xref" href="config-stacktrace.html#config-span-stack-trace-min-duration" title="span_stack_trace_min_duration (performance)"><code class="literal">span_stack_trace_min_duration</code></a>.
When tracing a large number of methods (for example by using wildcards),
this may lead to high overhead.
Consider increasing the threshold or disabling stack trace collection altogether.</p>
</div>
</div>
<p>Common configurations:</p>
<p>Trace all public methods in CDI-Annotated beans:</p>
<pre class="screen">public @@javax.enterprise.context.NormalScope your.application.package.*
public @@jakarta.enterprise.context.NormalScope your.application.package.*
public @@javax.inject.Scope your.application.package.*</pre>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This method is only available in the Elastic APM Java Agent.</p>
</div>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Changing this value at runtime can slow down the application temporarily.</p>
</div>
</div>
<p><a class="xref" href="configuration.html#configuration-dynamic" title="Dynamic configuration"><span class="image"><img src="./images/dynamic-config.svg" alt="dynamic config"></span> </a></p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Dynamic</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">&lt;none&gt;</code></p></td>
<td align="left" valign="top"><p>List</p></td>
<td align="left" valign="top"><p>true</p></td>
</tr>
</tbody>
</table>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Java System Properties</th>
<th align="left" valign="top">Property file</th>
<th align="left" valign="top">Environment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">elastic.apm.trace_methods</code></p></td>
<td align="left" valign="top"><p><code class="literal">trace_methods</code></p></td>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_TRACE_METHODS</code></p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="config-trace-methods-duration-threshold"></a><code class="literal">trace_methods_duration_threshold</code> (<span class="Admonishment Admonishment--change">
[<span class="Admonishment-version u-mono">1.7.0</span>]
<span class="Admonishment-detail">
Added in 1.7.0.
</span>
</span>)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/1.x/docs/configuration.asciidoc">edit</a></h4>
<p>If <a class="xref" href="config-core.html#config-trace-methods" title="trace_methods ()"><code class="literal">trace_methods</code></a> config option is set, provides a threshold to limit spans based on
duration. When set to a value greater than 0, spans representing methods traced based on <code class="literal">trace_methods</code> will be discarded by default.
Such methods will be traced and reported if one of the following applies:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
This method&#8217;s duration crossed the configured threshold.
</li>
<li class="listitem">
This method ended with Exception.
</li>
<li class="listitem">
A method executed as part of the execution of this method crossed the threshold or ended with Exception.
</li>
<li class="listitem">
A "forcibly-traced method" (e.g. DB queries, HTTP exits, custom) was executed during the execution of this method.
</li>
</ul>
</div>
<p>Set to 0 to disable.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Transactions are never discarded, regardless of their duration.
This configuration affects only spans.
In order not to break span references,
all spans leading to an async operation or an exit span (such as a HTTP request or a DB query) are never discarded,
regardless of their duration.</p>
</div>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>If this option and <a class="xref" href="config-core.html#config-span-min-duration" title="span_min_duration ()"><code class="literal">span_min_duration</code></a> are both configured,
the higher of both thresholds will determine which spans will be discarded.</p>
</div>
</div>
<p>Supports the duration suffixes <code class="literal">ms</code>, <code class="literal">s</code> and <code class="literal">m</code>.
Example: <code class="literal">0ms</code>.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Dynamic</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">0ms</code></p></td>
<td align="left" valign="top"><p>TimeDuration</p></td>
<td align="left" valign="top"><p>false</p></td>
</tr>
</tbody>
</table>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Java System Properties</th>
<th align="left" valign="top">Property file</th>
<th align="left" valign="top">Environment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">elastic.apm.trace_methods_duration_threshold</code></p></td>
<td align="left" valign="top"><p><code class="literal">trace_methods_duration_threshold</code></p></td>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_TRACE_METHODS_DURATION_THRESHOLD</code></p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="config-central-config"></a><code class="literal">central_config</code> (<span class="Admonishment Admonishment--change">
[<span class="Admonishment-version u-mono">1.8.0</span>]
<span class="Admonishment-detail">
Added in 1.8.0.
</span>
</span>)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/1.x/docs/configuration.asciidoc">edit</a></h4>
<p>When enabled, the agent will make periodic requests to the APM Server to fetch updated configuration.</p>
<p><a class="xref" href="configuration.html#configuration-dynamic" title="Dynamic configuration"><span class="image"><img src="./images/dynamic-config.svg" alt="dynamic config"></span> </a></p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Dynamic</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">true</code></p></td>
<td align="left" valign="top"><p>Boolean</p></td>
<td align="left" valign="top"><p>true</p></td>
</tr>
</tbody>
</table>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Java System Properties</th>
<th align="left" valign="top">Property file</th>
<th align="left" valign="top">Environment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">elastic.apm.central_config</code></p></td>
<td align="left" valign="top"><p><code class="literal">central_config</code></p></td>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_CENTRAL_CONFIG</code></p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="config-breakdown-metrics"></a><code class="literal">breakdown_metrics</code> (<span class="Admonishment Admonishment--change">
[<span class="Admonishment-version u-mono">1.8.0</span>]
<span class="Admonishment-detail">
Added in 1.8.0.
</span>
</span>)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/1.x/docs/configuration.asciidoc">edit</a></h4>
<p>Disables the collection of breakdown metrics (<code class="literal">span.self_time</code>)</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Dynamic</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">true</code></p></td>
<td align="left" valign="top"><p>Boolean</p></td>
<td align="left" valign="top"><p>false</p></td>
</tr>
</tbody>
</table>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Java System Properties</th>
<th align="left" valign="top">Property file</th>
<th align="left" valign="top">Environment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">elastic.apm.breakdown_metrics</code></p></td>
<td align="left" valign="top"><p><code class="literal">breakdown_metrics</code></p></td>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_BREAKDOWN_METRICS</code></p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="config-config-file"></a><code class="literal">config_file</code> (<span class="Admonishment Admonishment--change">
[<span class="Admonishment-version u-mono">1.8.0</span>]
<span class="Admonishment-detail">
Added in 1.8.0.
</span>
</span>)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/1.x/docs/configuration.asciidoc">edit</a></h4>
<p>Sets the path of the agent config file.
The special value <code class="literal">_AGENT_HOME_</code> is a placeholder for the folder the <code class="literal">elastic-apm-agent.jar</code> is in.
The file has to be on the file system.
You can not refer to classpath locations.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>this option can only be set via system properties, environment variables or the attacher options.</p>
</div>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Dynamic</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">_AGENT_HOME_/elasticapm.properties</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>false</p></td>
</tr>
</tbody>
</table>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Java System Properties</th>
<th align="left" valign="top">Property file</th>
<th align="left" valign="top">Environment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">elastic.apm.config_file</code></p></td>
<td align="left" valign="top"><p><code class="literal">config_file</code></p></td>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_CONFIG_FILE</code></p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="config-plugins-dir"></a><code class="literal">plugins_dir</code> (experimental)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/1.x/docs/configuration.asciidoc">edit</a></h4>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This feature is currently experimental, which means it is disabled by default and it is not guaranteed to be backwards compatible in future releases.</p>
</div>
</div>
<p>A folder that contains external agent plugins.</p>
<p>Use the <code class="literal">apm-agent-plugin-sdk</code> and the <code class="literal">apm-agent-api</code> artifacts to create a jar and place it into the plugins folder.
The agent will load all instrumentations that are declared in the
<code class="literal">META-INF/services/co.elastic.apm.agent.sdk.ElasticApmInstrumentation</code> service descriptor.
See <code class="literal">integration-tests/external-plugin-test</code> for an example plugin.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Dynamic</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">&lt;none&gt;</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>false</p></td>
</tr>
</tbody>
</table>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Java System Properties</th>
<th align="left" valign="top">Property file</th>
<th align="left" valign="top">Environment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">elastic.apm.plugins_dir</code></p></td>
<td align="left" valign="top"><p><code class="literal">plugins_dir</code></p></td>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_PLUGINS_DIR</code></p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="config-use-elastic-traceparent-header"></a><code class="literal">use_elastic_traceparent_header</code> (<span class="Admonishment Admonishment--change">
[<span class="Admonishment-version u-mono">1.14.0</span>]
<span class="Admonishment-detail">
Added in 1.14.0.
</span>
</span>)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/1.x/docs/configuration.asciidoc">edit</a></h4>
<p>To enable <a href="/guide/en/apm/guide/8.15/apm-distributed-tracing.html" class="ulink" target="_top">distributed tracing</a>, the agent
adds trace context headers to outgoing requests (like HTTP requests, Kafka records, gRPC requests etc.).
These headers (<code class="literal">traceparent</code> and <code class="literal">tracestate</code>) are defined in the
<a href="https://www.w3.org/TR/trace-context-1/" class="ulink" target="_top">W3C Trace Context</a> specification.</p>
<p>When this setting is <code class="literal">true</code>, the agent will also add the header <code class="literal">elastic-apm-traceparent</code>
for backwards compatibility with older versions of Elastic APM agents.</p>
<p><a class="xref" href="configuration.html#configuration-dynamic" title="Dynamic configuration"><span class="image"><img src="./images/dynamic-config.svg" alt="dynamic config"></span> </a></p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Dynamic</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">true</code></p></td>
<td align="left" valign="top"><p>Boolean</p></td>
<td align="left" valign="top"><p>true</p></td>
</tr>
</tbody>
</table>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Java System Properties</th>
<th align="left" valign="top">Property file</th>
<th align="left" valign="top">Environment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">elastic.apm.use_elastic_traceparent_header</code></p></td>
<td align="left" valign="top"><p><code class="literal">use_elastic_traceparent_header</code></p></td>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_USE_ELASTIC_TRACEPARENT_HEADER</code></p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="config-disable-outgoing-tracecontext-headers"></a><code class="literal">disable_outgoing_tracecontext_headers</code> (<span class="Admonishment Admonishment--change">
[<span class="Admonishment-version u-mono">1.37.0</span>]
<span class="Admonishment-detail">
Added in 1.37.0.
</span>
</span>)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/1.x/docs/configuration.asciidoc">edit</a></h4>
<p>Use this option to disable <code class="literal">tracecontext</code> headers injection to any outgoing communication.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Disabling <code class="literal">tracecontext</code> headers injection means that <a href="/guide/en/apm/guide/8.15/apm-distributed-tracing.html" class="ulink" target="_top">distributed tracing</a>
will not work on downstream services.</p>
</div>
</div>
<p><a class="xref" href="configuration.html#configuration-dynamic" title="Dynamic configuration"><span class="image"><img src="./images/dynamic-config.svg" alt="dynamic config"></span> </a></p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Dynamic</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Boolean</p></td>
<td align="left" valign="top"><p>true</p></td>
</tr>
</tbody>
</table>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Java System Properties</th>
<th align="left" valign="top">Property file</th>
<th align="left" valign="top">Environment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">elastic.apm.disable_outgoing_tracecontext_headers</code></p></td>
<td align="left" valign="top"><p><code class="literal">disable_outgoing_tracecontext_headers</code></p></td>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_DISABLE_OUTGOING_TRACECONTEXT_HEADERS</code></p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="config-span-min-duration"></a><code class="literal">span_min_duration</code> (<span class="Admonishment Admonishment--change">
[<span class="Admonishment-version u-mono">1.16.0</span>]
<span class="Admonishment-detail">
Added in 1.16.0.
</span>
</span>)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/1.x/docs/configuration.asciidoc">edit</a></h4>
<p>Sets the minimum duration of spans.
Spans that execute faster than this threshold are attempted to be discarded.</p>
<p>The attempt fails if they lead up to a span that can&#8217;t be discarded.
Spans that propagate the trace context to downstream services,
such as outgoing HTTP requests,
can&#8217;t be discarded.
Additionally, spans that lead to an error or that may be a parent of an async operation can&#8217;t be discarded.</p>
<p>However, external calls that don&#8217;t propagate context,
such as calls to a database, can be discarded using this threshold.</p>
<p><a class="xref" href="configuration.html#configuration-dynamic" title="Dynamic configuration"><span class="image"><img src="./images/dynamic-config.svg" alt="dynamic config"></span> </a></p>
<p>Supports the duration suffixes <code class="literal">ms</code>, <code class="literal">s</code> and <code class="literal">m</code>.
Example: <code class="literal">0ms</code>.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Dynamic</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">0ms</code></p></td>
<td align="left" valign="top"><p>TimeDuration</p></td>
<td align="left" valign="top"><p>true</p></td>
</tr>
</tbody>
</table>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Java System Properties</th>
<th align="left" valign="top">Property file</th>
<th align="left" valign="top">Environment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">elastic.apm.span_min_duration</code></p></td>
<td align="left" valign="top"><p><code class="literal">span_min_duration</code></p></td>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_SPAN_MIN_DURATION</code></p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="config-cloud-provider"></a><code class="literal">cloud_provider</code> (<span class="Admonishment Admonishment--change">
[<span class="Admonishment-version u-mono">1.21.0</span>]
<span class="Admonishment-detail">
Added in 1.21.0.
</span>
</span>)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/1.x/docs/configuration.asciidoc">edit</a></h4>
<p>This config value allows you to specify which cloud provider should be assumed
for metadata collection. By default, the agent will attempt to detect the cloud
provider or, if that fails, will use trial and error to collect the metadata.</p>
<p>Valid options: <code class="literal">AUTO</code>, <code class="literal">AWS</code>, <code class="literal">GCP</code>, <code class="literal">AZURE</code>, <code class="literal">NONE</code></p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Dynamic</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">AUTO</code></p></td>
<td align="left" valign="top"><p>CloudProvider</p></td>
<td align="left" valign="top"><p>false</p></td>
</tr>
</tbody>
</table>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Java System Properties</th>
<th align="left" valign="top">Property file</th>
<th align="left" valign="top">Environment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">elastic.apm.cloud_provider</code></p></td>
<td align="left" valign="top"><p><code class="literal">cloud_provider</code></p></td>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_CLOUD_PROVIDER</code></p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="config-enable-public-api-annotation-inheritance"></a><code class="literal">enable_public_api_annotation_inheritance</code> (performance)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/1.x/docs/configuration.asciidoc">edit</a></h4>
<p>A boolean specifying if the agent should search the class hierarchy for public api annotations (<code class="literal">@CaptureTransaction</code>, <code class="literal">@CaptureSpan</code>, <code class="literal">@Traced</code> and from 1.45.0 <code class="literal">@WithSpan</code>).
 When set to <code class="literal">false</code>, a method is instrumented if it is annotated with a public api annotation.
  When set to <code class="literal">true</code> methods overriding annotated methods will be instrumented as well.
 Either way, methods will only be instrumented if they are included in the configured <a class="xref" href="config-stacktrace.html#config-application-packages" title="application_packages"><code class="literal">application_packages</code></a>.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Dynamic</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Boolean</p></td>
<td align="left" valign="top"><p>false</p></td>
</tr>
</tbody>
</table>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Java System Properties</th>
<th align="left" valign="top">Property file</th>
<th align="left" valign="top">Environment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">elastic.apm.enable_public_api_annotation_inheritance</code></p></td>
<td align="left" valign="top"><p><code class="literal">enable_public_api_annotation_inheritance</code></p></td>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_ENABLE_PUBLIC_API_ANNOTATION_INHERITANCE</code></p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="config-transaction-name-groups"></a><code class="literal">transaction_name_groups</code> (<span class="Admonishment Admonishment--change">
[<span class="Admonishment-version u-mono">1.33.0</span>]
<span class="Admonishment-detail">
Added in 1.33.0.
</span>
</span>)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/1.x/docs/configuration.asciidoc">edit</a></h4>
<p>With this option,
you can group transaction names that contain dynamic parts with a wildcard expression.
For example,
the pattern <code class="literal">GET /user/*/cart</code> would consolidate transactions,
such as <code class="literal">GET /users/42/cart</code> and <code class="literal">GET /users/73/cart</code> into a single transaction name <code class="literal">GET /users/*/cart</code>,
hence reducing the transaction name cardinality.</p>
<p>This option supports the wildcard <code class="literal">*</code>, which matches zero or more characters.
Examples: <code class="literal">/foo/*/bar/*/baz*</code>, <code class="literal">*foo*</code>.
Matching is case insensitive by default.
Prepending an element with <code class="literal">(?-i)</code> makes the matching case sensitive.</p>
<p><a class="xref" href="configuration.html#configuration-dynamic" title="Dynamic configuration"><span class="image"><img src="./images/dynamic-config.svg" alt="dynamic config"></span> </a></p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Dynamic</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">&lt;none&gt;</code></p></td>
<td align="left" valign="top"><p>List</p></td>
<td align="left" valign="top"><p>true</p></td>
</tr>
</tbody>
</table>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Java System Properties</th>
<th align="left" valign="top">Property file</th>
<th align="left" valign="top">Environment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">elastic.apm.transaction_name_groups</code></p></td>
<td align="left" valign="top"><p><code class="literal">transaction_name_groups</code></p></td>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_TRANSACTION_NAME_GROUPS</code></p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="config-trace-continuation-strategy"></a><code class="literal">trace_continuation_strategy</code> (<span class="Admonishment Admonishment--change">
[<span class="Admonishment-version u-mono">1.34.0</span>]
<span class="Admonishment-detail">
Added in 1.34.0.
</span>
</span>)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/1.x/docs/configuration.asciidoc">edit</a></h4>
<p>This option allows some control over how the APM agent handles W3C trace-context headers on incoming requests. By default, the <code class="literal">traceparent</code> and <code class="literal">tracestate</code> headers are used per W3C spec for distributed tracing. However, in certain cases it can be helpful to not use the incoming <code class="literal">traceparent</code> header. Some example use cases:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
An Elastic-monitored service is receiving requests with <code class="literal">traceparent</code> headers from unmonitored services.
</li>
<li class="listitem">
An Elastic-monitored service is publicly exposed, and does not want tracing data (trace-ids, sampling decisions) to possibly be spoofed by user requests.
</li>
</ul>
</div>
<p>Valid values are:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<em>continue</em>: The default behavior. An incoming <code class="literal">traceparent</code> value is used to continue the trace and determine the sampling decision.
</li>
<li class="listitem">
<em>restart</em>: Always ignores the <code class="literal">traceparent</code> header of incoming requests. A new trace-id will be generated and the sampling decision will be made based on transaction_sample_rate. A span link will be made to the incoming <code class="literal">traceparent</code>.
</li>
<li class="listitem">
<em>restart_external</em>: If an incoming request includes the <code class="literal">es</code> vendor flag in <code class="literal">tracestate</code>, then any <code class="literal">traceparent</code> will be considered internal and will be handled as described for <em>continue</em> above. Otherwise, any <code class="literal">traceparent</code> is considered external and will be handled as described for <em>restart</em> above.
</li>
</ul>
</div>
<p>Starting with Elastic Observability 8.2, span links are visible in trace views.</p>
<p>This option is case-insensitive.</p>
<p><a class="xref" href="configuration.html#configuration-dynamic" title="Dynamic configuration"><span class="image"><img src="./images/dynamic-config.svg" alt="dynamic config"></span> </a></p>
<p>Valid options: <code class="literal">continue</code>, <code class="literal">restart</code>, <code class="literal">restart_external</code></p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Dynamic</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">CONTINUE</code></p></td>
<td align="left" valign="top"><p>TraceContinuationStrategy</p></td>
<td align="left" valign="top"><p>true</p></td>
</tr>
</tbody>
</table>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Java System Properties</th>
<th align="left" valign="top">Property file</th>
<th align="left" valign="top">Environment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">elastic.apm.trace_continuation_strategy</code></p></td>
<td align="left" valign="top"><p><code class="literal">trace_continuation_strategy</code></p></td>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_TRACE_CONTINUATION_STRATEGY</code></p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="config-baggage-to-attach"></a><code class="literal">baggage_to_attach</code> (<span class="Admonishment Admonishment--change">
[<span class="Admonishment-version u-mono">1.43.0</span>]
<span class="Admonishment-detail">
Added in 1.43.0.
</span>
</span>)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/1.x/docs/configuration.asciidoc">edit</a></h4>
<p>If any baggage key matches any of the patterns provided via this config option, the corresponding baggage key and value will be automatically stored on the corresponding transactions, spans and errors. The baggage keys will be prefixed with "baggage." on storage.</p>
<p><a class="xref" href="configuration.html#configuration-dynamic" title="Dynamic configuration"><span class="image"><img src="./images/dynamic-config.svg" alt="dynamic config"></span> </a></p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Dynamic</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">*</code></p></td>
<td align="left" valign="top"><p>List</p></td>
<td align="left" valign="top"><p>true</p></td>
</tr>
</tbody>
</table>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Java System Properties</th>
<th align="left" valign="top">Property file</th>
<th align="left" valign="top">Environment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">elastic.apm.baggage_to_attach</code></p></td>
<td align="left" valign="top"><p><code class="literal">baggage_to_attach</code></p></td>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_BAGGAGE_TO_ATTACH</code></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="config-circuit-breaker.html">« Circuit-Breaker configuration options</a>
</span>
<span class="next">
<a href="config-datastore.html">Datastore configuration options »</a>
</span>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>

                        <!-- Feedback widget -->
                        <div id="feedbackWidgetContainer"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


        <div id='elastic-footer'></div>
        <script src='https://www.elastic.co/elastic-footer.js'></script>
        <!-- Footer Section end-->

      </section>
    </div>

    <!-- Feedback modal -->
    <div id="feedbackModalContainer"></div>

    <script src="/guide/static/jquery.js"></script>
    <script type="text/javascript" src="/guide/static/docs-v1.js"></script>
    <script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
