<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>APM integration for Elastic Agent | APM Server Reference [7.12] | Elastic</title>
<link rel="home" href="index.html" title="APM Server Reference [7.12]"/>
<link rel="up" href="index.html" title="APM Server Reference [7.12]"/>
<link rel="prev" href="release-notes-6.1.html" title="APM Server version 6.1"/>
<link rel="next" href="apm-integration-data-streams.html" title="Data streams"/>
<meta name="DC.type" content="Learn/Docs/APM Server/Reference/7.12"/>
<meta name="DC.subject" content="APM"/>
<meta name="DC.identifier" content="7.12"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!--BEGIN QUALTRICS WEBSITE FEEDBACK SNIPPET-->
    <script type='text/javascript'>
      (function(){var g=function(e,h,f,g){
      this.get=function(a){for(var a=a+"=",c=document.cookie.split(";"),b=0,e=c.length;b<e;b++){for(var d=c[b];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return null};
      this.set=function(a,c){var b="",b=new Date;b.setTime(b.getTime()+6048E5);b="; expires="+b.toGMTString();document.cookie=a+"="+c+b+"; path=/; "};
      this.check=function(){var a=this.get(f);if(a)a=a.split(":");else if(100!=e)"v"==h&&(e=Math.random()>=e/100?0:100),a=[h,e,0],this.set(f,a.join(":"));else return!0;var c=a[1];if(100==c)return!0;switch(a[0]){case "v":return!1;case "r":return c=a[2]%Math.floor(100/c),a[2]++,this.set(f,a.join(":")),!c}return!0};
      this.go=function(){if(this.check()){var a=document.createElement("script");a.type="text/javascript";a.src=g;document.body&&document.body.appendChild(a)}};
      this.start=function(){var a=this;window.addEventListener?window.addEventListener("load",function(){a.go()},!1):window.attachEvent&&window.attachEvent("onload",function(){a.go()})}};
      try{(new g(100,"r","QSI_S_ZN_emkP0oSe9Qrn7kF","https://znemkp0ose9qrn7kf-elastic.siteintercept.qualtrics.com/WRSiteInterceptEngine/?Q_ZID=ZN_emkP0oSe9Qrn7kF")).start()}catch(i){}})();
    </script><div id='ZN_emkP0oSe9Qrn7kF'><!--DO NOT REMOVE-CONTENTS PLACED HERE--></div>
    <!--END WEBSITE FEEDBACK SNIPPET-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <!-- Subnav -->
    <div>
      <div>
        <div class="tertiary-nav d-none d-md-block">
          <div class="container">
            <div class="p-t-b-15 d-flex justify-content-between nav-container">
              <div class="breadcrum-wrapper"><span><a href="/guide/" style="font-size: 14px; font-weight: 600; color: #000;">Docs</a></span></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container">
              <div class="row">
                <div class="col-xs-12 col-sm-8 col-md-8 guide-section">
                  <!-- start body -->
                  <div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">APM Server Reference [7.12]</a></span>
»
<span class="breadcrumb-node">APM integration for Elastic Agent</span>
</div>
<div class="navheader">
<span class="prev">
<a href="release-notes-6.1.html">« APM Server version 6.1</a>
</span>
<span class="next">
<a href="apm-integration-data-streams.html">Data streams »</a>
</span>
</div>
<div class="part">
<div class="titlepage"><div><div>
<h1 class="title"><a id="apm-integration"></a>APM integration for Elastic Agent<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/7.12/docs/apm-package/apm-integration.asciidoc">edit</a></h1>
</div></div></div>
<div class="openblock partintro">
<div class="content">

<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is experimental and may be changed or removed completely in a future release. Elastic will take a best effort approach to fix any issues, but experimental features are not subject to the support SLA of official GA features.</p>
</div>
</div>
<p>Elastic Agent is a single, unified way to add monitoring for logs, metrics, and other types of data to each host.
The APM integration for Elastic Agent assigns the APM input to a specified policy,
and installs Elasticsearch templates and ingest node pipelines for APM data.
When Elastic Agent is assigned a policy with an APM input,
Elastic Agent will run the APM Server binary locally and listen for APM data.</p>
<h3><a id="apm-integration-get-started"></a>Get started<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/7.12/docs/apm-package/apm-integration.asciidoc">edit</a></h3>
<p>Ready to jump in?
Read through the <a class="xref" href="apm-integration.html#apm-integration-limitations" title="Limitations">APM integration limitations</a>, then head over to the</p>
<h3><a id="apm-integration-architecture"></a>Architecture<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/7.12/docs/apm-package/apm-integration.asciidoc">edit</a></h3>
<p>If RUM is enabled, you must run Elastic Agent centrally.
If RUM is disabled, Elastic Agent can be run on edge machines. To do this,
download and enroll an Elastic Agent on the same machines that your instrumented services run on.</p>
<h3><a id="apm-integration-limitations"></a>Limitations<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/7.12/docs/apm-package/apm-integration.asciidoc">edit</a></h3>
<p>The APM integration has the following limitations:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Index lifecycle management (ILM)
</span>
</dt>
<dd>
A default ILM policy, named <code class="literal">traces-apm.traces-default_policy</code> is created for all event types.
This policy moves indices to a warm data tier after 30 days.
No default cold or delete data tier is defined.
It is not possible to configure this policy in APM Server or Elastic Agent–
it must be configured with Elasticsearch or Kibana.
See <a href="/guide/en/elasticsearch/reference/7.12/example-using-index-lifecycle-policy.html" class="ulink" target="_top">Customize built-in ILM policies</a> for more information.
</dd>
<dt>
<span class="term">
Onboarding
</span>
</dt>
<dd>
APM Server no longer writes an onboarding document when setting up.
</dd>
<dt>
<span class="term">
Incompatible with <code class="literal">apm_user</code> role
</span>
</dt>
<dd>
The built-in <code class="literal">apm_user</code> role is not compatible with the APM integration
as it only provides read access to <code class="literal">apm-*</code> indices.
The new data stream naming scheme does not follow this pattern,
so users with the <code class="literal">apm_user</code> role will not be able to view <code class="literal">apm</code> data.
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Standalone mode
</span>
</dt>
<dd>
<a href="/guide/en/fleet/7.12/run-elastic-agent-standalone.html" class="ulink" target="_top">Standalone mode</a> is not currently supported.
An Elastic Agent with the APM integration enabled must be managed by fleet.
</dd>
<dt>
<span class="term">
Service names
</span>
</dt>
<dd>
Service names are case-insensitive and must be unique.
See <a class="xref" href="apm-integration-data-streams.html#apm-integration-service-name" title="Service names">Service names</a> for more information.
</dd>
<dt>
<span class="term">
Upgrading from prior Elastic Agent versions
</span>
</dt>
<dd>
Due to changing API key permissions, an Elastic Agent enrolled before version 7.12 is not compatible with the APM integration.
You must enroll a new Elastic Agent to use the integration.
</dd>
</dl>
</div>
<h3><a id="apm-integration-terminology"></a>Terminology<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/7.12/docs/apm-package/apm-integration.asciidoc">edit</a></h3>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Agents
</span>
</dt>
<dd>
<p>
Elastic Agent and APM agents are different components:
</p>
<p><span class="strong strong"><strong>Elastic Agent</strong></span> is a single, unified agent that you can deploy to hosts or containers to collect data and send it to the Elastic Stack.
Behind the scenes, Elastic Agent runs APM Server to listen for <code class="literal">apm</code> data.</p>
<p><span class="strong strong"><strong>APM agents</strong></span> are open source libraries written in the same language as your service.
You may only need one, or you might use all of them.
You install them into your service as you would install any other library.
They instrument your code and collect performance data and errors at runtime.
This data is sent to APM Server.</p>
</dd>
<dt>
<span class="term">
Central management/configuration
</span>
</dt>
<dd>
<p>
Fleet central management and APM agent central configuration are two different features
that can be accessed in Kibana:
</p>
<p><span class="strong strong"><strong>Fleet central management</strong></span> serves as the communication channel with your Elastic Agents;
agents check in for the latest updates on a regular basis.</p>
<p><span class="strong strong"><strong>APM agent central configuration</strong></span> allows you to fine-tune your agent configuration from within the APM app.
Changes are automatically propagated to your APM agents, so there’s no need to redeploy your services.</p>
</dd>
</dl>
</div>
<h3><a id="apm-integration-versioning"></a>Package versioning<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/7.12/docs/apm-package/apm-integration.asciidoc">edit</a></h3>
<p>The APM package is versioned separately from the Elastic Stack.
The current version is <code class="literal">0.1.0</code>. In the future, we may align with Elastic Stack versioning.</p>
<h3><a id="apm-integration-learn-more"></a>Learn more<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/7.12/docs/apm-package/apm-integration.asciidoc">edit</a></h3>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="input-apm.html" title="APM input settings"><em>APM input settings</em></a>
</li>
<li class="listitem">
<a class="xref" href="apm-integration-data-streams.html" title="Data streams"><em>Data streams</em></a>
</li>
<li class="listitem">
<a href="/guide/en/fleet/7.12/fleet-overview.html" class="ulink" target="_top">Fleet overview</a>
</li>
</ul>
</div>
</div>
</div>


</div>
<div class="navfooter">
<span class="prev">
<a href="release-notes-6.1.html">« APM Server version 6.1</a>
</span>
<span class="next">
<a href="apm-integration-data-streams.html">Data streams »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>
                <div class="col-xs-12 col-sm-4 col-md-4" id="right_col">
                  <div id="rtpcontainer" style="display: block;">
                    <div class="mktg-promo">
                      <h3>Most Popular</h3>
                      <ul class="icons">
                        <li class="icon-elasticsearch-white"><a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">Get Started with Elasticsearch: Video</a></li>
                        <li class="icon-kibana-white"><a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">Intro to Kibana: Video</a></li>
                        <li class="icon-logstash-white"><a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">ELK for Logs & Metrics: Video</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";
	var localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}';
</script>
<script src="/static/js/swiftype_app_search.umd.min.js"></script>
<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
