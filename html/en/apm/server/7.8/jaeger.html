<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Jaeger integration | APM Server Reference [7.8] | Elastic</title>
<link rel="home" href="index.html" title="APM Server Reference [7.8]"/>
<link rel="up" href="howto-guides.html" title="How-to guides"/>
<link rel="prev" href="ilm.html" title="Custom index lifecycle management with APM Server"/>
<link rel="next" href="storage-management.html" title="Storage Management"/>
<meta name="DC.type" content="Learn/Docs/APM Server/Reference/7.8"/>
<meta name="DC.subject" content="APM"/>
<meta name="DC.identifier" content="7.8"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <!--© 2015-2022 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!--BEGIN QUALTRICS WEBSITE FEEDBACK SNIPPET-->
    <script type='text/javascript'>
      (function(){var g=function(e,h,f,g){
      this.get=function(a){for(var a=a+"=",c=document.cookie.split(";"),b=0,e=c.length;b<e;b++){for(var d=c[b];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return null};
      this.set=function(a,c){var b="",b=new Date;b.setTime(b.getTime()+6048E5);b="; expires="+b.toGMTString();document.cookie=a+"="+c+b+"; path=/; "};
      this.check=function(){var a=this.get(f);if(a)a=a.split(":");else if(100!=e)"v"==h&&(e=Math.random()>=e/100?0:100),a=[h,e,0],this.set(f,a.join(":"));else return!0;var c=a[1];if(100==c)return!0;switch(a[0]){case "v":return!1;case "r":return c=a[2]%Math.floor(100/c),a[2]++,this.set(f,a.join(":")),!c}return!0};
      this.go=function(){if(this.check()){var a=document.createElement("script");a.type="text/javascript";a.src=g;document.body&&document.body.appendChild(a)}};
      this.start=function(){var a=this;window.addEventListener?window.addEventListener("load",function(){a.go()},!1):window.attachEvent&&window.attachEvent("onload",function(){a.go()})}};
      try{(new g(100,"r","QSI_S_ZN_emkP0oSe9Qrn7kF","https://znemkp0ose9qrn7kf-elastic.siteintercept.qualtrics.com/WRSiteInterceptEngine/?Q_ZID=ZN_emkP0oSe9Qrn7kF")).start()}catch(i){}})();
    </script><div id='ZN_emkP0oSe9Qrn7kF'><!--DO NOT REMOVE-CONTENTS PLACED HERE--></div>
    <!--END WEBSITE FEEDBACK SNIPPET-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  <div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="index.html">APM Server Reference [7.8]</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="howto-guides.html">How-to guides</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="ilm.html">« Custom index lifecycle management with APM Server</a>
</span>
<span class="next">
<a href="storage-management.html">Storage Management »</a>
</span>
</div>
<div class="chapter">
<div class="titlepage"><div><div>
<h2 class="title"><a id="jaeger"></a>Jaeger integration<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/apm-server/edit/7.8/docs/jaeger-support.asciidoc">edit</a></h2>
</div></div></div>

<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This feature is experimental and may be changed in a future release. It is not yet available on Elastic Cloud. For feature status on Elastic Cloud, see <a href="https://github.com/elastic/apm/issues/212" class="ulink" target="_top">#212</a>.</p>
</div>
</div>
<p>Elastic APM integrates with <a href="https://www.jaegertracing.io/" class="ulink" target="_top">Jaeger</a>, an open-source, distributed tracing system.
This integration allows users with an existing Jaeger setup to switch from the default Jaeger backend,
to ingesting data with Elastic&#8217;s APM Server, storing data in Elasticsearch, and visualizing traces in the APM app.
Best of all, this can be done without any instrumentation changes in your application code.</p>
<h4><a id="jaeger-get-started"></a>Get started<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/apm-server/edit/7.8/docs/jaeger-support.asciidoc">edit</a></h4>
<p>Connecting your preexisting Jaeger setup to Elastic APM is easy!
Configure APM Server to receive Jaeger data,
set up sampling, and configure your Jaeger Agents or Jaeger Clients to start sending spans to APM Server.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="jaeger.html#jaeger-configure-apm-server" title="Configure APM Server">Configure APM Server</a>
</li>
<li class="listitem">
<a class="xref" href="jaeger.html#jaeger-configure-sampling" title="Configure Sampling">Configure Sampling</a>
</li>
<li class="listitem">
<a class="xref" href="jaeger.html#jaeger-configure-agent-client" title="Configure Jaeger communication">Configure Jaeger communication</a>
</li>
<li class="listitem">
<a class="xref" href="jaeger.html#jaeger-configure-start" title="Start sending span data">Start sending span data</a>
</li>
</ul>
</div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>There are important <a class="xref" href="jaeger-reference.html#jaeger-caveats" title="Caveats">Caveats</a> to understand about this integration.</p>
</div>
</div>
<h4><a id="jaeger-configure-apm-server"></a>Configure APM Server<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/apm-server/edit/7.8/docs/jaeger-support.asciidoc">edit</a></h4>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Enable the correct jaeger endpoint in the <code class="literal">apm-server.yml</code> configuration file.</p>
<p>In a typical Jaeger deployment, Clients send spans to Agents, who forward them to Collectors.
If this matches your architecture, enable the gRPC endpoint by setting
<code class="literal">apm-server.jaeger.grpc.enabled</code> to <code class="literal">true</code>.</p>
<p>Alternatively, if you&#8217;ve configured your Clients to send spans directly to Collectors (bypassing Jaeger Agents),
enable the HTTP endpoint by setting <code class="literal">apm-server.jaeger.http.enabled</code> to <code class="literal">true</code>.</p>
</li>
<li class="listitem">
<p>Configure the host and port that APM Server listens on.</p>
<p>Based on the endpoint enabled in the previous step, configure the relevant host and port:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">apm-server.jaeger.grpc.host</code> defaults to <code class="literal">localhost:14250</code>.
</li>
<li class="listitem">
<code class="literal">apm-server.jaeger.http.host</code> defaults to <code class="literal">localhost:14268</code>.
</li>
</ul>
</div>
</li>
</ol>
</div>
<h4><a id="jaeger-configure-sampling"></a>Configure Sampling<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/apm-server/edit/7.8/docs/jaeger-support.asciidoc">edit</a></h4>
<p>The gRPC endpoint supports probabilistic sampling, which can be used to reduce the amount of data that your agents collect and send.
Probabilistic sampling makes a random sampling decision based on the configured sampling value.
For example, a value of <code class="literal">.2</code> means that 20% of traces will be sampled.</p>
<p>APM Server automatically enables the sampling endpoint when <code class="literal">grpc.enabled</code> is set to <code class="literal">true</code>.
There are two different ways to configure the sampling rate of your Jaeger Agents:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="jaeger.html#jaeger-configure-sampling-central" title="Central sampling">Centrally</a>, with APM Agent configuration (default).
</li>
<li class="listitem">
<a class="xref" href="jaeger.html#jaeger-configure-sampling-local" title="Local sampling">Locally</a>, in each Jaeger client.
</li>
</ul>
</div>
<h5><a id="jaeger-configure-sampling-central"></a>Central sampling<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/apm-server/edit/7.8/docs/jaeger-support.asciidoc">edit</a></h5>
<p>Central sampling, with APM Agent configuration,
requires the <a class="xref" href="setup-kibana-endpoint.html" title="Configure the Kibana endpoint">Kibana endpoint</a> to be enabled.
This allows Jaeger clients to poll APM Server for the sampling rate.
To enable the kibana endpoint, set <a class="xref" href="setup-kibana-endpoint.html#kibana-enabled" title="apm-server.kibana.enabled"><code class="literal">apm-server.kibana.enabled</code></a> to <code class="literal">true</code>, and point <a class="xref" href="setup-kibana-endpoint.html#kibana-host" title="apm-server.kibana.host"><code class="literal">apm-server.kibana.host</code></a> at the Kibana host that APM Server will communicate with.</p>
<p>The default sampling ratio, as well as per-service sampling rates,
can then be configured via the <a href="/guide/en/kibana/7.8/agent-configuration.html" class="ulink" target="_top">Agent configuration</a> page in the APM app.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>If a sampling rate smaller than <code class="literal">1.0</code> (100%) is configured,
transactions per minute will be incorrectly calculated in the APM app.
This is because Elastic APM data model is fundamentally different from the Jaeger data model.
In the Elastic ecosystem, sampling only impacts spans; transactions are always sampled at 100%.
The Jaeger data structure, however, does not have the concept of transactions.
Because of this, sampling decisions will apply to both transactions and spans.</p>
</div>
</div>
<h5><a id="jaeger-configure-sampling-local"></a>Local sampling<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/apm-server/edit/7.8/docs/jaeger-support.asciidoc">edit</a></h5>
<p>If you don&#8217;t have access to the APM app,
you&#8217;ll need to change the Jaeger Client&#8217;s <code class="literal">sampler.type</code> and <code class="literal">sampler.param</code>,
enabling you to set the sampling configuration locally in each Client.
See the official <a href="https://www.jaegertracing.io/docs/1.17/sampling/" class="ulink" target="_top">Jaeger sampling documentation</a>
for more information.</p>
<h4><a id="jaeger-configure-agent-client"></a>Configure Jaeger communication<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/apm-server/edit/7.8/docs/jaeger-support.asciidoc">edit</a></h4>
<h5><a id="jaeger-configure-grpc"></a>Jaeger Agent communication with APM Server (gRPC)<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/apm-server/edit/7.8/docs/jaeger-support.asciidoc">edit</a></h5>
<p>As of this writing, the Jaeger Agent binary offers the <code class="literal">--reporter.grpc.host-port</code> CLI flag,
which can be used to set a static list of collectors for the Jaeger Agent to connect to.
The <code class="literal">host:port</code> set here should correspond with the value set in <code class="literal">apm-server.jaeger.grpc.host</code>.</p>
<p><span class="strong strong"><strong>Optional token-based authorization</strong></span>*</p>
<p>A <a class="xref" href="secret-token.html" title="Secret token">secret token</a> or <a class="xref" href="api-key.html" title="API keys">API key</a> can be used to ensure only authorized
Jaeger Agents can send data to the APM Server.
Authorization is off by default, but can be enabled by setting a value in <code class="literal">apm-server.jaeger.grpc.auth_tag</code>.
When enabled, APM Server looks for a <em>Process tag</em> in each incoming event,
and uses it to authorize the Jaeger Agent against the configured <code class="literal">auth_tag</code> and secret token or API key.
Auth tags will be removed from events after being verified.</p>
<p>Here&#8217;s an example that sets the <code class="literal">auth_tag</code> and <code class="literal">secret_token</code> in APM Server:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">apm-server.jaeger.grpc.enabled=true
apm-server.jaeger.grpc.auth_tag=authorization
apm-server.secret_token=qwerty1234</pre>
</div>
<p>To authorize Jaeger Agent communication, use the <code class="literal">--agent.tags</code> CLI flag to pass the corresponding Process tag to the APM Server:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">--agent.tags "authorization=Bearer qwerty1234"</pre>
</div>
<div class="console_widget" data-snippet="snippets/1.console"></div>
<p>See the <a href="https://www.jaegertracing.io/docs/1.16/cli/" class="ulink" target="_top">Jaeger CLI flags documentation</a> for more information.</p>
<h5><a id="jaeger-configure-http"></a>Jaeger Client communication with APM Server (HTTP)<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/apm-server/edit/7.8/docs/jaeger-support.asciidoc">edit</a></h5>
<p>If you&#8217;re using an officially supported Jaeger Client library and want to connect directly to APM Server,
you need to update the <code class="literal">JAEGER_ENDPOINT</code> configuration property.
This is the HTTP endpoint the Client will send spans to.
The <code class="literal">host:port</code> set here should correspond to the value set in <code class="literal">apm-server.jaeger.http.host</code>.</p>
<p>See the relevant supported Jaeger library for more information.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://github.com/jaegertracing/jaeger-client-go" class="ulink" target="_top">Go</a>
</li>
<li class="listitem">
<a href="https://github.com/jaegertracing/jaeger-client-java" class="ulink" target="_top">Java</a>
</li>
<li class="listitem">
<a href="https://github.com/jaegertracing/jaeger-client-node" class="ulink" target="_top">Node.js</a>
</li>
<li class="listitem">
<a href="https://github.com/jaegertracing/jaeger-client-python" class="ulink" target="_top">Python</a>
</li>
<li class="listitem">
<a href="https://github.com/jaegertracing/jaeger-client-cpp" class="ulink" target="_top">C++</a>
</li>
<li class="listitem">
<a href="https://github.com/jaegertracing/jaeger-client-csharp" class="ulink" target="_top">C#</a>
</li>
</ul>
</div>
<h4><a id="jaeger-configure-start"></a>Start sending span data<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/apm-server/edit/7.8/docs/jaeger-support.asciidoc">edit</a></h4>
<p>Data sent from Jaeger Agents or Clients to APM Server should now be visible in the APM app!</p>
</div>
<div class="navfooter">
<span class="prev">
<a href="ilm.html">« Custom index lifecycle management with APM Server</a>
</span>
<span class="next">
<a href="storage-management.html">Storage Management »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
