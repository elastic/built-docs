<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Web crawler reference | Elastic App Search Documentation [8.7] | Elastic</title>
<link rel="home" href="index.html" title="Elastic App Search Documentation [8.7]"/>
<link rel="up" href="guides.html" title="Guides"/>
<link rel="prev" href="web-crawler-faq.html" title="Web crawler FAQ"/>
<link rel="next" href="web-crawler-events-logs-reference.html" title="Web crawler events logs reference"/>
<meta name="DC.type" content="Learn/Docs/App Search/Guide/8.7"/>
<meta name="DC.subject" content="App Search"/>
<meta name="DC.identifier" content="8.7"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <!--© 2015-2022 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <!--BEGIN QUALTRICS WEBSITE FEEDBACK SNIPPET-->
    <script type='text/javascript'>
      (function(){var g=function(e,h,f,g){
      this.get=function(a){for(var a=a+"=",c=document.cookie.split(";"),b=0,e=c.length;b<e;b++){for(var d=c[b];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return null};
      this.set=function(a,c){var b="",b=new Date;b.setTime(b.getTime()+6048E5);b="; expires="+b.toGMTString();document.cookie=a+"="+c+b+"; path=/; "};
      this.check=function(){var a=this.get(f);if(a)a=a.split(":");else if(100!=e)"v"==h&&(e=Math.random()>=e/100?0:100),a=[h,e,0],this.set(f,a.join(":"));else return!0;var c=a[1];if(100==c)return!0;switch(a[0]){case "v":return!1;case "r":return c=a[2]%Math.floor(100/c),a[2]++,this.set(f,a.join(":")),!c}return!0};
      this.go=function(){if(this.check()){var a=document.createElement("script");a.type="text/javascript";a.src=g;document.body&&document.body.appendChild(a)}};
      this.start=function(){var a=this;window.addEventListener?window.addEventListener("load",function(){a.go()},!1):window.attachEvent&&window.attachEvent("onload",function(){a.go()})}};
      try{(new g(100,"r","QSI_S_ZN_emkP0oSe9Qrn7kF","https://znemkp0ose9qrn7kf-elastic.siteintercept.qualtrics.com/WRSiteInterceptEngine/?Q_ZID=ZN_emkP0oSe9Qrn7kF")).start()}catch(i){}})();
    </script><div id='ZN_emkP0oSe9Qrn7kF'><!--DO NOT REMOVE-CONTENTS PLACED HERE--></div>
    <!--END WEBSITE FEEDBACK SNIPPET-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  <div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic App Search Documentation [8.7]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="guides.html">Guides</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="web-crawler-faq.html">« Web crawler FAQ</a>
</span>
<span class="next">
<a href="web-crawler-events-logs-reference.html">Web crawler events logs reference »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="web-crawler-reference"></a>Web crawler reference<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.7/app-search-docs/guides/web-crawler-reference.asciidoc">edit</a></h2>
</div></div></div>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>Looking for the <span class="strong strong"><strong>Elastic web crawler</strong></span>?
See the <a href="/guide/en/enterprise-search/8.7/crawler.html" class="ulink" target="_top">Elastic web crawler documentation</a>.</p>
</div>
</div>
<p>See <a class="xref" href="web-crawler.html" title="App Search web crawler">App Search web crawler</a> for a guided introduction to the App Search web crawler.</p>
<p>Refer to the following sections for terms, definitions, tables, and other detailed information.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="web-crawler-reference.html#web-crawler-reference-crawl" title="Crawl">Crawl</a>
</li>
<li class="listitem">
<p><a class="xref" href="web-crawler-reference.html#web-crawler-reference-content-discovery" title="Content discovery">Content discovery</a></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="web-crawler-reference.html#web-crawler-reference-crawl-state" title="Crawl state">Crawl state</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p><a class="xref" href="web-crawler-reference.html#web-crawler-reference-content-extraction-and-indexing" title="Content extraction and indexing">Content extraction and indexing</a></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="web-crawler-reference.html#web-crawler-reference-binary-content-extraction" title="Binary content extraction">Binary content extraction</a>
</li>
<li class="listitem">
<a class="xref" href="web-crawler-reference.html#web-crawler-reference-content-deduplication" title="Duplicate document handling">Duplicate document handling</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<a class="xref" href="web-crawler-reference.html#web-crawler-reference-content-inclusion-and-exclusion" title="Content inclusion and exclusion">Content inclusion and exclusion</a>
</li>
<li class="listitem">
<a class="xref" href="web-crawler-reference.html#web-crawler-reference-content-deletion" title="Content deletion">Content deletion</a>
</li>
<li class="listitem">
<a class="xref" href="web-crawler-reference.html#web-crawler-reference-domain" title="Domain">Domain</a>
</li>
<li class="listitem">
<a class="xref" href="web-crawler-reference.html#web-crawler-reference-entry-point" title="Entry point">Entry point</a>
</li>
<li class="listitem">
<p><a class="xref" href="web-crawler-reference.html#web-crawler-reference-sitemap" title="Sitemap">Sitemap</a></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="web-crawler-reference.html#web-crawler-reference-sitemap-discovery-management" title="Sitemap discovery and management">Sitemap discovery and management</a>
</li>
<li class="listitem">
<a class="xref" href="web-crawler-reference.html#web-crawler-reference-sitemap-format" title="Sitemap format and technical specification">Sitemap format and technical specification</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p><a class="xref" href="web-crawler-reference.html#web-crawler-reference-crawl-rule" title="Crawl rule">Crawl rule</a></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="web-crawler-reference.html#web-crawler-reference-crawl-rule-rules" title="Crawl rule logic (rules)">Crawl rule logic (rules)</a>
</li>
<li class="listitem">
<a class="xref" href="web-crawler-reference.html#web-crawler-reference-crawl-rule-matching" title="Crawl rule matching">Crawl rule matching</a>
</li>
<li class="listitem">
<a class="xref" href="web-crawler-reference.html#web-crawler-reference-crawl-rule-order" title="Crawl rule order">Crawl rule order</a>
</li>
<li class="listitem">
<a class="xref" href="web-crawler-reference.html#web-crawler-reference-crawl-rule-restricting-paths" title="Restricting paths using crawl rules">Restricting paths using crawl rules</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p><a class="xref" href="web-crawler-reference.html#web-crawler-reference-robots-txt-file" title="Robots.txt file">Robots.txt file</a></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="web-crawler-reference.html#web-crawler-reference-robots-txt-file-discovery-management" title="Robots.txt file discovery and management">Robots.txt file discovery and management</a>
</li>
<li class="listitem">
<a class="xref" href="web-crawler-reference.html#web-crawler-reference-robots-txt-file-format" title="Robots.txt file format and technical specification">Robots.txt file format and technical specification</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<a class="xref" href="web-crawler-reference.html#web-crawler-reference-canonical-url-link-tag" title="Canonical URL link tag">Canonical URL link tag</a>
</li>
<li class="listitem">
<a class="xref" href="web-crawler-reference.html#web-crawler-reference-robots-meta-tags" title="Robots meta tags">Robots meta tags</a>
</li>
<li class="listitem">
<a class="xref" href="web-crawler-reference.html#web-crawler-reference-meta-tags-content-extraction" title="Meta tags and data attributes to extract custom fields">Meta tags and data attributes to extract custom fields</a>
</li>
<li class="listitem">
<a class="xref" href="web-crawler-reference.html#web-crawler-reference-nofollow-link" title="Nofollow link">Nofollow link</a>
</li>
<li class="listitem">
<a class="xref" href="web-crawler-reference.html#web-crawler-reference-crawl-status" title="Crawl status">Crawl status</a>
</li>
<li class="listitem">
<a class="xref" href="web-crawler-reference.html#web-crawler-reference-partial-crawl" title="Partial crawl">Partial crawl</a>
</li>
<li class="listitem">
<a class="xref" href="web-crawler-reference.html#web-crawler-reference-process-crawl" title="Process crawl">Process crawl</a>
</li>
<li class="listitem">
<a class="xref" href="web-crawler-reference.html#web-crawler-reference-http-authentication" title="HTTP authentication">HTTP authentication</a>
</li>
<li class="listitem">
<a class="xref" href="web-crawler-reference.html#web-crawler-reference-http-proxy" title="HTTP proxy">HTTP proxy</a>
</li>
<li class="listitem">
<p><a class="xref" href="web-crawler-reference.html#web-crawler-reference-http-response-status-codes" title="HTTP response status codes handling">HTTP response status codes handling</a></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="web-crawler-reference.html#web-crawler-reference-http-response-status-codes-html" title="HTML response code handling">HTML response code handling</a>
</li>
<li class="listitem">
<a class="xref" href="web-crawler-reference.html#web-crawler-reference-http-response-status-codes-robots-txt" title="Robots.txt file response code handling">Robots.txt file response code handling</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<a class="xref" href="web-crawler-reference.html#web-crawler-reference-web-crawler-schema" title="Web crawler schema">Web crawler schema</a>
</li>
<li class="listitem">
<a class="xref" href="web-crawler-reference.html#web-crawler-reference-web-crawler-events-logs" title="Web crawler events logs">Web crawler events logs</a>
</li>
<li class="listitem">
<a class="xref" href="web-crawler-reference.html#web-crawler-reference-web-crawler-configuration-settings" title="Web crawler configuration settings">Web crawler configuration settings</a>
</li>
</ul>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="web-crawler-reference-crawl"></a>Crawl<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.7/app-search-docs/guides/web-crawler-reference.asciidoc">edit</a></h3>
</div></div></div>
<p>A <em>crawl</em> is a process, associated with an engine, by which the web crawler <a class="xref" href="web-crawler-reference.html#web-crawler-reference-content-discovery" title="Content discovery">discovers web content</a>, and <a class="xref" href="web-crawler-reference.html#web-crawler-reference-content-extraction-and-indexing" title="Content extraction and indexing">extracts and indexes that content</a> into the engine as search documents.</p>
<p>During a crawl, the web crawler stays within user-defined <a class="xref" href="web-crawler-reference.html#web-crawler-reference-domain" title="Domain">domains</a>, starting from specific <a class="xref" href="web-crawler-reference.html#web-crawler-reference-entry-point" title="Entry point">entry points</a>, and it discovers additional content according to <a class="xref" href="web-crawler-reference.html#web-crawler-reference-crawl-rule" title="Crawl rule">crawl rules</a>.
Operators and administrators <a class="xref" href="crawl-web-content.html#crawl-web-content-manage-crawl" title="Manage crawl">manage crawls</a> through the App Search dashboard.</p>
<p>Each crawl also respects instructions within <a class="xref" href="web-crawler-reference.html#web-crawler-reference-robots-txt-file" title="Robots.txt file">robots.txt files</a> and <a class="xref" href="web-crawler-reference.html#web-crawler-reference-sitemap" title="Sitemap">sitemaps</a>, and instructions embedded within HTML files using <a class="xref" href="web-crawler-reference.html#web-crawler-reference-canonical-url-link-tag" title="Canonical URL link tag">canonical link tags</a>, <a class="xref" href="web-crawler-reference.html#web-crawler-reference-robots-meta-tags" title="Robots meta tags">robots meta tags</a>, and <a class="xref" href="web-crawler-reference.html#web-crawler-reference-nofollow-link" title="Nofollow link">nofollow links</a>.</p>
<p>Operators can <a class="xref" href="crawl-web-content.html#crawl-web-content-monitor-crawl" title="Monitor crawl">monitor crawls</a> using the ID and status of each crawl, and using the web crawler events logs.</p>
<p>Each engine may run one active crawl at a time, but multiple engines can run crawls concurrently.</p>
<p>By default, each re-crawl is a full crawl.
 <a class="xref" href="web-crawler-reference.html#web-crawler-reference-partial-crawl" title="Partial crawl">Partial crawls</a> may be requested through the <a class="xref" href="web-crawler-api-reference.html#web-crawler-apis-post-crawler-partial-crawl-requests" title="Create a new partial crawl request">API</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="web-crawler-reference-content-discovery"></a>Content discovery<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.7/app-search-docs/guides/web-crawler-reference.asciidoc">edit</a></h3>
</div></div></div>
<p>To begin each crawl, the web crawler populates a <em>crawl queue</em> with the <a class="xref" href="web-crawler-reference.html#web-crawler-reference-entry-point" title="Entry point">entry points</a> for the crawl and the URLs provided by any <a class="xref" href="web-crawler-reference.html#web-crawler-reference-sitemap" title="Sitemap">sitemaps</a>.
It then begins fetching and parsing each page in the queue.
The crawler handles each page according to its <a class="xref" href="web-crawler-reference.html#web-crawler-reference-http-response-status-codes" title="HTTP response status codes handling">HTTP response status code</a>.</p>
<p>As the web crawler discovers additional URLs, it uses the <a class="xref" href="web-crawler-reference.html#web-crawler-reference-crawl-rule" title="Crawl rule">crawl rules</a> from the crawl configuration, the directives from any <a class="xref" href="web-crawler-reference.html#web-crawler-reference-robots-txt-file" title="Robots.txt file">robots.txt files</a>, and instructions embedded within the content to determine which of those URLs it is allowed to crawl.
The crawler adds the allowed URLs to the crawl queue.</p>
<p>If a page is not linked from other pages, the web crawler will not discover it.
Refer to the web of pages in the following image.
The crawler will not discover the page outlined in red, unless an admin adds its URL as an entry point for the domain or includes the URL in a sitemap:</p>
<div class="imageblock">
<div class="content">
<img src="images/app-search/web-of-content.png" alt="web of content">
</div>
</div>
<p>The web crawler continues fetching and adding to the crawl queue until the URL queue is empty, the crawler hits a resource limit, or the crawl fails unexpectedly.</p>
<p>The crawler logs detailed events while it crawls, which allow monitoring and auditing of the content discovery process.</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="web-crawler-reference-crawl-state"></a>Crawl state<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.7/app-search-docs/guides/web-crawler-reference.asciidoc">edit</a></h4>
</div></div></div>
<p>Each crawl persists its state to Elasticsearch, allowing the crawl to resume after a restart or shutdown.</p>
<p>The persisted data includes:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<em>Crawl URL queue:</em> A list of all outstanding URLs the crawler needs to visit before the end of the crawl.
</li>
<li class="listitem">
<em>Seen URLs list:</em> A list of all unique URLs the crawler has seen during the crawl.
The crawler uses this list to avoid visiting the same page twice.
</li>
</ul>
</div>
<p>Crawl state indexes are automatically removed at the end of each crawl.
The name of each of these indexes includes the ID of the corresponding crawl request.
You can use this information to clean up disk space if the automated cleanup process fails for any reason.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>Depending on the size of your site, crawl state indexes may become large.
Each page you have will generate a record in at least one of those indexes, meaning sites with millions of pages will generate indexes with millions of records.</p>
<p>Monitor disk space on your Elasticsearch clusters, and ensure your deployment has enough disk space to avoid stability issues.</p>
</div>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="web-crawler-reference-content-extraction-and-indexing"></a>Content extraction and indexing<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.7/app-search-docs/guides/web-crawler-reference.asciidoc">edit</a></h3>
</div></div></div>
<p><em>Content extraction</em> is the process where the web crawler transforms a web (HTML or binary) document into a search document.
And <em>indexing</em> is the process where the crawler puts the search document into an App Search engine for searching.</p>
<p>During content extraction, the web crawler <a class="xref" href="web-crawler-reference.html#web-crawler-reference-content-deduplication" title="Duplicate document handling">handles duplicate documents</a>.
The crawler indexes duplicate web documents as a single search document.</p>
<p>The web crawler extracts each web document into a predefined <a class="xref" href="web-crawler-reference.html#web-crawler-reference-web-crawler-schema" title="Web crawler schema">schema</a> before indexing it as a search document.
Custom field extraction is supported via <a class="xref" href="web-crawler-reference.html#web-crawler-reference-meta-tags-content-extraction" title="Meta tags and data attributes to extract custom fields">meta tags and attributes</a>.</p>
<p>During a crawl, the web crawler uses <a class="xref" href="web-crawler-reference.html#web-crawler-reference-http-response-status-codes" title="HTTP response status codes handling">HTTP response status codes</a> and <a class="xref" href="web-crawler-reference.html#web-crawler-reference-robots-meta-tags" title="Robots meta tags">robots meta tags</a> to determine which documents it is allowed to index.</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="web-crawler-reference-binary-content-extraction"></a>Binary content extraction<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.7/app-search-docs/guides/web-crawler-reference.asciidoc">edit</a></h4>
</div></div></div>
<p>Since 8.3.0, the web crawler can extract content from downloadable binary files, such as PDF and DOCX files.
To use this feature:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Enable binary content extraction with the configuration: <code class="literal">crawler.content_extraction.enabled: true</code>.
</li>
<li class="listitem">
<p>Select which MIME types should have their contents extracted. For example: <code class="literal">crawler.content_extraction.mime_types: ["application/pdf", "application/msword"]</code>.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
The MIME type is determined by the HTTP response&#8217;s <code class="literal">Content-Type</code> header when downloading a given file.
</li>
<li class="listitem">
While intended primarily for PDF and Microsoft Office formats, you can use any of the supported formats documented by <a href="https://tika.apache.org" class="ulink" target="_blank" rel="noopener">Apache Tika</a>.
</li>
<li class="listitem">
No default <code class="literal">mime_types</code> are defined.
You must configure at least one MIME type in order to extract non-HTML content.
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The ingest attachment processor does not support compressed files, e.g., an archive file containing a set of PDFs.
Expand the archive file and make individual uncompressed files available for the web crawler to process.</p>
</div>
</div>
<p>Enterprise Search uses an <a href="/guide/en/elasticsearch/reference/8.7/ingest.html" class="ulink" target="_blank" rel="noopener">Elasticsearch ingest pipeline</a>
to power the web crawler&#8217;s binary content extraction.
This pipeline, named <code class="literal">app_search_crawler</code>, is automatically created when Enterprise Search first starts, if Enterprise Search is configured to enable binary content extraction.</p>
<p>You can <a href="/guide/en/elasticsearch/reference/8.7/ingest.html#create-manage-ingest-pipelines" class="ulink" target="_blank" rel="noopener">view and update</a> this pipeline in Kibana or with Elasticsearch APIs.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>If you make changes to the default <code class="literal">app_search_crawler</code> ingest pipeline, these will not be overwritten when you upgrade Enterprise Search.
Therefore, we recommend comparing the default <code class="literal">app_search_crawler</code> pipeline that comes with the newer version — to determine if you need to
incorporate the latest changes into your customized pipeline.</p>
</div>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="web-crawler-reference-content-deduplication"></a>Duplicate document handling<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.7/app-search-docs/guides/web-crawler-reference.asciidoc">edit</a></h3>
</div></div></div>
<p>By default, the web crawler identifies groups of duplicate <em>web</em> documents and stores each group as a single <em>App Search</em> document within your engine.
Within the App Search document, the fields <code class="literal">url</code> and <code class="literal">additional_urls</code> represent all the URLs where the web crawler discovered the document&#8217;s content (or a sample of URLs if more than <code class="literal">100</code>).
The <code class="literal">url</code> field represents the <em>canonical URL</em>, which you can explicitly manage using <a class="xref" href="web-crawler-reference.html#web-crawler-reference-canonical-url-link-tag" title="Canonical URL link tag">canonical URL link tags</a>.</p>
<p>The crawler identifies duplicate content intelligently, ignoring insignificant differences such as navigation, whitespace, style, and scripts.
More specifically, the crawler combines the values of specific fields, and it <em>hashes</em> the result to create a unique "fingerprint" to represent the content of the web document.</p>
<p>The web crawler then checks your engine for an existing document with the same content hash.
If it doesn&#8217;t find one, it saves a new document to the engine.
If it <em>does</em> exist, the crawler updates the existing document instead of saving a new one.
The crawler adds to the document the additional URL at which the content was discovered.</p>
<p>You can manage which fields the web crawler uses to create the content hash.
You can also disable this feature and <em>allow</em> duplicate documents.</p>
<p>Manage these settings for each domain within the web crawler UI.
See <a class="xref" href="crawl-web-content.html#crawl-web-content-manage-duplicate-documents" title="Manage duplicate document handling">Manage duplicate document handling</a>.</p>
<p>Set the <em>default</em> fields for <em>all</em> domains using the following <a class="xref" href="web-crawler-reference.html#web-crawler-reference-web-crawler-configuration-settings" title="Web crawler configuration settings">configuration setting</a>: <code class="literal">crawler.extraction.default_deduplication_fields</code>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="web-crawler-reference-content-inclusion-and-exclusion"></a>Content inclusion and exclusion<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.7/app-search-docs/guides/web-crawler-reference.asciidoc">edit</a></h3>
</div></div></div>
<p>Inject HTML <code class="literal">data</code> attributes into your web pages to instruct the web crawler to include or exclude particular sections from extracted content. For example, use this feature to exclude navigation and footer content when crawling, or to exclude sections of content only intended for screen readers.</p>
<p>For all pages that contain HTML tags with a <code class="literal">data-elastic-include</code> attribute, the crawler will only index content within those tags.</p>
<p>For all pages that contain HTML tags with a <code class="literal">data-elastic-exclude</code> attribute, the crawler will skip those tags from content extraction. You can nest <code class="literal">data-elastic-include</code> and <code class="literal">data-elastic-exclude</code> tags, too.</p>
<p>The web crawler will still crawl any links that appear inside excluded sections as long as the configured crawl rules allow them.</p>
<p>A simple content exclusion rule example:</p>
<div class="pre_wrapper lang-html">
<pre class="programlisting prettyprint lang-html">&lt;body&gt;
  &lt;p&gt;This is your page content, which will be indexed by the App Search web crawler.
  &lt;div data-elastic-exclude&gt;Content in this div will be excluded from the search index&lt;/div&gt;
&lt;/body&gt;</pre>
</div>
<p>In this more complex example with nested exclusion and inclusion rules, the web crawler will only extract "test1 test3 test5 test7" from the page.</p>
<div class="pre_wrapper lang-html">
<pre class="programlisting prettyprint lang-html">&lt;body&gt;
  test1
  &lt;div data-elastic-exclude&gt;
    test2
    &lt;p data-elastic-include&gt;
      test3
      &lt;span data-elastic-exclude&gt;
        test4
        &lt;span data-elastic-include&gt;test5&lt;/span&gt;
      &lt;/span&gt;
    &lt;/p&gt;
    test6
  &lt;/div&gt;
  test7
&lt;/body&gt;</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="web-crawler-reference-content-deletion"></a>Content deletion<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.7/app-search-docs/guides/web-crawler-reference.asciidoc">edit</a></h3>
</div></div></div>
<p>The web crawler must also delete documents from an engine to keep its documents in sync with the corresponding web content.</p>
<p>During a crawl, the web crawler uses <a class="xref" href="web-crawler-reference.html#web-crawler-reference-http-response-status-codes" title="HTTP response status codes handling">HTTP response status codes</a> to determine which documents to delete.
However, this process cannot delete stale documents in the engine that are no longer linked to on the web.</p>
<p>Therefore, at the conclusion of each crawl, the web crawler begins an additional "purge" crawl, which fetches URLs that exist in the engine, but have not been seen on the web during recent crawls.
The crawler deletes from the engine all documents that respond with <code class="literal">4xx</code> and <code class="literal">3xx</code> responses during the phase.</p>
<p>You can purge documents on demand by using a <a class="xref" href="web-crawler-reference.html#web-crawler-reference-process-crawl" title="Process crawl">process crawl</a>.
A process crawl removes from your engine all documents that are no longer allowed by your <a class="xref" href="web-crawler-reference.html#web-crawler-reference-crawl-rule" title="Crawl rule">crawl rules</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="web-crawler-reference-domain"></a>Domain<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.7/app-search-docs/guides/web-crawler-reference.asciidoc">edit</a></h3>
</div></div></div>
<p>A <em>domain</em> is a website or other internet realm that is the target of a <a class="xref" href="web-crawler-reference.html#web-crawler-reference-crawl" title="Crawl">crawl</a>.
Each domain belongs to a crawl, and each crawl has one or more domains.</p>
<p>See <a class="xref" href="crawl-web-content.html#crawl-web-content-manage-domains" title="Manage domains">Manage domains</a> to manage domains for a crawl.</p>
<p>A crawl always stays <em>within</em> its domains when <a class="xref" href="web-crawler-reference.html#web-crawler-reference-content-discovery" title="Content discovery">discovering content</a>.
It cannot discover and index content outside of its domains.</p>
<p>Each domain has a <em>domain URL</em> that identifies the domain using a protocol and hostname.
The domain URL must not include a path.</p>
<p>Each unique combination of protocol and hostname is a separate domain.
Each of the following is its own domain:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">http://example.com</code>
</li>
<li class="listitem">
<code class="literal">https://example.com</code>
</li>
<li class="listitem">
<code class="literal">http://www.example.com</code>
</li>
<li class="listitem">
<code class="literal">https://www.example.com</code>
</li>
<li class="listitem">
<code class="literal">http://shop.example.com</code>
</li>
<li class="listitem">
<code class="literal">https://shop.example.com</code>
</li>
</ul>
</div>
<p>Each domain has:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
One or more <a class="xref" href="web-crawler-reference.html#web-crawler-reference-entry-point" title="Entry point">entry points</a>
</li>
<li class="listitem">
One or more <a class="xref" href="web-crawler-reference.html#web-crawler-reference-crawl-rule" title="Crawl rule">crawl rules</a>
</li>
<li class="listitem">
Zero or one <a class="xref" href="web-crawler-reference.html#web-crawler-reference-robots-txt-file" title="Robots.txt file">robots.txt files</a>
</li>
<li class="listitem">
Zero or more <a class="xref" href="web-crawler-reference.html#web-crawler-reference-sitemap" title="Sitemap">sitemaps</a>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="web-crawler-reference-entry-point"></a>Entry point<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.7/app-search-docs/guides/web-crawler-reference.asciidoc">edit</a></h3>
</div></div></div>
<p>An <em>entry point</em> is a path within a <a class="xref" href="web-crawler-reference.html#web-crawler-reference-domain" title="Domain">domain</a> that serves as a starting point for a crawl.
Each entry point belongs to a domain, and each domain has one or more entry points.</p>
<p>See <a class="xref" href="crawl-web-content.html#crawl-web-content-manage-entry-points" title="Manage entry points">Manage entry points</a> to manage entry points for a domain.</p>
<p>Use entry points to instruct the crawler to fetch URLs it would otherwise not discover.
For example, if you&#8217;d like to index a page that isn&#8217;t linked from other pages, add the page&#8217;s URL as an entry point.</p>
<p>Ensure the entry points for each domain are allowed by the domain&#8217;s <a class="xref" href="web-crawler-reference.html#web-crawler-reference-crawl-rule" title="Crawl rule">crawl rules</a>, and the directives within the domain&#8217;s <a class="xref" href="web-crawler-reference.html#web-crawler-reference-robots-txt-file" title="Robots.txt file">robots.txt file</a>.
The web crawler will not fetch entry points that are disallowed by crawl rules or robots.txt directives.</p>
<p>You can also inform the crawler of URLs using <a class="xref" href="web-crawler-reference.html#web-crawler-reference-sitemap" title="Sitemap">sitemaps</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="web-crawler-reference-sitemap"></a>Sitemap<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.7/app-search-docs/guides/web-crawler-reference.asciidoc">edit</a></h3>
</div></div></div>
<p>A sitemap is an XML file, associated with a <a class="xref" href="web-crawler-reference.html#web-crawler-reference-domain" title="Domain">domain</a>, that informs web crawlers about pages within that domain.
XML elements within the sitemap identify specific URLs that are available for crawling.</p>
<p>These elements are similar to <a class="xref" href="web-crawler-reference.html#web-crawler-reference-entry-point" title="Entry point">entry points</a>.
You can therefore choose to submit URLs to the App Search web crawler using sitemaps, entry points, or a combination of both.</p>
<p>You may prefer using sitemaps over entry points for any of the following reasons:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
You have already been publishing sitemaps for other web crawlers.
</li>
<li class="listitem">
You don&#8217;t have access to the web crawler UI.
</li>
<li class="listitem">
You prefer the sitemap file interface over the web crawler web interface.
</li>
</ul>
</div>
<p>Use sitemaps to inform the web crawler of pages you think are important, or pages that are isolated and not linked from other pages.
However, be aware the web crawler will visit only those pages from the sitemap that are allowed by the domain&#8217;s <a class="xref" href="web-crawler-reference.html#web-crawler-reference-crawl-rule" title="Crawl rule">crawl rules</a> and <a class="xref" href="web-crawler-reference.html#web-crawler-reference-robots-txt-file" title="Robots.txt file">robots.txt file</a> directives.</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="web-crawler-reference-sitemap-discovery-management"></a>Sitemap discovery and management<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.7/app-search-docs/guides/web-crawler-reference.asciidoc">edit</a></h4>
</div></div></div>
<p>To add a sitemap to a domain, you can specify it within a <a class="xref" href="web-crawler-reference.html#web-crawler-reference-robots-txt-file" title="Robots.txt file">robots.txt file</a>.
At the start of each <a class="xref" href="web-crawler-reference.html#web-crawler-reference-crawl" title="Crawl">crawl</a>, the web crawler fetches and processes each domain&#8217;s robots.txt file and each sitemap specified within those robots.txt files.</p>
<p>See <a class="xref" href="crawl-web-content.html#crawl-web-content-manage-sitemaps" title="Manage sitemaps">Manage sitemaps</a> to manage sitemaps for your domains.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="web-crawler-reference-sitemap-format"></a>Sitemap format and technical specification<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.7/app-search-docs/guides/web-crawler-reference.asciidoc">edit</a></h4>
</div></div></div>
<p>The <a href="https://www.sitemaps.org/index.html" class="ulink" target="_blank" rel="noopener">sitemaps standard</a> defines the format and technical specification for sitemaps.
Refer to the standard for the required and optional elements, character escaping, and other technical considerations and examples.</p>
<p>The App Search web crawler does not process optional meta data defined by the standard.
The crawler extracts a list of URLs from each sitemap and ignores all other information.</p>
<p>Ensure each URL within your sitemap matches the exact <a class="xref" href="web-crawler-reference.html#web-crawler-reference-domain" title="Domain">domain</a> (here defined as scheme + host + port) for your site.
Different subdomains (like <code class="literal">www.example.com</code> and <code class="literal">blog.example.com</code>) and different schemes (like <code class="literal">http://example.com</code> and <code class="literal">https://example.com</code>) require separate sitemaps.</p>
<p>The App Search web crawler also supports sitemap index files.
Refer to <a href="https://www.sitemaps.org/protocol.html#index" class="ulink" target="_blank" rel="noopener">Using sitemap index files</a> within the sitemap standard for sitemap index file details and examples.</p>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="web-crawler-reference-crawl-rule"></a>Crawl rule<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.7/app-search-docs/guides/web-crawler-reference.asciidoc">edit</a></h3>
</div></div></div>
<p>A <em>crawl rule</em> is a crawler instruction to <em>allow</em> or <em>disallow</em> specific paths within a <a class="xref" href="web-crawler-reference.html#web-crawler-reference-domain" title="Domain">domain</a>.
Each crawl rule belongs to a domain, and each domain has one or more crawl rules.</p>
<p>See <a class="xref" href="crawl-web-content.html#crawl-web-content-manage-crawl-rules" title="Manage crawl rules">Manage crawl rules</a> to manage crawl rules for a domain.
After modifying your crawl rules, you can re-apply the rules to your existing documents without waiting for a full re-crawl.
See <a class="xref" href="web-crawler-reference.html#web-crawler-reference-process-crawl" title="Process crawl">Process crawl</a>.</p>
<p>During <a class="xref" href="web-crawler-reference.html#web-crawler-reference-content-discovery" title="Content discovery">content discovery</a>, the web crawler discovers new URLs and must determine which it is allowed to follow.
Each URL has a <em>domain</em> (e.g. <code class="literal">https://example.com</code>) and a <em>path</em> (e.g. <code class="literal">/category/clothing</code> or <code class="literal">/c/Credit_Center</code>).</p>
<p>The web crawler looks up the crawl rules for the domain, and applies the path to the crawl rules to determine if the path is <em>allowed</em> or <em>disallowed</em>.
The crawler evaluates the crawl rules in order.
The <em>first</em> matching crawl rule determines the policy for the newly discovered URL.</p>
<p>Each crawl rule has a <em>path pattern</em>, a <em>rule</em>, and a <em>policy</em>.
To evaluate each rule, the web crawler compares a newly discovered <em>path</em> to the path pattern, using the logic represented by the rule, resulting in a policy.</p>
<p>The policy for each URL is also affected by directives in <a class="xref" href="web-crawler-reference.html#web-crawler-reference-robots-txt-file" title="Robots.txt file">robots.txt files</a>.
The web crawler will crawl only those URLs that are allowed by crawl rules <em>and</em> robots.txt directives.</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="web-crawler-reference-crawl-rule-rules"></a>Crawl rule logic (rules)<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.7/app-search-docs/guides/web-crawler-reference.asciidoc">edit</a></h4>
</div></div></div>
<p>The logic for each rule is as follows:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Begins with
</span>
</dt>
<dd>
<p>
The <em>path pattern</em> is a literal string <em>except</em> for the character <code class="literal">*</code>, which is a meta character that will match anything.
</p>
<p>The rule matches when the <em>path pattern</em> matches the <span class="strong strong"><strong>beginning</strong></span> of the <em>path</em> (which always begins with <code class="literal">/</code>).</p>
<p>If using this rule, begin your <em>path pattern</em> with <code class="literal">/</code>.</p>
</dd>
<dt>
<span class="term">
Ends with
</span>
</dt>
<dd>
<p>
The <em>path pattern</em> is a literal string <em>except</em> for the character <code class="literal">*</code>, which is a meta character that will match anything.
</p>
<p>The rule matches when the <em>path pattern</em> matches the <span class="strong strong"><strong>end</strong></span> of the <em>path</em>.</p>
</dd>
<dt>
<span class="term">
Contains
</span>
</dt>
<dd>
<p>
The <em>path pattern</em> is a literal string <em>except</em> for the character <code class="literal">*</code>, which is a meta character that will match anything.
</p>
<p>The rule matches when the <em>path pattern</em> matches anywhere <span class="strong strong"><strong>within</strong></span> the <em>path</em>.</p>
</dd>
<dt>
<span class="term">
Regex
</span>
</dt>
<dd>
<p>
The <em>path pattern</em> is a regular expression compatible with the Ruby language regular expression engine.
In addition to literal characters, the path pattern may include
<a href="https://ruby-doc.org/core-2.5.1/Regexp.html#class-Regexp-label-Metacharacters+and+Escapes" class="ulink" target="_blank" rel="noopener">metacharacters</a>, <a href="https://ruby-doc.org/core-2.5.1/Regexp.html#class-Regexp-label-Character+Classes" class="ulink" target="_blank" rel="noopener">character classes</a>, and <a href="https://ruby-doc.org/core-2.5.1/Regexp.html#class-Regexp-label-Repetition" class="ulink" target="_blank" rel="noopener">repetitions</a>.
You can test Ruby regular expressions using <a href="https://rubular.com" class="ulink" target="_blank" rel="noopener">Rubular</a>.
</p>
<p>The rule matches when the <em>path pattern</em> matches the <span class="strong strong"><strong>beginning</strong></span> of the <em>path</em> (which always begins with <code class="literal">/</code>).</p>
<p>If using this rule, begin your <em>path pattern</em> with <code class="literal">\/</code> or a metacharacter or character class that matches <code class="literal">/</code>.</p>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="web-crawler-reference-crawl-rule-matching"></a>Crawl rule matching<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.7/app-search-docs/guides/web-crawler-reference.asciidoc">edit</a></h4>
</div></div></div>
<p>The following table provides examples of crawl rule matching:</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">URL path</th>
<th align="left" valign="top">Rule</th>
<th align="left" valign="top">Path pattern</th>
<th align="left" valign="top">Match?</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">/foo/bar</code></p></td>
<td align="left" valign="top"><p><em>Begins with</em></p></td>
<td align="left" valign="top"><p><code class="literal">/foo</code></p></td>
<td align="left" valign="top"><p>YES</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">/foo/bar</code></p></td>
<td align="left" valign="top"><p><em>Begins with</em></p></td>
<td align="left" valign="top"><p><code class="literal">/*oo</code></p></td>
<td align="left" valign="top"><p>YES</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">/bar/foo</code></p></td>
<td align="left" valign="top"><p><em>Begins with</em></p></td>
<td align="left" valign="top"><p><code class="literal">/foo</code></p></td>
<td align="left" valign="top"><p>NO</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">/foo/bar</code></p></td>
<td align="left" valign="top"><p><em>Begins with</em></p></td>
<td align="left" valign="top"><p><code class="literal">foo</code></p></td>
<td align="left" valign="top"><p>NO</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">/blog/posts/hello-world</code></p></td>
<td align="left" valign="top"><p><em>Ends</em></p></td>
<td align="left" valign="top"><p><code class="literal">world</code></p></td>
<td align="left" valign="top"><p>YES</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">/blog/posts/hello-world</code></p></td>
<td align="left" valign="top"><p><em>Ends</em></p></td>
<td align="left" valign="top"><p><code class="literal">hello-*</code></p></td>
<td align="left" valign="top"><p>YES</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">/blog/world-hello</code></p></td>
<td align="left" valign="top"><p><em>Ends</em></p></td>
<td align="left" valign="top"><p><code class="literal">world</code></p></td>
<td align="left" valign="top"><p>NO</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">/blog/world-hello</code></p></td>
<td align="left" valign="top"><p><em>Ends</em></p></td>
<td align="left" valign="top"><p><code class="literal">*world</code></p></td>
<td align="left" valign="top"><p>NO</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">/fruits/bananas</code></p></td>
<td align="left" valign="top"><p><em>Contains</em></p></td>
<td align="left" valign="top"><p><code class="literal">banana</code></p></td>
<td align="left" valign="top"><p>YES</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">/fruits/apples</code></p></td>
<td align="left" valign="top"><p><em>Contains</em></p></td>
<td align="left" valign="top"><p><code class="literal">banana</code></p></td>
<td align="left" valign="top"><p>NO</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">/2020</code></p></td>
<td align="left" valign="top"><p><em>Regex</em></p></td>
<td align="left" valign="top"><p><code class="literal">\/[0-9]{3,5}</code></p></td>
<td align="left" valign="top"><p>YES</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">/20</code></p></td>
<td align="left" valign="top"><p><em>Regex</em></p></td>
<td align="left" valign="top"><p><code class="literal">\/[0-9]{3,5}</code></p></td>
<td align="left" valign="top"><p>NO</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">/2020</code></p></td>
<td align="left" valign="top"><p><em>Regex</em></p></td>
<td align="left" valign="top"><p><code class="literal">[0-9]{3,5}</code></p></td>
<td align="left" valign="top"><p>NO</p></td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="web-crawler-reference-crawl-rule-order"></a>Crawl rule order<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.7/app-search-docs/guides/web-crawler-reference.asciidoc">edit</a></h4>
</div></div></div>
<p>The <em>first</em> crawl rule to match determines the policy for the URL.
Therefore, the order of the crawl rules is significant.</p>
<p>The following table demonstrates how crawl rule order affects the resulting policy for a path:</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Path</th>
<th align="left" valign="top">Crawl rules</th>
<th align="left" valign="top">Resulting policy</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">/blog/2021/foo-bar-baz</code></p></td>
<td align="left" valign="top"><p>1. <code class="literal">Disallow</code> if <code class="literal">Begins with</code> <code class="literal">/blog</code></p>
<p>2. <code class="literal">Allow</code> if <code class="literal">Regex</code> <code class="literal">.*</code></p></td>
<td align="left" valign="top"><p>DISALLOW</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">/blog/2021/foo-bar-baz</code></p></td>
<td align="left" valign="top"><p>1. <code class="literal">Allow</code> if <code class="literal">Regex</code> <code class="literal">.*</code></p>
<p>2. <code class="literal">Disallow</code> if <code class="literal">Begins with</code> <code class="literal">/blog</code></p></td>
<td align="left" valign="top"><p>ALLOW</p></td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="web-crawler-reference-crawl-rule-restricting-paths"></a>Restricting paths using crawl rules<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.7/app-search-docs/guides/web-crawler-reference.asciidoc">edit</a></h4>
</div></div></div>
<p>The domain dashboard adds a default crawl rule to each domain: <code class="literal">Allow</code> if <code class="literal">Regex</code> <code class="literal">.*</code>.
You cannot delete or re-order this rule through the dashboard.</p>
<p>This rule is permissive, allowing all paths within the domain.
To restrict paths, use either of the following techniques:</p>
<p>Add rules that disallow specific paths (e.g. disallow the blog):</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Policy</th>
<th align="left" valign="top">Rule</th>
<th align="left" valign="top">Path pattern</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">Disallow</code></p></td>
<td align="left" valign="top"><p><code class="literal">Begins with</code></p></td>
<td align="left" valign="top"><p><code class="literal">/blog</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">Allow</code></p></td>
<td align="left" valign="top"><p><code class="literal">Regex</code></p></td>
<td align="left" valign="top"><p><code class="literal">.*</code></p></td>
</tr>
</tbody>
</table>
</div>
<p>Or, add rules that allow specific paths and disallow all others (e.g. allow <em>only</em> the blog):</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Policy</th>
<th align="left" valign="top">Rule</th>
<th align="left" valign="top">Path pattern</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">Allow</code></p></td>
<td align="left" valign="top"><p><code class="literal">Begins with</code></p></td>
<td align="left" valign="top"><p><code class="literal">/blog</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">Disallow</code></p></td>
<td align="left" valign="top"><p><code class="literal">Regex</code></p></td>
<td align="left" valign="top"><p><code class="literal">.*</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">Allow</code></p></td>
<td align="left" valign="top"><p><code class="literal">Regex</code></p></td>
<td align="left" valign="top"><p><code class="literal">.*</code></p></td>
</tr>
</tbody>
</table>
</div>
<p>When you restrict a crawl to specific paths, be sure to add <a class="xref" href="web-crawler-reference.html#web-crawler-reference-entry-point" title="Entry point">entry points</a> that allow the crawler to discover those paths.
For example, if your crawl rules restrict the crawler to <code class="literal">/blog</code>, add <code class="literal">/blog</code> as an entry point.</p>
<p>If you leave only the default entry point of <code class="literal">/</code>, the crawl will end immediately, since <code class="literal">/</code> is disallowed.</p>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="web-crawler-reference-robots-txt-file"></a>Robots.txt file<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.7/app-search-docs/guides/web-crawler-reference.asciidoc">edit</a></h3>
</div></div></div>
<p>A robots.txt file is a plain text file, associated with a <a class="xref" href="web-crawler-reference.html#web-crawler-reference-domain" title="Domain">domain</a>, that provides instructions to web crawlers.
The instructions within the file, also called directives, communicate which paths within that domain are disallowed (and allowed) for crawling.</p>
<p>The directives within a robots.txt file are similar to <a class="xref" href="web-crawler-reference.html#web-crawler-reference-crawl-rule" title="Crawl rule">crawl rules</a>.
You can therefore choose to manage inclusion and exclusion through robots.txt files, crawl rules, or a combination of both.
The App Search web crawler will crawl only those paths that are allowed by the crawl rules for the domain <span class="strong strong"><strong>and</strong></span> the directives within the robots.txt file for the domain.</p>
<p>You may prefer using a robots.txt file over crawl rules for any of the following reasons:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
You have already been publishing a robots.txt file for other web crawlers.
</li>
<li class="listitem">
You don&#8217;t have access to the web crawler UI.
</li>
<li class="listitem">
You prefer the robots.txt file interface over the web crawler web interface.
</li>
</ul>
</div>
<p>You can also use a robots.txt file to specify <a class="xref" href="web-crawler-reference.html#web-crawler-reference-sitemap" title="Sitemap">sitemaps</a> for a domain.</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="web-crawler-reference-robots-txt-file-discovery-management"></a>Robots.txt file discovery and management<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.7/app-search-docs/guides/web-crawler-reference.asciidoc">edit</a></h4>
</div></div></div>
<p>At the start of each <a class="xref" href="web-crawler-reference.html#web-crawler-reference-crawl" title="Crawl">crawl</a>, the web crawler fetches and processes the robots.txt file for each domain.
When fetching a robots.txt file, the crawler handles 2xx, 4xx, and 5xx responses differenty.
See <a class="xref" href="web-crawler-reference.html#web-crawler-reference-http-response-status-codes-robots-txt" title="Robots.txt file response code handling">Robots.txt file response code handling</a> for an explanation of each response.</p>
<p>See <a class="xref" href="crawl-web-content.html#crawl-web-content-manage-robots-txt-files" title="Manage robots.txt files">Manage robots.txt files</a> to manage robots.txt files for your domains.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="web-crawler-reference-robots-txt-file-format"></a>Robots.txt file format and technical specification<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.7/app-search-docs/guides/web-crawler-reference.asciidoc">edit</a></h4>
</div></div></div>
<p>See <a href="https://en.wikipedia.org/wiki/Robots_exclusion_standard" class="ulink" target="_blank" rel="noopener">Robots exclusion standard</a> on Wikipedia for a summary of robots.txt conventions.</p>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="web-crawler-reference-canonical-url-link-tag"></a>Canonical URL link tag<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.7/app-search-docs/guides/web-crawler-reference.asciidoc">edit</a></h3>
</div></div></div>
<p>A <em>canonical URL link tag</em> is an HTML element you can embed within pages that <a class="xref" href="web-crawler-reference.html#web-crawler-reference-content-deduplication" title="Duplicate document handling">duplicate the content of other pages</a>.
The canonical URL link tag specifies the canonical URL for that content.</p>
<p>The canonical URL is stored on the App Search document in the <code class="literal">url</code> <a class="xref" href="web-crawler-reference.html#web-crawler-reference-web-crawler-schema" title="Web crawler schema">field</a>, while the <code class="literal">additional_urls</code> field contains other URLs where the crawler discovered the same content.
If your site contains pages that duplicate the content of other pages, use canonical URL link tags to explicitly manage which URL is stored in the <code class="literal">url</code> field of the resulting App Search document.</p>
<p>Template:</p>
<div class="pre_wrapper lang-html">
<pre class="programlisting prettyprint lang-html">&lt;link rel="canonical" href="{CANONICAL_URL}"&gt;</pre>
</div>
<p>Example:</p>
<div class="pre_wrapper lang-html">
<pre class="programlisting prettyprint lang-html">&lt;link rel="canonical" href="https://example.com/categories/dresses/starlet-red-medium"&gt;</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="web-crawler-reference-robots-meta-tags"></a>Robots meta tags<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.7/app-search-docs/guides/web-crawler-reference.asciidoc">edit</a></h3>
</div></div></div>
<p><em>Robots meta tags</em> are HTML elements you can embed within pages to prevent the crawler from following links or indexing content.</p>
<p>Template:</p>
<div class="pre_wrapper lang-html">
<pre class="programlisting prettyprint lang-html">&lt;meta name="robots" content="{DIRECTIVES}"&gt;</pre>
</div>
<p>Supported directives:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">noindex</code>
</span>
</dt>
<dd>
The web crawler will not index the page.
</dd>
<dt>
<span class="term">
<code class="literal">nofollow</code>
</span>
</dt>
<dd>
<p>
The web crawler will not follow links from the page (i.e. will not add links to the crawl queue).
The web crawler logs a <code class="literal">url_discover_denied</code> event for each link.
</p>
<p>The directive does not prevent the web crawler from indexing the page.</p>
</dd>
</dl>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p><a class="xref" href="web-crawler-reference.html#web-crawler-reference-content-deletion" title="Content deletion">Process crawls</a> do not honor the <code class="literal">noindex</code> and <code class="literal">nofollow</code> directives.</p>
<p>In versions before 8.3.0, purge crawls also do not remove previously indexed pages that now have <code class="literal">noindex</code> and <code class="literal">nofollow</code> directives.
To remove obsolete content, you can create <a class="xref" href="crawl-web-content.html#crawl-web-content-manage-crawl-rules" title="Manage crawl rules">crawl rules</a> to exclude the pages and <em>then</em> run a <a class="xref" href="web-crawler-reference.html#web-crawler-reference-process-crawl" title="Process crawl">process crawl</a>.</p>
</div>
</div>
<p>Examples:</p>
<div class="pre_wrapper lang-html">
<pre class="programlisting prettyprint lang-html">&lt;meta name="robots" content="noindex"&gt;
&lt;meta name="robots" content="nofollow"&gt;
&lt;meta name="robots" content="noindex, nofollow"&gt;</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="web-crawler-reference-meta-tags-content-extraction"></a>Meta tags and data attributes to extract custom fields<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.7/app-search-docs/guides/web-crawler-reference.asciidoc">edit</a></h3>
</div></div></div>
<p>With <em>meta tags and data attributes</em> you can extract custom fields from your HTML pages.</p>
<p>Template:</p>
<div class="pre_wrapper lang-html">
<pre class="programlisting prettyprint lang-html">&lt;head&gt;
  &lt;meta class="elastic" name="{FIELD_NAME}" content="{FIELD_VALUE}"&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;div data-elastic-name="{FIELD_NAME}"&gt;{FIELD_VALUE}&lt;/div&gt;
&lt;/body&gt;</pre>
</div>
<p>The crawled document for this example</p>
<div class="pre_wrapper lang-html">
<pre class="programlisting prettyprint lang-html">&lt;head&gt;
  &lt;meta class="elastic" name="product_price" content="99.99"&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;h1 data-elastic-name="product_name"&gt;Printer&lt;/h1&gt;
&lt;/body&gt;</pre>
</div>
<p>will include 2 additional fields.</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
  "product_price": "99.99",
  "product_name": "Printer"
}</pre>
</div>
<p>You can specify multiple <code class="literal">class="elastic"</code> and <code class="literal">data-elastic-name</code> tags.</p>
<p>Template:</p>
<div class="pre_wrapper lang-html">
<pre class="programlisting prettyprint lang-html">&lt;head&gt;
  &lt;meta class="elastic" name="{FIELD_NAME_1}" content="{FIELD_VALUE_1}"&gt;
  &lt;meta class="elastic" name="{FIELD_NAME_2}" content="{FIELD_VALUE_2}"&gt;
&lt;/head&gt;
&lt;body&gt;
  &lt;div data-elastic-name="{FIELD_NAME_1}"&gt;{FIELD_VALUE_1}&lt;/div&gt;
  &lt;div data-elastic-name="{FIELD_NAME_2}"&gt;{FIELD_VALUE_2}&lt;/div&gt;
&lt;/body&gt;</pre>
</div>
<p><code class="literal">{FIELD_NAME}</code> must conform to the <a class="xref" href="documents.html#documents-create-field-name-rules" title="Field name rules">field name rules</a> detailed in the Documents API reference.
Additionally, the web crawler reserves the following fields:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">additional_urls</code>
</li>
<li class="listitem">
<code class="literal">body_content</code>
</li>
<li class="listitem">
<code class="literal">domains</code>
</li>
<li class="listitem">
<code class="literal">headings</code>
</li>
<li class="listitem">
<code class="literal">last_crawled_at</code>
</li>
<li class="listitem">
<code class="literal">links</code>
</li>
<li class="listitem">
<code class="literal">meta_description</code>
</li>
<li class="listitem">
<code class="literal">meta_keywords</code>
</li>
<li class="listitem">
<code class="literal">title</code>
</li>
<li class="listitem">
<code class="literal">url</code>
</li>
<li class="listitem">
<code class="literal">url_host</code>
</li>
<li class="listitem">
<code class="literal">url_path</code>
</li>
<li class="listitem">
<code class="literal">url_path_dir1</code>
</li>
<li class="listitem">
<code class="literal">url_path_dir2</code>
</li>
<li class="listitem">
<code class="literal">url_path_dir3</code>
</li>
<li class="listitem">
<code class="literal">url_port</code>
</li>
<li class="listitem">
<code class="literal">url_scheme</code>
</li>
</ul>
</div>
<p>For compatibility with Elastic Site Search, the crawler also supports the class value <code class="literal">swiftype</code> on meta elements and the data attribute <code class="literal">data-swiftype-name</code> on elements within the body.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="web-crawler-reference-nofollow-link"></a>Nofollow link<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.7/app-search-docs/guides/web-crawler-reference.asciidoc">edit</a></h3>
</div></div></div>
<p><em>Nofollow links</em> are HTML links that instruct the crawler to not follow the URL.</p>
<p>The web crawler will not follow links that include <code class="literal">rel="nofollow"</code> (i.e. will not add links to the crawl queue).
The web crawler logs a <code class="literal">url_discover_denied</code> event for each link.</p>
<p>The link does not prevent the web crawler from indexing the page in which it appears.</p>
<p>Template:</p>
<div class="pre_wrapper lang-html">
<pre class="programlisting prettyprint lang-html">&lt;a rel="nofollow" href="{LINK_URL}"&gt;{LINK_TEXT}&lt;/a&gt;</pre>
</div>
<p>Example:</p>
<div class="pre_wrapper lang-html">
<pre class="programlisting prettyprint lang-html">&lt;a rel="nofollow" href="/admin/categories"&gt;Edit this category&lt;/a&gt;</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="web-crawler-reference-crawl-status"></a>Crawl status<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.7/app-search-docs/guides/web-crawler-reference.asciidoc">edit</a></h3>
</div></div></div>
<p>Each crawl has a <em>status</em>, which quickly communicates its state.</p>
<p>See <a class="xref" href="crawl-web-content.html#crawl-web-content-view-crawl-status" title="View crawl status">View crawl status</a> to view the status for a crawl.</p>
<p>All crawl statuses:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Pending
</span>
</dt>
<dd>
The crawl is enqueued and will start after resources are available.
</dd>
<dt>
<span class="term">
Starting
</span>
</dt>
<dd>
The crawl is starting.
You may see this status briefly, while a crawl moves from <em>pending</em> to <em>running</em>.
</dd>
<dt>
<span class="term">
Running
</span>
</dt>
<dd>
The crawl is running.
</dd>
<dt>
<span class="term">
Success
</span>
</dt>
<dd>
The crawl completed without error.
The web crawler may stop a crawl due to hitting resource limits.
Such a crawl will report its status as <em>success</em>, as long as it completes without error.
</dd>
<dt>
<span class="term">
Canceling
</span>
</dt>
<dd>
The crawl is canceling.
You may see this status briefly, after choosing to cancel a crawl.
</dd>
<dt>
<span class="term">
Canceled
</span>
</dt>
<dd>
The crawl was intentionally canceled and therefore did not complete.
</dd>
<dt>
<span class="term">
Failed
</span>
</dt>
<dd>
The crawl ended unexpectedly.
<a class="xref" href="view-web-crawler-events-logs.html" title="View web crawler events logs">View the web crawler events logs</a> for a message providing an explanation.
</dd>
<dt>
<span class="term">
Skipped
</span>
</dt>
<dd>
An automatic crawl was skipped because another crawl was active at the time.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="web-crawler-reference-partial-crawl"></a>Partial crawl<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.7/app-search-docs/guides/web-crawler-reference.asciidoc">edit</a></h3>
</div></div></div>
<p>A <em>partial crawl</em> is a web crawl that runs with custom configuration to narrow the scope of the crawl.
Configuration for a partial crawl is provided at the time of the crawl request, replacing any globally configured settings.</p>
<p>Partial crawls offer the user powerful customization to meet a variety of use cases. Consider an engine with the following domains and entry points:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p><a href="http://www.awesome-recipes.com" class="ulink" target="_top">http://www.awesome-recipes.com</a></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">/quick</code>
</li>
<li class="listitem">
<code class="literal">/vegetarian</code>
</li>
<li class="listitem">
<code class="literal">/slow-cooker</code>
</li>
</ul>
</div>
</li>
<li class="listitem">
<a href="http://www.awesome-workouts.com" class="ulink" target="_top">http://www.awesome-workouts.com</a>
</li>
<li class="listitem">
<a href="http://www.awesome-reflections.com" class="ulink" target="_top">http://www.awesome-reflections.com</a>
</li>
</ul>
</div>
<p>A typical crawl for this engine would crawl all three domains, initiating a url queue with seed URLs:</p>
<div class="pre_wrapper lang-ruby">
<pre class="programlisting prettyprint lang-ruby">['http://www.awesome-recipes.com/quick', 'http://www.awesome-recipes.com/vegetarian', 'http://www.awesome-recipes.com/slow-cooker', 'http://www.awesome-workouts.com/', 'http://www.awesome-reflections.com/']</pre>
</div>
<p>Under the <code class="literal">http://www.awesome-workouts.com</code> domain, the crawler discovers a sitemap and adds multiple urls to the queue.
The crawler visits each url in the queue, enqueuing additional urls as it discovers and traverses any available HTML links.
Through this process, the crawler discovers hundreds of web pages, drilling into linked content up to the default depth of 10 traversals.</p>
<p>While running full crawls at regular intervals account for the bulk of this engine&#8217;s maintenance, partial crawls allow an administrator to quickly visit and update specific content ad-hoc.</p>
<p>Scenarios include:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Efficiently update new content linked from the home pages of each domain by requesting a partial crawl with a max depth of 2.
</li>
<li class="listitem">
Efficiently index new slow cooker recipes by augmenting the above request with a specified entry point of <code class="literal">http://www.awesome-recipes.com/slow-cooker</code>.
</li>
<li class="listitem">
Update content for just the <code class="literal">workouts</code> domain while keeping content from <code class="literal">recipes</code> and <code class="literal">reflections</code> intact with a single domain partial crawl.
</li>
<li class="listitem">
Target precise content updates by setting a max depth of 1 and providing a list of URLs to visit.
</li>
<li class="listitem">
Replicate the above at scale by providing the URLs from within a sitemap.
</li>
</ul>
</div>
<p>Partial crawls further streamline a web crawl by skipping the "purge" phase and, in certain cases, ignoring sitemaps defined in robots.txt.
Robots.txt sitemaps are ignored by a partial crawl if seed URLs and/or sitemap URLs are included in the partial crawl configuration.</p>
<p>One-time partial crawls can be configured through the UI, but recurring partial crawls should be requested through the API. For a full list of partial crawl capabilities, visit the <a class="xref" href="web-crawler-api-reference.html#web-crawler-apis-post-crawler-partial-crawl-requests" title="Create a new partial crawl request">API reference</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="web-crawler-reference-process-crawl"></a>Process crawl<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.7/app-search-docs/guides/web-crawler-reference.asciidoc">edit</a></h3>
</div></div></div>
<p>A <em>process crawl</em> is an operation that re-processes the documents in your engine using the current <a class="xref" href="web-crawler-reference.html#web-crawler-reference-crawl-rule" title="Crawl rule">crawl rules</a>.
Essentially, it <em>re-applies</em> your crawl rules to your existing documents, removing the documents whose URLs are no longer allowed by the current crawl rules.</p>
<p>After updating your crawl rules, you can use a process crawl to remove unwanted documents without waiting for a full re-crawl to remove them.
You can request process crawls through the web crawler UI or API.</p>
<p>Using the UI, you can request a process crawl for <em>all</em> domains or a <em>specific</em> domain.
See <a class="xref" href="crawl-web-content.html#crawl-web-content-re-apply-crawl-rules" title="Re-apply crawl rules">Re-apply crawl rules</a>.</p>
<p>Using the API, you can request a process crawl for <em>all</em> domains or a <em>subset</em> of domains.
See <a class="xref" href="web-crawler-api-reference.html#web-crawler-apis-process-crawls" title="Process crawls">Process crawls</a>.</p>
<p>It is recommended to cancel any active web crawls before requesting a process crawl.
A web crawl that runs concurrently with a process crawl may continue to index fresh documents with out of date configuration; the process crawl will only apply to documents indexed at the time of the request.</p>
<p>Using the API, you can also complete a "dry run" process crawl.
When "dry run" is enabled, the process crawl will report which documents would be deleted by a normal process crawl, but it does not delete any documents from your engine.
Use a dry run to get quick feedback after <a class="xref" href="web-crawler-api-reference.html#web-crawler-apis-crawl-rules" title="Crawl rules">modifying crawl rules through the web crawler API</a>.
If the results of the dry run include documents you do not want to remove, further modify your crawl rules.
Repeat this process until you get the expected results.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="web-crawler-reference-http-authentication"></a>HTTP authentication<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.7/app-search-docs/guides/web-crawler-reference.asciidoc">edit</a></h3>
</div></div></div>
<p>The web crawler can crawl domains protected by <a href="https://datatracker.ietf.org/doc/html/rfc7235" class="ulink" target="_blank" rel="noopener">HTTP Authentication</a>.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>This feature requires an appropriate Elastic subscription level.
Refer to the Elastic subscriptions pages for <a href="/subscriptions/cloud" class="ulink" target="_blank" rel="noopener">Elastic Cloud</a> and <a href="/subscriptions" class="ulink" target="_top">self-managed</a> deployments.</p>
</div>
</div>
<p>Use the <a class="xref" href="web-crawler-api-reference.html" title="Web crawler API reference">web crawler API</a> to provide the crawler with the information required to crawl each domain.
Create or update each domain with the <code class="literal">auth</code> parameter.
Refer to the following API references:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="web-crawler-api-reference.html#web-crawler-apis-post-crawler-domains" title="Create a new domain">Create a new domain</a>
</li>
<li class="listitem">
<a class="xref" href="web-crawler-api-reference.html#web-crawler-apis-put-crawler-domain" title="Update a domain">Update a domain</a>
</li>
</ul>
</div>
<p>Related: <a class="xref" href="web-crawler-reference.html#web-crawler-reference-http-proxy" title="HTTP proxy">HTTP proxy</a></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="web-crawler-reference-http-proxy"></a>HTTP proxy<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.7/app-search-docs/guides/web-crawler-reference.asciidoc">edit</a></h3>
</div></div></div>
<p>The web crawler can crawl content through an HTTP proxy, with or without <code class="literal">Basic</code> authentication.
Refer to the following guide: <a class="xref" href="crawl-private-network-cloud.html" title="Crawl a private network using a web crawler on Elastic Cloud">Crawl a private network using a web crawler on Elastic Cloud</a>.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>HTTP proxy with basic authentication requires an appropriate Elastic subscription level.
Refer to the Elastic subscriptions pages for <a href="/subscriptions/cloud" class="ulink" target="_blank" rel="noopener">Elastic Cloud</a> and <a href="/subscriptions" class="ulink" target="_top">self-managed</a> deployments.</p>
</div>
</div>
<p>Configure Enterprise Search with the necessary information about the HTTP proxy.
Refer to the following configuration settings reference: <a href="/guide/en/enterprise-search/8.7/configuration.html#configuration-settings-elastic-crawler-http-proxy" class="ulink" target="_blank" rel="noopener">Crawler HTTP proxy settings</a>.</p>
<p>Related: <a class="xref" href="web-crawler-reference.html#web-crawler-reference-http-authentication" title="HTTP authentication">HTTP authentication</a></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="web-crawler-reference-http-response-status-codes"></a>HTTP response status codes handling<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.7/app-search-docs/guides/web-crawler-reference.asciidoc">edit</a></h3>
</div></div></div>
<p>The following sections describe how the web crawler handles HTTP response status codes for HTML documents and robots.txt files.</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="web-crawler-reference-http-response-status-codes-html"></a>HTML response code handling<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.7/app-search-docs/guides/web-crawler-reference.asciidoc">edit</a></h4>
</div></div></div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Code</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Web crawler behavior</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">2xx</code></p></td>
<td align="left" valign="top"><p>Success</p></td>
<td align="left" valign="top"><p>The web crawler extracts and de-duplicates the page&#8217;s content into a search document.
Then it indexes the document into the engine, replacing an existing document with the same content if present.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">3xx</code></p></td>
<td align="left" valign="top"><p>Redirection</p></td>
<td align="left" valign="top"><p>The web crawler follows all redirects within configured domains recursively until it receives a <code class="literal">2xx</code>, <code class="literal">4xx</code>, or <code class="literal">5xx</code> response status code, detects a circular redirect or reaches a configured max redirects limit (which are handled as failures).
The crawler then handles that code as indicated in this table.
Each redirect response is logged as a separate event in the event log along with redirect information to help with long or circular redirect chain troubleshooting.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">4xx</code></p></td>
<td align="left" valign="top"><p>Permanent error</p></td>
<td align="left" valign="top"><p>The web crawler assumes this error is permanent.
It therefore does not index the document.
Furthermore, if the document is present in the engine, the web crawler deletes the document.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">5xx</code></p></td>
<td align="left" valign="top"><p>Temporary error</p></td>
<td align="left" valign="top"><p>The web crawler optimistically assumes this error will resolve in the future.
If the engine already contains a document representing the page, the document is updated to indicate the page was inaccessible.
After the page is inaccessible for three consecutive crawls, the document is deleted from the engine.</p></td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="web-crawler-reference-http-response-status-codes-robots-txt"></a>Robots.txt file response code handling<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.7/app-search-docs/guides/web-crawler-reference.asciidoc">edit</a></h4>
</div></div></div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Code</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Web crawler behavior</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">2xx</code></p></td>
<td align="left" valign="top"><p>Success</p></td>
<td align="left" valign="top"><p>The web crawler processes and honors the directives for the domain within the <a class="xref" href="web-crawler-reference.html#web-crawler-reference-robots-txt-file" title="Robots.txt file">robots.txt file</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">3xx</code></p></td>
<td align="left" valign="top"><p>Redirect</p></td>
<td align="left" valign="top"><p>The web crawler follows redirects (including redirects to external domains) until it receives a <code class="literal">2xx</code>, <code class="literal">4xx</code>, or <code class="literal">5xx</code> response status code, detects a circular redirect or reaches a configured max redirects limit (which are handled as failures).
The crawler then handles that code as indicated in this table.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">4xx</code></p></td>
<td align="left" valign="top"><p>Permanent error</p></td>
<td align="left" valign="top"><p>The web crawler assumes this error is permanent and no specific rules exist for the domain.
It therefore <span class="strong strong"><strong>allows all</strong></span> paths for the domain (subject to <a class="xref" href="web-crawler-reference.html#web-crawler-reference-crawl-rule" title="Crawl rule">crawl rules</a>).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">5xx</code></p></td>
<td align="left" valign="top"><p>Temporary error</p></td>
<td align="left" valign="top"><p>The web crawler optimistically assumes this error will resolve in the future.
However, in the interim, the crawler does not know which paths are allowed and disallowed.
It therefore <span class="strong strong"><strong>disallows all</strong></span> paths for the domain.</p></td>
</tr>
</tbody>
</table>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="web-crawler-reference-web-crawler-schema"></a>Web crawler schema<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.7/app-search-docs/guides/web-crawler-reference.asciidoc">edit</a></h3>
</div></div></div>
<p>The web crawler indexes search documents using the following schema.
All fields are strings or arrays of strings.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">additional_urls</code>
</span>
</dt>
<dd>
The URLs of additional pages with the same content.
</dd>
<dt>
<span class="term">
<code class="literal">body_content</code>
</span>
</dt>
<dd>
The content of the page&#8217;s <code class="literal">&lt;body&gt;</code> tag with all HTML tags removed.
Truncated to <code class="literal">crawler.extraction.body_size.limit</code>.
</dd>
<dt>
<span class="term">
<code class="literal">content_hash</code>
</span>
</dt>
<dd>
A "fingerprint" to uniquely identify this content, which is used to handle duplicate documents.
See <a class="xref" href="web-crawler-reference.html#web-crawler-reference-content-deduplication" title="Duplicate document handling">Duplicate document handling</a>.
</dd>
<dt>
<span class="term">
<code class="literal">domains</code>
</span>
</dt>
<dd>
The domains in which this content appears.
</dd>
<dt>
<span class="term">
<code class="literal">headings</code>
</span>
</dt>
<dd>
The text of the page&#8217;s HTML headings (<code class="literal">h1</code> - <code class="literal">h6</code> elements).
Limited by <code class="literal">crawler.extraction.headings_count.limit</code>.
</dd>
<dt>
<span class="term">
<code class="literal">id</code>
</span>
</dt>
<dd>
The unique identifier for the page.
</dd>
<dt>
<span class="term">
<code class="literal">links</code>
</span>
</dt>
<dd>
Links found on the page.
Limited by <code class="literal">crawler.extraction.indexed_links_count.limit</code>.
</dd>
<dt>
<span class="term">
<code class="literal">meta_description</code>
</span>
</dt>
<dd>
The page&#8217;s description, taken from the <code class="literal">&lt;meta name="description"&gt;</code> tag.
Truncated to <code class="literal">crawler.extraction.description_size.limit</code>.
</dd>
<dt>
<span class="term">
<code class="literal">meta_keywords</code>
</span>
</dt>
<dd>
The page&#8217;s keywords, taken from the <code class="literal">&lt;meta name="keywords"&gt;</code> tag.
Truncated to <code class="literal">crawler.extraction.keywords_size.limit</code>.
</dd>
<dt>
<span class="term">
<code class="literal">title</code>
</span>
</dt>
<dd>
The title of the page, taken from the <code class="literal">&lt;title&gt;</code> tag.
Truncated to <code class="literal">crawler.extraction.title_size.limit</code>.
</dd>
<dt>
<span class="term">
<code class="literal">url</code>
</span>
</dt>
<dd>
The URL of the page.
</dd>
<dt>
<span class="term">
<code class="literal">url_host</code>
</span>
</dt>
<dd>
The hostname or IP from the page&#8217;s URL.
</dd>
<dt>
<span class="term">
<code class="literal">url_path</code>
</span>
</dt>
<dd>
The full pathname from the page&#8217;s URL.
</dd>
<dt>
<span class="term">
<code class="literal">url_path_dir1</code>
</span>
</dt>
<dd>
The first segment of the pathname from the page&#8217;s URL.
</dd>
<dt>
<span class="term">
<code class="literal">url_path_dir2</code>
</span>
</dt>
<dd>
The second segment of the pathname from the page&#8217;s URL.
</dd>
<dt>
<span class="term">
<code class="literal">url_path_dir3</code>
</span>
</dt>
<dd>
The third segment of the pathname from the page&#8217;s URL.
</dd>
<dt>
<span class="term">
<code class="literal">url_port</code>
</span>
</dt>
<dd>
The port number from the page&#8217;s URL (as a string).
</dd>
<dt>
<span class="term">
<code class="literal">url_scheme</code>
</span>
</dt>
<dd>
The scheme of the page&#8217;s URL.
</dd>
</dl>
</div>
<p>In addition to these predefined fields, you can also extract custom fields via <a class="xref" href="web-crawler-reference.html#web-crawler-reference-meta-tags-content-extraction" title="Meta tags and data attributes to extract custom fields">meta tags and attributes</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="web-crawler-reference-web-crawler-events-logs"></a>Web crawler events logs<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.7/app-search-docs/guides/web-crawler-reference.asciidoc">edit</a></h3>
</div></div></div>
<p>The web crawler logs many events while discovering, extracting, and indexing web content.</p>
<p>To view these events, see <a class="xref" href="view-web-crawler-events-logs.html" title="View web crawler events logs">View web crawler events logs</a>.</p>
<p>For a complete reference of all events, see <a class="xref" href="web-crawler-events-logs-reference.html" title="Web crawler events logs reference">Web crawler events logs reference</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="web-crawler-reference-web-crawler-configuration-settings"></a>Web crawler configuration settings<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.7/app-search-docs/guides/web-crawler-reference.asciidoc">edit</a></h3>
</div></div></div>
<p>Operators can configure several web crawler settings.</p>
<p>See <a href="/guide/en/enterprise-search/8.7/configuration.html#configuration-settings-app-search-crawler" class="ulink" target="_blank" rel="noopener">App Search web crawler</a> within the Enterprise Search configuration documentation.</p>
</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="web-crawler-faq.html">« Web crawler FAQ</a>
</span>
<span class="next">
<a href="web-crawler-events-logs-reference.html">Web crawler events logs reference »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
