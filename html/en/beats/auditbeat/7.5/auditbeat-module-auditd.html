<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Auditd Module | Auditbeat Reference [7.5] | Elastic</title>
<link rel="home" href="index.html" title="Auditbeat Reference [7.5]"/>
<link rel="up" href="auditbeat-modules.html" title="Modules"/>
<link rel="prev" href="auditbeat-modules.html" title="Modules"/>
<link rel="next" href="auditbeat-module-file_integrity.html" title="File Integrity Module"/>
<meta name="DC.type" content="Learn/Docs/Auditbeat/Reference/7.5"/>
<meta name="DC.subject" content="Auditbeat"/>
<meta name="DC.identifier" content="7.5"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <!--© 2015-2022 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!--BEGIN QUALTRICS WEBSITE FEEDBACK SNIPPET-->
    <script type='text/javascript'>
      (function(){var g=function(e,h,f,g){
      this.get=function(a){for(var a=a+"=",c=document.cookie.split(";"),b=0,e=c.length;b<e;b++){for(var d=c[b];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return null};
      this.set=function(a,c){var b="",b=new Date;b.setTime(b.getTime()+6048E5);b="; expires="+b.toGMTString();document.cookie=a+"="+c+b+"; path=/; "};
      this.check=function(){var a=this.get(f);if(a)a=a.split(":");else if(100!=e)"v"==h&&(e=Math.random()>=e/100?0:100),a=[h,e,0],this.set(f,a.join(":"));else return!0;var c=a[1];if(100==c)return!0;switch(a[0]){case "v":return!1;case "r":return c=a[2]%Math.floor(100/c),a[2]++,this.set(f,a.join(":")),!c}return!0};
      this.go=function(){if(this.check()){var a=document.createElement("script");a.type="text/javascript";a.src=g;document.body&&document.body.appendChild(a)}};
      this.start=function(){var a=this;window.addEventListener?window.addEventListener("load",function(){a.go()},!1):window.attachEvent&&window.attachEvent("onload",function(){a.go()})}};
      try{(new g(100,"r","QSI_S_ZN_emkP0oSe9Qrn7kF","https://znemkp0ose9qrn7kf-elastic.siteintercept.qualtrics.com/WRSiteInterceptEngine/?Q_ZID=ZN_emkP0oSe9Qrn7kF")).start()}catch(i){}})();
    </script><div id='ZN_emkP0oSe9Qrn7kF'><!--DO NOT REMOVE-CONTENTS PLACED HERE--></div>
    <!--END WEBSITE FEEDBACK SNIPPET-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  <div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="index.html">Auditbeat Reference [7.5]</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="auditbeat-modules.html">Modules</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="auditbeat-modules.html">« Modules</a>
</span>
<span class="next">
<a href="auditbeat-module-file_integrity.html">File Integrity Module »</a>
</span>
</div>
<div class="chapter">
<div class="titlepage"><div><div>
<h2 class="title"><a id="auditbeat-module-auditd"></a>Auditd Module<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.5/auditbeat/docs/modules/auditd.asciidoc">edit</a></h2>
</div></div></div>
<p>The <code class="literal">auditd</code> module receives audit events from the Linux Audit Framework that
is a part of the Linux kernel.</p>
<p>This module is available only for Linux.</p>
<h3><a id="_how_it_works"></a>How it works<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.5/auditbeat/docs/modules/auditd.asciidoc">edit</a></h3>
<p>This module establishes a subscription to the kernel to receive the events
as they occur. So unlike most other modules, the <code class="literal">period</code> configuration
option is unused because it is not implemented using polling.</p>
<p>The Linux Audit Framework can send multiple messages for a single auditable
event. For example, a <code class="literal">rename</code> syscall causes the kernel to send eight separate
messages. Each message describes a different aspect of the activity that is
occurring (the syscall itself, file paths, current working directory, process
title). This module will combine all of the data from each of the messages
into a single event.</p>
<p>Messages for one event can be interleaved with messages from another event. This
module will buffer the messages in order to combine related messages into a
single event even if they arrive interleaved or out of order.</p>
<h3><a id="_useful_commands"></a>Useful commands<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.5/auditbeat/docs/modules/auditd.asciidoc">edit</a></h3>
<p>When running Auditbeat with the <code class="literal">auditd</code> module enabled, you might find
that other monitoring tools interfere with Auditbeat.</p>
<p>For example, you might encounter errors if another process, such as <code class="literal">auditd</code>, is
registered to receive data from the Linux Audit Framework. You can use these
commands to see if the <code class="literal">auditd</code> service is running and stop it:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>See if <code class="literal">auditd</code> is running:</p>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">service auditd status</pre>
</div>
</li>
<li class="listitem">
<p>Stop the <code class="literal">auditd</code> service:</p>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">service auditd stop</pre>
</div>
</li>
<li class="listitem">
<p>Disable <code class="literal">auditd</code> from starting on boot:</p>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">chkconfig auditd off</pre>
</div>
</li>
</ul>
</div>
<p>To save CPU usage and disk space, you can use this command to stop <code class="literal">journald</code>
from listening to audit messages:</p>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">systemctl mask systemd-journald-audit.socket</pre>
</div>
<h3><a id="_inspect_the_kernel_audit_system_status"></a>Inspect the kernel audit system status<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.5/auditbeat/docs/modules/auditd.asciidoc">edit</a></h3>
<p>Auditbeat provides useful commands to query the state of the audit system
in the Linux kernel.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>See the list of installed audit rules:</p>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">auditbeat show auditd-rules</pre>
</div>
<p>Prints the list of loaded rules, similar to <code class="literal">auditctl -l</code>:</p>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">-a never,exit -S all -F pid=26253
-a always,exit -F arch=b32 -S all -F key=32bit-abi
-a always,exit -F arch=b64 -S execve,execveat -F key=exec
-a always,exit -F arch=b64 -S connect,accept,bind -F key=external-access
-w /etc/group -p wa -k identity
-w /etc/passwd -p wa -k identity
-w /etc/gshadow -p wa -k identity
-a always,exit -F arch=b64 -S open,truncate,ftruncate,creat,openat,open_by_handle_at -F exit=-EACCES -F key=access
-a always,exit -F arch=b64 -S open,truncate,ftruncate,creat,openat,open_by_handle_at -F exit=-EPERM -F key=access</pre>
</div>
</li>
<li class="listitem">
<p>See the status of the audit system:</p>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">auditbeat show auditd-status</pre>
</div>
<p>Prints the status of the kernel audit system, similar to <code class="literal">auditctl -s</code>:</p>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">enabled 1
failure 0
pid 0
rate_limit 0
backlog_limit 8192
lost 14407
backlog 0
backlog_wait_time 0
features 0xf</pre>
</div>
</li>
</ul>
</div>
<h3><a id="_configuration_options_14"></a>Configuration options<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.5/auditbeat/docs/modules/auditd.asciidoc">edit</a></h3>
<p>This module has some configuration options for tuning its behavior. The
following example shows all configuration options with their default values.</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">- module: auditd
  resolve_ids: true
  failure_mode: silent
  backlog_limit: 8192
  rate_limit: 0
  include_raw_message: false
  include_warnings: false
  backpressure_strategy: auto</pre>
</div>
<p>This module also supports the
<a class="xref" href="auditbeat-module-auditd.html#module-standard-options-auditd" title="Standard configuration options">standard configuration options</a>
described later.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">socket_type</code></strong></span>
</span>
</dt>
<dd>
<p>
This optional setting controls the type of
socket that Auditbeat uses to receive events from the kernel. The two
options are <code class="literal">unicast</code> and <code class="literal">multicast</code>.
</p>
<p><code class="literal">unicast</code> should be used when Auditbeat is the primary userspace daemon for
receiving audit events and managing the rules. Only a single process can receive
audit events through the "unicast" connection so any other daemons should be
stopped (e.g. stop <code class="literal">auditd</code>).</p>
<p><code class="literal">multicast</code> can be used in kernel versions 3.16 and newer. By using <code class="literal">multicast</code>
Auditbeat will receive an audit event broadcast that is not exclusive to a
a single process. This is ideal for situations where <code class="literal">auditd</code> is running and
managing the rules. If <code class="literal">multicast</code> is specified, but the kernel version is less
than 3.16 Auditbeat will automatically revert to <code class="literal">unicast</code>.</p>
<p>By default Auditbeat will use <code class="literal">multicast</code> if the kernel version is 3.16 or
newer and no rules have been defined. Otherwise <code class="literal">unicast</code> will be used.</p>
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">resolve_ids</code></strong></span>
</span>
</dt>
<dd>
This boolean setting enables the resolution of UIDs and
GIDs to their associated names. The default value is true.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">failure_mode</code></strong></span>
</span>
</dt>
<dd>
This determines the kernel&#8217;s behavior on critical
failures such as errors sending events to Auditbeat, the backlog limit was
exceeded, the kernel ran out of memory, or the rate limit was exceeded. The
options are <code class="literal">silent</code>, <code class="literal">log</code>, or <code class="literal">panic</code>. <code class="literal">silent</code> basically makes the kernel
ignore the errors, <code class="literal">log</code> makes the kernel write the audit messages using
<code class="literal">printk</code> so they show up in system&#8217;s syslog, and <code class="literal">panic</code> causes the kernel to
panic to prevent use of the machine. Auditbeat&#8217;s default is <code class="literal">silent</code>.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">backlog_limit</code></strong></span>
</span>
</dt>
<dd>
This controls the maximum number of audit messages
that will be buffered by the kernel.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">rate_limit</code></strong></span>
</span>
</dt>
<dd>
This sets a rate limit on the number of messages/sec
delivered by the kernel. The default is 0, which disables rate limiting.
Changing this value to anything other than zero can cause messages to be lost.
The preferred approach to reduce the messaging rate is be more selective in the
audit ruleset.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">include_raw_message</code></strong></span>
</span>
</dt>
<dd>
This boolean setting causes Auditbeat to
include each of the raw messages that contributed to the event in the document
as a field called <code class="literal">event.original</code>. The default value is false. This setting is
primarily used for development and debugging purposes.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">include_warnings</code></strong></span>
</span>
</dt>
<dd>
This boolean setting causes Auditbeat to
include as warnings any issues that were encountered while parsing the raw
messages. The messages are written to the <code class="literal">error.message</code> field. The default
value is false. When this setting is enabled the raw messages will be included
in the event regardless of the <code class="literal">include_raw_message</code> config setting. This
setting is primarily used for development and debugging purposes.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">audit_rules</code></strong></span>
</span>
</dt>
<dd>
A string containing the audit rules that should be
installed to the kernel. There should be one rule per line. Comments can be
embedded in the string using <code class="literal">#</code> as a prefix. The format for rules is the same
used by the Linux <code class="literal">auditctl</code> utility. Auditbeat supports adding file watches
(<code class="literal">-w</code>) and syscall rules (<code class="literal">-a</code> or <code class="literal">-A</code>). For more information, see
<a class="xref" href="auditbeat-module-auditd.html#audit-rules" title="Audit rules">Audit rules</a>.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">audit_rule_files</code></strong></span>
</span>
</dt>
<dd>
A list of files to load audit rules from. This files are
loaded after the rules declared in <code class="literal">audit_rules</code> are loaded. Wildcards are
supported and will expand in lexicographical order. The format is the same as
that of the <code class="literal">audit_rules</code> field.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">backpressure_strategy</code></strong></span>
</span>
</dt>
<dd>
<p>
Specifies the strategy that Auditbeat uses to
prevent backpressure from propagating to the kernel and impacting audited
processes.
</p>
<p>The possible values are:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">auto</code> (default): Auditbeat uses the <code class="literal">kernel</code> strategy, if supported, or
falls back to the <code class="literal">userspace</code> strategy.
</li>
<li class="listitem">
<code class="literal">kernel</code>: Auditbeat sets the <code class="literal">backlog_wait_time</code> in the kernel&#8217;s
audit framework to 0. This causes events to be discarded in the kernel if
the audit backlog queue fills to capacity. Requires a 3.14 kernel or
newer.
</li>
<li class="listitem">
<code class="literal">userspace</code>: Auditbeat drops events when there is backpressure
from the publishing pipeline. If no <code class="literal">rate_limit</code> is set, Auditbeat sets a rate
limit of 5000. Users should test their setup and adjust the <code class="literal">rate_limit</code>
option accordingly.
</li>
<li class="listitem">
<code class="literal">both</code>: Auditbeat uses the <code class="literal">kernel</code> and <code class="literal">userspace</code> strategies at the same
time.
</li>
<li class="listitem">
<code class="literal">none</code>: No backpressure mitigation measures are enabled.
</li>
</ul>
</div>
</dd>
</dl>
</div>
<h4><a id="module-standard-options-auditd"></a>Standard configuration options<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.5/auditbeat/docs/auditbeat-options.asciidoc">edit</a></h4>
<p>You can specify the following options for any Auditbeat module.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">module</code></strong></span>
</span>
</dt>
<dd>
The name of the module to run.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">enabled</code></strong></span>
</span>
</dt>
<dd>
A Boolean value that specifies whether the module is enabled.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">fields</code></strong></span>
</span>
</dt>
<dd>
A dictionary of fields that will be sent with the dataset event. This setting
is optional.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">tags</code></strong></span>
</span>
</dt>
<dd>
A list of tags that will be sent with the dataset event. This setting is
optional.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">processors</code></strong></span>
</span>
</dt>
<dd>
<p>
A list of processors to apply to the data generated by the dataset.
</p>
<p>See <a class="xref" href="filtering-and-enhancing-data.html" title="Filter and enhance the exported data"><em>Filter and enhance the exported data</em></a> for information about specifying
processors in your config.</p>
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">index</code></strong></span>
</span>
</dt>
<dd>
<p>
If present, this formatted string overrides the index for events from this
module (for elasticsearch outputs), or sets the <code class="literal">raw_index</code> field of the event&#8217;s
metadata (for other outputs). This string can only refer to the agent name and
version and the event timestamp; for access to dynamic fields, use
<code class="literal">output.elasticsearch.index</code> or a processor.
</p>
<p>Example value: <code class="literal">"%{[agent.name]}-myindex-%{+yyyy.MM.dd}"</code> might
expand to <code class="literal">"auditbeat-myindex-2019.12.13"</code>.</p>
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">keep_null</code></strong></span>
</span>
</dt>
<dd>
If this option is set to true, fields with <code class="literal">null</code> values will be published in
the output document. By default, <code class="literal">keep_null</code> is set to <code class="literal">false</code>.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">service.name</code></strong></span>
</span>
</dt>
<dd>
A name given by the user to the service the data is collected from. It can be
used for example to identify information collected from nodes of different
clusters with the same <code class="literal">service.type</code>.
</dd>
</dl>
</div>
<h3><a id="audit-rules"></a>Audit rules<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.5/auditbeat/docs/modules/auditd.asciidoc">edit</a></h3>
<p>The audit rules are where you configure the activities that are audited. These
rules are configured as either syscalls or files that should be monitored. For
example you can track all <code class="literal">connect</code> syscalls or file system writes to
<code class="literal">/etc/passwd</code>.</p>
<p>Auditing a large number of syscalls can place a heavy load on the system so
consider carefully the rules you define and try to apply filters in the rules
themselves to be as selective as possible.</p>
<p>The kernel evaluates the rules in the order in which they were defined so place
the most active rules first in order to speed up evaluation.</p>
<p>You can assign keys to each rule for better identification of the rule that
triggered an event and easier filtering later in Elasticsearch.</p>
<p>Defining any audit rules in the config causes Auditbeat to purge all
existing audit rules prior to adding the rules specified in the config.
Therefore it is unnecessary and unsupported to include a <code class="literal">-D</code> (delete all) rule.</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">auditbeat.modules:
- module: auditd
  audit_rules: |
    # Things that affect identity.
    -w /etc/group -p wa -k identity
    -w /etc/passwd -p wa -k identity
    -w /etc/gshadow -p wa -k identity
    -w /etc/shadow -p wa -k identity

    # Unauthorized access attempts to files (unsuccessful).
    -a always,exit -F arch=b32 -S open,creat,truncate,ftruncate,openat,open_by_handle_at -F exit=-EACCES -F auid&gt;=1000 -F auid!=4294967295 -F key=access
    -a always,exit -F arch=b32 -S open,creat,truncate,ftruncate,openat,open_by_handle_at -F exit=-EPERM -F auid&gt;=1000 -F auid!=4294967295 -F key=access
    -a always,exit -F arch=b64 -S open,truncate,ftruncate,creat,openat,open_by_handle_at -F exit=-EACCES -F auid&gt;=1000 -F auid!=4294967295 -F key=access
    -a always,exit -F arch=b64 -S open,truncate,ftruncate,creat,openat,open_by_handle_at -F exit=-EPERM -F auid&gt;=1000 -F auid!=4294967295 -F key=access</pre>
</div>
<h3><a id="_example_configuration"></a>Example configuration<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.5/auditbeat/docs/modules/auditd.asciidoc">edit</a></h3>
<p>The Auditd module supports the common configuration options that are
described under <a class="xref" href="configuration-auditbeat.html" title="Specify which modules to run">configuring Auditbeat</a>. Here
is an example configuration:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">auditbeat.modules:
- module: auditd
  # Load audit rules from separate files. Same format as audit.rules(7).
  audit_rule_files: [ '${path.config}/audit.rules.d/*.conf' ]
  audit_rules: |
    ## Define audit rules here.
    ## Create file watches (-w) or syscall audits (-a or -A). Uncomment these
    ## examples or add your own rules.

    ## If you are on a 64 bit platform, everything should be running
    ## in 64 bit mode. This rule will detect any use of the 32 bit syscalls
    ## because this might be a sign of someone exploiting a hole in the 32
    ## bit API.
    #-a always,exit -F arch=b32 -S all -F key=32bit-abi

    ## Executions.
    #-a always,exit -F arch=b64 -S execve,execveat -k exec

    ## External access (warning: these can be expensive to audit).
    #-a always,exit -F arch=b64 -S accept,bind,connect -F key=external-access

    ## Identity changes.
    #-w /etc/group -p wa -k identity
    #-w /etc/passwd -p wa -k identity
    #-w /etc/gshadow -p wa -k identity

    ## Unauthorized access attempts.
    #-a always,exit -F arch=b64 -S open,creat,truncate,ftruncate,openat,open_by_handle_at -F exit=-EACCES -k access
    #-a always,exit -F arch=b64 -S open,creat,truncate,ftruncate,openat,open_by_handle_at -F exit=-EPERM -k access</pre>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="auditbeat-modules.html">« Modules</a>
</span>
<span class="next">
<a href="auditbeat-module-file_integrity.html">File Integrity Module »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
