<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>SSL client fails to connect to Logstash | Auditbeat Reference [7.7] | Elastic</title>
<link rel="home" href="index.html" title="Auditbeat Reference [7.7]"/>
<link rel="up" href="faq.html" title="Common problems"/>
<link rel="prev" href="diff-logstash-beats.html" title="Not sure whether to use Logstash or Beats"/>
<link rel="next" href="monitoring-shows-fewer-than-expected-beats.html" title="Monitoring UI shows fewer Beats than expected"/>
<meta name="DC.type" content="Learn/Docs/Auditbeat/Reference/7.7"/>
<meta name="DC.subject" content="Auditbeat"/>
<meta name="DC.identifier" content="7.7"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!--BEGIN QUALTRICS WEBSITE FEEDBACK SNIPPET-->
    <script type='text/javascript'>
      (function(){var g=function(e,h,f,g){
      this.get=function(a){for(var a=a+"=",c=document.cookie.split(";"),b=0,e=c.length;b<e;b++){for(var d=c[b];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return null};
      this.set=function(a,c){var b="",b=new Date;b.setTime(b.getTime()+6048E5);b="; expires="+b.toGMTString();document.cookie=a+"="+c+b+"; path=/; "};
      this.check=function(){var a=this.get(f);if(a)a=a.split(":");else if(100!=e)"v"==h&&(e=Math.random()>=e/100?0:100),a=[h,e,0],this.set(f,a.join(":"));else return!0;var c=a[1];if(100==c)return!0;switch(a[0]){case "v":return!1;case "r":return c=a[2]%Math.floor(100/c),a[2]++,this.set(f,a.join(":")),!c}return!0};
      this.go=function(){if(this.check()){var a=document.createElement("script");a.type="text/javascript";a.src=g;document.body&&document.body.appendChild(a)}};
      this.start=function(){var a=this;window.addEventListener?window.addEventListener("load",function(){a.go()},!1):window.attachEvent&&window.attachEvent("onload",function(){a.go()})}};
      try{(new g(100,"r","QSI_S_ZN_emkP0oSe9Qrn7kF","https://znemkp0ose9qrn7kf-elastic.siteintercept.qualtrics.com/WRSiteInterceptEngine/?Q_ZID=ZN_emkP0oSe9Qrn7kF")).start()}catch(i){}})();
    </script><div id='ZN_emkP0oSe9Qrn7kF'><!--DO NOT REMOVE-CONTENTS PLACED HERE--></div>
    <!--END WEBSITE FEEDBACK SNIPPET-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <!-- Subnav -->
    <div>
      <div>
        <div class="tertiary-nav d-none d-md-block">
          <div class="container">
            <div class="p-t-b-15 d-flex justify-content-between nav-container">
              <div class="breadcrum-wrapper"><span><a href="/guide/" style="font-size: 14px; font-weight: 600; color: #000;">Docs</a></span></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container">
              <div class="row">
                <div class="col-xs-12 col-sm-8 col-md-8 guide-section">
                  <!-- start body -->
                  <div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Auditbeat Reference [7.7]</a></span>
»
<span class="breadcrumb-link"><a href="troubleshooting.html">Troubleshoot</a></span>
»
<span class="breadcrumb-link"><a href="faq.html">Common problems</a></span>
»
<span class="breadcrumb-node">SSL client fails to connect to Logstash</span>
</div>
<div class="navheader">
<span class="prev">
<a href="diff-logstash-beats.html">« Not sure whether to use Logstash or Beats</a>
</span>
<span class="next">
<a href="monitoring-shows-fewer-than-expected-beats.html">Monitoring UI shows fewer Beats than expected »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="ssl-client-fails"></a>SSL client fails to connect to Logstash<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.7/libbeat/docs/shared-faq.asciidoc">edit</a></h2>
</div></div></div>
<p>The host running Logstash might be unreachable or the certificate may not be valid. To resolve your issue:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Make sure that Logstash is running and you can connect to it. First, try to ping the Logstash host to verify that you can reach it
from the host running Auditbeat. Then use either <code class="literal">nc</code> or <code class="literal">telnet</code> to make sure that the port is available. For example:</p>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">ping &lt;hostname or IP&gt;
telnet &lt;hostname or IP&gt; 5044</pre>
</div>
</li>
<li class="listitem">
<p>Verify that the certificate is valid and that the hostname and IP match.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>For testing purposes only, you can set <code class="literal">verification_mode: none</code> to disable hostname checking.</p>
</div>
</div>
</li>
<li class="listitem">
Use OpenSSL to test connectivity to the Logstash server and diagnose problems. See the <a href="https://www.openssl.org/docs/manmaster/apps/s_client.html" class="ulink" target="_top">OpenSSL documentation</a> for more info.
</li>
<li class="listitem">
Make sure that you have enabled SSL (set <code class="literal">ssl =&gt; true</code>) when configuring the <a href="/guide/en/logstash/current/plugins-inputs-beats.html" class="ulink" target="_top">Beats input plugin for Logstash</a>.
</li>
</ul>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_common_ssl_related_errors_and_resolutions"></a>Common SSL-Related Errors and Resolutions<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.7/libbeat/docs/shared-faq.asciidoc">edit</a></h3>
</div></div></div>
<p>Here are some common errors and ways to fix them:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="ssl-client-fails.html#failed-to-parse-private-key" title="tls: failed to parse private key">tls: failed to parse private key</a>
</li>
<li class="listitem">
<a class="xref" href="ssl-client-fails.html#cannot-validate-certificate" title="x509: cannot validate certificate for &lt;IP address&gt; because it doesn&#8217;t contain any IP SANs">x509: cannot validate certificate</a>
</li>
<li class="listitem">
<a class="xref" href="ssl-client-fails.html#getsockopt-no-route-to-host" title="getsockopt: no route to host">getsockopt: no route to host</a>
</li>
<li class="listitem">
<a class="xref" href="ssl-client-fails.html#getsockopt-connection-refused" title="getsockopt: connection refused">getsockopt: connection refused</a>
</li>
<li class="listitem">
<a class="xref" href="ssl-client-fails.html#target-machine-refused-connection" title="No connection could be made because the target machine actively refused it">No connection could be made because the target machine actively refused it</a>
</li>
</ul>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="failed-to-parse-private-key"></a>tls: failed to parse private key<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.7/libbeat/docs/shared-faq.asciidoc">edit</a></h4>
</div></div></div>
<p>This might occur for a few reasons:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
The encrypted file is not recognized as an encrypted PEM block. Auditbeat
tries to use the encrypted content as the final key, which fails.
</li>
<li class="listitem">
The file is correctly encrypted in a PEM block, but the decrypted content is
not a key in a format that Auditbeat recognizes. The key must be encoded as
PEM format.
</li>
<li class="listitem">
The passphrase is missing or has an error.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="cannot-validate-certificate"></a>x509: cannot validate certificate for &lt;IP address&gt; because it doesn&#8217;t contain any IP SANs<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.7/libbeat/docs/shared-faq.asciidoc">edit</a></h4>
</div></div></div>
<p>This happens because your certificate is only valid for the hostname present in the Subject field.</p>
<p>To resolve this problem, try one of these solutions:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Create a DNS entry for the hostname mapping it to the server&#8217;s IP.
</li>
<li class="listitem">
Create an entry in <code class="literal">/etc/hosts</code> for the hostname. Or on Windows add an entry to
<code class="literal">C:\Windows\System32\drivers\etc\hosts</code>.
</li>
<li class="listitem">
Re-create the server certificate and add a SubjectAltName (SAN) for the IP address of the server. This make the
server&#8217;s certificate valid for both the hostname and the IP address.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="getsockopt-no-route-to-host"></a>getsockopt: no route to host<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.7/libbeat/docs/shared-faq.asciidoc">edit</a></h4>
</div></div></div>
<p>This is not a SSL problem. It&#8217;s a networking problem. Make sure the two hosts can communicate.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="getsockopt-connection-refused"></a>getsockopt: connection refused<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.7/libbeat/docs/shared-faq.asciidoc">edit</a></h4>
</div></div></div>
<p>This is not a SSL problem. Make sure that Logstash is running and that there is no firewall blocking the traffic.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="target-machine-refused-connection"></a>No connection could be made because the target machine actively refused it<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.7/libbeat/docs/shared-faq.asciidoc">edit</a></h4>
</div></div></div>
<p>A firewall is refusing the connection. Check if a firewall is blocking the traffic on the client, the network, or the
destination host.</p>
</div>

</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="diff-logstash-beats.html">« Not sure whether to use Logstash or Beats</a>
</span>
<span class="next">
<a href="monitoring-shows-fewer-than-expected-beats.html">Monitoring UI shows fewer Beats than expected »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>
                <div class="col-xs-12 col-sm-4 col-md-4" id="right_col">
                  <div id="rtpcontainer" style="display: block;">
                    <div class="mktg-promo">
                      <h3>Most Popular</h3>
                      <ul class="icons">
                        <li class="icon-elasticsearch-white"><a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">Get Started with Elasticsearch: Video</a></li>
                        <li class="icon-kibana-white"><a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">Intro to Kibana: Video</a></li>
                        <li class="icon-logstash-white"><a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">ELK for Logs & Metrics: Video</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";
	var localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}';
</script>
<script src="/static/js/swiftype_app_search.umd.min.js"></script>
<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
