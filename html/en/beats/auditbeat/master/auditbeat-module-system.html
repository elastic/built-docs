<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>System Module | Auditbeat Reference [master] | Elastic</title>
<meta class="elastic" name="content" content="System Module | Auditbeat Reference [master]">

<link rel="home" href="index.html" title="Auditbeat Reference [master]"/>
<link rel="up" href="auditbeat-modules.html" title="Modules"/>
<link rel="prev" href="auditbeat-module-file_integrity.html" title="File Integrity Module"/>
<link rel="next" href="auditbeat-dataset-system-host.html" title="System host dataset"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="Auditbeat"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Auditbeat/Reference/master"/>
<meta name="DC.subject" content="Auditbeat"/>
<meta name="DC.identifier" content="master"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <!--© 2015-2022 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  <div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Auditbeat Reference [master]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="auditbeat-modules.html">Modules</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="auditbeat-module-file_integrity.html">« File Integrity Module</a>
</span>
<span class="next">
<a href="auditbeat-dataset-system-host.html">System host dataset »</a>
</span>
</div>
<div class="chapter xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="auditbeat-module-system"></a>System Module<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/main/x-pack/auditbeat/docs/modules/system.asciidoc">edit</a></h2>
</div></div></div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in beta and is subject to change. The design and code is less mature than official GA features and is being provided as-is with no warranties. Beta features are not subject to the support SLA of official GA features.</p>
</div>
</div>
<p>The <code class="literal">system</code> module collects various security related information about
a system. All datasets send both periodic state information (e.g. all currently
running processes) and real-time changes (e.g. when a new process starts
or stops).</p>
<p>The module is fully implemented for Linux on x86. Currently, the <code class="literal">socket</code> module is not available on ARM. Some datasets are also available
for macOS (Darwin) and Windows.</p>
<h3><a id="_how_it_works_3"></a>How it works<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/main/x-pack/auditbeat/docs/modules/system.asciidoc">edit</a></h3>
<p>Each dataset sends two kinds of information: state and events.</p>
<p>State information is sent periodically and (for some datasets) on startup.
A state update will consist of one event per object that is currently
active on the system (e.g. a process). All events belonging to the same state
update will share the same UUID in <code class="literal">event.id</code>.</p>
<p>The frequency of state updates can be controlled for all datasets using the
<code class="literal">state.period</code> configuration option. Overrides are available per dataset.
The default is <code class="literal">12h</code>.</p>
<p>Event information is sent as the events occur (e.g. a process starts or stops).
All datasets are currently using a poll model to retrieve their data.
The frequency of these polls is controlled by the <code class="literal">period</code> configuration
parameter.</p>
<h4><a id="_entity_ids"></a>Entity IDs<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/main/x-pack/auditbeat/docs/modules/system.asciidoc">edit</a></h4>
<p>This module populates <code class="literal">entity_id</code> fields to uniquely identify entities (users,
packages, processes&#8230;&#8203;) within a host. This requires Auditbeat
to obtain a unique identifier for the host:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Windows: Uses the <code class="literal">HKLM\Software\Microsoft\Cryptography\MachineGuid</code> registry
key.
</li>
<li class="listitem">
macOS: Uses the value returned by <code class="literal">gethostuuid(2)</code> system call.
</li>
<li class="listitem">
<p>Linux: Uses the content of one of the following files, created by either
<code class="literal">systemd</code> or <code class="literal">dbus</code>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
/etc/machine-id
</li>
<li class="listitem">
/var/lib/dbus/machine-id
</li>
<li class="listitem">
/var/db/dbus/machine-id
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Under CentOS 6.x, it&#8217;s possible that none of the files above exist.
In that case, running <code class="literal">dbus-uuidgen --ensure</code> (provided by the <code class="literal">dbus</code> package)
will generate one for you.</p>
</div>
</div>
<h4><a id="_example_dashboard"></a>Example dashboard<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/main/x-pack/auditbeat/docs/modules/system.asciidoc">edit</a></h4>
<p>The module comes with a sample dashboard:</p>
<div class="imageblock screenshot">
<div class="content">
<img src="./images/auditbeat-system-overview-dashboard.png" alt="Auditbeat System Overview Dashboard">
</div>
</div>
<h3><a id="_configuration_options_18"></a>Configuration options<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/main/x-pack/auditbeat/docs/modules/system.asciidoc">edit</a></h3>
<p>This module has some configuration options for controlling its behavior. The
following example shows all configuration options with their default values for
Linux.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>It is recommended to configure some datasets separately. See below for a
sample suggested configuration.</p>
</div>
</div>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">- module: system
  datasets:
    - host
    - login
    - package
    - process
    - socket
    - user
  period: 10s
  state.period: 12h

  socket.include_localhost: false

  user.detect_password_changes: true</pre>
</div>
<p>This module also supports the
<a class="xref" href="auditbeat-module-system.html#module-standard-options-system" title="Standard configuration options">standard configuration options</a>
described later.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">state.period</code></strong></span>
</span>
</dt>
<dd>
The interval at which the datasets send full state information.
This option can be overridden per dataset using <code class="literal">{dataset}.state.period</code>.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">user.detect_password_changes</code></strong></span>
</span>
</dt>
<dd>
If the <code class="literal">user</code> dataset is configured and
this option is set to <code class="literal">true</code>, Auditbeat will read password information in <code class="literal">/etc/passwd</code>
and <code class="literal">/etc/shadow</code> to detect password changes. A hash will be kept locally in
the <code class="literal">beat.db</code> file to detect changes between Auditbeat restarts. The <code class="literal">beat.db</code> file
should be readable only by the root user and be treated similar to the shadow file
itself.
</dd>
</dl>
</div>
<h4><a id="module-standard-options-system"></a>Standard configuration options<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/main/auditbeat/docs/auditbeat-options.asciidoc">edit</a></h4>
<p>You can specify the following options for any Auditbeat module.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">module</code></strong></span>
</span>
</dt>
<dd>
The name of the module to run.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">datasets</code></strong></span>
</span>
</dt>
<dd>
A list of datasets to execute.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">enabled</code></strong></span>
</span>
</dt>
<dd>
A Boolean value that specifies whether the module is enabled.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">period</code></strong></span>
</span>
</dt>
<dd>
The frequency at which the datasets check for changes. If a system
is not reachable, Auditbeat returns an error for each period. This setting
is required. For most datasets, especially <code class="literal">process</code> and <code class="literal">socket</code>, a shorter
period is recommended.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">fields</code></strong></span>
</span>
</dt>
<dd>
A dictionary of fields that will be sent with the dataset event. This setting
is optional.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">tags</code></strong></span>
</span>
</dt>
<dd>
A list of tags that will be sent with the dataset event. This setting is
optional.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">processors</code></strong></span>
</span>
</dt>
<dd>
<p>
A list of processors to apply to the data generated by the dataset.
</p>
<p>See <a class="xref" href="filtering-and-enhancing-data.html" title="Filter and enhance data with processors"><em>Processors</em></a> for information about specifying
processors in your config.</p>
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">index</code></strong></span>
</span>
</dt>
<dd>
<p>
If present, this formatted string overrides the index for events from this
module (for elasticsearch outputs), or sets the <code class="literal">raw_index</code> field of the event&#8217;s
metadata (for other outputs). This string can only refer to the agent name and
version and the event timestamp; for access to dynamic fields, use
<code class="literal">output.elasticsearch.index</code> or a processor.
</p>
<p>Example value: <code class="literal">"%{[agent.name]}-myindex-%{+yyyy.MM.dd}"</code> might
expand to <code class="literal">"auditbeat-myindex-2019.12.13"</code>.</p>
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">keep_null</code></strong></span>
</span>
</dt>
<dd>
If this option is set to true, fields with <code class="literal">null</code> values will be published in
the output document. By default, <code class="literal">keep_null</code> is set to <code class="literal">false</code>.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">service.name</code></strong></span>
</span>
</dt>
<dd>
A name given by the user to the service the data is collected from. It can be
used for example to identify information collected from nodes of different
clusters with the same <code class="literal">service.type</code>.
</dd>
</dl>
</div>
<h3><a id="_suggested_configuration"></a>Suggested configuration<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/main/x-pack/auditbeat/docs/modules/system.asciidoc">edit</a></h3>
<p>Processes and sockets can be short-lived, so the chance of missing an update
increases if the polling interval is too large.</p>
<p>On the other hand, host and user information is unlikely to change frequently,
so a longer polling interval can be used.</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">- module: system
  datasets:
    - host
    - login
    - package
    - user
  period: 1m

  user.detect_password_changes: true

- module: system
  datasets:
    - process
    - socket
  period: 1s</pre>
</div>
<h3><a id="_example_configuration_3"></a>Example configuration<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/main/x-pack/auditbeat/docs/modules/system.asciidoc">edit</a></h3>
<p>The System module supports the common configuration options that are
described under <a class="xref" href="configuration-auditbeat.html" title="Configure modules">configuring Auditbeat</a>. Here
is an example configuration:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">auditbeat.modules:
- module: system
  datasets:
    - package # Installed, updated, and removed packages

  period: 2m # The frequency at which the datasets check for changes

- module: system
  datasets:
    - host    # General host information, e.g. uptime, IPs
    - login   # User logins, logouts, and system boots.
    - process # Started and stopped processes
    - socket  # Opened and closed sockets
    - user    # User information

  # How often datasets send state updates with the
  # current state of the system (e.g. all currently
  # running processes, all open sockets).
  state.period: 12h

  # Enabled by default. Auditbeat will read password fields in
  # /etc/passwd and /etc/shadow and store a hash locally to
  # detect any changes.
  user.detect_password_changes: true

  # File patterns of the login record files.
  login.wtmp_file_pattern: /var/log/wtmp*
  login.btmp_file_pattern: /var/log/btmp*</pre>
</div>
<h3><a id="_datasets"></a>Datasets<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/main/x-pack/auditbeat/docs/modules/system.asciidoc">edit</a></h3>
<p>The following datasets are available:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="auditbeat-dataset-system-host.html" title="System host dataset">host</a>
</li>
<li class="listitem">
<a class="xref" href="auditbeat-dataset-system-login.html" title="System login dataset">login</a>
</li>
<li class="listitem">
<a class="xref" href="auditbeat-dataset-system-package.html" title="System package dataset">package</a>
</li>
<li class="listitem">
<a class="xref" href="auditbeat-dataset-system-process.html" title="System process dataset">process</a>
</li>
<li class="listitem">
<a class="xref" href="auditbeat-dataset-system-socket.html" title="System socket dataset">socket</a>
</li>
<li class="listitem">
<a class="xref" href="auditbeat-dataset-system-user.html" title="System user dataset">user</a>
</li>
</ul>
</div>






</div>
<div class="navfooter">
<span class="prev">
<a href="auditbeat-module-file_integrity.html">« File Integrity Module</a>
</span>
<span class="next">
<a href="auditbeat-dataset-system-host.html">System host dataset »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
