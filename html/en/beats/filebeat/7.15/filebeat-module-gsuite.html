<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>GSuite module | Filebeat Reference [7.15] | Elastic</title>
<link rel="home" href="index.html" title="Filebeat Reference [7.15]"/>
<link rel="up" href="filebeat-modules.html" title="Modules"/>
<link rel="prev" href="filebeat-module-google_workspace.html" title="Google Workspace module"/>
<link rel="next" href="filebeat-module-haproxy.html" title="HAproxy module"/>
<meta name="DC.type" content="Learn/Docs/Filebeat/Reference/7.15"/>
<meta name="DC.subject" content="Filebeat"/>
<meta name="DC.identifier" content="7.15"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <!--© 2015-2022 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!--BEGIN QUALTRICS WEBSITE FEEDBACK SNIPPET-->
    <script type='text/javascript'>
      (function(){var g=function(e,h,f,g){
      this.get=function(a){for(var a=a+"=",c=document.cookie.split(";"),b=0,e=c.length;b<e;b++){for(var d=c[b];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return null};
      this.set=function(a,c){var b="",b=new Date;b.setTime(b.getTime()+6048E5);b="; expires="+b.toGMTString();document.cookie=a+"="+c+b+"; path=/; "};
      this.check=function(){var a=this.get(f);if(a)a=a.split(":");else if(100!=e)"v"==h&&(e=Math.random()>=e/100?0:100),a=[h,e,0],this.set(f,a.join(":"));else return!0;var c=a[1];if(100==c)return!0;switch(a[0]){case "v":return!1;case "r":return c=a[2]%Math.floor(100/c),a[2]++,this.set(f,a.join(":")),!c}return!0};
      this.go=function(){if(this.check()){var a=document.createElement("script");a.type="text/javascript";a.src=g;document.body&&document.body.appendChild(a)}};
      this.start=function(){var a=this;window.addEventListener?window.addEventListener("load",function(){a.go()},!1):window.attachEvent&&window.attachEvent("onload",function(){a.go()})}};
      try{(new g(100,"r","QSI_S_ZN_emkP0oSe9Qrn7kF","https://znemkp0ose9qrn7kf-elastic.siteintercept.qualtrics.com/WRSiteInterceptEngine/?Q_ZID=ZN_emkP0oSe9Qrn7kF")).start()}catch(i){}})();
    </script><div id='ZN_emkP0oSe9Qrn7kF'><!--DO NOT REMOVE-CONTENTS PLACED HERE--></div>
    <!--END WEBSITE FEEDBACK SNIPPET-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  <div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="index.html">Filebeat Reference [7.15]</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="filebeat-modules.html">Modules</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="filebeat-module-google_workspace.html">« Google Workspace module</a>
</span>
<span class="next">
<a href="filebeat-module-haproxy.html">HAproxy module »</a>
</span>
</div>
<div class="chapter xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="filebeat-module-gsuite"></a>GSuite module<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.15/filebeat/docs/modules/gsuite.asciidoc">edit</a></h2>
</div></div></div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in beta and is subject to change. The design and code is less mature than official GA features and is being provided as-is with no warranties. Beta features are not subject to the support SLA of official GA features.</p>
</div>
</div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>Deprecated in 7.12.</p>
</div>
</div>
<p>This is a module for ingesting data from the different GSuite audit reports API&#8217;s.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>Read the <a class="xref" href="filebeat-installation-configuration.html" title="Filebeat quick start: installation and configuration">quick start</a> to learn
how to configure and run modules.</p>
</div>
</div>
<h3><a id="_compatibility_14"></a>Compatibility<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.15/filebeat/docs/modules/gsuite.asciidoc">edit</a></h3>
<p>It is compatible with a subset of applications under the <a href="https://developers.google.com/admin-sdk/reports/v1/get-start/getting-started" class="ulink" target="_top">Google Reports API v1</a>. As of today it supports:</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">GSuite Service</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top"></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>SAML <a href="https://developers.google.com/admin-sdk/reports/v1/appendix/activity/saml" class="ulink" target="_top">api docs</a> <a href="https://support.google.com/a/answer/7007375?hl=en&amp;ref_topic=9027054" class="ulink" target="_top">help</a></p></td>
<td align="left" valign="top"><p>View users’ successful and failed sign-ins to SAML applications.</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>User Accounts <a href="https://developers.google.com/admin-sdk/reports/v1/appendix/activity/user-accounts" class="ulink" target="_top">api docs</a> <a href="https://support.google.com/a/answer/9022875?hl=en&amp;ref_topic=9027054" class="ulink" target="_top">help</a></p></td>
<td align="left" valign="top"><p>Audit actions carried out by users on their own accounts including password changes, account recovery details and 2-Step Verification enrollment.</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Login <a href="https://developers.google.com/admin-sdk/reports/v1/appendix/activity/login" class="ulink" target="_top">api docs</a> <a href="https://support.google.com/a/answer/4580120?hl=en&amp;ref_topic=9027054" class="ulink" target="_top">help</a></p></td>
<td align="left" valign="top"><p>Track user sign-in activity to your domain.</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Admin <a href="https://developers.google.com/admin-sdk/reports/v1/appendix/activity/admin-application-settings" class="ulink" target="_top">api docs</a> <a href="https://support.google.com/a/answer/4579579?hl=en&amp;ref_topic=9027054" class="ulink" target="_top">help</a></p></td>
<td align="left" valign="top"><p>View administrator activity performed within the Google Admin console.</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Drive <a href="https://developers.google.com/admin-sdk/reports/v1/appendix/activity/drive" class="ulink" target="_top">api docs</a> <a href="https://support.google.com/a/answer/4579696?hl=en&amp;ref_topic=9027054" class="ulink" target="_top">help</a></p></td>
<td align="left" valign="top"><p>Record user activity within Google Drive including content creation in such as Google Docs, as well as content created elsewhere that your users upload to Drive such as PDFs and Microsoft Word files.</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Groups <a href="https://developers.google.com/admin-sdk/reports/v1/appendix/activity/groups" class="ulink" target="_top">api docs</a> <a href="https://support.google.com/a/answer/6270454?hl=en&amp;ref_topic=9027054" class="ulink" target="_top">help</a></p></td>
<td align="left" valign="top"><p>Track changes to groups, group memberships and group messages.</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
</tbody>
</table>
</div>
<h3><a id="_configure_the_module_2"></a>Configure the module<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.15/filebeat/docs/modules/gsuite.asciidoc">edit</a></h3>
<p>In order for Filebeat to ingest data from the Google Reports API you must:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Have an <span class="strong strong"><strong>administrator account</strong></span>.
</li>
<li class="listitem">
<a href="https://support.google.com/gsuitemigrate/answer/9222993?hl=en" class="ulink" target="_top">Set up a ServiceAccount</a> using the administrator account.
</li>
<li class="listitem">
<a href="https://support.google.com/gsuitemigrate/answer/9222865?hl=en" class="ulink" target="_top">Set up access to the Admin SDK API</a> for the ServiceAccount.
</li>
<li class="listitem">
<a href="https://developers.google.com/admin-sdk/reports/v1/guides/delegation" class="ulink" target="_top">Enable Domain-Wide Delegation</a> for your ServiceAccount.
</li>
</ul>
</div>
<p>This module will make use of the following <span class="strong strong"><strong>oauth2 scope</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">https://www.googleapis.com/auth/admin.reports.audit.readonly</code>
</li>
</ul>
</div>
<p>Once you have downloaded your service account credentials as a JSON file,
you can set up your module:</p>
<h5><a id="_configuration_options_33"></a>Configuration options<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.15/filebeat/docs/modules/gsuite.asciidoc">edit</a></h5>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">- module: gsuite
  saml:
    enabled: true
    var.jwt_file: "./credentials_file.json"
    var.delegated_account: "user@example.com"
  user_accounts:
    enabled: true
    var.jwt_file: "./credentials_file.json"
    var.delegated_account: "user@example.com"
  login:
    enabled: true
    var.jwt_file: "./credentials_file.json"
    var.delegated_account: "user@example.com"
  admin:
    enabled: true
    var.jwt_file: "./credentials_file.json"
    var.delegated_account: "user@example.com"
  drive:
    enabled: true
    var.jwt_file: "./credentials_file.json"
    var.delegated_account: "user@example.com"
  groups:
    enabled: true
    var.jwt_file: "./credentials_file.json"
    var.delegated_account: "user@example.com"</pre>
</div>
<p>Every fileset has the following configuration options:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">var.jwt_file</code></strong></span>
</span>
</dt>
<dd>
Specifies the path to the JWT credentials file.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">var.delegated_account</code></strong></span>
</span>
</dt>
<dd>
Email of the admin user used to access the API.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">var.http_client_timeout</code></strong></span>
</span>
</dt>
<dd>
Duration of the time limit on HTTP requests made by the module. Defaults to
<code class="literal">60s</code>.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">var.interval</code></strong></span>
</span>
</dt>
<dd>
Duration between requests to the API. Defaults to <code class="literal">2h</code>.
</dd>
</dl>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>GSuite defaults to a 2 hour polling interval because Google reports can go from
some minutes up to 3 days of delay. For more details on this, you can read more <a href="https://support.google.com/a/answer/7061566" class="ulink" target="_top">here</a>.</p>
</div>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">var.user_key</code></strong></span>
</span>
</dt>
<dd>
Specifies the user key to fetch reports from. Defaults to <code class="literal">all</code>.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">var.initial_interval</code></strong></span>
</span>
</dt>
<dd>
It will poll events up to this time period when the module starts. This is to prevent polling too many or repeated events on module restarts. Defaults to <code class="literal">24h</code>.
</dd>
</dl>
</div>
<h4><a id="_gsuite_reports_ecs_fields"></a>GSuite Reports ECS fields<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.15/filebeat/docs/modules/gsuite.asciidoc">edit</a></h4>
<p>This is a list of GSuite Reports fields that are mapped to ECS.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">GSuite Reports</th>
<th align="left" valign="top">ECS Fields</th>
<th align="left" valign="top"></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">items[].id.time</code></p></td>
<td align="left" valign="top"><p><code class="literal">@timestamp</code></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">items[].id.uniqueQualifier</code></p></td>
<td align="left" valign="top"><p><code class="literal">event.id</code></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">items[].id.applicationName</code></p></td>
<td align="left" valign="top"><p><code class="literal">event.provider</code></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">items[].events[].name</code></p></td>
<td align="left" valign="top"><p><code class="literal">event.action</code></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">items[].customerId</code></p></td>
<td align="left" valign="top"><p><code class="literal">organization.id</code></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">items[].ipAddress</code></p></td>
<td align="left" valign="top"><p><code class="literal">source.ip</code>, related.ip`, <code class="literal">source.as.*</code>, <code class="literal">source.geo.*</code></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">items[].actor.email</code></p></td>
<td align="left" valign="top"><p><code class="literal">source.user.email</code>, <code class="literal">source.user.name</code>, <code class="literal">source.user.domain</code></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">items[].actor.profileId</code></p></td>
<td align="left" valign="top"><p><code class="literal">source.user.id</code></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
</tbody>
</table>
</div>
<p>These are the common ones to all filesets.</p>
<h3><a id="_fields_25"></a>Fields<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.15/filebeat/docs/modules/gsuite.asciidoc">edit</a></h3>
<p>For a description of each field in the module, see the
<a class="xref" href="exported-fields-gsuite.html" title="gsuite fields">exported fields</a> section.</p>
</div>
<div class="navfooter">
<span class="prev">
<a href="filebeat-module-google_workspace.html">« Google Workspace module</a>
</span>
<span class="next">
<a href="filebeat-module-haproxy.html">HAproxy module »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
