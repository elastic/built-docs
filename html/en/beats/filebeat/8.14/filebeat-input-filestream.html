<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>filestream input | Filebeat Reference [8.14] | Elastic</title>
<meta class="elastic" name="content" content="filestream input | Filebeat Reference [8.14]">

<link rel="home" href="index.html" title="Filebeat Reference [8.14]"/>
<link rel="up" href="configuration-filebeat-options.html" title="Configure inputs"/>
<link rel="prev" href="filebeat-input-etw.html" title="ETW input"/>
<link rel="next" href="filebeat-input-gcp-pubsub.html" title="GCP Pub/Sub input"/>
<meta class="elastic" name="product_version" content="8.14"/>
<meta class="elastic" name="product_name" content="Filebeat"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Filebeat/Reference/8.14"/>
<meta name="DC.subject" content="Filebeat"/>
<meta name="DC.identifier" content="8.14"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles-v1.css" />
  </head>

  <!--© 2015-2025 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div class="navheader">
<span class="prev">
<a href="filebeat-input-etw.html">« ETW input</a>
</span>
<span class="next">
<a href="filebeat-input-gcp-pubsub.html">GCP Pub/Sub input »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Filebeat Reference [8.14]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="configuring-howto-filebeat.html">Configure Filebeat</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="configuration-filebeat-options.html">Configure inputs</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>filestream input</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-filestream.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="filebeat-input-filestream"></a>filestream input<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-filestream.asciidoc">edit</a></h2>
</div></div></div>

<p>Use the <code class="literal">filestream</code> input to read lines from active log files. It is the
new, improved alternative to the <code class="literal">log</code> input. It comes with various improvements
to the existing input:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Checking of <code class="literal">close.on_state_change.*</code> options happens out of
band. Thus, if an output is blocked, Filebeat can close the
reader and avoid keeping too many files open.
</li>
<li class="listitem">
Detailed metrics are available for all files that match the <code class="literal">paths</code> configuration
regardless of the <code class="literal">harvester_limit</code>. This way, you can keep track of all files,
even ones that are not actively read.
</li>
<li class="listitem">
The order of <code class="literal">parsers</code> is configurable. So it is possible to parse JSON lines and then
aggregate the contents into a multiline event.
</li>
<li class="listitem">
Some position updates and metadata changes no longer depend on the publishing pipeline.
If the pipeline is blocked some changes are still applied to the registry.
</li>
<li class="listitem">
Only the most recent updates are serialized to the registry. In contrast, the <code class="literal">log</code> input
has to serialize the complete registry on each ACK from the outputs. This makes the registry updates
much quicker with this input.
</li>
<li class="listitem">
The input ensures that only offsets updates are written to the registry append only log.
The <code class="literal">log</code> writes the complete file state.
</li>
<li class="listitem">
Stale entries can be removed from the registry, even if there is no active input.
</li>
</ol>
</div>
<p>To configure this input, specify a list of glob-based <a class="xref" href="filebeat-input-filestream.html#filestream-input-paths" title="paths"><code class="literal">paths</code></a>
that must be crawled to locate and fetch the log lines.</p>
<p>Example configuration:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: filestream
  id: my-filestream-id
  paths:
    - /var/log/messages
    - /var/log/*.log</pre>
</div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>Each filestream input must have a unique ID. Omitting or changing the filestream ID may cause
data duplication. Without a unique ID, filestream is unable to correctly track the state of files.</p>
</div>
</div>
<p>You can apply additional
<a class="xref" href="filebeat-input-filestream.html#filebeat-input-filestream-options" title="Prospector options">configuration settings</a> (such as <code class="literal">fields</code>,
<code class="literal">include_lines</code>, <code class="literal">exclude_lines</code> and so on) to the lines harvested
from these files. The options that you specify are applied to all the files
harvested by this input.</p>
<p>To apply different configuration settings to different files, you need to define
multiple input sections:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: filestream <a id="CO14-1"></a><i class="conum" data-value="1"></i>
  id: my-filestream-id
  paths:
    - /var/log/system.log
    - /var/log/wifi.log
- type: filestream <a id="CO14-2"></a><i class="conum" data-value="2"></i>
  id: apache-filestream-id
  paths:
    - "/var/log/apache2/*"
  fields:
    apache: true</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO14-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Harvests lines from two files:  <code class="literal">system.log</code> and
<code class="literal">wifi.log</code>.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO14-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>Harvests lines from every file in the <code class="literal">apache2</code> directory, and uses the
<code class="literal">fields</code> configuration option to add a field called <code class="literal">apache</code> to the output.</p>
</td>
</tr>
</table>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="filestream-file-identity"></a>Reading files on network shares and cloud providers<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-filestream.asciidoc">edit</a></h3>
</div></div></div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>Filebeat does not support reading from network shares and cloud providers.</p>
</div>
</div>
<p>However, one of the limitations of these data sources can be mitigated
if you configure Filebeat adequately.</p>
<p>By default, Filebeat identifies files based on their inodes and
device IDs. However, on network shares and cloud providers these
values might change during the lifetime of the file. If this happens
Filebeat thinks that file is new and resends the whole content
of the file. To solve this problem you can configure the <code class="literal">file_identity</code> option. Possible
values besides the default <code class="literal">inode_deviceid</code> are <code class="literal">path</code>, <code class="literal">inode_marker</code> and <code class="literal">fingerprint</code>.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>Changing <code class="literal">file_identity</code> methods between runs may result in
duplicated events in the output.</p>
</div>
</div>
<p>Selecting <code class="literal">path</code> instructs Filebeat to identify files based on their
paths. This is a quick way to avoid rereading files if inode and device ids
might change. However, keep in mind if the files are rotated (renamed), they
will be reread and resubmitted.</p>
<p>The option <code class="literal">inode_marker</code> can be used if the inodes stay the same even if
the device id is changed. You should choose this method if your files are
rotated instead of <code class="literal">path</code> if possible. You have to configure a marker file
readable by Filebeat and set the path in the option <code class="literal">path</code> of <code class="literal">inode_marker</code>.</p>
<p>The content of this file must be unique to the device. You can put the
UUID of the device or mountpoint where the input is stored. The following
example oneliner generates a hidden marker file for the selected mountpoint <code class="literal">/logs</code>:
Please note that you should not use this option on Windows as file identifiers might be
more volatile.</p>
<p>Selecting <code class="literal">fingerprint</code> instructs Filebeat to identify files based on their
content byte range.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>In order to use this file identity option, one must enable the <a class="xref" href="filebeat-input-filestream.html#filebeat-input-filestream-scan-fingerprint" title="prospector.scanner.fingerprint">fingerprint option in the scanner</a>. Once this file identity is enabled, changing the fingerprint configuration (offset, length, etc) will lead to a global re-ingestion of all files that match the paths configuration of the input.</p>
</div>
</div>
<p>Please refer to the <a class="xref" href="filebeat-input-filestream.html#filebeat-input-filestream-scan-fingerprint" title="prospector.scanner.fingerprint">fingerprint configuration for details</a>.</p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">$ lsblk -o MOUNTPOINT,UUID | grep /logs | awk '{print $2}' &gt;&gt; /logs/.filebeat-marker</pre>
</div>
<p>To set the generated file as a marker for <code class="literal">file_identity</code> you should configure
the input the following way:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: filestream
  id: my-filestream-id
  paths:
    - /logs/*.log
  file_identity.inode_marker.path: /logs/.filebeat-marker</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="filestream-rotating-logs"></a>Reading from rotating logs<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-filestream.asciidoc">edit</a></h3>
</div></div></div>
<p>When dealing with file rotation, avoid harvesting symlinks. Instead
use the <a class="xref" href="filebeat-input-filestream.html#filestream-input-paths" title="paths"><code class="literal">paths</code></a> setting to point to the original file, and specify
a pattern that matches the file you want to harvest and all of its rotated
files. Also make sure your log rotation strategy prevents lost or duplicate
messages. For more information, see <a class="xref" href="file-log-rotation.html" title="Log rotation results in lost or duplicate events">Log rotation results in lost or duplicate events</a>.</p>
<p>Furthermore, to avoid duplicate of rotated log messages, do not use the
<code class="literal">path</code> method for <code class="literal">file_identity</code>. Or exclude the rotated files with <code class="literal">exclude_files</code>
option.</p>
<h3><a id="filebeat-input-filestream-options"></a>Prospector options<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-filestream-file-options.asciidoc">edit</a></h3>
<p>The prospector is running a file system watcher which looks for files specified
in the <code class="literal">paths</code> option. At the moment only simple file system scanning is
supported.</p>
<h5><a id="filestream-input-id"></a><code class="literal">id</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-filestream-file-options.asciidoc">edit</a></h5>
<p>A unique identifier for this filestream input. Each filestream input
must have a unique ID.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>Changing input ID may cause data duplication because the
state of the files will be lost and they will be read from the
beginning again.</p>
</div>
</div>
<h5><a id="filestream-input-paths"></a><code class="literal">paths</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-filestream-file-options.asciidoc">edit</a></h5>
<p>A list of glob-based paths that will be crawled and fetched. All patterns
supported by <a href="https://golang.org/pkg/path/filepath/#Glob" class="ulink" target="_top">Go Glob</a> are also
supported here. For example, to fetch all files from a predefined level of
subdirectories, the following pattern can be used: <code class="literal">/var/log/*/*.log</code>. This
fetches all <code class="literal">.log</code> files from the subfolders of <code class="literal">/var/log</code>. It does not
fetch log files from the <code class="literal">/var/log</code> folder itself.
It is possible to recursively fetch all files in all subdirectories of a directory
using the optional <a class="xref" href="filebeat-input-filestream.html#filestream-recursive-glob" title="prospector.scanner.recursive_glob"><code class="literal">recursive_glob</code></a> settings.</p>
<p>Filebeat starts a harvester for each file that it finds under the specified
paths. You can specify one path per line. Each line begins with a dash (-).</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_scanner_options"></a>Scanner options<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-filestream-file-options.asciidoc">edit</a></h3>
</div></div></div>
<p>The scanner watches the configured paths. It scans the file system periodically
and returns the file system events to the Prospector.</p>
<h5><a id="filestream-recursive-glob"></a><code class="literal">prospector.scanner.recursive_glob</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-filestream-file-options.asciidoc">edit</a></h5>
<p>Enable expanding <code class="literal">**</code> into recursive glob patterns. With this feature enabled,
the rightmost <code class="literal">**</code> in each path is expanded into a fixed number of glob
patterns. For example: <code class="literal">/foo/**</code> expands to <code class="literal">/foo</code>, <code class="literal">/foo/*</code>, <code class="literal">/foo/*/*</code>, and so
on. If enabled it expands a single <code class="literal">**</code> into a 8-level deep <code class="literal">*</code> pattern.</p>
<p>This feature is enabled by default. Set <code class="literal">prospector.scanner.recursive_glob</code> to false to
disable it.</p>
<h5><a id="filebeat-input-filestream-exclude-files"></a><code class="literal">prospector.scanner.exclude_files</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-filestream-file-options.asciidoc">edit</a></h5>
<p>A list of regular expressions to match the files that you want Filebeat to
ignore. By default no files are excluded.</p>
<p>The following example configures Filebeat to ignore all the files that have
a <code class="literal">gz</code> extension:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: filestream
  ...
  prospector.scanner.exclude_files: ['\.gz$']</pre>
</div>
<p>See <a class="xref" href="regexp-support.html" title="Regular expression support">Regular expression support</a> for a list of supported regexp patterns.</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_prospector_scanner_include_files"></a><code class="literal">prospector.scanner.include_files</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-filestream-file-options.asciidoc">edit</a></h4>
</div></div></div>
<p>A list of regular expressions to match the files that you want Filebeat to
include. If a list of regexes is provided, only the files that are allowed by
the patterns are harvested.</p>
<p>By default no files are excluded. This option is the counterpart of
<code class="literal">prospector.scanner.exclude_files</code>.</p>
<p>The following example configures Filebeat to exclude files that
are not under <code class="literal">/var/log</code>:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: filestream
  ...
  prospector.scanner.include_files: ['^/var/log/.*']</pre>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Patterns should start with <code class="literal">^</code> in case of absolute paths.</p>
</div>
</div>
<p>See <a class="xref" href="regexp-support.html" title="Regular expression support">Regular expression support</a> for a list of supported regexp patterns.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_prospector_scanner_symlinks"></a><code class="literal">prospector.scanner.symlinks</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-filestream-file-options.asciidoc">edit</a></h4>
</div></div></div>
<p>The <code class="literal">symlinks</code> option allows Filebeat to harvest symlinks in addition to
regular files. When harvesting symlinks, Filebeat opens and reads the
original file even though it reports the path of the symlink.</p>
<p>When you configure a symlink for harvesting, make sure the original path is
excluded. If a single input is configured to harvest both the symlink and
the original file, Filebeat will detect the problem and only process the
first file it finds. However, if two different inputs are configured (one
to read the symlink and the other the original path), both paths will be
harvested, causing Filebeat to send duplicate data and the inputs to
overwrite each other&#8217;s state.</p>
<p>The <code class="literal">symlinks</code> option can be useful if symlinks to the log files have additional
metadata in the file name, and you want to process the metadata in Logstash.
This is, for example, the case for Kubernetes log files.</p>
<p>Because this option may lead to data loss, it is disabled by default.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_prospector_scanner_resend_on_touch"></a><code class="literal">prospector.scanner.resend_on_touch</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-filestream-file-options.asciidoc">edit</a></h4>
</div></div></div>
<p>If this option is enabled a file is resent if its size has not changed
but its modification time has changed to a later time than before.
It is disabled by default to avoid accidentally resending files.</p>
<h5><a id="filebeat-input-filestream-scan-frequency"></a><code class="literal">prospector.scanner.check_interval</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-filestream-file-options.asciidoc">edit</a></h5>
<p>How often Filebeat checks for new files in the paths that are specified
for harvesting. For example, if you specify a glob like <code class="literal">/var/log/*</code>, the
directory is scanned for files using the frequency specified by
<code class="literal">check_interval</code>. Specify 1s to scan the directory as frequently as possible
without causing Filebeat to scan too frequently. We do not recommend to set
this value <code class="literal">&lt;1s</code>.</p>
<p>If you require log lines to be sent in near real time do not use a very low
<code class="literal">check_interval</code> but adjust <code class="literal">close.on_state_change.inactive</code> so the file handler
stays open and constantly polls your files.</p>
<p>The default setting is 10s.</p>
<h5><a id="filebeat-input-filestream-scan-fingerprint"></a><code class="literal">prospector.scanner.fingerprint</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-filestream-file-options.asciidoc">edit</a></h5>
<p>Instead of relying on the device ID and inode values when comparing files, compare hashes of the given byte ranges of files.</p>
<p>Enable this option if you&#8217;re experiencing data loss or data duplication due to unstable file identifiers provided by the file system.</p>
<p>Following are some scenarios where this can happen:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Some file systems (i.e. in Docker) cache and re-use inodes</p>
<p>for example if you:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Create a file (<code class="literal">touch x</code>)
</li>
<li class="listitem">
Check the file&#8217;s inode (<code class="literal">ls -i x</code>)
</li>
<li class="listitem">
Delete the file (<code class="literal">rm x</code>)
</li>
<li class="listitem">
Create a new file right away (<code class="literal">touch y</code>)
</li>
<li class="listitem">
<p>Check the inode of the new file (<code class="literal">ls -i y</code>)</p>
<p>For both files you might see the same inode value despite even having different filenames.</p>
</li>
</ol>
</div>
</li>
<li class="listitem">
<p>Non-Ext file systems can change inodes:</p>
<p>Ext file systems store the inode number in the <code class="literal">i_ino</code> file, inside a struct <code class="literal">inode</code>, which is written to disk. In this case, if the file is the same (not another file with the same name) then the inode number is guaranteed to be the same.</p>
<p>If the file system is other than Ext, the inode number is generated by the inode operations defined by the file system driver. As they don&#8217;t have the concept of what an inode is, they have to mimic all of the inode&#8217;s internal fields to comply with VFS, so this number will probably be different after a reboot, even after closing and opening the file again (theoretically).</p>
</li>
<li class="listitem">
<p>Some file processing tools change inode values</p>
<p>Sometimes users unintentionally change inodes by using tools like <code class="literal">rsync</code> or <code class="literal">sed</code>.</p>
</li>
<li class="listitem">
<p>Some operating systems change device IDs after reboot</p>
<p>Depending on a mounting approach, the device ID (which is also used for comparing files) might change after a reboot.</p>
</li>
</ol>
</div>
<p><span class="strong strong"><strong>Configuration</strong></span></p>
<p>Fingerprint mode is disabled by default.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>Enabling fingerprint mode delays ingesting new files until they grow to at least <code class="literal">offset</code>+<code class="literal">length</code> bytes in size, so they can be fingerprinted. Until then these files are ignored.</p>
</div>
</div>
<p>Normally, log lines contain timestamps and other unique fields that should be able to use the fingerprint mode,
but in every use-case users should inspect their logs to determine what are the appropriate values for
the <code class="literal">offset</code> and <code class="literal">length</code> parameters. Default <code class="literal">offset</code> is <code class="literal">0</code> and default <code class="literal">length</code> is <code class="literal">1024</code> or 1 KB. <code class="literal">length</code> cannot be less than <code class="literal">64</code>.</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">fingerprint:
  enabled: false
  offset: 0
  length: 1024</pre>
</div>
<h5><a id="filebeat-input-filestream-ignore-older"></a><code class="literal">ignore_older</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-filestream-file-options.asciidoc">edit</a></h5>
<p>If this option is enabled, Filebeat ignores any files that were modified
before the specified timespan. Configuring <code class="literal">ignore_older</code> can be especially
useful if you keep log files for a long time. For example, if you want to start
Filebeat, but only want to send the newest files and files from last week,
you can configure this option.</p>
<p>You can use time strings like 2h (2 hours) and 5m (5 minutes). The default is 0,
which disables the setting. Commenting out the config has the same effect as
setting it to 0.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>You must set <code class="literal">ignore_older</code> to be greater than <code class="literal">close.on_state_change.inactive</code>.</p>
</div>
</div>
<p>The files affected by this setting fall into two categories:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Files that were never harvested
</li>
<li class="listitem">
Files that were harvested but weren&#8217;t updated for longer than <code class="literal">ignore_older</code>
</li>
</ul>
</div>
<p>For files which were never seen before, the offset state is set to the end of
the file. If a state already exists, the offset is reset to the size of the file.
If a file is updated again later, reading continues at the set offset position.</p>
<p>The <code class="literal">ignore_older</code> setting relies on the modification time of the file to
determine if a file is ignored. If the modification time of the file is not
updated when lines are written to a file (which can happen on Windows), the
<code class="literal">ignore_older</code> setting may cause Filebeat to ignore files even though
content was added at a later time.</p>
<p>To remove the state of previously harvested files from the registry file, use
the <code class="literal">clean_inactive</code> configuration option.</p>
<p>Before a file can be ignored by Filebeat, the file must be closed. To
ensure a file is no longer being harvested when it is ignored, you must set
<code class="literal">ignore_older</code> to a longer duration than <code class="literal">close.on_state_change.inactive</code>.</p>
<p>If a file that&#8217;s currently being harvested falls under <code class="literal">ignore_older</code>, the
harvester will first finish reading the file and close it after
<code class="literal">close.on_state_change.inactive</code> is reached. Then, after that, the file will be ignored.</p>
<h5><a id="filebeat-input-filestream-ignore-inactive"></a><code class="literal">ignore_inactive</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-filestream-file-options.asciidoc">edit</a></h5>
<p>If this option is enabled, Filebeat ignores every file that has not been
updated since the selected time. Possible options are <code class="literal">since_first_start</code> and
<code class="literal">since_last_start</code>. The first option ignores every file that has not been updated since
the first start of Filebeat. It is useful when the Beat might be restarted
due to configuration changes or a failure. The second option tells
the Beat to read from files that have been updated since its start.</p>
<p>The files affected by this setting fall into two categories:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Files that were never harvested
</li>
<li class="listitem">
Files that were harvested but weren&#8217;t updated since <code class="literal">ignore_inactive</code>.
</li>
</ul>
</div>
<p>For files that were never seen before, the offset state is set to the end of
the file. If a state already exist, the offset is not changed. In case a file is
updated again later, reading continues at the set offset position.</p>
<p>The setting relies on the modification time of the file to
determine if a file is ignored. If the modification time of the file is not
updated when lines are written to a file (which can happen on Windows), the
setting may cause Filebeat to ignore files even though content was added
at a later time.</p>
<p>To remove the state of previously harvested files from the registry file, use
the <code class="literal">clean_inactive</code> configuration option.</p>
<h5><a id="filebeat-input-filestream-take-over"></a><code class="literal">take_over</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-filestream-file-options.asciidoc">edit</a></h5>
<p>If <code class="literal">take_over</code> is set to <code class="literal">true</code>, this <code class="literal">filestream</code> will take over all files
from <code class="literal">log</code> inputs if they match at least one of the <code class="literal">paths</code> set in the <code class="literal">filestream</code>.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p><code class="literal">take_over: true</code> requires the <code class="literal">filestream</code> to have a unique ID.</p>
</div>
</div>
<p>This <code class="literal">take over</code> mode was created to enable smooth migration from deprecated <code class="literal">log</code>
inputs to the new <code class="literal">filestream</code> inputs.</p>
<p>See <a class="xref" href="migrate-to-filestream.html" title="Migrate log input configurations to filestream"><em>Migrate <code class="literal">log</code> input configurations to <code class="literal">filestream</code></em></a> for more details about the migration process.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>The <code class="literal">take over</code> mode is still in beta, however, it&#8217;s manually reversible
due to backups created in the <a class="xref" href="configuration-general-options.html#configuration-global-options" title="Global Filebeat configuration options"><code class="literal">registry.path/filebeat</code> directory</a>
and should be generally safe to use.</p>
</div>
</div>
<h5><a id="filebeat-input-filestream-close-options"></a><code class="literal">close.*</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-filestream-file-options.asciidoc">edit</a></h5>
<p>The <code class="literal">close.*</code> configuration options are used to close the harvester after a
certain criteria or time. Closing the harvester means closing the file handler.
If a file is updated after the harvester is closed, the file will be picked up
again after <code class="literal">prospector.scanner.check_interval</code> has elapsed. However, if the file
is moved or deleted while the harvester is closed, Filebeat will not be able
to pick up the file again, and any data that the harvester hasn&#8217;t read will be lost.</p>
<p>The <code class="literal">close.on_state_change.*</code> settings are applied asynchronously
to read from a file, meaning that if Filebeat is in a blocked state
due to blocked output, full queue or other issue, a file that would be
closed regardless.</p>
<h5><a id="filebeat-input-filestream-close-inactive"></a><code class="literal">close.on_state_change.inactive</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-filestream-file-options.asciidoc">edit</a></h5>
<p>When this option is enabled, Filebeat closes the file handle if a file has
not been harvested for the specified duration. The counter for the defined
period starts when the last log line was read by the harvester. It is not based
on the modification time of the file. If the closed file changes again, a new
harvester is started and the latest changes will be picked up after
<code class="literal">prospector.scanner.check_interval</code> has elapsed.</p>
<p>We recommended that you set <code class="literal">close.on_state_change.inactive</code> to a value that is
larger than the least frequent updates to your log files. For example, if your
log files get updated every few seconds, you can safely set
<code class="literal">close.on_state_change.inactive</code> to <code class="literal">1m</code>. If there are log files with very
different update rates, you can use multiple configurations with different values.</p>
<p>Setting <code class="literal">close.on_state_change.inactive</code> to a lower value means that file handles
are closed sooner. However this has the side effect that new log lines are not
sent in near real time if the harvester is closed.</p>
<p>The timestamp for closing a file does not depend on the modification time of the
file. Instead, Filebeat uses an internal timestamp that reflects when the
file was last harvested. For example, if <code class="literal">close.on_state_change.inactive</code> is set
to 5 minutes, the countdown for the 5 minutes starts after the harvester reads the
last line of the file.</p>
<p>You can use time strings like 2h (2 hours) and 5m (5 minutes). The default is
5m.</p>
<h5><a id="filebeat-input-filestream-close-renamed"></a><code class="literal">close.on_state_change.renamed</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-filestream-file-options.asciidoc">edit</a></h5>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>Only use this option if you understand that data loss is a potential
side effect.</p>
</div>
</div>
<p>When this option is enabled, Filebeat closes the file handler when a file
is renamed. This happens, for example, when rotating files. By default, the
harvester stays open and keeps reading the file because the file handler does
not depend on the file name. If the <code class="literal">close.on_state_change.renamed</code> option is
enabled and the file is renamed or moved in such a way that it&#8217;s no longer
matched by the file patterns specified for the , the file will not be picked
up again. Filebeat will not finish reading the file.</p>
<p>Do not use this option when <code class="literal">path</code> based <code class="literal">file_identity</code> is configured. It does
not make sense to enable the option, as Filebeat cannot detect renames using
path names as unique identifiers.</p>
<p>WINDOWS: If your Windows log rotation system shows errors because it can&#8217;t
rotate the files, you should enable this option.</p>
<h5><a id="filebeat-input-filestream-close-removed"></a><code class="literal">close.on_state_change.removed</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-filestream-file-options.asciidoc">edit</a></h5>
<p>When this option is enabled, Filebeat closes the harvester when a file is
removed. Normally a file should only be removed after it&#8217;s inactive for the
duration specified by <code class="literal">close.on_state_change.inactive</code>. However, if a file is
removed early and you don&#8217;t enable <code class="literal">close.on_state_change.removed</code>, Filebeat
keeps the file open to make sure the harvester has completed. If this setting
results in files that are not completely read because they are removed from
disk too early, disable this option.</p>
<p>This option is enabled by default. If you disable this option, you must also
disable <code class="literal">clean_removed</code>.</p>
<p>WINDOWS: If your Windows log rotation system shows errors because it can&#8217;t
rotate files, make sure this option is enabled.</p>
<h5><a id="filebeat-input-filestream-close-eof"></a><code class="literal">close.reader.on_eof</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-filestream-file-options.asciidoc">edit</a></h5>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>Only use this option if you understand that data loss is a potential
side effect.</p>
</div>
</div>
<p>When this option is enabled, Filebeat closes a file as soon as the end of a
file is reached. This is useful when your files are only written once and not
updated from time to time. For example, this happens when you are writing every
single log event to a new file. This option is disabled by default.</p>
<h5><a id="filebeat-input-filestream-close-timeout"></a><code class="literal">close.reader.after_interval</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-filestream-file-options.asciidoc">edit</a></h5>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>Only use this option if you understand that data loss is a potential
side effect. Another side effect is that multiline events might not be
completely sent before the timeout expires.</p>
</div>
</div>
<p>When this option is enabled, Filebeat gives every harvester a predefined
lifetime. Regardless of where the reader is in the file, reading will stop after
the <code class="literal">close.reader.after_interval</code> period has elapsed. This option can be useful for older log
files when you want to spend only a predefined amount of time on the files.
While <code class="literal">close.reader.after_interval</code> will close the file after the predefined timeout, if the
file is still being updated, Filebeat will start a new harvester again per
the defined <code class="literal">prospector.scanner.check_interval</code>. And the close.reader.after_interval for this harvester will
start again with the countdown for the timeout.</p>
<p>This option is particularly useful in case the output is blocked, which makes
Filebeat keep open file handlers even for files that were deleted from the
disk. Setting <code class="literal">close.reader.after_interval</code> to <code class="literal">5m</code> ensures that the files are periodically
closed so they can be freed up by the operating system.</p>
<p>If you set <code class="literal">close.reader.after_interval</code> to equal <code class="literal">ignore_older</code>, the file will not be picked
up if it&#8217;s modified while the harvester is closed. This combination of settings
normally leads to data loss, and the complete file is not sent.</p>
<p>When you use <code class="literal">close.reader.after_interval</code> for logs that contain multiline events, the
harvester might stop in the middle of a multiline event, which means that only
parts of the event will be sent. If the harvester is started again and the file
still exists, only the second part of the event will be sent.</p>
<p>This option is set to 0 by default which means it is disabled.</p>
<h5><a id="filebeat-input-filestream-clean-options"></a><code class="literal">clean_*</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-filestream-file-options.asciidoc">edit</a></h5>
<p>The <code class="literal">clean_*</code> options are used to clean up the state entries in the registry
file. These settings help to reduce the size of the registry file and can
prevent a potential <a class="xref" href="inode-reuse-issue.html" title="Inode reuse causes Filebeat to skip lines">inode reuse issue</a>.</p>
<h5><a id="filebeat-input-filestream-clean-inactive"></a><code class="literal">clean_inactive</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-filestream-file-options.asciidoc">edit</a></h5>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>Only use this option if you understand that data loss is a potential
side effect.</p>
</div>
</div>
<p>When this option is enabled, Filebeat removes the state of a file after the
specified period of inactivity has elapsed. The state can only be removed if
the file is already ignored by Filebeat (the file is older than
<code class="literal">ignore_older</code>). The <code class="literal">clean_inactive</code> setting must be greater than <code class="literal">ignore_older +
prospector.scanner.check_interval</code> to make sure that no states are removed while a file is still
being harvested. Otherwise, the setting could result in Filebeat resending
the full content constantly because <code class="literal">clean_inactive</code> removes state for files
that are still detected by Filebeat. If a file is updated or appears
again, the file is read from the beginning.</p>
<p>The <code class="literal">clean_inactive</code> configuration option is useful to reduce the size of the
registry file, especially if a large amount of new files are generated every
day.</p>
<p>This config option is also useful to prevent Filebeat problems resulting
from inode reuse on Linux. For more information, see <a class="xref" href="inode-reuse-issue.html" title="Inode reuse causes Filebeat to skip lines">Inode reuse causes Filebeat to skip lines</a>.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Every time a file is renamed, the file state is updated and the counter
for <code class="literal">clean_inactive</code> starts at 0 again.</p>
</div>
</div>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>During testing, you might notice that the registry contains state entries
that should be removed based on the <code class="literal">clean_inactive</code> setting. This happens
because Filebeat doesn&#8217;t remove the entries until the registry garbage
collector (GC) runs. Once the TTL for a state expired, there are no active
harvesters for the file and the registry GC runs, then, and only then
the state is removed from memory and an <code class="literal">op: remove</code> is added to the registry
log file.</p>
</div>
</div>
<h5><a id="filebeat-input-filestream-clean-removed"></a><code class="literal">clean_removed</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-filestream-file-options.asciidoc">edit</a></h5>
<p>When this option is enabled, Filebeat cleans files from the registry if
they cannot be found on disk anymore under the last known name. This means also
files which were renamed after the harvester was finished will be removed. This
option is enabled by default.</p>
<p>If a shared drive disappears for a short period and appears again, all files
will be read again from the beginning because the states were removed from the
registry file. In such cases, we recommend that you disable the <code class="literal">clean_removed</code>
option.</p>
<p>You must disable this option if you also disable <code class="literal">close.on_state_change.removed</code>.</p>
<h5><a id="_backoff_2"></a><code class="literal">backoff.*</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-filestream-file-options.asciidoc">edit</a></h5>
<p>The backoff options specify how aggressively Filebeat crawls open files for
updates. You can use the default values in most cases.</p>
<h5><a id="_backoff_init"></a><code class="literal">backoff.init</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-filestream-file-options.asciidoc">edit</a></h5>
<p>The <code class="literal">backoff.init</code> option defines how long Filebeat waits for the first time
before checking a file again after EOF is reached. The backoff intervals increase exponentially.
The default is 2s. Thus, the file is checked after 2 seconds, then 4 seconds,
then 8 seconds and so on until it reaches the limit defined in <code class="literal">backoff.max</code>.
Every time a new line appears in the file, the <code class="literal">backoff.init</code> value is reset to the
initial value.</p>
<h5><a id="_backoff_max"></a><code class="literal">backoff.max</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-filestream-file-options.asciidoc">edit</a></h5>
<p>The maximum time for Filebeat to wait before checking a file again after
EOF is reached. After having backed off multiple times from checking the file,
the wait time will never exceed <code class="literal">backoff.max</code>.
Because it takes a maximum of 10s to read a new line,
specifying 10s for <code class="literal">backoff.max</code> means that, at the worst, a new line could be
added to the log file if Filebeat has backed off multiple times. The
default is 10s.</p>
<p>Requirement: Set <code class="literal">backoff.max</code> to be greater than or equal to <code class="literal">backoff.init</code> and
less than or equal to <code class="literal">prospector.scanner.check_interval</code>
(<code class="literal">backoff.init &lt;= backoff.max &lt;= prospector.scanner.check_interval</code>).
If <code class="literal">backoff.max</code> needs to be higher, it is recommended to close the file handler
instead and let Filebeat pick up the file again.</p>
<h5><a id="filebeat-input-filestream-harvester-limit"></a><code class="literal">harvester_limit</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-filestream-file-options.asciidoc">edit</a></h5>
<p>The <code class="literal">harvester_limit</code> option limits the number of harvesters that are started in
parallel for one input. This directly relates to the maximum number of file
handlers that are opened. The default for <code class="literal">harvester_limit</code> is 0, which means
there is no limit. This configuration is useful if the number of files to be
harvested exceeds the open file handler limit of the operating system.</p>
<p>Setting a limit on the number of harvesters means that potentially not all files
are opened in parallel. Therefore we recommended that you use this option in
combination with the <code class="literal">close.on_state_change.*</code> options to make sure
harvesters are stopped more often so that new files can be picked up.</p>
<p>Currently if a new harvester can be started again, the harvester is picked
randomly. This means it&#8217;s possible that the harvester for a file that was just
closed and then updated again might be started instead of the harvester for a
file that hasn&#8217;t been harvested for a longer period of time.</p>
<p>This configuration option applies per input. You can use this option to
indirectly set higher priorities on certain inputs by assigning a higher
limit of harvesters.</p>
<h5><a id="_file_identity_2"></a><code class="literal">file_identity</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-filestream-file-options.asciidoc">edit</a></h5>
<p>Different <code class="literal">file_identity</code> methods can be configured to suit the
environment where you are collecting log messages.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>Changing <code class="literal">file_identity</code> methods between runs may result in
duplicated events in the output.</p>
</div>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">native</code></strong></span>
</span>
</dt>
<dd>
<p>
The default behaviour of Filebeat is to differentiate
between files using their inodes and device ids.
</p>
<p>In some cases these values can change during the lifetime of a file.
For example, when using the Linux <a href="https://en.wikipedia.org/wiki/Logical_Volume_Manager_%28Linux%29" class="ulink" target="_top">LVM</a> (Logical Volume Manager), device numbers are allocated dynamically at module load (refer to <a href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/logical_volume_manager_administration/lv#persistent_numbers" class="ulink" target="_top">Persistent Device Numbers</a> in the Red Hat Enterprise Linux documentation). To avoid the possibility of data duplication in this case, you can set <code class="literal">file_identity</code> to <code class="literal">path</code> rather than <code class="literal">native</code>.</p>
</dd>
</dl>
</div>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">file_identity.native: ~</pre>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">path</code></strong></span>
</span>
</dt>
<dd>
To identify files based on their paths use this strategy.
</dd>
</dl>
</div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>Only use this strategy if your log files are rotated to a folder
outside of the scope of your input or not at all. Otherwise you end up
with duplicated events.</p>
</div>
</div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This strategy does not support renaming files.
If an input file is renamed, Filebeat will read it again if the new path
matches the settings of the input.</p>
</div>
</div>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">file_identity.path: ~</pre>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">inode_marker</code></strong></span>
</span>
</dt>
<dd>
If the device id changes from time to time, you must use
this method to distinguish files. This option is not supported on Windows.
</dd>
</dl>
</div>
<p>Set the location of the marker file the following way:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">file_identity.inode_marker.path: /logs/.filebeat-marker</pre>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">fingerprint</code></strong></span>
</span>
</dt>
<dd>
To identify files based on their content byte range.
</dd>
</dl>
</div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>In order to use this file identity option, you must enable the <a class="xref" href="filebeat-input-filestream.html#filebeat-input-filestream-scan-fingerprint" title="prospector.scanner.fingerprint">fingerprint option in the scanner</a>. Once this file identity is enabled, changing the fingerprint configuration (offset, length, or other settings) will lead to a global re-ingestion of all files that match the paths configuration of the input.</p>
</div>
</div>
<p>Please refer to the <a class="xref" href="filebeat-input-filestream.html#filebeat-input-filestream-scan-fingerprint" title="prospector.scanner.fingerprint">fingerprint configuration for details</a>.</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">file_identity.fingerprint: ~</pre>
</div>
<h3><a id="filestream-log-rotation-support"></a>Log rotation<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-filestream-file-options.asciidoc">edit</a></h3>
<p>As log files are constantly written, they must be rotated and purged to prevent
the logger application from filling up the disk. Rotation is done by an external
application, thus, Filebeat needs information how to cooperate with it.</p>
<p>When reading from rotating files make sure the paths configuration includes
both the active file and all rotated files.</p>
<p>By default, Filebeat is able to track files correctly in the following strategies:
* create: new active file with a unique name is created on rotation
* rename: rotated files are renamed</p>
<p>However, in case of copytruncate strategy, you should provide additional configuration
to Filebeat.</p>
<h4><a id="_rotation_external_strategy_copytruncate"></a>rotation.external.strategy.copytruncate<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-filestream-file-options.asciidoc">edit</a></h4>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in technical preview and may be changed or removed in a future release. Elastic will work to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.</p>
</div>
</div>
<p>If the log rotating application copies the contents of the active file and then
truncates the original file, use these options to help Filebeat to read files
correctly.</p>
<p>Set the option <code class="literal">suffix_regex</code> so Filebeat can tell active and rotated files apart. There are
two supported suffix types in the input: numberic and date.</p>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_numeric_suffix"></a>Numeric suffix<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-filestream-file-options.asciidoc">edit</a></h3>
</div></div></div>
<p>If your rotated files have an incrementing index appended to the end of the filename, e.g.
active file <code class="literal">apache.log</code> and the rotated files are named <code class="literal">apache.log.1</code>, <code class="literal">apache.log.2</code>, etc,
use the following configuration.</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">---
rotation.external.strategy.copytruncate:
  suffix_regex: \.\d$
---</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_date_suffix"></a>Date suffix<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-filestream-file-options.asciidoc">edit</a></h3>
</div></div></div>
<p>If the rotation date is appended to the end of the filename, e.g. active file <code class="literal">apache.log</code> and the
rotated files are named <code class="literal">apache.log-20210526</code>, <code class="literal">apache.log-20210527</code>, etc. use the following configuration:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">---
rotation.external.strategy.copytruncate:
  suffix_regex: \-\d{6}$
  dateformat: -20060102
---</pre>
</div>
<h5><a id="_encoding_2"></a><code class="literal">encoding</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-filestream-reader-options.asciidoc">edit</a></h5>
<p>The file encoding to use for reading data that contains international
characters. See the encoding names <a href="http://www.w3.org/TR/encoding/" class="ulink" target="_top">recommended by
the W3C for use in HTML5</a>.</p>
<p>Valid encodings:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">plain</code>: plain ASCII encoding
</li>
<li class="listitem">
<code class="literal">utf-8</code> or <code class="literal">utf8</code>: UTF-8 encoding
</li>
<li class="listitem">
<code class="literal">gbk</code>: simplified Chinese charaters
</li>
<li class="listitem">
<code class="literal">iso8859-6e</code>: ISO8859-6E, Latin/Arabic
</li>
<li class="listitem">
<code class="literal">iso8859-6i</code>: ISO8859-6I, Latin/Arabic
</li>
<li class="listitem">
<code class="literal">iso8859-8e</code>: ISO8859-8E, Latin/Hebrew
</li>
<li class="listitem">
<code class="literal">iso8859-8i</code>: ISO8859-8I, Latin/Hebrew
</li>
<li class="listitem">
<code class="literal">iso8859-1</code>: ISO8859-1, Latin-1
</li>
<li class="listitem">
<code class="literal">iso8859-2</code>: ISO8859-2, Latin-2
</li>
<li class="listitem">
<code class="literal">iso8859-3</code>: ISO8859-3, Latin-3
</li>
<li class="listitem">
<code class="literal">iso8859-4</code>: ISO8859-4, Latin-4
</li>
<li class="listitem">
<code class="literal">iso8859-5</code>: ISO8859-5, Latin/Cyrillic
</li>
<li class="listitem">
<code class="literal">iso8859-6</code>: ISO8859-6, Latin/Arabic
</li>
<li class="listitem">
<code class="literal">iso8859-7</code>: ISO8859-7, Latin/Greek
</li>
<li class="listitem">
<code class="literal">iso8859-8</code>: ISO8859-8, Latin/Hebrew
</li>
<li class="listitem">
<code class="literal">iso8859-9</code>: ISO8859-9, Latin-5
</li>
<li class="listitem">
<code class="literal">iso8859-10</code>: ISO8859-10, Latin-6
</li>
<li class="listitem">
<code class="literal">iso8859-13</code>: ISO8859-13, Latin-7
</li>
<li class="listitem">
<code class="literal">iso8859-14</code>: ISO8859-14, Latin-8
</li>
<li class="listitem">
<code class="literal">iso8859-15</code>: ISO8859-15, Latin-9
</li>
<li class="listitem">
<code class="literal">iso8859-16</code>: ISO8859-16, Latin-10
</li>
<li class="listitem">
<code class="literal">cp437</code>: IBM CodePage 437
</li>
<li class="listitem">
<code class="literal">cp850</code>: IBM CodePage 850
</li>
<li class="listitem">
<code class="literal">cp852</code>: IBM CodePage 852
</li>
<li class="listitem">
<code class="literal">cp855</code>: IBM CodePage 855
</li>
<li class="listitem">
<code class="literal">cp858</code>: IBM CodePage 858
</li>
<li class="listitem">
<code class="literal">cp860</code>: IBM CodePage 860
</li>
<li class="listitem">
<code class="literal">cp862</code>: IBM CodePage 862
</li>
<li class="listitem">
<code class="literal">cp863</code>: IBM CodePage 863
</li>
<li class="listitem">
<code class="literal">cp865</code>: IBM CodePage 865
</li>
<li class="listitem">
<code class="literal">cp866</code>: IBM CodePage 866
</li>
<li class="listitem">
<code class="literal">ebcdic-037</code>: IBM CodePage 037
</li>
<li class="listitem">
<code class="literal">ebcdic-1040</code>: IBM CodePage 1140
</li>
<li class="listitem">
<code class="literal">ebcdic-1047</code>: IBM CodePage 1047
</li>
<li class="listitem">
<code class="literal">koi8r</code>: KOI8-R, Russian (Cyrillic)
</li>
<li class="listitem">
<code class="literal">koi8u</code>: KOI8-U, Ukranian (Cyrillic)
</li>
<li class="listitem">
<code class="literal">macintosh</code>: Macintosh encoding
</li>
<li class="listitem">
<code class="literal">macintosh-cyrillic</code>: Macintosh Cyrillic encoding
</li>
<li class="listitem">
<code class="literal">windows1250</code>: Windows1250, Central and Eastern European
</li>
<li class="listitem">
<code class="literal">windows1251</code>: Windows1251, Russian, Serbian (Cyrillic)
</li>
<li class="listitem">
<code class="literal">windows1252</code>: Windows1252, Legacy
</li>
<li class="listitem">
<code class="literal">windows1253</code>: Windows1253, Modern Greek
</li>
<li class="listitem">
<code class="literal">windows1254</code>: Windows1254, Turkish
</li>
<li class="listitem">
<code class="literal">windows1255</code>: Windows1255, Hebrew
</li>
<li class="listitem">
<code class="literal">windows1256</code>: Windows1256, Arabic
</li>
<li class="listitem">
<code class="literal">windows1257</code>: Windows1257, Estonian, Latvian, Lithuanian
</li>
<li class="listitem">
<code class="literal">windows1258</code>: Windows1258, Vietnamese
</li>
<li class="listitem">
<code class="literal">windows874</code>:  Windows874, ISO/IEC 8859-11, Latin/Thai
</li>
<li class="listitem">
<code class="literal">utf-16-bom</code>: UTF-16 with required BOM
</li>
<li class="listitem">
<code class="literal">utf-16be-bom</code>: big endian UTF-16 with required BOM
</li>
<li class="listitem">
<code class="literal">utf-16le-bom</code>: little endian UTF-16 with required BOM
</li>
</ul>
</div>
<p>The <code class="literal">plain</code> encoding is special, because it does not validate or transform any input.</p>
<h5><a id="filebeat-input-filestream-exclude-lines"></a><code class="literal">exclude_lines</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-filestream-reader-options.asciidoc">edit</a></h5>
<p>A list of regular expressions to match the lines that you want Filebeat to
exclude. Filebeat drops any lines that match a regular expression in the
list. By default, no lines are dropped. Empty lines are ignored.</p>
<p>The following example configures Filebeat to drop any lines that start with
<code class="literal">DBG</code>.</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: filestream
  ...
  exclude_lines: ['^DBG']</pre>
</div>
<p>See <a class="xref" href="regexp-support.html" title="Regular expression support">Regular expression support</a> for a list of supported regexp patterns.</p>
<h5><a id="filebeat-input-filestream-include-lines"></a><code class="literal">include_lines</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-filestream-reader-options.asciidoc">edit</a></h5>
<p>A list of regular expressions to match the lines that you want Filebeat to
include. Filebeat exports only the lines that match a regular expression in
the list. By default, all lines are exported. Empty lines are ignored.</p>
<p>The following example configures Filebeat to export any lines that start
with <code class="literal">ERR</code> or <code class="literal">WARN</code>:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: filestream
  ...
  include_lines: ['^ERR', '^WARN']</pre>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>If both <code class="literal">include_lines</code> and <code class="literal">exclude_lines</code> are defined, Filebeat
executes <code class="literal">include_lines</code> first and then executes <code class="literal">exclude_lines</code>. The order in
which the two options are defined doesn&#8217;t matter. The <code class="literal">include_lines</code> option
will always be executed before the <code class="literal">exclude_lines</code> option, even if
<code class="literal">exclude_lines</code> appears before <code class="literal">include_lines</code> in the config file.</p>
</div>
</div>
<p>The following example exports all log lines that contain <code class="literal">sometext</code>,
except for lines that begin with <code class="literal">DBG</code> (debug messages):</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: filestream
  ...
  include_lines: ['sometext']
  exclude_lines: ['^DBG']</pre>
</div>
<p>See <a class="xref" href="regexp-support.html" title="Regular expression support">Regular expression support</a> for a list of supported regexp patterns.</p>
<h5><a id="_buffer_size"></a><code class="literal">buffer_size</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-filestream-reader-options.asciidoc">edit</a></h5>
<p>The size in bytes of the buffer that each harvester uses when fetching a file.
The default is 16384.</p>
<h5><a id="_message_max_bytes"></a><code class="literal">message_max_bytes</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-filestream-reader-options.asciidoc">edit</a></h5>
<p>The maximum number of bytes that a single log message can have. All bytes after
<code class="literal">message_max_bytes</code> are discarded and not sent. The default is 10MB (10485760).</p>
<h5><a id="_parsers"></a><code class="literal">parsers</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-filestream-reader-options.asciidoc">edit</a></h5>
<p>This option expects a list of parsers that the log line has to go through.</p>
<p>Available parsers:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">multiline</code>
</li>
<li class="listitem">
<code class="literal">ndjson</code>
</li>
<li class="listitem">
<code class="literal">container</code>
</li>
<li class="listitem">
<code class="literal">syslog</code>
</li>
</ul>
</div>
<p>In this example, Filebeat is reading multiline messages that consist of 3 lines
and are encapsulated in single-line JSON objects.
The multiline message is stored under the key <code class="literal">msg</code>.</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: filestream
  ...
  parsers:
    - ndjson:
        target: ""
        message_key: msg
    - multiline:
        type: count
        count_lines: 3</pre>
</div>
<p>See the available parser settings in detail below.</p>
<h5><a id="_multiline_3"></a><code class="literal">multiline</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-filestream-reader-options.asciidoc">edit</a></h5>
<p>Options that control how Filebeat deals with log messages that span
multiple lines. See <a class="xref" href="multiline-examples.html" title="Manage multiline messages">Multiline messages</a> for more information about
configuring multiline options.</p>
<h5><a id="filebeat-input-filestream-ndjson"></a><code class="literal">ndjson</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-filestream-reader-options.asciidoc">edit</a></h5>
<p>These options make it possible for Filebeat to decode logs structured as
JSON messages. Filebeat processes the logs line by line, so the JSON
decoding only works if there is one JSON object per message.</p>
<p>The decoding happens before line filtering. You can combine JSON
decoding with filtering if you set the <code class="literal">message_key</code> option. This
can be helpful in situations where the application logs are wrapped in JSON
objects, like when using Docker.</p>
<p>Example configuration:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">- ndjson:
    target: ""
    add_error_key: true
    message_key: log</pre>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">target</code></strong></span>
</span>
</dt>
<dd>
The name of the new JSON object that should contain the parsed key value pairs. If you
leave it empty, the new keys will go under root.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">overwrite_keys</code></strong></span>
</span>
</dt>
<dd>
Values from the decoded JSON object overwrite the fields that Filebeat
normally adds (type, source, offset, etc.) in case of conflicts. Disable it if you want
to keep previously added values.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">expand_keys</code></strong></span>
</span>
</dt>
<dd>
If this setting is enabled, Filebeat will recursively
de-dot keys in the decoded JSON, and expand them into a hierarchical object
structure. For example, <code class="literal">{"a.b.c": 123}</code> would be expanded into <code class="literal">{"a":{"b":{"c":123}}}</code>.
This setting should be enabled when the input is produced by an
<a href="https://github.com/elastic/ecs-logging" class="ulink" target="_top">ECS logger</a>.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">add_error_key</code></strong></span>
</span>
</dt>
<dd>
If this setting is enabled, Filebeat adds an
"error.message" and "error.type: json" key in case of JSON unmarshalling errors
or when a <code class="literal">message_key</code> is defined in the configuration but cannot be used.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">message_key</code></strong></span>
</span>
</dt>
<dd>
An optional configuration setting that specifies a JSON key on
which to apply the line filtering and multiline settings. If specified the key
must be at the top level in the JSON object and the value associated with the
key must be a string, otherwise no filtering or multiline aggregation will
occur.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">document_id</code></strong></span>
</span>
</dt>
<dd>
Option configuration setting that specifies the JSON key to
set the document id. If configured, the field will be removed from the original
JSON document and stored in <code class="literal">@metadata._id</code>
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">ignore_decoding_error</code></strong></span>
</span>
</dt>
<dd>
An optional configuration setting that specifies if
JSON decoding errors should be logged or not. If set to true, errors will not
be logged. The default is false.
</dd>
</dl>
</div>
<h5><a id="_container"></a><code class="literal">container</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-filestream-reader-options.asciidoc">edit</a></h5>
<p>Use the <code class="literal">container</code> parser to extract information from  containers log files.
It parses lines into common message lines, extracting timestamps too.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">stream</code></strong></span>
</span>
</dt>
<dd>
Reads from the specified streams only: <code class="literal">all</code>, <code class="literal">stdout</code> or <code class="literal">stderr</code>. The default
is <code class="literal">all</code>.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">format</code></strong></span>
</span>
</dt>
<dd>
Use the given format when parsing logs: <code class="literal">auto</code>, <code class="literal">docker</code> or <code class="literal">cri</code>. The
default is <code class="literal">auto</code>, it will automatically detect the format. To disable
autodetection set any of the other options.
</dd>
</dl>
</div>
<p>The following snippet configures Filebeat to read the <code class="literal">stdout</code> stream from
all containers under the default Kubernetes logs path:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">  paths:
    - "/var/log/containers/*.log"
  parsers:
    - container:
        stream: stdout</pre>
</div>
<h5><a id="_syslog"></a><code class="literal">syslog</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-filestream-reader-options.asciidoc">edit</a></h5>
<p>The <code class="literal">syslog</code> parser parses RFC 3146 and/or RFC 5424 formatted syslog messages.</p>
<p>The supported configuration options are:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">format</code></strong></span>
</span>
</dt>
<dd>
(Optional) The syslog format to use, <code class="literal">rfc3164</code>, or <code class="literal">rfc5424</code>. To automatically
detect the format from the log entries, set this option to <code class="literal">auto</code>. The default is <code class="literal">auto</code>.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">timezone</code></strong></span>
</span>
</dt>
<dd>
(Optional) IANA time zone name(e.g. <code class="literal">America/New York</code>) or a
fixed time offset (e.g. +0200) to use when parsing syslog timestamps that do not contain
a time zone. <code class="literal">Local</code> may be specified to use the machine&#8217;s local time zone. Defaults to <code class="literal">Local</code>.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">log_errors</code></strong></span>
</span>
</dt>
<dd>
(Optional) If <code class="literal">true</code> the parser will log syslog parsing errors. Defaults to <code class="literal">false</code>.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">add_error_key</code></strong></span>
</span>
</dt>
<dd>
(Optional) If this setting is enabled, the parser adds or appends to an
<code class="literal">error.message</code> key with the parsing error that was encountered. Defaults to <code class="literal">true</code>.
</dd>
</dl>
</div>
<p>Example configuration:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">- syslog:
    format: rfc3164
    timezone: America/Chicago
    log_errors: true
    add_error_key: true</pre>
</div>
<p><span class="strong strong"><strong>Timestamps</strong></span></p>
<p>The RFC 3164 format accepts the following forms of timestamps:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Local timestamp (<code class="literal">Mmm dd hh:mm:ss</code>):</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">Jan 23 14:09:01</code>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>RFC-3339*:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">2003-10-11T22:14:15Z</code>
</li>
<li class="listitem">
<code class="literal">2003-10-11T22:14:15.123456Z</code>
</li>
<li class="listitem">
<code class="literal">2003-10-11T22:14:15-06:00</code>
</li>
<li class="listitem">
<code class="literal">2003-10-11T22:14:15.123456-06:00</code>
</li>
</ul>
</div>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Note</strong></span>: The local timestamp (for example, <code class="literal">Jan 23 14:09:01</code>) that accompanies an
RFC 3164 message lacks year and time zone information. The time zone will be enriched
using the <code class="literal">timezone</code> configuration option, and the year will be enriched using the
Filebeat system&#8217;s local time (accounting for time zones). Because of this, it is possible
for messages to appear in the future. An example of when this might happen is logs
generated on December 31 2021 are ingested on January 1 2022. The logs would be enriched
with the year 2022 instead of 2021.</p>
<p>The RFC 5424 format accepts the following forms of timestamps:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>RFC-3339:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">2003-10-11T22:14:15Z</code>
</li>
<li class="listitem">
<code class="literal">2003-10-11T22:14:15.123456Z</code>
</li>
<li class="listitem">
<code class="literal">2003-10-11T22:14:15-06:00</code>
</li>
<li class="listitem">
<code class="literal">2003-10-11T22:14:15.123456-06:00</code>
</li>
</ul>
</div>
</li>
</ul>
</div>
<p>Formats with an asterisk (*) are a non-standard allowance.</p>
<h5><a id="_include_message"></a><code class="literal">include_message</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-filestream-reader-options.asciidoc">edit</a></h5>
<p>Use the <code class="literal">include_message</code> parser to filter messages in the parsers pipeline. Messages that
match the provided pattern are passed to the next parser, the others are dropped.</p>
<p>You should use <code class="literal">include_message</code> instead of <code class="literal">include_lines</code> if you would like to
control when the filtering happens. <code class="literal">include_lines</code> runs after the parsers, <code class="literal">include_message</code>
runs in the parsers pipeline.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">patterns</code></strong></span>
</span>
</dt>
<dd>
List of regexp patterns to match.
</dd>
</dl>
</div>
<p>This example shows you how to include messages that start with the string ERR or WARN:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">  paths:
    - "/var/log/containers/*.log"
  parsers:
    - include_message.patterns: ["^ERR", "^WARN"]</pre>
</div>
<h3><a id="_metrics_8"></a>Metrics<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-filestream.asciidoc">edit</a></h3>
<p>This input exposes metrics under the <a class="xref" href="http-endpoint.html" title="Configure an HTTP endpoint for metrics">HTTP monitoring endpoint</a>.
These metrics are exposed under the <code class="literal">/inputs</code> path. They can be used to
observe the activity of the input.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Metric</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">files_opened_total</code></p></td>
<td align="left" valign="top"><p>Total number of files opened.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">files_closed_total</code></p></td>
<td align="left" valign="top"><p>Total number of files closed.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">files_active</code></p></td>
<td align="left" valign="top"><p>Number of files currently open (gauge).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">messages_read_total</code></p></td>
<td align="left" valign="top"><p>Total number of messages read.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">bytes_processed_total</code></p></td>
<td align="left" valign="top"><p>Total number of bytes processed.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">events_processed_total</code></p></td>
<td align="left" valign="top"><p>Total number of events processed.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">processing_errors_total</code></p></td>
<td align="left" valign="top"><p>Total number of processing errors.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">processing_time</code></p></td>
<td align="left" valign="top"><p>Histogram of the elapsed time to process messages (expressed in nanoseconds).</p></td>
</tr>
</tbody>
</table>
</div>
<p>Note:</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="filebeat-input-filestream-common-options"></a>Common options<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></h3>
</div></div></div>
<p>The following configuration options are supported by all inputs.</p>
<h5><a id="_enabled_9"></a><code class="literal">enabled</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></h5>
<p>Use the <code class="literal">enabled</code> option to enable and disable inputs. By default, enabled is
set to true.</p>
<h5><a id="_tags_9"></a><code class="literal">tags</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></h5>
<p>A list of tags that Filebeat includes in the <code class="literal">tags</code> field of each published
event. Tags make it easy to select specific events in Kibana or apply
conditional filtering in Logstash. These tags will be appended to the list of
tags specified in the general configuration.</p>
<p>Example:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: filestream
  . . .
  tags: ["json"]</pre>
</div>
<h5><a id="filebeat-input-filestream-fields"></a><code class="literal">fields</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></h5>
<p>Optional fields that you can specify to add additional information to the
output. For example, you might add fields that you can use for filtering log
data. Fields can be scalar values, arrays, dictionaries, or any nested
combination of these. By default, the fields that you specify here will be
grouped under a <code class="literal">fields</code> sub-dictionary in the output document. To store the
custom fields as top-level fields, set the <code class="literal">fields_under_root</code> option to true.
If a duplicate field is declared in the general configuration, then its value
will be overwritten by the value declared here.</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: filestream
  . . .
  fields:
    app_id: query_engine_12</pre>
</div>
<h5><a id="fields-under-root-filestream"></a><code class="literal">fields_under_root</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></h5>
<p>If this option is set to true, the custom
<a class="xref" href="filebeat-input-filestream.html#filebeat-input-filestream-fields" title="fields">fields</a> are stored as top-level fields in
the output document instead of being grouped under a <code class="literal">fields</code> sub-dictionary. If
the custom field names conflict with other field names added by Filebeat,
then the custom fields overwrite the other fields.</p>
<h5><a id="_processors_9"></a><code class="literal">processors</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></h5>
<p>A list of processors to apply to the input data.</p>
<p>See <a class="xref" href="filtering-and-enhancing-data.html" title="Filter and enhance data with processors"><em>Processors</em></a> for information about specifying
processors in your config.</p>
<h5><a id="_pipeline_9"></a><code class="literal">pipeline</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></h5>
<p>The ingest pipeline ID to set for the events generated by this input.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The pipeline ID can also be configured in the Elasticsearch output, but
this option usually results in simpler configuration files. If the pipeline is
configured both in the input and output, the option from the
input is used.</p>
</div>
</div>
<h5><a id="_keep_null_9"></a><code class="literal">keep_null</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></h5>
<p>If this option is set to true, fields with <code class="literal">null</code> values will be published in
the output document. By default, <code class="literal">keep_null</code> is set to <code class="literal">false</code>.</p>
<h5><a id="_index_9"></a><code class="literal">index</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></h5>
<p>If present, this formatted string overrides the index for events from this input
(for elasticsearch outputs), or sets the <code class="literal">raw_index</code> field of the event&#8217;s
metadata (for other outputs). This string can only refer to the agent name and
version and the event timestamp; for access to dynamic fields, use
<code class="literal">output.elasticsearch.index</code> or a processor.</p>
<p>Example value: <code class="literal">"%{[agent.name]}-myindex-%{+yyyy.MM.dd}"</code> might
expand to <code class="literal">"filebeat-myindex-2019.11.01"</code>.</p>
<h5><a id="_publisher_pipeline_disable_host_9"></a><code class="literal">publisher_pipeline.disable_host</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.14/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></h5>
<p>By default, all events contain <code class="literal">host.name</code>. This option can be set to <code class="literal">true</code> to
disable the addition of this field to all events. The default value is <code class="literal">false</code>.</p>
</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="filebeat-input-etw.html">« ETW input</a>
</span>
<span class="next">
<a href="filebeat-input-gcp-pubsub.html">GCP Pub/Sub input »</a>
</span>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>

                        <!-- Feedback widget -->
                        <div id="feedbackWidgetContainer"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


        <div id='elastic-footer'></div>
        <script src='https://www.elastic.co/elastic-footer.js'></script>
        <!-- Footer Section end-->

      </section>
    </div>

    <!-- Feedback modal -->
    <div id="feedbackModalContainer"></div>

    <script src="/guide/static/jquery.js"></script>
    <script type="text/javascript" src="/guide/static/docs-v1.js"></script>
    <script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
