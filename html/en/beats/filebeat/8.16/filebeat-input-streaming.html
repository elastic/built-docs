<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Streaming Input | Filebeat Reference [8.16] | Elastic</title>
<meta class="elastic" name="content" content="Streaming Input | Filebeat Reference [8.16]">

<link rel="home" href="index.html" title="Filebeat Reference [8.16]"/>
<link rel="up" href="configuration-filebeat-options.html" title="Configure inputs"/>
<link rel="prev" href="filebeat-input-stdin.html" title="Stdin input"/>
<link rel="next" href="filebeat-input-syslog.html" title="Syslog input"/>
<meta class="elastic" name="product_version" content="8.16"/>
<meta class="elastic" name="product_name" content="Filebeat"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Filebeat/Reference/8.16"/>
<meta name="DC.subject" content="Filebeat"/>
<meta name="DC.identifier" content="8.16"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles-v1.css" />
  </head>

  <!--© 2015-2025 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div class="navheader">
<span class="prev">
<a href="filebeat-input-stdin.html">« Stdin input</a>
</span>
<span class="next">
<a href="filebeat-input-syslog.html">Syslog input »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Filebeat Reference [8.16]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="configuring-howto-filebeat.html">Configure Filebeat</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="configuration-filebeat-options.html">Configure inputs</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Streaming Input</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.16/x-pack/filebeat/docs/inputs/input-streaming.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section xpack">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="filebeat-input-streaming"></a>Streaming Input</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.16/x-pack/filebeat/docs/inputs/input-streaming.asciidoc">edit</a></div>
</div></div></div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in technical preview and may be changed or removed in a future release. Elastic will work to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.</p>
</div>
</div>

<p>The <code class="literal">streaming</code> input reads messages from a streaming data source, for example a websocket server. This input uses the <code class="literal">CEL engine</code> and the <code class="literal">mito</code> library internally to parse and process the messages. Having support for <code class="literal">CEL</code> allows you to parse and process the messages in a more flexible way. It has many similarities with the <code class="literal">cel</code> input as to how the <code class="literal">CEL</code> programs are written but differs in the way the messages are read and processed. Currently websocket server or API endpoints, and the Crowdstrike Falcon streaming API are supported.</p>
<p>The websocket streaming input supports:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Auth</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Basic
</li>
<li class="listitem">
Bearer
</li>
<li class="listitem">
Custom
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The <code class="literal">streaming</code> input websocket handler does not currently support XML messages. Auto-reconnects are also not supported at the moment so reconnection will occur on input restart.</p>
</div>
</div>
<p>The Crowdstrike streaming input requires OAuth2.0 as described in the Crowdstrike documentation for the API. When using the Crowdstrike streaming type, the <code class="literal">crowdstrike_app_id</code> configuration field must be set. This field specifies the <code class="literal">appId</code> parameter sent to the Crowdstrike API. See the Crowdstrike documentation for details.</p>
<p>The <code class="literal">stream_type</code> configuration field specifies which type of streaming input to use, "websocket" or "crowdstrike". If it is not set, the input defaults to websocket streaming  .</p>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_execution_3"></a>Execution</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.16/x-pack/filebeat/docs/inputs/input-streaming.asciidoc">edit</a></div>
</div></div></div>
<p>The execution environment provided for the input includes includes the functions, macros, and global variables provided by the mito library.
A single JSON object is provided as an input accessible through a <code class="literal">state</code> variable. <code class="literal">state</code> contains a <code class="literal">response</code> map field and may contain arbitrary other fields configured via the input&#8217;s <code class="literal">state</code> configuration. If the CEL program saves cursor states between executions of the program, the configured <code class="literal">state.cursor</code> value will be replaced by the saved cursor prior to execution.</p>
<p>On start the <code class="literal">state</code> will be something like this:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
    "response": { ... },
    "cursor": { ... },
    ...
}</pre>
</div>
<p>The <code class="literal">streaming</code> input websocket handler creates a <code class="literal">response</code> field in the state map and attaches the websocket message to this field. All <code class="literal">CEL</code> programs written should act on this <code class="literal">response</code> field. Additional fields may be present at the root of the object and if the program tolerates it, the cursor value may be absent. Only the cursor is persisted over restarts, but all fields in state are retained between iterations of the processing loop except for the produced events array, see below.</p>
<p>If the cursor is present the program should process or filter out responses based on its value. If cursor is not present all responses should be processed as per the program&#8217;s logic.</p>
<p>After completion of a program&#8217;s execution it should return a single object with a structure looking like this:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
    "events": [ <a id="CO17-1"></a><i class="conum" data-value="1"></i>
        {...},
        ...
    ],
    "cursor": [ <a id="CO17-2"></a><i class="conum" data-value="2"></i>
        {...},
        ...
    ]
}</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO17-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>The <code class="literal">events</code> field must be present, but may be empty or null. If it is not empty, it must only have objects as elements.
The field could be an array or a single object that will be treated as an array with a single element. This depends completely on the streaming data source. The <code class="literal">events</code> field is the array of events to be published to the output. Each event must be a JSON object.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO17-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>If <code class="literal">cursor</code> is present it must be either be a single object or an array with the same length as events; each element <em>i</em> of the <code class="literal">cursor</code> will be the details for obtaining the events at and beyond event <em>i</em> in the <code class="literal">events</code> array. If the <code class="literal">cursor</code> is a single object, it will be the details for obtaining events after the last event in the <code class="literal">events</code> array and will only be retained on successful publication of all the events in the <code class="literal">events</code> array.</p>
</td>
</tr>
</table>
</div>
<p>Example configurations:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
# Read and process simple websocket messages from a local websocket server
- type: streaming
  url: ws://localhost:443/v1/stream
  program: |
    bytes(state.response).decode_json().as(inner_body,{
      "events": {
        "message":  inner_body.encode_json(),
      }
    })</pre>
</div>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
# Read and process events from the Crowdstrike Falcon Hose API
- type: streaming
  stream_type: crowdstrike
  url: https://api.crowdstrike.com/sensors/entities/datafeed/v2
  auth:
    client_id: a23fcea2643868ef1a41565a1a8a1c7c
    client_secret: c3VwZXJzZWNyZXRfY2xpZW50X3NlY3JldF9zaGhoaGgK
    token_url: https://api.crowdstrike.com/oauth2/token
  crowdstrike_app_id: my_app_id
  program: |
    state.response.decode_json().as(body,{
      "events": [body],
      ?"cursor": has(body.?metadata.offset) ?
        optional.of({"offset": body.metadata.offset})
      :
        optional.none(),
    })</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_debug_state_logging_2"></a>Debug state logging</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.16/x-pack/filebeat/docs/inputs/input-streaming.asciidoc">edit</a></div>
</div></div></div>
<p>The Websocket input will log the complete state when logging at the DEBUG level before and after CEL evaluation.
This will include any sensitive or secret information kept in the <code class="literal">state</code> object, and so DEBUG level logging should not be used in production when sensitive information is retained in the <code class="literal">state</code> object. See <a class="xref" href="filebeat-input-streaming.html#streaming-state-redact" title="redact"><code class="literal">redact</code></a> configuration parameters for settings to exclude sensitive fields from DEBUG logs.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_authentication"></a>Authentication</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.16/x-pack/filebeat/docs/inputs/input-streaming.asciidoc">edit</a></div>
</div></div></div>
<p>The websocket streaming input supports authentication via Basic token authentication, Bearer token authentication and authentication via a custom auth config. Unlike REST inputs Basic Authentication contains a basic auth token, Bearer Authentication contains a bearer token and custom auth contains any combination of custom header and value. These token/key values are are added to the request headers and are not exposed to the <code class="literal">state</code> object. The custom auth configuration is useful for constructing requests that require custom headers and values for authentication. The basic and bearer token configurations will always use the <code class="literal">Authorization</code> header and prepend the token with <code class="literal">Basic</code> or <code class="literal">Bearer</code> respectively.</p>
<p>Example configurations with authentication:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: streaming
  auth.basic_token: "dXNlcjpwYXNzd29yZA=="
  url: wss://localhost:443/_stream</pre>
</div>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: streaming
  auth.bearer_token: "dXNlcjpwYXNzd29yZA=="
  url: wss://localhost:443/_stream</pre>
</div>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: streaming
  auth.custom:
    header: "x-api-key"
    value: "dXNlcjpwYXNzd29yZA=="
  url: wss://localhost:443/_stream</pre>
</div>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: streaming
  auth.custom:
    header: "Auth"
    value: "Bearer dXNlcjpwYXNzd29yZA=="
  url: wss://localhost:443/_stream</pre>
</div>
<p>The crowdstrike streaming input requires OAuth2.0 authentication using a client ID, client secret and a token URL. These values are not exposed to the <code class="literal">state</code> object. OAuth2.0 scopes and endpoint parameters are available via the <code class="literal">auth.scopes</code> and <code class="literal">auth.endpoint_params</code> config parameters.</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: streaming
  stream_type: crowdstrike
  auth:
    client_id: a23fcea2643868ef1a41565a1a8a1c7c
    client_secret: c3VwZXJzZWNyZXRfY2xpZW50X3NlY3JldF9zaGhoaGgK
    token_url: https://api.crowdstrike.com/oauth2/token</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="input-state-streaming"></a>Input state</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.16/x-pack/filebeat/docs/inputs/input-streaming.asciidoc">edit</a></div>
</div></div></div>
<p>The <code class="literal">streaming</code> input keeps a runtime state between every message received. This state can be accessed by the CEL program and may contain arbitrary objects.
The state must contain a <code class="literal">response</code> map and may contain any object the user wishes to store in it. All objects are stored at runtime, except <code class="literal">cursor</code>, which has values that are persisted between restarts.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_configuration_options_17"></a>Configuration options</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.16/x-pack/filebeat/docs/inputs/input-streaming.asciidoc">edit</a></div>
</div></div></div>
<p>The <code class="literal">streaming</code> input supports the following configuration options plus the
<a class="xref" href="filebeat-input-streaming.html#filebeat-input-streaming-common-options" title="Common options">Common options</a> described later.</p>
<div class="position-relative"><h4><a id="stream_type-streaming"></a><code class="literal">stream_type</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.16/x-pack/filebeat/docs/inputs/input-streaming.asciidoc">edit</a></div>
<p>The flavor of streaming to use. This may be either "websocket", "crowdstrike", or unset. If the field is unset, websocket streaming is used.</p>
<div class="position-relative"><h4><a id="program-streaming"></a><code class="literal">program</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.16/x-pack/filebeat/docs/inputs/input-streaming.asciidoc">edit</a></div>
<p>The CEL program that is executed on each message received. This field should ideally be present but if not the default program given below is used.</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">program: |
  bytes(state.response).decode_json().as(inner_body,{
    "events": {
      "message":  inner_body.encode_json(),
    }
  })</pre>
</div>
<div class="position-relative"><h4><a id="input-url-program-streaming"></a><code class="literal">url_program</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.16/x-pack/filebeat/docs/inputs/input-streaming.asciidoc">edit</a></div>
<p>If present, this CEL program is executed before the streaming connection is established using the <code class="literal">state</code> object, including any stored cursor value. It must evaluate to a valid URL. The returned URL is used to make the streaming connection for processing. The program may use cursor values or other state defined values to customize the URL at runtime.</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">url: ws://testapi:443/v1/streamresults
state:
  initial_start_time: "2022-01-01T00:00:00Z"
url_program: |
  state.url + "?since=" + state.?cursor.since.orValue(state.initial_start_time)
program: |
  bytes(state.response).decode_json().as(inner_body,{
    "events": {
      "message":  inner_body.encode_json(),
    },
    "cursor": {
      "since": inner_body.timestamp
    }
  })</pre>
</div>
<div class="position-relative"><h4><a id="state-streaming"></a><code class="literal">state</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.16/x-pack/filebeat/docs/inputs/input-streaming.asciidoc">edit</a></div>
<p><code class="literal">state</code> is an optional object that is passed to the CEL program on the first execution. It is available to the executing program as the <code class="literal">state</code> variable. Except for the <code class="literal">state.cursor</code> field, <code class="literal">state</code> does not persist over restarts.</p>
<div class="position-relative"><h4><a id="cursor-streaming"></a><code class="literal">state.cursor</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.16/x-pack/filebeat/docs/inputs/input-streaming.asciidoc">edit</a></div>
<p>The cursor is an object available as <code class="literal">state.cursor</code> where arbitrary values may be stored. Cursor state is kept between input restarts and updated after each event of a request has been published. When a cursor is used the CEL program must either create a cursor state for each event that is returned by the program, or a single cursor that reflects the cursor for completion of the full set of events.</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
# Read and process simple websocket messages from a local websocket server
- type: streaming
  url: ws://localhost:443/v1/stream
  program: |
    bytes(state.response).as(body, {
      "events": [body.decode_json().with({
        "last_requested_at": has(state.cursor) &amp;&amp; has(state.cursor.last_requested_at) ?
          state.cursor.last_requested_at
        :
          now
      })],
      "cursor": {"last_requested_at": now}
    })</pre>
</div>
<div class="position-relative"><h4><a id="regexp-streaming"></a><code class="literal">regexp</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.16/x-pack/filebeat/docs/inputs/input-streaming.asciidoc">edit</a></div>
<p>A set of named regular expressions that may be used during a CEL program&#8217;s execution using the <code class="literal">regexp</code> extension library. The syntax used for the regular expressions is <a href="https://github.com/google/re2/wiki/Syntax" class="ulink" target="_top">RE2</a>.</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: streaming
  # Define two regular expressions, 'products' and 'solutions' for use during CEL program execution.
  regexp:
    products: '(?i)(Elasticsearch|Beats|Logstash|Kibana)'
    solutions: '(?i)(Search|Observability|Security)'</pre>
</div>
<div class="position-relative"><h4><a id="streaming-state-redact"></a><code class="literal">redact</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.16/x-pack/filebeat/docs/inputs/input-streaming.asciidoc">edit</a></div>
<p>During debug level logging, the <code class="literal">state</code> object and the resulting evaluation result are included in logs. This may result in leaking of secrets. In order to prevent this, fields may be redacted or deleted from the logged <code class="literal">state</code>. The <code class="literal">redact</code> configuration allows users to configure this field redaction behaviour. For safety reasons if the <code class="literal">redact</code> configuration is missing a warning is logged.</p>
<p>In the case of no-required redaction an empty <code class="literal">redact.fields</code> configuration should be used to silence the logged warning.</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">- type: streaming
  redact:
    fields: ~</pre>
</div>
<p>As an example, if a user-constructed Basic Authentication request is used in a CEL program the password can be redacted like so</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: streaming
  url: ws://localhost:443/_stream
  state:
    user: user@domain.tld
    password: P@$$W0₹D
  redact:
    fields:
      - password
    delete: true</pre>
</div>
<p>Note that fields under the <code class="literal">auth</code> configuration hierarchy are not exposed to the <code class="literal">state</code> and so do not need to be redacted. For this reason it is preferable to use these for authentication over the request construction shown above where possible.</p>
<div class="position-relative"><h4><a id="_redact_fields_2"></a><code class="literal">redact.fields</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.16/x-pack/filebeat/docs/inputs/input-streaming.asciidoc">edit</a></div>
<p>This specifies fields in the <code class="literal">state</code> to be redacted prior to debug logging. Fields listed in this array will be either replaced with a <code class="literal">*</code> or deleted entirely from messages sent to debug logs.</p>
<div class="position-relative"><h4><a id="_redact_delete_2"></a><code class="literal">redact.delete</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.16/x-pack/filebeat/docs/inputs/input-streaming.asciidoc">edit</a></div>
<p>This specifies whether fields should be replaced with a <code class="literal">*</code> or deleted entirely from messages sent to debug logs. If delete is <code class="literal">true</code>, fields will be deleted rather than replaced.</p>
<div class="position-relative"><h4><a id="retry-streaming"></a><code class="literal">retry</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.16/x-pack/filebeat/docs/inputs/input-streaming.asciidoc">edit</a></div>
<p>The <code class="literal">retry</code> configuration allows the user to specify the number of times the input should attempt to reconnect to the streaming data source in the event of a connection failure. The default value is <code class="literal">nil</code> which means no retries will be attempted. It has a <code class="literal">wait_min</code> and <code class="literal">wait_max</code> configuration which specifies the minimum and maximum time to wait between retries.</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: streaming
  url: ws://localhost:443/_stream
  program: |
    bytes(state.response).decode_json().as(inner_body,{
      "events": {
        "message":  inner_body.encode_json(),
      }
    })
  retry:
    max_attempts: 5
    wait_min: 1s
    wait_max: 10s</pre>
</div>
<div class="position-relative"><h4><a id="_retry_max_attempts"></a><code class="literal">retry.max_attempts</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.16/x-pack/filebeat/docs/inputs/input-streaming.asciidoc">edit</a></div>
<p>The maximum number of times the input should attempt to reconnect to the streaming data source in the event of a connection failure. The default value is <code class="literal">5</code> which means a maximum of 5 retries will be attempted.</p>
<div class="position-relative"><h4><a id="_retry_wait_min"></a><code class="literal">retry.wait_min</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.16/x-pack/filebeat/docs/inputs/input-streaming.asciidoc">edit</a></div>
<p>The minimum time to wait between retries. This ensures that retries are spaced out enough to give the system time to recover or resolve transient issues, rather than bombarding the system with rapid retries. For example, <code class="literal">wait_min</code> might be set to 1 second, meaning that even if the calculated backoff is less than this, the client will wait at least 1 second before retrying. The default value is <code class="literal">1</code> second.</p>
<div class="position-relative"><h4><a id="_retry_wait_max"></a><code class="literal">retry.wait_max</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.16/x-pack/filebeat/docs/inputs/input-streaming.asciidoc">edit</a></div>
<p>The maximum time to wait between retries. This prevents the retry mechanism from becoming too slow, ensuring that the client does not wait indefinitely between retries. This is crucial in systems where timeouts or user experience are critical. For example, <code class="literal">wait_max</code> might be set to 10 seconds, meaning that even if the calculated backoff is greater than this, the client will wait at most 10 seconds before retrying. The default value is <code class="literal">30</code> seconds.</p>
<div class="position-relative"><h3><a id="_timeout"></a><code class="literal">timeout</code></h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.16/x-pack/filebeat/docs/inputs/input-streaming.asciidoc">edit</a></div>
<p>Timeout is the maximum amount of time the websocket dialer will wait for a connection to be established. The default value is <code class="literal">180</code> seconds.</p>
<div class="position-relative"><h4><a id="_proxy_url"></a><code class="literal">proxy_url</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.16/x-pack/filebeat/docs/inputs/input-streaming.asciidoc">edit</a></div>
<p>This specifies the forward proxy URL to use for the connection. The <code class="literal">proxy_url</code> configuration is optional and can be used to configure the proxy settings for the connection. The <code class="literal">proxy_url</code> default value is set by <code class="literal">http.ProxyFromEnvironment</code> which reads the <code class="literal">HTTP_PROXY</code>, <code class="literal">HTTPS_PROXY</code>, and <code class="literal">NO_PROXY</code> environment variables.</p>
<div class="position-relative"><h4><a id="_proxy_headers"></a><code class="literal">proxy_headers</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.16/x-pack/filebeat/docs/inputs/input-streaming.asciidoc">edit</a></div>
<p>This specifies the headers to be sent to the proxy server. The <code class="literal">proxy_headers</code> configuration is optional and can be used to configure the headers to be sent to the proxy server.</p>
<div class="position-relative"><h4><a id="_ssl_3"></a><code class="literal">ssl</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.16/x-pack/filebeat/docs/inputs/input-streaming.asciidoc">edit</a></div>
<p>This specifies the SSL configuration for the connection. The <code class="literal">ssl</code> configuration is optional and can be used to configure the SSL settings for the connection. The <code class="literal">ssl</code> configuration has the following subfields:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">certificate_authorities</code>: A list of root certificates to use for verifying the server&#8217;s certificate.
</li>
<li class="listitem">
<code class="literal">certificate</code>: The (PEM encoded) certificate to use for client authentication.
</li>
<li class="listitem">
<code class="literal">key</code>: The (PEM encoded) private key to use for client authentication.
</li>
</ul>
</div>
<p>If this is a self-signed certificate, the <code class="literal">certificate_authorities</code> field should be set to the certificate itself.</p>
<div class="position-relative"><h3><a id="_metrics_13"></a>Metrics</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.16/x-pack/filebeat/docs/inputs/input-streaming.asciidoc">edit</a></div>
<p>This input exposes metrics under the <a class="xref" href="http-endpoint.html" title="Configure an HTTP endpoint for metrics">HTTP monitoring endpoint</a>.
These metrics are exposed under the <code class="literal">/inputs</code> path. They can be used to
observe the activity of the input.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Metric</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">url</code></p></td>
<td align="left" valign="top"><p>URL of the input resource.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">cel_eval_errors</code></p></td>
<td align="left" valign="top"><p>Number of errors encountered during cel program evaluation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">errors_total</code></p></td>
<td align="left" valign="top"><p>Number of errors encountered over the life cycle of the input.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">batches_received_total</code></p></td>
<td align="left" valign="top"><p>Number of event arrays received.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">batches_published_total</code></p></td>
<td align="left" valign="top"><p>Number of event arrays published.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">received_bytes_total</code></p></td>
<td align="left" valign="top"><p>Number of bytes received over the life cycle of the input.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">events_received_total</code></p></td>
<td align="left" valign="top"><p>Number of events received.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">events_published_total</code></p></td>
<td align="left" valign="top"><p>Number of events published.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">cel_processing_time</code></p></td>
<td align="left" valign="top"><p>Histogram of the elapsed successful CEL program processing times in nanoseconds.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">batch_processing_time</code></p></td>
<td align="left" valign="top"><p>Histogram of the elapsed successful batch processing times in nanoseconds (time of receipt to time of ACK for non-empty batches).</p></td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_developer_tools_2"></a>Developer tools</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.16/x-pack/filebeat/docs/inputs/input-streaming.asciidoc">edit</a></div>
</div></div></div>
<p>A stand-alone CEL environment that implements the majority of the streaming input&#8217;s Comment Expression Language functionality is available in the <a href="https://github.com/elastic/mito" class="ulink" target="_top">Elastic Mito</a> repository. This tool may be used to help develop CEL programs to be used by the input. Installation is available from source by running <code class="literal">go install github.com/elastic/mito/cmd/mito@latest</code> and requires a Go toolchain.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="filebeat-input-streaming-common-options"></a>Common options</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.16/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></div>
</div></div></div>
<p>The following configuration options are supported by all inputs.</p>
<div class="position-relative"><h5><a id="_enabled_23"></a><code class="literal">enabled</code></h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.16/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></div>
<p>Use the <code class="literal">enabled</code> option to enable and disable inputs. By default, enabled is
set to true.</p>
<div class="position-relative"><h5><a id="_tags_22"></a><code class="literal">tags</code></h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.16/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></div>
<p>A list of tags that Filebeat includes in the <code class="literal">tags</code> field of each published
event. Tags make it easy to select specific events in Kibana or apply
conditional filtering in Logstash. These tags will be appended to the list of
tags specified in the general configuration.</p>
<p>Example:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: streaming
  . . .
  tags: ["json"]</pre>
</div>
<div class="position-relative"><h5><a id="filebeat-input-streaming-fields"></a><code class="literal">fields</code></h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.16/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></div>
<p>Optional fields that you can specify to add additional information to the
output. For example, you might add fields that you can use for filtering log
data. Fields can be scalar values, arrays, dictionaries, or any nested
combination of these. By default, the fields that you specify here will be
grouped under a <code class="literal">fields</code> sub-dictionary in the output document. To store the
custom fields as top-level fields, set the <code class="literal">fields_under_root</code> option to true.
If a duplicate field is declared in the general configuration, then its value
will be overwritten by the value declared here.</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: streaming
  . . .
  fields:
    app_id: query_engine_12</pre>
</div>
<div class="position-relative"><h5><a id="fields-under-root-streaming"></a><code class="literal">fields_under_root</code></h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.16/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></div>
<p>If this option is set to true, the custom
<a class="xref" href="filebeat-input-streaming.html#filebeat-input-streaming-fields" title="fields">fields</a> are stored as top-level fields in
the output document instead of being grouped under a <code class="literal">fields</code> sub-dictionary. If
the custom field names conflict with other field names added by Filebeat,
then the custom fields overwrite the other fields.</p>
<div class="position-relative"><h5><a id="_processors_22"></a><code class="literal">processors</code></h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.16/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></div>
<p>A list of processors to apply to the input data.</p>
<p>See <a class="xref" href="filtering-and-enhancing-data.html" title="Filter and enhance data with processors"><em>Processors</em></a> for information about specifying
processors in your config.</p>
<div class="position-relative"><h5><a id="_pipeline_22"></a><code class="literal">pipeline</code></h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.16/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></div>
<p>The ingest pipeline ID to set for the events generated by this input.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The pipeline ID can also be configured in the Elasticsearch output, but
this option usually results in simpler configuration files. If the pipeline is
configured both in the input and output, the option from the
input is used.</p>
</div>
</div>
<div class="position-relative"><h5><a id="_keep_null_22"></a><code class="literal">keep_null</code></h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.16/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></div>
<p>If this option is set to true, fields with <code class="literal">null</code> values will be published in
the output document. By default, <code class="literal">keep_null</code> is set to <code class="literal">false</code>.</p>
<div class="position-relative"><h5><a id="_index_22"></a><code class="literal">index</code></h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.16/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></div>
<p>If present, this formatted string overrides the index for events from this input
(for elasticsearch outputs), or sets the <code class="literal">raw_index</code> field of the event&#8217;s
metadata (for other outputs). This string can only refer to the agent name and
version and the event timestamp; for access to dynamic fields, use
<code class="literal">output.elasticsearch.index</code> or a processor.</p>
<p>Example value: <code class="literal">"%{[agent.name]}-myindex-%{+yyyy.MM.dd}"</code> might
expand to <code class="literal">"filebeat-myindex-2019.11.01"</code>.</p>
<div class="position-relative"><h5><a id="_publisher_pipeline_disable_host_22"></a><code class="literal">publisher_pipeline.disable_host</code></h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.16/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></div>
<p>By default, all events contain <code class="literal">host.name</code>. This option can be set to <code class="literal">true</code> to
disable the addition of this field to all events. The default value is <code class="literal">false</code>.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The <code class="literal">streaming</code> input is currently tagged as experimental and might have bugs and other issues. Please report any issues on the <a href="https://github.com/elastic/beats" class="ulink" target="_top">Github</a> repository.</p>
</div>
</div>
</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="filebeat-input-stdin.html">« Stdin input</a>
</span>
<span class="next">
<a href="filebeat-input-syslog.html">Syslog input »</a>
</span>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>

                        <!-- Feedback widget -->
                        <div id="feedbackWidgetContainer"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


        <div id='elastic-footer'></div>
        <script src='https://www.elastic.co/elastic-footer.js'></script>
        <!-- Footer Section end-->

      </section>
    </div>

    <!-- Feedback modal -->
    <div id="feedbackModalContainer"></div>

    <script src="/guide/static/jquery.js"></script>
    <script type="text/javascript" src="/guide/static/docs-v1.js"></script>
    <script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
