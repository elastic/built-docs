<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>HTTP JSON input | Filebeat Reference [8.6] | Elastic</title>
<link rel="home" href="index.html" title="Filebeat Reference [8.6]"/>
<link rel="up" href="configuration-filebeat-options.html" title="Configure inputs"/>
<link rel="prev" href="filebeat-input-http_endpoint.html" title="HTTP Endpoint input"/>
<link rel="next" href="filebeat-input-journald.html" title="Journald input"/>
<meta name="DC.type" content="Learn/Docs/Filebeat/Reference/8.6"/>
<meta name="DC.subject" content="Filebeat"/>
<meta name="DC.identifier" content="8.6"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <!--© 2015-2022 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <!--BEGIN QUALTRICS WEBSITE FEEDBACK SNIPPET-->
    <script type='text/javascript'>
      (function(){var g=function(e,h,f,g){
      this.get=function(a){for(var a=a+"=",c=document.cookie.split(";"),b=0,e=c.length;b<e;b++){for(var d=c[b];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return null};
      this.set=function(a,c){var b="",b=new Date;b.setTime(b.getTime()+6048E5);b="; expires="+b.toGMTString();document.cookie=a+"="+c+b+"; path=/; "};
      this.check=function(){var a=this.get(f);if(a)a=a.split(":");else if(100!=e)"v"==h&&(e=Math.random()>=e/100?0:100),a=[h,e,0],this.set(f,a.join(":"));else return!0;var c=a[1];if(100==c)return!0;switch(a[0]){case "v":return!1;case "r":return c=a[2]%Math.floor(100/c),a[2]++,this.set(f,a.join(":")),!c}return!0};
      this.go=function(){if(this.check()){var a=document.createElement("script");a.type="text/javascript";a.src=g;document.body&&document.body.appendChild(a)}};
      this.start=function(){var a=this;window.addEventListener?window.addEventListener("load",function(){a.go()},!1):window.attachEvent&&window.attachEvent("onload",function(){a.go()})}};
      try{(new g(100,"r","QSI_S_ZN_emkP0oSe9Qrn7kF","https://znemkp0ose9qrn7kf-elastic.siteintercept.qualtrics.com/WRSiteInterceptEngine/?Q_ZID=ZN_emkP0oSe9Qrn7kF")).start()}catch(i){}})();
    </script><div id='ZN_emkP0oSe9Qrn7kF'><!--DO NOT REMOVE-CONTENTS PLACED HERE--></div>
    <!--END WEBSITE FEEDBACK SNIPPET-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="index.html">Filebeat Reference [8.6]</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="configuring-howto-filebeat.html">Configure Filebeat</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="configuration-filebeat-options.html">Configure inputs</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="filebeat-input-http_endpoint.html">« HTTP Endpoint input</a>
</span>
<span class="next">
<a href="filebeat-input-journald.html">Journald input »</a>
</span>
</div>
<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="filebeat-input-httpjson"></a>HTTP JSON input<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h2>
</div></div></div>

<p>Use the <code class="literal">httpjson</code> input to read messages from an HTTP API with JSON payloads.</p>
<p>This input supports:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Auth</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Basic
</li>
<li class="listitem">
OAuth2
</li>
</ul>
</div>
</li>
<li class="listitem">
Retrieval at a configurable interval
</li>
<li class="listitem">
Pagination
</li>
<li class="listitem">
Retries
</li>
<li class="listitem">
Rate limiting
</li>
<li class="listitem">
Proxying
</li>
<li class="listitem">
Request transformations
</li>
<li class="listitem">
Response transformations
</li>
</ul>
</div>
<p>Example configurations:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
# Fetch your public IP every minute.
- type: httpjson
  interval: 1m
  request.url: https://api.ipify.org/?format=json
  processors:
    - decode_json_fields:
        fields: ["message"]
        target: "json"</pre>
</div>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: httpjson
  request.url: http://localhost:9200/_search?scroll=5m
  request.method: POST
  response.split:
    target: body.hits.hits
  response.pagination:
    - set:
        target: url.value
        value: http://localhost:9200/_search/scroll
    - set:
        target: url.params.scroll_id
        value: '[[.last_response.body._scroll_id]]'
    - set:
        target: body.scroll
        value: 5m</pre>
</div>
<p>Additionally, it supports authentication via Basic auth, HTTP Headers or oauth2.</p>
<p>Example configurations with authentication:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: httpjson
  request.url: http://localhost
  request.transforms:
    - set:
        target: header.Authorization
        value: 'Basic aGVsbG86d29ybGQ='</pre>
</div>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: httpjson
  auth.oauth2:
    client.id: 12345678901234567890abcdef
    client.secret: abcdef12345678901234567890
    token_url: http://localhost/oauth2/token
  request.url: http://localhost</pre>
</div>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: httpjson
  auth.oauth2:
    client.id: 12345678901234567890abcdef
    client.secret: abcdef12345678901234567890
    token_url: http://localhost/oauth2/token
    user: user@domain.tld
    password: P@$$W0₹D
  request.url: http://localhost</pre>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="input-state"></a>Input state<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h3>
</div></div></div>
<p>The <code class="literal">httpjson</code> input keeps a runtime state between requests. This state can be accessed by some configuration options and transforms.</p>
<p>The state has the following elements:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">last_response.url.value</code>: The full URL with params and fragments from the last request with a successful response.
</li>
<li class="listitem">
<code class="literal">last_response.url.params</code>: A <a href="https://pkg.go.dev/net/url#Values" class="ulink" target="_top"><code class="literal">url.Values</code></a> of the params from the URL in <code class="literal">last_response.url.value</code>.  Can be queried with the <a href="https://pkg.go.dev/net/url#Values.Get" class="ulink" target="_top"><code class="literal">Get</code></a> function.
</li>
<li class="listitem">
<code class="literal">last_response.header</code>: A map containing the headers from the last successful response.
</li>
<li class="listitem">
<code class="literal">last_response.body</code>: A map containing the parsed JSON body from the last successful response. This is the response as it comes from the remote server.
</li>
<li class="listitem">
<code class="literal">last_response.page</code>: A number indicating the page number of the last response. It starts with the value <code class="literal">0</code> at every interval.
</li>
<li class="listitem">
<code class="literal">first_event</code>: A map representing the first event sent to the output (result from applying transforms to <code class="literal">last_response.body</code>).
</li>
<li class="listitem">
<code class="literal">last_event</code>: A map representing the last event of the current request in the requests chain (result from applying transforms to <code class="literal">last_response.body</code>).
</li>
<li class="listitem">
<code class="literal">url</code>: The last requested URL as a raw <a href="https://pkg.go.dev/net/url#URL" class="ulink" target="_top"><code class="literal">url.URL</code></a> Go type.
</li>
<li class="listitem">
<code class="literal">header</code>: A map containing the headers. References the next request headers when used in <a class="xref" href="filebeat-input-httpjson.html#request-transforms-headers" title="request.rate_limit.early_limit"><code class="literal">request.rate_limit.early_limit</code></a> or <a class="xref" href="filebeat-input-httpjson.html#response-pagination" title="response.pagination"><code class="literal">response.pagination</code></a> configuration sections, and to the last response headers when used in <a class="xref" href="filebeat-input-httpjson.html#response-transforms" title="response.transforms"><code class="literal">response.transforms</code></a>, <a class="xref" href="filebeat-input-httpjson.html#response-split" title="response.split"><code class="literal">response.split</code></a>, or <a class="xref" href="filebeat-input-httpjson.html#request-rate-limit" title="request.rate_limit.limit"><code class="literal">request.rate_limit.limit</code></a> configuration sections.
</li>
<li class="listitem">
<code class="literal">body</code>: A map containing the body. References the next request body when used in <a class="xref" href="filebeat-input-httpjson.html#request-transforms-headers" title="request.rate_limit.early_limit"><code class="literal">request.rate_limit.early_limit</code></a> or <a class="xref" href="filebeat-input-httpjson.html#response-pagination" title="response.pagination"><code class="literal">response.pagination</code></a> configuration sections, and to the last response body when used in <a class="xref" href="filebeat-input-httpjson.html#response-transforms" title="response.transforms"><code class="literal">response.transforms</code></a> or <a class="xref" href="filebeat-input-httpjson.html#response-split" title="response.split"><code class="literal">response.split</code></a> configuration sections.
</li>
<li class="listitem">
<code class="literal">cursor</code>: A map containing any data the user configured to be stored between restarts (See <a class="xref" href="filebeat-input-httpjson.html#cursor" title="cursor"><code class="literal">cursor</code></a>).
</li>
</ul>
</div>
<p>All of the mentioned objects are only stored at runtime, except <code class="literal">cursor</code>, which has values that are persisted between restarts.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="transforms"></a>Transforms<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h3>
</div></div></div>
<p>A transform is an action that lets the user modify the <a class="xref" href="filebeat-input-httpjson.html#input-state" title="Input state">input state</a>. Depending on where the transform is defined, it will have access for reading or writing different elements of the <a class="xref" href="filebeat-input-httpjson.html#input-state" title="Input state">state</a>.</p>
<p>The access limitations are described in the corresponding configuration sections.</p>
<h4><a id="_append"></a><code class="literal">append</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>Appends a value to an array. If the field does not exist, the first entry will create a new array. If the field exists, the value is appended to the existing field and converted to a list.</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">- append:
    target: body.foo.bar
    value: '[[.cursor.baz]]'
    default: "a default value"</pre>
</div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">target</code> defines the destination field where the value is stored.
</li>
<li class="listitem">
<code class="literal">value</code> defines the value that will be stored and it is a <a class="xref" href="filebeat-input-httpjson.html#value-templates" title="Value templates">value template</a>.
</li>
<li class="listitem">
<code class="literal">default</code> defines the fallback value whenever <code class="literal">value</code> is empty or the template parsing fails. Default templates do not have access to any state, only to functions.
</li>
<li class="listitem">
<code class="literal">value_type</code> defines the type of the resulting value. Possible values are: <code class="literal">string</code>, <code class="literal">json</code>, and <code class="literal">int</code>. Default is <code class="literal">string</code>.
</li>
<li class="listitem">
<code class="literal">fail_on_template_error</code> if set to <code class="literal">true</code> an error will be returned and the request will be aborted when the template evaluation fails. Default is <code class="literal">false</code>.
</li>
</ul>
</div>
<h4><a id="_delete"></a><code class="literal">delete</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>Deletes the target field.</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">- delete:
    target: body.foo.bar</pre>
</div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">target</code> defines the destination field to delete. If <code class="literal">target</code> is a list and not a single element, the complete list will be deleted.
</li>
</ul>
</div>
<h4><a id="_set"></a><code class="literal">set</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>Sets a value.</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">- set:
    target: body.foo.bar
    value: '[[.cursor.baz]]'
    default: "a default value"</pre>
</div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">target</code> defines the destination field where the value is stored.
</li>
<li class="listitem">
<code class="literal">value</code> defines the value that will be stored and it is a <a class="xref" href="filebeat-input-httpjson.html#value-templates" title="Value templates">value template</a>.
</li>
<li class="listitem">
<code class="literal">default</code> defines the fallback value whenever <code class="literal">value</code> is empty or the template parsing fails. Default templates do not have access to any state, only to functions.
</li>
<li class="listitem">
<code class="literal">value_type</code> defines how the resulting value will be treated. Possible values are: <code class="literal">string</code>, <code class="literal">json</code>, and <code class="literal">int</code>. Default is <code class="literal">string</code>.
</li>
<li class="listitem">
<code class="literal">fail_on_template_error</code> if set to <code class="literal">true</code> an error will be returned and the request will be aborted when the template evaluation fails. Default is <code class="literal">false</code>.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="value-templates"></a>Value templates<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h3>
</div></div></div>
<p>Some configuration options and transforms can use value templates. Value templates are Go templates with access to the input state and to some built-in functions.
Please note that delimiters are changed from the default <code class="literal">{{ }}</code> to <code class="literal">[[ ]]</code> to improve interoperability with other templating mechanisms.</p>
<p>To see which <a class="xref" href="filebeat-input-httpjson.html#input-state" title="Input state">state elements</a> and operations are available, see the documentation for the option or <a class="xref" href="filebeat-input-httpjson.html#transforms" title="Transforms">transform</a> where you want to use a value template.</p>
<p>A value template looks like:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">- set:
    target: body.foo.bar
    value: '[[.cursor.baz]] more data'
    default: "a default value"</pre>
</div>
<p>The content inside the brackets <code class="literal">[[</code> <code class="literal">]]</code> is evaluated. For more information on Go templates please refer to <a href="https://golang.org/pkg/text/template" class="ulink" target="_top">the Go docs</a>.</p>
<p>Some built-in helper functions are provided to work with the input state inside value templates:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">add</code>: adds a list of integers and returns their sum.
</li>
<li class="listitem">
<code class="literal">base64DecodeNoPad</code>: Decodes the base64 string without padding. Any binary output will be converted to a UTF8 string.
</li>
<li class="listitem">
<code class="literal">base64Decode</code>: Decodes the base64 string. Any binary output will be converted to a UTF8 string.
</li>
<li class="listitem">
<code class="literal">base64EncodeNoPad</code>: Joins and base64 encodes all supplied strings without padding. Example <code class="literal">[[base64EncodeNoPad "string1" "string2"]]</code>
</li>
<li class="listitem">
<code class="literal">base64Encode</code>: Joins and base64 encodes all supplied strings. Example <code class="literal">[[base64Encode "string1" "string2"]]</code>
</li>
<li class="listitem">
<code class="literal">beatInfo</code>: returns a map containing information about the Beat.  Available keys in the map are <code class="literal">goos</code> (running operating system), <code class="literal">goarch</code> (running system architecture), <code class="literal">commit</code> (git commit of current build), <code class="literal">buildtime</code> (compile time of current build), <code class="literal">version</code> (version of current build). Example: <code class="literal">[[ beatInfo.version ]]</code> returns <code class="literal">{version}</code>.
</li>
<li class="listitem">
<code class="literal">div</code>: does the integer division of two integer values.
</li>
<li class="listitem">
<code class="literal">formatDate</code>: formats a <code class="literal">time.Time</code>. By default the format layout is <code class="literal">RFC3339</code> but optionally can accept any of the Golang predefined layouts or a custom one. It will default to UTC timezone when formatting, but you can specify a different timezone. If the timezone is incorrect, it will default to UTC. Example: <code class="literal">[[ formatDate (now) "UnixDate" ]]</code>, <code class="literal">[[ formatDate (now) "UnixDate" "America/New_York" ]]</code>.
</li>
<li class="listitem">
<code class="literal">getRFC5988Link</code>: extracts a specific relation from a list of <a href="https://tools.ietf.org/html/rfc5988" class="ulink" target="_top">RFC5988</a> links. It is useful when parsing header values for pagination. Example: <code class="literal">[[ getRFC5988Link "next" .last_response.header.Link ]]</code>.
</li>
<li class="listitem">
<code class="literal">hashBase64</code>: calculates the hash of a list of strings concatenated together. Returns a base64 encoded hash. Supports sha1 or sha256. Example <code class="literal">[[hash "sha256" "string1" "string2" (formatDate (now) "RFC1123")]]</code>
</li>
<li class="listitem">
<code class="literal">hash</code>: calculates the hash of a list of strings concatenated together. Returns a hex encoded hash. Supports sha1 or sha256. Example <code class="literal">[[hash "sha256" "string1" "string2" (formatDate (now) "RFC1123")]]</code>
</li>
<li class="listitem">
<code class="literal">hexDecode</code>: Decodes the hexadecimal string. Any hexadecimal string will be converted to its bytes representation. Example <code class="literal">[[hexDecode "b0a92a08a9b4883aa3aa2d0957be12a678cbdbb32dc5db09fe68239a09872f96"]]</code>; Expected Output: <code class="literal">"\xb0\xa9*\b\xa9\xb4\x88:\xa3\xaa-\tW\xbe\x12\xa6x\xcb۳-\xc5\xdb\t\xfeh#\x9a\t\x87/\x96"</code>
</li>
<li class="listitem">
<code class="literal">hmacBase64</code>: calculates the hmac signature of a list of strings concatenated together. Returns a base64 encoded signature. Supports sha1 or sha256. Example <code class="literal">[[hmac "sha256" "secret" "string1" "string2" (formatDate (now) "RFC1123")]]</code>
</li>
<li class="listitem">
<code class="literal">hmac</code>: calculates the hmac signature of a list of strings concatenated together. Returns a hex encoded signature. Supports sha1 or sha256. Example <code class="literal">[[hmac "sha256" "secret" "string1" "string2" (formatDate (now) "RFC1123")]]</code>
</li>
<li class="listitem">
<code class="literal">join</code>: joins a list using the specified separator. Example: <code class="literal">[[join .body.arr ","]]</code>
</li>
<li class="listitem">
<code class="literal">mul</code>: multiplies two integers.
</li>
<li class="listitem">
<code class="literal">now</code>: returns the current <code class="literal">time.Time</code> object in UTC. Optionally, it can receive a <code class="literal">time.Duration</code> as a parameter. Example: <code class="literal">[[now (parseDuration "-1h")]]</code> returns the time at 1 hour before now.
</li>
<li class="listitem">
<code class="literal">parseDate</code>: parses a date string and returns a <code class="literal">time.Time</code> in UTC. By default the expected layout is <code class="literal">RFC3339</code> but optionally can accept any of the Golang predefined layouts or a custom one. Example: <code class="literal">[[ parseDate "2020-11-05T12:25:32Z" ]]</code>, <code class="literal">[[ parseDate "2020-11-05T12:25:32.1234567Z" "RFC3339Nano" ]]</code>, <code class="literal">[[ (parseDate "Thu Nov  5 12:25:32 +0000 2020" "Mon Jan _2 15:04:05 -0700 2006").UTC ]]</code>.
</li>
<li class="listitem">
<code class="literal">parseDuration</code>: parses duration strings and returns <code class="literal">time.Duration</code>. Example: <code class="literal">[[parseDuration "1h"]]</code>.
</li>
<li class="listitem">
<code class="literal">parseTimestampMilli</code>: parses a timestamp in milliseconds and returns a <code class="literal">time.Time</code> in UTC. Example: <code class="literal">[[parseTimestamp 1604582732000]]</code> returns <code class="literal">2020-11-05 13:25:32 +0000 UTC</code>.
</li>
<li class="listitem">
<code class="literal">parseTimestampNano</code>: parses a timestamp in nanoseconds and returns a <code class="literal">time.Time</code> in UTC. Example: <code class="literal">[[parseTimestamp 1604582732000000000]]</code> returns <code class="literal">2020-11-05 13:25:32 +0000 UTC</code>.
</li>
<li class="listitem">
<code class="literal">parseTimestamp</code>: parses a timestamp in seconds and returns a <code class="literal">time.Time</code> in UTC. Example: <code class="literal">[[parseTimestamp 1604582732]]</code> returns <code class="literal">2020-11-05 13:25:32 +0000 UTC</code>.
</li>
<li class="listitem">
<code class="literal">replaceAll(old, new, s)</code>: replaces all non-overlapping instances of <code class="literal">old</code> with <code class="literal">new</code> in <code class="literal">s</code>. Example: <code class="literal">[[ replaceAll "some" "my" "some value" ]]</code> returns <code class="literal">my value</code>.
</li>
<li class="listitem">
<code class="literal">sprintf</code>: formats according to a format specifier and returns the resulting string. Refer to <a href="https://pkg.go.dev/fmt#Sprintf" class="ulink" target="_top">the Go docs</a> for usage. Example: <code class="literal">[[sprintf "%d:%q" 34 "quote this"]]</code>
</li>
<li class="listitem">
<code class="literal">toInt</code>: converts a value of any type to an integer when possible. Returns 0 if the conversion fails.
</li>
<li class="listitem">
<code class="literal">toJSON</code>: converts a value to a JSON string. This can be used with <code class="literal">value_type: json</code> to create an object from a template. Example: <code class="literal">[[ toJSON .last_response.body.pagingIdentifiers ]]</code>.
</li>
<li class="listitem">
<code class="literal">urlEncode</code>: URL encodes the supplied string. Example <code class="literal">[[urlEncode "string1"]]</code>. Example <code class="literal">[[urlEncode "&lt;string1&gt;"]]</code> will return <code class="literal">%3Cstring1%3E</code>.
</li>
<li class="listitem">
<code class="literal">userAgent</code>: generates the User Agent with optional additional values. If no arguments are provided, it will generate the default User Agent that is added to all requests by default. It is recommended to delete the existing User-Agent header before setting a new one. Example: <code class="literal">[[ userAgent "integration/1.2.3" ]]</code> would generate <code class="literal">Elastic-Filebeat/8.1.0 (darwin; amd64; 9b893e88cfe109e64638d65c58fd75c2ff695402; 2021-12-15 13:20:00 +0000 UTC; integration_name/1.2.3)</code>
</li>
<li class="listitem">
<code class="literal">uuid</code>: returns a random UUID such as <code class="literal">a11e8780-e3e7-46d0-8e76-f66e75acf019</code>. Example: <code class="literal">[[ uuid ]]</code>
</li>
</ul>
</div>
<p>In addition to the provided functions, any of the native functions for <a href="https://golang.org/pkg/time/#Time" class="ulink" target="_top"><code class="literal">time.Time</code></a>, <a href="https://golang.org/pkg/net/http/#Header" class="ulink" target="_top"><code class="literal">http.Header</code></a>, and <a href="https://golang.org/pkg/net/url/#Values" class="ulink" target="_top"><code class="literal">url.Values</code></a> types can be used on the corresponding objects. Examples: <code class="literal">[[(now).Day]]</code>, <code class="literal">[[.last_response.header.Get "key"]]</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_configuration_options_8"></a>Configuration options<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h3>
</div></div></div>
<p>The <code class="literal">httpjson</code> input supports the following configuration options plus the
<a class="xref" href="filebeat-input-httpjson.html#filebeat-input-httpjson-common-options" title="Common options">Common options</a> described later.</p>
<h4><a id="_interval_2"></a><code class="literal">interval</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>Duration between repeated requests. It may make additional pagination requests in response to the initial request if pagination is enabled. Default: <code class="literal">60s</code>.</p>
<h4><a id="_auth_basic_enabled_2"></a><code class="literal">auth.basic.enabled</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>When set to <code class="literal">false</code>, disables the basic auth configuration. Default: <code class="literal">true</code>.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Basic auth settings are disabled if either <code class="literal">enabled</code> is set to <code class="literal">false</code> or
the <code class="literal">auth.basic</code> section is missing.</p>
</div>
</div>
<h4><a id="_auth_basic_user_2"></a><code class="literal">auth.basic.user</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>The user to authenticate with.</p>
<h4><a id="_auth_basic_password_2"></a><code class="literal">auth.basic.password</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>The password to use.</p>
<h4><a id="_auth_oauth2_enabled_2"></a><code class="literal">auth.oauth2.enabled</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>When set to <code class="literal">false</code>, disables the oauth2 configuration. Default: <code class="literal">true</code>.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>OAuth2 settings are disabled if either <code class="literal">enabled</code> is set to <code class="literal">false</code> or
the <code class="literal">auth.oauth2</code> section is missing.</p>
</div>
</div>
<h4><a id="_auth_oauth2_provider_2"></a><code class="literal">auth.oauth2.provider</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>Used to configure supported oauth2 providers.
Each supported provider will require specific settings. It is not set by default.
Supported providers are: <code class="literal">azure</code>, <code class="literal">google</code>.</p>
<h4><a id="_auth_oauth2_client_id_3"></a><code class="literal">auth.oauth2.client.id</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>The client ID used as part of the authentication flow. It is always required
except if using <code class="literal">google</code> as provider. Required for providers: <code class="literal">default</code>, <code class="literal">azure</code>.</p>
<h4><a id="_auth_oauth2_client_secret_3"></a><code class="literal">auth.oauth2.client.secret</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>The client secret used as part of the authentication flow. It is always required
except if using <code class="literal">google</code> as provider. Required for providers: <code class="literal">default</code>, <code class="literal">azure</code>.</p>
<h4><a id="_auth_oauth2_user_3"></a><code class="literal">auth.oauth2.user</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>The user used as part of the authentication flow. It is required for authentication
 - grant type password. It is only available for provider <code class="literal">default</code>.</p>
<h4><a id="_auth_oauth2_password_3"></a><code class="literal">auth.oauth2.password</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>The password used as part of the authentication flow. It is required for authentication
 - grant type password. It is only available for provider <code class="literal">default</code>.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>user and password are required for grant_type password. If user and
password is not used then it will automatically use the <code class="literal">token_url</code> and
<code class="literal">client credential</code> method.</p>
</div>
</div>
<h4><a id="_auth_oauth2_scopes_2"></a><code class="literal">auth.oauth2.scopes</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>A list of scopes that will be requested during the oauth2 flow.
It is optional for all providers.</p>
<h4><a id="_auth_oauth2_token_url_3"></a><code class="literal">auth.oauth2.token_url</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>The endpoint that will be used to generate the tokens during the oauth2 flow. It is required if no provider is specified.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>For <code class="literal">azure</code> provider either <code class="literal">token_url</code> or <code class="literal">azure.tenant_id</code> is required.</p>
</div>
</div>
<h4><a id="_auth_oauth2_endpoint_params_2"></a><code class="literal">auth.oauth2.endpoint_params</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>Set of values that will be sent on each request to the <code class="literal">token_url</code>. Each param key can have multiple values.
Can be set for all providers except <code class="literal">google</code>.</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">- type: httpjson
  auth.oauth2:
    endpoint_params:
      Param1:
        - ValueA
        - ValueB
      Param2:
        - Value</pre>
</div>
<h4><a id="_auth_oauth2_azure_tenant_id_2"></a><code class="literal">auth.oauth2.azure.tenant_id</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>Used for authentication when using <code class="literal">azure</code> provider.
Since it is used in the process to generate the <code class="literal">token_url</code>, it can&#8217;t be used in
combination with it. It is not required.</p>
<p>For information about where to find it, you can refer to
<a href="https://docs.microsoft.com/en-us/azure/active-directory/develop/howto-create-service-principal-portal" class="ulink" target="_top">https://docs.microsoft.com/en-us/azure/active-directory/develop/howto-create-service-principal-portal</a>.</p>
<h4><a id="_auth_oauth2_azure_resource_2"></a><code class="literal">auth.oauth2.azure.resource</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>The accessed WebAPI resource when using <code class="literal">azure</code> provider.
It is not required.</p>
<h4><a id="_auth_oauth2_google_credentials_file_2"></a><code class="literal">auth.oauth2.google.credentials_file</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>The credentials file for Google.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Only one of the credentials settings can be set at once. If none is provided, loading
default credentials from the environment will be attempted via ADC. For more information about
how to provide Google credentials, please refer to <a href="https://cloud.google.com/docs/authentication" class="ulink" target="_top">https://cloud.google.com/docs/authentication</a>.</p>
</div>
</div>
<h4><a id="_auth_oauth2_google_credentials_json_2"></a><code class="literal">auth.oauth2.google.credentials_json</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>Your credentials information as raw JSON.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Only one of the credentials settings can be set at once. If none is provided, loading
default credentials from the environment will be attempted via ADC. For more information about
how to provide Google credentials, please refer to <a href="https://cloud.google.com/docs/authentication" class="ulink" target="_top">https://cloud.google.com/docs/authentication</a>.</p>
</div>
</div>
<h4><a id="_auth_oauth2_google_jwt_file_2"></a><code class="literal">auth.oauth2.google.jwt_file</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>The JWT Account Key file for Google.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Only one of the credentials settings can be set at once. If none is provided, loading
default credentials from the environment will be attempted via ADC. For more information about
how to provide Google credentials, please refer to <a href="https://cloud.google.com/docs/authentication" class="ulink" target="_top">https://cloud.google.com/docs/authentication</a>.</p>
</div>
</div>
<h4><a id="_auth_oauth2_google_jwt_json_2"></a><code class="literal">auth.oauth2.google.jwt_json</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>The JWT Account Key file as raw JSON.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Only one of the credentials settings can be set at once. If none is provided, loading
default credentials from the environment will be attempted via ADC. For more information about
how to provide Google credentials, please refer to <a href="https://cloud.google.com/docs/authentication" class="ulink" target="_top">https://cloud.google.com/docs/authentication</a>.</p>
</div>
</div>
<h4><a id="_auth_oauth2_google_delegated_account_2"></a><code class="literal">auth.oauth2.google.delegated_account</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>Email of the delegated account used to create the credentials (usually an admin). Used in combination
with <code class="literal">auth.oauth2.google.jwt_file</code> or <code class="literal">auth.oauth2.google.jwt_json</code>.</p>
<h4><a id="request-parameters"></a><code class="literal">request.url</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>The URL of the HTTP API. Required.</p>
<h4><a id="_request_method"></a><code class="literal">request.method</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>HTTP method to use when making requests. <code class="literal">GET</code> or <code class="literal">POST</code> are the options. Default: <code class="literal">GET</code>.</p>
<h4><a id="_request_encode_as"></a><code class="literal">request.encode_as</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>ContentType used for encoding the request body. If set it will force the encoding in the specified format regardless of the <code class="literal">Content-Type</code> header value, otherwise it will honor it if possible or fallback to <code class="literal">application/json</code>. By default the requests are sent with <code class="literal">Content-Type: application/json</code>. Supported values: <code class="literal">application/json</code> and <code class="literal">application/x-www-form-urlencoded</code>. <code class="literal">application/x-www-form-urlencoded</code> will url encode the <code class="literal">url.params</code> and set them as the body. It is not set by default.</p>
<h4><a id="_request_body"></a><code class="literal">request.body</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>An optional HTTP POST body. The configuration value must be an object, and it
will be encoded to JSON. This is only valid when <code class="literal">request.method</code> is <code class="literal">POST</code>.
Defaults to <code class="literal">null</code> (no HTTP body).</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">- type: httpjson
  request.method: POST
  request.body:
    query:
      bool:
        filter:
          term:
            type: authentication</pre>
</div>
<h4><a id="_request_timeout"></a><code class="literal">request.timeout</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>Duration before declaring that the HTTP client connection has timed out. Valid time units are <code class="literal">ns</code>, <code class="literal">us</code>, <code class="literal">ms</code>, <code class="literal">s</code>, <code class="literal">m</code>, <code class="literal">h</code>. Default: <code class="literal">30s</code>.</p>
<h4><a id="_request_ssl"></a><code class="literal">request.ssl</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>This specifies SSL/TLS configuration. If the ssl section is missing, the host&#8217;s
CAs are used for HTTPS connections. See <a class="xref" href="configuration-ssl.html" title="Configure SSL"><em>SSL</em></a> for more
information.</p>
<h4><a id="_request_proxy_url"></a><code class="literal">request.proxy_url</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>This specifies proxy configuration in the form of <code class="literal">http[s]://&lt;user&gt;:&lt;password&gt;@&lt;server name/ip&gt;:&lt;port&gt;</code></p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
# Fetch your public IP every minute.
- type: httpjson
  interval: 1m
  request.url: https://api.ipify.org/?format=json
  request.proxy_url: http://proxy.example:8080</pre>
</div>
<h4><a id="_request_retry_max_attempts"></a><code class="literal">request.retry.max_attempts</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>The maximum number of retries for the HTTP client. Default: <code class="literal">5</code>.</p>
<h4><a id="_request_retry_wait_min"></a><code class="literal">request.retry.wait_min</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>The minimum time to wait before a retry is attempted. Default: <code class="literal">1s</code>.</p>
<h4><a id="_request_retry_wait_max"></a><code class="literal">request.retry.wait_max</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>The maximum time to wait before a retry is attempted. Default: <code class="literal">60s</code>.</p>
<h4><a id="_request_redirect_forward_headers"></a><code class="literal">request.redirect.forward_headers</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>When set to <code class="literal">true</code> request headers are forwarded in case of a redirect. Default: <code class="literal">false</code>.</p>
<h4><a id="_request_redirect_headers_ban_list"></a><code class="literal">request.redirect.headers_ban_list</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>When <code class="literal">redirect.forward_headers</code> is set to <code class="literal">true</code>, all headers <em>except</em> the ones defined in this list will be forwarded. Default: <code class="literal">[]</code>.</p>
<h4><a id="_request_redirect_max_redirects"></a><code class="literal">request.redirect.max_redirects</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>The maximum number of redirects to follow for a request. Default: <code class="literal">10</code>.</p>
<h4><a id="request-rate-limit"></a><code class="literal">request.rate_limit.limit</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>The value of the response that specifies the total limit. It is defined with a Go template value.
Can read state from: [<code class="literal">.last_response.header</code>]</p>
<h4><a id="_request_rate_limit_remaining"></a><code class="literal">request.rate_limit.remaining</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>The value of the response that specifies the remaining quota of the rate limit.
It is defined with a Go template value. Can read state from: [<code class="literal">.last_response.header</code>]
If the <code class="literal">remaining</code> header is missing from the Response, no rate-limiting will occur.</p>
<h4><a id="_request_rate_limit_reset"></a><code class="literal">request.rate_limit.reset</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>The value of the response that specifies the epoch time when the rate limit will reset.
It is defined with a Go template value. Can read state from: [<code class="literal">.last_response.header</code>]</p>
<h4><a id="request-transforms-headers"></a><code class="literal">request.rate_limit.early_limit</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>Optionally start rate-limiting prior to the value specified in the Response.</p>
<p>Under the default behavior, Requests will continue while the <code class="literal">remaining</code> value is non-zero.
Specifying an <code class="literal">early_limit</code> will mean that rate-limiting will occur prior to reaching <code class="literal">0</code>.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If the value specified for <code class="literal">early_limit</code> is less than <code class="literal">1</code>,
the value is treated as a percentage of the Response provided <code class="literal">limit</code>.
e.g. specifying <code class="literal">0.9</code> will mean that Requests will continue until reaching 90% of the rate-limit&#8201;&#8212;&#8201;for a <code class="literal">limit</code> value of <code class="literal">120</code>, the rate-limit starts when the <code class="literal">remaining</code> reaches <code class="literal">12</code>.
If the <code class="literal">limit</code> header is missing from the Response, default rate-limiting will occur (when <code class="literal">remaining</code> reaches <code class="literal">0</code>).
</li>
<li class="listitem">
If the value specified for <code class="literal">early_limit</code> is greater than or equal to <code class="literal">1</code>,
the value is treated as the target value for <code class="literal">remaining</code>.
e.g. instead of rate-limiting when <code class="literal">remaining</code> hits <code class="literal">0</code>, rate-limiting will occur when <code class="literal">remaining</code> hits the value specified.
</li>
</ul>
</div>
<p>It is not set by default (by default the rate-limiting as specified in the Response is followed).</p>
<h4><a id="request-transforms"></a><code class="literal">request.transforms</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>List of transforms to apply to the request before each execution.</p>
<p>Available transforms for request: [<code class="literal">append</code>, <code class="literal">delete</code>, <code class="literal">set</code>].</p>
<p>Can read state from: [<code class="literal">.first_response.*</code>,<code class="literal">.last_response.*</code>, <code class="literal">.parent_last_response.*</code> <code class="literal">.last_event.*</code>, <code class="literal">.cursor.*</code>, <code class="literal">.header.*</code>, <code class="literal">.url.*</code>, <code class="literal">.body.*</code>].</p>
<p>Can write state to: [<code class="literal">body.*</code>, <code class="literal">header.*</code>, <code class="literal">url.*</code>].</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: httpjson
  request.url: http://localhost:9200/_search?scroll=5m
  request.method: POST
  request.transforms:
    - set:
        target: body.from
        value: '[[now (parseDuration "-1h")]]'</pre>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The clause <code class="literal">.parent_last_response.</code> should only be used from within chain steps and when pagination exists at the root request level. If pagination
does not exist at the root level, please use the clause <code class="literal">.first_response.</code> to access parent response object from within chains. You can look at this
<span class="strong strong"><strong>example</strong></span> below for a better idea.</p>
</div>
</div>
<p><span class="strong strong"><strong>Example Config:</strong></span></p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">  filebeat.inputs:
  - type: httpjson
    enabled: true
    id: my-httpjson-id
    request.url: http://xyz.com/services/data/v1.0/export_ids/page
    request.method: POST
    interval: 1h
    request.retry.max_attempts: 2
    request.retry.wait_min: 5s
    request.transforms:
    - set:
        target: body.page
        value: 0
    response.request_body_on_pagination: true
    response.pagination:
      - set:
          target: body.page
          value: '[[ .last_response.body.page ]]'
          fail_on_template_error: true
    chain:
    - step:
          request.url: http://xyz.com/services/data/v1.0/$.exportId/export_ids/$.files[:].id/info
          request.method: POST
          request.transforms:
          - set:
              target: body.exportId
              value: '[[ .parent_last_response.body.exportId ]]'
          replace: $.files[:].id
          replace_with: '$.exportId,.parent_last_response.body.exportId'</pre>
</div>
<p>Here we can see that the chain step uses <code class="literal">.parent_last_response.body.exportId</code> only because <code class="literal">response.pagination</code> is present for the parent (root) request.
However if <code class="literal">response.pagination</code> was not present in the parent (root) request, <code class="literal">replace_with</code> clause should have used <code class="literal">.first_response.body.exportId</code>. This is
because when pagination does not exist at the parent level <code class="literal">parent_last_response</code> object is not populated with required values for performance reasons, but the
<code class="literal">first_response</code> object always stores the very first response in the process chain.</p>
<h4><a id="_request_tracer_filename"></a><code class="literal">request.tracer.filename</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>It is possible to log httpjson requests and responses to a local file-system for debugging configurations.
This option is enabled by setting the <code class="literal">request.tracer.filename</code> value. Additional options are available to
tune log rotation behavior.</p>
<p>Enabling this option compromises security and should only be used for debugging.</p>
<h4><a id="_request_tracer_maxsize"></a><code class="literal">request.tracer.maxsize</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>This value sets the maximum size, in megabytes, the log file will reach before it is rotated. By default
logs are allowed to reach 1MB before rotation.</p>
<h4><a id="_request_tracer_maxage"></a><code class="literal">request.tracer.maxage</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>This specifies the number days to retain rotated log files. If it is not set, log files are retained
indefinitely.</p>
<h4><a id="_request_tracer_maxbackups"></a><code class="literal">request.tracer.maxbackups</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>The number of old logs to retain. If it is not set all old logs are retained subject to the <code class="literal">request.tracer.maxage</code>
setting.</p>
<h4><a id="_request_tracer_localtime"></a><code class="literal">request.tracer.localtime</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>Whether to use the host&#8217;s local time rather that UTC for timestamping rotated log file names.</p>
<h4><a id="_request_tracer_compress"></a><code class="literal">request.tracer.compress</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>This determines whether rotated logs should be gzip compressed.</p>
<h4><a id="_response_decode_as"></a><code class="literal">response.decode_as</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>ContentType used for decoding the response body. If set it will force the decoding in the specified format regardless of the <code class="literal">Content-Type</code> header value, otherwise it will honor it if possible or fallback to <code class="literal">application/json</code>. Supported values: <code class="literal">application/json, application/x-ndjson</code>, <code class="literal">text/csv</code>, <code class="literal">application/zip</code>. It is not set by default.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>For <code class="literal">text/csv</code>, one event for each line will be created, using the header values as the object keys. For this reason is always assumed that a header exists.</p>
</div>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>For <code class="literal">application/zip</code>, the <code class="literal">zip</code> file is expected to contain one or more <code class="literal">.json</code> or <code class="literal">.ndjson</code> files. The contents of all of them will be merged into a single list of <code class="literal">JSON</code> objects.</p>
</div>
</div>
<h4><a id="response-transforms"></a><code class="literal">response.transforms</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>List of transforms to apply to the response once it is received.</p>
<p>Available transforms for response: [<code class="literal">append</code>, <code class="literal">delete</code>, <code class="literal">set</code>].</p>
<p>Can read state from: [<code class="literal">.last_response.*</code>, <code class="literal">.last_event.*</code>, <code class="literal">.cursor.*</code>, <code class="literal">.header.*</code>, <code class="literal">.url.*</code>].</p>
<p>Can write state to: [<code class="literal">body.*</code>].</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: httpjson
  request.url: http://localhost:9200/_search?scroll=5m
  request.method: POST
  response.transforms:
    - delete:
        target: body.very_confidential
  response.split:
    target: body.hits.hits
  response.pagination:
    - set:
        target: url.value
        value: http://localhost:9200/_search/scroll
    - set:
        target: url.params.scroll_id
        value: '[[.last_response.body._scroll_id]]'
    - set:
        target: body.scroll
        value: 5m</pre>
</div>
<h4><a id="response-split"></a><code class="literal">response.split</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>Split operation to apply to the response once it is received. A split can convert a map, array, or string into multiple events.
If the split target is empty the parent document will be kept. If documents with empty splits should be dropped, the <code class="literal">ignore_empty_value</code> option should be set to <code class="literal">true</code>.</p>
<h4><a id="_response_split_target"></a><code class="literal">response.split[].target</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>Defines the target field upon the split operation will be performed.</p>
<h4><a id="_response_split_type"></a><code class="literal">response.split[].type</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>Defines the field type of the target. Allowed values: <code class="literal">array</code>, <code class="literal">map</code>, <code class="literal">string</code>. <code class="literal">string</code> requires the use of the <code class="literal">delimiter</code> options to specify what characters to split the string on.  <code class="literal">delimiter</code> always behaves as if <code class="literal">keep_parent</code> is set to <code class="literal">true</code>. Default: <code class="literal">array</code>.</p>
<h4><a id="_response_split_transforms"></a><code class="literal">response.split[].transforms</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>A set of transforms can be defined. This list will be applied after <a class="xref" href="filebeat-input-httpjson.html#response-transforms" title="response.transforms">response.transforms</a> and after the object has been modified based on <code class="literal">response.split[].keep_parent</code> and <code class="literal">response.split[].key_field</code>.</p>
<p>Available transforms for response: [<code class="literal">append</code>, <code class="literal">delete</code>, <code class="literal">set</code>].</p>
<p>Can read state from: [<code class="literal">.last_response.*</code>, <code class="literal">.first_event.*</code>, <code class="literal">.last_event.*</code>, <code class="literal">.cursor.*</code>, <code class="literal">.header.*</code>, <code class="literal">.url.*</code>].</p>
<p>Can write state to: [<code class="literal">body.*</code>].</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>in this context, <code class="literal">body.*</code> will be the result of all the previous transformations.</p>
</div>
</div>
<h4><a id="_response_split_keep_parent"></a><code class="literal">response.split[].keep_parent</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>If set to true, the fields from the parent document (at the same level as <code class="literal">target</code>) will be kept. Otherwise a new document will be created using <code class="literal">target</code> as the root. Default: <code class="literal">false</code>.</p>
<h4><a id="_response_split_delimiter"></a><code class="literal">response.split[].delimiter</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>Required if using split type of <code class="literal">string</code>.  This is the sub string used to split the string.  For example if <code class="literal">delimiter</code> was "\n" and the string was "line 1\nline 2", then the split would result in "line 1" and "line 2".</p>
<h4><a id="_response_split_key_field"></a><code class="literal">response.split[].key_field</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>Valid when used with <code class="literal">type: map</code>. When not empty, defines a new field where the original key value will be stored.</p>
<h4><a id="_response_split_ignore_empty_value"></a><code class="literal">response.split[].ignore_empty_value</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>If set to true, empty or missing value will be ignored and processing will pass on to the next nested split operation instead of failing with an error. Default: <code class="literal">false</code>.</p>
<h4><a id="_response_split_split"></a><code class="literal">response.split[].split</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>Nested split operation. Split operations can be nested at will. An event won&#8217;t be created until the deepest split operation is applied.</p>
<h4><a id="_response_request_body_on_pagination"></a><code class="literal">response.request_body_on_pagination</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>If set to true, the values in <code class="literal">request.body</code> are sent for pagination requests. Default: <code class="literal">false</code>.</p>
<h4><a id="response-pagination"></a><code class="literal">response.pagination</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>List of transforms that will be applied to the response to every new page request. All the transforms from <code class="literal">request.transform</code> will be executed and then <code class="literal">response.pagination</code> will be added to modify the next request as needed. For subsequent responses, the usual <a class="xref" href="filebeat-input-httpjson.html#response-transforms" title="response.transforms">response.transforms</a> and <a class="xref" href="filebeat-input-httpjson.html#response-split" title="response.split">response.split</a> will be executed normally.</p>
<p>Available transforms for pagination: [<code class="literal">append</code>, <code class="literal">delete</code>, <code class="literal">set</code>].</p>
<p>Can read state from: [<code class="literal">.last_response.*</code>, <code class="literal">.first_event.*</code>, <code class="literal">.last_event.*</code>, <code class="literal">.cursor.*</code>, <code class="literal">.header.*</code>, <code class="literal">.url.*</code>, <code class="literal">.body.*</code>].</p>
<p>Can write state to: [<code class="literal">body.*</code>, <code class="literal">header.*</code>, <code class="literal">url.*</code>].</p>
<p>Examples using split:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>We have a response with two nested arrays, and we want a document for each of the elements of the inner array:</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
  "this": "is kept",
  "alerts": [
    {
      "this_is": "also kept",
      "entities": [
        {
          "something": "something"
        },
        {
          "else": "else"
        }
      ]
    },
    {
      "this_is": "also kept 2",
      "entities": [
        {
          "something": "something 2"
        },
        {
          "else": "else 2"
        }
      ]
    }
  ]
}</pre>
</div>
<p>The config will look like:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: httpjson
  interval: 1m
  request.url: https://example.com
  response.split:
    target: body.alerts
    type: array
    keep_parent: true
    split:
      # paths in nested splits need to represent the state of body, not only their current level of nesting
      target: body.alerts.entities
      type: array
      keep_parent: true</pre>
</div>
<p>This will output:</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">[
  {
    "this": "is kept",
    "alerts": {
      "this_is": "also kept",
      "entities": {
        "something": "something"
      }
    }
  },
  {
    "this": "is kept",
    "alerts": {
      "this_is": "also kept",
      "entities": {
        "else": "else"
      }
    }
  },
  {
    "this": "is kept",
    "alerts": {
      "this_is": "also kept 2",
      "entities": {
        "something": "something 2"
      }
    }
  },
  {
    "this": "is kept",
    "alerts": {
      "this_is": "also kept 2",
      "entities": {
        "else": "else 2"
      }
    }
  }
]</pre>
</div>
</li>
<li class="listitem">
<p>We have a response with an array with two objects, and we want a document for each of the object keys while keeping the keys values:</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
  "this": "is not kept",
  "alerts": [
    {
      "this_is": "kept",
      "entities": {
        "id1": {
          "something": "something"
        }
      }
    },
    {
      "this_is": "kept 2",
      "entities": {
        "id2": {
          "something": "something 2"
        }
      }
    }
  ]
}</pre>
</div>
<p>The config will look like:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: httpjson
  interval: 1m
  request.url: https://example.com
  response.split:
    target: body.alerts
    type: array
    keep_parent: false
    split:
      # this time alerts will not exist because previous keep_parent is false
      target: body.entities
      type: map
      keep_parent: true
      key_field: id</pre>
</div>
<p>This will output:</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">[
  {
    "this_is": "kept",
    "entities": {
      "id": "id1",
      "something": "something"
    }
  },
  {
    "this_is": "kept 2",
    "entities": {
      "id": "id2",
      "something": "something 2"
    }
  }
]</pre>
</div>
</li>
<li class="listitem">
<p>We have a response with an array with two objects, and we want a document for each of the object keys while applying a transform to each:</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
  "this": "is not kept",
  "alerts": [
    {
      "this_is": "also not kept",
      "entities": {
        "id1": {
          "something": "something"
        }
      }
    },
    {
      "this_is": "also not kept",
      "entities": {
        "id2": {
          "something": "something 2"
        }
      }
    }
  ]
}</pre>
</div>
<p>The config will look like:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: httpjson
  interval: 1m
  request.url: https://example.com
  response.split:
    target: body.alerts
    type: array
    split:
      transforms:
        - set:
            target: body.new
            value: will be added to each
      target: body.entities
      type: map</pre>
</div>
<p>This will output:</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">[
  {
    "something": "something",
    "new": "will be added for each"
  },
  {
    "something": "something 2",
    "new": "will be added for each"
  }
]</pre>
</div>
</li>
<li class="listitem">
<p>We have a response with a keys whose value is a string.  We want the string to be split on a delimiter and a document for each sub strings.</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
  "this": "is kept",
  "lines": "Line 1\nLine 2\nLine 3"
}</pre>
</div>
<p>The config will look like:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: httpjson
  interval: 1m
  request.url: https://example.com
  response.split:
    target: body.lines
    type: string
    delimiter: "\n"</pre>
</div>
<p>This will output:</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">[
  {
    "this": "is kept",
    "lines": "Line 1"
  },
  {
    "this": "is kept",
    "lines": "Line 2"
  },
  {
    "this": "is kept",
    "lines": "Line 3"
  }
]</pre>
</div>
</li>
</ul>
</div>
<h3><a id="chain"></a><code class="literal">chain</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h3>
<p>A chain is a list of requests to be made after the first one.</p>
<h4><a id="_chain_step"></a><code class="literal">chain[].step</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>Contains basic request and response configuration for chained calls.</p>
<h4><a id="_chain_step_request"></a><code class="literal">chain[].step.request</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>See <a class="xref" href="filebeat-input-httpjson.html#request-parameters" title="request.url">request parameters</a>. Required.</p>
<p>Example:</p>
<p>First call: https://example.com/services/data/v1.0/</p>
<p>Second call: https://example.com/services/data/v1.0/1/export_ids</p>
<p>Third call: https://example.com/services/data/v1.0/export_ids/file_1/info</p>
<h4><a id="_chain_step_response_split"></a><code class="literal">chain[].step.response.split</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>See <a class="xref" href="filebeat-input-httpjson.html#response-split" title="response.split">response split parameter</a>.</p>
<p>+</p>
<h4><a id="chain-step-replace"></a><code class="literal">chain[].step.replace</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>A <a href="https://goessner.net/articles/JsonPath/index.html#e2" class="ulink" target="_top">JSONPath</a> string to parse values from responses JSON, collected from previous chain steps. Place same replace string in url where collected values from previous call should be placed. Required.</p>
<p>Example:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>First call: https://example.com/services/data/v1.0/</p>
<p><a class="xref" href="filebeat-input-httpjson.html#response-json1">response</a></p>
</li>
<li class="listitem">
<p>Second call: https://example.com/services/data/v1.0/<code class="literal">$.records[:].id</code>/export_ids</p>
<p><a class="xref" href="filebeat-input-httpjson.html#response-json2">response</a></p>
</li>
<li class="listitem">
Third call: https://example.com/services/data/v1.0/export_ids/<code class="literal">$.file_name</code>/info
</li>
</ul>
</div>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: httpjson
  enabled: true
  # first call
  request.url: https://example.com/services/data/v1.0/records
  interval: 1h
  chain:
    # second call
    - step:
      request.url: https://example.com/services/data/v1.0/$.records[:].id/export_ids
      request.method: GET
      replace: $.records[:].id
    # third call
    - step:
      request.url: https://example.com/services/data/v1.0/export_ids/$.file_name/info
      request.method: GET
      replace: $.file_name</pre>
</div>
<p>Example:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>First call to collect record ids</p>
<p>request_url: https://example.com/services/data/v1.0/records</p>
<p>response_json:</p>
<a id="response-json1"></a><div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
    "records": [
        {
            "id": 1,
        },
        {
            "id": 2,
        },
        {
            "id": 3,
        },
    ]
}</pre>
</div>
</li>
<li class="listitem">
<p>Second call to collect <code class="literal">file_name</code> using collected ids from first call.</p>
<p>request_url using id as <em>1</em>: https://example.com/services/data/v1.0/1/export_ids</p>
<p>response_json using id as <em>1</em>:</p>
<a id="response-json2"></a><div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
    "file_name": "file_1"
}</pre>
</div>
<p>request_url using id as <em>2</em>: https://example.com/services/data/v1.0/2/export_ids</p>
<p>response_json using id as <em>2</em>:</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
    "file_name": "file_2"
}</pre>
</div>
</li>
<li class="listitem">
<p>Third call to collect <code class="literal">files</code> using collected <code class="literal">file_name</code> from second call.</p>
<p>request_url using file_name as <em>file_1</em>: https://example.com/services/data/v1.0/export_ids/file_1/info</p>
<p>request_url using file_name as <em>file_2</em>: https://example.com/services/data/v1.0/export_ids/file_2/info</p>
<p>Collect and make events from response in any format supported by httpjson for all calls.</p>
<h4><a id="chain-step-replace_with"></a><code class="literal">chain[].step.replace_with</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
</li>
</ul>
</div>
<p>The <code class="literal">replace_with: "pattern,value"</code> clause is used to replace a fixed pattern string defined in <code class="literal">request.url</code> with the given value.
The fixed pattern must have a <code class="literal">$.</code> prefix, for example: <code class="literal">$.xyz</code>. The <code class="literal">value</code> may be hard coded or extracted from context variables
like [<code class="literal">.last_response.*</code>, <code class="literal">.first_response.*</code>, <code class="literal">.parent_last_response.*</code>] etc. The <code class="literal">replace_with</code> clause can be used in combination with the <code class="literal">replace</code> clause
thus providing a lot of flexibility in the logic of chain requests.</p>
<p>Example:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>First call: https://example.com/services/data/v1.0/exports</p>
<p><a class="xref" href="filebeat-input-httpjson.html#response-json1-replace_with">response</a></p>
</li>
<li class="listitem">
<p>Second call: https://example.com/services/data/v1.0/$.exportId/files</p>
<p><a class="xref" href="filebeat-input-httpjson.html#response-json2-replace_with">response</a></p>
</li>
</ul>
</div>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: httpjson
  enabled: true
  # first call
  request.url: https://example.com/services/data/v1.0/exports
  interval: 1h
  chain:
    # second call
    - step:
      request.url: https://example.com/services/data/v1.0/$.exportId/files
      request.method: GET
      replace_with: '$.exportId,.first_response.body.exportId'</pre>
</div>
<p>Example:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>First call to fetch exportId</p>
<p>request_url: https://example.com/services/data/v1.0/exports</p>
<p>response_json:</p>
<a id="response-json1-replace_with"></a><div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
    "exportId" : "2212"
}</pre>
</div>
</li>
<li class="listitem">
<p>Second call to fetch <code class="literal">file ids</code> using exportId from first call.</p>
<p>request_url using exportId as <em>2212</em>: https://example.com/services/data/v1.0/2212/files</p>
<p>response_json using exportId as <em>2212</em>:</p>
<a id="response-json2-replace_with"></a><div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
    "files": [
        {
            "id": 1,
        },
        {
            "id": 2,
        },
        {
            "id": 3,
        },
    ]
}</pre>
</div>
<p>This behaviour of targeted fixed pattern replacement in the url helps solve various use cases.</p>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Some useful points to remember:- </strong></span></p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
If you want the <code class="literal">value</code> to be treated as an expression to be evaluated for data extraction from context variables, it should always have a
<span class="strong strong"><strong>single <em>.</em> (dot) prefix</strong></span>. Example: <code class="literal">replace_with: '$.exportId,.first_response.body.exportId'</code>. Anything more or less will have the internal
processor treat it as a hard coded value, <code class="literal">replace_with: '$.exportId,..first_response.body.exportId'</code> (more than one <em>.</em> (dot) as prefix) or
<code class="literal">replace_with:'$.exportId,first_response.body.exportId'</code> (no <em>.</em> dot as prefix)
</li>
<li class="listitem">
Incomplete <code class="literal">value expressions</code> will cause an error while processing. Example: <code class="literal">replace_with: '$.exportId,.first_response.'</code>, <code class="literal">replace_with:
'$.exportId,.last_response.'</code> etc. These expressions are incomplete because they do not evaluate down to a valid key that can be extracted from
the context variables. The value expression: <code class="literal">.first_response.</code>, on processing, will result in an array <code class="literal">[first_response ""]</code> where the key to be
extrated becomes <code class="literal">"" (an empty string)</code>, which has no definition within any context variable.
</li>
</ol>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Fixed patterns must not contain commas in their definition. String replacement patterns are matched by the <code class="literal">replace_with</code> processor with exact string matching.</p>
</div>
</div>
<h4><a id="_chain_while"></a><code class="literal">chain[].while</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>Contains basic request and response configuration for chained while calls. Chained while calls will keep making the requests for a given number of times until a condition is met
or the maximum number of attempts gets exhausted. While chain has an attribute <code class="literal">until</code> which holds the expression to be evaluated. Ideally the <code class="literal">until</code> field should always be used
together with the attributes <code class="literal">request.retry.max_attempts</code> and <code class="literal">request.retry.wait_min</code> which specifies the maximum number of attempts to evaluate <code class="literal">until</code> before giving up and the
maximum wait time in between such requests. If <code class="literal">request.retry.max_attempts</code> is not specified, it will only try to evaluate the expression once and give up if it fails. If
<code class="literal">request.retry.wait_min</code> is not specified the default wait time will always be <code class="literal">0</code> as in successive calls will be made immediately.</p>
<h4><a id="_chain_while_request"></a><code class="literal">chain[].while.request</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>See  <a class="xref" href="filebeat-input-httpjson.html#request-parameters" title="request.url">request parameters</a> .</p>
<p>Example:</p>
<p>First call: http://example.com/services/data/v1.0/exports</p>
<p>Second call: http://example.com/services/data/v1.0/9ef0e6a5/export_ids/status</p>
<p>Third call: http://example.com/services/data/v1.0/export_ids/1/info</p>
<h4><a id="_chain_while_response_split"></a><code class="literal">chain[].while.response.split</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>See  <a class="xref" href="filebeat-input-httpjson.html#response-split" title="response.split">response split parameter</a> .</p>
<h4><a id="_chain_while_replace"></a><code class="literal">chain[].while.replace</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>See  <a class="xref" href="filebeat-input-httpjson.html#chain-step-replace" title="chain[].step.replace">chain[].step.replace</a> .</p>
<p>Example:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>First call: http://example.com/services/data/v1.0/exports</p>
<p><a class="xref" href="filebeat-input-httpjson.html#response-json1-while">response</a></p>
</li>
<li class="listitem">
<p>Second call: http://example.com/services/data/v1.0/<code class="literal">$.exportId</code>/export_ids/status</p>
<p><a class="xref" href="filebeat-input-httpjson.html#response-json2-while">response</a></p>
</li>
<li class="listitem">
<p>Third call: http://example.com/services/data/v1.0/export_ids/<code class="literal">$.files[:].id</code>/info</p>
<p><a class="xref" href="filebeat-input-httpjson.html#response-json3-while">response 1</a>, <a class="xref" href="filebeat-input-httpjson.html#response-json4-while">response 2</a></p>
</li>
</ul>
</div>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: httpjson
  enabled: true
  # first call
  id: my-httpjson-id
  request.url: http://example.com/services/data/v1.0/exports
  interval: 1h
  chain:
    # second call
    - while:
        request.url: http://example.com/services/data/v1.0/$.exportId/export_ids/status
        request.method: GET
        replace: $.exportId
        until: '[[ eq .last_response.body.status "completed" ]]'
        request.retry.max_attempts: 5
        request.retry.wait_min: 5s
    # third call
    - step:
        request.url: http://example.com/services/data/v1.0/export_ids/$.files[:].id/info
        request.method: GET
        replace: $.files[:].id</pre>
</div>
<p>Example:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>First call to collect export ids</p>
<p>request_url: https://example.com/services/data/v1.0/exports</p>
<p>response_json:</p>
<a id="response-json1-while"></a><div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
    "exportId": "9ef0e6a5"
}</pre>
</div>
</li>
<li class="listitem">
<p>Second call to collect <code class="literal">file_ids</code> using collected id from first call when <code class="literal">response.body.sataus == "completed"</code>. This call continues until the condition is satisfied or the maximum number of attempts gets exhausted.</p>
<p>request_url using id as <em>9ef0e6a5</em>: https://example.com/services/data/v1.0/9ef0e6a5/export_ids/status</p>
<p>response_json using id as <em>9ef0e6a5</em>:</p>
<a id="response-json2-while"></a><div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
    "status": "completed",
    "files": [
      {
        "id": 1
      },
      {
        "id": 2
      },
      {
        "id": 3
      }
    ]
}</pre>
</div>
</li>
<li class="listitem">
<p>Third call to collect <code class="literal">files</code> using collected <code class="literal">file_id</code> from second call.</p>
<p>request_url using file_id as <em>1</em>: https://example.com/services/data/v1.0/export_ids/1/info</p>
<p>request_url using file_id as <em>2</em>: https://example.com/services/data/v1.0/export_ids/2/info</p>
<p>response_json using id as <em>1</em>:</p>
<a id="response-json3-while"></a><div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
    "file_name": "file_1",
    "file_data": "some data"
}</pre>
</div>
<p>response_json using id as <em>2</em>:</p>
<a id="response-json4-while"></a><div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
    "file_name": "file_2",
    "file_data": "some data"
}</pre>
</div>
<p>Collect and make events from response in any format supported by httpjson for all calls.</p>
</li>
</ul>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>httpjson chain will only create and ingest events from last call on chained configurations. Also, the current chain only supports the following: all <a class="xref" href="filebeat-input-httpjson.html#request-parameters" title="request.url">request parameters</a>, <a class="xref" href="filebeat-input-httpjson.html#response-transforms" title="response.transforms">response.transforms</a> and <a class="xref" href="filebeat-input-httpjson.html#response-split" title="response.split">response.split</a>.</p>
</div>
</div>
<h4><a id="_chain_while_replace_with"></a><code class="literal">chain[].while.replace_with</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>See  <a class="xref" href="filebeat-input-httpjson.html#chain-step-replace_with" title="chain[].step.replace_with">chain[].step.replace_with</a> .</p>
<h4><a id="cursor"></a><code class="literal">cursor</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>Cursor is a list of key value objects where arbitrary values are defined. The values are interpreted as  <a class="xref" href="filebeat-input-httpjson.html#value-templates" title="Value templates">value templates</a> and a default template can be set. Cursor state is kept between input restarts and updated once all the events for a request are published.</p>
<p>Each cursor entry is formed by:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
A <code class="literal">value</code> template, which will define the value to store when evaluated.
</li>
<li class="listitem">
A <code class="literal">default</code> template, which will define the value to store when the value template fails or is empty.
</li>
<li class="listitem">
An <code class="literal">ignore_empty_value</code> flag. When set to <code class="literal">true</code>, will not store empty values, preserving the previous one, if any. Default: <code class="literal">true</code>.
</li>
</ul>
</div>
<p>Can read state from: [<code class="literal">.last_response.*</code>, <code class="literal">.first_event.*</code>, <code class="literal">.last_event.*</code>].</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Default templates do not have access to any state, only to functions.</p>
</div>
</div>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: httpjson
  interval: 1m
  request.url: https://api.ipify.org/?format=json
  response.transforms:
    - set:
        target: body.last_requested_at
        value: '[[.cursor.last_requested_at]]'
        default: "[[now]]"
  cursor:
    last_requested_at:
      value: '[[now]]'
  processors:
    - decode_json_fields:
        fields: ["message"]
        target: "json"</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_request_life_cycle"></a>Request life cycle<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h3>
</div></div></div>
<p><span class="image"><img src="images/input-httpjson-lifecycle.png" alt="Request lifecycle"></span></p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
At every defined interval a new request is created.
</li>
<li class="listitem">
The request is transformed using the configured <a class="xref" href="filebeat-input-httpjson.html#request-transforms" title="request.transforms">request.transforms</a>.
</li>
<li class="listitem">
The resulting transformed request is executed.
</li>
<li class="listitem">
The server responds (here is where any retry or rate limit policy takes place when configured).
</li>
<li class="listitem">
The response is transformed using the configured <a class="xref" href="filebeat-input-httpjson.html#response-transforms" title="response.transforms">response.transforms</a> and <a class="xref" href="filebeat-input-httpjson.html#response-split" title="response.split">response.split</a>.
</li>
<li class="listitem">
If a chain step is configured. Each step will generate new requests based on collected IDs from responses. The requests will be transformed using configured <a class="xref" href="filebeat-input-httpjson.html#request-transforms" title="request.transforms">request.transforms</a> and the resulting generated transformed requests will be executed. This process will happen for all the steps mentioned in the chain.
</li>
<li class="listitem">
Each resulting event is published to the output.
</li>
<li class="listitem">
If a <code class="literal">response.pagination</code> is configured and there are more pages, a new request is created using it, otherwise the process ends until the next interval.
</li>
</ol>
</div>
<p><span class="image"><img src="images/input-httpjson-chain-lifecycle.png" alt="Chain Request lifecycle"></span></p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Response from regular call will be processed.
</li>
<li class="listitem">
Extract data from response and generate new requests from responses.
</li>
<li class="listitem">
Process generated requests and collect responses from server.
</li>
<li class="listitem">
Go back to step-2 for the next step.
</li>
<li class="listitem">
Publish collected responses from the last chain step.
</li>
</ol>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="filebeat-input-httpjson-common-options"></a>Common options<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></h3>
</div></div></div>
<p>The following configuration options are supported by all inputs.</p>
<h5><a id="_enabled_9"></a><code class="literal">enabled</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></h5>
<p>Use the <code class="literal">enabled</code> option to enable and disable inputs. By default, enabled is
set to true.</p>
<h5><a id="_tags_9"></a><code class="literal">tags</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></h5>
<p>A list of tags that Filebeat includes in the <code class="literal">tags</code> field of each published
event. Tags make it easy to select specific events in Kibana or apply
conditional filtering in Logstash. These tags will be appended to the list of
tags specified in the general configuration.</p>
<p>Example:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: httpjson
  . . .
  tags: ["json"]</pre>
</div>
<h5><a id="filebeat-input-httpjson-fields"></a><code class="literal">fields</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></h5>
<p>Optional fields that you can specify to add additional information to the
output. For example, you might add fields that you can use for filtering log
data. Fields can be scalar values, arrays, dictionaries, or any nested
combination of these. By default, the fields that you specify here will be
grouped under a <code class="literal">fields</code> sub-dictionary in the output document. To store the
custom fields as top-level fields, set the <code class="literal">fields_under_root</code> option to true.
If a duplicate field is declared in the general configuration, then its value
will be overwritten by the value declared here.</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: httpjson
  . . .
  fields:
    app_id: query_engine_12</pre>
</div>
<h5><a id="fields-under-root-httpjson"></a><code class="literal">fields_under_root</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></h5>
<p>If this option is set to true, the custom
<a class="xref" href="filebeat-input-httpjson.html#filebeat-input-httpjson-fields" title="fields">fields</a> are stored as top-level fields in
the output document instead of being grouped under a <code class="literal">fields</code> sub-dictionary. If
the custom field names conflict with other field names added by Filebeat,
then the custom fields overwrite the other fields.</p>
<h5><a id="_processors_9"></a><code class="literal">processors</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></h5>
<p>A list of processors to apply to the input data.</p>
<p>See <a class="xref" href="filtering-and-enhancing-data.html" title="Filter and enhance data with processors"><em>Processors</em></a> for information about specifying
processors in your config.</p>
<h5><a id="_pipeline_9"></a><code class="literal">pipeline</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></h5>
<p>The ingest pipeline ID to set for the events generated by this input.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The pipeline ID can also be configured in the Elasticsearch output, but
this option usually results in simpler configuration files. If the pipeline is
configured both in the input and output, the option from the
input is used.</p>
</div>
</div>
<h5><a id="_keep_null_9"></a><code class="literal">keep_null</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></h5>
<p>If this option is set to true, fields with <code class="literal">null</code> values will be published in
the output document. By default, <code class="literal">keep_null</code> is set to <code class="literal">false</code>.</p>
<h5><a id="_index_9"></a><code class="literal">index</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></h5>
<p>If present, this formatted string overrides the index for events from this input
(for elasticsearch outputs), or sets the <code class="literal">raw_index</code> field of the event&#8217;s
metadata (for other outputs). This string can only refer to the agent name and
version and the event timestamp; for access to dynamic fields, use
<code class="literal">output.elasticsearch.index</code> or a processor.</p>
<p>Example value: <code class="literal">"%{[agent.name]}-myindex-%{+yyyy.MM.dd}"</code> might
expand to <code class="literal">"filebeat-myindex-2019.11.01"</code>.</p>
<h5><a id="_publisher_pipeline_disable_host_9"></a><code class="literal">publisher_pipeline.disable_host</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.6/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></h5>
<p>By default, all events contain <code class="literal">host.name</code>. This option can be set to <code class="literal">true</code> to
disable the addition of this field to all events. The default value is <code class="literal">false</code>.</p>
</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="filebeat-input-http_endpoint.html">« HTTP Endpoint input</a>
</span>
<span class="next">
<a href="filebeat-input-journald.html">Journald input »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
