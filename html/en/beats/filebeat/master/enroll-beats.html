<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Enroll Beats in central management | Filebeat Reference [master] | Elastic</title>
<link rel="home" href="index.html" title="Filebeat Reference [master]"/>
<link rel="up" href="configuration-central-management.html" title="Beats central management"/>
<link rel="prev" href="how-central-managment-works.html" title="How central management works"/>
<link rel="next" href="filebeat-modules.html" title="Modules"/>
<meta name="DC.type" content="Learn/Docs/Filebeat/Reference/master"/>
<meta name="DC.subject" content="Filebeat"/>
<meta name="DC.identifier" content="master"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!--BEGIN QUALTRICS WEBSITE FEEDBACK SNIPPET-->
    <script type='text/javascript'>
      (function(){var g=function(e,h,f,g){
      this.get=function(a){for(var a=a+"=",c=document.cookie.split(";"),b=0,e=c.length;b<e;b++){for(var d=c[b];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return null};
      this.set=function(a,c){var b="",b=new Date;b.setTime(b.getTime()+6048E5);b="; expires="+b.toGMTString();document.cookie=a+"="+c+b+"; path=/; "};
      this.check=function(){var a=this.get(f);if(a)a=a.split(":");else if(100!=e)"v"==h&&(e=Math.random()>=e/100?0:100),a=[h,e,0],this.set(f,a.join(":"));else return!0;var c=a[1];if(100==c)return!0;switch(a[0]){case "v":return!1;case "r":return c=a[2]%Math.floor(100/c),a[2]++,this.set(f,a.join(":")),!c}return!0};
      this.go=function(){if(this.check()){var a=document.createElement("script");a.type="text/javascript";a.src=g;document.body&&document.body.appendChild(a)}};
      this.start=function(){var a=this;window.addEventListener?window.addEventListener("load",function(){a.go()},!1):window.attachEvent&&window.attachEvent("onload",function(){a.go()})}};
      try{(new g(100,"r","QSI_S_ZN_emkP0oSe9Qrn7kF","https://znemkp0ose9qrn7kf-elastic.siteintercept.qualtrics.com/WRSiteInterceptEngine/?Q_ZID=ZN_emkP0oSe9Qrn7kF")).start()}catch(i){}})();
    </script><div id='ZN_emkP0oSe9Qrn7kF'><!--DO NOT REMOVE-CONTENTS PLACED HERE--></div>
    <!--END WEBSITE FEEDBACK SNIPPET-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <!-- Subnav -->
    <div>
      <div>
        <div class="tertiary-nav d-none d-md-block">
          <div class="container">
            <div class="p-t-b-15 d-flex justify-content-between nav-container">
              <div class="breadcrum-wrapper"><span><a href="/guide/" style="font-size: 14px; font-weight: 600; color: #000;">Docs</a></span></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container">
              <div class="row">
                <div class="col-xs-12 col-sm-8 col-md-8 guide-section">
                  <!-- start body -->
                  <div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Filebeat Reference [master]</a></span>
»
<span class="breadcrumb-link"><a href="configuration-central-management.html">Beats central management</a></span>
»
<span class="breadcrumb-node">Enroll Beats in central management</span>
</div>
<div class="navheader">
<span class="prev">
<a href="how-central-managment-works.html">« How central management works</a>
</span>
<span class="next">
<a href="filebeat-modules.html">Modules »</a>
</span>
</div>
<div class="chapter xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="enroll-beats"></a>Enroll Beats in central management<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/master/libbeat/docs/shared-central-management.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>
<div class="sidebar">
<div class="titlepage"><div><div>
<p class="title"><strong>Beats central management discontinued</strong></p>
</div></div></div>
<p>We have ceased development on Beats central management and
are working on a comprehensive solution to replace it.
Thank you for participating in the beta and providing feedback.
If you have any questions or concerns, please reach out to us on the
<a href="https://discuss.elastic.co/c/beats" class="ulink" target="_top">Discuss forum</a>.</p>
</div>
<p>You need to enroll Beats to register them in
<a class="xref" href="configuration-central-management.html" title="Beats central management">central management</a> and establish
trust. Enrolled Beats will have the credentials needed to retrieve
configurations from Kibana.</p>
<p>During the enrollment process:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
The Beat contacts Kibana and tries to register
</li>
<li class="listitem">
Kibana registers the Beat instance and returns an access token
for configuration polling
</li>
<li class="listitem">
The enroll command creates a backup of your configuration and then
<span class="strong strong"><strong>overwrites the current settings</strong></span> so they can be managed centrally
</li>
</ol>
</div>
<p>To enroll Beats, use either <a class="xref" href="enroll-beats.html#token-based-enrollment" title="Token-based enrollment">token-based</a>
or <a class="xref" href="enroll-beats.html#username-password-enrollment" title="Username and password-based enrollment">username and password-based</a> enrollment.</p>
<h3><a id="_prerequisites"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/master/libbeat/docs/shared-central-management.asciidoc">edit</a></h3>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Verify that your Elastic license includes the Beats central management
feature.</p>
<p>Don&#8217;t have a license? You can start a 30-day trial. At the end of the trial
period, you can purchase a subscription to keep using central management. For
more information, see <a href="/subscriptions" class="ulink" target="_top">https://www.elastic.co/subscriptions</a> and
<a href="/guide/en/kibana/master/managing-licenses.html" class="ulink" target="_top">License Management</a>.</p>
</li>
<li class="listitem">
<a href="/guide/en/kibana/master/using-kibana-with-security.html" class="ulink" target="_top">Enable security</a> in Kibana to
ensure that only users with sufficient privileges are able to access Beats
configurations.
</li>
<li class="listitem">
Assign the <code class="literal">beats_admin</code> role to any users who need to enroll Beats or
manage configuration settings in central management.
</li>
<li class="listitem">
If you plan to use the sample Kibana dashboards provided with Filebeat,
<a class="xref" href="load-kibana-dashboards.html" title="Load Kibana dashboards">load the dashboards</a> before enrolling the
Beat.
</li>
<li class="listitem">
If you plan to define module configurations in central management, set up the
ingest pipelines before enrolling the Beat. For more information, see
<a class="xref" href="load-ingest-pipelines.html" title="Load ingest pipelines"><em>Load ingest pipelines</em></a>.
</li>
</ul>
</div>
<h3><a id="token-based-enrollment"></a>Token-based enrollment<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/master/libbeat/docs/shared-central-management.asciidoc">edit</a></h3>
<p>Token-based enrollment is recommended if you are enrolling Beats manually.</p>
<p>To use token-based enrollment, go to Kibana &#8594; Management &#8594; Beats and click
<code class="literal">Enroll Beat</code>. Select the Beat type and operating system, then copy and run the
command for enrolling the Beat.</p>
<p>The command has this format:</p>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">filebeat enroll KIBANA_URL TOKEN</pre>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">KIBANA_URL</code></strong></span>
</span>
</dt>
<dd>
The URL of the Kibana instance you will use for central management.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">TOKEN</code></strong></span>
</span>
</dt>
<dd>
The enrollment token generated by the Central Management UI. The enrollment token will
expire as soon as it&#8217;s used.
</dd>
</dl>
</div>
<p>For example:</p>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">filebeat enroll http://xyz.gov:5601 70f4b584e8024b96b682c46125a8d81</pre>
</div>
<p>Repeat this process to enroll additional Beats.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p><span class="strong strong"><strong>Windows users:</strong></span> If you installed Filebeat as a service, you must also set
<code class="literal">-path.data</code> to <code class="literal">"C:\ProgramData\filebeat"</code> when you
run the enroll command. For example:</p>
<p><code class="literal">.\filebeat.exe enroll <a href="http://xyz.gov:5601" class="ulink" target="_top">http://xyz.gov:5601</a> 70f4b584e8024b96b682c46125a8d81a
-path.data "C:\ProgramData\filebeat"</code></p>
<p>Why? The service installation script, <code class="literal">install-service-filebeat.ps1</code>,
changes the default data path to match the convention used for Windows. If you
run the enroll command without specifying the correct data path, Filebeat
will be enrolled in central management with the wrong UUID and unable to receive
the configuration.</p>
</div>
</div>
<h3><a id="username-password-enrollment"></a>Username and password-based enrollment<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/master/libbeat/docs/shared-central-management.asciidoc">edit</a></h3>
<p>You can also enroll by specifying a username and password. This is the
recommended way for scripted deploys:</p>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">filebeat enroll KIBANA_URL --username USER --password METHOD [--force]</pre>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">--username USER</code></strong></span>
</span>
</dt>
<dd>
The username to use for password-based enrollment. The default
username is <code class="literal">elastic</code>.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">--password METHOD</code></strong></span>
</span>
</dt>
<dd>
<p>
The method to use for getting the password. Available options are:
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">env:VAR_NAME</code> gets the password from the environment variable <code class="literal">VAR_NAME</code>
</li>
<li class="listitem">
<code class="literal">stdin</code> prompts the user for a password. This is the default.
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">--force</code></strong></span>
</span>
</dt>
<dd>
Overwrites the current settings without asking for confirmation.
</dd>
</dl>
</div>
<p>For example:</p>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">filebeat enroll http://xyz.gov:5601 --username myuser --password stdin</pre>
</div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p><span class="strong strong"><strong>Windows users:</strong></span> If you installed Filebeat as a service, you must also set
<code class="literal">-path.data</code> to <code class="literal">"C:\ProgramData\filebeat"</code> when you
run the enroll command. For example:</p>
<p><code class="literal">.\filebeat.exe enroll <a href="http://xyz.gov:5601" class="ulink" target="_top">http://xyz.gov:5601</a> --username myuser --password stdin
-path.data "C:\ProgramData\filebeat"</code></p>
<p>Why? The service installation script, <code class="literal">install-service-filebeat.ps1</code>,
changes the default data path to match the convention used for Windows. If you
run the enroll command without specifying the correct data path, Filebeat
will be enrolled in central management with the wrong UUID and unable to receive
the configuration.</p>
</div>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="how-central-managment-works.html">« How central management works</a>
</span>
<span class="next">
<a href="filebeat-modules.html">Modules »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>
                <div class="col-xs-12 col-sm-4 col-md-4" id="right_col">
                  <div id="rtpcontainer" style="display: block;">
                    <div class="mktg-promo">
                      <h3>Most Popular</h3>
                      <ul class="icons">
                        <li class="icon-elasticsearch-white"><a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">Get Started with Elasticsearch: Video</a></li>
                        <li class="icon-kibana-white"><a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">Intro to Kibana: Video</a></li>
                        <li class="icon-logstash-white"><a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">ELK for Logs & Metrics: Video</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";
	var localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}';
</script>
<script src="/static/js/swiftype_app_search.umd.min.js"></script>
<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
