<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Common Expression Language input | Filebeat Reference [master] | Elastic</title>
<meta class="elastic" name="content" content="Common Expression Language input | Filebeat Reference [master]">

<link rel="home" href="index.html" title="Filebeat Reference [master]"/>
<link rel="up" href="configuration-filebeat-options.html" title="Configure inputs"/>
<link rel="prev" href="filebeat-input-azure-blob-storage.html" title="Azure Blob Storage Input"/>
<link rel="next" href="filebeat-input-cloudfoundry.html" title="Cloud Foundry input"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="Filebeat"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Filebeat/Reference/master"/>
<meta name="DC.subject" content="Filebeat"/>
<meta name="DC.identifier" content="master"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <!--© 2015-2022 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <!--BEGIN QUALTRICS WEBSITE FEEDBACK SNIPPET-->
    <script type='text/javascript'>
      (function(){var g=function(e,h,f,g){
      this.get=function(a){for(var a=a+"=",c=document.cookie.split(";"),b=0,e=c.length;b<e;b++){for(var d=c[b];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return null};
      this.set=function(a,c){var b="",b=new Date;b.setTime(b.getTime()+6048E5);b="; expires="+b.toGMTString();document.cookie=a+"="+c+b+"; path=/; "};
      this.check=function(){var a=this.get(f);if(a)a=a.split(":");else if(100!=e)"v"==h&&(e=Math.random()>=e/100?0:100),a=[h,e,0],this.set(f,a.join(":"));else return!0;var c=a[1];if(100==c)return!0;switch(a[0]){case "v":return!1;case "r":return c=a[2]%Math.floor(100/c),a[2]++,this.set(f,a.join(":")),!c}return!0};
      this.go=function(){if(this.check()){var a=document.createElement("script");a.type="text/javascript";a.src=g;document.body&&document.body.appendChild(a)}};
      this.start=function(){var a=this;window.addEventListener?window.addEventListener("load",function(){a.go()},!1):window.attachEvent&&window.attachEvent("onload",function(){a.go()})}};
      try{(new g(100,"r","QSI_S_ZN_emkP0oSe9Qrn7kF","https://znemkp0ose9qrn7kf-elastic.siteintercept.qualtrics.com/WRSiteInterceptEngine/?Q_ZID=ZN_emkP0oSe9Qrn7kF")).start()}catch(i){}})();
    </script><div id='ZN_emkP0oSe9Qrn7kF'><!--DO NOT REMOVE-CONTENTS PLACED HERE--></div>
    <!--END WEBSITE FEEDBACK SNIPPET-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  <div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Filebeat Reference [master]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="configuring-howto-filebeat.html">Configure Filebeat</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="configuration-filebeat-options.html">Configure inputs</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="filebeat-input-azure-blob-storage.html">« Azure Blob Storage Input</a>
</span>
<span class="next">
<a href="filebeat-input-cloudfoundry.html">Cloud Foundry input »</a>
</span>
</div>
<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="filebeat-input-cel"></a>Common Expression Language input<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h2>
</div></div></div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in technical preview and may be changed or removed in a future release. Elastic will apply best effort to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.</p>
</div>
</div>

<p>Use the <code class="literal">cel</code> input to read messages from a file path or HTTP API with a variety of payloads using the <a href="https://opensource.google.com/projects/cel" class="ulink" target="_top">Common Expression Language (CEL)</a> and the <a href="https://pkg.go.dev/github.com/elastic/mito/lib" class="ulink" target="_top">mito</a> CEL extension libraries.</p>
<p>CEL is a non-Turing complete language that can perform evaluation of expression in inputs, which can include file and API endpoints using the mito extension library.
The <code class="literal">cel</code> input periodically runs a CEL program that is given an execution environment that may be configured by the user, and publishes the set of events that result from the program evaluation.
Optionally the CEL program may return cursor states that will be provided to the next execution of the CEL program.
The cursor states may be used to control the behaviour of the program.</p>
<p>This input supports:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Auth</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Basic
</li>
<li class="listitem">
OAuth2
</li>
</ul>
</div>
</li>
<li class="listitem">
Retrieval at a configurable interval
</li>
<li class="listitem">
Pagination
</li>
<li class="listitem">
Retries
</li>
<li class="listitem">
Rate limiting
</li>
<li class="listitem">
Proxying
</li>
</ul>
</div>
<p>Example configurations:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
# Fetch your public IP every minute.
- type: cel
  interval: 1m
  resource.url: https://api.ipify.org/?format=json
  program: |
    bytes(get(state.url).Body).as(body, {
        "events": [body.decode_json()]
    })</pre>
</div>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: cel
  resource.url: http://localhost:9200/_search
  state:
    scroll: 5m
  program: |
    (
        !has(state.cursor) || !has(state.cursor.scroll_id) ?
            post(state.url+"?scroll=5m", "", "")
        :
            post(
                state.url+"/scroll?"+{"scroll_id": [state.cursor.scroll_id]}.format_query(),
                "application/json",
                {"scroll": state.scroll}.encode_json()
            )
    ).as(resp, bytes(resp.Body).decode_json().as(body, {
            "events": body.hits.hits,
            "cursor": {"scroll_id": body._scroll_id},
    }))</pre>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_execution"></a>Execution<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h3>
</div></div></div>
<p>The execution environment provided for the input includes includes the function, macros and global variables provided by the mito and ext.Strings libraries.
A single JSON object is provided as an input accessible through a <code class="literal">state</code> variable.
<code class="literal">state</code> contains a string <code class="literal">url</code> field and may contain arbitrary other fields configured via the input&#8217;s <code class="literal">state</code> configuration.
If the CEL program saves cursor states between executions of the program, the configured <code class="literal">state.cursor</code> value will be replaced by the saved cursor prior to execution.</p>
<p>On start the <code class="literal">state</code> is will be something like this:</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
    "url": &lt;resource address&gt;,
    "cursor": { ... },
    ...
}</pre>
</div>
<p>The <code class="literal">state.url</code> field will be present and may be an HTTP end-point or a file path.
It is the responsibility of the CEL program to handle removing the scheme from a file URL if it is present.
The <code class="literal">state.url</code> field may be mutated during execution of the program, but the mutated state will not be persisted between restarts The <code class="literal">state.url</code> field must be present in the returned value to ensure that it is available in the next evaluation unless the program has the resource address hard-coded in or it is available from the cursor.</p>
<p>Additional fields may be present at the root of the object and if the program tolerates it, the cursor value may be absent.
Only the cursor is persisted over restarts, but all fields in state are retained between iterations of the processing loop except for the produced events array, see below.</p>
<p>If the cursor is present the program should perform and process requests based on its value.
If cursor is not present the program must have alternative logic to determine what requests to make.</p>
<p>After completion of a program&#8217;s execution it should return a single object with a structure looking like this:</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
    "events": [ <a id="CO12-1"></a><i class="conum" data-value="1"></i>
        {...},
        ...
    ],
    "cursor": [ <a id="CO12-2"></a><i class="conum" data-value="2"></i>
        {...},
        ...
    ],
    "url": &lt;resource address&gt;,
    "status_code": &lt;HTTP request status code if a network request&gt;,
    "header": &lt;HTTP response headers if a network request&gt;,
    "rate_limit": &lt;HTTP rate limit map if required by API&gt;, <a id="CO12-3"></a><i class="conum" data-value="3"></i>
    "want_more": false <a id="CO12-4"></a><i class="conum" data-value="4"></i>
}</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO12-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>The <code class="literal">events</code> field must be present, but may be empty or null. If it is not empty, it must only have objects as elements.
The field should be an array, but in the case of an error condition in the CEL program it is acceptable to return a single object instead of an array; this will will be wrapped as an array for publication and an error will be logged.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO12-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>If <code class="literal">cursor</code> is present it must be either be a single object or an array with the same length as events; each element <em>i</em> of the <code class="literal">cursor</code> will be the details for obtaining the events at and beyond event <em>i</em> in the <code class="literal">events</code> array. If the <code class="literal">cursor</code> is a single object it is will be the details for obtaining events after the last event in the <code class="literal">events</code> array and will only be retained on successful publication of all the events in the <code class="literal">events</code> array.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO12-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>If <code class="literal">rate_limit</code> is present it must be a map with numeric fields <code class="literal">rate</code> and <code class="literal">burst</code>. The <code class="literal">rate_limit</code> field may also have a string <code class="literal">error</code> field and other fields which will be logged. If it has an <code class="literal">error</code> field, the <code class="literal">rate</code> and <code class="literal">burst</code> will not be used to set rate limit behavior. The <a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#Limit" class="ulink" target="_top">Limit</a>, and <a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#OktaRateLimit" class="ulink" target="_top">Okta Rate Limit policy</a> and <a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#DraftRateLimit" class="ulink" target="_top">Draft Rate Limit policy</a> documentation show how to construct this field.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO12-4"><i class="conum" data-value="4"></i></a></p>
</td>
<td align="left" valign="top">
<p>The evaluation is repeated with the new state, after removing the events field, if the "want_more" field is present and true, and a non-zero events array is returned.</p>
</td>
</tr>
</table>
</div>
<p>The <code class="literal">status_code</code>, <code class="literal">header</code> and <code class="literal">rate_limit</code> values may be omitted if the program is not interacting with an HTTP API end-point and so will not be needed to contribute to program control.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_debug_state_logging"></a>Debug state logging<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h3>
</div></div></div>
<p>The CEL input will log the complete state after evaluation when logging at the DEBUG level.
This will include any sensitive or secret information kept in the <code class="literal">state</code> object, and so DEBUG level logging should not be used in production when sensitive information is retained in the <code class="literal">state</code> object.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_cel_extension_libraries"></a>CEL extension libraries<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h3>
</div></div></div>
<p>As noted above the <code class="literal">cel</code> input provides function, macro and global variables to extend the language.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p><a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#Collections" class="ulink" target="_top">Collections</a></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#hdr-Collate" class="ulink" target="_top">Collate</a>
</li>
<li class="listitem">
<a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#hdr-Drop" class="ulink" target="_top">Drop</a>
</li>
<li class="listitem">
<a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#hdr-Drop_Empty" class="ulink" target="_top">Drop Empty</a>
</li>
<li class="listitem">
<a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#hdr-Flatten" class="ulink" target="_top">Flatten</a>
</li>
<li class="listitem">
<a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#hdr-Max" class="ulink" target="_top">Max</a>
</li>
<li class="listitem">
<a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#hdr-Min" class="ulink" target="_top">Min</a>
</li>
<li class="listitem">
<a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#hdr-With" class="ulink" target="_top">With</a>
</li>
<li class="listitem">
<a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#hdr-With_Replace" class="ulink" target="_top">With Replace</a>
</li>
<li class="listitem">
<a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#hdr-With_Update" class="ulink" target="_top">With Update</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p><a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#Crypto" class="ulink" target="_top">Crypto</a></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#hdr-Base64" class="ulink" target="_top">Base64</a>
</li>
<li class="listitem">
<a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#hdr-Base64_Raw" class="ulink" target="_top">Base64 Raw</a>
</li>
<li class="listitem">
<a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#hdr-Hex" class="ulink" target="_top">Hex</a>
</li>
<li class="listitem">
<a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#hdr-SHA_1" class="ulink" target="_top">SHA-1</a>
</li>
<li class="listitem">
<a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#hdr-SHA_256" class="ulink" target="_top">SHA-256</a>
</li>
<li class="listitem">
<a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#hdr-HMAC" class="ulink" target="_top">HMAC</a>
</li>
<li class="listitem">
<a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#hdr-UUID" class="ulink" target="_top">UUID</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p><a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#File" class="ulink" target="_top">File</a></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#hdr-Dir" class="ulink" target="_top">Dir</a>
</li>
<li class="listitem">
<a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#hdr-File" class="ulink" target="_top">File</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p><a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#HTTP" class="ulink" target="_top">HTTP</a></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#hdr-HEAD" class="ulink" target="_top">HEAD</a>
</li>
<li class="listitem">
<a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#hdr-GET" class="ulink" target="_top">GET</a>
</li>
<li class="listitem">
<a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#hdr-GET_Request" class="ulink" target="_top">GET Request</a>
</li>
<li class="listitem">
<a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#hdr-POST" class="ulink" target="_top">POST</a>
</li>
<li class="listitem">
<a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#hdr-POST_Request" class="ulink" target="_top">POST Request</a>
</li>
<li class="listitem">
<a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#hdr-Request" class="ulink" target="_top">Request</a>
</li>
<li class="listitem">
<a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#hdr-Basic_Authentication" class="ulink" target="_top">Basic Authentication</a>
</li>
<li class="listitem">
<a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#hdr-Do_Request" class="ulink" target="_top">Do Request</a>
</li>
<li class="listitem">
<a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#hdr-Parse_URL" class="ulink" target="_top">Parse URL</a>
</li>
<li class="listitem">
<a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#hdr-Format_URL" class="ulink" target="_top">Format URL</a>
</li>
<li class="listitem">
<a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#hdr-Parse_Query" class="ulink" target="_top">Parse Query</a>
</li>
<li class="listitem">
<a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#hdr-Format_Query" class="ulink" target="_top">Format Query</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p><a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#File" class="ulink" target="_top">File</a> — the file extension is initialized with MIME handlers for "application/gzip", <a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#NDJSON" class="ulink" target="_top">"application/x-ndjson"</a>, <a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#Zip" class="ulink" target="_top">"application/zip"</a>, <a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#CSVNoHeader" class="ulink" target="_top">"text/csv; header=absent"</a>, and <a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#CSVHeader" class="ulink" target="_top">"text/csv; header=present"</a>.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#hdr-Encode_JSON" class="ulink" target="_top">Encode JSON</a>
</li>
<li class="listitem">
<a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#hdr-Decode_JSON" class="ulink" target="_top">Decode JSON</a>
</li>
<li class="listitem">
<a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#hdr-Decode_JSON_Stream" class="ulink" target="_top">Decode JSON Stream</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p><a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#Limit" class="ulink" target="_top">Limit</a> — the rate limit extension is initialized with <a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#OktaRateLimit" class="ulink" target="_top">Okta (as "okta")</a> and the <a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#DraftRateLimit" class="ulink" target="_top">Draft Rate Limit (as "draft")</a> policies.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#hdr-Rate_Limit" class="ulink" target="_top">Rate Limit</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p><a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#MIME" class="ulink" target="_top">MIME</a> — the MIME extension is initialized with MIME handlers for "application/gzip", <a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#NDJSON" class="ulink" target="_top">"application/x-ndjson"</a>, <a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#Zip" class="ulink" target="_top">"application/zip"</a>, <a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#CSVNoHeader" class="ulink" target="_top">"text/csv; header=absent"</a>, and <a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#CSVHeader" class="ulink" target="_top">"text/csv; header=present"</a>.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#hdr-MIME" class="ulink" target="_top">MIME</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p><a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#Regexp" class="ulink" target="_top">Regexp</a> — the regular expression extension is initialized with the patterns specified in the user input configuration via the <code class="literal">regexp</code> field.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#hdr-RE_Match" class="ulink" target="_top">RE Match</a>
</li>
<li class="listitem">
<a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#hdr-RE_Find" class="ulink" target="_top">RE Find</a>
</li>
<li class="listitem">
<a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#hdr-RE_Find_All" class="ulink" target="_top">RE Find All</a>
</li>
<li class="listitem">
<a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#hdr-RE_Find_Submatch" class="ulink" target="_top">RE Find Submatch</a>
</li>
<li class="listitem">
<a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#hdr-RE_Find_All_Submatch" class="ulink" target="_top">RE Find All Submatch</a>
</li>
<li class="listitem">
<a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#hdr-RE_Replace_All" class="ulink" target="_top">RE Replace All</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p><a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#Strings" class="ulink" target="_top">Strings</a></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#hdr-String_Methods" class="ulink" target="_top">String Methods</a>
</li>
<li class="listitem">
<a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#hdr-String_List_Methods" class="ulink" target="_top">String List Methods</a>
</li>
<li class="listitem">
<a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#hdr-Bytes_Methods" class="ulink" target="_top">Bytes Methods</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p><a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#Time" class="ulink" target="_top">Time</a></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#hdr-Format" class="ulink" target="_top">Format</a>
</li>
<li class="listitem">
<a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#hdr-Parse_Time" class="ulink" target="_top">Parse Time</a>
</li>
<li class="listitem">
<a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#hdr-Global_Variables" class="ulink" target="_top">Global Variables</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p><a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#Try" class="ulink" target="_top">Try</a></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#hdr-Try" class="ulink" target="_top">Try</a>
</li>
<li class="listitem">
<a href="https://pkg.go.dev/github.com/elastic/mito@v1.1.0/lib#hdr-Is_Error" class="ulink" target="_top">Is Error</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
<p>In addition to the extensions provided in the packages listed above, a global variable <code class="literal">useragent</code> is also provided which gives the user CEL program access to the filebeat user-agent string.</p>
<p>Additionally, it supports authentication via Basic auth, HTTP Headers or oauth2.</p>
<p>Example configurations with authentication:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: cel
  resource.url: http://localhost
  request.transforms:
    - set:
        target: header.Authorization
        value: 'Basic aGVsbG86d29ybGQ='</pre>
</div>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: cel
  auth.oauth2:
    client.id: 12345678901234567890abcdef
    client.secret: abcdef12345678901234567890
    token_url: http://localhost/oauth2/token
  resource.url: http://localhost</pre>
</div>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: cel
  auth.oauth2:
    client.id: 12345678901234567890abcdef
    client.secret: abcdef12345678901234567890
    token_url: http://localhost/oauth2/token
    user: user@domain.tld
    password: P@$$W0₹D
  resource.url: http://localhost</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="input-state-cel"></a>Input state<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h3>
</div></div></div>
<p>The <code class="literal">cel</code> input keeps a runtime state between requests. This state can be accessed by the CEL program and may contain arbitrary objects.</p>
<p>The state must contain a <code class="literal">url</code> string and may contain any object the user wishes to store in it.</p>
<p>All objects are stored at runtime, except <code class="literal">cursor</code>, which has values that are persisted between restarts.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_configuration_options_2"></a>Configuration options<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h3>
</div></div></div>
<p>The <code class="literal">cel</code> input supports the following configuration options plus the
<a class="xref" href="filebeat-input-cel.html#filebeat-input-cel-common-options" title="Common options">Common options</a> described later.</p>
<h4><a id="_interval"></a><code class="literal">interval</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h4>
<p>Duration between repeated requests. It may make additional pagination requests in response to the initial request if pagination is enabled. Default: <code class="literal">60s</code>.</p>
<h4><a id="program-cel"></a><code class="literal">program</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h4>
<p>The CEL program that is executed each polling period. This field is required.</p>
<h4><a id="max_executions-cel"></a><code class="literal">max_executions</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h4>
<p><code class="literal">max_executions</code> is the maximum number of times a CEL program can request to be re-run with a <code class="literal">want_more</code> field. This is used to ensure that accidental infinite loops do not halt processing. When the execution budget is exceeded, execution will be restarted at the next interval and a warning will be written into the logs. Default: 1000.</p>
<h4><a id="state-cel"></a><code class="literal">state</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h4>
<p><code class="literal">state</code> is an optional object that is passed to the CEL program on the first execution. It is available to the executing program as the <code class="literal">state</code> variable. It is made available to subsequent executions of the program during the life of input as the returned value of the previous execution, but with the <code class="literal">state.events</code> field removed. Except for the <code class="literal">state.cursor</code> field, <code class="literal">state</code> does not persist over restarts.</p>
<h4><a id="cursor-cel"></a><code class="literal">state.cursor</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h4>
<p>The cursor is an object available as <code class="literal">state.cursor</code> where arbitrary values may be stored. Cursor state is kept between input restarts and updated after each event of a request has been published. When a cursor is used the CEL program must either create a cursor state for each event that is returned by the program, or a single cursor that reflect the cursor for completion of the full set of events.</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
# Fetch your public IP every minute and note when the last request was made.
- type: cel
  interval: 1m
  resource.url: https://api.ipify.org/?format=json
  program: |
    bytes(get(state.url).Body).as(body, {
        "events": [body.decode_json().with({
            "last_requested_at": has(state.cursor) &amp;&amp; has(state.cursor.last_requested_at) ?
                state.cursor.last_requested_at
            :
                now
        })],
        "cursor": {"last_requested_at": now}
    })</pre>
</div>
<h4><a id="regexp-cel"></a><code class="literal">regexp</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h4>
<p>A set of named regular expressions that may be used during a CEL program&#8217;s execution using the <code class="literal">regexp</code> extension library. The syntax used for the regular expressions is <a href="https://github.com/google/re2/wiki/Syntax" class="ulink" target="_top">RE2</a>.</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: cel
  # Define two regular expressions, 'products' and 'solutions' for use during CEL execution.
  regexp:
    products: '(?i)(Elasticsearch|Beats|Logstash|Kibana)'
    solutions: '(?i)(Search|Observability|Security)'</pre>
</div>
<h4><a id="_auth_basic_enabled"></a><code class="literal">auth.basic.enabled</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h4>
<p>When set to <code class="literal">false</code>, disables the basic auth configuration. Default: <code class="literal">true</code>.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Basic auth settings are disabled if either <code class="literal">enabled</code> is set to <code class="literal">false</code> or
the <code class="literal">auth.basic</code> section is missing.</p>
</div>
</div>
<h4><a id="_auth_basic_user"></a><code class="literal">auth.basic.user</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h4>
<p>The user to authenticate with.</p>
<h4><a id="_auth_basic_password"></a><code class="literal">auth.basic.password</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h4>
<p>The password to use.</p>
<h4><a id="_auth_oauth2_enabled"></a><code class="literal">auth.oauth2.enabled</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h4>
<p>When set to <code class="literal">false</code>, disables the oauth2 configuration. Default: <code class="literal">true</code>.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>OAuth2 settings are disabled if either <code class="literal">enabled</code> is set to <code class="literal">false</code> or
the <code class="literal">auth.oauth2</code> section is missing.</p>
</div>
</div>
<h4><a id="_auth_oauth2_provider"></a><code class="literal">auth.oauth2.provider</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h4>
<p>Used to configure supported oauth2 providers.
Each supported provider will require specific settings. It is not set by default.
Supported providers are: <code class="literal">azure</code>, <code class="literal">google</code>.</p>
<h4><a id="_auth_oauth2_client_id"></a><code class="literal">auth.oauth2.client.id</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h4>
<p>The client ID used as part of the authentication flow. It is always required
except if using <code class="literal">google</code> as provider. Required for providers: <code class="literal">default</code>, <code class="literal">azure</code>.</p>
<h4><a id="_auth_oauth2_client_secret"></a><code class="literal">auth.oauth2.client.secret</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h4>
<p>The client secret used as part of the authentication flow. It is always required
except if using <code class="literal">google</code> as provider. Required for providers: <code class="literal">default</code>, <code class="literal">azure</code>.</p>
<h4><a id="_auth_oauth2_user"></a><code class="literal">auth.oauth2.user</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h4>
<p>The user used as part of the authentication flow. It is required for authentication
 - grant type password. It is only available for provider <code class="literal">default</code>.</p>
<h4><a id="_auth_oauth2_password"></a><code class="literal">auth.oauth2.password</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h4>
<p>The password used as part of the authentication flow. It is required for authentication
 - grant type password. It is only available for provider <code class="literal">default</code>.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>user and password are required for grant_type password. If user and
password is not used then it will automatically use the <code class="literal">token_url</code> and
<code class="literal">client credential</code> method.</p>
</div>
</div>
<h4><a id="_auth_oauth2_scopes"></a><code class="literal">auth.oauth2.scopes</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h4>
<p>A list of scopes that will be requested during the oauth2 flow.
It is optional for all providers.</p>
<h4><a id="_auth_oauth2_token_url"></a><code class="literal">auth.oauth2.token_url</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h4>
<p>The endpoint that will be used to generate the tokens during the oauth2 flow. It is required if no provider is specified.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>For <code class="literal">azure</code> provider either <code class="literal">token_url</code> or <code class="literal">azure.tenant_id</code> is required.</p>
</div>
</div>
<h4><a id="_auth_oauth2_endpoint_params"></a><code class="literal">auth.oauth2.endpoint_params</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h4>
<p>Set of values that will be sent on each request to the <code class="literal">token_url</code>. Each param key can have multiple values.
Can be set for all providers except <code class="literal">google</code>.</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">- type: cel
  auth.oauth2:
    endpoint_params:
      Param1:
        - ValueA
        - ValueB
      Param2:
        - Value</pre>
</div>
<h4><a id="_auth_oauth2_azure_tenant_id"></a><code class="literal">auth.oauth2.azure.tenant_id</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h4>
<p>Used for authentication when using <code class="literal">azure</code> provider.
Since it is used in the process to generate the <code class="literal">token_url</code>, it can&#8217;t be used in
combination with it. It is not required.</p>
<p>For information about where to find it, you can refer to
<a href="https://docs.microsoft.com/en-us/azure/active-directory/develop/howto-create-service-principal-portal" class="ulink" target="_top">https://docs.microsoft.com/en-us/azure/active-directory/develop/howto-create-service-principal-portal</a>.</p>
<h4><a id="_auth_oauth2_azure_resource"></a><code class="literal">auth.oauth2.azure.resource</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h4>
<p>The accessed WebAPI resource when using <code class="literal">azure</code> provider.
It is not required.</p>
<h4><a id="_auth_oauth2_google_credentials_file"></a><code class="literal">auth.oauth2.google.credentials_file</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h4>
<p>The credentials file for Google.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Only one of the credentials settings can be set at once. If none is provided, loading
default credentials from the environment will be attempted via ADC. For more information about
how to provide Google credentials, please refer to <a href="https://cloud.google.com/docs/authentication" class="ulink" target="_top">https://cloud.google.com/docs/authentication</a>.</p>
</div>
</div>
<h4><a id="_auth_oauth2_google_credentials_json"></a><code class="literal">auth.oauth2.google.credentials_json</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h4>
<p>Your credentials information as raw JSON.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Only one of the credentials settings can be set at once. If none is provided, loading
default credentials from the environment will be attempted via ADC. For more information about
how to provide Google credentials, please refer to <a href="https://cloud.google.com/docs/authentication" class="ulink" target="_top">https://cloud.google.com/docs/authentication</a>.</p>
</div>
</div>
<h4><a id="_auth_oauth2_google_jwt_file"></a><code class="literal">auth.oauth2.google.jwt_file</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h4>
<p>The JWT Account Key file for Google.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Only one of the credentials settings can be set at once. If none is provided, loading
default credentials from the environment will be attempted via ADC. For more information about
how to provide Google credentials, please refer to <a href="https://cloud.google.com/docs/authentication" class="ulink" target="_top">https://cloud.google.com/docs/authentication</a>.</p>
</div>
</div>
<h4><a id="_auth_oauth2_google_jwt_json"></a><code class="literal">auth.oauth2.google.jwt_json</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h4>
<p>The JWT Account Key file as raw JSON.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Only one of the credentials settings can be set at once. If none is provided, loading
default credentials from the environment will be attempted via ADC. For more information about
how to provide Google credentials, please refer to <a href="https://cloud.google.com/docs/authentication" class="ulink" target="_top">https://cloud.google.com/docs/authentication</a>.</p>
</div>
</div>
<h4><a id="_auth_oauth2_google_delegated_account"></a><code class="literal">auth.oauth2.google.delegated_account</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h4>
<p>Email of the delegated account used to create the credentials (usually an admin). Used in combination
with <code class="literal">auth.oauth2.google.jwt_file</code> or <code class="literal">auth.oauth2.google.jwt_json</code>.</p>
<h4><a id="resource-parameters"></a><code class="literal">resource.url</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h4>
<p>The URL of the HTTP API. Required.</p>
<p>The API endpoint may be accessed via unix socket and Windows named pipes by adding  <code class="literal">+unix</code> or <code class="literal">+npipe</code>
to the URL scheme, for example, <code class="literal">http+unix:///var/socket/</code>.</p>
<h4><a id="_resource_timeout"></a><code class="literal">resource.timeout</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h4>
<p>Duration before declaring that the HTTP client connection has timed out. Valid time units are <code class="literal">ns</code>, <code class="literal">us</code>, <code class="literal">ms</code>, <code class="literal">s</code>, <code class="literal">m</code>, <code class="literal">h</code>. Default: <code class="literal">30s</code>.</p>
<h4><a id="_resource_ssl"></a><code class="literal">resource.ssl</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h4>
<p>This specifies SSL/TLS configuration. If the ssl section is missing, the host&#8217;s
CAs are used for HTTPS connections. See <a class="xref" href="configuration-ssl.html" title="Configure SSL"><em>SSL</em></a> for more
information.</p>
<h4><a id="_resource_keep_alive_disable"></a><code class="literal">resource.keep_alive.disable</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h4>
<p>This specifies whether to disable keep-alives for HTTP end-points. Default: <code class="literal">true</code>.</p>
<h4><a id="_resource_keep_alive_max_idle_connections"></a><code class="literal">resource.keep_alive.max_idle_connections</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h4>
<p>The maximum number of idle connections across all hosts. Zero means no limit. Default: <code class="literal">0</code>.</p>
<h4><a id="_resource_keep_alive_max_idle_connections_per_host"></a><code class="literal">resource.keep_alive.max_idle_connections_per_host</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h4>
<p>The maximum idle connections to keep per-host. If zero, defaults to two. Default: <code class="literal">0</code>.</p>
<h4><a id="_resource_keep_alive_idle_connection_timeout"></a><code class="literal">resource.keep_alive.idle_connection_timeout</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h4>
<p>The maximum amount of time an idle connection will remain idle before closing itself. Valid time units are <code class="literal">ns</code>, <code class="literal">us</code>, <code class="literal">ms</code>, <code class="literal">s</code>, <code class="literal">m</code>, <code class="literal">h</code>. Zero means no limit. Default: <code class="literal">0s</code>.</p>
<h4><a id="_resource_retry_max_attempts"></a><code class="literal">resource.retry.max_attempts</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h4>
<p>The maximum number of retries for the HTTP client. Default: <code class="literal">5</code>.</p>
<h4><a id="_resource_retry_wait_min"></a><code class="literal">resource.retry.wait_min</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h4>
<p>The minimum time to wait before a retry is attempted. Default: <code class="literal">1s</code>.</p>
<h4><a id="_resource_retry_wait_max"></a><code class="literal">resource.retry.wait_max</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h4>
<p>The maximum time to wait before a retry is attempted. Default: <code class="literal">60s</code>.</p>
<h4><a id="_resource_redirect_forward_headers"></a><code class="literal">resource.redirect.forward_headers</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h4>
<p>When set to <code class="literal">true</code> request headers are forwarded in case of a redirect. Default: <code class="literal">false</code>.</p>
<h4><a id="_resource_redirect_headers_ban_list"></a><code class="literal">resource.redirect.headers_ban_list</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h4>
<p>When <code class="literal">redirect.forward_headers</code> is set to <code class="literal">true</code>, all headers <em>except</em> the ones defined in this list will be forwarded. Default: <code class="literal">[]</code>.</p>
<h4><a id="_resource_redirect_max_redirects"></a><code class="literal">resource.redirect.max_redirects</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h4>
<p>The maximum number of redirects to follow for a request. Default: <code class="literal">10</code>.</p>
<h4><a id="resource-rate-limit"></a><code class="literal">resource.rate_limit.limit</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h4>
<p>The value of the response that specifies the maximum overall resource request rate.</p>
<h4><a id="_resource_rate_limit_burst"></a><code class="literal">resource.rate_limit.burst</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h4>
<p>The maximum burst size. Burst is the maximum number of resource requests that can be made above the overall rate limit.</p>
<h4><a id="_resource_tracer_filename"></a><code class="literal">resource.tracer.filename</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h4>
<p>It is possible to log HTTP requests and responses in a CEL program to a local file-system for debugging configurations.
This option is enabled by setting the <code class="literal">resource.tracer.filename</code> value. Additional options are available to
tune log rotation behavior.</p>
<p>To differentiate the trace files generated from different input instances, a placeholder <code class="literal">*</code> can be added to the filename and will be replaced with the input instance id.
For Example, <code class="literal">http-request-trace-*.ndjson</code>.</p>
<p>Enabling this option compromises security and should only be used for debugging.</p>
<h4><a id="_resource_tracer_maxsize"></a><code class="literal">resource.tracer.maxsize</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h4>
<p>This value sets the maximum size, in megabytes, the log file will reach before it is rotated. By default
logs are allowed to reach 1MB before rotation.</p>
<h4><a id="_resource_tracer_maxage"></a><code class="literal">resource.tracer.maxage</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h4>
<p>This specifies the number days to retain rotated log files. If it is not set, log files are retained
indefinitely.</p>
<h4><a id="_resource_tracer_maxbackups"></a><code class="literal">resource.tracer.maxbackups</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h4>
<p>The number of old logs to retain. If it is not set all old logs are retained subject to the <code class="literal">resource.tracer.maxage</code>
setting.</p>
<h4><a id="_resource_tracer_localtime"></a><code class="literal">resource.tracer.localtime</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h4>
<p>Whether to use the host&#8217;s local time rather that UTC for timestamping rotated log file names.</p>
<h4><a id="_resource_tracer_compress"></a><code class="literal">resource.tracer.compress</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h4>
<p>This determines whether rotated logs should be gzip compressed.</p>
<h4><a id="_redact_fields"></a><code class="literal">redact.fields</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h4>
<p>This specifies fields in the <code class="literal">state</code> to be redacted prior to debug logging. Fields listed in this array will be either replaced with a <code class="literal">*</code> or deleted entirely from messages sent to debug logs.</p>
<h4><a id="_redact_delete"></a><code class="literal">redact.delete</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h4>
<p>This specifies whether fields should be replaced with a <code class="literal">*</code> or deleted entirely from messages sent to debug logs. If delete is <code class="literal">true</code>, fields will be deleted rather than replaced.</p>
<h3><a id="_metrics_3"></a>Metrics<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h3>
<p>This input exposes metrics under the <a class="xref" href="http-endpoint.html" title="Configure an HTTP endpoint for metrics">HTTP monitoring endpoint</a>.
These metrics are exposed under the <code class="literal">/inputs</code> path. They can be used to
observe the activity of the input.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Metric</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">resource</code></p></td>
<td align="left" valign="top"><p>URL or path of the input resource.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">cel_executions</code></p></td>
<td align="left" valign="top"><p>Number times the CEL program has been executed.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">batches_received_total</code></p></td>
<td align="left" valign="top"><p>Number of event arrays received.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">events_received_total</code></p></td>
<td align="left" valign="top"><p>Number of events received.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">batches_published_total</code></p></td>
<td align="left" valign="top"><p>Number of event arrays published.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">events_published_total</code></p></td>
<td align="left" valign="top"><p>Number of events published.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">cel_processing_time</code></p></td>
<td align="left" valign="top"><p>Histogram of the elapsed successful CEL program processing times in nanoseconds.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">batch_processing_time</code></p></td>
<td align="left" valign="top"><p>Histogram of the elapsed successful batch processing times in nanoseconds (time of receipt to time of ACK for non-empty batches).</p></td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_developer_tools"></a>Developer tools<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/docs/inputs/input-cel.asciidoc">edit</a></h3>
</div></div></div>
<p>A stand-alone CEL environment that implements the majority of the CEL input&#8217;s Comment Expression Language functionality is available in the <a href="https://github.com/elastic/mito" class="ulink" target="_top">Elastic Mito</a> repository. This tool may be used to help develop CEL programs to be used by the input. Installation is available from source by running <code class="literal">go install github.com/elastic/mito/cmd/mito@latest</code> and requires a Go toolchain.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="filebeat-input-cel-common-options"></a>Common options<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></h3>
</div></div></div>
<p>The following configuration options are supported by all inputs.</p>
<h5><a id="_enabled_3"></a><code class="literal">enabled</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></h5>
<p>Use the <code class="literal">enabled</code> option to enable and disable inputs. By default, enabled is
set to true.</p>
<h5><a id="_tags_3"></a><code class="literal">tags</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></h5>
<p>A list of tags that Filebeat includes in the <code class="literal">tags</code> field of each published
event. Tags make it easy to select specific events in Kibana or apply
conditional filtering in Logstash. These tags will be appended to the list of
tags specified in the general configuration.</p>
<p>Example:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: cel
  . . .
  tags: ["json"]</pre>
</div>
<h5><a id="filebeat-input-cel-fields"></a><code class="literal">fields</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></h5>
<p>Optional fields that you can specify to add additional information to the
output. For example, you might add fields that you can use for filtering log
data. Fields can be scalar values, arrays, dictionaries, or any nested
combination of these. By default, the fields that you specify here will be
grouped under a <code class="literal">fields</code> sub-dictionary in the output document. To store the
custom fields as top-level fields, set the <code class="literal">fields_under_root</code> option to true.
If a duplicate field is declared in the general configuration, then its value
will be overwritten by the value declared here.</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: cel
  . . .
  fields:
    app_id: query_engine_12</pre>
</div>
<h5><a id="fields-under-root-cel"></a><code class="literal">fields_under_root</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></h5>
<p>If this option is set to true, the custom
<a class="xref" href="filebeat-input-cel.html#filebeat-input-cel-fields" title="fields">fields</a> are stored as top-level fields in
the output document instead of being grouped under a <code class="literal">fields</code> sub-dictionary. If
the custom field names conflict with other field names added by Filebeat,
then the custom fields overwrite the other fields.</p>
<h5><a id="_processors_3"></a><code class="literal">processors</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></h5>
<p>A list of processors to apply to the input data.</p>
<p>See <a class="xref" href="filtering-and-enhancing-data.html" title="Filter and enhance data with processors"><em>Processors</em></a> for information about specifying
processors in your config.</p>
<h5><a id="_pipeline_3"></a><code class="literal">pipeline</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></h5>
<p>The ingest pipeline ID to set for the events generated by this input.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The pipeline ID can also be configured in the Elasticsearch output, but
this option usually results in simpler configuration files. If the pipeline is
configured both in the input and output, the option from the
input is used.</p>
</div>
</div>
<h5><a id="_keep_null_3"></a><code class="literal">keep_null</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></h5>
<p>If this option is set to true, fields with <code class="literal">null</code> values will be published in
the output document. By default, <code class="literal">keep_null</code> is set to <code class="literal">false</code>.</p>
<h5><a id="_index_3"></a><code class="literal">index</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></h5>
<p>If present, this formatted string overrides the index for events from this input
(for elasticsearch outputs), or sets the <code class="literal">raw_index</code> field of the event&#8217;s
metadata (for other outputs). This string can only refer to the agent name and
version and the event timestamp; for access to dynamic fields, use
<code class="literal">output.elasticsearch.index</code> or a processor.</p>
<p>Example value: <code class="literal">"%{[agent.name]}-myindex-%{+yyyy.MM.dd}"</code> might
expand to <code class="literal">"filebeat-myindex-2019.11.01"</code>.</p>
<h5><a id="_publisher_pipeline_disable_host_3"></a><code class="literal">publisher_pipeline.disable_host</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></h5>
<p>By default, all events contain <code class="literal">host.name</code>. This option can be set to <code class="literal">true</code> to
disable the addition of this field to all events. The default value is <code class="literal">false</code>.</p>
</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="filebeat-input-azure-blob-storage.html">« Azure Blob Storage Input</a>
</span>
<span class="next">
<a href="filebeat-input-cloudfoundry.html">Cloud Foundry input »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
