<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>winlog input | Filebeat Reference [master] | Elastic</title>
<meta class="elastic" name="content" content="winlog input | Filebeat Reference [master]">

<link rel="home" href="index.html" title="Filebeat Reference [master]"/>
<link rel="up" href="configuration-filebeat-options.html" title="Configure inputs"/>
<link rel="prev" href="filebeat-input-unix.html" title="Unix input"/>
<link rel="next" href="configuration-filebeat-modules.html" title="Configure modules"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="Filebeat"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Filebeat/Reference/master"/>
<meta name="DC.subject" content="Filebeat"/>
<meta name="DC.identifier" content="master"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles-v1.css" />
  </head>

  <!--© 2015-2025 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div class="page_header">
This documentation contains work-in-progress information for future Elastic Stack and Cloud releases. Use the version selector to view supported release docs. It also contains some Elastic Cloud serverless information. Check out our <a href="https://www.elastic.co/docs/current/serverless">serverless docs</a> for more details.
</div>
<div class="navheader">
<span class="prev">
<a href="filebeat-input-unix.html">« Unix input</a>
</span>
<span class="next">
<a href="configuration-filebeat-modules.html">Configure modules »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Filebeat Reference [master]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="configuring-howto-filebeat.html">Configure Filebeat</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="configuration-filebeat-options.html">Configure inputs</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>winlog input</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/filebeat/docs/inputs/input-winlog.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="filebeat-input-winlog"></a>winlog input</h2><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/filebeat/docs/inputs/input-winlog.asciidoc">edit</a></div>
</div></div></div>

<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in beta and is subject to change. The design and code is less mature than official GA features and is being provided as-is with no warranties. Beta features are not subject to the support SLA of official GA features.</p>
</div>
</div>
<p>Use the <code class="literal">winlog</code> input to read Windows event logs. It reads from one
event log using Windows APIs, filters the events based on user-configured criteria,
then sends the event data to the configured outputs. It watches the event
log so that new event data is sent in a timely manner. The read position for
the event log is persisted to disk to allow the input to resume after
restarts.</p>
<p>The <code class="literal">winlog</code> input can capture event data from any event logs running on your system.
For example, you can capture events such as:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
application events
</li>
<li class="listitem">
hardware events
</li>
<li class="listitem">
security events
</li>
<li class="listitem">
system events
</li>
</ul>
</div>
<p>Here is a sample configuration:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">- type: winlog
  name: Application
  ignore_older: 72h</pre>
</div>
<div class="position-relative"><h3><a id="_configuration_options_22"></a>Configuration options</h3><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/filebeat/docs/inputs/input-winlog.asciidoc">edit</a></div>
<div class="position-relative"><h4><a id="_batch_read_size"></a><code class="literal">batch_read_size</code></h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/filebeat/docs/inputs/input-winlog.asciidoc">edit</a></div>
<p>The maximum number of event log records to read from the Windows API in a single
batch. The default batch size is 100. Most Windows versions return an error if
the value is larger than 1024. <span class="strong strong"><strong>{vista_and_newer}</strong></span></p>
<p>Filebeat starts a goroutine (a lightweight thread) to read from each
individual event log. The goroutine reads a batch of event log records using the
Windows API, applies any processors to the events, publishes them to the
configured outputs, and waits for an acknowledgement from the outputs before
reading additional event log records.</p>
<div class="position-relative"><h4><a id="_name"></a><code class="literal">name</code></h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/filebeat/docs/inputs/input-winlog.asciidoc">edit</a></div>
<p>The name of the event log to monitor. It must
have a <code class="literal">name</code> field, except for those which use a custom XML query.
A channel is a named stream of events that transports events from an event
source to an event log. Most channels are tied to specific event publishers.
You can get a list of available event logs by using the PowerShell
<a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.diagnostics/get-winevent" class="ulink" target="_top"><code class="literal">Get-WinEvent</code></a> cmdlet
on Windows Vista or newer. Here is a sample of the output from the command:</p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">PS C:\&gt; Get-WinEvent -ListLog * | Format-List -Property LogName
LogName : Application
LogName : HardwareEvents
LogName : Internet Explorer
LogName : Key Management Service
LogName : Security
LogName : System
LogName : Windows PowerShell
LogName : ForwardedEvents
LogName : Microsoft-Management-UI/Admin
LogName : Microsoft-Rdms-UI/Admin
LogName : Microsoft-Rdms-UI/Operational
LogName : Microsoft-Windows-Windows Firewall With Advanced Security/Firewall
...</pre>
</div>
<p>If <code class="literal">Get-WinEvent</code> is not available, the <a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.management/get-eventlog" class="ulink" target="_top"><code class="literal">Get-EventLog</code></a> cmdlet can be used in its
place.</p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">PS C:\Users\vagrant&gt; Get-EventLog *

  Max(K) Retain OverflowAction        Entries Log
  ------ ------ --------------        ------- ---
  20,480      0 OverwriteAsNeeded          75 Application
  20,480      0 OverwriteAsNeeded           0 HardwareEvents
     512      7 OverwriteOlder              0 Internet Explorer
  20,480      0 OverwriteAsNeeded           0 Key Management Service
  20,480      0 OverwriteAsNeeded       1,609 Security
  20,480      0 OverwriteAsNeeded       1,184 System
  15,360      0 OverwriteAsNeeded         464 Windows PowerShell</pre>
</div>
<p>You must specify the full name of the channel in the configuration file.</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">- type: winlog
  name: Microsoft-Windows-Windows Firewall With Advanced Security/Firewall</pre>
</div>
<p>To read events from an archived <code class="literal">.evtx</code> file you can specify the <code class="literal">name</code> as the
absolute path (it cannot be relative) to the file.</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">- type: winlog
  name: 'C:\backup\sysmon-2019.08.evtx'
  no_more_events: stop</pre>
</div>
<p>The name key must not be used with custom XML queries.</p>
<div class="position-relative"><h4><a id="_id"></a><code class="literal">id</code></h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/filebeat/docs/inputs/input-winlog.asciidoc">edit</a></div>
<p>A unique identifier for the event log. This key is required when using a custom
XML query.</p>
<p>It is used to uniquely identify the event log reader in the registry file. This is
useful if multiple event logs are being set up to watch the same channel or file. If an
ID is not given, the <code class="literal">name</code> value will be used.</p>
<p>This value must be unique.</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">- type: winlog
  name: Application
  id: application-logs
  ignore_older: 168h</pre>
</div>
<div class="position-relative"><h4><a id="_ignore_older"></a><code class="literal">ignore_older</code></h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/filebeat/docs/inputs/input-winlog.asciidoc">edit</a></div>
<p>If this option is specified, the input filters events that are older than the
specified amount of time. Valid time units are "ns", "us" (or "µs"), "ms", "s",
"m", "h". This option is useful when you are beginning to monitor an event log
that contains older records that you would like to ignore. This field is
optional.</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">- type: winlog
  name: Application
  ignore_older: 168h</pre>
</div>
<div class="position-relative"><h4><a id="_forwarded"></a><code class="literal">forwarded</code></h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/filebeat/docs/inputs/input-winlog.asciidoc">edit</a></div>
<p>A boolean flag to indicate that the log contains only events collected from
remote hosts using the Windows Event Collector. The value defaults to true for
the ForwardedEvents log and false for any other log. <span class="strong strong"><strong>{vista_and_newer}</strong></span></p>
<p>This settings allows Filebeat to optimize reads for forwarded events that are
already rendered. When the value is true Filebeat does not attempt to render
the event using message files from the host computer. The Windows Event
Collector subscription should be configured to use the "RenderedText" format
(this is the default) to ensure that the events are distributed with messages
and descriptions.</p>
<div class="position-relative"><h4><a id="_event_id"></a><code class="literal">event_id</code></h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/filebeat/docs/inputs/input-winlog.asciidoc">edit</a></div>
<p>An allowlist and blocklist of event IDs. The value is a comma-separated list. The
accepted values are single event IDs to include (e.g. 4624), a range of event
IDs to include (e.g. 4700-4800), and single event IDs to exclude (e.g. -4735).
<span class="strong strong"><strong>{vista_and_newer}</strong></span></p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">- type: winlog
  name: Security
  event_id: 4624, 4625, 4700-4800, -4735</pre>
</div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>If you specify more than 22 query conditions (event IDs or event ID ranges), some
versions of Windows will prevent Filebeat from reading the event log due to
limits in the query system. If this occurs a similar warning as shown below will
be logged by Filebeat, and it will continue processing data from other event
logs.</p>
<p><code class="literal">WARN EventLog[Application] Open() error. No events will be read from this
source. The specified query is invalid.</code></p>
<p>In some cases, the limit may be lower than 22 conditions. For instance, using a
mixture of ranges and single event IDs, along with an additional parameter such
as <code class="literal">ignore older</code>, results in a limit of 21 conditions.</p>
<p>If you have more than 22 conditions, you can workaround this Windows limitation
by using a drop_event[drop-event] processor to do the filtering after
Filebeat has received the events from Windows. The filter shown below is
equivalent to <code class="literal">event_id: 903, 1024, 4624</code> but can be expanded beyond 22
event IDs.</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">- type: winlog
  name: Security
  processors:
    - drop_event.when.not.or:
      - equals.winlog.event_id: 903
      - equals.winlog.event_id: 1024
      - equals.winlog.event_id: 4624</pre>
</div>
</div>
</div>
<div class="position-relative"><h4><a id="_language"></a><code class="literal">language</code></h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/filebeat/docs/inputs/input-winlog.asciidoc">edit</a></div>
<p>The language ID the events will be rendered in. The language will be forced regardless
of the system language. A complete list of language IDs can be found
<a href="https://docs.microsoft.com/en-us/openspecs/windows_protocols/ms-lcid/a9eac961-e77d-41a6-90a5-ce1a8b0cdb9c" class="ulink" target="_top">here</a>.
It defaults to <code class="literal">0</code>, which indicates to use the system language.</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">- type: winlog
  name: Security
  event_id: 4624, 4625, 4700-4800, -4735
  language: 0x0409 # en-US</pre>
</div>
<div class="position-relative"><h4><a id="_level"></a><code class="literal">level</code></h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/filebeat/docs/inputs/input-winlog.asciidoc">edit</a></div>
<p>A list of event levels to include. The value is a comma-separated list of
levels. <span class="strong strong"><strong>{vista_and_newer}</strong></span></p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Level</th>
<th align="left" valign="top">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>critical, crit</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>error, err</p></td>
<td align="left" valign="top"><p>2</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>warning, warn</p></td>
<td align="left" valign="top"><p>3</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>information, info</p></td>
<td align="left" valign="top"><p>0 or 4</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>verbose</p></td>
<td align="left" valign="top"><p>5</p></td>
</tr>
</tbody>
</table>
</div>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">- type: winlog
  name: Security
  level: critical, error, warning</pre>
</div>
<div class="position-relative"><h4><a id="_provider_3"></a><code class="literal">provider</code></h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/filebeat/docs/inputs/input-winlog.asciidoc">edit</a></div>
<p>A list of providers (source names) to include. The value is a YAML list.
<span class="strong strong"><strong>{vista_and_newer}</strong></span></p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">- type: winlog
  name: Application
  provider:
    - Application Error
    - Application Hang
    - Windows Error Reporting
    - EMET</pre>
</div>
<p>You can obtain a list of providers associated with a log by using PowerShell.
Here is an example showing the providers associated with the Security log.</p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">PS C:\&gt; (Get-WinEvent -ListLog Security).ProviderNames
DS
LSA
SC Manager
Security
Security Account Manager
ServiceModel 4.0.0.0
Spooler
TCP/IP
VSSAudit
Microsoft-Windows-Security-Auditing
Microsoft-Windows-Eventlog</pre>
</div>
<div class="position-relative"><h4><a id="_xml_query"></a><code class="literal">xml_query</code></h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/filebeat/docs/inputs/input-winlog.asciidoc">edit</a></div>
<p>Provide a custom XML query. This option is mutually exclusive with the <code class="literal">name</code>, <code class="literal">event_id</code>,
<code class="literal">ignore_older</code>, <code class="literal">level</code>, and <code class="literal">provider</code> options. These options should be included in
the XML query directly. Furthermore, an <code class="literal">id</code> must be provided. Custom XML queries
provide more flexibility and advanced options than the simpler query options in Filebeat.
<span class="strong strong"><strong>{vista_and_newer}</strong></span></p>
<p>Here is a configuration which will collect DHCP server events from multiple channels:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">- type: winlog
  id: dhcp-server-logs
  xml_query: &gt;
    &lt;QueryList&gt;
      &lt;Query Id="0" Path="DhcpAdminEvents"&gt;
        &lt;Select Path="DhcpAdminEvents"&gt;*&lt;/Select&gt;
        &lt;Select Path="Microsoft-Windows-Dhcp-Server/FilterNotifications"&gt;*&lt;/Select&gt;
        &lt;Select Path="Microsoft-Windows-Dhcp-Server/Operational"&gt;*&lt;/Select&gt;
      &lt;/Query&gt;
    &lt;/QueryList&gt;</pre>
</div>
<p>XML queries may also be created in Windows Event Viewer using custom views. The query
can be created using a graphical interface and the corresponding XML can be
retrieved from the XML tab.</p>
<div class="position-relative"><h4><a id="_include_xml"></a><code class="literal">include_xml</code></h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/filebeat/docs/inputs/input-winlog.asciidoc">edit</a></div>
<p>Boolean option that controls if the raw XML representation of an event is
included in the data sent by Filebeat. The default is false.
<span class="strong strong"><strong>{vista_and_newer}</strong></span></p>
<p>The XML representation of the event is useful for troubleshooting purposes. The
data in the fields reported by Filebeat can be compared to the data in the XML
to diagnose problems.</p>
<p>Example:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">- type: winlog
  name: Microsoft-Windows-Windows Defender/Operational
  include_xml: true</pre>
</div>
<div class="position-relative"><h4><a id="_tags_27"></a><code class="literal">tags</code></h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/filebeat/docs/inputs/input-winlog.asciidoc">edit</a></div>
<p>A list of tags that the Beat includes in the <code class="literal">tags</code> field of each published
event. Tags make it easy to select specific events in Kibana or apply
conditional filtering in Logstash. These tags will be appended to the list of
tags specified in the general configuration.</p>
<p>Example:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">- type: winlog
  name: CustomLog
  tags: ["web"]</pre>
</div>
<div class="position-relative"><h4><a id="winlog-configuration-fields"></a><code class="literal">fields</code></h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/filebeat/docs/inputs/input-winlog.asciidoc">edit</a></div>
<p>Optional fields that you can specify to add additional information to the
output. For example, you might add fields that you can use for filtering event
data. Fields can be scalar values, arrays, dictionaries, or any nested
combination of these. By default, the fields that you specify here will be
grouped under a <code class="literal">fields</code> sub-dictionary in the output document. To store the
custom fields as top-level fields, set the <code class="literal">fields_under_root</code> option to true.
If a duplicate field is declared in the general configuration, then its value
will be overwritten by the value declared here.</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">- type: winlog
  name: CustomLog
  fields:
    customer_id: 51415432</pre>
</div>
<div class="position-relative"><h4><a id="_fields_under_root"></a><code class="literal">fields_under_root</code></h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/filebeat/docs/inputs/input-winlog.asciidoc">edit</a></div>
<p>If this option is set to true, the custom <a class="xref" href="filebeat-input-winlog.html#winlog-configuration-fields" title="fields">fields</a>
are stored as top-level fields in the output document instead of being grouped
under a <code class="literal">fields</code> sub-dictionary. If the custom field names conflict with other
field names added by Filebeat, then the custom fields overwrite the other
fields.</p>
<div class="position-relative"><h4><a id="_processors_27"></a><code class="literal">processors</code></h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/filebeat/docs/inputs/input-winlog.asciidoc">edit</a></div>
<p>A list of processors to apply to the data generated by the event log.</p>
<p>See <a class="xref" href="filtering-and-enhancing-data.html" title="Filter and enhance data with processors"><em>Processors</em></a> for information about specifying
processors in your config.</p>
<div class="position-relative"><h4><a id="_index_27"></a><code class="literal">index</code></h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/filebeat/docs/inputs/input-winlog.asciidoc">edit</a></div>
<p>If present, this formatted string overrides the index for events from this
event log (for elasticsearch outputs), or sets the <code class="literal">raw_index</code> field of the event&#8217;s
metadata (for other outputs). This string can only refer to the agent name and
version and the event timestamp; for access to dynamic fields, use
<code class="literal">output.elasticsearch.index</code> or a processor.</p>
<p>Example value: <code class="literal">"%{[agent.name]}-myindex-%{+yyyy.MM.dd}"</code> might
expand to <code class="literal">"filebeat-myindex-2019.12.13"</code>.</p>
<div class="position-relative"><h4><a id="_keep_null_27"></a><code class="literal">keep_null</code></h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/filebeat/docs/inputs/input-winlog.asciidoc">edit</a></div>
<p>If this option is set to true, fields with <code class="literal">null</code> values will be published in
the output document. By default, <code class="literal">keep_null</code> is set to <code class="literal">false</code>.</p>
<div class="position-relative"><h4><a id="_no_more_events"></a><code class="literal">no_more_events</code></h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/filebeat/docs/inputs/input-winlog.asciidoc">edit</a></div>
<p>The action that the event log reader should take when it receives a signal from
Windows that there are no more events to read. It can either <code class="literal">wait</code> for more
events to be written (the default behavior) or it can <code class="literal">stop</code>. The overall
Filebeat process will stop when all of the individual event log readers have
stopped. <span class="strong strong"><strong>{vista_and_newer}</strong></span></p>
<p>Setting <code class="literal">no_more_events</code> to <code class="literal">stop</code> is useful when reading from archived event
log files where you want to read the whole file then exit.</p>
<div class="position-relative"><h4><a id="_api"></a><code class="literal">api</code></h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/filebeat/docs/inputs/input-winlog.asciidoc">edit</a></div>
<p>This selects the event log reader implementation that is used to read events
from the Windows APIs. You should only set this option when testing experimental
features. When the value is set to <code class="literal">wineventlog-experimental</code> Filebeat will
replace the default event log reader with the <span class="strong strong"><strong>experimental</strong></span> implementation.
We are evaluating this implementation to see if it can provide increased
performance and reduce CPU usage. <span class="strong strong"><strong>{vista_and_newer}</strong></span></p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">- type: winlog
  name: ForwardedEvents
  api: wineventlog-experimental</pre>
</div>
<p>There are a few notable differences in the events:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Events that contained data under <code class="literal">winlog.user_data</code> will now have it under
<code class="literal">winlog.event_data</code>.
</li>
<li class="listitem">
Setting <code class="literal">include_xml: true</code> has no effect.
</li>
</ul>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="filebeat-input-unix.html">« Unix input</a>
</span>
<span class="next">
<a href="configuration-filebeat-modules.html">Configure modules »</a>
</span>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>

                        <!-- Feedback widget -->
                        <div id="feedbackWidgetContainer"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


        <div id='elastic-footer'></div>
        <script src='https://www.elastic.co/elastic-footer.js'></script>
        <!-- Footer Section end-->

      </section>
    </div>

    <!-- Feedback modal -->
    <div id="feedbackModalContainer"></div>

    <script src="/guide/static/jquery.js"></script>
    <script type="text/javascript" src="/guide/static/docs-v1.js"></script>
    <script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
