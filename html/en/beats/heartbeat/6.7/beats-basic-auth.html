<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Configure authentication credentials
        | Heartbeat Reference [6.7]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Heartbeat Reference [6.7]" /><link rel="up" href="securing-beats.html" title="Configure Heartbeat to use X-Pack security" /><link rel="prev" href="feature-roles.html" title="Heartbeat features that require authorization" /><link rel="next" href="beats-user-access.html" title="Grant users access to Heartbeat indices" /><meta name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta name="DC.type" content="Learn/Docs/Heartbeat/Reference/6.7" /><meta name="DC.subject" content="Heartbeat" /><meta name="DC.identifier" content="6.7" />
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#ffffff">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="description" content="" />
    <meta name="localized" content="true" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <!-- For third-generation iPad with high-resolution Retina display: -->
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <!-- For iPhone with high-resolution Retina display: -->
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <!-- For first- and second-generation iPad: -->
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- css -->
    <script src="/static/js/jquery.min.js"></script>
    <script src="/static/js/bootstrap.min.js"></script>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->
    
    <!-- new ga for staging server -->
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>
    <!-- new ga for staging server -->

    <!-- Elastic APM -->
    <!--
    <script src="https://www.elastic.co/static/js/elastic-apm-js-base.umd.min.2.2.0.js"></script>
    <script type="text/javascript">
      var elasticApm = init({
        serviceName: 'elastic-co-frontend',
        serverUrl: 'https://3ddd1ee09cc242c4b169d36f5a2b8b77.apm.us-west1.gcp.cloud.es.io:443',
        stackTraceLimit: 5,
        serviceVersion: '1.0.0'
      })
    
      var pageLoadName
      var pathname = window.location.pathname.replace(/\/es|\/pt|\/jp|\/pt|\/fr|\/kr|\/cn|\/de/g, '')
      var parts = pathname.split('/');
    
      if (parts.length && parts[1] === 'blog') {
        if (parts.length === 2) {
          pageLoadName =  '/blog';
        }
        else if (parts[2] === 'category') {
          pageLoadName =  '/blog/category';
        }
        else if (parts[2] === 'archive') {
          pageLoadName =  '/blog/archive';
        }
        else {
          pageLoadName =  '/blog/detail';
        }
      }
      else if (parts.length && parts[1] === 'elasticon') {
        if (parts.length === 2) {
          pageLoadName =  '/elasticon';
        }
        else if (parts.length === 5 && (parts[2] === 'conf' || parts[2] === 'tour')) {
          pageLoadName =  '/elasticon/overview';
        }
        else if (parts.length > 5 && (parts[2] === 'conf' || parts[2] === 'tour')) {
          pageLoadName =  '/elasticon/video';
        }
      }
      else if (parts.length && parts[1] === 'guide') {
        pageLoadName =  '/guide';
      }
      else if (parts.length === 2 && parts[1] === 'videos') {
        pageLoadName =  '/videos';
      }
      else if (parts.length > 2 && parts[1] === 'videos') {
        pageLoadName =  '/videos/detail';
      }
      else if (parts.length > 2 && parts[1] === 'webinars') {
        pageLoadName =  '/webinars/detail';
      }
      else {
        pageLoadName =  window.location.pathname;
      }
    
      console.log('apm pageLoadName:', pageLoadName, parts)
      elasticApm.setTags({env:"production"});
      elasticApm.setInitialPageLoadName(pageLoadName);
    </script>
    -->

    <!-- Header Section -->
    
    <div id='elastic-nav'></div>

    <!-- Subnav -->
    <div>
      <div>
        <div class="tertiary-nav d-none d-md-block">
          <div class="container">
            <div class="p-t-b-15 d-flex justify-content-between nav-container">
              <div class="breadcrum-wrapper"><span><a href="/guide/" style="font-size: 14px; font-weight: 600; color: #000;">Docs</a></span></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container">
              <div class="row">
                <div class="col-xs-12 col-sm-8 col-md-8 guide-section">
                  <!-- start body -->
                  <div class="page_header">You are looking at documentation for an older release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Heartbeat Reference
      [6.7]
    </a></span> » <span class="breadcrumb-link"><a href="securing-heartbeat.html">Securing Heartbeat</a></span> » <span class="breadcrumb-link"><a href="securing-beats.html">Configure Heartbeat to use X-Pack security</a></span> » <span class="breadcrumb-node">Configure authentication credentials</span></div><div class="navheader"><span class="prev"><a href="feature-roles.html">
              « 
              Heartbeat features that require authorization</a>
           
        </span><span class="next">
           
          <a href="beats-user-access.html">Grant users access to Heartbeat indices
               »
            </a></span></div><div class="xpack section"><div class="titlepage"><div><div><h2 class="title"><a id="beats-basic-auth"></a>Configure authentication credentials<a href="https://github.com/elastic/beats/edit/6.7/libbeat/docs/security/basic-auth.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2></div></div></div><p>When sending data to a secured cluster through the <code class="literal">elasticsearch</code>
output, Heartbeat must either provide basic authentication credentials
or present a client certificate.</p><p>To configure authentication credentials for Heartbeat:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
Create a writer role that has the following privileges:
</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<span class="strong strong"><strong>Cluster</strong></span>: <code class="literal">manage_index_templates</code> and <code class="literal">monitor</code>
</li><li class="listitem">
<span class="strong strong"><strong>Index</strong></span>: <code class="literal">write</code> and <code class="literal">create_index</code> on the Heartbeat indices
</li></ul></div><p class="simpara">You can create roles from the <span class="strong strong"><strong>Management / Roles</strong></span> UI in Kibana or through the
<code class="literal">role</code> API. For example, the following request creates a role named
<code class="literal">heartbeat_writer</code>:</p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">POST _xpack/security/role/heartbeat_writer
{
  "cluster": ["manage_index_templates","monitor"],
  "indices": [
    {
      "names": [ "heartbeat-*" ], <a id="CO15-1"></a><i class="conum" data-value="1"></i>
      "privileges": ["write","create_index"]
    }
  ]
}</pre></div><div class="console_widget" data-snippet="snippets/beats-basic-auth/1.json"></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO15-1"><i class="conum" data-value="1"></i></a> </p></td><td valign="top" align="left"><p>
If you use a custom Heartbeat index pattern, specify that pattern
instead of the default <code class="literal">heartbeat-*</code> pattern.
</p></td></tr></table></div></li><li class="listitem"><p class="simpara">
If you plan to use <a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/6.7/getting-started-index-lifecycle-management.html" target="_top">index
lifecycle management</a>, create a role that has the following privileges. These
privileges are required to load index lifecycle policies and create and manage
rollover indices:
</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<span class="strong strong"><strong>Cluster:</strong></span> <code class="literal">manage_ilm</code>
</li><li class="listitem"><p class="simpara">
<span class="strong strong"><strong>Index:</strong></span> <code class="literal">write</code>, <code class="literal">create_index</code>, <code class="literal">manage</code>, and <code class="literal">manage_ilm</code> on the
Heartbeat indices
</p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">POST _xpack/security/role/heartbeat_ilm
{
  "cluster": ["manage_ilm"],
  "indices": [
    {
      "names": [ "heartbeat-*","shrink-heartbeat-*"],
      "privileges": ["write","create_index","manage","manage_ilm"]
    }
  ]
}</pre></div><div class="console_widget" data-snippet="snippets/beats-basic-auth/2.json"></div></li></ul></div></li><li class="listitem"><p class="simpara">
Assign the writer role to the user that Heartbeat will use to connect to
Elasticsearch. Make sure you also assign any roles that are required for specific
features. For the list of features and required roles, see <a class="xref" href="feature-roles.html" title="Heartbeat features that require authorization">Heartbeat features that require authorization</a>.
</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
To authenticate as a native user, create a user for Heartbeat to use
internally and assign it the writer role, plus any other roles that are
needed.
</p><p class="simpara">You can create users from the <span class="strong strong"><strong>Management / Users</strong></span> UI in Kibana or through the
<code class="literal">user</code> API. For example, following request creates a user
named <code class="literal">heartbeat_internal</code> that has the
<code class="literal">heartbeat_writer</code> and <code class="literal">kibana_user</code> roles:</p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">POST /_xpack/security/user/heartbeat_internal
{
  "password" : "YOUR_PASSWORD",
  "roles" : [ "heartbeat_writer","kibana_user"],
  "full_name" : "Internal Heartbeat User"
}</pre></div><div class="console_widget" data-snippet="snippets/beats-basic-auth/3.json"></div></li><li class="listitem"><p class="simpara">
To use PKI authentication, assign the writer role, plus any other roles that are
needed, in the <code class="literal">role_mapping.yml</code> configuration file. Specify the user by the
distinguished name that appears in its certificate:
</p><div class="pre_wrapper lang-yaml"><pre class="programlisting prettyprint lang-yaml">heartbeat_writer:
  - "cn=Internal Heartbeat User,ou=example,o=com"
kibana_user:
  - "cn=Internal Heartbeat User,ou=example,o=com"</pre></div><p class="simpara">For more information, see
<a class="ulink" href="https://www.elastic.co/guide/en/elastic-stack-overview/6.7/mapping-roles.html#mapping-roles-file" target="_top">Using Role Mapping Files</a>.</p></li></ol></div></li><li class="listitem"><p class="simpara">
In the Heartbeat configuration file, specify authentication credentials
for the <code class="literal">elasticsearch</code> output:
</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
To use basic authentication, configure the <code class="literal">username</code> and <code class="literal">password</code> settings.
For example, the following Heartbeat output configuration uses the native
<code class="literal">heartbeat_internal</code> user to connect to Elasticsearch:
</p><div class="pre_wrapper lang-js"><pre class="programlisting prettyprint lang-js">output.elasticsearch:
  hosts: ["localhost:9200"]
  username: "heartbeat_internal" <a id="CO16-1"></a><i class="conum" data-value="1"></i>
  password: "YOUR_PASSWORD" <a id="CO16-2"></a><i class="conum" data-value="2"></i></pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO16-1"><i class="conum" data-value="1"></i></a> </p></td><td valign="top" align="left"><p>
You created this user earlier.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO16-2"><i class="conum" data-value="2"></i></a> </p></td><td valign="top" align="left"><p>
The example shows a hard-coded password, but you should store sensitive
values in the <a class="link" href="keystore.html" title="Secrets keystore for secure settings">secrets keystore</a>.
</p></td></tr></table></div></li><li class="listitem"><p class="simpara">
To use PKI authentication, configure the <code class="literal">certificate</code> and <code class="literal">key</code> settings:
</p><div class="pre_wrapper lang-js"><pre class="programlisting prettyprint lang-js">output.elasticsearch:
  hosts: ["localhost:9200"]
  ssl.certificate: "/etc/pki/client/cert.pem" <a id="CO17-1"></a><i class="conum" data-value="1"></i>
  ssl.key: "/etc/pki/client/cert.key"</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO17-1"><i class="conum" data-value="1"></i></a> </p></td><td valign="top" align="left"><p>
The distinguished name (DN) in the certificate must be mapped to
the <code class="literal">heartbeat_writer</code> and <code class="literal">kibana_user</code> roles in the
<code class="literal">role_mapping.yml</code> configuration file on each node in the Elasticsearch cluster.
</p></td></tr></table></div></li></ol></div></li></ol></div></div><div class="navfooter"><span class="prev"><a href="feature-roles.html">
              « 
              Heartbeat features that require authorization</a>
           
        </span><span class="next">
           
          <a href="beats-user-access.html">Grant users access to Heartbeat indices
               »
            </a></span></div>
                  <!-- end body -->
                </div>
                <div class="col-xs-12 col-sm-4 col-md-4" id="right_col">
                  <div id="rtpcontainer" style="display: block;">
                    <div class="mktg-promo">
                      <h3>Getting Started Videos</h3>
                      <ul class="icons">
                        <li class="icon-elasticsearch-white"><a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">Starting Elasticsearch</a></li>
                        <li class="icon-kibana-white"><a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">Introduction to Kibana</a></li>
                        <li class="icon-logstash-white"><a href="https://www.elastic.co/webinars/getting-started-logstash?baymax=default&elektra=docs&storm=top-video">Logstash Starter Guide</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<!-- Footer Section end-->

<script src='https://www.elastic.co/elastic-nav.js'></script>
<script src='https://www.elastic.co/elastic-footer.js'></script>
      </section>
    </div>

    
<script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";
	var localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}';
</script>
<script src="/static/js/swiftype_app_search.umd.min.js"></script>
<script type="text/javascript" src="/static/js/slick.min.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>

<script type="text/javascript">
window.initial_state = {}</script>
  </body>
</html>
