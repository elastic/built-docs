<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Set up Heartbeat monitors | Heartbeat Reference [7.2] | Elastic</title>
<link rel="home" href="index.html" title="Heartbeat Reference [7.2]"/>
<link rel="up" href="configuring-howto-heartbeat.html" title="Configuring Heartbeat"/>
<link rel="prev" href="configuring-howto-heartbeat.html" title="Configuring Heartbeat"/>
<link rel="next" href="configuration-general-options.html" title="Specify general settings"/>
<meta name="DC.type" content="Learn/Docs/Heartbeat/Reference/7.2"/>
<meta name="DC.subject" content="Heartbeat"/>
<meta name="DC.identifier" content="7.2"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!--BEGIN QUALTRICS WEBSITE FEEDBACK SNIPPET-->
    <script type='text/javascript'>
      (function(){var g=function(e,h,f,g){
      this.get=function(a){for(var a=a+"=",c=document.cookie.split(";"),b=0,e=c.length;b<e;b++){for(var d=c[b];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return null};
      this.set=function(a,c){var b="",b=new Date;b.setTime(b.getTime()+6048E5);b="; expires="+b.toGMTString();document.cookie=a+"="+c+b+"; path=/; "};
      this.check=function(){var a=this.get(f);if(a)a=a.split(":");else if(100!=e)"v"==h&&(e=Math.random()>=e/100?0:100),a=[h,e,0],this.set(f,a.join(":"));else return!0;var c=a[1];if(100==c)return!0;switch(a[0]){case "v":return!1;case "r":return c=a[2]%Math.floor(100/c),a[2]++,this.set(f,a.join(":")),!c}return!0};
      this.go=function(){if(this.check()){var a=document.createElement("script");a.type="text/javascript";a.src=g;document.body&&document.body.appendChild(a)}};
      this.start=function(){var a=this;window.addEventListener?window.addEventListener("load",function(){a.go()},!1):window.attachEvent&&window.attachEvent("onload",function(){a.go()})}};
      try{(new g(100,"r","QSI_S_ZN_emkP0oSe9Qrn7kF","https://znemkp0ose9qrn7kf-elastic.siteintercept.qualtrics.com/WRSiteInterceptEngine/?Q_ZID=ZN_emkP0oSe9Qrn7kF")).start()}catch(i){}})();
    </script><div id='ZN_emkP0oSe9Qrn7kF'><!--DO NOT REMOVE-CONTENTS PLACED HERE--></div>
    <!--END WEBSITE FEEDBACK SNIPPET-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <!-- Subnav -->
    <div>
      <div>
        <div class="tertiary-nav d-none d-md-block">
          <div class="container">
            <div class="p-t-b-15 d-flex justify-content-between nav-container">
              <div class="breadcrum-wrapper"><span><a href="/guide/" style="font-size: 14px; font-weight: 600; color: #000;">Docs</a></span></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container">
              <div class="row">
                <div class="col-xs-12 col-sm-8 col-md-8 guide-section">
                  <!-- start body -->
                  <div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Heartbeat Reference [7.2]</a></span>
»
<span class="breadcrumb-link"><a href="configuring-howto-heartbeat.html">Configuring Heartbeat</a></span>
»
<span class="breadcrumb-node">Set up Heartbeat monitors</span>
</div>
<div class="navheader">
<span class="prev">
<a href="configuring-howto-heartbeat.html">« Configuring Heartbeat</a>
</span>
<span class="next">
<a href="configuration-general-options.html">Specify general settings »</a>
</span>
</div>
<div class="chapter">
<div class="titlepage"><div><div>
<h2 class="title"><a id="configuration-heartbeat-options"></a>Set up Heartbeat monitors<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.2/heartbeat/docs/heartbeat-options.asciidoc">edit</a></h2>
</div></div></div>

<p>To configure Heartbeat define a set of <code class="literal">monitors</code> to check your remote hosts.
Specify monitors either directly inside the <code class="literal">heartbeat.yml</code> config file, or in external
dynamically loaded files located in the directory referenced by <code class="literal">heartbeat.config.monitors.path</code>.
One advantage of using external files is that these can be automatically reloaded
without stopping the Heartbeat process.</p>
<p>Each <code class="literal">monitor</code> item is an entry in a yaml list, and so begins with a dash (-).
You can define the type of monitor to use, the hosts to check, and other
optional settings that control Heartbeat behavior.</p>
<p>The following example configures three monitors checking via the <code class="literal">icmp</code>, <code class="literal">tcp</code>, and <code class="literal">http</code>
protocols directly inside the <code class="literal">heartbeat.yml</code> file, and demonstrates how to use TCP Echo
and HTTP response verification:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml"># heartbeat.yml
heartbeat.monitors:
- type: icmp
  schedule: '*/5 * * * * * *'
  hosts: ["myhost"]
- type: tcp
  schedule: '@every 5s'
  hosts: ["myhost:7"]  # default TCP Echo Protocol
  check.send: "Check"
  check.receive: "Check"
- type: http
  schedule: '@every 5s'
  urls: ["http://localhost:80/service/status"]
  check.response.status: 200
heartbeat.scheduler:
  limit: 10</pre>
</div>
<p>Using the <code class="literal">heartbeat.yml</code> configuration file is convenient, but has two drawbacks:
it can become hard to manage with large numbers of monitors, and it will not reload
heartbeat automatically when its contents changes.</p>
<p>Define monitors via the <code class="literal">heartbeat.config.monitors</code> to prevent those issues from
happening to you. To do so you would instead have your <code class="literal">heartbeat.yml</code> file contain the following:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml"># heartbeat.yml
heartbeat.config.monitors:
  # Directory + glob pattern to search for configuration files
  path: /path/to/my/monitors.d/*.yml
  # If enabled, heartbeat will periodically check the config.monitors path for changes
  reload.enabled: true
  # How often to check for changes
  reload.period: 1s</pre>
</div>
<p>Then, define one or more files in the directory pointed to by <code class="literal">heartbeat.config.monitors.path</code>.
You may specify multiple monitors in a given file if you like. The contents of these files is
monitor definitions only, e.g. what is normally under the <code class="literal">heartbeat.monitors</code> section of
<code class="literal">heartbeat.yml</code>. See below for an example</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml"># /path/to/my/monitors.d/localhost_service_check.yml
- type: http
  schedule: '@every 5s'
  urls: ["http://localhost:80/service/status"]
  check.response.status: 200</pre>
</div>
<h3><a id="monitor-options"></a>Monitor options<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.2/heartbeat/docs/heartbeat-options.asciidoc">edit</a></h3>
<p>You can specify the following options when defining a Heartbeat monitor in any location.
These options are the same for all monitors. Each monitor type has additional configuration
options that are specific to that monitor type.</p>
<h4><a id="monitor-type"></a><code class="literal">type</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.2/heartbeat/docs/heartbeat-options.asciidoc">edit</a></h4>
<p>The type of monitor to run. One of:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">icmp</code>: Uses an ICMP (v4 and v6) Echo Request to ping the configured hosts.
Requires root access. See <a class="xref" href="configuration-heartbeat-options.html#monitor-icmp-options" title="ICMP options">ICMP options</a>.
</li>
<li class="listitem">
<code class="literal">tcp</code>: Connects via TCP and optionally verifies the endpoint by sending and/or
receiving a custom payload. See <a class="xref" href="configuration-heartbeat-options.html#monitor-tcp-options" title="TCP options">TCP options</a>.
</li>
<li class="listitem">
<code class="literal">http</code>: Connects via HTTP and optionally verifies that the host returns the
expected response. See <a class="xref" href="configuration-heartbeat-options.html#monitor-http-options" title="HTTP options">HTTP options</a>.
</li>
</ul>
</div>
<p>The <code class="literal">tcp</code> and <code class="literal">http</code> monitor types both support SSL/TLS and some proxy
settings.</p>
<h4><a id="monitor-id"></a><code class="literal">id</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.2/heartbeat/docs/heartbeat-options.asciidoc">edit</a></h4>
<p>A unique identifier for this configuration. This should not change with edits to the monitor configuration
regardless of changes to any config fields. Examples: <code class="literal">uploader-service</code>, <code class="literal">http://example.net</code>, <code class="literal">us-west-loadbalancer</code>. Note that this uniqueness is only within a given beat instance. If you want to monitor the same endpoint from multiple locations it is recommended that those heartbeat instances use the same IDs so that their results can be correlated. You can use the <code class="literal">host.geo.name</code> property to disambiguate them.</p>
<p>When querying against indexed monitor data this is the field you will be aggregating with. Appears in the
<a class="xref" href="exported-fields.html" title="Exported fields">exported fields</a> as <code class="literal">monitor.id</code>.</p>
<p>If you do not set this explicitly the monitor&#8217;s config will be hashed and a generated value used. This value will
change with any options change to this monitor making aggregations over time between changes impossible. For this reason
it is recommended that you set this manually.</p>
<h4><a id="monitor-name"></a><code class="literal">name</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.2/heartbeat/docs/heartbeat-options.asciidoc">edit</a></h4>
<p>Optional human readable name for this monitor. This value appears in the <a class="xref" href="exported-fields.html" title="Exported fields">exported fields</a>
as <code class="literal">monitor.name</code>.</p>
<h4><a id="monitor-enabled"></a><code class="literal">enabled</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.2/heartbeat/docs/heartbeat-options.asciidoc">edit</a></h4>
<p>A Boolean value that specifies whether the module is enabled. If the <code class="literal">enabled</code>
option is missing from the configuration block, the module is enabled by
default.</p>
<h4><a id="monitor-schedule"></a><code class="literal">schedule</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.2/heartbeat/docs/heartbeat-options.asciidoc">edit</a></h4>
<p>A cron-like expression that specifies the task schedule. For example:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">*/5 * * * * * *</code> runs the task every 5 seconds (for example, at 10:00:00,
10:00:05, and so on).
</li>
<li class="listitem">
<code class="literal">@every 5s</code> runs the task every 5 seconds from the time when Heartbeat was
started.
</li>
</ul>
</div>
<p>The <code class="literal">schedule</code> option uses a cron-like syntax based on <a href="https://github.com/gorhill/cronexpr#implementation" class="ulink" target="_top">this <code class="literal">cronexpr</code> implementation</a>,
but adds the <code class="literal">@every</code> keyword.</p>
<h4><a id="monitor-ipv4"></a><code class="literal">ipv4</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.2/heartbeat/docs/heartbeat-options.asciidoc">edit</a></h4>
<p>A Boolean value that specifies whether to ping using the ipv4 protocol if
hostnames are configured. The default is <code class="literal">true</code>.</p>
<h4><a id="monitor-ipv6"></a><code class="literal">ipv6</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.2/heartbeat/docs/heartbeat-options.asciidoc">edit</a></h4>
<p>A Boolean value that specifies whether to ping using the ipv6 protocol
if hostnames are configured. The default is <code class="literal">true</code>.</p>
<h4><a id="monitor-mode"></a><code class="literal">mode</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.2/heartbeat/docs/heartbeat-options.asciidoc">edit</a></h4>
<p>If <code class="literal">mode</code> is <code class="literal">any</code>, the monitor pings only one IP address for a hostname. If
<code class="literal">mode</code> is <code class="literal">all</code>, the monitor pings all resolvable IPs for a hostname. The
<code class="literal">mode: all</code> setting is useful if you are using a DNS-load balancer and want to
ping every IP address for the specified hostname. The default is <code class="literal">any</code>.</p>
<h4><a id="monitor-timeout"></a><code class="literal">timeout</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.2/heartbeat/docs/heartbeat-options.asciidoc">edit</a></h4>
<p>The total running time for each ping test. This is the total time allowed for
testing the connection and exchanging data. The default is 16 seconds (16s).</p>
<p>If the timeout is exceeded, Heartbeat publishes a <code class="literal">service-down</code> event. If the
value specified for <code class="literal">timeout</code> is greater than <code class="literal">schedule</code>, intermediate checks
will not be executed by the scheduler.</p>
<h4><a id="monitor-fields"></a><code class="literal">fields</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.2/heartbeat/docs/heartbeat-options.asciidoc">edit</a></h4>
<p>Optional fields that you can specify to add additional information to the
output. For example, you might add fields that you can use for filtering log
data. Fields can be scalar values, arrays, dictionaries, or any nested
combination of these. By default, the fields that you specify here will be
grouped under a <code class="literal">fields</code> sub-dictionary in the output document. To store the
custom fields as top-level fields, set the <code class="literal">fields_under_root</code> option to true.
If a duplicate field is declared in the general configuration, then its value
will be overwritten by the value declared here.</p>
<h4><a id="monitor-fields-under-root"></a><code class="literal">fields_under_root</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.2/heartbeat/docs/heartbeat-options.asciidoc">edit</a></h4>
<p>If this option is set to true, the custom <a class="xref" href="configuration-heartbeat-options.html#monitor-fields" title="fields">fields</a>
are stored as top-level fields in the output document instead of being grouped
under a <code class="literal">fields</code> sub-dictionary. If the custom field names conflict with other
field names added by Heartbeat, then the custom fields overwrite the other
fields.</p>
<h4><a id="monitor-tags"></a><code class="literal">tags</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.2/heartbeat/docs/heartbeat-options.asciidoc">edit</a></h4>
<p>A list of tags that will be sent with the monitor event. This setting is optional.</p>
<h4><a id="monitor-processors"></a><code class="literal">processors</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.2/heartbeat/docs/heartbeat-options.asciidoc">edit</a></h4>
<p>A list of processors to apply to the data generated by the monitor.</p>
<p>See <a class="xref" href="filtering-and-enhancing-data.html" title="Filter and Enhance the exported data"><em>Filter and Enhance the exported data</em></a> for information about specifying
processors in your config.</p>
<h3><a id="monitor-icmp-options"></a>ICMP options<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.2/heartbeat/docs/heartbeat-options.asciidoc">edit</a></h3>
<p>These options configure Heartbeat to use ICMP (v4 and v6) Echo Requests to check
the configured hosts. These options are valid when the <a class="xref" href="configuration-heartbeat-options.html#monitor-type" title="type"><code class="literal">type</code></a> is
<code class="literal">icmp</code>.</p>
<h4><a id="monitor-icmp-hosts"></a><code class="literal">hosts</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.2/heartbeat/docs/heartbeat-options.asciidoc">edit</a></h4>
<p>A list of hosts to ping.</p>
<h4><a id="monitor-icmp-wait"></a><code class="literal">wait</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.2/heartbeat/docs/heartbeat-options.asciidoc">edit</a></h4>
<p>The duration to wait before emitting another ICMP Echo Request. The default is 1
second (1s).</p>
<h3><a id="monitor-tcp-options"></a>TCP options<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.2/heartbeat/docs/heartbeat-options.asciidoc">edit</a></h3>
<p>These options configure Heartbeat to connect via TCP and optionally verify the
endpoint by sending and/or receiving a custom payload. These options are valid when
the <a class="xref" href="configuration-heartbeat-options.html#monitor-type" title="type"><code class="literal">type</code></a> is <code class="literal">tcp</code>.</p>
<h4><a id="monitor-tcp-hosts"></a><code class="literal">hosts</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.2/heartbeat/docs/heartbeat-options.asciidoc">edit</a></h4>
<p>A list of hosts to ping. The entries in the list can be:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
A plain host name, such as <code class="literal">localhost</code>, or an IP address. If you specify this
option, you must also specify a value for <a class="xref" href="configuration-heartbeat-options.html#monitor-tcp-ports" title="ports"><code class="literal">ports</code></a>.  If the
monitor is <a class="xref" href="configuration-ssl.html" title="Specify SSL settings">configured to use SSL</a>, Heartbeat establishes an
SSL/TLS-based connection. Otherwise, it establishes a plain TCP connection.
</li>
<li class="listitem">
A hostname and port, such as <code class="literal">localhost:12345</code>. Heartbeat connects
to the port on the specified host. If the monitor is
<a class="xref" href="configuration-ssl.html" title="Specify SSL settings">configured to use SSL</a>, Heartbeat establishes an
SSL/TLS-based connection. Otherwise, it establishes a TCP connection.
</li>
<li class="listitem">
<p>A full URL using the syntax <code class="literal">scheme://&lt;host&gt;:[port]</code>, where:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">scheme</code> is one of <code class="literal">tcp</code>, <code class="literal">plain</code>, <code class="literal">ssl</code> or <code class="literal">tls</code>. If <code class="literal">tcp</code> or <code class="literal">plain</code> is
specified, Heartbeat establishes a TCP connection even if the monitor is
configured to use SSL. If <code class="literal">tls</code> or <code class="literal">ssl</code> is specified, Heartbeat establishes
an SSL connection. However, if the monitor is not configured to use SSL, the
system defaults are used (currently not supported on Windows).
</li>
<li class="listitem">
<code class="literal">host</code> is the hostname.
</li>
<li class="listitem">
<code class="literal">port</code> is the port number. If <code class="literal">port</code> is missing in the URL, the
<a class="xref" href="configuration-heartbeat-options.html#monitor-tcp-ports" title="ports"><code class="literal">ports</code></a> setting is required.
</li>
</ul>
</div>
</li>
</ul>
</div>
<h4><a id="monitor-tcp-ports"></a><code class="literal">ports</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.2/heartbeat/docs/heartbeat-options.asciidoc">edit</a></h4>
<p>A list of ports to ping if the host specified in <a class="xref" href="configuration-heartbeat-options.html#monitor-tcp-hosts" title="hosts"><code class="literal">hosts</code></a>
does not contain a port number.</p>
<p>Example configuration:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">- type: tcp
  schedule: '@every 5s'
  hosts: ["myhost"]
  ports: [80, 9200, 5044]</pre>
</div>
<h4><a id="monitor-tcp-check"></a><code class="literal">check</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.2/heartbeat/docs/heartbeat-options.asciidoc">edit</a></h4>
<p>An optional payload string to send to the remote host and the expected answer.
If no payload is specified, the endpoint is assumed to be available if the
connection attempt was successful. If <code class="literal">send</code> is specified without <code class="literal">receive</code>,
any response is accepted as OK. If <code class="literal">receive</code> is specified without <code class="literal">send</code>, no
payload is sent, but the client expects to receive a payload in the form of a
"hello message" or "banner" on connect.</p>
<p>Example configuration:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">- type: tcp
  schedule: '@every 5s'
  hosts: ["myhost"]
  ports: [7]
  check.send: 'Hello World'
  check.receive: 'Hello World'</pre>
</div>
<h4><a id="monitor-tcp-proxy-url"></a><code class="literal">proxy_url</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.2/heartbeat/docs/heartbeat-options.asciidoc">edit</a></h4>
<p>The URL of the SOCKS5 proxy to use when connecting to the server. The value
must be a URL with a scheme of socks5://.</p>
<p>If the SOCKS5 proxy server requires client authentication, then a username and
password can be embedded in the URL as shown in the example.</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">  proxy_url: socks5://user:password@socks5-proxy:2233</pre>
</div>
<p>When using a proxy, hostnames are resolved on the proxy server instead of on
the client. You can change this behavior by setting the
<code class="literal">proxy_use_local_resolver</code> option.</p>
<h4><a id="monitor-tcp-proxy-use-local-resolver"></a><code class="literal">proxy_use_local_resolver</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.2/heartbeat/docs/heartbeat-options.asciidoc">edit</a></h4>
<p>A Boolean value that determines whether hostnames are resolved locally instead
of being resolved on the proxy server. The default value is false, which means
that name resolution occurs on the proxy server.</p>
<h4><a id="monitor-tcp-tls-ssl"></a><code class="literal">ssl</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.2/heartbeat/docs/heartbeat-options.asciidoc">edit</a></h4>
<p>The TLS/SSL connection settings.  If the monitor is
<a class="xref" href="configuration-ssl.html" title="Specify SSL settings">configured to use SSL</a>, it will attempt an SSL
handshake. If <code class="literal">check</code> is not configured, the monitor will only check to see if
it can establish an SSL/TLS connection. This check can fail either at TCP level
or during certificate validation.</p>
<p>Example configuration:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">- type: tcp
  schedule: '@every 5s'
  hosts: ["myhost"]
  ports: [80, 9200, 5044]
  ssl:
    certificate_authorities: ['/etc/ca.crt']
    supported_protocols: ["TLSv1.0", "TLSv1.1", "TLSv1.2"]</pre>
</div>
<p>Also see <a class="xref" href="configuration-ssl.html" title="Specify SSL settings"><em>Specify SSL settings</em></a> for a full description of the <code class="literal">ssl</code> options.</p>
<h3><a id="monitor-http-options"></a>HTTP options<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.2/heartbeat/docs/heartbeat-options.asciidoc">edit</a></h3>
<p>These options configure Heartbeat to connect via HTTP and optionally verify that
the host returns the expected response. These options are valid when the
<a class="xref" href="configuration-heartbeat-options.html#monitor-type" title="type"><code class="literal">type</code></a> is <code class="literal">http</code>.</p>
<h4><a id="monitor-http-urls"></a><code class="literal">urls</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.2/heartbeat/docs/heartbeat-options.asciidoc">edit</a></h4>
<p>A list of URLs to ping.</p>
<p>Example configuration:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">- type: http
  schedule: '@every 5s'
  urls: ["http://myhost:80"]</pre>
</div>
<h4><a id="monitor-http-proxy-url"></a><code class="literal">proxy_url</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.2/heartbeat/docs/heartbeat-options.asciidoc">edit</a></h4>
<p>The HTTP proxy URL. This setting is optional.</p>
<h4><a id="monitor-http-max-redirects"></a><code class="literal">max_redirects</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.2/heartbeat/docs/heartbeat-options.asciidoc">edit</a></h4>
<p>The total number of redirections Heartbeat will follow.
If you set it to 0 (zero), Heartbeat will receive the redirect response and not follow it.</p>
<p>For example, you can check for a 302 response (<code class="literal">check.response.status: 302</code>) if you set <code class="literal">max_redirects: 0</code></p>
<h4><a id="monitor-http-username"></a><code class="literal">username</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.2/heartbeat/docs/heartbeat-options.asciidoc">edit</a></h4>
<p>The username for authenticating with the server. The credentials are passed
with the request. This setting is optional.</p>
<p>You need to specify credentials when your <code class="literal">check.response</code> settings require it.
For example, you can check for a 403 response (<code class="literal">check.response.status: 403</code>)
without setting credentials.</p>
<h4><a id="monitor-http-password"></a><code class="literal">password</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.2/heartbeat/docs/heartbeat-options.asciidoc">edit</a></h4>
<p>The password for authenticating with the server. This setting is optional.</p>
<h4><a id="monitor-http-tls-ssl"></a><code class="literal">ssl</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.2/heartbeat/docs/heartbeat-options.asciidoc">edit</a></h4>
<p>The TLS/SSL connection settings for use with the HTTPS endpoint. If you don&#8217;t
specify settings, the system defaults are used.</p>
<p>Example configuration:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">- type: http
  schedule: '@every 5s'
  urls: ["https://myhost:443"]
  ssl:
    certificate_authorities: ['/etc/ca.crt']
    supported_protocols: ["TLSv1.0", "TLSv1.1", "TLSv1.2"]</pre>
</div>
<p>Also see <a class="xref" href="configuration-ssl.html" title="Specify SSL settings"><em>Specify SSL settings</em></a> for a full description of the <code class="literal">ssl</code> options.</p>
<h4><a id="monitor-http-check"></a><code class="literal">check</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.2/heartbeat/docs/heartbeat-options.asciidoc">edit</a></h4>
<p>An optional <code class="literal">request</code> to send to the remote host and the expected <code class="literal">response</code>.</p>
<p>Example configuration:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">- type: http
  schedule: '@every 5s'
  urls: ["http://myhost:80"]
  check.request.method: HEAD
  check.response.status: 200</pre>
</div>
<p>Under <code class="literal">check.request</code>, specify these options:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">method</code></strong></span>
</span>
</dt>
<dd>
The HTTP method to use. Valid values are <code class="literal">"HEAD"</code>, <code class="literal">"GET"</code> and
<code class="literal">"POST"</code>.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">headers</code></strong></span>
</span>
</dt>
<dd>
A dictionary of additional HTTP headers to send.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">body</code></strong></span>
</span>
</dt>
<dd>
Optional request body content.
</dd>
</dl>
</div>
<p>Under <code class="literal">check.response</code>, specify these options:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">status</code></strong></span>
</span>
</dt>
<dd>
The expected status code. 4xx and 5xx codes are considered <code class="literal">down</code> by default. Other codes are considered <code class="literal">up</code>.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">headers</code></strong></span>
</span>
</dt>
<dd>
The required response headers.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">body</code></strong></span>
</span>
</dt>
<dd>
A list of regular expressions to match the the body output. Only a single expression needs to match.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">json</code></strong></span>
</span>
</dt>
<dd>
A list of <a class="xref" href="defining-processors.html#conditions" title="Conditions">condition</a> expressions executed against the body when parsed as JSON.
</dd>
</dl>
</div>
<p>The following configuration shows how to check the response when the body
contains JSON:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">- type: http
  schedule: '@every 5s'
  urls: ["https://myhost:80"]
  check.request:
    method: GET
    headers:
      'X-API-Key': '12345-mykey-67890'
  check.response:
    status: 200
    json:
      - description: check status
        condition:
          equals:
            status: ok</pre>
</div>
<p>The following configuration shows how to check the response for multiple regex
patterns:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">- type: http
  schedule: '@every 5s'
  urls: ["https://myhost:80"]
  check.request:
    method: GET
    headers:
      'X-API-Key': '12345-mykey-67890'
  check.response:
    status: 200
    body:
      - hello
      - world</pre>
</div>
<p>The following configuration shows how to check the response with a multiline
regex:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">- type: http
  schedule: '@every 5s'
  urls: ["https://myhost:80"]
  check.request:
    method: GET
    headers:
      'X-API-Key': '12345-mykey-67890'
  check.response:
    status: 200
    body: '(?s)first.*second.*third'</pre>
</div>
<h3><a id="monitors-scheduler"></a>Scheduler options<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.2/heartbeat/docs/heartbeat-options.asciidoc">edit</a></h3>
<p>You specify options under <code class="literal">heartbeat.scheduler</code> to control the behavior of the task
scheduler.</p>
<p>Example configuration:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">heartbeat.scheduler:
  limit: 10
  location: 'UTC-08:00'</pre>
</div>
<p>In the example, setting <code class="literal">limit</code> to 10 guarantees that only 10 concurrent
I/O tasks will be active. An I/O task can be the actual check or resolving an
address via DNS.</p>
<h4><a id="heartbeat-scheduler-limit"></a><code class="literal">limit</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.2/heartbeat/docs/heartbeat-options.asciidoc">edit</a></h4>
<p>The number of concurrent I/O tasks that Heartbeat is allowed to execute. If set
to 0, there is no limit. The default is 0.</p>
<p>Most operating systems set a file descriptor limit of 1024. For Heartbeat to
operate correctly and not accidentally block libbeat output, the value that you
specify for <code class="literal">limit</code> should be below the configured ulimit.</p>
<h4><a id="heartbeat-scheduler-location"></a><code class="literal">location</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.2/heartbeat/docs/heartbeat-options.asciidoc">edit</a></h4>
<p>The timezone for the scheduler. By default the scheduler uses localtime.</p>
<h4><a id="monitor-watch-poll-file"></a><code class="literal">watch.poll_file</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.2/heartbeat/docs/heartbeat-options.asciidoc">edit</a></h4>
<p><span class="Admonishment Admonishment--change">
[<span class="Admonishment-version u-mono u-strikethrough">6.5.0</span>]
<span class="Admonishment-detail">
Deprecated in 6.5.0. Replaced by using dynamic reloading via the <code class="literal">heartbeat.config.monitors</code> option.
</span>
</span></p>
<p>The JSON file to watch for additional monitor configurations. The JSON file can
contain multiple objects, each of which specifies a different monitor config.
Heartbeat checks this file periodically and starts a new monitor instance for
each new JSON object added to the file. For example, imagine that you add
10 new entries to the JSON file, each for a different hostname. When Heartbeat
picks up the changes in the file, it merges the original config
(<code class="literal">heartbeat.yml</code>) plus the JSON objects, and starts a monitor for each new host
that you&#8217;ve configured. If you delete an object from the JSON file and it
doesn&#8217;t exist in the main config, Heartbeat stops the monitor instance running
for that object.</p>
<p>Each monitor has a unique ID that&#8217;s based on parameters like protocol, host,
and port. If two monitors have the same ID, Heartbeat uses the settings that
are defined in the last JSON object of the merged config. This means that
you can specify settings in the JSON file that overwrite the settings in
the main config. In this way, the configuration that you specify for the
monitor in the main Heartbeat config file acts like a default config that you
can live-reconfigure by specifying additional configurations in the external
JSON file.</p>
<p>Example configuration:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">heartbeat.monitors:
- type: tcp
  schedule: '*/5 * * * * * *'
  hosts: ["myhost"]
  watch.poll_file:
    path: {path.config}/monitors/dynamic.json
    interval: 5s</pre>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">path</code></strong></span>
</span>
</dt>
<dd>
Specifies the path to the JSON file to check for updates.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">interval</code></strong></span>
</span>
</dt>
<dd>
Specifies how often Heartbeat checks the file for changes.
</dd>
</dl>
</div>
<p>To reconfigure the settings specified in the example config, you could define
the following JSON objects in <code class="literal">dynamic.json</code>:</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{"hosts": ["myhost:1234"], "schedule": "*/15 * * * * * *"} <a id="CO8-1"></a><i class="conum" data-value="1"></i>
{"hosts": ["tls://otherhost:479"], "ssl.certificate_authorities": ["path/to/ca/file.pem"]} <a id="CO8-2"></a><i class="conum" data-value="2"></i></pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO8-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Upon detecting the changes, Heartbeat stops the old monitor and then
restarts it with a schedule of 15 seconds between checks.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO8-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>Heartbeat starts a new monitor that uses a TLS-based connection with a
custom CA certificate.</p>
</td>
</tr>
</table>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="configuring-howto-heartbeat.html">« Configuring Heartbeat</a>
</span>
<span class="next">
<a href="configuration-general-options.html">Specify general settings »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>
                <div class="col-xs-12 col-sm-4 col-md-4" id="right_col">
                  <div id="rtpcontainer" style="display: block;">
                    <div class="mktg-promo">
                      <h3>Most Popular</h3>
                      <ul class="icons">
                        <li class="icon-elasticsearch-white"><a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">Get Started with Elasticsearch: Video</a></li>
                        <li class="icon-kibana-white"><a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">Intro to Kibana: Video</a></li>
                        <li class="icon-logstash-white"><a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">ELK for Logs & Metrics: Video</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";
	var localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}';
</script>
<script src="/static/js/swiftype_app_search.umd.min.js"></script>
<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
