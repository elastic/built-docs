<!DOCTYPE html>
<html lang="en-us">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Upgrade from 6.x to 7.x
        | Beats Platform Reference [7.2]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Beats Platform Reference [7.2]" /><link rel="up" href="upgrading.html" title="Upgrading" /><link rel="prev" href="upgrading-minor-versions.html" title="Upgrade between minor versions" /><link rel="next" href="troubleshooting-upgrade.html" title="Troubleshooting Beats upgrade issues" /><meta name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta name="DC.type" content="Learn/Docs/Libbeat/Reference/7.2" /><meta name="DC.subject" content="libbeat" /><meta name="DC.identifier" content="7.2" />
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#ffffff">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <!-- DC tags section -->
    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" >
    <link rel="schema.DCTERMS" href="http://purl.org/dc/terms/" >
    
    <!-- end DC tags -->
    <meta name="description" content="" />
    <meta name="localized" content="true" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <!-- For third-generation iPad with high-resolution Retina display: -->
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <!-- For iPhone with high-resolution Retina display: -->
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <!-- For first- and second-generation iPad: -->
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- css -->
    <link href="/static/css/main.css" rel="stylesheet">
    <script src="/static/js/jquery.min.js"></script>
    <script src="/static/js/bootstrap.min.js"></script>
    <script src="/static/js/jquery.cookie.js"></script>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <script type="text/javascript">
      // -------------------- set language based on browser language --------------------
      var lang = '/'+(navigator.language || navigator.userLanguage).slice(0,2)+'/',
      locales = {
        '/en':'/',
        '/de/': '/de/',
        '/fr/': '/fr/',
        '/ja/':'/jp/',
        '/ko/':'/kr/',
        '/zh/':'/cn/',
        '/es/': '/es/'
      },
      localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}',
      currentlocale = JSON.parse(localeUrl).relative_url_prefix;

      if($.cookie("is_lang_detected") == undefined){
        if(locales[lang] != undefined && locales[lang] != currentlocale){
          locale_lang_url = locales[lang] + window.location.pathname.slice(1,window.location.pathname.length);
          $.cookie("is_lang_detected",true ,{ path: '/'});
          window.location = locale_lang_url;
        }
      }
            
      // --------------------- end of set language based on browser language -----------------
    </script>
    <link type="text/css" rel="stylesheet" href="/static/css/guide.css" />
  
<link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />

</head>

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->
    
    <!-- new ga for staging server -->
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>
    <!-- new ga for staging server -->

    <!-- Elastic APM -->
    <!--
    <script src="https://www.elastic.co/static/js/elastic-apm-js-base.umd.min.2.2.0.js"></script>
    <script type="text/javascript">
      var elasticApm = init({
        serviceName: 'elastic-co-frontend',
        serverUrl: 'https://3ddd1ee09cc242c4b169d36f5a2b8b77.apm.us-west1.gcp.cloud.es.io:443',
        stackTraceLimit: 5,
        serviceVersion: '1.0.0'
      })
    
      var pageLoadName
      var pathname = window.location.pathname.replace(/\/es|\/pt|\/jp|\/pt|\/fr|\/kr|\/cn|\/de/g, '')
      var parts = pathname.split('/');
    
      if (parts.length && parts[1] === 'blog') {
        if (parts.length === 2) {
          pageLoadName =  '/blog';
        }
        else if (parts[2] === 'category') {
          pageLoadName =  '/blog/category';
        }
        else if (parts[2] === 'archive') {
          pageLoadName =  '/blog/archive';
        }
        else {
          pageLoadName =  '/blog/detail';
        }
      }
      else if (parts.length && parts[1] === 'elasticon') {
        if (parts.length === 2) {
          pageLoadName =  '/elasticon';
        }
        else if (parts.length === 5 && (parts[2] === 'conf' || parts[2] === 'tour')) {
          pageLoadName =  '/elasticon/overview';
        }
        else if (parts.length > 5 && (parts[2] === 'conf' || parts[2] === 'tour')) {
          pageLoadName =  '/elasticon/video';
        }
      }
      else if (parts.length && parts[1] === 'guide') {
        pageLoadName =  '/guide';
      }
      else if (parts.length === 2 && parts[1] === 'videos') {
        pageLoadName =  '/videos';
      }
      else if (parts.length > 2 && parts[1] === 'videos') {
        pageLoadName =  '/videos/detail';
      }
      else if (parts.length > 2 && parts[1] === 'webinars') {
        pageLoadName =  '/webinars/detail';
      }
      else {
        pageLoadName =  window.location.pathname;
      }
    
      console.log('apm pageLoadName:', pageLoadName, parts)
      elasticApm.setTags({env:"production"});
      elasticApm.setInitialPageLoadName(pageLoadName);
    </script>
    -->

    <!-- Header Section -->
    
    <div id='elastic-nav'></div>

    <!-- Subnav -->
    <div>
      <div>
        <div class="tertiary-nav d-none d-md-block">
          <div class="container">
            <div class="p-t-b-15 d-flex justify-content-between nav-container">
              <div class="breadcrum-wrapper"><span><a href="/guide/" style="font-size: 14px; font-weight: 600; color: #000;">Docs</a></span></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <link rel="stylesheet" type="text/css" href="/static/css/horizon-swiper.min.css">

    <style> 
      .m-shortcuts li a.m-search {
        background: url("/assets/blt7b9c4fe6528dc4ef/m-search-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}

      .m-shortcuts li a.m-docs {
        background: url("/assets/blt44d8b7530a76d01c/m-guide-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}

      .m-shortcuts li a.m-contact {
        background: url("/assets/blt878040795c9d083b/m-contact-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
    </style>

    <script type="text/javascript" src="/static/js/horizon-swiper.min.js"></script>

    <script type="text/javascript">
      $(document).ready( function(){
        // if($('#scrollable-pane li').length > 3){
          $('.horizon-swiper').horizonSwiper({
            showItems: 3,
            arrows: true
          }); 
        // }
        
        $('.navbar-toggle').on('click', function(){
          $('.mobile-navigation, .menu-open').hide();
          $('.navigation-wrapper').addClass('mobile-navigation');
          $('.navbar').addClass('menu-open');
          $('.menu-close').show();
        });
        $('.menu-close').on('click', function(){
          $('.navigation-wrapper').removeClass('mobile-navigation');
          $('.navbar').removeClass('menu-open');
          $('.menu-close').hide();
        });
    
        var active_url = "";
    
        $(".navbar-mobile-header-icon").click(function(index){
          $('.navigation-wrapper').toggleClass('menu-overlay');
          $(this).toggleClass("navbar-mobile-header-icon-click navbar-mobile-header-icon-out");
          $(".mobile-inner-nav").slideToggle(500);
          $(".mobile-inner-nav .navbar-nav a").each(function( index ) {
            $(this).css({'animation-delay': (index/25)+'0.4s'});
          });
        });
    
        $('.dropdown-btn').on('click', function(e){
          e.preventDefault();
          setDropdown();
        });
        
        function setDropdown() {
          $('#myDropdown').slideToggle();
        }
    
        $('body').on('click', function(event){
          if (!event.target.matches('.dropdown-btn')) {
    
            var dropdowns = $(".dropdown-content");
            var i;
            for (i = 0; i < dropdowns.length; i++) {
              var openDropdown = dropdowns[i];
              if (openDropdown.classList.contains('show')) {
                openDropdown.classList.remove('show');
              }
            }
          }
        });
    
      });
      $(window).resize(function () {
        $('.horizon-swiper').horizonSwiper({
          showItems: 3,
          arrows: true
        });
      });
    </script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">   

          <section id="guide" lang="en">
            <div class="container">
              <div class="row">
                <!-- start body -->
                
            <div class="col-xs-12 col-sm-8 col-md-8 guide-section">
            <!-- start body -->
<div class="page_header">You are looking at documentation for an older release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Beats Platform Reference
      [7.2]
    </a></span> » <span class="breadcrumb-link"><a href="upgrading.html">Upgrading</a></span> » <span class="breadcrumb-node">Upgrade from 6.x to 7.x</span></div><div class="navheader"><span class="prev"><a href="upgrading-minor-versions.html">
              « 
              Upgrade between minor versions</a>
           
        </span><span class="next">
           
          <a href="troubleshooting-upgrade.html">Troubleshooting Beats upgrade issues
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="upgrading-6-to-7"></a>Upgrade from 6.x to 7.x<a href="https://github.com/elastic/beats/edit/7.2/libbeat/docs/upgrading.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>Before upgrading your Beats, review the <a class="link" href="breaking-changes.html" title="Breaking changes">breaking changes</a>
and the <a class="xref" href="release-notes.html" title="Release notes"><em>Release notes</em></a>.</p><p>If you’re upgrading other products in the stack, also read the
<a class="ulink" href="http://www.elastic.co/guide/en/elastic-stack/7.2/index.html" target="_top">Elastic Stack Installation and Upgrade Guide</a>.</p><p>We recommend that you fully upgrade Elasticsearch and Kibana to version 7.0
before upgrading Beats. If you’re on Beats 6.0 through 6.6,
upgrade the Elastic Stack and Beats to version 6.7 <span class="strong strong"><strong>before</strong></span> proceeding with the
7.0 upgrade.</p><p>Upgrading between non-consecutive major versions (e.g. 5.x to 7.x) is not
supported.</p><div class="important admon"><div class="icon"><img alt="Important" src="images/icons/important.png" /></div><div class="admon_content"><p>Please read through all upgrade steps before proceeding. These steps
are required before running the software for the first time.</p></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="upgrading-to-6.7"></a>Upgrade to Beats 6.7 before upgrading to 7.0<a href="https://github.com/elastic/beats/edit/7.2/libbeat/docs/upgrading.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>The upgrade procedure assumes that you have Beats 6.7 installed. If you’re on
a previous 6.x version of Beats, upgrade to version 6.7 first. If you’re using
other products in the Elastic Stack, upgrade Beats as part of the
<a class="ulink" href="http://www.elastic.co/guide/en/elastic-stack/7.2/upgrading-elastic-stack.html" target="_top">Elastic Stack upgrade process</a>.</p><p>Upgrading to 6.7 is required because the Elasticsearch index template was modified to
be compatible with Elasticsearch 7.0 (the <code class="literal">_type</code> setting changed from <code class="literal">doc</code> to <code class="literal">_doc</code>).</p><p>After upgrading to 6.7, use the <a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/7.2/indices-templates.html#getting" target="_top">Index
Template API</a> to verify that the 6.7 index template has been created in Elasticsearch.</p><p>To load the the index template, run the <code class="literal">setup</code> command with the <code class="literal">--template</code> option
specified. For example, if the Beats output is Elasticsearch, run:</p><p><span class="strong strong"><strong>deb and rpm:</strong></span></p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">metricbeat setup --template</pre></div><p><span class="strong strong"><strong>mac and linux:</strong></span></p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">./metricbeat setup --template</pre></div><p><span class="strong strong"><strong>docker:</strong></span></p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">docker run docker.elastic.co/beats/metricbeat:7.0.0 setup --template</pre></div><p><span class="strong strong"><strong>win:</strong></span></p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">PS &gt; .\metricbeat.exe setup --template</pre></div><p>If the Beats output is not <code class="literal">elasticsearch</code>, temporarily enable the
<code class="literal">elasticsearch</code> output when you run the <code class="literal">setup</code> command. For example:</p><p><span class="strong strong"><strong>deb and rpm:</strong></span></p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">metricbeat setup --template -E output.logstash.enabled=false -E 'output.elasticsearch.hosts=["localhost:9200"]'</pre></div><p><span class="strong strong"><strong>mac and linux:</strong></span></p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">./metricbeat setup --template -E output.logstash.enabled=false -E 'output.elasticsearch.hosts=["localhost:9200"]'</pre></div><p><span class="strong strong"><strong>docker:</strong></span></p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">docker run docker.elastic.co/beats/metricbeat:7.0.0 setup --template -E output.logstash.enabled=false -E 'output.elasticsearch.hosts=["localhost:9200"]'</pre></div><p><span class="strong strong"><strong>win:</strong></span></p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">PS &gt; .\metricbeat.exe setup --template -E output.logstash.enabled=false -E 'output.elasticsearch.hosts=["localhost:9200"]'</pre></div><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>In previous versions, we advised users to manually force loading of the
index template. This is no longer recommended. Use the <code class="literal">setup</code> command instead.</p></div></div><p><span class="strong strong"><strong>Metricbeat and Filebeat users:</strong></span> If you use Beats central management,
make sure you migrate the Beats central management index to 6.7 before you
upgrade to 7.0. Although central management is not a GA-level feature in 7.0,
we’ve provided a migration tool to help you migrate your configurations from
version 6.6 to 6.7 or later. For more information, see the
<a class="ulink" href="https://www.elastic.co/blog/beats-6-7-0-released" target="_top">Beats 6.7.0 release blog</a>.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_upgrade_beats_binaries_to_7_0"></a>Upgrade Beats binaries to 7.0<a href="https://github.com/elastic/beats/edit/7.2/libbeat/docs/upgrading.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>Before upgrading:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
Stop the existing Beats process by using the appropriate command for your
system.
</li><li class="listitem"><p class="simpara">
Back up the <code class="literal">data</code> and <code class="literal">config</code> directories by copying them to another
location.
</p><div class="tip admon"><div class="icon"><img alt="Tip" src="images/icons/tip.png" /></div><div class="admon_content"><p>The location of these directories depends on the installation method. To
see the current paths, start the Beat from a terminal, and the <code class="literal">data</code> and
<code class="literal">config</code> paths are printed at startup.</p></div></div></li></ol></div><p>To upgrade using a Debian or RPM package:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Use <code class="literal">rpm</code> or <code class="literal">dpkg</code> to install the new package. All files are installed in the
appropriate location for the operating system and Beats config files are not
overwritten.
</li></ul></div><p>To upgrade using a zip or compressed tarball:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
Extract the zip or tarball to a <span class="emphasis"><em>new</em></span> directory. This is critical if you
are not using external <code class="literal">config</code> and <code class="literal">data</code> directories.
</li><li class="listitem"><p class="simpara">
Set the following options in the Beats configuration file:
</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
Set <code class="literal">path.config</code> to point to your external <code class="literal">config</code> directory. If you are
not using an external <code class="literal">config</code> directory, copy your old configuration over to
the new installation.
</li><li class="listitem">
Set <code class="literal">path.data</code> to point to your external data directory. If you are not using
an external <code class="literal">data</code> directory, copy your old data directory over to the new
installation.
</li><li class="listitem">
Set <code class="literal">path.logs</code> to point to the location where you want to store your logs. If
you do not specify this setting, logs are stored in the directory you extracted
the archive to.
</li></ul></div></li></ol></div><p>Complete the upgrade tasks described in the following sections <span class="strong strong"><strong>before</strong></span>
restarting the Beats process.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="migrate-config-files"></a>Migrate configuration files<a href="https://github.com/elastic/beats/edit/7.2/libbeat/docs/upgrading.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>Beats 7.0 comes with several backwards incompatible configuration changes.
Before upgrading, review the <a class="xref" href="breaking-changes-7.0.html" title="Breaking changes in 7.0">Breaking changes in 7.0</a> document. Also review
the full list of breaking changes in the <a class="xref" href="release-notes.html" title="Release notes"><em>Release notes</em></a> for 7.0.</p><p>Where possible, we kept the old configuration options working, but deprecated
them. However, deprecation was not always possible, so if you use any of the
settings described under breaking changes, make sure you understand the
alternatives that we provide.</p></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="enable-ecs-compatibility"></a>Enable the compatibility layer for Elastic Common Schema (ECS) fields<a href="https://github.com/elastic/beats/edit/7.2/libbeat/docs/upgrading.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>Starting with 7.0, the fields exported by Beats conform to the
<a class="ulink" href="https://www.elastic.co/guide/en/ecs/1.0/index.html" target="_top">Elastic Common Schema (ECS)</a>. Many of the exported fields
have been renamed. See <a class="ulink" href="https://www.elastic.co/guide/en/beats/libbeat/7.2/breaking-changes-7.0.html" target="_top">Breaking
changes in 7.0</a> for the full list of changed names.</p><p>To help you transition to the new fields, we provide a compatibility layer in
the form of ECS-compatible field aliases. To use the aliases, set the following
option in the Beat’s configuration file <span class="strong strong"><strong>before</strong></span> you upgrade the Elasticsearch index
template to 7.0.</p><div class="pre_wrapper lang-yaml"><pre class="programlisting prettyprint lang-yaml">migration.6_to_7.enabled: true</pre></div><p>The field aliases let you use 6.x dashboards and visualizations with indices
created by Beats 7.0 or later. The aliases do <span class="strong strong"><strong>not</strong></span> work with saved searches
or with API calls that manipulate documents directly.</p><p>Some fields also have type changes in 7.0 that affect the behavior of older
dashboards and visualizations. To clarify:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<span class="strong strong"><strong>Some fields have type changes.</strong></span> Your Kibana visualizations and aggregations
will not work on these fields until the conflicts are resolved.
</li><li class="listitem">
<span class="strong strong"><strong>Some fields have name changes, but no type changes.</strong></span> The field aliases
created by the compatibility layer ensure that visualizations and aggregations
on the old field names work on old and new data. 7.0 dashboards work
only on new field names (and therefore only on new data).
</li><li class="listitem">
<span class="strong strong"><strong>Some fields have both name and type changes.</strong></span> Field aliases are created for
these fields, but your Kibana visualizations and aggregations will not work on
these fields until the conflicts are resolved. Some of your  Elasticsearch API queries
may continue to work, if the old and new types are compatible.
</li></ul></div><p>We strongly advise that you adjust your custom Kibana dashboards, machine
learning jobs, and other content to use the new ECS field names. After removing
all references to old fields, you should set <code class="literal">migration.6_to_7.enabled: false</code>
so that field aliases will not be created during your next minor upgrade.</p><p>The aliases will be removed in 8.0.</p><div class="tip admon"><div class="icon"><img alt="Tip" src="images/icons/tip.png" /></div><div class="admon_content"><p>Did you run the Beat or load the index template before reading this section?
That’s OK. See the clean-up steps described under <a class="xref" href="troubleshooting-upgrade.html#missing-fields" title="Missing fields or too many fields in the index">Missing fields or too many fields in the index</a>.</p></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="upgrade-index-template"></a>Upgrade the Elasticsearch index template<a href="https://github.com/elastic/beats/edit/7.2/libbeat/docs/upgrading.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>Index templates and the default index names are versioned. For example,
Metricbeat 7.2.1 typically creates indices like this:</p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">metricbeat-7.2.1-2019.04.02</pre></div><p>And the corresponding Elasticsearch index template is named <code class="literal">metricbeat-7.2.1</code>.</p><p>This means that each version of the Beat creates a new index, and it’s
guaranteed that the correct index template for that version is applied. With
these changes in place, you generally don’t have to do anything to upgrade the
index template when you move to a new version. Just load the new version of the
index template <span class="strong strong"><strong>before</strong></span> ingesting any data into Elasticsearch.</p><p>If you plan to run Beats 6.7 and 7.0 in parallel, make sure you
<a class="link" href="upgrading-6-to-7.html#enable-ecs-compatibility" title="Enable the compatibility layer for Elastic Common Schema (ECS) fields">enable the compatibility layer</a> <span class="strong strong"><strong>before</strong></span> you load
the index template.</p><p>To load the the index template, run the <code class="literal">setup</code> command with the <code class="literal">--template</code> option
specified. For example, if the Beats output is Elasticsearch, run:</p><p><span class="strong strong"><strong>deb and rpm:</strong></span></p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">metricbeat setup --template</pre></div><p><span class="strong strong"><strong>mac and linux:</strong></span></p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">./metricbeat setup --template</pre></div><p><span class="strong strong"><strong>docker:</strong></span></p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">docker run docker.elastic.co/beats/metricbeat:7.0.0 setup --template</pre></div><p><span class="strong strong"><strong>win:</strong></span></p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">PS &gt; .\metricbeat.exe setup --template</pre></div><p>If the Beats output is not <code class="literal">elasticsearch</code>, temporarily enable the
<code class="literal">elasticsearch</code> output when you run the <code class="literal">setup</code> command. For example:</p><p><span class="strong strong"><strong>deb and rpm:</strong></span></p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">metricbeat setup --template -E output.logstash.enabled=false -E 'output.elasticsearch.hosts=["localhost:9200"]'</pre></div><p><span class="strong strong"><strong>mac and linux:</strong></span></p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">./metricbeat setup --template -E output.logstash.enabled=false -E 'output.elasticsearch.hosts=["localhost:9200"]'</pre></div><p><span class="strong strong"><strong>docker:</strong></span></p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">docker run docker.elastic.co/beats/metricbeat:7.0.0 setup --template -E output.logstash.enabled=false -E 'output.elasticsearch.hosts=["localhost:9200"]'</pre></div><p><span class="strong strong"><strong>win:</strong></span></p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">PS &gt; .\metricbeat.exe setup --template -E output.logstash.enabled=false -E 'output.elasticsearch.hosts=["localhost:9200"]'</pre></div><div class="tip admon"><div class="icon"><img alt="Tip" src="images/icons/tip.png" /></div><div class="admon_content"><p>When loading the index template, you can also specify
<code class="literal">-E setup.template.settings.index.number_of_shards=n</code> where <code class="literal">n</code> is the number of
shards to use for the index.</p></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="non-es-outputs"></a>How to use versioned index templates when the output is not Elasticsearch<a href="https://github.com/elastic/beats/edit/7.2/libbeat/docs/upgrading.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>If you’ve configured Beats to send events to a different output, such as Logstash,
make sure you use versioned index templates and indices. Otherwise, after you
upgrade, there will be field conflicts.</p><p>To use versioned index templates and indices with Logstash, configure your
Logstash pipeline to use the metadata from Beats to set the index, and allow
Beats to manage the index template:</p><div class="pre_wrapper lang-json"><pre class="programlisting prettyprint lang-json">    manage_template =&gt; false
    index =&gt; "%{[@metadata][beat]}-%{[@metadata][version]}-%{+YYYY.MM.dd}"</pre></div><p>When you use this configuration, the index name is set to match the index
pattern in the Beats index template. See the
<a class="ulink" href="http://www.elastic.co/guide/en/logstash/7.2/plugins-inputs-beats.html" target="_top">Beats input plugin</a> documentation
for more information.</p><p>For other non-Elasticsearch outputs, use the metadata from Beats to set the index, and
allow Beats to load and manage the index template, as described under
<a class="xref" href="upgrading-6-to-7.html#upgrade-index-template" title="Upgrade the Elasticsearch index template">Upgrade the Elasticsearch index template</a>.</p><div class="important admon"><div class="icon"><img alt="Important" src="images/icons/important.png" /></div><div class="admon_content"><p>The index name must match the index pattern in the Beats index
template. For example, if Logstash sends events to an index called
<code class="literal">metricbeat-7-2019.04.02</code>, but the index template expects indices to match
<code class="literal">metricbeat-7.2.1-*</code>, you may encounter mapping errors and be unable
to index Beats events.</p></div></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="_upgrade_dashboards"></a>Upgrade dashboards<a href="https://github.com/elastic/beats/edit/7.2/libbeat/docs/upgrading.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>We recommend that you import the 7.0 Kibana dashboards after upgrading
Kibana and Beats. This way, you can take advantage of the new dashboards
created for the 7.0 release.</p><p>If you’ve <a class="link" href="upgrading-6-to-7.html#enable-ecs-compatibility" title="Enable the compatibility layer for Elastic Common Schema (ECS) fields">enabled the compatibility layer</a> before
loading the index template and dashboards, 6.x dashboards can co-exist with
7.0 dashboards and will continue working after the upgrade.</p><p>To load the 7.0 dashboards, run the <code class="literal">setup</code> command with the <code class="literal">--dashboards</code> option
specified. For example, if the Beats output is Elasticsearch, run:</p><p><span class="strong strong"><strong>deb and rpm:</strong></span></p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">metricbeat setup --dashboards</pre></div><p><span class="strong strong"><strong>mac and linux:</strong></span></p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">./metricbeat setup --dashboards</pre></div><p><span class="strong strong"><strong>docker:</strong></span></p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">docker run docker.elastic.co/beats/metricbeat:7.0.0 setup --dashboards</pre></div><p><span class="strong strong"><strong>win:</strong></span></p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">PS &gt; .\metricbeat.exe setup --dashboards</pre></div><p>If the Beats output is not <code class="literal">elasticsearch</code>, temporarily enable the
<code class="literal">elasticsearch</code> output when you run the <code class="literal">setup</code> command. For example:</p><p><span class="strong strong"><strong>deb and rpm:</strong></span></p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">metricbeat setup --dashboards -E output.logstash.enabled=false -E 'output.elasticsearch.hosts=["localhost:9200"]'</pre></div><p><span class="strong strong"><strong>mac and linux:</strong></span></p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">./metricbeat setup --dashboards -E output.logstash.enabled=false -E 'output.elasticsearch.hosts=["localhost:9200"]'</pre></div><p><span class="strong strong"><strong>docker:</strong></span></p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">docker run docker.elastic.co/beats/metricbeat:7.0.0 setup --dashboards -E output.logstash.enabled=false -E 'output.elasticsearch.hosts=["localhost:9200"]'</pre></div><p><span class="strong strong"><strong>win:</strong></span></p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">PS &gt; .\metricbeat.exe setup --dashboards -E output.logstash.enabled=false -E 'output.elasticsearch.hosts=["localhost:9200"]'</pre></div></div><div class="section"><div class="titlepage"><div><div><h3 class="title"><a id="migrate-filebeat-registry"></a>Migrate Filebeat registry to use new format<a href="https://github.com/elastic/beats/edit/7.2/libbeat/docs/upgrading.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3></div></div></div><p>Starting with version 7.0, Filebeat stores the registry in a directory
structure. If Filebeat finds an old registry file at the path set by
<code class="literal">filebeat.registry.path</code>, it will automatically migrate the registry file to the
new format. If the registry file is at a different location, set
<code class="literal">filebeat.registry.migrate_file</code> to point to the file.</p><p>The registry changes also require you to rename the following configuration
settings:</p><div class="informaltable"><table cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th align="left" valign="top">Old config name </th><th align="left" valign="top"> New config name</th></tr></thead><tbody><tr><td align="left" valign="top"><p><code class="literal">filebeat.registry_file</code></p></td><td align="left" valign="top"><p><code class="literal">filebeat.registry.path</code>.</p></td></tr><tr><td align="left" valign="top"><p><code class="literal">filebeat.registry_file_permissions</code></p></td><td align="left" valign="top"><p><code class="literal">filebeat.registry.file_permissions</code></p></td></tr><tr><td align="left" valign="top"><p><code class="literal">filebeat.registry_flush</code></p></td><td align="left" valign="top"><p><code class="literal">filebeat.registry.flush</code></p></td></tr></tbody></table></div><p>Before proceeding with the upgrade, make sure you back up the registry file.</p></div><div class="xpack section"><div class="titlepage"><div><div><h3 class="title"><a id="ilm-on"></a>Check privileges for index lifecycle management (on by default in 7.0)<a href="https://github.com/elastic/beats/edit/7.2/libbeat/docs/upgrading.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a><a class="xpack_tag" href="/subscriptions"></a></h3></div></div></div><p>Starting with Beats 7.0, index lifecycle management is on by default when
sending data to Beats clusters that support it. Make sure Beats users have
the privileges needed to use index lifecycle management, or disable index
lifecycle management.</p><p>For help troubleshooting authorization issues, see <a class="xref" href="troubleshooting-upgrade.html#user-unauthorized" title="User is not authorized">User is not authorized</a>.</p><p>If you want to disable index lifecycle management, set
<code class="literal">setup.ilm.enabled: false</code> in the Beats configuration file.</p></div></div><div class="navfooter"><span class="prev"><a href="upgrading-minor-versions.html">
              « 
              Upgrade between minor versions</a>
           
        </span><span class="next">
           
          <a href="troubleshooting-upgrade.html">Troubleshooting Beats upgrade issues
               »
            </a></span></div>
<!-- end body -->

            </div>
            <div class="col-xs-12 col-sm-4 col-md-4" id="right_col">
        
                  <div id="rtpcontainer" style="display: block;">
                    <div class="mktg-promo">
                      <h3>Getting Started Videos</h3>
                      <ul class="icons">
                        <li class="icon-elasticsearch-white"><a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">Starting Elasticsearch</a></li>
                        <li class="icon-kibana-white"><a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">Introduction to Kibana</a></li>
                        <li class="icon-logstash-white"><a href="https://www.elastic.co/webinars/getting-started-logstash?baymax=default&elektra=docs&storm=top-video">Logstash Starter Guide</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'</div>
<!-- Footer Section end-->

<script src='https://www.elastic.co/elastic-nav.js'></script>
<script src='https://www.elastic.co/elastic-footer.js'></script>

<style type="text/css">
	
        
            .Facebook a {background:url("/assets/bltf546ff2e0a8f2de5/facebook.svg") no-repeat;}
            .Facebook a:before {
                content: url("/assets/bltc24cf11c714ecfc4/facebook-hover.svg");
                width:0;
                height:0;
                visibility:hidden;
            }
        
        
            .Facebook a:hover {background:url("/assets/bltc24cf11c714ecfc4/facebook-hover.svg")}		
        
	
        
            .Twitter a {background:url("/assets/bltdd9556d6b24e2b85/twitter.svg") no-repeat;}
            .Twitter a:before {
                content: url("/assets/blt90b0372cc07a54d3/twitter-hover.svg");
                width:0;
                height:0;
                visibility:hidden;
            }
        
        
            .Twitter a:hover {background:url("/assets/blt90b0372cc07a54d3/twitter-hover.svg")}		
        
	
        
            .LinkedIn a {background:url("/assets/bltc4a77e0f52ce07f1/linkedin.svg") no-repeat;}
            .LinkedIn a:before {
                content: url("/assets/blt01ce654380e4ea6c/linkedin-hover.svg");
                width:0;
                height:0;
                visibility:hidden;
            }
        
        
            .LinkedIn a:hover {background:url("/assets/blt01ce654380e4ea6c/linkedin-hover.svg")}		
        
	
        
            .Xing a {background:url("/assets/bltc6347078dcc9ec76/xing.svg") no-repeat;}
            .Xing a:before {
                content: url("/assets/bltededebe5f7521a39/xing-hover.svg");
                width:0;
                height:0;
                visibility:hidden;
            }
        
        
            .Xing a:hover {background:url("/assets/bltededebe5f7521a39/xing-hover.svg")}		
        
	
        
            .YouTube a {background:url("/assets/blt4982061ce1aebc7f/youtube.svg") no-repeat;}
            .YouTube a:before {
                content: url("/assets/bltddeb6c6404ae81a5/youtube-hover.svg");
                width:0;
                height:0;
                visibility:hidden;
            }
        
        
            .YouTube a:hover {background:url("/assets/bltddeb6c6404ae81a5/youtube-hover.svg")}		
        
	
</style>

<script src="//app-lon02.marketo.com/js/forms2/js/forms2.min.js"></script>
<script>
$(document).ready(function(){

    var ipSuccess = function(data) {
        country = data.country_code;
        if (data.in_eu){
                        
            marketo_id = "6196";
            
        }else{ 
            marketo_id = "1398";

        }

        $('.subscribe-form form.sb-form').attr('id', 'mktoForm_' + marketo_id);
        if(window.MktoForms2){
            MktoForms2.loadForm("//app-lon02.marketo.com", "813-MAM-392", marketo_id,function(form){
                form.onSuccess(function(form){
                    $('#mktoForm_'+marketo_id).css('display','none');
                    $('.subscribe-wrapper .subscribe-form-container').hide();
                    $('.subscribe-wrapper').find('.form_thanks').removeClass('hide')
                    dataLayer.push({'event': 'mktoFormSubmit'});
                    return false;
                });
            });  
        }
    }

    var marketo_id;

    $.ajax({
        url: "/gdpr-data"
    }).success(function(data) {
        ipSuccess(data);
    });

})
</script>

      </section>
    </div>

    
     <script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";
	var localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}';
</script>
<script src="/static/js/swiftype_app_search.umd.min.js"></script>
<script src="/static/js/jquery.autocomplete.js"></script>
<script type="text/javascript" src="/static/js/slick.min.js"></script>
<script src="/static/js/nav-v5.js"></script>
<script src="/static/js/script.js"></script>

  
            <script type="text/javascript" src="/guide/static/docs.js"></script>

            </body>
        
</html>
