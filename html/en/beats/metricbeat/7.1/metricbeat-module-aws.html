<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>aws module
        | Metricbeat Reference [7.1]
      | Elastic
    </title><link rel="home" href="index.html" title="Metricbeat Reference [7.1]" /><link rel="up" href="metricbeat-modules.html" title="Modules" /><link rel="prev" href="metricbeat-metricset-apache-status.html" title="Apache status metricset" /><link rel="next" href="metricbeat-metricset-aws-ec2.html" title="aws ec2 metricset" /><meta name="DC.type" content="Learn/Docs/Metricbeat/Reference/7.1" /><meta name="DC.subject" content="Metricbeat" /><meta name="DC.identifier" content="7.1" />
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#ffffff">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <script src="/static/js/jquery.min.js"></script>
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <!-- Subnav -->
    <div>
      <div>
        <div class="tertiary-nav d-none d-md-block">
          <div class="container">
            <div class="p-t-b-15 d-flex justify-content-between nav-container">
              <div class="breadcrum-wrapper"><span><a href="/guide/" style="font-size: 14px; font-weight: 600; color: #000;">Docs</a></span></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container">
              <div class="row">
                <div class="col-xs-12 col-sm-8 col-md-8 guide-section">
                  <!-- start body -->
                  <div class="page_header">You are looking at documentation for an older release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Metricbeat Reference
      [7.1]
    </a></span> » <span class="breadcrumb-link"><a href="metricbeat-modules.html">Modules</a></span> » <span class="breadcrumb-node">aws module</span></div><div class="navheader"><span class="prev"><a href="metricbeat-metricset-apache-status.html">
              « 
              Apache status metricset</a>
           
        </span><span class="next">
           
          <a href="metricbeat-metricset-aws-ec2.html">aws ec2 metricset
               »
            </a></span></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="metricbeat-module-aws"></a>aws module<a href="https://github.com/elastic/beats/edit/7.1/metricbeat/docs/modules/aws.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>This module periodically fetches monitoring metrics from AWS Cloudwatch using
<a class="ulink" href="https://docs.aws.amazon.com/AmazonCloudWatch/latest/APIReference/API_GetMetricData.html" target="_top">GetMetricData API</a> for AWS services.
Note: extra AWS charges on GetMetricData API requests will be generated by this module.</p><p>The default metricset is <code class="literal">ec2</code>.</p><h3><a id="_module_specific_configuration_notes"></a>Module-specific configuration notes<a href="https://github.com/elastic/beats/edit/7.1/metricbeat/docs/modules/aws.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>This module environment variable <code class="literal">AWS_ACCESS_KEY_ID</code>, <code class="literal">AWS_SECRET_ACCESS_KEY</code>, <code class="literal">AWS_SESSION_TOKEN</code> and <code class="literal">AWS_REGION</code>
references in the config file to set values that need to be configurable during deployment.</p><p>There are two different kinds of AWS credentials can be used here: <code class="literal">access keys</code> and <code class="literal">temporary security credentials</code>.
<code class="literal">AWS_ACCESS_KEY_ID</code> and <code class="literal">AWS_SECRET_ACCESS_KEY</code> are the two parts of <code class="literal">access keys</code>. They are long-term credentials for
an IAM user or the AWS account root user. Please see
<a class="ulink" href="https://docs.aws.amazon.com/general/latest/gr/aws-sec-cred-types.html#access-keys-and-secret-access-keys" target="_top">AWS Access Keys
 and Secret Access Keys</a> for more details. <code class="literal">temporary security credentials</code> has a limited lifetime and consists of an access key ID,
a secret access key, and a security token which typically returned from <code class="literal">GetSessionToken</code>. MFA-enabled IAM users would
need to submit an MFA code while calling <code class="literal">GetSessionToken</code>. <code class="literal">aws_default_region</code> is to set the region for SDK to use. Please
see <a class="ulink" href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_temp.html" target="_top">Temporary Security Credentials</a> for more details.
<code class="literal">sts get-session-token</code> AWS CLI can be used to generate temporary credentials. For example. with MFA-enabled:</p><pre class="screen">aws&gt; sts get-session-token --serial-number arn:aws:iam::1234:mfa/your-email@example.com --token-code 456789 --duration-seconds 129600</pre><p>Because temporary security credentials are short term, after they expire, the user needs to generate new ones and modify
the aws.yml config file with the new credentials. Unless <a class="ulink" href="https://www.elastic.co/guide/en/beats/metricbeat/current/_live_reloading.html" target="_top">live reloading</a>
feature is enabled for Metricbeat, the user needs to manually restart Metricbeat after updating the config file in order
to continue collecting Cloudwatch metrics. This will cause data loss if the config file is not updated with new
credentials before the old ones expire. For Metricbeat, we recommend users to use access keys in config file to enable
aws module making AWS api calls without have to generate new temporary credentials and update the config frequently.</p><p>IAM policy is an entity that defines permissions to an object within your AWS environment. Specific permissions needs
to be added into the IAM user’s policy to authorize Metricbeat to collect AWS monitoring metrics. Please see documentation
under each metricset for required permissions.</p><p>By default, Amazon EC2 sends metric data to CloudWatch every 5 minutes. With this basic monitoring, <code class="literal">period</code> in aws module
configuration should be larger or equal than <code class="literal">300s</code>. If <code class="literal">period</code> is set to be less than <code class="literal">300s</code>, the same cloudwatch metrics
will be collected more than once which will cause extra fees without getting more granular metrics. For example, in <code class="literal">US East (N. Virginia)</code> region, it costs
$0.01/1000 metrics requested using GetMetricData. Please see <a class="ulink" href="https://aws.amazon.com/cloudwatch/pricing/" target="_top">AWS Cloudwatch Pricing</a>
for more details. To avoid unnecessary charges, <code class="literal">period</code> is preferred to be set to <code class="literal">300s</code> or multiples of <code class="literal">300s</code>, such as
<code class="literal">600s</code> and <code class="literal">900s</code>.</p><p>For more granular monitoring data you can enable detailed monitoring on the instance to get metrics every 1 minute. Please see
<a class="ulink" href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-cloudwatch-new.html" target="_top">Enabling Detailed Monitoring</a> for instructions
on how to enable detailed monitoring. With detailed monitoring enabled, <code class="literal">period</code> in aws module configuration can be any number
larger than <code class="literal">60s</code>. Since AWS sends metric data to CloudWatch in 1-minute periods, setting metricbeat module <code class="literal">period</code> less
than <code class="literal">60s</code> will cause extra API requests which means extra charges on AWS. To avoid unnecessary charges, <code class="literal">period</code> is
preferred to be set to <code class="literal">60s</code> or multiples of <code class="literal">60s</code>, such as <code class="literal">120s</code> and <code class="literal">180s</code>.</p><p>Here is an example of aws metricbeat module configuration:</p><div class="pre_wrapper lang-yaml"><pre class="programlisting prettyprint lang-yaml">metricbeat.modules:
- module: aws
  period: 300s
  metricsets: ["ec2"]
  access_key_id: '${AWS_ACCESS_KEY_ID}'
  secret_access_key: '${AWS_SECRET_ACCESS_KEY}'
  session_token: '${AWS_SESSION_TOKEN}'
  default_region: '${AWS_REGION:us-west-1}'</pre></div><h2><a id="_metricsets_4"></a>Metricsets<a href="https://github.com/elastic/beats/edit/7.1/metricbeat/docs/modules/aws.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2><p>The following Metricsets are already included:</p><h3><a id="_ec2"></a><code class="literal">ec2</code><a href="https://github.com/elastic/beats/edit/7.1/metricbeat/docs/modules/aws.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>By default, Amazon EC2 sends metric data to CloudWatch every 5 minutes. With this basic monitoring, <code class="literal">period</code> in aws module
configuration should be larger or equal than <code class="literal">300s</code>. If <code class="literal">period</code> is set to be less than <code class="literal">300s</code>, the same cloudwatch metrics
will be collected more than once which will cause extra fees without getting more granular metrics. For example, in <code class="literal">US East (N. Virginia)</code> region, it costs
$0.01/1000 metrics requested using GetMetricData. Please see <a class="ulink" href="https://aws.amazon.com/cloudwatch/pricing/" target="_top">AWS Cloudwatch Pricing</a>
for more details. To avoid unnecessary charges, <code class="literal">period</code> is preferred to be set to <code class="literal">300s</code> or multiples of <code class="literal">300s</code>, such as
<code class="literal">600s</code> and <code class="literal">900s</code>. For more granular monitoring data you can enable detailed monitoring on the instance to get metrics every 1 minute. Please see
<a class="ulink" href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-cloudwatch-new.html" target="_top">Enabling Detailed Monitoring</a> for instructions
on how to enable detailed monitoring. With detailed monitoring enabled, <code class="literal">period</code> in aws module configuration can be any number
larger than <code class="literal">60s</code>. Since AWS sends metric data to CloudWatch in 1-minute periods, setting metricbeat module <code class="literal">period</code> less
than <code class="literal">60s</code> will cause extra API requests which means extra charges on AWS. To avoid unnecessary charges, <code class="literal">period</code> is
preferred to be set to <code class="literal">60s</code> or multiples of <code class="literal">60s</code>, such as <code class="literal">120s</code> and <code class="literal">180s</code>.</p><p>The AWS module comes with a predefined dashboard. For example:</p><div class="informalfigure"><div class="mediaobject"><img src="./images/metricbeat-aws-ec2-overview.png" alt="metricbeat aws ec2 overview" /></div></div><h3><a id="_example_configuration_3"></a>Example configuration<a href="https://github.com/elastic/beats/edit/7.1/metricbeat/docs/modules/aws.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>The aws module supports the standard configuration options that are described
in <a class="xref" href="configuration-metricbeat.html" title="Specify which modules to run"><em>Specify which modules to run</em></a>. Here is an example configuration:</p><div class="pre_wrapper lang-yaml"><pre class="programlisting prettyprint lang-yaml">metricbeat.modules:
- module: aws
  period: 300s
  metricsets:
    - "ec2"
  access_key_id: '${AWS_ACCESS_KEY_ID:""}'
  secret_access_key: '${AWS_SECRET_ACCESS_KEY:""}'
  session_token: '${AWS_SESSION_TOKEN:""}'
  default_region: '${AWS_REGION:us-west-1}'</pre></div><h3><a id="_metricsets_5"></a>Metricsets<a href="https://github.com/elastic/beats/edit/7.1/metricbeat/docs/modules/aws.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>The following metricsets are available:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><a class="link" href="metricbeat-metricset-aws-ec2.html" title="aws ec2 metricset">ec2</a></li></ul></div></div><div class="navfooter"><span class="prev"><a href="metricbeat-metricset-apache-status.html">
              « 
              Apache status metricset</a>
           
        </span><span class="next">
           
          <a href="metricbeat-metricset-aws-ec2.html">aws ec2 metricset
               »
            </a></span></div>
                  <!-- end body -->
                </div>
                <div class="col-xs-12 col-sm-4 col-md-4" id="right_col">
                  <div id="rtpcontainer" style="display: block;">
                    <div class="mktg-promo">
                      <h3>Getting Started Videos</h3>
                      <ul class="icons">
                        <li class="icon-elasticsearch-white"><a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">Starting Elasticsearch</a></li>
                        <li class="icon-kibana-white"><a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">Introduction to Kibana</a></li>
                        <li class="icon-logstash-white"><a href="https://www.elastic.co/webinars/getting-started-logstash?baymax=default&elektra=docs&storm=top-video">Logstash Starter Guide</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";
	var localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}';
</script>
<script src="/static/js/swiftype_app_search.umd.min.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
