<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Hints based autodiscover | Metricbeat Reference [7.3] | Elastic</title>
<link rel="home" href="index.html" title="Metricbeat Reference [7.3]"/>
<link rel="up" href="configuration-autodiscover.html" title="Autodiscover"/>
<link rel="prev" href="configuration-autodiscover.html" title="Autodiscover"/>
<link rel="next" href="configuration-autodiscover-advanced.html" title="Advanced usage"/>
<meta name="DC.type" content="Learn/Docs/Metricbeat/Reference/7.3"/>
<meta name="DC.subject" content="Metricbeat"/>
<meta name="DC.identifier" content="7.3"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!--BEGIN QUALTRICS WEBSITE FEEDBACK SNIPPET-->
    <script type='text/javascript'>
      (function(){var g=function(e,h,f,g){
      this.get=function(a){for(var a=a+"=",c=document.cookie.split(";"),b=0,e=c.length;b<e;b++){for(var d=c[b];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return null};
      this.set=function(a,c){var b="",b=new Date;b.setTime(b.getTime()+6048E5);b="; expires="+b.toGMTString();document.cookie=a+"="+c+b+"; path=/; "};
      this.check=function(){var a=this.get(f);if(a)a=a.split(":");else if(100!=e)"v"==h&&(e=Math.random()>=e/100?0:100),a=[h,e,0],this.set(f,a.join(":"));else return!0;var c=a[1];if(100==c)return!0;switch(a[0]){case "v":return!1;case "r":return c=a[2]%Math.floor(100/c),a[2]++,this.set(f,a.join(":")),!c}return!0};
      this.go=function(){if(this.check()){var a=document.createElement("script");a.type="text/javascript";a.src=g;document.body&&document.body.appendChild(a)}};
      this.start=function(){var a=this;window.addEventListener?window.addEventListener("load",function(){a.go()},!1):window.attachEvent&&window.attachEvent("onload",function(){a.go()})}};
      try{(new g(100,"r","QSI_S_ZN_emkP0oSe9Qrn7kF","https://znemkp0ose9qrn7kf-elastic.siteintercept.qualtrics.com/WRSiteInterceptEngine/?Q_ZID=ZN_emkP0oSe9Qrn7kF")).start()}catch(i){}})();
    </script><div id='ZN_emkP0oSe9Qrn7kF'><!--DO NOT REMOVE-CONTENTS PLACED HERE--></div>
    <!--END WEBSITE FEEDBACK SNIPPET-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <!-- Subnav -->
    <div>
      <div>
        <div class="tertiary-nav d-none d-md-block">
          <div class="container">
            <div class="p-t-b-15 d-flex justify-content-between nav-container">
              <div class="breadcrum-wrapper"><span><a href="/guide/" style="font-size: 14px; font-weight: 600; color: #000;">Docs</a></span></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container">
              <div class="row">
                <div class="col-xs-12 col-sm-8 col-md-8 guide-section">
                  <!-- start body -->
                  <div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Metricbeat Reference [7.3]</a></span>
»
<span class="breadcrumb-link"><a href="configuring-howto-metricbeat.html">Configuring Metricbeat</a></span>
»
<span class="breadcrumb-link"><a href="configuration-autodiscover.html">Autodiscover</a></span>
»
<span class="breadcrumb-node">Hints based autodiscover</span>
</div>
<div class="navheader">
<span class="prev">
<a href="configuration-autodiscover.html">« Autodiscover</a>
</span>
<span class="next">
<a href="configuration-autodiscover-advanced.html">Advanced usage »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="configuration-autodiscover-hints"></a>Hints based autodiscover<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.3/libbeat/docs/shared-autodiscover.asciidoc">edit</a></h2>
</div></div></div>
<p>Metricbeat supports autodiscover based on hints from the provider. The <code class="literal">hints</code> system looks for
hints in Kubernetes Pod annotations or Docker labels which have the prefix <code class="literal">co.elastic.metrics</code>. As soon as
the container starts, Metricbeat will check if it contains any hints and launch the proper config for
it. Hints tell Metricbeat how to get metrics for the given container. This is the full list of supported hints:</p>
<h5><a id="_co_elastic_metricsmodule"></a><code class="literal">co.elastic.metrics/module</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.3/metricbeat/docs/autodiscover-hints.asciidoc">edit</a></h5>
<p>Metricbeat module to use to fetch metrics. See <a class="xref" href="metricbeat-modules.html" title="Modules">Modules</a> for the list of supported modules.</p>
<h5><a id="_co_elastic_metricshosts"></a><code class="literal">co.elastic.metrics/hosts</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.3/metricbeat/docs/autodiscover-hints.asciidoc">edit</a></h5>
<p>Hosts setting to use with the given module. Hosts can include <code class="literal">${data.host}</code> and <code class="literal">${data.port}</code>
values from the autodiscover event, ie: <code class="literal">${data.host}:80</code>.</p>
<h5><a id="_co_elastic_metricsmetricsets"></a><code class="literal">co.elastic.metrics/metricsets</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.3/metricbeat/docs/autodiscover-hints.asciidoc">edit</a></h5>
<p>List of metricsets to use, comma separated. If no metricsets are provided, default metricsets for the module
are used.</p>
<h5><a id="_co_elastic_metricsperiod"></a><code class="literal">co.elastic.metrics/period</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.3/metricbeat/docs/autodiscover-hints.asciidoc">edit</a></h5>
<p>The time interval for metrics retrieval, ie: 10s</p>
<h5><a id="_co_elastic_metricstimeout"></a><code class="literal">co.elastic.metrics/timeout</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.3/metricbeat/docs/autodiscover-hints.asciidoc">edit</a></h5>
<p>Metrics retrieval timeout, default: 3s</p>
<h5><a id="_co_elastic_metricsssl"></a><code class="literal">co.elastic.metrics/ssl.*</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.3/metricbeat/docs/autodiscover-hints.asciidoc">edit</a></h5>
<p>SSL parameters, as seen in <a class="xref" href="configuration-ssl.html" title="Specify SSL settings"><em>Specify SSL settings</em></a>.</p>
<h5><a id="_co_elastic_logsraw"></a><code class="literal">co.elastic.logs/raw</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.3/metricbeat/docs/autodiscover-hints.asciidoc">edit</a></h5>
<p>When an entire module configuration needs to be completely set the <code class="literal">raw</code> hint can be used. You can provide a
stringified JSON of the input configuration. <code class="literal">raw</code> overrides every other hint and can be used to create both a single or
a list of configurations.</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">co.elastic.metrics/raw: "[{\"enabled\":true,\"metricsets\":[\"default\"],\"module\":\"mockmoduledefaults\",\"period\":\"1m\",\"timeout\":\"3s\"}]"</pre>
</div>
<h5><a id="_co_elastic_metricsprocessors"></a><code class="literal">co.elastic.metrics/processors</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.3/metricbeat/docs/autodiscover-hints.asciidoc">edit</a></h5>
<p>Define a processor to be added to the Metricbeat module configuration. See <a class="xref" href="filtering-and-enhancing-data.html" title="Filter and enhance the exported data"><em>Filter and enhance the exported data</em></a> for the list
of supported processors.</p>
<p>In order to provide ordering of the processor definition, numbers can be provided. If not, the hints builder will do
arbitrary ordering:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">co.elastic.logs/processors.1.add_locale.abbrevation: "MST"
co.elastic.logs/processors.add_locale.abbrevation: "PST"</pre>
</div>
<p>In the above sample the processor definition tagged with <code class="literal">1</code> would be executed first.</p>
<h3><a id="_kubernetes_2"></a>Kubernetes<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.3/metricbeat/docs/autodiscover-hints.asciidoc">edit</a></h3>
<p>Kubernetes autodiscover provider supports hints in Pod annotations. To enable it just set <code class="literal">hints.enabled</code>:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">metricbeat.autodiscover:
  providers:
    - type: kubernetes
      hints.enabled: true</pre>
</div>
<p>This configuration enables the <code class="literal">hints</code> autodiscover for Kubernetes. The <code class="literal">hints</code> system looks for
hints in Kubernetes annotations or Docker labels which have the prefix <code class="literal">co.elastic.metrics</code>.</p>
<p>You can annotate Kubernetes Pods with useful info to spin up Metricbeat modules:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">annotations:
  co.elastic.metrics/module: prometheus
  co.elastic.metrics/metricsets: collector
  co.elastic.metrics/hosts: '${data.host}:9090'
  co.elastic.metrics/period: 1m</pre>
</div>
<p>The above annotations are used to spin up a Prometheus collector metricset and it polls the
parent container on port <code class="literal">9090</code> at a 1 minute interval.</p>
<h5><a id="_multiple_containers"></a>Multiple containers<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.3/metricbeat/docs/autodiscover-hints.asciidoc">edit</a></h5>
<p>When a Pod has multiple containers, these settings are shared. To set hints specific to a container in
the pod you can put the container name in the hint.</p>
<p>When a pod has multiple containers, the settings are shared unless you put the container name in the
hint. For example, these hints configure a common behavior for all containers in the Pod, and sets a specific
<code class="literal">hosts</code> hint for the container called <code class="literal">sidecar</code>.</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">annotations:
  co.elastic.metrics/module: apache
  co.elastic.metrics/hosts: '${data.host}:80'
  co.elastic.metrics.sidecar/hosts: '${data.host}:8080'</pre>
</div>
<h3><a id="_docker_3"></a>Docker<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.3/metricbeat/docs/autodiscover-hints.asciidoc">edit</a></h3>
<p>Docker autodiscover provider supports hints in labels. To enable it just set <code class="literal">hints.enabled</code>:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">metricbeat.autodiscover:
  providers:
    - type: docker
      hints.enabled: true</pre>
</div>
<p>You can label Docker containers with useful info to spin up Metricbeat modules, for example:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">  co.elastic.metrics/module: nginx
  co.elastic.metrics/metricsets: stubstatus
  co.elastic.metrics/hosts: '${data.host}:80'
  co.elastic.metrics/period: 10s</pre>
</div>
<p>The above labels would allow Metricbeat to configure a Prometheus collector to poll port <code class="literal">9090</code>
of the Docker container every 1 minute.</p>
</div>
<div class="navfooter">
<span class="prev">
<a href="configuration-autodiscover.html">« Autodiscover</a>
</span>
<span class="next">
<a href="configuration-autodiscover-advanced.html">Advanced usage »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>
                <div class="col-xs-12 col-sm-4 col-md-4" id="right_col">
                  <div id="rtpcontainer" style="display: block;">
                    <div class="mktg-promo">
                      <h3>Most Popular</h3>
                      <ul class="icons">
                        <li class="icon-elasticsearch-white"><a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">Get Started with Elasticsearch: Video</a></li>
                        <li class="icon-kibana-white"><a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">Intro to Kibana: Video</a></li>
                        <li class="icon-logstash-white"><a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">ELK for Logs & Metrics: Video</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";
	var localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}';
</script>
<script src="/static/js/swiftype_app_search.umd.min.js"></script>
<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
