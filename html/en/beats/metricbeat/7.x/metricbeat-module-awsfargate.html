<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>AWS Fargate module | Metricbeat Reference [7.x] | Elastic</title>
<link rel="home" href="index.html" title="Metricbeat Reference [7.x]"/>
<link rel="up" href="metricbeat-modules.html" title="Modules"/>
<link rel="prev" href="metricbeat-metricset-aws-vpn.html" title="AWS vpn metricset"/>
<link rel="next" href="metricbeat-metricset-awsfargate-task_stats.html" title="AWS Fargate task_stats metricset"/>
<meta name="DC.type" content="Learn/Docs/Metricbeat/Reference/7.x"/>
<meta name="DC.subject" content="Metricbeat"/>
<meta name="DC.identifier" content="7.x"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!--BEGIN QUALTRICS WEBSITE FEEDBACK SNIPPET-->
    <script type='text/javascript'>
      (function(){var g=function(e,h,f,g){
      this.get=function(a){for(var a=a+"=",c=document.cookie.split(";"),b=0,e=c.length;b<e;b++){for(var d=c[b];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return null};
      this.set=function(a,c){var b="",b=new Date;b.setTime(b.getTime()+6048E5);b="; expires="+b.toGMTString();document.cookie=a+"="+c+b+"; path=/; "};
      this.check=function(){var a=this.get(f);if(a)a=a.split(":");else if(100!=e)"v"==h&&(e=Math.random()>=e/100?0:100),a=[h,e,0],this.set(f,a.join(":"));else return!0;var c=a[1];if(100==c)return!0;switch(a[0]){case "v":return!1;case "r":return c=a[2]%Math.floor(100/c),a[2]++,this.set(f,a.join(":")),!c}return!0};
      this.go=function(){if(this.check()){var a=document.createElement("script");a.type="text/javascript";a.src=g;document.body&&document.body.appendChild(a)}};
      this.start=function(){var a=this;window.addEventListener?window.addEventListener("load",function(){a.go()},!1):window.attachEvent&&window.attachEvent("onload",function(){a.go()})}};
      try{(new g(100,"r","QSI_S_ZN_emkP0oSe9Qrn7kF","https://znemkp0ose9qrn7kf-elastic.siteintercept.qualtrics.com/WRSiteInterceptEngine/?Q_ZID=ZN_emkP0oSe9Qrn7kF")).start()}catch(i){}})();
    </script><div id='ZN_emkP0oSe9Qrn7kF'><!--DO NOT REMOVE-CONTENTS PLACED HERE--></div>
    <!--END WEBSITE FEEDBACK SNIPPET-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <!-- Subnav -->
    <div>
      <div>
        <div class="tertiary-nav d-none d-md-block">
          <div class="container">
            <div class="p-t-b-15 d-flex justify-content-between nav-container">
              <div class="breadcrum-wrapper"><span><a href="/guide/" style="font-size: 14px; font-weight: 600; color: #000;">Docs</a></span></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container">
              <div class="row">
                <div class="col-xs-12 col-sm-8 col-md-8 guide-section">
                  <!-- start body -->
                  <div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Metricbeat Reference [7.x]</a></span>
»
<span class="breadcrumb-link"><a href="metricbeat-modules.html">Modules</a></span>
»
<span class="breadcrumb-node">AWS Fargate module</span>
</div>
<div class="navheader">
<span class="prev">
<a href="metricbeat-metricset-aws-vpn.html">« AWS vpn metricset</a>
</span>
<span class="next">
<a href="metricbeat-metricset-awsfargate-task_stats.html">AWS Fargate task_stats metricset »</a>
</span>
</div>
<div class="chapter xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="metricbeat-module-awsfargate"></a>AWS Fargate module<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/7.x/metricbeat/docs/modules/awsfargate.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in beta and is subject to change. The design and code is less mature than official GA features and is being provided as-is with no warranties. Beta features are not subject to the support SLA of official GA features.</p>
</div>
</div>
<p>Amazon ECS on Fargate provides a method to retrieve various metadata, network
metrics, and Docker stats about tasks and containers. This is referred to as the
<a href="https://docs.aws.amazon.com/AmazonECS/latest/userguide/task-metadata-endpoint-v4-fargate.html" class="ulink" target="_top">task metadata endpoint</a>
and this endpoint is available per container.</p>
<p>The environment variable is injected by default into the containers of Amazon
ECS tasks on Fargate that use platform version 1.4.0 or later and Amazon ECS
tasks on Amazon EC2 that are running at least version 1.39.0 of the Amazon ECS
container agent.</p>
<p>The awsfargate module is a Metricbeat module which collects AWS fargate metrics
from task metadata endpoint.</p>
<h2><a id="_introduction_to_aws_ecs_and_fargate"></a>Introduction to AWS ECS and Fargate<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/7.x/metricbeat/docs/modules/awsfargate.asciidoc">edit</a></h2>
<p>Amazon Elastic Container Service (Amazon ECS) is a highly scalable, fast,
container management service that makes it easy to run, stop, and manage
containers. ECS has two launch types that can define how compute resources will
be managed: ECS EC2 and ECS Fargate.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>ECS EC2</strong></span>
</li>
</ul>
</div>
<p>ECS EC2 launches containers that run on EC2 instances. Users have to manage EC2
instances. Pricing depends on the number of EC2 instances running.</p>
<p>One can monitor these containers by deploying Metricbeat on the corresponding EC2 instances with the
Metricbeat Docker module enabled.</p>
<p>In order to achieve this one will need:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
to ensure access to these EC2 instances using ssh keys
coupled with EC2 instances (attach ssh keys on cluster creation using <code class="literal">Key pair</code> option)
</li>
<li class="listitem">
to enable shh access for the instances with the
proper <a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/authorizing-access-to-an-instance.html" class="ulink" target="_top">inbound rules</a>.
</li>
</ol>
</div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>ECS Fargate</strong></span>
</li>
</ul>
</div>
<p>ECS Fargate removes the responsibility of provisioning, configuring, and
managing the EC2 instances by allowing AWS to manage the EC2 instances. Users
only need to specify containers and tasks. Pricing based on the number of tasks.</p>
<h2><a id="_task_metadata_endpoint"></a>Task Metadata Endpoint<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/7.x/metricbeat/docs/modules/awsfargate.asciidoc">edit</a></h2>
<p><a href="https://docs.aws.amazon.com/AmazonECS/latest/userguide/task-metadata-endpoint-v4-fargate.html" class="ulink" target="_top">Task metadata endpoint</a>
returns <a href="https://docs.docker.com/engine/api/v1.30/#operation/ContainerStats" class="ulink" target="_top">Docker stats</a>
in JSON format for all the containers associated with the task.
This endpoint is only available from within the task definition itself, which
means Metricbeat needs to be run as a sidecar container within the task
definition. Since the metadata endpoint is only accessible from within the
Fargate Task, there is no authentication in place.</p>
<h2><a id="_metricsets_8"></a>Metricsets<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/7.x/metricbeat/docs/modules/awsfargate.asciidoc">edit</a></h2>
<p>Currently, we have <code class="literal">task_stats</code> metricset in <code class="literal">awsfargate</code> module.</p>
<h3><a id="_task_stats"></a><code class="literal">task_stats</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/7.x/metricbeat/docs/modules/awsfargate.asciidoc">edit</a></h3>
<p>This metricset collects runtime CPU metrics, disk I/O metrics, memory metrics,
network metrics and container metadata from both endpoint
<code class="literal">${ECS_CONTAINER_METADATA_URI_V4}/task/stats</code> and <code class="literal">${ECS_CONTAINER_METADATA_URI_V4}/task</code>.</p>
<h3><a id="_example_configuration_6"></a>Example configuration<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/7.x/metricbeat/docs/modules/awsfargate.asciidoc">edit</a></h3>
<p>The AWS Fargate module supports the standard configuration options that are described
in <a class="xref" href="configuration-metricbeat.html" title="Configure modules"><em>Modules</em></a>. Here is an example configuration:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">metricbeat.modules:
- module: awsfargate
  period: 10s
  metricsets:
    - task_stats</pre>
</div>
<h3><a id="_metricsets_9"></a>Metricsets<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/7.x/metricbeat/docs/modules/awsfargate.asciidoc">edit</a></h3>
<p>The following metricsets are available:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="metricbeat-metricset-awsfargate-task_stats.html" title="AWS Fargate task_stats metricset">task_stats</a>
</li>
</ul>
</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="metricbeat-metricset-aws-vpn.html">« AWS vpn metricset</a>
</span>
<span class="next">
<a href="metricbeat-metricset-awsfargate-task_stats.html">AWS Fargate task_stats metricset »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>
                <div class="col-xs-12 col-sm-4 col-md-4" id="right_col">
                  <div id="rtpcontainer" style="display: block;">
                    <div class="mktg-promo">
                      <h3>Most Popular</h3>
                      <ul class="icons">
                        <li class="icon-elasticsearch-white"><a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">Get Started with Elasticsearch: Video</a></li>
                        <li class="icon-kibana-white"><a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">Intro to Kibana: Video</a></li>
                        <li class="icon-logstash-white"><a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">ELK for Logs & Metrics: Video</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";
	var localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}';
</script>
<script src="/static/js/swiftype_app_search.umd.min.js"></script>
<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
