<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Secure communication with Elasticsearch | Metricbeat Reference [8.15] | Elastic</title>
<meta class="elastic" name="content" content="Secure communication with Elasticsearch | Metricbeat Reference [8.15]">

<link rel="home" href="index.html" title="Metricbeat Reference [8.15]"/>
<link rel="up" href="securing-metricbeat.html" title="Secure Metricbeat"/>
<link rel="prev" href="beats-api-keys.html" title="Grant access using API keys"/>
<link rel="next" href="configuring-ssl-logstash.html" title="Secure communication with Logstash"/>
<meta class="elastic" name="product_version" content="8.15"/>
<meta class="elastic" name="product_name" content="Metricbeat"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Metricbeat/Reference/8.15"/>
<meta name="DC.subject" content="Metricbeat"/>
<meta name="DC.identifier" content="8.15"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles-v1.css" />
  </head>

  <!--© 2015-2025 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div class="navheader">
<span class="prev">
<a href="beats-api-keys.html">« Grant access using API keys</a>
</span>
<span class="next">
<a href="configuring-ssl-logstash.html">Secure communication with Logstash »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Metricbeat Reference [8.15]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="securing-metricbeat.html">Secure Metricbeat</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Secure communication with Elasticsearch</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.15/libbeat/docs/https.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="chapter xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="securing-communication-elasticsearch"></a>Secure communication with Elasticsearch<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.15/libbeat/docs/https.asciidoc">edit</a></h2>
</div></div></div>
<p>When sending data to a secured cluster through the <code class="literal">elasticsearch</code>
output, Metricbeat can use any of the following authentication methods:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Basic authentication credentials (username and password).
</li>
<li class="listitem">
Token-based API authentication.
</li>
<li class="listitem">
A client certificate.
</li>
</ul>
</div>
<p>Authentication is specified in the Metricbeat configuration file:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>To use <span class="strong strong"><strong>basic authentication</strong></span>, specify the <code class="literal">username</code> and <code class="literal">password</code> settings under <code class="literal">output.elasticsearch</code>.
For example:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">output.elasticsearch:
  hosts: ["https://myEShost:9200"]
  username: "metricbeat_writer" <a id="CO31-1"></a><i class="conum" data-value="1"></i>
  password: "YOUR_PASSWORD" <a id="CO31-2"></a><i class="conum" data-value="2"></i></pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO31-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>This user needs the privileges required to publish events to Elasticsearch.
To create a user like this, see <a class="xref" href="privileges-to-publish-events.html" title="Grant privileges and roles needed for publishing">Create a <em>publishing</em> user</a>.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO31-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>This example shows a hard-coded password, but you should store sensitive
values
in the <a class="xref" href="keystore.html" title="Secrets keystore for secure settings">secrets keystore</a>.</p>
</td>
</tr>
</table>
</div>
</li>
<li class="listitem">
<p>To use token-based <span class="strong strong"><strong>API key authentication</strong></span>, specify the <code class="literal">api_key</code> under <code class="literal">output.elasticsearch</code>.
For example:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">output.elasticsearch:
  hosts: ["https://myEShost:9200"]
  api_key: "ZCV7VnwBgnX0T19fN8Qe:KnR6yE41RrSowb0kQ0HWoA" <a id="CO32-1"></a><i class="conum" data-value="1"></i></pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO32-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>This API key must have the privileges required to publish events to Elasticsearch.
To create an API key like this, see <a class="xref" href="beats-api-keys.html" title="Grant access using API keys"><em>Grant access using API keys</em></a>.</p>
</td>
</tr>
</table>
</div>
</li>
</ul>
</div>
<div id="beats-tls" class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>To use <span class="strong strong"><strong>Public Key Infrastructure (PKI) certificates</strong></span> to authenticate users,
specify the <code class="literal">certificate</code> and <code class="literal">key</code> settings under <code class="literal">output.elasticsearch</code>.
For example:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">output.elasticsearch:
  hosts: ["https://myEShost:9200"]
  ssl.certificate: "/etc/pki/client/cert.pem" <a id="CO33-1"></a><i class="conum" data-value="1"></i>
  ssl.key: "/etc/pki/client/cert.key" <a id="CO33-2"></a><i class="conum" data-value="2"></i></pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO33-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>The path to the certificate for SSL client authentication</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO33-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>The client certificate key</p>
</td>
</tr>
</table>
</div>
<p>These settings assume that the
distinguished name (DN) in the certificate is mapped to the appropriate roles in
the <code class="literal">role_mapping.yml</code> file on each node in the Elasticsearch cluster. For more
information, see <a href="/guide/en/elasticsearch/reference/8.15/mapping-roles.html#mapping-roles-file" class="ulink" target="_top">Using role
mapping files</a>.</p>
<p>By default, Metricbeat uses the list of trusted certificate authorities (CA) from the
operating system where Metricbeat is running. If the certificate authority that signed your node certificates
is not in the host system&#8217;s trusted certificate authorities list, you need
to add the path to the <code class="literal">.pem</code> file that contains your CA&#8217;s certificate to the
Metricbeat configuration. This will configure Metricbeat to use a specific list of
CA certificates instead of the default list from the OS.</p>
<p>Here is an example configuration:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">output.elasticsearch:
  hosts: ["https://myEShost:9200"]
  ssl.certificate_authorities: <a id="CO34-1"></a><i class="conum" data-value="1"></i>
    - /etc/pki/my_root_ca.pem
    - /etc/pki/my_other_ca.pem
  ssl.certificate: "/etc/pki/client.pem" <a id="CO34-2"></a><i class="conum" data-value="2"></i>
  ssl.key: "/etc/pki/key.pem" <a id="CO34-3"></a><i class="conum" data-value="3"></i></pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO34-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Specify the path to the local <code class="literal">.pem</code> file that contains your Certificate
Authority&#8217;s certificate. This is needed if you use your own CA to sign your node certificates.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO34-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>The path to the certificate for SSL client authentication</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO34-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>The client certificate key</p>
</td>
</tr>
</table>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>For any given connection, the SSL/TLS certificates must have a subject
that matches the value specified for <code class="literal">hosts</code>, or the SSL handshake fails.
For example, if you specify <code class="literal">hosts: ["foobar:9200"]</code>, the certificate MUST
include <code class="literal">foobar</code> in the subject (<code class="literal">CN=foobar</code>) or as a subject alternative name
(SAN). Make sure the hostname resolves to the correct IP address. If no DNS is available, then
you can associate the IP address with your hostname in <code class="literal">/etc/hosts</code>
(on Unix) or <code class="literal">C:\Windows\System32\drivers\etc\hosts</code> (on Windows).</p>
</div>
</div>
</li>
</ul>
</div>
<h3 class="xpack"><a id="securing-communication-kibana"></a>Secure communication with the Kibana endpoint<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.15/libbeat/docs/https.asciidoc">edit</a></h3>
<p>If you&#8217;ve configured the <a class="xref" href="setup-kibana-endpoint.html" title="Configure the Kibana endpoint">Kibana endpoint</a>,
you can also specify credentials for authenticating with Kibana under <code class="literal">kibana.setup</code>.
If no credentials are specified, Kibana will use the configured authentication method
in the Elasticsearch output.</p>
<p>For example, specify a unique username and password to connect to Kibana like this:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">setup.kibana:
  host: "mykibanahost:5601"
  username: "metricbeat_kib_setup" <a id="CO35-1"></a><i class="conum" data-value="1"></i>
  password: "YOUR_PASSWORD" <a id="CO35-2"></a><i class="conum" data-value="2"></i></pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO35-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>This user needs privileges required to set up dashboards. To create a user like this,
see <a class="xref" href="privileges-to-setup-beats.html" title="Grant privileges and roles needed for setup">Create a <em>setup</em> user</a>.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO35-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>This example shows a hard-coded password, but you should store sensitive
values
in the <a class="xref" href="keystore.html" title="Secrets keystore for secure settings">secrets keystore</a>.</p>
</td>
</tr>
</table>
</div>
<h3 class="xpack"><a id="securing-communication-learn-more"></a>Learn more about secure communication<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.15/libbeat/docs/https.asciidoc">edit</a></h3>
<p>More information on sending data to a secured cluster is available in the configuration reference:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="elasticsearch-output.html" title="Configure the Elasticsearch output">Elasticsearch</a>
</li>
<li class="listitem">
<a class="xref" href="configuration-ssl.html" title="Configure SSL"><em>SSL</em></a>
</li>
<li class="listitem">
<a class="xref" href="setup-kibana-endpoint.html" title="Configure the Kibana endpoint"><em>Kibana endpoint</em></a>
</li>
</ul>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="beats-api-keys.html">« Grant access using API keys</a>
</span>
<span class="next">
<a href="configuring-ssl-logstash.html">Secure communication with Logstash »</a>
</span>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>

                        <!-- Feedback widget -->
                        <div id="feedbackWidgetContainer"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


        <div id='elastic-footer'></div>
        <script src='https://www.elastic.co/elastic-footer.js'></script>
        <!-- Footer Section end-->

      </section>
    </div>

    <!-- Feedback modal -->
    <div id="feedbackModalContainer"></div>

    <script src="/guide/static/jquery.js"></script>
    <script type="text/javascript" src="/guide/static/docs-v1.js"></script>
    <script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
