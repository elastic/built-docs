<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Google Cloud Platform module | Metricbeat Reference [master] | Elastic</title>
<meta class="elastic" name="content" content="Google Cloud Platform module | Metricbeat Reference [master]">

<link rel="home" href="index.html" title="Metricbeat Reference [master]"/>
<link rel="up" href="metricbeat-modules.html" title="Modules"/>
<link rel="prev" href="metricbeat-metricset-etcd-store.html" title="Etcd store metricset"/>
<link rel="next" href="metricbeat-metricset-gcp-billing.html" title="Google Cloud Platform billing metricset"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="Metricbeat"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Metricbeat/Reference/master"/>
<meta name="DC.subject" content="Metricbeat"/>
<meta name="DC.identifier" content="master"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <!--© 2015-2022 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  <div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Metricbeat Reference [master]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="metricbeat-modules.html">Modules</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="metricbeat-metricset-etcd-store.html">« Etcd store metricset</a>
</span>
<span class="next">
<a href="metricbeat-metricset-gcp-billing.html">Google Cloud Platform billing metricset »</a>
</span>
</div>
<div class="chapter xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="metricbeat-module-gcp"></a>Google Cloud Platform module<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/main/x-pack/metricbeat/module/gcp/_meta/docs.asciidoc">edit</a></h2>
</div></div></div>
<div class="sidebar">
<div class="titlepage"><div><div>
<p class="title"><strong>Prefer to use Elastic Agent for this use case?</strong></p>
</div></div></div>
<p>Refer to the
<a href="https://docs.elastic.co/en/integrations/gcp" class="ulink" target="_top">Elastic Integrations documentation</a>.</p>
<details>
<summary class="title">Learn more</summary>
<div class="content">
<p>Elastic Agent is a single, unified way to add monitoring for logs, metrics, and
other types of data to a host. It can also protect hosts from security threats,
query data from operating systems, forward data from remote services or
hardware, and more. Refer to the documentation for a detailed
<a href="/guide/en/fleet/master/beats-agent-comparison.html" class="ulink" target="_top">comparison of Beats and Elastic Agent</a>.</p>
</div>
</details>
</div>
<p>This module periodically fetches monitoring metrics from Google Cloud Platform using
<a href="https://cloud.google.com/monitoring/api/metrics_gcp" class="ulink" target="_top">Stackdriver Monitoring API</a> for Google Cloud Platform services.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Extra GCP charges on Stackdriver Monitoring API requests may be
generated by this module. Please see <a class="xref" href="metricbeat-module-gcp.html#gcp-api-requests" title="Rough estimation of the number of API calls">rough estimation of the number of API calls</a>
for more details.</p>
</div>
</div>
<h2><a id="_module_config_and_parameters"></a>Module config and parameters<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/main/x-pack/metricbeat/module/gcp/_meta/docs.asciidoc">edit</a></h2>
<p>This is a list of the possible module parameters you can tune:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>zone</strong></span>: A single string with the zone you want to monitor like <code class="literal">us-central1-a</code>.
Or you can specific a partial zone name like <code class="literal">us-central1-</code> or <code class="literal">us-central1-*</code>,
which will monitor all zones start with <code class="literal">us-central1-</code>: <code class="literal">us-central1-a</code>,
<code class="literal">us-central1-b</code>, <code class="literal">us-central1-c</code> and <code class="literal">us-central1-f</code>.
Please see <a href="https://cloud.google.com/compute/docs/regions-zones#available" class="ulink" target="_top">GCP zones</a>
for zones that are available in GCP.
</li>
<li class="listitem">
<span class="strong strong"><strong>region</strong></span>: A single string with the region you want to monitor like <code class="literal">us-central1</code>.
This will enable monitoring for all zones under this region. Or you can specific
a partial region name like <code class="literal">us-east</code> or <code class="literal">us-east*</code>, which will monitor all regions start with
<code class="literal">us-east</code>: <code class="literal">us-east1</code> and <code class="literal">us-east4</code>. If both region and zone are configured,
only region will be used.
Please see <a href="https://cloud.google.com/compute/docs/regions-zones#available" class="ulink" target="_top">GCP regions</a>
for regions that are available in GCP. If both <code class="literal">region</code> and <code class="literal">zone</code> are not
specified, metrics will be collected from all regions/zones.
</li>
<li class="listitem">
<span class="strong strong"><strong>project_id</strong></span>: A single string with your GCP Project ID
</li>
<li class="listitem">
<span class="strong strong"><strong>credentials_file_path</strong></span>: A single string pointing to the JSON file path
reachable by Metricbeat that you have created using IAM.
</li>
<li class="listitem">
<span class="strong strong"><strong>exclude_labels</strong></span>: (<code class="literal">true</code>/<code class="literal">false</code> default <code class="literal">false</code>) Do not extract extra labels
and metadata information from metricsets and fetch metrics only. At the moment,
<span class="strong strong"><strong>labels and metadata extraction is only supported</strong></span> in <code class="literal">compute</code> metricset.
</li>
<li class="listitem">
<span class="strong strong"><strong>period</strong></span>: A single time duration specified for this module collection frequency.
</li>
</ul>
</div>
<h2><a id="_example_configuration_23"></a>Example configuration<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/main/x-pack/metricbeat/module/gcp/_meta/docs.asciidoc">edit</a></h2>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p><code class="literal">compute</code> metricset is enabled to collect metrics from <code class="literal">us-central1-a</code> zone
in <code class="literal">elastic-observability</code> project.</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">- module: gcp
  metricsets:
    - compute
  zone: "us-central1-a"
  project_id: "elastic-observability"
  credentials_file_path: "your JSON credentials file path"
  exclude_labels: false
  period: 60s</pre>
</div>
</li>
<li class="listitem">
<p><code class="literal">compute</code> and <code class="literal">pubsub</code> metricsets are enabled to collect metrics from all zones
under <code class="literal">us-central1</code> region in <code class="literal">elastic-observability</code> project.</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">- module: gcp
  metricsets:
    - compute
    - pubsub
  region: "us-central1"
  project_id: "elastic-observability"
  credentials_file_path: "your JSON credentials file path"
  exclude_labels: false
  period: 60s</pre>
</div>
</li>
<li class="listitem">
<p><code class="literal">compute</code> metricset is enabled to collect metrics from all regions starts with
<code class="literal">us-west</code> in <code class="literal">elastic-observability</code> project, which includes all zones under
<code class="literal">us-west1</code>, <code class="literal">us-west2</code>, <code class="literal">us-west3</code> and <code class="literal">us-west4</code>.</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">- module: gcp
  metricsets:
    - compute
    - pubsub
  region: "us-west"
  project_id: "elastic-observability"
  credentials_file_path: "your JSON credentials file path"
  exclude_labels: false
  period: 60s</pre>
</div>
</li>
</ul>
</div>
<h2><a id="_authentication_authorization_and_permissions"></a>Authentication, authorization and permissions.<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/main/x-pack/metricbeat/module/gcp/_meta/docs.asciidoc">edit</a></h2>
<p>Authentication and authorization in Google Cloud Platform can be achieved in many ways. For the current version of the Google Cloud Platform module for Metricbeat, the only supported method is using Service Account JSON files. A typical JSON with a private key looks like this:</p>
<h3><a id="_example_credentials"></a>Example Credentials<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/main/x-pack/metricbeat/module/gcp/_meta/docs.asciidoc">edit</a></h3>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
  "type": "service_account",
  "project_id": "your-project-id",
  "private_key_id": "a_private_key_id",
  "private_key": "-----BEGIN PRIVATE KEY-----your private key\n-----END PRIVATE KEY-----\n",
  "client_email": "some-email@your-project-id.iam.gserviceaccount.com",
  "client_id": "123456",
  "auth_uri": "https://accounts.google.com/o/oauth2/auth",
  "token_uri": "https://oauth2.googleapis.com/token",
  "auth_provider_x509_cert_url": "https://www.googleapis.com/oauth2/v1/certs",
  "client_x509_cert_url": "https://www.googleapis.com/robot/v1/metadata/x509/metricbeat-testing%40your-project-id.iam.gserviceaccount.com"
}</pre>
</div>
<p>Generally, you have to create a Service Account and assign it the following roles or the permissions described on each role (applies to all metricsets):</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p><code class="literal">Monitoring Viewer</code>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">monitoring.metricDescriptors.list</code>
</li>
<li class="listitem">
<code class="literal">monitoring.timeSeries.list</code>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p><code class="literal">Compute Viewer</code>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">compute.instances.get</code>
</li>
<li class="listitem">
<code class="literal">compute.instances.list</code>
</li>
</ul>
</div>
</li>
</ul>
</div>
<p>You can play in IAM pretty much with your service accounts and Instance level access to your resources (for example, allowing that everything running in an Instance is authorized to use the Compute API). The module uses Google Cloud Platform libraries for authentication so many possibilities are open but the Module is only supported by using the method mentioned above.</p>
<h2><a id="_google_cloud_platform_module_under_the_hood"></a>Google Cloud Platform module: Under the hood<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/main/x-pack/metricbeat/module/gcp/_meta/docs.asciidoc">edit</a></h2>
<p>Google Cloud Platform offers the <a href="https://cloud.google.com/monitoring/api/metrics_gcp" class="ulink" target="_top">Stackdriver Monitoring API</a> to fetch metrics from its services. <span class="strong strong"><strong>Those metrics are retrieved one by one</strong></span>.</p>
<p>If you also want to <span class="strong strong"><strong>extract service labels</strong></span> (by setting <code class="literal">exclude_labels</code> to false, which is the default state). You also make a new API check on the corresponding service. Service labels requires a new API call to extract those metrics. In the worst case the number of API calls will be doubled. In the best case, all metrics come from the same GCP entity and 100% of the required information is included in the first API call (which is cached for subsequent calls).</p>
<p>If <code class="literal">period</code> value is set to 5-minute and sample period of the metric type is 60-second, then this module will collect data from this metric type once every 5 minutes with aggregation.
GCP monitoring data has a up to 240 seconds latency, which means latest monitoring data will be up to 4 minutes old. Please see <a href="https://cloud.google.com/monitoring/api/v3/latency-n-retention" class="ulink" target="_top">Latency of GCP Monitoring Metric Data</a> for more details.
In <code class="literal">gcp</code> module, metrics are collected based on this ingest delay, which is also obtained from ListMetricDescriptors API.</p>
<h3><a id="gcp-api-requests"></a>Rough estimation of the number of API calls<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/main/x-pack/metricbeat/module/gcp/_meta/docs.asciidoc">edit</a></h3>
<p>Google Cloud Platform pricing depends of the number of requests you do to their API&#8217;s. Here you have some information that you can use to make an estimation of the pricing you should expect. For example, imagine that you have a Compute Metricset activated and you don&#8217;t want to exclude labels. You have a total of 20 instances running in a particular GCP project, region and zone.</p>
<p>For example, if Compute Metricset fetches 14 metrics (which is the number of metrics fetched in the early beta version). Each of those metrics will attempt an API call to Compute API to retrieve also their metadata. Because you have 20 different instances, the total number of API calls that will be done on each refresh period are: 14 metrics + 20 instances = 34 API requests every 5 minutes if that is your current Period. 9792 API requests per day with one zone. If you add 2 zones more with the same amount of instances you&#8217;ll have 19584 API requests per day (9792 on each zone) or around 587520 per month for the Compute Metricset. This maths must be done for each different Metricset with slight variations.</p>
<h2><a id="_metricsets_28"></a>Metricsets<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/main/x-pack/metricbeat/module/gcp/_meta/docs.asciidoc">edit</a></h2>
<p>Currently, we have <code class="literal">billing</code>, <code class="literal">compute</code>,  <code class="literal">gke</code>, <code class="literal">loadbalancing</code>, <code class="literal">pubsub</code>, <code class="literal">metrics</code> and
<code class="literal">storage</code> metricset in <code class="literal">gcp</code> module.</p>
<h3><a id="_billing_3"></a><code class="literal">billing</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/main/x-pack/metricbeat/module/gcp/_meta/docs.asciidoc">edit</a></h3>
<p>This metricset fetches billing metrics from <a href="https://cloud.google.com/bigquery" class="ulink" target="_top">GCP BigQuery</a>
Cloud Billing allows users to export billing data into BigQuery automatically
throughout the day. This metricset gets access to the daily cost detail table
periodically to export billing metrics for further analysis.</p>
<p>The <code class="literal">billing</code> metricset comes with a predefined dashboard:</p>
<div class="imageblock">
<div class="content">
<img src="./images/metricbeat-gcp-billing-overview.png" alt="metricbeat gcp billing overview">
</div>
</div>
<h3><a id="_compute"></a><code class="literal">compute</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/main/x-pack/metricbeat/module/gcp/_meta/docs.asciidoc">edit</a></h3>
<p>This metricset fetches metrics from <a href="https://cloud.google.com/compute/" class="ulink" target="_top">Compute Engine</a>
Virtual Machines in Google Cloud Platform. The <code class="literal">compute</code> metricset contains some
of the metrics exported from the <a href="https://cloud.google.com/monitoring/api/metrics_gcp#gcp-compute" class="ulink" target="_top">GCP Compute Monitoring API</a>.
Extra labels and metadata are also extracted using the <a href="https://cloud.google.com/compute/docs/reference/rest/v1/instances/get" class="ulink" target="_top">Compute API</a>.
This is enough to get most of the info associated with a metric like compute
labels and metadata and metric specific Labels.</p>
<p>The <code class="literal">compute</code> metricset comes with a predefined dashboard:</p>
<div class="imageblock">
<div class="content">
<img src="./images/metricbeat-gcp-compute-overview.png" alt="metricbeat gcp compute overview">
</div>
</div>
<h3><a id="_gke"></a><code class="literal">gke</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/main/x-pack/metricbeat/module/gcp/_meta/docs.asciidoc">edit</a></h3>
<p>This metricset fetches metrics for <a href="https://cloud.google.com/kubernetes-engine" class="ulink" target="_top">Kubernetes Engine</a>.</p>
<p>The <code class="literal">gke</code> metricset contains all GA metrics exported by <a href="https://cloud.google.com/monitoring/api/metrics_kubernetes" class="ulink" target="_top">Cloud Monitoring Kubernetes metrics</a>.</p>
<p>Extra labels and metadata are also extracted using the <a href="https://cloud.google.com/compute/docs/reference/rest/v1/instances/get" class="ulink" target="_top">Compute API</a>.</p>
<p>The <code class="literal">gke</code> metricset comes with a predefined dashboard:</p>
<div class="imageblock">
<div class="content">
<img src="./images/metricbeat-gcp-gke-overview.png" alt="metricbeat gcp gke overview">
</div>
</div>
<h3><a id="_loadbalancing"></a><code class="literal">loadbalancing</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/main/x-pack/metricbeat/module/gcp/_meta/docs.asciidoc">edit</a></h3>
<p>This metricset fetches metrics from <a href="https://cloud.google.com/load-balancing/" class="ulink" target="_top">Load Balancing</a>
in Google Cloud Platform. The <code class="literal">loadbalancing</code> metricset contains all metrics
exported from the <a href="https://cloud.google.com/monitoring/api/metrics_gcp#gcp-loadbalancing" class="ulink" target="_top">GCP Load Balancing Monitoring API</a>.</p>
<p>The <code class="literal">loadbalancing</code> metricset comes with two predefined dashboards:</p>
<h4><a id="_https"></a>HTTPS<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/main/x-pack/metricbeat/module/gcp/_meta/docs.asciidoc">edit</a></h4>
<p>For HTTPS load balancing:
image::./images/metricbeat-gcp-load-balancing-https-overview.png[]</p>
<h4><a id="_l3"></a>L3<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/main/x-pack/metricbeat/module/gcp/_meta/docs.asciidoc">edit</a></h4>
<p>For L3 load balancing:
image::./images/metricbeat-gcp-load-balancing-l3-overview.png[]</p>
<h4><a id="_tcpsslproxy"></a>TCP/SSL/Proxy<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/main/x-pack/metricbeat/module/gcp/_meta/docs.asciidoc">edit</a></h4>
<p>For TCP/SSL/Proxy load balancing:
image::./images/metricbeat-gcp-load-balancing-tcp-ssl-proxy-overview.png[]</p>
<h3><a id="_pubsub"></a><code class="literal">pubsub</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/main/x-pack/metricbeat/module/gcp/_meta/docs.asciidoc">edit</a></h3>
<p>This metricset fetches metrics from <a href="https://cloud.google.com/pubsub/" class="ulink" target="_top">Pub/Sub</a>
topics and subscriptions in Google Cloud Platform. The <code class="literal">pubsub</code> metricset
contains all GA stage metrics exported from the
<a href="https://cloud.google.com/monitoring/api/metrics_gcp#gcp-pubsub" class="ulink" target="_top">GCP PubSub Monitoring API</a>.</p>
<p>The <code class="literal">pubsub</code> metricset comes with a predefined dashboard:</p>
<div class="imageblock">
<div class="content">
<img src="./images/metricbeat-gcp-pubsub-overview.png" alt="metricbeat gcp pubsub overview">
</div>
</div>
<h3><a id="_metrics_7"></a><code class="literal">metrics</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/main/x-pack/metricbeat/module/gcp/_meta/docs.asciidoc">edit</a></h3>
<p><code class="literal">metrics</code> metricset uses Google Cloud Operations/Stackdriver, which provides
visibility into the performance, uptime, and overall health of cloud-powered
applications. It collects metrics, events, and metadata from different services
from Google Cloud.
This metricset is to collect <a href="https://cloud.google.com/monitoring/api/metrics_gcp" class="ulink" target="_top">monitoring metrics</a>
from Google Cloud using <code class="literal">ListTimeSeries</code> API.</p>
<h3><a id="_storage_2"></a><code class="literal">storage</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/main/x-pack/metricbeat/module/gcp/_meta/docs.asciidoc">edit</a></h3>
<p>This metricset fetches metrics from <a href="https://cloud.google.com/storage/" class="ulink" target="_top">Storage</a>
in Google Cloud Platform. The <code class="literal">storage</code> metricset contains all GA metrics
exported from the <a href="https://cloud.google.com/monitoring/api/metrics_gcp#gcp-storage" class="ulink" target="_top">GCP Storage Monitoring API</a>.</p>
<p>We recommend users to define <code class="literal">period: 5m</code> for this metricset because in Google
Cloud, storage monitoring metrics are written every 5-minute sample period with
a 10-minute ingest delay.</p>
<p>The <code class="literal">storage</code> metricset comes with a predefined dashboard:</p>
<div class="imageblock">
<div class="content">
<img src="./images/metricbeat-gcp-storage-overview.png" alt="metricbeat gcp storage overview">
</div>
</div>
<h3><a id="_example_configuration_24"></a>Example configuration</h3>
<p>The Google Cloud Platform module supports the standard configuration options that are described
in <a class="xref" href="configuration-metricbeat.html" title="Configure modules"><em>Modules</em></a>. Here is an example configuration:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">metricbeat.modules:
- module: gcp
  metricsets:
    - compute
  region: "us-"
  project_id: "your project id"
  credentials_file_path: "your JSON credentials file path"
  exclude_labels: false
  period: 1m

- module: gcp
  metricsets:
    - pubsub
    - loadbalancing
    - firestore
    - dataproc
  zone: "us-central1-a"
  project_id: "your project id"
  credentials_file_path: "your JSON credentials file path"
  exclude_labels: false
  period: 1m

- module: gcp
  metricsets:
    - storage
  project_id: "your project id"
  credentials_file_path: "your JSON credentials file path"
  exclude_labels: false
  period: 5m

- module: gcp
  metricsets:
    - metrics
  project_id: "your project id"
  credentials_file_path: "your JSON credentials file path"
  exclude_labels: false
  period: 1m
  metrics:
    - aligner: ALIGN_NONE
      service: compute
      metric_types:
        - "instance/cpu/reserved_cores"
        - "instance/cpu/usage_time"
        - "instance/cpu/utilization"
        - "instance/uptime"

- module: gcp
  metricsets:
    - gke
  project_id: "your project id"
  credentials_file_path: "your JSON credentials file path"
  exclude_labels: false
  period: 1m

- module: gcp
  metricsets:
    - billing
  period: 24h
  project_id: "your project id"
  credentials_file_path: "your JSON credentials file path"
  dataset_id: "dataset id"
  table_pattern: "table pattern"
  cost_type: "regular"

- module: gcp
  metricsets:
    - carbon
  period: 24h
  project_id: "your project id"
  credentials_file_path: "your JSON credentials file path"
  dataset_id: "dataset id"
  table_pattern: "table pattern"</pre>
</div>
<h3><a id="_metricsets_29"></a>Metricsets</h3>
<p>The following metricsets are available:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="metricbeat-metricset-gcp-billing.html" title="Google Cloud Platform billing metricset">billing</a>
</li>
<li class="listitem">
<a class="xref" href="metricbeat-metricset-gcp-carbon.html" title="Google Cloud Platform carbon metricset">carbon</a>
</li>
<li class="listitem">
<a class="xref" href="metricbeat-metricset-gcp-compute.html" title="Google Cloud Platform compute metricset">compute</a>
</li>
<li class="listitem">
<a class="xref" href="metricbeat-metricset-gcp-dataproc.html" title="Google Cloud Platform dataproc metricset">dataproc</a>
</li>
<li class="listitem">
<a class="xref" href="metricbeat-metricset-gcp-firestore.html" title="Google Cloud Platform firestore metricset">firestore</a>
</li>
<li class="listitem">
<a class="xref" href="metricbeat-metricset-gcp-gke.html" title="Google Cloud Platform gke metricset">gke</a>
</li>
<li class="listitem">
<a class="xref" href="metricbeat-metricset-gcp-loadbalancing.html" title="Google Cloud Platform loadbalancing metricset">loadbalancing</a>
</li>
<li class="listitem">
<a class="xref" href="metricbeat-metricset-gcp-metrics.html" title="Google Cloud Platform metrics metricset">metrics</a>
</li>
<li class="listitem">
<a class="xref" href="metricbeat-metricset-gcp-pubsub.html" title="Google Cloud Platform pubsub metricset">pubsub</a>
</li>
<li class="listitem">
<a class="xref" href="metricbeat-metricset-gcp-storage.html" title="Google Cloud Platform storage metricset">storage</a>
</li>
</ul>
</div>










</div>
<div class="navfooter">
<span class="prev">
<a href="metricbeat-metricset-etcd-store.html">« Etcd store metricset</a>
</span>
<span class="next">
<a href="metricbeat-metricset-gcp-billing.html">Google Cloud Platform billing metricset »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
