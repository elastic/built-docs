<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Exporting GeoIP Information | Packetbeat Reference [5.5] | Elastic</title>
<meta class="elastic" name="content" content="Exporting GeoIP Information | Packetbeat Reference [5.5]">

<link rel="home" href="index.html" title="Packetbeat Reference [5.5]"/>
<link rel="up" href="configuring-howto-packetbeat.html" title="Configuring Packetbeat"/>
<link rel="prev" href="configuring-ingest-node.html" title="Configuring Packetbeat to Use Ingest Node"/>
<link rel="next" href="config-packetbeat-logstash.html" title="Configuring Packetbeat to Use Logstash"/>
<meta class="elastic" name="product_version" content="5.5"/>
<meta class="elastic" name="product_name" content="Packetbeat"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Packetbeat/Reference/5.5"/>
<meta name="DC.subject" content="Packetbeat"/>
<meta name="DC.identifier" content="5.5"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles-v1.css" />
  </head>

  <!--© 2015-2025 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div class="page_header">
<p>
  <strong>WARNING</strong>: Version 5.5 of Packetbeat has passed its 
  <a href="https://www.elastic.co/support/eol">EOL date</a>. 
</p>  
<p>
  This documentation is no longer being maintained and may be removed. 
  If you are running this version, we strongly advise you to upgrade. 
  For the latest information, see the 
  <a href="../current/index.html">current release documentation</a>. 
</p>
</div>
<div class="navheader">
<span class="prev">
<a href="configuring-ingest-node.html">« Configuring Packetbeat to Use Ingest Node</a>
</span>
<span class="next">
<a href="config-packetbeat-logstash.html">Configuring Packetbeat to Use Logstash »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Packetbeat Reference [5.5]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="configuring-howto-packetbeat.html">Configuring Packetbeat</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Exporting GeoIP Information</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/5.5/packetbeat/docs/packetbeat-geoip.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="chapter">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="packetbeat-geoip"></a>Exporting GeoIP Information</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/5.5/packetbeat/docs/packetbeat-geoip.asciidoc">edit</a></div>
</div></div></div>
<p>You can use Packetbeat along with the
<a href="/guide/en/elasticsearch/plugins/5.5/ingest-geoip.html" class="ulink" target="_top">ingest geoIP processor plugin</a> in Elasticsearch
to export geographic location information about source IPs for incoming HTTP
requests. Then you can use this info to visualize the location of your
clients on a map in Kibana.</p>
<p>Prior to version 5.0, Packetbeat provided a <code class="literal">geoip</code> configuration option for
exporting geoIP information about the source IPs.  Starting with 5.0, the
<code class="literal">geoip</code> configuration option in Beats is deprecated in favor of using the
ingest geoIP processor plugin. This plugin adds information about the
geographical location of IP addresses, based on data from the Maxmind GeoLite2
City Database. Because the plugin uses a geoIP database that&#8217;s installed on
Elasticsearch, you no longer need to install a geoIP database on the
machines running Beats.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>If your use case involves using Logstash, you can use the
<a href="/guide/en/logstash/5.5/plugins-filters-geoip.html" class="ulink" target="_top">GeoIP filter</a> available in Logstash
instead of using the ingest plugin. However, using the ingest plugin is the
simplest approach when you don&#8217;t require the additional processing power of
Logstash.</p>
</div>
</div>
<div class="position-relative"><h3><a id="packetbeat-configuring-geoip"></a>Configuring the Ingest GeoIP Processor Plugin</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/5.5/packetbeat/docs/packetbeat-geoip.asciidoc">edit</a></div>
<p>To configure Packetbeat and the ingest geoIP processor plugin:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<a href="/guide/en/elasticsearch/plugins/5.5/ingest-geoip.html" class="ulink" target="_top">Install the ingest geoIP processor plugin</a>.
After installing the plugin, remember to restart the node.
</li>
<li class="listitem">
<p>Define an ingest node pipeline that uses a <code class="literal">geoip</code> processor to add location
info to the event. For example, you can use the Console in Kibana to create the
following pipeline:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">PUT _ingest/pipeline/geoip-info
{
  "description": "Add geoip info",
  "processors": [
    {
      "geoip": {
        "field": "client_ip",
        "target_field": "client_geoip",
        "properties": ["location"],
        "ignore_failure": true
      }
    }
  ]
}</pre>
</div>
<p>This pipeline adds a <code class="literal">client_geoip.location</code> field of type <code class="literal">geo_point</code> to the
event. The ID of the pipeline is <code class="literal">geoip-info</code>. <code class="literal">client_ip</code> is the output field
in Packetbeat that contains the IP address of the client. You set
<code class="literal">ignore_failure</code> to <code class="literal">true</code> so that the pipeline will continue processing events
when it encounters an event that doesn&#8217;t have a <code class="literal">client_ip</code> field.</p>
<p>See
<a href="/guide/en/elasticsearch/plugins/5.5/using-ingest-geoip.html" class="ulink" target="_top">Using the Geoip Processor in a Pipeline</a>
for more options.</p>
</li>
<li class="listitem">
<p>In the Packetbeat config file, configure the Elasticsearch output to use the
pipeline. Specify the pipeline ID in the <code class="literal">pipeline</code> option under
<code class="literal">output.elasticsearch</code>. For example:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">output.elasticsearch:
  hosts: ["localhost:9200"]
  pipeline: geoip-info</pre>
</div>
</li>
<li class="listitem">
<p>Run Packetbeat, passing in the configuration file that you updated earlier.</p>
<div class="pre_wrapper lang-shell">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-shell">./packetbeat -e -c packetbeat.yml</pre>
</div>
<p>The event that&#8217;s sent to Elasticsearch should now include a
<code class="literal">client_geoip.location</code> field.</p>
</li>
</ol>
</div>
<div class="position-relative"><h3><a id="packetbeat-visualizing-location"></a>Visualizing the Location of Your Packetbeat Clients</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/5.5/packetbeat/docs/packetbeat-geoip.asciidoc">edit</a></div>
<p>To visualize the location of your Packetbeat clients, you can either
<a class="xref" href="packetbeat-sample-dashboards.html" title="Step 5: Loading Sample Kibana Dashboards">import the Kibana dashboard for Packetbeat</a> (if
you haven&#8217;t already), or create a new <a href="/guide/en/kibana/5.5/tilemap.html" class="ulink" target="_top">Tile map</a> in
Kibana and use the <code class="literal">client_geoip.location</code> field as the Geohash.</p>
<p><span class="image"><img src="./images/kibana-update-map.png" alt="Update Packetbeat client location map in Kibana"></span></p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>If the map in the dashboard reports "no results found", and you don&#8217;t see
<code class="literal">client_geoip.location</code> in the list of available Geohash fields, try refreshing
the field list in Kibana. On the Management tab, select the <code class="literal">packetbeat-*</code>
index pattern, and refresh the field list to pick up any fields that were added
by the ingest geoIP processor.</p>
</div>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="configuring-ingest-node.html">« Configuring Packetbeat to Use Ingest Node</a>
</span>
<span class="next">
<a href="config-packetbeat-logstash.html">Configuring Packetbeat to Use Logstash »</a>
</span>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>

                        <!-- Feedback widget -->
                        <div id="feedbackWidgetContainer"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


        <div id='elastic-footer'></div>
        <script src='https://www.elastic.co/elastic-footer.js'></script>
        <!-- Footer Section end-->

      </section>
    </div>

    <!-- Feedback modal -->
    <div id="feedbackModalContainer"></div>

    <script src="/guide/static/jquery.js"></script>
    <script type="text/javascript" src="/guide/static/docs-v1.js"></script>
    <script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
