<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Capture HTTP traffic | Packetbeat Reference [6.5] | Elastic</title>
<link rel="home" href="index.html" title="Packetbeat Reference [6.5]"/>
<link rel="up" href="configuration-protocols.html" title="Specify which transaction protocols to monitor"/>
<link rel="prev" href="packetbeat-dns-options.html" title="Capture DNS traffic"/>
<link rel="next" href="packetbeat-amqp-options.html" title="Capture AMQP traffic"/>
<meta name="DC.type" content="Learn/Docs/Packetbeat/Reference/6.5"/>
<meta name="DC.subject" content="Packetbeat"/>
<meta name="DC.identifier" content="6.5"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <!--© 2015-2022 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!--BEGIN QUALTRICS WEBSITE FEEDBACK SNIPPET-->
    <script type='text/javascript'>
      (function(){var g=function(e,h,f,g){
      this.get=function(a){for(var a=a+"=",c=document.cookie.split(";"),b=0,e=c.length;b<e;b++){for(var d=c[b];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return null};
      this.set=function(a,c){var b="",b=new Date;b.setTime(b.getTime()+6048E5);b="; expires="+b.toGMTString();document.cookie=a+"="+c+b+"; path=/; "};
      this.check=function(){var a=this.get(f);if(a)a=a.split(":");else if(100!=e)"v"==h&&(e=Math.random()>=e/100?0:100),a=[h,e,0],this.set(f,a.join(":"));else return!0;var c=a[1];if(100==c)return!0;switch(a[0]){case "v":return!1;case "r":return c=a[2]%Math.floor(100/c),a[2]++,this.set(f,a.join(":")),!c}return!0};
      this.go=function(){if(this.check()){var a=document.createElement("script");a.type="text/javascript";a.src=g;document.body&&document.body.appendChild(a)}};
      this.start=function(){var a=this;window.addEventListener?window.addEventListener("load",function(){a.go()},!1):window.attachEvent&&window.attachEvent("onload",function(){a.go()})}};
      try{(new g(100,"r","QSI_S_ZN_emkP0oSe9Qrn7kF","https://znemkp0ose9qrn7kf-elastic.siteintercept.qualtrics.com/WRSiteInterceptEngine/?Q_ZID=ZN_emkP0oSe9Qrn7kF")).start()}catch(i){}})();
    </script><div id='ZN_emkP0oSe9Qrn7kF'><!--DO NOT REMOVE-CONTENTS PLACED HERE--></div>
    <!--END WEBSITE FEEDBACK SNIPPET-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  <div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="index.html">Packetbeat Reference [6.5]</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="configuring-howto-packetbeat.html">Configuring Packetbeat</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="configuration-protocols.html">Specify which transaction protocols to monitor</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="packetbeat-dns-options.html">« Capture DNS traffic</a>
</span>
<span class="next">
<a href="packetbeat-amqp-options.html">Capture AMQP traffic »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="packetbeat-http-options"></a>Capture HTTP traffic<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/6.5/packetbeat/docs/packetbeat-options.asciidoc">edit</a></h2>
</div></div></div>

<p>The HTTP protocol has several specific configuration options. Here is a
sample configuration for the <code class="literal">http</code> section of the <code class="literal">packetbeat.yml</code> config file:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">packetbeat.protocols:
- type: http
  ports: [80, 8080, 8000, 5000, 8002]
  hide_keywords: ["pass", "password", "passwd"]
  send_headers: ["User-Agent", "Cookie", "Set-Cookie"]
  split_cookie: true
  real_ip_header: "X-Forwarded-For"</pre>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_configuration_options_4"></a>Configuration options<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/6.5/packetbeat/docs/packetbeat-options.asciidoc">edit</a></h3>
</div></div></div>
<p>Also see <a class="xref" href="common-protocol-options.html" title="Common protocol options">Common protocol options</a>.</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_hide_keywords"></a><code class="literal">hide_keywords</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/6.5/packetbeat/docs/packetbeat-options.asciidoc">edit</a></h4>
</div></div></div>
<p>A list of query parameters that Packetbeat will automatically censor in
the transactions that it saves. The values associated with these parameters are replaced
by <code class="literal">'xxxxx'</code>. By default, no changes are made to the HTTP messages.</p>
<p>Packetbeat has this option because, unlike SQL traffic, which typically only contains the
hashes of the passwords, HTTP traffic may contain sensitive data. To reduce security risks,
you can configure this option to avoid sending the contents of certain HTTP POST
parameters.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This option replaces query parameters from GET requests and top-level
parameters from POST requests. If sensitive data is encoded inside a
parameter that you don&#8217;t specify here, Packetbeat cannot censor it. Also, note that if
you configure Packetbeat to save the raw request and response fields (see the <a class="xref" href="common-protocol-options.html#send-request-option" title="send_request"><code class="literal">send_request</code></a>
and the <a class="xref" href="common-protocol-options.html#send-response-option" title="send_response"><code class="literal">send_response</code></a> options), sensitive data may be present in those
fields.</p>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_redact_authorization"></a><code class="literal">redact_authorization</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/6.5/packetbeat/docs/packetbeat-options.asciidoc">edit</a></h4>
</div></div></div>
<p>When this option is enabled, Packetbeat obscures the value of
<code class="literal">Authorization</code> and <code class="literal">Proxy-Authorization</code> HTTP headers, and censors
those strings in the response.</p>
<p>You should set this option to true for transactions that use Basic Authentication because
they may contain the base64 unencrypted username and password.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_send_headers"></a><code class="literal">send_headers</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/6.5/packetbeat/docs/packetbeat-options.asciidoc">edit</a></h4>
</div></div></div>
<p>A list of header names to capture and send to Elasticsearch. These
headers are placed under the <code class="literal">headers</code> dictionary in the resulting JSON.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_send_all_headers"></a><code class="literal">send_all_headers</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/6.5/packetbeat/docs/packetbeat-options.asciidoc">edit</a></h4>
</div></div></div>
<p>Instead of sending a white list of headers to Elasticsearch, you can
send all headers by setting this option to true. The default is false.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_include_body_for"></a><code class="literal">include_body_for</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/6.5/packetbeat/docs/packetbeat-options.asciidoc">edit</a></h4>
</div></div></div>
<p>The list of content types for which Packetbeat exports the full HTTP payload. The HTTP body is available under
<code class="literal">http.request.body</code> and <code class="literal">http.response.body</code> for these Content-Types.</p>
<p>In addition, if <a class="xref" href="common-protocol-options.html#send-response-option" title="send_response"><code class="literal">send_response</code></a> option is enabled, then the HTTP body is exported together with the HTTP
headers under <code class="literal">response</code> and if
<a class="xref" href="common-protocol-options.html#send-request-option" title="send_request"><code class="literal">send_request</code></a> enabled, then <code class="literal">request</code> contains the entire HTTP message including the body.</p>
<p>In the following example, the HTML attachments of the HTTP responses are exported under the <code class="literal">response</code> field and under
<code class="literal">http.request.body</code> or <code class="literal">http.response.body</code>:</p>
<div class="pre_wrapper lang-yml">
<pre class="programlisting prettyprint lang-yml">packetbeat.protocols:
- type: http
  ports: [80, 8080]
  send_response: true
  include_body_for: ["text/html"]</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_split_cookie"></a><code class="literal">split_cookie</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/6.5/packetbeat/docs/packetbeat-options.asciidoc">edit</a></h4>
</div></div></div>
<p>If the <code class="literal">Cookie</code> or <code class="literal">Set-Cookie</code> headers are sent, this option controls whether
they are split into individual values. For example, with this option set, an
HTTP response might result in the following JSON:</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">"response": {
  "code": 200,
  "headers": {
    "connection": "close",
    "content-language": "en",
    "content-type": "text/html; charset=utf-8",
    "date": "Fri, 21 Nov 2014 17:07:34 GMT",
    "server": "gunicorn/19.1.1",
    "set-cookie": { <a id="CO7-1"></a><i class="conum" data-value="1"></i>
      "csrftoken": "S9ZuJF8mvIMT5CL4T1Xqn32wkA6ZSeyf",
      "expires": "Fri, 20-Nov-2015 17:07:34 GMT",
      "max-age": "31449600",
      "path": "/"
    },
    "vary": "Cookie, Accept-Language"
  },
  "phrase": "OK"
}</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO7-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Note that <code class="literal">set-cookie</code> is a map containing the cookie names as keys.</p>
</td>
</tr>
</table>
</div>
<p>The default is false.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_real_ip_header"></a><code class="literal">real_ip_header</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/6.5/packetbeat/docs/packetbeat-options.asciidoc">edit</a></h4>
</div></div></div>
<p>The header field to extract the real IP from. This setting is useful when
you want to capture traffic behind a reverse proxy, but you want to get the geo-location
information. If this header is present and contains a valid IP addresses, the
information is used for the <code class="literal">real_ip</code> field.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_max_message_size"></a><code class="literal">max_message_size</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/6.5/packetbeat/docs/packetbeat-options.asciidoc">edit</a></h4>
</div></div></div>
<p>If an individual HTTP message is larger than this setting (in bytes), it will be trimmed
to this size. Unless this value is very small (&lt;1.5K), Packetbeat is able to still correctly
follow the transaction and create an event for it. The default is 10485760 (10 MB).</p>
</div>

</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="packetbeat-dns-options.html">« Capture DNS traffic</a>
</span>
<span class="next">
<a href="packetbeat-amqp-options.html">Capture AMQP traffic »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
