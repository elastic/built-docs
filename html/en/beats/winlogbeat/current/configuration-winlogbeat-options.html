<!DOCTYPE html>
<html lang="en-us">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Set up Winlogbeat
        | Winlogbeat Reference [7.2]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Winlogbeat Reference [7.2]" /><link rel="up" href="configuring-howto-winlogbeat.html" title="Configuring Winlogbeat" /><link rel="prev" href="configuring-howto-winlogbeat.html" title="Configuring Winlogbeat" /><link rel="next" href="configuration-general-options.html" title="Specify general settings" /><meta name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta name="DC.type" content="Learn/Docs/Winlogbeat/Reference/7.2" /><meta name="DC.subject" content="Winlogbeat" /><meta name="DC.identifier" content="7.2" />
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#ffffff">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <!-- DC tags section -->
    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" >
    <link rel="schema.DCTERMS" href="http://purl.org/dc/terms/" >
    
    <!-- end DC tags -->
    <meta name="description" content="" />
    <meta name="localized" content="true" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <!-- For third-generation iPad with high-resolution Retina display: -->
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <!-- For iPhone with high-resolution Retina display: -->
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <!-- For first- and second-generation iPad: -->
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- css -->
    <link href="/static/css/main.css" rel="stylesheet">
    <script src="/static/js/jquery.min.js"></script>
    <script src="/static/js/bootstrap.min.js"></script>
    <script src="/static/js/jquery.cookie.js"></script>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <script type="text/javascript">
      // -------------------- set language based on browser language --------------------
      var lang = '/'+(navigator.language || navigator.userLanguage).slice(0,2)+'/',
      locales = {
        '/en':'/',
        '/de/': '/de/',
        '/fr/': '/fr/',
        '/ja/':'/jp/',
        '/ko/':'/kr/',
        '/zh/':'/cn/',
        '/es/': '/es/'
      },
      localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}',
      currentlocale = JSON.parse(localeUrl).relative_url_prefix;

      if($.cookie("is_lang_detected") == undefined){
        if(locales[lang] != undefined && locales[lang] != currentlocale){
          locale_lang_url = locales[lang] + window.location.pathname.slice(1,window.location.pathname.length);
          $.cookie("is_lang_detected",true ,{ path: '/'});
          window.location = locale_lang_url;
        }
      }
            
      // --------------------- end of set language based on browser language -----------------
    </script>
    <link type="text/css" rel="stylesheet" href="/static/css/guide.css" />
  
<link rel="stylesheet" type="text/css" href="styles.css" />

</head>

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->
    
    <!-- new ga for staging server -->
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>
    <!-- new ga for staging server -->

    <!-- Elastic APM -->
    <!--
    <script src="https://www.elastic.co/static/js/elastic-apm-js-base.umd.min.2.2.0.js"></script>
    <script type="text/javascript">
      var elasticApm = init({
        serviceName: 'elastic-co-frontend',
        serverUrl: 'https://3ddd1ee09cc242c4b169d36f5a2b8b77.apm.us-west1.gcp.cloud.es.io:443',
        stackTraceLimit: 5,
        serviceVersion: '1.0.0'
      })
    
      var pageLoadName
      var pathname = window.location.pathname.replace(/\/es|\/pt|\/jp|\/pt|\/fr|\/kr|\/cn|\/de/g, '')
      var parts = pathname.split('/');
    
      if (parts.length && parts[1] === 'blog') {
        if (parts.length === 2) {
          pageLoadName =  '/blog';
        }
        else if (parts[2] === 'category') {
          pageLoadName =  '/blog/category';
        }
        else if (parts[2] === 'archive') {
          pageLoadName =  '/blog/archive';
        }
        else {
          pageLoadName =  '/blog/detail';
        }
      }
      else if (parts.length && parts[1] === 'elasticon') {
        if (parts.length === 2) {
          pageLoadName =  '/elasticon';
        }
        else if (parts.length === 5 && (parts[2] === 'conf' || parts[2] === 'tour')) {
          pageLoadName =  '/elasticon/overview';
        }
        else if (parts.length > 5 && (parts[2] === 'conf' || parts[2] === 'tour')) {
          pageLoadName =  '/elasticon/video';
        }
      }
      else if (parts.length && parts[1] === 'guide') {
        pageLoadName =  '/guide';
      }
      else if (parts.length === 2 && parts[1] === 'videos') {
        pageLoadName =  '/videos';
      }
      else if (parts.length > 2 && parts[1] === 'videos') {
        pageLoadName =  '/videos/detail';
      }
      else if (parts.length > 2 && parts[1] === 'webinars') {
        pageLoadName =  '/webinars/detail';
      }
      else {
        pageLoadName =  window.location.pathname;
      }
    
      console.log('apm pageLoadName:', pageLoadName, parts)
      elasticApm.setTags({env:"production"});
      elasticApm.setInitialPageLoadName(pageLoadName);
    </script>
    -->

    <!-- Header Section -->
    
    <div id='elastic-nav'></div>

    <link rel="stylesheet" type="text/css" href="/static/css/horizon-swiper.min.css">

    <style> 
      .m-shortcuts li a.m-search {
        background: url("/assets/blt7b9c4fe6528dc4ef/m-search-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}

      .m-shortcuts li a.m-docs {
        background: url("/assets/blt44d8b7530a76d01c/m-guide-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}

      .m-shortcuts li a.m-contact {
        background: url("/assets/blt878040795c9d083b/m-contact-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
    </style>

    <script type="text/javascript" src="/static/js/horizon-swiper.min.js"></script>

    <script type="text/javascript">
      $(document).ready( function(){
        // if($('#scrollable-pane li').length > 3){
          $('.horizon-swiper').horizonSwiper({
            showItems: 3,
            arrows: true
          }); 
        // }
        
        $('.navbar-toggle').on('click', function(){
          $('.mobile-navigation, .menu-open').hide();
          $('.navigation-wrapper').addClass('mobile-navigation');
          $('.navbar').addClass('menu-open');
          $('.menu-close').show();
        });
        $('.menu-close').on('click', function(){
          $('.navigation-wrapper').removeClass('mobile-navigation');
          $('.navbar').removeClass('menu-open');
          $('.menu-close').hide();
        });
    
        var active_url = "";
    
        $(".navbar-mobile-header-icon").click(function(index){
          $('.navigation-wrapper').toggleClass('menu-overlay');
          $(this).toggleClass("navbar-mobile-header-icon-click navbar-mobile-header-icon-out");
          $(".mobile-inner-nav").slideToggle(500);
          $(".mobile-inner-nav .navbar-nav a").each(function( index ) {
            $(this).css({'animation-delay': (index/25)+'0.4s'});
          });
        });
    
        $('.dropdown-btn').on('click', function(e){
          e.preventDefault();
          setDropdown();
        });
        
        function setDropdown() {
          $('#myDropdown').slideToggle();
        }
    
        $('body').on('click', function(event){
          if (!event.target.matches('.dropdown-btn')) {
    
            var dropdowns = $(".dropdown-content");
            var i;
            for (i = 0; i < dropdowns.length; i++) {
              var openDropdown = dropdowns[i];
              if (openDropdown.classList.contains('show')) {
                openDropdown.classList.remove('show');
              }
            }
          }
        });
    
      });
      $(window).resize(function () {
        $('.horizon-swiper').horizonSwiper({
          showItems: 3,
          arrows: true
        });
      });
    </script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">   

          <section id="guide" lang="en">
            <div class="container">
              <div class="row">
                <!-- start body -->
                
            <div class="col-xs-12 col-sm-8 col-md-8 guide-section">
            <!-- start body -->
<div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Winlogbeat Reference
      [7.2]
    </a></span> » <span class="breadcrumb-link"><a href="configuring-howto-winlogbeat.html">Configuring Winlogbeat</a></span> » <span class="breadcrumb-node">Set up Winlogbeat</span></div><div class="navheader"><span class="prev"><a href="configuring-howto-winlogbeat.html">
              « 
              Configuring Winlogbeat</a>
           
        </span><span class="next">
           
          <a href="configuration-general-options.html">Specify general settings
               »
            </a></span></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="configuration-winlogbeat-options"></a>Set up Winlogbeat<a href="https://github.com/elastic/beats/edit/7.2/winlogbeat/docs/winlogbeat-options.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>The <code class="literal">winlogbeat</code> section of the <code class="literal">winlogbeat.yml</code> config file specifies all options that are specific to Winlogbeat.
Most importantly, it contains the list of event logs to monitor.</p><p>Here is a sample configuration:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-yaml">winlogbeat.event_logs:
  - name: Application
    ignore_older: 72h
  - name: Security
  - name: System</pre></div><h3><a id="_configuration_options"></a>Configuration options<a href="https://github.com/elastic/beats/edit/7.2/winlogbeat/docs/winlogbeat-options.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>You can specify the following options in the <code class="literal">winlogbeat</code> section of the <code class="literal">winlogbeat.yml</code> config file:</p><h4><a id="_literal_registry_file_literal"></a><code class="literal">registry_file</code><a href="https://github.com/elastic/beats/edit/7.2/winlogbeat/docs/winlogbeat-options.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>The name of the file where Winlogbeat stores information that it uses to resume
monitoring after a restart. By default the file is stored as <code class="literal">.winlogbeat.yml</code>
in the directory where the Beat was started. When you run the process as a
Windows service, it’s recommended that you set the value to
<code class="literal">C:/ProgramData/winlogbeat/.winlogbeat.yml</code>.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-yaml">winlogbeat.registry_file: C:/ProgramData/winlogbeat/.winlogbeat.yml</pre></div><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>The forward slashes (/) in the path are automatically changed to
backslashes (\) for Windows compatibility. You can use either forward or
backslashes. Forward slashes are easier to work with in YAML because there is no
need to escape them.</p></div></div><h4><a id="_literal_shutdown_timeout_literal"></a><code class="literal">shutdown_timeout</code><a href="https://github.com/elastic/beats/edit/7.2/winlogbeat/docs/winlogbeat-options.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>The amount of time to wait for all events to be published when shutting down.
By default there is no shutdown timeout so Winlogbeat will stop without waiting.
When you restart it will resume from the last successfully published event in
each event log.</p><p>In some use cases you do want to wait for the publishing queue to drain before
exiting and that’s when you would use this option.</p><p>Valid time units are <code class="literal">ns</code>, <code class="literal">us</code>, <code class="literal">ms</code>, <code class="literal">s</code>, <code class="literal">m</code>, <code class="literal">h</code>.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-yaml">winlogbeat.shutdown_timeout: 30s</pre></div><h4><a id="_literal_event_logs_literal"></a><code class="literal">event_logs</code><a href="https://github.com/elastic/beats/edit/7.2/winlogbeat/docs/winlogbeat-options.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>A list of entries (called <span class="emphasis"><em>dictionaries</em></span> in YAML) that specify which event logs
to monitor. Each entry in the list defines an event log to monitor as well as
any information to be associated with the event log (filter, tags, and so on).
The <code class="literal">name</code> field is the only required field for each event log.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-yaml">winlogbeat.event_logs:
  - name: Application</pre></div><h4><a id="_literal_event_logs_batch_read_size_literal"></a><code class="literal">event_logs.batch_read_size</code><a href="https://github.com/elastic/beats/edit/7.2/winlogbeat/docs/winlogbeat-options.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><div class="warning admon"><div class="icon"><img alt="Warning" src="images/icons/warning.png" /></div><div class="admon_content"><p>This functionality is experimental and may be changed or removed completely in a future release. Elastic will take a best effort approach to fix any issues, but experimental features are not subject to the support SLA of official GA features.</p></div></div><p>The maximum number of event log records to read from the Windows API in a single
batch. The default batch size is 100. Most Windows versions return an error if
the value is larger than 1024. <span class="strong strong"><strong>This option is only available on operating systems supporting the Windows Event Log API (Microsoft Windows Vista and newer).</strong></span></p><p>Winlogbeat starts a goroutine (a lightweight thread) to read from each
individual event log. The goroutine reads a batch of event log records using the
Windows API, applies any processors to the events, publishes them to the
configured outputs, and waits for an acknowledgement from the outputs before
reading additional event log records.</p><h4><a id="configuration-winlogbeat-options-event_logs-name"></a><code class="literal">event_logs.name</code><a href="https://github.com/elastic/beats/edit/7.2/winlogbeat/docs/winlogbeat-options.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>The name of the event log to monitor. Each dictionary under <code class="literal">event_logs</code> must
have a <code class="literal">name</code> field. You can get a list of available event logs by running
<code class="literal">Get-EventLog *</code> in PowerShell.  Here is a sample of the output from the
command:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-sh">PS C:\Users\vagrant&gt; Get-EventLog *

  Max(K) Retain OverflowAction        Entries Log
  ------ ------ --------------        ------- ---
  20,480      0 OverwriteAsNeeded          75 Application
  20,480      0 OverwriteAsNeeded           0 HardwareEvents
     512      7 OverwriteOlder              0 Internet Explorer
  20,480      0 OverwriteAsNeeded           0 Key Management Service
  20,480      0 OverwriteAsNeeded       1,609 Security
  20,480      0 OverwriteAsNeeded       1,184 System
  15,360      0 OverwriteAsNeeded         464 Windows PowerShell</pre></div><p>Channel names can also be specified if running on Windows Vista or newer. A
channel is a named stream of events that transports events from an event source
to an event log. Most channels are tied to specific event publishers. Here is an
example showing how to list all channels using PowerShell.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-sh">PS C:\&gt; Get-WinEvent -ListLog * | Format-List -Property LogName
LogName : Application
LogName : HardwareEvents
LogName : Internet Explorer
LogName : Key Management Service
LogName : Security
LogName : System
LogName : Windows PowerShell
LogName : ForwardedEvents
LogName : Microsoft-Management-UI/Admin
LogName : Microsoft-Rdms-UI/Admin
LogName : Microsoft-Rdms-UI/Operational
LogName : Microsoft-Windows-Windows Firewall With Advanced Security/Firewall
...</pre></div><p>You must specify the full name of the channel in the configuration file.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-yaml">winlogbeat.event_logs:
  - name: Microsoft-Windows-Windows Firewall With Advanced Security/Firewall</pre></div><p>To read events from an archived <code class="literal">.evtx</code> file you can specify the <code class="literal">name</code> as the
absolute path (it cannot be relative) to the file. There’s a complete example
of how to read from an .evtx file in the <a class="link" href="faq.html#reading-from-evtx" title="Can Winlogbeat read from .evtx files?">FAQ</a>.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-yaml">winlogbeat.event_logs:
  - name: 'C:\backup\sysmon-2019.08.evtx'</pre></div><h4><a id="_literal_event_logs_ignore_older_literal"></a><code class="literal">event_logs.ignore_older</code><a href="https://github.com/elastic/beats/edit/7.2/winlogbeat/docs/winlogbeat-options.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>If this option is specified, Winlogbeat filters events that are older than the
specified amount of time. Valid time units are "ns", "us" (or "µs"), "ms", "s",
"m", "h". This option is useful when you are beginning to monitor an event log
that contains older records that you would like to ignore. This field is
optional.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-yaml">winlogbeat.event_logs:
  - name: Application
    ignore_older: 168h</pre></div><h4><a id="_literal_event_logs_forwarded_literal"></a><code class="literal">event_logs.forwarded</code><a href="https://github.com/elastic/beats/edit/7.2/winlogbeat/docs/winlogbeat-options.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>A boolean flag to indicate that the log contains only events collected from
remote hosts using the Windows Event Collector. The value defaults to true for
the ForwardedEvents log and false for any other log. <span class="strong strong"><strong>This option is only available on operating systems supporting the Windows Event Log API (Microsoft Windows Vista and newer).</strong></span></p><p>This settings allows Winlogbeat to optimize reads for forwarded events that are
already rendered. When the value is true Winlogbeat does not attempt to render
the event using message files from the host computer. The Windows Event
Collector subscription should be configured to use the "RenderedText" format
(this is the default) to ensure that the events are distributed with messages
and descriptions.</p><h4><a id="_literal_event_logs_event_id_literal"></a><code class="literal">event_logs.event_id</code><a href="https://github.com/elastic/beats/edit/7.2/winlogbeat/docs/winlogbeat-options.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>A whitelist and blacklist of event IDs. The value is a comma-separated list. The
accepted values are single event IDs to include (e.g. 4624), a range of event
IDs to include (e.g. 4700-4800), and single event IDs to exclude (e.g. -4735).
<span class="strong strong"><strong>This option is only available on operating systems supporting the Windows Event Log API (Microsoft Windows Vista and newer).</strong></span></p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-yaml">winlogbeat.event_logs:
  - name: Security
    event_id: 4624, 4625, 4700-4800, -4735</pre></div><div class="warning admon"><div class="icon"><img alt="Warning" src="images/icons/warning.png" /></div><div class="admon_content"><p>If you specify more that 22 event IDs to include or 22 event IDs to exclude,
Windows will prevent Winlogbeat from reading the event log because it limits the
number of conditions that can be used in an event log query. If this occurs a similar
warning as shown below will be logged by Winlogbeat, and it will continue
processing data from other event logs. For more information, see
<a class="ulink" href="https://support.microsoft.com/en-us/kb/970453" target="_top">https://support.microsoft.com/en-us/kb/970453</a>.</p><p><code class="literal">WARN EventLog[Application] Open() error. No events will be read from this
source. The specified query is invalid.</code></p><p>If you have more than 22 event IDs, you can workaround this Windows limitation
by using a drop_event[drop-event] processor to do the filtering after
Winlogbeat has received the events from Windows. The filter shown below is
equivalent to <code class="literal">event_id: 903, 1024, 4624</code> but can be expanded beyond 22
event IDs.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-yaml">winlogbeat.event_logs:
  - name: Security
    processors:
      - drop_event.when.not.or:
        - equals.event_id: 903
        - equals.event_id: 1024
        - equals.event_id: 4624</pre></div></div></div><h4><a id="_literal_event_logs_level_literal"></a><code class="literal">event_logs.level</code><a href="https://github.com/elastic/beats/edit/7.2/winlogbeat/docs/winlogbeat-options.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>A list of event levels to include. The value is a comma-separated list of
levels. <span class="strong strong"><strong>This option is only available on operating systems supporting the Windows Event Log API (Microsoft Windows Vista and newer).</strong></span></p><div class="informaltable"><table cellpadding="4px" border="1"><colgroup><col class="col_1" /><col class="col_2" /></colgroup><thead><tr><th align="left" valign="top">Level</th><th align="left" valign="top">Value</th></tr></thead><tbody><tr><td align="left" valign="top"><p>critical, crit</p></td><td align="left" valign="top"><p>1</p></td></tr><tr><td align="left" valign="top"><p>error, err</p></td><td align="left" valign="top"><p>2</p></td></tr><tr><td align="left" valign="top"><p>warning, warn</p></td><td align="left" valign="top"><p>3</p></td></tr><tr><td align="left" valign="top"><p>information, info</p></td><td align="left" valign="top"><p>0 or 4</p></td></tr><tr><td align="left" valign="top"><p>verbose</p></td><td align="left" valign="top"><p>5</p></td></tr></tbody></table></div><div class="pre_wrapper"><pre class="programlisting prettyprint lang-yaml">winlogbeat.event_logs:
  - name: Security
    level: critical, error, warning</pre></div><h4><a id="_literal_event_logs_provider_literal"></a><code class="literal">event_logs.provider</code><a href="https://github.com/elastic/beats/edit/7.2/winlogbeat/docs/winlogbeat-options.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>A list of providers (source names) to include. The value is a YAML list.
<span class="strong strong"><strong>This option is only available on operating systems supporting the Windows Event Log API (Microsoft Windows Vista and newer).</strong></span></p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-yaml">winlogbeat.event_logs:
  - name: Application
    provider:
      - Application Error
      - Application Hang
      - Windows Error Reporting
      - EMET</pre></div><p>You can obtain a list of providers associated with a log by using PowerShell.
Here is an example showing the providers associated with the Security log.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-sh">PS C:\&gt; (Get-WinEvent -ListLog Security).ProviderNames
DS
LSA
SC Manager
Security
Security Account Manager
ServiceModel 4.0.0.0
Spooler
TCP/IP
VSSAudit
Microsoft-Windows-Security-Auditing
Microsoft-Windows-Eventlog</pre></div><h4><a id="_literal_event_logs_include_xml_literal"></a><code class="literal">event_logs.include_xml</code><a href="https://github.com/elastic/beats/edit/7.2/winlogbeat/docs/winlogbeat-options.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>Boolean option that controls if the raw XML representation of an event is
included in the data sent by Winlogbeat. The default is false.
<span class="strong strong"><strong>This option is only available on operating systems supporting the Windows Event Log API (Microsoft Windows Vista and newer).</strong></span></p><p>The XML representation of the event is useful for troubleshooting purposes. The
data in the fields reported by Winlogbeat can be compared to the data in the XML
to diagnose problems.</p><p>Example:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-yaml">winlogbeat.event_logs:
  - name: Microsoft-Windows-Windows Defender/Operational
    include_xml: true</pre></div><h4><a id="_literal_event_logs_tags_literal"></a><code class="literal">event_logs.tags</code><a href="https://github.com/elastic/beats/edit/7.2/winlogbeat/docs/winlogbeat-options.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>A list of tags that the Beat includes in the <code class="literal">tags</code> field of each published
event. Tags make it easy to select specific events in Kibana or apply
conditional filtering in Logstash. These tags will be appended to the list of
tags specified in the general configuration.</p><p>Example:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-yaml">winlogbeat.event_logs:
  - name: CustomLog
    tags: ["web"]</pre></div><h4><a id="winlogbeat-configuration-fields"></a><code class="literal">event_logs.fields</code><a href="https://github.com/elastic/beats/edit/7.2/winlogbeat/docs/winlogbeat-options.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>Optional fields that you can specify to add additional information to the
output. For example, you might add fields that you can use for filtering event
data. Fields can be scalar values, arrays, dictionaries, or any nested
combination of these. By default, the fields that you specify here will be
grouped under a <code class="literal">fields</code> sub-dictionary in the output document. To store the
custom fields as top-level fields, set the <code class="literal">fields_under_root</code> option to true.
If a duplicate field is declared in the general configuration, then its value
will be overwritten by the value declared here.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-yaml">winlogbeat.event_logs:
  - name: CustomLog
    fields:
      customer_id: 51415432</pre></div><h4><a id="_literal_event_logs_fields_under_root_literal"></a><code class="literal">event_logs.fields_under_root</code><a href="https://github.com/elastic/beats/edit/7.2/winlogbeat/docs/winlogbeat-options.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>If this option is set to true, the custom <a class="link" href="configuration-winlogbeat-options.html#winlogbeat-configuration-fields" title="event_logs.fields">fields</a>
are stored as top-level fields in the output document instead of being grouped
under a <code class="literal">fields</code> sub-dictionary. If the custom field names conflict with other
field names added by Winlogbeat, then the custom fields overwrite the other
fields.</p><h4><a id="_literal_event_logs_processors_literal"></a><code class="literal">event_logs.processors</code><a href="https://github.com/elastic/beats/edit/7.2/winlogbeat/docs/winlogbeat-options.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>A list of processors to apply to the data generated by the event log.</p><p>See <a class="xref" href="filtering-and-enhancing-data.html" title="Filter and Enhance the exported data"><em>Filter and Enhance the exported data</em></a> for information about specifying
processors in your config.</p><h4><a id="_literal_event_logs_no_more_events_literal"></a><code class="literal">event_logs.no_more_events</code><a href="https://github.com/elastic/beats/edit/7.2/winlogbeat/docs/winlogbeat-options.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>The action that the event log reader should take when it receives a signal from
Windows that there are no more events to read. It can either <code class="literal">wait</code> for more
events to be written (the default behavior) or it can <code class="literal">stop</code>. The overall
Winlogbeat process will stop when all of the individual event log readers have
stopped. <span class="strong strong"><strong>This option is only available on operating systems supporting the Windows Event Log API (Microsoft Windows Vista and newer).</strong></span></p><p>Setting <code class="literal">no_more_events</code> to <code class="literal">stop</code> is useful when reading from archived event
log files where you want to read the whole file then exit. There’s a complete
example of how to read from an <code class="literal">.evtx</code> file in the <a class="link" href="faq.html#reading-from-evtx" title="Can Winlogbeat read from .evtx files?">FAQ</a>.</p></div><div class="navfooter"><span class="prev"><a href="configuring-howto-winlogbeat.html">
              « 
              Configuring Winlogbeat</a>
           
        </span><span class="next">
           
          <a href="configuration-general-options.html">Specify general settings
               »
            </a></span></div>
<!-- end body -->

            </div>
            <div class="col-xs-12 col-sm-4 col-md-4" id="right_col">
        
                  <div id="rtpcontainer" style="display: block;">
                    <div class="mktg-promo">
                      <h3>Getting Started Videos</h3>
                      <ul class="icons">
                        <li class="icon-elasticsearch-white"><a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">Starting Elasticsearch</a></li>
                        <li class="icon-kibana-white"><a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">Introduction to Kibana</a></li>
                        <li class="icon-logstash-white"><a href="https://www.elastic.co/webinars/getting-started-logstash?baymax=default&elektra=docs&storm=top-video">Logstash Starter Guide</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'</div>
<!-- Footer Section end-->

<script src='https://www.elastic.co/elastic-nav.js'></script>
<script src='https://www.elastic.co/elastic-footer.js'></script>

<style type="text/css">
	
        
            .Facebook a {background:url("/assets/bltf546ff2e0a8f2de5/facebook.svg") no-repeat;}
            .Facebook a:before {
                content: url("/assets/bltc24cf11c714ecfc4/facebook-hover.svg");
                width:0;
                height:0;
                visibility:hidden;
            }
        
        
            .Facebook a:hover {background:url("/assets/bltc24cf11c714ecfc4/facebook-hover.svg")}		
        
	
        
            .Twitter a {background:url("/assets/bltdd9556d6b24e2b85/twitter.svg") no-repeat;}
            .Twitter a:before {
                content: url("/assets/blt90b0372cc07a54d3/twitter-hover.svg");
                width:0;
                height:0;
                visibility:hidden;
            }
        
        
            .Twitter a:hover {background:url("/assets/blt90b0372cc07a54d3/twitter-hover.svg")}		
        
	
        
            .LinkedIn a {background:url("/assets/bltc4a77e0f52ce07f1/linkedin.svg") no-repeat;}
            .LinkedIn a:before {
                content: url("/assets/blt01ce654380e4ea6c/linkedin-hover.svg");
                width:0;
                height:0;
                visibility:hidden;
            }
        
        
            .LinkedIn a:hover {background:url("/assets/blt01ce654380e4ea6c/linkedin-hover.svg")}		
        
	
        
            .Xing a {background:url("/assets/bltc6347078dcc9ec76/xing.svg") no-repeat;}
            .Xing a:before {
                content: url("/assets/bltededebe5f7521a39/xing-hover.svg");
                width:0;
                height:0;
                visibility:hidden;
            }
        
        
            .Xing a:hover {background:url("/assets/bltededebe5f7521a39/xing-hover.svg")}		
        
	
        
            .YouTube a {background:url("/assets/blt4982061ce1aebc7f/youtube.svg") no-repeat;}
            .YouTube a:before {
                content: url("/assets/bltddeb6c6404ae81a5/youtube-hover.svg");
                width:0;
                height:0;
                visibility:hidden;
            }
        
        
            .YouTube a:hover {background:url("/assets/bltddeb6c6404ae81a5/youtube-hover.svg")}		
        
	
</style>

<script src="//app-lon02.marketo.com/js/forms2/js/forms2.min.js"></script>
<script>
$(document).ready(function(){

    var ipSuccess = function(data) {
        country = data.country_code;
        if (data.in_eu){
                        
            marketo_id = "6196";
            
        }else{ 
            marketo_id = "1398";

        }

        $('.subscribe-form form.sb-form').attr('id', 'mktoForm_' + marketo_id);
        if(window.MktoForms2){
            MktoForms2.loadForm("//app-lon02.marketo.com", "813-MAM-392", marketo_id,function(form){
                form.onSuccess(function(form){
                    $('#mktoForm_'+marketo_id).css('display','none');
                    $('.subscribe-wrapper .subscribe-form-container').hide();
                    $('.subscribe-wrapper').find('.form_thanks').removeClass('hide')
                    dataLayer.push({'event': 'mktoFormSubmit'});
                    return false;
                });
            });  
        }
    }

    var marketo_id;

    $.ajax({
        url: "/gdpr-data"
    }).success(function(data) {
        ipSuccess(data);
    });

})
</script>

      </section>
    </div>

    
     <script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";
	var localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}';
</script>
<script src="/static/js/swiftype_app_search.umd.min.js"></script>
<script src="/static/js/jquery.autocomplete.js"></script>
<script type="text/javascript" src="/static/js/slick.min.js"></script>
<script src="/static/js/nav-v5.js"></script>
<script src="/static/js/script.js"></script>
 
     
<script type="text/javascript">
$(document).ready(function(){
	if (window.location.hash.length) {
	      var target = $(window.location.hash);
	      target = target.length ? target : $(window.location.hash);
	      if (target.length) {
	        setTimeout(function(){ $(window).scrollTop(target.offset().top - 60); }, 1200);        
	      }
	}
	$('#guide').on('click','a[href*=#]:not([href=#])',function(e) {
			var flag=true;
		      if (location.pathname.replace(/^\//,'') == this.pathname.replace(/^\//,'') && location.hostname == this.hostname) {
		          var target = $(this.hash);
		          target = target.length ? target :$(this.hash);
		          if (target.length) {
		            if(flag){
		              flag=false;
		              var heightScroll=($('.tertiary-nav.navbar-fixed-top').height())?60:110;
		              $('html,body').animate({
		                  scrollTop: target.offset().top - heightScroll
		                }, 2000, function(){
		                  flag=true;
		                });
		            }                    
		          }
		      }
		    
	});

})

</script>

     <style></style>
     
  
            <script type="text/javascript" src="docs.js"></script>
<script type='text/javascript' src='https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js?lang=yaml'></script>

            </body>
        
</html>
