<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Load balancers | Elastic Cloud Enterprise Reference [2.6] | Elastic</title>
<meta class="elastic" name="content" content="Load balancers | Elastic Cloud Enterprise Reference [2.6]">

<link rel="home" href="index.html" title="Elastic Cloud Enterprise Reference [2.6]"/>
<link rel="up" href="ece-planning.html" title="Planning your installation"/>
<link rel="prev" href="ece-separation-of-roles.html" title="Separation of roles"/>
<link rel="next" href="ece-wildcard-dns.html" title="Wildcard DNS record"/>
<meta class="elastic" name="product_version" content="2.6"/>
<meta class="elastic" name="product_name" content="ECE"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/CloudEnterprise/Reference/2.6"/>
<meta name="DC.subject" content="ECE"/>
<meta name="DC.identifier" content="2.6"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="icon" href="/favicon.ico" sizes="32x32"/>
    <link rel="icon" href="/favicon.svg" type="image/svg+xml"/>
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" sizes="180x180"/>
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles-v1.css" />
  </head>

  <!--© 2015-2025 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div class="page_header">
<p>
  <strong>It is time to say goodbye</strong>: This version of Elastic Cloud Enterprise 
  has reached <a href="https://www.elastic.co/support/eol">end-of-life (EOL)</a>
  and is no longer supported. 
</p>  
<p>
  The documentation for this version is no longer being maintained. 
  If you are running this version, we strongly advise you to upgrade. 
  For the latest information, see the 
  <a href="../current/index.html">current release documentation</a>. 
</p>
</div>
<div class="navheader">
<span class="prev">
<a href="ece-separation-of-roles.html">« Separation of roles</a>
</span>
<span class="next">
<a href="ece-wildcard-dns.html">Wildcard DNS record »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Cloud Enterprise Reference [2.6]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="ece-planning.html">Planning your installation</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Load balancers</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/release-ms-41/docs/cloud-enterprise/ce-planning.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div id="url-to-v3" class="version-warning">
    <strong>IMPORTANT</strong>: This documentation is no longer updated. Refer to <a href="https://www.elastic.co/support/eol">Elastic's version policy</a> and the <a href="https://www.elastic.co/docs/deploy-manage/deploy/cloud-enterprise/ece-load-balancers">latest documentation</a>.
</div>
<div class="chapter">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="ece-load-balancers"></a>Load balancers</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/release-ms-41/docs/cloud-enterprise/ce-planning.asciidoc">edit</a></div>
</div></div></div>
<p>Elastic Cloud Enterprise is designed to be used in conjunction with at least one load balancer. A load balancer is not included with Elastic Cloud Enterprise, so you need to provide one yourself and place it in front of the Elastic Cloud Enterprise proxies.</p>
<p>Use the following recommendations to configure your load balancer:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>High availability</strong></span>: The exact number of load balancers depends on the utilization rate for your clusters. In a highly available installation, use at least two load balancers per availability zone in your installation.
</li>
<li class="listitem">
<span class="strong strong"><strong>Inbound ports</strong></span>: Load balancers require that inbound traffic is open on the ports used by Elasticsearch, Kibana, and the transport client. To learn more, see the <a class="xref" href="ece-prereqs-networking.html" title="Networking">networking prerequisites</a>.
</li>
<li class="listitem">
<span class="strong strong"><strong>Deployment traffic and control plane traffic</strong></span>: Create separate load balancers for deployment traffic (Elasticsearch and Kibana traffic) and control plane traffic (Cloud UI console and ECE} API). This separation allows you to migrate to a large installation topology without reconfiguring or creating an additional load balancer.
</li>
<li class="listitem">
<span class="strong strong"><strong>Traffic across proxies</strong></span>: Balance traffic evenly across all proxies. Proxies are constantly updated with the internal routing information on how to direct requests to clusters on allocators that are hosting their nodes across zones. Proxies prefer cluster nodes in their local zone and route requests primarily to nodes in their own zone.
</li>
<li class="listitem">
<span class="strong strong"><strong>Network</strong></span>: Use a network that is fast enough from a latency and throughput perspective to be considered local for the Elasticsearch clustering requirement. There shouldn&#8217;t be a major advantage in "preferring local" from a load balancer perspective (rather than a proxy perspective). This might even lead to potential hot spotting on specific proxies, so it should be avoided.
</li>
<li class="listitem">
<span class="strong strong"><strong>X-Forwarded-For</strong></span>: Configure load balancers to strip inbound <code class="literal">X-Forwarded-For</code> headers and replace them with the client source IP as seen by the load balancer. This is required to prevent clients from spoofing their IP addresses. Elastic Cloud Enterprise uses <code class="literal">X-Forwarded-For</code> to log client IP addresses and, if you have implemented IP filtering, to manage traffic.
</li>
<li class="listitem">
<span class="strong strong"><strong>HTTP</strong></span>: Use <em>HTTP mode</em> for ports 9200/9243 (HTTP traffic to clusters) and also for ports 12400/12443 (adminconsole traffic). Make sure that all load balancers or proxies sending HTTP traffic to deployments hosted on Elastic Cloud Enterprise are sending HTTP/1.1 traffic.
</li>
<li class="listitem">
<span class="strong strong"><strong>TCP</strong></span>: Use <em>TCP mode</em> for ports 9300/9343 (transport client traffic to clusters) and the load balancer should enable the proxy protocol support.
</li>
</ul>
</div>
<div class="position-relative"><h3><a id="ece_proxy_health_check_for_ece_2_0_and_earlier"></a>Proxy health check for ECE 2.0 and earlier</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/release-ms-41/docs/cloud-enterprise/ce-planning.asciidoc">edit</a></div>
<p>You can use <code class="literal">/__elb_health__</code> on your proxy hosts and check for a 200 response that indicates healthy.</p>
<pre class="screen">http://&lt;proxy-address&gt;:9200&gt;/__elb_health__</pre>
<p>or</p>
<pre class="screen">https://&lt;proxy-address&gt;:9243&gt;/__elb_health__</pre>
<p>This returns a healthy response as:</p>
<pre class="screen">{"ok":true,"status":200}</pre>
<div class="position-relative"><h3><a id="ece_proxy_health_check_for_ece_2_1_and_later"></a>Proxy health check for ECE 2.1 and later</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/release-ms-41/docs/cloud-enterprise/ce-planning.asciidoc">edit</a></div>
<p>For Elastic Cloud Enterprise 2.1 and later, the health check endpoint has changed.
You can use <code class="literal">/_health</code> on proxy hosts with a result of either a 200 OK to indicate healthy or a 502 Bad Gateway response for unhealthy. A healthy response also means that internal routing tables in the proxy are valid and initialized, but not necessarily up-to-date.</p>
<pre class="screen">http://PROXY_ADDRESS:9200/_health</pre>
<p>or</p>
<pre class="screen">https://PROXY_ADDRESS:9243/_health</pre>
<p>This returns a healthy response as:</p>
<pre class="screen">{"ok":true,"status":200}</pre>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="ece-separation-of-roles.html">« Separation of roles</a>
</span>
<span class="next">
<a href="ece-wildcard-dns.html">Wildcard DNS record »</a>
</span>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>

                        <!-- Feedback widget -->
                        <div id="feedbackWidgetContainer"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


        <div id='elastic-footer'></div>
        <script src='https://www.elastic.co/elastic-footer.js'></script>
        <!-- Footer Section end-->

      </section>
    </div>

    <!-- Feedback modal -->
    <div id="feedbackModalContainer"></div>

    <script src="/guide/static/jquery.js"></script>
    <script type="text/javascript" src="/guide/static/docs-v1.js"></script>
    <script type="text/javascript">
  window.initial_state = {"alternatives":{"console":{"php":{"hasAny":false},"go":{"hasAny":false},"ruby":{"hasAny":false},"java":{"hasAny":false},"javascript":{"hasAny":false},"python":{"hasAny":false},"csharp":{"hasAny":false}}}}</script>
  </body>
</html>
