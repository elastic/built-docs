<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Upgrade to Elasticsearch 5.x | Elastic Cloud Enterprise Reference [3.0] | Elastic</title>
<meta class="elastic" name="content" content="Upgrade to Elasticsearch 5.x | Elastic Cloud Enterprise Reference [3.0]">

<link rel="home" href="index.html" title="Elastic Cloud Enterprise Reference [3.0]"/>
<link rel="up" href="ece-upgrade-deployment.html" title="Upgrade versions"/>
<link rel="prev" href="ece-upgrading-v6.html" title="Upgrade to Elasticsearch 6.x"/>
<link rel="next" href="ece-upgrade-appsearch.html" title="Upgrade App Search to Enterprise Search"/>
<meta class="elastic" name="product_version" content="3.0"/>
<meta class="elastic" name="product_name" content="ECE"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/CloudEnterprise/Reference/3.0"/>
<meta name="DC.subject" content="ECE"/>
<meta name="DC.identifier" content="3.0"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles-v1.css" />
  </head>

  <!--© 2015-2025 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div class="page_header">
A newer version is available. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div class="navheader">
<span class="prev">
<a href="ece-upgrading-v6.html">« Upgrade to Elasticsearch 6.x</a>
</span>
<span class="next">
<a href="ece-upgrade-appsearch.html">Upgrade App Search to Enterprise Search »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Cloud Enterprise Reference [3.0]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="ece-administering-deployments.html">Administering deployments</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="ece-upgrade-deployment.html">Upgrade versions</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Upgrade to Elasticsearch 5.x</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-69/docs/shared/ec-ce-upgrading-v5.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="ece-upgrading-v5"></a>Upgrade to Elasticsearch 5.x<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-69/docs/shared/ec-ce-upgrading-v5.asciidoc">edit</a></h2>
</div></div></div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Version 5.6 of Elasticsearch has passed its <a href="/support/eol" class="ulink" target="_top">EOL date</a>. This documentation is no longer being maintained and may be removed. If you are running this version, we strongly advise you to <a class="xref" href="ece-upgrade-deployment.html" title="Upgrade versions">upgrade your deployment</a> to a more current version of the Elastic stack.</p>
</div>
</div>
<p>Elasticsearch 5.x provides major new features and improved usability, but there are a few things you need to keep in mind when upgrading to our latest and greatest software in Elastic Cloud Enterprise.</p>
<h4><a id="ece_breaking_changes_in_elasticsearch_5_x"></a>Breaking changes in Elasticsearch 5.x<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-69/docs/shared/ec-ce-upgrading-v5.asciidoc">edit</a></h4>
<p>A number of Elasticsearch queries were deprecated in version 2.0 or later and removed in version 5.x. Applications running deprecated queries might break after upgrading to 5.x.</p>
<p>Starting in Elasticsearch 2.3, a <a href="/guide/en/elasticsearch/reference/8.15/logging.html#deprecation-logging" class="ulink" target="_top">deprecation log</a> became available that can help you determine if your applications are affected. Before you upgrade, check this deprecation log. If you are using deprecated queries, you will need to update your applications.</p>
<p>A number of other items were changed or removed in Elasticsearch 5.0 and later. For more information, check <a href="/guide/en/elasticsearch/reference/5.6/breaking-changes-5.6.html" class="ulink" target="_top">Breaking changes in 5.6</a>.</p>
<h4><a id="ece-shield-migration-v5"></a>Migrating Shield configurations<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-69/docs/shared/ec-ce-upgrading-v5.asciidoc">edit</a></h4>
<p>In Elasticsearch 5.0 and later, the security features required to keep your Elastic Cloud Enterprise clusters safe became part of <a href="/guide/en/x-pack/6.2/xpack-introduction.html" class="ulink" target="_top">X-Pack</a>.</p>
<p>With the move to X-Pack, the biggest changes to security features for the Elastic Stack include the names of the security configuration options, TLS/SSL configuration, and how roles are defined. A few privileges have also been removed.</p>
<p>When you upgrade an Elasticsearch cluster on Elastic Cloud Enterprise to version 5.x, the upgrade process to the new X-Pack security features is handled for you. As part of the upgrade process, all users, roles, and user-role mappings that exist in your Shield configuration are upgraded to use the new X-Pack security features. In addition, two users are always created on version 5.x clusters, the <code class="literal">elastic</code> superuser and the <code class="literal">anonymous</code> user. Note that in Elasticsearch versions 7.10 and higher the <code class="literal">anonymous</code> user is disabled by default. Check <a href="/guide/en/elasticsearch/reference/8.15/anonymous-access.html" class="ulink" target="_top">Enabling anonymous access</a> to enable it.</p>
<p>If your cluster never had an active Shield configuration, or if you are not provided the password during the upgrade process, you might need to
<a class="xref" href="ece-password-reset-elastic.html" title="Reset the password for the elastic user">reset the password for the <code class="literal">elastic</code> user</a>
after upgrading to Elasticsearch 5.x. Users and applications will need to authenticate to be able to connect to your cluster.</p>
<p>After the upgrade is complete, you use the Kibana Management app for X-Pack to work with users and roles, which replaces the
Shield
Editor in previous releases:</p>
<div class="imageblock">
<div class="content">
<img src="images/kibana-users.png" alt="User and role management in Kibana">
</div>
</div>
<h4><a id="ece_indices_originally_created_in_older_versions_of_elasticsearch"></a>Indices originally created in older versions of Elasticsearch<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-69/docs/shared/ec-ce-upgrading-v5.asciidoc">edit</a></h4>
<p>Indices created in Elasticsearch before version 2.0 are not compatible with version 5.x, even if you upgraded your cluster to version 2.0 or later at some point. To upgrade to Elasticsearch 5.x with these indices, you must perform some additional steps.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>If you upgrade to Elasticsearch 5.x with indices that are not supported, your Elasticsearch cluster will not start. Please make sure you follow the steps in this section first.</p>
</div>
</div>
<p>The following steps apply to you if your current cluster was originally created in a version of Elasticsearch 2.0 or earlier, or if you are not sure what version your cluster originally used:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Check if you can upgrade to Elasticsearch 5.x directly.</p>
<p><span class="strong strong"><strong>For all versions of Elasticsearch:</strong></span> You can find out what version of Elasticsearch an index was created with by querying the index settings and looking at the value of <code class="literal">settings.index.version.created</code>. The first number in the value indicates the major version of Elasticsearch and any value that is below 2000000 is not readable in Elasticsearch 5.x, even if <code class="literal">settings.index.version.upgraded</code> shows a value that is greater than or equal to 2000000.</p>
<p>For example:</p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">- newdata: {
    aliases: { },
  + mappings: {…},
  - settings: {
      - index: {
          refresh_interval: "-1",
          number_of_shards: "5",
        - translog: {
            durability: "async"
        },
        creation_date: "1460043613621",
        number_of_replicas: "1",
        uuid: "n6kYaMYGT0OJx8McwGAzPw",
      - version: {
          created: "2030099"
          upgraded: "5000002"
        }
    }
  },
  warmers: { }
},</pre>
</div>
<p>Here is how you read the example:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If <code class="literal">created</code> indicates a value that is <span class="strong strong"><strong>greater than or equal to 2000000</strong></span>, you can upgrade to Elastisearch 5.x directly. In this example, the index was created with version 2.3.0 (<code class="literal">created: "2030099"</code>). You can skip the rest of the steps in this section and proceed to upgrade your cluster.
</li>
<li class="listitem">
<p>If <code class="literal">created</code> indicates a value that is <span class="strong strong"><strong>smaller than 2000000</strong></span>, you cannot upgrade to Elastisearch 5.x directly. Before you upgrade to Elasticsearch 5.x, follow the remaining steps in this section first.</p>
<p>Examples of <code class="literal">created</code> values that prevent you from upgrading to Elastisearch 5.x directly:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">1070199</code>
</span>
</dt>
<dd>
Indicates an index created with Elasticsearch 1.7.1.
</dd>
<dt>
<span class="term">
<code class="literal">1060299</code>
</span>
</dt>
<dd>
Indicates an index created with Elasticsearch 1.6.2.
</dd>
</dl>
</div>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>For Elasticsearch 2.0 and later:</strong></span> You can get a human-friendly value for the version that an index was created with by appending <code class="literal">?human=true</code> to your query URL.</p>
<p>For example, for an Elasticsearch cluster <code class="literal">a1b2c3d4a1b2c3d4a1b2c3d4a1b2c3d4</code> with the index named <code class="literal">test</code>, the URL <code class="literal">https://a1b2c3d4a1b2c3d4a1b2c3d4a1b2c3d4.us-east-1.aws.found.io:9243/test?human=true</code> returns a human-friendly version with the <code class="literal">created_string</code> (some output has been omitted for clarity):</p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">...
created_string: "2.3.2",
created: "2030299"
...</pre>
</div>
</li>
<li class="listitem">
<p>If you cannot upgrade to Elasticsearch 5.x directly, there are several options to get your cluster to version 5.x with minimal fuss:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Use the migration plugin that is available for Elasticsearch 2.3.0 and later by upgrading to 2.3 first. This means that you migrate in a two-step process, first by upgrading from 1.x to 2.3 and then by upgrading from 2.3 to 5.x with the migration plugin. This process performs an online reindex.
</li>
<li class="listitem">
<p>Use the upgrade functionality in Elastic Cloud Enterprise built around the Upgrade API. This option performs a remote reindex of your indices and checks if the upgraded cluster will be able to start after upgrading.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>There is additional overhead when you use this option. If your cluster is already running at capacity before the upgrade, Elastic recommends that you temporarily step up to the next available cluster size before upgrading, so that the reindex operation can complete in a reasonable amount of time. You can step down to the original cluster size after upgrading to avoid further costs.</p>
</div>
</div>
</li>
<li class="listitem">
If neither of those options work for you, you can also upgrade your indices on a cluster running Elasticsearch 2.3.x yourself with the Reindex API. For more information, check <a href="/guide/en/elasticsearch/reference/5.6/reindex-upgrade.html" class="ulink" target="_top">Reindex to upgrade</a>.
</li>
</ul>
</div>
</li>
</ol>
</div>
<p><span class="strong strong"><strong>A Note on Snapshots</strong></span></p>
<p>Snapshots cannot be restored in Elasticsearch 5.x, if they contain indices created in an Elasticsearch version before 2.0. To work around this restriction, you either need to discard these snapshots or you need to open them on a cluster running Elasticsearch 2.3 before reindexing and creating new snapshots.</p>
</div>
</div>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { equationNumbers: { autoNumber: "none" } }
})
MathJax.Hub.Register.StartupHook("AsciiMath Jax Ready", function () {
  MathJax.InputJax.AsciiMath.postfilterHooks.Add(function (data, node) {
    if ((node = data.script.parentNode) && (node = node.parentNode) && node.classList.contains('stemblock')) {
      data.math.root.display = "block"
    }
    return data
  })
})
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>
</div><div class="navfooter">
<span class="prev">
<a href="ece-upgrading-v6.html">« Upgrade to Elasticsearch 6.x</a>
</span>
<span class="next">
<a href="ece-upgrade-appsearch.html">Upgrade App Search to Enterprise Search »</a>
</span>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>

                        <!-- Feedback widget -->
                        <div id="feedbackWidgetContainer"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


        <div id='elastic-footer'></div>
        <script src='https://www.elastic.co/elastic-footer.js'></script>
        <!-- Footer Section end-->

      </section>
    </div>

    <!-- Feedback modal -->
    <div id="feedbackModalContainer"></div>

    <script src="/guide/static/jquery.js"></script>
    <script type="text/javascript" src="/guide/static/docs-v1.js"></script>
    <script type="text/javascript">
  window.initial_state = {"alternatives":{"console":{"php":{"hasAny":false},"go":{"hasAny":false},"ruby":{"hasAny":false},"java":{"hasAny":false},"javascript":{"hasAny":false},"python":{"hasAny":false},"csharp":{"hasAny":false}}}}</script>
  </body>
</html>
