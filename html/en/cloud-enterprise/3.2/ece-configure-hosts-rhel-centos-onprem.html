<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Red Hat Enterprise Linux (RHEL) and CentOS | Elastic Cloud Enterprise Reference [3.2] | Elastic</title>
<link rel="home" href="index.html" title="Elastic Cloud Enterprise Reference [3.2]"/>
<link rel="up" href="ece-configure-os-onprem.html" title="Configure your operating system"/>
<link rel="prev" href="ece-configure-hosts-ubuntu-onprem.html" title="Ubuntu 18.04 LTS (Bionic Beaver)"/>
<link rel="next" href="ece-configure-hosts-sles12-onprem.html" title="SUSE Linux Enterprise Server (SLES) 12"/>
<meta name="DC.type" content="Learn/Docs/CloudEnterprise/Reference/3.2"/>
<meta name="DC.subject" content="ECE"/>
<meta name="DC.identifier" content="3.2"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <!--© 2015-2022 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!--BEGIN QUALTRICS WEBSITE FEEDBACK SNIPPET-->
    <script type='text/javascript'>
      (function(){var g=function(e,h,f,g){
      this.get=function(a){for(var a=a+"=",c=document.cookie.split(";"),b=0,e=c.length;b<e;b++){for(var d=c[b];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return null};
      this.set=function(a,c){var b="",b=new Date;b.setTime(b.getTime()+6048E5);b="; expires="+b.toGMTString();document.cookie=a+"="+c+b+"; path=/; "};
      this.check=function(){var a=this.get(f);if(a)a=a.split(":");else if(100!=e)"v"==h&&(e=Math.random()>=e/100?0:100),a=[h,e,0],this.set(f,a.join(":"));else return!0;var c=a[1];if(100==c)return!0;switch(a[0]){case "v":return!1;case "r":return c=a[2]%Math.floor(100/c),a[2]++,this.set(f,a.join(":")),!c}return!0};
      this.go=function(){if(this.check()){var a=document.createElement("script");a.type="text/javascript";a.src=g;document.body&&document.body.appendChild(a)}};
      this.start=function(){var a=this;window.addEventListener?window.addEventListener("load",function(){a.go()},!1):window.attachEvent&&window.attachEvent("onload",function(){a.go()})}};
      try{(new g(100,"r","QSI_S_ZN_emkP0oSe9Qrn7kF","https://znemkp0ose9qrn7kf-elastic.siteintercept.qualtrics.com/WRSiteInterceptEngine/?Q_ZID=ZN_emkP0oSe9Qrn7kF")).start()}catch(i){}})();
    </script><div id='ZN_emkP0oSe9Qrn7kF'><!--DO NOT REMOVE-CONTENTS PLACED HERE--></div>
    <!--END WEBSITE FEEDBACK SNIPPET-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  <div class="page_header">
A newer version is available. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="index.html">Elastic Cloud Enterprise Reference [3.2]</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="ece-installing.html">Installing Elastic Cloud Enterprise</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="ece-install-your-infra.html">Install ECE on your own premises</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="ece-configure-os-onprem.html">Configure your operating system</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="ece-configure-hosts-ubuntu-onprem.html">« Ubuntu 18.04 LTS (Bionic Beaver)</a>
</span>
<span class="next">
<a href="ece-configure-hosts-sles12-onprem.html">SUSE Linux Enterprise Server (SLES) 12 »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ece-configure-hosts-rhel-centos-onprem"></a>Red Hat Enterprise Linux (RHEL) and CentOS<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-72/docs/cloud-enterprise/ce-configuring-rhel-centos.asciidoc">edit</a></h3>
</div></div></div>
<p>The following instructions show you how to prepare your hosts on Red Hat Enterprise Linux (RHEL) and on CentOS.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="ece-configure-hosts-rhel-centos-onprem.html#ece-supported-kernel-rhel-onprem" title="Check the supported Linux kernel">Check the supported Linux kernel</a>
</li>
<li class="listitem">
<a class="xref" href="ece-configure-hosts-rhel-centos-onprem.html#ece-install-docker-rhel-centos-onprem" title="Install Docker">Install Docker</a>
</li>
<li class="listitem">
<a class="xref" href="ece-configure-hosts-rhel-centos-onprem.html#ece-xfs-setup-rhel-onprem" title="Set up XFS quotas">Set up XFS quotas</a>
</li>
<li class="listitem">
<a class="xref" href="ece-configure-hosts-rhel-centos-onprem.html#ece-update-configuration-settings-rhel-onprem" title="Update the configurations settings">Update the configurations settings</a>
</li>
<li class="listitem">
<a class="xref" href="ece-configure-hosts-rhel-centos-onprem.html#ece-configure-docker-daemon-rhel-centos-onprem" title="Configure the Docker daemon options">Configure the Docker daemon options</a>
</li>
</ul>
</div>
<h5><a id="ece-supported-kernel-rhel-onprem"></a>Check the supported Linux kernel<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-72/docs/cloud-enterprise/ce-configuring-rhel-centos.asciidoc">edit</a></h5>
<p>Elastic Cloud Enterprise requires the default RHEL/CentOS 3.10.0-1160.31.1 or later kernel.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Use the following command to check your kernel version:</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">uname -r</pre>
</div>
<p>Before you proceed, update the OS, and reboot the system.</p>
</li>
<li class="listitem">
<p>Update the system:</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">sudo yum update
sudo reboot</pre>
</div>
</li>
<li class="listitem">
<p>Enable the <code class="literal">overlay2</code> kernel module:</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">echo "overlay2" | sudo tee -a /etc/modules-load.d/overlay.conf</pre>
</div>
</li>
<li class="listitem">
<p>Refresh the dynamically generated grub2 configuration and configure grub to boot the newly installed kernel 3.10.0-1160.31.1 or later:</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">sudo grub2-set-default 0
sudo grub2-mkconfig -o /etc/grub2.cfg</pre>
</div>
</li>
<li class="listitem">
<p>Add the required options to the kernel boot arguments:</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">sudo /sbin/grubby --update-kernel=ALL --args='cgroup_enable=memory cgroup.memory=nokmem swapaccount=1'</pre>
</div>
</li>
</ol>
</div>
<h5><a id="ece-install-docker-rhel-centos-onprem"></a>Install Docker<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-72/docs/cloud-enterprise/ce-configuring-rhel-centos.asciidoc">edit</a></h5>
<p>Which version of Docker you install depends on whether you use Red Hat Enterprise Linux (RHEL) or CentOS.</p>
<h6><a id="ece_rhel_or_centos_7_2"></a>RHEL or CentOS 7<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-72/docs/cloud-enterprise/ce-configuring-rhel-centos.asciidoc">edit</a></h6>
<p>If you are using RHEL/CentOS 7, install Docker version 20.10.7 or later:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Add the Docker repository:</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">sudo tee /etc/yum.repos.d/docker.repo &lt;&lt;-'EOF'
[dockerrepo]
name=Docker Repository
baseurl=https://download.docker.com/linux/centos/7/x86_64/stable
enabled=1
gpgcheck=1
gpgkey=https://download.docker.com/linux/centos/gpg
EOF

sudo yum makecache fast</pre>
</div>
</li>
</ol>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>On RHEL 7, enable the <code class="literal">rhel-7-server-extras-rpm</code> and <code class="literal">rhel-7-server-optional-rpms</code> repositories.</p>
</div>
</div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Install Docker version 20.10.7 or later:</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">sudo yum install -y docker-ce-20.10* docker-ce-cli-20.10* containerd.io-1.5.*</pre>
</div>
</li>
</ol>
</div>
<h6><a id="ece_rhel_8_or_centos_8_2"></a>RHEL 8 or CentOS 8<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-72/docs/cloud-enterprise/ce-configuring-rhel-centos.asciidoc">edit</a></h6>
<p>If you are using RHEL 8 or CentOS 8, install Docker version 20.10.7 or later:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Add the Docker repository:</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh"># Add yum config manager
sudo yum install -y 'dnf-command(config-manager)'

# Add the docker-ce centos yum repo
sudo yum config-manager --add-repo=https://download.docker.com/linux/centos/docker-ce.repo

# Update the yum cache
sudo yum makecache --timer</pre>
</div>
</li>
<li class="listitem">
<p>Install Docker version 20.10.7 or later:</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">sudo yum install -y docker-ce-20.10* docker-ce-cli-20.10* containerd.io-1.5.*</pre>
</div>
</li>
</ol>
</div>
<h5><a id="ece-xfs-setup-rhel-onprem"></a>Set up XFS quotas<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-72/docs/cloud-enterprise/ce-configuring-rhel-centos.asciidoc">edit</a></h5>
<p>XFS quotas are required to support disk space quotas for Elasticsearch data directories. Some Linux distributions such as RHEL and CentOS already provide XFS as the default file system; however, quotas might be disabled.</p>
<p>Disk space quotas set a limit on the amount of disk space a cluster node can use. Currently, quotas are calculated by
a static ratio of 1:32, which means that for every 1 GB of RAM a cluster is given, a cluster node is allowed to consume 32 GB of disk space.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>You can use use LVM, <code class="literal">mdadm</code>, or a combination of the two for block device management, but this configuration is not documented nor is it supported in Elastic Cloud Enterprise.</p>
</div>
</div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>You must use XFS on all allocators.</p>
</div>
</div>
<p>To set up XFS with quotas on a single, pre-partitioned block device named <code class="literal">/dev/xvdg1</code>:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Format the partition:</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">sudo mkfs.xfs /dev/xvdg1</pre>
</div>
</li>
<li class="listitem">
<p>Create the <code class="literal">/mnt/data/</code> directory as a mount point:</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">sudo install -o $USER -g $USER -d -m 700 /mnt/data</pre>
</div>
</li>
<li class="listitem">
<p>Modify the entry for the XFS volume in the <code class="literal">/etc/fstab</code> file to add <code class="literal">pquota,prjquota</code>. The
default filesystem path used by Elastic Cloud Enterprise is <code class="literal">/mnt/data</code>.</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">/dev/xvdg1	/mnt/data	xfs	defaults,nofail,x-systemd.automount,prjquota,pquota  0 2</pre>
</div>
</li>
<li class="listitem">
<p>Regenerate the mount files:</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">sudo systemctl daemon-reload
sudo systemctl restart local-fs.target</pre>
</div>
</li>
</ol>
</div>
<h5><a id="ece-update-configuration-settings-rhel-onprem"></a>Update the configurations settings<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-72/docs/cloud-enterprise/ce-configuring-rhel-centos.asciidoc">edit</a></h5>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Stop the Docker service:</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">sudo systemctl stop docker</pre>
</div>
</li>
<li class="listitem">
<p>Configure kernel parameters:</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">cat &lt;&lt;EOF | sudo tee -a /etc/sysctl.conf
# Required by Elasticsearch 5.0 and later
vm.max_map_count=262144
# enable forwarding so the Docker networking works as expected
net.ipv4.ip_forward=1
# Decrease the maximum number of TCP retransmissions to 5 as recommended for Elasticsearch TCP retransmission timeout.
# See https://www.elastic.co/guide/en/elasticsearch/reference/current/system-config-tcpretries.html
net.ipv4.tcp_retries2=5
# Make sure the host doesn't swap too early
vm.swappiness=1
EOF</pre>
</div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>The <code class="literal">net.ipv4.tcp_retries2</code> setting applies to all TCP connections and will affect the reliability of communication with systems other than Elasticsearch clusters too. If your clusters communicate with external systems over a low quality network then you may need to select a higher value for net.ipv4.tcp_retries2.</p>
</div>
</div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Apply the settings:</p>
<p>RHEL/CentOS 7:</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">sudo sysctl -p
sudo systemctl restart network</pre>
</div>
<p>RHEL/CentOS 8:</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">sudo sysctl -p
sudo systemctl restart NetworkManager</pre>
</div>
</li>
</ol>
</div>
</li>
<li class="listitem">
<p>Adjust the system limits.</p>
<p>Add the following configuration values to the <code class="literal">/etc/security/limits.conf</code> file. If you are using a user name other than <code class="literal">elastic</code>, adjust the configuration values accordingly.</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">*                soft    nofile         1024000
*                hard    nofile         1024000
*                soft    memlock        unlimited
*                hard    memlock        unlimited
elastic          soft    nofile         1024000
elastic          hard    nofile         1024000
elastic          soft    memlock        unlimited
elastic          hard    memlock        unlimited
root             soft    nofile         1024000
root             hard    nofile         1024000
root             soft    memlock        unlimited</pre>
</div>
<p>The default limit for number of processes is too low.
Remove it and rely on the kernel limit instead (for RHEL/CentOS 7 only).</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">sudo rm /etc/security/limits.d/20-nproc.conf</pre>
</div>
</li>
<li class="listitem">
<p>If you did not create the mount point earlier (if you did not set up XFS), create the <code class="literal">/mnt/data/</code> directory as a mount point:</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">sudo install -o $USER -g $USER -d -m 700 /mnt/data</pre>
</div>
</li>
<li class="listitem">
<p>If you <a class="xref" href="ece-configure-hosts-rhel-centos-onprem.html#ece-xfs-setup-rhel-onprem" title="Set up XFS quotas">set up a new device with XFS</a> earlier:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Mount the block device (change the device name if you use a different device than <code class="literal">/dev/xvdg1</code>):</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">sudo mount /dev/xvdg1</pre>
</div>
</li>
<li class="listitem">
<p>Set the permissions on the newly mounted device:</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">sudo chown $USER:$USER /mnt/data</pre>
</div>
</li>
</ol>
</div>
</li>
<li class="listitem">
<p>Create the <code class="literal">/mnt/data/docker</code> directory for the Docker service storage:</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">sudo install -o $USER -g $USER -d -m 700 /mnt/data/docker</pre>
</div>
</li>
<li class="listitem">
<p>Disable the <code class="literal">firewalld</code> service. The service is not compatible with Docker and interferes with the installation of ECE. You must disable <code class="literal">firewalld</code> before installing or reinstalling ECE.</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">sudo systemctl disable firewalld</pre>
</div>
</li>
</ol>
</div>
<h5><a id="ece-configure-docker-daemon-rhel-centos-onprem"></a>Configure the Docker daemon options<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-72/docs/cloud-enterprise/ce-configuring-rhel-centos.asciidoc">edit</a></h5>
<p>Docker creates a bridge IP address that can conflict with IP addresses on your internal network. To avoid an IP address conflict, change the <code class="literal">--bip=172.17.42.1/16</code> parameter in our examples to something that you know will work. If there is no conflict, you can omit the <code class="literal">--bip</code> parameter. The <code class="literal">--bip</code> parameter is internal to the host and can be set to the same IP for each host in the cluster. More information on Docker daemon options can be found in the <a href="https://docs.docker.com/engine/reference/commandline/dockerd/" class="ulink" target="_top">dockerd command line reference</a>.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Update the <code class="literal">/etc/systemd/system/docker.service.d/docker.conf</code> file. If the file path and file do not exist, create them.</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">[Unit]
Description=Docker Service
After=multi-user.target

[Service]
ExecStart=
ExecStart=/usr/bin/dockerd --data-root /mnt/data/docker --storage-driver=overlay2 --bip=172.17.42.1/16 --raw-logs --icc=false</pre>
</div>
</li>
<li class="listitem">
<p>Apply the updated Docker daemon configuration:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Reload the Docker daemon configuration:</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">sudo systemctl daemon-reload</pre>
</div>
</li>
<li class="listitem">
<p>Restart the Docker service:</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">sudo systemctl restart docker</pre>
</div>
</li>
<li class="listitem">
<p>Enable Docker to start on boot:</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">sudo systemctl enable docker</pre>
</div>
</li>
</ol>
</div>
</li>
<li class="listitem">
<p>Enable your user to communicate with the Docker subsystem by adding it to the <code class="literal">docker</code> group:</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">sudo usermod -aG docker $USER</pre>
</div>
</li>
<li class="listitem">
<p>Pin the Docker version to ensure that the <code class="literal">docker-ce</code> package does not get upgraded:</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">echo "exclude=docker-ce" | sudo tee -a /etc/yum.conf</pre>
</div>
</li>
<li class="listitem">
<p>Recommended: Tune your network settings.</p>
<p>Create a <code class="literal">70-cloudenterprise.conf</code> file in the <code class="literal">/etc/sysctl.d/</code> file path that includes these network settings:</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">cat &lt;&lt; SETTINGS | sudo tee /etc/sysctl.d/70-cloudenterprise.conf
net.ipv4.tcp_max_syn_backlog=65536
net.core.somaxconn=32768
net.core.netdev_max_backlog=32768
SETTINGS</pre>
</div>
</li>
<li class="listitem">
<p>Reboot your system to ensure that all configuration changes take effect:</p>
<div class="pre_wrapper lang-literal">
<pre class="programlisting prettyprint lang-literal">sudo reboot</pre>
</div>
</li>
<li class="listitem">
<p>After rebooting, verify that your Docker settings persist as expected:</p>
<div class="pre_wrapper lang-literal">
<pre class="programlisting prettyprint lang-literal">sudo docker info | grep Root</pre>
</div>
<p>If the command returns <code class="literal">Docker Root Dir: /mnt/data/docker</code>, then your changes were applied successfully and persist as expected.</p>
<p>If the command returns <code class="literal">Docker Root Dir: /var/lib/docker</code>, then you need to troubleshoot the previous configuration steps until the Docker settings are applied successfully before continuing with the installation process. For more information, check <a href="https://docs.docker.com/engine/admin/systemd/#/custom-docker-daemon-options" class="ulink" target="_top">Custom Docker daemon options</a> in the Docker documentation.</p>
</li>
<li class="listitem">
Repeat these steps on other hosts that you want to use with Elastic Cloud Enterprise or follow the steps in the next section to start installing Elastic Cloud Enterprise.
</li>
</ol>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>We recommend enabling SELinux on RHEL/CentOS host systems. However, do
not enable the <em>selinux-enabled</em> option in the Docker daemon configuration at
this time.</p>
</div>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="ece-configure-hosts-ubuntu-onprem.html">« Ubuntu 18.04 LTS (Bionic Beaver)</a>
</span>
<span class="next">
<a href="ece-configure-hosts-sles12-onprem.html">SUSE Linux Enterprise Server (SLES) 12 »</a>
</span>
</div>
</div>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { equationNumbers: { autoNumber: "none" } }
})
MathJax.Hub.Register.StartupHook("AsciiMath Jax Ready", function () {
  MathJax.InputJax.AsciiMath.postfilterHooks.Add(function (data, node) {
    if ((node = data.script.parentNode) && (node = node.parentNode) && node.classList.contains('stemblock')) {
      data.math.root.display = "block"
    }
    return data
  })
})
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {"alternatives":{"console":{"php":{"hasAny":false},"go":{"hasAny":false},"ruby":{"hasAny":false},"java":{"hasAny":false},"javascript":{"hasAny":false},"python":{"hasAny":false},"csharp":{"hasAny":false}}}}</script>
  </body>
</html>
