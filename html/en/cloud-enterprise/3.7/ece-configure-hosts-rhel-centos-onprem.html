<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Red Hat Enterprise Linux (RHEL) and Rocky Linux | Elastic Cloud Enterprise Reference [3.7] | Elastic</title>
<meta class="elastic" name="content" content="Red Hat Enterprise Linux (RHEL) and Rocky Linux | Elastic Cloud Enterprise Reference [3.7]">

<link rel="home" href="index.html" title="Elastic Cloud Enterprise Reference [3.7]"/>
<link rel="up" href="ece-configure-os-onprem.html" title="Configure your operating system"/>
<link rel="prev" href="ece-configure-hosts-ubuntu-onprem.html" title="Ubuntu 20.04 LTS (Focal Fossa) and Ubuntu 22.04 LTS (Jammy Jellyfish)"/>
<link rel="next" href="ece-configure-hosts-sles12-onprem.html" title="SUSE Linux Enterprise Server (SLES) 12 SP5 and 15"/>
<meta class="elastic" name="product_version" content="3.7"/>
<meta class="elastic" name="product_name" content="ECE"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/CloudEnterprise/Reference/3.7"/>
<meta name="DC.subject" content="ECE"/>
<meta name="DC.identifier" content="3.7"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles-v1.css" />
  </head>

  <!--© 2015-2025 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div class="page_header">
A newer version is available. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div class="navheader">
<span class="prev">
<a href="ece-configure-hosts-ubuntu-onprem.html">« Ubuntu 20.04 LTS (Focal Fossa) and Ubuntu 22.04 LTS (Jammy Jellyfish)</a>
</span>
<span class="next">
<a href="ece-configure-hosts-sles12-onprem.html">SUSE Linux Enterprise Server (SLES) 12 SP5 and 15 »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Cloud Enterprise Reference [3.7]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="ece-installing.html">Installing Elastic Cloud Enterprise</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="ece-install-your-infra.html">Install ECE on your own premises</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="ece-configure-os-onprem.html">Configure your operating system</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Red Hat Enterprise Linux (RHEL) and Rocky Linux</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-105/docs/cloud-enterprise/ce-configuring-rhel-centos.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="ece-configure-hosts-rhel-centos-onprem"></a>Red Hat Enterprise Linux (RHEL) and Rocky Linux</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-105/docs/cloud-enterprise/ce-configuring-rhel-centos.asciidoc">edit</a></div>
</div></div></div>
<div class="position-relative"><h5><a id="ece-setup-rhel8-podman-onprem"></a>Red Hat Enterprise Linux 8 (RHEL 8), 9 (RHEL 9), and Rocky Linux 8 and 9</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-105/docs/cloud-enterprise/ce-configuring-rhel-centos.asciidoc">edit</a></div>
<p>The following instructions show you how to prepare your hosts on Red Hat Enterprise Linux 8 (RHEL 8), 9 (RHEL 9), and Rocky Linux 8 and 9.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="ece-configure-hosts-rhel-centos-onprem.html#ece-prerequisites-rhel8-onprem" title="Prerequisites">Prerequisites</a>
</li>
<li class="listitem">
<a class="xref" href="ece-configure-hosts-rhel-centos-onprem.html#ece-configure-hosts-rhel8-podman-onprem" title="Configure the host">Configure the host</a>
</li>
</ul>
</div>
<div class="position-relative"><h6><a id="ece-prerequisites-rhel8-onprem"></a>Prerequisites</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-105/docs/cloud-enterprise/ce-configuring-rhel-centos.asciidoc">edit</a></div>
<p>Create a RHEL 8 (the version must be &gt;= 8.5), RHEL 9, Rocky Linux 8, or Rocky Linux 9 instance.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For RHEL 8, follow your internal guidelines to add a vanilla RHEL 8 instance to your environment. Note that the version must be &gt;= 8.5.
</li>
</ul>
</div>
<p>Verify that required traffic is allowed.</p>
<div class="position-relative"><h6><a id="ece-configure-hosts-rhel8-podman-onprem"></a>Configure the host</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-105/docs/cloud-enterprise/ce-configuring-rhel-centos.asciidoc">edit</a></div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Install the OS packages <code class="literal">lvm2</code>, <code class="literal">iptables</code>, <code class="literal">sysstat</code>, and <code class="literal">net-tools</code> by executing:</p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">sudo dnf install lvm2 iptables sysstat net-tools <a id="CO2-1"></a><i class="conum" data-value="1"></i></pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO2-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>The ECE diagnostic script requires <code class="literal">net-tools</code>.<br></p>
</td>
</tr>
</table>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>For RHEL 9 and Rocky Linux 9, also install the <code class="literal">containernetworking-plugins</code> package using:<br></p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">sudo dnf -y install containernetworking-plugins</pre>
</div>
</div>
</div>
</li>
<li class="listitem">
<p>Remove Docker and previously installed podman packages (if previously installed).</p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">sudo dnf remove docker docker-ce podman podman-remote containerd.io</pre>
</div>
</li>
<li class="listitem">
<p>As a sudoers user, edit the <code class="literal">/etc/selinux/config</code> file:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li class="listitem">
<p>If you are not using SELinux, set it to permissive mode:</p>
<div class="pre_wrapper lang-text">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-text">SELINUX=permissive</pre>
</div>
</li>
<li class="listitem">
<p>If you are using SELinux, set it to enforcing mode:</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Avoid customizing the host Docker path <code class="literal">/mnt/data/docker</code> when using SELinux. Otherwise the ECE installer script needs to be adjusted.</p>
</div>
</div>
<div class="pre_wrapper lang-text">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-text">SELINUX=enforcing</pre>
</div>
</li>
</ol>
</div>
</li>
<li class="listitem">
<p>Install podman:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Install the latest available version <code class="literal">4.*</code> using dnf.</p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">sudo dnf install podman-4.* podman-remote-4.*</pre>
</div>
</li>
<li class="listitem">
<p>To prevent automatic Podman major version updates, configure the Podman version to be locked while still allowing minor and patch updates.</p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">## Install versionlock
sudo dnf install 'dnf-command(versionlock)'

## Lock major version
sudo dnf versionlock add --raw 'podman-4.*'
sudo dnf versionlock add --raw 'podman-remote-4.*'

## Verify that podman-4.* and podman-remote-4.* appear in the output
sudo dnf versionlock list</pre>
</div>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>[This step is for RHEL 9 and Rocky Linux 9 only] Switch the network stack from Netavark to CNI:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li class="listitem">
If the <em>/etc/containers/containers.conf</em> file does not exist, copy the <em>/usr/share/containers/containers.conf</em> file to the <em>/etc/containers/</em> directory (for example, using <code class="literal">cp /usr/share/containers/containers.conf /etc/containers/</code>).
</li>
<li class="listitem">
Open the <em>/etc/containers/containers.conf</em> file. Navigate to the <span class="strong strong"><strong>network</strong></span> section and make sure that the <span class="strong strong"><strong>network_backend</strong></span> setting is set to <code class="literal">cni</code>.
</li>
<li class="listitem">
Reboot the system (<code class="literal">reboot</code>).
</li>
<li class="listitem">
<p>Check that the network stack has changed to <code class="literal">cni</code>: <br></p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">cat /etc/containers/containers.conf
[...]
[network]
network_backend="cni"
[...]</pre>
</div>
</li>
</ol>
</div>
</li>
<li class="listitem">
<p>If podman requires a proxy in your infrastructure setup, modify the <code class="literal">/usr/share/containers/containers.conf</code> file and add the <code class="literal">HTTP_PROXY</code> and <code class="literal">HTTPS_PROXY</code> environment variables in the [engine] section. Please note that multiple env variables in that configuration file exists&#8201;&#8212;&#8201;use the one in the [engine] section.</p>
<p>Example:</p>
<div class="pre_wrapper lang-text">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-text">[engine]
env = ["HTTP_PROXY=http://{proxy-ip}:{proxy-port}", "HTTPS_PROXY=http://{proxy-ip}:{proxy-port}"]</pre>
</div>
</li>
<li class="listitem">
<p>Reload systemd configuration</p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">sudo systemctl daemon-reload</pre>
</div>
</li>
<li class="listitem">
<p>Create OS groups, if they do not exist yet</p>
<p>Reference: <a class="xref" href="ece-users-permissions.html" title="Users and permissions prerequisites">Users and permissions</a></p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">sudo groupadd elastic
sudo groupadd podman</pre>
</div>
</li>
<li class="listitem">
<p>Add user <code class="literal">elastic</code> to the <code class="literal">podman</code> group</p>
<p>Reference: <a class="xref" href="ece-users-permissions.html" title="Users and permissions prerequisites">Users and permissions</a></p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">sudo useradd -g "elastic" -G "podman" elastic</pre>
</div>
</li>
<li class="listitem">
<p>As a sudoers user, add the following line to /etc/sudoers.d/99-ece-users</p>
<p>Reference: <a class="xref" href="ece-users-permissions.html" title="Users and permissions prerequisites">Users and permissions</a></p>
<div class="pre_wrapper lang-text">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-text">elastic ALL=(ALL) NOPASSWD:ALL</pre>
</div>
</li>
<li class="listitem">
<p>Add the required options to the kernel boot arguments</p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">sudo /sbin/grubby --update-kernel=ALL --args='cgroup_enable=memory cgroup.memory=nokmem swapaccount=1'</pre>
</div>
</li>
<li class="listitem">
<p>Create the directory</p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">sudo mkdir -p /etc/systemd/system/podman.socket.d</pre>
</div>
</li>
<li class="listitem">
<p>As a sudoers user, create the file <code class="literal">/etc/systemd/system/podman.socket.d/podman.conf</code> with the following content. Set the correct ownership and permission.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Both <code class="literal">ListenStream=</code> and <code class="literal">ListenStream=/var/run/docker.sock</code> parameters are required!</p>
</div>
</div>
<p>File content:</p>
<div class="pre_wrapper lang-text">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-text">[Socket]
ListenStream=
ListenStream=/var/run/docker.sock
SocketMode=770
SocketUser=elastic
SocketGroup=podman</pre>
</div>
<p>File ownership and permission:</p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">sudo chown root:root /etc/systemd/system/podman.socket.d/podman.conf
sudo chmod 0644 /etc/systemd/system/podman.socket.d/podman.conf</pre>
</div>
</li>
<li class="listitem">
<p>As a sudoers user, create the (text) file <code class="literal">/usr/bin/docker</code> with the following content. Verify that the regular double quotes in the text file are used (ASCII code Hex 22)</p>
<div class="pre_wrapper lang-text">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-text">#!/bin/bash
podman-remote --url unix:///var/run/docker.sock "$@"</pre>
</div>
</li>
<li class="listitem">
<p>Set the file permissions on <code class="literal">/usr/bin/docker</code></p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">sudo chmod 0755 /usr/bin/docker</pre>
</div>
</li>
<li class="listitem">
<p>As a sudoers user, add the following two lines to section <code class="literal">[storage]</code> in the file <code class="literal">/etc/containers/storage.conf</code>. Verify that those parameters are only defined once. Either remove or comment out potentially existing parameters.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Avoid customizing the host Docker path <code class="literal">/mnt/data/docker</code> when using SELinux. Otherwise the ECE installer script needs to be adjusted.</p>
</div>
</div>
<div class="pre_wrapper lang-text">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-text">runroot = "/mnt/data/docker/runroot/"
graphroot = "/mnt/data/docker"</pre>
</div>
</li>
<li class="listitem">
<p>Enable podman so that itself and running containers start automatically after a reboot</p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">sudo systemctl enable podman.service
sudo systemctl enable podman-restart.service</pre>
</div>
</li>
<li class="listitem">
<p>Enable the <code class="literal">overlay</code> kernel module (check <a href="https://docs.docker.com/storage/storagedriver/overlayfs-driver/" class="ulink" target="_top">Use the OverlayFS storage driver</a>) that the Podman <code class="literal">overlay</code> storage driver uses (check <a href="https://www.redhat.com/en/blog/working-container-storage-library-and-tools-red-hat-enterprise-linux#:~:text=Storage%20Configuration" class="ulink" target="_top">Working with the Container Storage library and tools in Red Hat Enterprise Linux</a>).</p>
<p>In the Docker world there are two overlay drivers, overlay and overlay2. Today most users use the overlay2 driver, so we just use that one, and called it overlay. Refer also to <a href="https://docs.docker.com/storage/storagedriver/overlayfs-driver/" class="ulink" target="_top">Use the OverlayFS storage driver</a>.</p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">echo "overlay" | sudo tee -a /etc/modules-load.d/overlay.conf</pre>
</div>
</li>
<li class="listitem">
<p>Format the additional data partition</p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">sudo mkfs.xfs /dev/nvme1n1</pre>
</div>
</li>
<li class="listitem">
<p>Create the <code class="literal">/mnt/data/</code> directory used as a mount point</p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">sudo install -o elastic -g elastic -d -m 700 /mnt/data</pre>
</div>
</li>
<li class="listitem">
<p>As a sudoers user, modify the entry for the XFS volume in the <code class="literal">/etc/fstab</code> file to add <code class="literal">pquota,prjquota</code>. The default filesystem path used by Elastic Cloud Enterprise is <code class="literal">/mnt/data</code>.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Replace <code class="literal">/dev/nvme1n1</code> in the following example with the corresponding device on your host, and add this example configuration as a single line to <code class="literal">/etc/fstab</code>.</p>
</div>
</div>
<div class="pre_wrapper lang-text">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-text">/dev/nvme1n1	/mnt/data	xfs	defaults,nofail,x-systemd.automount,prjquota,pquota  0 2</pre>
</div>
</li>
<li class="listitem">
<p>Restart the local-fs target</p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">sudo systemctl daemon-reload
sudo systemctl restart local-fs.target</pre>
</div>
</li>
<li class="listitem">
<p>Set the permissions on the newly mounted device</p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">ls /mnt/data
sudo chown elastic:elastic /mnt/data</pre>
</div>
</li>
<li class="listitem">
<p>Create the <code class="literal">/mnt/data/docker</code> directory for the Docker service storage</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Avoid customizing the host Docker path <code class="literal">/mnt/data/docker</code> when using SELinux. Otherwise the ECE installer script needs to be adjusted.</p>
</div>
</div>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">sudo install -o elastic -g elastic -d -m 700 /mnt/data/docker</pre>
</div>
</li>
<li class="listitem">
<p>If you want to use FirewallD, please ensure you meet the <a class="xref" href="ece-networking-prereq.html" title="Networking prerequisites">networking prerequisites</a>. Otherwise, you can disable it with:</p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">sudo systemctl disable firewalld</pre>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>If FirewallD does not exist on your VM, you can skip this step.</p>
</div>
</div>
</li>
<li class="listitem">
<p>Configure kernel parameters</p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">cat &lt;&lt;EOF | sudo tee -a /etc/sysctl.conf
# Required by Elasticsearch
vm.max_map_count=262144
# enable forwarding so the Docker networking works as expected
net.ipv4.ip_forward=1
# Decrease the maximum number of TCP retransmissions to 5 as recommended for Elasticsearch TCP retransmission timeout.
# See https://www.elastic.co/guide/en/elasticsearch/reference/current/system-config-tcpretries.html
net.ipv4.tcp_retries2=5
# Make sure the host doesn't swap too early
vm.swappiness=1
EOF</pre>
</div>
</li>
<li class="listitem">
<p>Apply the new sysctl settings</p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">sudo sysctl -p
sudo systemctl restart NetworkManager</pre>
</div>
</li>
<li class="listitem">
<p>As a sudoers user, adjust the system limits. Add the following configuration values to the <code class="literal">/etc/security/limits.conf</code> file.</p>
<div class="pre_wrapper lang-text">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-text">*                soft    nofile         1024000
*                hard    nofile         1024000
*                soft    memlock        unlimited
*                hard    memlock        unlimited
elastic          soft    nofile         1024000
elastic          hard    nofile         1024000
elastic          soft    memlock        unlimited
elastic          hard    memlock        unlimited
elastic          soft    nproc          unlimited
elastic          hard    nproc          unlimited
root             soft    nofile         1024000
root             hard    nofile         1024000
root             soft    memlock        unlimited</pre>
</div>
</li>
<li class="listitem">
<p>NOTE: This step is optional if the Docker registry doesn&#8217;t require authentication.</p>
<p>Authenticate the <code class="literal">elastic</code> user to pull images from the Docker registry you use, by creating the file <code class="literal">/home/elastic/.docker/config.json</code>. This file needs to be owned by the <code class="literal">elastic</code> user. If you are using a user name other than <code class="literal">elastic</code>, adjust the path accordingly.</p>
<p><span class="strong strong"><strong>Example</strong></span>: In case you use <code class="literal">docker.elastic.co</code>, the file content looks like as follows:</p>
<div class="pre_wrapper lang-text">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-text">{
 "auths": {
   "docker.elastic.co": {
     "auth": "&lt;auth-token&gt;"
   }
 }
}</pre>
</div>
</li>
<li class="listitem">
<p>Restart the podman service by running this command:</p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">sudo systemctl daemon-reload
sudo systemctl restart podman</pre>
</div>
</li>
<li class="listitem">
<p>Reboot the RHEL host</p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">sudo reboot</pre>
</div>
</li>
</ol>
</div>
</div>
</div>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { equationNumbers: { autoNumber: "none" } }
})
MathJax.Hub.Register.StartupHook("AsciiMath Jax Ready", function () {
  MathJax.InputJax.AsciiMath.postfilterHooks.Add(function (data, node) {
    if ((node = data.script.parentNode) && (node = node.parentNode) && node.classList.contains('stemblock')) {
      data.math.root.display = "block"
    }
    return data
  })
})
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>
</div><div class="navfooter">
<span class="prev">
<a href="ece-configure-hosts-ubuntu-onprem.html">« Ubuntu 20.04 LTS (Focal Fossa) and Ubuntu 22.04 LTS (Jammy Jellyfish)</a>
</span>
<span class="next">
<a href="ece-configure-hosts-sles12-onprem.html">SUSE Linux Enterprise Server (SLES) 12 SP5 and 15 »</a>
</span>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>

                        <!-- Feedback widget -->
                        <div id="feedbackWidgetContainer"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


        <div id='elastic-footer'></div>
        <script src='https://www.elastic.co/elastic-footer.js'></script>
        <!-- Footer Section end-->

      </section>
    </div>

    <!-- Feedback modal -->
    <div id="feedbackModalContainer"></div>

    <script src="/guide/static/jquery.js"></script>
    <script type="text/javascript" src="/guide/static/docs-v1.js"></script>
    <script type="text/javascript">
  window.initial_state = {"alternatives":{"console":{"php":{"hasAny":false},"go":{"hasAny":false},"ruby":{"hasAny":false},"java":{"hasAny":false},"javascript":{"hasAny":false},"python":{"hasAny":false},"csharp":{"hasAny":false}}}}</script>
  </body>
</html>
