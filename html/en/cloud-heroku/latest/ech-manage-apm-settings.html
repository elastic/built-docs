<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Edit APM user settings | Elasticsearch Add-On for Heroku Documentation | Elastic</title>
<link rel="home" href="index.html" title="Elasticsearch Add-On for Heroku Documentation"/>
<link rel="up" href="ech-editing-user-settings.html" title="Edit your user settings"/>
<link rel="prev" href="ech-manage-kibana-settings.html" title="Edit Kibana user settings"/>
<link rel="next" href="ech-autoscaling.html" title="Deployment autoscaling"/>
<meta name="DC.type" content="Learn/Docs/Cloud-Heroku/Reference"/>
<meta name="DC.subject" content="Elasticsearch Add-On for Heroku"/>
<meta name="DC.identifier" content="latest"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <!--© 2015-2022 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!--BEGIN QUALTRICS WEBSITE FEEDBACK SNIPPET-->
    <script type='text/javascript'>
      (function(){var g=function(e,h,f,g){
      this.get=function(a){for(var a=a+"=",c=document.cookie.split(";"),b=0,e=c.length;b<e;b++){for(var d=c[b];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return null};
      this.set=function(a,c){var b="",b=new Date;b.setTime(b.getTime()+6048E5);b="; expires="+b.toGMTString();document.cookie=a+"="+c+b+"; path=/; "};
      this.check=function(){var a=this.get(f);if(a)a=a.split(":");else if(100!=e)"v"==h&&(e=Math.random()>=e/100?0:100),a=[h,e,0],this.set(f,a.join(":"));else return!0;var c=a[1];if(100==c)return!0;switch(a[0]){case "v":return!1;case "r":return c=a[2]%Math.floor(100/c),a[2]++,this.set(f,a.join(":")),!c}return!0};
      this.go=function(){if(this.check()){var a=document.createElement("script");a.type="text/javascript";a.src=g;document.body&&document.body.appendChild(a)}};
      this.start=function(){var a=this;window.addEventListener?window.addEventListener("load",function(){a.go()},!1):window.attachEvent&&window.attachEvent("onload",function(){a.go()})}};
      try{(new g(100,"r","QSI_S_ZN_emkP0oSe9Qrn7kF","https://znemkp0ose9qrn7kf-elastic.siteintercept.qualtrics.com/WRSiteInterceptEngine/?Q_ZID=ZN_emkP0oSe9Qrn7kF")).start()}catch(i){}})();
    </script><div id='ZN_emkP0oSe9Qrn7kF'><!--DO NOT REMOVE-CONTENTS PLACED HERE--></div>
    <!--END WEBSITE FEEDBACK SNIPPET-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="index.html">Elasticsearch Add-On for Heroku Documentation</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="ech-configure.html">Configuring your deployment</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="ech-editing-user-settings.html">Edit your user settings</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="ech-manage-kibana-settings.html">« Edit Kibana user settings</a>
</span>
<span class="next">
<a href="ech-autoscaling.html">Deployment autoscaling »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="ech-manage-apm-settings"></a>Edit APM user settings<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-77/docs/saas/ec-editing-user-settings.asciidoc">edit</a></h2>
</div></div></div>
<p>Change how Elastic APM runs by providing your own user settings.
Starting in Elastic Stack version 8.0, how you change APM settings and the settings that are available to you
depend on how you spin up Elastic APM. There are two modes:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Fleet-managed APM integration
</span>
</dt>
<dd>
<p>
New deployments created in Elastic Stack version 8.0 and later will be managed by Fleet.
</p>
<p>Check <a href="/guide/en/apm/guide/8.3/input-apm.html" class="ulink" target="_top">APM integration input settings</a> for information on how to configure Elastic APM in this mode.</p>
</dd>
<dt>
<span class="term">
Standalone APM Server (legacy)
</span>
</dt>
<dd>
<p>
Deployments created prior to Elastic Stack version 8.0 are in legacy mode.
Upgrading to or past Elastic Stack 8.0 will not remove you from legacy mode.
</p>
<p>Check <a class="xref" href="ech-manage-apm-settings.html#ech-edit-apm-standalone-settings" title="Edit standalone APM settings (legacy)">Edit standalone APM settings (legacy)</a> and <a class="xref" href="ech-manage-apm-settings.html#ech-apm-settings" title="Supported standalone APM settings (legacy)">Supported standalone APM settings (legacy)</a> for information on how to configure Elastic APM in this mode.</p>
</dd>
</dl>
</div>
<p>To learn more about the differences between these modes, or to switch from Standalone APM Server (legacy) mode to Fleet-managed,
check <a href="/guide/en/apm/guide/8.3/upgrade-to-apm-integration.html" class="ulink" target="_top">Switch to the Elastic APM integration</a>.</p>
<h4><a id="ech-edit-apm-standalone-settings"></a>Edit standalone APM settings (legacy)<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-77/docs/saas/ec-editing-user-settings.asciidoc">edit</a></h4>
<p>User settings are appended to the <code class="literal">apm-server.yml</code> configuration file for your instance and provide custom configuration options.</p>
<p>To add user settings:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Log in to the <a href="https://cloud.elastic.co?baymax=docs-body&amp;elektra=docs" class="ulink" target="_top">Elasticsearch Add-On for Heroku console</a>.
</li>
<li class="listitem">
<p>On the deployments page, select your deployment.</p>
<p>Narrow your deployments by name, ID, or choose from several other filters. To customize your view, use a combination of filters, or change the format from a grid to a list.</p>
</li>
<li class="listitem">
From your deployment menu, go to the <span class="strong strong"><strong>Edit</strong></span> page.
</li>
<li class="listitem">
In the <span class="strong strong"><strong>APM</strong></span> section, select <span class="strong strong"><strong>Edit user settings</strong></span>. (For existing deployments with user settings, you may have to expand the <span class="strong strong"><strong>Edit apm-server.yml</strong></span> caret instead.)
</li>
<li class="listitem">
Update the user settings.
</li>
<li class="listitem">
Select <span class="strong strong"><strong>Save changes</strong></span>.
</li>
</ol>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>If a setting is not supported by Elasticsearch Add-On for Heroku, you will get an error message when you try to save.</p>
</div>
</div>
<h4><a id="ech-apm-settings"></a>Supported standalone APM settings (legacy)<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-77/docs/saas/ec-editing-user-settings.asciidoc">edit</a></h4>
<p>Elasticsearch Add-On for Heroku supports the following setting when running APM in standalone mode (legacy).</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>Some settings that could break your cluster if set incorrectly are blocklisted. The following settings are generally safe in cloud environments. For detailed information about APM settings, check the <a href="/guide/en/apm/guide/8.3/configuring-howto-apm-server.html" class="ulink" target="_top">APM documentation</a>.</p>
</div>
</div>
<p><span class="strong strong"><strong>For version 7.17 and later:</strong></span></p>
<p>This stack version includes all of the settings from 7.16 and the following:</p>
<p>Allow anonymous access only for specified agents and/or services. This is primarily intended to allow limited access for untrusted agents, such as Real User Monitoring.
Anonymous auth is automatically enabled when RUM is enabled. Otherwise, anonymous auth is disabled.
When anonymous auth is enabled, only agents matching allow_agent and services matching allow_service are allowed. See below for details on default values for these.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">apm-server.auth.anonymous.allow_agent</code>
</span>
</dt>
<dd>
Allow anonymous access only for specified agents.
</dd>
<dt>
<span class="term">
<code class="literal">apm-server.auth.anonymous.allow_service</code>
</span>
</dt>
<dd>
Allow anonymous access only for specified service names. By default, all service names are allowed. This will be replacing the config option <code class="literal">apm-server.rum.allow_service_names</code> from <code class="literal">8.0</code> on.
</dd>
<dt>
<span class="term">
<code class="literal">apm-server.auth.anonymous.rate_limit.event_limit</code>
</span>
</dt>
<dd>
Rate limiting is defined per unique client IP address, for a limited number of IP addresses. Sites with many concurrent clients should consider increasing this limit. Defaults to 1000. This will be replacing the config option`apm-server.rum.event_rate.limit` from <code class="literal">8.0</code> on.
</dd>
<dt>
<span class="term">
<code class="literal">apm-server.auth.anonymous.rate_limit.ip_limit</code>
</span>
</dt>
<dd>
Defines the maximum amount of events allowed per IP per second. Defaults to 300. The overall maximum event throughput for anonymous access is (event_limit * ip_limit). This will be replacing the config option <code class="literal">apm-server.rum.event_rate.lru_size</code> from <code class="literal">8.0</code> on.
</dd>
<dt>
<span class="term">
<code class="literal">apm-server.auth.api_key.enabled</code>
</span>
</dt>
<dd>
Enables agent authorization using Elasticsearch API Keys.  This will be replacing the config option <code class="literal">apm-server.api_key.enabled</code> from <code class="literal">8.0</code> on.
</dd>
<dt>
<span class="term">
<code class="literal">apm-server.auth.api_key.limit</code>
</span>
</dt>
<dd>
Restrict how many unique API keys are allowed per minute. Should be set to at least the amount of different API keys configured in your monitored services. Every unique API key triggers one request to Elasticsearch. This will be replacing the config option <code class="literal">apm-server.api_key.limit</code> from <code class="literal">8.0</code> on.
</dd>
</dl>
</div>
<p><span class="strong strong"><strong>For version 7.14 and later:</strong></span></p>
<p>This stack version includes all of the settings from 7.13 and the following:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">apm-server.aggregation.transactions.*</code>
</span>
</dt>
<dd>
This functionality is experimental and may be changed or removed completely in a future release. When enabled, APM Server produces transaction histogram metrics that are used to power the APM app. Shifting this responsibility from APM app to APM Server results in improved query performance and removes the need to store unsampled transactions.
</dd>
</dl>
</div>
<p><span class="strong strong"><strong>For version 7.13 and later:</strong></span></p>
<p>This stack version includes all of the settings from 7.12 and the following:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">apm-server.default_service_environment</code>
</span>
</dt>
<dd>
If specified, APM Server will record this value in events which have no service environment defined, and add it to agent configuration queries to Kibana when none is specified in the request from the agent.
</dd>
<dt>
<span class="term">
<code class="literal">apm-server.rum.allow_service_names</code>
</span>
</dt>
<dd>
A list of service names to allow, to limit service-specific indices and data streams created for unauthenticated RUM events. If the list is empty, any service name is allowed.
</dd>
</dl>
</div>
<p><span class="strong strong"><strong>For version 7.9 and later:</strong></span></p>
<p>This stack version includes all of the settings from 7.7 and the following:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">apm-server.ilm.setup.mapping</code>
</span>
</dt>
<dd>
ILM policies now support configurable index suffixes. You can append the <code class="literal">policy_name</code> with an <code class="literal">index_suffix</code> based on the <code class="literal">event_type</code>, which can be one of <code class="literal">span</code>, <code class="literal">transaction</code>, <code class="literal">error</code>, or <code class="literal">metric</code>.
</dd>
</dl>
</div>
<p><span class="strong strong"><strong>For version 7.7 and later:</strong></span></p>
<p>This stack version includes all of the settings from 7.6 and the following:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">apm-server.rum.allow_headers</code>
</span>
</dt>
<dd>
List of Access-Control-Allow-Headers to allow RUM requests, in addition to "Content-Type", "Content-Encoding", and "Accept".
</dd>
<dt>
<span class="term">
<code class="literal">setup.template.append_fields</code>
</span>
</dt>
<dd>
A list of fields to be added to the Elasticsearch template and Kibana data view (formerly <em>index pattern</em>).
</dd>
</dl>
</div>
<p><span class="strong strong"><strong>For version 7.6 and later:</strong></span></p>
<p>This stack version includes all of the settings from 7.5 and the following:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">apm-server.api_key.enabled</code>
</span>
</dt>
<dd>
Enabled by default. For any requests where APM Server accepts a <code class="literal">secret_token</code> in the authorization header, it now alternatively accepts an API Key.
</dd>
<dt>
<span class="term">
<code class="literal">apm-server.api_key.limit</code>
</span>
</dt>
<dd>
Configure how many unique API keys are allowed per minute. Should be set to at least the amount of different API keys used in monitored services. Default value is 100.
</dd>
</dl>
</div>
<p><span class="strong strong"><strong>For version 7.5 and later:</strong></span></p>
<p>This stack version includes all of the settings from 7.4 and the following:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">apm-server.ilm.setup.enabled</code>
</span>
</dt>
<dd>
When enabled, APM Server creates aliases, event type specific settings and ILM policies. If disabled, event type specific templates need to be managed manually.
</dd>
<dt>
<span class="term">
<code class="literal">apm-server.ilm.setup.overwrite</code>
</span>
</dt>
<dd>
Set to <code class="literal">true</code> to apply custom policies and to properly overwrite templates when switching between using ILM and not using ILM.
</dd>
<dt>
<span class="term">
<code class="literal">apm-server.ilm.setup.require_policy</code>
</span>
</dt>
<dd>
Set to <code class="literal">false</code> when policies are set up outside of APM Server but referenced in this configuration.
</dd>
<dt>
<span class="term">
<code class="literal">apm-server.ilm.setup.policies</code>
</span>
</dt>
<dd>
Array of ILM policies. Each entry has a <code class="literal">name</code> and a <code class="literal">policy</code>.
</dd>
<dt>
<span class="term">
<code class="literal">apm-server.ilm.setup.mapping</code>
</span>
</dt>
<dd>
Array of mappings of ILM policies to event types. Each entry has a <code class="literal">policy_name</code> and an <code class="literal">event_type</code>, which can be one of <code class="literal">span</code>, <code class="literal">transaction</code>, <code class="literal">error</code>, or <code class="literal">metric</code>.
</dd>
</dl>
</div>
<p><span class="strong strong"><strong>For version 7.4 and later:</strong></span></p>
<p>This stack version includes all of the settings from 7.3 and the following:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">apm-server.rum.source_mapping.enabled</code>
</span>
</dt>
<dd>
When events are monitored using the RUM agent, APM Server tries to apply source mapping by default. This configuration option allows you to disable source mapping on stack traces.
</dd>
<dt>
<span class="term">
<code class="literal">apm-server.rum.source_mapping.cache.expiration</code>
</span>
</dt>
<dd>
Sets how long a source map should be cached before being refetched from Elasticsearch. Default value is 5m.
</dd>
</dl>
</div>
<p><span class="strong strong"><strong>For version 7.3 and later:</strong></span></p>
<p>This stack version includes all of the settings from 7.2 and the following:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">output.elasticsearch.pipeline</code>
</span>
</dt>
<dd>
APM comes with a default pipeline definition. This allows overriding it. To disable, you can set <code class="literal">pipeline: _none</code>
</dd>
<dt>
<span class="term">
<code class="literal">apm-server.agent.config.cache.expiration</code>
</span>
</dt>
<dd>
When using APM agent configuration, determines cache expiration from information fetched from Kibana. Defaults to <code class="literal">30s</code>.
</dd>
</dl>
</div>
<p><span class="strong strong"><strong>For version 7.2 and later:</strong></span></p>
<p>This stack version includes all of the settings from 6.5 and the following:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">apm-server.ilm.enabled</code>
</span>
</dt>
<dd>
Enables index lifecycle management (ILM) for the indices created by the APM Server. Defaults to <code class="literal">false</code>. If you&#8217;re updating an existing APM Server, you must also set <code class="literal">setup.template.overwrite: true</code>. If you don&#8217;t, the index template will not be overridden and ILM changes will not take effect.
</dd>
</dl>
</div>
<p><span class="strong strong"><strong>For version 6.5 and later:</strong></span></p>
<p>This stack version includes all of the settings from 6.4 and the following:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">apm-server.max_event_size</code>
</span>
</dt>
<dd>
Specifies the maximum allowed size of an event for processing by the server, in bytes. Defaults to <code class="literal">307200</code>.
</dd>
<dt>
<span class="term">
<code class="literal">output.elasticsearch.pipelines</code>
</span>
</dt>
<dd>
Adds an array for pipeline selector configurations that support conditionals, format string-based field access, and name mappings used to <a href="/guide/en/apm/guide/8.3/configuring-ingest-node.html" class="ulink" target="_top">parse data using ingest node pipelines</a>.
</dd>
<dt>
<span class="term">
<code class="literal">apm-server.register.ingest.pipeline.enabled</code>
</span>
</dt>
<dd>
Loads the pipeline definitions to Elasticsearch when the APM Server starts up. Defaults to <code class="literal">false</code>.
</dd>
<dt>
<span class="term">
<code class="literal">apm-server.register.ingest.pipeline.overwrite</code>
</span>
</dt>
<dd>
Overwrites the existing pipeline definitions in Elasticsearch. Defaults to <code class="literal">true</code>.
</dd>
<dt>
<span class="term">
<code class="literal">apm-server.rum.event_rate.lru_size</code>
</span>
</dt>
<dd>
Defines the number of unique IP addresses that can be tracked in the LRU cache, which keeps a rate limit for each of the most recently seen IP addresses. Defaults to <code class="literal">1000</code>.
</dd>
<dt>
<span class="term">
<code class="literal">apm-server.rum.event_rate.limit</code>
</span>
</dt>
<dd>
Sets the rate limit per second for each IP address for events sent to the APM Server v2 RUM endpoint. Defaults to <code class="literal">300</code>.
</dd>
</dl>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>With the version 6.5 release, we recommend verifying that your agents continue to be <a href="/guide/en/apm/guide/8.3/agent-server-compatibility.html" class="ulink" target="_top">compatible with your APM Server</a>.</p>
</div>
</div>
<p><span class="strong strong"><strong>For version 6.4 and later:</strong></span></p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">apm-server.rum.enabled</code>
</span>
</dt>
<dd>
Enables/disables Real User Monitoring (RUM) support. Defaults to <code class="literal">true</code> (enabled).
</dd>
<dt>
<span class="term">
<code class="literal">apm-server.rum.allow_origins</code>
</span>
</dt>
<dd>
Specifies a list of permitted origins from user agents. The default is <code class="literal">*</code>, which allows everything.
</dd>
<dt>
<span class="term">
<code class="literal">apm-server.rum.library_pattern</code>
</span>
</dt>
<dd>
Differentiates library frames against  <a href="/guide/en/apm/guide/8.3/configuration-rum.html#rum-library-pattern" class="ulink" target="_top">specific attributes</a>. The default value is <code class="literal">"node_modules|bower_components|~"</code>.
</dd>
<dt>
<span class="term">
<code class="literal">apm-server.rum.exclude_from_grouping</code>
</span>
</dt>
<dd>
Configures the RegExp to be matched against a stacktrace frame&#8217;s <code class="literal">file_name</code>.
</dd>
<dt>
<span class="term">
<code class="literal">apm-server.rum.rate_limit</code>
</span>
</dt>
<dd>
Sets the rate limit per second for each IP address for requests sent to the RUM endpoint. Defaults to <code class="literal">10</code>.
</dd>
<dt>
<span class="term">
<code class="literal">apm-server.capture_personal_data</code>
</span>
</dt>
<dd>
When set to <code class="literal">true</code>, the server captures the IP of the instrumented service and its User Agent. Enabled by default.
</dd>
<dt>
<span class="term">
<code class="literal">setup.template.settings.index.number_of_shards</code>
</span>
</dt>
<dd>
Specifies the number of shards for the Elasticsearch template.
</dd>
<dt>
<span class="term">
<code class="literal">setup.template.settings.index.number_of_replicas</code>
</span>
</dt>
<dd>
Specifies the number of replicas for the Elasticsearch template.
</dd>
</dl>
</div>
<p><span class="strong strong"><strong>For version 6.3:</strong></span></p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">apm-server.frontend.enabled</code>
</span>
</dt>
<dd>
Enables/disables frontend support.
</dd>
<dt>
<span class="term">
<code class="literal">apm-server.frontend.allow_origins</code>
</span>
</dt>
<dd>
Specifies the comma-separated list of permitted origins from user agents. The default is <code class="literal">*</code>, which allows everything.
</dd>
<dt>
<span class="term">
<code class="literal">apm-server.frontend.library_pattern</code>
</span>
</dt>
<dd>
Differentiates library frames against <a href="/guide/en/apm/server/6.3/configuration-frontend.html" class="ulink" target="_top">specific attributes</a>. The default value is <code class="literal">"node_modules|bower_components|~"</code>.
</dd>
<dt>
<span class="term">
<code class="literal">apm-server.frontend.exclude_from_grouping</code>
</span>
</dt>
<dd>
Configures the RegExp to be matched against a stacktrace frame&#8217;s <code class="literal">file_name</code>.
</dd>
<dt>
<span class="term">
<code class="literal">apm-server.frontend.rate_limit</code>
</span>
</dt>
<dd>
Sets the rate limit per second per IP address for requests sent to the frontend endpoint. Defaults to <code class="literal">10</code>.
</dd>
<dt>
<span class="term">
<code class="literal">apm-server.capture_personal_data</code>
</span>
</dt>
<dd>
When set to <code class="literal">true</code>, the server captures the IP address of the instrumented service and its User Agent. Enabled by default.
</dd>
<dt>
<span class="term">
<code class="literal">max_procs</code>
</span>
</dt>
<dd>
Max number of CPUs used simultaneously. Defaults to the number of logical CPUs available.
</dd>
<dt>
<span class="term">
<code class="literal">setup.template.enabled</code>
</span>
</dt>
<dd>
Set to false to disable loading of Elasticsearch templates used for APM indices. If set to false, you must load the template manually.
</dd>
<dt>
<span class="term">
<code class="literal">setup.template.name</code>
</span>
</dt>
<dd>
Name of the template. Defaults to <code class="literal">apm-server</code>.
</dd>
<dt>
<span class="term">
<code class="literal">setup.template.pattern</code>
</span>
</dt>
<dd>
The template pattern to apply to the default index settings. Default is <code class="literal">apm-*</code>
</dd>
<dt>
<span class="term">
<code class="literal">setup.template.settings.index.number_of_shards</code>
</span>
</dt>
<dd>
Specifies the number of shards for the Elasticsearch template.
</dd>
<dt>
<span class="term">
<code class="literal">setup.template.settings.index.number_of_replicas</code>
</span>
</dt>
<dd>
Specifies the number of replicas for the Elasticsearch template.
</dd>
<dt>
<span class="term">
<code class="literal">output.elasticsearch.bulk_max_size</code>
</span>
</dt>
<dd>
<p>
Maximum number of events to bulk together in a single Elasticsearch bulk API request. By default, this number changes based on the size of the instance and server version:
</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Instance size</th>
<th align="left" valign="top">Version 6.5+</th>
<th align="left" valign="top">Version &lt;6.5</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>512MB</p></td>
<td align="left" valign="top"><p>267</p></td>
<td align="left" valign="top"><p>53</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>1GB</p></td>
<td align="left" valign="top"><p>381</p></td>
<td align="left" valign="top"><p>68</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>2GB</p></td>
<td align="left" valign="top"><p>533</p></td>
<td align="left" valign="top"><p>95</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>4GB</p></td>
<td align="left" valign="top"><p>762</p></td>
<td align="left" valign="top"><p>70</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>8GB</p></td>
<td align="left" valign="top"><p>1067</p></td>
<td align="left" valign="top"><p>96</p></td>
</tr>
</tbody>
</table>
</div>
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">output.elasticsearch.indices</code>
</span>
</dt>
<dd>
Array of index selector rules supporting conditionals and formatted string.
</dd>
<dt>
<span class="term">
<code class="literal">output.elasticsearch.index</code>
</span>
</dt>
<dd>
The index to write the events to. If changed, <code class="literal">setup.template.name</code> and <code class="literal">setup.template.pattern</code> must be changed accordingly.
</dd>
<dt>
<span class="term">
<code class="literal">output.elasticsearch.worker</code>
</span>
</dt>
<dd>
<p>
Maximum number of concurrent workers publishing events to Elasticsearch. By default, this number changes based on the size of the instance and server version:
</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Instance size</th>
<th align="left" valign="top">Version 6.5+</th>
<th align="left" valign="top">Version &lt;6.5</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>512MB</p></td>
<td align="left" valign="top"><p>5</p></td>
<td align="left" valign="top"><p>5</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>1GB</p></td>
<td align="left" valign="top"><p>7</p></td>
<td align="left" valign="top"><p>5</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>2GB</p></td>
<td align="left" valign="top"><p>10</p></td>
<td align="left" valign="top"><p>5</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>4GB</p></td>
<td align="left" valign="top"><p>14</p></td>
<td align="left" valign="top"><p>10</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>8GB</p></td>
<td align="left" valign="top"><p>20</p></td>
<td align="left" valign="top"><p>10</p></td>
</tr>
</tbody>
</table>
</div>
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">queue.mem.events</code>
</span>
</dt>
<dd>
<p>
Maximum number of events to concurrently store in the internal queue. By default, this number changes based on the size of the instance and server version:
</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Instance size</th>
<th align="left" valign="top">Version 6.5+</th>
<th align="left" valign="top">Version &lt;6.5</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>512MB</p></td>
<td align="left" valign="top"><p>2000</p></td>
<td align="left" valign="top"><p>266</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>1GB</p></td>
<td align="left" valign="top"><p>4000</p></td>
<td align="left" valign="top"><p>339</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>2GB</p></td>
<td align="left" valign="top"><p>8000</p></td>
<td align="left" valign="top"><p>476</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>4GB</p></td>
<td align="left" valign="top"><p>16000</p></td>
<td align="left" valign="top"><p>699</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>8GB</p></td>
<td align="left" valign="top"><p>32000</p></td>
<td align="left" valign="top"><p>958</p></td>
</tr>
</tbody>
</table>
</div>
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">queue.mem.flush.min_events</code>
</span>
</dt>
<dd>
Minimum number of events to have before pushing them to Elasticsearch. By default, this number changes based on the size of the instance.
</dd>
<dt>
<span class="term">
<code class="literal">queue.mem.flush.timeout</code>
</span>
</dt>
<dd>
Maximum duration before sending the events to the output if the <code class="literal">min_events</code> is not crossed.
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Logging settings
</span>
</dt>
<dt>
<span class="term">
<code class="literal">logging.level</code>
</span>
</dt>
<dd>
Specifies the minimum log level. One of <em>debug</em>, <em>info</em>, <em>warning</em>, or <em>error</em>. Defaults to <em>info</em>.
</dd>
<dt>
<span class="term">
<code class="literal">logging.selectors</code>
</span>
</dt>
<dd>
The list of debugging-only selector tags used by different APM Server components. Use <em>*</em> to enable debug output for all components. For example, add <em>publish</em> to display all the debug messages related to event publishing.
</dd>
<dt>
<span class="term">
<code class="literal">logging.metrics.enabled</code>
</span>
</dt>
<dd>
If enabled, APM Server periodically logs its internal metrics that have changed in the last period. Defaults to <em>true</em>.
</dd>
<dt>
<span class="term">
<code class="literal">logging.metrics.period</code>
</span>
</dt>
<dd>
The period after which to log the internal metrics. Defaults to <em>30s</em>.
</dd>
</dl>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>To change logging settings you must first <a class="xref" href="ech-enable-logging-and-monitoring.html" title="Enable logging and monitoring">enable deployment logging</a>.</p>
</div>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="ech-manage-kibana-settings.html">« Edit Kibana user settings</a>
</span>
<span class="next">
<a href="ech-autoscaling.html">Deployment autoscaling »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {"alternatives":{"console":{"php":{"hasAny":false},"go":{"hasAny":false},"ruby":{"hasAny":false},"java":{"hasAny":false},"javascript":{"hasAny":false},"python":{"hasAny":false},"csharp":{"hasAny":false}}}}</script>
  </body>
</html>
