<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Configure Elastic Cloud SAML single sign-on | Elasticsearch Service Documentation | Elastic</title>
<meta class="elastic" name="content" content="Configure Elastic Cloud SAML single sign-on | Elasticsearch Service Documentation">

<link rel="home" href="index.html" title="Elasticsearch Service Documentation"/>
<link rel="up" href="ec-organizations.html" title="Managing your organization"/>
<link rel="prev" href="ec-user-privileges.html" title="User roles and privileges"/>
<link rel="next" href="ec-saml-sso-okta.html" title="Register Elastic Cloud SAML in Okta"/>
<meta class="elastic" name="product_version" content="latest"/>
<meta class="elastic" name="product_name" content="Elastic Cloud"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Cloud/Reference"/>
<meta name="DC.subject" content="Elastic Cloud"/>
<meta name="DC.identifier" content="latest"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles-v1.css" />
  </head>

  <!--© 2015-2025 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div class="navheader">
<span class="prev">
<a href="ec-user-privileges.html">« User roles and privileges</a>
</span>
<span class="next">
<a href="ec-saml-sso-okta.html">Register Elastic Cloud SAML in Okta »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elasticsearch Service Documentation</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="ec-organizations.html">Managing your organization</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Configure Elastic Cloud SAML single sign-on</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-122/docs/saas/ec-organizations-saml-sso.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="chapter">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="ec-saml-sso"></a>Configure Elastic Cloud SAML single sign-on</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-122/docs/saas/ec-organizations-saml-sso.asciidoc">edit</a></div>
</div></div></div>

<p>You can centrally control access to your Elastic Cloud organization by setting up SAML single sign-on (SSO) with a SAML 2.0 identity provider (IdP).</p>
<p>When users log in to Elastic Cloud for the first time using SSO, they&#8217;re automatically added to your organization and their accounts are automatically provisioned.</p>
<p>You can also enhance security by enforcing SSO authentication for members of your organization, and centrally manage role assignments by mapping IdP groups to Elastic Cloud roles.</p>
<div class="position-relative"><h3><a id="ec_should_i_use_organization_level_or_deployment_level_sso_2"></a>Should I use organization-level or deployment-level SSO?</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-122/docs/saas/ec-organizations-saml-sso.asciidoc">edit</a></div>
<p>You can also integrate third-party authentication directly <a class="xref" href="ec-security.html" title="Securing your deployment">at the deployment level</a>. The option that you choose depends on your requirements:</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Consideration</th>
<th align="left" valign="top">Organization-level</th>
<th align="left" valign="top">Deployment-level</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Management experience</strong></span></p></td>
<td align="left" valign="top"><p>Manage authentication and role mapping centrally for all deployments in the organization</p></td>
<td align="left" valign="top"><p>Configure SSO for each deployment individually</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Authentication protocols</strong></span></p></td>
<td align="left" valign="top"><p>SAML only</p></td>
<td align="left" valign="top"><p>Multiple protocols, including LDAP, OIDC, and SAML</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Role mapping</strong></span></p></td>
<td align="left" valign="top"><p><a class="xref" href="ec-user-privileges.html" title="User roles and privileges">Organization-level roles and instance access roles</a>, Serverless project <a href="https://docs.elastic.co/serverless/custom-roles.html" class="ulink" target="_top">custom roles</a></p></td>
<td align="left" valign="top"><p><a href="/guide/en/elasticsearch/reference/8.17/built-in-roles.html" class="ulink" target="_top">Built-in</a> and <a href="/guide/en/elasticsearch/reference/8.17/defining-roles.html" class="ulink" target="_top">custom</a> stack-level roles</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>User experience</strong></span></p></td>
<td align="left" valign="top"><p>Users interact with Cloud</p></td>
<td align="left" valign="top"><p>Users interact with the deployment directly</p></td>
</tr>
</tbody>
</table>
</div>
<p>If you want to avoid exposing users to the Elastic Cloud UI, or have users who only interact with some deployments, then you might prefer users to interact with your deployment directly.</p>
<p>In some circumstances, you might want to use both organization-level and deployment-level SSO. For example, if you have a data analyst who interacts only with data in specific deployments, then you might want to configure deployment-level SSO for them. If you manage multiple tenants in a single organization, then you might want to configure organization-level SSO to administer deployments, and deployment-level SSO for the users who are using each deployment.</p>
<div class="position-relative"><h3><a id="ec_prerequisites_4"></a>Prerequisites</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-122/docs/saas/ec-organizations-saml-sso.asciidoc">edit</a></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
This functionality requires an <a href="/subscriptions/cloud" class="ulink" target="_top">Enterprise subscription</a>.
</li>
<li class="listitem">
You must have a SAML 2.0 compatible identity provider.
</li>
</ul>
</div>
<div class="position-relative"><h3><a id="ec_risks_and_considerations"></a>Risks and considerations</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-122/docs/saas/ec-organizations-saml-sso.asciidoc">edit</a></div>
<p>Before you configure SAML SSO, familiarize yourself with the following risks and considerations:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Actions taken on the IdP are not automatically reflected in Elastic Cloud.
For example, if you remove a user from your IdP, they are not removed from the Elastic Cloud organization and their active sessions are not invalidated.</p>
<p>To immediately revoke a user&#8217;s active sessions, an organization owner must <a href="https://cloud.elastic.co/account/members" class="ulink" target="_top">remove the user from the Elastic Cloud organization</a> or remove their assigned roles.</p>
</li>
<li class="listitem">
If you enforce SSO authentication, you can be locked out of Elastic Cloud if your IdP is unavailable or misconfigured. You might need to work with Elastic Support to regain access to your account. To avoid being locked out, you should maintain and store an <a class="xref" href="ec-api-authentication.html#ec-api-keys" title="Create an API key">Elastic Cloud API key</a> with organization owner level privileges so that an administrator can disable enforcement in an emergency.
</li>
<li class="listitem">
If you do not enforce SSO authentication, users can still log in without authenticating with your IdP. You need to manage these users in Elastic Cloud.
</li>
<li class="listitem">
Cloud passwords are invalidated each time a user logs in using SSO. If a user needs sign in with their email and password again, they need to <a class="xref" href="ec-change-password.html" title="Change your password">change their password</a>.
</li>
<li class="listitem">
Role mappings only take effect when your organization&#8217;s members authenticate using SSO. If SSO authentication is not enforced, users might have roles that are inconsistent with the role mapping when they log in using other methods.
</li>
<li class="listitem">
Roles manually assigned using the Elastic Cloud UI are overwritten by the role mapping when the user logs in using SSO.
</li>
</ul>
</div>
<div class="position-relative"><h3><a id="ec-saml-sso-claim-domain"></a>Claim a domain</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-122/docs/saas/ec-organizations-saml-sso.asciidoc">edit</a></div>
<p>Before you can register and use your IdP with Elastic Cloud, you must claim one or more domains.
Only users that have email addresses that match claimed domains can authenticate with your IdP.</p>
<p>If the members of your Elastic Cloud organization have email addresses from multiple domains, you can claim multiple domains.</p>
<p>You must have authority to modify your domain&#8217;s DNS records and be a member of the <span class="strong strong"><strong>Organization owner</strong></span> role in Elastic Cloud to complete this step.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Open your organization&#8217;s <a href="https://cloud.elastic.co/account/idp" class="ulink" target="_top"><span class="strong strong"><strong>Security</strong></span></a> tab.
</li>
<li class="listitem">
In the <span class="strong strong"><strong>Domains</strong></span> section, click <span class="strong strong"><strong>Add domain</strong></span>.
</li>
<li class="listitem">
In the <span class="strong strong"><strong>Domain name</strong></span> field, enter the domain that you want to claim and then click <span class="strong strong"><strong>Generate verification code</strong></span>.
</li>
<li class="listitem">
In the DNS provider settings for your domain, add a new TXT record with the name <code class="literal">_elastic_domain_challenge</code> and the verification code as the value.
</li>
<li class="listitem">
<p>Verify that your DNS provider settings are correct by running a <code class="literal">dig</code> command in a Linux terminal. For example, for the domain <code class="literal">example.com</code>:</p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">dig _elastic_domain_challenge.example.com TXT
...
;; ANSWER SECTION:
_elastic_domain_challenge.example.com. 60 IN	TXT "1234rvic48untuh8uckoroaelpz7iid4uk5b8g0m2e4q57b07kak66r7xetoge8zn"
...</pre>
</div>
</li>
<li class="listitem">
In the Elastic Cloud UI, click <span class="strong strong"><strong>Verify and add domain</strong></span>.
</li>
</ol>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>It might take some time for the DNS records to be updated and propagated in the network. If verification isn&#8217;t successful, wait a while and try again.</p>
</div>
</div>
<div class="position-relative"><h3><a id="ec-saml-sso-register-idp"></a>Register a SAML IdP</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-122/docs/saas/ec-organizations-saml-sso.asciidoc">edit</a></div>
<p>After you have claimed one or more domains, you can register your IdP with Elastic Cloud.
The steps vary by IdP; for more specific details, refer to <a class="xref" href="ec-saml-sso-entra.html" title="Register Elastic Cloud SAML in Microsoft Entra ID">Register Elastic Cloud SAML in Microsoft Entra ID</a> and <a class="xref" href="ec-saml-sso-okta.html" title="Register Elastic Cloud SAML in Okta">Register Elastic Cloud SAML in Okta</a>.</p>
<div class="position-relative"><h4><a id="ec_create_a_new_saml_2_application"></a>Create a new SAML 2 application</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-122/docs/saas/ec-organizations-saml-sso.asciidoc">edit</a></div>
<p>Create a new SAML 2 application in your IdP.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Use placeholder values for the assertion consumer service (ACS) and SP entity ID/audience.
Those values will be provided by Elastic Cloud in a later step.
</li>
<li class="listitem">
Configure your application to send an <code class="literal">email</code> attribute statement with the email address of your organization members.
The email should match the domain that you claimed.
</li>
<li class="listitem">
Optionally configure the application to send <code class="literal">firstName</code> and <code class="literal">lastName</code> attribute statements, which will be used to set the respective fields of the user&#8217;s Elastic Cloud account.
</li>
<li class="listitem">
If you&#8217;re planning to use role mappings, configure the application to send a <code class="literal">groups</code> attribute statement with the groups that you want to map to roles in Elastic Cloud.
</li>
<li class="listitem">
Note the SAML issuer and the SSO URL, which is the URL of the IdP where users will be redirected at login.
</li>
<li class="listitem">
Download the public certificate of the SAML 2 application.
</li>
</ol>
</div>
<div class="position-relative"><h4><a id="ec_register_the_idp_with_elastic_cloud"></a>Register the IdP with Elastic Cloud</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-122/docs/saas/ec-organizations-saml-sso.asciidoc">edit</a></div>
<p>Add the information that you collected to Elastic Cloud.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Open your organization&#8217;s <a href="https://cloud.elastic.co/account/idp" class="ulink" target="_top"><span class="strong strong"><strong>Security</strong></span></a> tab.
</li>
<li class="listitem">
In the <span class="strong strong"><strong>User authentication</strong></span> section, click <span class="strong strong"><strong>Configure SSO</strong></span>.
</li>
<li class="listitem">
<p>Fill the following fields:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<span class="strong strong"><strong>Identity Provider Entity ID</strong></span>: The SAML issuer that you collected in the previous step. This is unique identifier of your identity provider that allows Elastic Cloud to verify the source of SAML assertions.
</li>
<li class="listitem">
<span class="strong strong"><strong>Identity Provider SSO URL</strong></span>: The SSO URL that you collected in the previous step. This should be the HTTP-POST SAML binding of your identity provider. Users will be redirected to this URL when they attempt to log in.
</li>
<li class="listitem">
<span class="strong strong"><strong>Public x509 certificate</strong></span>: The public certificate of the SAML 2 application that you downloaded in the previous step. This is the certificate that SAML responses will be signed with by your IdP. The certificate must be in PEM format.
</li>
<li class="listitem">
<span class="strong strong"><strong>Login identifier prefix</strong></span>: A customizable piece of the Elastic Cloud SSO URL that your organization members can use to authenticate. This could be the name of your business. You can use lowercase alphanumeric characters and hyphens in this value, and you can change it later.
</li>
</ol>
</div>
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Update configuration</strong></span>.
</li>
</ol>
</div>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>The <span class="strong strong"><strong>Only allow login through my identity provider</strong></span> option is disabled by default. You must verify your SSO configuration by logging in using SSO to enable this option.</p>
</div>
</div>
<p>If your configuration is valid, the following details of the service provider (SP) will be displayed:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p><span class="strong strong"><strong>SSO Login URL</strong></span>: The URL that your organization members can use to log in to your organization using your IdP.</p>
<p>If your IdP supports an application bookmark or tile, this is the URL that should be used. Elastic Cloud does not support IdP-initiated SSO.</p>
</li>
<li class="listitem">
<span class="strong strong"><strong>Service provider Entity ID</strong></span>: The unique identifier that allows your IDP to recognize and validate requests from Elastic Cloud.
</li>
<li class="listitem">
<span class="strong strong"><strong>Service provider ACS URL</strong></span>: The Elastic Cloud URL that receives SAML assertions from your IdP.
</li>
<li class="listitem">
<span class="strong strong"><strong>Metadata URL</strong></span>: The link to an XML metadata file that contains the Elastic service provider metadata. If your IdP accepts metadata files, then you can use this file to configure your IdP.
</li>
</ul>
</div>
<div class="position-relative"><h4><a id="ec_update_the_saml_2_application_in_your_idp"></a>Update the SAML 2 application in your IdP</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-122/docs/saas/ec-organizations-saml-sso.asciidoc">edit</a></div>
<p>Using the details returned in the previous step, update the assertion consumer service (ACS), SP entity ID/audience, and SSO login URL values in your SAML 2 application.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>Additional details that you might want to use in your IdP configuration, such as the request signing certificate, are available in the downloadable metadata file.</p>
</div>
</div>
<div class="position-relative"><h3><a id="ec_test_sso"></a>Test SSO</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-122/docs/saas/ec-organizations-saml-sso.asciidoc">edit</a></div>
<p>After you register the IdP in Elastic Cloud and configure your IdP, you can test authentication.
To begin SSO, open the identity provider SSO URL in an incognito browsing session.
If everything is configured correctly, you should be redirected to your IdP for authentication and then redirected back to Elastic Cloud signed in.</p>
<p>Users who are not a member of the Elastic Cloud organization can authenticate with your IdP to automatically create an Elastic Cloud account provided that their email matches the claimed domain.</p>
<div class="position-relative"><h3><a id="enforce-sso"></a>Enforce SSO</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-122/docs/saas/ec-organizations-saml-sso.asciidoc">edit</a></div>
<p>After SSO is configured successfully, you might want to enforce SSO authentication for members of your organization.
This enforcement requires members to authenticate with SSO through the organization&#8217;s SAML IdP and prevents them from logging in by any other methods.
It ensures that users who have been off-boarded in your IdP can no longer authenticate to Elastic Cloud, and also ensures users have the appropriate role mappings applied at each login.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>If you turn on enforcement, you will be unable to access Elastic Cloud if your IdP is unavailable or misconfigured or there is an Elastic Cloud incident.
It is recommended that you maintain and store an Elastic Cloud API key with organization owner level privileges so that an administrator can disable enforcement in an emergency. Refer to <a class="xref" href="ec-api-authentication.html#ec-api-keys" title="Create an API key">Create an API key</a>.
You can also open a support issue if you lose access to your Elastic Cloud account.</p>
</div>
</div>
<div class="position-relative"><h4><a id="ec_enable_enforcement"></a>Enable enforcement</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-122/docs/saas/ec-organizations-saml-sso.asciidoc">edit</a></div>
<p>To protect your account from being accidentally locked out when this option is enabled, we validate that you are authenticated SSO with the latest applied configuration before enabling enforcement.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Open your organization&#8217;s <a href="https://cloud.elastic.co/account/idp" class="ulink" target="_top"><span class="strong strong"><strong>Security</strong></span></a> tab.
</li>
<li class="listitem">
In the <span class="strong strong"><strong>User authentication</strong></span> section, click <span class="strong strong"><strong>Edit</strong></span>.
</li>
<li class="listitem">
Toggle the <span class="strong strong"><strong>Only allow login through my identity provider</strong></span> option on to enable enforcement.
</li>
</ol>
</div>
<div class="position-relative"><h4><a id="ec_disable_enforcement"></a>Disable enforcement</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-122/docs/saas/ec-organizations-saml-sso.asciidoc">edit</a></div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Open your organization&#8217;s <a href="https://cloud.elastic.co/account/idp" class="ulink" target="_top"><span class="strong strong"><strong>Security</strong></span></a> tab.
</li>
<li class="listitem">
In the <span class="strong strong"><strong>User authentication</strong></span> section, click <span class="strong strong"><strong>Edit</strong></span>.
</li>
<li class="listitem">
Toggle the <span class="strong strong"><strong>Only allow login through my identity provider</strong></span> option off to disable enforcement.
</li>
</ol>
</div>
<p>If you are unable to access the UI for any reason, use the following API call to disable enforcement. The API key that you use must have organization owner level privileges to disable enforcement.</p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">curl -XPUT \
-H 'Content-Type: application/json' \
-H "Authorization: ApiKey $EC_API_KEY" \
"https://api.elastic-cloud.com/api/v1/organizations/$ORGANIZATION_ID" \
-d '
{
  "enforce_authentication_method": null
}
'</pre>
</div>
<div class="position-relative"><h3><a id="role-mappings"></a>Role mappings</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-122/docs/saas/ec-organizations-saml-sso.asciidoc">edit</a></div>
<p>To automate <a class="xref" href="ec-user-privileges.html" title="User roles and privileges">role</a> assignments to your Elastic Cloud organization&#8217;s members, you can use role mappings. Role mappings map groups returned by your IdP in the <code class="literal">groups</code> SAML attribute to one or more Elastic Cloud roles. The mapping will be evaluated and the applicable roles will be assigned each time your organization&#8217;s members log into Elastic Cloud using SSO.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>If <a class="xref" href="ec-saml-sso.html#enforce-sso" title="Enforce SSO">SSO enforcement</a> is not enabled, user roles might not be consistent with your role mapping and additional manual role assignment might be needed. Roles manually assigned using the Elastic Cloud UI are overwritten by the role mapping when the user logs in using SSO.</p>
</div>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>If the <code class="literal">groups</code> attribute is not included in the SAML response, the user will keep whatever groups they were last assigned by the IdP. If you want to remove all groups for a user as part of an offboarding process, instead unassign the user from the Elastic Cloud application.</p>
</div>
</div>
<p>To configure role mappings:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Open your organization&#8217;s <a href="https://cloud.elastic.co/account/idp" class="ulink" target="_top"><span class="strong strong"><strong>Security</strong></span></a> tab.
</li>
<li class="listitem">
In the <span class="strong strong"><strong>Role mappings</strong></span> section, click <span class="strong strong"><strong>Create role mapping</strong></span>.
</li>
<li class="listitem">
Add a name for the role mapping. The name helps to identify the role mapping to other members, and must be unique.
</li>
<li class="listitem">
Click to configure the roles that you want to assign to users who meet the mapping rules, click <span class="strong strong"><strong>Add roles</strong></span> and then select the roles. For more information, refer to <a class="xref" href="ec-user-privileges.html" title="User roles and privileges"><em>User roles and privileges</em></a>.
</li>
<li class="listitem">
<p>In the <span class="strong strong"><strong>Mapping rules</strong></span> section, add rules for the role mapping:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Select <span class="strong strong"><strong>All are true</strong></span> or <span class="strong strong"><strong>Any are true</strong></span> to define how the rules are evaluated.
</li>
<li class="listitem">
<p>Add group name or names that the member must have in their SAML assertion to be assigned the role.</p>
<p>Use the wildcard character <code class="literal">*</code> to specify group name patterns. Wildcards will match 0 or more characters.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="position-relative"><h3><a id="ec_disable_sso"></a>Disable SSO</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-122/docs/saas/ec-organizations-saml-sso.asciidoc">edit</a></div>
<p>If SSO enforcement is enabled, then you must disable SSO enforcement before you disable SSO.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Open your organization&#8217;s <a href="https://cloud.elastic.co/account/idp" class="ulink" target="_top"><span class="strong strong"><strong>Security</strong></span></a> tab.
</li>
<li class="listitem">
In the <span class="strong strong"><strong>User authentication</strong></span> section, click <span class="strong strong"><strong>Edit</strong></span>.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Disable SAML SSO</strong></span>.
</li>
</ol>
</div>
<div class="position-relative"><h3><a id="ec_troubleshoot_sso"></a>Troubleshoot SSO</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-122/docs/saas/ec-organizations-saml-sso.asciidoc">edit</a></div>
<div class="position-relative"><h4><a id="ec_sso_screen_is_not_redirecting_to_my_idp"></a>SSO screen is not redirecting to my IdP</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-122/docs/saas/ec-organizations-saml-sso.asciidoc">edit</a></div>
<p>Double check the <code class="literal">saml_idp.sso_url</code> provided during IdP registration.
This should be the HTTP-POST binding URL to your IdP&#8217;s SAML application.
Elastic Cloud will redirect to this URL during sign in.</p>
<div class="position-relative"><h4><a id="ec_failure_to_redirect_back_to_elastic_cloud_after_idp_log_in_or_redirected_to_access_denied"></a>Failure to redirect back to Elastic Cloud after IdP log in, or redirected to <code class="literal">/access-denied</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-122/docs/saas/ec-organizations-saml-sso.asciidoc">edit</a></div>
<p>There could be a variety of issues that might result in sign in failure.
Try tracing the SAML request and response with a SAML tracer. You should see a <code class="literal">SAMLRequest</code> field when redirecting to your IdP, and a
<code class="literal">SAMLResponse</code> field when redirecting to the Cloud ACS.</p>
<p>If there was an error in your IdP, there may be a non-success <code class="literal">Status</code> field which should describe the error that occurred.</p>
<p>If the SAML response was successful, double-check the components of the SAML response:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
The <code class="literal">Destination</code> and <code class="literal">Recipient</code> should match the <code class="literal">acs</code> provided by the Elastic Cloud IdP registration API.
</li>
<li class="listitem">
An <code class="literal">AttributeStatement</code> named <code class="literal">email</code> should be sent with the email matching a domain claimed by your Elastic Cloud organization. If the
domain of the email doesn&#8217;t match a claimed domain, the authentication flow will not complete.
</li>
<li class="listitem">
The <code class="literal">AudienceRestriction</code> <code class="literal">Audience</code> should match the <code class="literal">sp_entity_id</code> provided by the Elastic Cloud IdP registration API.
</li>
<li class="listitem">
The <code class="literal">Issuer</code> should match the value provided to the Elastic Cloud IdP registration API.
</li>
<li class="listitem">
The signature of the SAML response should be verifiable by the certificate provided during IdP configuration in Cloud.
</li>
</ul>
</div>


</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="ec-user-privileges.html">« User roles and privileges</a>
</span>
<span class="next">
<a href="ec-saml-sso-okta.html">Register Elastic Cloud SAML in Okta »</a>
</span>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>

                        <!-- Feedback widget -->
                        <div id="feedbackWidgetContainer"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


        <div id='elastic-footer'></div>
        <script src='https://www.elastic.co/elastic-footer.js'></script>
        <!-- Footer Section end-->

      </section>
    </div>

    <!-- Feedback modal -->
    <div id="feedbackModalContainer"></div>

    <script src="/guide/static/jquery.js"></script>
    <script type="text/javascript" src="/guide/static/docs-v1.js"></script>
    <script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
