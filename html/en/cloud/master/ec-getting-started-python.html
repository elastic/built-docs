<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Ingest data with Python on Elasticsearch Service | Elasticsearch Service Documentation [master] | Elastic</title>
<meta class="elastic" name="content" content="Ingest data with Python on Elasticsearch Service | Elasticsearch Service Documentation [master]">

<link rel="home" href="index.html" title="Elasticsearch Service Documentation [master]"/>
<link rel="up" href="ec-ingest-guides.html" title="Ingesting data from your application"/>
<link rel="prev" href="ec-getting-started-node-js.html" title="Ingest data with Node.js on Elasticsearch Service"/>
<link rel="next" href="ec-getting-started-search-use-cases-beats-logstash.html" title="Ingest data from Beats to Elasticsearch Service with Logstash as a proxy"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="Elastic Cloud"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Cloud/Reference/master"/>
<meta name="DC.subject" content="Elastic Cloud"/>
<meta name="DC.identifier" content="master"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <!--© 2015-2022 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <!--BEGIN QUALTRICS WEBSITE FEEDBACK SNIPPET-->
    <script type='text/javascript'>
      (function(){var g=function(e,h,f,g){
      this.get=function(a){for(var a=a+"=",c=document.cookie.split(";"),b=0,e=c.length;b<e;b++){for(var d=c[b];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return null};
      this.set=function(a,c){var b="",b=new Date;b.setTime(b.getTime()+6048E5);b="; expires="+b.toGMTString();document.cookie=a+"="+c+b+"; path=/; "};
      this.check=function(){var a=this.get(f);if(a)a=a.split(":");else if(100!=e)"v"==h&&(e=Math.random()>=e/100?0:100),a=[h,e,0],this.set(f,a.join(":"));else return!0;var c=a[1];if(100==c)return!0;switch(a[0]){case "v":return!1;case "r":return c=a[2]%Math.floor(100/c),a[2]++,this.set(f,a.join(":")),!c}return!0};
      this.go=function(){if(this.check()){var a=document.createElement("script");a.type="text/javascript";a.src=g;document.body&&document.body.appendChild(a)}};
      this.start=function(){var a=this;window.addEventListener?window.addEventListener("load",function(){a.go()},!1):window.attachEvent&&window.attachEvent("onload",function(){a.go()})}};
      try{(new g(100,"r","QSI_S_ZN_emkP0oSe9Qrn7kF","https://znemkp0ose9qrn7kf-elastic.siteintercept.qualtrics.com/WRSiteInterceptEngine/?Q_ZID=ZN_emkP0oSe9Qrn7kF")).start()}catch(i){}})();
    </script><div id='ZN_emkP0oSe9Qrn7kF'><!--DO NOT REMOVE-CONTENTS PLACED HERE--></div>
    <!--END WEBSITE FEEDBACK SNIPPET-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  <div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elasticsearch Service Documentation [master]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="ec-cloud-ingest-data.html">Adding data to Elasticsearch</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="ec-ingest-guides.html">Ingesting data from your application</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="ec-getting-started-node-js.html">« Ingest data with Node.js on Elasticsearch Service</a>
</span>
<span class="next">
<a href="ec-getting-started-search-use-cases-beats-logstash.html">Ingest data from Beats to Elasticsearch Service with Logstash as a proxy »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="ec-getting-started-python"></a>Ingest data with Python on Elasticsearch Service<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/master/docs/shared/ec-ce-getting-started-use-cases-python.asciidoc">edit</a></h2>
</div></div></div>
<p>This guide tells you how to get started with:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Securely connecting to Elasticsearch Service with Python
</li>
<li class="listitem">
Ingesting data into your deployment from your application
</li>
<li class="listitem">
Searching and modifying your data on Elasticsearch Service
</li>
</ul>
</div>
<p>If you are an Python application programmer who is new to the Elastic Stack, this content can help you get started more easily.</p>
<p><em>Time required: 45 minutes</em></p>
<h4><a id="ec_prerequisites"></a>Prerequisites<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/master/docs/shared/ec-ce-getting-started-use-cases-python.asciidoc">edit</a></h4>
<p>These steps are applicable to your existing application. If you don’t have one, you can use the example included here to create one.</p>
<h5><a id="ec_get_the_elasticsearch_packages"></a>Get the <code class="literal">elasticsearch</code> packages<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/master/docs/shared/ec-ce-getting-started-use-cases-python.asciidoc">edit</a></h5>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">python -m pip install elasticsearch
python -m pip install elasticsearch-async</pre>
</div>
<h5><a id="ec_create_the_setup_py_file"></a>Create the <code class="literal">setup.py</code> file<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/master/docs/shared/ec-ce-getting-started-use-cases-python.asciidoc">edit</a></h5>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh"># Elasticsearch 7.x
elasticsearch&gt;=7.0.0,&lt;8.0.0</pre>
</div>
<h4><a id="ec_get_elasticsearch_service_2"></a>Get Elasticsearch Service<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/master/docs/shared/ec-ce-getting-started-use-cases-python.asciidoc">edit</a></h4>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<a href="/cloud/elasticsearch-service/signup?baymax=docs-body&amp;elektra=docs" class="ulink" target="_top">Get a free trial</a>.
</li>
<li class="listitem">
Log into <a href="https://cloud.elastic.co?baymax=docs-body&amp;elektra=docs" class="ulink" target="_top">Elastic Cloud</a>.
</li>
<li class="listitem">
Select <span class="strong strong"><strong>Create deployment</strong></span>.
</li>
<li class="listitem">
Give your deployment a name. You can leave all other settings at their default values.
</li>
<li class="listitem">
Select <span class="strong strong"><strong>Create deployment</strong></span> and save your Elastic deployment credentials. You need these credentials later on.
</li>
<li class="listitem">
When the deployment is ready, click <span class="strong strong"><strong>Continue</strong></span> and a page of <span class="strong strong"><strong>Setup guides</strong></span> is displayed. To continue to the deployment homepage click <span class="strong strong"><strong>I&#8217;d like to do something else</strong></span>.
</li>
</ol>
</div>
<p>Prefer not to subscribe to yet another service? You can also get Elasticsearch Service through <a class="xref" href="ec-marketplaces.html" title="Subscribing from a marketplace">AWS, Azure, and GCP marketplaces</a>.</p>
<h4><a id="ec_connect_securely"></a>Connect securely<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/master/docs/shared/ec-ce-getting-started-use-cases-python.asciidoc">edit</a></h4>
<p>When connecting to Elasticsearch Service you need to use your Cloud ID to specify the connection details. Find your Cloud ID by going to the Kibana main menu and selecting Management &gt; Integrations, and then selecting View deployment details.</p>
<p>To connect to, stream data to, and issue queries with Elasticsearch Service, you need to think about authentication. Two authentication mechanisms are supported, <em>API key</em> and <em>basic authentication</em>. Here, to get you started quickly, we’ll show you how to use basic authentication, but you can also generate API keys as shown later on. API keys are safer and preferred for production environments.</p>
<h5><a id="ec_basic_authentication_2"></a>Basic authentication<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/master/docs/shared/ec-ce-getting-started-use-cases-python.asciidoc">edit</a></h5>
<p>For basic authentication, use the same deployment credentials (<code class="literal">username</code> and <code class="literal">password</code> parameters) and Cloud ID you copied down earlier. Find your Cloud ID by going to the Kibana main menu and selecting Management &gt; Integrations, and then selecting View deployment details. (If you did not save the password, you can
<a class="xref" href="ec-password-reset.html" title="Reset the elastic user password">reset the password</a>
.)</p>
<p>You first need to create and edit an <code class="literal">example.ini</code> file with your deployment details:</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">[ELASTIC]
cloud_id = DEPLOYMENT_NAME:CLOUD_ID_DETAILS
user = elastic
password = LONGPASSWORD</pre>
</div>
<p>The following examples are to be typed into the Python interpreter in
interactive mode.  The prompts have been removed to make it easier for
you to copy the samples, the output from the interpreter is shown
unmodified.</p>
<h5><a id="ec_import_libraries_and_read_in_the_configuration"></a>Import libraries and read in the configuration<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/master/docs/shared/ec-ce-getting-started-use-cases-python.asciidoc">edit</a></h5>
<div class="pre_wrapper lang-python">
<pre class="programlisting prettyprint lang-python">❯ python3
Python 3.9.6 (default, Jun 29 2021, 05:25:02)
[Clang 12.0.5 (clang-1205.0.22.9)] on darwin
Type "help", "copyright", "credits" or "license" for more information.

from elasticsearch import Elasticsearch, helpers
import configparser

config = configparser.ConfigParser()
config.read('example.ini')</pre>
</div>
<h6><a id="ec_output"></a>Output<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/master/docs/shared/ec-ce-getting-started-use-cases-python.asciidoc">edit</a></h6>
<div class="pre_wrapper lang-python">
<pre class="programlisting prettyprint lang-python">['example.ini']
&gt;&gt;&gt;</pre>
</div>
<h5><a id="ec_instantiate_the_elasticsearch_connection"></a>Instantiate the Elasticsearch connection<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/master/docs/shared/ec-ce-getting-started-use-cases-python.asciidoc">edit</a></h5>
<div class="pre_wrapper lang-python">
<pre class="programlisting prettyprint lang-python">es = Elasticsearch(
    cloud_id=config['ELASTIC']['cloud_id'],
    http_auth=(config['ELASTIC']['user'], config['ELASTIC']['password'])
)</pre>
</div>
<p>You can now confirm that you have connected to the deployment by returning some information about the deployment:</p>
<div class="pre_wrapper lang-python">
<pre class="programlisting prettyprint lang-python">es.info()</pre>
</div>
<h6><a id="ec_output_2"></a>Output<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/master/docs/shared/ec-ce-getting-started-use-cases-python.asciidoc">edit</a></h6>
<div class="pre_wrapper lang-python">
<pre class="programlisting prettyprint lang-python">{'name': 'instance-0000000000',
  'cluster_name': '747ab208fb70403dbe3155af102aef56',
  'cluster_uuid': 'IpgjkPkVQ5efJY-M9ilG7g',
  'version': {'number': '7.15.0', 'build_flavor': 'default', 'build_type': 'docker', 'build_hash': '79d65f6e357953a5b3cbcc5e2c7c21073d89aa29', 'build_date': '2021-09-16T03:05:29.143308416Z', 'build_snapshot': False, 'lucene_version': '8.9.0', 'minimum_wire_compatibility_version': '6.8.0', 'minimum_index_compatibility_version': '6.0.0-beta1'},
  'tagline': 'You Know, for Search'}</pre>
</div>
<h4><a id="ec_ingest_data_2"></a>Ingest data<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/master/docs/shared/ec-ce-getting-started-use-cases-python.asciidoc">edit</a></h4>
<p>After connecting to your deployment, you are ready to index and search data. Let&#8217;s create a new index, insert some quotes from our favorite characters, and then refresh the index so that it is ready to be searched. A refresh makes all operations performed on an index since the last refresh available for search.</p>
<h5><a id="ec_index_a_document"></a>Index a document<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/master/docs/shared/ec-ce-getting-started-use-cases-python.asciidoc">edit</a></h5>
<div class="pre_wrapper lang-python">
<pre class="programlisting prettyprint lang-python">es.index(
 index='lord-of-the-rings',
 document={
  'character': 'Aragon',
  'quote': 'It is not this day.'
 })</pre>
</div>
<h6><a id="ec_output_3"></a>Output<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/master/docs/shared/ec-ce-getting-started-use-cases-python.asciidoc">edit</a></h6>
<div class="pre_wrapper lang-python">
<pre class="programlisting prettyprint lang-python">{'_index': 'lord-of-the-rings',
  '_type': '_doc',
  '_id': 'IanWEnwBg_mH2XweqDqg',
  '_version': 1,
  'result': 'created',
  '_shards': {'total': 2, 'successful': 1, 'failed': 0}, '_seq_no': 34, '_primary_term': 1}</pre>
</div>
<h5><a id="ec_index_another_record"></a>Index another record<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/master/docs/shared/ec-ce-getting-started-use-cases-python.asciidoc">edit</a></h5>
<div class="pre_wrapper lang-python">
<pre class="programlisting prettyprint lang-python">es.index(
 index='lord-of-the-rings',
 document={
  'character': 'Gandalf',
  'quote': 'A wizard is never late, nor is he early.'
 })</pre>
</div>
<h6><a id="ec_output_4"></a>Output<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/master/docs/shared/ec-ce-getting-started-use-cases-python.asciidoc">edit</a></h6>
<div class="pre_wrapper lang-python">
<pre class="programlisting prettyprint lang-python">{'_index': 'lord-of-the-rings',
  '_type': '_doc',
  '_id': 'IqnWEnwBg_mH2Xwezjpj',
  '_version': 1,
  'result': 'created',
  '_shards': {'total': 2, 'successful': 1, 'failed': 0}, '_seq_no': 35, '_primary_term': 1}</pre>
</div>
<h5><a id="ec_index_a_third_record"></a>Index a third record<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/master/docs/shared/ec-ce-getting-started-use-cases-python.asciidoc">edit</a></h5>
<div class="pre_wrapper lang-python">
<pre class="programlisting prettyprint lang-python">es.index(
 index='lord-of-the-rings',
 document={
  'character': 'Frodo Baggins',
  'quote': 'You are late'
 })</pre>
</div>
<h6><a id="ec_output_5"></a>Output<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/master/docs/shared/ec-ce-getting-started-use-cases-python.asciidoc">edit</a></h6>
<div class="pre_wrapper lang-python">
<pre class="programlisting prettyprint lang-python">{'_index': 'lord-of-the-rings',
  '_type': '_doc',
  '_id': 'I6nWEnwBg_mH2Xwe_Tre',
  '_version': 1,
  'result': 'created',
  '_shards': {'total': 2, 'successful': 1, 'failed': 0}, '_seq_no': 36, '_primary_term': 1}</pre>
</div>
<h5><a id="ec_refresh_the_index"></a>Refresh the index<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/master/docs/shared/ec-ce-getting-started-use-cases-python.asciidoc">edit</a></h5>
<div class="pre_wrapper lang-python">
<pre class="programlisting prettyprint lang-python">es.indices.refresh(index='lord-of-the-rings')</pre>
</div>
<h6><a id="ec_output_6"></a>Output<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/master/docs/shared/ec-ce-getting-started-use-cases-python.asciidoc">edit</a></h6>
<div class="pre_wrapper lang-python">
<pre class="programlisting prettyprint lang-python">{'_shards': {'total': 2, 'successful': 1, 'failed': 0}}</pre>
</div>
<p>When using the <code class="literal">es.index</code> API, the request automatically creates the <code class="literal">lord-of-the-rings</code> index, if it doesn’t exist already, as well as document IDs for each indexed document if they are not explicitly specified.</p>
<h4><a id="ec_search_and_modify_data_2"></a>Search and modify data<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/master/docs/shared/ec-ce-getting-started-use-cases-python.asciidoc">edit</a></h4>
<p>After creating a new index and ingesting some data, you are now ready to search. Let’s find what different characters have said things about being <code class="literal">late</code>:</p>
<div class="pre_wrapper lang-python">
<pre class="programlisting prettyprint lang-python">result = es.search(
 index='lord-of-the-rings',
  query={
    'match': {'quote': 'late'}
  }
 )

result['hits']['hits']</pre>
</div>
<h5><a id="ec_output_7"></a>Output<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/master/docs/shared/ec-ce-getting-started-use-cases-python.asciidoc">edit</a></h5>
<div class="pre_wrapper lang-python">
<pre class="programlisting prettyprint lang-python">[{'_index': 'lord-of-the-rings',
  '_type': '_doc',
  '_id': '2EkAzngB_pyHD3p65UMt',
  '_score': 0.5820575,
  '_source': {'character': 'Frodo Baggins', 'quote': 'You are late'}},
 {'_index': 'lord-of-the-rings',
  '_type': '_doc',
  '_id': '10kAzngB_pyHD3p65EPR',
  '_score': 0.37883914,
  '_source': {'character': 'Gandalf',
   'quote': 'A wizard is never late, nor is he early.'}}]</pre>
</div>
<p>The search request returns content of documents containing <code class="literal">late</code> in the quote field, including document IDs that were automatically generated.</p>
<p>You can make updates to specific documents using document IDs. Let’s add a birthplace for our character:</p>
<div class="pre_wrapper lang-python">
<pre class="programlisting prettyprint lang-python">es.update(
 index='lord-of-the-rings',
 id='2EkAzngB_pyHD3p65UMt', <a id="CO2-1"></a><i class="conum" data-value="1"></i>
 doc={'birthplace': 'The Shire'}
 )</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO2-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>This update example uses the field <code class="literal">id</code> to identify the document to update. Copy the <code class="literal">id</code> from the document related to <code class="literal">Frodo Baggins</code> when you update and add the <code class="literal">birthplace</code>.</p>
</td>
</tr>
</table>
</div>
<h5><a id="ec_output_8"></a>Output<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/master/docs/shared/ec-ce-getting-started-use-cases-python.asciidoc">edit</a></h5>
<div class="pre_wrapper lang-python">
<pre class="programlisting prettyprint lang-python">es.get(index='lord-of-the-rings', id='2EkAzngB_pyHD3p65UMt')
{'_index': 'lord-of-the-rings',
 '_type': '_doc',
 '_id': '2EkAzngB_pyHD3p65UMt',
 '_version': 2,
 '_seq_no': 3,
 '_primary_term': 1,
 'found': True,
 '_source': {'character': 'Frodo Baggins',
  'quote': 'You are late',
  'birthplace': 'The Shire'}}</pre>
</div>
<p>For frequently used API calls with the Python client, check <a href="/guide/en/elasticsearch/client/python-api/current/examples.html" class="ulink" target="_top">Examples</a>.</p>
<h4><a id="ec_switch_to_api_key_authentication_2"></a>Switch to API key authentication<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/master/docs/shared/ec-ce-getting-started-use-cases-python.asciidoc">edit</a></h4>
<p>To get started, authentication to Elasticsearch used the <code class="literal">elastic</code>
superuser and password, but an API key is much safer and a best practice for production.</p>
<p>In the example that follows, an API key is created with the cluster <code class="literal">monitor</code> privilege which gives read-only access for determining the cluster state. Some additional privileges also allow <code class="literal">create_index</code>, <code class="literal">write</code>, <code class="literal">read</code>, and <code class="literal">manage</code> operations for the specified index. The index <code class="literal">manage</code> privilege is added to enable index refreshes.</p>
<p>The easiest way to create this key is in the API console for your deployment. Select the deployment name and go to <span class="strong strong"><strong>&#9776;</strong></span> &gt; <span class="strong strong"><strong>Management</strong></span> &gt; <span class="strong strong"><strong>Dev Tools</strong></span>:</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">POST /_security/api_key
{
  "name": "python_example",
  "role_descriptors": {
    "python_read_write": {
      "cluster": ["monitor"],
      "index": [
        {
          "names": ["test-index"],
          "privileges": ["create_index", "write", "read", "manage"]
        }
      ]
    }
  }
}</pre>
</div>
<h5><a id="ec_the_output_is"></a>The output is:<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/master/docs/shared/ec-ce-getting-started-use-cases-python.asciidoc">edit</a></h5>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
  "id" : "API_KEY_ID",
  "name" : "python_example",
  "api_key" : "API_KEY_DETAILS"
}</pre>
</div>
<p>Edit the <code class="literal">example.ini</code> file you created earlier and add the <code class="literal">id</code> and <code class="literal">api_key</code> you just created. You should also remove the lines for <code class="literal">user</code> and <code class="literal">password</code> you added earlier after you have tested the <code class="literal">api_key</code>, and consider changing the <code class="literal">elastic</code> password using the <a href="https://cloud.elastic.co?baymax=docs-body&amp;elektra=docs" class="ulink" target="_top">Elasticsearch Service Console</a>.</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">[DEFAULT]
cloud_id = DEPLOYMENT_NAME:CLOUD_ID_DETAILS
apikey_id = API_KEY_ID
apikey_key = API_KEY_DETAILS</pre>
</div>
<p>You can now use the API key in place of a username and password. The client connection becomes:</p>
<div class="pre_wrapper lang-python">
<pre class="programlisting prettyprint lang-python">es = Elasticsearch(
    cloud_id=config['DEFAULT']['cloud_id'],
    api_key=(config['DEFAULT']['apikey_id'], config['DEFAULT']['apikey_key']),
)</pre>
</div>
<p>Check <a href="/guide/en/elasticsearch/reference/8.7/security-api-create-api-key.html" class="ulink" target="_top">Create API key API</a> to learn more about API Keys and <a href="/guide/en/elasticsearch/reference/8.7/security-privileges.html" class="ulink" target="_top">Security privileges</a> to understand which privileges are needed. If you are not sure what the right combination of privileges for your custom application is, you can enable <a href="/guide/en/elasticsearch/reference/8.7/enable-audit-logging.html" class="ulink" target="_top">audit logging</a> on Elasticsearch to find out what privileges are being used. To learn more about how logging works on Elasticsearch Service, check <a href="/blog/monitoring-elastic-cloud-deployment-logs-and-metrics" class="ulink" target="_top">Monitoring Elastic Cloud deployment logs and metrics</a>.</p>
<p>For more information on refreshing an index, searching, updating, and deleting, check the <a href="/guide/en/elasticsearch/client/python-api/current/examples.html" class="ulink" target="_top">elasticsearch-py examples</a>.</p>
<h5><a id="ec_best_practices_2"></a>Best practices<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/master/docs/shared/ec-ce-getting-started-use-cases-python.asciidoc">edit</a></h5>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Security
</span>
</dt>
<dd>
<p>
When connecting to Elasticsearch Service, the client automatically enables both request and response compression by default, since it yields significant throughput improvements. Moreover, the client also sets the SSL option <code class="literal">secureProtocol</code> to <code class="literal">TLSv1_2_method</code> unless specified otherwise. You can still override this option by configuring it.
</p>
<p>Do not enable sniffing when using Elasticsearch Service, since the nodes are behind a load balancer. Elasticsearch Service takes care of everything for you. Take a look at <a href="/blog/elasticsearch-sniffing-best-practices-what-when-why-how" class="ulink" target="_top">Elasticsearch sniffing best practices: What, when, why, how</a> if you want to know more.</p>
</dd>
<dt>
<span class="term">
Schema
</span>
</dt>
<dd>
When the example code is run, an index mapping is created automatically. The field types are selected by Elasticsearch based on the content seen when the first record was ingested, and updated as new fields appeared in the data. It would be more efficient to specify the fields and field types in advance to optimize performance. Refer to the Elastic Common Schema documentation and Field Type documentation when you design the schema for your production use cases.
</dd>
<dt>
<span class="term">
Ingest
</span>
</dt>
<dd>
For more advanced scenarios, <a href="/guide/en/elasticsearch/client/python-api/current/client-helpers.html#bulk-helpers" class="ulink" target="_top">Bulk helpers</a> gives examples for the <code class="literal">bulk</code> API that makes it possible to perform multiple operations in a single call. If you have a lot of documents to index, using bulk to batch document operations is significantly faster than submitting requests individually.
</dd>
</dl>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="ec-getting-started-node-js.html">« Ingest data with Node.js on Elasticsearch Service</a>
</span>
<span class="next">
<a href="ec-getting-started-search-use-cases-beats-logstash.html">Ingest data from Beats to Elasticsearch Service with Logstash as a proxy »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
