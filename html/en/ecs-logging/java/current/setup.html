<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Get started | ECS Logging Java Reference [1.x] | Elastic</title>
<meta class="elastic" name="content" content="Get started | ECS Logging Java Reference [1.x]">

<link rel="home" href="index.html" title="ECS Logging Java Reference [1.x]"/>
<link rel="up" href="index.html" title="ECS Logging Java Reference [1.x]"/>
<link rel="prev" href="intro.html" title="Introduction"/>
<link rel="next" href="_structured_logging_with_log4j2.html" title="Structured logging with log4j2"/>
<meta class="elastic" name="product_version" content="1.x"/>
<meta class="elastic" name="product_name" content="ECS Logging Java Reference"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/ECS-logging/java/Guide/1.x"/>
<meta name="DC.subject" content="ECS Logging Java Reference"/>
<meta name="DC.identifier" content="1.x"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <!--© 2015-2022 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link">
  <div id="related-products" class="dropdown">
    <div class="related-products-title">ECS Logging:</div>
    <div class="dropdown-anchor" tabindex="0">Java Reference<span class="dropdown-icon"></span></div>
    <div class="dropdown-content">
      <ul>
        <li><a href="/guide/en/ecs-logging/overview/current/intro.html">Reference</a></li>
        <li><a href="/guide/en/ecs-logging/go-logrus/current/intro.html">Go (Logrus) Reference</a></li>
        <li><a href="/guide/en/ecs-logging/go-zap/current/intro.html">Go (zap) Reference</a></li>
        <li><a href="/guide/en/ecs-logging/java/current/intro.html">Java Reference</a></li>
        <li><a href="/guide/en/ecs-logging/dotnet/current/intro.html">.NET Reference</a></li>
        <li><a href="/guide/en/ecs-logging/nodejs/current/intro.html">Node.js Reference</a></li>
        <li><a href="/guide/en/ecs-logging/ruby/current/intro.html">Ruby Reference</a></li>
        <li><a href="/guide/en/ecs-logging/php/current/intro.html">PHP Reference</a></li>
        <li><a href="/guide/en/ecs-logging/python/current/intro.html">Python Reference</a></li>
      </ul>
    </div>
  </div>
</span>
</div>
<div class="navheader">
<span class="prev">
<a href="intro.html">« Introduction</a>
</span>
<span class="next">
<a href="_structured_logging_with_log4j2.html">Structured logging with log4j2 »</a>
</span>
</div>
<div class="chapter">
<div class="titlepage"><div><div>
<h1 class="title"><a id="setup"></a>Get started<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ecs-logging-java/edit/1.x/docs/setup.asciidoc">edit</a></h1>
</div></div></div>
<style>
.tabs {
  width: 100%;
}
[role="tablist"] {
  margin: 0 0 -0.1em;
  overflow: visible;
}
[role="tab"] {
  position: relative;
  padding: 0.3em 0.5em 0.4em;
  border: 1px solid hsl(219, 1%, 72%);
  border-radius: 0.2em 0.2em 0 0;
  overflow: visible;
  font-family: inherit;
  font-size: inherit;
  background: hsl(220, 20%, 94%);
}
[role="tab"]:hover::before,
[role="tab"]:focus::before,
[role="tab"][aria-selected="true"]::before {
  position: absolute;
  bottom: 100%;
  right: -1px;
  left: -1px;
  border-radius: 0.2em 0.2em 0 0;
  border-top: 3px solid hsl(219, 1%, 72%);
  content: '';
}
[role="tab"][aria-selected="true"] {
  border-radius: 0;
  background: hsl(220, 43%, 99%);
  outline: 0;
}
[role="tab"][aria-selected="true"]:not(:focus):not(:hover)::before {
  border-top: 5px solid hsl(218, 96%, 48%);
}
[role="tab"][aria-selected="true"]::after {
  position: absolute;
  z-index: 3;
  bottom: -1px;
  right: 0;
  left: 0;
  height: 0.3em;
  background: hsl(220, 43%, 99%);
  box-shadow: none;
  content: '';
}
[role="tab"]:hover,
[role="tab"]:focus,
[role="tab"]:active {
  outline: 0;
  border-radius: 0;
  color: inherit;
}
[role="tab"]:hover::before,
[role="tab"]:focus::before {
  border-color: hsl(218, 96%, 48%);
}
[role="tabpanel"] {
  position: relative;
  z-index: 2;
  padding: 1em;
  border: 1px solid hsl(219, 1%, 72%);
  border-radius: 0 0.2em 0.2em 0.2em;
  box-shadow: 0 0 0.2em hsl(219, 1%, 72%);
  background: hsl(220, 43%, 99%);
  margin-bottom: 1em;
}
[role="tabpanel"] p {
  margin: 0;
}
[role="tabpanel"] * + p {
  margin-top: 1em;
}
</style>

<script>
window.addEventListener("DOMContentLoaded", () => {
  const tabs = document.querySelectorAll('[role="tab"]');
  const tabList = document.querySelector('[role="tablist"]');
  // Add a click event handler to each tab
  tabs.forEach(tab => {
    tab.addEventListener("click", changeTabs);
  });
  // Enable arrow navigation between tabs in the tab list
  let tabFocus = 0;
  tabList.addEventListener("keydown", e => {
    // Move right
    if (e.keyCode === 39 || e.keyCode === 37) {
      tabs[tabFocus].setAttribute("tabindex", -1);
      if (e.keyCode === 39) {
        tabFocus++;
        // If we're at the end, go to the start
        if (tabFocus >= tabs.length) {
          tabFocus = 0;
        }
        // Move left
      } else if (e.keyCode === 37) {
        tabFocus--;
        // If we're at the start, move to the end
        if (tabFocus < 0) {
          tabFocus = tabs.length - 1;
        }
      }
      tabs[tabFocus].setAttribute("tabindex", 0);
      tabs[tabFocus].focus();
    }
  });
});

function setActiveTab(target) {
  const parent = target.parentNode;
  const grandparent = parent.parentNode;
  // console.log(grandparent);
  // Remove all current selected tabs
  parent
    .querySelectorAll('[aria-selected="true"]')
    .forEach(t => t.setAttribute("aria-selected", false));
  // Set this tab as selected
  target.setAttribute("aria-selected", true);
  // Hide all tab panels
  grandparent
    .querySelectorAll('[role="tabpanel"]')
    .forEach(p => p.setAttribute("hidden", true));
  // Show the selected panel
  grandparent.parentNode
    .querySelector(`#${target.getAttribute("aria-controls")}`)
    .removeAttribute("hidden");
}

function changeTabs(e) {
  // get the containing list of the tab that was just clicked
  const tabList = e.target.parentNode;

  // get all of the sibling tabs
  const buttons = Array.apply(null, tabList.querySelectorAll('button'));

  // loop over the siblings to discover which index thje clicked one was
  const { index } = buttons.reduce(({ found, index }, button) => {
    if (!found && buttons[index] === e.target) {
      return { found: true, index };
    } else if (!found) {
      return { found, index: index + 1 };
    } else {
      return { found, index };
    }
  }, { found: false, index: 0 });

  // get the tab container
  const container = tabList.parentNode;
  // read the data-tab-group value from the container, e.g. "os"
  const { tabGroup } = container.dataset;
  // get a list of all the tab groups that match this value on the page
  const groups = document.querySelectorAll('[data-tab-group=' + tabGroup + ']');

  // for each of the found tab groups, find the tab button at the previously discovered index and select it for each group
  groups.forEach((group) => {
    const target = group.querySelectorAll('button')[index];
    setActiveTab(target);
  });
}
</script>
<h3><a id="setup-step-1"></a>Step 1: Configure application logging<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ecs-logging-java/edit/1.x/docs/setup.asciidoc">edit</a></h3>
<p>If you are using the Elastic APM Java agent, the easiest way to transform your logs into ECS-compatible JSON format is through the
<a href="/guide/en/apm/agent/java/current/config-logging.html#config-log-ecs-reformatting" class="ulink" target="_top"><code class="literal">log_ecs_reformatting</code></a> configuration option.
By only setting this option, the Java agent will automatically import the correct ECS-logging library and configure your logging
framework to use it instead (<code class="literal">OVERRIDE</code>/<code class="literal">REPLACE</code>) or in addition to (<code class="literal">SHADE</code>) your current configuration. No other changes required!
Make sure to check out other <a href="/guide/en/apm/agent/java/current/config-logging.html" class="ulink" target="_top">Logging configuration options</a> to unlock the full potential of this option.</p>
<p>Otherwise, follow the steps below to manually apply ECS-formatting through your logging framework configuration.
The following logging frameworks are supported:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Logback (default for Spring Boot)
</li>
<li class="listitem">
Log4j2
</li>
<li class="listitem">
Log4j
</li>
<li class="listitem">
<code class="literal">java.util.logging</code> (JUL)
</li>
<li class="listitem">
JBoss Log Manager
</li>
</ul>
</div>
<h4><a id="_add_the_dependency"></a>Add the dependency<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ecs-logging-java/edit/1.x/docs/setup.asciidoc">edit</a></h4>
<div class="tabs" data-tab-group="os">
  <div role="tablist" aria-label="dependency">
    <button role="tab"
            aria-selected="true"
            aria-controls="logback-tab-install"
            id="logback-install">
      Logback
    </button>
    <button role="tab"
            aria-selected="false"
            aria-controls="log4j2-tab-install"
            id="log4j2-install"
            tabindex="-1">
      Log4j2
    </button>
    <button role="tab"
            aria-selected="false"
            aria-controls="log4j-tab-install"
            id="log4j-install"
            tabindex="-1">
      Log4j
    </button>
    <button role="tab"
            aria-selected="false"
            aria-controls="jul-tab-install"
            id="jul-install"
            tabindex="-1">
      JUL
    </button>
    <button role="tab"
            aria-selected="false"
            aria-controls="jboss-tab-install"
            id="jboss-install"
            tabindex="-1">
      JBoss
    </button>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="logback-tab-install"
       aria-labelledby="logback-install">
<p>The minimum required logback version is 1.1.</p>
<p>Download the latest version of Elastic logging: <a href="https://search.maven.org/search?q=g:co.elastic.logging%20AND%20a:logback-ecs-encoder" class="ulink" target="_top"><span class="image"><img src="https://img.shields.io/maven-central/v/co.elastic.logging/logback-ecs-encoder.svg" alt="Maven Central"></span></a></p>
<p>Add a dependency to your application:</p>
<div class="pre_wrapper lang-xml">
<pre class="programlisting prettyprint lang-xml">&lt;dependency&gt;
    &lt;groupId&gt;co.elastic.logging&lt;/groupId&gt;
    &lt;artifactId&gt;logback-ecs-encoder&lt;/artifactId&gt;
    &lt;version&gt;${ecs-logging-java.version}&lt;/version&gt;
&lt;/dependency&gt;</pre>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>If you are not using a dependency management tool, like maven, you have to manually add both
<code class="literal">logback-ecs-encoder</code> and <code class="literal">ecs-logging-core</code> jars to the classpath.
For example to the <code class="literal">$CATALINA_HOME/lib</code> directory.
Other than that, there are no required dependencies.</p>
</div>
</div>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="log4j2-tab-install"
       aria-labelledby="log4j2-install"
       hidden="">
<p>The minimum required log4j2 version is 2.6.</p>
<p>Download the latest version of Elastic logging: <a href="https://search.maven.org/search?q=g:co.elastic.logging%20AND%20a:log4j2-ecs-layout:" class="ulink" target="_top"><span class="image"><img src="https://img.shields.io/maven-central/v/co.elastic.logging/log4j2-ecs-layout.svg" alt="Maven Central"></span></a></p>
<p>Add a dependency to your application:</p>
<div class="pre_wrapper lang-xml">
<pre class="programlisting prettyprint lang-xml">&lt;dependency&gt;
    &lt;groupId&gt;co.elastic.logging&lt;/groupId&gt;
    &lt;artifactId&gt;log4j2-ecs-layout&lt;/artifactId&gt;
    &lt;version&gt;${ecs-logging-java.version}&lt;/version&gt;
&lt;/dependency&gt;</pre>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>If you are not using a dependency management tool, like maven, you have to manually add both
<code class="literal">log4j2-ecs-layout</code> and <code class="literal">ecs-logging-core</code> jars to the classpath.
For example, to the <code class="literal">$CATALINA_HOME/lib</code> directory.
Other than that, there are no required dependencies.</p>
</div>
</div>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="log4j-tab-install"
       aria-labelledby="log4j-install"
       hidden="">
<p>The minimum required log4j version is 1.2.4.</p>
<p>Download the latest version of Elastic logging: <a href="https://search.maven.org/search?q=g:co.elastic.logging%20AND%20a:log4j-ecs-layout" class="ulink" target="_top"><span class="image"><img src="https://img.shields.io/maven-central/v/co.elastic.logging/log4j-ecs-layout.svg" alt="Maven Central"></span></a></p>
<p>Add a dependency to your application:</p>
<div class="pre_wrapper lang-xml">
<pre class="programlisting prettyprint lang-xml">&lt;dependency&gt;
    &lt;groupId&gt;co.elastic.logging&lt;/groupId&gt;
    &lt;artifactId&gt;log4j-ecs-layout&lt;/artifactId&gt;
    &lt;version&gt;${ecs-logging-java.version}&lt;/version&gt;
&lt;/dependency&gt;</pre>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>If you are not using a dependency management tool, like maven, you have to manually add both
<code class="literal">log4j-ecs-layout</code> and <code class="literal">ecs-logging-core</code> jars to the classpath.
For example, to the <code class="literal">$CATALINA_HOME/lib</code> directory.
Other than that, there are no required dependencies.</p>
</div>
</div>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="jul-tab-install"
       aria-labelledby="jul-install"
       hidden="">
<p>A formatter for JUL (<code class="literal">java.util.logging</code>) which produces ECS-compatible records.
Useful for applications that use JUL as primary logging framework, like Apache Tomcat.</p>
<p>Download the latest version of Elastic logging: <a href="https://search.maven.org/search?q=g:co.elastic.logging%20AND%20a:jul-ecs-formatter" class="ulink" target="_top"><span class="image"><img src="https://img.shields.io/maven-central/v/co.elastic.logging/jul-ecs-formatter.svg" alt="Maven Central"></span></a></p>
<p>Add a dependency to your application:</p>
<div class="pre_wrapper lang-xml">
<pre class="programlisting prettyprint lang-xml">&lt;dependency&gt;
    &lt;groupId&gt;co.elastic.logging&lt;/groupId&gt;
    &lt;artifactId&gt;jul-ecs-formatter&lt;/artifactId&gt;
    &lt;version&gt;${ecs-logging-java.version}&lt;/version&gt;
&lt;/dependency&gt;</pre>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>If you are not using a dependency management tool, like maven, you have to manually add both
<code class="literal">jul-ecs-formatter</code> and <code class="literal">ecs-logging-core</code> jars to the classpath.
For example, to the <code class="literal">$CATALINA_HOME/lib</code> directory.
Other than that, there are no required dependencies.</p>
</div>
</div>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="jboss-tab-install"
       aria-labelledby="jboss-install"
       hidden="">
<p>A formatter for JBoss Log Manager which produces ECS-compatible records.
Useful for applications that use JBoss Log Manager as their primary logging framework, like WildFly.</p>
<p>Download the latest version of Elastic logging: <a href="https://search.maven.org/search?q=g:co.elastic.logging%20AND%20a:jboss-logmanager-ecs-formatter" class="ulink" target="_top"><span class="image"><img src="https://img.shields.io/maven-central/v/co.elastic.logging/jboss-logmanager-ecs-formatter.svg" alt="Maven Central"></span></a></p>
<p>Add a dependency to your application:</p>
<div class="pre_wrapper lang-xml">
<pre class="programlisting prettyprint lang-xml">&lt;dependency&gt;
    &lt;groupId&gt;co.elastic.logging&lt;/groupId&gt;
    &lt;artifactId&gt;jboss-logmanager-ecs-formatter&lt;/artifactId&gt;
    &lt;version&gt;${ecs-logging-java.version}&lt;/version&gt;
&lt;/dependency&gt;</pre>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>If you are not using a dependency management tool, like maven, you have to manually add both
<code class="literal">jboss-logmanager-ecs-formatter</code> and <code class="literal">ecs-logging-core</code> jars to the classpath.
Other than that, there are no required dependencies.</p>
</div>
</div>
  </div>
</div>
<h4><a id="_use_the_ecs_encoderformatterlayout"></a>Use the ECS encoder/formatter/layout<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ecs-logging-java/edit/1.x/docs/setup.asciidoc">edit</a></h4>
<div class="tabs" data-tab-group="os">
  <div role="tablist" aria-label="ecs-encoder">
    <button role="tab"
            aria-selected="true"
            aria-controls="logback-tab-ecs-encoder"
            id="logback-ecs-encoder">
      Logback
    </button>
    <button role="tab"
            aria-selected="false"
            aria-controls="log4j2-tab-ecs-encoder"
            id="log4j2-ecs-encoder"
            tabindex="-1">
      Log4j2
    </button>
    <button role="tab"
            aria-selected="false"
            aria-controls="log4j-tab-ecs-encoder"
            id="log4j-ecs-encoder"
            tabindex="-1">
      Log4j
    </button>
    <button role="tab"
            aria-selected="false"
            aria-controls="jul-tab-ecs-encoder"
            id="jul-ecs-encoder"
            tabindex="-1">
      JUL
    </button>
    <button role="tab"
            aria-selected="false"
            aria-controls="jboss-tab-ecs-encoder"
            id="jboss-ecs-encoder"
            tabindex="-1">
      JBoss
    </button>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="logback-tab-ecs-encoder"
       aria-labelledby="logback-ecs-encoder">
<p><span class="strong strong"><strong>Spring Boot applications</strong></span></p>
<p>In <code class="literal">src/main/resources/logback-spring.xml</code>:</p>
<div class="pre_wrapper lang-xml">
<pre class="programlisting prettyprint lang-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;configuration&gt;
    &lt;property name="LOG_FILE" value="${LOG_FILE:-${LOG_PATH:-${LOG_TEMP:-${java.io.tmpdir:-/tmp}}}/spring.log}"/&gt;
    &lt;include resource="org/springframework/boot/logging/logback/defaults.xml"/&gt;
    &lt;include resource="org/springframework/boot/logging/logback/console-appender.xml" /&gt;
    &lt;include resource="org/springframework/boot/logging/logback/file-appender.xml" /&gt;
    &lt;include resource="co/elastic/logging/logback/boot/ecs-console-appender.xml" /&gt;
    &lt;include resource="co/elastic/logging/logback/boot/ecs-file-appender.xml" /&gt;
    &lt;root level="INFO"&gt;
        &lt;appender-ref ref="ECS_JSON_CONSOLE"/&gt;
        &lt;appender-ref ref="CONSOLE"/&gt;
        &lt;appender-ref ref="ECS_JSON_FILE"/&gt;
        &lt;appender-ref ref="FILE"/&gt;
    &lt;/root&gt;
&lt;/configuration&gt;</pre>
</div>
<p>You also need to configure the following properties to your <code class="literal">application.properties</code>:</p>
<div class="pre_wrapper lang-properties">
<pre class="programlisting prettyprint lang-properties">spring.application.name=my-application
# for Spring Boot 2.2.x+
logging.file.name=/path/to/my-application.log
# for older Spring Boot versions
logging.file=/path/to/my-application.log</pre>
</div>
<p><span class="strong strong"><strong>Other applications</strong></span></p>
<p>All you have to do is to use the <code class="literal">co.elastic.logging.logback.EcsEncoder</code> instead of the default pattern encoder in <code class="literal">logback.xml</code></p>
<div class="pre_wrapper lang-xml">
<pre class="programlisting prettyprint lang-xml">&lt;encoder class="co.elastic.logging.logback.EcsEncoder"&gt;
    &lt;serviceName&gt;my-application&lt;/serviceName&gt;
    &lt;serviceVersion&gt;my-application-version&lt;/serviceVersion&gt;
    &lt;serviceEnvironment&gt;my-application-environment&lt;/serviceEnvironment&gt;
    &lt;serviceNodeName&gt;my-application-cluster-node&lt;/serviceNodeName&gt;
&lt;/encoder&gt;</pre>
</div>
<p><span class="strong strong"><strong>Encoder Parameters</strong></span></p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Parameter name</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">serviceName</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>Sets the <code class="literal">service.name</code> field so you can filter your logs by a particular service name</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">serviceVersion</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>Sets the <code class="literal">service.version</code> field so you can filter your logs by a particular service version</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">serviceEnvironment</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>Sets the <code class="literal">service.environment</code> field so you can filter your logs by a particular service environment</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">serviceNodeName</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>Sets the <code class="literal">service.node.name</code> field so you can filter your logs by a particular node of your clustered service</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">eventDataset</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p><code class="literal">${serviceName}</code></p></td>
<td align="left" valign="top"><p>Sets the <code class="literal">event.dataset</code> field used by the machine learning job of the Logs app to look for anomalies in the log rate.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">includeMarkers</code></p></td>
<td align="left" valign="top"><p>boolean</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Log <a href="https://logging.apache.org/log4j/2.0/manual/markers.html" class="ulink" target="_top">Markers</a> as <a href="/guide/en/ecs/8.8/ecs-base.html" class="ulink" target="_top"><code class="literal">tags</code></a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">stackTraceAsArray</code></p></td>
<td align="left" valign="top"><p>boolean</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Serializes the <a href="/guide/en/ecs/8.8/ecs-error.html" class="ulink" target="_top"><code class="literal">error.stack_trace</code></a> as a JSON array where each element is in a new line to improve readability.
Note that this requires a slightly more complex <a class="xref" href="setup.html#setup-stack-trace-as-array" title="When stackTraceAsArray is enabled">Filebeat configuration</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">includeOrigin</code></p></td>
<td align="left" valign="top"><p>boolean</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code>, adds the <a href="/guide/en/ecs/8.8/ecs-log.html" class="ulink" target="_top"><code class="literal">log.origin.file.name</code></a>,
 <a href="/guide/en/ecs/8.8/ecs-log.html" class="ulink" target="_top"><code class="literal">log.origin.file.line</code></a> and <a href="/guide/en/ecs/8.8/ecs-log.html" class="ulink" target="_top"><code class="literal">log.origin.function</code></a> fields.
 Note that you also have to set <code class="literal">&lt;includeCallerData&gt;true&lt;/includeCallerData&gt;</code> on your appenders if you are using the async ones.</p></td>
</tr>
</tbody>
</table>
</div>
<p>To include any custom field in the output, use following syntax:</p>
<div class="pre_wrapper lang-xml">
<pre class="programlisting prettyprint lang-xml">&lt;additionalField&gt;
    &lt;key&gt;key1&lt;/key&gt;
    &lt;value&gt;value1&lt;/value&gt;
&lt;/additionalField&gt;
&lt;additionalField&gt;
    &lt;key&gt;key2&lt;/key&gt;
    &lt;value&gt;value2&lt;/value&gt;
&lt;/additionalField&gt;</pre>
</div>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="log4j2-tab-ecs-encoder"
       aria-labelledby="log4j2-ecs-encoder"
       hidden="">
<p>Instead of the usual <code class="literal">&lt;PatternLayout/&gt;</code>, use <code class="literal">&lt;EcsLayout serviceName="my-app"/&gt;</code>.
For example:</p>
<div class="pre_wrapper lang-xml">
<pre class="programlisting prettyprint lang-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;Configuration status="DEBUG"&gt;
    &lt;Appenders&gt;
        &lt;Console name="LogToConsole" target="SYSTEM_OUT"&gt;
            &lt;EcsLayout serviceName="my-app" serviceVersion="my-app-version" serviceEnvironment="my-app-environment" serviceNodeName="my-app-cluster-node"/&gt;
        &lt;/Console&gt;
        &lt;File name="LogToFile" fileName="logs/app.log"&gt;
            &lt;EcsLayout serviceName="my-app" serviceVersion="my-app-version" serviceEnvironment="my-app-environment" serviceNodeName="my-app-cluster-node"/&gt;
        &lt;/File&gt;
    &lt;/Appenders&gt;
    &lt;Loggers&gt;
        &lt;Root level="info"&gt;
            &lt;AppenderRef ref="LogToFile"/&gt;
            &lt;AppenderRef ref="LogToConsole"/&gt;
        &lt;/Root&gt;
    &lt;/Loggers&gt;
&lt;/Configuration&gt;</pre>
</div>
<p><span class="strong strong"><strong>Layout Parameters</strong></span></p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Parameter name</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">serviceName</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>Sets the <code class="literal">service.name</code> field so you can filter your logs by a particular service name</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">serviceVersion</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>Sets the <code class="literal">service.version</code> field so you can filter your logs by a particular service version</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">serviceEnvironment</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>Sets the <code class="literal">service.environment</code> field so you can filter your logs by a particular service environment</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">serviceNodeName</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>Sets the <code class="literal">service.node.name</code> field so you can filter your logs by a particular node of your clustered service</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">eventDataset</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p><code class="literal">${serviceName}</code></p></td>
<td align="left" valign="top"><p>Sets the <code class="literal">event.dataset</code> field used by the machine learning job of the Logs app to look for anomalies in the log rate.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">includeMarkers</code></p></td>
<td align="left" valign="top"><p>boolean</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Log <a href="https://logging.apache.org/log4j/2.0/manual/markers.html" class="ulink" target="_top">Markers</a> as <a href="/guide/en/ecs/8.8/ecs-base.html" class="ulink" target="_top"><code class="literal">tags</code></a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">stackTraceAsArray</code></p></td>
<td align="left" valign="top"><p>boolean</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Serializes the <a href="/guide/en/ecs/8.8/ecs-error.html" class="ulink" target="_top"><code class="literal">error.stack_trace</code></a> as a JSON array where each element is in a new line to improve readability.
 Note that this requires a slightly more complex <a class="xref" href="setup.html#setup-stack-trace-as-array" title="When stackTraceAsArray is enabled">Filebeat configuration</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">includeOrigin</code></p></td>
<td align="left" valign="top"><p>boolean</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code>, adds the <a href="/guide/en/ecs/8.8/ecs-log.html" class="ulink" target="_top"><code class="literal">log.origin.file.name</code></a>,
 <a href="/guide/en/ecs/8.8/ecs-log.html" class="ulink" target="_top"><code class="literal">log.origin.file.line</code></a> and <a href="/guide/en/ecs/8.8/ecs-log.html" class="ulink" target="_top"><code class="literal">log.origin.function</code></a> fields.
 Note that you also have to set <code class="literal">includeLocation="true"</code> on your loggers and appenders if you are using the async ones.</p></td>
</tr>
</tbody>
</table>
</div>
<p>To include any custom field in the output, use following syntax:</p>
<div class="pre_wrapper lang-xml">
<pre class="programlisting prettyprint lang-xml">  &lt;EcsLayout&gt;
    &lt;KeyValuePair key="key1" value="constant value"/&gt;
    &lt;KeyValuePair key="key2" value="$${ctx:key}"/&gt;
  &lt;/EcsLayout&gt;</pre>
</div>
<p>Custom fields are included in the order they are declared. The values support <a href="https://logging.apache.org/log4j/2.x/manual/lookups.html" class="ulink" target="_top">lookups</a>.
This means that the <code class="literal">KeyValuePair</code> setting can be utilized to dynamically set predefined fields as well:</p>
<div class="pre_wrapper lang-xml">
<pre class="programlisting prettyprint lang-xml">&lt;EcsLayout serviceName="myService"&gt;
  &lt;KeyValuePair key="service.version" value="$${spring:project.version}"/&gt;
  &lt;KeyValuePair key="service.node.name" value="${env:HOSTNAME}"/&gt;
&lt;/EcsLayout&gt;</pre>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The log4j2 <code class="literal">EcsLayout</code> does not allocate any memory (unless the log event contains an <code class="literal">Exception</code>) to reduce GC pressure.
This is achieved by manually serializing JSON so that no intermediate JSON or map representation of a log event is needed.</p>
</div>
</div>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="log4j-tab-ecs-encoder"
       aria-labelledby="log4j-ecs-encoder"
       hidden="">
<p>Instead of the usual layout class <code class="literal">"org.apache.log4j.PatternLayout"</code>, use <code class="literal">"co.elastic.logging.log4j.EcsLayout"</code>.
For example:</p>
<div class="pre_wrapper lang-xml">
<pre class="programlisting prettyprint lang-xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;!DOCTYPE log4j:configuration SYSTEM "log4j.dtd"&gt;
&lt;log4j:configuration xmlns:log4j="http://jakarta.apache.org/log4j/"&gt;
    &lt;appender name="LogToConsole" class="org.apache.log4j.ConsoleAppender"&gt;
        &lt;param name="Target" value="System.out"/&gt;
        &lt;layout class="co.elastic.logging.log4j.EcsLayout"&gt;
            &lt;param name="serviceName" value="my-app"/&gt;
            &lt;param name="serviceNodeName" value="my-app-cluster-node"/&gt;
        &lt;/layout&gt;
    &lt;/appender&gt;
    &lt;appender name="LogToFile" class="org.apache.log4j.RollingFileAppender"&gt;
        &lt;param name="File" value="logs/app.log"/&gt;
        &lt;layout class="co.elastic.logging.log4j.EcsLayout"&gt;
            &lt;param name="serviceName" value="my-app"/&gt;
            &lt;param name="serviceNodeName" value="my-app-cluster-node"/&gt;
        &lt;/layout&gt;
    &lt;/appender&gt;
    &lt;root&gt;
        &lt;priority value="INFO"/&gt;
        &lt;appender-ref ref="LogToFile"/&gt;
        &lt;appender-ref ref="LogToConsole"/&gt;
    &lt;/root&gt;
&lt;/log4j:configuration&gt;</pre>
</div>
<p><span class="strong strong"><strong>Layout Parameters</strong></span></p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Parameter name</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">serviceName</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>Sets the <code class="literal">service.name</code> field so you can filter your logs by a particular service name</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">serviceVersion</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>Sets the <code class="literal">service.version</code> field so you can filter your logs by a particular service version</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">serviceEnvironment</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>Sets the <code class="literal">service.environment</code> field so you can filter your logs by a particular service environment</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">serviceNodeName</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>Sets the <code class="literal">service.node.name</code> field so you can filter your logs by a particular node of your clustered service</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">eventDataset</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p><code class="literal">${serviceName}</code></p></td>
<td align="left" valign="top"><p>Sets the <code class="literal">event.dataset</code> field used by the machine learning job of the Logs app to look for anomalies in the log rate.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">stackTraceAsArray</code></p></td>
<td align="left" valign="top"><p>boolean</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Serializes the <a href="/guide/en/ecs/8.8/ecs-error.html" class="ulink" target="_top"><code class="literal">error.stack_trace</code></a> as a JSON array where each element is in a new line to improve readability.
Note that this requires a slightly more complex <a class="xref" href="setup.html#setup-stack-trace-as-array" title="When stackTraceAsArray is enabled">Filebeat configuration</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">includeOrigin</code></p></td>
<td align="left" valign="top"><p>boolean</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code>, adds the <a href="/guide/en/ecs/8.8/ecs-log.html" class="ulink" target="_top"><code class="literal">log.origin.file.name</code></a>,
<a href="/guide/en/ecs/8.8/ecs-log.html" class="ulink" target="_top"><code class="literal">log.origin.file.line</code></a> and <a href="/guide/en/ecs/8.8/ecs-log.html" class="ulink" target="_top"><code class="literal">log.origin.function</code></a> fields.
Note that you also have to set <code class="literal">&lt;param name="LocationInfo" value="true"/&gt;</code> if you are using <code class="literal">AsyncAppender</code>.</p></td>
</tr>
</tbody>
</table>
</div>
<p>To include any custom field in the output, use following syntax:</p>
<div class="pre_wrapper lang-xml">
<pre class="programlisting prettyprint lang-xml">&lt;layout class="co.elastic.logging.log4j.EcsLayout"&gt;
   &lt;param name="additionalField" value="key1=value1"/&gt;
   &lt;param name="additionalField" value="key2=value2"/&gt;
&lt;/layout&gt;</pre>
</div>
<p>Custom fields are included in the order they are declared.</p>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="jul-tab-ecs-encoder"
       aria-labelledby="jul-ecs-encoder"
       hidden="">
<p>Specify <code class="literal">co.elastic.logging.jul.EcsFormatter</code> as <code class="literal">formatter</code> for the required log handler.</p>
<p>For example, in <code class="literal">$CATALINA_HOME/conf/logging.properties</code>:</p>
<div class="pre_wrapper lang-properties">
<pre class="programlisting prettyprint lang-properties">java.util.logging.ConsoleHandler.level = FINE
java.util.logging.ConsoleHandler.formatter = co.elastic.logging.jul.EcsFormatter
co.elastic.logging.jul.EcsFormatter.serviceName=my-app
co.elastic.logging.jul.EcsFormatter.serviceVersion=my-app-version
co.elastic.logging.jul.EcsFormatter.serviceEnvironment=my-app-environment
co.elastic.logging.jul.EcsFormatter.serviceNodeName=my-app-cluster-node</pre>
</div>
<p><span class="strong strong"><strong>Layout Parameters</strong></span></p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Parameter name</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">serviceName</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>Sets the <code class="literal">service.name</code> field so you can filter your logs by a particular service name</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">serviceVersion</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>Sets the <code class="literal">service.version</code> field so you can filter your logs by a particular service version</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">serviceEnvironment</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>Sets the <code class="literal">service.environment</code> field so you can filter your logs by a particular service environment</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">serviceNodeName</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>Sets the <code class="literal">service.node.name</code> field so you can filter your logs by a particular node of your clustered service</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">eventDataset</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p><code class="literal">${serviceName}</code></p></td>
<td align="left" valign="top"><p>Sets the <code class="literal">event.dataset</code> field used by the machine learning job of the Logs app to look for anomalies in the log rate.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">stackTraceAsArray</code></p></td>
<td align="left" valign="top"><p>boolean</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Serializes the <a href="/guide/en/ecs/8.8/ecs-error.html" class="ulink" target="_top"><code class="literal">error.stack_trace</code></a> as a JSON array where each element is in a new line to improve readability. Note that this requires a slightly more complex [Filebeat configuration](../README.md#when-stacktraceasarray-is-enabled).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">includeOrigin</code></p></td>
<td align="left" valign="top"><p>boolean</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code>, adds the <a href="/guide/en/ecs/8.8/ecs-log.html" class="ulink" target="_top"><code class="literal">log.origin.file.name</code></a>,
 <a href="/guide/en/ecs/8.8/ecs-log.html" class="ulink" target="_top"><code class="literal">log.origin.file.line</code></a> and <a href="/guide/en/ecs/8.8/ecs-log.html" class="ulink" target="_top"><code class="literal">log.origin.function</code></a> fields.
 Note that JUL does not stores line number and <code class="literal">log.origin.file.line</code> will have <em>1</em> value.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">additionalFields</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>Adds additional static fields to all log events.
 The fields are specified as comma-separated key-value pairs.
 Example: <code class="literal">co.elastic.logging.jul.EcsFormatter.additionalFields=key1=value1,key2=value2</code>.</p></td>
</tr>
</tbody>
</table>
</div>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="jboss-tab-ecs-encoder"
       aria-labelledby="jboss-ecs-encoder"
       hidden="">
<p>Specify <code class="literal">co.elastic.logging.jboss.logmanager.EcsFormatter</code> as <code class="literal">formatter</code> for the required log handler.</p>
<p>For example, with Wildfly, create a <code class="literal">jboss-logmanager-ecs-formatter</code> module:</p>
<div class="pre_wrapper lang-bash">
<pre class="programlisting prettyprint lang-bash">$WILDFLY_HOME/bin/jboss-cli.sh -c 'module add --name=co.elastic.logging.jboss-logmanager-ecs-formatter --resources=jboss-logmanager-ecs-formatter-${ecs-logging-java.version}.jar:/tmp/ecs-logging-core-${ecs-logging-java.version}.jar --dependencies=org.jboss.logmanager'</pre>
</div>
<p>Add the formatter to a handler in the logging subsystem:</p>
<div class="pre_wrapper lang-bash">
<pre class="programlisting prettyprint lang-bash">$WILDFLY_HOME/bin/jboss-cli.sh -c '/subsystem=logging/custom-formatter=ECS:add(module=co.elastic.logging.jboss-logmanager-ecs-formatter,
class=co.elastic.logging.jboss.logmanager.EcsFormatter, properties={serviceName=my-app,serviceVersion=my-app-version,serviceEnvironment=my-app-environment,serviceNodeName=my-app-cluster-node}),\
                                   /subsystem=logging/console-handler=CONSOLE:write-attribute(name=named-formatter,value=ECS)'</pre>
</div>
<p><span class="strong strong"><strong>Layout Parameters</strong></span></p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Parameter name</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">serviceName</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>Sets the <code class="literal">service.name</code> field so you can filter your logs by a particular service name</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">serviceVersion</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>Sets the <code class="literal">service.version</code> field so you can filter your logs by a particular service version</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">serviceEnvironment</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>Sets the <code class="literal">service.environment</code> field so you can filter your logs by a particular service environment</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">serviceNodeName</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>Sets the <code class="literal">service.node.name</code> field so you can filter your logs by a particular node of your clustered service</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">eventDataset</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p><code class="literal">${serviceName}</code></p></td>
<td align="left" valign="top"><p>Sets the <code class="literal">event.dataset</code> field used by the machine learning job of the Logs app to look for anomalies in the log rate.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">stackTraceAsArray</code></p></td>
<td align="left" valign="top"><p>boolean</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Serializes the <a href="/guide/en/ecs/8.8/ecs-error.html" class="ulink" target="_top"><code class="literal">error.stack_trace</code></a> as a JSON array where each element is in a new line to improve readability. Note that this requires a slightly more complex <a class="xref" href="setup.html#setup-stack-trace-as-array" title="When stackTraceAsArray is enabled">Filebeat configuration</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">includeOrigin</code></p></td>
<td align="left" valign="top"><p>boolean</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>If <code class="literal">true</code>, adds the <a href="/guide/en/ecs/8.8/ecs-log.html" class="ulink" target="_top"><code class="literal">log.origin.file.name</code></a>,
 <a href="/guide/en/ecs/8.8/ecs-log.html" class="ulink" target="_top"><code class="literal">log.origin.file.line</code></a> and <a href="/guide/en/ecs/8.8/ecs-log.html" class="ulink" target="_top"><code class="literal">log.origin.function</code></a> fields.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">additionalFields</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>Adds additional static fields to all log events.
 The fields are specified as comma-separated key-value pairs.
 Example: <code class="literal">additionalFields=key1=value1,key2=value2</code>.</p></td>
</tr>
</tbody>
</table>
</div>
  </div>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>If you&#8217;re using the Elastic APM Java agent,
log correlation is enabled by default starting in version 1.30.0.
In previous versions, log correlation is off by default, but can be enabled by setting
the <code class="literal">enable_log_correlation</code> config to <code class="literal">true</code>.</p>
</div>
</div>
<h3><a id="setup-step-2"></a>Step 2: Configure Filebeat<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ecs-logging-java/edit/1.x/docs/setup.asciidoc">edit</a></h3>
<div class="tabs" data-tab-group="fb">
  <div role="tablist" aria-label="filebeat">
    <button role="tab"
            aria-selected="true"
            aria-controls="logs-tab-install"
            id="logs-install">
      Log file
    </button>
    <button role="tab"
            aria-selected="false"
            aria-controls="kubernetes-tab-install"
            id="kubernetes-install">
      Kubernetes
    </button>
    <button role="tab"
            aria-selected="false"
            aria-controls="docker-tab-install"
            id="docker-install">
      Docker
    </button>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="logs-tab-install"
       aria-labelledby="logs-install">
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Follow the <a href="/guide/en/beats/filebeat/8.8/filebeat-installation-configuration.html" class="ulink" target="_top">Filebeat quick start</a>
</li>
<li class="listitem">
Add the following configuration to your <code class="literal">filebeat.yaml</code> file.
</li>
</ol>
</div>
<p>For Filebeat 7.16+</p>
<p><strong>filebeat.yaml.</strong></p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: filestream <a id="CO1-1"></a><i class="conum" data-value="1"></i>
  paths: /path/to/logs.json
  parsers:
    - ndjson:
      overwrite_keys: true <a id="CO1-2"></a><i class="conum" data-value="2"></i>
      add_error_key: true <a id="CO1-3"></a><i class="conum" data-value="3"></i>
      expand_keys: true <a id="CO1-4"></a><i class="conum" data-value="4"></i>

processors: <a id="CO1-5"></a><i class="conum" data-value="5"></i>
  - add_host_metadata: ~
  - add_cloud_metadata: ~
  - add_docker_metadata: ~
  - add_kubernetes_metadata: ~</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO1-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Use the filestream input to read lines from active log files.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO1-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>Values from the decoded JSON object overwrite the fields that Filebeat normally adds (type, source, offset, etc.) in case of conflicts.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO1-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>Filebeat adds an "error.message" and "error.type: json" key in case of JSON unmarshalling errors.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO1-4"><i class="conum" data-value="4"></i></a></p>
</td>
<td align="left" valign="top">
<p>Filebeat will recursively de-dot keys in the decoded JSON, and expand them into a hierarchical object structure.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO1-5"><i class="conum" data-value="5"></i></a></p>
</td>
<td align="left" valign="top">
<p>Processors enhance your data. See <a href="/guide/en/beats/filebeat/8.8/filtering-and-enhancing-data.html" class="ulink" target="_top">processors</a> to learn more.</p>
</td>
</tr>
</table>
</div>
<p>For Filebeat &lt; 7.16</p>
<p><strong>filebeat.yaml.</strong></p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: log
  paths: /path/to/logs.json
  json.keys_under_root: true
  json.overwrite_keys: true
  json.add_error_key: true
  json.expand_keys: true

processors:
- add_host_metadata: ~
- add_cloud_metadata: ~
- add_docker_metadata: ~
- add_kubernetes_metadata: ~</pre>
</div>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="kubernetes-tab-install"
       aria-labelledby="kubernetes-install"
       hidden="">
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Make sure your application logs to stdout/stderr.
</li>
<li class="listitem">
Follow the <a href="/guide/en/beats/filebeat/8.8/running-on-kubernetes.html" class="ulink" target="_top">Run Filebeat on Kubernetes</a> guide.
</li>
<li class="listitem">
Enable <a href="/guide/en/beats/filebeat/current/configuration-autodiscover-hints.html" class="ulink" target="_top">hints-based autodiscover</a> (uncomment the corresponding section in <code class="literal">filebeat-kubernetes.yaml</code>).
</li>
<li class="listitem">
Add these annotations to your pods that log using ECS loggers.
This will make sure the logs are parsed appropriately.
</li>
</ol>
</div>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">annotations:
  co.elastic.logs/json.overwrite_keys: true <a id="CO2-1"></a><i class="conum" data-value="1"></i>
  co.elastic.logs/json.add_error_key: true <a id="CO2-2"></a><i class="conum" data-value="2"></i>
  co.elastic.logs/json.expand_keys: true <a id="CO2-3"></a><i class="conum" data-value="3"></i></pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO2-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Values from the decoded JSON object overwrite the fields that Filebeat normally adds (type, source, offset, etc.) in case of conflicts.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO2-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>Filebeat adds an "error.message" and "error.type: json" key in case of JSON unmarshalling errors.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO2-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>Filebeat will recursively de-dot keys in the decoded JSON, and expand them into a hierarchical object structure.</p>
</td>
</tr>
</table>
</div>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="docker-tab-install"
       aria-labelledby="docker-install"
       hidden="">
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Make sure your application logs to stdout/stderr.
</li>
<li class="listitem">
Follow the <a href="/guide/en/beats/filebeat/8.8/running-on-docker.html" class="ulink" target="_top">Run Filebeat on Docker</a> guide.
</li>
<li class="listitem">
Enable <a href="/guide/en/beats/filebeat/current/configuration-autodiscover-hints.html" class="ulink" target="_top">hints-based autodiscover</a>.
</li>
<li class="listitem">
Add these labels to your containers that log using ECS loggers.
This will make sure the logs are parsed appropriately.
</li>
</ol>
</div>
<p><strong>docker-compose.yml.</strong></p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">labels:
  co.elastic.logs/json.overwrite_keys: true <a id="CO3-1"></a><i class="conum" data-value="1"></i>
  co.elastic.logs/json.add_error_key: true <a id="CO3-2"></a><i class="conum" data-value="2"></i>
  co.elastic.logs/json.expand_keys: true <a id="CO3-3"></a><i class="conum" data-value="3"></i></pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO3-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Values from the decoded JSON object overwrite the fields that Filebeat normally adds (type, source, offset, etc.) in case of conflicts.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO3-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>Filebeat adds an "error.message" and "error.type: json" key in case of JSON unmarshalling errors.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO3-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>Filebeat will recursively de-dot keys in the decoded JSON, and expand them into a hierarchical object structure.</p>
</td>
</tr>
</table>
</div>
  </div>
</div>
<p>For more information, see the <a href="/guide/en/beats/filebeat/8.8/configuring-howto-filebeat.html" class="ulink" target="_top">Filebeat reference</a>.</p>
<h4><a id="setup-stack-trace-as-array"></a>When <code class="literal">stackTraceAsArray</code> is enabled<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ecs-logging-java/edit/1.x/docs/setup.asciidoc">edit</a></h4>
<p>Filebeat can normally only decode JSON if there is one JSON object per line.
When <code class="literal">stackTraceAsArray</code> is enabled, there will be a new line for each stack trace element which improves readability.
But when combining the multiline settings with a <code class="literal">decode_json_fields</code> we can also handle multi-line JSON:</p>
<div class="pre_wrapper lang-yml">
<pre class="programlisting prettyprint lang-yml">filebeat.inputs:
  - type: log
    paths: /path/to/logs.json
    multiline.pattern: '^{'
    multiline.negate: true
    multiline.match: after
processors:
  - decode_json_fields:
      fields: message
      target: ""
      overwrite_keys: true
  # flattens the array to a single string
  - script:
      when:
        has_fields: ['error.stack_trace']
      lang: javascript
      id: my_filter
      source: &gt;
        function process(event) {
            event.Put("error.stack_trace", event.Get("error.stack_trace").join("\n"));
        }</pre>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="intro.html">« Introduction</a>
</span>
<span class="next">
<a href="_structured_logging_with_log4j2.html">Structured logging with log4j2 »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
