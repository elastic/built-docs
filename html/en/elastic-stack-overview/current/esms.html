<!DOCTYPE html>
<html lang="en-us">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Elastic Stack Monitoring Service
        | Elastic Stack Overview [7.3]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Elastic Stack Overview [7.3]" /><link rel="up" href="xpack-monitoring.html" title="Monitoring the Elastic Stack" /><link rel="prev" href="monitoring-production.html" title="Monitoring in a production environment" /><link rel="next" href="monitoring-troubleshooting.html" title="Troubleshooting monitoring" /><meta name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta name="DC.type" content="Learn/Docs/Elastic Stack/Overview/7.3" /><meta name="DC.subject" content="Elastic Stack" /><meta name="DC.identifier" content="7.3" />
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#ffffff">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <!-- DC tags section -->
    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" >
    <link rel="schema.DCTERMS" href="http://purl.org/dc/terms/" >
    
    <!-- end DC tags -->
    <meta name="description" content="" />
    <meta name="localized" content="true" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <!-- For third-generation iPad with high-resolution Retina display: -->
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <!-- For iPhone with high-resolution Retina display: -->
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <!-- For first- and second-generation iPad: -->
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- css -->
    <link href="/static/css/main.css" rel="stylesheet">
    <script src="/static/js/jquery.min.js"></script>
    <script src="/static/js/bootstrap.min.js"></script>
    <script src="/static/js/jquery.cookie.js"></script>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <script type="text/javascript">
      // -------------------- set language based on browser language --------------------
      var lang = '/'+(navigator.language || navigator.userLanguage).slice(0,2)+'/',
      locales = {
        '/en':'/',
        '/de/': '/de/',
        '/fr/': '/fr/',
        '/ja/':'/jp/',
        '/ko/':'/kr/',
        '/zh/':'/cn/',
        '/es/': '/es/'
      },
      localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}',
      currentlocale = JSON.parse(localeUrl).relative_url_prefix;

      if($.cookie("is_lang_detected") == undefined){
        if(locales[lang] != undefined && locales[lang] != currentlocale){
          locale_lang_url = locales[lang] + window.location.pathname.slice(1,window.location.pathname.length);
          $.cookie("is_lang_detected",true ,{ path: '/'});
          window.location = locale_lang_url;
        }
      }
            
      // --------------------- end of set language based on browser language -----------------
    </script>
    <link type="text/css" rel="stylesheet" href="/static/css/guide.css" />
  
<link rel="stylesheet" type="text/css" href="styles.css" />

</head>

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->
    
    <!-- new ga for staging server -->
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>
    <!-- new ga for staging server -->

    <!-- Elastic APM -->
    <!--
    <script src="https://www.elastic.co/static/js/elastic-apm-js-base.umd.min.2.2.0.js"></script>
    <script type="text/javascript">
      var elasticApm = init({
        serviceName: 'elastic-co-frontend',
        serverUrl: 'https://3ddd1ee09cc242c4b169d36f5a2b8b77.apm.us-west1.gcp.cloud.es.io:443',
        stackTraceLimit: 5,
        serviceVersion: '1.0.0'
      })
    
      var pageLoadName
      var pathname = window.location.pathname.replace(/\/es|\/pt|\/jp|\/pt|\/fr|\/kr|\/cn|\/de/g, '')
      var parts = pathname.split('/');
    
      if (parts.length && parts[1] === 'blog') {
        if (parts.length === 2) {
          pageLoadName =  '/blog';
        }
        else if (parts[2] === 'category') {
          pageLoadName =  '/blog/category';
        }
        else if (parts[2] === 'archive') {
          pageLoadName =  '/blog/archive';
        }
        else {
          pageLoadName =  '/blog/detail';
        }
      }
      else if (parts.length && parts[1] === 'elasticon') {
        if (parts.length === 2) {
          pageLoadName =  '/elasticon';
        }
        else if (parts.length === 5 && (parts[2] === 'conf' || parts[2] === 'tour')) {
          pageLoadName =  '/elasticon/overview';
        }
        else if (parts.length > 5 && (parts[2] === 'conf' || parts[2] === 'tour')) {
          pageLoadName =  '/elasticon/video';
        }
      }
      else if (parts.length && parts[1] === 'guide') {
        pageLoadName =  '/guide';
      }
      else if (parts.length === 2 && parts[1] === 'videos') {
        pageLoadName =  '/videos';
      }
      else if (parts.length > 2 && parts[1] === 'videos') {
        pageLoadName =  '/videos/detail';
      }
      else if (parts.length > 2 && parts[1] === 'webinars') {
        pageLoadName =  '/webinars/detail';
      }
      else {
        pageLoadName =  window.location.pathname;
      }
    
      console.log('apm pageLoadName:', pageLoadName, parts)
      elasticApm.setTags({env:"production"});
      elasticApm.setInitialPageLoadName(pageLoadName);
    </script>
    -->

    <!-- Header Section -->
    
    <div id='elastic-nav'></div>

    <!-- Subnav -->
    <div>
      <div>
        <div class="tertiary-nav d-none d-md-block">
          <div class="container">
            <div class="p-t-b-15 d-flex justify-content-between nav-container">
              <div class="breadcrum-wrapper"><span><a href="/guide/" style="font-size: 14px; font-weight: 600; color: #000;">Docs</a></span></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <link rel="stylesheet" type="text/css" href="/static/css/horizon-swiper.min.css">

    <style> 
      .m-shortcuts li a.m-search {
        background: url("/assets/blt7b9c4fe6528dc4ef/m-search-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}

      .m-shortcuts li a.m-docs {
        background: url("/assets/blt44d8b7530a76d01c/m-guide-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}

      .m-shortcuts li a.m-contact {
        background: url("/assets/blt878040795c9d083b/m-contact-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
    </style>

    <script type="text/javascript" src="/static/js/horizon-swiper.min.js"></script>

    <script type="text/javascript">
      $(document).ready( function(){
        // if($('#scrollable-pane li').length > 3){
          $('.horizon-swiper').horizonSwiper({
            showItems: 3,
            arrows: true
          }); 
        // }
        
        $('.navbar-toggle').on('click', function(){
          $('.mobile-navigation, .menu-open').hide();
          $('.navigation-wrapper').addClass('mobile-navigation');
          $('.navbar').addClass('menu-open');
          $('.menu-close').show();
        });
        $('.menu-close').on('click', function(){
          $('.navigation-wrapper').removeClass('mobile-navigation');
          $('.navbar').removeClass('menu-open');
          $('.menu-close').hide();
        });
    
        var active_url = "";
    
        $(".navbar-mobile-header-icon").click(function(index){
          $('.navigation-wrapper').toggleClass('menu-overlay');
          $(this).toggleClass("navbar-mobile-header-icon-click navbar-mobile-header-icon-out");
          $(".mobile-inner-nav").slideToggle(500);
          $(".mobile-inner-nav .navbar-nav a").each(function( index ) {
            $(this).css({'animation-delay': (index/25)+'0.4s'});
          });
        });
    
        $('.dropdown-btn').on('click', function(e){
          e.preventDefault();
          setDropdown();
        });
        
        function setDropdown() {
          $('#myDropdown').slideToggle();
        }
    
        $('body').on('click', function(event){
          if (!event.target.matches('.dropdown-btn')) {
    
            var dropdowns = $(".dropdown-content");
            var i;
            for (i = 0; i < dropdowns.length; i++) {
              var openDropdown = dropdowns[i];
              if (openDropdown.classList.contains('show')) {
                openDropdown.classList.remove('show');
              }
            }
          }
        });
    
      });
      $(window).resize(function () {
        $('.horizon-swiper').horizonSwiper({
          showItems: 3,
          arrows: true
        });
      });
    </script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">   

          <section id="guide" lang="en">
            <div class="container">
              <div class="row">
                <!-- start body -->
                
            <div class="col-xs-12 col-sm-8 col-md-8 guide-section">
            <!-- start body -->
<div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elastic Stack Overview
      [7.3]
    </a></span> » <span class="breadcrumb-link"><a href="xpack-monitoring.html">Monitoring the Elastic Stack</a></span> » <span class="breadcrumb-node">Elastic Stack Monitoring Service</span></div><div class="navheader"><span class="prev"><a href="monitoring-production.html">
              « 
              Monitoring in a production environment</a>
           
        </span><span class="next">
           
          <a href="monitoring-troubleshooting.html">Troubleshooting monitoring
               »
            </a></span></div><div class="xpack chapter"><div class="titlepage"><div><div><h2 class="title"><a id="esms"></a>Elastic Stack Monitoring Service<a href="https://github.com/elastic/stack-docs/edit/7.3/docs/en/stack/monitoring/esms.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2></div></div></div><p>The Elastic Stack Monitoring Service (ESMS) is a monitoring cluster on Elastic Cloud. Elastic provides
and maintains ESMS for self-managed commercial customers. If you send
your monitoring data to ESMS, it can also be used by Elastic support to
provide better and faster incident resolution.</p><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>You must obtain your ESMS cluster URLs and credentials from the
Elastic support team.</p></div></div><h3><a id="esms-elasticsearch"></a>Collecting monitoring data about Elasticsearch<a href="https://github.com/elastic/stack-docs/edit/7.3/docs/en/stack/monitoring/esms.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>There are two methods for collecting and sending data about the health of your
production cluster to ESMS: Metricbeat or collectors and exporters.</p><div class="tip admon"><div class="icon"><img alt="Tip" src="images/icons/tip.png" /></div><div class="admon_content"><p>It is simplest to use Metricbeat.</p></div></div><p>To use Metricbeat:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">Enable the collection of monitoring data on your cluster.</p><p class="simpara">Set <code class="literal">xpack.monitoring.collection.enabled</code> to <code class="literal">true</code> on the
production cluster. By default, it is is disabled (<code class="literal">false</code>).</p><p class="simpara">You can use the following APIs to review and change this setting:</p><div class="pre_wrapper lang-console"><pre class="programlisting prettyprint lang-console">GET _cluster/settings

PUT _cluster/settings
{
  "persistent": {
    "xpack.monitoring.collection.enabled": true
  }
}</pre></div><div class="console_widget" data-snippet="snippets/43.console"></div><p class="simpara">If Elasticsearch security features are enabled, you must have <code class="literal">monitor</code> cluster privileges to
view the cluster settings and <code class="literal">manage</code> cluster privileges to change them.</p><p class="simpara">For more information about these settings, see
<a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/7.3/monitoring-settings.html" target="_top">Monitoring settings in Elasticsearch</a>.</p></li><li class="listitem"><p class="simpara">Disable the default collection of Elasticsearch monitoring metrics.</p><p class="simpara">Set <code class="literal">xpack.monitoring.elasticsearch.collection.enabled</code> to <code class="literal">false</code> on the
production cluster.</p><p class="simpara">You can use the following API to change this setting:</p><div class="pre_wrapper lang-console"><pre class="programlisting prettyprint lang-console">PUT _cluster/settings
{
  "persistent": {
    "xpack.monitoring.elasticsearch.collection.enabled": false
  }
}</pre></div><div class="console_widget" data-snippet="snippets/44.console"></div><p class="simpara">If Elasticsearch security features are enabled, you must have <code class="literal">monitor</code> cluster
privileges to  view the cluster settings and <code class="literal">manage</code> cluster privileges
to change them.</p></li><li class="listitem"><a class="ulink" href="https://www.elastic.co/guide/en/beats/metricbeat/7.3/metricbeat-installation.html" target="_top">Install Metricbeat</a> on each
node.</li><li class="listitem"><p class="simpara">Enable the Elasticsearch X-Pack module in Metricbeat on each node.</p><p class="simpara">For example, to enable the default configuration in the <code class="literal">modules.d</code> directory,
run the following command:</p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">metricbeat modules enable elasticsearch-xpack</pre></div><p class="simpara">For more information, see
<a class="ulink" href="https://www.elastic.co/guide/en/beats/metricbeat/7.3/configuration-metricbeat.html" target="_top">Specify which modules to run</a> and
<a class="ulink" href="https://www.elastic.co/guide/en/beats/metricbeat/7.3/metricbeat-module-elasticsearch.html" target="_top">Elasticsearch module</a>.</p></li><li class="listitem"><p class="simpara">Configure the Elasticsearch X-Pack module in Metricbeat on each node.</p><p class="simpara">The <code class="literal">modules.d/elasticsearch-xpack.yml</code> file contains the following settings:</p><div class="pre_wrapper lang-yaml"><pre class="programlisting prettyprint lang-yaml">  - module: elasticsearch
    metricsets:
      - ccr
      - cluster_stats
      - index
      - index_recovery
      - index_summary
      - ml_job
      - node_stats
      - shard
    period: 10s
    hosts: ["http://localhost:9200"]
    #username: "user"
    #password: "secret"
    xpack.enabled: true</pre></div><p class="simpara">By default, the module collects Elasticsearch monitoring metrics from
<code class="literal">http://localhost:9200</code>. If that host and port number are not correct, you must
update the <code class="literal">hosts</code> setting. If you configured Elasticsearch to use encrypted
communications, you must access it via HTTPS. For example, use a <code class="literal">hosts</code> setting
like <code class="literal">https://localhost:9200</code>.</p><p class="simpara">If Elastic security features are enabled, you must also provide a user ID
and password so that Metricbeat can collect metrics successfully:</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">Create a user on the production cluster that has the
<a class="ulink" href="https://www.elastic.co/guide/en/elastic-stack-overview/7.3/built-in-roles.html" target="_top"><code class="literal">remote_monitoring_collector</code> built-in role</a>.
Alternatively, use the
<a class="ulink" href="https://www.elastic.co/guide/en/elastic-stack-overview/7.3/built-in-users.html" target="_top"><code class="literal">remote_monitoring_user</code> built-in user</a>.</li><li class="listitem">Add the <code class="literal">username</code> and <code class="literal">password</code> settings to the Elasticsearch module configuration
file.</li></ol></div></li><li class="listitem"><p class="simpara">Optional: Disable the system module in Metricbeat.</p><p class="simpara">By default, the <a class="ulink" href="https://www.elastic.co/guide/en/beats/metricbeat/7.3/metricbeat-module-system.html" target="_top">system module</a> is
enabled. The information it collects, however, is not shown on the <span class="strong strong"><strong>Monitoring</strong></span>
page in Kibana. Unless you want to use that information for other purposes, run
the following command:</p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">metricbeat modules disable system</pre></div></li><li class="listitem"><p class="simpara">Identify where to send the Elasticsearch monitoring data and supply the necessary
security information. Add the following settings in the Metricbeat
configuration file (<code class="literal">metricbeat.yml</code>):</p><div class="pre_wrapper lang-yaml"><pre class="programlisting prettyprint lang-yaml">output.elasticsearch:
  hosts: ["MONITORING_ELASTICSEARCH_URL"] <a id="CO18-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
  username: cloud_monitoring_agent <a id="CO18-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>
  password: MONITORING_AGENT_PASSWORD <a id="CO18-3"></a><span><img src="images/icons/callouts/3.png" alt="" /></span></pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO18-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>Replace <code class="literal">MONITORING_ELASTICSEARCH_URL</code> with the appropriate URL for ESMS.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO18-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>The Elastic support team creates this user in ESMS and grants it the
<a class="ulink" href="https://www.elastic.co/guide/en/elastic-stack-overview/7.3/built-in-roles.html" target="_top"><code class="literal">remote_monitoring_agent</code> built-in role</a>.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO18-3"><span><img src="images/icons/callouts/3.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>Replace <code class="literal">MONITORING_AGENT_PASSWORD</code> with the value provided to you by the
Elastic support team.</p></td></tr></table></div></li><li class="listitem"><a class="ulink" href="https://www.elastic.co/guide/en/beats/metricbeat/7.3/metricbeat-starting.html" target="_top">Start Metricbeat</a>.</li><li class="listitem"><p class="simpara">Verify that your monitoring data exists in ESMS.</p><p class="simpara">Open Kibana in your web browser. Use the Kibana URL and the administrator user ID
that was provided to you by the Elastic support team.
<a class="ulink" href="https://www.elastic.co/guide/en/kibana/7.3/elasticsearch-metrics.html" target="_top">View the Elasticsearch metrics</a> on the
<span class="strong strong"><strong>Stack Monitoring</strong></span> page.</p><p class="simpara">If you do not see your metrics yet, see
<a class="link" href="monitoring-troubleshooting.html" title="Troubleshooting monitoring">Troubleshooting monitoring features</a>.</p></li></ol></div><h3><a id="esms-kibana"></a>Collecting monitoring data about Kibana<a href="https://github.com/elastic/stack-docs/edit/7.3/docs/en/stack/monitoring/esms.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>There are two methods for sending monitoring data about Kibana to ESMS.
You can send it directly to ESMS by using Metricbeat or you can route
it through exporters on the production cluster.</p><div class="tip admon"><div class="icon"><img alt="Tip" src="images/icons/tip.png" /></div><div class="admon_content"><p>It is simplest to use Metricbeat.</p></div></div><p>To use Metricbeat:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">Disable the default collection of Kibana monitoring metrics.</p><p class="simpara">Add the following setting in the Kibana configuration file (<code class="literal">kibana.yml</code>):</p><div class="pre_wrapper lang-yaml"><pre class="programlisting prettyprint lang-yaml">xpack.monitoring.kibana.collection.enabled: false</pre></div><p class="simpara">Leave the <code class="literal">xpack.monitoring.enabled</code> set to its default value (<code class="literal">true</code>).</p><p class="simpara">For more information, see
<a class="ulink" href="https://www.elastic.co/guide/en/kibana/7.3/monitoring-settings-kb.html" target="_top">Monitoring settings in Kibana</a>.</p></li><li class="listitem"><a class="ulink" href="https://www.elastic.co/guide/en/kibana/7.3/start-stop.html" target="_top">Start Kibana</a>.</li><li class="listitem">Ensure that the <code class="literal">xpack.monitoring.collection.enabled</code> setting is <code class="literal">true</code> on
each node in the production cluster.</li><li class="listitem"><a class="ulink" href="https://www.elastic.co/guide/en/beats/metricbeat/7.3/metricbeat-installation.html" target="_top">Install Metricbeat</a> on the
same server as Kibana.</li><li class="listitem"><p class="simpara">Enable the Kibana X-Pack module in Metricbeat.</p><p class="simpara">For example, to enable the default configuration in the <code class="literal">modules.d</code> directory,
run the following command:</p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">metricbeat modules enable kibana-xpack</pre></div><p class="simpara">For more information, see
<a class="ulink" href="https://www.elastic.co/guide/en/beats/metricbeat/7.3/configuration-metricbeat.html" target="_top">Specify which modules to run</a> and
<a class="ulink" href="https://www.elastic.co/guide/en/beats/metricbeat/7.3/metricbeat-module-kibana.html" target="_top">Kibana module</a>.</p></li><li class="listitem"><p class="simpara">Configure the Kibana X-Pack module in Metricbeat.</p><p class="simpara">The <code class="literal">modules.d/kibana-xpack.yml</code> file contains the following settings:</p><div class="pre_wrapper lang-yaml"><pre class="programlisting prettyprint lang-yaml">- module: kibana
  metricsets:
    - stats
  period: 10s
  hosts: ["localhost:5601"]
  #basepath: ""
  #username: "user"
  #password: "secret"
  xpack.enabled: true</pre></div><p class="simpara">By default, the module collects Kibana monitoring metrics from <code class="literal">localhost:5601</code>.
If that host and port number are not correct, you must update the <code class="literal">hosts</code>
setting. If you configured Kibana to use encrypted communications, you must
access it via HTTPS. For example, use a <code class="literal">hosts</code> setting like
<code class="literal">https://localhost:5601</code>.</p><p class="simpara">If the Elastic security features are enabled, you must also provide a user
ID and password so that Metricbeat can collect metrics successfully:</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem">Create a user on the production cluster that has the
<code class="literal">remote_monitoring_collector</code> <a class="ulink" href="https://www.elastic.co/guide/en/elastic-stack-overview/7.3/built-in-roles.html" target="_top">built-in role</a>.
Alternatively, use the <code class="literal">remote_monitoring_user</code>
<a class="ulink" href="https://www.elastic.co/guide/en/elastic-stack-overview/7.3/built-in-users.html" target="_top">built-in user</a>.</li><li class="listitem">Add the <code class="literal">username</code> and <code class="literal">password</code> settings to the Kibana module configuration
file.</li></ol></div></li><li class="listitem"><p class="simpara">Optional: Disable the system module in Metricbeat.</p><p class="simpara">By default, the <a class="ulink" href="https://www.elastic.co/guide/en/beats/metricbeat/7.3/metricbeat-module-system.html" target="_top">system module</a> is
enabled. The information it collects, however, is not shown on the <span class="strong strong"><strong>Monitoring</strong></span>
page in Kibana. Unless you want to use that information for other purposes, run
the following command:</p><div class="pre_wrapper lang-sh"><pre class="programlisting prettyprint lang-sh">metricbeat modules disable system</pre></div></li><li class="listitem"><p class="simpara">Identify where to send the Kibana monitoring data and supply the necessary
security information. Add the following settings in the Metricbeat
configuration file (<code class="literal">metricbeat.yml</code>):</p><div class="pre_wrapper lang-yaml"><pre class="programlisting prettyprint lang-yaml">  output.elasticsearch:
    hosts: ["MONITORING_ELASTICSEARCH_URL"] <a id="CO19-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
    username: cloud_monitoring_agent <a id="CO19-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>
    password: MONITORING_AGENT_PASSWORD <a id="CO19-3"></a><span><img src="images/icons/callouts/3.png" alt="" /></span></pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO19-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>Replace <code class="literal">MONITORING_ELASTICSEARCH_URL</code> with the appropriate URL for ESMS.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO19-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>The Elastic support team creates this user in ESMS and grants it the
<a class="ulink" href="https://www.elastic.co/guide/en/elastic-stack-overview/7.3/built-in-roles.html" target="_top"><code class="literal">remote_monitoring_agent</code> built-in role</a>.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO19-3"><span><img src="images/icons/callouts/3.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>Replace <code class="literal">MONITORING_AGENT_PASSWORD</code> with the value provided to you by the
Elastic support team.</p></td></tr></table></div></li><li class="listitem"><a class="ulink" href="https://www.elastic.co/guide/en/beats/metricbeat/7.3/metricbeat-starting.html" target="_top">Start Metricbeat</a>.</li><li class="listitem"><p class="simpara">Verify that your monitoring data exists in ESMS.</p><p class="simpara">Open Kibana in your web browser. Use the Kibana URL and the administrator user ID
that was provided to you by the Elastic support team.
<a class="ulink" href="https://www.elastic.co/guide/en/kibana/7.3/kibana-page.html" target="_top">View the Kibana metrics</a> on the <span class="strong strong"><strong>Stack Monitoring</strong></span> page.</p><p class="simpara">If you do not see your metrics yet, see
<a class="link" href="monitoring-troubleshooting.html" title="Troubleshooting monitoring">Troubleshooting monitoring features</a>.</p></li></ol></div></div><div class="navfooter"><span class="prev"><a href="monitoring-production.html">
              « 
              Monitoring in a production environment</a>
           
        </span><span class="next">
           
          <a href="monitoring-troubleshooting.html">Troubleshooting monitoring
               »
            </a></span></div>
<!-- end body -->

            </div>
            <div class="col-xs-12 col-sm-4 col-md-4" id="right_col">
        
                  <div id="rtpcontainer" style="display: block;">
                    <div class="mktg-promo">
                      <h3>Getting Started Videos</h3>
                      <ul class="icons">
                        <li class="icon-elasticsearch-white"><a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">Starting Elasticsearch</a></li>
                        <li class="icon-kibana-white"><a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">Introduction to Kibana</a></li>
                        <li class="icon-logstash-white"><a href="https://www.elastic.co/webinars/getting-started-logstash?baymax=default&elektra=docs&storm=top-video">Logstash Starter Guide</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'</div>
<!-- Footer Section end-->

<script src='https://www.elastic.co/elastic-nav.js'></script>
<script src='https://www.elastic.co/elastic-footer.js'></script>

<style type="text/css">
	
        
            .Facebook a {background:url("/assets/bltf546ff2e0a8f2de5/facebook.svg") no-repeat;}
            .Facebook a:before {
                content: url("/assets/bltc24cf11c714ecfc4/facebook-hover.svg");
                width:0;
                height:0;
                visibility:hidden;
            }
        
        
            .Facebook a:hover {background:url("/assets/bltc24cf11c714ecfc4/facebook-hover.svg")}		
        
	
        
            .Twitter a {background:url("/assets/bltdd9556d6b24e2b85/twitter.svg") no-repeat;}
            .Twitter a:before {
                content: url("/assets/blt90b0372cc07a54d3/twitter-hover.svg");
                width:0;
                height:0;
                visibility:hidden;
            }
        
        
            .Twitter a:hover {background:url("/assets/blt90b0372cc07a54d3/twitter-hover.svg")}		
        
	
        
            .LinkedIn a {background:url("/assets/bltc4a77e0f52ce07f1/linkedin.svg") no-repeat;}
            .LinkedIn a:before {
                content: url("/assets/blt01ce654380e4ea6c/linkedin-hover.svg");
                width:0;
                height:0;
                visibility:hidden;
            }
        
        
            .LinkedIn a:hover {background:url("/assets/blt01ce654380e4ea6c/linkedin-hover.svg")}		
        
	
        
            .Xing a {background:url("/assets/bltc6347078dcc9ec76/xing.svg") no-repeat;}
            .Xing a:before {
                content: url("/assets/bltededebe5f7521a39/xing-hover.svg");
                width:0;
                height:0;
                visibility:hidden;
            }
        
        
            .Xing a:hover {background:url("/assets/bltededebe5f7521a39/xing-hover.svg")}		
        
	
        
            .YouTube a {background:url("/assets/blt4982061ce1aebc7f/youtube.svg") no-repeat;}
            .YouTube a:before {
                content: url("/assets/bltddeb6c6404ae81a5/youtube-hover.svg");
                width:0;
                height:0;
                visibility:hidden;
            }
        
        
            .YouTube a:hover {background:url("/assets/bltddeb6c6404ae81a5/youtube-hover.svg")}		
        
	
</style>

<script src="//app-lon02.marketo.com/js/forms2/js/forms2.min.js"></script>
<script>
$(document).ready(function(){

    var ipSuccess = function(data) {
        country = data.country_code;
        if (data.in_eu){
                        
            marketo_id = "6196";
            
        }else{ 
            marketo_id = "1398";

        }

        $('.subscribe-form form.sb-form').attr('id', 'mktoForm_' + marketo_id);
        if(window.MktoForms2){
            MktoForms2.loadForm("//app-lon02.marketo.com", "813-MAM-392", marketo_id,function(form){
                form.onSuccess(function(form){
                    $('#mktoForm_'+marketo_id).css('display','none');
                    $('.subscribe-wrapper .subscribe-form-container').hide();
                    $('.subscribe-wrapper').find('.form_thanks').removeClass('hide')
                    dataLayer.push({'event': 'mktoFormSubmit'});
                    return false;
                });
            });  
        }
    }

    var marketo_id;

    $.ajax({
        url: "/gdpr-data"
    }).success(function(data) {
        ipSuccess(data);
    });

})
</script>

      </section>
    </div>

    
     <script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";
	var localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}';
</script>
<script src="/static/js/swiftype_app_search.umd.min.js"></script>
<script src="/static/js/jquery.autocomplete.js"></script>
<script type="text/javascript" src="/static/js/slick.min.js"></script>
<script src="/static/js/nav-v5.js"></script>
<script src="/static/js/script.js"></script>
 
     
<script type="text/javascript">
$(document).ready(function(){
	if (window.location.hash.length) {
	      var target = $(window.location.hash);
	      target = target.length ? target : $(window.location.hash);
	      if (target.length) {
	        setTimeout(function(){ $(window).scrollTop(target.offset().top - 60); }, 1200);        
	      }
	}
	$('#guide').on('click','a[href*=#]:not([href=#])',function(e) {
			var flag=true;
		      if (location.pathname.replace(/^\//,'') == this.pathname.replace(/^\//,'') && location.hostname == this.hostname) {
		          var target = $(this.hash);
		          target = target.length ? target :$(this.hash);
		          if (target.length) {
		            if(flag){
		              flag=false;
		              var heightScroll=($('.tertiary-nav.navbar-fixed-top').height())?60:110;
		              $('html,body').animate({
		                  scrollTop: target.offset().top - heightScroll
		                }, 2000, function(){
		                  flag=true;
		                });
		            }                    
		          }
		      }
		    
	});

})

</script>

     <style></style>
     
  
            <script type="text/javascript" src="docs.js"></script>
<script type='text/javascript' src='https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js?lang=yaml'></script>

            </body>
        
</html>
