<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Reindex API | Java REST Client [7.1] | Elastic</title>
<link rel="home" href="index.html" title="Java REST Client [7.1]"/>
<link rel="up" href="java-rest-high-supported-apis.html" title="Document APIs"/>
<link rel="prev" href="java-rest-high-document-multi-get.html" title="Multi-Get API"/>
<link rel="next" href="java-rest-high-document-update-by-query.html" title="Update By Query API"/>
<meta name="DC.type" content="Learn/Docs/Clients/JavaREST/7.1"/>
<meta name="DC.subject" content="Clients"/>
<meta name="DC.identifier" content="7.1"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!--BEGIN QUALTRICS WEBSITE FEEDBACK SNIPPET-->
    <script type='text/javascript'>
      (function(){var g=function(e,h,f,g){
      this.get=function(a){for(var a=a+"=",c=document.cookie.split(";"),b=0,e=c.length;b<e;b++){for(var d=c[b];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return null};
      this.set=function(a,c){var b="",b=new Date;b.setTime(b.getTime()+6048E5);b="; expires="+b.toGMTString();document.cookie=a+"="+c+b+"; path=/; "};
      this.check=function(){var a=this.get(f);if(a)a=a.split(":");else if(100!=e)"v"==h&&(e=Math.random()>=e/100?0:100),a=[h,e,0],this.set(f,a.join(":"));else return!0;var c=a[1];if(100==c)return!0;switch(a[0]){case "v":return!1;case "r":return c=a[2]%Math.floor(100/c),a[2]++,this.set(f,a.join(":")),!c}return!0};
      this.go=function(){if(this.check()){var a=document.createElement("script");a.type="text/javascript";a.src=g;document.body&&document.body.appendChild(a)}};
      this.start=function(){var a=this;window.addEventListener?window.addEventListener("load",function(){a.go()},!1):window.attachEvent&&window.attachEvent("onload",function(){a.go()})}};
      try{(new g(100,"r","QSI_S_ZN_emkP0oSe9Qrn7kF","https://znemkp0ose9qrn7kf-elastic.siteintercept.qualtrics.com/WRSiteInterceptEngine/?Q_ZID=ZN_emkP0oSe9Qrn7kF")).start()}catch(i){}})();
    </script><div id='ZN_emkP0oSe9Qrn7kF'><!--DO NOT REMOVE-CONTENTS PLACED HERE--></div>
    <!--END WEBSITE FEEDBACK SNIPPET-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <!-- Subnav -->
    <div>
      <div>
        <div class="tertiary-nav d-none d-md-block">
          <div class="container">
            <div class="p-t-b-15 d-flex justify-content-between nav-container">
              <div class="breadcrum-wrapper"><span><a href="/guide/" style="font-size: 14px; font-weight: 600; color: #000;">Docs</a></span></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container">
              <div class="row">
                <div class="col-xs-12 col-sm-8 col-md-8 guide-section">
                  <!-- start body -->
                  <div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Java REST Client [7.1]</a></span>
»
<span class="breadcrumb-link"><a href="java-rest-high.html">Java High Level REST Client</a></span>
»
<span class="breadcrumb-link"><a href="java-rest-high-supported-apis.html">Document APIs</a></span>
»
<span class="breadcrumb-node">Reindex API</span>
</div>
<div class="navheader">
<span class="prev">
<a href="java-rest-high-document-multi-get.html">« Multi-Get API</a>
</span>
<span class="next">
<a href="java-rest-high-document-update-by-query.html">Update By Query API »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="java-rest-high-document-reindex"></a>Reindex API<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/7.1/docs/java-rest/high-level/document/reindex.asciidoc">edit</a></h2>
</div></div></div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="java-rest-high-document-reindex-request"></a>Reindex Request<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/7.1/docs/java-rest/high-level/document/reindex.asciidoc">edit</a></h3>
</div></div></div>
<p>A <code class="literal">ReindexRequest</code> can be used to copy documents from one or more indexes into a
destination index.</p>
<p>It requires an existing source index and a target index which may or may not exist pre-request. Reindex does not attempt
to set up the destination index. It does not copy the settings of the source index. You should set up the destination
index prior to running a _reindex action, including setting up mappings, shard counts, replicas, etc.</p>
<p>The simplest form of a <code class="literal">ReindexRequest</code> looks like this:</p>
<div class="pre_wrapper lang-java">
<pre class="programlisting prettyprint lang-java">ReindexRequest request = new ReindexRequest(); <a id="CO123-1"></a><i class="conum" data-value="1"></i>
request.setSourceIndices("source1", "source2"); <a id="CO123-2"></a><i class="conum" data-value="2"></i>
request.setDestIndex("dest");  <a id="CO123-3"></a><i class="conum" data-value="3"></i></pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO123-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Creates the <code class="literal">ReindexRequest</code></p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO123-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>Adds a list of sources to copy from</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO123-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>Adds the destination index</p>
</td>
</tr>
</table>
</div>
<p>The <code class="literal">dest</code> element can be configured like the index API to control optimistic concurrency control. Just leaving out
<code class="literal">versionType</code> (as above) or setting it to internal will cause Elasticsearch to blindly dump documents into the target.
Setting <code class="literal">versionType</code> to external will cause Elasticsearch to preserve the version from the source, create any documents
that are missing, and update any documents that have an older version in the destination index than they do in the
source index.</p>
<div class="pre_wrapper lang-java">
<pre class="programlisting prettyprint lang-java">request.setDestVersionType(VersionType.EXTERNAL); <a id="CO124-1"></a><i class="conum" data-value="1"></i></pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO124-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Set the versionType to <code class="literal">EXTERNAL</code></p>
</td>
</tr>
</table>
</div>
<p>Setting <code class="literal">opType</code> to <code class="literal">create</code> will cause <code class="literal">_reindex</code> to only create missing documents in the target index. All existing
documents will cause a version conflict. The default <code class="literal">opType</code> is <code class="literal">index</code>.</p>
<div class="pre_wrapper lang-java">
<pre class="programlisting prettyprint lang-java">request.setDestOpType("create"); <a id="CO125-1"></a><i class="conum" data-value="1"></i></pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO125-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Set the opType to <code class="literal">create</code></p>
</td>
</tr>
</table>
</div>
<p>By default version conflicts abort the <code class="literal">_reindex</code> process but you can just count
them instead with:</p>
<div class="pre_wrapper lang-java">
<pre class="programlisting prettyprint lang-java">request.setConflicts("proceed"); <a id="CO126-1"></a><i class="conum" data-value="1"></i></pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO126-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Set <code class="literal">proceed</code> on version conflict</p>
</td>
</tr>
</table>
</div>
<p>You can limit the documents by adding a query.</p>
<div class="pre_wrapper lang-java">
<pre class="programlisting prettyprint lang-java">request.setSourceQuery(new TermQueryBuilder("user", "kimchy")); <a id="CO127-1"></a><i class="conum" data-value="1"></i></pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO127-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Only copy documents which have field <code class="literal">user</code> set to <code class="literal">kimchy</code></p>
</td>
</tr>
</table>
</div>
<p>It’s also possible to limit the number of processed documents by setting size.</p>
<div class="pre_wrapper lang-java">
<pre class="programlisting prettyprint lang-java">request.setSize(10); <a id="CO128-1"></a><i class="conum" data-value="1"></i></pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO128-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Only copy 10 documents</p>
</td>
</tr>
</table>
</div>
<p>By default <code class="literal">_reindex</code> uses batches of 1000. You can change the batch size with <code class="literal">sourceBatchSize</code>.</p>
<div class="pre_wrapper lang-java">
<pre class="programlisting prettyprint lang-java">request.setSourceBatchSize(100); <a id="CO129-1"></a><i class="conum" data-value="1"></i></pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO129-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Use batches of 100 documents</p>
</td>
</tr>
</table>
</div>
<p>Reindex can also use the ingest feature by specifying a <code class="literal">pipeline</code>.</p>
<div class="pre_wrapper lang-java">
<pre class="programlisting prettyprint lang-java">request.setDestPipeline("my_pipeline"); <a id="CO130-1"></a><i class="conum" data-value="1"></i></pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO130-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>set pipeline to <code class="literal">my_pipeline</code></p>
</td>
</tr>
</table>
</div>
<p>If you want a particular set of documents from the source index you’ll need to use sort. If possible, prefer a more
selective query to size and sort.</p>
<div class="pre_wrapper lang-java">
<pre class="programlisting prettyprint lang-java">request.addSortField("field1", SortOrder.DESC); <a id="CO131-1"></a><i class="conum" data-value="1"></i>
request.addSortField("field2", SortOrder.ASC); <a id="CO131-2"></a><i class="conum" data-value="2"></i></pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO131-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>add descending sort to`field1`</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO131-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>add ascending sort to <code class="literal">field2</code></p>
</td>
</tr>
</table>
</div>
<p><code class="literal">ReindexRequest</code> also supports a <code class="literal">script</code> that modifies the document. It allows you to
also change the document&#8217;s metadata. The following example illustrates that.</p>
<div class="pre_wrapper lang-java">
<pre class="programlisting prettyprint lang-java">request.setScript(
    new Script(
        ScriptType.INLINE, "painless",
        "if (ctx._source.user == 'kimchy') {ctx._source.likes++;}",
        Collections.emptyMap())); <a id="CO132-1"></a><i class="conum" data-value="1"></i></pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO132-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p><code class="literal">setScript</code> to increment the <code class="literal">likes</code> field on all documents with user <code class="literal">kimchy</code>.</p>
</td>
</tr>
</table>
</div>
<p><code class="literal">ReindexRequest</code> supports reindexing from a remote Elasticsearch cluster. When using a remote cluster the query should be
specified inside the <code class="literal">RemoteInfo</code> object and not using <code class="literal">setSourceQuery</code>. If both the remote info and the source query are
set it results in a validation error during the request. The reason for this is that the remote Elasticsearch may not
understand queries built by the modern query builders. The remote cluster support works all the way back to Elasticsearch
0.90 and the query language has changed since then. When reaching older versions, it is safer to write the query by hand
in JSON.</p>
<div class="pre_wrapper lang-java">
<pre class="programlisting prettyprint lang-java">request.setRemoteInfo(
    new RemoteInfo(
        "http", remoteHost, remotePort, null,
        new BytesArray(new MatchAllQueryBuilder().toString()),
        user, password, Collections.emptyMap(),
        new TimeValue(100, TimeUnit.MILLISECONDS),
        new TimeValue(100, TimeUnit.SECONDS)
    )
); <a id="CO133-1"></a><i class="conum" data-value="1"></i></pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO133-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>set remote elastic cluster</p>
</td>
</tr>
</table>
</div>
<p><code class="literal">ReindexRequest</code> also helps in automatically parallelizing using <code class="literal">sliced-scroll</code> to
slice on <code class="literal">_uid</code>. Use <code class="literal">setSlices</code> to specify the number of slices to use.</p>
<div class="pre_wrapper lang-java">
<pre class="programlisting prettyprint lang-java">request.setSlices(2); <a id="CO134-1"></a><i class="conum" data-value="1"></i></pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO134-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>set number of slices to use</p>
</td>
</tr>
</table>
</div>
<p><code class="literal">ReindexRequest</code> uses the <code class="literal">scroll</code> parameter to control how long it keeps the
"search context" alive.</p>
<div class="pre_wrapper lang-java">
<pre class="programlisting prettyprint lang-java">request.setScroll(TimeValue.timeValueMinutes(10)); <a id="CO135-1"></a><i class="conum" data-value="1"></i></pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO135-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>set scroll time</p>
</td>
</tr>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_optional_arguments_7"></a>Optional arguments<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/7.1/docs/java-rest/high-level/document/reindex.asciidoc">edit</a></h3>
</div></div></div>
<p>In addition to the options above the following arguments can optionally be also provided:</p>
<div class="pre_wrapper lang-java">
<pre class="programlisting prettyprint lang-java">request.setTimeout(TimeValue.timeValueMinutes(2)); <a id="CO136-1"></a><i class="conum" data-value="1"></i></pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO136-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Timeout to wait for the reindex request to be performed as a <code class="literal">TimeValue</code></p>
</td>
</tr>
</table>
</div>
<div class="pre_wrapper lang-java">
<pre class="programlisting prettyprint lang-java">request.setRefresh(true); <a id="CO137-1"></a><i class="conum" data-value="1"></i></pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO137-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Refresh index after calling reindex</p>
</td>
</tr>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="java-rest-high-document-reindex-sync"></a>Synchronous Execution<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/7.1/docs/java-rest/high-level/execution.asciidoc">edit</a></h3>
</div></div></div>
<p>When executing a <code class="literal">ReindexRequest</code> in the following manner, the client waits
for the <code class="literal">BulkByScrollResponse</code> to be returned before continuing with code execution:</p>
<div class="pre_wrapper lang-java">
<pre class="programlisting prettyprint lang-java">BulkByScrollResponse bulkResponse =
        client.reindex(request, RequestOptions.DEFAULT);</pre>
</div>
<p>Synchronous calls may throw an <code class="literal">IOException</code> in case of either failing to
parse the REST response in the high-level REST client, the request times out
or similar cases where there is no response coming back from the server.</p>
<p>In cases where the server returns a <code class="literal">4xx</code> or <code class="literal">5xx</code> error code, the high-level
client tries to parse the response body error details instead and then throws
a generic <code class="literal">ElasticsearchException</code> and adds the original <code class="literal">ResponseException</code> as a
suppressed exception to it.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="java-rest-high-document-reindex-async"></a>Asynchronous Execution<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/7.1/docs/java-rest/high-level/execution.asciidoc">edit</a></h3>
</div></div></div>
<p>Executing a <code class="literal">ReindexRequest</code> can also be done in an asynchronous fashion so that
the client can return directly. Users need to specify how the response or
potential failures will be handled by passing the request and a listener to the
asynchronous reindex method:</p>
<div class="pre_wrapper lang-java">
<pre class="programlisting prettyprint lang-java">client.reindexAsync(request, RequestOptions.DEFAULT, listener); <a id="CO138-1"></a><i class="conum" data-value="1"></i></pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO138-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>The <code class="literal">ReindexRequest</code> to execute and the <code class="literal">ActionListener</code> to use when
the execution completes</p>
</td>
</tr>
</table>
</div>
<p>The asynchronous method does not block and returns immediately. Once it is
completed the <code class="literal">ActionListener</code> is called back using the <code class="literal">onResponse</code> method
if the execution successfully completed or using the <code class="literal">onFailure</code> method if
it failed. Failure scenarios and expected exceptions are the same as in the
synchronous execution case.</p>
<p>A typical listener for <code class="literal">reindex</code> looks like:</p>
<div class="pre_wrapper lang-java">
<pre class="programlisting prettyprint lang-java">listener = new ActionListener&lt;BulkByScrollResponse&gt;() {
    @Override
    public void onResponse(BulkByScrollResponse bulkResponse) {
        <a id="CO139-1"></a><i class="conum" data-value="1"></i>
    }

    @Override
    public void onFailure(Exception e) {
        <a id="CO139-2"></a><i class="conum" data-value="2"></i>
    }
};</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO139-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Called when the execution is successfully completed.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO139-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>Called when the whole <code class="literal">ReindexRequest</code> fails.</p>
</td>
</tr>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="java-rest-high-document-reindex-task-submission"></a>Reindex task submission<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/7.1/docs/java-rest/high-level/document/reindex.asciidoc">edit</a></h3>
</div></div></div>
<p>It is also possible to submit a <code class="literal">ReindexRequest</code> and not wait for it completion with the use of Task API. This is an equivalent of a REST request
with wait_for_completion flag set to false.</p>
<div class="pre_wrapper lang-java">
<pre class="programlisting prettyprint lang-java">ReindexRequest reindexRequest = new ReindexRequest(); <a id="CO140-1"></a><i class="conum" data-value="1"></i>
reindexRequest.setSourceIndices(sourceIndex);
reindexRequest.setDestIndex(destinationIndex);
reindexRequest.setRefresh(true);

TaskSubmissionResponse reindexSubmission = highLevelClient()
    .submitReindexTask(reindexRequest, RequestOptions.DEFAULT); <a id="CO140-2"></a><i class="conum" data-value="2"></i>

String taskId = reindexSubmission.getTask(); <a id="CO140-3"></a><i class="conum" data-value="3"></i></pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO140-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>A <code class="literal">ReindexRequest</code> is constructed the same way as for the synchronous method</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO140-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>A submit method returns a <code class="literal">TaskSubmissionResponse</code> which contains a task identifier.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO140-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>The task identifier can be used to get <code class="literal">response</code> from a completed task.</p>
</td>
</tr>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="java-rest-high-document-reindex-response"></a>Reindex Response<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/7.1/docs/java-rest/high-level/document/reindex.asciidoc">edit</a></h3>
</div></div></div>
<p>The returned <code class="literal">BulkByScrollResponse</code> contains information about the executed operations and
allows to iterate over each result as follows:</p>
<div class="pre_wrapper lang-java">
<pre class="programlisting prettyprint lang-java">TimeValue timeTaken = bulkResponse.getTook(); <a id="CO141-1"></a><i class="conum" data-value="1"></i>
boolean timedOut = bulkResponse.isTimedOut(); <a id="CO141-2"></a><i class="conum" data-value="2"></i>
long totalDocs = bulkResponse.getTotal(); <a id="CO141-3"></a><i class="conum" data-value="3"></i>
long updatedDocs = bulkResponse.getUpdated(); <a id="CO141-4"></a><i class="conum" data-value="4"></i>
long createdDocs = bulkResponse.getCreated(); <a id="CO141-5"></a><i class="conum" data-value="5"></i>
long deletedDocs = bulkResponse.getDeleted(); <a id="CO141-6"></a><i class="conum" data-value="6"></i>
long batches = bulkResponse.getBatches(); <a id="CO141-7"></a><i class="conum" data-value="7"></i>
long noops = bulkResponse.getNoops(); <a id="CO141-8"></a><i class="conum" data-value="8"></i>
long versionConflicts = bulkResponse.getVersionConflicts(); <a id="CO141-9"></a><i class="conum" data-value="9"></i>
long bulkRetries = bulkResponse.getBulkRetries(); <a id="CO141-10"></a><i class="conum" data-value="10"></i>
long searchRetries = bulkResponse.getSearchRetries(); <a id="CO141-11"></a><i class="conum" data-value="11"></i>
TimeValue throttledMillis = bulkResponse.getStatus().getThrottled(); <a id="CO141-12"></a><i class="conum" data-value="12"></i>
TimeValue throttledUntilMillis =
        bulkResponse.getStatus().getThrottledUntil(); <a id="CO141-13"></a><i class="conum" data-value="13"></i>
List&lt;ScrollableHitSource.SearchFailure&gt; searchFailures =
        bulkResponse.getSearchFailures(); <a id="CO141-14"></a><i class="conum" data-value="14"></i>
List&lt;BulkItemResponse.Failure&gt; bulkFailures =
        bulkResponse.getBulkFailures(); <a id="CO141-15"></a><i class="conum" data-value="15"></i></pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO141-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Get total time taken</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO141-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>Check if the request timed out</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO141-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>Get total number of docs processed</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO141-4"><i class="conum" data-value="4"></i></a></p>
</td>
<td align="left" valign="top">
<p>Number of docs that were updated</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO141-5"><i class="conum" data-value="5"></i></a></p>
</td>
<td align="left" valign="top">
<p>Number of docs that were created</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO141-6"><i class="conum" data-value="6"></i></a></p>
</td>
<td align="left" valign="top">
<p>Number of docs that were deleted</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO141-7"><i class="conum" data-value="7"></i></a></p>
</td>
<td align="left" valign="top">
<p>Number of batches that were executed</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO141-8"><i class="conum" data-value="8"></i></a></p>
</td>
<td align="left" valign="top">
<p>Number of skipped docs</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO141-9"><i class="conum" data-value="9"></i></a></p>
</td>
<td align="left" valign="top">
<p>Number of version conflicts</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO141-10"><i class="conum" data-value="10"></i></a></p>
</td>
<td align="left" valign="top">
<p>Number of times request had to retry bulk index operations</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO141-11"><i class="conum" data-value="11"></i></a></p>
</td>
<td align="left" valign="top">
<p>Number of times request had to retry search operations</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO141-12"><i class="conum" data-value="12"></i></a></p>
</td>
<td align="left" valign="top">
<p>The total time this request has throttled itself not including the current throttle time if it is currently sleeping</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO141-13"><i class="conum" data-value="13"></i></a></p>
</td>
<td align="left" valign="top">
<p>Remaining delay of any current throttle sleep or 0 if not sleeping</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO141-14"><i class="conum" data-value="14"></i></a></p>
</td>
<td align="left" valign="top">
<p>Failures during search phase</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO141-15"><i class="conum" data-value="15"></i></a></p>
</td>
<td align="left" valign="top">
<p>Failures during bulk index operation</p>
</td>
</tr>
</table>
</div>
</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="java-rest-high-document-multi-get.html">« Multi-Get API</a>
</span>
<span class="next">
<a href="java-rest-high-document-update-by-query.html">Update By Query API »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>
                <div class="col-xs-12 col-sm-4 col-md-4" id="right_col">
                  <div id="rtpcontainer" style="display: block;">
                    <div class="mktg-promo">
                      <h3>Most Popular</h3>
                      <ul class="icons">
                        <li class="icon-elasticsearch-white"><a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">Get Started with Elasticsearch: Video</a></li>
                        <li class="icon-kibana-white"><a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">Intro to Kibana: Video</a></li>
                        <li class="icon-logstash-white"><a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">ELK for Logs & Metrics: Video</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";
	var localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}';
</script>
<script src="/static/js/swiftype_app_search.umd.min.js"></script>
<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
