<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>X-Pack Graph explore API | Java REST Client [7.6] | Elastic</title>
<link rel="home" href="index.html" title="Java REST Client [7.6]"/>
<link rel="up" href="_graph_apis.html" title="Graph APIs"/>
<link rel="prev" href="_graph_apis.html" title="Graph APIs"/>
<link rel="next" href="_ccr_apis.html" title="CCR APIs"/>
<meta name="DC.type" content="Learn/Docs/Clients/JavaREST/7.6"/>
<meta name="DC.subject" content="Clients"/>
<meta name="DC.identifier" content="7.6"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!--BEGIN QUALTRICS WEBSITE FEEDBACK SNIPPET-->
    <script type='text/javascript'>
      (function(){var g=function(e,h,f,g){
      this.get=function(a){for(var a=a+"=",c=document.cookie.split(";"),b=0,e=c.length;b<e;b++){for(var d=c[b];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return null};
      this.set=function(a,c){var b="",b=new Date;b.setTime(b.getTime()+6048E5);b="; expires="+b.toGMTString();document.cookie=a+"="+c+b+"; path=/; "};
      this.check=function(){var a=this.get(f);if(a)a=a.split(":");else if(100!=e)"v"==h&&(e=Math.random()>=e/100?0:100),a=[h,e,0],this.set(f,a.join(":"));else return!0;var c=a[1];if(100==c)return!0;switch(a[0]){case "v":return!1;case "r":return c=a[2]%Math.floor(100/c),a[2]++,this.set(f,a.join(":")),!c}return!0};
      this.go=function(){if(this.check()){var a=document.createElement("script");a.type="text/javascript";a.src=g;document.body&&document.body.appendChild(a)}};
      this.start=function(){var a=this;window.addEventListener?window.addEventListener("load",function(){a.go()},!1):window.attachEvent&&window.attachEvent("onload",function(){a.go()})}};
      try{(new g(100,"r","QSI_S_ZN_emkP0oSe9Qrn7kF","https://znemkp0ose9qrn7kf-elastic.siteintercept.qualtrics.com/WRSiteInterceptEngine/?Q_ZID=ZN_emkP0oSe9Qrn7kF")).start()}catch(i){}})();
    </script><div id='ZN_emkP0oSe9Qrn7kF'><!--DO NOT REMOVE-CONTENTS PLACED HERE--></div>
    <!--END WEBSITE FEEDBACK SNIPPET-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <!-- Subnav -->
    <div>
      <div>
        <div class="tertiary-nav d-none d-md-block">
          <div class="container">
            <div class="p-t-b-15 d-flex justify-content-between nav-container">
              <div class="breadcrum-wrapper"><span><a href="/guide/" style="font-size: 14px; font-weight: 600; color: #000;">Docs</a></span></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container">
              <div class="row">
                <div class="col-xs-12 col-sm-8 col-md-8 guide-section">
                  <!-- start body -->
                  <div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Java REST Client [7.6]</a></span>
»
<span class="breadcrumb-link"><a href="java-rest-high.html">Java High Level REST Client</a></span>
»
<span class="breadcrumb-link"><a href="_graph_apis.html">Graph APIs</a></span>
»
<span class="breadcrumb-node">X-Pack Graph explore API</span>
</div>
<div class="navheader">
<span class="prev">
<a href="_graph_apis.html">« Graph APIs</a>
</span>
<span class="next">
<a href="_ccr_apis.html">CCR APIs »</a>
</span>
</div>
<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="java-rest-high-x-pack-graph-explore"></a>X-Pack Graph explore API<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/7.6/docs/java-rest/high-level/graph/explore.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="java-rest-high-x-pack-graph-explore-execution"></a>Initial request<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/7.6/docs/java-rest/high-level/graph/explore.asciidoc">edit</a></h3>
</div></div></div>
<p>Graph queries are executed using the <code class="literal">explore()</code> method:</p>
<div class="pre_wrapper lang-java">
<pre class="programlisting prettyprint lang-java">GraphExploreRequest request = new GraphExploreRequest();
request.indices("index1", "index2");
request.useSignificance(false);
TermQueryBuilder startingQuery = new TermQueryBuilder("text", "projectx");

Hop hop1 = request.createNextHop(startingQuery); <a id="CO1129-1"></a><i class="conum" data-value="1"></i>
VertexRequest people = hop1.addVertexRequest("participants"); <a id="CO1129-2"></a><i class="conum" data-value="2"></i>
people.minDocCount(1);
VertexRequest files = hop1.addVertexRequest("attachment_md5");
files.minDocCount(1);

Hop hop2 = request.createNextHop(null); <a id="CO1129-3"></a><i class="conum" data-value="3"></i>
VertexRequest vr2 = hop2.addVertexRequest("participants");
vr2.minDocCount(5);

GraphExploreResponse exploreResponse = client.graph().explore(request, RequestOptions.DEFAULT); <a id="CO1129-4"></a><i class="conum" data-value="4"></i></pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO1129-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>In this example we seed the exploration with a query to find messages mentioning the mysterious <code class="literal">projectx</code></p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO1129-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>What we want to discover in these messages are the ids of <code class="literal">participants</code> in the communications and the md5 hashes
of any attached files. In each case, we want to find people or files that have had at least one document connecting them
to projectx.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO1129-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>The next "hop" in the graph exploration is to find the people who have shared several messages with the people or files
discovered in the previous hop (the projectx conspirators). The <code class="literal">minDocCount</code> control is used here to ensure the people
discovered have had at least 5 communications with projectx entities. Note we could also supply a "guiding query" here e.g. a
date range to consider only recent communications but we pass null to consider all connections.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO1129-4"><i class="conum" data-value="4"></i></a></p>
</td>
<td align="left" valign="top">
<p>Finally we call the graph explore API with the GraphExploreRequest object.</p>
</td>
</tr>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_response"></a>Response<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/7.6/docs/java-rest/high-level/graph/explore.asciidoc">edit</a></h3>
</div></div></div>
<p>Graph responses consist of Vertex and Connection objects (aka "nodes" and "edges" respectively):</p>
<div class="pre_wrapper lang-java">
<pre class="programlisting prettyprint lang-java">Collection&lt;Vertex&gt; v = exploreResponse.getVertices();
Collection&lt;Connection&gt; c = exploreResponse.getConnections();
for (Vertex vertex : v) {
    System.out.println(vertex.getField() + ":" + vertex.getTerm() + <a id="CO1130-1"></a><i class="conum" data-value="1"></i>
            " discovered at hop depth " + vertex.getHopDepth());
}
for (Connection link : c) {
    System.out.println(link.getFrom() + " -&gt; " + link.getTo() <a id="CO1130-2"></a><i class="conum" data-value="2"></i>
            + " evidenced by " + link.getDocCount() + " docs");
}</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO1130-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Each Vertex is a unique term (a combination of fieldname and term value). The "hopDepth" property tells us at which point in the
requested exploration this term was first discovered.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO1130-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>Each Connection is a pair of Vertex objects and includes a docCount property telling us how many times these two
Vertex terms have been sighted together</p>
</td>
</tr>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="java-rest-high-x-pack-graph-expand-execution"></a>Expanding a client-side Graph<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/7.6/docs/java-rest/high-level/graph/explore.asciidoc">edit</a></h3>
</div></div></div>
<p>Typically once an application has rendered an initial GraphExploreResponse as a collection of vertices and connecting lines (graph visualization toolkits such as D3, sigma.js or Keylines help here) the next step a user may want to do is "expand". This involves finding new vertices that might be connected to the existing ones currently shown.</p>
<p>To do this we use the same <code class="literal">explore</code> method but our request contains details about which vertices to expand from and which vertices to avoid re-discovering.</p>
<div class="pre_wrapper lang-java">
<pre class="programlisting prettyprint lang-java">GraphExploreRequest expandRequest = new GraphExploreRequest();
expandRequest.indices("index1", "index2");


Hop expandHop1 = expandRequest.createNextHop(null); <a id="CO1131-1"></a><i class="conum" data-value="1"></i>
VertexRequest fromPeople = expandHop1.addVertexRequest("participants"); <a id="CO1131-2"></a><i class="conum" data-value="2"></i>
for (Vertex vertex : initialVertices) {
    if (vertex.getField().equals("participants")) {
        fromPeople.addInclude(vertex.getTerm(), 1f);
    }
}

Hop expandHop2 = expandRequest.createNextHop(null);
VertexRequest newPeople = expandHop2.addVertexRequest("participants"); <a id="CO1131-3"></a><i class="conum" data-value="3"></i>
for (Vertex vertex : initialVertices) {
    if (vertex.getField().equals("participants")) {
        newPeople.addExclude(vertex.getTerm());
    }
}

GraphExploreResponse expandResponse = client.graph().explore(expandRequest, RequestOptions.DEFAULT);</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO1131-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Unlike the initial request we do not need to pass a starting query</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO1131-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>In the first hop which represents our "from" vertices we explicitly list the terms that we already have on-screen and want to expand by using the <code class="literal">addInclude</code> filter.
We can supply a boost for those terms that are considered more important to follow than others but here we select a common value of 1 for all.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO1131-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>When defining the second hop which represents the "to" vertices we hope to discover we explicitly list the terms that we already know about using the <code class="literal">addExclude</code> filter</p>
</td>
</tr>
</table>
</div>
</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="_graph_apis.html">« Graph APIs</a>
</span>
<span class="next">
<a href="_ccr_apis.html">CCR APIs »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>
                <div class="col-xs-12 col-sm-4 col-md-4" id="right_col">
                  <div id="rtpcontainer" style="display: block;">
                    <div class="mktg-promo">
                      <h3>Most Popular</h3>
                      <ul class="icons">
                        <li class="icon-elasticsearch-white"><a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">Get Started with Elasticsearch: Video</a></li>
                        <li class="icon-kibana-white"><a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">Intro to Kibana: Video</a></li>
                        <li class="icon-logstash-white"><a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">ELK for Logs & Metrics: Video</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";
	var localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}';
</script>
<script src="/static/js/swiftype_app_search.umd.min.js"></script>
<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
