<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Terms Aggregation Usage | Elasticsearch.Net and NEST: the .NET clients [6.x] | Elastic</title>
<link rel="home" href="index.html" title="Elasticsearch.Net and NEST: the .NET clients [6.x]"/>
<link rel="up" href="bucket-aggregations.html" title="Bucket Aggregations"/>
<link rel="prev" href="significant-text-aggregation-usage.html" title="Significant Text Aggregation Usage"/>
<link rel="next" href="pipeline-aggregations.html" title="Pipeline Aggregations"/>
<meta name="DC.type" content="Learn/Docs/Clients/.Net/6.x"/>
<meta name="DC.subject" content="Clients"/>
<meta name="DC.identifier" content="6.x"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <!--© 2015-2022 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!--BEGIN QUALTRICS WEBSITE FEEDBACK SNIPPET-->
    <script type='text/javascript'>
      (function(){var g=function(e,h,f,g){
      this.get=function(a){for(var a=a+"=",c=document.cookie.split(";"),b=0,e=c.length;b<e;b++){for(var d=c[b];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return null};
      this.set=function(a,c){var b="",b=new Date;b.setTime(b.getTime()+6048E5);b="; expires="+b.toGMTString();document.cookie=a+"="+c+b+"; path=/; "};
      this.check=function(){var a=this.get(f);if(a)a=a.split(":");else if(100!=e)"v"==h&&(e=Math.random()>=e/100?0:100),a=[h,e,0],this.set(f,a.join(":"));else return!0;var c=a[1];if(100==c)return!0;switch(a[0]){case "v":return!1;case "r":return c=a[2]%Math.floor(100/c),a[2]++,this.set(f,a.join(":")),!c}return!0};
      this.go=function(){if(this.check()){var a=document.createElement("script");a.type="text/javascript";a.src=g;document.body&&document.body.appendChild(a)}};
      this.start=function(){var a=this;window.addEventListener?window.addEventListener("load",function(){a.go()},!1):window.attachEvent&&window.attachEvent("onload",function(){a.go()})}};
      try{(new g(100,"r","QSI_S_ZN_emkP0oSe9Qrn7kF","https://znemkp0ose9qrn7kf-elastic.siteintercept.qualtrics.com/WRSiteInterceptEngine/?Q_ZID=ZN_emkP0oSe9Qrn7kF")).start()}catch(i){}})();
    </script><div id='ZN_emkP0oSe9Qrn7kF'><!--DO NOT REMOVE-CONTENTS PLACED HERE--></div>
    <!--END WEBSITE FEEDBACK SNIPPET-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  <div class="page_header">
<p>
  <strong>NOTE</strong>: You are looking at documentation for an older release. 
  For the latest information, see the 
  <a href="../current/index.html">current release documentation</a>. 
</p>
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="index.html">Elasticsearch.Net and NEST:  the .NET clients [6.x]</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="reference-aggregations.html">Aggregations</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="bucket-aggregations.html">Bucket Aggregations</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="significant-text-aggregation-usage.html">« Significant Text Aggregation Usage</a>
</span>
<span class="next">
<a href="pipeline-aggregations.html">Pipeline Aggregations »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="terms-aggregation-usage"></a>Terms Aggregation Usage<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch-net/edit/6.x/docs/aggregations/bucket/terms/terms-aggregation-usage.asciidoc">edit</a></h2>
</div></div></div>
<p>A multi-bucket value source based aggregation where buckets are dynamically built - one per unique value.</p>
<p>See the Elasticsearch documentation on <a href="/guide/en/elasticsearch/reference/6.8/search-aggregations-bucket-terms-aggregation.html" class="ulink" target="_top">terms aggregation</a> for more detail.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_fluent_dsl_example_145"></a>Fluent DSL example<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch-net/edit/6.x/docs/aggregations/bucket/terms/terms-aggregation-usage.asciidoc">edit</a></h3>
</div></div></div>
<div class="pre_wrapper lang-csharp">
<pre class="programlisting prettyprint lang-csharp">a =&gt; a
.Terms("states", st =&gt; st
    .Field(p =&gt; p.State)
    .MinimumDocumentCount(2)
    .Size(5)
    .ShardSize(100)
    .ExecutionHint(TermsAggregationExecutionHint.Map)
    .Missing("n/a")
    .Script(ss =&gt; ss.Source("'State of Being: '+_value"))
    .Order(o =&gt; o
        .KeyAscending()
        .CountDescending()
    )
    .Meta(m =&gt; m
        .Add("foo", "bar")
    )
)</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_object_initializer_syntax_example_145"></a>Object Initializer syntax example<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch-net/edit/6.x/docs/aggregations/bucket/terms/terms-aggregation-usage.asciidoc">edit</a></h3>
</div></div></div>
<div class="pre_wrapper lang-csharp">
<pre class="programlisting prettyprint lang-csharp">new TermsAggregation("states")
{
    Field = Field&lt;Project&gt;(p =&gt; p.State),
    MinimumDocumentCount = 2,
    Size = 5,
    ShardSize = 100,
    ExecutionHint = TermsAggregationExecutionHint.Map,
    Missing = "n/a",
    Script = new InlineScript("'State of Being: '+_value"),
    Order = new List&lt;TermsOrder&gt;
    {
        TermsOrder.KeyAscending,
        TermsOrder.CountDescending
    },
    Meta = new Dictionary&lt;string, object&gt;
    {
        { "foo", "bar" }
    }
}</pre>
</div>
<p><strong>Example json output.</strong></p>
<div class="pre_wrapper lang-javascript">
<pre class="programlisting prettyprint lang-javascript">{
  "states": {
    "meta": {
      "foo": "bar"
    },
    "terms": {
      "field": "state",
      "min_doc_count": 2,
      "size": 5,
      "shard_size": 100,
      "execution_hint": "map",
      "missing": "n/a",
      "script": {
        "source": "'State of Being: '+_value"
      },
      "order": [
        {
          "_key": "asc"
        },
        {
          "_count": "desc"
        }
      ]
    }
  }
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_handling_responses_58"></a>Handling Responses<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch-net/edit/6.x/docs/aggregations/bucket/terms/terms-aggregation-usage.asciidoc">edit</a></h3>
</div></div></div>
<div class="pre_wrapper lang-csharp">
<pre class="programlisting prettyprint lang-csharp">response.ShouldBeValid();
var states = response.Aggregations.Terms("states");
states.Should().NotBeNull();
states.DocCountErrorUpperBound.Should().HaveValue();
states.SumOtherDocCount.Should().HaveValue();
states.Buckets.Should().NotBeNull();
states.Buckets.Count.Should().BeGreaterThan(0);
foreach (var item in states.Buckets)
{
    item.Key.Should().NotBeNullOrEmpty();
    item.DocCount.Should().BeGreaterOrEqualTo(1);
}
states.Meta.Should().NotBeNull().And.HaveCount(1);
states.Meta["foo"].Should().Be("bar");</pre>
</div>
<h2><a id="terms-pattern-filter"></a>Filtering with a regular expression pattern<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch-net/edit/6.x/docs/aggregations/bucket/terms/terms-aggregation-usage.asciidoc">edit</a></h2>
<p>Using terms aggregation with filtering to include values using a regular expression pattern</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_fluent_dsl_example_146"></a>Fluent DSL example<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch-net/edit/6.x/docs/aggregations/bucket/terms/terms-aggregation-usage.asciidoc">edit</a></h3>
</div></div></div>
<div class="pre_wrapper lang-csharp">
<pre class="programlisting prettyprint lang-csharp">a =&gt; a
.Terms("states", st =&gt; st
    .Field(p =&gt; p.State.Suffix("keyword"))
    .MinimumDocumentCount(2)
    .Size(5)
    .ShardSize(100)
    .ExecutionHint(TermsAggregationExecutionHint.Map)
    .Missing("n/a")
    .Include("(Stable|VeryActive)")
    .Order(o =&gt; o
        .KeyAscending()
        .CountDescending()
    )
    .Meta(m =&gt; m
        .Add("foo", "bar")
    )
)</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_object_initializer_syntax_example_146"></a>Object Initializer syntax example<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch-net/edit/6.x/docs/aggregations/bucket/terms/terms-aggregation-usage.asciidoc">edit</a></h3>
</div></div></div>
<div class="pre_wrapper lang-csharp">
<pre class="programlisting prettyprint lang-csharp">new TermsAggregation("states")
{
    Field = Field&lt;Project&gt;(p =&gt; p.State.Suffix("keyword")),
    MinimumDocumentCount = 2,
    Size = 5,
    ShardSize = 100,
    ExecutionHint = TermsAggregationExecutionHint.Map,
    Missing = "n/a",
    Include = new TermsInclude("(Stable|VeryActive)"),
    Order = new List&lt;TermsOrder&gt;
    {
        TermsOrder.KeyAscending,
        TermsOrder.CountDescending
    },
    Meta = new Dictionary&lt;string, object&gt;
    {
        { "foo", "bar" }
    }
}</pre>
</div>
<p><strong>Example json output.</strong></p>
<div class="pre_wrapper lang-javascript">
<pre class="programlisting prettyprint lang-javascript">{
  "states": {
    "meta": {
      "foo": "bar"
    },
    "terms": {
      "field": "state.keyword",
      "min_doc_count": 2,
      "size": 5,
      "shard_size": 100,
      "execution_hint": "map",
      "missing": "n/a",
      "include": "(Stable|VeryActive)",
      "order": [
        {
          "_key": "asc"
        },
        {
          "_count": "desc"
        }
      ]
    }
  }
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_handling_responses_59"></a>Handling Responses<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch-net/edit/6.x/docs/aggregations/bucket/terms/terms-aggregation-usage.asciidoc">edit</a></h3>
</div></div></div>
<div class="pre_wrapper lang-csharp">
<pre class="programlisting prettyprint lang-csharp">response.ShouldBeValid();
var states = response.Aggregations.Terms&lt;StateOfBeing&gt;("states");
states.Should().NotBeNull();
states.DocCountErrorUpperBound.Should().HaveValue();
states.SumOtherDocCount.Should().HaveValue();
states.Buckets.Should().NotBeNull();
states.Buckets.Count.Should().BeGreaterThan(0);
foreach (var item in states.Buckets)
{
    item.Key.Should().BeOfType&lt;StateOfBeing&gt;();
    item.DocCount.Should().BeGreaterOrEqualTo(1);
}
states.Meta.Should().NotBeNull().And.HaveCount(1);
states.Meta["foo"].Should().Be("bar");</pre>
</div>
<h2><a id="terms-exact-value-filter"></a>Filtering with exact values<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch-net/edit/6.x/docs/aggregations/bucket/terms/terms-aggregation-usage.asciidoc">edit</a></h2>
<p>Using terms aggregation with filtering to include only specific values</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_fluent_dsl_example_147"></a>Fluent DSL example<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch-net/edit/6.x/docs/aggregations/bucket/terms/terms-aggregation-usage.asciidoc">edit</a></h3>
</div></div></div>
<div class="pre_wrapper lang-csharp">
<pre class="programlisting prettyprint lang-csharp">a =&gt; a
.Terms("states", st =&gt; st
    .Field(p =&gt; p.State.Suffix("keyword"))
    .MinimumDocumentCount(2)
    .Size(5)
    .ShardSize(100)
    .ExecutionHint(TermsAggregationExecutionHint.Map)
    .Missing("n/a")
    .Include(new[] { StateOfBeing.Stable.ToString(), StateOfBeing.VeryActive.ToString() })
    .Order(o =&gt; o
        .KeyAscending()
        .CountDescending()
    )
    .Meta(m =&gt; m
        .Add("foo", "bar")
    )
)</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_object_initializer_syntax_example_147"></a>Object Initializer syntax example<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch-net/edit/6.x/docs/aggregations/bucket/terms/terms-aggregation-usage.asciidoc">edit</a></h3>
</div></div></div>
<div class="pre_wrapper lang-csharp">
<pre class="programlisting prettyprint lang-csharp">new TermsAggregation("states")
{
    Field = Field&lt;Project&gt;(p =&gt; p.State.Suffix("keyword")),
    MinimumDocumentCount = 2,
    Size = 5,
    ShardSize = 100,
    ExecutionHint = TermsAggregationExecutionHint.Map,
    Missing = "n/a",
    Include = new TermsInclude(new[] { StateOfBeing.Stable.ToString(), StateOfBeing.VeryActive.ToString() }),
    Order = new List&lt;TermsOrder&gt;
    {
        TermsOrder.KeyAscending,
        TermsOrder.CountDescending
    },
    Meta = new Dictionary&lt;string, object&gt;
    {
        { "foo", "bar" }
    }
}</pre>
</div>
<p><strong>Example json output.</strong></p>
<div class="pre_wrapper lang-javascript">
<pre class="programlisting prettyprint lang-javascript">{
  "states": {
    "meta": {
      "foo": "bar"
    },
    "terms": {
      "field": "state.keyword",
      "min_doc_count": 2,
      "size": 5,
      "shard_size": 100,
      "execution_hint": "map",
      "missing": "n/a",
      "include": [
        "Stable",
        "VeryActive"
      ],
      "order": [
        {
          "_key": "asc"
        },
        {
          "_count": "desc"
        }
      ]
    }
  }
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_handling_responses_60"></a>Handling Responses<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch-net/edit/6.x/docs/aggregations/bucket/terms/terms-aggregation-usage.asciidoc">edit</a></h3>
</div></div></div>
<div class="pre_wrapper lang-csharp">
<pre class="programlisting prettyprint lang-csharp">response.ShouldBeValid();
var states = response.Aggregations.Terms("states");
states.Should().NotBeNull();
states.DocCountErrorUpperBound.Should().HaveValue();
states.SumOtherDocCount.Should().HaveValue();
states.Buckets.Should().NotBeNull();
states.Buckets.Count.Should().BeGreaterThan(0);
foreach (var item in states.Buckets)
{
    item.Key.Should().NotBeNullOrEmpty();
    item.DocCount.Should().BeGreaterOrEqualTo(1);
}
states.Meta.Should().NotBeNull().And.HaveCount(1);
states.Meta["foo"].Should().Be("bar");</pre>
</div>
<h2><a id="_filtering_with_partitions"></a>Filtering with partitions<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch-net/edit/6.x/docs/aggregations/bucket/terms/terms-aggregation-usage.asciidoc">edit</a></h2>
<p>A terms aggregation that uses partitioning to filter the terms that are returned in the response. Further terms
can be returned by issuing additional requests with an incrementing <code class="literal">partition</code> number.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Partitioning is available only in Elasticsearch 5.2.0+</p>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_fluent_dsl_example_148"></a>Fluent DSL example<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch-net/edit/6.x/docs/aggregations/bucket/terms/terms-aggregation-usage.asciidoc">edit</a></h3>
</div></div></div>
<div class="pre_wrapper lang-csharp">
<pre class="programlisting prettyprint lang-csharp">a =&gt; a
.Terms("commits", st =&gt; st
    .Field(p =&gt; p.NumberOfCommits)
    .Include(0, 10)
    .Size(5)
)</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_object_initializer_syntax_example_148"></a>Object Initializer syntax example<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch-net/edit/6.x/docs/aggregations/bucket/terms/terms-aggregation-usage.asciidoc">edit</a></h3>
</div></div></div>
<div class="pre_wrapper lang-csharp">
<pre class="programlisting prettyprint lang-csharp">new TermsAggregation("commits")
{
    Field = Field&lt;Project&gt;(p =&gt; p.NumberOfCommits),
    Include = new TermsInclude(0, 10),
    Size = 5
}</pre>
</div>
<p><strong>Example json output.</strong></p>
<div class="pre_wrapper lang-javascript">
<pre class="programlisting prettyprint lang-javascript">{
  "commits": {
    "terms": {
      "field": "numberOfCommits",
      "size": 5,
      "include": {
        "partition": 0,
        "num_partitions": 10
      }
    }
  }
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_handling_responses_61"></a>Handling Responses<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch-net/edit/6.x/docs/aggregations/bucket/terms/terms-aggregation-usage.asciidoc">edit</a></h3>
</div></div></div>
<div class="pre_wrapper lang-csharp">
<pre class="programlisting prettyprint lang-csharp">response.ShouldBeValid();
var commits = response.Aggregations.Terms&lt;int&gt;("commits");
commits.Should().NotBeNull();
commits.DocCountErrorUpperBound.Should().HaveValue();
commits.SumOtherDocCount.Should().HaveValue();
commits.Buckets.Should().NotBeNull();
commits.Buckets.Count.Should().BeGreaterThan(0);
foreach (var item in commits.Buckets)
{
    item.Key.Should().BeGreaterThan(0);
    item.DocCount.Should().BeGreaterOrEqualTo(1);
}</pre>
</div>
<h2><a id="_numeric_fields"></a>Numeric fields<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch-net/edit/6.x/docs/aggregations/bucket/terms/terms-aggregation-usage.asciidoc">edit</a></h2>
<p>A terms aggregation on a numeric field</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_fluent_dsl_example_149"></a>Fluent DSL example<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch-net/edit/6.x/docs/aggregations/bucket/terms/terms-aggregation-usage.asciidoc">edit</a></h3>
</div></div></div>
<div class="pre_wrapper lang-csharp">
<pre class="programlisting prettyprint lang-csharp">a =&gt; a
.Terms("commits", st =&gt; st
    .Field(p =&gt; p.NumberOfCommits)
    .Missing(-1)
    .ShowTermDocCountError()
)</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_object_initializer_syntax_example_149"></a>Object Initializer syntax example<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch-net/edit/6.x/docs/aggregations/bucket/terms/terms-aggregation-usage.asciidoc">edit</a></h3>
</div></div></div>
<div class="pre_wrapper lang-csharp">
<pre class="programlisting prettyprint lang-csharp">new TermsAggregation("commits")
{
    Field = Field&lt;Project&gt;(p =&gt; p.NumberOfCommits),
    ShowTermDocCountError = true,
    Missing = -1
}</pre>
</div>
<p><strong>Example json output.</strong></p>
<div class="pre_wrapper lang-javascript">
<pre class="programlisting prettyprint lang-javascript">{
  "commits": {
    "terms": {
      "field": "numberOfCommits",
      "missing": -1,
      "show_term_doc_count_error": true
    }
  }
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_handling_responses_62"></a>Handling Responses<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch-net/edit/6.x/docs/aggregations/bucket/terms/terms-aggregation-usage.asciidoc">edit</a></h3>
</div></div></div>
<div class="pre_wrapper lang-csharp">
<pre class="programlisting prettyprint lang-csharp">response.ShouldBeValid();
var commits = response.Aggregations.Terms&lt;int&gt;("commits");
commits.Should().NotBeNull();
commits.DocCountErrorUpperBound.Should().HaveValue();
commits.SumOtherDocCount.Should().HaveValue();
commits.Buckets.Should().NotBeNull();
commits.Buckets.Count.Should().BeGreaterThan(0);
foreach (var item in commits.Buckets)
{
    item.Key.Should().BeGreaterThan(0);
    item.DocCount.Should().BeGreaterOrEqualTo(1);
}
commits.Buckets.Should().Contain(b =&gt; b.DocCountErrorUpperBound.HasValue);</pre>
</div>
<h2><a id="_nested_terms_aggregations"></a>Nested terms aggregations<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch-net/edit/6.x/docs/aggregations/bucket/terms/terms-aggregation-usage.asciidoc">edit</a></h2>
<p>A terms aggregation returns buckets that can contain more aggregations</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_fluent_dsl_example_150"></a>Fluent DSL example<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch-net/edit/6.x/docs/aggregations/bucket/terms/terms-aggregation-usage.asciidoc">edit</a></h3>
</div></div></div>
<div class="pre_wrapper lang-csharp">
<pre class="programlisting prettyprint lang-csharp">a =&gt; a
.Terms("commits", st =&gt; st
    .Field(p =&gt; p.NumberOfCommits)
    .Aggregations(aggs =&gt; aggs
        .Terms("state", t =&gt; t
            .Meta(m =&gt; m.Add("x", "y"))
            .Field(p =&gt; p.State)
        )
    )
)</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_object_initializer_syntax_example_150"></a>Object Initializer syntax example<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch-net/edit/6.x/docs/aggregations/bucket/terms/terms-aggregation-usage.asciidoc">edit</a></h3>
</div></div></div>
<div class="pre_wrapper lang-csharp">
<pre class="programlisting prettyprint lang-csharp">new TermsAggregation("commits")
{
    Field = Field&lt;Project&gt;(p =&gt; p.NumberOfCommits),
    Aggregations = new TermsAggregation("state")
    {
        Meta = new Dictionary&lt;string, object&gt; { { "x", "y" } },
        Field = Field&lt;Project&gt;(p =&gt; p.State),
    }
}</pre>
</div>
<p><strong>Example json output.</strong></p>
<div class="pre_wrapper lang-javascript">
<pre class="programlisting prettyprint lang-javascript">{
  "commits": {
    "terms": {
      "field": "numberOfCommits"
    },
    "aggs": {
      "state": {
        "meta": {
          "x": "y"
        },
        "terms": {
          "field": "state"
        }
      }
    }
  }
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_handling_responses_63"></a>Handling Responses<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch-net/edit/6.x/docs/aggregations/bucket/terms/terms-aggregation-usage.asciidoc">edit</a></h3>
</div></div></div>
<div class="pre_wrapper lang-csharp">
<pre class="programlisting prettyprint lang-csharp">response.ShouldBeValid();
var commits = response.Aggregations.Terms&lt;int&gt;("commits");
commits.Should().NotBeNull();
commits.DocCountErrorUpperBound.Should().HaveValue();
commits.SumOtherDocCount.Should().HaveValue();
commits.Buckets.Should().NotBeNull();
commits.Buckets.Count.Should().BeGreaterThan(0);
foreach (var item in commits.Buckets)
{
    item.Key.Should().BeGreaterThan(0);
    item.DocCount.Should().BeGreaterOrEqualTo(1);
    var states = item.Terms("state");
    states.Should().NotBeNull();
    states.Buckets.Should().NotBeEmpty();
    states.Meta.Should().NotBeEmpty("meta").And.ContainKey("x");
    foreach (var b in states.Buckets)
    {
        b.DocCount.Should().BeGreaterThan(0);
        b.Key.Should().NotBeNullOrEmpty();
    }
}</pre>
</div>
<h2><a id="_typed_keys_aggregations"></a>Typed Keys aggregations<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch-net/edit/6.x/docs/aggregations/bucket/terms/terms-aggregation-usage.asciidoc">edit</a></h2>
<p>Starting with Elasticsearch 6.x you can provide a <code class="literal">typed_keys</code> parameter which will prefix all the aggregation names
with the type of aggregation that is returned. The following modifies the previous nested terms aggregation and sends it again
but this time with the <code class="literal">typed_keys</code> option set. The client should treat this in a an opaque fashion so let&#8217;s assert that it does.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_fluent_dsl_example_151"></a>Fluent DSL example<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch-net/edit/6.x/docs/aggregations/bucket/terms/terms-aggregation-usage.asciidoc">edit</a></h3>
</div></div></div>
<div class="pre_wrapper lang-csharp">
<pre class="programlisting prettyprint lang-csharp">f =&gt; base.Fluent(f.TypedKeys())</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_object_initializer_syntax_example_151"></a>Object Initializer syntax example<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch-net/edit/6.x/docs/aggregations/bucket/terms/terms-aggregation-usage.asciidoc">edit</a></h3>
</div></div></div>
<div class="pre_wrapper lang-csharp">
<pre class="programlisting prettyprint lang-csharp">var r = base.Initializer;
r.TypedKeys = true;
return r;</pre>
</div>
</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="significant-text-aggregation-usage.html">« Significant Text Aggregation Usage</a>
</span>
<span class="next">
<a href="pipeline-aggregations.html">Pipeline Aggregations »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
