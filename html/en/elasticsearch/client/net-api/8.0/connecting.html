<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Connecting | Elasticsearch .NET Client [8.0] | Elastic</title>
<link rel="home" href="index.html" title="Elasticsearch .NET Client [8.0]"/>
<link rel="up" href="index.html" title="Elasticsearch .NET Client [8.0]"/>
<link rel="prev" href="installation.html" title="Installation"/>
<link rel="next" href="configuration.html" title="Configuration"/>
<meta name="DC.type" content="Learn/Docs/Clients/.Net/8.0"/>
<meta name="DC.subject" content="Clients"/>
<meta name="DC.identifier" content="8.0"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <!--© 2015-2022 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!--BEGIN QUALTRICS WEBSITE FEEDBACK SNIPPET-->
    <script type='text/javascript'>
      (function(){var g=function(e,h,f,g){
      this.get=function(a){for(var a=a+"=",c=document.cookie.split(";"),b=0,e=c.length;b<e;b++){for(var d=c[b];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return null};
      this.set=function(a,c){var b="",b=new Date;b.setTime(b.getTime()+6048E5);b="; expires="+b.toGMTString();document.cookie=a+"="+c+b+"; path=/; "};
      this.check=function(){var a=this.get(f);if(a)a=a.split(":");else if(100!=e)"v"==h&&(e=Math.random()>=e/100?0:100),a=[h,e,0],this.set(f,a.join(":"));else return!0;var c=a[1];if(100==c)return!0;switch(a[0]){case "v":return!1;case "r":return c=a[2]%Math.floor(100/c),a[2]++,this.set(f,a.join(":")),!c}return!0};
      this.go=function(){if(this.check()){var a=document.createElement("script");a.type="text/javascript";a.src=g;document.body&&document.body.appendChild(a)}};
      this.start=function(){var a=this;window.addEventListener?window.addEventListener("load",function(){a.go()},!1):window.attachEvent&&window.attachEvent("onload",function(){a.go()})}};
      try{(new g(100,"r","QSI_S_ZN_emkP0oSe9Qrn7kF","https://znemkp0ose9qrn7kf-elastic.siteintercept.qualtrics.com/WRSiteInterceptEngine/?Q_ZID=ZN_emkP0oSe9Qrn7kF")).start()}catch(i){}})();
    </script><div id='ZN_emkP0oSe9Qrn7kF'><!--DO NOT REMOVE-CONTENTS PLACED HERE--></div>
    <!--END WEBSITE FEEDBACK SNIPPET-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  <div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="index.html">Elasticsearch .NET Client [8.0]</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="installation.html">« Installation</a>
</span>
<span class="next">
<a href="configuration.html">Configuration »</a>
</span>
</div>
<div class="chapter">
<div class="titlepage"><div><div>
<h1 class="title"><a id="connecting"></a>Connecting<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch-net/edit/8.0/docs/connecting.asciidoc">edit</a></h1>
</div></div></div>
<p>This page contains the information you need to create an instance of the .NET
Client for Elasticsearch that connects to your Elasticsearch cluster.</p>
<p>It&#8217;s possible to connect to your Elasticsearch cluster via a single node, or by
specifying multiple nodes using a node pool. Using a node pool has a few
advantages over a single node, such as load balancing and cluster failover
support. The client provides convenient configuration options to connect to an
Elastic Cloud deployment.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Client applications should create a single instance of
<code class="literal">ElasticsearchClient</code> that is used throughout your application for its entire
lifetime. Internally the client manages and maintains HTTP connections to nodes,
reusing them to optimize performance. If you use a dependency injection
container for your application, the client instance should be registered with a
singleton lifetime.</p>
</div>
</div>
<h3><a id="cloud-deployment"></a>Connecting to a cloud deployment<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch-net/edit/8.0/docs/connecting.asciidoc">edit</a></h3>
<p><a href="/guide/en/cloud/current/ec-getting-started.html" class="ulink" target="_top">Elastic Cloud</a>
is the easiest way to get started with Elasticsearch. When connecting to Elastic Cloud
with the .NET Elasticsearch client you should always use the Cloud ID. You can find this
value within the "Manage Deployment" page after you&#8217;ve created a cluster
(look in the top-left if you&#8217;re in Kibana).</p>
<p>We recommend using a Cloud ID whenever possible because your client will be
automatically configured for optimal use with Elastic Cloud, including HTTPS and
HTTP compression.</p>
<p>Connecting to an Elasticsearch Service deployment is achieved by providing the
unique Cloud ID for your deployment when configuring the <code class="literal">ElasticsearchClient</code>
instance. You also require suitable credentials, either a username and password or
an API key that your application uses to authenticate with your deployment.</p>
<p>As a security best practice, it is recommended to create a dedicated API key per
application, with permissions limited to only those required for any API calls
the application is authorized to make.</p>
<p>The following snippet demonstrates how to create a client instance that connects to
an Elasticsearch deployment in the cloud.</p>
<div class="pre_wrapper lang-csharp">
<pre class="programlisting prettyprint lang-csharp">using Elastic.Clients.Elasticsearch;
using Elastic.Transport;

var client = new ElasticsearchClient("&lt;CLOUD_ID&gt;", new ApiKey("&lt;API_KEY&gt;")); <a id="CO1-1"></a><i class="conum" data-value="1"></i></pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO1-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Replace the placeholder string values above with your cloud ID and the API key
configured for your application to access your deployment.</p>
</td>
</tr>
</table>
</div>
<h3><a id="single-node"></a>Connecting to a single node<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch-net/edit/8.0/docs/connecting.asciidoc">edit</a></h3>
<p>Single node configuration is best suited to connections to a multi-node cluster
running behind a load balancer or reverse proxy, which is exposed via a single
URL. It may also be convenient to use a single node during local application
development. If the URL represents a single Elasticsearch node, be aware that this offers
no resiliency should the server be unreachable or unresponsive.</p>
<p>By default, security features such as authentication and TLS are enabled on Elasticsearch
clusters. When you start Elasticsearch for the first time, TLS is configured
automatically for the HTTP layer. A CA certificate is generated and stored on
disk which is used to sign the certificates for the HTTP layer of the Elasticsearch
cluster.</p>
<p>In order for the client to establish a connection with the cluster over HTTPS,
the CA certificate must be trusted by the client application. There are several
mechanisms for <a class="xref" href="working-with-certificates.html" title="Working with certificates">working with certificates</a>, but the
simplest choice is to use the hex-encoded SHA-256 fingerprint of the CA
certificate. The CA fingerprint is output to the terminal when you start Elasticsearch
for the first time. You&#8217;ll see a distinct block like the one
below in the output from Elasticsearch (you may have to scroll up if it&#8217;s been a while):</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">----------------------------------------------------------------
-&gt; Elasticsearch security features have been automatically configured!
-&gt; Authentication is enabled and cluster connections are encrypted.

-&gt;  Password for the elastic user (reset with `bin/elasticsearch-reset-password -u elastic`):
  lhQpLELkjkrawaBoaz0Q

-&gt;  HTTP CA certificate SHA-256 fingerprint:
  a52dd93511e8c6045e21f16654b77c9ee0f34aea26d9f40320b531c474676228
...
----------------------------------------------------------------</pre>
</div>
<p>Note down the <code class="literal">elastic</code> user password and HTTP CA fingerprint for the next
sections.</p>
<p>The CA fingerprint can also be retrieved at any time from a running cluster using
the following command:</p>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">openssl x509 -fingerprint -sha256 -in config/certs/http_ca.crt</pre>
</div>
<p>The command returns the security certificate, including the fingerprint. The
<code class="literal">issuer</code> should be <code class="literal">Elasticsearch security auto-configuration HTTP CA</code>.</p>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">issuer= /CN=Elasticsearch security auto-configuration HTTP CA
SHA256 Fingerprint=&lt;FINGERPRINT&gt;</pre>
</div>
<p>Visit the
<a href="/guide/en/elasticsearch/reference/master/configuring-stack-security.html" class="ulink" target="_top">Connect clients to Elasticsearch</a> documentation for more information.</p>
<p>The following snippet shows you how to create a client instance that connects to
your Elasticsearch cluster via a single node, using the CA fingerprint:</p>
<div class="pre_wrapper lang-csharp">
<pre class="programlisting prettyprint lang-csharp">using Elastic.Clients.Elasticsearch;
using Elastic.Transport;

var settings = new ElasticsearchClientSettings(new Uri("https://localhost:9200"))
    .CertificateFingerprint("&lt;FINGERPRINT&gt;")
    .Authentication(new BasicAuthentication("&lt;USERNAME&gt;", "&lt;PASSWORD&gt;"));

var client = new ElasticsearchClient(settings);</pre>
</div>
<p>The preceding snippet demonstrates configuring the client to authenticate by
providing a username and password with basic authentication. If preferred, you
may also use <code class="literal">ApiKey</code> authentication as shown in the cloud connection example.</p>
<h3><a id="multiple-nodes"></a>Connecting to multiple nodes using a node pool<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch-net/edit/8.0/docs/connecting.asciidoc">edit</a></h3>
<p>To provide resiliency, you should configure multiple nodes for your cluster to
which the client attempts to communicate. By default, the client cycles through
nodes for each request in a round robin fashion. The client also tracks
unhealthy nodes and avoids sending requests to them until they become healthy.</p>
<p>This configuration is best suited to connect to a known small sized cluster,
where you do not require sniffing to detect the cluster topology. Refer to the
<a class="xref" href="connection-pooling.html" title="Connection pools">node pool documentation</a> for more information about the
types of node pool available in the Elasticsearch .NET client.</p>
<p>The following snippet shows you how to connect to multiple nodes by using a
static node pool:</p>
<div class="pre_wrapper lang-csharp">
<pre class="programlisting prettyprint lang-csharp">using Elastic.Clients.Elasticsearch;
using Elastic.Transport;

var nodes = new Uri[]
{
	new Uri("https://myserver1:9200"),
	new Uri("https://myserver2:9200"),
	new Uri("https://myserver3:9200")
};

var pool = new StaticNodePool(nodes);

var settings = new ElasticsearchClientSettings(pool)
    .CertificateFingerprint("&lt;FINGERPRINT&gt;")
    .Authentication(new ApiKey("&lt;API_KEY&gt;"));

var client = new ElasticsearchClient(settings);</pre>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="installation.html">« Installation</a>
</span>
<span class="next">
<a href="configuration.html">Configuration »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
