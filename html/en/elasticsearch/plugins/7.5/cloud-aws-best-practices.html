<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Best Practices in AWS | Elasticsearch Plugins and Integrations [7.5] | Elastic</title>
<link rel="home" href="index.html" title="Elasticsearch Plugins and Integrations [7.5]"/>
<link rel="up" href="discovery-ec2.html" title="EC2 Discovery Plugin"/>
<link rel="prev" href="discovery-ec2-usage.html" title="Using the EC2 discovery plugin"/>
<link rel="next" href="discovery-azure-classic.html" title="Azure Classic Discovery Plugin"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Plugins/7.5"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="7.5"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!--BEGIN QUALTRICS WEBSITE FEEDBACK SNIPPET-->
    <script type='text/javascript'>
      (function(){var g=function(e,h,f,g){
      this.get=function(a){for(var a=a+"=",c=document.cookie.split(";"),b=0,e=c.length;b<e;b++){for(var d=c[b];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return null};
      this.set=function(a,c){var b="",b=new Date;b.setTime(b.getTime()+6048E5);b="; expires="+b.toGMTString();document.cookie=a+"="+c+b+"; path=/; "};
      this.check=function(){var a=this.get(f);if(a)a=a.split(":");else if(100!=e)"v"==h&&(e=Math.random()>=e/100?0:100),a=[h,e,0],this.set(f,a.join(":"));else return!0;var c=a[1];if(100==c)return!0;switch(a[0]){case "v":return!1;case "r":return c=a[2]%Math.floor(100/c),a[2]++,this.set(f,a.join(":")),!c}return!0};
      this.go=function(){if(this.check()){var a=document.createElement("script");a.type="text/javascript";a.src=g;document.body&&document.body.appendChild(a)}};
      this.start=function(){var a=this;window.addEventListener?window.addEventListener("load",function(){a.go()},!1):window.attachEvent&&window.attachEvent("onload",function(){a.go()})}};
      try{(new g(100,"r","QSI_S_ZN_emkP0oSe9Qrn7kF","https://znemkp0ose9qrn7kf-elastic.siteintercept.qualtrics.com/WRSiteInterceptEngine/?Q_ZID=ZN_emkP0oSe9Qrn7kF")).start()}catch(i){}})();
    </script><div id='ZN_emkP0oSe9Qrn7kF'><!--DO NOT REMOVE-CONTENTS PLACED HERE--></div>
    <!--END WEBSITE FEEDBACK SNIPPET-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <!-- Subnav -->
    <div>
      <div>
        <div class="tertiary-nav d-none d-md-block">
          <div class="container">
            <div class="p-t-b-15 d-flex justify-content-between nav-container">
              <div class="breadcrum-wrapper"><span><a href="/guide/" style="font-size: 14px; font-weight: 600; color: #000;">Docs</a></span></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container">
              <div class="row">
                <div class="col-xs-12 col-sm-8 col-md-8 guide-section">
                  <!-- start body -->
                  <div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Elasticsearch Plugins and Integrations [7.5]</a></span>
»
<span class="breadcrumb-link"><a href="discovery.html">Discovery Plugins</a></span>
»
<span class="breadcrumb-link"><a href="discovery-ec2.html">EC2 Discovery Plugin</a></span>
»
<span class="breadcrumb-node">Best Practices in AWS</span>
</div>
<div class="navheader">
<span class="prev">
<a href="discovery-ec2-usage.html">« Using the EC2 discovery plugin</a>
</span>
<span class="next">
<a href="discovery-azure-classic.html">Azure Classic Discovery Plugin »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="cloud-aws-best-practices"></a>Best Practices in AWS<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/7.5/docs/plugins/discovery-ec2.asciidoc">edit</a></h3>
</div></div></div>
<p>This section contains some other information about designing and managing an
Elasticsearch cluster on your own AWS infrastructure. If you would prefer to avoid these
operational details then you may be interested in a hosted Elasticsearch installation
available on AWS-based infrastructure from <a href="http://www.elastic.co/cloud" class="ulink" target="_top">http://www.elastic.co/cloud</a>.</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_storage"></a>Storage<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/7.5/docs/plugins/discovery-ec2.asciidoc">edit</a></h4>
</div></div></div>
<p>EC2 instances offer a number of different kinds of storage. Please be aware of
the following when selecting the storage for your cluster:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/InstanceStorage.html" class="ulink" target="_top">Instance
Store</a> is recommended for Elasticsearch clusters as it offers excellent performance and
is cheaper than EBS-based storage. Elasticsearch is designed to work well with this kind
of ephemeral storage because it replicates each shard across multiple nodes. If
a node fails and its Instance Store is lost then Elasticsearch will rebuild any lost
shards from other copies.
</li>
<li class="listitem">
<a href="https://aws.amazon.com/ebs/" class="ulink" target="_top">EBS-based storage</a> may be acceptable
for smaller clusters (1-2 nodes). Be sure to use provisioned IOPS to ensure
your cluster has satisfactory performance.
</li>
<li class="listitem">
<a href="https://aws.amazon.com/efs/" class="ulink" target="_top">EFS-based storage</a> is not
recommended or supported as it does not offer satisfactory performance.
Historically, shared network filesystems such as EFS have not always offered
precisely the behaviour that Elasticsearch requires of its filesystem, and this has been
known to lead to index corruption. Although EFS offers durability, shared
storage, and the ability to grow and shrink filesystems dynamically, you can
achieve the same benefits using Elasticsearch directly.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_choice_of_ami"></a>Choice of AMI<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/7.5/docs/plugins/discovery-ec2.asciidoc">edit</a></h4>
</div></div></div>
<p>Prefer the <a href="https://aws.amazon.com/amazon-linux-ami/" class="ulink" target="_top">Amazon Linux AMIs</a> as these
allow you to benefit from the lightweight nature, support, and EC2-specific
performance enhancements that these images offer.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_networking"></a>Networking<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/7.5/docs/plugins/discovery-ec2.asciidoc">edit</a></h4>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Smaller instance types have limited network performance, in terms of both
<a href="https://lab.getbase.com/how-we-discovered-limitations-on-the-aws-tcp-stack/" class="ulink" target="_top">bandwidth
and number of connections</a>. If networking is a bottleneck, avoid
<a href="https://aws.amazon.com/ec2/instance-types/" class="ulink" target="_top">instance types</a> with networking
labelled as <code class="literal">Moderate</code> or <code class="literal">Low</code>.
</li>
<li class="listitem">
It is a good idea to distribute your nodes across multiple
<a href="http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-regions-availability-zones.html" class="ulink" target="_top">availability
zones</a> and use <a href="/guide/en/elasticsearch/reference/7.5/allocation-awareness.html" class="ulink" target="_top">shard allocation awareness</a> to
ensure that each shard has copies in more than one availability zone.
</li>
<li class="listitem">
Do not span a cluster across regions. Elasticsearch expects that node-to-node
connections within a cluster are reasonably reliable and offer high bandwidth
and low latency, and these properties do not hold for connections between
regions. Although an Elasticsearch cluster will behave correctly when node-to-node
connections are unreliable or slow, it is not optimised for this case and its
performance may suffer. If you wish to geographically distribute your data, you
should provision multiple clusters and use features such as
<a href="/guide/en/elasticsearch/reference/7.5/modules-cross-cluster-search.html" class="ulink" target="_top">cross-cluster search</a> and
<a href="/guide/en/elasticsearch/reference/7.5/xpack-ccr.html" class="ulink" target="_top">cross-cluster replication</a>.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_other_recommendations"></a>Other recommendations<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/7.5/docs/plugins/discovery-ec2.asciidoc">edit</a></h4>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If you have split your nodes into roles, consider
<a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/Using_Tags.html" class="ulink" target="_top">tagging the
EC2 instances</a> by role to make it easier to filter and view your EC2 instances
in the AWS console.
</li>
<li class="listitem">
Consider
<a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/terminating-instances.html#Using_ChangingDisableAPITermination" class="ulink" target="_top">enabling
termination protection</a> for all of your data and master-eligible nodes. This
will help to prevent accidental termination of these nodes which could
temporarily reduce the resilience of the cluster and which could cause a
potentially disruptive reallocation of shards.
</li>
<li class="listitem">
If running your cluster using one or more
<a href="https://docs.aws.amazon.com/autoscaling/ec2/userguide/AutoScalingGroup.html" class="ulink" target="_top">auto-scaling
groups</a>, consider protecting your data and master-eligible nodes
<a href="https://docs.aws.amazon.com/autoscaling/ec2/userguide/as-instance-termination.html#instance-protection-instance" class="ulink" target="_top">against
termination during scale-in</a>. This will help to prevent automatic termination
of these nodes which could temporarily reduce the resilience of the cluster and
which could cause a potentially disruptive reallocation of shards. If these
instances are protected against termination during scale-in then you can use
<a href="/guide/en/elasticsearch/reference/7.5/shard-allocation-filtering.html" class="ulink" target="_top">shard allocation filtering</a> to gracefully
migrate any data off these nodes before terminating them manually.
</li>
</ul>
</div>
</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="discovery-ec2-usage.html">« Using the EC2 discovery plugin</a>
</span>
<span class="next">
<a href="discovery-azure-classic.html">Azure Classic Discovery Plugin »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>
                <div class="col-xs-12 col-sm-4 col-md-4" id="right_col">
                  <div id="rtpcontainer" style="display: block;">
                    <div class="mktg-promo">
                      <h3>Most Popular</h3>
                      <ul class="icons">
                        <li class="icon-elasticsearch-white"><a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">Get Started with Elasticsearch: Video</a></li>
                        <li class="icon-kibana-white"><a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">Intro to Kibana: Video</a></li>
                        <li class="icon-logstash-white"><a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">ELK for Logs & Metrics: Video</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";
	var localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}';
</script>
<script src="/static/js/swiftype_app_search.umd.min.js"></script>
<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
