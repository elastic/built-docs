<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Mapping changes | Elasticsearch Reference [2.1] | Elastic</title>
<link rel="home" href="index.html" title="Elasticsearch Reference [2.1]"/>
<link rel="up" href="breaking-changes-2.0.html" title="Breaking changes in 2.0"/>
<link rel="prev" href="breaking_20_multiple_literal_data_path_literal_striping.html" title="Multiple path.data striping"/>
<link rel="next" href="breaking_20_crud_and_routing_changes.html" title="CRUD and routing changes"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/2.1"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="2.1"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!--BEGIN QUALTRICS WEBSITE FEEDBACK SNIPPET-->
    <script type='text/javascript'>
      (function(){var g=function(e,h,f,g){
      this.get=function(a){for(var a=a+"=",c=document.cookie.split(";"),b=0,e=c.length;b<e;b++){for(var d=c[b];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return null};
      this.set=function(a,c){var b="",b=new Date;b.setTime(b.getTime()+6048E5);b="; expires="+b.toGMTString();document.cookie=a+"="+c+b+"; path=/; "};
      this.check=function(){var a=this.get(f);if(a)a=a.split(":");else if(100!=e)"v"==h&&(e=Math.random()>=e/100?0:100),a=[h,e,0],this.set(f,a.join(":"));else return!0;var c=a[1];if(100==c)return!0;switch(a[0]){case "v":return!1;case "r":return c=a[2]%Math.floor(100/c),a[2]++,this.set(f,a.join(":")),!c}return!0};
      this.go=function(){if(this.check()){var a=document.createElement("script");a.type="text/javascript";a.src=g;document.body&&document.body.appendChild(a)}};
      this.start=function(){var a=this;window.addEventListener?window.addEventListener("load",function(){a.go()},!1):window.attachEvent&&window.attachEvent("onload",function(){a.go()})}};
      try{(new g(100,"r","QSI_S_ZN_emkP0oSe9Qrn7kF","https://znemkp0ose9qrn7kf-elastic.siteintercept.qualtrics.com/WRSiteInterceptEngine/?Q_ZID=ZN_emkP0oSe9Qrn7kF")).start()}catch(i){}})();
    </script><div id='ZN_emkP0oSe9Qrn7kF'><!--DO NOT REMOVE-CONTENTS PLACED HERE--></div>
    <!--END WEBSITE FEEDBACK SNIPPET-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <!-- Subnav -->
    <div>
      <div>
        <div class="tertiary-nav d-none d-md-block">
          <div class="container">
            <div class="p-t-b-15 d-flex justify-content-between nav-container">
              <div class="breadcrum-wrapper"><span><a href="/guide/" style="font-size: 14px; font-weight: 600; color: #000;">Docs</a></span></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container">
              <div class="row">
                <div class="col-xs-12 col-sm-8 col-md-8 guide-section">
                  <!-- start body -->
                  <div class="page_header">
<p>
  <strong>WARNING</strong>: Version 2.1 of Elasticsearch has passed its 
  <a href="https://www.elastic.co/support/eol">EOL date</a>. 
</p>  
<p>
  This documentation is no longer being maintained and may be removed. 
  If you are running this version, we strongly advise you to upgrade. 
  For the latest information, see the 
  <a href="../current/index.html">current release documentation</a>. 
</p>
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Elasticsearch Reference [2.1]</a></span>
»
<span class="breadcrumb-link"><a href="breaking-changes.html">Breaking changes</a></span>
»
<span class="breadcrumb-link"><a href="breaking-changes-2.0.html">Breaking changes in 2.0</a></span>
»
<span class="breadcrumb-node">Mapping changes</span>
</div>
<div class="navheader">
<span class="prev">
<a href="breaking_20_multiple_literal_data_path_literal_striping.html">« Multiple <code class="literal">path.data</code> striping</a>
</span>
<span class="next">
<a href="breaking_20_crud_and_routing_changes.html">CRUD and routing changes »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="breaking_20_mapping_changes"></a>Mapping changes<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/2.1/docs/reference/migration/migrate_2_0/mapping.asciidoc">edit</a></h2>
</div></div></div>
<p>A number of changes have been made to mappings to remove ambiguity and to
ensure that conflicting mappings cannot be created.</p>
<p>One major change is that dynamically added fields must have their mapping
confirmed by the master node before indexing continues.  This is to avoid a
problem where different shards in the same index dynamically add different
mappings for the same field.  These conflicting mappings can silently return
incorrect results and can lead to index corruption.</p>
<p>This change can make indexing slower when frequently adding many new fields.
We are looking at ways of optimising this process but we chose safety over
performance for this extreme use case.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_conflicting_field_mappings"></a>Conflicting field mappings<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/2.1/docs/reference/migration/migrate_2_0/mapping.asciidoc">edit</a></h3>
</div></div></div>
<p>Fields with the same name, in the same index, in different types, must have
the same mapping, with the exception of the <a class="xref" href="copy-to.html" title="copy_to"><code class="literal">copy_to</code></a>, <a class="xref" href="dynamic.html" title="dynamic"><code class="literal">dynamic</code></a>,
<a class="xref" href="enabled.html" title="enabled"><code class="literal">enabled</code></a>, <a class="xref" href="ignore-above.html" title="ignore_above"><code class="literal">ignore_above</code></a>, <a class="xref" href="include-in-all.html" title="include_in_all"><code class="literal">include_in_all</code></a>, and <a class="xref" href="properties.html" title="properties"><code class="literal">properties</code></a>
parameters, which may have different settings per field.</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">PUT my_index
{
  "mappings": {
    "type_one": {
      "properties": {
        "name": { <a id="CO2-1"></a><i class="conum" data-value="1"></i>
          "type": "string"
        }
      }
    },
    "type_two": {
      "properties": {
        "name": { <a id="CO2-2"></a><i class="conum" data-value="1"></i>
          "type":     "string",
          "analyzer": "english"
        }
      }
    }
  }
}</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO2-1"><i class="conum" data-value="1"></i></a><a href="#CO2-2"></a></p>
</td>
<td align="left" valign="top">
<p>The two <code class="literal">name</code> fields have conflicting mappings and will prevent Elasticsearch
from starting.</p>
</td>
</tr>
</table>
</div>
<p>Elasticsearch will not start in the presence of conflicting field mappings.
These indices must be deleted or reindexed using a new mapping.</p>
<p>The <code class="literal">ignore_conflicts</code> option of the put mappings API has been removed.
Conflicts can&#8217;t be ignored anymore.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_fields_cannot_be_referenced_by_short_name"></a>Fields cannot be referenced by short name<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/2.1/docs/reference/migration/migrate_2_0/mapping.asciidoc">edit</a></h3>
</div></div></div>
<p>A field can no longer be referenced using its short name.  Instead, the full
path to the field is required.  For instance:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">PUT my_index
{
  "mappings": {
    "my_type": {
      "properties": {
        "title":     { "type": "string" }, <a id="CO3-1"></a><i class="conum" data-value="1"></i>
        "name": {
          "properties": {
            "title": { "type": "string" }, <a id="CO3-2"></a><i class="conum" data-value="2"></i>
            "first": { "type": "string" },
            "last":  { "type": "string" }
          }
        }
      }
    }
  }
}</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO3-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>This field is referred to as <code class="literal">title</code>.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO3-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>This field is referred to as <code class="literal">name.title</code>.</p>
</td>
</tr>
</table>
</div>
<p>Previously, the two <code class="literal">title</code> fields in the example above could have been
confused with each other when using the short name <code class="literal">title</code>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_type_name_prefix_removed"></a>Type name prefix removed<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/2.1/docs/reference/migration/migrate_2_0/mapping.asciidoc">edit</a></h3>
</div></div></div>
<p>Previously, two fields with the same name in two different types could
sometimes be disambiguated by prepending the type name.  As a side effect, it
would add a filter on the type name to the relevant query.  This feature was
ambiguous&#8201;&#8212;&#8201;a type name could be confused with a field name&#8201;&#8212;&#8201;and didn&#8217;t
work everywhere e.g. aggregations.</p>
<p>Instead, fields should be specified with the full path, but without a type
name prefix.  If you wish to filter by the <code class="literal">_type</code> field, either specify the
type in the URL or add an explicit filter.</p>
<p>The following example query in 1.x:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">GET my_index/_search
{
  "query": {
    "match": {
      "my_type.some_field": "quick brown fox"
    }
  }
}</pre>
</div>
<p>would be rewritten in 2.0 as:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">GET my_index/my_type/_search <a id="CO4-1"></a><i class="conum" data-value="1"></i>
{
  "query": {
    "match": {
      "some_field": "quick brown fox" <a id="CO4-2"></a><i class="conum" data-value="2"></i>
    }
  }
}</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO4-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>The type name can be specified in the URL to act as a filter.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO4-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>The field name should be specified without the type prefix.</p>
</td>
</tr>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_field_names_may_not_contain_dots"></a>Field names may not contain dots<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/2.1/docs/reference/migration/migrate_2_0/mapping.asciidoc">edit</a></h3>
</div></div></div>
<p>In 1.x, it was possible to create fields with dots in their name, for
instance:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">PUT my_index
{
  "mappings": {
    "my_type": {
      "properties": {
        "foo.bar": { <a id="CO5-1"></a><i class="conum" data-value="1"></i>
          "type": "string"
        },
        "foo": {
          "properties": {
            "bar": { <a id="CO5-2"></a><i class="conum" data-value="1"></i>
              "type": "string"
            }
          }
        }
      }
    }
  }
}</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO5-1"><i class="conum" data-value="1"></i></a><a href="#CO5-2"></a></p>
</td>
<td align="left" valign="top">
<p>These two fields cannot be distinguised as both are referred to as <code class="literal">foo.bar</code>.</p>
</td>
</tr>
</table>
</div>
<p>You can no longer create fields with dots in the name.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_type_names_may_not_start_with_a_dot"></a>Type names may not start with a dot<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/2.1/docs/reference/migration/migrate_2_0/mapping.asciidoc">edit</a></h3>
</div></div></div>
<p>In 1.x, Elasticsearch would issue a warning if a type name included a dot,
e.g. <code class="literal">my.type</code>.  Now that type names are no longer used to distinguish between
fields in different types, this warning has been relaxed: type names may now
contain dots, but they may not <span class="strong strong"><strong>begin</strong></span> with a dot.  The only exception to this
is the special <code class="literal">.percolator</code> type.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_type_names_may_not_be_longer_than_255_characters"></a>Type names may not be longer than 255 characters<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/2.1/docs/reference/migration/migrate_2_0/mapping.asciidoc">edit</a></h3>
</div></div></div>
<p>Mapping type names may not be longer than 255 characters.  Long type names
will continue to function on indices created before upgrade, but it will not
be possible create types with long names in new indices.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_types_may_no_longer_be_deleted"></a>Types may no longer be deleted<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/2.1/docs/reference/migration/migrate_2_0/mapping.asciidoc">edit</a></h3>
</div></div></div>
<p>In 1.x it was possible to delete a type mapping, along with all of the
documents of that type, using the delete mapping API.  This is no longer
supported, because remnants of the fields in the type could remain in the
index, causing corruption later on.</p>
<p>Instead, if you need to delete a type mapping, you should reindex to a new
index which does not contain the mapping.  If you just need to delete the
documents that belong to that type, then use the delete-by-query plugin
instead.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="migration-meta-fields"></a>Type meta-fields<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/2.1/docs/reference/migration/migrate_2_0/mapping.asciidoc">edit</a></h3>
</div></div></div>
<p>The <a class="xref" href="mapping-fields.html" title="Meta-Fields">meta-fields</a> associated with had configuration options
removed, to make them more reliable:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">_id</code> configuration can no longer be changed.  If you need to sort, use the <a class="xref" href="mapping-uid-field.html" title="_uid field"><code class="literal">_uid</code></a> field instead.
</li>
<li class="listitem">
<code class="literal">_type</code> configuration can no longer be changed.
</li>
<li class="listitem">
<code class="literal">_index</code> configuration can no longer be changed.
</li>
<li class="listitem">
<code class="literal">_routing</code> configuration is limited to marking routing as required.
</li>
<li class="listitem">
<code class="literal">_field_names</code> configuration is limited to disabling the field.
</li>
<li class="listitem">
<code class="literal">_size</code> configuration is limited to enabling the field.
</li>
<li class="listitem">
<code class="literal">_timestamp</code> configuration is limited to enabling the field, setting format and default value.
</li>
<li class="listitem">
<code class="literal">_boost</code> has been removed.
</li>
<li class="listitem">
<code class="literal">_analyzer</code> has been removed.
</li>
</ul>
</div>
<p>Importantly, <span class="strong strong"><strong>meta-fields can no longer be specified as part of the document
body.</strong></span>  Instead, they must be specified in the query string parameters.  For
instance, in 1.x, the <code class="literal">routing</code> could be specified as follows:</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">PUT my_index
{
  "mappings": {
    "my_type": {
      "_routing": {
        "path": "group" <a id="CO6-1"></a><i class="conum" data-value="1"></i>
      },
      "properties": {
        "group": { <a id="CO6-2"></a><i class="conum" data-value="1"></i>
          "type": "string"
        }
      }
    }
  }
}

PUT my_index/my_type/1 <a id="CO6-3"></a><i class="conum" data-value="2"></i>
{
  "group": "foo"
}</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO6-1"><i class="conum" data-value="1"></i></a><a href="#CO6-2"></a></p>
</td>
<td align="left" valign="top">
<p>This 1.x mapping tells Elasticsearch to extract the <code class="literal">routing</code> value from the <code class="literal">group</code> field in the document body.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO6-3"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>This indexing request uses a <code class="literal">routing</code> value of <code class="literal">foo</code>.</p>
</td>
</tr>
</table>
</div>
<p>In 2.0, the routing must be specified explicitly:</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">PUT my_index
{
  "mappings": {
    "my_type": {
      "_routing": {
        "required": true <a id="CO7-1"></a><i class="conum" data-value="1"></i>
      },
      "properties": {
        "group": {
          "type": "string"
        }
      }
    }
  }
}

PUT my_index/my_type/1?routing=bar <a id="CO7-2"></a><i class="conum" data-value="2"></i>
{
  "group": "foo"
}</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO7-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Routing can be marked as required to ensure it is not forgotten during indexing.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO7-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>This indexing request uses a <code class="literal">routing</code> value of <code class="literal">bar</code>.</p>
</td>
</tr>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_literal__timestamp_literal_and_literal__ttl_literal_deprecated"></a><code class="literal">_timestamp</code> and <code class="literal">_ttl</code> deprecated<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/2.1/docs/reference/migration/migrate_2_0/mapping.asciidoc">edit</a></h3>
</div></div></div>
<p>The <code class="literal">_timestamp</code> and <code class="literal">_ttl</code> fields are deprecated, but will remain functional
for the remainder of the 2.x series.</p>
<p>Instead of the <code class="literal">_timestamp</code> field, use a normal <a class="xref" href="date.html" title="Date datatype"><code class="literal">date</code></a> field and set
the value explicitly.</p>
<p>The current <code class="literal">_ttl</code> functionality will be replaced in a future version with a
new implementation of TTL, possibly with different semantics, and will not
depend on the <code class="literal">_timestamp</code> field.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_analyzer_mappings"></a>Analyzer mappings<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/2.1/docs/reference/migration/migrate_2_0/mapping.asciidoc">edit</a></h3>
</div></div></div>
<p>Previously, <code class="literal">index_analyzer</code> and <code class="literal">search_analyzer</code> could be set separately,
while the <code class="literal">analyzer</code> setting would set both.  The <code class="literal">index_analyzer</code> setting has
been removed in favour of just using the <code class="literal">analyzer</code> setting.</p>
<p>If just the <code class="literal">analyzer</code> is set, it will be used at index time and at search time.  To use a different analyzer at search time, specify both the <code class="literal">analyzer</code> and a <code class="literal">search_analyzer</code>.</p>
<p>The <code class="literal">index_analyzer</code>, <code class="literal">search_analyzer</code>,  and <code class="literal">analyzer</code> type-level settings
have also been removed, as it is no longer possible to select fields based on
the type name.</p>
<p>The <code class="literal">_analyzer</code> meta-field, which allowed setting an analyzer per document has
also been removed.  It will be ignored on older indices.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_date_fields_and_unix_timestamps"></a>Date fields and Unix timestamps<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/2.1/docs/reference/migration/migrate_2_0/mapping.asciidoc">edit</a></h3>
</div></div></div>
<p>Previously, <code class="literal">date</code> fields would first try to parse values as a Unix timestamp&#8201;&#8212;&#8201;milliseconds-since-the-epoch&#8201;&#8212;&#8201;before trying to use their defined date
<code class="literal">format</code>.  This meant that formats like <code class="literal">yyyyMMdd</code> could never work, as values
would be interpreted as timestamps.</p>
<p>In 2.0, we have added two formats: <code class="literal">epoch_millis</code> and <code class="literal">epoch_second</code>.  Only
date fields that use these formats will be able to parse timestamps.</p>
<p>These formats cannot be used in dynamic templates, because they are
indistinguishable from long values.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_default_date_format"></a>Default date format<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/2.1/docs/reference/migration/migrate_2_0/mapping.asciidoc">edit</a></h3>
</div></div></div>
<p>The default date format has changed from <code class="literal">date_optional_time</code> to
<code class="literal">strict_date_optional_time</code>, which expects a 4 digit year, and a 2 digit month
and day, (and optionally, 2 digit hour, minute, and second).</p>
<p>A dynamically added date field, by default, includes the <code class="literal">epoch_millis</code>
format to support timestamp parsing.  For instance:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">PUT my_index/my_type/1
{
  "date_one": "2015-01-01" <a id="CO8-1"></a><i class="conum" data-value="1"></i>
}</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO8-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Has <code class="literal">format</code>: <code class="literal">"strict_date_optional_time||epoch_millis"</code>.</p>
</td>
</tr>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_literal_mapping_date_round_ceil_literal_setting"></a><code class="literal">mapping.date.round_ceil</code> setting<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/2.1/docs/reference/migration/migrate_2_0/mapping.asciidoc">edit</a></h3>
</div></div></div>
<p>The <code class="literal">mapping.date.round_ceil</code> setting for date math parsing has been removed.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="migration-bool-fields"></a>Boolean fields<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/2.1/docs/reference/migration/migrate_2_0/mapping.asciidoc">edit</a></h3>
</div></div></div>
<p>Boolean fields used to have a string fielddata with <code class="literal">F</code> meaning <code class="literal">false</code> and <code class="literal">T</code>
meaning <code class="literal">true</code>. They have been refactored to use numeric fielddata, with <code class="literal">0</code>
for <code class="literal">false</code> and <code class="literal">1</code> for <code class="literal">true</code>. As a consequence, the format of the responses of
the following APIs changed when applied to boolean fields: <code class="literal">0</code>/<code class="literal">1</code> is returned
instead of <code class="literal">F</code>/<code class="literal">T</code>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="search-request-fielddata-fields.html" title="Field Data Fields">fielddata fields</a>
</li>
<li class="listitem">
<a class="xref" href="search-request-sort.html" title="Sort">sort values</a>
</li>
<li class="listitem">
<a class="xref" href="search-aggregations-bucket-terms-aggregation.html" title="Terms Aggregation">terms aggregations</a>
</li>
</ul>
</div>
<p>In addition, terms aggregations use a custom formatter for boolean (like for
dates and ip addresses, which are also backed by numbers) in order to return
the user-friendly representation of boolean fields: <code class="literal">false</code>/<code class="literal">true</code>:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">"buckets": [
  {
     "key": 0,
     "key_as_string": "false",
     "doc_count": 42
  },
  {
     "key": 1,
     "key_as_string": "true",
     "doc_count": 12
  }
]</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_literal_index_name_literal_and_literal_path_literal_removed"></a><code class="literal">index_name</code> and <code class="literal">path</code> removed<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/2.1/docs/reference/migration/migrate_2_0/mapping.asciidoc">edit</a></h3>
</div></div></div>
<p>The <code class="literal">index_name</code> setting was used to change the name of the Lucene field,
and the <code class="literal">path</code> setting was used on <code class="literal">object</code> fields to determine whether the
Lucene field should use the full path (including parent object fields), or
just the final <code class="literal">name</code>.</p>
<p>These setting have been removed as their purpose is better served with the
<a class="xref" href="copy-to.html" title="copy_to"><code class="literal">copy_to</code></a> parameter.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_murmur3_fields"></a>Murmur3 Fields<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/2.1/docs/reference/migration/migrate_2_0/mapping.asciidoc">edit</a></h3>
</div></div></div>
<p>Fields of type <code class="literal">murmur3</code> can no longer change <code class="literal">doc_values</code> or <code class="literal">index</code> setting.
They are always mapped as follows:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "type":       "murmur3",
  "index":      "no",
  "doc_values": true
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_attachment_fields"></a>Attachment Fields<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/2.1/docs/reference/migration/migrate_2_0/mapping.asciidoc">edit</a></h3>
</div></div></div>
<p>Fields of type <code class="literal">attachment</code> used to index their content in the "main"
multi-field&#8201;&#8212;&#8201;a sub-field with the same name as the main field, e.g.
<code class="literal">my_attachment.my_attachment</code>.  This sub-field will be renamed to
<code class="literal">my_attachment.content</code>.   Any mapping settings (e.g. <code class="literal">analyzer</code>) on the old
<code class="literal">my_attachment.my_attachment</code> field will be lost. In this case, the index
needs to be reindexed in 2.x.</p>
<p>The <code class="literal">attachment</code> sub-fields do not support <code class="literal">copy_to</code>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_mappings_in_config_files_not_supported"></a>Mappings in config files not supported<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/2.1/docs/reference/migration/migrate_2_0/mapping.asciidoc">edit</a></h3>
</div></div></div>
<p>The ability to specify mappings in configuration files has been removed. To
specify default mappings that apply to multiple indexes, use
<a class="xref" href="indices-templates.html" title="Index Templates">index templates</a> instead.</p>
<p>Along with this change, the following settings have been removed:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">index.mapper.default_mapping_location</code>
</li>
<li class="listitem">
<code class="literal">index.mapper.default_percolator_mapping_location</code>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_fielddata_formats"></a>Fielddata formats<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/2.1/docs/reference/migration/migrate_2_0/mapping.asciidoc">edit</a></h3>
</div></div></div>
<p>Now that doc values are the default for fielddata, specialized in-memory
formats have become an esoteric option. These fielddata formats have been removed:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">fst</code> on string fields
</li>
<li class="listitem">
<code class="literal">compressed</code> on geo points
</li>
</ul>
</div>
<p>The default fielddata format will be used instead.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_posting_and_doc_values_codecs"></a>Posting and doc-values codecs<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/2.1/docs/reference/migration/migrate_2_0/mapping.asciidoc">edit</a></h3>
</div></div></div>
<p>It is no longer possible to specify per-field postings and doc values formats
in the mappings. This setting will be ignored on indices created before 2.0
and will cause mapping parsing to fail on indices created on or after 2.0. For
old indices, this means that new segments will be written with the default
postings and doc values formats of the current codec.</p>
<p>It is still possible to change the whole codec by using the <code class="literal">index.codec</code>
setting. Please however note that using a non-default codec is discouraged as
it could prevent future versions of Elasticsearch from being able to read the
index.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_compress_and_compress_threshold"></a>Compress and compress threshold<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/2.1/docs/reference/migration/migrate_2_0/mapping.asciidoc">edit</a></h3>
</div></div></div>
<p>The <code class="literal">compress</code> and <code class="literal">compress_threshold</code> options have been removed from the
<code class="literal">_source</code> field and fields of type <code class="literal">binary</code>.  These fields are compressed by
default.  If you would like to increase compression levels, use the new
<a class="xref" href="index-modules.html#index-codec"><code class="literal">index.codec: best_compression</code></a> setting instead.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_position_offset_gap"></a>position_offset_gap<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/2.1/docs/reference/migration/migrate_2_0/mapping.asciidoc">edit</a></h3>
</div></div></div>
<p>The <code class="literal">position_offset_gap</code> option is renamed to <em>position_increment_gap</em>. This was
done to clear away the confusion. Elasticsearch&#8217;s <em>position_increment_gap</em> now is
mapped directly to Lucene&#8217;s <em>position_increment_gap</em></p>
<p>The default <code class="literal">position_increment_gap</code> is now 100. Indexes created in Elasticsearch
2.0.0 will default to using 100 and indexes created before that will continue
to use the old default of 0. This was done to prevent phrase queries from
matching across different values of the same term unexpectedly. Specifically,
100 was chosen to cause phrase queries with slops up to 99 to match only within
a single value of a field.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_copy_to_and_multi_fields"></a>copy_to and multi fields<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/2.1/docs/reference/migration/migrate_2_0/mapping.asciidoc">edit</a></h3>
</div></div></div>
<p>A <a class="xref" href="copy-to.html" title="copy_to">copy_to</a> within a <a class="xref" href="multi-fields.html" title="fields">multi field</a> is ignored from version 2.0 on. With any version after
2.1 or 2.0.1 creating a mapping that has a copy_to within a multi field will result
in an exception.</p>
</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="breaking_20_multiple_literal_data_path_literal_striping.html">« Multiple <code class="literal">path.data</code> striping</a>
</span>
<span class="next">
<a href="breaking_20_crud_and_routing_changes.html">CRUD and routing changes »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>
                <div class="col-xs-12 col-sm-4 col-md-4" id="right_col">
                  <div id="rtpcontainer" style="display: block;">
                    <div class="mktg-promo">
                      <h3>Most Popular</h3>
                      <ul class="icons">
                        <li class="icon-elasticsearch-white"><a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">Get Started with Elasticsearch: Video</a></li>
                        <li class="icon-kibana-white"><a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">Intro to Kibana: Video</a></li>
                        <li class="icon-logstash-white"><a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">ELK for Logs & Metrics: Video</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";
	var localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}';
</script>
<script src="/static/js/swiftype_app_search.umd.min.js"></script>
<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
