<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Reindex API | Elasticsearch Guide [2.4] | Elastic</title>
<link rel="home" href="index.html" title="Elasticsearch Guide [2.4]"/>
<link rel="up" href="docs.html" title="Document APIs"/>
<link rel="prev" href="docs-bulk.html" title="Bulk API"/>
<link rel="next" href="docs-termvectors.html" title="Term Vectors"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/2.4"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="2.4"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <!--© 2015-2022 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!--BEGIN QUALTRICS WEBSITE FEEDBACK SNIPPET-->
    <script type='text/javascript'>
      (function(){var g=function(e,h,f,g){
      this.get=function(a){for(var a=a+"=",c=document.cookie.split(";"),b=0,e=c.length;b<e;b++){for(var d=c[b];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return null};
      this.set=function(a,c){var b="",b=new Date;b.setTime(b.getTime()+6048E5);b="; expires="+b.toGMTString();document.cookie=a+"="+c+b+"; path=/; "};
      this.check=function(){var a=this.get(f);if(a)a=a.split(":");else if(100!=e)"v"==h&&(e=Math.random()>=e/100?0:100),a=[h,e,0],this.set(f,a.join(":"));else return!0;var c=a[1];if(100==c)return!0;switch(a[0]){case "v":return!1;case "r":return c=a[2]%Math.floor(100/c),a[2]++,this.set(f,a.join(":")),!c}return!0};
      this.go=function(){if(this.check()){var a=document.createElement("script");a.type="text/javascript";a.src=g;document.body&&document.body.appendChild(a)}};
      this.start=function(){var a=this;window.addEventListener?window.addEventListener("load",function(){a.go()},!1):window.attachEvent&&window.attachEvent("onload",function(){a.go()})}};
      try{(new g(100,"r","QSI_S_ZN_emkP0oSe9Qrn7kF","https://znemkp0ose9qrn7kf-elastic.siteintercept.qualtrics.com/WRSiteInterceptEngine/?Q_ZID=ZN_emkP0oSe9Qrn7kF")).start()}catch(i){}})();
    </script><div id='ZN_emkP0oSe9Qrn7kF'><!--DO NOT REMOVE-CONTENTS PLACED HERE--></div>
    <!--END WEBSITE FEEDBACK SNIPPET-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  <div class="page_header">
<p>
  <strong>WARNING</strong>: Version 2.4 of Elasticsearch has passed its 
  <a href="https://www.elastic.co/support/eol">EOL date</a>. 
</p>  
<p>
  This documentation is no longer being maintained and may be removed. 
  If you are running this version, we strongly advise you to upgrade. 
  For the latest information, see the 
  <a href="../current/index.html">current release documentation</a>. 
</p>
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="index.html">Elasticsearch Guide [2.4]</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="docs.html">Document APIs</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="docs-bulk.html">« Bulk API</a>
</span>
<span class="next">
<a href="docs-termvectors.html">Term Vectors »</a>
</span>
</div>
<div class="chapter">
<div class="titlepage"><div><div>
<h2 class="title"><a id="docs-reindex"></a>Reindex API<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/2.4/docs/reference/docs/reindex.asciidoc">edit</a></h2>
</div></div></div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>The reindex API is new and should still be considered experimental.  The API may change in ways that are not backwards compatible</p>
</div>
</div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Reindex does not attempt to set up the destination index.  It does
not copy the settings of the source index.  You should set up the destination
index prior to running a <code class="literal">_reindex</code> action, including setting up mappings, shard
counts, replicas, etc.</p>
</div>
</div>
<p>The most basic form of <code class="literal">_reindex</code> just copies documents from one index to another.
This will copy documents from the <code class="literal">twitter</code> index into the <code class="literal">new_twitter</code> index:</p>
<div class="pre_wrapper lang-sense">
<pre class="programlisting prettyprint lang-sense">POST /_reindex
{
  "source": {
    "index": "twitter"
  },
  "dest": {
    "index": "new_twitter"
  }
}</pre>
</div>
<div class="sense_widget" data-snippet="snippets/30.sense"></div>
<p>That will return something like this:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "took" : 147,
  "timed_out": false,
  "created": 120,
  "updated": 0,
  "batches": 1,
  "version_conflicts": 0,
  "failures" : [ ],
  "created": 12344
}</pre>
</div>
<p>Just like <a class="xref" href="docs-update-by-query.html" title="Update By Query API"><code class="literal">_update_by_query</code></a>, <code class="literal">_reindex</code> gets a
snapshot of the source index but its target must be a <span class="strong strong"><strong>different</strong></span> index so
version conflicts are unlikely. The <code class="literal">dest</code> element can be configured like the
index API to control optimistic concurrency control. Just leaving out
<code class="literal">version_type</code> (as above) or setting it to <code class="literal">internal</code> will cause Elasticsearch
to blindly dump documents into the target, overwriting any that happen to have
the same type and id:</p>
<div class="pre_wrapper lang-sense">
<pre class="programlisting prettyprint lang-sense">POST /_reindex
{
  "source": {
    "index": "twitter"
  },
  "dest": {
    "index": "new_twitter",
    "version_type": "internal"
  }
}</pre>
</div>
<div class="sense_widget" data-snippet="snippets/31.sense"></div>
<p>Setting <code class="literal">version_type</code> to <code class="literal">external</code> will cause Elasticsearch to preserve the
<code class="literal">version</code> from the source, create any documents that are missing, and update
any documents that have an older version in the destination index than they do
in the source index:</p>
<div class="pre_wrapper lang-sense">
<pre class="programlisting prettyprint lang-sense">POST /_reindex
{
  "source": {
    "index": "twitter"
  },
  "dest": {
    "index": "new_twitter",
    "version_type": "external"
  }
}</pre>
</div>
<div class="sense_widget" data-snippet="snippets/32.sense"></div>
<p>Settings <code class="literal">op_type</code> to <code class="literal">create</code> will cause <code class="literal">_reindex</code> to only create missing
documents in the target index. All existing documents will cause a version
conflict:</p>
<div class="pre_wrapper lang-sense">
<pre class="programlisting prettyprint lang-sense">POST /_reindex
{
  "source": {
    "index": "twitter"
  },
  "dest": {
    "index": "new_twitter",
    "op_type": "create"
  }
}</pre>
</div>
<div class="sense_widget" data-snippet="snippets/33.sense"></div>
<p>By default version conflicts abort the <code class="literal">_reindex</code> process but you can just
count them by settings <code class="literal">"conflicts": "proceed"</code> in the request body:</p>
<div class="pre_wrapper lang-sense">
<pre class="programlisting prettyprint lang-sense">POST /_reindex
{
  "conflicts": "proceed",
  "source": {
    "index": "twitter"
  },
  "dest": {
    "index": "new_twitter",
    "op_type": "create"
  }
}</pre>
</div>
<div class="sense_widget" data-snippet="snippets/34.sense"></div>
<p>You can limit the documents by adding a type to the <code class="literal">source</code> or by adding a
query. This will only copy <code class="literal">tweet</code>&apos;s made by <code class="literal">kimchy</code> into <code class="literal">new_twitter</code>:</p>
<div class="pre_wrapper lang-sense">
<pre class="programlisting prettyprint lang-sense">POST /_reindex
{
  "source": {
    "index": "twitter",
    "type": "tweet",
    "query": {
      "term": {
        "user": "kimchy"
      }
    }
  },
  "dest": {
    "index": "new_twitter"
  }
}</pre>
</div>
<div class="sense_widget" data-snippet="snippets/35.sense"></div>
<p><code class="literal">index</code> and <code class="literal">type</code> in <code class="literal">source</code> can both be lists, allowing you to copy from
lots of sources in one request. This will copy documents from the <code class="literal">tweet</code> and
<code class="literal">post</code> types in the <code class="literal">twitter</code> and <code class="literal">blog</code> index. It&#8217;d include the <code class="literal">post</code> type in
the <code class="literal">twitter</code> index and the <code class="literal">tweet</code> type in the <code class="literal">blog</code> index. If you want to be
more specific you&#8217;ll need to use the <code class="literal">query</code>. It also makes no effort to handle
ID collisions. The target index will remain valid but it&#8217;s not easy to predict
which document will survive because the iteration order isn&#8217;t well defined.</p>
<div class="pre_wrapper lang-sense">
<pre class="programlisting prettyprint lang-sense">POST /_reindex
{
  "source": {
    "index": ["twitter", "blog"],
    "type": ["tweet", "post"]
  },
  "dest": {
    "index": "all_together"
  }
}</pre>
</div>
<div class="sense_widget" data-snippet="snippets/36.sense"></div>
<p>It&#8217;s also possible to limit the number of processed documents by setting
<code class="literal">size</code>. This will only copy a single document from <code class="literal">twitter</code> to
<code class="literal">new_twitter</code>:</p>
<div class="pre_wrapper lang-sense">
<pre class="programlisting prettyprint lang-sense">POST /_reindex
{
  "size": 1,
  "source": {
    "index": "twitter"
  },
  "dest": {
    "index": "new_twitter"
  }
}</pre>
</div>
<div class="sense_widget" data-snippet="snippets/37.sense"></div>
<p>If you want a particular set of documents from the twitter index you&#8217;ll
need to sort. Sorting makes the scroll less efficient but in some contexts
it&#8217;s worth it. If possible, prefer a more selective query to <code class="literal">size</code> and <code class="literal">sort</code>.
This will copy 10000 documents from <code class="literal">twitter</code> into <code class="literal">new_twitter</code>:</p>
<div class="pre_wrapper lang-sense">
<pre class="programlisting prettyprint lang-sense">POST /_reindex
{
  "size": 10000,
  "source": {
    "index": "twitter",
    "sort": { "date": "desc" }
  },
  "dest": {
    "index": "new_twitter"
  }
}</pre>
</div>
<div class="sense_widget" data-snippet="snippets/38.sense"></div>
<p>The <code class="literal">source</code> section supports all the elements that are supported in a
<a class="xref" href="search-request-body.html" title="Request Body Search">search request</a>. For instance only a subset of the
fields from the original documents can be reindexed using source filtering
as follows:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST _reindex
{
  "source": {
    "index": "twitter",
    "_source": ["user", "tweet"]
  },
  "dest": {
    "index": "new_twitter"
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/39.console"></div>
<p>Like <code class="literal">_update_by_query</code>, <code class="literal">_reindex</code> supports a script that modifies the
document. Unlike <code class="literal">_update_by_query</code>, the script is allowed to modify the
document&#8217;s metadata. This example bumps the version of the source document:</p>
<div class="pre_wrapper lang-sense">
<pre class="programlisting prettyprint lang-sense">POST /_reindex
{
  "source": {
    "index": "twitter"
  },
  "dest": {
    "index": "new_twitter",
    "version_type": "external"
  },
  "script": {
    "inline": "if (ctx._source.foo == 'bar') {ctx._version++; ctx._source.remove('foo')}"
  }
}</pre>
</div>
<div class="sense_widget" data-snippet="snippets/40.sense"></div>
<p>Think of the possibilities! Just be careful! With great power&#8230;&#8203;. You can
change:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">_id</code>
</li>
<li class="listitem">
<code class="literal">_type</code>
</li>
<li class="listitem">
<code class="literal">_index</code>
</li>
<li class="listitem">
<code class="literal">_version</code>
</li>
<li class="listitem">
<code class="literal">_routing</code>
</li>
<li class="listitem">
<code class="literal">_parent</code>
</li>
<li class="listitem">
<code class="literal">_timestamp</code>
</li>
<li class="listitem">
<code class="literal">_ttl</code>
</li>
</ul>
</div>
<p>Setting <code class="literal">_version</code> to <code class="literal">null</code> or clearing it from the <code class="literal">ctx</code> map is just like not
sending the version in an indexing request. It will cause that document to be
overwritten in the target index regardless of the version on the target or the
version type you use in the <code class="literal">_reindex</code> request.</p>
<p>By default if <code class="literal">_reindex</code> sees a document with routing then the routing is
preserved unless it&#8217;s changed by the script. You can set <code class="literal">routing</code> on the
<code class="literal">dest</code> request to change this:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">keep</code>
</span>
</dt>
<dd>
Sets the routing on the bulk request sent for each match to the routing on
the match. The default.
</dd>
<dt>
<span class="term">
<code class="literal">discard</code>
</span>
</dt>
<dd>
Sets the routing on the bulk request sent for each match to null.
</dd>
<dt>
<span class="term">
<code class="literal">=&lt;some text&gt;</code>
</span>
</dt>
<dd>
Sets the routing on the bulk request sent for each match to all text after
the <code class="literal">=</code>.
</dd>
</dl>
</div>
<p>For example, you can use the following request to copy all documents from
the <code class="literal">source</code> index with the company name <code class="literal">cat</code> into the <code class="literal">dest</code> index with
routing set to <code class="literal">cat</code>.</p>
<div class="pre_wrapper lang-sense">
<pre class="programlisting prettyprint lang-sense">POST /_reindex
{
  "source": {
    "index": "source"
    "query": {
      "match": {
        "company": "cat"
      }
    }
  },
  "dest": {
    "index": "dest",
    "routing": "=cat"
  }
}</pre>
</div>
<div class="sense_widget" data-snippet="snippets/41.sense"></div>
<p>By default <code class="literal">_reindex</code> uses scroll batches of 1000. You can change the
batch size with the <code class="literal">size</code> field in the <code class="literal">source</code> element:</p>
<div class="pre_wrapper lang-sense">
<pre class="programlisting prettyprint lang-sense">POST _reindex
{
  "source": {
    "index": "source",
    "size": 100
  },
  "dest": {
    "index": "dest"
  }
}</pre>
</div>
<div class="sense_widget" data-snippet="snippets/42.sense"></div>
<h3><a id="_url_parameters_2"></a>URL Parameters<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/2.4/docs/reference/docs/reindex.asciidoc">edit</a></h3>
<p>In addition to the standard parameters like <code class="literal">pretty</code>, the Reindex API also
supports <code class="literal">refresh</code>, <code class="literal">wait_for_completion</code>, <code class="literal">consistency</code>, <code class="literal">timeout</code>, and
<code class="literal">requests_per_second</code>.</p>
<p>Sending the <code class="literal">refresh</code> url parameter will cause all indexes to which the request
wrote to be refreshed. This is different than the Index API&#8217;s <code class="literal">refresh</code>
parameter which causes just the shard that received the new data to be refreshed.</p>
<p>If the request contains <code class="literal">wait_for_completion=false</code> then Elasticsearch will
perform some preflight checks, launch the request, and then return a <code class="literal">task</code>
which can be used with <a class="xref" href="docs-reindex.html#docs-reindex-task-api" title="Works with the Task API">Tasks APIs</a> to cancel or get
the status of the task. For now, once the request is finished the task is gone
and the only place to look for the ultimate result of the task is in the
Elasticsearch log file. This will be fixed soon.</p>
<p><code class="literal">consistency</code> controls how many copies of a shard must respond to each write
request. <code class="literal">timeout</code> controls how long each write request waits for unavailable
shards to become available. Both work exactly how they work in the
<a class="xref" href="docs-bulk.html" title="Bulk API">Bulk API</a>.</p>
<p><code class="literal">requests_per_second</code> can be set to any decimal number (<code class="literal">1.4</code>, <code class="literal">6</code>, <code class="literal">1000</code>, etc)
and throttles the number of requests per second that the reindex issues. The
throttling is done waiting between bulk batches so that it can manipulate the
scroll timeout. The wait time is the difference between the time it took the
batch to complete and the time <code class="literal">requests_per_second * requests_in_the_batch</code>.
Since the batch isn&#8217;t broken into multiple bulk requests large batch sizes will
cause Elasticsearch to create many requests and then wait for a while before
starting the next set. This is "bursty" instead of "smooth". The default is
<code class="literal">unlimited</code> which is also the only non-number value that it accepts.</p>
<h3><a id="_response_body_2"></a>Response body<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/2.4/docs/reference/docs/reindex.asciidoc">edit</a></h3>
<p>The JSON response looks like this:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "took" : 639,
  "updated": 0,
  "created": 123,
  "batches": 1,
  "version_conflicts": 2,
  "retries": 0,
  "throttled_millis": 0,
  "failures" : [ ]
}</pre>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">took</code>
</span>
</dt>
<dd>
The number of milliseconds from start to end of the whole operation.
</dd>
<dt>
<span class="term">
<code class="literal">updated</code>
</span>
</dt>
<dd>
The number of documents that were successfully updated.
</dd>
<dt>
<span class="term">
<code class="literal">created</code>
</span>
</dt>
<dd>
The number of documents that were successfully created.
</dd>
<dt>
<span class="term">
<code class="literal">batches</code>
</span>
</dt>
<dd>
The number of scroll responses pulled back by the the reindex.
</dd>
<dt>
<span class="term">
<code class="literal">version_conflicts</code>
</span>
</dt>
<dd>
The number of version conflicts that reindex hit.
</dd>
<dt>
<span class="term">
<code class="literal">retries</code>
</span>
</dt>
<dd>
The number of retries that the reindex did in response to a full queue.
</dd>
<dt>
<span class="term">
<code class="literal">throttled_millis</code>
</span>
</dt>
<dd>
Number of milliseconds the request slept to conform to <code class="literal">requests_per_second</code>.
</dd>
<dt>
<span class="term">
<code class="literal">failures</code>
</span>
</dt>
<dd>
Array of all indexing failures. If this is non-empty then the request aborted
because of those failures. See <code class="literal">conflicts</code> for how to prevent version conflicts
from aborting the operation.
</dd>
</dl>
</div>
<h3><a id="docs-reindex-task-api"></a>Works with the Task API<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/2.4/docs/reference/docs/reindex.asciidoc">edit</a></h3>
<p>While Reindex is running you can fetch their status using the
<a class="xref" href="tasks.html" title="Task Management API">Task API</a>:</p>
<div class="pre_wrapper lang-sense">
<pre class="programlisting prettyprint lang-sense">GET /_tasks/?pretty&amp;detailed=true&amp;actions=*reindex</pre>
</div>
<div class="sense_widget" data-snippet="snippets/43.sense"></div>
<p>The responses looks like:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "nodes" : {
    "r1A2WoRbTwKZ516z6NEs5A" : {
      "name" : "Tyrannus",
      "transport_address" : "127.0.0.1:9300",
      "host" : "127.0.0.1",
      "ip" : "127.0.0.1:9300",
      "attributes" : {
        "testattr" : "test",
        "portsfile" : "true"
      },
      "tasks" : {
        "r1A2WoRbTwKZ516z6NEs5A:36619" : {
          "node" : "r1A2WoRbTwKZ516z6NEs5A",
          "id" : 36619,
          "type" : "transport",
          "action" : "indices:data/write/reindex",
          "status" : {    <a id="CO21-1"></a><i class="conum" data-value="1"></i>
            "total" : 6154,
            "updated" : 3500,
            "created" : 0,
            "deleted" : 0,
            "batches" : 4,
            "version_conflicts" : 0,
            "noops" : 0,
            "retries": 0,
            "throttled_millis": 0
          },
          "description" : ""
        }
      }
    }
  }
}</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO21-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>this object contains the actual status. It is just like the response json
with the important addition of the <code class="literal">total</code> field. <code class="literal">total</code> is the total number
of operations that the reindex expects to perform. You can estimate the
progress by adding the <code class="literal">updated</code>, <code class="literal">created</code>, and <code class="literal">deleted</code> fields. The request
will finish when their sum is equal to the <code class="literal">total</code> field.</p>
</td>
</tr>
</table>
</div>
<h3><a id="docs-reindex-cancel-task-api"></a>Works with the Cancel Task API<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/2.4/docs/reference/docs/reindex.asciidoc">edit</a></h3>
<p>Any Reindex can be canceled using the <a class="xref" href="tasks.html" title="Task Management API">Task Cancel API</a>:</p>
<div class="pre_wrapper lang-sense">
<pre class="programlisting prettyprint lang-sense">POST /_tasks/{task_id}/_cancel</pre>
</div>
<div class="sense_widget" data-snippet="snippets/44.sense"></div>
<p>The <code class="literal">task_id</code> can be found using the tasks API above.</p>
<p>Cancelation should happen quickly but might take a few seconds. The task status
API above will continue to list the task until it is wakes to cancel itself.</p>
<h3><a id="docs-reindex-rethrottle"></a>Rethrottling<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/2.4/docs/reference/docs/reindex.asciidoc">edit</a></h3>
<p>The value of <code class="literal">requests_per_second</code> can be changed on a running reindex using
the <code class="literal">_rethrottle</code> API:</p>
<div class="pre_wrapper lang-sense">
<pre class="programlisting prettyprint lang-sense">POST /_reindex/{task_id}/_rethrottle?requests_per_second=unlimited</pre>
</div>
<div class="sense_widget" data-snippet="snippets/45.sense"></div>
<p>The <code class="literal">task_id</code> can be found using the tasks API above.</p>
<p>Just like when setting it on the <code class="literal">_reindex</code> API <code class="literal">requests_per_second</code> can be
either <code class="literal">unlimited</code> to disable throttling or any decimal number like <code class="literal">1.7</code> or
<code class="literal">12</code> to throttle to that level. Rethrottling that speeds up the query takes
effect immediately but rethrotting that slows down the query will take effect
on after completing the current batch. This prevents scroll timeouts.</p>
<h3><a id="_reindex_to_change_the_name_of_a_field"></a>Reindex to change the name of a field<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/2.4/docs/reference/docs/reindex.asciidoc">edit</a></h3>
<p><code class="literal">_reindex</code> can be used to build a copy of an index with renamed fields. Say you
create an index containing documents that look like this:</p>
<div class="pre_wrapper lang-sense">
<pre class="programlisting prettyprint lang-sense">POST test/test/1?refresh&amp;pretty
{
  "text": "words words",
  "flag": "foo"
}</pre>
</div>
<div class="sense_widget" data-snippet="snippets/46.sense"></div>
<p>But you don&#8217;t like the name <code class="literal">flag</code> and want to replace it with <code class="literal">tag</code>.
<code class="literal">_reindex</code> can create the other index for you:</p>
<div class="pre_wrapper lang-sense">
<pre class="programlisting prettyprint lang-sense">POST _reindex?pretty
{
  "source": {
    "index": "test"
  },
  "dest": {
    "index": "test2"
  },
  "script": {
    "inline": "ctx._source.tag = ctx._source.remove(\"flag\")"
  }
}</pre>
</div>
<div class="sense_widget" data-snippet="snippets/47.sense"></div>
<p>Now you can get the new document:</p>
<div class="pre_wrapper lang-sense">
<pre class="programlisting prettyprint lang-sense">GET test2/test/1?pretty</pre>
</div>
<div class="sense_widget" data-snippet="snippets/48.sense"></div>
<p>and it&#8217;ll look like:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "text": "words words",
  "tag": "foo"
}</pre>
</div>
<p>Or you can search by <code class="literal">tag</code> or whatever you want.</p>
</div>
<div class="navfooter">
<span class="prev">
<a href="docs-bulk.html">« Bulk API</a>
</span>
<span class="next">
<a href="docs-termvectors.html">Term Vectors »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
