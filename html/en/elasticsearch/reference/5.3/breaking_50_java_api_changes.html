<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Java API changes | Elasticsearch Guide [5.3] | Elastic</title>
<link rel="home" href="index.html" title="Elasticsearch Guide [5.3]"/>
<link rel="up" href="breaking-changes-5.0.html" title="Breaking changes in 5.0"/>
<link rel="prev" href="breaking_50_cat_api.html" title="CAT API changes"/>
<link rel="next" href="breaking_50_packaging.html" title="Packaging"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/5.3"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="5.3"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <!--© 2015-2022 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!--BEGIN QUALTRICS WEBSITE FEEDBACK SNIPPET-->
    <script type='text/javascript'>
      (function(){var g=function(e,h,f,g){
      this.get=function(a){for(var a=a+"=",c=document.cookie.split(";"),b=0,e=c.length;b<e;b++){for(var d=c[b];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return null};
      this.set=function(a,c){var b="",b=new Date;b.setTime(b.getTime()+6048E5);b="; expires="+b.toGMTString();document.cookie=a+"="+c+b+"; path=/; "};
      this.check=function(){var a=this.get(f);if(a)a=a.split(":");else if(100!=e)"v"==h&&(e=Math.random()>=e/100?0:100),a=[h,e,0],this.set(f,a.join(":"));else return!0;var c=a[1];if(100==c)return!0;switch(a[0]){case "v":return!1;case "r":return c=a[2]%Math.floor(100/c),a[2]++,this.set(f,a.join(":")),!c}return!0};
      this.go=function(){if(this.check()){var a=document.createElement("script");a.type="text/javascript";a.src=g;document.body&&document.body.appendChild(a)}};
      this.start=function(){var a=this;window.addEventListener?window.addEventListener("load",function(){a.go()},!1):window.attachEvent&&window.attachEvent("onload",function(){a.go()})}};
      try{(new g(100,"r","QSI_S_ZN_emkP0oSe9Qrn7kF","https://znemkp0ose9qrn7kf-elastic.siteintercept.qualtrics.com/WRSiteInterceptEngine/?Q_ZID=ZN_emkP0oSe9Qrn7kF")).start()}catch(i){}})();
    </script><div id='ZN_emkP0oSe9Qrn7kF'><!--DO NOT REMOVE-CONTENTS PLACED HERE--></div>
    <!--END WEBSITE FEEDBACK SNIPPET-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  <div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="index.html">Elasticsearch Guide [5.3]</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="breaking-changes.html">Breaking changes</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="breaking-changes-5.0.html">Breaking changes in 5.0</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="breaking_50_cat_api.html">« CAT API changes</a>
</span>
<span class="next">
<a href="breaking_50_packaging.html">Packaging »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="breaking_50_java_api_changes"></a>Java API changes<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h2>
</div></div></div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_transport_client_has_been_moved"></a>Transport client  has been moved<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h3>
</div></div></div>
<p>The Java transport client has been moved to its own module which can be referenced using:</p>
<div class="pre_wrapper lang-xml">
<pre class="programlisting prettyprint lang-xml">&lt;dependency&gt;
    &lt;groupId&gt;org.elasticsearch.client&lt;/groupId&gt;
    &lt;artifactId&gt;transport&lt;/artifactId&gt;
    &lt;version&gt;5.0.0&lt;/version&gt;
&lt;/dependency&gt;</pre>
</div>
<p>The transport client is now created using the following snippet:</p>
<div class="pre_wrapper lang-java">
<pre class="programlisting prettyprint lang-java">TransportClient client = new PreBuiltTransportClient(Settings.EMPTY)
        .addTransportAddress(new InetSocketTransportAddress(InetAddress.getByName("host1"), 9300))
        .addTransportAddress(new InetSocketTransportAddress(InetAddress.getByName("host2"), 9300));</pre>
</div>
<p>For more information please see the <a href="/guide/en/elasticsearch/client/java-api/5.3/java-api.html" class="ulink" target="_top">Java client documentation</a></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_count_api_has_been_removed"></a>Count api has been removed<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h3>
</div></div></div>
<p>The deprecated count api has been removed from the Java api, use the search api instead and set size to 0.</p>
<p>The following call</p>
<div class="pre_wrapper lang-java">
<pre class="programlisting prettyprint lang-java">client.prepareCount(indices).setQuery(query).get();</pre>
</div>
<p>can be replaced with</p>
<div class="pre_wrapper lang-java">
<pre class="programlisting prettyprint lang-java">client.prepareSearch(indices).setSource(new SearchSourceBuilder().size(0).query(query)).get();</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_suggest_api_has_been_removed"></a>Suggest api has been removed<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h3>
</div></div></div>
<p>The suggest api has been removed from the Java api, use the suggest option in search api, it has been optimized
for suggest-only request.</p>
<p>The following call</p>
<div class="pre_wrapper lang-java">
<pre class="programlisting prettyprint lang-java">client.prepareSuggest(indices).addSuggestion("foo", SuggestBuilders.completionSuggestion("field").text("s")).get();</pre>
</div>
<p>can be replaced with</p>
<div class="pre_wrapper lang-java">
<pre class="programlisting prettyprint lang-java">client.prepareSearch(indices).suggest(new SuggestBuilder().addSuggestion("foo", SuggestBuilders.completionSuggestion("field").text("s"))).get();</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_elasticsearch_will_no_longer_detect_logging_implementations"></a>Elasticsearch will no longer detect logging implementations<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h3>
</div></div></div>
<p>Elasticsearch now logs using Log4j 2. Previously if Log4j wasn&#8217;t on the
classpath it made some effort to degrade to SLF4J or Java logging. Now it will
fail to work without the Log4j 2 API. The log4j-over-slf4j bridge ought to work
when using the Java client. The log4j-1.2-api bridge is used for third-party
dependencies that still use the Log4j 1 API. The Elasticsearch server now only
supports Log4j 2 as configured by <code class="literal">log4j2.properties</code> and will fail if Log4j
isn&#8217;t present.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_groovy_dependencies"></a>Groovy dependencies<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h3>
</div></div></div>
<p>In previous versions of Elasticsearch, the Groovy scripting capabilities
depended on the <code class="literal">org.codehaus.groovy:groovy-all</code> artifact.  In addition
to pulling in the Groovy language, this pulls in a very large set of
functionality, none of which is needed for scripting within
Elasticsearch. Aside from the inherent difficulties in managing such a
large set of dependencies, this also increases the surface area for
security issues. This dependency has been reduced to the core Groovy
language <code class="literal">org.codehaus.groovy:groovy</code> artifact.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_documentalreadyexistsexception_removed"></a>DocumentAlreadyExistsException removed<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">DocumentAlreadyExistsException</code> is removed and a <code class="literal">VersionConflictEngineException</code> is thrown instead (with a better
error description). This will influence code that use the <code class="literal">IndexRequest.opType()</code> or <code class="literal">IndexRequest.create()</code>
to index a document only if it doesn&#8217;t already exist.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_writeconsistencylevel_removed_on_write_requests"></a>writeConsistencyLevel removed on write requests<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h3>
</div></div></div>
<p>In previous versions of Elasticsearch, the various write requests had a
<code class="literal">setWriteConsistencyLevel</code> method to set the shard consistency level for
write operations. However, the semantics of write consistency were ambiguous
as this is just a pre-operation check to ensure the specified number of
shards were available before the operation commenced. The write consistency
level did not guarantee that the data would be replicated to those number
of copies by the time the operation finished. The <code class="literal">setWriteConsistencyLevel</code>
method on these write requests has been changed to <code class="literal">setWaitForActiveShards</code>,
which can take a numerical value up to the total number of shard copies or
<code class="literal">ActiveShardCount.ALL</code> for all shard copies. The default is to just wait
for the primary shard to be active before proceeding with the operation.
See the section on <a class="xref" href="docs-index_.html#index-wait-for-active-shards" title="Wait For Active Shards">wait for active shards</a>
for more details.</p>
<p>This change affects <code class="literal">IndexRequest</code>, <code class="literal">IndexRequestBuilder</code>, <code class="literal">BulkRequest</code>,
<code class="literal">BulkRequestBuilder</code>, <code class="literal">UpdateRequest</code>, <code class="literal">UpdateRequestBuilder</code>, <code class="literal">DeleteRequest</code>,
and <code class="literal">DeleteRequestBuilder</code>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_changes_to_query_builders"></a>Changes to Query Builders<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h3>
</div></div></div>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_boostingquerybuilder"></a>BoostingQueryBuilder<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h4>
</div></div></div>
<p>Removed setters for mandatory positive/negative query. Both arguments now have
to be supplied at construction time already and have to be non-null.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_spancontainingquerybuilder"></a>SpanContainingQueryBuilder<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h4>
</div></div></div>
<p>Removed setters for mandatory big/little inner span queries. Both arguments now have
to be supplied at construction time already and have to be non-null. Updated
static factory methods in QueryBuilders accordingly.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_spanorquerybuilder"></a>SpanOrQueryBuilder<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h4>
</div></div></div>
<p>Making sure that query contains at least one clause by making initial clause mandatory
in constructor.
Renaming method to add clauses from <code class="literal">clause(SpanQueryBuilder)</code> to <code class="literal">addClause(SpanQueryBuilder)</code>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_spannearquerybuilder"></a>SpanNearQueryBuilder<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h4>
</div></div></div>
<p>Removed setter for mandatory slop parameter, needs to be set in constructor now. Also
making sure that query contains at least one clause by making initial clause mandatory
in constructor. Updated the static factory methods in QueryBuilders accordingly.
Renaming method to add clauses from <code class="literal">clause(SpanQueryBuilder)</code> to <code class="literal">addClause(SpanQueryBuilder)</code>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_spannotquerybuilder"></a>SpanNotQueryBuilder<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h4>
</div></div></div>
<p>Removed setter for mandatory include/exclude span query clause, needs to be set in constructor now.
Updated the static factory methods in QueryBuilders and tests accordingly.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_spanwithinquerybuilder"></a>SpanWithinQueryBuilder<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h4>
</div></div></div>
<p>Removed setters for mandatory big/little inner span queries. Both arguments now have
to be supplied at construction time already and have to be non-null. Updated
static factory methods in QueryBuilders accordingly.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_wrapperquerybuilder"></a>WrapperQueryBuilder<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h4>
</div></div></div>
<p>Removed <code class="literal">wrapperQueryBuilder(byte[] source, int offset, int length)</code>. Instead simply
use  <code class="literal">wrapperQueryBuilder(byte[] source)</code>. Updated the static factory methods in
QueryBuilders accordingly.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_querystringquerybuilder"></a>QueryStringQueryBuilder<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h4>
</div></div></div>
<p>Removed ability to pass in boost value using <code class="literal">field(String field)</code> method in form e.g. <code class="literal">field^2</code>.
Use the <code class="literal">field(String, float)</code> method instead.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_operator"></a>Operator<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h4>
</div></div></div>
<p>Removed the enums called <code class="literal">Operator</code> from <code class="literal">MatchQueryBuilder</code>, <code class="literal">QueryStringQueryBuilder</code>,
<code class="literal">SimpleQueryStringBuilder</code>, and <code class="literal">CommonTermsQueryBuilder</code> in favour of using the enum
defined in <code class="literal">org.elasticsearch.index.query.Operator</code> in an effort to consolidate the
codebase and avoid duplication.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_queryname_and_boost_support"></a>queryName and boost support<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h4>
</div></div></div>
<p>Support for <code class="literal">queryName</code> and <code class="literal">boost</code> has been streamlined to all of the queries. That is
a breaking change till queries get sent over the network as serialized json rather
than in <code class="literal">Streamable</code> format. In fact whenever additional fields are added to the json
representation of the query, older nodes might throw error when they find unknown fields.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_innerhitsbuilder"></a>InnerHitsBuilder<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h4>
</div></div></div>
<p>InnerHitsBuilder now has a dedicated addParentChildInnerHits and addNestedInnerHits methods
to differentiate between inner hits for nested vs. parent / child documents. This change
makes the type / path parameter mandatory.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_matchquerybuilder"></a>MatchQueryBuilder<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h4>
</div></div></div>
<p>Moving MatchQueryBuilder.Type and MatchQueryBuilder.ZeroTermsQuery enum to MatchQuery.Type.
Also reusing new Operator enum.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_morelikethisquerybuilder"></a>MoreLikeThisQueryBuilder<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h4>
</div></div></div>
<p>Removed <code class="literal">MoreLikeThisQueryBuilder.Item#id(String id)</code>, <code class="literal">Item#doc(BytesReference doc)</code>,
<code class="literal">Item#doc(XContentBuilder doc)</code>. Use provided constructors instead.</p>
<p>Removed <code class="literal">MoreLikeThisQueryBuilder#addLike</code> in favor of texts and/or items being provided
at construction time. Using arrays there instead of lists now.</p>
<p>Removed <code class="literal">MoreLikeThisQueryBuilder#addUnlike</code> in favor to using the <code class="literal">unlike</code> methods
which take arrays as arguments now rather than the lists used before.</p>
<p>The deprecated <code class="literal">docs(Item... docs)</code>, <code class="literal">ignoreLike(Item... docs)</code>,
<code class="literal">ignoreLike(String... likeText)</code>, <code class="literal">addItem(Item... likeItems)</code> have been removed.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_geodistancequerybuilder"></a>GeoDistanceQueryBuilder<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h4>
</div></div></div>
<p>Removing individual setters for lon() and lat() values, both values should be set together
 using point(lon, lat).</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_geodistancerangequerybuilder"></a>GeoDistanceRangeQueryBuilder<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h4>
</div></div></div>
<p>Removing setters for to(Object &#8230;&#8203;) and from(Object &#8230;&#8203;) in favour of the only two allowed input
arguments (String, Number). Removing setter for center point (point(), geohash()) because parameter
is mandatory and should already be set in constructor.
Also removing setters for lt(), lte(), gt(), gte() since they can all be replaced by equivalent
calls to to/from() and includeLower()/includeUpper().</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_geopolygonquerybuilder"></a>GeoPolygonQueryBuilder<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h4>
</div></div></div>
<p>Require shell of polygon already to be specified in constructor instead of adding it pointwise.
This enables validation, but makes it necessary to remove the addPoint() methods.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_multimatchquerybuilder"></a>MultiMatchQueryBuilder<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h4>
</div></div></div>
<p>Moving MultiMatchQueryBuilder.ZeroTermsQuery enum to MatchQuery.ZeroTermsQuery.
Also reusing new Operator enum.</p>
<p>Removed ability to pass in boost value using <code class="literal">field(String field)</code> method in form e.g. <code class="literal">field^2</code>.
Use the <code class="literal">field(String, float)</code> method instead.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_missingquerybuilder"></a>MissingQueryBuilder<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h4>
</div></div></div>
<p>The MissingQueryBuilder which was deprecated in 2.2.0 is removed. As a replacement use ExistsQueryBuilder
inside a mustNot() clause. So instead of using <code class="literal">new MissingQueryBuilder(name)</code> now use
<code class="literal">new BoolQueryBuilder().mustNot(new ExistsQueryBuilder(name))</code>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_notquerybuilder"></a>NotQueryBuilder<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h4>
</div></div></div>
<p>The NotQueryBuilder which was deprecated in 2.1.0 is removed. As a replacement use BoolQueryBuilder
with added mustNot() clause. So instead of using <code class="literal">new NotQueryBuilder(filter)</code> now use
<code class="literal">new BoolQueryBuilder().mustNot(filter)</code>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_termsquerybuilder"></a>TermsQueryBuilder<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h4>
</div></div></div>
<p>Remove the setter for <code class="literal">termsLookup()</code>, making it only possible to either use a TermsLookup object or
individual values at construction time. Also moving individual settings for the TermsLookup (lookupIndex,
lookupType, lookupId, lookupPath) to the separate TermsLookup class, using constructor only and moving
checks for validation there. Removed <code class="literal">TermsLookupQueryBuilder</code> in favour of <code class="literal">TermsQueryBuilder</code>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_functionscorequerybuilder"></a>FunctionScoreQueryBuilder<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h4>
</div></div></div>
<p><code class="literal">add</code> methods have been removed, all filters and functions must be provided as constructor arguments by
creating an array of <code class="literal">FunctionScoreQueryBuilder.FilterFunctionBuilder</code> objects, containing one element
for each filter/function pair.</p>
<p><code class="literal">scoreMode</code> and <code class="literal">boostMode</code> can only be provided using corresponding enum members instead
of string values: see <code class="literal">FilterFunctionScoreQuery.ScoreMode</code> and <code class="literal">CombineFunction</code>.</p>
<p><code class="literal">CombineFunction.MULT</code> has been renamed to <code class="literal">MULTIPLY</code>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_idsquerybuilder"></a>IdsQueryBuilder<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h4>
</div></div></div>
<p>For simplicity, only one way of adding the ids to the existing list (empty by default)  is left: <code class="literal">addIds(String...)</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_shapebuilders"></a>ShapeBuilders<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h4>
</div></div></div>
<p><code class="literal">InternalLineStringBuilder</code> is removed in favour of <code class="literal">LineStringBuilder</code>, <code class="literal">InternalPolygonBuilder</code> in favour of PolygonBuilder` and <code class="literal">Ring</code> has been replaced with <code class="literal">LineStringBuilder</code>. Also the abstract base classes <code class="literal">BaseLineStringBuilder</code> and <code class="literal">BasePolygonBuilder</code> haven been merged with their corresponding implementations.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_rescorebuilder"></a>RescoreBuilder<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h4>
</div></div></div>
<p><code class="literal">RecoreBuilder.Rescorer</code> was merged with <code class="literal">RescoreBuilder</code>, which now is an abstract superclass. QueryRescoreBuilder currently is its only implementation.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_phrasesuggestionbuilder"></a>PhraseSuggestionBuilder<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h4>
</div></div></div>
<p>The inner DirectCandidateGenerator class has been moved out to its own class called DirectCandidateGeneratorBuilder.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_sortbuilders"></a>SortBuilders<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h4>
</div></div></div>
<p>The <code class="literal">sortMode</code> setter in <code class="literal">FieldSortBuilder</code>, <code class="literal">GeoDistanceSortBuilder</code> and <code class="literal">ScriptSortBuilder</code> now
accept a <code class="literal">SortMode</code> enum instead of a String constant. Also the getter returns the same enum type.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_suggestbuilder"></a>SuggestBuilder<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h4>
</div></div></div>
<p>The <code class="literal">setText</code> method has been changed to <code class="literal">setGlobalText</code> to make the intent more clear, and a <code class="literal">getGlobalText</code> method has been added.</p>
<p>The <code class="literal">addSuggestion</code> method now required the user specified suggestion name, previously used in the ctor of each suggestion.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_suggestionbuilder"></a>SuggestionBuilder<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h4>
</div></div></div>
<p>The <code class="literal">field</code> setter has been deleted. Instead the field name needs to be specified as constructor argument.</p>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_searchsourcebuilder"></a>SearchSourceBuilder<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h3>
</div></div></div>
<p>All methods which take an <code class="literal">XContentBuilder</code>, <code class="literal">BytesReference</code> <code class="literal">Map&lt;String, Object&gt;</code> or <code class="literal">bytes[]</code> have been removed in favor of providing the
relevant builder object for that feature (e.g. <code class="literal">HighlightBuilder</code>, <code class="literal">AggregationBuilder</code>, <code class="literal">SuggestBuilder</code>) . This means that all search requests
can now be validated at call time which results in much clearer errors.</p>
<p>The <code class="literal">defaultResourceWindowSize(int)</code> method has been removed. The window size should be set explicitly on all <code class="literal">RescoreBuilder</code> objects.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_searchrequestbuilder"></a>SearchRequestBuilder<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h3>
</div></div></div>
<p>All methods which take an <code class="literal">XContentBuilder</code>, <code class="literal">BytesReference</code> <code class="literal">Map&lt;String, Object&gt;</code> or <code class="literal">bytes[]</code> have been removed in favor of providing the
relevant builder object for that feature (e.g. <code class="literal">HighlightBuilder</code>, <code class="literal">AggregationBuilder</code>, <code class="literal">SuggestBuilder</code>) . This means that all search requests
can now be validated at call time which results in much clearer errors.</p>
<p>All highlighter methods have been removed in favor of a single <code class="literal">highlighter(HighlightBuilder)</code> method.</p>
<p>The <code class="literal">setExtraSource(SearchSourceBuilder)</code> method has been removed.</p>
<p>The <code class="literal">setTemplateSource(String)</code> and <code class="literal">setTemplateSource(BytesReference)</code> methods have been removed. Use <code class="literal">setTemplate(Template)</code> instead.</p>
<p><code class="literal">setRescorer(Rescorer)</code> and <code class="literal">setRescorer(Rescorer, int)</code> have been removed in favor of <code class="literal">setRescorer(RescoreBuilder)</code> and <code class="literal">setRescorer(RescoreBuilder, int)</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_searchrequest"></a>SearchRequest<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h3>
</div></div></div>
<p>All <code class="literal">source</code> methods have been removed in favor of a single <code class="literal">source(SearchSourceBuilder)</code> method. This means that all search requests can now be validated
at call time which results in much clearer errors.</p>
<p>All <code class="literal">extraSource</code> methods have been removed.</p>
<p>All <code class="literal">template</code> methods have been removed in favor of a new Search Template API. A new <code class="literal">SearchTemplateRequest</code> now accepts a template and
a <code class="literal">SearchRequest</code> and must be executed using the new <code class="literal">SearchTemplateAction</code> action.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_searchresponse"></a>SearchResponse<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h3>
</div></div></div>
<p>Sort values for <code class="literal">string</code> fields are now return as <code class="literal">java.lang.String</code> objects rather than <code class="literal">org.elasticsearch.common.text.Text</code>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_aggregationbuilder"></a>AggregationBuilder<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h3>
</div></div></div>
<p>All methods which take an <code class="literal">XContentBuilder</code>, <code class="literal">BytesReference</code> <code class="literal">Map&lt;String, Object&gt;</code> or <code class="literal">bytes[]</code> have been removed in favor of providing the
relevant builder object (i.e. <code class="literal">subAggregation(AggregationBuilder)</code> or <code class="literal">subAggregation(PipelineAggregationBuilder)</code>). This means that all
requests can now be validated at call time which results in much clearer errors.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_validatequeryrequest"></a>ValidateQueryRequest<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">source(QuerySourceBuilder)</code>, <code class="literal">source(Map)</code>, <code class="literal">source(XContentBuilder)</code>, <code class="literal">source(String)</code>, <code class="literal">source(byte[])</code>, <code class="literal">source(byte[], int, int)</code>,
<code class="literal">source(BytesReference)</code> and <code class="literal">source()</code> have been removed in favor of using <code class="literal">query(QueryBuilder)</code> and <code class="literal">query()</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_validatequeryrequestbuilder"></a>ValidateQueryRequestBuilder<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">setSource()</code> methods have been removed in favor of using <code class="literal">setQuery(QueryBuilder)</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_explainrequest"></a>ExplainRequest<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">source(QuerySourceBuilder)</code>, <code class="literal">source(Map)</code>, <code class="literal">source(BytesReference)</code> and <code class="literal">source()</code> have been removed in favor of using
<code class="literal">query(QueryBuilder)</code> and <code class="literal">query()</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_explainrequestbuilder"></a>ExplainRequestBuilder<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h3>
</div></div></div>
<p>The <code class="literal">setQuery(BytesReference)</code> method have been removed in favor of using <code class="literal">setQuery(QueryBuilder)</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_clusterstatsresponse"></a>ClusterStatsResponse<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h3>
</div></div></div>
<p>Removed the <code class="literal">getMemoryAvailable</code> method from <code class="literal">OsStats</code>, which could be previously accessed calling
<code class="literal">clusterStatsResponse.getNodesStats().getOs().getMemoryAvailable()</code>. It is now replaced with
<code class="literal">clusterStatsResponse.getNodesStats().getOs().getMem()</code> which exposes <code class="literal">getTotal()</code>, <code class="literal">getFree()</code>,
<code class="literal">getUsed()</code>, <code class="literal">getFreePercent()</code> and <code class="literal">getUsedPercent()</code>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_setrefresh_boolean_has_been_removed"></a>setRefresh(boolean) has been removed<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">setRefresh(boolean)</code> has been removed in favor of <code class="literal">setRefreshPolicy(RefreshPolicy)</code> because there
are now three options (NONE, IMMEDIATE, and WAIT_FOR). <code class="literal">setRefresh(IMMEDIATE)</code> has the same behavior
as <code class="literal">setRefresh(true)</code> used to have. See <code class="literal">setRefreshPolicy</code>'s javadoc for more.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_remove_properties_support_2"></a>Remove properties support<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h3>
</div></div></div>
<p>Some Java APIs (e.g., <code class="literal">IndicesAdminClient#setSettings</code>) would support Java properties syntax
(line-delimited key=value pairs). This support has been removed.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_render_search_template_java_api_has_been_removed"></a>Render Search Template Java API has been removed<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h3>
</div></div></div>
<p>The Render Search Template Java API including <code class="literal">RenderSearchTemplateAction</code>, <code class="literal">RenderSearchTemplateRequest</code> and
<code class="literal">RenderSearchTemplateResponse</code> has been removed in favor of a new <code class="literal">simulate</code> option in the Search Template Java API.
 This Search Template API is now included in the <code class="literal">lang-mustache</code> module and the <code class="literal">simulate</code> flag must be set on the
 <code class="literal">SearchTemplateRequest</code> object.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_analyzerequest"></a>AnalyzeRequest<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h3>
</div></div></div>
<p>The <code class="literal">tokenFilters(String...)</code> and <code class="literal">charFilters(String...)</code> methods have been removed
in favor of using <code class="literal">addTokenFilter(String)</code>/<code class="literal">addTokenFilter(Map)</code> and <code class="literal">addCharFilter(String)</code>/<code class="literal">addCharFilter(Map)</code> each filters</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_analyzerequestbuilder"></a>AnalyzeRequestBuilder<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h3>
</div></div></div>
<p>The <code class="literal">setTokenFilters(String...)</code> and <code class="literal">setCharFilters(String...)</code> methods have been removed
in favor of using <code class="literal">addTokenFilter(String)</code>/<code class="literal">addTokenFilter(Map)</code> and <code class="literal">addCharFilter(String)</code>/<code class="literal">addCharFilter(Map)</code> each filters</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_clusterhealthrequest"></a>ClusterHealthRequest<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h3>
</div></div></div>
<p>The <code class="literal">waitForRelocatingShards(int)</code> method has been removed in favor of <code class="literal">waitForNoRelocatingShards(boolean)</code>
which instead uses a boolean flag to denote whether the cluster health operation should wait for there to
be no relocating shards in the cluster before returning.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_clusterhealthrequestbuilder"></a>ClusterHealthRequestBuilder<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h3>
</div></div></div>
<p>The <code class="literal">setWaitForRelocatingShards(int)</code> method has been removed in favor of <code class="literal">setWaitForNoRelocatingShards(boolean)</code>
which instead uses a boolean flag to denote whether the cluster health operation should wait for there to
be no relocating shards in the cluster before returning.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_blobcontainer_interface_for_snapshot_restore"></a>BlobContainer Interface for Snapshot/Restore<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h3>
</div></div></div>
<p>Some methods have been removed from the <code class="literal">BlobContainer</code> interface for Snapshot/Restore repositories.  In particular,
the following three methods have been removed:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<code class="literal">deleteBlobs(Collection&lt;String&gt;)</code> (use <code class="literal">deleteBlob(String)</code> instead)
</li>
<li class="listitem">
<code class="literal">deleteBlobsByPrefix(String)</code> (use <code class="literal">deleteBlob(String)</code> instead)
</li>
<li class="listitem">
<code class="literal">writeBlob(String, BytesReference)</code> (use <code class="literal">writeBlob(String, InputStream, long)</code> instead)
</li>
</ol>
</div>
<p>The <code class="literal">deleteBlob</code> methods that took multiple blobs as arguments were deleted because no atomic guarantees can be made about either deleting all blobs or deleting none of them, and exception handling in such a situation is ambiguous and best left to the caller. Hence, all delete blob calls use the singular <code class="literal">deleteBlob(String)</code> method.</p>
<p>The extra <code class="literal">writeBlob</code> method offered no real advantage to the interface and all calls to <code class="literal">writeBlob(blobName, bytesRef)</code> can be replaced with:</p>
<div class="pre_wrapper lang-java">
<pre class="programlisting prettyprint lang-java">try (InputStream stream = bytesRef.streamInput()) {
    blobContainer.writeBlob(blobName, stream, bytesRef.length());
}</pre>
</div>
<p>For any custom implementation of the <code class="literal">BlobContainer</code> interface, these three methods must be removed.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_nodebuilder_removed"></a>NodeBuilder removed<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/5.3/docs/reference/migration/migrate_5_0/java.asciidoc">edit</a></h3>
</div></div></div>
<p>NodeBuilder has been removed. While using Node directly within an application is not officially supported, it can still be constructed with the <code class="literal">Node(Settings)</code> constructor.</p>
</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="breaking_50_cat_api.html">« CAT API changes</a>
</span>
<span class="next">
<a href="breaking_50_packaging.html">Packaging »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
