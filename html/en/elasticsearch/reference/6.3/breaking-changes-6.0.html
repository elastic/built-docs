<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Breaking changes in 6.0 | Elasticsearch Guide [6.3] | Elastic</title>
<link rel="home" href="index.html" title="Elasticsearch Guide [6.3]"/>
<link rel="up" href="breaking-changes.html" title="Breaking changes"/>
<link rel="prev" href="breaking-changes.html" title="Breaking changes"/>
<link rel="next" href="breaking-changes-6.1.html" title="Breaking changes in 6.1"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/6.3"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="6.3"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <!--© 2015-2022 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!--BEGIN QUALTRICS WEBSITE FEEDBACK SNIPPET-->
    <script type='text/javascript'>
      (function(){var g=function(e,h,f,g){
      this.get=function(a){for(var a=a+"=",c=document.cookie.split(";"),b=0,e=c.length;b<e;b++){for(var d=c[b];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return null};
      this.set=function(a,c){var b="",b=new Date;b.setTime(b.getTime()+6048E5);b="; expires="+b.toGMTString();document.cookie=a+"="+c+b+"; path=/; "};
      this.check=function(){var a=this.get(f);if(a)a=a.split(":");else if(100!=e)"v"==h&&(e=Math.random()>=e/100?0:100),a=[h,e,0],this.set(f,a.join(":"));else return!0;var c=a[1];if(100==c)return!0;switch(a[0]){case "v":return!1;case "r":return c=a[2]%Math.floor(100/c),a[2]++,this.set(f,a.join(":")),!c}return!0};
      this.go=function(){if(this.check()){var a=document.createElement("script");a.type="text/javascript";a.src=g;document.body&&document.body.appendChild(a)}};
      this.start=function(){var a=this;window.addEventListener?window.addEventListener("load",function(){a.go()},!1):window.attachEvent&&window.attachEvent("onload",function(){a.go()})}};
      try{(new g(100,"r","QSI_S_ZN_emkP0oSe9Qrn7kF","https://znemkp0ose9qrn7kf-elastic.siteintercept.qualtrics.com/WRSiteInterceptEngine/?Q_ZID=ZN_emkP0oSe9Qrn7kF")).start()}catch(i){}})();
    </script><div id='ZN_emkP0oSe9Qrn7kF'><!--DO NOT REMOVE-CONTENTS PLACED HERE--></div>
    <!--END WEBSITE FEEDBACK SNIPPET-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  <div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="index.html">Elasticsearch Guide [6.3]</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="breaking-changes.html">Breaking changes</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="breaking-changes.html">« Breaking changes</a>
</span>
<span class="next">
<a href="breaking-changes-6.1.html">Breaking changes in 6.1 »</a>
</span>
</div>
<div class="chapter">
<div class="titlepage"><div><div>
<h2 class="title"><a id="breaking-changes-6.0"></a>Breaking changes in 6.0<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0.asciidoc">edit</a></h2>
</div></div></div>

<p>This section discusses the changes that you need to be aware of when migrating
your application to Elasticsearch 6.0.</p>
<h3><a id="_indices_created_before_6_0"></a>Indices created before 6.0<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0.asciidoc">edit</a></h3>
<p>Elasticsearch 6.0 can read indices created in version 5.0 or above.  An
Elasticsearch 6.0 node will not start in the presence of indices created in a
version of Elasticsearch before 5.0.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<h3>Reindex indices from Elasticsearch 2.x or before</h3>
<p>Indices created in Elasticsearch 2.x or before will need to be reindexed with
Elasticsearch 5.x in order to be readable by Elasticsearch 6.x.</p>
</div>
</div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<h3>Multiple mapping types are not supported in indices created in 6.0</h3>
<p>The ability to have multiple mapping types per index has been removed in 6.0.
New indices will be restricted to a single type. This is the first step in the
plan to remove mapping types altogether.  Indices created in 5.x will continue
to support multiple mapping types.</p>
<p>See <a class="xref" href="removal-of-types.html" title="Removal of mapping types"><em>Removal of mapping types</em></a> for more information.</p>
</div>
</div>
<h3><a id="_also_see"></a>Also see:<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0.asciidoc">edit</a></h3>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="breaking-changes-6.0.html#breaking_60_aggregations_changes" title="Aggregations changes">Aggregations changes</a>
</li>
<li class="listitem">
<a class="xref" href="breaking-changes-6.0.html#breaking_60_cat_changes" title="Cat API changes">Cat API changes</a>
</li>
<li class="listitem">
<a class="xref" href="breaking-changes-6.0.html#breaking_60_clients_changes" title="Clients changes">Clients changes</a>
</li>
<li class="listitem">
<a class="xref" href="breaking-changes-6.0.html#breaking_60_cluster_changes" title="Cluster changes">Cluster changes</a>
</li>
<li class="listitem">
<a class="xref" href="breaking-changes-6.0.html#breaking_60_docs_changes" title="Document API changes">Document API changes</a>
</li>
<li class="listitem">
<a class="xref" href="breaking-changes-6.0.html#breaking_60_indices_changes" title="Indices changes">Indices changes</a>
</li>
<li class="listitem">
<a class="xref" href="breaking-changes-6.0.html#breaking_60_ingest_changes" title="Ingest changes">Ingest changes</a>
</li>
<li class="listitem">
<a class="xref" href="breaking-changes-6.0.html#breaking_60_java_changes" title="Java API changes">Java API changes</a>
</li>
<li class="listitem">
<a class="xref" href="breaking-changes-6.0.html#breaking_60_mappings_changes" title="Mapping changes">Mapping changes</a>
</li>
<li class="listitem">
<a class="xref" href="breaking-changes-6.0.html#breaking_60_packaging_changes" title="Packaging changes">Packaging changes</a>
</li>
<li class="listitem">
<a class="xref" href="breaking-changes-6.0.html#breaking_60_percolator_changes" title="Percolator changes">Percolator changes</a>
</li>
<li class="listitem">
<a class="xref" href="breaking-changes-6.0.html#breaking_60_plugins_changes" title="Plugins changes">Plugins changes</a>
</li>
<li class="listitem">
<a class="xref" href="breaking-changes-6.0.html#breaking_60_reindex_changes" title="Reindex changes">Reindex changes</a>
</li>
<li class="listitem">
<a class="xref" href="breaking-changes-6.0.html#breaking_60_rest_changes" title="REST changes">REST changes</a>
</li>
<li class="listitem">
<a class="xref" href="breaking-changes-6.0.html#breaking_60_stats_changes" title="Stats and info changes">Stats and info changes</a>
</li>
<li class="listitem">
<a class="xref" href="breaking-changes-6.0.html#breaking_60_search_changes" title="Search and Query DSL changes">Search and Query DSL changes</a>
</li>
<li class="listitem">
<a class="xref" href="breaking-changes-6.0.html#breaking_60_settings_changes" title="Settings changes">Settings changes</a>
</li>
<li class="listitem">
<a class="xref" href="breaking-changes-6.0.html#breaking_60_scripting_changes" title="Scripting changes">Scripting changes</a>
</li>
</ul>
</div>
<h3><a id="breaking_60_aggregations_changes"></a>Aggregations changes<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/aggregations.asciidoc">edit</a></h3>
<h4><a id="_deprecated_literal_pattern_literal_element_of_include_exclude_for_terms_aggregations_has_been_removed"></a>Deprecated <code class="literal">pattern</code> element of include/exclude for terms aggregations has been removed<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/aggregations.asciidoc">edit</a></h4>
<p>The <code class="literal">include</code> and <code class="literal">exclude</code> options of <code class="literal">terms</code> aggregations used to accept a
sub <code class="literal">pattern</code> object which has been removed. The pattern should now be directly
put as a value of the <code class="literal">include</code> and <code class="literal">exclude</code> fields. For instance, the below
<code class="literal">terms</code> aggregation:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /twitter/_search?size=0
{
    "aggs" : {
        "top_users" : {
            "terms" : {
                "field" : "user",
                "include": {
                  "pattern": "foo.*"
                },
                "exclude": {
                  "pattern": ".*bar"
                }
            }
        }
    }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/1501.console"></div>
<p>should be replaced with:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /twitter/_search?size=0
{
    "aggs" : {
        "top_users" : {
            "terms" : {
                "field" : "user",
                "include": "foo.*",
                "exclude": ".*bar"
            }
        }
    }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/1502.console"></div>
<h4><a id="_numeric_literal_to_literal_and_literal_from_literal_parameters_in_literal_date_range_literal_aggregation_are_interpreted_according_to_literal_format_literal_now"></a>Numeric <code class="literal">to</code> and <code class="literal">from</code> parameters in <code class="literal">date_range</code> aggregation are interpreted according to <code class="literal">format</code> now<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/aggregations.asciidoc">edit</a></h4>
<p>Numeric <code class="literal">to</code> and <code class="literal">from</code> parameters in <code class="literal">date_range</code> aggregations used to always be interpreted as <code class="literal">epoch_millis</code>,
making other numeric formats like <code class="literal">epoch_seconds</code> unusable for numeric input values.
Now we interpret these parameters according to the <code class="literal">format</code> of the target field.
If the <code class="literal">format</code> in the mappings is not compatible with the numeric input value, a compatible
<code class="literal">format</code> (e.g. <code class="literal">epoch_millis</code>, <code class="literal">epoch_second</code>) must be specified in the <code class="literal">date_range</code> aggregation, otherwise an error is thrown.</p>
<h4><a id="_literal_global_ordinals_hash_literal_and_literal_global_ordinals_low_cardinality_literal_are_deprecated_in_the_literal_terms_literal_aggregation"></a><code class="literal">global_ordinals_hash</code> and <code class="literal">global_ordinals_low_cardinality</code> are deprecated in the <code class="literal">terms</code> aggregation<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/aggregations.asciidoc">edit</a></h4>
<p>The execution hints <code class="literal">global_ordinals_hash</code> and <code class="literal">global_ordinals_low_cardinality</code> are deprecated and should be replaced
by <code class="literal">global_ordinals</code> which now internally choose whether it should remap global ordinals to dense ordinals or directly use the
segment ordinals.</p>
<h3><a id="breaking_60_analysis_changes"></a>Analysis changes<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/analysis.asciidoc">edit</a></h3>
<h4><a id="_synonym_token_filter"></a>Synonym Token Filter<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/analysis.asciidoc">edit</a></h4>
<p>In 6.0, Synonym Token Filter tokenizes synonyms with whatever
tokenizer and token filters appear before it in the chain.</p>
<p>The <code class="literal">tokenizer</code> and <code class="literal">ignore_case</code> parameters are deprecated
and will be ignored when used in new indices.  These parameters
will continue to function as before when used in indices
created in 5.x.</p>
<h4><a id="_limiting_the_length_of_an_analyzed_text_during_highlighting"></a>Limiting the length of an analyzed text during highlighting<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/analysis.asciidoc">edit</a></h4>
<p>Highlighting a text that was indexed without offsets or term vectors,
requires analysis of this text in memory real time during the search request.
For large texts this analysis may take substantial amount of time and memory.
To protect against this, the maximum number of characters that to be analyzed will be
limited to 1000000 in the next major Elastic version. For this version, by default the limit
is not set. A deprecation warning will be issued when an analyzed text exceeds 1000000.
 The limit can be set for a particular index with the index setting
<code class="literal">index.highlight.max_analyzed_offset</code>.</p>
<h3><a id="breaking_60_cat_changes"></a>Cat API changes<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/cat.asciidoc">edit</a></h3>
<h4><a id="_unbounded_queue_size_in_cat_thread_pool"></a>Unbounded queue size in cat thread pool<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/cat.asciidoc">edit</a></h4>
<p>Previously if a queue size backing a thread pool was unbounded, the cat thread pool API would output an empty string in
the queue_size column. This has been changed to now output -1 so that the output is always present and always numeric.</p>
<h3><a id="breaking_60_clients_changes"></a>Clients changes<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/clients.asciidoc">edit</a></h3>
<h4><a id="_java_high_level_rest_client"></a>Java High Level REST Client<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/clients.asciidoc">edit</a></h4>
<p>Starting from version 5.6.0 a new Java client has been released: the Java High Level REST Client.
This official high-level client (named like this to differentiate it from the existing low-level client) for
Elasticsearch can be used to execute search, index, delete, update and bulk operations using the same Core
Java classes as the <code class="literal">TransportClient</code> uses.</p>
<p>This Java High Level REST Client is designed to replace the <code class="literal">TransportClient</code> in a near future.</p>
<h3><a id="breaking_60_cluster_changes"></a>Cluster changes<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/cluster.asciidoc">edit</a></h3>
<h4><a id="_cluster_name_no_longer_allowed_in_path_data"></a>Cluster name no longer allowed in path.data<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/cluster.asciidoc">edit</a></h4>
<p>Previously the cluster name could be used in the <code class="literal">path.data</code> setting with a
warning. This is now no longer allowed. For instance, in the previous version
this was valid:</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh"># Assuming path.data is /tmp/mydata
# No longer supported:
$ tree /tmp/mydata
/tmp/mydata
├── &lt;cluster_name&gt;
│   └── nodes
│       └── 0
│           └── &lt;etc&gt;

# Should be changed to:
$ tree /tmp/mydata
/tmp/mydata
├── nodes
│   └── 0
│       └── &lt;etc&gt;</pre>
</div>
<h3><a id="breaking_60_docs_changes"></a>Document API changes<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/docs.asciidoc">edit</a></h3>
<h4><a id="_version_type_literal_force_literal_removed"></a>version type <code class="literal">force</code> removed<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/docs.asciidoc">edit</a></h4>
<p>Document modification operations may no longer specify the <code class="literal">version_type</code> of
<code class="literal">force</code> to override any previous version checks.</p>
<h4><a id="_link_linkend_upserts_upserts_link_no_longer_support_versions"></a><a class="xref" href="docs-update.html#upserts" title="Upserts">Upserts</a> no longer support versions<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/docs.asciidoc">edit</a></h4>
<p>Adding a <code class="literal">version</code> to an upsert request is no longer supported.</p>
<h4><a id="_literal_created_literal_field_removed_in_the_index_api"></a><code class="literal">created</code> field removed in the Index API<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/docs.asciidoc">edit</a></h4>
<p>The <code class="literal">created</code> field has been removed in the Index API as in the <code class="literal">index</code> and
<code class="literal">create</code> bulk operations. <code class="literal">operation</code> field should be used instead.</p>
<h4><a id="_literal_found_literal_field_removed_in_the_delete_api"></a><code class="literal">found</code> field removed in the Delete API<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/docs.asciidoc">edit</a></h4>
<p>The <code class="literal">found</code> field has been removed in the Delete API as in the <code class="literal">delete</code> bulk
operations. <code class="literal">operation</code> field should be used instead.</p>
<h3><a id="breaking_60_geo_changes"></a>Geo changes<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/geo.asciidoc">edit</a></h3>
<h4><a id="_deprecated_literal_shapebuilders_literal_helper_class"></a>Deprecated <code class="literal">ShapeBuilders</code> helper class<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/geo.asciidoc">edit</a></h4>
<p>The <code class="literal">ShapeBuilders</code> class containing static methods to create shape specific builders
(e.g., <code class="literal">ShapeBuilders.newPoint</code>) has been deprecated. One must now use the builder&#8217;s
constructor instead (e.g., `new MultiPointBuilder()).</p>
<h4><a id="_deprecated_literal_shapebuilder_parse_literal_static_method"></a>Deprecated <code class="literal">ShapeBuilder.parse</code> static method<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/geo.asciidoc">edit</a></h4>
<p>The <code class="literal">ShapeBuilder.parse</code> method has been deprecated. Use <code class="literal">ShapeParser.parse</code> instead.</p>
<h3><a id="breaking_60_indices_changes"></a>Indices changes<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/indices.asciidoc">edit</a></h3>
<h4><a id="_index_templates_use_literal_index_patterns_literal_instead_of_literal_template_literal"></a>Index templates use <code class="literal">index_patterns</code> instead of <code class="literal">template</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/indices.asciidoc">edit</a></h4>
<p>Previously templates expressed the indices that they should match using a glob
style pattern in the <code class="literal">template</code> field. They should now use the <code class="literal">index_patterns</code>
field instead. As the name implies you can define multiple glob style patterns
in an array but for convenience defining a single pattern as a bare string is
also supported. So both of these examples are valid:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT _template/template_1
{
  "index_patterns": ["te*", "bar*"],
  "settings": {
    "number_of_shards": 1
  }
}
PUT _template/template_2
{
  "index_patterns": "te*",
  "settings": {
    "number_of_shards": 1
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/1503.console"></div>
<h4><a id="_shadow_replicas_have_been_removed"></a>Shadow Replicas have been removed<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/indices.asciidoc">edit</a></h4>
<p>Shadow replicas don&#8217;t see enough usage, and have been removed. This includes the
following settings:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">index.shared_filesystem</code>
</li>
<li class="listitem">
<code class="literal">index.shadow_replicas</code>
</li>
<li class="listitem">
<code class="literal">node.add_lock_id_to_custom_path</code>
</li>
</ul>
</div>
<h4><a id="_open_close_index_api_allows_wildcard_expressions_that_match_no_indices_by_default"></a>Open/Close index API allows wildcard expressions that match no indices by default<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/indices.asciidoc">edit</a></h4>
<p>The default value of the <code class="literal">allow_no_indices</code> option for the Open/Close index API
has been changed from <code class="literal">false</code> to <code class="literal">true</code> so it is aligned with the behaviour of the
Delete index API. As a result, Open/Close index API don&#8217;t return an error by
default when a provided wildcard expression doesn&#8217;t match any closed/open index.</p>
<h4><a id="_delete_a_document"></a>Delete a document<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/indices.asciidoc">edit</a></h4>
<p>Delete a document from non-existing index has been modified to not create the index.
However if an external versioning is used the index will be created and the document
will be marked for deletion.</p>
<h4><a id="_indices_aliases_api_resolves_indices_expressions_only_against_indices"></a>Indices aliases api resolves indices expressions only against indices<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/indices.asciidoc">edit</a></h4>
<p>The index parameter in the update-aliases, put-alias, and delete-alias APIs no
longer accepts alias names. Instead, it accepts only index names (or wildcards
which will expand to matching indices).</p>
<h4><a id="_delete_index_api_resolves_indices_expressions_only_against_indices"></a>Delete index api resolves indices expressions only against indices<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/indices.asciidoc">edit</a></h4>
<p>The index parameter in the delete index API no longer accepts alias names.
Instead, it accepts only index names (or wildcards which will expand to
matching indices).</p>
<h4><a id="_support_for_literal_literal_has_been_removed_in_index_expressions"></a>Support for <code class="literal">+</code> has been removed in index expressions<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/indices.asciidoc">edit</a></h4>
<p>Omitting the <code class="literal">+</code> has the same effect as specifying it, hence support for <code class="literal">+</code>
has been removed in index expressions.</p>
<h4><a id="_translog_retention"></a>Translog retention<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/indices.asciidoc">edit</a></h4>
<p>Translog files are now kept for up to 12 hours (by default), with a maximum size of <code class="literal">512mb</code> (default), and
are no longer deleted on <code class="literal">flush</code>. This is to increase the chance of doing an operation based recovery when
bringing up replicas up to speed.</p>
<h4><a id="_limit_to_the_difference_between_max_size_and_min_size_in_ngramtokenfilter_and_ngramtokenizer"></a>Limit to the difference between max_size and min_size in NGramTokenFilter and NGramTokenizer<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/indices.asciidoc">edit</a></h4>
<p>To safeguard against creating too many index terms, the difference between
max_ngram and min_ngram in NGramTokenFilter and NGramTokenizer has been
limited to 1. This default limit can be changed with the index setting
index.max_ngram_diff. Note that if the limit is exceeded a deprecation
warning is logged.</p>
<h4><a id="_limit_to_the_difference_between_max_size_and_min_size_in_shingletokenfilter"></a>Limit to the difference between max_size and min_size in ShingleTokenFilter<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/indices.asciidoc">edit</a></h4>
<p>To safeguard against creating too many tokens, the difference between
max_shingle_size and min_shingle_size in ShingleTokenFilter has been
limited to 3. This default limit can be changed with the index setting
index.max_shingle_diff. Note that if the limit is exceeded a deprecation
warning will be logged.</p>
<h3><a id="breaking_60_ingest_changes"></a>Ingest changes<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/ingest.asciidoc">edit</a></h3>
<h4><a id="_timestamp_meta_data_field_type_has_changed"></a>Timestamp meta-data field type has changed<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/ingest.asciidoc">edit</a></h4>
<p>The type of the "timestamp" meta-data field has changed from <code class="literal">java.lang.String</code> to <code class="literal">java.util.Date</code>.</p>
<h4><a id="_the_format_of_the_string_formatted_ingest_timestamp_field_has_changed"></a>The format of the string-formatted ingest.timestamp field has changed<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/ingest.asciidoc">edit</a></h4>
<p>Previously, since Elasticsearch 5.4.0, you needed to use <code class="literal">ingest.new_date_format</code> to have the
<code class="literal">ingest.timestamp</code> metadata field be formatted in such a way that ES can coerce it to a field
of type <code class="literal">date</code> without further transformation. This is not necessary anymore and this setting was
removed. You can now simply set a field to <code class="literal">{{ingest.timestamp}}</code> in a pipeline, and have that
field be of type <code class="literal">date</code> without any mapping errors.</p>
<h3><a id="breaking_60_java_changes"></a>Java API changes<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/java.asciidoc">edit</a></h3>
<h4><a id="_literal_setsource_literal_methods_require_xcontenttype"></a><code class="literal">setSource</code> methods require XContentType<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/java.asciidoc">edit</a></h4>
<p>Previously the <code class="literal">setSource</code> methods and other methods that accepted byte/string representations of
an object source did not require the XContentType to be specified. The auto-detection of the content
type is no longer used, so these methods now require the XContentType as an additional argument when
providing the source in bytes or as a string.</p>
<h4><a id="_literal_deletebyqueryrequest_literal_requires_an_explicitly_set_query"></a><code class="literal">DeleteByQueryRequest</code> requires an explicitly set query<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/java.asciidoc">edit</a></h4>
<p>In previous versions of Elasticsearch, delete by query requests without an explicit query
were accepted, match_all was used as the default query and all documents were deleted
as a result. From version 6.0.0, a <code class="literal">DeleteByQueryRequest</code> requires an explicit query be set.</p>
<h4><a id="_literal_internalstats_literal_and_literal_stats_literal_getcountasstring_method_removed"></a><code class="literal">InternalStats</code> and <code class="literal">Stats</code> getCountAsString() method removed<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/java.asciidoc">edit</a></h4>
<p>The <code class="literal">count</code> value in the stats aggregation represents a doc count that shouldn&#8217;t require a formatted
version. This method was deprecated in 5.4 in favour of just using
<code class="literal">String.valueOf(getCount())</code> if needed</p>
<h4><a id="_literal_actionrequestbuilder_execute_literal_returns_literal_actionfuture_literal_rather_than_literal_listenableactionfuture_literal"></a><code class="literal">ActionRequestBuilder#execute</code> returns <code class="literal">ActionFuture</code> rather than <code class="literal">ListenableActionFuture</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/java.asciidoc">edit</a></h4>
<p>When sending a request through the request builders e.g. client.prepareSearch().execute(), it used to
be possible to call <code class="literal">addListener</code> against the returned <code class="literal">ListenableActionFuture</code>. With this change an
<code class="literal">ActionFuture</code> is returned instead, which is consistent with what the <code class="literal">Client</code> methods return, hence
it is not possible to associate the future with listeners. The <code class="literal">execute</code> method that accept a listener
as an argument can be used instead.</p>
<h4><a id="_literal_terms_order_literal_and_literal_histogram_order_literal_classes_replace_by_literal_bucketorder_literal"></a><code class="literal">Terms.Order</code> and <code class="literal">Histogram.Order</code> classes replace by <code class="literal">BucketOrder</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/java.asciidoc">edit</a></h4>
<p>The <code class="literal">terms</code>, <code class="literal">histogram</code>, and <code class="literal">date_histogram</code> aggregation code has been refactored to use common
code for ordering buckets. The <code class="literal">BucketOrder</code> class must be used instead of <code class="literal">Terms.Order</code> and
<code class="literal">Histogram.Order</code>. The <code class="literal">static</code> methods in the <code class="literal">BucketOrder</code> class must be called instead of directly
accessing internal order instances, e.g. <code class="literal">BucketOrder.count(boolean)</code> and <code class="literal">BucketOrder.aggregation(String, boolean)</code>.
Use <code class="literal">BucketOrder.key(boolean)</code> to order the <code class="literal">terms</code> aggregation buckets by <code class="literal">_term</code>.</p>
<h4><a id="_literal_gettookinmillis_literal_removed_in_literal_bulkresponse_literal_literal_searchresponse_literal_and_literal_termvectorsresponse_literal"></a><code class="literal">getTookInMillis()</code> removed in <code class="literal">BulkResponse</code>, <code class="literal">SearchResponse</code> and <code class="literal">TermVectorsResponse</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/java.asciidoc">edit</a></h4>
<p>In <code class="literal">BulkResponse</code>, <code class="literal">SearchResponse</code> and <code class="literal">TermVectorsResponse</code> <code class="literal">getTookInMiilis()</code> method
has been removed in favor of <code class="literal">getTook</code> method. <code class="literal">getTookInMiilis()</code> is easily replaced by
<code class="literal">getTook().getMillis()</code>.</p>
<h4><a id="_literal_getfield_literal_and_literal_searchhitfield_literal_replaced_by_literal_documentfield_literal"></a><code class="literal">GetField</code> and <code class="literal">SearchHitField</code> replaced by <code class="literal">DocumentField</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/java.asciidoc">edit</a></h4>
<p>As <code class="literal">GetField</code> and <code class="literal">SearchHitField</code> have the same members, they have been unified into
<code class="literal">DocumentField</code>.</p>
<h4><a id="_some_aggregation_classes_have_moved_packages"></a>Some Aggregation classes have moved packages<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/java.asciidoc">edit</a></h4>
<p>The classes for the variants of the range aggregation (geo_distance, date and ip) were moved into the <code class="literal">org.elasticsearch.search.aggregations.bucket.range</code>
package.</p>
<p>The <code class="literal">org.elasticsearch.search.aggregations.bucket.terms.support</code> package was removed and the classes were moved to
<code class="literal">org.elasticsearch.search.aggregations.bucket.terms</code>.</p>
<p>The filter aggregation classes were moved to <code class="literal">org.elasticsearch.search.aggregations.bucket.filter</code></p>
<h4><a id="_constructor_for_literal_percentileranksaggregationbuilder_literal_has_changed"></a>Constructor for <code class="literal">PercentileRanksAggregationBuilder</code> has changed<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/java.asciidoc">edit</a></h4>
<p>It is now required to include the desired ranks as a non-null, non-empty array of doubles to the builder&#8217;s constructor,
rather than configuring them via a setter on the builder. The setter method <code class="literal">values()</code> has correspondingly
been removed.</p>
<h3><a id="breaking_60_mappings_changes"></a>Mapping changes<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/mappings.asciidoc">edit</a></h3>
<h4><a id="_coercion_of_boolean_fields"></a>Coercion of boolean fields<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/mappings.asciidoc">edit</a></h4>
<p>Previously, Elasticsearch recognized the strings <code class="literal">true</code>, <code class="literal">false</code>, <code class="literal">on</code>, <code class="literal">off</code>, <code class="literal">yes</code>, <code class="literal">no</code>, <code class="literal">0</code>, <code class="literal">1</code> as booleans. Elasticsearch 6.0
recognizes only the strings <code class="literal">true</code> and <code class="literal">false</code> as booleans and will throw an error otherwise. For backwards compatibility purposes, during the 6.x
series the previous coercion rules will continue to work on pre-6.0 indices. This means that you do not need to change affected existing
mappings immediately. However, it is not possible to create new indices from existing index templates that violate the strict <code class="literal">boolean</code>
coercion rules.</p>
<h4><a id="_the_literal__all_literal_meta_field_is_now_disabled_by_default"></a>The <code class="literal">_all</code> meta field is now disabled by default<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/mappings.asciidoc">edit</a></h4>
<p>On new mappings, the <code class="literal">_all</code> meta field that contains a copy of the text from
each field is now disabled by default. The <code class="literal">query_string</code> and
<code class="literal">simple_query_string</code> queries that previously used <code class="literal">_all</code> to search will now
check if <code class="literal">_all</code> is enabled/disabled and switch to executing the query across all
fields if <code class="literal">_all</code> is disabled. <code class="literal">_all</code> can no longer be configured for indices
created with Elasticsearch version 6.0 or later.</p>
<h4><a id="_the_literal_include_in_all_literal_mapping_parameter_is_now_disallowed"></a>The <code class="literal">include_in_all</code> mapping parameter is now disallowed<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/mappings.asciidoc">edit</a></h4>
<p>Since the <code class="literal">_all</code> field is now disabled by default and cannot be configured for
indices created with Elasticsearch 6.0 or later, the <code class="literal">include_in_all</code> setting is
now disallowed for these indices' mappings.</p>
<h4><a id="_unrecognized_literal_match_mapping_type_literal_options_not_silently_ignored"></a>Unrecognized <code class="literal">match_mapping_type</code> options not silently ignored<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/mappings.asciidoc">edit</a></h4>
<p>Previously Elasticsearch would silently ignore any dynamic templates that
included a <code class="literal">match_mapping_type</code> type that was unrecognized. An exception is now
thrown on an unrecognized type.</p>
<h4><a id="_validation_of_literal_locale_literal_on_date_fields"></a>Validation of <code class="literal">locale</code> on date fields<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/mappings.asciidoc">edit</a></h4>
<p>The <code class="literal">locale</code> option of <code class="literal">date</code> fields previously allowed almost any string values,
and unrecognized values would simply be ignored. Unrecognized values are now
rejected on indices created with Elasticsearch 6.0 or newer.</p>
<h3><a id="breaking_60_packaging_changes"></a>Packaging changes<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/packaging.asciidoc">edit</a></h3>
<h4><a id="_configuring_custom_user_and_group_for_package_is_no_longer_allowed"></a>Configuring custom user and group for package is no longer allowed<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/packaging.asciidoc">edit</a></h4>
<p>Previously someone could configure the <code class="literal">$ES_USER</code> and <code class="literal">$ES_GROUP</code> variables to
change which user and group Elasticsearch was run as. This is no longer
possible, the DEB and RPM packages now exclusively use the user and group
<code class="literal">elasticsearch</code>. If a custom user or group is needed then a provisioning system
should use the tarball distribution instead of the provided RPM and DEB
packages.</p>
<h4><a id="_literal_path_conf_literal_is_no_longer_a_configurable_setting"></a><code class="literal">path.conf</code> is no longer a configurable setting<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/packaging.asciidoc">edit</a></h4>
<p>Previous versions of Elasticsearch enabled setting <code class="literal">path.conf</code> as a
setting. This was rather convoluted as it meant that you could start
Elasticsearch with a config file that specified via <code class="literal">path.conf</code> that
Elasticsearch should use another config file. Instead, to configure a custom
config directory, use the <a class="xref" href="settings.html#config-files-location" title="Config files location"><code class="literal">ES_PATH_CONF</code> environment variable</a>.</p>
<h4><a id="_literal_conf_dir_literal_is_no_longer_supported"></a><code class="literal">CONF_DIR</code> is no longer supported<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/packaging.asciidoc">edit</a></h4>
<p>Previous versions of Elasticsearch enabled using the <code class="literal">CONF_DIR</code> environment
variable to specify a custom configuration directory for some configuration
files and some scripts (it was used inconsistently). Starting in Elasticsearch
6.0.0, the usage of this environment variable has been superceded by
<code class="literal">ES_PATH_CONF</code>, and this new environment variable is consistently used for all
configuration files and scripts.</p>
<h4><a id="_default_path_settings_are_removed"></a>Default path settings are removed<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/packaging.asciidoc">edit</a></h4>
<p>Previous versions of Elasticsearch enabled setting <code class="literal">default.path.data</code> and
<code class="literal">default.path.logs</code> to set the default data path and default logs path if they
were not otherwise set in the configuration file. These settings have been
removed and now data paths and log paths can be configured via settings
only. Related, this means that the environment variables <code class="literal">DATA_DIR</code> and
<code class="literal">LOG_DIR</code> no longer have any effect as these were used to set
<code class="literal">default.path.data</code> and <code class="literal">default.path.logs</code> in the packaging scripts.</p>
<p>Additionally, this means that if you were using the package distributions (i.e.,
you have installed Elasticsearch from the RPM or the DEB distributions), you had
not previously explicitly configured <code class="literal">path.data</code> or <code class="literal">path.logs</code>, and you carry
over your <code class="literal">elasticsearch.yml</code> file from 5.x, then you will need to add settings
for <code class="literal">path.data</code> and <code class="literal">path.logs</code>. To use the defaults that you were implicitly
using previously, you should add these lines to your <code class="literal">elasticsearch.yml</code>:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">path.data: /var/lib/elasticsearch
path.logs: /var/log/elasticsearch</pre>
</div>
<p>(If you already had explicit values for either of these settings, you should of
course preserve those). If you do not do this, Elasticsearch will refuse to
start.</p>
<h4><a id="_32_bit_is_no_longer_maintained"></a>32-bit is no longer maintained<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/packaging.asciidoc">edit</a></h4>
<p>We previously attempted to ensure that Elasticsearch could be started on 32-bit
JVM (although a bootstrap check prevented using a 32-bit JVM in production). We
are no longer maintaining this attempt.</p>
<h4><a id="_literal_server_literal_flag_no_longer_filtered_in_the_windows_service"></a><code class="literal">-server</code> flag no longer filtered in the Windows service<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/packaging.asciidoc">edit</a></h4>
<p>Related to the previous change that 32-bit is no longer supported, the default
<code class="literal">jvm.options</code> file that ships with Elasticsearch no longer includes the
<code class="literal">-server</code> flag. Previously, the installation of the Windows service would filter
the <code class="literal">-server</code> flag because it is not compatible with the service. Since the
default <code class="literal">jvm.options</code> file no longer includes <code class="literal">-server</code>, the filtering of this
flag was removed from the installation of the Windows service. This means that
if you have a <code class="literal">jvm.options</code> file that includes this flag you will need to remove
it.</p>
<h4><a id="_literal_es_jvm_options_literal_is_no_longer_supported"></a><code class="literal">ES_JVM_OPTIONS</code> is no longer supported<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/packaging.asciidoc">edit</a></h4>
<p>The environment variable <code class="literal">ES_JVM_OPTIONS</code> that enabled a custom location for the
<code class="literal">jvm.options</code> file has been removed in favor of using the environment variable
<code class="literal">ES_PATH_CONF</code>. This environment variable is already used in the packaging to
support relocating the configuration files so this change merely aligns the
other configuration files with the location of the <code class="literal">jvm.options</code> file.</p>
<h4><a id="_literal_es_include_literal_is_no_longer_supported"></a><code class="literal">ES_INCLUDE</code> is no longer supported<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/packaging.asciidoc">edit</a></h4>
<p>The environment variable <code class="literal">ES_INCLUDE</code> could previously be used to establish the
environment used to start Elasticsearch (and various supporting scripts). This
legacy feature could be useful when there were several environment variables
useful for configuring JVM options; this functionality had previously been
replaced by <a class="xref" href="jvm-options.html" title="Setting JVM options">Setting JVM options</a>. Therefore, <code class="literal">ES_INCLUDE</code> has been removed.</p>
<h3><a id="breaking_60_percolator_changes"></a>Percolator changes<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/percolator.asciidoc">edit</a></h3>
<h4><a id="_deprecated_percolator_and_mpercolate_apis_have_been_removed"></a>Deprecated percolator and mpercolate apis have been removed<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/percolator.asciidoc">edit</a></h4>
<p>Instead the <code class="literal">percolate</code> query should be used via either the search or msearch apis.</p>
<h4><a id="_the_percolator_map_unmapped_fields_as_string_setting_has_been_deprecated"></a>The percolator.map_unmapped_fields_as_string setting has been deprecated<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/percolator.asciidoc">edit</a></h4>
<p>The <code class="literal">percolator.map_unmapped_fields_as_text</code> setting should be used instead.</p>
<h3><a id="breaking_60_plugins_changes"></a>Plugins changes<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/plugins.asciidoc">edit</a></h3>
<h4><a id="_mapper_attachments_plugin"></a>Mapper attachments plugin<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/plugins.asciidoc">edit</a></h4>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
The mapper attachments plugin has been deprecated in elasticsearch 5.0 and is now removed.
You can use <a href="/guide/en/elasticsearch/plugins/6.3/ingest-attachment.html" class="ulink" target="_top">ingest attachment plugin</a> instead.
</li>
</ul>
</div>
<h4><a id="_s3_repository_plugin"></a>S3 Repository plugin<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/plugins.asciidoc">edit</a></h4>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
The bucket an s3 repository is configured with will no longer be created automatically.
It must exist before the s3 repository is created.
</li>
<li class="listitem">
Support for specifying s3 credentials through environment variables and
system properties has been removed. Use the <code class="literal">elasticsearch-keystore</code> tool
to securely store the credentials.
</li>
<li class="listitem">
Specifying region has been removed. This includes the settings <code class="literal">cloud.aws.region</code>,
<code class="literal">cloud.aws.s3.region</code>, <code class="literal">repositories.s3.region</code>, and specifying
region inside the repository settings. Instead, specify the full endpoint if a custom
s3 location is needed, or rely on the default behavior which automatically locates
the region of the configured bucket.
</li>
<li class="listitem">
Specifying s3 signer type has been removed, including <code class="literal">cloud.aws.signer</code> and <code class="literal">cloud.aws.s3.signer</code>.
</li>
<li class="listitem">
Global repositories settings have been removed. This includes <code class="literal">repositories.s3.bucket</code>,
<code class="literal">repositories.s3.server_side_encryption</code>, <code class="literal">repositories.s3.buffer_size</code>,
<code class="literal">repositories.s3.max_retries</code>, <code class="literal">repositories.s3.use_throttle_retries</code>,
<code class="literal">repositories.s3.chunk_size</code>, <code class="literal">repositories.s3.compress</code>, <code class="literal">repositories.s3.storage_class</code>,
<code class="literal">repositories.s3.canned_acl</code>, <code class="literal">repositories.s3.base_path</code>, and
<code class="literal">repositories.s3.path_style_access</code>. Instead, these settings should be set directly in the
 settings per repository.
 See <a href="/guide/en/elasticsearch/plugins/6.3/repository-s3-repository.html" class="ulink" target="_top">S3 Repository settings</a>.
</li>
<li class="listitem">
Shared client settings have been removed. This includes  <code class="literal">cloud.aws.access_key</code>,
 <code class="literal">cloud.aws.secret_key</code>, <code class="literal">cloud.aws.protocol</code>, <code class="literal">cloud.aws.proxy.host</code>,
 <code class="literal">cloud.aws.proxy.port</code>, <code class="literal">cloud.aws.proxy.username</code>, <code class="literal">cloud.aws.proxy.password</code>,
 <code class="literal">cloud.aws.signer</code>, <code class="literal">cloud.aws.read_timeout</code>, <code class="literal">cloud.aws.s3.access_key</code>,
 <code class="literal">cloud.aws.s3.secret_key</code>, <code class="literal">cloud.aws.s3.protocol</code>, <code class="literal">cloud.aws.s3.proxy.host</code>,
 <code class="literal">cloud.aws.s3.proxy.port</code>, <code class="literal">cloud.aws.s3.proxy.username</code>, <code class="literal">cloud.aws.s3.proxy.password</code>,
 <code class="literal">cloud.aws.s3.signer</code>, <code class="literal">cloud.aws.s3.read_timeout</code>, <code class="literal">repositories.s3.access_key</code>,
 <code class="literal">repositories.s3.secret_key</code>, <code class="literal">repositories.s3.endpoint</code> and <code class="literal">repositories.s3.protocol</code>.
Instead, use the new named client settings under <code class="literal">s3.client.CLIENT_NAME.*</code>.
</li>
<li class="listitem">
The <code class="literal">path_style_access</code> setting has been removed. The repository will use the appropriate path style access based on the configured endpoint.
</li>
</ul>
</div>
<h4><a id="_azure_repository_plugin"></a>Azure Repository plugin<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/plugins.asciidoc">edit</a></h4>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
The container an azure repository is configured with will no longer be created automatically.
It must exist before the azure repository is created.
</li>
<li class="listitem">
Global repositories settings you are able to set in elasticsearch config file under <code class="literal">repositories.azure</code>
name space have been removed. This includes <code class="literal">repositories.azure.account</code>, <code class="literal">repositories.azure.container</code>,
<code class="literal">repositories.azure.base_path</code>, <code class="literal">repositories.azure.location_mode</code>, <code class="literal">repositories.azure.chunk_size</code> and
<code class="literal">repositories.azure.compress</code>.
You must set those settings per repository instead. Respectively <code class="literal">account</code>, <code class="literal">container</code>, <code class="literal">base_path</code>,
<code class="literal">location_mode</code>, <code class="literal">chunk_size</code> and <code class="literal">compress</code>.
See <a href="/guide/en/elasticsearch/plugins/6.3/repository-azure-repository-settings.html#repository-azure-repository-settings" class="ulink" target="_top">Azure Repository settings</a>.
</li>
</ul>
</div>
<h4><a id="_gcs_repository_plugin"></a>GCS Repository plugin<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/plugins.asciidoc">edit</a></h4>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
The <code class="literal">service_account</code> setting has been removed. A service account json credential file must now be
specified in the <a class="xref" href="secure-settings.html" title="Secure settings">elasticsearch keystore</a>.
</li>
</ul>
</div>
<h4><a id="_ec2_discovery_plugin"></a>EC2 Discovery plugin<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/plugins.asciidoc">edit</a></h4>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Specifying ec2 signer type has been removed, including <code class="literal">cloud.aws.signer</code> and <code class="literal">cloud.aws.ec2.signer</code>.
</li>
<li class="listitem">
The region setting has been removed. This includes the settings <code class="literal">cloud.aws.region</code>
and <code class="literal">cloud.aws.ec2.region</code>. Instead, specify the full endpoint.
</li>
<li class="listitem">
All <code class="literal">cloud.aws.*</code> and <code class="literal">cloud.aws.ec2.*</code> settings have been removed. Use <code class="literal">discovery.ec2.*</code> settings instead.
</li>
</ul>
</div>
<h4><a id="_ignoring_hidden_folders"></a>Ignoring hidden folders<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/plugins.asciidoc">edit</a></h4>
<p>Previous versions of Elasticsearch would skip hidden files and directories when
scanning the plugins folder. This leniency has been removed.</p>
<h4><a id="_icu_analysis_plugin"></a>ICU Analysis plugin<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/plugins.asciidoc">edit</a></h4>
<p>The icu4j library has been upgraded to 59.1,
Indices created in the previous major version will need to be reindexed
in order to return correct (and correctly ordered) results,
and to take advantage of new characters.</p>
<h4><a id="_plugins_should_not_construct_literal_environment_literal_instances_from_literal_settings_literal"></a>Plugins should not construct <code class="literal">Environment</code> instances from <code class="literal">Settings</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/plugins.asciidoc">edit</a></h4>
<p>Previously, plugins could construct an <code class="literal">Environment</code> instance from <code class="literal">Settings</code> to
discover the path to plugin-specific config files. This will no longer work in
all situations as the <code class="literal">Settings</code> object does not carry the necessary information
for the config path to be set correctly. Instead, plugins that need to know the
config path should have a single constructor that accepts a pair of <code class="literal">Settings</code>
and <code class="literal">Path</code> instances, and construct an <code class="literal">Environment</code> using the corresponding
constructor on <code class="literal">Environment</code>.</p>
<h3><a id="breaking_60_reindex_changes"></a>Reindex changes<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/reindex.asciidoc">edit</a></h3>
<h4><a id="_literal_size_literal_parameter"></a><code class="literal">size</code> parameter<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/reindex.asciidoc">edit</a></h4>
<p>The <code class="literal">size</code> parameter can no longer be explicitly set to <code class="literal">-1</code>. If all documents are required then the <code class="literal">size</code> parameter should not be set.</p>
<h3><a id="breaking_60_rest_changes"></a>REST changes<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/rest.asciidoc">edit</a></h3>
<h4><a id="_unquoted_json"></a>Unquoted JSON<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/rest.asciidoc">edit</a></h4>
<p>In previous versions of Elasticsearch, JSON documents were allowed to contain unquoted field names.
This feature was removed in the 5.x series, but a backwards-compatibility layer was added via the
system property <code class="literal">elasticsearch.json.allow_unquoted_field_names</code>. This backwards-compatibility layer
has been removed in Elasticsearch 6.0.0.</p>
<h4><a id="_duplicate_keys_in_json_cbor_yaml_and_smile"></a>Duplicate Keys in JSON, CBOR, Yaml and Smile<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/rest.asciidoc">edit</a></h4>
<p>In previous versions of Elasticsearch, documents were allowed to contain duplicate keys. Elasticsearch 6.0.0
 enforces that all keys are unique. This applies to all content types: JSON, CBOR, Yaml and Smile.</p>
<h4><a id="_content_type_auto_detection"></a>Content-Type Auto-detection<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/rest.asciidoc">edit</a></h4>
<p>In previous versions of Elasticsearch, having a proper Content-Type for the data in a request was not enforced.
Elasticsearch 6.0.0 enforces that all requests with a body must have a supported Content-Type and this type will
be used when parsing the data.</p>
<p>When using the <code class="literal">source</code> query string parameter, the <code class="literal">source_content_type</code> parameter must also be specified with
the media type of the source.</p>
<h4><a id="_boolean_api_parameters"></a>Boolean API parameters<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/rest.asciidoc">edit</a></h4>
<p>All REST APIs parameters (both request parameters and JSON body) support providing boolean "false" as the
value <code class="literal">false</code> and boolean "true" as the value <code class="literal">true</code>. All other values will raise an error.</p>
<h4><a id="_analyze_api_changes"></a>Analyze API changes<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/rest.asciidoc">edit</a></h4>
<p>The deprecated request parameters and plain text in request body has been removed. Define parameters in request body.</p>
<h4><a id="_support_custom_normalizer_in_analyze_api"></a>Support custom normalizer in Analyze API<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/rest.asciidoc">edit</a></h4>
<p>Analyze API can analyze normalizer and custom normalizer.
In previous versions of Elasticsearch, Analyze API is requiring a <code class="literal">tokenizer</code> or <code class="literal">analyzer</code> parameter.
In Elasticsearch 6.0.0, Analyze API can analyze a text as a keyword field with custom normalizer
or if <code class="literal">char_filter</code>/<code class="literal">filter</code> is set and <code class="literal">tokenizer</code>/<code class="literal">analyzer</code> is not set.</p>
<h4><a id="_literal_timestamp_literal_and_literal_ttl_literal_in_index_requests"></a><code class="literal">timestamp</code> and <code class="literal">ttl</code> in index requests<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/rest.asciidoc">edit</a></h4>
<p><code class="literal">timestamp</code> and <code class="literal">ttl</code> are not accepted anymore as parameters of index/update
requests.</p>
<h4><a id="_refresh_requests_with_one_or_more_shard_failures_return_http_500_response_instead_of_200"></a>Refresh requests with one or more shard failures return HTTP 500 response instead of 200<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/rest.asciidoc">edit</a></h4>
<p>Refresh requests that are broadcast to multiple shards that can have one or more
shards fail during the request now return a 500 response instead of a 200
response in the event there is at least one failure.</p>
<h4><a id="_delete_by_query_api_requires_an_explicit_query"></a>Delete by Query API requires an explicit query<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/rest.asciidoc">edit</a></h4>
<p>In previous versions of Elasticsearch, delete by query requests without an explicit query
were accepted, match_all was used as the default query and all documents were deleted
as a result. From version 6.0.0, delete by query requests require an explicit query.</p>
<h4><a id="_delete_document_calls_now_implicitly_create_the_type"></a>DELETE document calls now implicitly create the type<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/rest.asciidoc">edit</a></h4>
<p>Running <code class="literal">DELETE index/type/id</code> now implicitly creates <code class="literal">type</code> with a default
mapping if it did not exist yet.</p>
<h4><a id="_indices_information_apis"></a>Indices information APIs<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/rest.asciidoc">edit</a></h4>
<p>Previously it was possible to execute <code class="literal">GET /_aliases,_mappings</code> or <code class="literal">GET
/myindex/_settings,_alias</code> by separating multiple types of requests with commas
in order to retrieve multiple types of information about one or more indices.
This comma-separation for retrieving multiple pieces of information has been
removed. <code class="literal">GET /_all</code> can be used to retrieve all aliases, settings, and
mappings for all indices.</p>
<p>In order to retrieve only the mapping for an index use:
<code class="literal">GET /myindex/_mapping</code> (or <code class="literal">_alias</code> for a list of aliases, or <code class="literal">_settings</code> for the settings).</p>
<h4><a id="_requests_to_existing_endpoints_with_incorrect_http_verb_now_return_405_responses"></a>Requests to existing endpoints with incorrect HTTP verb now return 405 responses<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/rest.asciidoc">edit</a></h4>
<p>Issuing a request to an endpoint that exists, but with an incorrect HTTP verb
(such as a <code class="literal">POST</code> request to <code class="literal">/myindex/_settings</code>) now returns an HTTP 405
response instead of a 404. An <code class="literal">Allow</code> header is added to the 405 responses
containing the allowed verbs. For example:</p>
<div class="pre_wrapper lang-text">
<pre class="programlisting prettyprint lang-text">$ curl -v -XPOST 'localhost:9200/my_index/_settings'
*   Trying 127.0.0.1...
* TCP_NODELAY set
* Connected to localhost (127.0.0.1) port 9200 (#0)
&gt; POST /my_index/_settings HTTP/1.1
&gt; Host: localhost:9200
&gt; User-Agent: curl/7.51.0
&gt; Accept: */*
&gt;
&lt; HTTP/1.1 405 Method Not Allowed
&lt; Allow: PUT,GET
&lt; content-type: application/json; charset=UTF-8
&lt; content-length: 134
&lt;
{
  "error" : "Incorrect HTTP method for uri [/my_index/_settings] and method [POST], allowed: [PUT, GET]",
  "status" : 405
}
* Curl_http_done: called premature == 0
* Connection #0 to host localhost left intact</pre>
</div>
<h4><a id="_disallow_using_literal__cache_literal_and_literal__cache_key_literal"></a>Disallow using <code class="literal">_cache</code> and <code class="literal">_cache_key</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/rest.asciidoc">edit</a></h4>
<p>The <code class="literal">_cache</code> and <code class="literal">_cache_key</code> options in queries have been deprecated since version 2.0.0 and
have been ignored since then, issuing a deprecation warning. These options have now been completely
removed, so using them now will throw an error.</p>
<h4><a id="_indexclosedexception_to_return_400_status_code"></a>IndexClosedException to return 400 status code<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/rest.asciidoc">edit</a></h4>
<p>An <code class="literal">IndexClosedException</code> is returned whenever an api that doesn&#8217;t support
closed indices (e.g. search) is called passing closed indices as parameters
and <code class="literal">ignore_unavailable</code> is set to <code class="literal">false</code>. The response status code returned
in such case changed from <code class="literal">403</code> to <code class="literal">400</code></p>
<h3><a id="breaking_60_scripting_changes"></a>Scripting changes<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/scripting.asciidoc">edit</a></h3>
<h4><a id="_groovy_javascript_and_python_languages_removed"></a>Groovy, JavaScript, and Python languages removed<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/scripting.asciidoc">edit</a></h4>
<p>The Groovy, JavaScript, and Python scripting languages were deprecated in
elasticsearch 5.0 and have now been removed. Use painless instead.</p>
<h4><a id="_native_scripts_removed"></a>Native scripts removed<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/scripting.asciidoc">edit</a></h4>
<p>Native scripts have been removed. Instead,
<a class="xref" href="modules-scripting-engine.html" title="Advanced scripts using script engines">implement a <code class="literal">ScriptEngine</code></a>.</p>
<h4><a id="_date_fields_now_return_dates"></a>Date fields now return dates<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/scripting.asciidoc">edit</a></h4>
<p><code class="literal">doc.some_date_field.value</code> now returns <code class="literal">ReadableDateTime</code>s instead of
milliseconds since epoch as a <code class="literal">long</code>. The same is true for
<code class="literal">doc.some_date_field[some_number]</code>. Use <code class="literal">doc.some_date_field.value.millis</code> to
fetch the milliseconds since epoch if you need it.</p>
<h4><a id="_removed_access_to_index_internal_via_the_literal__index_literal_variable"></a>Removed access to index internal via the <code class="literal">_index</code> variable<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/scripting.asciidoc">edit</a></h4>
<p>The <code class="literal">_index</code> variable has been removed. If you used it for advanced scoring, consider writing a <code class="literal">Similarity</code> plugin.</p>
<h4><a id="_script_settings"></a>Script Settings<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/scripting.asciidoc">edit</a></h4>
<p>All of the existing scripting security settings have been removed.  Instead
they are replaced with <code class="literal">script.allowed_types</code> and <code class="literal">script.allowed_contexts</code>.</p>
<h4><a id="_literal_lang_literal_can_no_longer_be_specified_when_using_a_stored_script_as_part_of_a_request"></a><code class="literal">lang</code> can no longer be specified when using a stored script as part of a request<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/scripting.asciidoc">edit</a></h4>
<p>The <code class="literal">lang</code> variable can no longer be specified as part of a request that uses a stored
script otherwise an error will occur.  Note that a request using a stored script is
different from a request that puts a stored script.  The language of the script has
already been stored as part of the cluster state and an <code class="literal">id</code> is sufficient to access
all of the information necessary to execute a stored script.</p>
<h4><a id="_lang_can_no_longer_be_used_when_putting_getting_or_deleting_a_stored_script"></a>'lang` can no longer be used when putting, getting, or deleting a stored script<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/scripting.asciidoc">edit</a></h4>
<p>Stored scripts can no longer have the <code class="literal">lang</code> parameter specified as part of the url
when performing PUT, GET, and DELETE actions on the <code class="literal">_scripts/</code> path.  All stored
scripts must have a unique <code class="literal">id</code> as the namespace is only <code class="literal">id</code> now and no longer <code class="literal">lang</code>
and <code class="literal">id</code>.</p>
<h4><a id="_stored_search_template_apis_removed"></a>Stored search template apis removed<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/scripting.asciidoc">edit</a></h4>
<p>The PUT, GET and DELETE <code class="literal">_search/template</code> apis have been removed. Store search templates with the stored scripts apis instead.</p>
<p>For example, previously one might have stored a search template with the following:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">PUT /_search/template/custom_template
{
  "query": {
    "match": {
      "f1": "{{f1}}"
    }
  }
}</pre>
</div>
<p>And instead one would now use the following:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT /_scripts/custom_template
{
  "script": {
    "lang": "mustache",
    "source": {
      "query": {
        "match": {
          "f1": "{{f1}}"
        }
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/1504.console"></div>
<h3><a id="breaking_60_search_changes"></a>Search and Query DSL changes<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/search.asciidoc">edit</a></h3>
<h4><a id="_changes_to_queries"></a>Changes to queries<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/search.asciidoc">edit</a></h4>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
The <code class="literal">collect_payloads</code> parameter of the <code class="literal">span_near</code> query has been removed. Payloads will be
loaded when needed.
</li>
<li class="listitem">
Queries on boolean fields now strictly parse boolean-like values. This means
only the strings <code class="literal">"true"</code> and <code class="literal">"false"</code> will be parsed into their boolean
counterparts. Other strings will cause an error to be thrown.
</li>
<li class="listitem">
The <code class="literal">in</code> query (a synonym for the <code class="literal">terms</code> query) has been removed
</li>
<li class="listitem">
The <code class="literal">geo_bbox</code> query (a synonym for the <code class="literal">geo_bounding_box</code> query) has been removed
</li>
<li class="listitem">
The <code class="literal">mlt</code> query (a synonym for the <code class="literal">more_like_this</code> query) has been removed.
</li>
<li class="listitem">
The deprecated <code class="literal">like_text</code>, <code class="literal">ids</code> and <code class="literal">docs</code> parameters (all synonyms for <code class="literal">like</code>) of the <code class="literal">more_like_this</code> query have
been removed. Also the deprecated <code class="literal">min_word_len</code> (a synonym for <code class="literal">min_word_length</code>) and <code class="literal">max_word_len</code>
(a synonym for <code class="literal">max_word_length</code>) have been removed.
</li>
<li class="listitem">
The <code class="literal">fuzzy_match</code> and <code class="literal">match_fuzzy</code> query (synonyma for the <code class="literal">match</code> query) have been removed
</li>
<li class="listitem">
The <code class="literal">terms</code> query now always returns scores equal to <code class="literal">1</code> and is not subject to
<code class="literal">indices.query.bool.max_clause_count</code> anymore.
</li>
<li class="listitem">
The deprecated <code class="literal">indices</code> query has been removed.
</li>
<li class="listitem">
Support for empty query objects (<code class="literal">{ }</code>) has been removed from the query DSL.
An error is thrown whenever an empty query object is provided.
</li>
<li class="listitem">
The deprecated <code class="literal">minimum_number_should_match</code> parameter in the <code class="literal">bool</code> query has
been removed, use <code class="literal">minimum_should_match</code> instead.
</li>
<li class="listitem">
The <code class="literal">query_string</code> query now correctly parses the maximum number of
states allowed when
<a href="https://en.wikipedia.org/wiki/Powerset_construction#Complexity" class="ulink" target="_top">determinizing</a>
a regex as <code class="literal">max_determinized_states</code> instead of the typo
<code class="literal">max_determined_states</code>.
</li>
<li class="listitem">
The <code class="literal">query_string</code> query no longer accepts <code class="literal">enable_position_increment</code>, use
<code class="literal">enable_position_increments</code> instead.
</li>
<li class="listitem">
For <code class="literal">geo_distance</code> queries, sorting, and aggregations the <code class="literal">sloppy_arc</code> option
has been removed from the <code class="literal">distance_type</code> parameter.
</li>
<li class="listitem">
The <code class="literal">geo_distance_range</code> query, which was deprecated in 5.0, has been removed.
</li>
<li class="listitem">
The <code class="literal">optimize_bbox</code> parameter has been removed from <code class="literal">geo_distance</code> queries.
</li>
<li class="listitem">
The <code class="literal">ignore_malformed</code> and <code class="literal">coerce</code> parameters have been removed from
<code class="literal">geo_bounding_box</code>, <code class="literal">geo_polygon</code>, and <code class="literal">geo_distance</code> queries.
</li>
<li class="listitem">
The <code class="literal">disable_coord</code> parameter of the <code class="literal">bool</code> and <code class="literal">common_terms</code> queries has
been removed. If provided, it will be ignored and issue a deprecation warning.
</li>
<li class="listitem">
The <code class="literal">template</code> query has been removed. This query was deprecated since 5.0
</li>
<li class="listitem">
The <code class="literal">percolate</code> query&#8217;s <code class="literal">document_type</code> has been deprecated. From 6.0 and later
it is no longer required to specify the <code class="literal">document_type</code> parameter.
</li>
<li class="listitem">
The <code class="literal">split_on_whitespace</code> parameter for the <code class="literal">query_string</code> query has been removed.
If provided, it will be ignored and issue a deprecation warning.
The <code class="literal">query_string</code> query now splits on operator only.
</li>
<li class="listitem">
The <code class="literal">use_dis_max</code> parameter for the <code class="literal">query_string</code> query has been removed.
If provided, it will be ignored and issue a deprecation warning.
The <code class="literal">tie_breaker</code> parameter must be used instead.
</li>
<li class="listitem">
The <code class="literal">auto_generate_phrase_queries</code> parameter for the <code class="literal">query_string</code> query has been removed,
use an explicit quoted query instead.
If provided, it will be ignored and issue a deprecation warning.
</li>
<li class="listitem">
The <code class="literal">all_fields</code> parameter for the <code class="literal">query_string</code> and <code class="literal">simple_query_string</code> has been removed.
Set <code class="literal">default_field</code> to *` instead.
If provided, <code class="literal">default_field</code> will be automatically set to <code class="literal">*</code>
</li>
<li class="listitem">
The <code class="literal">index</code> parameter in the terms filter, used to look up terms in a dedicated index is
now mandatory. Previously, the index defaulted to the index the query was executed on. Now this index
must be explicitly set in the request.
</li>
<li class="listitem">
The deprecated <code class="literal">type</code> and <code class="literal">slop</code> parameter for the <code class="literal">match</code> query have been removed. Instead of
setting the <code class="literal">type</code>, the <code class="literal">match_phrase</code> or <code class="literal">match_phrase_prefix</code> should be used. The <code class="literal">slop</code> removed from
the <code class="literal">match</code> query but is supported for <code class="literal">match_phrase</code> and <code class="literal">match_phrase_prefix</code>.
</li>
<li class="listitem">
The deprecated <code class="literal">phrase_slop</code> parameter (a synonym for the <code class="literal">slop</code> parameter) of the <code class="literal">match_phrase</code> query has been removed.
</li>
<li class="listitem">
The deprecated <code class="literal">query</code> parameter (a synonym for the <code class="literal">filter</code> parameter) of the <code class="literal">constant_score</code> query has been removed.
</li>
<li class="listitem">
The deprecated <code class="literal">phrase_slop</code> parameter (a synonym for the <code class="literal">slop</code> parameter) of the <code class="literal">multi_match</code> query has been removed.
</li>
<li class="listitem">
The deprecated <code class="literal">prefix</code> parameter (a synonym for the <code class="literal">value</code> parameter) of the <code class="literal">prefix</code> query has been removed.
</li>
<li class="listitem">
The deprecated <code class="literal">le</code> (a synonym for <code class="literal">lte</code>) and <code class="literal">ge</code> (a synonym for <code class="literal">gte</code>) parameter of the <code class="literal">range</code> query have been removed.
</li>
<li class="listitem">
The deprecated <code class="literal">types</code> and <code class="literal">_type</code> synonyms for the <code class="literal">type</code> parameter of the <code class="literal">ids</code> query have been removed
</li>
<li class="listitem">
The deprecated multi term rewrite parameters <code class="literal">constant_score_auto</code>, <code class="literal">constant_score_filter</code> (synonyms for <code class="literal">constant_score</code>)
have been removed.
</li>
</ul>
</div>
<h4><a id="_search_shards_api"></a>Search shards API<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/search.asciidoc">edit</a></h4>
<p>The search shards API no longer accepts the <code class="literal">type</code> url parameter, which didn&#8217;t
have any effect in previous versions.</p>
<h4><a id="_changes_to_the_profile_api"></a>Changes to the Profile API<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/search.asciidoc">edit</a></h4>
<p>The <code class="literal">"time"</code> field showing human readable timing output has been replaced by the <code class="literal">"time_in_nanos"</code>
field which displays the elapsed time in nanoseconds. The <code class="literal">"time"</code> field can be turned on by adding
<code class="literal">"?human=true"</code> to the request url. It will display a rounded, human readable time value.</p>
<h4><a id="_scoring_changes"></a>Scoring changes<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/search.asciidoc">edit</a></h4>
<h5><a id="_query_normalization"></a>Query normalization<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/search.asciidoc">edit</a></h5>
<p>Query normalization has been removed. This means that the TF-IDF similarity no
longer tries to make scores comparable across queries and that boosts are now
integrated into scores as simple multiplicative factors.</p>
<p>Other similarities are not affected as they did not normalize scores and
already integrated boosts into scores as multiplicative factors.</p>
<p>See <a href="https://issues.apache.org/jira/browse/LUCENE-7347" class="ulink" target="_top"><code class="literal">LUCENE-7347</code></a> for more
information.</p>
<h5><a id="_coordination_factors"></a>Coordination factors<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/search.asciidoc">edit</a></h5>
<p>Coordination factors have been removed from the scoring formula. This means that
boolean queries no longer score based on the number of matching clauses.
Instead, they always return the sum of the scores of the matching clauses.</p>
<p>As a consequence, use of the TF-IDF similarity is now discouraged as this was
an important component of the quality of the scores that this similarity
produces. BM25 is recommended instead.</p>
<p>See <a href="https://issues.apache.org/jira/browse/LUCENE-7347" class="ulink" target="_top"><code class="literal">LUCENE-7347</code></a> for more
information.</p>
<h4><a id="_fielddata_on_literal__uid_literal"></a>Fielddata on <code class="literal">_uid</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/search.asciidoc">edit</a></h4>
<p>Fielddata on <code class="literal">_uid</code> is deprecated. It is possible to switch to <code class="literal">_id</code> instead
but the only reason why it has not been deprecated too is because it is used
for the <code class="literal">random_score</code> function. If you really need access to the id of
documents for sorting, aggregations or search scripts, the recommendation is
to duplicate the id as a field in the document.</p>
<h4><a id="_highlighters"></a>Highlighters<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/search.asciidoc">edit</a></h4>
<p>The <code class="literal">unified</code> highlighter is the new default choice for highlighter.
The offset strategy for each field is picked internally by this highlighter depending on the
type of the field (<code class="literal">index_options</code>).
It is still possible to force the highlighter to <code class="literal">fvh</code> or <code class="literal">plain</code> types.</p>
<p>The <code class="literal">postings</code> highlighter has been removed from Lucene and Elasticsearch.
The <code class="literal">unified</code> highlighter outputs the same highlighting when <code class="literal">index_options</code> is set
 to <code class="literal">offsets</code>.</p>
<h4><a id="_literal_fielddata_fields_literal"></a><code class="literal">fielddata_fields</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/search.asciidoc">edit</a></h4>
<p>The deprecated <code class="literal">fielddata_fields</code> have now been removed. <code class="literal">docvalue_fields</code> should be used instead.</p>
<h4><a id="_literal_docvalue_fields_literal"></a><code class="literal">docvalue_fields</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/search.asciidoc">edit</a></h4>
<p><code class="literal">docvalue_fields</code> now have a default upper limit of 100 fields that can be requested.
This limit can be overridden by using the <code class="literal">index.max_docvalue_fields_search</code> index setting.</p>
<h4><a id="_literal_script_fields_litera"></a><code class="literal">script_fields</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/search.asciidoc">edit</a></h4>
<p><code class="literal">script_fields</code> now have a default upper limit of 32 script fields that can be requested.
This limit can be overridden by using the <code class="literal">index.max_script_fields</code> index setting.</p>
<h4><a id="_inner_hits"></a>Inner hits<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/search.asciidoc">edit</a></h4>
<p>The source inside a hit of inner hits keeps its full path with respect to the entire source.
In prior versions the source field names were relative to the inner hit.</p>
<h4><a id="_scroll"></a>Scroll<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/search.asciidoc">edit</a></h4>
<p>The <code class="literal">from</code> parameter can no longer be used in the search request body when initiating a scroll.
The parameter was already ignored in these situations, now in addition an error is thrown.</p>
<h4><a id="_limit_on_from_size_in_top_hits_and_inner_hits"></a>Limit on from/size in top hits and inner hits<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/search.asciidoc">edit</a></h4>
<p>The maximum number of results (<code class="literal">from</code> + <code class="literal">size</code>) that is allowed to be retrieved
via inner hits and top hits has been limited to 100. The limit can be controlled
via the <code class="literal">index.max_inner_result_window</code> index setting.</p>
<h4><a id="_scroll_queries_that_use_the_request_cache_are_deprecated"></a>Scroll queries that use the request_cache are deprecated<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/search.asciidoc">edit</a></h4>
<p>Setting <code class="literal">request_cache:true</code> on a query that creates a scroll ('scroll=1m`)
 is deprecated and the request will not use the cache internally.
In future versions we will return a <code class="literal">400 - Bad request</code> instead of just ignoring
the hint.
Scroll queries are not meant to be cached.</p>
<h4><a id="_limiting_the_number_of_terms_that_can_be_used_in_a_terms_query_request"></a>Limiting the number of terms that can be used in a Terms Query request<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/search.asciidoc">edit</a></h4>
<p>Executing a Terms Query with a lot of terms may degrade the cluster performance,
as each additional term demands extra processing and memory.
To safeguard against this, the maximum number of terms that can be used in a
Terms Query request has been limited to 65536. This default maximum can be changed
for a particular index with the index setting <code class="literal">index.max_terms_count</code>.</p>
<h4><a id="_invalid_literal__search_literal_request_body"></a>Invalid <code class="literal">_search</code> request body<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/search.asciidoc">edit</a></h4>
<p>For 6.x and starting in 6.3 a deprecation warning will be printed to warn
against search requests that contain extra tokens after the main object.
These extra tokens were ignored by the query parser before 6.3 but the next
 major version will not accept invalid body anymore.</p>
<h3><a id="breaking_60_settings_changes"></a>Settings changes<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/settings.asciidoc">edit</a></h3>
<h4><a id="_remove_support_for_elasticsearch_json_and_elasticsearch_yaml_configuration_file"></a>Remove support for elasticsearch.json and elasticsearch.yaml configuration file<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/settings.asciidoc">edit</a></h4>
<p>The configuration file found in the Elasticsearch config directory could previously have
a <code class="literal">.yml</code>, <code class="literal">.yaml</code> or <code class="literal">.json</code> extension. Only <code class="literal">elasticsearch.yml</code> is now supported.</p>
<h4><a id="_duplicate_keys_in_configuration_file"></a>Duplicate keys in configuration file<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/settings.asciidoc">edit</a></h4>
<p>In previous versions of Elasticsearch, the configuration file was allowed to
contain duplicate keys. For example:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">node:
  name: my-node

node
  attr:
    rack: my-rack</pre>
</div>
<p>In Elasticsearch 6.0.0, this is no longer permitted. Instead, this must be
specified in a single key as:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">node:
  name: my-node
  attr:
    rack: my-rack</pre>
</div>
<h4><a id="_coercion_of_boolean_settings"></a>Coercion of boolean settings<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/settings.asciidoc">edit</a></h4>
<p>Previously, Elasticsearch recognized the strings <code class="literal">true</code>, <code class="literal">false</code>, <code class="literal">on</code>, <code class="literal">off</code>, <code class="literal">yes</code>, <code class="literal">no</code>, <code class="literal">0</code>, <code class="literal">1</code> as booleans. Elasticsearch 6.0
recognizes only <code class="literal">true</code> and <code class="literal">false</code> as boolean and will throw an error otherwise. For backwards compatibility purposes, during the 6.x series
index settings on pre-6.0 indices will continue to work. Note that this does not apply to node-level settings that are stored
in <code class="literal">elasticsearch.yml</code>.</p>
<h4><a id="_snapshot_settings"></a>Snapshot settings<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/settings.asciidoc">edit</a></h4>
<p>The internal setting <code class="literal">cluster.routing.allocation.snapshot.relocation_enabled</code> that allowed shards with running snapshots to be reallocated to
different nodes has been removed. Enabling this setting could cause allocation issues if a shard got allocated off a node and then
reallocated back to this node while a snapshot was running.</p>
<h4><a id="_store_throttling_settings"></a>Store throttling settings<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/settings.asciidoc">edit</a></h4>
<p>Store throttling has been removed. As a consequence, the
<code class="literal">indices.store.throttle.type</code> and <code class="literal">indices.store.throttle.max_bytes_per_sec</code>
cluster settings and the <code class="literal">index.store.throttle.type</code> and
<code class="literal">index.store.throttle.max_bytes_per_sec</code> index settings are not
recognized anymore.</p>
<h4><a id="_store_settings"></a>Store settings<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/settings.asciidoc">edit</a></h4>
<p>The <code class="literal">default</code> <code class="literal">index.store.type</code> has been removed. If you were using it, we
advise that you simply remove it from your index settings and Elasticsearch
will use the best <code class="literal">store</code> implementation for your operating system.</p>
<h4><a id="_network_settings"></a>Network settings<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/settings.asciidoc">edit</a></h4>
<p>The blocking TCP client, blocking TCP server, and blocking HTTP server have been removed.
As a consequence, the <code class="literal">network.tcp.blocking_server</code>, <code class="literal">network.tcp.blocking_client</code>,
<code class="literal">network.tcp.blocking</code>,<code class="literal">transport.tcp.blocking_client</code>, <code class="literal">transport.tcp.blocking_server</code>,
and <code class="literal">http.tcp.blocking_server</code> settings are not recognized anymore.</p>
<p>The previously unused settings <code class="literal">transport.netty.max_cumulation_buffer_capacity</code>,
<code class="literal">transport.netty.max_composite_buffer_components</code> and
<code class="literal">http.netty.max_cumulation_buffer_capacity</code> have been removed.</p>
<h4><a id="_similarity_settings"></a>Similarity settings<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/settings.asciidoc">edit</a></h4>
<p>The <code class="literal">base</code> similarity is now ignored as coords and query normalization have
been removed. If provided, this setting will be ignored and issue a
deprecation warning.</p>
<h4><a id="_script_settings_2"></a>Script Settings<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/settings.asciidoc">edit</a></h4>
<p>All of the existing scripting security settings have been removed.  Instead
they are replaced with <code class="literal">script.allowed_types</code> and <code class="literal">script.allowed_contexts</code>.</p>
<h4><a id="_discovery_settings"></a>Discovery Settings<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/settings.asciidoc">edit</a></h4>
<p>The <code class="literal">discovery.type</code> settings no longer supports the values <code class="literal">gce</code>, <code class="literal">aws</code> and <code class="literal">ec2</code>.
Integration with these platforms should be done by setting the <code class="literal">discovery.zen.hosts_provider</code> setting to
one of those values.</p>
<h3><a id="breaking_60_stats_changes"></a>Stats and info changes<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/stats.asciidoc">edit</a></h3>
<h4><a id="_removal_of_literal_throttle_time_literal_in_the_literal_store_literal_stats"></a>Removal of <code class="literal">throttle_time</code> in the <code class="literal">store</code> stats<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/stats.asciidoc">edit</a></h4>
<p>Given that store throttling has been removed, the <code class="literal">store</code> stats do not report
<code class="literal">throttle_time</code> anymore.</p>
<h4><a id="_fs_stats_no_longer_reports_if_the_disk_spins"></a>FS stats no longer reports if the disk spins<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.3/docs/reference/migration/migrate_6_0/stats.asciidoc">edit</a></h4>
<p>Elasticsearch has defaulted to assuming that it is running on SSDs since
the 2.x series of Elasticsearch. As such, Elasticsearch no longer needs to
collect information from the operating system as to whether or not the
underlying disks of each data path spin or not. While this functionality was no
longer needed starting in the 2.x series of Elasticsearch, it was maintained in
the filesystem section of the nodes stats APIs. This information has now been
removed.</p>
</div>
<div class="navfooter">
<span class="prev">
<a href="breaking-changes.html">« Breaking changes</a>
</span>
<span class="next">
<a href="breaking-changes-6.1.html">Breaking changes in 6.1 »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
