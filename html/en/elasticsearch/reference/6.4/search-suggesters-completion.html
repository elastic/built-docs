<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Completion Suggester | Elasticsearch Reference [6.4] | Elastic</title>
<link rel="home" href="index.html" title="Elasticsearch Reference [6.4]"/>
<link rel="up" href="search-suggesters.html" title="Suggesters"/>
<link rel="prev" href="search-suggesters-phrase.html" title="Phrase Suggester"/>
<link rel="next" href="suggester-context.html" title="Context Suggester"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/6.4"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="6.4"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!--BEGIN QUALTRICS WEBSITE FEEDBACK SNIPPET-->
    <script type='text/javascript'>
      (function(){var g=function(e,h,f,g){
      this.get=function(a){for(var a=a+"=",c=document.cookie.split(";"),b=0,e=c.length;b<e;b++){for(var d=c[b];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return null};
      this.set=function(a,c){var b="",b=new Date;b.setTime(b.getTime()+6048E5);b="; expires="+b.toGMTString();document.cookie=a+"="+c+b+"; path=/; "};
      this.check=function(){var a=this.get(f);if(a)a=a.split(":");else if(100!=e)"v"==h&&(e=Math.random()>=e/100?0:100),a=[h,e,0],this.set(f,a.join(":"));else return!0;var c=a[1];if(100==c)return!0;switch(a[0]){case "v":return!1;case "r":return c=a[2]%Math.floor(100/c),a[2]++,this.set(f,a.join(":")),!c}return!0};
      this.go=function(){if(this.check()){var a=document.createElement("script");a.type="text/javascript";a.src=g;document.body&&document.body.appendChild(a)}};
      this.start=function(){var a=this;window.addEventListener?window.addEventListener("load",function(){a.go()},!1):window.attachEvent&&window.attachEvent("onload",function(){a.go()})}};
      try{(new g(100,"r","QSI_S_ZN_emkP0oSe9Qrn7kF","https://znemkp0ose9qrn7kf-elastic.siteintercept.qualtrics.com/WRSiteInterceptEngine/?Q_ZID=ZN_emkP0oSe9Qrn7kF")).start()}catch(i){}})();
    </script><div id='ZN_emkP0oSe9Qrn7kF'><!--DO NOT REMOVE-CONTENTS PLACED HERE--></div>
    <!--END WEBSITE FEEDBACK SNIPPET-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <!-- Subnav -->
    <div>
      <div>
        <div class="tertiary-nav d-none d-md-block">
          <div class="container">
            <div class="p-t-b-15 d-flex justify-content-between nav-container">
              <div class="breadcrum-wrapper"><span><a href="/guide/" style="font-size: 14px; font-weight: 600; color: #000;">Docs</a></span></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container">
              <div class="row">
                <div class="col-xs-12 col-sm-8 col-md-8 guide-section">
                  <!-- start body -->
                  <div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Elasticsearch Reference [6.4]</a></span>
»
<span class="breadcrumb-link"><a href="search.html">Search APIs</a></span>
»
<span class="breadcrumb-link"><a href="search-suggesters.html">Suggesters</a></span>
»
<span class="breadcrumb-node">Completion Suggester</span>
</div>
<div class="navheader">
<span class="prev">
<a href="search-suggesters-phrase.html">« Phrase Suggester</a>
</span>
<span class="next">
<a href="suggester-context.html">Context Suggester »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="search-suggesters-completion"></a>Completion Suggester<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.4/docs/reference/search/suggesters/completion-suggest.asciidoc">edit</a></h2>
</div></div></div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>In order to understand the format of suggestions, please
read the <a class="xref" href="search-suggesters.html" title="Suggesters"><em>Suggesters</em></a> page first.</p>
</div>
</div>
<p>The <code class="literal">completion</code> suggester provides auto-complete/search-as-you-type
functionality. This is a navigational feature to guide users to
relevant results as they are typing, improving search precision.
It is not meant for spell correction or did-you-mean functionality
like the <code class="literal">term</code> or <code class="literal">phrase</code> suggesters.</p>
<p>Ideally, auto-complete functionality should be as fast as a user
types to provide instant feedback relevant to what a user has already
typed in. Hence, <code class="literal">completion</code> suggester is optimized for speed.
The suggester uses data structures that enable fast lookups,
but are costly to build and are stored in-memory.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="completion-suggester-mapping"></a>Mapping<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.4/docs/reference/search/suggesters/completion-suggest.asciidoc">edit</a></h3>
</div></div></div>
<p>To use this feature, specify a special mapping for this field,
which indexes the field values for fast completions.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT music
{
    "mappings": {
        "_doc" : {
            "properties" : {
                "suggest" : {
                    "type" : "completion"
                },
                "title" : {
                    "type": "keyword"
                }
            }
        }
    }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/312.console"></div>
<p>Mapping supports the following parameters:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">analyzer</code>
</span>
</dt>
<dd>
The index analyzer to use, defaults to <code class="literal">simple</code>.
In case you are wondering why we did not opt for the <code class="literal">standard</code>
analyzer: We try to have easy to understand behaviour here, and if you
index the field content <code class="literal">At the Drive-in</code>, you will not get any
suggestions for <code class="literal">a</code>, nor for <code class="literal">d</code> (the first non stopword).
</dd>
<dt>
<span class="term">
<code class="literal">search_analyzer</code>
</span>
</dt>
<dd>
The search analyzer to use, defaults to value of <code class="literal">analyzer</code>.
</dd>
<dt>
<span class="term">
<code class="literal">preserve_separators</code>
</span>
</dt>
<dd>
Preserves the separators, defaults to <code class="literal">true</code>.
If disabled, you could find a field starting with <code class="literal">Foo Fighters</code>, if you
suggest for <code class="literal">foof</code>.
</dd>
<dt>
<span class="term">
<code class="literal">preserve_position_increments</code>
</span>
</dt>
<dd>
Enables position increments, defaults to <code class="literal">true</code>.
If disabled and using stopwords analyzer, you could get a
field starting with <code class="literal">The Beatles</code>, if you suggest for <code class="literal">b</code>. <span class="strong strong"><strong>Note</strong></span>: You
could also achieve this by indexing two inputs, <code class="literal">Beatles</code> and
<code class="literal">The Beatles</code>, no need to change a simple analyzer, if you are able to
enrich your data.
</dd>
<dt>
<span class="term">
<code class="literal">max_input_length</code>
</span>
</dt>
<dd>
Limits the length of a single input, defaults to <code class="literal">50</code> UTF-16 code points.
This limit is only used at index time to reduce the total number of
characters per input string in order to prevent massive inputs from
bloating the underlying datastructure. Most usecases won&#8217;t be influenced
by the default value since prefix completions seldom grow beyond prefixes longer
than a handful of characters.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="indexing"></a>Indexing<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.4/docs/reference/search/suggesters/completion-suggest.asciidoc">edit</a></h3>
</div></div></div>
<p>You index suggestions like any other field. A suggestion is made of an
<code class="literal">input</code> and an optional <code class="literal">weight</code> attribute. An <code class="literal">input</code> is the expected
text to be matched by a suggestion query and the <code class="literal">weight</code> determines how
the suggestions will be scored. Indexing a suggestion is as follows:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT music/_doc/1?refresh
{
    "suggest" : {
        "input": [ "Nevermind", "Nirvana" ],
        "weight" : 34
    }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/313.console"></div>
<p>The following parameters are supported:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">input</code>
</span>
</dt>
<dd>
The input to store, this can be an array of strings or just
a string. This field is mandatory.
</dd>
<dt>
<span class="term">
<code class="literal">weight</code>
</span>
</dt>
<dd>
A positive integer or a string containing a positive integer,
which defines a weight and allows you to rank your suggestions.
This field is optional.
</dd>
</dl>
</div>
<p>You can index multiple suggestions for a document as follows:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT music/_doc/1?refresh
{
    "suggest" : [
        {
            "input": "Nevermind",
            "weight" : 10
        },
        {
            "input": "Nirvana",
            "weight" : 3
        }
    ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/314.console"></div>
<p>You can use the following shorthand form. Note that you can not specify
a weight with suggestion(s) in the shorthand form.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT music/_doc/1?refresh
{
  "suggest" : [ "Nevermind", "Nirvana" ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/315.console"></div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="querying"></a>Querying<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.4/docs/reference/search/suggesters/completion-suggest.asciidoc">edit</a></h3>
</div></div></div>
<p>Suggesting works as usual, except that you have to specify the suggest
type as <code class="literal">completion</code>. Suggestions are near real-time, which means
new suggestions can be made visible by <a class="xref" href="indices-refresh.html" title="Refresh">refresh</a> and
documents once deleted are never shown. This request:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST music/_search?pretty
{
    "suggest": {
        "song-suggest" : {
            "prefix" : "nir", <a id="CO39-1"></a><i class="conum" data-value="1"></i>
            "completion" : { <a id="CO39-2"></a><i class="conum" data-value="2"></i>
                "field" : "suggest" <a id="CO39-3"></a><i class="conum" data-value="3"></i>
            }
        }
    }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/316.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO39-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Prefix used to search for suggestions</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO39-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>Type of suggestions</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO39-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>Name of the field to search for suggestions in</p>
</td>
</tr>
</table>
</div>
<p>returns this response:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "_shards" : {
    "total" : 5,
    "successful" : 5,
    "skipped" : 0,
    "failed" : 0
  },
  "hits": ...
  "took": 2,
  "timed_out": false,
  "suggest": {
    "song-suggest" : [ {
      "text" : "nir",
      "offset" : 0,
      "length" : 3,
      "options" : [ {
        "text" : "Nirvana",
        "_index": "music",
        "_type": "_doc",
        "_id": "1",
        "_score": 1.0,
        "_source": {
          "suggest": ["Nevermind", "Nirvana"]
        }
      } ]
    } ]
  }
}</pre>
</div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p><code class="literal">_source</code> meta-field must be enabled, which is the default
behavior, to enable returning <code class="literal">_source</code> with suggestions.</p>
</div>
</div>
<p>The configured weight for a suggestion is returned as <code class="literal">_score</code>. The
<code class="literal">text</code> field uses the <code class="literal">input</code> of your indexed suggestion. Suggestions
return the full document <code class="literal">_source</code> by default. The size of the <code class="literal">_source</code>
can impact performance due to disk fetch and network transport overhead.
To save some network overhead, filter out unnecessary fields from the <code class="literal">_source</code>
using <a class="xref" href="search-request-source-filtering.html" title="Source filtering">source filtering</a> to minimize
<code class="literal">_source</code> size. Note that the _suggest endpoint doesn&#8217;t support source
filtering but using suggest on the <code class="literal">_search</code> endpoint does:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST music/_search
{
    "_source": "suggest", <a id="CO40-1"></a><i class="conum" data-value="1"></i>
    "suggest": {
        "song-suggest" : {
            "prefix" : "nir",
            "completion" : {
                "field" : "suggest", <a id="CO40-2"></a><i class="conum" data-value="2"></i>
                "size" : 5 <a id="CO40-3"></a><i class="conum" data-value="3"></i>
            }
        }
    }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/317.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO40-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Filter the source to return only the <code class="literal">suggest</code> field</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO40-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>Name of the field to search for suggestions in</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO40-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>Number of suggestions to return</p>
</td>
</tr>
</table>
</div>
<p>Which should look like:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
    "took": 6,
    "timed_out": false,
    "_shards" : {
        "total" : 5,
        "successful" : 5,
        "skipped" : 0,
        "failed" : 0
    },
    "hits": {
        "total" : 0,
        "max_score" : 0.0,
        "hits" : []
    },
    "suggest": {
        "song-suggest" : [ {
            "text" : "nir",
            "offset" : 0,
            "length" : 3,
            "options" : [ {
                "text" : "Nirvana",
                "_index": "music",
                "_type": "_doc",
                "_id": "1",
                "_score": 1.0,
                "_source": {
                    "suggest": ["Nevermind", "Nirvana"]
                }
            } ]
        } ]
    }
}</pre>
</div>
<p>The basic completion suggester query supports the following parameters:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">field</code>
</span>
</dt>
<dd>
The name of the field on which to run the query (required).
</dd>
<dt>
<span class="term">
<code class="literal">size</code>
</span>
</dt>
<dd>
The number of suggestions to return (defaults to <code class="literal">5</code>).
</dd>
<dt>
<span class="term">
<code class="literal">skip_duplicates</code>
</span>
</dt>
<dd>
Whether duplicate suggestions should be filtered out (defaults to <code class="literal">false</code>).
</dd>
</dl>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The completion suggester considers all documents in the index.
See <a class="xref" href="suggester-context.html" title="Context Suggester">Context Suggester</a> for an explanation of how to query a subset of
documents instead.</p>
</div>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>In case of completion queries spanning more than one shard, the suggest
is executed in two phases, where the last phase fetches the relevant documents
from shards, implying executing completion requests against a single shard is
more performant due to the document fetch overhead when the suggest spans
multiple shards. To get best performance for completions, it is recommended to
index completions into a single shard index. In case of high heap usage due to
shard size, it is still recommended to break index into multiple shards instead
of optimizing for completion performance.</p>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="skip_duplicates"></a>Skip duplicate suggestions<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.4/docs/reference/search/suggesters/completion-suggest.asciidoc">edit</a></h3>
</div></div></div>
<p>Queries can return duplicate suggestions coming from different documents.
It is possible to modify this behavior by setting <code class="literal">skip_duplicates</code> to true.
When set, this option filters out documents with duplicate suggestions from the result.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST music/_search?pretty
{
    "suggest": {
        "song-suggest" : {
            "prefix" : "nor",
            "completion" : {
                "field" : "suggest",
                "skip_duplicates": true
            }
        }
    }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/318.console"></div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>when set to true this option can slow down search because more suggestions
need to be visited to find the top N.</p>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="fuzzy"></a>Fuzzy queries<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.4/docs/reference/search/suggesters/completion-suggest.asciidoc">edit</a></h3>
</div></div></div>
<p>The completion suggester also supports fuzzy queries - this means,
you can have a typo in your search and still get results back.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST music/_search?pretty
{
    "suggest": {
        "song-suggest" : {
            "prefix" : "nor",
            "completion" : {
                "field" : "suggest",
                "fuzzy" : {
                    "fuzziness" : 2
                }
            }
        }
    }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/319.console"></div>
<p>Suggestions that share the longest prefix to the query <code class="literal">prefix</code> will
be scored higher.</p>
<p>The fuzzy query can take specific fuzzy parameters.
The following parameters are supported:</p>
<div class="informaltable">
<table border="0" cellpadding="4px">
<colgroup>
<col/>
<col/>
</colgroup>
<tbody valign="top">
<tr>
<td valign="top">
<p>
<code class="literal">fuzziness</code>
</p>
</td>
<td valign="top">
<p>
The fuzziness factor, defaults to <code class="literal">AUTO</code>.
See  <a class="xref" href="common-options.html#fuzziness" title="Fuzziness">Fuzziness</a> for allowed settings.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">transpositions</code>
</p>
</td>
<td valign="top">
<p>
if set to <code class="literal">true</code>, transpositions are counted
as one change instead of two, defaults to <code class="literal">true</code>
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">min_length</code>
</p>
</td>
<td valign="top">
<p>
Minimum length of the input before fuzzy
suggestions are returned, defaults <code class="literal">3</code>
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">prefix_length</code>
</p>
</td>
<td valign="top">
<p>
Minimum length of the input, which is not
checked for fuzzy alternatives, defaults to <code class="literal">1</code>
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">unicode_aware</code>
</p>
</td>
<td valign="top">
<p>
If <code class="literal">true</code>, all measurements (like fuzzy edit
distance, transpositions, and lengths) are
measured in Unicode code points instead of
in bytes.  This is slightly slower than raw
bytes, so it is set to <code class="literal">false</code> by default.
</p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>If you want to stick with the default values, but
      still use fuzzy, you can either use <code class="literal">fuzzy: {}</code>
      or <code class="literal">fuzzy: true</code>.</p>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="regex"></a>Regex queries<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.4/docs/reference/search/suggesters/completion-suggest.asciidoc">edit</a></h3>
</div></div></div>
<p>The completion suggester also supports regex queries meaning
you can express a prefix as a regular expression</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST music/_search?pretty
{
    "suggest": {
        "song-suggest" : {
            "regex" : "n[ever|i]r",
            "completion" : {
                "field" : "suggest"
            }
        }
    }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/320.console"></div>
<p>The regex query can take specific regex parameters.
The following parameters are supported:</p>
<div class="informaltable">
<table border="0" cellpadding="4px">
<colgroup>
<col/>
<col/>
</colgroup>
<tbody valign="top">
<tr>
<td valign="top">
<p>
<code class="literal">flags</code>
</p>
</td>
<td valign="top">
<p>
Possible flags are <code class="literal">ALL</code> (default), <code class="literal">ANYSTRING</code>, <code class="literal">COMPLEMENT</code>,
<code class="literal">EMPTY</code>, <code class="literal">INTERSECTION</code>, <code class="literal">INTERVAL</code>, or <code class="literal">NONE</code>. See <a class="xref" href="query-dsl-regexp-query.html" title="Regexp Query">regexp-syntax</a>
for their meaning
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">max_determinized_states</code>
</p>
</td>
<td valign="top">
<p>
Regular expressions are dangerous because it&#8217;s easy to accidentally
create an innocuous looking one that requires an exponential number of
internal determinized automaton states (and corresponding RAM and CPU)
for Lucene to execute.  Lucene prevents these using the
<code class="literal">max_determinized_states</code> setting (defaults to 10000).  You can raise
this limit to allow more complex regular expressions to execute.
</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="search-suggesters-phrase.html">« Phrase Suggester</a>
</span>
<span class="next">
<a href="suggester-context.html">Context Suggester »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>
                <div class="col-xs-12 col-sm-4 col-md-4" id="right_col">
                  <div id="rtpcontainer" style="display: block;">
                    <div class="mktg-promo">
                      <h3>Most Popular</h3>
                      <ul class="icons">
                        <li class="icon-elasticsearch-white"><a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">Get Started with Elasticsearch: Video</a></li>
                        <li class="icon-kibana-white"><a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">Intro to Kibana: Video</a></li>
                        <li class="icon-logstash-white"><a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">ELK for Logs & Metrics: Video</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";
	var localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}';
</script>
<script src="/static/js/swiftype_app_search.umd.min.js"></script>
<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
