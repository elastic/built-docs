<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Breaking changes in 6.5 | Elasticsearch Reference [6.6] | Elastic</title>
<link rel="home" href="index.html" title="Elasticsearch Reference [6.6]"/>
<link rel="up" href="breaking-changes.html" title="Breaking changes"/>
<link rel="prev" href="breaking-changes-6.4.html" title="Breaking changes in 6.4"/>
<link rel="next" href="breaking-changes-6.6.html" title="Breaking changes in 6.6"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/6.6"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="6.6"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!--BEGIN QUALTRICS WEBSITE FEEDBACK SNIPPET-->
    <script type='text/javascript'>
      (function(){var g=function(e,h,f,g){
      this.get=function(a){for(var a=a+"=",c=document.cookie.split(";"),b=0,e=c.length;b<e;b++){for(var d=c[b];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return null};
      this.set=function(a,c){var b="",b=new Date;b.setTime(b.getTime()+6048E5);b="; expires="+b.toGMTString();document.cookie=a+"="+c+b+"; path=/; "};
      this.check=function(){var a=this.get(f);if(a)a=a.split(":");else if(100!=e)"v"==h&&(e=Math.random()>=e/100?0:100),a=[h,e,0],this.set(f,a.join(":"));else return!0;var c=a[1];if(100==c)return!0;switch(a[0]){case "v":return!1;case "r":return c=a[2]%Math.floor(100/c),a[2]++,this.set(f,a.join(":")),!c}return!0};
      this.go=function(){if(this.check()){var a=document.createElement("script");a.type="text/javascript";a.src=g;document.body&&document.body.appendChild(a)}};
      this.start=function(){var a=this;window.addEventListener?window.addEventListener("load",function(){a.go()},!1):window.attachEvent&&window.attachEvent("onload",function(){a.go()})}};
      try{(new g(100,"r","QSI_S_ZN_emkP0oSe9Qrn7kF","https://znemkp0ose9qrn7kf-elastic.siteintercept.qualtrics.com/WRSiteInterceptEngine/?Q_ZID=ZN_emkP0oSe9Qrn7kF")).start()}catch(i){}})();
    </script><div id='ZN_emkP0oSe9Qrn7kF'><!--DO NOT REMOVE-CONTENTS PLACED HERE--></div>
    <!--END WEBSITE FEEDBACK SNIPPET-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <!-- Subnav -->
    <div>
      <div>
        <div class="tertiary-nav d-none d-md-block">
          <div class="container">
            <div class="p-t-b-15 d-flex justify-content-between nav-container">
              <div class="breadcrum-wrapper"><span><a href="/guide/" style="font-size: 14px; font-weight: 600; color: #000;">Docs</a></span></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container">
              <div class="row">
                <div class="col-xs-12 col-sm-8 col-md-8 guide-section">
                  <!-- start body -->
                  <div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Elasticsearch Reference [6.6]</a></span>
»
<span class="breadcrumb-link"><a href="breaking-changes.html">Breaking changes</a></span>
»
<span class="breadcrumb-node">Breaking changes in 6.5</span>
</div>
<div class="navheader">
<span class="prev">
<a href="breaking-changes-6.4.html">« Breaking changes in 6.4</a>
</span>
<span class="next">
<a href="breaking-changes-6.6.html">Breaking changes in 6.6 »</a>
</span>
</div>
<div class="chapter">
<div class="titlepage"><div><div>
<h2 class="title"><a id="breaking-changes-6.5"></a>Breaking changes in 6.5<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.6/docs/reference/migration/migrate_6_5.asciidoc">edit</a></h2>
</div></div></div>

<p>This section discusses the changes that you need to be aware of when migrating
your application to Elasticsearch 6.5.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="breaking-changes-6.5.html#breaking_65_logging_changes" title="Logging changes">Logging changes</a>
</li>
<li class="listitem">
<a class="xref" href="breaking-changes-6.5.html#breaking_65_search_changes" title="Search changes">Search changes</a>
</li>
<li class="listitem">
<a class="xref" href="breaking-changes-6.5.html#breaking_65_sql_changes" title="SQL plugin changes">SQL plugin changes</a>
</li>
<li class="listitem">
<a class="xref" href="breaking-changes-6.5.html#breaking_65_client_changes" title="Client changes">Client changes</a>
</li>
<li class="listitem">
<a class="xref" href="breaking-changes-6.5.html#breaking_65_security_changes" title="Security changes">Security changes</a>
</li>
</ul>
</div>
<p>See also <a class="xref" href="release-highlights.html" title="Release Highlights">Release Highlights</a> and <a class="xref" href="es-release-notes.html" title="Release Notes">Release Notes</a>.</p>
<h3><a id="breaking_65_logging_changes"></a>Logging changes<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.6/docs/reference/migration/migrate_6_5.asciidoc">edit</a></h3>
<h4><a id="_node_name_in_logging_pattern"></a>%node_name in logging pattern<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.6/docs/reference/migration/migrate_6_5.asciidoc">edit</a></h4>
<p>To make the node name appear consistently in Elasticsearch&#8217;s logs and to clean
up much of the internal logging code we&#8217;ve removed the node name from the
"marker" in the logging configuration. If you do not customize your logging
configuration file then there is nothing for you to do. If you <span class="strong strong"><strong>do</strong></span> customize
your logging configuration properties then you should replace <code class="literal">%marker</code> with
`[%node_name]%marker `, including the trailing space. If you do not do so
Elasticsearch will log a warning on startup and log with the new pattern. It
will not change the logging configuration files though. You should make this
change before 7.0 because in 7.0 Elasticsearch will no longer automatically
add the node name to the logging configuration if it isn&#8217;t already present.</p>
<h3><a id="breaking_65_search_changes"></a>Search changes<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.6/docs/reference/migration/migrate_6_5.asciidoc">edit</a></h3>
<h4><a id="_scroll_2"></a>Scroll<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.6/docs/reference/migration/migrate_6_5.asciidoc">edit</a></h4>
<p>Using <code class="literal">rescore</code> with a scroll query now raises a deprecation warning and
ignores the parameter.  In earlier 6.x releases, rescore on scroll queries was
silently ignored.  In 7.0 and later, we will return a <code class="literal">400 - Bad Request</code> with
a validation error.</p>
<h3><a id="breaking_65_sql_changes"></a>SQL plugin changes<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.6/docs/reference/migration/migrate_6_5.asciidoc">edit</a></h3>
<h4><a id="_grouping_by_columns_with_missing_values_will_create_an_additional_group"></a>Grouping by columns with missing values will create an additional group<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.6/docs/reference/migration/migrate_6_5.asciidoc">edit</a></h4>
<p>An additional group will be present in the result of requests containing a
<code class="literal">GROUP BY</code> for a column that has missing values in the returned documents.
The records with missing values in the grouped by column will be collectively
considered a single bucket.</p>
<h3><a id="breaking_65_client_changes"></a>Client changes<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.6/docs/reference/migration/migrate_6_5.asciidoc">edit</a></h3>
<h4><a id="_deprecate_retry_withbackoff_methods_that_take_settings"></a>Deprecate Retry.withBackoff methods that take Settings<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.6/docs/reference/migration/migrate_6_5.asciidoc">edit</a></h4>
<p><code class="literal">Settings</code> is no longer required by <code class="literal">Retry</code> so the <code class="literal">withBackoff</code> methods that
take <code class="literal">Settings</code> are now deprecated and there are new versions of those methods
that do not require <code class="literal">Settings</code>.</p>
<h3><a id="breaking_65_security_changes"></a>Security changes<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.6/docs/reference/migration/migrate_6_5.asciidoc">edit</a></h3>
<h4><a id="_custom_role_providers_interface_change"></a>Custom role providers interface change<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.6/docs/reference/migration/migrate_6_5.asciidoc">edit</a></h4>
<p>Custom role providers previously accepted an <code class="literal">ActionListener</code> with a response
type of <code class="literal">Set&lt;RoleDescriptor&gt;</code>, but in 6.5.0 the role provider requires an
<code class="literal">ActionListener</code> with a response type of <code class="literal">RoleRetrievalResult</code>. The
<code class="literal">RoleRetrievalResult</code> object accepts a <code class="literal">Set&lt;RoleDescriptor&gt;</code> if the provider
was successful; if the provider was not successful the <code class="literal">RoleRetrievalResult</code>
should be populated with the error.</p>
<h3><a id="breaking_65_settings_changes"></a>Settings changes<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.6/docs/reference/migration/migrate_6_5.asciidoc">edit</a></h3>
<h4><a id="_audit_logfile_local_node_info"></a>Audit logfile local node info<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.6/docs/reference/migration/migrate_6_5.asciidoc">edit</a></h4>
<p>In 6.5.0 a new format for the logfile auditing has been introduced.
The new file format prints audit entries as JSON documents.
Entries in the previous format contained positional fields.
These fields are no longer positional in the new format, as they are part of the
structured log entry (the JSON document).
Consequently, the following settings, which toggled some of the prefix
positional fields, have been renamed ("prefix" was spliced out):</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">xpack.security.audit.logfile.prefix.emit_node_host_address</code> to
<code class="literal">xpack.security.audit.logfile.emit_node_host_address</code>
</li>
<li class="listitem">
<code class="literal">xpack.security.audit.logfile.prefix.emit_node_host_name</code> to
<code class="literal">xpack.security.audit.logfile.emit_node_host_name</code>
</li>
<li class="listitem">
<code class="literal">xpack.security.audit.logfile.prefix.emit_node_name</code> to
<code class="literal">xpack.security.audit.logfile.emit_node_name</code>
</li>
</ul>
</div>
<p>In 7.0.0 the <code class="literal">prefix</code> variant will be removed.</p>
</div>
<div class="navfooter">
<span class="prev">
<a href="breaking-changes-6.4.html">« Breaking changes in 6.4</a>
</span>
<span class="next">
<a href="breaking-changes-6.6.html">Breaking changes in 6.6 »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>
                <div class="col-xs-12 col-sm-4 col-md-4" id="right_col">
                  <div id="rtpcontainer" style="display: block;">
                    <div class="mktg-promo">
                      <h3>Most Popular</h3>
                      <ul class="icons">
                        <li class="icon-elasticsearch-white"><a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">Get Started with Elasticsearch: Video</a></li>
                        <li class="icon-kibana-white"><a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">Intro to Kibana: Video</a></li>
                        <li class="icon-logstash-white"><a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">ELK for Logs & Metrics: Video</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";
	var localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}';
</script>
<script src="/static/js/swiftype_app_search.umd.min.js"></script>
<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
