<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Breaking changes in 6.7 | Elasticsearch Guide [6.7] | Elastic</title>
<meta class="elastic" name="content" content="Breaking changes in 6.7 | Elasticsearch Guide [6.7]">

<link rel="home" href="index.html" title="Elasticsearch Guide [6.7]"/>
<link rel="up" href="breaking-changes.html" title="Breaking changes"/>
<link rel="prev" href="breaking-changes-6.6.html" title="Breaking changes in 6.6"/>
<link rel="next" href="es-release-notes.html" title="Release Notes"/>
<meta class="elastic" name="product_version" content="6.7"/>
<meta class="elastic" name="product_name" content="Elasticsearch"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/6.7"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="6.7"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="icon" href="/favicon.ico" sizes="32x32"/>
    <link rel="icon" href="/favicon.svg" type="image/svg+xml"/>
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" sizes="180x180"/>
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles-v1.css" />
  </head>

  <!--© 2015-2025 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div class="navheader">
<span class="prev">
<a href="breaking-changes-6.6.html">« Breaking changes in 6.6</a>
</span>
<span class="next">
<a href="es-release-notes.html">Release Notes »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elasticsearch Guide [6.7]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="breaking-changes.html">Breaking changes</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Breaking changes in 6.7</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.7/docs/reference/migration/migrate_6_7.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div id="url-to-v3" class="version-warning">
    <strong>IMPORTANT</strong>: This documentation is no longer updated. Refer to <a href="https://www.elastic.co/support/eol">Elastic's version policy</a> and the <a href="https://www.elastic.co/docs">latest documentation</a>.
</div>
<div class="chapter">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="breaking-changes-6.7"></a>Breaking changes in 6.7</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.7/docs/reference/migration/migrate_6_7.asciidoc">edit</a></div>
</div></div></div>

<p>This section discusses the changes that you need to be aware of when migrating
your application to Elasticsearch 6.7.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="breaking-changes-6.7.html#breaking_67_indexing_changes" title="Indexing changes">Indexing changes</a>
</li>
<li class="listitem">
<a class="xref" href="breaking-changes-6.7.html#breaking_67_plugin_changes" title="Plugin changes">Plugin changes</a>
</li>
<li class="listitem">
<a class="xref" href="breaking-changes-6.7.html#breaking_67_settings_changes" title="Settings changes">Settings changes</a>
</li>
<li class="listitem">
<a class="xref" href="breaking-changes-6.7.html#breaking_67_api_changes" title="API changes">API changes</a>
</li>
<li class="listitem">
<a class="xref" href="breaking-changes-6.7.html#breaking_67_security_changes" title="Security changes">Security changes</a>
</li>
</ul>
</div>
<p>See also <a class="xref" href="release-highlights.html" title="Release Highlights">Release Highlights</a> and <a class="xref" href="es-release-notes.html" title="Release Notes">Release Notes</a>.</p>
<div class="position-relative"><h3><a id="breaking_67_indexing_changes"></a>Indexing changes</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.7/docs/reference/migration/migrate_6_7.asciidoc">edit</a></div>
<div class="position-relative"><h4><a id="_deprecated_usage_of_literal_internal_literal_versioning_for_optimistic_concurrency_control"></a>Deprecated usage of <code class="literal">internal</code> versioning for optimistic concurrency control</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.7/docs/reference/migration/migrate_6_7.asciidoc">edit</a></div>
<p><code class="literal">internal</code> version may not uniquely identify a document&#8217;s version if an indexed document
wasn&#8217;t fully replicated when a primary fails. As such it is unsafe to use for
optimistic concurrency control, is deprecated and the option will no longer be available
in Elasticsearch 7.0.0. Please use the <code class="literal">if_seq_no</code> and <code class="literal">if_primary_term</code> parameters instead.
See <a class="xref" href="optimistic-concurrency-control.html" title="Optimistic concurrency control"><em>Optimistic concurrency control</em></a> for more details.</p>
<div class="position-relative"><h3><a id="breaking_67_plugin_changes"></a>Plugin changes</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.7/docs/reference/migration/migrate_6_7.asciidoc">edit</a></div>
<div class="position-relative"><h4><a id="_literal_ingest_geoip_literal_and_literal_ingest_user_agent_literal_are_no_longer_distributed_as_plugins"></a><code class="literal">ingest-geoip</code> and <code class="literal">ingest-user-agent</code> are no longer distributed as plugins</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.7/docs/reference/migration/migrate_6_7.asciidoc">edit</a></div>
<p>The <code class="literal">ingest-geoip</code> and <code class="literal">ingest-user-agent</code> plugins have been converted to
modules and are now included with all Elasticsearch distributions. Starting with
Elasticsearch 6.7.0, attempting to install or remove these plugins will result
in a no-op. In Elasticsearch 7.0.0, attempting to install or remove these plugins
will result in an error. Additionally, there are two minor breaking changes here:
- <code class="literal">elasticsearch-plugin list</code> will no longer output <code class="literal">ingest-geoip</code> nor
  <code class="literal">ingest-user-agent</code>
- <code class="literal">plugin.mandatory</code> is no longer compatible with <code class="literal">ingest-geoip</code> nor
  <code class="literal">ingest-user-agent</code></p>
<p>Elasticsearch 6.7.0 checks that there are no leftover geoip database files in
the plugin configuration directory because the new module does not use them.
Therefore, remove the <code class="literal">ingest-geoip</code> plugin prior to upgrading to 6.7.0 with
the <code class="literal">--purge</code> option to also delete the old database files:</p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">./bin/elasticsearch-plugin remove --purge ingest-geoip</pre>
</div>
<p>Otherwise you will see the following error message upon startup (assuming
<code class="literal">/etc/elasticsearch/ingest-geoip</code> as the plugin configuration directory):</p>
<div class="pre_wrapper lang-text">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-text">expected database [GeoLite2-ASN.mmdb] to not exist in [/etc/elasticsearch/ingest-geoip]</pre>
</div>
<div class="position-relative"><h3><a id="breaking_67_settings_changes"></a>Settings changes</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.7/docs/reference/migration/migrate_6_7.asciidoc">edit</a></div>
<div class="position-relative"><h4><a id="_disabling_memory_mapping"></a>Disabling memory-mapping</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.7/docs/reference/migration/migrate_6_7.asciidoc">edit</a></div>
<p>The setting <code class="literal">node.store.allow_mmapfs</code> has been deprecated. Use
<code class="literal">node.store.allow_mmap</code> instead.</p>
<div class="position-relative"><h3><a id="breaking_67_api_changes"></a>API changes</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.7/docs/reference/migration/migrate_6_7.asciidoc">edit</a></div>
<div class="position-relative"><h4><a id="_removing_compressed_size_of_cluster_state"></a>Removing compressed size of cluster state</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.7/docs/reference/migration/migrate_6_7.asciidoc">edit</a></div>
<p>Since 6.0.0, the <code class="literal">/_cluster/state</code> REST endpoint and cluster state API on the
transport client would compute and return the compressed size of the cluster
state as if it were serialized for inter-node communication. This metric would
be returned in the <code class="literal">compressed_size</code> or <code class="literal">compressed_size_in_bytes</code> fields in the
REST endpoint, or <code class="literal">ClusterStateResponse#getTotalCompressedSize</code> via the
transport client. Computing this field is expensive, and has dubious reporting
value as it does not reflect the actual size of the cluster state on disk. The
expense of computing this field is such that in some situations it can disrupt
all activity on a node including indexing activity. Therefore we have elected to
by default stop computing this field in a minor release. We are providing a
backwards compatibility flag via the system property
<code class="literal">-Des.cluster_state.size=true</code> which will return to the previous 6.0.0&#8212;&#8203;6.6.2
behavior.  Computing this metric and displaying this field will be completely
removed in 7.0.0, and using this backwards compatibility flag will fail.</p>
<div class="position-relative"><h3><a id="breaking_67_security_changes"></a>Security changes</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.7/docs/reference/migration/migrate_6_7.asciidoc">edit</a></div>
<div class="position-relative"><h4><a id="_removed_support_for_pre_v6_2_tokens"></a>Removed support for pre v6.2 tokens</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.7/docs/reference/migration/migrate_6_7.asciidoc">edit</a></div>
<p>The token service no longer accepts tokens that were generated on an Elasticsearch version
earlier than 6.2.0</p>
<p>No applications in the Elastic Stack made use of Elasticsearch tokens prior to 6.2.0, so this
change does not affect access to Kibana or any official Elasticsearch clients.
If you have an application that uses Elasticsearch tokens, and a token from 6.1 or earlier
is presented for authentication, Elasticsearch will reject the token with a <code class="literal">401</code> status code.</p>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="breaking-changes-6.6.html">« Breaking changes in 6.6</a>
</span>
<span class="next">
<a href="es-release-notes.html">Release Notes »</a>
</span>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>

                        <!-- Feedback widget -->
                        <div id="feedbackWidgetContainer"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


        <div id='elastic-footer'></div>
        <script src='https://www.elastic.co/elastic-footer.js'></script>
        <!-- Footer Section end-->

      </section>
    </div>

    <!-- Feedback modal -->
    <div id="feedbackModalContainer"></div>

    <script src="/guide/static/jquery.js"></script>
    <script type="text/javascript" src="/guide/static/docs-v1.js"></script>
    <script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
