<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Breaking changes in 6.7 | Elasticsearch Reference [6.8] | Elastic</title>
<link rel="home" href="index.html" title="Elasticsearch Reference [6.8]"/>
<link rel="up" href="breaking-changes.html" title="Breaking changes"/>
<link rel="prev" href="breaking-changes-6.6.html" title="Breaking changes in 6.6"/>
<link rel="next" href="breaking-changes-6.8.html" title="Breaking changes in 6.8"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/6.8"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="6.8"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!--BEGIN QUALTRICS WEBSITE FEEDBACK SNIPPET-->
    <script type='text/javascript'>
      (function(){var g=function(e,h,f,g){
      this.get=function(a){for(var a=a+"=",c=document.cookie.split(";"),b=0,e=c.length;b<e;b++){for(var d=c[b];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return null};
      this.set=function(a,c){var b="",b=new Date;b.setTime(b.getTime()+6048E5);b="; expires="+b.toGMTString();document.cookie=a+"="+c+b+"; path=/; "};
      this.check=function(){var a=this.get(f);if(a)a=a.split(":");else if(100!=e)"v"==h&&(e=Math.random()>=e/100?0:100),a=[h,e,0],this.set(f,a.join(":"));else return!0;var c=a[1];if(100==c)return!0;switch(a[0]){case "v":return!1;case "r":return c=a[2]%Math.floor(100/c),a[2]++,this.set(f,a.join(":")),!c}return!0};
      this.go=function(){if(this.check()){var a=document.createElement("script");a.type="text/javascript";a.src=g;document.body&&document.body.appendChild(a)}};
      this.start=function(){var a=this;window.addEventListener?window.addEventListener("load",function(){a.go()},!1):window.attachEvent&&window.attachEvent("onload",function(){a.go()})}};
      try{(new g(100,"r","QSI_S_ZN_emkP0oSe9Qrn7kF","https://znemkp0ose9qrn7kf-elastic.siteintercept.qualtrics.com/WRSiteInterceptEngine/?Q_ZID=ZN_emkP0oSe9Qrn7kF")).start()}catch(i){}})();
    </script><div id='ZN_emkP0oSe9Qrn7kF'><!--DO NOT REMOVE-CONTENTS PLACED HERE--></div>
    <!--END WEBSITE FEEDBACK SNIPPET-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <!-- Subnav -->
    <div>
      <div>
        <div class="tertiary-nav d-none d-md-block">
          <div class="container">
            <div class="p-t-b-15 d-flex justify-content-between nav-container">
              <div class="breadcrum-wrapper"><span><a href="/guide/" style="font-size: 14px; font-weight: 600; color: #000;">Docs</a></span></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container">
              <div class="row">
                <div class="col-xs-12 col-sm-8 col-md-8 guide-section">
                  <!-- start body -->
                  <div class="page_header">
<p>
  <strong>NOTE</strong>: You are looking at documentation for an older release. 
  For the latest information, see the 
  <a href="../current/index.html">current release documentation</a>. 
</p>
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Elasticsearch Reference [6.8]</a></span>
»
<span class="breadcrumb-link"><a href="breaking-changes.html">Breaking changes</a></span>
»
<span class="breadcrumb-node">Breaking changes in 6.7</span>
</div>
<div class="navheader">
<span class="prev">
<a href="breaking-changes-6.6.html">« Breaking changes in 6.6</a>
</span>
<span class="next">
<a href="breaking-changes-6.8.html">Breaking changes in 6.8 »</a>
</span>
</div>
<div class="chapter">
<div class="titlepage"><div><div>
<h2 class="title"><a id="breaking-changes-6.7"></a>Breaking changes in 6.7<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/6.8/docs/reference/migration/migrate_6_7.asciidoc">edit</a></h2>
</div></div></div>

<p>This section discusses the changes that you need to be aware of when migrating
your application to Elasticsearch 6.7.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="breaking-changes-6.7.html#breaking_67_indexing_changes" title="Indexing changes">Indexing changes</a>
</li>
<li class="listitem">
<a class="xref" href="breaking-changes-6.7.html#breaking_67_plugin_changes" title="Plugin changes">Plugin changes</a>
</li>
<li class="listitem">
<a class="xref" href="breaking-changes-6.7.html#breaking_67_settings_changes" title="Settings changes">Settings changes</a>
</li>
<li class="listitem">
<a class="xref" href="breaking-changes-6.7.html#breaking_67_api_changes" title="API changes">API changes</a>
</li>
<li class="listitem">
<a class="xref" href="breaking-changes-6.7.html#breaking_67_security_changes" title="Security changes">Security changes</a>
</li>
</ul>
</div>
<p>See also <a class="xref" href="release-highlights.html" title="Release Highlights">Release Highlights</a> and <a class="xref" href="es-release-notes.html" title="Release Notes">Release Notes</a>.</p>
<h3><a id="breaking_67_indexing_changes"></a>Indexing changes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/6.8/docs/reference/migration/migrate_6_7.asciidoc">edit</a></h3>
<h4><a id="_deprecated_usage_of_literal_internal_literal_versioning_for_optimistic_concurrency_control"></a>Deprecated usage of <code class="literal">internal</code> versioning for optimistic concurrency control<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/6.8/docs/reference/migration/migrate_6_7.asciidoc">edit</a></h4>
<p><code class="literal">internal</code> version may not uniquely identify a document&#8217;s version if an indexed document
wasn&#8217;t fully replicated when a primary fails. As such it is unsafe to use for
optimistic concurrency control, is deprecated and the option will no longer be available
in Elasticsearch 7.0.0. Please use the <code class="literal">if_seq_no</code> and <code class="literal">if_primary_term</code> parameters instead.
See <a class="xref" href="optimistic-concurrency-control.html" title="Optimistic concurrency control"><em>Optimistic concurrency control</em></a> for more details.</p>
<h3><a id="breaking_67_plugin_changes"></a>Plugin changes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/6.8/docs/reference/migration/migrate_6_7.asciidoc">edit</a></h3>
<h4><a id="_literal_ingest_geoip_literal_and_literal_ingest_user_agent_literal_are_no_longer_distributed_as_plugins"></a><code class="literal">ingest-geoip</code> and <code class="literal">ingest-user-agent</code> are no longer distributed as plugins<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/6.8/docs/reference/migration/migrate_6_7.asciidoc">edit</a></h4>
<p>The <code class="literal">ingest-geoip</code> and <code class="literal">ingest-user-agent</code> plugins have been converted to
modules and are now included with all Elasticsearch distributions. Starting with
Elasticsearch 6.7.0, attempting to install or remove these plugins will result
in a no-op. In Elasticsearch 7.0.0, attempting to install or remove these plugins
will result in an error. Additionally, there are two minor breaking changes here:
- <code class="literal">elasticsearch-plugin list</code> will no longer output <code class="literal">ingest-geoip</code> nor
  <code class="literal">ingest-user-agent</code>
- <code class="literal">plugin.mandatory</code> is no longer compatible with <code class="literal">ingest-geoip</code> nor
  <code class="literal">ingest-user-agent</code></p>
<p>Elasticsearch 6.7.0 checks that there are no leftover geoip database files in
the plugin configuration directory because the new module does not use them.
Therefore, remove the <code class="literal">ingest-geoip</code> plugin prior to upgrading to 6.7.0 with
the <code class="literal">--purge</code> option to also delete the old database files:</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">./bin/elasticsearch-plugin remove --purge ingest-geoip</pre>
</div>
<p>Otherwise you will see the following error message upon startup (assuming
<code class="literal">/etc/elasticsearch/ingest-geoip</code> as the plugin configuration directory):</p>
<div class="pre_wrapper lang-text">
<pre class="programlisting prettyprint lang-text">expected database [GeoLite2-ASN.mmdb] to not exist in [/etc/elasticsearch/ingest-geoip]</pre>
</div>
<h3><a id="breaking_67_settings_changes"></a>Settings changes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/6.8/docs/reference/migration/migrate_6_7.asciidoc">edit</a></h3>
<h4><a id="_disabling_memory_mapping"></a>Disabling memory-mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/6.8/docs/reference/migration/migrate_6_7.asciidoc">edit</a></h4>
<p>The setting <code class="literal">node.store.allow_mmapfs</code> has been deprecated. Use
<code class="literal">node.store.allow_mmap</code> instead.</p>
<h3><a id="breaking_67_api_changes"></a>API changes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/6.8/docs/reference/migration/migrate_6_7.asciidoc">edit</a></h3>
<h4><a id="_removing_compressed_size_of_cluster_state"></a>Removing compressed size of cluster state<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/6.8/docs/reference/migration/migrate_6_7.asciidoc">edit</a></h4>
<p>Since 6.0.0, the <code class="literal">/_cluster/state</code> REST endpoint and cluster state API on the
transport client would compute and return the compressed size of the cluster
state as if it were serialized for inter-node communication. This metric would
be returned in the <code class="literal">compressed_size</code> or <code class="literal">compressed_size_in_bytes</code> fields in the
REST endpoint, or <code class="literal">ClusterStateResponse#getTotalCompressedSize</code> via the
transport client. Computing this field is expensive, and has dubious reporting
value as it does not reflect the actual size of the cluster state on disk. The
expense of computing this field is such that in some situations it can disrupt
all activity on a node including indexing activity. Therefore we have elected to
by default stop computing this field in a minor release. We are providing a
backwards compatibility flag via the system property
<code class="literal">-Des.cluster_state.size=true</code> which will return to the previous 6.0.0&#8212;&#8203;6.6.2
behavior.  Computing this metric and displaying this field will be completely
removed in 7.0.0, and using this backwards compatibility flag will fail.</p>
<h3><a id="breaking_67_security_changes"></a>Security changes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/6.8/docs/reference/migration/migrate_6_7.asciidoc">edit</a></h3>
<h4><a id="_removed_support_for_pre_v6_2_tokens"></a>Removed support for pre v6.2 tokens<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/6.8/docs/reference/migration/migrate_6_7.asciidoc">edit</a></h4>
<p>The token service no longer accepts tokens that were generated on an Elasticsearch version
earlier than 6.2.0</p>
<p>No applications in the Elastic Stack made use of Elasticsearch tokens prior to 6.2.0, so this
change does not affect access to Kibana or any official Elasticsearch clients.
If you have an application that uses Elasticsearch tokens, and a token from 6.1 or earlier
is presented for authentication, Elasticsearch will reject the token with a <code class="literal">401</code> status code.</p>
</div>
<div class="navfooter">
<span class="prev">
<a href="breaking-changes-6.6.html">« Breaking changes in 6.6</a>
</span>
<span class="next">
<a href="breaking-changes-6.8.html">Breaking changes in 6.8 »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>
                <div class="col-xs-12 col-sm-4 col-md-4" id="right_col">
                  <div id="rtpcontainer" style="display: block;">
                    <div class="mktg-promo">
                      <h3>Most Popular</h3>
                      <ul class="icons">
                        <li class="icon-elasticsearch-white"><a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">Get Started with Elasticsearch: Video</a></li>
                        <li class="icon-kibana-white"><a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">Intro to Kibana: Video</a></li>
                        <li class="icon-logstash-white"><a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">ELK for Logs & Metrics: Video</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";
	var localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}';
</script>
<script src="/static/js/swiftype_app_search.umd.min.js"></script>
<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
