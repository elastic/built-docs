<!DOCTYPE html>
<html lang="en-us">
  <head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Explore API
        | Elasticsearch Reference [6.8]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Elasticsearch Reference [6.8]" /><link rel="up" href="xpack-api.html" title="X-Pack APIs" /><link rel="prev" href="ccr-get-auto-follow-pattern.html" title="Get auto-follow pattern API" /><link rel="next" href="freeze-index-api.html" title="Freeze index API" /><meta name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/6.8" /><meta name="DC.subject" content="Elasticsearch" /><meta name="DC.identifier" content="6.8" />
    
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#ffffff">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <!-- DC tags section -->
    <link rel="schema.DC" href="http://purl.org/dc/elements/1.1/" >
    <link rel="schema.DCTERMS" href="http://purl.org/dc/terms/" >
    
    <!-- end DC tags -->
    <meta name="description" content="" />
    <meta name="localized" content="true" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <!-- For third-generation iPad with high-resolution Retina display: -->
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <!-- For iPhone with high-resolution Retina display: -->
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <!-- For first- and second-generation iPad: -->
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- css -->
    <link href="/static/css/main.css" rel="stylesheet">
    <script src="/static/js/jquery.min.js"></script>
    <script src="/static/js/bootstrap.min.js"></script>
    <script src="/static/js/jquery.cookie.js"></script>
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <script type="text/javascript">
      // -------------------- set language based on browser language --------------------
      var lang = '/'+(navigator.language || navigator.userLanguage).slice(0,2)+'/',
      locales = {
        '/en':'/',
        '/de/': '/de/',
        '/fr/': '/fr/',
        '/ja/':'/jp/',
        '/ko/':'/kr/',
        '/zh/':'/cn/',
        '/es/': '/es/'
      },
      localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}',
      currentlocale = JSON.parse(localeUrl).relative_url_prefix;

      if($.cookie("is_lang_detected") == undefined){
        if(locales[lang] != undefined && locales[lang] != currentlocale){
          locale_lang_url = locales[lang] + window.location.pathname.slice(1,window.location.pathname.length);
          $.cookie("is_lang_detected",true ,{ path: '/'});
          window.location = locale_lang_url;
        }
      }
            
      // --------------------- end of set language based on browser language -----------------
    </script>
    <link type="text/css" rel="stylesheet" href="/static/css/guide.css" />
  
<link rel="stylesheet" type="text/css" href="styles.css" />

</head>

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->
    
    <!-- new ga for staging server -->
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>
    <!-- new ga for staging server -->

    <!-- Elastic APM -->
    <!--
    <script src="https://www.elastic.co/static/js/elastic-apm-js-base.umd.min.2.2.0.js"></script>
    <script type="text/javascript">
      var elasticApm = init({
        serviceName: 'elastic-co-frontend',
        serverUrl: 'https://3ddd1ee09cc242c4b169d36f5a2b8b77.apm.us-west1.gcp.cloud.es.io:443',
        stackTraceLimit: 5,
        serviceVersion: '1.0.0'
      })
    
      var pageLoadName
      var pathname = window.location.pathname.replace(/\/es|\/pt|\/jp|\/pt|\/fr|\/kr|\/cn|\/de/g, '')
      var parts = pathname.split('/');
    
      if (parts.length && parts[1] === 'blog') {
        if (parts.length === 2) {
          pageLoadName =  '/blog';
        }
        else if (parts[2] === 'category') {
          pageLoadName =  '/blog/category';
        }
        else if (parts[2] === 'archive') {
          pageLoadName =  '/blog/archive';
        }
        else {
          pageLoadName =  '/blog/detail';
        }
      }
      else if (parts.length && parts[1] === 'elasticon') {
        if (parts.length === 2) {
          pageLoadName =  '/elasticon';
        }
        else if (parts.length === 5 && (parts[2] === 'conf' || parts[2] === 'tour')) {
          pageLoadName =  '/elasticon/overview';
        }
        else if (parts.length > 5 && (parts[2] === 'conf' || parts[2] === 'tour')) {
          pageLoadName =  '/elasticon/video';
        }
      }
      else if (parts.length && parts[1] === 'guide') {
        pageLoadName =  '/guide';
      }
      else if (parts.length === 2 && parts[1] === 'videos') {
        pageLoadName =  '/videos';
      }
      else if (parts.length > 2 && parts[1] === 'videos') {
        pageLoadName =  '/videos/detail';
      }
      else if (parts.length > 2 && parts[1] === 'webinars') {
        pageLoadName =  '/webinars/detail';
      }
      else {
        pageLoadName =  window.location.pathname;
      }
    
      console.log('apm pageLoadName:', pageLoadName, parts)
      elasticApm.setTags({env:"production"});
      elasticApm.setInitialPageLoadName(pageLoadName);
    </script>
    -->

    <!-- Header Section -->
    
    <div id='elastic-nav'></div>

    <link rel="stylesheet" type="text/css" href="/static/css/horizon-swiper.min.css">

    <style> 
      .m-shortcuts li a.m-search {
        background: url("/assets/blt7b9c4fe6528dc4ef/m-search-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}

      .m-shortcuts li a.m-docs {
        background: url("/assets/blt44d8b7530a76d01c/m-guide-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}

      .m-shortcuts li a.m-contact {
        background: url("/assets/blt878040795c9d083b/m-contact-icon.png") no-repeat scroll center center rgba(0, 0, 0, 0);
        background-size: contain;}
    </style>

    <script type="text/javascript" src="/static/js/horizon-swiper.min.js"></script>

    <script type="text/javascript">
      $(document).ready( function(){
        // if($('#scrollable-pane li').length > 3){
          $('.horizon-swiper').horizonSwiper({
            showItems: 3,
            arrows: true
          }); 
        // }
        
        $('.navbar-toggle').on('click', function(){
          $('.mobile-navigation, .menu-open').hide();
          $('.navigation-wrapper').addClass('mobile-navigation');
          $('.navbar').addClass('menu-open');
          $('.menu-close').show();
        });
        $('.menu-close').on('click', function(){
          $('.navigation-wrapper').removeClass('mobile-navigation');
          $('.navbar').removeClass('menu-open');
          $('.menu-close').hide();
        });
    
        var active_url = "";
    
        $(".navbar-mobile-header-icon").click(function(index){
          $('.navigation-wrapper').toggleClass('menu-overlay');
          $(this).toggleClass("navbar-mobile-header-icon-click navbar-mobile-header-icon-out");
          $(".mobile-inner-nav").slideToggle(500);
          $(".mobile-inner-nav .navbar-nav a").each(function( index ) {
            $(this).css({'animation-delay': (index/25)+'0.4s'});
          });
        });
    
        $('.dropdown-btn').on('click', function(e){
          e.preventDefault();
          setDropdown();
        });
        
        function setDropdown() {
          $('#myDropdown').slideToggle();
        }
    
        $('body').on('click', function(event){
          if (!event.target.matches('.dropdown-btn')) {
    
            var dropdowns = $(".dropdown-content");
            var i;
            for (i = 0; i < dropdowns.length; i++) {
              var openDropdown = dropdowns[i];
              if (openDropdown.classList.contains('show')) {
                openDropdown.classList.remove('show');
              }
            }
          }
        });
    
      });
      $(window).resize(function () {
        $('.horizon-swiper').horizonSwiper({
          showItems: 3,
          arrows: true
        });
      });
    </script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">   

          <section id="guide" lang="en">
            <div class="container">
              <div class="row">
                <!-- start body -->
                
            <div class="col-xs-12 col-sm-8 col-md-8 guide-section">
            <!-- start body -->
<div class="page_header">You are looking at documentation for an older release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Elasticsearch Reference
      [6.8]
    </a></span> » <span class="breadcrumb-link"><a href="xpack-api.html">X-Pack APIs</a></span> » <span class="breadcrumb-node">Explore API</span></div><div class="navheader"><span class="prev"><a href="ccr-get-auto-follow-pattern.html">
              « 
              Get auto-follow pattern API</a>
           
        </span><span class="next">
           
          <a href="freeze-index-api.html">Freeze index API
               »
            </a></span></div><div class="xpack chapter"><div class="titlepage"><div><div><h2 class="title"><a id="graph-explore-api"></a>Explore API<a href="https://github.com/elastic/elasticsearch/edit/6.8/docs/reference/graph/explore.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2></div></div></div><p>The Graph explore API enables you to extract and summarize information about
the documents and terms in your Elasticsearch index.</p><p>The easiest way to understand the behaviour of this API is to use the
Graph UI to explore connections. You can view the most recent request submitted
to the <code class="literal">_explore</code> endpoint from the <span class="strong strong"><strong>Last request</strong></span> panel. For more information,
see <a class="ulink" href="https://www.elastic.co/guide/en/kibana/6.8/graph-getting-started.html" target="_top">Getting Started with Graph</a>.</p><p>For additional information about working with the explore API, see the Graph
<a class="ulink" href="https://www.elastic.co/guide/en/kibana/6.8/graph-troubleshooting.html" target="_top">Troubleshooting</a> and
<a class="ulink" href="https://www.elastic.co/guide/en/kibana/6.8/graph-limitations.html" target="_top">Limitations</a> topics.</p><h3><a id="_request_13"></a>Request<a href="https://github.com/elastic/elasticsearch/edit/6.8/docs/reference/graph/explore.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p><code class="literal">POST &lt;index&gt;/_xpack/graph/_explore</code></p><h3><a id="_description_13"></a>Description<a href="https://github.com/elastic/elasticsearch/edit/6.8/docs/reference/graph/explore.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>An initial request to the <code class="literal">_explore</code> API contains a seed query that identifies
the documents of interest and specifies the fields that define the vertices
and connections you want to include in the graph. Subsequent <code class="literal">_explore</code> requests
enable you to <span class="emphasis"><em>spider out</em></span> from one more vertices of interest. You can exclude
vertices that have already been returned.</p><h3><a id="_request_body_6"></a>Request Body<a href="https://github.com/elastic/elasticsearch/edit/6.8/docs/reference/graph/explore.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><div class="variablelist"><dl class="variablelist"><dt><span class="term">query</span></dt><dd><p class="simpara">A seed query that identifies the documents of interest. Can be any valid
Elasticsearch query. For example:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">"query": {
  "bool": {
    "must": {
      "match": {
        "query.raw": "midi"
      }
    },
    "filter": [
      {
        "range": {
          "query_time": {
            "gte": "2015-10-01 00:00:00"
          }
        }
      }
    ]
  }
}</pre></div></dd><dt><span class="term">vertices</span></dt><dd><p class="simpara">Specifies or more fields that contain the terms you want to include in the
graph as vertices. For example:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">"vertices": [
  {
    "field": "product"
    }
]</pre></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">field</span></dt><dd>Identifies a field in the documents of interest.</dd><dt><span class="term">include</span></dt><dd>Identifies the terms of interest that form the starting points
from which you want to spider out. You do not have to specify a seed query
if you specify an include clause. The include clause implicitly querys for
documents that contain any of the listed terms listed.
In addition to specifying a simple array of strings, you can also pass
objects with <code class="literal">term</code> and <code class="literal">boost</code> values to boost matches on particular terms.</dd><dt><span class="term">exclude</span></dt><dd>The <code class="literal">exclude</code> clause prevents the specified terms from being included in
the results.</dd><dt><span class="term">size</span></dt><dd>Specifies the maximum number of vertex terms returned for each
field. Defaults to 5.</dd><dt><span class="term">min_doc_count</span></dt><dd>Specifies how many documents must contain a pair of terms before it is
considered to be a useful connection. This setting acts as a certainty
threshold. Defaults to 3.</dd><dt><span class="term">shard_min_doc_count</span></dt><dd>This advanced setting controls how many documents on a particular shard have
to contain a pair of terms before the connection is returned for global
consideration. Defaults to 2.</dd></dl></div></dd><dt><span class="term">connections</span></dt><dd><p class="simpara">Specifies or more fields from which you want to extract terms that are
associated with the specified vertices. For example:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">"connections": {  <a id="CO525-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
  "vertices": [
    {
      "field": "query.raw"
    }
  ]
}</pre></div><div class="note admon"><div class="icon"><img alt="Note" src="images/icons/note.png" /></div><div class="admon_content"><p>Connections can be nested inside the <code class="literal">connections</code> object to
explore additional relationships in the data. Each level of nesting is
considered a <span class="emphasis"><em>hop</em></span>, and proximity within the graph is often described in
terms of <span class="emphasis"><em>hop depth</em></span>.</p></div></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">query</span></dt><dd>An optional <span class="emphasis"><em>guiding query</em></span> that constrains the Graph API as it
explores connected terms. For example, you might want to direct the Graph
API to ignore older data by specifying a query that identifies recent
documents.</dd><dt><span class="term">vertices</span></dt><dd><p class="simpara">Contains the fields you are interested in. For example:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">"vertices": [
  {
    "field": "query.raw",
    "size": 5,
    "min_doc_count": 10,
    "shard_min_doc_count": 3
  }
]</pre></div></dd></dl></div></dd><dt><span class="term">controls</span></dt><dd><p class="simpara">Direct the Graph API how to build the graph.</p><div class="variablelist"><dl class="variablelist"><dt><span class="term">use_significance</span></dt><dd>The <code class="literal">use_significance</code> flag filters associated terms so only those that are
significantly associated with your query are included. For information about
the algorithm used to calculate significance, see the
<a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/6.8/search-aggregations-bucket-significantterms-aggregation.html" target="_top">significant_terms
aggregation</a>. Defaults to <code class="literal">true</code>.</dd><dt><span class="term">sample_size</span></dt><dd>Each <span class="emphasis"><em>hop</em></span> considers a sample of the best-matching documents on each
shard. Using samples improves the speed of execution and keeps
exploration focused on meaningfully-connected terms. Very small values
(less than 50) might not provide sufficient weight-of-evidence to identify
significant connections between terms. Very large sample sizes can dilute
the quality of the results and increase execution times.
Defaults to 100 documents.</dd><dt><span class="term">timeout</span></dt><dd>The length of time in milliseconds after which exploration will be halted
and the results gathered so far are returned. This timeout is honored on
a best-effort basis. Execution might overrun this timeout if, for example,
a long pause is encountered while FieldData is loaded for a field.</dd><dt><span class="term">sample_diversity</span></dt><dd><p class="simpara">To avoid the top-matching documents sample being dominated by a single
source of results, it is sometimes necessary to request diversity in
the sample. You can do this by selecting a single-value field and setting
a maximum number of documents per value for that field. For example:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">"sample_diversity": {
  "field": "category.raw",
  "max_docs_per_value": 500
}</pre></div></dd></dl></div></dd></dl></div><h3><a id="_examples_8"></a>Examples<a href="https://github.com/elastic/elasticsearch/edit/6.8/docs/reference/graph/explore.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><h4><a id="basic-search"></a>Basic exploration<a href="https://github.com/elastic/elasticsearch/edit/6.8/docs/reference/graph/explore.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>An initial search typically begins with a query to identify strongly related terms.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-console">POST clicklogs/_xpack/graph/_explore
{
    "query": { <a id="CO525-2"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
        "match": {
            "query.raw": "midi"
        }
    },
    "vertices": [ <a id="CO525-3"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>
        {
            "field": "product"
        }
    ],
    "connections": {  <a id="CO525-4"></a><span><img src="images/icons/callouts/3.png" alt="" /></span>
        "vertices": [
            {
                "field": "query.raw"
            }
        ]
    }
}</pre></div><div class="console_widget" data-snippet="snippets/1501.console"></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO525-2"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>Seed the exploration with a query. This example is searching
clicklogs for people who searched for the term "midi".</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO525-3"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>Identify the vertices to include in the graph. This example is looking for
product codes that are significantly associated with searches for "midi".</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO525-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> <a href="#CO525-4"><span><img src="images/icons/callouts/3.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>Find the connections. This example is looking for other search
terms that led people to click on the products that are associated with
searches for "midi".</p></td></tr></table></div><p>The response from the explore API looks like this:</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-js">{
   "took": 0,
   "timed_out": false,
   "failures": [],
   "vertices": [ <a id="CO526-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
      {
         "field": "query.raw",
         "term": "midi cable",
         "weight": 0.08745858139552132,
         "depth": 1
      },
      {
         "field": "product",
         "term": "8567446",
         "weight": 0.13247784285434397,
         "depth": 0
      },
      {
         "field": "product",
         "term": "1112375",
         "weight": 0.018600718471158982,
         "depth": 0
      },
      {
         "field": "query.raw",
         "term": "midi keyboard",
         "weight": 0.04802242866755111,
         "depth": 1
      }
   ],
   "connections": [ <a id="CO526-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>
      {
         "source": 0,
         "target": 1,
         "weight": 0.04802242866755111,
         "doc_count": 13
      },
      {
         "source": 2,
         "target": 3,
         "weight": 0.08120623870976627,
         "doc_count": 23
      }
   ]
}</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO526-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>An array of all of the vertices that were discovered. A vertex is an indexed
term, so the field and term value are provided. The <code class="literal">weight</code> attribute specifies
a significance score. The <code class="literal">depth</code> attribute specifies the hop-level at which
the term was first encountered.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO526-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>The connections between the vertices in the array. The <code class="literal">source</code> and <code class="literal">target</code>
properties are indexed into the vertices array and indicate which vertex term led
to the other as part of exploration. The <code class="literal">doc_count</code> value indicates how many
documents in the sample set contain this pairing of terms (this is
not a global count for all documents in the index).</p></td></tr></table></div><h4><a id="optional-controls"></a>Optional controls<a href="https://github.com/elastic/elasticsearch/edit/6.8/docs/reference/graph/explore.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>The default settings are configured to remove noisy data and
get the "big picture" from your data. This example shows how to specify
additional parameters to influence how the graph is built.</p><p>For tips on tuning the settings for more detailed forensic evaluation where
every document could be of interest, see the
<a class="ulink" href="https://www.elastic.co/guide/en/kibana/6.8/graph-troubleshooting.html" target="_top">Troubleshooting</a> guide.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-console">POST clicklogs/_xpack/graph/_explore
{
    "query": {
        "match": {
            "query.raw": "midi"
        }
    },
   "controls": {
      "use_significance": false,<a id="CO527-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
      "sample_size": 2000,<a id="CO527-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>
      "timeout": 2000,<a id="CO527-3"></a><span><img src="images/icons/callouts/3.png" alt="" /></span>
      "sample_diversity": {<a id="CO527-4"></a><span><img src="images/icons/callouts/4.png" alt="" /></span>
         "field": "category.raw",
         "max_docs_per_value": 500
      }
   },
   "vertices": [
      {
         "field": "product",
         "size": 5,<a id="CO527-5"></a><span><img src="images/icons/callouts/5.png" alt="" /></span>
         "min_doc_count": 10,<a id="CO527-6"></a><span><img src="images/icons/callouts/6.png" alt="" /></span>
         "shard_min_doc_count": 3<a id="CO527-7"></a><span><img src="images/icons/callouts/7.png" alt="" /></span>
      }
   ],
   "connections": {
      "query": {<a id="CO527-8"></a><span><img src="images/icons/callouts/8.png" alt="" /></span>
         "bool": {
            "filter": [
               {
                  "range": {
                     "query_time": {
                        "gte": "2015-10-01 00:00:00"
                     }
                  }
               }
            ]
         }
      },
      "vertices": [
         {
            "field": "query.raw",
            "size": 5,
            "min_doc_count": 10,
            "shard_min_doc_count": 3
         }
      ]
   }
}</pre></div><div class="console_widget" data-snippet="snippets/1502.console"></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO527-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>Disable <code class="literal">use_significance</code> to include all associated terms, not just the
ones that are significantly associated with the query.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO527-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>Increase the sample size to consider a larger set of documents on
each shard.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO527-3"><span><img src="images/icons/callouts/3.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>Limit how long a graph request runs before returning results.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO527-4"><span><img src="images/icons/callouts/4.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>Ensure diversity in the sample by setting a limit on the number of documents
per value in a particular single-value field, such as a category field.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO527-5"><span><img src="images/icons/callouts/5.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>Control the maximum number of vertex terms returned for each field.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO527-6"><span><img src="images/icons/callouts/6.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>Set a certainty threshold that specifies how many documents have to contain
a pair of terms before we consider it to be a useful connection.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO527-7"><span><img src="images/icons/callouts/7.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>Specify how many documents on a shard have to contain a pair of terms before
the connection is returned for global consideration.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO527-8"><span><img src="images/icons/callouts/8.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>Restrict which document are considered as you explore connected terms.</p></td></tr></table></div><h4><a id="spider-search"></a>Spidering operations<a href="https://github.com/elastic/elasticsearch/edit/6.8/docs/reference/graph/explore.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>After an initial search, you typically want to select vertices of interest and
see what additional vertices are connected. In graph-speak, this operation is
referred to as "spidering". By submitting a series of requests, you can
progressively build a graph of related information.</p><p>To spider out, you need to specify two things:</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">The set of vertices for which you want to find additional connections</li><li class="listitem">The set of vertices you already know about that you want to exclude from the
results of the spidering operation.</li></ul></div><p>You specify this information using <code class="literal">include`and `exclude</code> clauses. For example,
the following request starts with the product <code class="literal">1854873</code> and spiders
out to find additional search terms associated with that product. The terms
"midi", "midi keyboard", and "synth" are excluded from the results.</p><div class="pre_wrapper"><pre class="programlisting prettyprint lang-console">POST clicklogs/_xpack/graph/_explore
{
   "vertices": [
      {
         "field": "product",
         "include": [ "1854873" ] <a id="CO528-1"></a><span><img src="images/icons/callouts/1.png" alt="" /></span>
      }
   ],
   "connections": {
      "vertices": [
         {
            "field": "query.raw",
            "exclude": [ <a id="CO528-2"></a><span><img src="images/icons/callouts/2.png" alt="" /></span>
               "midi keyboard",
               "midi",
               "synth"
            ]
         }
      ]
   }
}</pre></div><div class="console_widget" data-snippet="snippets/1503.console"></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO528-1"><span><img src="images/icons/callouts/1.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>The vertices you want to start from are specified
as an array of terms in an <code class="literal">include</code> clause.</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO528-2"><span><img src="images/icons/callouts/2.png" alt="" /></span></a> </p></td><td valign="top" align="left"><p>The <code class="literal">exclude</code> clause prevents terms you already know about from being
included in the results.</p></td></tr></table></div></div><div class="navfooter"><span class="prev"><a href="ccr-get-auto-follow-pattern.html">
              « 
              Get auto-follow pattern API</a>
           
        </span><span class="next">
           
          <a href="freeze-index-api.html">Freeze index API
               »
            </a></span></div>
<!-- end body -->

            </div>
            <div class="col-xs-12 col-sm-4 col-md-4" id="right_col">
        
                  <div id="rtpcontainer" style="display: block;">
                    <div class="mktg-promo">
                      <h3>Getting Started Videos</h3>
                      <ul class="icons">
                        <li class="icon-elasticsearch-white"><a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">Starting Elasticsearch</a></li>
                        <li class="icon-kibana-white"><a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">Introduction to Kibana</a></li>
                        <li class="icon-logstash-white"><a href="https://www.elastic.co/webinars/getting-started-logstash?baymax=default&elektra=docs&storm=top-video">Logstash Starter Guide</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'</div>
<!-- Footer Section end-->

<script src='https://www.elastic.co/elastic-nav.js'></script>
<script src='https://www.elastic.co/elastic-footer.js'></script>

<style type="text/css">
	
        
            .Facebook a {background:url("/assets/bltf546ff2e0a8f2de5/facebook.svg") no-repeat;}
            .Facebook a:before {
                content: url("/assets/bltc24cf11c714ecfc4/facebook-hover.svg");
                width:0;
                height:0;
                visibility:hidden;
            }
        
        
            .Facebook a:hover {background:url("/assets/bltc24cf11c714ecfc4/facebook-hover.svg")}		
        
	
        
            .Twitter a {background:url("/assets/bltdd9556d6b24e2b85/twitter.svg") no-repeat;}
            .Twitter a:before {
                content: url("/assets/blt90b0372cc07a54d3/twitter-hover.svg");
                width:0;
                height:0;
                visibility:hidden;
            }
        
        
            .Twitter a:hover {background:url("/assets/blt90b0372cc07a54d3/twitter-hover.svg")}		
        
	
        
            .LinkedIn a {background:url("/assets/bltc4a77e0f52ce07f1/linkedin.svg") no-repeat;}
            .LinkedIn a:before {
                content: url("/assets/blt01ce654380e4ea6c/linkedin-hover.svg");
                width:0;
                height:0;
                visibility:hidden;
            }
        
        
            .LinkedIn a:hover {background:url("/assets/blt01ce654380e4ea6c/linkedin-hover.svg")}		
        
	
        
            .Xing a {background:url("/assets/bltc6347078dcc9ec76/xing.svg") no-repeat;}
            .Xing a:before {
                content: url("/assets/bltededebe5f7521a39/xing-hover.svg");
                width:0;
                height:0;
                visibility:hidden;
            }
        
        
            .Xing a:hover {background:url("/assets/bltededebe5f7521a39/xing-hover.svg")}		
        
	
        
            .YouTube a {background:url("/assets/blt4982061ce1aebc7f/youtube.svg") no-repeat;}
            .YouTube a:before {
                content: url("/assets/bltddeb6c6404ae81a5/youtube-hover.svg");
                width:0;
                height:0;
                visibility:hidden;
            }
        
        
            .YouTube a:hover {background:url("/assets/bltddeb6c6404ae81a5/youtube-hover.svg")}		
        
	
</style>

<script src="//app-lon02.marketo.com/js/forms2/js/forms2.min.js"></script>
<script>
$(document).ready(function(){

    var ipSuccess = function(data) {
        country = data.country_code;
        if (data.in_eu){
                        
            marketo_id = "6196";
            
        }else{ 
            marketo_id = "1398";

        }

        $('.subscribe-form form.sb-form').attr('id', 'mktoForm_' + marketo_id);
        if(window.MktoForms2){
            MktoForms2.loadForm("//app-lon02.marketo.com", "813-MAM-392", marketo_id,function(form){
                form.onSuccess(function(form){
                    $('#mktoForm_'+marketo_id).css('display','none');
                    $('.subscribe-wrapper .subscribe-form-container').hide();
                    $('.subscribe-wrapper').find('.form_thanks').removeClass('hide')
                    dataLayer.push({'event': 'mktoFormSubmit'});
                    return false;
                });
            });  
        }
    }

    var marketo_id;

    $.ajax({
        url: "/gdpr-data"
    }).success(function(data) {
        ipSuccess(data);
    });

})
</script>

      </section>
    </div>

    
     <script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";
	var localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}';
</script>
<script src="/static/js/swiftype_app_search.umd.min.js"></script>
<script src="/static/js/jquery.autocomplete.js"></script>
<script type="text/javascript" src="/static/js/slick.min.js"></script>
<script src="/static/js/nav-v5.js"></script>
<script src="/static/js/script.js"></script>
 
     
<script type="text/javascript">
$(document).ready(function(){
	if (window.location.hash.length) {
	      var target = $(window.location.hash);
	      target = target.length ? target : $(window.location.hash);
	      if (target.length) {
	        setTimeout(function(){ $(window).scrollTop(target.offset().top - 60); }, 1200);        
	      }
	}
	$('#guide').on('click','a[href*=#]:not([href=#])',function(e) {
			var flag=true;
		      if (location.pathname.replace(/^\//,'') == this.pathname.replace(/^\//,'') && location.hostname == this.hostname) {
		          var target = $(this.hash);
		          target = target.length ? target :$(this.hash);
		          if (target.length) {
		            if(flag){
		              flag=false;
		              var heightScroll=($('.tertiary-nav.navbar-fixed-top').height())?60:110;
		              $('html,body').animate({
		                  scrollTop: target.offset().top - heightScroll
		                }, 2000, function(){
		                  flag=true;
		                });
		            }                    
		          }
		      }
		    
	});

})

</script>

     <style></style>
     
  
            <script type="text/javascript" src="docs.js"></script>
<script type='text/javascript' src='https://cdn.rawgit.com/google/code-prettify/master/loader/run_prettify.js?lang=yaml'></script>

            </body>
        
</html>
