<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>EQL syntax reference | Elasticsearch Reference [7.x] | Elastic</title>
<link rel="home" href="index.html" title="Elasticsearch Reference [7.x]"/>
<link rel="up" href="eql.html" title="EQL search"/>
<link rel="prev" href="eql.html" title="EQL search"/>
<link rel="next" href="eql-function-ref.html" title="EQL function reference"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/7.x"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="7.x"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!--BEGIN QUALTRICS WEBSITE FEEDBACK SNIPPET-->
    <script type='text/javascript'>
      (function(){var g=function(e,h,f,g){
      this.get=function(a){for(var a=a+"=",c=document.cookie.split(";"),b=0,e=c.length;b<e;b++){for(var d=c[b];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return null};
      this.set=function(a,c){var b="",b=new Date;b.setTime(b.getTime()+6048E5);b="; expires="+b.toGMTString();document.cookie=a+"="+c+b+"; path=/; "};
      this.check=function(){var a=this.get(f);if(a)a=a.split(":");else if(100!=e)"v"==h&&(e=Math.random()>=e/100?0:100),a=[h,e,0],this.set(f,a.join(":"));else return!0;var c=a[1];if(100==c)return!0;switch(a[0]){case "v":return!1;case "r":return c=a[2]%Math.floor(100/c),a[2]++,this.set(f,a.join(":")),!c}return!0};
      this.go=function(){if(this.check()){var a=document.createElement("script");a.type="text/javascript";a.src=g;document.body&&document.body.appendChild(a)}};
      this.start=function(){var a=this;window.addEventListener?window.addEventListener("load",function(){a.go()},!1):window.attachEvent&&window.attachEvent("onload",function(){a.go()})}};
      try{(new g(100,"r","QSI_S_ZN_emkP0oSe9Qrn7kF","https://znemkp0ose9qrn7kf-elastic.siteintercept.qualtrics.com/WRSiteInterceptEngine/?Q_ZID=ZN_emkP0oSe9Qrn7kF")).start()}catch(i){}})();
    </script><div id='ZN_emkP0oSe9Qrn7kF'><!--DO NOT REMOVE-CONTENTS PLACED HERE--></div>
    <!--END WEBSITE FEEDBACK SNIPPET-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <!-- Subnav -->
    <div>
      <div>
        <div class="tertiary-nav d-none d-md-block">
          <div class="container">
            <div class="p-t-b-15 d-flex justify-content-between nav-container">
              <div class="breadcrum-wrapper"><span><a href="/guide/" style="font-size: 14px; font-weight: 600; color: #000;">Docs</a></span></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container">
              <div class="row">
                <div class="col-xs-12 col-sm-8 col-md-8 guide-section">
                  <!-- start body -->
                  <div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Elasticsearch Reference [7.x]</a></span>
»
<span class="breadcrumb-link"><a href="eql.html">EQL search</a></span>
»
<span class="breadcrumb-node">EQL syntax reference</span>
</div>
<div class="navheader">
<span class="prev">
<a href="eql.html">« EQL search</a>
</span>
<span class="next">
<a href="eql-function-ref.html">EQL function reference »</a>
</span>
</div>
<div class="chapter xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="eql-syntax"></a>EQL syntax reference<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/syntax.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<h3><a id="eql-basic-syntax"></a>Basic syntax<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/syntax.asciidoc">edit</a></h3>
<p>EQL queries require an event category and a matching condition. The <code class="literal">where</code>
keyword connects them.</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">event_category where condition</pre>
</div>
<p>For example, the following EQL query matches <code class="literal">process</code> events with a
<code class="literal">process.name</code> field value of <code class="literal">svchost.exe</code>:</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">process where process.name == "svchost.exe"</pre>
</div>
<h3><a id="eql-syntax-event-categories"></a>Event categories<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/syntax.asciidoc">edit</a></h3>
<p>An event category is a valid, indexed value of the
<a class="xref" href="eql.html#eql-required-fields" title="Required fields">event category field</a>. You can set the event category
field using the <code class="literal">event_category_field</code> parameter of the EQL search API.</p>
<h3><a id="eql-syntax-match-any-event-category"></a>Match any event category<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/syntax.asciidoc">edit</a></h3>
<p>To match events of any category, use the <code class="literal">any</code> keyword. You can also use the
<code class="literal">any</code> keyword to search for documents without a event category field.</p>
<p>For example, the following EQL query matches any documents with a
<code class="literal">network.protocol</code> field value of <code class="literal">http</code>:</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">any where network.protocol == "http"</pre>
</div>
<h3><a id="eql-syntax-escape-an-event-category"></a>Escape an event category<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/syntax.asciidoc">edit</a></h3>
<p>Use enclosing double quotes (<code class="literal">"</code>) or three enclosing double quotes (<code class="literal">"""</code>) to
escape event categories that:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Contain a special character, such as a hyphen (<code class="literal">-</code>) or dot (<code class="literal">.</code>)
</li>
<li class="listitem">
Contain a space
</li>
<li class="listitem">
Start with a numeral
</li>
</ul>
</div>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">".my.event.category"
"my-event-category"
"my event category"
"6eventcategory"

""".my.event.category"""
"""my-event-category"""
"""my event category"""
"""6eventcategory"""</pre>
</div>
<h3><a id="eql-syntax-escape-a-field-name"></a>Escape a field name<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/syntax.asciidoc">edit</a></h3>
<p>Use enclosing backticks (`) to escape field names that:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Contain a hyphen (<code class="literal">-</code>)
</li>
<li class="listitem">
Contain a space
</li>
<li class="listitem">
Start with a numeral
</li>
</ul>
</div>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">`my-field`
`my field`
`6myfield`</pre>
</div>
<p>Use double backticks (``) to escape any backticks (`) in the field
name.</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">my`field -&gt; `my``field`</pre>
</div>
<h3><a id="eql-syntax-conditions"></a>Conditions<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/syntax.asciidoc">edit</a></h3>
<p>A condition consists of one or more criteria an event must match.
You can specify and combine these criteria using the following operators. Most
EQL operators are case-sensitive by default.</p>
<h3><a id="eql-syntax-comparison-operators"></a>Comparison operators<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/syntax.asciidoc">edit</a></h3>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">&lt;   &lt;=   ==   :   !=   &gt;=   &gt;</pre>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;</code> (less than)
</span>
</dt>
<dd>
Returns <code class="literal">true</code> if the value to the left of the operator is less than the value
to the right. Otherwise returns <code class="literal">false</code>.
</dd>
<dt>
<span class="term">
<code class="literal">&lt;=</code> (less than or equal)
</span>
</dt>
<dd>
Returns <code class="literal">true</code> if the value to the left of the operator is less than or equal to
the value to the right. Otherwise returns <code class="literal">false</code>.
</dd>
<dt>
<span class="term">
<code class="literal">==</code> (equal, case-sensitive)
</span>
</dt>
<dd>
Returns <code class="literal">true</code> if the values to the left and right of the operator are equal.
Otherwise returns <code class="literal">false</code>. Wildcards are not supported.
</dd>
<dt>
<span class="term">
<code class="literal">:</code> (equal, case-insensitive)
</span>
</dt>
<dd>
Returns <code class="literal">true</code> if strings to the left and right of the operator are equal.
Otherwise returns <code class="literal">false</code>. Can only be used to compare strings. Supports
<a class="xref" href="eql-syntax.html#eql-syntax-wildcards" title="Wildcards">wildcards</a> and <a class="xref" href="eql-syntax.html#eql-syntax-lookup-operators" title="Lookup operators">list
lookups</a>.
</dd>
<dt>
<span class="term">
<code class="literal">!=</code> (not equal, case-sensitive)
</span>
</dt>
<dd>
Returns <code class="literal">true</code> if the values to the left and right of the operator are not
equal. Otherwise returns <code class="literal">false</code>. Wildcards are not supported.
</dd>
<dt>
<span class="term">
<code class="literal">&gt;=</code> (greater than or equal)
</span>
</dt>
<dd>
Returns <code class="literal">true</code> if the value to the left of the operator is greater than or equal
to the value to the right. Otherwise returns <code class="literal">false</code>. When comparing strings,
the operator uses a case-sensitive lexicographic order.
</dd>
<dt>
<span class="term">
<code class="literal">&gt;</code> (greater than)
</span>
</dt>
<dd>
Returns <code class="literal">true</code> if the value to the left of the operator is greater than the
value to the right. Otherwise returns <code class="literal">false</code>. When comparing strings,
the operator uses a case-sensitive lexicographic order.
</dd>
</dl>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p><code class="literal">=</code> is not supported as an equal operator. Use <code class="literal">==</code> or <code class="literal">:</code> instead.</p>
</div>
</div>
<h3><a id="eql-syntax-pattern-comparison-keywords"></a>Pattern comparison keywords<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/syntax.asciidoc">edit</a></h3>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">my_field like  "VALUE*"         // case-sensitive wildcard matching
my_field like~ "value*"         // case-insensitive wildcard matching

my_field regex  "VALUE[^Z].?"   // case-sensitive regex matching
my_field regex~ "value[^z].?"   // case-insensitive regex matching</pre>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">like</code> (case-sensitive)
</span>
</dt>
<dd>
Returns <code class="literal">true</code> if the string to the left of the keyword matches a
<a class="xref" href="eql-syntax.html#eql-syntax-wildcards" title="Wildcards">wildcard pattern</a> to the right. Supports
<a class="xref" href="eql-syntax.html#eql-syntax-lookup-operators" title="Lookup operators">list lookups</a>. Can only be used to compare
strings. For case-insensitive matching, use <code class="literal">like~</code>.
</dd>
<dt>
<span class="term">
<code class="literal">regex</code> (case-sensitive)
</span>
</dt>
<dd>
Returns <code class="literal">true</code> if the string to the left of the keyword matches a regular
expression to the right. For supported regular expression syntax, see
<a class="xref" href="regexp-syntax.html" title="Regular expression syntax"><em>Regular expression syntax</em></a>. Supports <a class="xref" href="eql-syntax.html#eql-syntax-lookup-operators" title="Lookup operators">list lookups</a>. Can
only be used to compare strings. For case-insensitive matching, use <code class="literal">regex~</code>.
</dd>
</dl>
</div>
<h3><a id="limitations-for-comparisons"></a>Limitations for comparisons<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/syntax.asciidoc">edit</a></h3>
<p>You cannot chain comparisons. Instead, use a
<a class="xref" href="eql-syntax.html#eql-syntax-logical-operators" title="Logical operators">logical operator</a> between comparisons. For
example, <code class="literal">foo &lt; bar &lt;= baz</code> is not supported. However, you can rewrite the
expression as <code class="literal">foo &lt; bar and bar &lt;= baz</code>, which is supported.</p>
<p>You also cannot compare a field to another field, even if the fields are changed
using a <a class="xref" href="eql-syntax.html#eql-functions" title="Functions">function</a>.</p>
<p><span class="strong strong"><strong>Example</strong></span><br>
The following EQL query compares the <code class="literal">process.parent_name</code> field
value to a static value, <code class="literal">foo</code>. This comparison is supported.</p>
<p>However, the query also compares the <code class="literal">process.parent.name</code> field value to the
<code class="literal">process.name</code> field. This comparison is not supported and will return an
error for the entire query.</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">process where process.parent.name == "foo" and process.parent.name == process.name</pre>
</div>
<p>Instead, you can rewrite the query to compare both the <code class="literal">process.parent.name</code>
and <code class="literal">process.name</code> fields to static values.</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">process where process.parent.name == "foo" and process.name == "foo"</pre>
</div>
<h3><a id="eql-syntax-logical-operators"></a>Logical operators<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/syntax.asciidoc">edit</a></h3>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">and  or  not</pre>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">and</code>
</span>
</dt>
<dd>
Returns <code class="literal">true</code> only if the condition to the left and right <em>both</em> return <code class="literal">true</code>.
Otherwise returns <code class="literal">false</code>.
</dd>
<dt>
<span class="term">
<code class="literal">or</code>
</span>
</dt>
<dd>
Returns <code class="literal">true</code> if one of the conditions to the left or right <code class="literal">true</code>.
Otherwise returns <code class="literal">false</code>.
</dd>
<dt>
<span class="term">
<code class="literal">not</code>
</span>
</dt>
<dd>
Returns <code class="literal">true</code> if the condition to the right is <code class="literal">false</code>.
</dd>
</dl>
</div>
<h3><a id="eql-syntax-lookup-operators"></a>Lookup operators<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/syntax.asciidoc">edit</a></h3>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">my_field in ("Value-1", "VALUE2", "VAL3")                 // case-sensitive
my_field in~ ("value-1", "value2", "val3")                // case-insensitive

my_field not in ("Value-1", "VALUE2", "VAL3")             // case-sensitive
my_field not in~ ("value-1", "value2", "val3")            // case-insensitive

my_field : ("value-1", "value2", "val3")                  // case-insensitive

my_field like  ("Value-*", "VALUE2", "VAL?")              // case-sensitive
my_field like~ ("value-*", "value2", "val?")              // case-insensitive

my_field regex  ("[vV]alue-[0-9]", "VALUE[^2].?", "VAL3") // case-sensitive
my_field regex~  ("value-[0-9]", "value[^2].?", "val3")   // case-sensitive</pre>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">in</code> (case-sensitive)
</span>
</dt>
<dd>
Returns <code class="literal">true</code> if the value is contained in the provided list. For
case-insensitive matching, use <code class="literal">in~</code>.
</dd>
<dt>
<span class="term">
<code class="literal">not in</code> (case-sensitive)
</span>
</dt>
<dd>
Returns <code class="literal">true</code> if the value is not contained in the provided list. For
case-insensitive matching, use <code class="literal">not in~</code>.
</dd>
<dt>
<span class="term">
<code class="literal">:</code> (case-insensitive)
</span>
</dt>
<dd>
Returns <code class="literal">true</code> if the string is contained in the provided list. Can only be used
to compare strings.
</dd>
<dt>
<span class="term">
<code class="literal">like</code> (case-sensitive)
</span>
</dt>
<dd>
Returns <code class="literal">true</code> if the string matches a <a class="xref" href="eql-syntax.html#eql-syntax-wildcards" title="Wildcards">wildcard pattern</a>
in the provided list. Can only be used to compare strings. For case-insensitive
matching, use <code class="literal">like~</code>.
</dd>
<dt>
<span class="term">
<code class="literal">regex</code> (case-sensitive)
</span>
</dt>
<dd>
Returns <code class="literal">true</code> if the string matches a regular expression pattern in the
provided list. For supported regular expression syntax, see <a class="xref" href="regexp-syntax.html" title="Regular expression syntax"><em>Regular expression syntax</em></a>.
Can only be used to compare strings. For case-insensitive matching, use
<code class="literal">regex~</code>.
</dd>
</dl>
</div>
<h3><a id="eql-syntax-math-operators"></a>Math operators<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/syntax.asciidoc">edit</a></h3>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">+  -  *  /  %</pre>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">+</code> (add)
</span>
</dt>
<dd>
Adds the values to the left and right of the operator.
</dd>
<dt>
<span class="term">
<code class="literal">-</code> (subtract)
</span>
</dt>
<dd>
Subtracts the value to the right of the operator from the value to the left.
</dd>
<dt>
<span class="term">
<code class="literal">*</code> (multiply)
</span>
</dt>
<dd>
Multiplies the values to the left and right of the operator.
</dd>
<dt>
<span class="term">
<code class="literal">/</code> (divide)
</span>
</dt>
<dd>
<p>
Divides the value to the left of the operator by the value to the right.
</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<a id="eql-divide-operator-float-rounding"></a>
<p>If both the dividend and divisor are integers, the divide (<code class="literal">\</code>) operation
<em>rounds down</em> any returned floating point numbers to the nearest integer. To
avoid rounding, convert either the dividend or divisor to a float.</p>
<p><span class="strong strong"><strong>Example</strong></span><br>
The <code class="literal">process.args_count</code> field is a <a class="xref" href="number.html" title="Numeric field types"><code class="literal">long</code></a> integer field containing a
count of process arguments.</p>
<p>A user might expect the following EQL query to only match events with a
<code class="literal">process.args_count</code> value of <code class="literal">4</code>.</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">process where ( 4 / process.args_count ) == 1</pre>
</div>
<p>However, the EQL query matches events with a <code class="literal">process.args_count</code> value of <code class="literal">3</code>
or <code class="literal">4</code>.</p>
<p>For events with a <code class="literal">process.args_count</code> value of <code class="literal">3</code>, the divide operation
returns a float of <code class="literal">1.333...</code>, which is rounded down to <code class="literal">1</code>.</p>
<p>To match only events with a <code class="literal">process.args_count</code> value of <code class="literal">4</code>, convert
either the dividend or divisor to a float.</p>
<p>The following EQL query changes the integer <code class="literal">4</code> to the equivalent float <code class="literal">4.0</code>.</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">process where ( 4.0 / process.args_count ) == 1</pre>
</div>
</div>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">%</code> (modulo)
</span>
</dt>
<dd>
Divides the value to the left of the operator by the value to the right. Returns only the remainder.
</dd>
</dl>
</div>
<h3><a id="eql-syntax-match-any-condition"></a>Match any condition<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/syntax.asciidoc">edit</a></h3>
<p>To match events solely on event category, use the <code class="literal">where true</code> condition.</p>
<p>For example, the following EQL query matches any <code class="literal">file</code> events:</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">file where true</pre>
</div>
<p>To match any event, you can combine the <code class="literal">any</code> keyword with the <code class="literal">where true</code>
condition:</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">any where true</pre>
</div>
<h3><a id="eql-syntax-check-field-exists"></a>Check if a field exists<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/syntax.asciidoc">edit</a></h3>
<p>To match events containing any value for a field, compare the field to <code class="literal">null</code>
using the <code class="literal">!=</code> operator:</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">my_field != null</pre>
</div>
<p>To match events that do not contain a field value, compare the field to <code class="literal">null</code>
using the <code class="literal">==</code> operator:</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">my_field == null</pre>
</div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>To avoid errors, the field must contain a non-<code class="literal">null</code> value in at
least one document or be <a class="xref" href="explicit-mapping.html" title="Explicit mapping">explicitly mapped</a>.</p>
</div>
</div>
<h3><a id="eql-syntax-strings"></a>Strings<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/syntax.asciidoc">edit</a></h3>
<p>Strings are enclosed in double quotes (<code class="literal">"</code>).</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">"hello world"</pre>
</div>
<p>Strings enclosed in single quotes (<code class="literal">'</code>) are not supported.</p>
<h3><a id="eql-syntax-escape-characters"></a>Escape characters in a string<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/syntax.asciidoc">edit</a></h3>
<p>When used within a string, special characters, such as a carriage return or
double quote (<code class="literal">"</code>), must be escaped with a preceding backslash (<code class="literal">\</code>).</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">"example \r of \" escaped \n characters"</pre>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Escape sequence</th>
<th align="left" valign="top">Literal character</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">\n</code></p></td>
<td align="left" valign="top"><p>A newline (linefeed) character</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">\r</code></p></td>
<td align="left" valign="top"><p>A carriage return character</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">\t</code></p></td>
<td align="left" valign="top"><p>A tab character</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">\\</code></p></td>
<td align="left" valign="top"><p>A backslash (<code class="literal">\</code>) character</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">\"</code></p></td>
<td align="left" valign="top"><p>A double quote (<code class="literal">"</code>) character</p></td>
</tr>
</tbody>
</table>
</div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>The single quote (<code class="literal">'</code>) character is reserved for future use. You
cannot use an escaped single quote (<code class="literal">\'</code>) for literal strings. Use an escaped
double quote (<code class="literal">\"</code>) instead.</p>
</div>
</div>
<h3><a id="eql-syntax-raw-strings"></a>Raw strings<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/syntax.asciidoc">edit</a></h3>
<p>Raw strings treat special characters, such as backslashes (<code class="literal">\</code>), as literal
characters. Raw strings are enclosed in three double quotes (<code class="literal">"""</code>).</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">"""Raw string with a literal double quote " and blackslash \ included"""</pre>
</div>
<p>A raw string cannot contain three consecutive double quotes (<code class="literal">"""</code>). Instead,
use a regular string with the <code class="literal">\"</code> escape sequence.</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">"String containing \"\"\" three double quotes"</pre>
</div>
<h3><a id="eql-syntax-wildcards"></a>Wildcards<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/syntax.asciidoc">edit</a></h3>
<p>For string comparisons using the <code class="literal">:</code> operator or <code class="literal">like</code> keyword, you can use the
<code class="literal">*</code> and <code class="literal">?</code> wildcards to match specific patterns. The <code class="literal">*</code> wildcard matches zero
or more characters:</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">my_field : "doc*"     // Matches "doc", "docs", or "document" but not "DOS"
my_field : "*doc"     // Matches "adoc" or "asciidoc"
my_field : "d*c"      // Matches "doc" or "disc"

my_field like "DOC*"  // Matches "DOC", "DOCS", "DOCs", or "DOCUMENT" but not "DOS"
my_field like "D*C"   // Matches "DOC", "DISC", or "DisC"</pre>
</div>
<p>The <code class="literal">?</code> wildcard matches exactly one character:</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">my_field : "doc?"     // Matches "docs" but not "doc", "document", or "DOS"
my_field : "?doc"     // Matches "adoc" but not "asciidoc"
my_field : "d?c"      // Matches "doc" but not "disc"

my_field like "DOC?"  // Matches "DOCS" or "DOCs" but not "DOC", "DOCUMENT", or "DOS"
my_field like "D?c"   // Matches "DOC" but not "DISC"</pre>
</div>
<p>The <code class="literal">:</code> operator and <code class="literal">like</code> keyword also support wildcards in
<a class="xref" href="eql-syntax.html#eql-syntax-lookup-operators" title="Lookup operators">list lookups</a>:</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">my_field : ("doc*", "f*o", "ba?", "qux")
my_field like ("Doc*", "F*O", "BA?", "QUX")</pre>
</div>
<h3><a id="eql-sequences"></a>Sequences<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/syntax.asciidoc">edit</a></h3>
<p>You can use EQL sequences to describe and match an ordered series of events.
Each item in a sequence is an event category and event condition,
surrounded by square brackets (<code class="literal">[ ]</code>). Events are listed in ascending
chronological order, with the most recent event listed last.</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">sequence
  [ event_category_1 where condition_1 ]
  [ event_category_2 where condition_2 ]
  ...</pre>
</div>
<p><span class="strong strong"><strong>Example</strong></span><br>
The following EQL sequence query matches this series of ordered events:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Start with an event with:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
An event category of <code class="literal">file</code>
</li>
<li class="listitem">
A <code class="literal">file.extension</code> of <code class="literal">exe</code>
</li>
</ul>
</div>
</li>
<li class="listitem">
Followed by an event with an event category of <code class="literal">process</code>
</li>
</ol>
</div>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">sequence
  [ file where file.extension == "exe" ]
  [ process where true ]</pre>
</div>
<h3><a id="eql-with-maxspan-keywords"></a><code class="literal">with maxspan</code> keywords<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/syntax.asciidoc">edit</a></h3>
<p>You can use the <code class="literal">with maxspan</code> keywords to constrain a sequence to a specified
timespan. All events in a matching sequence must occur within this duration,
starting at the first event&#8217;s timestamp.</p>
<p>The <code class="literal">maxspan</code> keyword accepts <a class="xref" href="common-options.html#time-units" title="Time units">time value</a> arguments.</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">sequence with maxspan=30s
  [ event_category_1 where condition_1 ] by field_baz
  [ event_category_2 where condition_2 ] by field_bar
  ...</pre>
</div>
<p><span class="strong strong"><strong>Example</strong></span><br>
The following sequence query uses a <code class="literal">maxspan</code> value of <code class="literal">15m</code> (15 minutes).
Events in a matching sequence must occur within 15 minutes of the first event&#8217;s
timestamp.</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">sequence with maxspan=15m
  [ file where file.extension == "exe" ]
  [ process where true ]</pre>
</div>
<h3><a id="eql-by-keyword"></a><code class="literal">by</code> keyword<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/syntax.asciidoc">edit</a></h3>
<p>You can use the <code class="literal">by</code> keyword with sequences to only match events that share the
same field values. If a field value should be shared across all events, you
can use <code class="literal">sequence by</code>.</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">sequence by field_foo
  [ event_category_1 where condition_1 ] by field_baz
  [ event_category_2 where condition_2 ] by field_bar
  ...</pre>
</div>
<p><span class="strong strong"><strong>Example</strong></span><br>
The following sequence query uses the <code class="literal">by</code> keyword to constrain matching events
to:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Events with the same <code class="literal">user.name</code> value
</li>
<li class="listitem">
<code class="literal">file</code> events with a <code class="literal">file.path</code> value equal to the following <code class="literal">process</code>
event&#8217;s <code class="literal">process.path</code> value.
</li>
</ul>
</div>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">sequence
  [ file where file.extension == "exe" ] by user.name, file.path
  [ process where true ] by user.name, process.path</pre>
</div>
<p>Because the <code class="literal">user.name</code> field is shared across all events in the sequence, it
can be included using <code class="literal">sequence by</code>. The following sequence is equivalent to the
prior one.</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">sequence by user.name
  [ file where file.extension == "exe" ] by file.path
  [ process where true ] by process.path</pre>
</div>
<p>You can combine the <code class="literal">sequence by</code> and <code class="literal">with maxspan</code> keywords to constrain a
sequence by both field values and a timespan.</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">sequence by field_foo with maxspan=30s
  [ event_category_1 where condition_1 ] by field_baz
  [ event_category_2 where condition_2 ] by field_bar
  ...</pre>
</div>
<p><span class="strong strong"><strong>Example</strong></span><br>
The following sequence query uses the <code class="literal">sequence by</code> keyword and <code class="literal">with maxspan</code>
keywords to match only a sequence of events that:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Share the same <code class="literal">user.name</code> field values
</li>
<li class="listitem">
Occur within <code class="literal">15m</code> (15 minutes) of the first matching event
</li>
</ul>
</div>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">sequence by user.name with maxspan=15m
  [ file where file.extension == "exe" ] by file.path
  [ process where true ] by process.path</pre>
</div>
<h3><a id="eql-until-keyword"></a><code class="literal">until</code> keyword<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/syntax.asciidoc">edit</a></h3>
<p>You can use the <code class="literal">until</code> keyword to specify an expiration event for a sequence.
If this expiration event occurs <em>between</em> matching events in a sequence, the
sequence expires and is not considered a match. If the expiration event occurs
<em>after</em> matching events in a sequence, the sequence is still considered a
match. The expiration event is not included in the results.</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">sequence
  [ event_category_1 where condition_1 ]
  [ event_category_2 where condition_2 ]
  ...
until [ event_category_3 where condition_3 ]</pre>
</div>
<p><span class="strong strong"><strong>Example</strong></span><br>
A dataset contains the following event sequences, grouped by shared IDs:</p>
<div class="pre_wrapper lang-txt">
<pre class="programlisting prettyprint lang-txt">A, B
A, B, C
A, C, B</pre>
</div>
<p>The following EQL query searches the dataset for sequences containing
event <code class="literal">A</code> followed by event <code class="literal">B</code>. Event <code class="literal">C</code> is used as an expiration event.</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">sequence by ID
  A
  B
until C</pre>
</div>
<p>The query matches sequences <code class="literal">A, B</code> and <code class="literal">A, B, C</code> but not <code class="literal">A, C, B</code>.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>The <code class="literal">until</code> keyword can be useful when searching for process sequences in
Windows event logs.</p>
<p>In Windows, a process ID (PID) is unique only while a process is running. After
a process terminates, its PID can be reused.</p>
<p>You can search for a sequence of events with the same PID value using the <code class="literal">by</code>
and <code class="literal">sequence by</code> keywords.</p>
<p><span class="strong strong"><strong>Example</strong></span><br>
The following EQL query uses the <code class="literal">sequence by</code> keyword to match a
sequence of events that share the same <code class="literal">process.pid</code> value.</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">sequence by process.pid
  [ process where event.type == "start" and process.name == "cmd.exe" ]
  [ process where file.extension == "exe" ]</pre>
</div>
<p>However, due to PID reuse, this can result in a matching sequence that
contains events across unrelated processes. To prevent false positives, you can
use the <code class="literal">until</code> keyword to end matching sequences before a process termination
event.</p>
<p>The following EQL query uses the <code class="literal">until</code> keyword to end sequences before
<code class="literal">process</code> events with an <code class="literal">event.type</code> of <code class="literal">stop</code>. These events indicate a process
has been terminated.</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">sequence by process.pid
  [ process where event.type == "start" and process.name == "cmd.exe" ]
  [ process where file.extension == "exe" ]
until [ process where event.type == "stop" ]</pre>
</div>
</div>
</div>
<h3><a id="eql-functions"></a>Functions<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/syntax.asciidoc">edit</a></h3>
<p>You can use EQL functions to convert data types, perform math, manipulate
strings, and more. For a list of supported functions, see <a class="xref" href="eql-function-ref.html" title="EQL function reference"><em>Function reference</em></a>.</p>
<h3><a id="eql-case-insensitive-functions"></a>Case-insensitive functions<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/syntax.asciidoc">edit</a></h3>
<p>Most EQL functions are case-sensitive by default. To make a function
case-insensitive, use the <code class="literal">~</code> operator after the function name:</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">stringContains(process.name,".exe")  // Matches ".exe" but not ".EXE" or ".Exe"
stringContains~(process.name,".exe") // Matches ".exe", ".EXE", or ".Exe"</pre>
</div>
<h3><a id="eql-how-functions-impact-search-performance"></a>How functions impact search performance<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/syntax.asciidoc">edit</a></h3>
<p>Using functions in EQL queries can result in slower search speeds. If you
often use functions to transform indexed data, you can speed up search by making
these changes during indexing instead. However, that often means slower index
speeds.</p>
<p><span class="strong strong"><strong>Example</strong></span><br>
An index contains the <code class="literal">file.path</code> field. <code class="literal">file.path</code> contains the full path to a
file, including the file extension.</p>
<p>When running EQL searches, users often use the <code class="literal">endsWith</code> function with the
<code class="literal">file.path</code> field to match file extensions:</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">file where endsWith(file.path,".exe") or endsWith(file.path,".dll")</pre>
</div>
<p>While this works, it can be repetitive to write and can slow search speeds. To
speed up search, you can do the following instead:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<a class="xref" href="indices-put-mapping.html" title="Put mapping API">Add a new field</a>, <code class="literal">file.extension</code>, to the index. The
<code class="literal">file.extension</code> field will contain only the file extension from the
<code class="literal">file.path</code> field.
</li>
<li class="listitem">
Use an <a class="xref" href="ingest.html" title="Ingest node">ingest pipeline</a> containing the <a class="xref" href="grok-processor.html" title="Grok processor"><code class="literal">grok</code></a>
processor or another preprocessor tool to extract the file extension from the
<code class="literal">file.path</code> field before indexing.
</li>
<li class="listitem">
Index the extracted file extension to the <code class="literal">file.extension</code> field.
</li>
</ol>
</div>
<p>These changes may slow indexing but allow for faster searches. Users
can use the <code class="literal">file.extension</code> field instead of multiple <code class="literal">endsWith</code> function
calls:</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">file where file.extension in ("exe", "dll")</pre>
</div>
<p>We recommend testing and benchmarking any indexing changes before deploying them
in production. See <a class="xref" href="tune-for-indexing-speed.html" title="Tune for indexing speed"><em>Tune for indexing speed</em></a> and <a class="xref" href="tune-for-search-speed.html" title="Tune for search speed"><em>Tune for search speed</em></a>.</p>
<h3><a id="eql-pipes"></a>Pipes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/syntax.asciidoc">edit</a></h3>
<p>EQL pipes filter, aggregate, and post-process events returned by
an EQL query. You can use pipes to narrow down EQL query results or make them
more specific.</p>
<p>Pipes are delimited using the pipe (<code class="literal">|</code>) character.</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">event_category where condition | pipe</pre>
</div>
<p><span class="strong strong"><strong>Example</strong></span><br>
The following EQL query uses the <code class="literal">tail</code> pipe to return only the 10 most recent
events matching the query.</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">authentication where agent.id == 4624
| tail 10</pre>
</div>
<p>You can pass the output of a pipe to another pipe. This lets you use multiple
pipes with a single query.</p>
<p>For a list of supported pipes, see <a class="xref" href="eql-pipe-ref.html" title="EQL pipe reference"><em>Pipe reference</em></a>.</p>
<h3><a id="eql-syntax-limitations"></a>Limitations<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/syntax.asciidoc">edit</a></h3>
<p>EQL does not support the following features and syntax.</p>
<h4><a id="eql-compare-fields"></a>Comparing fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/syntax.asciidoc">edit</a></h4>
<p>You cannot use EQL comparison operators to compare a field to
another field. This applies even if the fields are changed using a
<a class="xref" href="eql-syntax.html#eql-functions" title="Functions">function</a>.</p>
<h4><a id="eql-text-fields"></a>Text fields are not supported<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/syntax.asciidoc">edit</a></h4>
<p>EQL searches do not support <a class="xref" href="text.html" title="Text field type"><code class="literal">text</code></a> fields. To a search a <code class="literal">text</code> field,
use the EQL search API&#8217;s <a class="xref" href="eql.html#eql-search-filter-query-dsl" title="Filter using Query DSL">Query DSL <code class="literal">filter</code></a>
parameter.</p>
<h4><a id="eql-array-fields"></a>Array field values are not supported<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/syntax.asciidoc">edit</a></h4>
<p>EQL does not support <a class="xref" href="array.html" title="Arrays">array</a> field values, also known as
<em>multi-value fields</em>. EQL searches on array field values may return inconsistent
results.</p>
<h4><a id="eql-nested-fields"></a>EQL search on nested fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/syntax.asciidoc">edit</a></h4>
<p>You cannot use EQL to search the values of a <a class="xref" href="nested.html" title="Nested field type"><code class="literal">nested</code></a> field or the
sub-fields of a <code class="literal">nested</code> field. However, data streams and indices containing
<code class="literal">nested</code> field mappings are otherwise supported.</p>
<h4><a id="eql-unsupported-syntax"></a>Differences from Endgame EQL syntax<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/syntax.asciidoc">edit</a></h4>
<p>Elasticsearch EQL differs from the <a href="https://eql.readthedocs.io/en/latest/query-guide/index.html" class="ulink" target="_top">Elastic Endgame EQL syntax</a> as
follows:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
In Elasticsearch EQL, most operators are case-sensitive. For example,
<code class="literal">process_name == "cmd.exe"</code> is not equivalent to
<code class="literal">process_name == "Cmd.exe"</code>.
</li>
<li class="listitem">
In Elasticsearch EQL, functions are case-sensitive. To make a function
case-insensitive, use <code class="literal">~</code>, such as <code class="literal">endsWith~(process_name, ".exe")</code>.
</li>
<li class="listitem">
For case-insensitive equality comparisons, use the <code class="literal">:</code> operator. Both <code class="literal">*</code> and
<code class="literal">?</code> are recognized wildcard characters.
</li>
<li class="listitem">
The <code class="literal">==</code> and <code class="literal">!=</code> operators do not expand wildcard characters. For example,
<code class="literal">process_name == "cmd*.exe"</code> interprets <code class="literal">*</code> as a literal asterisk, not a
wildcard.
</li>
<li class="listitem">
For wildcard matching, use the <code class="literal">like</code> keyword when case-sensitive and
<code class="literal">like~</code> when case-insensitive. The <code class="literal">:</code> operator is equivalent to <code class="literal">like~</code>.
</li>
<li class="listitem">
For regular expression matching, use <code class="literal">regex</code> or <code class="literal">regex~</code>.
</li>
<li class="listitem">
<code class="literal">=</code> cannot be substituted for the <code class="literal">==</code> operator.
</li>
<li class="listitem">
Strings enclosed in single quotes (<code class="literal">'</code>) are not supported. Enclose strings in
double quotes (<code class="literal">"</code>) instead.
</li>
<li class="listitem">
<code class="literal">?"</code> and <code class="literal">?'</code> do not indicate raw strings. Enclose raw strings in
three double quotes (<code class="literal">"""</code>) instead.
</li>
<li class="listitem">
<p>Elasticsearch EQL does not support:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Array functions:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://eql.readthedocs.io/en/latest/query-guide/functions.html#arrayContains" class="ulink" target="_top"><code class="literal">arrayContains</code></a>
</li>
<li class="listitem">
<a href="https://eql.readthedocs.io/en/latest/query-guide/functions.html#arrayCount" class="ulink" target="_top"><code class="literal">arrayCount</code></a>
</li>
<li class="listitem">
<a href="https://eql.readthedocs.io/en/latest/query-guide/functions.html#arraySearch" class="ulink" target="_top"><code class="literal">arraySearch</code></a>
</li>
</ul>
</div>
</li>
<li class="listitem">
The <a href="https://eql.readthedocs.io/en/latest/query-guide//functions.html#match" class="ulink" target="_top"><code class="literal">match</code></a> function
</li>
<li class="listitem">
<a href="https://eql.readthedocs.io/en/latest/query-guide/joins.html" class="ulink" target="_top">Joins</a>
</li>
<li class="listitem">
<p><a href="https://eql.readthedocs.io/en/latest/query-guide/basic-syntax.html#event-relationships" class="ulink" target="_top">Lineage-related keywords</a>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">child of</code>
</li>
<li class="listitem">
<code class="literal">descendant of</code>
</li>
<li class="listitem">
<code class="literal">event of</code>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>The following <a href="https://eql.readthedocs.io/en/latest/query-guide/pipes.html" class="ulink" target="_top">pipes</a>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://eql.readthedocs.io/en/latest/query-guide/pipes.html#count" class="ulink" target="_top"><code class="literal">count</code></a>
</li>
<li class="listitem">
<a href="https://eql.readthedocs.io/en/latest/query-guide/pipes.html#filter" class="ulink" target="_top"><code class="literal">filter</code></a>
</li>
<li class="listitem">
<a href="https://eql.readthedocs.io/en/latest/query-guide/pipes.html#sort" class="ulink" target="_top"><code class="literal">sort</code></a>
</li>
<li class="listitem">
<a href="https://eql.readthedocs.io/en/latest/query-guide/pipes.html#unique" class="ulink" target="_top"><code class="literal">unique</code></a>
</li>
<li class="listitem">
<a href="https://eql.readthedocs.io/en/latest/query-guide/pipes.html#unique-count" class="ulink" target="_top"><code class="literal">unique_count</code></a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</li>
</ul>
</div>
<h4><a id="eql-how-sequence-queries-handle-matches"></a>How sequence queries handle matches<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/syntax.asciidoc">edit</a></h4>
<p><a class="xref" href="eql-syntax.html#eql-sequences" title="Sequences">Sequence queries</a> don&#8217;t find all potential matches for a
sequence. This approach would be too slow and costly for large event data sets.
Instead, a sequence query handles pending sequence matches as a
<a href="https://en.wikipedia.org/wiki/Finite-state_machine" class="ulink" target="_top">state machine</a>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Each event item in the sequence query is a state in the machine.
</li>
<li class="listitem">
Only one pending sequence can be in each state at a time.
</li>
<li class="listitem">
If two pending sequences are in the same state at the same time, the most
recent sequence overwrites the older one.
</li>
<li class="listitem">
If the query includes <a class="xref" href="eql-syntax.html#eql-by-keyword" title="by keyword"><code class="literal">by</code> fields</a>, the query uses a
separate state machine for each unique <code class="literal">by</code> field value.
</li>
</ul>
</div>
<details>
<summary class="title"><span class="strong strong"><strong>Example</strong></span></summary>
<div class="content">
<p>A data set contains the following <code class="literal">process</code> events in ascending chronological
order:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{ "index" : { "_id": "1" } }
{ "user": { "name": "root" }, "process": { "name": "attrib" }, ...}
{ "index" : { "_id": "2" } }
{ "user": { "name": "root" }, "process": { "name": "attrib" }, ...}
{ "index" : { "_id": "3" } }
{ "user": { "name": "elkbee" }, "process": { "name": "bash" }, ...}
{ "index" : { "_id": "4" } }
{ "user": { "name": "root" }, "process": { "name": "bash" }, ...}
{ "index" : { "_id": "5" } }
{ "user": { "name": "root" }, "process": { "name": "bash" }, ...}
{ "index" : { "_id": "6" } }
{ "user": { "name": "elkbee" }, "process": { "name": "attrib" }, ...}
{ "index" : { "_id": "7" } }
{ "user": { "name": "root" }, "process": { "name": "attrib" }, ...}
{ "index" : { "_id": "8" } }
{ "user": { "name": "elkbee" }, "process": { "name": "bash" }, ...}
{ "index" : { "_id": "9" } }
{ "user": { "name": "root" }, "process": { "name": "cat" }, ...}
{ "index" : { "_id": "10" } }
{ "user": { "name": "elkbee" }, "process": { "name": "cat" }, ...}
{ "index" : { "_id": "11" } }
{ "user": { "name": "root" }, "process": { "name": "cat" }, ...}</pre>
</div>
<p>An EQL sequence query searches the data set:</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">sequence by user.name
  [process where process.name == "attrib"]
  [process where process.name == "bash"]
  [process where process.name == "cat"]</pre>
</div>
<p>The query&#8217;s event items correspond to the following states:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
State A:  <code class="literal">[process where process.name == "attrib"]</code>
</li>
<li class="listitem">
State B:  <code class="literal">[process where process.name == "bash"]</code>
</li>
<li class="listitem">
Complete: <code class="literal">[process where process.name == "cat"]</code>
</li>
</ul>
</div>
<div class="imageblock text-center">
<div class="content">
<img src="images/eql/sequence-state-machine.svg" alt="sequence state machine">
</div>
</div>
<p>To find matching sequences, the query uses separate state machines for each
unique <code class="literal">user.name</code> value. Based on the data set, you can expect two state
machines: one for the <code class="literal">root</code> user and one for <code class="literal">elkbee</code>.</p>
<div class="imageblock text-center">
<div class="content">
<img src="images/eql/separate-state-machines.svg" alt="separate state machines">
</div>
</div>
<p>Pending sequence matches move through each machine&#8217;s states as follows:</p>
<div class="pre_wrapper lang-txt">
<pre class="programlisting prettyprint lang-txt">{ "index" : { "_id": "1" } }
{ "user": { "name": "root" }, "process": { "name": "attrib" }, ...}
// Creates sequence [1] in state A for the "root" user.
//
// +------------------------"root"------------------------+
// |  +-----------+     +-----------+     +------------+  |
// |  |  State A  |     |  State B  |     |  Complete  |  |
// |  +-----------+     +-----------+     +------------+  |
// |  |    [1]    |     |           |     |            |  |
// |  +-----------+     +-----------+     +------------+  |
// +------------------------------------------------------+

{ "index" : { "_id": "2" } }
{ "user": { "name": "root" }, "process": { "name": "attrib" }, ...}
// Creates sequence [2] in state A for "root", overwriting sequence [1].
//
// +------------------------"root"------------------------+
// |  +-----------+     +-----------+     +------------+  |
// |  |  State A  |     |  State B  |     |  Complete  |  |
// |  +-----------+     +-----------+     +------------+  |
// |  |    [2]    |     |           |     |            |  |
// |  +-----------+     +-----------+     +------------+  |
// +------------------------------------------------------+

{ "index" : { "_id": "3" } }
{ "user": { "name": "elkbee" }, "process": { "name": "bash" }, ...}
// Nothing happens. The "elkbee" user has no pending sequence to move
// from state A to state B.
//
// +-----------------------"elkbee"-----------------------+
// |  +-----------+     +-----------+     +------------+  |
// |  |  State A  |     |  State B  |     |  Complete  |  |
// |  +-----------+     +-----------+     +------------+  |
// |  |           |     |           |     |            |  |
// |  +-----------+     +-----------+     +------------+  |
// +------------------------------------------------------+

{ "index" : { "_id": "4" } }
{ "user": { "name": "root" }, "process": { "name": "bash" }, ...}
// Sequence [2] moves out of state A for "root".
// State B for "root" now contains [2, 4].
// State A for "root" is empty.
//
// +------------------------"root"------------------------+
// |  +-----------+     +-----------+     +------------+  |
// |  |  State A  |     |  State B  |     |  Complete  |  |
// |  +-----------+ --&gt; +-----------+     +------------+  |
// |  |           |     |   [2, 4]  |     |            |  |
// |  +-----------+     +-----------+     +------------+  |
// +------------------------------------------------------+

{ "index" : { "_id": "5" } }
{ "user": { "name": "root" }, "process": { "name": "bash" }, ...}
// Nothing happens. State A is empty for "root".
//
// +------------------------"root"------------------------+
// |  +-----------+     +-----------+     +------------+  |
// |  |  State A  |     |  State B  |     |  Complete  |  |
// |  +-----------+     +-----------+     +------------+  |
// |  |           |     |   [2, 4]  |     |            |  |
// |  +-----------+     +-----------+     +------------+  |
// +------------------------------------------------------+

{ "index" : { "_id": "6" } }
{ "user": { "name": "elkbee" }, "process": { "name": "attrib" }, ...}
// Creates sequence [6] in state A for "elkbee".
//
// +-----------------------"elkbee"-----------------------+
// |  +-----------+     +-----------+     +------------+  |
// |  |  State A  |     |  State B  |     |  Complete  |  |
// |  +-----------+     +-----------+     +------------+  |
// |  |    [6]    |     |           |     |            |  |
// |  +-----------+     +-----------+     +------------+  |
// +------------------------------------------------------+

{ "index" : { "_id": "7" } }
{ "user": { "name": "root" }, "process": { "name": "attrib" }, ...}
// Creates sequence [7] in state A for "root".
// Sequence [2, 4] remains in state B for "root".
//
// +------------------------"root"------------------------+
// |  +-----------+     +-----------+     +------------+  |
// |  |  State A  |     |  State B  |     |  Complete  |  |
// |  +-----------+     +-----------+     +------------+  |
// |  |    [7]    |     |   [2, 4]  |     |            |  |
// |  +-----------+     +-----------+     +------------+  |
// +------------------------------------------------------+

{ "index" : { "_id": "8" } }
{ "user": { "name": "elkbee" }, "process": { "name": "bash" }, ...}
// Sequence [6, 8] moves to state B for "elkbee".
// State A for "elkbee" is now empty.
//
// +-----------------------"elkbee"-----------------------+
// |  +-----------+     +-----------+     +------------+  |
// |  |  State A  |     |  State B  |     |  Complete  |  |
// |  +-----------+ --&gt; +-----------+     +------------+  |
// |  |           |     |   [6, 8]  |     |            |  |
// |  +-----------+     +-----------+     +------------+  |
// +------------------------------------------------------+

{ "index" : { "_id": "9" } }
{ "user": { "name": "root" }, "process": { "name": "cat" }, ...}
// Sequence [2, 4, 9] is complete for "root".
// State B for "root" is now empty.
// Sequence [7] remains in state A.
//
// +------------------------"root"------------------------+
// |  +-----------+     +-----------+     +------------+  |
// |  |  State A  |     |  State B  |     |  Complete  |  |
// |  +-----------+     +-----------+ --&gt; +------------+  |
// |  |    [7]    |     |           |     |  [2, 4, 9] |
// |  +-----------+     +-----------+     +------------+  |
// +------------------------------------------------------+

{ "index" : { "_id": "10" } }
{ "user": { "name": "elkbee" }, "process": { "name": "cat" }, ...}
// Sequence [6, 8, 10] is complete for "elkbee".
// State A and B for "elkbee" are now empty.
//
// +-----------------------"elkbee"-----------------------+
// |  +-----------+     +-----------+     +------------+  |
// |  |  State A  |     |  State B  |     |  Complete  |  |
// |  +-----------+     +-----------+ --&gt; +------------+  |
// |  |           |     |           |     | [6, 8, 10] |
// |  +-----------+     +-----------+     +------------+  |
// +------------------------------------------------------+

{ "index" : { "_id": "11" } }
{ "user": { "name": "root" }, "process": { "name": "cat" }, ...}
// Nothing happens.
// The machines for "root" and "elkbee" remain the same.
//
// +------------------------"root"------------------------+
// |  +-----------+     +-----------+     +------------+  |
// |  |  State A  |     |  State B  |     |  Complete  |  |
// |  +-----------+     +-----------+     +------------+  |
// |  |    [7]    |     |           |     |  [2, 4, 9] |
// |  +-----------+     +-----------+     +------------+  |
// +------------------------------------------------------+
//
// +-----------------------"elkbee"-----------------------+
// |  +-----------+     +-----------+     +------------+  |
// |  |  State A  |     |  State B  |     |  Complete  |  |
// |  +-----------+     +-----------+     +------------+  |
// |  |           |     |           |     | [6, 8, 10] |
// |  +-----------+     +-----------+     +------------+  |
// +------------------------------------------------------+</pre>
</div>
</div>
</details>
</div>
<div class="navfooter">
<span class="prev">
<a href="eql.html">« EQL search</a>
</span>
<span class="next">
<a href="eql-function-ref.html">EQL function reference »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>
                <div class="col-xs-12 col-sm-4 col-md-4" id="right_col">
                  <div id="rtpcontainer" style="display: block;">
                    <div class="mktg-promo">
                      <h3>Most Popular</h3>
                      <ul class="icons">
                        <li class="icon-elasticsearch-white"><a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">Get Started with Elasticsearch: Video</a></li>
                        <li class="icon-kibana-white"><a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">Intro to Kibana: Video</a></li>
                        <li class="icon-logstash-white"><a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">ELK for Logs & Metrics: Video</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";
	var localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}';
</script>
<script src="/static/js/swiftype_app_search.umd.min.js"></script>
<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
