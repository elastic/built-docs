<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Searchable snapshot | Elasticsearch Guide [8.1] | Elastic</title>
<link rel="home" href="index.html" title="Elasticsearch Guide [8.1]"/>
<link rel="up" href="ilm-actions.html" title="Index lifecycle actions"/>
<link rel="prev" href="ilm-rollover.html" title="Rollover"/>
<link rel="next" href="ilm-set-priority.html" title="Set priority"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/8.1"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="8.1"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <!--© 2015-2022 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!--BEGIN QUALTRICS WEBSITE FEEDBACK SNIPPET-->
    <script type='text/javascript'>
      (function(){var g=function(e,h,f,g){
      this.get=function(a){for(var a=a+"=",c=document.cookie.split(";"),b=0,e=c.length;b<e;b++){for(var d=c[b];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return null};
      this.set=function(a,c){var b="",b=new Date;b.setTime(b.getTime()+6048E5);b="; expires="+b.toGMTString();document.cookie=a+"="+c+b+"; path=/; "};
      this.check=function(){var a=this.get(f);if(a)a=a.split(":");else if(100!=e)"v"==h&&(e=Math.random()>=e/100?0:100),a=[h,e,0],this.set(f,a.join(":"));else return!0;var c=a[1];if(100==c)return!0;switch(a[0]){case "v":return!1;case "r":return c=a[2]%Math.floor(100/c),a[2]++,this.set(f,a.join(":")),!c}return!0};
      this.go=function(){if(this.check()){var a=document.createElement("script");a.type="text/javascript";a.src=g;document.body&&document.body.appendChild(a)}};
      this.start=function(){var a=this;window.addEventListener?window.addEventListener("load",function(){a.go()},!1):window.attachEvent&&window.attachEvent("onload",function(){a.go()})}};
      try{(new g(100,"r","QSI_S_ZN_emkP0oSe9Qrn7kF","https://znemkp0ose9qrn7kf-elastic.siteintercept.qualtrics.com/WRSiteInterceptEngine/?Q_ZID=ZN_emkP0oSe9Qrn7kF")).start()}catch(i){}})();
    </script><div id='ZN_emkP0oSe9Qrn7kF'><!--DO NOT REMOVE-CONTENTS PLACED HERE--></div>
    <!--END WEBSITE FEEDBACK SNIPPET-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  <div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="index.html">Elasticsearch Guide [8.1]</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="index-lifecycle-management.html">ILM: Manage the index lifecycle</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="ilm-actions.html">Index lifecycle actions</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="ilm-rollover.html">« Rollover</a>
</span>
<span class="next">
<a href="ilm-set-priority.html">Set priority »</a>
</span>
</div>
<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="ilm-searchable-snapshot"></a>Searchable snapshot<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.1/docs/reference/ilm/actions/ilm-searchable-snapshot.asciidoc">edit</a></h2>
</div></div></div>
<p>Phases allowed: hot, cold, frozen.</p>
<p>Takes a snapshot of the managed index in the configured repository and mounts it
as a <a class="xref" href="searchable-snapshots.html" title="Searchable snapshots">searchable snapshot</a>. If the index is part of a
<a class="xref" href="data-streams.html" title="Data streams">data stream</a>, the mounted index replaces the original index in
the stream.</p>
<p>The <code class="literal">searchable_snapshot</code> action requires <a class="xref" href="data-tiers.html" title="Data tiers">data tiers</a>. The action
uses the
<a class="xref" href="data-tier-shard-filtering.html#tier-preference-allocation-filter"><code class="literal">index.routing.allocation.include._tier_preference</code></a>
setting to mount the index directly to the phase&#8217;s corresponding data tier. In
the frozen phase, the action mounts a <a class="xref" href="searchable-snapshots.html#partially-mounted">partially mounted
index</a> prefixed with <code class="literal">partial-</code> to the frozen tier. In other phases, the action mounts a
<a class="xref" href="searchable-snapshots.html#fully-mounted">fully mounted index</a> prefixed with <code class="literal">restored-</code> to the corresponding data tier.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>Don&#8217;t include the <code class="literal">searchable_snapshot</code> action in both the hot and cold
phases. This can result in indices failing to automatically migrate to the cold
tier during the cold phase.</p>
</div>
</div>
<p>If the <code class="literal">searchable_snapshot</code> action is used in the hot phase the subsequent
phases cannot include the <code class="literal">shrink</code> or <code class="literal">forcemerge</code> actions.</p>
<p>This action cannot be performed on a data stream&#8217;s write index. Attempts to do
so will fail. To convert the index to a searchable snapshot, first
<a class="xref" href="use-a-data-stream.html#manually-roll-over-a-data-stream" title="Manually roll over a data stream">manually roll over</a> the data stream. This
creates a new write index. Because the index is no longer the stream&#8217;s write
index, the action can then convert it to a searchable snapshot.
Using a policy that makes use of the <a class="xref" href="ilm-rollover.html" title="Rollover">rollover</a> action
in the hot phase will avoid this situation and the need for a manual rollover for future
managed indices.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Mounting and relocating the shards of searchable snapshot indices involves
copying the shard contents from the snapshot repository. This may incur
different costs from the copying between nodes that happens with regular
indices. These costs are typically lower but, in some environments, may be
higher. See <a class="xref" href="searchable-snapshots.html#searchable-snapshots-costs" title="Reduce costs with searchable snapshots">Reduce costs with searchable snapshots</a> for more details.</p>
</div>
</div>
<p>By default, this snapshot is deleted by the <a class="xref" href="ilm-delete.html" title="Delete">delete action</a> in the delete phase.
To keep the snapshot, set <code class="literal">delete_searchable_snapshot</code> to <code class="literal">false</code> in the delete action.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ilm-searchable-snapshot-options"></a>Options<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.1/docs/reference/ilm/actions/ilm-searchable-snapshot.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">snapshot_repository</code>
</span>
</dt>
<dd>
(Required, string)
<a class="xref" href="snapshots-register-repository.html" title="Register a snapshot repository">Repository</a> used to store the snapshot.
</dd>
<dt>
<span class="term">
<code class="literal">force_merge_index</code>
</span>
</dt>
<dd>
(Optional, Boolean)
Force merges the managed index to one segment.
Defaults to <code class="literal">true</code>.
If the managed index was already force merged using the
<a class="xref" href="ilm-forcemerge.html" title="Force merge">force merge action</a> in a previous action
the <code class="literal">searchable snapshot</code> action force merge step will be a no-op.
</dd>
</dl>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The <code class="literal">forcemerge</code> action is best effort. It might happen that some of
the shards are relocating, in which case they will not be merged.
The <code class="literal">searchable_snapshot</code> action will continue executing even if not all shards
are force merged.</p>
</div>
</div>
<p>This force merging occurs in the phase that the index is in <span class="strong strong"><strong>prior</strong></span> to the <code class="literal">searchable_snapshot</code>
action. For example, if using a <code class="literal">searchable_snapshot</code> action in the <code class="literal">hot</code> phase, the force merge
will be performed on the hot nodes. If using a <code class="literal">searchable_snapshot</code> action in the <code class="literal">cold</code> phase, the
force merge will be performed on whatever tier the index is <span class="strong strong"><strong>prior</strong></span> to the <code class="literal">cold</code> phase (either
<code class="literal">hot</code> or <code class="literal">warm</code>).</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ilm-searchable-snapshot-ex"></a>Examples<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.1/docs/reference/ilm/actions/ilm-searchable-snapshot.asciidoc">edit</a></h3>
</div></div></div>
<a id="3f2e5132e35b9e8b3203a4a0541cf0d4"></a>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT _ilm/policy/my_policy
{
  "policy": {
    "phases": {
      "cold": {
        "actions": {
          "searchable_snapshot" : {
            "snapshot_repository" : "backing_repo"
          }
        }
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/1471.console"></div>
</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="ilm-rollover.html">« Rollover</a>
</span>
<span class="next">
<a href="ilm-set-priority.html">Set priority »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {"alternatives":{"console":{"php":{"hasAny":true},"csharp":{"hasAny":true},"python":{"hasAny":true},"ruby":{"hasAny":true},"go":{"hasAny":true},"js":{"hasAny":true}}}}</script>
  </body>
</html>
