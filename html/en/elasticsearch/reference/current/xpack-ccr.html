<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Cross-cluster replication | Elasticsearch Reference [7.9] | Elastic</title>
<link rel="home" href="index.html" title="Elasticsearch Reference [7.9]"/>
<link rel="up" href="high-availability.html" title="Set up a cluster for high availability"/>
<link rel="prev" href="restore-cluster-data.html" title="Restore a cluster&#8217;s data"/>
<link rel="next" href="ccr-getting-started.html" title="Tutorial: Set up cross-cluster replication"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/7.9"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="7.9"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!--BEGIN QUALTRICS WEBSITE FEEDBACK SNIPPET-->
    <script type='text/javascript'>
      (function(){var g=function(e,h,f,g){
      this.get=function(a){for(var a=a+"=",c=document.cookie.split(";"),b=0,e=c.length;b<e;b++){for(var d=c[b];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return null};
      this.set=function(a,c){var b="",b=new Date;b.setTime(b.getTime()+6048E5);b="; expires="+b.toGMTString();document.cookie=a+"="+c+b+"; path=/; "};
      this.check=function(){var a=this.get(f);if(a)a=a.split(":");else if(100!=e)"v"==h&&(e=Math.random()>=e/100?0:100),a=[h,e,0],this.set(f,a.join(":"));else return!0;var c=a[1];if(100==c)return!0;switch(a[0]){case "v":return!1;case "r":return c=a[2]%Math.floor(100/c),a[2]++,this.set(f,a.join(":")),!c}return!0};
      this.go=function(){if(this.check()){var a=document.createElement("script");a.type="text/javascript";a.src=g;document.body&&document.body.appendChild(a)}};
      this.start=function(){var a=this;window.addEventListener?window.addEventListener("load",function(){a.go()},!1):window.attachEvent&&window.attachEvent("onload",function(){a.go()})}};
      try{(new g(100,"r","QSI_S_ZN_emkP0oSe9Qrn7kF","https://znemkp0ose9qrn7kf-elastic.siteintercept.qualtrics.com/WRSiteInterceptEngine/?Q_ZID=ZN_emkP0oSe9Qrn7kF")).start()}catch(i){}})();
    </script><div id='ZN_emkP0oSe9Qrn7kF'><!--DO NOT REMOVE-CONTENTS PLACED HERE--></div>
    <!--END WEBSITE FEEDBACK SNIPPET-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <!-- Subnav -->
    <div>
      <div>
        <div class="tertiary-nav d-none d-md-block">
          <div class="container">
            <div class="p-t-b-15 d-flex justify-content-between nav-container">
              <div class="breadcrum-wrapper"><span><a href="/guide/" style="font-size: 14px; font-weight: 600; color: #000;">Docs</a></span></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container">
              <div class="row">
                <div class="col-xs-12 col-sm-8 col-md-8 guide-section">
                  <!-- start body -->
                  
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Elasticsearch Reference [7.9]</a></span>
»
<span class="breadcrumb-link"><a href="high-availability.html">Set up a cluster for high availability</a></span>
»
<span class="breadcrumb-node">Cross-cluster replication</span>
</div>
<div class="navheader">
<span class="prev">
<a href="restore-cluster-data.html">« Restore a cluster&#8217;s data</a>
</span>
<span class="next">
<a href="ccr-getting-started.html">Tutorial: Set up cross-cluster replication »</a>
</span>
</div>
<div class="chapter xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="xpack-ccr"></a>Cross-cluster replication<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.9/docs/reference/ccr/index.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>
<p>With cross-cluster replication, you can replicate indices across clusters to:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Continue handling search requests in the event of a datacenter outage
</li>
<li class="listitem">
Prevent search volume from impacting indexing throughput
</li>
<li class="listitem">
Reduce search latency by processing search requests in geo-proximity to the
user
</li>
</ul>
</div>
<p>Cross-cluster replication uses an active-passive model. You index to a <em>leader</em> index, and the
data is replicated to one or more read-only <em>follower</em> indices. Before you can add a follower index to a cluster, you must configure the <em>remote cluster</em> that contains the leader index.</p>
<p>When the leader index receives writes, the follower indices pull changes from
the leader index on the remote cluster. You can manually create follower
indices, or configure auto-follow patterns to automatically create follower
indices for new time series indices.</p>
<p>You configure cross-cluster replication clusters in a uni-directional or bi-directional setup:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
In a uni-directional configuration, one cluster contains only
leader indices, and the other cluster contains only follower indices.
</li>
<li class="listitem">
In a bi-directional configuration, each cluster contains both leader and
follower indices.
</li>
</ul>
</div>
<p>In a uni-directional configuration, the cluster containing follower indices
must be running <span class="strong strong"><strong>the same or newer</strong></span> version of Elasticsearch as the remote cluster.
If newer, the versions must also be compatible as outlined in the following matrix.</p>
<details id="ccr-version-compatibility">
<summary class="title">Version compatibility matrix</summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
<col class="col_5"/>
<col class="col_6"/>
<col class="col_7"/>
<col class="col_8"/>
</colgroup>
<tbody>
<tr>
<td align="center" valign="top"><p></p></td>
<td align="center" colspan="7" valign="top"><p><span class="strong strong"><strong>Local cluster</strong></span></p></td>
</tr>
<tr>
<td align="center" valign="top"><p><span class="strong strong"><strong>Remote cluster</strong></span></p></td>
<td align="center" valign="top"><p>5.0&#8594;5.5</p></td>
<td align="center" valign="top"><p>5.6</p></td>
<td align="center" valign="top"><p>6.0&#8594;6.6</p></td>
<td align="center" valign="top"><p>6.7</p></td>
<td align="center" valign="top"><p>6.8</p></td>
<td align="center" valign="top"><p>7.0</p></td>
<td align="center" valign="top"><p>7.1&#8594;7.x</p></td>
</tr>
<tr>
<td align="center" valign="top"><p>5.0&#8594;5.5</p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
</tr>
<tr>
<td align="center" valign="top"><p>5.6</p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
</tr>
<tr>
<td align="center" valign="top"><p>6.0&#8594;6.6</p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
</tr>
<tr>
<td align="center" valign="top"><p>6.7</p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
</tr>
<tr>
<td align="center" valign="top"><p>6.8</p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
</tr>
<tr>
<td align="center" valign="top"><p>7.0</p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
</tr>
<tr>
<td align="center" valign="top"><p>7.1&#8594;7.x</p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
<h3><a id="ccr-multi-cluster-architectures"></a>Multi-cluster architectures<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.9/docs/reference/ccr/index.asciidoc">edit</a></h3>
<p>Use cross-cluster replication to construct several multi-cluster architectures within the Elastic
Stack:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="xpack-ccr.html#ccr-disaster-recovery" title="Disaster recovery and high availability">Disaster recovery</a> in case a primary cluster fails,
with a secondary cluster serving as a hot backup
</li>
<li class="listitem">
<a class="xref" href="xpack-ccr.html#ccr-data-locality" title="Data locality">Data locality</a> to maintain multiple copies of the
dataset close to the application servers (and users), and reduce costly latency
</li>
<li class="listitem">
<a class="xref" href="xpack-ccr.html#ccr-centralized-reporting" title="Centralized reporting">Centralized reporting</a> for minimizing network
traffic and latency in querying multiple geo-distributed Elasticsearch clusters, or for
preventing search load from interfering with indexing by offloading search to a
secondary cluster
</li>
</ul>
</div>
<p>Watch the
<a href="/webinars/replicate-elasticsearch-data-with-cross-cluster-replication-ccr" class="ulink" target="_top">cross-cluster replication webinar</a> to learn more about the following use cases.
Then, <a class="xref" href="ccr-getting-started.html" title="Tutorial: Set up cross-cluster replication">set up cross-cluster replication</a> on your local machine and work
through the demo from the webinar.</p>
<h4><a id="ccr-disaster-recovery"></a>Disaster recovery and high availability<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.9/docs/reference/ccr/index.asciidoc">edit</a></h4>
<p>Disaster recovery provides your mission-critical applications with the
tolerance to withstand datacenter or region outages. This use case is the
most common deployment of cross-cluster replication. You can configure clusters in different
architectures to support disaster recovery and high availability:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="xpack-ccr.html#ccr-single-datacenter-recovery" title="Single disaster recovery datacenter">Single disaster recovery datacenter</a>
</li>
<li class="listitem">
<a class="xref" href="xpack-ccr.html#ccr-multiple-datacenter-recovery" title="Multiple disaster recovery datacenters">Multiple disaster recovery datacenters</a>
</li>
<li class="listitem">
<a class="xref" href="xpack-ccr.html#ccr-chained-replication" title="Chained replication">Chained replication</a>
</li>
<li class="listitem">
<a class="xref" href="xpack-ccr.html#ccr-bi-directional-replication" title="Bi-directional replication">Bi-directional replication</a>
</li>
</ul>
</div>
<h5><a id="ccr-single-datacenter-recovery"></a>Single disaster recovery datacenter<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.9/docs/reference/ccr/index.asciidoc">edit</a></h5>
<p>In this configuration, data is replicated from the production datacenter to the
disaster recovery datacenter. Because the follower indices replicate the leader
index, your application can use the disaster recovery datacenter if the
production datacenter is unavailable.</p>
<div class="imageblock">
<div class="content">
<img src="images/ccr-arch-disaster-recovery.png" alt="Production datacenter that replicates data to a disaster recovery datacenter">
</div>
</div>
<h5><a id="ccr-multiple-datacenter-recovery"></a>Multiple disaster recovery datacenters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.9/docs/reference/ccr/index.asciidoc">edit</a></h5>
<p>You can replicate data from one datacenter to multiple datacenters. This
configuration provides both disaster recovery and high availability, ensuring
that data is replicated in two datacenters if the primary datacenter is down
or unavailable.</p>
<p>In the following diagram, data from Datacenter A is replicated to
Datacenter B and Datacenter C, which both have a read-only copy of the leader
index from Datacenter A.</p>
<div class="imageblock">
<div class="content">
<img src="images/ccr-arch-multiple-dcs.png" alt="Production datacenter that replicates data to two other datacenters">
</div>
</div>
<h5><a id="ccr-chained-replication"></a>Chained replication<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.9/docs/reference/ccr/index.asciidoc">edit</a></h5>
<p>You can replicate data across multiple datacenters to form a replication
chain. In the following diagram, Datacenter A contains the leader index.
Datacenter B replicates data from Datacenter A, and Datacenter C replicates
from the follower indices in Datacenter B. The connection between these
datacenters forms a chained replication pattern.</p>
<div class="imageblock">
<div class="content">
<img src="images/ccr-arch-chain-dcs.png" alt="Three datacenters connected to form a replication chain">
</div>
</div>
<h5><a id="ccr-bi-directional-replication"></a>Bi-directional replication<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.9/docs/reference/ccr/index.asciidoc">edit</a></h5>
<p>In a <a href="/blog/bi-directional-replication-with-elasticsearch-cross-cluster-replication-ccr" class="ulink" target="_top">bi-directional replication</a> setup, all clusters have access to view
all data, and all clusters have an index to write to without manually
implementing failover. Applications can write to the local index within each
datacenter, and read across multiple indices for a global view of all
information.</p>
<p>This configuration requires no manual intervention when a cluster or datacenter
is unavailable. In the following diagram, if Datacenter A is unavailable, you can continue using Datacenter B without manual failover. When Datacenter A
comes online, replication resumes between the clusters.</p>
<div class="imageblock">
<div class="content">
<img src="images/ccr-arch-bi-directional.png" alt="Bi-directional configuration where each cluster contains both a leader index and follower indices">
</div>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This configuration is useful for index-only workloads, where no updates
to document values occur. In this configuration, documents indexed by Elasticsearch are
immutable. Clients are located in each datacenter alongside the Elasticsearch
cluster, and do not communicate with clusters in different datacenters.</p>
</div>
</div>
<h4><a id="ccr-data-locality"></a>Data locality<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.9/docs/reference/ccr/index.asciidoc">edit</a></h4>
<p>Bringing data closer to your users or application server can reduce latency
and response time. This methodology also applies when replicating data in Elasticsearch.
For example, you can replicate a product catalog or reference dataset to 20 or
more datacenters around the world to minimize the distance between the data and
the application server.</p>
<p>In the following diagram, data is replicated from one datacenter to three
additional datacenters, each in their own region. The central datacenter
contains the leader index, and the additional datacenters contain follower
indices that replicate data in that particular region. This configuration
puts data closer to the application accessing it.</p>
<div class="imageblock">
<div class="content">
<img src="images/ccr-arch-data-locality.png" alt="A centralized datacenter replicated across three other datacenters" width="each in their own region">
</div>
</div>
<h4><a id="ccr-centralized-reporting"></a>Centralized reporting<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.9/docs/reference/ccr/index.asciidoc">edit</a></h4>
<p>Using a centralized reporting cluster is useful when querying across a large
network is inefficient. In this configuration, you replicate data from many
smaller clusters to the centralized reporting cluster.</p>
<p>For example, a large global bank might have 100 Elasticsearch clusters around the world
that are distributed across different regions for each bank branch. Using
cross-cluster replication, the bank can replicate events from all 100 banks to a central cluster to
analyze and aggregate events locally for reporting. Rather than maintaining a
mirrored cluster, the bank can use cross-cluster replication to replicate specific indices.</p>
<p>In the following diagram, data from three datacenters in different regions is
replicated to a centralized reporting cluster. This configuration enables you
to copy data from regional hubs to a central cluster, where you can run all
reports locally.</p>
<div class="imageblock">
<div class="content">
<img src="images/ccr-arch-central-reporting.png" alt="Three clusters in different regions sending data to a centralized reporting cluster for analysis">
</div>
</div>
<h3><a id="ccr-replication-mechanics"></a>Replication mechanics<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.9/docs/reference/ccr/index.asciidoc">edit</a></h3>
<p>Although you <a class="xref" href="ccr-getting-started.html" title="Tutorial: Set up cross-cluster replication">set up cross-cluster replication</a> at the index level, Elasticsearch
achieves replication at the shard level. When a follower index is created,
each shard in that index pulls changes from its corresponding shard in the
leader index, which means that a follower index has the same number of
shards as its leader index. All operations on the leader are replicated by the
follower, such as operations to create, update, or delete a document.
These requests can be served from any copy of the leader shard (primary or
replica).</p>
<p>When a follower shard sends a read request, the leader shard responds with
any new operations, limited by the read parameters that you establish when
configuring the follower index. If no new operations are available, the
leader shard waits up to the configured timeout for new operations. If the
timeout elapses, the leader shard responds to the follower shard that there
are no new operations. The follower shard updates shard statistics and
immediately sends another read request to the leader shard. This
communication model ensures that network connections between the remote
cluster and the local cluster are continually in use, avoiding forceful
termination by an external source such as a firewall.</p>
<p>If a read request fails, the cause of the failure is inspected. If the
cause of the failure is deemed to be recoverable (such as a network
failure), the follower shard enters into a retry loop. Otherwise, the
follower shard pauses
<a class="xref" href="ccr-managing.html#ccr-pause-replication" title="Pause and resume replication">until you resume it</a>.</p>
<p>When a follower shard receives operations from the leader shard, it places
those operations in a write buffer. The follower shard submits bulk write
requests using operations from the write buffer. If the write buffer exceeds
its configured limits, no additional read requests are sent. This configuration
provides a back-pressure against read requests, allowing the follower shard
to resume sending read requests when the write buffer is no longer full.</p>
<p>To manage how operations are replicated from the leader index, you can
configure settings when
<a class="xref" href="ccr-getting-started.html#ccr-getting-started-follower-index" title="Create a follower index to replicate a specific index">creating the follower index</a>.</p>
<p>The follower index automatically retrieves some updates applied to the leader
index, while other updates are retrieved as needed:</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<tbody>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Update type</strong></span></p></td>
<td align="left" valign="top"><p><span class="strong strong"><strong>Automatic</strong></span></p></td>
<td align="left" valign="top"><p><span class="strong strong"><strong>As needed</strong></span></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Alias</p></td>
<td align="left" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="left" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Mapping</p></td>
<td align="left" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
<td align="left" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Settings</p></td>
<td align="left" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
<td align="left" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
</tr>
</tbody>
</table>
</div>
<p>For example, changing the number of replicas on the leader index is not
replicated by the follower index, so that setting might not be retrieved.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>You cannot manually modify a follower index&#8217;s mappings or aliases.</p>
</div>
</div>
<p>If you apply a non-dynamic settings change to the leader index that is
needed by the follower index, the follower index closes itself, applies the
settings update, and then re-opens itself. The follower index is unavailable
for reads and cannot replicate writes during this cycle.</p>
<h3><a id="ccr-remote-recovery"></a>Initializing followers using remote recovery<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.9/docs/reference/ccr/index.asciidoc">edit</a></h3>
<p>When you create a follower index, you cannot use it until it is fully
initialized. The <em>remote recovery</em> process builds a new copy of a shard on a
follower node by copying data from the primary shard in the leader cluster.</p>
<p>Elasticsearch uses this remote recovery process to bootstrap a follower index using the
data from the leader index. This process provides the follower with a copy of
the current state of the leader index, even if a complete history of changes
is not available on the leader due to Lucene segment merging.</p>
<p>Remote recovery is a network intensive process that transfers all of the Lucene
segment files from the leader cluster to the follower cluster. The follower
requests that a recovery session be initiated on the primary shard in the
leader cluster. The follower then requests file chunks concurrently from the
leader. By default, the process concurrently requests five 1MB file
chunks. This default behavior is designed to support leader and follower
clusters with high network latency between them.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>You can modify dynamic <a class="xref" href="ccr-settings.html#ccr-recovery-settings" title="Remote recovery settings">remote recovery settings</a>
to rate-limit the transmitted data and manage the resources consumed by remote
recoveries.</p>
</div>
</div>
<p>Use the <a class="xref" href="cat-recovery.html" title="cat recovery API">recovery API</a> on the cluster containing the follower
index to obtain information about an in-progress remote recovery. Because Elasticsearch
implements remote recoveries using the
<a class="xref" href="snapshot-restore.html" title="Snapshot and restore">snapshot and restore</a> infrastructure, running remote
recoveries are labelled as type <code class="literal">snapshot</code> in the recovery API.</p>
<h3><a id="ccr-leader-requirements"></a>Replicating a leader requires soft deletes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.9/docs/reference/ccr/index.asciidoc">edit</a></h3>
<p>Cross-cluster replication works by replaying the history of individual write
operations that were performed on the shards of the leader index. Elasticsearch needs to
retain the
<a class="xref" href="index-modules-history-retention.html" title="History retention">history of these operations</a> on the leader
shards so that they can be pulled by the follower shard tasks. The underlying
mechanism used to retain these operations is <em>soft deletes</em>.</p>
<p>A soft delete occurs whenever an existing document is deleted or updated. By
retaining these soft deletes up to configurable limits, the history of
operations can be retained on the leader shards and made available to the
follower shard tasks as it replays the history of operations.</p>
<p>The <a class="xref" href="index-modules.html#ccr-index-soft-deletes-retention-period"><code class="literal">index.soft_deletes.retention_lease.period</code></a> setting defines the
maximum time to retain a shard history retention lease before it is
considered expired. This setting determines how long the cluster containing
your leader index can be offline, which is 12 hours by default. If a shard copy
recovers after its retention lease expires, then Elasticsearch will fall back to copying
the entire index, because it can no longer replay the missing history.</p>
<p>Soft deletes must be enabled for indices that you want to use as leader
indices. Soft deletes are enabled by default on new indices created on
or after Elasticsearch 7.0.0.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Cross-cluster replication cannot be used on existing indices created using Elasticsearch
7.0.0 or earlier, where soft deletes are disabled. You must
<a class="xref" href="docs-reindex.html" title="Reindex API">reindex</a> your data into a new index with soft deletes
enabled.</p>
</div>
</div>
<h3><a id="ccr-learn-more"></a>Use cross-cluster replication<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.9/docs/reference/ccr/index.asciidoc">edit</a></h3>
<p>This following sections provide more information about how to configure
and use cross-cluster replication:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="ccr-getting-started.html" title="Tutorial: Set up cross-cluster replication">Set up cross-cluster replication</a>
</li>
<li class="listitem">
<a class="xref" href="ccr-managing.html" title="Manage cross-cluster replication">Manage cross-cluster replication</a>
</li>
<li class="listitem">
<a class="xref" href="ccr-auto-follow.html" title="Manage auto-follow patterns">Manage auto-follow patterns</a>
</li>
<li class="listitem">
<a class="xref" href="ccr-upgrading.html" title="Upgrading clusters using cross-cluster replication">Upgrading clusters</a>
</li>
</ul>
</div>




</div>
<div class="navfooter">
<span class="prev">
<a href="restore-cluster-data.html">« Restore a cluster&#8217;s data</a>
</span>
<span class="next">
<a href="ccr-getting-started.html">Tutorial: Set up cross-cluster replication »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>
                <div class="col-xs-12 col-sm-4 col-md-4" id="right_col">
                  <div id="rtpcontainer" style="display: block;">
                    <div class="mktg-promo">
                      <h3>Most Popular</h3>
                      <ul class="icons">
                        <li class="icon-elasticsearch-white"><a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">Get Started with Elasticsearch: Video</a></li>
                        <li class="icon-kibana-white"><a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">Intro to Kibana: Video</a></li>
                        <li class="icon-logstash-white"><a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">ELK for Logs & Metrics: Video</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";
	var localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}';
</script>
<script src="/static/js/swiftype_app_search.umd.min.js"></script>
<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
