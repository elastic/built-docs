<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Data stream lifecycle | Elasticsearch Guide [master] | Elastic</title>
<meta class="elastic" name="content" content="Data stream lifecycle | Elasticsearch Guide [master]">

<link rel="home" href="index.html" title="Elasticsearch Guide [master]"/>
<link rel="up" href="data-streams.html" title="Data streams"/>
<link rel="prev" href="downsampling-ilm.html" title="Run downsampling with ILM"/>
<link rel="next" href="tutorial-manage-new-data-stream.html" title="Tutorial: Create a data stream with a lifecycle"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="Elasticsearch"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/master"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="master"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <!--© 2015-2022 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  <div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elasticsearch Guide [master]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="data-streams.html">Data streams</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="downsampling-ilm.html">« Run downsampling with ILM</a>
</span>
<span class="next">
<a href="tutorial-manage-new-data-stream.html">Tutorial: Create a data stream with a lifecycle »</a>
</span>
</div>
<div class="chapter xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="data-stream-lifecycle"></a>Data stream lifecycle<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/data-streams/lifecycle/index.asciidoc">edit</a></h2>
</div></div></div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in technical preview and may be changed or removed in a future release. Elastic will apply best effort to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.</p>
</div>
</div>
<p>A data stream lifecycle is the built-in mechanism data streams use to manage their lifecycle. It enables you to easily
automate the management of your data streams according to your retention requirements. For example, you could configure
the lifecycle to:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Ensure that data indexed in the data stream will be kept at least for the retention time you defined.
</li>
<li class="listitem">
Ensure that data older than the retention period will be deleted automatically by Elasticsearch at a later time.
</li>
</ul>
</div>
<p>To achieve that, it supports:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Automatic <a class="xref" href="index-rollover.html" title="Rollover">rollover</a>, which chunks your incoming data in smaller pieces to facilitate better performance
and backwards incompatible mapping changes.
</li>
<li class="listitem">
Configurable retention, which allows you to configure the time period for which your data is guaranteed to be stored.
Elasticsearch is allowed at a later time to delete data older than this time period.
</li>
</ul>
</div>
<h3><a id="data-streams-lifecycle-how-it-works"></a>How does it work?<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/data-streams/lifecycle/index.asciidoc">edit</a></h3>
<p>In intervals configured by <a class="xref" href="data-stream-lifecycle-settings.html#data-streams-lifecycle-poll-interval"><code class="literal">data_streams.lifecycle.poll_interval</code></a>, Elasticsearch goes over
each data stream and performs the following steps:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Checks if the data stream has a data stream lifecycle configured, skipping any indices not part of a managed data stream.
</li>
<li class="listitem">
Rolls over the write index of the data stream, if it fulfills the conditions defined by
<a class="xref" href="data-stream-lifecycle-settings.html#cluster-lifecycle-default-rollover"><code class="literal">cluster.lifecycle.default.rollover</code></a>.
</li>
<li class="listitem">
Applies retention to the remaining backing indices. This means deleting the backing indices whose
<code class="literal">generation_time</code> is longer than the configured retention period. The <code class="literal">generation_time</code> is only applicable to rolled over backing
indices and it is either the time since the backing index got rolled over, or the time optionally configured in the
<a class="xref" href="data-stream-lifecycle-settings.html#index-data-stream-lifecycle-origination-date"><code class="literal">index.lifecycle.origination_date</code></a> setting.
</li>
</ol>
</div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>We use the <code class="literal">generation_time</code> instead of the creation time because this ensures that all data in the backing
index have passed the retention period. As a result, the retention period is not the exact time data gets deleted, but
the minimum time data will be stored.</p>
</div>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The steps <code class="literal">2</code> and <code class="literal">3</code> apply only to backing indices that are not already managed by ILM, meaning that these indices either do
not have an ILM policy defined, or if they do, they have <a class="xref" href="data-stream-lifecycle-settings.html#index-lifecycle-prefer-ilm"><code class="literal">index.lifecycle.prefer_ilm</code></a>
set to <code class="literal">false</code>.</p>
</div>
</div>
<h3><a id="data-stream-lifecycle-configuration"></a>Configuring data stream lifecycle<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/data-streams/lifecycle/index.asciidoc">edit</a></h3>
<p>Since the lifecycle is configured on the data stream level, the process to configure a lifecycle on a new data stream and
on an existing one differ.</p>
<p>In the following sections, we will go through the following tutorials:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
To create a new data stream with a lifecycle, you need to add the data stream lifecycle as part of the index template
that matches the name of your data stream (see <a class="xref" href="tutorial-manage-new-data-stream.html" title="Tutorial: Create a data stream with a lifecycle">Tutorial: Create a data stream with a lifecycle</a>). When a write operation
with the name of your data stream reaches Elasticsearch then the data stream will be created with the respective data stream lifecycle.
</li>
<li class="listitem">
To update the lifecycle of an existing data stream you need to use the <a class="xref" href="data-stream-apis.html#data-stream-lifecycle-api">data stream lifecycle APIs</a>
to edit the lifecycle on the data stream itself (see <a class="xref" href="tutorial-manage-existing-data-stream.html" title="Tutorial: Update existing data stream">Tutorial: Update existing data stream</a>).
</li>
</ul>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Updating the data stream lifecycle of an existing data stream is different from updating the settings or the mapping,
because it is applied on the data stream level and not on the individual backing indices.</p>
</div>
</div>


</div>
<div class="navfooter">
<span class="prev">
<a href="downsampling-ilm.html">« Run downsampling with ILM</a>
</span>
<span class="next">
<a href="tutorial-manage-new-data-stream.html">Tutorial: Create a data stream with a lifecycle »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {"alternatives":{"console":{"php":{"hasAny":true},"python":{"hasAny":true},"ruby":{"hasAny":true},"go":{"hasAny":true},"js":{"hasAny":true}}}}</script>
  </body>
</html>
