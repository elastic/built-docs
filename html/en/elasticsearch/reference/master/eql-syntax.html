<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>EQL syntax reference | Elasticsearch Reference [master] | Elastic</title>
<link rel="home" href="index.html" title="Elasticsearch Reference [master]"/>
<link rel="up" href="eql.html" title="EQL search"/>
<link rel="prev" href="eql.html" title="EQL search"/>
<link rel="next" href="eql-function-ref.html" title="EQL function reference"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/master"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="master"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!--BEGIN QUALTRICS WEBSITE FEEDBACK SNIPPET-->
    <script type='text/javascript'>
      (function(){var g=function(e,h,f,g){
      this.get=function(a){for(var a=a+"=",c=document.cookie.split(";"),b=0,e=c.length;b<e;b++){for(var d=c[b];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return null};
      this.set=function(a,c){var b="",b=new Date;b.setTime(b.getTime()+6048E5);b="; expires="+b.toGMTString();document.cookie=a+"="+c+b+"; path=/; "};
      this.check=function(){var a=this.get(f);if(a)a=a.split(":");else if(100!=e)"v"==h&&(e=Math.random()>=e/100?0:100),a=[h,e,0],this.set(f,a.join(":"));else return!0;var c=a[1];if(100==c)return!0;switch(a[0]){case "v":return!1;case "r":return c=a[2]%Math.floor(100/c),a[2]++,this.set(f,a.join(":")),!c}return!0};
      this.go=function(){if(this.check()){var a=document.createElement("script");a.type="text/javascript";a.src=g;document.body&&document.body.appendChild(a)}};
      this.start=function(){var a=this;window.addEventListener?window.addEventListener("load",function(){a.go()},!1):window.attachEvent&&window.attachEvent("onload",function(){a.go()})}};
      try{(new g(100,"r","QSI_S_ZN_emkP0oSe9Qrn7kF","https://znemkp0ose9qrn7kf-elastic.siteintercept.qualtrics.com/WRSiteInterceptEngine/?Q_ZID=ZN_emkP0oSe9Qrn7kF")).start()}catch(i){}})();
    </script><div id='ZN_emkP0oSe9Qrn7kF'><!--DO NOT REMOVE-CONTENTS PLACED HERE--></div>
    <!--END WEBSITE FEEDBACK SNIPPET-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <!-- Subnav -->
    <div>
      <div>
        <div class="tertiary-nav d-none d-md-block">
          <div class="container">
            <div class="p-t-b-15 d-flex justify-content-between nav-container">
              <div class="breadcrum-wrapper"><span><a href="/guide/" style="font-size: 14px; font-weight: 600; color: #000;">Docs</a></span></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container">
              <div class="row">
                <div class="col-xs-12 col-sm-8 col-md-8 guide-section">
                  <!-- start body -->
                  <div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Elasticsearch Reference [master]</a></span>
»
<span class="breadcrumb-link"><a href="eql.html">EQL search</a></span>
»
<span class="breadcrumb-node">EQL syntax reference</span>
</div>
<div class="navheader">
<span class="prev">
<a href="eql.html">« EQL search</a>
</span>
<span class="next">
<a href="eql-function-ref.html">EQL function reference »</a>
</span>
</div>
<div class="chapter xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="eql-syntax"></a>EQL syntax reference<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/eql/syntax.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is experimental and may be changed or removed completely in a future release. Elastic will take a best effort approach to fix any issues, but experimental features are not subject to the support SLA of official GA features.</p>
</div>
</div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Elasticsearch supports a subset of <a href="https://eql.readthedocs.io/en/latest/query-guide/index.html" class="ulink" target="_top">EQL syntax</a>. See
<a class="xref" href="eql-syntax.html#eql-syntax-limitations" title="Limitations">Limitations</a>.</p>
</div>
</div>
<h3><a id="eql-basic-syntax"></a>Basic syntax<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/eql/syntax.asciidoc">edit</a></h3>
<p>EQL queries require an event category and a matching condition. The <code class="literal">where</code>
keyword connects them.</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">event_category where condition</pre>
</div>
<p>For example, the following EQL query matches <code class="literal">process</code> events with a
<code class="literal">process.name</code> field value of <code class="literal">svchost.exe</code>:</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">process where process.name == "svchost.exe"</pre>
</div>
<h4><a id="eql-syntax-event-categories"></a>Event categories<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/eql/syntax.asciidoc">edit</a></h4>
<p>In Elasticsearch, an event category is a valid, indexed value of the
<a class="xref" href="eql.html#eql-required-fields" title="Required fields">event category field</a>. You can set the event category
field using the <code class="literal">event_category_field</code> parameter of the EQL search API.</p>
<h5><a id="eql-syntax-match-any-event-category"></a>Match any event category<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/eql/syntax.asciidoc">edit</a></h5>
<p>To match events of any category, use the <code class="literal">any</code> keyword. You can also use the
<code class="literal">any</code> keyword to search for documents without a event category field.</p>
<p>For example, the following EQL query matches any documents with a
<code class="literal">network.protocol</code> field value of <code class="literal">http</code>:</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">any where network.protocol == "http"</pre>
</div>
<h4><a id="eql-syntax-conditions"></a>Conditions<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/eql/syntax.asciidoc">edit</a></h4>
<p>A condition consists of one or more criteria an event must match.
You can specify and combine these criteria using the following operators:</p>
<h5><a id="eql-syntax-comparison-operators"></a>Comparison operators<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/eql/syntax.asciidoc">edit</a></h5>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">&lt;   &lt;=   ==   !=   &gt;=   &gt;</pre>
</div>
<details>
<summary class="title"><span class="strong strong"><strong>Definitions</strong></span></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;</code> (less than)
</span>
</dt>
<dd>
Returns <code class="literal">true</code> if the value to the left of the operator is less than the value
to the right. Otherwise returns <code class="literal">false</code>.
</dd>
<dt>
<span class="term">
<code class="literal">&lt;=</code> (less than or equal)
</span>
</dt>
<dd>
Returns <code class="literal">true</code> if the value to the left of the operator is less than or equal to
the value to the right. Otherwise returns <code class="literal">false</code>.
</dd>
<dt>
<span class="term">
<code class="literal">==</code> (equal)
</span>
</dt>
<dd>
Returns <code class="literal">true</code> if the values to the left and right of the operator are equal.
Otherwise returns <code class="literal">false</code>.
</dd>
<dt>
<span class="term">
<code class="literal">!=</code> (not equal)
</span>
</dt>
<dd>
Returns <code class="literal">true</code> if the values to the left and right of the operator are not
equal. Otherwise returns <code class="literal">false</code>.
</dd>
<dt>
<span class="term">
<code class="literal">&gt;=</code> (greater than or equal)
</span>
</dt>
<dd>
Returns <code class="literal">true</code> if the value to the left of the operator is greater than or equal
to the value to the right. Otherwise returns <code class="literal">false</code>.
</dd>
<dt>
<span class="term">
<code class="literal">&gt;</code> (greater than)
</span>
</dt>
<dd>
Returns <code class="literal">true</code> if the value to the left of the operator is greater than the
value to the right. Otherwise returns <code class="literal">false</code>.
</dd>
</dl>
</div>
</div>
</details>
<p>You cannot use comparison operators to compare a variable, such as a field
value, to another variable, even if those variables are modified using a
<a class="xref" href="eql-syntax.html#eql-functions" title="Functions">function</a>.</p>
<p><span class="strong strong"><strong>Example</strong></span><br>
The following EQL query compares the <code class="literal">process.parent_name</code> field
value to a static value, <code class="literal">foo</code>. This comparison is supported.</p>
<p>However, the query also compares the <code class="literal">process.parent.name</code> field value to the
<code class="literal">process.name</code> field. This comparison is not supported and will return an
error for the entire query.</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">process where process.parent.name == "foo" and process.parent.name == process.name</pre>
</div>
<p>Instead, you can rewrite the query to compare both the <code class="literal">process.parent.name</code>
and <code class="literal">process.name</code> fields to static values.</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">process where process.parent.name == "foo" and process.name == "foo"</pre>
</div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Avoid using the <code class="literal">==</code> operator to perform exact matching on <a class="xref" href="text.html" title="Text field type"><code class="literal">text</code></a> field
values.</p>
<p>By default, Elasticsearch changes the values of <code class="literal">text</code> fields as part of <a class="xref" href="analysis.html" title="Text analysis">analysis</a>. This can make finding exact matches for <code class="literal">text</code> field values
difficult.</p>
<p>To search <code class="literal">text</code> fields, consider using a <a class="xref" href="eql.html#eql-search-filter-query-dsl" title="Filter using query DSL">query
DSL filter</a> that contains a <a class="xref" href="query-dsl-match-query.html" title="Match query"><code class="literal">match</code></a> query.</p>
</div>
</div>
<h5><a id="eql-syntax-logical-operators"></a>Logical operators<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/eql/syntax.asciidoc">edit</a></h5>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">and  or  not</pre>
</div>
<details>
<summary class="title"><span class="strong strong"><strong>Definitions</strong></span></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">and</code>
</span>
</dt>
<dd>
Returns <code class="literal">true</code> only if the condition to the left and right <em>both</em> return <code class="literal">true</code>.
Otherwise returns `false.
</dd>
<dt>
<span class="term">
<code class="literal">or</code>
</span>
</dt>
<dd>
Returns <code class="literal">true</code> if one of the conditions to the left or right <code class="literal">true</code>.
Otherwise returns `false.
</dd>
<dt>
<span class="term">
<code class="literal">not</code>
</span>
</dt>
<dd>
Returns <code class="literal">true</code> if the condition to the right is <code class="literal">false</code>.
</dd>
</dl>
</div>
</div>
</details>
<h5><a id="eql-syntax-lookup-operators"></a>Lookup operators<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/eql/syntax.asciidoc">edit</a></h5>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">user.name in ("Administrator", "SYSTEM", "NETWORK SERVICE")
user.name not in ("Administrator", "SYSTEM", "NETWORK SERVICE")</pre>
</div>
<details>
<summary class="title"><span class="strong strong"><strong>Definitions</strong></span></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">in</code>
</span>
</dt>
<dd>
Returns <code class="literal">true</code> if the value is contained in the provided list.
</dd>
<dt>
<span class="term">
<code class="literal">not in</code>
</span>
</dt>
<dd>
Returns <code class="literal">true</code> if the value is not contained in the provided list.
</dd>
</dl>
</div>
</div>
</details>
<h5><a id="eql-syntax-math-operators"></a>Math operators<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/eql/syntax.asciidoc">edit</a></h5>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">+  -  *  /  %</pre>
</div>
<details>
<summary class="title"><span class="strong strong"><strong>Definitions</strong></span></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">+</code> (add)
</span>
</dt>
<dd>
Adds the values to the left and right of the operator.
</dd>
<dt>
<span class="term">
<code class="literal">-</code> (Subtract)
</span>
</dt>
<dd>
Subtracts the value to the right of the operator from the value to the left.
</dd>
<dt>
<span class="term">
<code class="literal">*</code> (Subtract)
</span>
</dt>
<dd>
Multiplies the values to the left and right of the operator.
</dd>
<dt>
<span class="term">
<code class="literal">/</code> (Divide)
</span>
</dt>
<dd>
Divides the value to the left of the operator by the value to the right.
</dd>
<dt>
<span class="term">
<code class="literal">%</code> (modulo)
</span>
</dt>
<dd>
Divides the value to the left of the operator by the value to the right. Returns only the remainder.
</dd>
</dl>
</div>
</div>
</details>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<a id="eql-divide-operator-float-rounding"></a>
<p>If both the dividend and divisor are integers, the divide (<code class="literal">\</code>) operation
<em>rounds down</em> any returned floating point numbers to the nearest integer.</p>
<p>EQL queries in Elasticsearch should account for this rounding. To avoid rounding, convert
either the dividend or divisor to a float.</p>
<p><span class="strong strong"><strong>Example</strong></span><br>
The <code class="literal">process.args_count</code> field is a <a class="xref" href="number.html" title="Numeric field types"><code class="literal">long</code></a> integer field containing a
count of process arguments.</p>
<p>A user might expect the following EQL query to only match events with a
<code class="literal">process.args_count</code> value of <code class="literal">4</code>.</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">process where ( 4 / process.args_count ) == 1</pre>
</div>
<p>However, the EQL query matches events with a <code class="literal">process.args_count</code> value of <code class="literal">3</code>
or <code class="literal">4</code>.</p>
<p>For events with a <code class="literal">process.args_count</code> value of <code class="literal">3</code>, the divide operation
returns a float of <code class="literal">1.333...</code>, which is rounded down to <code class="literal">1</code>.</p>
<p>To match only events with a <code class="literal">process.args_count</code> value of <code class="literal">4</code>, convert
either the dividend or divisor to a float.</p>
<p>The following EQL query changes the integer <code class="literal">4</code> to the equivalent float <code class="literal">4.0</code>.</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">process where ( 4.0 / process.args_count ) == 1</pre>
</div>
</div>
</div>
<h4><a id="eql-syntax-strings"></a>Strings<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/eql/syntax.asciidoc">edit</a></h4>
<p>Strings are enclosed with double quotes (<code class="literal">"</code>) or single quotes (<code class="literal">'</code>).</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">"hello world"
"hello world with 'substring'"</pre>
</div>
<h5><a id="eql-syntax-wildcards"></a>Wildcards<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/eql/syntax.asciidoc">edit</a></h5>
<p>When making string comparisons using the <code class="literal">==</code> or <code class="literal">!=</code> operators, you can use the
<code class="literal">*</code> operator to match specific patterns:</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">field == "example*wildcard"
field != "example*wildcard"</pre>
</div>
<h5><a id="eql-syntax-match-any-condition"></a>Match any condition<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/eql/syntax.asciidoc">edit</a></h5>
<p>To match events solely on event category, use the <code class="literal">where true</code> condition.</p>
<p>For example, the following EQL query matches any <code class="literal">file</code> events:</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">file where true</pre>
</div>
<p>To match any event, you can combine the <code class="literal">any</code> keyword with the <code class="literal">where true</code>
condition:</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">any where true</pre>
</div>
<h5><a id="eql-syntax-escaped-characters"></a>Escaped characters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/eql/syntax.asciidoc">edit</a></h5>
<p>When used within a string, special characters, such as a carriage return or
double quote (<code class="literal">"</code>), must be escaped with a preceding backslash (<code class="literal">\</code>).</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">"example \t of \n escaped \r characters"</pre>
</div>
<details>
<summary class="title"><span class="strong strong"><strong>Escape sequences</strong></span></summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Escape sequence</th>
<th align="left" valign="top">Literal character</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">\n</code></p></td>
<td align="left" valign="top"><p>A newline (linefeed) character</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">\r</code></p></td>
<td align="left" valign="top"><p>A carriage return character</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">\t</code></p></td>
<td align="left" valign="top"><p>A tab character</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">\\</code></p></td>
<td align="left" valign="top"><p>A backslash (<code class="literal">\</code>) character</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">\"</code></p></td>
<td align="left" valign="top"><p>A double quote (<code class="literal">"</code>) character</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">\'</code></p></td>
<td align="left" valign="top"><p>A single quote (<code class="literal">'</code>) character</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
<h5><a id="eql-syntax-raw-strings"></a>Raw strings<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/eql/syntax.asciidoc">edit</a></h5>
<p>Raw strings are preceded by a question mark (<code class="literal">?</code>) and treat backslashes (<code class="literal">\</code>) as
literal characters.</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">?"String with a literal 'blackslash' \ character included"</pre>
</div>
<p>You can escape single quotes (<code class="literal">'</code>) and double quotes (<code class="literal">"</code>) with a backslash, but
the backslash remains in the resulting string.</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">?"\""</pre>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Raw strings cannot contain only a single backslash or end in an odd number of
backslashes.</p>
</div>
</div>
<h4><a id="eql-syntax-non-alpha-field-names"></a>Non-alphanumeric field names<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/eql/syntax.asciidoc">edit</a></h4>
<p>Field names containing non-alphanumeric characters, such as underscores (<code class="literal">_</code>),
dots (<code class="literal">.</code>), hyphens (<code class="literal">-</code>), or spaces, must be escaped using backticks (`).</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">`my_field`
`my.field`
`my-field`
`my field`</pre>
</div>
<h3><a id="eql-sequences"></a>Sequences<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/eql/syntax.asciidoc">edit</a></h3>
<p>You can use EQL sequences to describe and match an ordered series of events.
Each item in a sequence is an event category and event condition,
surrounded by square brackets (<code class="literal">[ ]</code>). Events are listed in ascending
chronological order, with the most recent event listed last.</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">sequence
  [ event_category_1 where condition_1 ]
  [ event_category_2 where condition_2 ]
  ...</pre>
</div>
<p><span class="strong strong"><strong>Example</strong></span><br>
The following EQL sequence query matches this series of ordered events:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Start with an event with:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
An event category of <code class="literal">file</code>
</li>
<li class="listitem">
A <code class="literal">file.extension</code> of <code class="literal">exe</code>
</li>
</ul>
</div>
</li>
<li class="listitem">
Followed by an event with an event category of <code class="literal">process</code>
</li>
</ol>
</div>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">sequence
  [ file where file.extension == "exe" ]
  [ process where true ]</pre>
</div>
<h4><a id="eql-with-maxspan-keywords"></a><code class="literal">with maxspan</code> keywords<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/eql/syntax.asciidoc">edit</a></h4>
<p>You can use the <code class="literal">with maxspan</code> keywords to constrain a sequence to a specified
timespan. All events in a matching sequence must occur within this duration,
starting at the first event&#8217;s timestamp.</p>
<p>The <code class="literal">maxspan</code> keyword accepts <a class="xref" href="common-options.html#time-units" title="Time units">time value</a> arguments.</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">sequence with maxspan=30s
  [ event_category_1 where condition_1 ] by field_baz
  [ event_category_2 where condition_2 ] by field_bar
  ...</pre>
</div>
<p><span class="strong strong"><strong>Example</strong></span><br>
The following sequence query uses a <code class="literal">maxspan</code> value of <code class="literal">15m</code> (15 minutes).
Events in a matching sequence must occur within 15 minutes of the first event&#8217;s
timestamp.</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">sequence with maxspan=15m
  [ file where file.extension == "exe" ]
  [ process where true ]</pre>
</div>
<h4><a id="eql-by-keyword"></a><code class="literal">by</code> keyword<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/eql/syntax.asciidoc">edit</a></h4>
<p>You can use the <code class="literal">by</code> keyword with sequences to only match events that share the
same field values. If a field value should be shared across all events, you
can use <code class="literal">sequence by</code>.</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">sequence by field_foo
  [ event_category_1 where condition_1 ] by field_baz
  [ event_category_2 where condition_2 ] by field_bar
  ...</pre>
</div>
<p><span class="strong strong"><strong>Example</strong></span><br>
The following sequence query uses the <code class="literal">by</code> keyword to constrain matching events
to:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Events with the same <code class="literal">user.name</code> value
</li>
<li class="listitem">
<code class="literal">file</code> events with a <code class="literal">file.path</code> value equal to the following <code class="literal">process</code>
event&#8217;s <code class="literal">process.path</code> value.
</li>
</ul>
</div>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">sequence
  [ file where file.extension == "exe" ] by user.name, file.path
  [ process where true ] by user.name, process.path</pre>
</div>
<p>Because the <code class="literal">user.name</code> field is shared across all events in the sequence, it
can be included using <code class="literal">sequence by</code>. The following sequence is equivalent to the
prior one.</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">sequence by user.name
  [ file where file.extension == "exe" ] by file.path
  [ process where true ] by process.path</pre>
</div>
<p>You can combine the <code class="literal">sequence by</code> and <code class="literal">with maxspan</code> keywords to constrain a
sequence by both field values and a timespan.</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">sequence by field_foo with maxspan=30s
  [ event_category_1 where condition_1 ] by field_baz
  [ event_category_2 where condition_2 ] by field_bar
  ...</pre>
</div>
<p><span class="strong strong"><strong>Example</strong></span><br>
The following sequence query uses the <code class="literal">sequence by</code> keyword and <code class="literal">with maxspan</code>
keywords to match only a sequence of events that:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Share the same <code class="literal">user.name</code> field values
</li>
<li class="listitem">
Occur within <code class="literal">15m</code> (15 minutes) of the first matching event
</li>
</ul>
</div>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">sequence by user.name with maxspan=15m
  [ file where file.extension == "exe" ] by file.path
  [ process where true ] by process.path</pre>
</div>
<h4><a id="eql-until-keyword"></a><code class="literal">until</code> keyword<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/eql/syntax.asciidoc">edit</a></h4>
<p>You can use the <code class="literal">until</code> keyword to specify an expiration event for a sequence.
If this expiration event occurs <em>between</em> matching events in a sequence, the
sequence expires and is not considered a match. If the expiration event occurs
<em>after</em> matching events in a sequence, the sequence is still considered a
match. The expiration event is not included in the results.</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">sequence
  [ event_category_1 where condition_1 ]
  [ event_category_2 where condition_2 ]
  ...
until [ event_category_3 where condition_3 ]</pre>
</div>
<p><span class="strong strong"><strong>Example</strong></span><br>
A dataset contains the following event sequences, grouped by shared IDs:</p>
<div class="pre_wrapper lang-txt">
<pre class="programlisting prettyprint lang-txt">A, B
A, B, C
A, C, B</pre>
</div>
<p>The following EQL query searches the dataset for sequences containing
event <code class="literal">A</code> followed by event <code class="literal">B</code>. Event <code class="literal">C</code> is used as an expiration event.</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">sequence by ID
  A
  B
until C</pre>
</div>
<p>The query matches sequences <code class="literal">A, B</code> and <code class="literal">A, B, C</code> but not <code class="literal">A, C, B</code>.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>The <code class="literal">until</code> keyword can be useful when searching for process sequences in
Windows event logs.</p>
<p>In Windows, a process ID (PID) is unique only while a process is running. After
a process terminates, its PID can be reused.</p>
<p>You can search for a sequence of events with the same PID value using the <code class="literal">by</code>
and <code class="literal">sequence by</code> keywords.</p>
<p><span class="strong strong"><strong>Example</strong></span><br>
The following EQL query uses the <code class="literal">sequence by</code> keyword to match a
sequence of events that share the same <code class="literal">process.pid</code> value.</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">sequence by process.pid
  [ process where event.type == "start" and process.name == "cmd.exe" ]
  [ process where file.extension == "exe" ]</pre>
</div>
<p>However, due to PID reuse, this can result in a matching sequence that
contains events across unrelated processes. To prevent false positives, you can
use the <code class="literal">until</code> keyword to end matching sequences before a process termination
event.</p>
<p>The following EQL query uses the <code class="literal">until</code> keyword to end sequences before
<code class="literal">process</code> events with an <code class="literal">event.type</code> of <code class="literal">stop</code>. These events indicate a process
has been terminated.</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">sequence by process.pid
  [ process where event.type == "start" and process.name == "cmd.exe" ]
  [ process where file.extension == "exe" ]
until [ process where event.type == "stop" ]</pre>
</div>
</div>
</div>
<h3><a id="eql-functions"></a>Functions<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/eql/syntax.asciidoc">edit</a></h3>
<p>Elasticsearch supports several of EQL&#8217;s built-in functions. You can use these functions
to convert data types, perform math, manipulate strings, and more.</p>
<p>For a list of supported functions, see <a class="xref" href="eql-function-ref.html" title="EQL function reference"><em>Function reference</em></a>.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>Using functions in EQL queries can result in slower search speeds. If you
often use functions to transform indexed data, you can speed up search by making
these changes during indexing instead. However, that often means slower index
speeds.</p>
<p><span class="strong strong"><strong>Example</strong></span><br>
An index contains the <code class="literal">file.path</code> field. <code class="literal">file.path</code> contains the full path to a
file, including the file extension.</p>
<p>When running EQL searches, users often use the <code class="literal">endsWith</code> function with the
<code class="literal">file.path</code> field to match file extensions:</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">file where endsWith(file.path,".exe") or endsWith(file.path,".dll")</pre>
</div>
<p>While this works, it can be repetitive to write and can slow search speeds. To
speed up search, you can do the following instead:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<a class="xref" href="indices-put-mapping.html" title="Put mapping API">Add a new field</a>, <code class="literal">file.extension</code>, to the index. The
<code class="literal">file.extension</code> field will contain only the file extension from the
<code class="literal">file.path</code> field.
</li>
<li class="listitem">
Use an <a class="xref" href="ingest.html" title="Ingest node">ingest pipeline</a> containing the <a class="xref" href="grok-processor.html" title="Grok processor"><code class="literal">grok</code></a>
processor or another preprocessor tool to extract the file extension from the
<code class="literal">file.path</code> field before indexing.
</li>
<li class="listitem">
Index the extracted file extension to the <code class="literal">file.extension</code> field.
</li>
</ol>
</div>
<p>These changes may slow indexing but allow for faster searches. Users
can use the <code class="literal">file.extension</code> field instead of multiple <code class="literal">endsWith</code> function
calls:</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">file where file.extension in ("exe", "dll")</pre>
</div>
<p>We recommend testing and benchmarking any indexing changes before deploying them
in production. See <a class="xref" href="tune-for-indexing-speed.html" title="Tune for indexing speed"><em>Tune for indexing speed</em></a> and <a class="xref" href="tune-for-search-speed.html" title="Tune for search speed"><em>Tune for search speed</em></a>.</p>
</div>
</div>
<h3><a id="eql-pipes"></a>Pipes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/eql/syntax.asciidoc">edit</a></h3>
<p>EQL pipes filter, aggregate, and post-process events returned by
an EQL query. You can use pipes to narrow down EQL query results or make them
more specific.</p>
<p>Pipes are delimited using the pipe (<code class="literal">|</code>) character.</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">event_category where condition | pipe</pre>
</div>
<p><span class="strong strong"><strong>Example</strong></span><br>
The following EQL query uses the <code class="literal">tail</code> pipe to return only the 10 most recent
events matching the query.</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">authentication where agent.id == 4624
| tail 10</pre>
</div>
<p>You can pass the output of a pipe to another pipe. This lets you use multiple
pipes with a single query.</p>
<p>For a list of supported pipes, see <a class="xref" href="eql-pipe-ref.html" title="EQL pipe reference"><em>Pipe reference</em></a>.</p>
<h3><a id="eql-syntax-limitations"></a>Limitations<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/eql/syntax.asciidoc">edit</a></h3>
<p>Elasticsearch EQL does not support the following features and syntax.</p>
<h4><a id="eql-nested-fields"></a>EQL search on nested fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/eql/syntax.asciidoc">edit</a></h4>
<p>You cannot use EQL to search the values of a <a class="xref" href="nested.html" title="Nested field type"><code class="literal">nested</code></a> field or the
sub-fields of a <code class="literal">nested</code> field. However, data streams and indices containing
<code class="literal">nested</code> field mappings are otherwise supported.</p>
<h4><a id="eql-unsupported-syntax"></a>Unsupported syntax<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/eql/syntax.asciidoc">edit</a></h4>
<p>Elasticsearch supports a subset of <a href="https://eql.readthedocs.io/en/latest/query-guide/index.html" class="ulink" target="_top">EQL syntax</a>. Elasticsearch cannot run EQL
queries that contain:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Array functions:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://eql.readthedocs.io/en/latest/query-guide/functions.html#arrayContains" class="ulink" target="_top"><code class="literal">arrayContains</code></a>
</li>
<li class="listitem">
<a href="https://eql.readthedocs.io/en/latest/query-guide/functions.html#arrayCount" class="ulink" target="_top"><code class="literal">arrayCount</code></a>
</li>
<li class="listitem">
<a href="https://eql.readthedocs.io/en/latest/query-guide/functions.html#arraySearch" class="ulink" target="_top"><code class="literal">arraySearch</code></a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<a href="https://eql.readthedocs.io/en/latest/query-guide/joins.html" class="ulink" target="_top">Joins</a>
</li>
<li class="listitem">
<p><a href="https://eql.readthedocs.io/en/latest/query-guide/basic-syntax.html#event-relationships" class="ulink" target="_top">Lineage-related keywords</a>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">child of</code>
</li>
<li class="listitem">
<code class="literal">descendant of</code>
</li>
<li class="listitem">
<code class="literal">event of</code>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>The following <a href="https://eql.readthedocs.io/en/latest/query-guide/pipes.html" class="ulink" target="_top">pipes</a>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://eql.readthedocs.io/en/latest/query-guide/pipes.html#count" class="ulink" target="_top"><code class="literal">count</code></a>
</li>
<li class="listitem">
<a href="https://eql.readthedocs.io/en/latest/query-guide/pipes.html#filter" class="ulink" target="_top"><code class="literal">filter</code></a>
</li>
<li class="listitem">
<a href="https://eql.readthedocs.io/en/latest/query-guide/pipes.html#sort" class="ulink" target="_top"><code class="literal">sort</code></a>
</li>
<li class="listitem">
<a href="https://eql.readthedocs.io/en/latest/query-guide/pipes.html#unique" class="ulink" target="_top"><code class="literal">unique</code></a>
</li>
<li class="listitem">
<a href="https://eql.readthedocs.io/en/latest/query-guide/pipes.html#unique-count" class="ulink" target="_top"><code class="literal">unique_count</code></a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="eql.html">« EQL search</a>
</span>
<span class="next">
<a href="eql-function-ref.html">EQL function reference »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>
                <div class="col-xs-12 col-sm-4 col-md-4" id="right_col">
                  <div id="rtpcontainer" style="display: block;">
                    <div class="mktg-promo">
                      <h3>Most Popular</h3>
                      <ul class="icons">
                        <li class="icon-elasticsearch-white"><a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">Get Started with Elasticsearch: Video</a></li>
                        <li class="icon-kibana-white"><a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">Intro to Kibana: Video</a></li>
                        <li class="icon-logstash-white"><a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">ELK for Logs & Metrics: Video</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";
	var localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}';
</script>
<script src="/static/js/swiftype_app_search.umd.min.js"></script>
<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {"alternatives":{"console":{"php":{"hasAny":true},"csharp":{"hasAny":true},"python":{"hasAny":true},"ruby":{"hasAny":true},"go":{"hasAny":true},"js":{"hasAny":true}}}}</script>
  </body>
</html>
