<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>FIPS 140-2 | Elasticsearch Guide [master] | Elastic</title>
<meta class="elastic" name="content" content="FIPS 140-2 | Elasticsearch Guide [master]">

<link rel="home" href="index.html" title="Elasticsearch Guide [master]"/>
<link rel="up" href="manually-configure-security.html" title="Manually configure security"/>
<link rel="prev" href="security-files.html" title="Security files"/>
<link rel="next" href="update-node-certs.html" title="Updating node security certificates"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="Elasticsearch"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/master"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="master"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <!--© 2015-2022 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  <div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elasticsearch Guide [master]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="secure-cluster.html">Secure the Elastic Stack</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="manually-configure-security.html">Manually configure security</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="security-files.html">« Security files</a>
</span>
<span class="next">
<a href="update-node-certs.html">Updating node security certificates »</a>
</span>
</div>
<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="fips-140-compliance"></a>FIPS 140-2<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/security/fips-140-compliance.asciidoc">edit</a></h2>
</div></div></div>
<p>The Federal Information Processing Standard (FIPS) Publication 140-2, (FIPS PUB
140-2), titled "Security Requirements for Cryptographic Modules" is a U.S.
government computer security standard used to approve cryptographic modules.
Elasticsearch offers a FIPS 140-2 compliant mode and as such can run in a FIPS 140-2
configured JVM.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>The JVM bundled with Elasticsearch is not configured for FIPS 140-2. You must
configure an external JDK with a FIPS 140-2 certified Java Security Provider.
Refer to the Elasticsearch
<a href="/support/matrix#matrix_jvm" class="ulink" target="_top">JVM support matrix</a> for
supported JVM configurations. See <a href="/subscriptions" class="ulink" target="_top">subscriptions</a> for required licensing.</p>
</div>
</div>
<p>Compliance with FIPS 140-2 requires using only FIPS approved / NIST recommended cryptographic algorithms. Generally this can be done by the following:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Installation and configuration of a FIPS certified Java security provider.
</li>
<li class="listitem">
Ensuring the configuration of Elasticsearch is FIPS 140-2 compliant as documented below.
</li>
<li class="listitem">
Setting <code class="literal">xpack.security.fips_mode.enabled</code> to <code class="literal">true</code> in <code class="literal">elasticsearch.yml</code>. Note - this setting alone is not sufficient to be compliant
with FIPS 140-2.
</li>
</ul>
</div>
<h3><a id="_configuring_elasticsearch_for_fips_140_2"></a>Configuring Elasticsearch for FIPS 140-2<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/security/fips-140-compliance.asciidoc">edit</a></h3>
<p>Detailed instructions for the configuration required for FIPS 140-2 compliance is beyond the scope of this document.  It is the responsibility
of the user to ensure compliance with FIPS 140-2. Elasticsearch has been tested with a specific configuration described below. However, there are
other configurations possible to achieve compliance.</p>
<p>The following is a high-level overview of the required configuration:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Use an externally installed Java installation. The JVM bundled with Elasticsearch is not configured for FIPS 140-2.
</li>
<li class="listitem">
Install a FIPS certified security provider .jar file(s) in Elasticsearch&#8217;s <code class="literal">lib</code> directory.
</li>
<li class="listitem">
Configure Java to use a FIPS certified security provider (<a class="xref" href="fips-140-compliance.html#java-security-provider" title="Java security provider">see below</a>).
</li>
<li class="listitem">
Configure Elasticsearch&#8217;s security manager to allow use of the FIPS certified provider (<a class="xref" href="fips-140-compliance.html#java-security-manager" title="Java security manager">see below</a>).
</li>
<li class="listitem">
Ensure the keystore and truststore are configured correctly (<a class="xref" href="fips-140-compliance.html#keystore-fips-password" title="Elasticsearch Keystore">see below</a>).
</li>
<li class="listitem">
Ensure the TLS settings are configured correctly (<a class="xref" href="fips-140-compliance.html#fips-tls" title="TLS">see below</a>).
</li>
<li class="listitem">
Ensure the password hashing settings are configured correctly (<a class="xref" href="fips-140-compliance.html#fips-stored-password-hashing">see below</a>).
</li>
<li class="listitem">
Ensure the cached password hashing settings are configured correctly (<a class="xref" href="fips-140-compliance.html#fips-cached-password-hashing">see below</a>).
</li>
<li class="listitem">
Configure <code class="literal">elasticsearch.yml</code> to use FIPS 140-2 mode, see (<a class="xref" href="fips-140-compliance.html#configuring-es-yml" title="Configure Elasticsearch elasticsearch.yml">below</a>).
</li>
<li class="listitem">
Verify the security provider is installed and configured correctly (<a class="xref" href="fips-140-compliance.html#verify-security-provider" title="Verify the security provider is installed">see below</a>).
</li>
<li class="listitem">
Review the upgrade considerations (<a class="xref" href="fips-140-compliance.html#fips-upgrade-considerations" title="Upgrade considerations">see below</a>) and limitations (<a class="xref" href="fips-140-compliance.html#fips-limitations" title="Limitations">see below</a>).
</li>
</ul>
</div>
<h4><a id="java-security-provider"></a>Java security provider<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/security/fips-140-compliance.asciidoc">edit</a></h4>
<p>Detailed instructions for installation and configuration of a FIPS certified Java security provider is beyond the scope of this document.
Specifically, a FIPS certified
<a href="https://docs.oracle.com/en/java/javase/17/security/java-cryptography-architecture-jca-reference-guide.html" class="ulink" target="_top">JCA</a> and
<a href="https://docs.oracle.com/en/java/javase/17/security/java-secure-socket-extension-jsse-reference-guide.html" class="ulink" target="_top">JSSE</a> implementation is required
so that the JVM uses FIPS validated implementations of NIST recommended cryptographic algorithms.</p>
<p>Elasticsearch has been tested with Bouncy Castle&#8217;s <a href="https://repo1.maven.org/maven2/org/bouncycastle/bc-fips/1.0.2.4/bc-fips-1.0.2.4.jar" class="ulink" target="_top">bc-fips 1.0.2.4</a>
and <a href="https://repo1.maven.org/maven2/org/bouncycastle/bctls-fips/1.0.17/bctls-fips-1.0.17.jar" class="ulink" target="_top">bctls-fips 1.0.17</a>.
Please refer to the [Support Matrix] for details on which combinations of JVM and security provider are supported in FIPS mode. Elasticsearch does not ship with a FIPS certified provider. It is the responsibility of the user
to install and configure the security provider to ensure compliance with FIPS 140-2. Using a FIPS certified provider will ensure that only
approved cryptographic algorithms are used.</p>
<p>To configure Elasticsearch to use additional security provider(s) configure Elasticsearch&#8217;s <a class="xref" href="advanced-configuration.html#set-jvm-options" title="Set JVM options">JVM property</a> <code class="literal">java.security.properties</code> to point to a file
(<a href="https://raw.githubusercontent.com/elastic/elasticsearch/main/build-tools-internal/src/main/resources/fips_java.security" class="ulink" target="_top">example</a>) in Elasticsearch&#8217;s
<code class="literal">config</code> directory. Ensure the FIPS certified security provider is configured with the lowest order. This file should contain the necessary
configuration to instruct Java to use the FIPS certified security provider.</p>
<h4><a id="java-security-manager"></a>Java security manager<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/security/fips-140-compliance.asciidoc">edit</a></h4>
<p>All code running in Elasticsearch is subject to the security restrictions enforced by the Java security manager.
The security provider you have installed and configured may require additional permissions in order to function correctly. You can grant these permissions by providing your own
<a href="https://docs.oracle.com/javase/8/docs/technotes/guides/security/PolicyFiles.html#FileSyntax" class="ulink" target="_top">Java security policy</a></p>
<p>To configure Elasticsearch&#8217;s security manager configure the JVM property <code class="literal">java.security.policy</code> to point a file
(<a href="https://raw.githubusercontent.com/elastic/elasticsearch/main/build-tools-internal/src/main/resources/fips_java.policy" class="ulink" target="_top">example</a>)in Elasticsearch&#8217;s
<code class="literal">config</code> directory with the desired permissions. This file should contain the necessary configuration for the Java security manager
to grant the required permissions needed by the security provider.</p>
<h4><a id="keystore-fips-password"></a>Elasticsearch Keystore<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/security/fips-140-compliance.asciidoc">edit</a></h4>
<p>FIPS 140-2 (via NIST Special Publication 800-132) dictates that encryption keys should at
least have an effective strength of 112 bits.
As such, the Elasticsearch keystore that stores the node&#8217;s <a class="xref" href="secure-settings.html" title="Secure settings">secure settings</a>
needs to be password protected with a password that satisfies this requirement.
This means that the password needs to be 14 bytes long which is equivalent
to a 14 character ASCII encoded password, or a 7 character UTF-8 encoded password.
You can use the <a class="xref" href="elasticsearch-keystore.html" title="elasticsearch-keystore">elasticsearch-keystore passwd</a> subcommand to change or set the
password of an existing keystore.
Note that when the keystore is password-protected, you must supply the password each time
Elasticsearch starts.</p>
<h4><a id="fips-tls"></a>TLS<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/security/fips-140-compliance.asciidoc">edit</a></h4>
<p>SSLv2 and SSLv3 are not allowed by FIPS 140-2, so <code class="literal">SSLv2Hello</code> and <code class="literal">SSLv3</code> cannot
be used for <a class="xref" href="security-settings.html#ssl-tls-settings" title="General TLS settings"><code class="literal">ssl.supported_protocols</code></a>.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The use of TLS ciphers is mainly governed by the relevant crypto module
(the FIPS Approved Security Provider that your JVM uses). All the ciphers that
are configured by default in Elasticsearch are FIPS 140-2 compliant and as such can be
used in a FIPS 140-2 JVM. See <a class="xref" href="security-settings.html#ssl-tls-settings" title="General TLS settings"><code class="literal">ssl.cipher_suites</code></a>.</p>
</div>
</div>
<h4><a id="_tls_keystores_and_keys"></a>TLS keystores and keys<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/security/fips-140-compliance.asciidoc">edit</a></h4>
<p>Keystores can be used in a number of <a class="xref" href="security-settings.html#ssl-tls-settings" title="General TLS settings">General TLS settings</a> in order to
conveniently store key and trust material. Neither <code class="literal">JKS</code>, nor <code class="literal">PKCS#12</code> keystores
can be used in a FIPS 140-2 configured JVM. Avoid using
these types of keystores. Your FIPS 140-2 provider may provide a compliant keystore
implementation that can be used, or you can use PEM encoded files. To use PEM encoded
key material, you can use the relevant <code class="literal">\*.key</code> and <code class="literal">*.certificate</code> configuration
options, and for trust material you can use <code class="literal">*.certificate_authorities</code>.</p>
<p>FIPS 140-2 compliance dictates that the length of the public keys used for TLS
must correspond to the strength of the symmetric key algorithm in use in TLS.
Depending on the value of <code class="literal">ssl.cipher_suites</code> that you select to use, the TLS
keys must have corresponding length according to the following table:</p>
<div class="table">
<a id="comparable-key-strength"></a>
<p class="title"><strong>Table 81. Comparable key strengths</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Comparable key strengths">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<tbody>
<tr>
<td align="left" valign="top"><p>Symmetric Key Algorithm</p></td>
<td align="left" valign="top"><p>RSA key Length</p></td>
<td align="left" valign="top"><p>ECC key length</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">3DES</code></p></td>
<td align="left" valign="top"><p>2048</p></td>
<td align="left" valign="top"><p>224-255</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">AES-128</code></p></td>
<td align="left" valign="top"><p>3072</p></td>
<td align="left" valign="top"><p>256-383</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">AES-256</code></p></td>
<td align="left" valign="top"><p>15630</p></td>
<td align="left" valign="top"><p>512+</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<h4><a id="_stored_password_hashing"></a>Stored password hashing<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/security/fips-140-compliance.asciidoc">edit</a></h4>
<p><a id="fips-stored-password-hashing"></a>While Elasticsearch offers a number of algorithms for securely hashing credentials
on disk, only the <code class="literal">PBKDF2</code> based family of algorithms is compliant with FIPS
140-2 for stored password hashing. However, since <code class="literal">PBKDF2</code> is essentially a key derivation
function, your JVM security provider may enforce a
<a class="xref" href="fips-140-compliance.html#keystore-fips-password" title="Elasticsearch Keystore">112-bit key strength requirement</a>. Although FIPS 140-2
does not mandate user password standards, this requirement may affect password
hashing in Elasticsearch. To comply with this requirement,
while allowing you to use passwords that satisfy your security policy, Elasticsearch offers
<a class="xref" href="security-settings.html#hashing-settings" title="User cache and password hash algorithms">pbkdf2_stretch</a> which is the suggested hashing algorithm when running
Elasticsearch in FIPS 140-2 environments. <code class="literal">pbkdf2_stretch</code> performs a single round of SHA-512
on the user password before passing it to the <code class="literal">PBKDF2</code> implementation.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>You can still use one of the plain <code class="literal">pbkdf2</code> options instead of <code class="literal">pbkdf2_stretch</code> if
you have external policies and tools that can ensure all user passwords for the reserved,
native, and file realms are longer than 14 bytes.</p>
</div>
</div>
<p>You must set the <code class="literal">xpack.security.authc.password_hashing.algorithm</code> setting to one of the
available <code class="literal">pbkdf_stretch_*</code> values.
When FIPS-140 mode is enabled, the default value for
<code class="literal">xpack.security.authc.password_hashing.algorithm</code> is <code class="literal">pbkdf2_stretch</code>.
See <a class="xref" href="security-settings.html#hashing-settings" title="User cache and password hash algorithms">User cache and password hash algorithms</a>.</p>
<p>Password hashing configuration changes are not retroactive so the stored hashed
credentials of existing users of the reserved, native, and file realms are not
updated on disk.
To ensure FIPS 140-2 compliance, recreate users or
change their password using the <a class="xref" href="users-command.html" title="elasticsearch-users">elasticsearch-user</a> CLI tool
for the file realm and the <a class="xref" href="security-api-put-user.html" title="Create or update users API">create users</a> and
<a class="xref" href="security-api-change-password.html" title="Change passwords API">change password</a> APIs for the native and reserved realms.
Other types of realms are not affected and do not require any changes.</p>
<h4><a id="_cached_password_hashing"></a>Cached password hashing<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/security/fips-140-compliance.asciidoc">edit</a></h4>
<p><a id="fips-cached-password-hashing"></a><code class="literal">ssha256</code> (salted <code class="literal">sha256</code>) is recommended for cache hashing. Though
<code class="literal">PBKDF2</code> is compliant with FIPS-140-2, it is&#8201;&#8212;&#8201;by design&#8201;&#8212;&#8201;slow, and
thus not generally suitable as a cache hashing algorithm. Cached
credentials are never stored on disk, and salted <code class="literal">sha256</code> provides an
adequate level of security for in-memory credential hashing, without
imposing prohibitive performance overhead. You <em>may</em> use <code class="literal">PBKDF2</code>,
however you should carefully assess performance impact first. Depending
on your deployment, the overhead of <code class="literal">PBKDF2</code> could undo most of the
performance gain of using a cache.</p>
<p>Either set all <code class="literal">cache.hash_algo</code> settings to <code class="literal">ssha256</code> or leave
them undefined, since <code class="literal">ssha256</code> is the default value for all
<code class="literal">cache.hash_algo</code> settings. See <a class="xref" href="security-settings.html#hashing-settings" title="User cache and password hash algorithms">User cache and password hash algorithms</a>.</p>
<p>The user cache will be emptied upon node restart, so any existing
hashes using non-compliant algorithms will be discarded and the new
ones will be created using the algorithm you have selected.</p>
<h4><a id="configuring-es-yml"></a>Configure Elasticsearch elasticsearch.yml<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/security/fips-140-compliance.asciidoc">edit</a></h4>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Set <code class="literal">xpack.security.fips_mode.enabled</code> to <code class="literal">true</code> in <code class="literal">elasticsearch.yml</code>. This setting is used to ensure to configure some internal
configuration to be FIPS 140-2 compliant and provides some additional verification.
</li>
<li class="listitem">
Set <code class="literal">xpack.security.autoconfiguration.enabled</code> to <code class="literal">false</code>. This will disable the automatic configuration of the security settings.
Users must ensure that the security settings are configured correctly for FIPS-140-2 compliance. This is only applicable for new installations.
</li>
<li class="listitem">
Set <code class="literal">xpack.security.authc.password_hashing.algorithm</code> appropriately see <a class="xref" href="fips-140-compliance.html#fips-stored-password-hashing">above</a>.
</li>
<li class="listitem">
Other relevant security settings. For example, TLS for the transport and HTTP interfaces. (not explicitly covered here or in the example below)
</li>
<li class="listitem">
Optional: Set <code class="literal">xpack.security.fips_mode.required_providers</code> in <code class="literal">elasticsearch.yml</code> to ensure the required security providers (8.13+).
see <a class="xref" href="fips-140-compliance.html#verify-security-provider" title="Verify the security provider is installed">below</a>.
</li>
</ul>
</div>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">xpack.security.fips_mode.enabled: true
xpack.security.autoconfiguration.enabled: false
xpack.security.fips_mode.required_providers: ["BCFIPS", "BCJSSE"]
xpack.security.authc.password_hashing.algorithm: "pbkdf2_stretch"</pre>
</div>
<h4><a id="verify-security-provider"></a>Verify the security provider is installed<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/security/fips-140-compliance.asciidoc">edit</a></h4>
<p>To verify that the security provider is installed and in use, you can use any of the following steps:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Verify the required security providers are configured with the lowest order in the file pointed to by <code class="literal">java.security.properties</code>.
For example, <code class="literal">security.provider.1</code> is a lower order than <code class="literal">security.provider.2</code>
</li>
<li class="listitem">
Set <code class="literal">xpack.security.fips_mode.required_providers</code> in <code class="literal">elasticsearch.yml</code> to the list of required security providers.
This setting is used to ensure that the correct security provider is installed and configured. (8.13+)
If the security provider is not installed correctly, Elasticsearch will fail to start. <code class="literal">["BCFIPS", "BCJSSE"]</code> are the values to
use for Bouncy Castle&#8217;s FIPS JCE and JSSE certified provider.
</li>
</ul>
</div>
<h3><a id="fips-upgrade-considerations"></a>Upgrade considerations<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/security/fips-140-compliance.asciidoc">edit</a></h3>
<p>Elasticsearch 8.0+ requires Java 17 or later. Elasticsearch 8.13+ has been tested with <a href="https://www.bouncycastle.org/java.html" class="ulink" target="_top">Bouncy Castle</a>'s Java 17
<a href="https://csrc.nist.gov/projects/cryptographic-module-validation-program/certificate/4616" class="ulink" target="_top">certified</a> FIPS implementation and is the
recommended Java security provider when running Elasticsearch in FIPS 140-2 mode.
Note - Elasticsearch does not ship with a FIPS certified security provider and requires explicit installation and configuration.</p>
<p>Alternatively, consider using Elasticsearch Service in the
<a href="/industries/public-sector/fedramp" class="ulink" target="_top">FedRAMP-certified GovCloud region</a>.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Some encryption algorithms may no longer be available by default in updated FIPS 140-2 security providers.
Notably, Triple DES and PKCS1.5 RSA are now discouraged and <a href="https://www.bouncycastle.org/fips-java" class="ulink" target="_top">Bouncy Castle</a> now
requires explicit configuration to continue using these algorithms.</p>
</div>
</div>
<p>If you plan to upgrade your existing cluster to a version that can be run in
a FIPS 140-2 configured JVM, we recommend to first perform a rolling
upgrade to the new version in your existing JVM and perform all necessary
configuration changes in preparation for running in FIPS 140-2 mode. You can then
perform a rolling restart of the nodes, starting each node in a FIPS 140-2 JVM.
During the restart, Elasticsearch:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Upgrades <a class="xref" href="secure-settings.html" title="Secure settings">secure settings</a> to the latest, compliant format.
A FIPS 140-2 JVM cannot load previous format versions. If your keystore is
not password-protected, you must manually set a password. See
<a class="xref" href="fips-140-compliance.html#keystore-fips-password" title="Elasticsearch Keystore">Elasticsearch Keystore</a>.
</li>
<li class="listitem">
Upgrades self-generated trial licenses to the latest FIPS 140-2 compliant format.
</li>
</ul>
</div>
<p>If your <a href="/subscriptions" class="ulink" target="_top">subscription</a> already supports FIPS 140-2 mode, you
can elect to perform a rolling upgrade while at the same time running each
upgraded node in a FIPS 140-2 JVM. In this case, you would need to also manually
regenerate your <code class="literal">elasticsearch.keystore</code> and migrate all secure settings to it,
in addition to the necessary configuration changes outlined below, before
starting each node.</p>
<h3><a id="fips-limitations"></a>Limitations<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/security/fips-140-compliance.asciidoc">edit</a></h3>
<p>Due to the limitations that FIPS 140-2 compliance enforces, a small number of
features are not available while running in FIPS 140-2 mode. The list is as follows:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Azure Classic Discovery Plugin
</li>
<li class="listitem">
The <a class="xref" href="certutil.html" title="elasticsearch-certutil"><code class="literal">elasticsearch-certutil</code></a> tool. However,
<code class="literal">elasticsearch-certutil</code> can very well be used in a non FIPS 140-2
 configured JVM (pointing <code class="literal">ES_JAVA_HOME</code> environment variable to a different
 java installation) in order to generate the keys and certificates that
 can be later used in the FIPS 140-2 configured JVM.
</li>
<li class="listitem">
The SQL CLI client cannot run in a FIPS 140-2 configured JVM while using
TLS for transport security or PKI for client authentication.
</li>
</ul>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="security-files.html">« Security files</a>
</span>
<span class="next">
<a href="update-node-certs.html">Updating node security certificates »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>

                        <!-- Feedback widget -->
                        <div id="feedbackWidgetContainer"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


        <div id='elastic-footer'></div>
        <script src='https://www.elastic.co/elastic-footer.js'></script>
        <!-- Footer Section end-->

      </section>
    </div>

    <!-- Feedback modal -->
    <div id="feedbackModalContainer"></div>

    <script src="/guide/static/jquery.js"></script>
    <script type="text/javascript" src="/guide/static/docs.js"></script>
    <script type="text/javascript">
  window.initial_state = {"alternatives":{"console":{"php":{"hasAny":true},"python":{"hasAny":true},"ruby":{"hasAny":true},"go":{"hasAny":true},"js":{"hasAny":true}}}}</script>
  </body>
</html>
