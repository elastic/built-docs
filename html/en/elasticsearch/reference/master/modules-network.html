<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Networking | Elasticsearch Guide [master] | Elastic</title>
<meta class="elastic" name="content" content="Networking | Elasticsearch Guide [master]">

<link rel="home" href="index.html" title="Elasticsearch Guide [master]"/>
<link rel="up" href="settings.html" title="Configuring Elasticsearch"/>
<link rel="prev" href="modules-node.html" title="Nodes"/>
<link rel="next" href="query-cache.html" title="Node query cache settings"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="Elasticsearch"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/master"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="master"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles-v1.css" />
  </head>

  <!--© 2015-2025 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div class="page_header">
This documentation contains work-in-progress information for future Elastic Stack and Cloud releases. Use the version selector to view supported release docs. It also contains some Elastic Cloud serverless information. Check out our <a href="https://www.elastic.co/docs/current/serverless">serverless docs</a> for more details.
</div>
<div class="navheader">
<span class="prev">
<a href="modules-node.html">« Nodes</a>
</span>
<span class="next">
<a href="query-cache.html">Node query cache settings »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elasticsearch Guide [master]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="setup.html">Set up Elasticsearch</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="settings.html">Configuring Elasticsearch</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Networking</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/modules/network.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="modules-network"></a>Networking<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/modules/network.asciidoc">edit</a></h2>
</div></div></div>
<p>Each Elasticsearch node has two different network interfaces. Clients send requests to
Elasticsearch&#8217;s REST APIs using its <a class="xref" href="modules-network.html#http-settings" title="Advanced HTTP settings">HTTP interface</a>, but nodes
communicate with other nodes using the <a class="xref" href="modules-network.html#transport-settings" title="Advanced transport settings">transport
interface</a>. The transport interface is also used for communication with
<a class="xref" href="remote-clusters.html" title="Remote clusters">remote clusters</a>.</p>
<p>You can configure both of these interfaces at the same time using the
<code class="literal">network.*</code> settings. If you have a more complicated network, you might need to
configure the interfaces independently using the <code class="literal">http.*</code> and <code class="literal">transport.*</code>
settings. Where possible, use the <code class="literal">network.*</code> settings that apply to both
interfaces to simplify your configuration and reduce duplication.</p>
<p>By default Elasticsearch binds only to <code class="literal">localhost</code> which means it cannot be accessed
remotely. This configuration is sufficient for a local development cluster made
of one or more nodes all running on the same host. To form a cluster across
multiple hosts, or which is accessible to remote clients, you must adjust some
<a class="xref" href="modules-network.html#common-network-settings" title="Commonly used network settings">network settings</a> such as <code class="literal">network.host</code>.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<h3>Be careful with the network configuration!</h3>
<p>Never expose an unprotected node to the public internet. If you do, you are
permitting anyone in the world to download, modify, or delete any of the data
in your cluster.</p>
</div>
</div>
<p>Configuring Elasticsearch to bind to a non-local address will <a class="xref" href="system-config.html#dev-vs-prod" title="Development mode vs production mode">convert some
warnings into fatal exceptions</a>. If a node refuses to start after configuring
its network settings then you must address the logged exceptions before
proceeding.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="common-network-settings"></a>Commonly used network settings<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/modules/network.asciidoc">edit</a></h3>
</div></div></div>
<p>Most users will need to configure only the following network settings.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">network.host</code>
</span>
</dt>
<dd>
<p>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, string)
Sets the address of this node for both HTTP and transport traffic. The node
will bind to this address and will also use it as its publish address. Accepts
an IP address, a hostname, or a <a class="xref" href="modules-network.html#network-interface-values" title="Special values for network addresses">special value</a>.
</p>
<p>Defaults to <code class="literal">_local_</code>. However, note that <a class="xref" href="configuring-stack-security.html" title="Start the Elastic Stack with security enabled automatically">security
auto-configuration</a> will add <code class="literal">http.host: 0.0.0.0</code> to your <code class="literal">elasticsearch.yml</code>
configuration file, which overrides this default for HTTP traffic.</p>
</dd>
<dt>
<span class="term">
<code class="literal">http.port</code>
</span>
</dt>
<dd>
<p>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, integer)
The port to bind for HTTP client communication. Accepts a single value or a
range. If a range is specified, the node will bind to the first available port
in the range.
</p>
<p>Defaults to <code class="literal">9200-9300</code>.</p>
</dd>
<dt>
<span class="term">
<code class="literal">transport.port</code>
</span>
</dt>
<dd>
<p>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, integer)
The port to bind for communication between nodes. Accepts a single value or a
range. If a range is specified, the node will bind to the first available port
in the range. Set this setting to a single port, not a range, on every
master-eligible node.
</p>
<p>Defaults to <code class="literal">9300-9400</code>.</p>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="remote_cluster.port"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">remote_cluster.port</code>
</span>
</dt>
<dd>
<p>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, integer)
The port to bind for remote cluster client communication. Accepts a single value.
</p>
<p>Defaults to <code class="literal">9443</code>.</p>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="network-interface-values"></a>Special values for network addresses<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/modules/network.asciidoc">edit</a></h3>
</div></div></div>
<p>You can configure Elasticsearch to automatically determine its addresses by using the
following special values. Use these values when configuring
<code class="literal">network.host</code>, <code class="literal">network.bind_host</code>, <code class="literal">network.publish_host</code>, and the
corresponding settings for the HTTP and transport interfaces.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">_local_</code>
</span>
</dt>
<dd>
Any loopback addresses on the system, for example <code class="literal">127.0.0.1</code>.
</dd>
<dt>
<span class="term">
<code class="literal">_site_</code>
</span>
</dt>
<dd>
Any site-local addresses on the system, for example <code class="literal">192.168.0.1</code>.
</dd>
<dt>
<span class="term">
<code class="literal">_global_</code>
</span>
</dt>
<dd>
Any globally-scoped addresses on the system, for example <code class="literal">8.8.8.8</code>.
</dd>
<dt>
<span class="term">
<code class="literal">_[networkInterface]_</code>
</span>
</dt>
<dd>
Use the addresses of the network interface called <code class="literal">[networkInterface]</code>. For
example if you wish to use the addresses of an interface called <code class="literal">en0</code> then
set <code class="literal">network.host: _en0_</code>.
</dd>
<dt>
<span class="term">
<code class="literal">0.0.0.0</code>
</span>
</dt>
<dd>
The addresses of all available network interfaces.
</dd>
</dl>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>In some systems these special values resolve to multiple addresses. If
so, Elasticsearch will select one of them as its publish address and may change its
selection on each node restart. Ensure your node is accessible at every possible
address.</p>
</div>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Any values containing a <code class="literal">:</code> (e.g. an IPv6 address or some of the
<a class="xref" href="modules-network.html#network-interface-values" title="Special values for network addresses">special values</a>) must be quoted because <code class="literal">:</code> is a
special character in YAML.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="network-interface-values-ipv4-vs-ipv6"></a>IPv4 vs IPv6<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/modules/network.asciidoc">edit</a></h4>
</div></div></div>
<p>These special values yield both IPv4 and IPv6 addresses by default, but you can
also add an <code class="literal">:ipv4</code> or <code class="literal">:ipv6</code> suffix to limit them to just IPv4 or IPv6
addresses respectively. For example, <code class="literal">network.host: "_en0:ipv4_"</code> would set this
node&#8217;s addresses to the IPv4 addresses of interface <code class="literal">en0</code>.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<h3>Discovery in the Cloud</h3>
<p>More special settings are available when running in the Cloud with either the
<a href="/guide/en/elasticsearch/plugins/master/discovery-ec2.html" class="ulink" target="_top">EC2 discovery plugin</a> or the
<a href="/guide/en/elasticsearch/plugins/master/discovery-gce-network-host.html#discovery-gce-network-host" class="ulink" target="_top">Google Compute Engine discovery plugin</a>
installed.</p>
</div>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="modules-network-binding-publishing"></a>Binding and publishing<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/modules/network.asciidoc">edit</a></h3>
</div></div></div>
<p>Elasticsearch uses network addresses for two distinct purposes known as binding and
publishing. Most nodes will use the same address for everything, but more
complicated setups may need to configure different addresses for different
purposes.</p>
<p>When an application such as Elasticsearch wishes to receive network communications, it
must indicate to the operating system the address or addresses whose traffic it
should receive. This is known as <em>binding</em> to those addresses. Elasticsearch can bind to
more than one address if needed, but most nodes only bind to a single address.
Elasticsearch can only bind to an address if it is running on a host that has a network
interface with that address. If necessary, you can configure the transport and
HTTP interfaces to bind to different addresses.</p>
<p>Each Elasticsearch node has an address at which clients and other nodes can contact it,
known as its <em>publish address</em>. Each node has one publish address for its HTTP
interface and one for its transport interface. These two addresses can be
anything, and don&#8217;t need to be addresses of the network interfaces on the host.
The only requirements are that each node must be:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Accessible at its HTTP publish address by all clients that will discover it
using sniffing.
</li>
<li class="listitem">
Accessible at its transport publish address by all other nodes in its
cluster, and by any remote clusters that will discover it using
<a class="xref" href="remote-clusters.html#sniff-mode">Remote clusters</a>.
</li>
</ul>
</div>
<p>Each node must have its own distinct publish address.</p>
<p>If you specify the transport publish address using a hostname then Elasticsearch will
resolve this hostname to an IP address once during startup, and other nodes
will use the resulting IP address instead of resolving the name again
themselves. To avoid confusion, use a hostname which resolves to the node&#8217;s
address in all network locations.</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_using_a_single_address"></a>Using a single address<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/modules/network.asciidoc">edit</a></h4>
</div></div></div>
<p>The most common configuration is for Elasticsearch to bind to a single address at which
it is accessible to clients and other nodes. In this configuration you should
just set <code class="literal">network.host</code> to that address. You should not separately set any bind
or publish addresses, nor should you separately configure the addresses for the
HTTP or transport interfaces.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_using_multiple_addresses"></a>Using multiple addresses<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/modules/network.asciidoc">edit</a></h4>
</div></div></div>
<p>Use the <a class="xref" href="modules-network.html#advanced-network-settings" title="Advanced network settings">advanced network settings</a> if you wish to
bind Elasticsearch to multiple addresses, or to publish a different address from the
addresses to which you are binding. Set <code class="literal">network.bind_host</code> to the bind
addresses, and <code class="literal">network.publish_host</code> to the address at which this node is
exposed. In complex configurations, you can configure these addresses
differently for the HTTP and transport interfaces.</p>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="advanced-network-settings"></a>Advanced network settings<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/modules/network.asciidoc">edit</a></h3>
</div></div></div>
<p>These advanced settings let you bind to multiple addresses, or to use different
addresses for binding and publishing. They are not required in most cases and
you should not use them if you can use the <a class="xref" href="modules-network.html#common-network-settings" title="Commonly used network settings">commonly
used settings</a> instead.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">network.bind_host</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, string)
The network address(es) to which the node should bind in order to listen for
incoming connections. Accepts a list of IP addresses, hostnames, and
<a class="xref" href="modules-network.html#network-interface-values" title="Special values for network addresses">special values</a>. Defaults to the address given by
<code class="literal">network.host</code>. Use this setting only if binding to multiple addresses or using
different addresses for publishing and binding.
</dd>
<dt>
<span class="term">
<code class="literal">network.publish_host</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, string)
The network address that clients and other nodes can use to contact this node.
Accepts an IP address, a hostname, or a <a class="xref" href="modules-network.html#network-interface-values" title="Special values for network addresses">special
value</a>. Defaults to the address given by <code class="literal">network.host</code>. Use this setting only
if binding to multiple addresses or using different addresses for publishing
and binding.
</dd>
</dl>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>You can specify a list of addresses for <code class="literal">network.host</code> and
<code class="literal">network.publish_host</code>. You can also specify one or more hostnames or
<a class="xref" href="modules-network.html#network-interface-values" title="Special values for network addresses">special values</a> that resolve to multiple addresses.
If you do this then Elasticsearch chooses one of the addresses for its publish address.
This choice uses heuristics based on IPv4/IPv6 stack preference and
reachability and may change when the node restarts. Ensure
each node is accessible at all possible publish addresses.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="tcp-settings"></a>Advanced TCP settings<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/modules/network.asciidoc">edit</a></h4>
</div></div></div>
<p>Use the following settings to control the low-level parameters of the TCP
connections used by the HTTP and transport interfaces.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">network.tcp.keep_alive</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, boolean)
Configures the <code class="literal">SO_KEEPALIVE</code> option for network sockets, which determines
whether each connection sends TCP keepalive probes. Defaults to <code class="literal">true</code>.
</dd>
<dt>
<span class="term">
<code class="literal">network.tcp.keep_idle</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, integer)
Configures the <code class="literal">TCP_KEEPIDLE</code> option for network sockets, which determines the
time in seconds that a connection must be idle before starting to send TCP
keepalive probes. Defaults to <code class="literal">-1</code>, which means to use the system default. This
value cannot exceed <code class="literal">300</code> seconds. Only applicable on Linux and macOS.
</dd>
<dt>
<span class="term">
<code class="literal">network.tcp.keep_interval</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, integer)
Configures the <code class="literal">TCP_KEEPINTVL</code> option for network sockets, which determines the
time in seconds between sending TCP keepalive probes. Defaults to <code class="literal">-1</code>, which
means to use the system default. This value cannot exceed <code class="literal">300</code> seconds. Only
applicable on Linux and macOS.
</dd>
<dt>
<span class="term">
<code class="literal">network.tcp.keep_count</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, integer)
Configures the <code class="literal">TCP_KEEPCNT</code> option for network sockets, which determines the
number of unacknowledged TCP keepalive probes that may be sent on a connection
before it is dropped. Defaults to <code class="literal">-1</code>, which means to use the system default.
Only applicable on Linux and macOS.
</dd>
<dt>
<span class="term">
<code class="literal">network.tcp.no_delay</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, boolean)
Configures the <code class="literal">TCP_NODELAY</code> option on network sockets, which determines
whether <a href="https://en.wikipedia.org/wiki/Nagle%27s_algorithm" class="ulink" target="_top">TCP no delay</a> is enabled. Defaults to
<code class="literal">true</code>.
</dd>
<dt>
<span class="term">
<code class="literal">network.tcp.reuse_address</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, boolean)
Configures the <code class="literal">SO_REUSEADDR</code> option for network sockets, which determines
whether the address can be reused or not. Defaults to <code class="literal">false</code> on Windows and
<code class="literal">true</code> otherwise.
</dd>
<dt>
<span class="term">
<code class="literal">network.tcp.send_buffer_size</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, <a class="xref" href="api-conventions.html#byte-units" title="Byte size units">byte value</a>)
Configures the size of the TCP send buffer for network sockets. Defaults to
<code class="literal">-1</code> which means to use the system default.
</dd>
<dt>
<span class="term">
<code class="literal">network.tcp.receive_buffer_size</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, <a class="xref" href="api-conventions.html#byte-units" title="Byte size units">byte value</a>)
Configures the size of the TCP receive buffer. Defaults to <code class="literal">-1</code> which means to
use the system default.
</dd>
</dl>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="http-settings"></a>Advanced HTTP settings<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/modules/http.asciidoc">edit</a></h3>
</div></div></div>
<p>Use the following advanced settings to configure the HTTP interface
independently of the <a class="xref" href="modules-network.html#transport-settings" title="Advanced transport settings">transport interface</a>. You can also
configure both interfaces together using the <a class="xref" href="modules-network.html#common-network-settings" title="Commonly used network settings">network settings</a>.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">http.host</code>
</span>
</dt>
<dd>
<p>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, string)
Sets the address of this node for HTTP traffic. The node will bind to this
address and will also use it as its HTTP publish address. Accepts an IP
address, a hostname, or a <a class="xref" href="modules-network.html#network-interface-values" title="Special values for network addresses">special value</a>.
Use this setting only if you require different configurations for the
transport and HTTP interfaces.
</p>
<p>Defaults to the address given by <code class="literal">network.host</code>. However, note that
<a class="xref" href="configuring-stack-security.html" title="Start the Elastic Stack with security enabled automatically">security auto-configuration</a> will add
<code class="literal">http.host: 0.0.0.0</code> to your <code class="literal">elasticsearch.yml</code> configuration file, which
overrides this default.</p>
</dd>
<dt>
<span class="term">
<code class="literal">http.bind_host</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, string)
The network address(es) to which the node should bind in order to listen for
incoming HTTP connections. Accepts a list of IP addresses, hostnames, and
<a class="xref" href="modules-network.html#network-interface-values" title="Special values for network addresses">special values</a>. Defaults to the address given by
<code class="literal">http.host</code> or <code class="literal">network.bind_host</code>. Use this setting only if you require to
bind to multiple addresses or to use different addresses for publishing and
binding, and you also require different binding configurations for the
transport and HTTP interfaces.
</dd>
<dt>
<span class="term">
<code class="literal">http.publish_host</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, string)
The network address for HTTP clients to contact the node using sniffing.
Accepts an IP address, a hostname, or a <a class="xref" href="modules-network.html#network-interface-values" title="Special values for network addresses">special
value</a>. Defaults to the address given by <code class="literal">http.host</code> or
<code class="literal">network.publish_host</code>. Use this setting only if you require to bind to
multiple addresses or to use different addresses for publishing and binding,
and you also require different binding configurations for the transport and
HTTP interfaces.
</dd>
<dt>
<span class="term">
<code class="literal">http.publish_port</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, integer)
The port of the <a class="xref" href="modules-network.html#modules-network-binding-publishing" title="Binding and publishing">HTTP publish address</a>.
Configure this setting only if you need the publish port to be different from
<code class="literal">http.port</code>. Defaults to the port assigned via <code class="literal">http.port</code>.
</dd>
<dt>
<span class="term">
<code class="literal">http.max_content_length</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, <a class="xref" href="api-conventions.html#byte-units" title="Byte size units">byte value</a>)
Maximum size of an HTTP request body. If the body is compressed, the limit applies
to the HTTP request body size before compression. Defaults to <code class="literal">100mb</code>. Configuring
this setting to greater than <code class="literal">100mb</code> can cause cluster instability and is not
recommended. If you hit this limit when sending a request to the <a class="xref" href="docs-bulk.html" title="Bulk API">Bulk</a>
API, configure your client to send fewer documents in each bulk request. If you
wish to index individual documents that exceed <code class="literal">100mb</code>, pre-process them into
smaller documents before sending them to Elasticsearch. For instance, store the raw data
in a system outside Elasticsearch and include a link to the raw data in the documents
that Elasticsearch indexes.
</dd>
<dt>
<span class="term">
<code class="literal">http.max_initial_line_length</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, <a class="xref" href="api-conventions.html#byte-units" title="Byte size units">byte value</a>)
Maximum size of an HTTP URL. Defaults to <code class="literal">4kb</code>.
</dd>
<dt>
<span class="term">
<code class="literal">http.max_header_size</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, <a class="xref" href="api-conventions.html#byte-units" title="Byte size units">byte value</a>)
Maximum size of allowed headers. Defaults to <code class="literal">16kb</code>.
</dd>
</dl>
</div>
<div class="variablelist">
<a id="http-compression"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">http.compression</code> <span class="image"><a class="image" href="https://www.elastic.co/cloud/elasticsearch-service/signup?page=docs&amp;placement=docs-body"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/logo_cloud.svg" alt="logo cloud" title="Supported on Elasticsearch Service"></a></span>
</span>
</dt>
<dd>
<p>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, boolean)
Support for compression when possible (with Accept-Encoding). If HTTPS is enabled, defaults to <code class="literal">false</code>. Otherwise, defaults to <code class="literal">true</code>.
</p>
<p>Disabling compression for HTTPS mitigates potential security risks, such as a
<a href="https://en.wikipedia.org/wiki/BREACH" class="ulink" target="_top">BREACH attack</a>. To compress HTTPS traffic,
you must explicitly set <code class="literal">http.compression</code> to <code class="literal">true</code>.</p>
</dd>
<dt>
<span class="term">
<code class="literal">http.compression_level</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, integer)
Defines the compression level to use for HTTP responses. Valid values are in the range of 1 (minimum compression) and 9 (maximum compression). Defaults to <code class="literal">3</code>.
</dd>
</dl>
</div>
<div class="variablelist">
<a id="http-cors-enabled"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">http.cors.enabled</code> <span class="image"><a class="image" href="https://www.elastic.co/cloud/elasticsearch-service/signup?page=docs&amp;placement=docs-body"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/logo_cloud.svg" alt="logo cloud" title="Supported on Elasticsearch Service"></a></span>
</span>
</dt>
<dd>
<p>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, boolean)
Enable or disable cross-origin resource sharing, which determines whether a browser on another origin can execute requests against Elasticsearch. Set to <code class="literal">true</code> to enable Elasticsearch to process pre-flight
<a href="https://en.wikipedia.org/wiki/Cross-origin_resource_sharing" class="ulink" target="_top">CORS</a> requests.
Elasticsearch will respond to those requests with the <code class="literal">Access-Control-Allow-Origin</code> header if the <code class="literal">Origin</code> sent in the request is permitted by the <code class="literal">http.cors.allow-origin</code> list. Set to <code class="literal">false</code> (the default) to make Elasticsearch ignore the <code class="literal">Origin</code> request header, effectively disabling CORS requests because Elasticsearch will never respond with the <code class="literal">Access-Control-Allow-Origin</code> response header.
</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>If the client does not send a pre-flight request with an <code class="literal">Origin</code> header or it does not check the response headers from the server to validate the
<code class="literal">Access-Control-Allow-Origin</code> response header, then cross-origin security is
compromised. If CORS is not enabled on Elasticsearch, the only way for the client to know is to send a pre-flight request and realize the required response headers are missing.</p>
</div>
</div>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="http-cors-allow-origin"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">http.cors.allow-origin</code> <span class="image"><a class="image" href="https://www.elastic.co/cloud/elasticsearch-service/signup?page=docs&amp;placement=docs-body"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/logo_cloud.svg" alt="logo cloud" title="Supported on Elasticsearch Service"></a></span>
</span>
</dt>
<dd>
<p>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, string)
Which origins to allow. If you prepend and append a forward slash (<code class="literal">/</code>) to the value, this will be treated as a regular expression, allowing you to support HTTP and HTTPs. For example, using <code class="literal">/https?:\/\/localhost(:[0-9]+)?/</code> would return the request header appropriately in both cases. Defaults to no origins allowed.
</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>A wildcard (<code class="literal">*</code>) is a valid value but is considered a security risk, as your Elasticsearch instance is open to cross origin requests from <span class="strong strong"><strong>anywhere</strong></span>.</p>
</div>
</div>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="http-cors-max-age"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">http.cors.max-age</code> <span class="image"><a class="image" href="https://www.elastic.co/cloud/elasticsearch-service/signup?page=docs&amp;placement=docs-body"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/logo_cloud.svg" alt="logo cloud" title="Supported on Elasticsearch Service"></a></span>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, integer)
Browsers send a "preflight" OPTIONS-request to determine CORS settings.
<code class="literal">max-age</code> defines for how long, in seconds, the result should be cached.
Defaults to <code class="literal">1728000</code> (20 days).
</dd>
</dl>
</div>
<div class="variablelist">
<a id="http-cors-allow-methods"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">http.cors.allow-methods</code> <span class="image"><a class="image" href="https://www.elastic.co/cloud/elasticsearch-service/signup?page=docs&amp;placement=docs-body"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/logo_cloud.svg" alt="logo cloud" title="Supported on Elasticsearch Service"></a></span>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, string)
Which methods to allow. Defaults to <code class="literal">OPTIONS, HEAD, GET, POST, PUT, DELETE</code>.
</dd>
</dl>
</div>
<div class="variablelist">
<a id="http-cors-allow-headers"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">http.cors.allow-headers</code> <span class="image"><a class="image" href="https://www.elastic.co/cloud/elasticsearch-service/signup?page=docs&amp;placement=docs-body"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/logo_cloud.svg" alt="logo cloud" title="Supported on Elasticsearch Service"></a></span>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, string)
Which headers to allow. Defaults to <code class="literal">X-Requested-With, Content-Type, Content-Length, Authorization, Accept, User-Agent, X-Elastic-Client-Meta</code>.
</dd>
</dl>
</div>
<div class="variablelist">
<a id="http-cors-expose-headers"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">http.cors.expose-headers</code> <span class="image"><a class="image" href="https://www.elastic.co/cloud/elasticsearch-service/signup?page=docs&amp;placement=docs-body"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/logo_cloud.svg" alt="logo cloud" title="Supported on Elasticsearch Service"></a></span>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>)
Which response headers to expose in the client. Defaults to <code class="literal">X-elastic-product</code>.
</dd>
</dl>
</div>
<div class="variablelist">
<a id="http-cors-allow-credentials"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">http.cors.allow-credentials</code> <span class="image"><a class="image" href="https://www.elastic.co/cloud/elasticsearch-service/signup?page=docs&amp;placement=docs-body"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/logo_cloud.svg" alt="logo cloud" title="Supported on Elasticsearch Service"></a></span>
</span>
</dt>
<dd>
<p>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, boolean)
Whether the <code class="literal">Access-Control-Allow-Credentials</code> header should be returned. Defaults to <code class="literal">false</code>.
</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This header is only returned when the setting is set to <code class="literal">true</code>.</p>
</div>
</div>
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">http.detailed_errors.enabled</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, boolean)
Configures whether detailed error reporting in HTTP responses is enabled.
Defaults to <code class="literal">true</code>, which means that HTTP requests that include the
<a class="xref" href="common-options.html#common-options-error-options" title="Enabling stack traces"><code class="literal">?error_trace</code> parameter</a> will return a
detailed error message including a stack trace if they encounter an exception.
If set to <code class="literal">false</code>, requests with the <code class="literal">?error_trace</code> parameter are rejected.
</dd>
<dt>
<span class="term">
<code class="literal">http.pipelining.max_events</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, integer)
The maximum number of events to be queued up in memory before an HTTP connection is closed, defaults to <code class="literal">10000</code>.
</dd>
<dt>
<span class="term">
<code class="literal">http.max_warning_header_count</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, integer)
The maximum number of warning headers in client HTTP responses. Defaults to
<code class="literal">-1</code> which means the number of warning headers is unlimited.
</dd>
<dt>
<span class="term">
<code class="literal">http.max_warning_header_size</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, <a class="xref" href="api-conventions.html#byte-units" title="Byte size units">byte value</a>)
The maximum total size of warning headers in client HTTP responses. Defaults to
<code class="literal">-1</code> which means the size of the warning headers is unlimited.
</dd>
<dt>
<span class="term">
<code class="literal">http.tcp.keep_alive</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, boolean)
Configures the <code class="literal">SO_KEEPALIVE</code> option for this socket, which determines whether
it sends TCP keepalive probes. Defaults to <code class="literal">network.tcp.keep_alive</code>.
</dd>
<dt>
<span class="term">
<code class="literal">http.tcp.keep_idle</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, integer)
Configures the <code class="literal">TCP_KEEPIDLE</code> option for HTTP sockets, which determines the
time in seconds that a connection must be idle before starting to send TCP
keepalive probes. Defaults to <code class="literal">network.tcp.keep_idle</code>, which uses the system
default. This value cannot exceed <code class="literal">300</code> seconds. Only applicable on Linux and
macOS.
</dd>
<dt>
<span class="term">
<code class="literal">http.tcp.keep_interval</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, integer)
Configures the <code class="literal">TCP_KEEPINTVL</code> option for HTTP sockets, which determines the
time in seconds between sending TCP keepalive probes. Defaults to
<code class="literal">network.tcp.keep_interval</code>, which uses the system default. This value cannot
exceed <code class="literal">300</code> seconds. Only applicable on Linux and macOS.
</dd>
<dt>
<span class="term">
<code class="literal">http.tcp.keep_count</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, integer)
Configures the <code class="literal">TCP_KEEPCNT</code> option for HTTP sockets, which determines the
number of unacknowledged TCP keepalive probes that may be sent on a connection
before it is dropped. Defaults to <code class="literal">network.tcp.keep_count</code>, which uses the
system default. Only applicable on Linux and macOS.
</dd>
<dt>
<span class="term">
<code class="literal">http.tcp.no_delay</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, boolean)
Configures the <code class="literal">TCP_NODELAY</code> option on HTTP sockets, which determines whether
<a href="https://en.wikipedia.org/wiki/Nagle%27s_algorithm" class="ulink" target="_top">TCP no delay</a> is enabled. Defaults to <code class="literal">true</code>.
</dd>
<dt>
<span class="term">
<code class="literal">http.tcp.reuse_address</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, boolean)
Configures the <code class="literal">SO_REUSEADDR</code> option for HTTP sockets, which determines whether
the address can be reused or not. Defaults to <code class="literal">false</code> on Windows and <code class="literal">true</code>
otherwise.
</dd>
<dt>
<span class="term">
<code class="literal">http.tcp.send_buffer_size</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, <a class="xref" href="api-conventions.html#byte-units" title="Byte size units">byte value</a>)
The size of the TCP send buffer for HTTP traffic. Defaults to
<code class="literal">network.tcp.send_buffer_size</code>.
</dd>
<dt>
<span class="term">
<code class="literal">http.tcp.receive_buffer_size</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, <a class="xref" href="api-conventions.html#byte-units" title="Byte size units">byte value</a>)
The size of the TCP receive buffer for HTTP traffic. Defaults to
<code class="literal">network.tcp.receive_buffer_size</code>.
</dd>
<dt>
<span class="term">
<code class="literal">http.client_stats.enabled</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#dynamic-cluster-setting">Dynamic</a>, boolean)
Enable or disable collection of HTTP client stats. Defaults to <code class="literal">true</code>.
</dd>
<dt>
<span class="term">
<code class="literal">http.client_stats.closed_channels.max_count</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, integer)
When <code class="literal">http.client_stats.enabled</code> is <code class="literal">true</code>, sets the maximum number of closed
HTTP channels for which Elasticsearch reports statistics. Defaults to <code class="literal">10000</code>.
</dd>
<dt>
<span class="term">
<code class="literal">http.client_stats.closed_channels.max_age</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, <a class="xref" href="api-conventions.html#time-units" title="Time units">time value</a>)
When <code class="literal">http.client_stats.enabled</code> is <code class="literal">true</code>, sets the maximum length of time
after closing a HTTP channel that Elasticsearch will report that channel&#8217;s statistics.
Defaults to <code class="literal">5m</code>.
</dd>
</dl>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_http_client_configuration"></a>HTTP client configuration<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/modules/http.asciidoc">edit</a></h4>
</div></div></div>
<p>Many HTTP clients and proxies are configured for browser-like response latency
and impose a fairly short timeout by default, reporting a failure if Elasticsearch takes
longer than this timeout to complete the processing of a request. Elasticsearch will
always eventually respond to every request, but some requests may require many
minutes of processing time to complete. Consider carefully whether your
client&#8217;s default response timeout is appropriate for your needs. In many cases
it is better to wait longer for a response instead of failing, and this means
you should disable any response timeouts:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If you react to a timeout by retrying the request, the retry will often end
up being placed at the back of the same queue which held the original request.
It will therefore take longer to complete the processing of the request if you
time out and retry instead of waiting more patiently. Retrying also imposes
additional load on Elasticsearch.
</li>
<li class="listitem">
If a request is not idempotent and cannot be retried then failing the request
is your last resort. Waiting more patiently for a response will usually allow
the overall operation to succeed.
</li>
</ul>
</div>
<p>If you disable the response timeout in your client, make sure to configure TCP
keepalives instead. TCP keepalives are the recommended way to prevent a client
from waiting indefinitely in the event of a network outage.</p>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="transport-settings"></a>Advanced transport settings<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/modules/transport.asciidoc">edit</a></h3>
</div></div></div>
<p>Use the following advanced settings to configure the transport interface
independently of the <a class="xref" href="modules-network.html#http-settings" title="Advanced HTTP settings">HTTP interface</a>. Use the
<a class="xref" href="modules-network.html#common-network-settings" title="Commonly used network settings">network
settings</a> to configure both interfaces together.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">transport.host</code>
</span>
</dt>
<dd>
<p>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, string)
Sets the address of this node for transport traffic. The node will bind to this
address and will also use it as its transport publish address. Accepts an IP
address, a hostname, or a <a class="xref" href="modules-network.html#network-interface-values" title="Special values for network addresses">special value</a>.
Use this setting only if you require different configurations for the
transport and HTTP interfaces.
</p>
<p>Defaults to the address given by <code class="literal">network.host</code>.</p>
</dd>
<dt>
<span class="term">
<code class="literal">transport.bind_host</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, string)
The network address(es) to which the node should bind in order to listen for
incoming transport connections. Accepts a list of IP addresses, hostnames, and
<a class="xref" href="modules-network.html#network-interface-values" title="Special values for network addresses">special values</a>. Defaults to the address given by
<code class="literal">transport.host</code> or <code class="literal">network.bind_host</code>. Use this setting only if you require
to bind to multiple addresses or to use different addresses for publishing and
binding, and you also require different binding configurations for the
transport and HTTP interfaces.
</dd>
<dt>
<span class="term">
<code class="literal">transport.publish_host</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, string)
The network address at which the node can be contacted by other nodes. Accepts
an IP address, a hostname, or a <a class="xref" href="modules-network.html#network-interface-values" title="Special values for network addresses">special value</a>.
Defaults to the address given by <code class="literal">transport.host</code> or <code class="literal">network.publish_host</code>.
Use this setting only if you require to bind to multiple addresses or to use
different addresses for publishing and binding, and you also require different
binding configurations for the transport and HTTP interfaces.
</dd>
<dt>
<span class="term">
<code class="literal">transport.publish_port</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, integer)
The port of the <a class="xref" href="modules-network.html#modules-network-binding-publishing" title="Binding and publishing">transport publish
address</a>. Set this parameter only if you need the publish port to be
different from <code class="literal">transport.port</code>. Defaults to the port assigned via
<code class="literal">transport.port</code>.
</dd>
<dt>
<span class="term">
<code class="literal">transport.connect_timeout</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, <a class="xref" href="api-conventions.html#time-units" title="Time units">time value</a>)
The connect timeout for initiating a new connection (in
time setting format). Defaults to <code class="literal">30s</code>.
</dd>
</dl>
</div>
<div class="variablelist">
<a id="transport-settings-compress"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">transport.compress</code>
</span>
</dt>
<dd>
<p>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, string)
Determines which transport requests are compressed before sending them to
another node. Elasticsearch will compress transport responses if and only if the
corresponding request was compressed. See also <code class="literal">transport.compression_scheme</code>,
which specifies the compression scheme which is used. Accepts the following
values:
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">false</code>
</span>
</dt>
<dd>
No transport requests are compressed. This option uses the most network
bandwidth, but avoids the CPU overhead of compression and decompression.
</dd>
<dt>
<span class="term">
<code class="literal">indexing_data</code>
</span>
</dt>
<dd>
Compresses only the raw indexing data sent between nodes during ingest, CCR
following (excluding bootstrapping) and operations-based shard recovery
(excluding file-based recovery which copies the raw Lucene data). This option
is a good trade-off between network bandwidth savings and the extra CPU
required for compression and decompression. This option is the default.
</dd>
<dt>
<span class="term">
<code class="literal">true</code>
</span>
</dt>
<dd>
All transport requests are compressed. This option may perform better than
<code class="literal">indexing_data</code> in terms of network bandwidth, but will require the most CPU
for compression and decompression work.
</dd>
</dl>
</div>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="transport-settings-compression-scheme"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">transport.compression_scheme</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, string)
Configures the compression scheme for requests which are selected for
compression by to the <code class="literal">transport.compress</code> setting. Accepts either <code class="literal">deflate</code> or
<code class="literal">lz4</code>, which offer different trade-offs between compression ratio and CPU
usage. Elasticsearch will use the same compression scheme for responses as for the
corresponding requests. Defaults to <code class="literal">lz4</code>.
</dd>
<dt>
<span class="term">
<code class="literal">transport.tcp.keep_alive</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, boolean)
Configures the <code class="literal">SO_KEEPALIVE</code> option for transport sockets, which determines
whether they send TCP keepalive probes. Defaults to <code class="literal">network.tcp.keep_alive</code>.
</dd>
<dt>
<span class="term">
<code class="literal">transport.tcp.keep_idle</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, integer)
Configures the <code class="literal">TCP_KEEPIDLE</code> option for transport sockets, which determines
the time in seconds that a connection must be idle before starting to send TCP
keepalive probes. Defaults to <code class="literal">network.tcp.keep_idle</code> if set, or the system
default otherwise. This value cannot exceed <code class="literal">300</code> seconds. In cases where the
system default is higher than <code class="literal">300</code>, the value is automatically lowered to
<code class="literal">300</code>. Only applicable on Linux and macOS.
</dd>
<dt>
<span class="term">
<code class="literal">transport.tcp.keep_interval</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, integer)
Configures the <code class="literal">TCP_KEEPINTVL</code> option for transport sockets, which determines
the time in seconds between sending TCP keepalive probes. Defaults to
<code class="literal">network.tcp.keep_interval</code> if set, or the system default otherwise. This value
cannot exceed <code class="literal">300</code> seconds. In cases where the system default is higher than
<code class="literal">300</code>, the value is automatically lowered to <code class="literal">300</code>. Only applicable on Linux
and macOS.
</dd>
<dt>
<span class="term">
<code class="literal">transport.tcp.keep_count</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, integer)
Configures the <code class="literal">TCP_KEEPCNT</code> option for transport sockets, which determines the
number of unacknowledged TCP keepalive probes that may be sent on a connection
before it is dropped. Defaults to <code class="literal">network.tcp.keep_count</code> if set, or the
system default otherwise. Only applicable on Linux and macOS.
</dd>
<dt>
<span class="term">
<code class="literal">transport.tcp.no_delay</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, boolean)
Configures the <code class="literal">TCP_NODELAY</code> option on transport sockets, which determines
whether <a href="https://en.wikipedia.org/wiki/Nagle%27s_algorithm" class="ulink" target="_top">TCP no delay</a> is enabled. Defaults to
<code class="literal">true</code>.
</dd>
<dt>
<span class="term">
<code class="literal">transport.tcp.reuse_address</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, boolean)
Configures the <code class="literal">SO_REUSEADDR</code> option for network sockets, which determines
whether the address can be reused or not. Defaults to
<code class="literal">network.tcp.reuse_address</code>.
</dd>
<dt>
<span class="term">
<code class="literal">transport.tcp.send_buffer_size</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, <a class="xref" href="api-conventions.html#byte-units" title="Byte size units">byte value</a>)
The size of the TCP send buffer for transport traffic. Defaults to
<code class="literal">network.tcp.send_buffer_size</code>.
</dd>
<dt>
<span class="term">
<code class="literal">transport.tcp.receive_buffer_size</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, <a class="xref" href="api-conventions.html#byte-units" title="Byte size units">byte value</a>)
The size of the TCP receive buffer for transport traffic. Defaults to
<code class="literal">network.tcp.receive_buffer_size</code>.
</dd>
<dt>
<span class="term">
<code class="literal">transport.ping_schedule</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, <a class="xref" href="api-conventions.html#time-units" title="Time units">time value</a>)
Configures the time between sending application-level pings on all transport
connections to promptly detect when a transport connection has failed. Defaults
to <code class="literal">-1</code> meaning that application-level pings are not sent. You should use TCP
keepalives (see <code class="literal">transport.tcp.keep_alive</code>) instead of application-level pings
wherever possible.
</dd>
</dl>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="transport-profiles"></a>Transport profiles<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/modules/transport.asciidoc">edit</a></h4>
</div></div></div>
<p>Elasticsearch allows you to bind to multiple ports on different interfaces by
the use of transport profiles. See this example configuration</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">transport.profiles.default.port: 9300-9400
transport.profiles.default.bind_host: 10.0.0.1
transport.profiles.client.port: 9500-9600
transport.profiles.client.bind_host: 192.168.0.1
transport.profiles.dmz.port: 9700-9800
transport.profiles.dmz.bind_host: 172.16.1.2</pre>
</div>
<p>The <code class="literal">default</code> profile is special. It is used as a fallback for any other
profiles, if those do not have a specific configuration setting set, and is how
this node connects to other nodes in the cluster.
Other profiles can have any name and can be used to set up specific endpoints
for incoming connections.</p>
<p>The following parameters can be configured on each transport profile, as in the
example above:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">port</code>: The port to which to bind.
</li>
<li class="listitem">
<code class="literal">bind_host</code>: The host to which to bind.
</li>
<li class="listitem">
<code class="literal">publish_host</code>: The host which is published in informational APIs.
</li>
</ul>
</div>
<p>Profiles also support all the other transport settings specified in the
<a class="xref" href="modules-network.html#transport-settings" title="Advanced transport settings">transport settings</a> section, and use these as defaults.
For example, <code class="literal">transport.profiles.client.tcp.reuse_address</code> can be explicitly
configured, and defaults otherwise to <code class="literal">transport.tcp.reuse_address</code>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="long-lived-connections"></a>Long-lived idle connections<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/modules/transport.asciidoc">edit</a></h4>
</div></div></div>
<p>A transport connection between two nodes is made up of a number of long-lived
TCP connections, some of which may be idle for an extended period of time.
Nonetheless, Elasticsearch requires these connections to remain open, and it
can disrupt the operation of your cluster if any inter-node connections are
closed by an external influence such as a firewall. It is important to
configure your network to preserve long-lived idle connections between
Elasticsearch nodes, for instance by leaving <code class="literal">*.tcp.keep_alive</code> enabled and
ensuring that the keepalive interval is shorter than any timeout that might
cause idle connections to be closed, or by setting <code class="literal">transport.ping_schedule</code> if
keepalives cannot be configured. Devices which drop connections when they reach
a certain age are a common source of problems to Elasticsearch clusters, and
must not be used.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="request-compression"></a>Request compression<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/modules/transport.asciidoc">edit</a></h4>
</div></div></div>
<p>The default <code class="literal">transport.compress</code> configuration option <code class="literal">indexing_data</code> will only
compress requests that relate to the transport of raw indexing source data
between nodes. This option primarily compresses data sent during ingest,
ccr, and shard recovery. This default normally makes sense for local cluster
communication as compressing raw documents tends significantly reduce inter-node
network usage with minimal CPU impact.</p>
<p>The <code class="literal">transport.compress</code> setting always configures local cluster request
compression and is the fallback setting for remote cluster request compression.
If you want to configure remote request compression differently than local
request compression, you can set it on a per-remote cluster basis using the
<a class="xref" href="remote-clusters-settings.html" title="Remote cluster settings"><code class="literal">cluster.remote.${cluster_alias}.transport.compress</code> setting</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="response-compression"></a>Response compression<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/modules/transport.asciidoc">edit</a></h4>
</div></div></div>
<p>The compression settings do not configure compression for responses. Elasticsearch will
compress a response if the inbound request was compressed&#8212;&#8203;even when compression
is not enabled. Similarly, Elasticsearch will not compress a response if the inbound
request was uncompressed&#8212;&#8203;even when compression is enabled. The compression
scheme used to compress a response will be the same scheme the remote node used
to compress the request.</p>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="remote-cluster-network-settings"></a>Advanced remote cluster (API key based model) settings<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/modules/remote-cluster-network.asciidoc">edit</a></h3>
</div></div></div>
<p>Use the following advanced settings to configure the remote cluster interface (API key based model)
independently of the <a class="xref" href="modules-network.html#transport-settings" title="Advanced transport settings">transport interface</a>. You can also
configure both interfaces together using the <a class="xref" href="modules-network.html#common-network-settings" title="Commonly used network settings">network settings</a>.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">remote_cluster_server.enabled</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, boolean)
Determines whether the remote cluster server should be enabled. This setting must
be <code class="literal">true</code> for <code class="literal">remote_cluster.port</code> and all following remote cluster settings to
take effect. Enabling it allows the cluster to serve cross-cluster requests using
the API key based model. Defaults to <code class="literal">false</code>.
</dd>
<dt>
<span class="term">
<code class="literal">remote_cluster.host</code>
</span>
</dt>
<dd>
<p>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, string)
Sets the address of this node for remote cluster server traffic. The node will bind to this
address and will also use it as its remote cluster server publish address. Accepts an IP
address, a hostname, or a <a class="xref" href="modules-network.html#network-interface-values" title="Special values for network addresses">special value</a>.
Use this setting only if you require different configurations for the
remote cluster server and transport interfaces.
</p>
<p>Defaults to the address given by <code class="literal">transport.bind_host</code>.</p>
</dd>
<dt>
<span class="term">
<code class="literal">remote_cluster.bind_host</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, string)
The network address(es) to which the node should bind in order to listen for
incoming remote cluster connections. Accepts a list of IP addresses, hostnames, and
<a class="xref" href="modules-network.html#network-interface-values" title="Special values for network addresses">special values</a>. Defaults to the address given by
<code class="literal">remote_cluster.host</code>. Use this setting only if you require
to bind to multiple addresses or to use different addresses for publishing and
binding, and you also require different binding configurations for the
remote cluster server and transport interfaces.
</dd>
<dt>
<span class="term">
<code class="literal">remote_cluster.publish_host</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, string)
The network address at which the node can be contacted by other nodes. Accepts
an IP address, a hostname, or a <a class="xref" href="modules-network.html#network-interface-values" title="Special values for network addresses">special value</a>.
Defaults to the address given by <code class="literal">remote_cluster.host</code>.
Use this setting only if you require to bind to multiple addresses or to use
different addresses for publishing and binding, and you also require different
binding configurations for the remote cluster server and transport interfaces.
</dd>
<dt>
<span class="term">
<code class="literal">remote_cluster.publish_port</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, integer)
The port of the <a class="xref" href="modules-network.html#modules-network-binding-publishing" title="Binding and publishing">remote cluster server publish
address</a>. Set this parameter only if you need the publish port to be
different from <code class="literal">remote_cluster.port</code>. Defaults to the port assigned via
<code class="literal">remote_cluster.port</code>.
</dd>
<dt>
<span class="term">
<code class="literal">remote_cluster.tcp.keep_alive</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, boolean)
Configures the <code class="literal">SO_KEEPALIVE</code> option for remote cluster sockets, which determines
whether they send TCP keepalive probes. Defaults to <code class="literal">transport.tcp.keep_alive</code>.
</dd>
<dt>
<span class="term">
<code class="literal">remote_cluster.tcp.keep_idle</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, integer)
Configures the <code class="literal">TCP_KEEPIDLE</code> option for transport sockets, which determines
the time in seconds that a connection must be idle before starting to send TCP
keepalive probes. Defaults to <code class="literal">transport.tcp.keep_idle</code> if set, or the system
default otherwise. This value cannot exceed <code class="literal">300</code> seconds. In cases where the
system default is higher than <code class="literal">300</code>, the value is automatically lowered to
<code class="literal">300</code>. Only applicable on Linux and macOS.
</dd>
<dt>
<span class="term">
<code class="literal">remote_cluster.tcp.keep_interval</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, integer)
Configures the <code class="literal">TCP_KEEPINTVL</code> option for transport sockets, which determines
the time in seconds between sending TCP keepalive probes. Defaults to
<code class="literal">transport.tcp.keep_interval</code> if set, or the system default otherwise. This value
cannot exceed <code class="literal">300</code> seconds. In cases where the system default is higher than
<code class="literal">300</code>, the value is automatically lowered to <code class="literal">300</code>. Only applicable on Linux
and macOS.
</dd>
<dt>
<span class="term">
<code class="literal">remote_cluster.tcp.keep_count</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, integer)
Configures the <code class="literal">TCP_KEEPCNT</code> option for transport sockets, which determines the
number of unacknowledged TCP keepalive probes that may be sent on a connection
before it is dropped. Defaults to <code class="literal">transport.tcp.keep_count</code> if set, or the
system default otherwise. Only applicable on Linux and macOS.
</dd>
<dt>
<span class="term">
<code class="literal">remote_cluster.tcp.no_delay</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, boolean)
Configures the <code class="literal">TCP_NODELAY</code> option on transport sockets, which determines
whether <a href="https://en.wikipedia.org/wiki/Nagle%27s_algorithm" class="ulink" target="_top">TCP no delay</a> is enabled. Defaults to
<code class="literal">transport.tcp.no_delay</code>.
</dd>
<dt>
<span class="term">
<code class="literal">remote_cluster.tcp.reuse_address</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, boolean)
Configures the <code class="literal">SO_REUSEADDR</code> option for network sockets, which determines
whether the address can be reused or not. Defaults to
<code class="literal">transport.tcp.reuse_address</code>.
</dd>
<dt>
<span class="term">
<code class="literal">remote_cluster.tcp.send_buffer_size</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, <a class="xref" href="api-conventions.html#byte-units" title="Byte size units">byte value</a>)
The size of the TCP send buffer for transport traffic. Defaults to
<code class="literal">transport.tcp.send_buffer_size</code>.
</dd>
<dt>
<span class="term">
<code class="literal">remote_cluster.tcp.receive_buffer_size</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, <a class="xref" href="api-conventions.html#byte-units" title="Byte size units">byte value</a>)
The size of the TCP receive buffer for transport traffic. Defaults to
<code class="literal">transport.tcp.receive_buffer_size</code>.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_request_tracing"></a>Request tracing<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/modules/network/tracers.asciidoc">edit</a></h3>
</div></div></div>
<p>You can trace individual requests made on the HTTP and transport layers.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>Tracing can generate extremely high log volumes that can destabilize
your cluster. Do not enable request tracing on busy or important clusters.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="http-rest-request-tracer"></a>REST request tracer<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/modules/network/tracers.asciidoc">edit</a></h4>
</div></div></div>
<p>The HTTP layer has a dedicated tracer that logs incoming requests and the
corresponding outgoing responses. Activate the tracer by setting the level of
the <code class="literal">org.elasticsearch.http.HttpTracer</code> logger to <code class="literal">TRACE</code>:</p>
<div class="pre_wrapper lang-ruby alternative">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ruby alternative">response = client.cluster.put_settings(
  body: {
    persistent: {
      "logger.org.elasticsearch.http.HttpTracer": 'TRACE'
    }
  }
)
puts response</pre>
</div>
<a id="a45810722dc4f468f81b1e8a451d21be"></a>
<div class="pre_wrapper lang-console default has-ruby">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console default has-ruby">PUT _cluster/settings
{
   "persistent" : {
      "logger.org.elasticsearch.http.HttpTracer" : "TRACE"
   }
}</pre>
</div>
<div class="console_widget has-ruby" data-snippet="snippets/20.console"></div>
<p>You can also control which URIs will be traced, using a set of include and
exclude wildcard patterns. By default every request will be traced.</p>
<div class="pre_wrapper lang-ruby alternative">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ruby alternative">response = client.cluster.put_settings(
  body: {
    persistent: {
      'http.tracer.include' =&gt; '*',
      'http.tracer.exclude' =&gt; ''
    }
  }
)
puts response</pre>
</div>
<a id="8b7956a2b88fd798a895d3466d671b58"></a>
<div class="pre_wrapper lang-console default has-ruby">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console default has-ruby">PUT _cluster/settings
{
   "persistent" : {
      "http.tracer.include" : "*",
      "http.tracer.exclude" : ""
   }
}</pre>
</div>
<div class="console_widget has-ruby" data-snippet="snippets/21.console"></div>
<p>By default, the tracer logs a summary of each request and response which
matches these filters. To record the body of each request and response too, set
the system property <code class="literal">es.insecure_network_trace_enabled</code> to <code class="literal">true</code>, and then set
the levels of both the <code class="literal">org.elasticsearch.http.HttpTracer</code> and
<code class="literal">org.elasticsearch.http.HttpBodyTracer</code> loggers to <code class="literal">TRACE</code>:</p>
<div class="pre_wrapper lang-ruby alternative">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ruby alternative">response = client.cluster.put_settings(
  body: {
    persistent: {
      "logger.org.elasticsearch.http.HttpTracer": 'TRACE',
      "logger.org.elasticsearch.http.HttpBodyTracer": 'TRACE'
    }
  }
)
puts response</pre>
</div>
<a id="3250a8d2d2a9619035040e55a03620b9"></a>
<div class="pre_wrapper lang-console default has-ruby">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console default has-ruby">PUT _cluster/settings
{
   "persistent" : {
      "logger.org.elasticsearch.http.HttpTracer" : "TRACE",
      "logger.org.elasticsearch.http.HttpBodyTracer" : "TRACE"
   }
}</pre>
</div>
<div class="console_widget has-ruby" data-snippet="snippets/22.console"></div>
<p>Each message body is compressed, encoded, and split into chunks to avoid
truncation:</p>
<div class="pre_wrapper lang-text">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-text">[TRACE][o.e.h.HttpBodyTracer     ] [master] [276] response body [part 1]: H4sIAAAAAAAA/9...
[TRACE][o.e.h.HttpBodyTracer     ] [master] [276] response body [part 2]: 2oJ93QyYLWWhcD...
[TRACE][o.e.h.HttpBodyTracer     ] [master] [276] response body (gzip compressed, base64-encoded, and split into 2 parts on preceding log lines)</pre>
</div>
<p>Each chunk is annotated with an internal request ID (<code class="literal">[276]</code> in this example)
which you should use to correlate the chunks with the corresponding summary
lines. To reconstruct the output, base64-decode the data and decompress it
using <code class="literal">gzip</code>. For instance, on Unix-like systems:</p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">cat httptrace.log | sed -e 's/.*://' | base64 --decode | gzip --decompress</pre>
</div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>HTTP request and response bodies may contain sensitive information
such as credentials and keys, so HTTP body tracing is disabled by default. You
must explicitly enable it on each node by setting the system property
<code class="literal">es.insecure_network_trace_enabled</code> to <code class="literal">true</code>. This feature is primarily
intended for test systems which do not contain any sensitive information. If
you set this property on a system which contains sensitive information, you
must protect your logs from unauthorized access.</p>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="transport-tracer"></a>Transport tracer<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/modules/network/tracers.asciidoc">edit</a></h4>
</div></div></div>
<p>The transport layer has a dedicated tracer that logs incoming and outgoing
requests and responses. Activate the tracer by setting the level of the
<code class="literal">org.elasticsearch.transport.TransportService.tracer</code> logger to <code class="literal">TRACE</code>:</p>
<div class="pre_wrapper lang-ruby alternative">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ruby alternative">response = client.cluster.put_settings(
  body: {
    persistent: {
      "logger.org.elasticsearch.transport.TransportService.tracer": 'TRACE'
    }
  }
)
puts response</pre>
</div>
<a id="5d689d74062cddd01a0711a2fa7f23fd"></a>
<div class="pre_wrapper lang-console default has-ruby">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console default has-ruby">PUT _cluster/settings
{
   "persistent" : {
      "logger.org.elasticsearch.transport.TransportService.tracer" : "TRACE"
   }
}</pre>
</div>
<div class="console_widget has-ruby" data-snippet="snippets/23.console"></div>
<p>You can also control which actions will be traced, using a set of include and
exclude wildcard patterns. By default every request will be traced except for
fault detection pings:</p>
<div class="pre_wrapper lang-ruby alternative">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ruby alternative">response = client.cluster.put_settings(
  body: {
    persistent: {
      'transport.tracer.include' =&gt; '*',
      'transport.tracer.exclude' =&gt; 'internal:coordination/fault_detection/*'
    }
  }
)
puts response</pre>
</div>
<a id="c6d5e3b6ff9c665ec5344a4bfa7add80"></a>
<div class="pre_wrapper lang-console default has-ruby">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console default has-ruby">PUT _cluster/settings
{
   "persistent" : {
      "transport.tracer.include" : "*",
      "transport.tracer.exclude" : "internal:coordination/fault_detection/*"
   }
}</pre>
</div>
<div class="console_widget has-ruby" data-snippet="snippets/24.console"></div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="modules-network-threading-model"></a>Networking threading model<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/modules/network/threading.asciidoc">edit</a></h3>
</div></div></div>
<p>This section describes the threading model used by the networking subsystem in
Elasticsearch. This information isn&#8217;t required to use Elasticsearch, but it may be useful to
advanced users who are diagnosing network problems in a cluster.</p>
<p>Elasticsearch nodes communicate over a collection of TCP channels that together form a
transport connection. Elasticsearch clients communicate with the cluster over HTTP,
which also uses one or more TCP channels. Each of these TCP channels is owned
by exactly one of the <code class="literal">transport_worker</code> threads in the node. This owning
thread is chosen when the channel is opened and remains the same for the
lifetime of the channel.</p>
<p>Each <code class="literal">transport_worker</code> thread has sole responsibility for sending and
receiving data over the channels it owns. Additionally, each http and transport
server socket is assigned to one of the <code class="literal">transport_worker</code> threads. That worker
has the responsibility of accepting new incoming connections to the server
socket it owns.</p>
<p>If a thread in Elasticsearch wants to send data over a particular channel, it passes the
data to the owning <code class="literal">transport_worker</code> thread for the actual transmission.</p>
<p>Normally the <code class="literal">transport_worker</code> threads will not completely handle the messages
they receive. Instead, they will do a small amount of preliminary processing
and then dispatch (hand off) the message to a different
<a class="xref" href="modules-threadpool.html" title="Thread pools">threadpool</a> for the rest of their handling. For instance,
bulk messages are dispatched to the <code class="literal">write</code> threadpool, searches are dispatched
to one of the <code class="literal">search</code> threadpools, and requests for statistics and other
management tasks are mostly dispatched to the <code class="literal">management</code> threadpool. However
in some cases the processing of a message is expected to be so quick that Elasticsearch
will do all of the processing on the <code class="literal">transport_worker</code> thread rather than
incur the overhead of dispatching it elsewhere.</p>
<p>By default, there is one <code class="literal">transport_worker</code> thread per CPU. In contrast, there
may sometimes be tens-of-thousands of TCP channels. If data arrives on a TCP
channel and its owning <code class="literal">transport_worker</code> thread is busy, the data isn&#8217;t
processed until the thread finishes whatever it is doing. Similarly, outgoing
data are not sent over a channel until the owning <code class="literal">transport_worker</code> thread is
free. This means that we require every <code class="literal">transport_worker</code> thread to be idle
frequently. An idle <code class="literal">transport_worker</code> looks something like this in a stack
dump:</p>
<div class="pre_wrapper lang-text">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-text">"elasticsearch[instance-0000000004][transport_worker][T#1]" #32 daemon prio=5 os_prio=0 cpu=9645.94ms elapsed=501.63s tid=0x00007fb83b6307f0 nid=0x1c4 runnable  [0x00007fb7b8ffe000]
   java.lang.Thread.State: RUNNABLE
	at sun.nio.ch.EPoll.wait(java.base@17.0.2/Native Method)
	at sun.nio.ch.EPollSelectorImpl.doSelect(java.base@17.0.2/EPollSelectorImpl.java:118)
	at sun.nio.ch.SelectorImpl.lockAndDoSelect(java.base@17.0.2/SelectorImpl.java:129)
	- locked &lt;0x00000000c443c518&gt; (a sun.nio.ch.Util$2)
	- locked &lt;0x00000000c38f7700&gt; (a sun.nio.ch.EPollSelectorImpl)
	at sun.nio.ch.SelectorImpl.select(java.base@17.0.2/SelectorImpl.java:146)
	at io.netty.channel.nio.NioEventLoop.select(NioEventLoop.java:813)
	at io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:460)
	at io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
	at io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
	at java.lang.Thread.run(java.base@17.0.2/Thread.java:833)</pre>
</div>
<p>In the <a class="xref" href="cluster-nodes-hot-threads.html" title="Nodes hot threads API">Nodes hot threads</a> API an idle <code class="literal">transport_worker</code> thread is
reported like this:</p>
<div class="pre_wrapper lang-text">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-text">   0.0% [cpu=0.0%, idle=100.0%] (500ms out of 500ms) cpu usage by thread 'elasticsearch[instance-0000000004][transport_worker][T#1]'
     10/10 snapshots sharing following 9 elements
       java.base@17.0.2/sun.nio.ch.EPoll.wait(Native Method)
       java.base@17.0.2/sun.nio.ch.EPollSelectorImpl.doSelect(EPollSelectorImpl.java:118)
       java.base@17.0.2/sun.nio.ch.SelectorImpl.lockAndDoSelect(SelectorImpl.java:129)
       java.base@17.0.2/sun.nio.ch.SelectorImpl.select(SelectorImpl.java:146)
       io.netty.channel.nio.NioEventLoop.select(NioEventLoop.java:813)
       io.netty.channel.nio.NioEventLoop.run(NioEventLoop.java:460)
       io.netty.util.concurrent.SingleThreadEventExecutor$4.run(SingleThreadEventExecutor.java:986)
       io.netty.util.internal.ThreadExecutorMap$2.run(ThreadExecutorMap.java:74)
       java.base@17.0.2/java.lang.Thread.run(Thread.java:833)</pre>
</div>
<p>Note that <code class="literal">transport_worker</code> threads should always be in state <code class="literal">RUNNABLE</code>, even
when waiting for input, because they block in the native <code class="literal">EPoll#wait</code> method. The <code class="literal">idle=</code>
time reports the proportion of time the thread spent waiting for input, whereas the <code class="literal">cpu=</code> time
reports the proportion of time the thread spent processing input it has received.</p>
<p>If a <code class="literal">transport_worker</code> thread is not frequently idle, it may build up a
backlog of work. This can cause delays in processing messages on the channels
that it owns. It&#8217;s hard to predict exactly which work will be delayed:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
There are many more channels than threads. If work related to one channel is
causing delays to its worker thread, all other channels owned by that thread
will also suffer delays.
</li>
<li class="listitem">
The mapping from TCP channels to worker threads is fixed but arbitrary. Each
channel is assigned an owning thread in a round-robin fashion when the channel
is opened. Each worker thread is responsible for many different kinds of
channel.
</li>
<li class="listitem">
There are many channels open between each pair of nodes. For each request,
Elasticsearch will choose from the appropriate channels in a round-robin fashion. Some
requests may end up on a channel owned by a delayed worker while other
identical requests will be sent on a channel that&#8217;s working smoothly.
</li>
</ul>
</div>
<p>If the backlog builds up too far, some messages may be delayed by many seconds.
The node might even <a class="xref" href="cluster-fault-detection.html" title="Cluster fault detection">fail its health checks</a> and be
removed from the cluster. Sometimes, you can find evidence of busy
<code class="literal">transport_worker</code> threads using the <a class="xref" href="cluster-nodes-hot-threads.html" title="Nodes hot threads API">Nodes hot threads</a> API.
However, this API itself sends network messages so may not work correctly if
the <code class="literal">transport_worker</code> threads are too busy. It is more reliable to use
<code class="literal">jstack</code> to obtain stack dumps or use Java Flight Recorder to obtain a
profiling trace. These tools are independent of any work the JVM is performing.</p>
<p>It may also be possible to identify some reasons for delays from the server
logs. See for instance the following loggers:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">org.elasticsearch.transport.InboundHandler</code>
</span>
</dt>
<dd>
This logger reports a warning if
processing an inbound message occupies a network thread for unreasonably long,
which is almost certainly a bug. The warning includes some information which
can be used to identify the message that took unreasonably long to process.
</dd>
<dt>
<span class="term">
<code class="literal">org.elasticsearch.transport.OutboundHandler</code>
</span>
</dt>
<dd>
This logger reports a warning
if sending an outbound message takes longer than expected. This duration
includes time spent waiting for network congestion to clear, and time spent
processing other work on the same network thread, so does not always indicate
the presence of a bug related to the outbound message specified in the log
entry.
</dd>
<dt>
<span class="term">
<code class="literal">org.elasticsearch.common.network.ThreadWatchdog</code>
</span>
</dt>
<dd>
<p>
This logger reports a
warning and a thread dump when it notices that a network thread has not made
progress between two consecutive checks, which is almost certainly a bug:
</p>
<div class="pre_wrapper lang-text">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-text">[WARN ][o.e.c.n.ThreadWatchdog   ] the following threads are active but did not make progress in the preceding [5s]: [elasticsearch[instance-0000000004][transport_worker][T#1]]]
[WARN ][o.e.c.n.ThreadWatchdog   ] hot threads dump due to active threads not making progress [part 1]: H4sIAAAAAAAA/+1aa2/bOBb93l8hYLUYFWgYvWw5AQbYpEkn6STZbJyiwAwGA1qiY8US6ZJUHvPr90qk/JJky41TtDMuUIci...
[WARN ][o.e.c.n.ThreadWatchdog   ] hot threads dump due to active threads not making progress [part 2]: LfXL/x70a3eL8ve6Ral74ZBrp5x7HmUD9KXQz1MaXUNfFC6SeEysxSw1cNXL9JXYl3AigAE7ywbm/AZ+ll3Ox4qXJHNjVr6h...
[WARN ][o.e.c.n.ThreadWatchdog   ] hot threads dump due to active threads not making progress (gzip compressed, base64-encoded, and split into 2 parts on preceding log lines; ...</pre>
</div>
<p>To reconstruct the thread dump, base64-decode the data and decompress it using <code class="literal">gzip</code>. For instance, on Unix-like systems:</p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">cat watchdog.log | sed -e 's/.*://' | base64 --decode | gzip --decompress</pre>
</div>
<p>This mechanism can be controlled with the following settings:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">network.thread.watchdog.interval</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, <a class="xref" href="api-conventions.html#time-units" title="Time units">time value</a>)
Defines the interval between watchdog checks. Defaults to <code class="literal">5s</code>. Set to <code class="literal">0</code> to
disable the network thread watchdog.
</dd>
<dt>
<span class="term">
<code class="literal">network.thread.watchdog.quiet_time</code>
</span>
</dt>
<dd>
(<a class="xref" href="settings.html#static-cluster-setting">Static</a>, <a class="xref" href="api-conventions.html#time-units" title="Time units">time value</a>)
Defines the interval between watchdog warnings. Defaults to <code class="literal">10m</code>.
</dd>
</dl>
</div>
</dd>
</dl>
</div>
</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="modules-node.html">« Nodes</a>
</span>
<span class="next">
<a href="query-cache.html">Node query cache settings »</a>
</span>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>

                        <!-- Feedback widget -->
                        <div id="feedbackWidgetContainer"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


        <div id='elastic-footer'></div>
        <script src='https://www.elastic.co/elastic-footer.js'></script>
        <!-- Footer Section end-->

      </section>
    </div>

    <!-- Feedback modal -->
    <div id="feedbackModalContainer"></div>

    <script src="/guide/static/jquery.js"></script>
    <script type="text/javascript" src="/guide/static/docs-v1.js"></script>
    <script type="text/javascript">
  window.initial_state = {"alternatives":{"console":{"php":{"hasAny":true},"python":{"hasAny":true},"ruby":{"hasAny":true},"go":{"hasAny":true},"js":{"hasAny":true}}}}</script>
  </body>
</html>
