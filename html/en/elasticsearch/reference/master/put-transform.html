<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<meta name="keywords" content="hot-spotting, hotspot, hot-spot, hot spot, hotspots, hotspotting">
<title>Create transform API | Elasticsearch Guide [master] | Elastic</title>
<meta class="elastic" name="content" content="Create transform API | Elasticsearch Guide [master]">

<link rel="home" href="index.html" title="Elasticsearch Guide [master]"/>
<link rel="up" href="transform-apis.html" title="Transform APIs"/>
<link rel="prev" href="transform-apis.html" title="Transform APIs"/>
<link rel="next" href="delete-transform.html" title="Delete transform API"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="Elasticsearch"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/master"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="master"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <!--© 2015-2022 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  <div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elasticsearch Guide [master]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="rest-apis.html">REST APIs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="transform-apis.html">Transform APIs</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="transform-apis.html">« Transform APIs</a>
</span>
<span class="next">
<a href="delete-transform.html">Delete transform API »</a>
</span>
</div>
<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="put-transform"></a>Create transform API<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/transform/apis/put-transform.asciidoc">edit</a></h2>
</div></div></div>

<p>Instantiates a transform.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="put-transform-request"></a>Request<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/transform/apis/put-transform.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">PUT _transform/&lt;transform_id&gt;</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="put-transform-prereqs"></a>Prerequisites<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/transform/apis/put-transform.asciidoc">edit</a></h3>
</div></div></div>
<p>Requires the following privileges:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
cluster: <code class="literal">manage_transform</code> (the <code class="literal">transform_admin</code> built-in role grants this
privilege)
</li>
<li class="listitem">
source indices: <code class="literal">read</code>, <code class="literal">view_index_metadata</code>
</li>
<li class="listitem">
destination index: <code class="literal">read</code>, <code class="literal">create_index</code>, <code class="literal">index</code>. If a <code class="literal">retention_policy</code> is configured, the <code class="literal">delete</code> privilege is
also required.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="put-transform-desc"></a>Description<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/transform/apis/put-transform.asciidoc">edit</a></h3>
</div></div></div>
<p>This API defines a transform, which copies data from source indices,
transforms it, and persists it into an entity-centric destination index. If you
choose to use the pivot method for your transform, the entities are defined by
the set of <code class="literal">group_by</code> fields in the <code class="literal">pivot</code> object. If you choose to use the
latest method, the entities are defined by the <code class="literal">unique_key</code> field values in the
<code class="literal">latest</code> object.</p>
<p>You can also think of the destination index as a two-dimensional tabular data
structure (known as a data frame). The ID for each document in the data frame
is generated from a hash of the entity, so there is a unique row per entity. For
more information, see <a class="xref" href="transforms.html" title="Transforming data"><em>Transforming data</em></a>.</p>
<p>When the transform is created, a series of validations occur to ensure its
success. For example, there is a check for the existence of the source indices
and a check that the destination index is not part of the source index pattern.
You can use the <code class="literal">defer_validation</code> parameter to skip these checks.</p>
<p>Deferred validations are always run when the transform is started, with the
exception of privilege checks.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
The transform remembers which roles the user that created it had at the time
of creation and uses those same roles. If those roles do not have the required
privileges on the source and destination indices, the transform fails when it
attempts unauthorized operations. If you provide
<a class="xref" href="http-clients.html#http-clients-secondary-authorization" title="Secondary authorization">secondary authorization headers</a>, those
credentials are used instead.
</li>
<li class="listitem">
You must use Kibana or this API to create a transform. Do not add a
transform directly into any <code class="literal">.transform-internal*</code> indices using the Elasticsearch
index API. If Elasticsearch security features are enabled, do not give users any
privileges on <code class="literal">.transform-internal*</code> indices. If you used transforms prior to
7.5, also do not give users any privileges on <code class="literal">.data-frame-internal*</code> indices.
</li>
</ul>
</div>
</div>
</div>
<p>You must choose either the latest or pivot method for your transform; you
cannot use both in a single transform.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="put-transform-path-parms"></a>Path parameters<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/transform/apis/put-transform.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;transform_id&gt;</code>
</span>
</dt>
<dd>
(Required, string)
Identifier for the transform. This identifier can contain lowercase
alphanumeric characters (a-z and 0-9), hyphens, and underscores. It has a 64
character limit and must start and end with alphanumeric characters.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="put-transform-query-parms"></a>Query parameters<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/transform/apis/put-transform.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">defer_validation</code>
</span>
</dt>
<dd>
(Optional, Boolean) When <code class="literal">true</code>, deferrable validations are not run. This
behavior may be desired if the source index does not exist until after the
transform is created.
</dd>
<dt>
<span class="term">
<code class="literal">timeout</code>
</span>
</dt>
<dd>
(Optional, time)
Period to wait for a response. If no response is received before the timeout
expires, the request fails and returns an error. Defaults to <code class="literal">30s</code>.
</dd>
</dl>
</div>
</div>

<div class="section child_attributes">
<div class="titlepage"><div><div>
<h3 class="title"><a id="put-transform-request-body"></a>Request body<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/transform/apis/put-transform.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">description</code>
</span>
</dt>
<dd>
(Optional, string) Free text description of the transform.
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">dest</code>
</span>
</dt>
<dd>
<p>
(Required, object)
The destination for the transform.
</p>
<details open>
<summary class="title">Properties of <code class="literal">dest</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">index</code>
</span>
</dt>
<dd>
(Required, string)
The <em>destination index</em> for the transform.
</dd>
</dl>
</div>
<p>In the case of a <code class="literal">pivot</code> transform, the mappings of the destination
index are deduced based on the source fields when possible. If alternate
mappings are required, use the <a class="xref" href="indices-create-index.html" title="Create index API">Create index API</a>
prior to starting the transform.</p>
<p>In the case of a <code class="literal">latest</code> transform, the mappings are never deduced. If dynamic
mappings for the destination index are undesirable, use the
<a class="xref" href="indices-create-index.html" title="Create index API">Create index API</a> prior to starting the transform.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">aliases</code>
</span>
</dt>
<dd>
(Optional, array of objects)
The aliases that the destination index for the transform should have.
Aliases are manipulated using the stored credentials of the transform, which means the secondary credentials supplied
at creation time (if both primary and secondary credentials are specified).
</dd>
</dl>
</div>
<p>The destination index is added to the aliases regardless whether the destination
index was created by the transform or pre-created by the user.</p>
<p>+
.Properties of <code class="literal">aliases</code></p>
<details open>
<summary class="title">Details</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">alias</code>
</span>
</dt>
<dd>
(Required, string)
The name of the alias.
</dd>
<dt>
<span class="term">
<code class="literal">move_on_creation</code>
</span>
</dt>
<dd>
(Optional, boolean)
Whether or not the destination index should be the <span class="strong strong"><strong>only</strong></span> index in this alias.
If <code class="literal">true</code>, all the other indices will be removed from this alias before adding the destination index to this alias.
Defaults to <code class="literal">false</code>.
</dd>
</dl>
</div>
</div>
</details>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">pipeline</code>
</span>
</dt>
<dd>
(Optional, string)
The unique identifier for an <a class="xref" href="ingest.html" title="Ingest pipelines">ingest pipeline</a>.
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">frequency</code>
</span>
</dt>
<dd>
(Optional, <a class="xref" href="api-conventions.html#time-units" title="Time units">time units</a>)
The interval between checks for changes in the source indices when the
transform is running continuously. The minimum value is <code class="literal">1s</code> and the maximum
is <code class="literal">1h</code>. The default value is <code class="literal">1m</code>.
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">latest</code>
</span>
</dt>
<dd>
<p>
(Required<sup>*</sup>, object)
The <code class="literal">latest</code> method transforms the data by finding the latest document for each
unique key.
</p>
<details open>
<summary class="title">Properties of <code class="literal">latest</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">sort</code>
</span>
</dt>
<dd>
(Required, string)
Specifies the date field that is used to identify the latest documents.
</dd>
<dt>
<span class="term">
<code class="literal">unique_key</code>
</span>
</dt>
<dd>
(Required, array of strings)
Specifies an array of one or more fields that are used to group the data.
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">_meta</code>
</span>
</dt>
<dd>
(Optional, object)
Defines optional transform metadata.
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">pivot</code>
</span>
</dt>
<dd>
<p>
(Required<sup>*</sup>, object)
The <code class="literal">pivot</code> method transforms the data by aggregating and grouping it. These
objects define the <code class="literal">group by</code> fields and the aggregation to reduce the data.
</p>
<details open>
<summary class="title">Properties of <code class="literal">pivot</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">aggregations</code> or <code class="literal">aggs</code>
</span>
</dt>
<dd>
<p>
(Required, object)
Defines how to aggregate the grouped data. The following aggregations are
currently supported:
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="search-aggregations-metrics-avg-aggregation.html" title="Avg aggregation">Average</a>
</li>
<li class="listitem">
<a class="xref" href="search-aggregations-pipeline-bucket-script-aggregation.html" title="Bucket script aggregation">Bucket script</a>
</li>
<li class="listitem">
<a class="xref" href="search-aggregations-pipeline-bucket-selector-aggregation.html" title="Bucket selector aggregation">Bucket selector</a>
</li>
<li class="listitem">
<a class="xref" href="search-aggregations-metrics-cardinality-aggregation.html" title="Cardinality aggregation">Cardinality</a>
</li>
<li class="listitem">
<a class="xref" href="search-aggregations-bucket-filter-aggregation.html" title="Filter aggregation">Filter</a>
</li>
<li class="listitem">
<a class="xref" href="search-aggregations-metrics-geobounds-aggregation.html" title="Geo-bounds aggregation">Geo bounds</a>
</li>
<li class="listitem">
<a class="xref" href="search-aggregations-metrics-geocentroid-aggregation.html" title="Geo-centroid aggregation">Geo centroid</a>
</li>
<li class="listitem">
<a class="xref" href="search-aggregations-metrics-geo-line.html" title="Geo-Line Aggregation">Geo line</a>
</li>
<li class="listitem">
<a class="xref" href="search-aggregations-metrics-cartesian-bounds-aggregation.html" title="Cartesian-bounds aggregation">Cartesian bounds</a>
</li>
<li class="listitem">
<a class="xref" href="search-aggregations-metrics-cartesian-centroid-aggregation.html" title="Cartesian-centroid aggregation">Cartesian centroid</a>
</li>
<li class="listitem">
<a class="xref" href="search-aggregations-metrics-max-aggregation.html" title="Max aggregation">Max</a>
</li>
<li class="listitem">
<a class="xref" href="search-aggregations-metrics-median-absolute-deviation-aggregation.html" title="Median absolute deviation aggregation">Median absolute deviation</a>
</li>
<li class="listitem">
<a class="xref" href="search-aggregations-metrics-min-aggregation.html" title="Min aggregation">Min</a>
</li>
<li class="listitem">
<a class="xref" href="search-aggregations-bucket-missing-aggregation.html" title="Missing aggregation">Missing</a>
</li>
<li class="listitem">
<a class="xref" href="search-aggregations-metrics-percentile-aggregation.html" title="Percentiles aggregation">Percentiles</a>
</li>
<li class="listitem">
<a class="xref" href="search-aggregations-bucket-range-aggregation.html" title="Range aggregation">Range</a>
</li>
<li class="listitem">
<a class="xref" href="search-aggregations-bucket-rare-terms-aggregation.html" title="Rare terms aggregation">Rare Terms</a>
</li>
<li class="listitem">
<a class="xref" href="search-aggregations-metrics-scripted-metric-aggregation.html" title="Scripted metric aggregation">Scripted metric</a>
</li>
<li class="listitem">
<a class="xref" href="search-aggregations-metrics-stats-aggregation.html" title="Stats aggregation">Stats</a>
</li>
<li class="listitem">
<a class="xref" href="search-aggregations-metrics-sum-aggregation.html" title="Sum aggregation">Sum</a>
</li>
<li class="listitem">
<a class="xref" href="search-aggregations-bucket-terms-aggregation.html" title="Terms aggregation">Terms</a>
</li>
<li class="listitem">
<a class="xref" href="search-aggregations-metrics-top-metrics.html" title="Top metrics aggregation">Top Metrics</a>
</li>
<li class="listitem">
<a class="xref" href="search-aggregations-metrics-valuecount-aggregation.html" title="Value count aggregation">Value count</a>
</li>
<li class="listitem">
<a class="xref" href="search-aggregations-metrics-weight-avg-aggregation.html" title="Weighted avg aggregation">Weighted average</a>
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">group_by</code>
</span>
</dt>
<dd>
<p>
(Required, object)
Defines how to group the data. More than one grouping can be defined per pivot.
The following groupings are currently supported:
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="search-aggregations-bucket-composite-aggregation.html#_date_histogram" title="Date histogram">Date histogram</a>
</li>
<li class="listitem">
<a class="xref" href="search-aggregations-bucket-composite-aggregation.html#_geotile_grid" title="GeoTile grid">Geotile Grid</a>
</li>
<li class="listitem">
<a class="xref" href="search-aggregations-bucket-composite-aggregation.html#_histogram" title="Histogram">Histogram</a>
</li>
<li class="listitem">
<a class="xref" href="search-aggregations-bucket-composite-aggregation.html#_terms" title="Terms">Terms</a>
</li>
</ul>
</div>
<p>The grouping properties can optionally have a <code class="literal">missing_bucket</code> property. If
it&#8217;s <code class="literal">true</code>, documents without a value in the respective <code class="literal">group_by</code> field are
included. Defaults to <code class="literal">false</code>.</p>
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">retention_policy</code>
</span>
</dt>
<dd>
<p>
(Optional, object)
Defines a retention policy for the transform. Data that meets the defined
criteria is deleted from the destination index.
</p>
<details open>
<summary class="title">Properties of <code class="literal">retention_policy</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">time</code>
</span>
</dt>
<dd>
<p>
(Required, object)
Specifies that the transform uses a time field to set the retention policy.
Data is deleted if <code class="literal">time.field</code> for the retention policy exists and contains
data older than <code class="literal">max.age</code>.
</p>
<details open>
<summary class="title">Properties of <code class="literal">time</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">field</code>
</span>
</dt>
<dd>
(Required, string)
The date field that is used to calculate the age of the document. Set
<code class="literal">time.field</code> to an existing date field.
</dd>
<dt>
<span class="term">
<code class="literal">max_age</code>
</span>
</dt>
<dd>
(Required, <a class="xref" href="api-conventions.html#time-units" title="Time units">time units</a>)
Specifies the maximum age of a document in the destination index. Documents that
are older than the configured value are removed from the destination index.
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">settings</code>
</span>
</dt>
<dd>
<p>
(Optional, object)
Defines optional transform settings.
</p>
<details open>
<summary class="title">Properties of <code class="literal">settings</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">align_checkpoints</code>
</span>
</dt>
<dd>
(Optional, boolean)
Specifies whether the transform checkpoint ranges should be optimized for performance.
Such optimization can align checkpoint ranges with date histogram interval when date histogram
is specified as a group source in the transform config. As an effect, less document updates in the
destination index will be performed thus improving overall performance.
The default value is <code class="literal">true</code>, which means the checkpoint ranges will be optimized if possible.
</dd>
<dt>
<span class="term">
<code class="literal">dates_as_epoch_millis</code>
</span>
</dt>
<dd>
(Optional, boolean)
Defines if dates in the output should be written as ISO formatted string (default)
or as millis since epoch. <code class="literal">epoch_millis</code> has been the default for transforms created
before version <code class="literal">7.11</code>. For compatible output set this to <code class="literal">true</code>.
The default value is <code class="literal">false</code>.
</dd>
<dt>
<span class="term">
<code class="literal">deduce_mappings</code>
</span>
</dt>
<dd>
(Optional, boolean)
Specifies whether the transform should deduce the destination index mappings from the transform config.
The default value is <code class="literal">true</code>, which means the destination index mappings will be deduced if possible.
</dd>
<dt>
<span class="term">
<code class="literal">docs_per_second</code>
</span>
</dt>
<dd>
(Optional, float)
Specifies a limit on the number of input documents per second. This setting
throttles the transform by adding a wait time between search requests. The
default value is <code class="literal">null</code>, which disables throttling.
</dd>
<dt>
<span class="term">
<code class="literal">max_page_search_size</code>
</span>
</dt>
<dd>
(Optional, integer)
Defines the initial page size to use for the composite aggregation for each
checkpoint. If circuit breaker exceptions occur, the page size is dynamically
adjusted to a lower value. The minimum value is <code class="literal">10</code> and the maximum is <code class="literal">65,536</code>.
The default value is <code class="literal">500</code>.
</dd>
<dt>
<span class="term">
<code class="literal">num_failure_retries</code>
</span>
</dt>
<dd>
(Optional, integer)
Defines the number of retries on a recoverable failure before the transform task is marked as <code class="literal">failed</code>.
The minimum value is <code class="literal">0</code> and the maximum is <code class="literal">100</code>.
<code class="literal">-1</code> can be used to denote infinity. In this case, the transform never gives up on retrying a recoverable failure.
The default value is the cluster-level setting <code class="literal">num_transform_failure_retries</code>.
</dd>
<dt>
<span class="term">
<code class="literal">unattended</code>
</span>
</dt>
<dd>
(Optional, boolean)
If <code class="literal">true</code>, the transform runs in unattended mode. In unattended mode, the
transform retries indefinitely in case of an error which means the transform
never fails. Setting the number of retries other than infinite fails in
validation. Defaults to <code class="literal">false</code>.
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">source</code>
</span>
</dt>
<dd>
<p>
(Required, object)
The source of the data for the transform.
</p>
<details open>
<summary class="title">Properties of <code class="literal">source</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">index</code>
</span>
</dt>
<dd>
<p>
(Required, string or array)
The <em>source indices</em> for the transform. It can be a single index, an index
pattern (for example, <code class="literal">"my-index-*"</code>), an array of indices (for example,
<code class="literal">["my-index-000001", "my-index-000002"]</code>), or an array of index patterns (for
example, <code class="literal">["my-index-*", "my-other-index-*"]</code>. For remote indices use the syntax
<code class="literal">"remote_name:index_name"</code>.
</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>If any indices are in remote clusters then the master node and at least
one transform node must have the <code class="literal">remote_cluster_client</code> node role.</p>
</div>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">query</code>
</span>
</dt>
<dd>
(Optional, object)
A query clause that retrieves a subset of data from the source index. See
<a class="xref" href="query-dsl.html" title="Query DSL">Query DSL</a>.
</dd>
<dt>
<span class="term">
<code class="literal">runtime_mappings</code>
</span>
</dt>
<dd>
(Optional, object)
Definitions of search-time runtime fields that can be used by the transform. For
search runtime fields all data nodes, including remote nodes, must be 7.12 or
later.
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">sync</code>
</span>
</dt>
<dd>
<p>
(Optional, object)
Defines the properties transforms require to run continuously.
</p>
<details open>
<summary class="title">Properties of <code class="literal">sync</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">time</code>
</span>
</dt>
<dd>
<p>
(Required, object)
Specifies that the transform uses a time field to synchronize the source and
destination indices.
</p>
<details open>
<summary class="title">Properties of <code class="literal">time</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">delay</code>
</span>
</dt>
<dd>
(Optional, <a class="xref" href="api-conventions.html#time-units" title="Time units">time units</a>)
The time delay between the current time and the latest input data time. The
default value is <code class="literal">60s</code>.
</dd>
<dt>
<span class="term">
<code class="literal">field</code>
</span>
</dt>
<dd>
<p>
(Required, string)
The date field that is used to identify new documents in the source.
</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>It is strongly recommended to use a field that contains the
<a class="xref" href="ingest.html#access-ingest-metadata" title="Access ingest metadata in a processor">ingest timestamp</a>. If you use a different field,
you might need to set the <code class="literal">delay</code> such that it accounts for data transmission
delays.</p>
</div>
</div>
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="put-transform-example"></a>Examples<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/transform/apis/put-transform.asciidoc">edit</a></h3>
</div></div></div>
<p>The following transform uses the <code class="literal">pivot</code> method:</p>
<a id="58ca855be30049f8f0879e532db51ee2"></a>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT _transform/ecommerce_transform1
{
  "source": {
    "index": "kibana_sample_data_ecommerce",
    "query": {
      "term": {
        "geoip.continent_name": {
          "value": "Asia"
        }
      }
    }
  },
  "pivot": {
    "group_by": {
      "customer_id": {
        "terms": {
          "field": "customer_id",
          "missing_bucket": true
        }
      }
    },
    "aggregations": {
      "max_price": {
        "max": {
          "field": "taxful_total_price"
        }
      }
    }
  },
  "description": "Maximum priced ecommerce data by customer_id in Asia",
  "dest": {
    "index": "kibana_sample_data_ecommerce_transform1",
    "pipeline": "add_timestamp_pipeline"
  },
  "frequency": "5m",
  "sync": {
    "time": {
      "field": "order_date",
      "delay": "60s"
    }
  },
  "retention_policy": {
    "time": {
      "field": "order_date",
      "max_age": "30d"
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2991.console"></div>
<p>When the transform is created, you receive the following results:</p>
<a id="aff76d64e6270a13c3274869f9abc3a9"></a>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "acknowledged" : true
}</pre>
</div>
<p>The following transform uses the <code class="literal">latest</code> method:</p>
<a id="7106e6317e6368b9863cf64df9c6f0c9"></a>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT _transform/ecommerce_transform2
{
  "source": {
    "index": "kibana_sample_data_ecommerce"
  },
  "latest": {
    "unique_key": ["customer_id"],
    "sort": "order_date"
  },
  "description": "Latest order for each customer",
  "dest": {
    "index": "kibana_sample_data_ecommerce_transform2"
  },
  "frequency": "5m",
  "sync": {
    "time": {
      "field": "order_date",
      "delay": "60s"
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2992.console"></div>
</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="transform-apis.html">« Transform APIs</a>
</span>
<span class="next">
<a href="delete-transform.html">Delete transform API »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {"alternatives":{"console":{"php":{"hasAny":true},"python":{"hasAny":true},"ruby":{"hasAny":true},"go":{"hasAny":true},"js":{"hasAny":true}}}}</script>
  </body>
</html>
