<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Add remote clusters using API key authentication | Elasticsearch Guide [master] | Elastic</title>
<meta class="elastic" name="content" content="Add remote clusters using API key authentication | Elasticsearch Guide [master]">

<link rel="home" href="index.html" title="Elasticsearch Guide [master]"/>
<link rel="up" href="remote-clusters.html" title="Remote clusters"/>
<link rel="prev" href="remote-clusters.html" title="Remote clusters"/>
<link rel="next" href="remote-clusters-cert.html" title="Add remote clusters using TLS certificate authentication"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="Elasticsearch"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/master"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="master"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles-v1.css" />
  </head>

  <!--© 2015-2025 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div class="page_header">
This documentation contains work-in-progress information for future Elastic Stack and Cloud releases. Use the version selector to view supported release docs. It also contains some Elastic Cloud serverless information. Check out our <a href="https://www.elastic.co/docs/current/serverless">serverless docs</a> for more details.
</div>
<div class="navheader">
<span class="prev">
<a href="remote-clusters.html">« Remote clusters</a>
</span>
<span class="next">
<a href="remote-clusters-cert.html">Add remote clusters using TLS certificate authentication »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elasticsearch Guide [master]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="setup.html">Set up Elasticsearch</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="remote-clusters.html">Remote clusters</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Add remote clusters using API key authentication</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/modules/cluster/remote-clusters-api-key.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="remote-clusters-api-key"></a>Add remote clusters using API key authentication<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/modules/cluster/remote-clusters-api-key.asciidoc">edit</a></h2>
</div></div></div>
<p>API key authentication enables a local cluster to authenticate itself with a
remote cluster via a <a class="xref" href="security-api-create-cross-cluster-api-key.html" title="Create Cross-Cluster API key API">cross-cluster
API key</a>. The API key needs to be created by an administrator of the remote
cluster. The local cluster is configured to provide this API key on each request
to the remote cluster. The remote cluster verifies the API key and grants
access, based on the API key&#8217;s privileges.</p>
<p>All cross-cluster requests from the local cluster are bound by the API key&#8217;s
privileges, regardless of local users associated with the requests. For example,
if the API key only allows read access to <code class="literal">my-index</code> on the remote cluster, even
a superuser from the local cluster is limited by this constraint. This mechanism
enables the remote cluster&#8217;s administrator to have full control over who can
access what data with cross-cluster search and/or cross-cluster replication. The
remote cluster&#8217;s administrator can be confident that no access is possible
beyond what is explicitly assigned to the API key.</p>
<p>On the local cluster side, not every local user needs to access every piece of
data allowed by the API key. An administrator of the local cluster can further
configure additional permission constraints on local users so each user only
gets access to the necessary remote data. Note it is only possible to further
reduce the permissions allowed by the API key for individual local users. It is
impossible to increase the permissions to go beyond what is allowed by the API
key.</p>
<p>In this model, cross-cluster operations use <a class="xref" href="modules-network.html#remote_cluster.port">a dedicated
server port</a> (remote cluster interface) for communication between clusters. A
remote cluster must enable this port for local clusters to connect. Configure
Transport Layer Security (TLS) for this port to maximize security (as explained
in <a class="xref" href="remote-clusters-api-key.html#remote-clusters-security-api-key" title="Establish trust with a remote cluster">Establish trust with a remote cluster</a>).</p>
<p>The local cluster must trust the remote cluster on the remote cluster interface.
This means that the local cluster trusts the remote cluster&#8217;s certificate
authority (CA) that signs the server certificate used by the remote cluster
interface. When establishing a connection, all nodes from the local cluster that
participate in cross-cluster communication verify certificates from nodes on the
other side, based on the TLS trust configuration.</p>
<p>To add a remote cluster using API key authentication:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<a class="xref" href="remote-clusters-api-key.html#remote-clusters-prerequisites-api-key" title="Prerequisites">Review the prerequisites</a>
</li>
<li class="listitem">
<a class="xref" href="remote-clusters-api-key.html#remote-clusters-security-api-key" title="Establish trust with a remote cluster">Establish trust with a remote cluster</a>
</li>
<li class="listitem">
<a class="xref" href="remote-clusters-api-key.html#remote-clusters-connect-api-key" title="Connect to a remote cluster">Connect to a remote cluster</a>
</li>
<li class="listitem">
<a class="xref" href="remote-clusters-api-key.html#remote-clusters-privileges-api-key" title="Configure roles and users">Configure roles and users</a>
</li>
</ol>
</div>
<p>If you run into any issues, refer to <a class="xref" href="remote-clusters-troubleshooting.html" title="Troubleshooting remote clusters">Troubleshooting</a>.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="remote-clusters-prerequisites-api-key"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/modules/cluster/remote-clusters-api-key.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
The Elasticsearch security features need to be enabled on both clusters, on every node.
Security is enabled by default. If it&#8217;s disabled, set <code class="literal">xpack.security.enabled</code>
to <code class="literal">true</code> in <code class="literal">elasticsearch.yml</code>. Refer to <a class="xref" href="security-settings.html#general-security-settings" title="General security settings">General security settings</a>.
</li>
<li class="listitem">
The nodes of the local and remote clusters must be on version 8.10 or later.
</li>
<li class="listitem">
The local and remote clusters must have an appropriate license. For more
information, refer to <a href="/subscriptions" class="ulink" target="_top">https://www.elastic.co/subscriptions</a>.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="remote-clusters-security-api-key"></a>Establish trust with a remote cluster<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/modules/cluster/remote-clusters-api-key.asciidoc">edit</a></h3>
</div></div></div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>If a remote cluster is part of an Elasticsearch Service deployment, it has a valid certificate by default.
You can therefore skip steps related to certificates in these instructions.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="remote-clusters-security-api-key-remote-action"></a>On the remote cluster<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/modules/cluster/remote-clusters-api-key.asciidoc">edit</a></h4>
</div></div></div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Enable the remote cluster server on every node of the remote cluster. In
<code class="literal">elasticsearch.yml</code>:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Set <a class="xref" href="modules-network.html#remote-cluster-network-settings" title="Advanced remote cluster (API key based model) settings"><code class="literal">remote_cluster_server.enabled</code></a> to
<code class="literal">true</code>.
</li>
<li class="listitem">
Configure the bind and publish address for remote cluster server traffic, for
example using <a class="xref" href="modules-network.html#remote-cluster-network-settings" title="Advanced remote cluster (API key based model) settings"><code class="literal">remote_cluster.host</code></a>. Without
configuring the address, remote cluster traffic may be bound to the local
interface, and remote clusters running on other machines can&#8217;t connect.
</li>
<li class="listitem">
Optionally, configure the remote server port using
<a class="xref" href="modules-network.html#remote_cluster.port"><code class="literal">remote_cluster.port</code></a> (defaults to <code class="literal">9443</code>).
</li>
</ol>
</div>
</li>
<li class="listitem">
<p>Next, generate a certificate authority (CA) and a server certificate/key pair.
On one of the nodes of the remote cluster, from the directory where Elasticsearch has
been installed:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Create a CA, if you don&#8217;t have a CA already:</p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">./bin/elasticsearch-certutil ca --pem --out=cross-cluster-ca.zip --pass CA_PASSWORD</pre>
</div>
<p>Replace <code class="literal">CA_PASSWORD</code> with the password you want to use for the CA. You can
remove the <code class="literal">--pass</code> option and its argument if you are not deploying to a
production environment.</p>
</li>
<li class="listitem">
<p>Unzip the generated <code class="literal">cross-cluster-ca.zip</code> file. This compressed file
contains the following content:</p>
<div class="pre_wrapper lang-txt">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-txt">/ca
|_ ca.crt
|_ ca.key</pre>
</div>
</li>
<li class="listitem">
<p>Generate a certificate and private key pair for the nodes in the remote
cluster:</p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">./bin/elasticsearch-certutil cert --out=cross-cluster.p12 --pass=CERT_PASSWORD --ca-cert=ca/ca.crt --ca-key=ca/ca.key --ca-pass=CA_PASSWORD --dns=example.com --ip=127.0.0.1</pre>
</div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Replace <code class="literal">CA_PASSWORD</code> with the CA password from the previous step.
</li>
<li class="listitem">
Replace <code class="literal">CERT_PASSWORD</code> with the password you want to use for the generated
private key.
</li>
<li class="listitem">
Use the <code class="literal">--dns</code> option to specify the relevant DNS name for the certificate.
You can specify it multiple times for multiple DNS.
</li>
<li class="listitem">
Use the <code class="literal">--ip</code> option to specify the relevant IP address for the certificate.
You can specify it multiple times for multiple IP addresses.
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>If the remote cluster has multiple nodes, you can either:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
create a single wildcard certificate for all nodes;
</li>
<li class="listitem">
or, create separate certificates for each node either manually or in batch
with the <a class="xref" href="certutil.html#certutil-silent" title="Using elasticsearch-certutil in Silent Mode">silent mode</a>.
</li>
</ul>
</div>
</li>
</ol>
</div>
</li>
<li class="listitem">
<p>On every node of the remote cluster:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Copy the <code class="literal">cross-cluster.p12</code> file from the earlier step to the <code class="literal">config</code>
directory. If you didn&#8217;t create a wildcard certificate, make sure you copy the
correct node-specific p12 file.
</li>
<li class="listitem">
<p>Add following configuration to <code class="literal">elasticsearch.yml</code>:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">xpack.security.remote_cluster_server.ssl.enabled: true
xpack.security.remote_cluster_server.ssl.keystore.path: cross-cluster.p12</pre>
</div>
</li>
<li class="listitem">
<p>Add the SSL keystore password to the Elasticsearch keystore:</p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">./bin/elasticsearch-keystore add xpack.security.remote_cluster_server.ssl.keystore.secure_password</pre>
</div>
<p>When prompted, enter the <code class="literal">CERT_PASSWORD</code> from the earlier step.</p>
</li>
</ol>
</div>
</li>
<li class="listitem">
Restart the remote cluster.
</li>
<li class="listitem">
On the remote cluster, generate a cross-cluster API key that provides access
to the indices you want to use for cross-cluster search or cross-cluster replication. You can use the
<a class="xref" href="security-api-create-cross-cluster-api-key.html" title="Create Cross-Cluster API key API">Create Cross-Cluster API key</a> API or
<a href="/guide/en/kibana/master/api-keys.html" class="ulink" target="_top">Kibana</a>.
</li>
<li class="listitem">
Copy the encoded key (<code class="literal">encoded</code> in the response) to a safe location. You will
need it to connect to the remote cluster later.
</li>
</ol>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="remote-clusters-security-api-key-local-actions"></a>On the local cluster<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/modules/cluster/remote-clusters-api-key.asciidoc">edit</a></h4>
</div></div></div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>On every node of the local cluster:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Copy the <code class="literal">ca.crt</code> file generated on the remote cluster earlier into the
<code class="literal">config</code> directory, renaming the file <code class="literal">remote-cluster-ca.crt</code>.
</li>
<li class="listitem">
<p>Add following configuration to <code class="literal">elasticsearch.yml</code>:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">xpack.security.remote_cluster_client.ssl.enabled: true
xpack.security.remote_cluster_client.ssl.certificate_authorities: [ "remote-cluster-ca.crt" ]</pre>
</div>
</li>
<li class="listitem">
<p>Add the cross-cluster API key, created on the remote cluster earlier, to the
keystore:</p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">./bin/elasticsearch-keystore add cluster.remote.ALIAS.credentials</pre>
</div>
<p>Replace <code class="literal">ALIAS</code> with the same name that you will use to create the remote cluster entry
later. When prompted, enter the encoded cross-cluster API key created on the
remote cluster earlier.</p>
</li>
</ol>
</div>
</li>
<li class="listitem">
Restart the local cluster to load changes to the keystore and settings.
</li>
</ol>
</div>
<p><span class="strong strong"><strong>Note:</strong></span> If you are configuring only the cross-cluster API key, you can call the <a class="xref" href="cluster-nodes-reload-secure-settings.html" title="Nodes reload secure settings API">Nodes reload secure settings</a> API, instead of restarting the cluster.
Configuring the <code class="literal">remote_cluster_client</code> settings in <code class="literal">elasticsearch.yml</code> still requires a restart.</p>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="remote-clusters-connect-api-key"></a>Connect to a remote cluster<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/modules/cluster/remote-clusters-api-key.asciidoc">edit</a></h3>
</div></div></div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>You must have the <code class="literal">manage</code> cluster privilege to connect remote clusters.</p>
</div>
</div>
<p>The local cluster uses the <a class="xref" href="modules-network.html" title="Networking">remote cluster interface</a> to
establish communication with remote clusters. The coordinating nodes in the
local cluster establish <a class="xref" href="modules-network.html#long-lived-connections" title="Long-lived idle connections">long-lived</a> TCP connections
with specific nodes in the remote cluster. Elasticsearch requires these connections to
remain open, even if the connections are idle for an extended period.</p>
<p>To add a remote cluster from Stack Management in Kibana:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Select <span class="strong strong"><strong>Remote Clusters</strong></span> from the side navigation.
</li>
<li class="listitem">
Enter a name (<em>cluster alias</em>) for the remote cluster.
</li>
<li class="listitem">
Specify the Elasticsearch endpoint URL, or the IP address or host name of the remote
cluster followed by the remote cluster port (defaults to
<code class="literal">9443</code>). For example,
<code class="literal">cluster.es.eastus2.staging.azure.foundit.no:9443</code> or
<code class="literal">192.168.1.1:9443</code>.
</li>
</ol>
</div>
<p>Alternatively, use the <a class="xref" href="cluster-update-settings.html" title="Cluster update settings API">cluster update settings API</a>
to add a remote cluster. You can also use this API to dynamically configure
remote clusters for <em>every</em> node in the local cluster. To configure remote
clusters on individual nodes in the local cluster, define static settings in
<code class="literal">elasticsearch.yml</code> for each node.</p>
<p>The following request adds a remote cluster with an alias of <code class="literal">cluster_one</code>. This
<em>cluster alias</em> is a unique identifier that represents the connection to the
remote cluster and is used to distinguish between local and remote indices.</p>
<a id="0b1c5486f96bfa5db8db854c0178dbe5"></a>
<div class="pre_wrapper lang-console">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console">PUT /_cluster/settings
{
  "persistent" : {
    "cluster" : {
      "remote" : {
        "cluster_one" : {    <a id="CO21-1"></a><i class="conum" data-value="1"></i>
          "seeds" : [
            "127.0.0.1:9443" <a id="CO21-2"></a><i class="conum" data-value="2"></i>
          ]
        }
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/51.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO21-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>The cluster alias of this remote cluster is <code class="literal">cluster_one</code>.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO21-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>Specifies the hostname and remote cluster port of a seed node in the
remote cluster.</p>
</td>
</tr>
</table>
</div>
<p>You can use the <a class="xref" href="cluster-remote-info.html" title="Remote cluster info API">remote cluster info API</a> to verify that
the local cluster is successfully connected to the remote cluster:</p>
<div class="pre_wrapper lang-python alternative">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-python alternative">resp = client.cluster.remote_info()
print(resp)</pre>
</div>
<div class="pre_wrapper lang-ruby alternative">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ruby alternative">response = client.cluster.remote_info
puts response</pre>
</div>
<a id="cc0cca5556ec6224c7134c233734beed"></a>
<div class="pre_wrapper lang-console default has-python has-ruby">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console default has-python has-ruby">GET /_remote/info</pre>
</div>
<div class="console_widget has-python has-ruby" data-snippet="snippets/52.console"></div>
<p>The API response indicates that the local cluster is connected to the remote
cluster with the cluster alias <code class="literal">cluster_one</code>:</p>
<a id="f4b7b11eca3e34d50dfd403c90b9b0ff"></a>
<div class="pre_wrapper lang-console-result">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console-result">{
  "cluster_one" : {
    "seeds" : [
      "127.0.0.1:9443"
    ],
    "connected" : true,
    "num_nodes_connected" : 1,  <a id="CO22-1"></a><i class="conum" data-value="1"></i>
    "max_connections_per_cluster" : 3,
    "initial_connect_timeout" : "30s",
    "skip_unavailable" : true, <a id="CO22-2"></a><i class="conum" data-value="2"></i>
    "cluster_credentials": "::es_redacted::", <a id="CO22-3"></a><i class="conum" data-value="3"></i>
    "mode" : "sniff"
  }
}</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO22-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>The number of nodes in the remote cluster the local cluster is
connected to.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO22-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>Indicates whether to skip the remote cluster if searched through cross-cluster search but
no nodes are available.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO22-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>If present, indicates the remote cluster has connected using API key
authentication.</p>
</td>
</tr>
</table>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_dynamically_configure_remote_clusters"></a>Dynamically configure remote clusters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/modules/cluster/remote-clusters-connect.asciidoc">edit</a></h4>
</div></div></div>
<p>Use the <a class="xref" href="cluster-update-settings.html" title="Cluster update settings API">cluster update settings API</a> to dynamically
configure remote settings on every node in the cluster. The following request
adds three remote clusters: <code class="literal">cluster_one</code>, <code class="literal">cluster_two</code>, and <code class="literal">cluster_three</code>.</p>
<p>The <code class="literal">seeds</code> parameter specifies the hostname and
<a class="xref" href="modules-network.html" title="Networking">remote cluster port</a> (default
<code class="literal">9443</code>) of a seed node in the remote cluster.</p>
<p>The <code class="literal">mode</code> parameter determines the configured connection mode, which defaults
to <a class="xref" href="remote-clusters.html#sniff-mode"><code class="literal">sniff</code></a>. Because <code class="literal">cluster_one</code> doesn&#8217;t specify a <code class="literal">mode</code>, it
uses the default. Both <code class="literal">cluster_two</code> and <code class="literal">cluster_three</code> explicitly use
different modes.</p>
<a id="b4f4c9ad3301c97fb3c38d108a3bc453"></a>
<div class="pre_wrapper lang-console">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console">PUT _cluster/settings
{
  "persistent": {
    "cluster": {
      "remote": {
        "cluster_one": {
          "seeds": [
            "127.0.0.1:9443"
          ]
        },
        "cluster_two": {
          "mode": "sniff",
          "seeds": [
            "127.0.0.1:9444"
          ],
          "transport.compress": true,
          "skip_unavailable": true
        },
        "cluster_three": {
          "mode": "proxy",
          "proxy_address": "127.0.0.1:9445"
        }
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/53.console"></div>
<p>You can dynamically update settings for a remote cluster after the initial
configuration. The following request updates the compression settings for
<code class="literal">cluster_two</code>, and the compression and ping schedule settings for
<code class="literal">cluster_three</code>.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>When the compression or ping schedule settings change, all existing
node connections must close and re-open, which can cause in-flight requests to
fail.</p>
</div>
</div>
<div class="pre_wrapper lang-ruby alternative">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ruby alternative">response = client.cluster.put_settings(
  body: {
    persistent: {
      cluster: {
        remote: {
          cluster_two: {
            'transport.compress' =&gt; false
          },
          cluster_three: {
            'transport.compress' =&gt; true,
            'transport.ping_schedule' =&gt; '60s'
          }
        }
      }
    }
  }
)
puts response</pre>
</div>
<a id="b1f7cb4157b13368373383abd7d2b8cb"></a>
<div class="pre_wrapper lang-console default has-ruby">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console default has-ruby">PUT _cluster/settings
{
  "persistent": {
    "cluster": {
      "remote": {
        "cluster_two": {
          "transport.compress": false
        },
        "cluster_three": {
          "transport.compress": true,
          "transport.ping_schedule": "60s"
        }
      }
    }
  }
}</pre>
</div>
<div class="console_widget has-ruby" data-snippet="snippets/54.console"></div>
<p>You can delete a remote cluster from the cluster settings by passing <code class="literal">null</code>
values for each remote cluster setting. The following request removes
<code class="literal">cluster_two</code> from the cluster settings, leaving <code class="literal">cluster_one</code> and
<code class="literal">cluster_three</code> intact:</p>
<div class="pre_wrapper lang-ruby alternative">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ruby alternative">response = client.cluster.put_settings(
  body: {
    persistent: {
      cluster: {
        remote: {
          cluster_two: {
            mode: nil,
            seeds: nil,
            skip_unavailable: nil,
            'transport.compress' =&gt; nil
          }
        }
      }
    }
  }
)
puts response</pre>
</div>
<a id="7456ef459d510d66ba4492cc9fbdc6c6"></a>
<div class="pre_wrapper lang-console default has-ruby">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console default has-ruby">PUT _cluster/settings
{
  "persistent": {
    "cluster": {
      "remote": {
        "cluster_two": {
          "mode": null,
          "seeds": null,
          "skip_unavailable": null,
          "transport.compress": null
        }
      }
    }
  }
}</pre>
</div>
<div class="console_widget has-ruby" data-snippet="snippets/55.console"></div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_statically_configure_remote_clusters"></a>Statically configure remote clusters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/modules/cluster/remote-clusters-connect.asciidoc">edit</a></h4>
</div></div></div>
<p>If you specify settings in <code class="literal">elasticsearch.yml</code>, only the nodes with
those settings can connect to the remote cluster and serve remote cluster
requests.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Remote cluster settings that are specified using the
<a class="xref" href="cluster-update-settings.html" title="Cluster update settings API">cluster update settings API</a> take precedence over
settings that you specify in <code class="literal">elasticsearch.yml</code> for individual nodes.</p>
</div>
</div>
<p>In the following example, <code class="literal">cluster_one</code>, <code class="literal">cluster_two</code>, and <code class="literal">cluster_three</code> are
arbitrary cluster aliases representing the connection to each cluster. These
names are subsequently used to distinguish between local and remote indices.</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">cluster:
    remote:
        cluster_one:
            seeds: 127.0.0.1:9443
        cluster_two:
            mode: sniff
            seeds: 127.0.0.1:9444
            transport.compress: true      <a id="CO23-1"></a><i class="conum" data-value="1"></i>
            skip_unavailable: true        <a id="CO23-2"></a><i class="conum" data-value="2"></i>
        cluster_three:
            mode: proxy
            proxy_address: 127.0.0.1:9445 <a id="CO23-3"></a><i class="conum" data-value="3"></i></pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO23-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Compression is explicitly enabled for requests to <code class="literal">cluster_two</code>.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO23-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>Disconnected remote clusters are optional for <code class="literal">cluster_two</code>.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO23-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>The address for the proxy endpoint used to connect to <code class="literal">cluster_three</code>.</p>
</td>
</tr>
</table>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="remote-clusters-privileges-api-key"></a>Configure roles and users<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/security/authentication/remote-clusters-privileges-api-key.asciidoc">edit</a></h3>
</div></div></div>
<p>To use a remote cluster for cross-cluster replication or cross-cluster search, you need to create user roles with
<a class="xref" href="defining-roles.html#roles-remote-indices-priv" title="Remote indices privileges">remote indices privileges</a> on the local cluster.</p>
<p>You can manage users and roles from Stack Management in Kibana by selecting
<span class="strong strong"><strong>Security &gt; Roles</strong></span> from the side navigation. You can also use the
<a class="xref" href="security-api.html#security-role-apis" title="Roles">role management APIs</a> to add, update, remove, and retrieve
roles dynamically.</p>
<p>The following examples use the <a class="xref" href="security-api-put-role.html" title="Create or update roles API">Create or update roles</a> API. You must have at
least the <code class="literal">manage_security</code> cluster privilege to use this API.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The cross-cluster API key used by the local cluster to connect the remote
cluster must have sufficient privileges to cover all remote indices privileges
required by individual users.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_configure_privileges_for_cross_cluster_replication"></a>Configure privileges for cross-cluster replication<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/security/authentication/remote-clusters-privileges-api-key.asciidoc">edit</a></h4>
</div></div></div>
<p>Assuming the remote cluster is connected under the name of <code class="literal">my_remote_cluster</code>,
the following request creates a role called <code class="literal">remote-replication</code> on the local
cluster that allows replicating the remote <code class="literal">leader-index</code> index:</p>
<a id="fd7eeadab6251d9113c4380a7fbe2572"></a>
<div class="pre_wrapper lang-console">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console">POST /_security/role/remote-replication
{
  "cluster": [
    "manage_ccr"
  ],
  "remote_indices": [
    {
      "clusters": [ "my_remote_cluster" ],
      "names": [
        "leader-index"
      ],
      "privileges": [
        "cross_cluster_replication"
      ]
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/56.console"></div>
<p>After creating the local <code class="literal">remote-replication</code> role, use the
<a class="xref" href="security-api-put-user.html" title="Create or update users API">Create or update users</a> API to create a user on the local cluster cluster and
assign the <code class="literal">remote-replication</code> role. For example, the following request assigns
the <code class="literal">remote-replication</code> role to a user named <code class="literal">cross-cluster-user</code>:</p>
<a id="9d5855075e7008270459cc88c189043d"></a>
<div class="pre_wrapper lang-console">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console">POST /_security/user/cross-cluster-user
{
  "password" : "l0ng-r4nd0m-p@ssw0rd",
  "roles" : [ "remote-replication" ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/57.console"></div>
<p>Note that you only need to create this user on the local cluster.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_configure_privileges_for_cross_cluster_search"></a>Configure privileges for cross-cluster search<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/security/authentication/remote-clusters-privileges-api-key.asciidoc">edit</a></h4>
</div></div></div>
<p>Assuming the remote cluster is connected under the name of <code class="literal">my_remote_cluster</code>,
the following request creates a <code class="literal">remote-search</code> role on the local cluster that
allows searching the remote <code class="literal">target-index</code> index:</p>
<a id="d69bd36335774c8ae1286cee21310241"></a>
<div class="pre_wrapper lang-console">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console">POST /_security/role/remote-search
{
  "remote_indices": [
    {
      "clusters": [ "my_remote_cluster" ],
      "names": [
        "target-index"
      ],
      "privileges": [
        "read",
        "read_cross_cluster",
        "view_index_metadata"
      ]
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/58.console"></div>
<p>After creating the <code class="literal">remote-search</code> role, use the <a class="xref" href="security-api-put-user.html" title="Create or update users API">Create or update users</a> API
to create a user on the local cluster and assign the <code class="literal">remote-search</code> role. For
example, the following request assigns the <code class="literal">remote-search</code> role to a user named
<code class="literal">cross-search-user</code>:</p>
<a id="f187ac2dc35425cb0ef48f328cc7e435"></a>
<div class="pre_wrapper lang-console">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console">POST /_security/user/cross-search-user
{
  "password" : "l0ng-r4nd0m-p@ssw0rd",
  "roles" : [ "remote-search" ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/59.console"></div>
<p>Note that you only need to create this user on the local cluster.</p>
</div>

</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="remote-clusters.html">« Remote clusters</a>
</span>
<span class="next">
<a href="remote-clusters-cert.html">Add remote clusters using TLS certificate authentication »</a>
</span>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>

                        <!-- Feedback widget -->
                        <div id="feedbackWidgetContainer"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


        <div id='elastic-footer'></div>
        <script src='https://www.elastic.co/elastic-footer.js'></script>
        <!-- Footer Section end-->

      </section>
    </div>

    <!-- Feedback modal -->
    <div id="feedbackModalContainer"></div>

    <script src="/guide/static/jquery.js"></script>
    <script type="text/javascript" src="/guide/static/docs-v1.js"></script>
    <script type="text/javascript">
  window.initial_state = {"alternatives":{"console":{"php":{"hasAny":true},"python":{"hasAny":true},"ruby":{"hasAny":true},"go":{"hasAny":true},"js":{"hasAny":true}}}}</script>
  </body>
</html>
