<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Retrievers | Elasticsearch Guide [master] | Elastic</title>
<meta class="elastic" name="content" content="Retrievers | Elasticsearch Guide [master]">

<link rel="home" href="index.html" title="Elasticsearch Guide [master]"/>
<link rel="up" href="search-with-elasticsearch.html" title="Search your data"/>
<link rel="prev" href="cohere-es.html" title="Tutorial: Using Cohere with Elasticsearch"/>
<link rel="next" href="learning-to-rank.html" title="Learning To Rank"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="Elasticsearch"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/master"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="master"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles-v1.css" />
  </head>

  <!--© 2015-2025 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div class="page_header">
This documentation contains work-in-progress information for future Elastic Stack and Cloud releases. Use the version selector to view supported release docs. It also contains some Elastic Cloud serverless information. Check out our <a href="https://www.elastic.co/docs/current/serverless">serverless docs</a> for more details.
</div>
<div class="navheader">
<span class="prev">
<a href="cohere-es.html">« Tutorial: Using Cohere with Elasticsearch</a>
</span>
<span class="next">
<a href="learning-to-rank.html">Learning To Rank »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elasticsearch Guide [master]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="search-with-elasticsearch.html">Search your data</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Retrievers</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/search/search-your-data/retrievers-overview.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="chapter">
<div class="titlepage"><div><div>
<h2 class="title"><a id="retrievers-overview"></a>Retrievers<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/search/search-your-data/retrievers-overview.asciidoc">edit</a></h2>
</div></div></div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in technical preview and may be changed or removed in a future release. Elastic will work to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.</p>
</div>
</div>
<p>A retriever is an abstraction that was added to the Search API in <span class="strong strong"><strong>8.14.0</strong></span>.
This abstraction enables the configuration of multi-stage retrieval pipelines within a single <code class="literal">_search</code> call.
This simplifies your search application logic, because you no longer need to configure complex searches via multiple Elasticsearch calls or implement additional client-side logic to combine results from different queries.</p>
<p>This document provides a general overview of the retriever abstraction.
For implementation details, including notable restrictions, check out the
<a class="xref" href="retriever.html" title="Retriever">reference documentation</a> in the <code class="literal">_search</code> API docs.</p>
<h3><a id="retrievers-overview-types"></a>Retriever types<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/search/search-your-data/retrievers-overview.asciidoc">edit</a></h3>
<p>Retrievers come in various types, each tailored for different search operations.
The following retrievers are currently available:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="retriever.html#standard-retriever" title="Standard Retriever"><span class="strong strong"><strong>Standard Retriever</strong></span></a>.
Returns top documents from a traditional <a href="/guide/en/elasticsearch/reference/master/query-dsl.html" class="ulink" target="_top">query</a>.
Mimics a traditional query but in the context of a retriever framework.
This ensures backward compatibility as existing <code class="literal">_search</code> requests remain supported.
That way you can transition to the new abstraction at your own pace without mixing syntaxes.
</li>
<li class="listitem">
<a class="xref" href="retriever.html#knn-retriever" title="kNN Retriever"><span class="strong strong"><strong>kNN Retriever</strong></span></a>.
Returns top documents from a <a class="xref" href="search-search.html#search-api-knn">knn search</a>, in the context of a retriever framework.
</li>
<li class="listitem">
<p><a class="xref" href="retriever.html#rrf-retriever" title="RRF Retriever"><span class="strong strong"><strong>RRF Retriever</strong></span></a>.
Combines and ranks multiple first-stage retrievers using the reciprocal rank fusion (RRF) algorithm.
Allows you to combine multiple result sets with different relevance indicators into a single result set.
An RRF retriever is a <span class="strong strong"><strong>compound retriever</strong></span>, where its <code class="literal">filter</code> element is propagated to its sub retrievers.</p>
<p>Sub retrievers may not use elements that are restricted by having a compound retriever as part of the retriever tree.
See the <a class="xref" href="rrf.html#rrf-using-multiple-standard-retrievers" title="Reciprocal rank fusion using multiple standard retrievers">RRF documentation</a> for detailed examples and information on how to use the RRF retriever.</p>
</li>
</ul>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Stay tuned for more retriever types in future releases!</p>
</div>
</div>
<h3><a id="_what_makes_retrievers_useful"></a>What makes retrievers useful?<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/search/search-your-data/retrievers-overview.asciidoc">edit</a></h3>
<p>Here&#8217;s an overview of what makes retrievers useful and how they differ from regular queries.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<span class="strong strong"><strong>Simplified user experience</strong></span>.
Retrievers simplify the user experience by allowing entire retrieval pipelines to be configured in a single API call.
This maintains backward compatibility with traditional query elements by automatically translating them to the appropriate retriever.
</li>
<li class="listitem">
<span class="strong strong"><strong>Structured retrieval</strong></span>.
Retrievers provide a more structured way to define search operations.
They allow searches to be described using a "retriever tree", a hierarchical structure that clarifies the sequence and logic of operations, making complex searches more understandable and manageable.
</li>
<li class="listitem">
<span class="strong strong"><strong>Composability and flexibility</strong></span>.
Retrievers enable flexible composability, allowing you to build pipelines and seamlessly integrate different retrieval strategies into these pipelines.
Retrievers make it easy to test out different retrieval strategy combinations.
</li>
<li class="listitem">
<span class="strong strong"><strong>Compound operations</strong></span>.
A retriever can have sub retrievers.
This allows complex nested searches where the results of one retriever feed into another, supporting sophisticated querying strategies that might involve multiple stages or criteria.
</li>
<li class="listitem">
<span class="strong strong"><strong>Retrieval as a first-class concept</strong></span>.
Unlike traditional queries, where the query is a part of a larger search API call, retrievers are designed as standalone entities that can be combined or used in isolation.
This enables a more modular and flexible approach to constructing searches.
</li>
<li class="listitem">
<span class="strong strong"><strong>Enhanced control over document scoring and ranking</strong></span>.
Retrievers allow for more explicit control over how documents are scored and filtered.
For instance, you can specify minimum score thresholds, apply complex filters without affecting scoring, and use parameters like <code class="literal">terminate_after</code> for performance optimizations.
</li>
<li class="listitem">
<span class="strong strong"><strong>Integration with existing Elasticsearch functionalities</strong></span>.
Even though retrievers can be used instead of existing <code class="literal">_search</code> API syntax (like the
<code class="literal">query</code> and <code class="literal">knn</code>), they are designed to integrate seamlessly with things like pagination (<code class="literal">search_after</code>) and sorting.
They also maintain compatibility with aggregation operations by treating the combination of all leaf retrievers as
<code class="literal">should</code> clauses in a boolean query.
</li>
<li class="listitem">
<span class="strong strong"><strong>Cleaner separation of concerns</strong></span>.
When using compound retrievers, only the query element is allowed, which enforces a cleaner separation of concerns and prevents the complexity that might arise from overly nested or interdependent configurations.
</li>
</ol>
</div>
<h3><a id="retrievers-overview-example"></a>Example<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/search/search-your-data/retrievers-overview.asciidoc">edit</a></h3>
<p>The following example demonstrates how using retrievers simplify the composability of queries for RRF ranking.</p>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">GET example-index/_search
{
  "retriever": {
    "rrf": {
      "retrievers": [
        {
          "standard": {
            "query": {
              "sparse_vector": {
                "field": "vector.tokens",
                "inference_id": "my-elser-endpoint",
                "query": "What blue shoes are on sale?"
              }
            }
          }
        },
        {
          "standard": {
            "query": {
              "match": {
                "text": "blue shoes sale"
              }
            }
          }
        }
      ]
    }
  }
}</pre>
</div>
<p>This example demonstrates how you can combine different retrieval strategies into a single <code class="literal">retriever</code> pipeline.</p>
<p>Compare to <code class="literal">RRF</code> with <code class="literal">sub_searches</code> approach:</p>
<details>
<summary class="title"><span class="strong strong"><strong>Expand</strong></span> for example</summary>
<div class="content">
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">GET example-index/_search
{
  "sub_searches":[
    {
      "query":{
        "match":{
          "text":"blue shoes sale"
        }
      }
    },
    {
      "query":{
        "sparse_vector": {
            "field": "vector.tokens",
            "inference_id": "my-elser-endoint",
            "query": "What blue shoes are on sale?"
          }
        }
      }
  ],
  "rank":{
    "rrf":{
      "window_size":50,
      "rank_constant":20
    }
  }
}</pre>
</div>
</div>
</details>
<h3><a id="retrievers-overview-glossary"></a>Glossary<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/search/search-your-data/retrievers-overview.asciidoc">edit</a></h3>
<p>Here are some important terms:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Retrieval Pipeline</strong></span>.
Defines the entire retrieval and ranking logic to produce top hits.
</li>
<li class="listitem">
<span class="strong strong"><strong>Retriever Tree</strong></span>.
A hierarchical structure that defines how retrievers interact.
</li>
<li class="listitem">
<span class="strong strong"><strong>First-stage Retriever</strong></span>.
Returns an initial set of candidate documents.
</li>
<li class="listitem">
<span class="strong strong"><strong>Compound Retriever</strong></span>.
Builds on one or more retrievers, enhancing document retrieval and ranking logic.
</li>
<li class="listitem">
<span class="strong strong"><strong>Combiners</strong></span>.
Compound retrievers that merge top hits from multiple sub-retrievers.
</li>
</ul>
</div>
<h3><a id="retrievers-overview-play-in-search"></a>Retrievers in action<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/search/search-your-data/retrievers-overview.asciidoc">edit</a></h3>
<p>The Search Playground builds Elasticsearch queries using the retriever abstraction.
It automatically detects the fields and types in your index and builds a retriever tree based on your selections.</p>
<p>You can use the Playground to experiment with different retriever configurations and see how they affect search results.</p>
<p>Refer to the <a href="/guide/en/kibana/master/playground.html" class="ulink" target="_top">Playground documentation</a> for more information.</p>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="cohere-es.html">« Tutorial: Using Cohere with Elasticsearch</a>
</span>
<span class="next">
<a href="learning-to-rank.html">Learning To Rank »</a>
</span>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>

                        <!-- Feedback widget -->
                        <div id="feedbackWidgetContainer"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


        <div id='elastic-footer'></div>
        <script src='https://www.elastic.co/elastic-footer.js'></script>
        <!-- Footer Section end-->

      </section>
    </div>

    <!-- Feedback modal -->
    <div id="feedbackModalContainer"></div>

    <script src="/guide/static/jquery.js"></script>
    <script type="text/javascript" src="/guide/static/docs-v1.js"></script>
    <script type="text/javascript">
  window.initial_state = {"alternatives":{"console":{"php":{"hasAny":true},"python":{"hasAny":true},"ruby":{"hasAny":true},"go":{"hasAny":true},"js":{"hasAny":true}}}}</script>
  </body>
</html>
