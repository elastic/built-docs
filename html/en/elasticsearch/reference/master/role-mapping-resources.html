<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<meta name="keywords" content="Elasticsearch diagnostic, diagnostics">
<title>Role mapping resources | Elasticsearch Guide [master] | Elastic</title>
<meta class="elastic" name="content" content="Role mapping resources | Elasticsearch Guide [master]">

<link rel="home" href="index.html" title="Elasticsearch Guide [master]"/>
<link rel="up" href="api-definitions.html" title="Definitions"/>
<link rel="prev" href="api-definitions.html" title="Definitions"/>
<link rel="next" href="breaking-changes.html" title="Migration guide"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="Elasticsearch"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/master"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="master"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles-v1.css" />
  </head>

  <!--© 2015-2025 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div class="page_header">
This documentation contains work-in-progress information for future Elastic Stack and Cloud releases. Use the version selector to view supported release docs. It also contains some Elastic Cloud serverless information. Check out our <a href="https://www.elastic.co/docs/current/serverless">serverless docs</a> for more details.
</div>
<div class="navheader">
<span class="prev">
<a href="api-definitions.html">« Definitions</a>
</span>
<span class="next">
<a href="breaking-changes.html">Migration guide »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elasticsearch Guide [master]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="rest-apis.html">REST APIs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="api-definitions.html">Definitions</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Role mapping resources</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/rest-api/security/role-mapping-resources.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="role-mapping-resources"></a>Role mapping resources<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/rest-api/security/role-mapping-resources.asciidoc">edit</a></h2>
</div></div></div>
<p>A role mapping resource has the following properties:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">enabled</code>
</span>
</dt>
<dd>
(Boolean)  Mappings that have <code class="literal">enabled</code> set to <code class="literal">false</code> are ignored when role
mapping is performed.
</dd>
<dt>
<span class="term">
<code class="literal">metadata</code>
</span>
</dt>
<dd>
(object) Additional metadata that helps define which roles are assigned to each
user. Within the <code class="literal">metadata</code> object, keys beginning with <code class="literal">_</code> are reserved for
system usage.
</dd>
<dt>
<span class="term">
<code class="literal">roles</code>
</span>
</dt>
<dd>
(list) A list of roles that are granted to the users that match the role mapping
rules.
</dd>
<dt>
<span class="term">
<code class="literal">rules</code>
</span>
</dt>
<dd>
<p>
(object) The rules that determine which users should be matched by the mapping.
A rule is a logical condition that is expressed by using a JSON DSL. The DSL supports the following rule types:
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">any</code>
</span>
</dt>
<dd>
(array of rules) If <span class="strong strong"><strong>any</strong></span> of its children are true, it evaluates to <code class="literal">true</code>.
</dd>
<dt>
<span class="term">
<code class="literal">all</code>
</span>
</dt>
<dd>
(array of rules) If <span class="strong strong"><strong>all</strong></span> of its children are true, it evaluates to <code class="literal">true</code>.
</dd>
<dt>
<span class="term">
<code class="literal">field</code>
</span>
</dt>
<dd>
(object) See <a class="xref" href="role-mapping-resources.html#mapping-roles-rule-field" title="Field rules">Field rules</a>.
</dd>
<dt>
<span class="term">
<code class="literal">except</code>
</span>
</dt>
<dd>
(object) A single rule as an object. Only valid as a child of an <code class="literal">all</code> rule. If
its child is <code class="literal">false</code>, the <code class="literal">except</code> is <code class="literal">true</code>.
</dd>
</dl>
</div>
</dd>
</dl>
</div>
<h4><a id="mapping-roles-rule-field"></a>Field rules<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/rest-api/security/role-mapping-resources.asciidoc">edit</a></h4>
<p>The <code class="literal">field</code> rule is the primary building block for a role mapping expression.
It takes a single object as its value and that object must contain a single
member with key <em>F</em> and value <em>V</em>. The field rule looks up the value of <em>F</em>
within the user object and then tests whether the user value <em>matches</em> the
provided value <em>V</em>.</p>
<p>The value specified in the field rule can be one of the following types:</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>Simple String</p></td>
<td align="left" valign="top"><p>Exactly matches the provided value.</p></td>
<td align="left" valign="top"><p><code class="literal">"esadmin"</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Wildcard String</p></td>
<td align="left" valign="top"><p>Matches the provided value using a wildcard.</p></td>
<td align="left" valign="top"><p><code class="literal">"*,dc=example,dc=com"</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Regular Expression</p></td>
<td align="left" valign="top"><p>Matches the provided value using a
                       <a class="xref" href="regexp-syntax.html" title="Regular expression syntax">Lucene regexp</a>.</p></td>
<td align="left" valign="top"><p><code class="literal">"/.*-admin[0-9]*/"</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Number</p></td>
<td align="left" valign="top"><p>Matches an equivalent numerical value.</p></td>
<td align="left" valign="top"><p><code class="literal">7</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Null</p></td>
<td align="left" valign="top"><p>Matches a null or missing value.</p></td>
<td align="left" valign="top"><p><code class="literal">null</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Array</p></td>
<td align="left" valign="top"><p>Tests each element in the array in
                      accordance with the above definitions.
                      If <em>any</em> of elements match, the match is successful.</p></td>
<td align="left" valign="top"><p><code class="literal">["admin", "operator"]</code></p></td>
</tr>
</tbody>
</table>
</div>
<h5><a id="_user_fields"></a>User fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/rest-api/security/role-mapping-resources.asciidoc">edit</a></h5>
<p>The <em>user object</em> against which rules are evaluated has the following fields:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">username</code>
</span>
</dt>
<dd>
(string) The username by which the Elasticsearch security features knows this user. For
example, <code class="literal">"username": "jsmith"</code>.
</dd>
<dt>
<span class="term">
<code class="literal">dn</code>
</span>
</dt>
<dd>
(string) The <em>Distinguished Name</em> of the user. For example, <code class="literal">"dn": "cn=jsmith,ou=users,dc=example,dc=com",</code>.
</dd>
<dt>
<span class="term">
<code class="literal">groups</code>
</span>
</dt>
<dd>
(array of strings) The groups to which the user belongs. For example, <code class="literal">"groups" : [ "cn=admin,ou=groups,dc=example,dc=com","cn=esusers,ou=groups,dc=example,dc=com ]</code>.
</dd>
<dt>
<span class="term">
<code class="literal">metadata</code>
</span>
</dt>
<dd>
(object) Additional metadata for the user. This can include a variety of key-value pairs. When referencing metadata fields in role mapping rules, use the dot notation to specify the key within the metadata object. If the key contains special characters such as parentheses, dots, or spaces, you must escape these characters using backslashes (<code class="literal">\</code>). For example, <code class="literal">"metadata": { "cn": "John Smith" }</code>.
</dd>
<dt>
<span class="term">
<code class="literal">realm</code>
</span>
</dt>
<dd>
(object) The realm that authenticated the user. The only field in this object is the realm name. For example, <code class="literal">"realm": { "name": "ldap1" }</code>.
</dd>
</dl>
</div>
<p>The <code class="literal">groups</code> field is multi-valued; a user can belong to many groups. When a
<code class="literal">field</code> rule is applied against a multi-valued field, it is considered to match
if <em>at least one</em> of the member values matches. For example, the following rule
matches any user who is a member of the <code class="literal">admin</code> group, regardless of any
other groups they belong to:</p>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">{ "field" : { "groups" : "admin" } }</pre>
</div>
<p>For additional realm-specific details, see
<a class="xref" href="mapping-roles.html#ldap-role-mapping" title="Active Directory and LDAP realms">Active Directory and LDAP realms</a>.</p>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="api-definitions.html">« Definitions</a>
</span>
<span class="next">
<a href="breaking-changes.html">Migration guide »</a>
</span>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>

                        <!-- Feedback widget -->
                        <div id="feedbackWidgetContainer"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


        <div id='elastic-footer'></div>
        <script src='https://www.elastic.co/elastic-footer.js'></script>
        <!-- Footer Section end-->

      </section>
    </div>

    <!-- Feedback modal -->
    <div id="feedbackModalContainer"></div>

    <script src="/guide/static/jquery.js"></script>
    <script type="text/javascript" src="/guide/static/docs-v1.js"></script>
    <script type="text/javascript">
  window.initial_state = {"alternatives":{"console":{"php":{"hasAny":true},"python":{"hasAny":true},"ruby":{"hasAny":true},"go":{"hasAny":true},"js":{"hasAny":true}}}}</script>
  </body>
</html>
