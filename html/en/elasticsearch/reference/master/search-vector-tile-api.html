<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<meta name="keywords" content="Elasticsearch diagnostic, diagnostics">
<title>Vector tile search API | Elasticsearch Guide [master] | Elastic</title>
<meta class="elastic" name="content" content="Vector tile search API | Elasticsearch Guide [master]">

<link rel="home" href="index.html" title="Elasticsearch Guide [master]"/>
<link rel="up" href="search.html" title="Search APIs"/>
<link rel="prev" href="search-rank-eval.html" title="Ranking evaluation API"/>
<link rel="next" href="search-application-apis.html" title="Search Application APIs"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="Elasticsearch"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/master"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="master"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles-v1.css" />
  </head>

  <!--© 2015-2025 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div class="page_header">
This documentation contains work-in-progress information for future Elastic Stack and Cloud releases. Use the version selector to view supported release docs. It also contains some Elastic Cloud serverless information. Check out our <a href="https://www.elastic.co/docs/current/serverless">serverless docs</a> for more details.
</div>
<div class="navheader">
<span class="prev">
<a href="search-rank-eval.html">« Ranking evaluation API</a>
</span>
<span class="next">
<a href="search-application-apis.html">Search Application APIs »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elasticsearch Guide [master]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="rest-apis.html">REST APIs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="search.html">Search APIs</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Vector tile search API</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/search/search-vector-tile-api.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="search-vector-tile-api"></a>Vector tile search API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/search/search-vector-tile-api.asciidoc">edit</a></h2>
</div></div></div>

<p>Searches a vector tile for geospatial values. Returns results as a binary
<a href="https://docs.mapbox.com/vector-tiles/specification" class="ulink" target="_top">Mapbox vector tile</a>.</p>
<div class="pre_wrapper lang-js alternative">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js alternative">const response = await client.searchMvt({
  index: "my-index",
  field: "my-geo-field",
  zoom: 15,
  x: 5271,
  y: 12710,
});
console.log(response);</pre>
</div>
<a id="34be27141e3a476c138546190101c8bc"></a>
<div class="pre_wrapper lang-console default has-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console default has-js">GET my-index/_mvt/my-geo-field/15/5271/12710</pre>
</div>
<div class="console_widget has-js" data-snippet="snippets/3138.console"></div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="search-vector-tile-api-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/search/search-vector-tile-api.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">GET &lt;target&gt;/_mvt/&lt;field&gt;/&lt;zoom&gt;/&lt;x&gt;/&lt;y&gt;</code></p>
<p><code class="literal">POST &lt;target&gt;/_mvt/&lt;field&gt;/&lt;zoom&gt;/&lt;x&gt;/&lt;y&gt;</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="search-vector-tile-api-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/search/search-vector-tile-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Before using this API, you should be familiar with the
<a href="https://github.com/mapbox/vector-tile-spec" class="ulink" target="_top">Mapbox vector tile specification</a>.
</li>
<li class="listitem">
If the Elasticsearch security features are enabled, you must have the <code class="literal">read</code>
<a class="xref" href="security-privileges.html#privileges-list-indices" title="Indices privileges">index privilege</a> for the target data stream, index,
or alias. For cross-cluster search, see <a class="xref" href="remote-clusters.html" title="Remote clusters"><em>Remote clusters</em></a>.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="search-vector-tile-api-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/search/search-vector-tile-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;target&gt;</code>
</span>
</dt>
<dd>
<p>
(Required, string) Comma-separated list of data streams, indices, or aliases to
search. Supports wildcards (<code class="literal">*</code>). To search all data streams and indices, omit
this parameter or use <code class="literal">*</code> or <code class="literal">_all</code>.
</p>
<p>To search a remote cluster, use the <code class="literal">&lt;cluster&gt;:&lt;target&gt;</code> syntax. See
<a class="xref" href="modules-cross-cluster-search.html" title="Search across clusters"><em>Search across clusters</em></a>.</p>
</dd>
<dt>
<span class="term">
<code class="literal">&lt;field&gt;</code>
</span>
</dt>
<dd>
<p>
(Required, string) Field containing geospatial values to return. Must be a
<a class="xref" href="geo-point.html" title="Geopoint field type"><code class="literal">geo_point</code></a> or <a class="xref" href="geo-shape.html" title="Geoshape field type"><code class="literal">geo_shape</code></a> field. The field must
have <a class="xref" href="doc-values.html" title="doc_values">doc values</a> enabled. Cannot be a nested field.
</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Vector tiles do not natively support geometry collections. For
<code class="literal">geometrycollection</code> values in a <code class="literal">geo_shape</code> field, the API returns a <code class="literal">hits</code>
layer feature for each element of the collection.
This behavior may change in a future release.</p>
</div>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">&lt;zoom&gt;</code>
</span>
</dt>
<dd>
(Required, integer) Zoom level for the vector tile to search. Accepts <code class="literal">0</code>-<code class="literal">29</code>.
</dd>
<dt>
<span class="term">
<code class="literal">&lt;x&gt;</code>
</span>
</dt>
<dd>
(Required, integer) X coordinate for the vector tile to search.
</dd>
<dt>
<span class="term">
<code class="literal">&lt;y&gt;</code>
</span>
</dt>
<dd>
(Required, integer) Y coordinate for the vector tile to search.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="search-vector-tile-api-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/search/search-vector-tile-api.asciidoc">edit</a></h3>
</div></div></div>
<p>Internally, Elasticsearch translates a vector tile search API request into a
<a class="xref" href="search-search.html" title="Search API">search</a> containing:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
A <a class="xref" href="query-dsl-geo-bounding-box-query.html" title="Geo-bounding box query"><code class="literal">geo_bounding_box</code></a> query on the
<code class="literal">&lt;field&gt;</code>. The query uses the <code class="literal">&lt;zoom&gt;/&lt;x&gt;/&lt;y&gt;</code> tile as a bounding box.
</li>
<li class="listitem">
A <a class="xref" href="search-aggregations-bucket-geotilegrid-aggregation.html" title="Geotile grid aggregation"><code class="literal">geotile_grid</code></a> or
<a class="xref" href="search-aggregations-bucket-geohexgrid-aggregation.html" title="Geohex grid aggregation"><code class="literal">geohex_grid</code></a> aggregation
on the <code class="literal">&lt;field&gt;</code>. The <code class="literal">grid_agg</code> parameter determines the aggregation type. The
aggregation uses the <code class="literal">&lt;zoom&gt;/&lt;x&gt;/&lt;y&gt;</code> tile as a bounding box.
</li>
<li class="listitem">
Optionally, a
<a class="xref" href="search-aggregations-metrics-geobounds-aggregation.html" title="Geo-bounds aggregation"><code class="literal">geo_bounds</code></a> aggregation
on the <code class="literal">&lt;field&gt;</code>. The search only includes this aggregation if the
<code class="literal">exact_bounds</code> parameter is <code class="literal">true</code>.
</li>
<li class="listitem">
If the optional parameter <code class="literal">with_labels</code> is true, the internal search will include
a dynamic runtime field that calls the <code class="literal">getLabelPosition</code> function of the geometry doc value.
This enables the generation of new point features containing suggested geometry labels,
so that, for example, multi-polygons will have only one label.
</li>
</ul>
</div>
<p>For example, Elasticsearch may translate a vector tile search API request with a
<code class="literal">grid_agg</code> argument of <code class="literal">geotile</code> and an <code class="literal">exact_bounds</code> argument of <code class="literal">true</code>
into the following search:</p>
<div class="pre_wrapper lang-js alternative">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js alternative">const response = await client.search({
  index: "my-index",
  size: 10000,
  query: {
    geo_bounding_box: {
      "my-geo-field": {
        top_left: {
          lat: -40.979898069620134,
          lon: -45,
        },
        bottom_right: {
          lat: -66.51326044311186,
          lon: 0,
        },
      },
    },
  },
  aggregations: {
    grid: {
      geotile_grid: {
        field: "my-geo-field",
        precision: 11,
        size: 65536,
        bounds: {
          top_left: {
            lat: -40.979898069620134,
            lon: -45,
          },
          bottom_right: {
            lat: -66.51326044311186,
            lon: 0,
          },
        },
      },
    },
    bounds: {
      geo_bounds: {
        field: "my-geo-field",
        wrap_longitude: false,
      },
    },
  },
});
console.log(response);</pre>
</div>
<a id="9a49b7572d571e00e20dbebdd30f9368"></a>
<div class="pre_wrapper lang-console default has-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console default has-js">GET my-index/_search
{
  "size": 10000,
  "query": {
    "geo_bounding_box": {
      "my-geo-field": {
        "top_left": {
          "lat": -40.979898069620134,
          "lon": -45
        },
        "bottom_right": {
          "lat": -66.51326044311186,
          "lon": 0
        }
      }
    }
  },
  "aggregations": {
    "grid": {
      "geotile_grid": {
        "field": "my-geo-field",
        "precision": 11,
        "size": 65536,
        "bounds": {
          "top_left": {
            "lat": -40.979898069620134,
            "lon": -45
          },
          "bottom_right": {
            "lat": -66.51326044311186,
            "lon": 0
          }
        }
      }
    },
    "bounds": {
      "geo_bounds": {
        "field": "my-geo-field",
        "wrap_longitude": false
      }
    }
  }
}</pre>
</div>
<div class="console_widget has-js" data-snippet="snippets/3139.console"></div>
<p>The API returns results as a binary
<a href="https://github.com/mapbox/vector-tile-spec" class="ulink" target="_top">Mapbox vector tile</a>. Mapbox vector
tiles are encoded as <a href="https://github.com/protocolbuffers/protobuf" class="ulink" target="_top">Google
Protobufs (PBF)</a>. By default, the tile contains three layers:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
A <code class="literal">hits</code> layer containing a feature for each <code class="literal">&lt;field&gt;</code> value matching the
<code class="literal">geo_bounding_box</code> query.
</li>
<li class="listitem">
An <code class="literal">aggs</code> layer containing a feature for each cell of the <code class="literal">geotile_grid</code> or
<code class="literal">geohex_grid</code>. The layer only contains features for cells with matching data.
</li>
<li class="listitem">
<p>A <code class="literal">meta</code> layer containing:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
A feature containing a bounding box. By default, this is the bounding box of
the tile.
</li>
<li class="listitem">
Value ranges for any sub-aggregations on the <code class="literal">geotile_grid</code> or <code class="literal">geohex_grid</code>.
</li>
<li class="listitem">
Metadata for the search.
</li>
</ul>
</div>
</li>
</ul>
</div>
<p>The API only returns features that can display at its zoom level. For example,
if a polygon feature has no area at its zoom level, the API omits it.</p>
<p>The API returns errors as UTF-8 encoded JSON.</p>
</div>

<div class="section child_attributes">
<div class="titlepage"><div><div>
<h3 class="title"><a id="search-vector-tile-api-query-params"></a>Query parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/search/search-vector-tile-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>You can specify several options for this API as either a query
parameter or request body parameter. If you specify both parameters, the query
parameter takes precedence.</p>
</div>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">exact_bounds</code>
</span>
</dt>
<dd>
<p>
(Optional, Boolean)
If <code class="literal">false</code>, the <code class="literal">meta</code> layer&#8217;s feature is the bounding box of the tile. Defaults
to <code class="literal">false</code>.
</p>
<p>If <code class="literal">true</code>, the <code class="literal">meta</code> layer&#8217;s feature is a bounding box resulting from a
<a class="xref" href="search-aggregations-metrics-geobounds-aggregation.html" title="Geo-bounds aggregation"><code class="literal">geo_bounds</code></a> aggregation.
The aggregation runs on <code class="literal">&lt;field&gt;</code> values that intersect the <code class="literal">&lt;zoom&gt;/&lt;x&gt;/&lt;y&gt;</code>
tile with <code class="literal">wrap_longitude</code> set to <code class="literal">false</code>. The resulting bounding box may be
larger than the vector tile.</p>
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">extent</code>
</span>
</dt>
<dd>
(Optional, integer) Size, in pixels, of a side of the tile. Vector tiles are
square with equal sides. Defaults to <code class="literal">4096</code>.
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">buffer</code>
</span>
</dt>
<dd>
(Optional, integer) Size, in pixels, of a clipping buffer outside the tile.
This allows renderers to avoid outline artifacts from geometries that extend past the extent of the tile.
Defaults to <code class="literal">5</code>.
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">grid_agg</code>
</span>
</dt>
<dd>
<p>
(Optional, string) Aggregation used to create a grid for the <code class="literal">&lt;field&gt;</code>.
</p>
<details open>
<summary class="title">Valid values for <code class="literal">grid_agg</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">geotile</code> (Default)
</span>
</dt>
<dd>
<a class="xref" href="search-aggregations-bucket-geotilegrid-aggregation.html" title="Geotile grid aggregation"><code class="literal">geotile_grid</code></a> aggregation.
</dd>
<dt>
<span class="term">
<code class="literal">geohex</code>
</span>
</dt>
<dd>
<a class="xref" href="search-aggregations-bucket-geohexgrid-aggregation.html" title="Geohex grid aggregation"><code class="literal">geohex_grid</code></a> aggregation.
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">grid_precision</code>
</span>
</dt>
<dd>
<p>
(Optional, integer) Precision level for cells in the <code class="literal">grid_agg</code>. Accepts
<code class="literal">0</code>-<code class="literal">8</code>. Defaults to <code class="literal">8</code>. If <code class="literal">0</code>, results don&#8217;t include the <code class="literal">aggs</code> layer.
</p>
<details open>
<summary class="title">Grid precision for <code class="literal">geotile</code></summary>
<div class="content">
<p>For a <code class="literal">grid_agg</code> of <code class="literal">geotile</code>, you can use cells in the <code class="literal">aggs</code> layer as tiles
for lower zoom levels. <code class="literal">grid_precision</code> represents the additional zoom levels
available through these cells. The final precision is computed by as
follows:</p>
<p><code class="literal">&lt;zoom&gt; + grid_precision</code></p>
<p>For example, if <code class="literal">&lt;zoom&gt;</code> is <code class="literal">7</code> and <code class="literal">grid_precision</code> is <code class="literal">8</code>, then the
<code class="literal">geotile_grid</code> aggregation will use a precision of <code class="literal">15</code>. The maximum final
precision is <code class="literal">29</code>.</p>
<p>The <code class="literal">grid_precision</code> also determines the number of cells for the grid as
follows:</p>
<p><code class="literal">(2^grid_precision) x (2^grid_precision)</code></p>
<p>For example, a value of <code class="literal">8</code> divides the tile into a grid of 256 x 256 cells. The
<code class="literal">aggs</code> layer only contains features for cells with matching data.</p>
</div>
</details>
<details open>
<summary class="title">Grid precision for <code class="literal">geohex</code></summary>
<div class="content">
<p>For a <code class="literal">grid_agg</code> of <code class="literal">geohex</code>, Elasticsearch uses <code class="literal">&lt;zoom&gt;</code> and <code class="literal">grid_precision</code> to
calculate a final precision as follows:</p>
<p><code class="literal">&lt;zoom&gt; + grid_precision</code></p>
<p>This precision determines the <a href="https://h3geo.org/docs/core-library/restable" class="ulink" target="_top">H3
resolution of the hexagonal cells</a> produced by the <code class="literal">geohex</code> aggregation. The
following table maps the H3 resolution for each precision.</p>
<p>For example, if <code class="literal">&lt;zoom&gt;</code> is <code class="literal">3</code> and <code class="literal">grid_precision</code> is <code class="literal">3</code>, the precision is
<code class="literal">6</code>. At a precision of <code class="literal">6</code>, hexagonal cells have an H3 resolution of <code class="literal">2</code>. If
<code class="literal">&lt;zoom&gt;</code> is <code class="literal">3</code> and <code class="literal">grid_precision</code> is <code class="literal">4</code>, the precision is <code class="literal">7</code>. At a
precision of <code class="literal">7</code>, hexagonal cells have an H3 resolution of <code class="literal">3</code>.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
<col class="col_5"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Precision</th>
<th align="left" valign="top">Unique tile bins</th>
<th align="left" valign="top">H3 resolution</th>
<th align="left" valign="top">Unique hex bins</th>
<th align="left" valign="top">Ratio</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>1</p></td>
<td align="left" valign="top"><p>4</p></td>
<td align="left" valign="top"><p>0</p></td>
<td align="left" valign="top"><p>122</p></td>
<td align="left" valign="top"><p>30.5</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>2</p></td>
<td align="left" valign="top"><p>16</p></td>
<td align="left" valign="top"><p>0</p></td>
<td align="left" valign="top"><p>122</p></td>
<td align="left" valign="top"><p>7.625</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>3</p></td>
<td align="left" valign="top"><p>64</p></td>
<td align="left" valign="top"><p>1</p></td>
<td align="left" valign="top"><p>842</p></td>
<td align="left" valign="top"><p>13.15625</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>4</p></td>
<td align="left" valign="top"><p>256</p></td>
<td align="left" valign="top"><p>1</p></td>
<td align="left" valign="top"><p>842</p></td>
<td align="left" valign="top"><p>3.2890625</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>5</p></td>
<td align="left" valign="top"><p>1024</p></td>
<td align="left" valign="top"><p>2</p></td>
<td align="left" valign="top"><p>5882</p></td>
<td align="left" valign="top"><p>5.744140625</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>6</p></td>
<td align="left" valign="top"><p>4096</p></td>
<td align="left" valign="top"><p>2</p></td>
<td align="left" valign="top"><p>5882</p></td>
<td align="left" valign="top"><p>1.436035156</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>7</p></td>
<td align="left" valign="top"><p>16384</p></td>
<td align="left" valign="top"><p>3</p></td>
<td align="left" valign="top"><p>41162</p></td>
<td align="left" valign="top"><p>2.512329102</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>8</p></td>
<td align="left" valign="top"><p>65536</p></td>
<td align="left" valign="top"><p>3</p></td>
<td align="left" valign="top"><p>41162</p></td>
<td align="left" valign="top"><p>0.6280822754</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>9</p></td>
<td align="left" valign="top"><p>262144</p></td>
<td align="left" valign="top"><p>4</p></td>
<td align="left" valign="top"><p>288122</p></td>
<td align="left" valign="top"><p>1.099098206</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>10</p></td>
<td align="left" valign="top"><p>1048576</p></td>
<td align="left" valign="top"><p>4</p></td>
<td align="left" valign="top"><p>288122</p></td>
<td align="left" valign="top"><p>0.2747745514</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>11</p></td>
<td align="left" valign="top"><p>4194304</p></td>
<td align="left" valign="top"><p>5</p></td>
<td align="left" valign="top"><p>2016842</p></td>
<td align="left" valign="top"><p>0.4808526039</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>12</p></td>
<td align="left" valign="top"><p>16777216</p></td>
<td align="left" valign="top"><p>6</p></td>
<td align="left" valign="top"><p>14117882</p></td>
<td align="left" valign="top"><p>0.8414913416</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>13</p></td>
<td align="left" valign="top"><p>67108864</p></td>
<td align="left" valign="top"><p>6</p></td>
<td align="left" valign="top"><p>14117882</p></td>
<td align="left" valign="top"><p>0.2103728354</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>14</p></td>
<td align="left" valign="top"><p>268435456</p></td>
<td align="left" valign="top"><p>7</p></td>
<td align="left" valign="top"><p>98825162</p></td>
<td align="left" valign="top"><p>0.3681524172</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>15</p></td>
<td align="left" valign="top"><p>1073741824</p></td>
<td align="left" valign="top"><p>8</p></td>
<td align="left" valign="top"><p>691776122</p></td>
<td align="left" valign="top"><p>0.644266719</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>16</p></td>
<td align="left" valign="top"><p>4294967296</p></td>
<td align="left" valign="top"><p>8</p></td>
<td align="left" valign="top"><p>691776122</p></td>
<td align="left" valign="top"><p>0.1610666797</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>17</p></td>
<td align="left" valign="top"><p>17179869184</p></td>
<td align="left" valign="top"><p>9</p></td>
<td align="left" valign="top"><p>4842432842</p></td>
<td align="left" valign="top"><p>0.2818666889</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>18</p></td>
<td align="left" valign="top"><p>68719476736</p></td>
<td align="left" valign="top"><p>10</p></td>
<td align="left" valign="top"><p>33897029882</p></td>
<td align="left" valign="top"><p>0.4932667053</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>19</p></td>
<td align="left" valign="top"><p>274877906944</p></td>
<td align="left" valign="top"><p>11</p></td>
<td align="left" valign="top"><p>237279209162</p></td>
<td align="left" valign="top"><p>0.8632167343</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>20</p></td>
<td align="left" valign="top"><p>1099511627776</p></td>
<td align="left" valign="top"><p>11</p></td>
<td align="left" valign="top"><p>237279209162</p></td>
<td align="left" valign="top"><p>0.2158041836</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>21</p></td>
<td align="left" valign="top"><p>4398046511104</p></td>
<td align="left" valign="top"><p>12</p></td>
<td align="left" valign="top"><p>1660954464122</p></td>
<td align="left" valign="top"><p>0.3776573213</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>22</p></td>
<td align="left" valign="top"><p>17592186044416</p></td>
<td align="left" valign="top"><p>13</p></td>
<td align="left" valign="top"><p>11626681248842</p></td>
<td align="left" valign="top"><p>0.6609003122</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>23</p></td>
<td align="left" valign="top"><p>70368744177664</p></td>
<td align="left" valign="top"><p>13</p></td>
<td align="left" valign="top"><p>11626681248842</p></td>
<td align="left" valign="top"><p>0.165225078</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>24</p></td>
<td align="left" valign="top"><p>281474976710656</p></td>
<td align="left" valign="top"><p>14</p></td>
<td align="left" valign="top"><p>81386768741882</p></td>
<td align="left" valign="top"><p>0.2891438866</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>25</p></td>
<td align="left" valign="top"><p>1125899906842620</p></td>
<td align="left" valign="top"><p>15</p></td>
<td align="left" valign="top"><p>569707381193162</p></td>
<td align="left" valign="top"><p>0.5060018015</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>26</p></td>
<td align="left" valign="top"><p>4503599627370500</p></td>
<td align="left" valign="top"><p>15</p></td>
<td align="left" valign="top"><p>569707381193162</p></td>
<td align="left" valign="top"><p>0.1265004504</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>27</p></td>
<td align="left" valign="top"><p>18014398509482000</p></td>
<td align="left" valign="top"><p>15</p></td>
<td align="left" valign="top"><p>569707381193162</p></td>
<td align="left" valign="top"><p>0.03162511259</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>28</p></td>
<td align="left" valign="top"><p>72057594037927900</p></td>
<td align="left" valign="top"><p>15</p></td>
<td align="left" valign="top"><p>569707381193162</p></td>
<td align="left" valign="top"><p>0.007906278149</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>29</p></td>
<td align="left" valign="top"><p>288230376151712000</p></td>
<td align="left" valign="top"><p>15</p></td>
<td align="left" valign="top"><p>569707381193162</p></td>
<td align="left" valign="top"><p>0.001976569537</p></td>
</tr>
</tbody>
</table>
</div>
<p>Hexagonal cells don&#8217;t align perfectly on a vector tile. Some cells may intersect
more than one vector tile. To compute the H3 resolution for each precision, Elasticsearch
compares the average density of hexagonal bins at each resolution with the
average density of tile bins at each zoom level. Elasticsearch uses the H3 resolution
that is closest to the corresponding <code class="literal">geotile</code> density.</p>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">grid_type</code>
</span>
</dt>
<dd>
<p>
(Optional, string) Determines the geometry type for features in the <code class="literal">aggs</code>
layer. In the <code class="literal">aggs</code> layer, each feature represents a cell in the grid.
</p>
<details open>
<summary class="title">Valid values for <code class="literal">grid_type</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">grid</code> (Default)
</span>
</dt>
<dd>
Each feature is a <code class="literal">Polygon</code> of the cell&#8217;s geometry. For a <code class="literal">grid_agg</code> of
<code class="literal">geotile</code>, the feature is the cell&#8217;s bounding box. For a <code class="literal">grid_agg</code> of
<code class="literal">geohex</code>, the feature is the hexagonal cell&#8217;s boundaries.
</dd>
<dt>
<span class="term">
<code class="literal">point</code>
</span>
</dt>
<dd>
Each feature is a <code class="literal">Point</code> that&#8217;s the centroid of the cell.
</dd>
<dt>
<span class="term">
<code class="literal">centroid</code>
</span>
</dt>
<dd>
Each feature is a <code class="literal">Point</code> that&#8217;s the centroid of the data within the cell. For
complex geometries, the actual centroid may be outside the cell. In these cases,
the feature is set to the closest point to the centroid inside the cell.
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">size</code>
</span>
</dt>
<dd>
(Optional, integer) Maximum number of features to return in the <code class="literal">hits</code> layer.
Accepts <code class="literal">0</code>-<code class="literal">10000</code>. Defaults to <code class="literal">10000</code>. If <code class="literal">0</code>, results don&#8217;t include the
<code class="literal">hits</code> layer.
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">track_total_hits</code>
</span>
</dt>
<dd>
<p>
(Optional, integer or Boolean)
Number of hits matching the query to count accurately. Defaults to <code class="literal">10000</code>.
</p>
<p>If <code class="literal">true</code>, the exact number of hits is returned at the cost of some performance.
If <code class="literal">false</code>, the response does not include the total number of hits matching the query.</p>
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">with_labels</code>
</span>
</dt>
<dd>
<p>
(Optional, Boolean)
If true, the hits and aggs layers will contain additional point features representing
suggested label positions for the original features.
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">Point</code> and <code class="literal">MultiPoint</code> features will have one of the points selected.
</li>
<li class="listitem">
<code class="literal">Polygon</code> and <code class="literal">MultiPolygon</code> features will have a single point generated,
either the centroid, if it is within the polygon, or another point within the
polygon selected from the <a class="xref" href="geo-shape.html#geoshape-indexing-approach" title="Indexing approach">sorted triangle-tree</a>.
</li>
<li class="listitem">
<code class="literal">LineString</code> features will likewise provide a roughly central point selected
from the <a class="xref" href="geo-shape.html#geoshape-indexing-approach" title="Indexing approach">triangle-tree</a>.
</li>
<li class="listitem">
The aggregation results will provide one central point for each aggregation bucket.
</li>
</ul>
</div>
<p>All attributes from the original features will also be copied to the new label features.
In addition, the new features will be distinguishable using the tag <code class="literal">_mvt_label_position</code>.</p>
</dd>
</dl>
</div>
</div>

<div class="section child_attributes">
<div class="titlepage"><div><div>
<h3 class="title"><a id="search-vector-tile-api-request-body"></a>Request body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/search/search-vector-tile-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">aggs</code>
</span>
</dt>
<dd>
<p>
(Optional, <a class="xref" href="search-aggregations.html" title="Aggregations">aggregation object</a>)
<a class="xref" href="search-aggregations.html#run-sub-aggs" title="Run sub-aggregations">Sub-aggregations</a> for the <code class="literal">grid_agg</code>. Supports the following
aggregation types:
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="search-aggregations-metrics-avg-aggregation.html" title="Avg aggregation"><code class="literal">avg</code></a>
</li>
<li class="listitem">
<a class="xref" href="search-aggregations-metrics-boxplot-aggregation.html" title="Boxplot aggregation"><code class="literal">boxplot</code></a>
</li>
<li class="listitem">
<a class="xref" href="search-aggregations-metrics-cardinality-aggregation.html" title="Cardinality aggregation"><code class="literal">cardinality</code></a>
</li>
<li class="listitem">
<a class="xref" href="search-aggregations-metrics-extendedstats-aggregation.html" title="Extended stats aggregation"><code class="literal">extended stats</code></a>
</li>
<li class="listitem">
<a class="xref" href="search-aggregations-metrics-max-aggregation.html" title="Max aggregation"><code class="literal">max</code></a>
</li>
<li class="listitem">
<a class="xref" href="search-aggregations-metrics-median-absolute-deviation-aggregation.html" title="Median absolute deviation aggregation"><code class="literal">median absolute deviation</code></a>
</li>
<li class="listitem">
<a class="xref" href="search-aggregations-metrics-min-aggregation.html" title="Min aggregation"><code class="literal">min</code></a>
</li>
<li class="listitem">
<a class="xref" href="search-aggregations-metrics-percentile-aggregation.html" title="Percentiles aggregation"><code class="literal">percentile</code></a>
</li>
<li class="listitem">
<a class="xref" href="search-aggregations-metrics-percentile-rank-aggregation.html" title="Percentile ranks aggregation"><code class="literal">percentile-rank</code></a>
</li>
<li class="listitem">
<a class="xref" href="search-aggregations-metrics-stats-aggregation.html" title="Stats aggregation"><code class="literal">stats</code></a>
</li>
<li class="listitem">
<a class="xref" href="search-aggregations-metrics-sum-aggregation.html" title="Sum aggregation"><code class="literal">sum</code></a>
</li>
<li class="listitem">
<p><a class="xref" href="search-aggregations-metrics-valuecount-aggregation.html" title="Value count aggregation"><code class="literal">value count</code></a></p>
<p>The aggregation names can&#8217;t start with <code class="literal">_mvt_</code>. The <code class="literal">_mvt_</code> prefix is reserved
for internal aggregations.</p>
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">exact_bounds</code>
</span>
</dt>
<dd>
<p>
(Optional, Boolean)
If <code class="literal">false</code>, the <code class="literal">meta</code> layer&#8217;s feature is the bounding box of the tile. Defaults
to <code class="literal">false</code>.
</p>
<p>If <code class="literal">true</code>, the <code class="literal">meta</code> layer&#8217;s feature is a bounding box resulting from a
<a class="xref" href="search-aggregations-metrics-geobounds-aggregation.html" title="Geo-bounds aggregation"><code class="literal">geo_bounds</code></a> aggregation.
The aggregation runs on <code class="literal">&lt;field&gt;</code> values that intersect the <code class="literal">&lt;zoom&gt;/&lt;x&gt;/&lt;y&gt;</code>
tile with <code class="literal">wrap_longitude</code> set to <code class="literal">false</code>. The resulting bounding box may be
larger than the vector tile.</p>
</dd>
<dt>
<span class="term">
<code class="literal">extent</code>
</span>
</dt>
<dd>
(Optional, integer) Size, in pixels, of a side of the tile. Vector tiles are
square with equal sides. Defaults to <code class="literal">4096</code>.
</dd>
<dt>
<span class="term">
<code class="literal">buffer</code>
</span>
</dt>
<dd>
(Optional, integer) Size, in pixels, of a clipping buffer outside the tile.
This allows renderers to avoid outline artifacts from geometries that extend past the extent of the tile.
Defaults to <code class="literal">5</code>.
</dd>
<dt>
<span class="term">
<code class="literal">fields</code>
</span>
</dt>
<dd>
<p>
(Optional, array of strings and objects) Fields to return in the <code class="literal">hits</code> layer.
Supports wildcards (<code class="literal">*</code>).
</p>
<p>This parameter does not support fields with <a class="xref" href="array.html" title="Arrays">array values</a>. Fields with
array values may return inconsistent results.</p>
<p>You can specify fields in the array as a string or object.</p>
<details open>
<summary class="title">Properties of <code class="literal">fields</code> objects</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">field</code>
</span>
</dt>
<dd>
(Required, string) Field to return. Supports wildcards (<code class="literal">*</code>).
</dd>
<dt>
<span class="term">
<code class="literal">format</code>
</span>
</dt>
<dd>
<p>
(Optional, string)
Format for date and geospatial fields. Other field data types do not support
this parameter.
</p>
<p><a class="xref" href="date.html" title="Date field type"><code class="literal">date</code></a> and <a class="xref" href="date_nanos.html" title="Date nanoseconds field type"><code class="literal">date_nanos</code></a> fields accept a
<a class="xref" href="mapping-date-format.html" title="format">date format</a>. <a class="xref" href="geo-point.html" title="Geopoint field type"><code class="literal">geo_point</code></a> and
<a class="xref" href="geo-shape.html" title="Geoshape field type"><code class="literal">geo_shape</code></a> fields accept:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">geojson</code> (default)
</span>
</dt>
<dd>
<a href="http://www.geojson.org" class="ulink" target="_top">GeoJSON</a>
</dd>
<dt>
<span class="term">
<code class="literal">wkt</code>
</span>
</dt>
<dd>
<a href="https://en.wikipedia.org/wiki/Well-known_text_representation_of_geometry" class="ulink" target="_top">Well Known Text</a>
</dd>
<dt>
<span class="term">
<code class="literal">mvt(&lt;spec&gt;)</code>
</span>
</dt>
<dd>
<p>
Binary
<a href="https://docs.mapbox.com/vector-tiles/specification" class="ulink" target="_top">Mapbox vector tile</a>. The API
returns the tile as a base64-encoded string.
The <code class="literal">&lt;spec&gt;</code> has the format <code class="literal">&lt;zoom&gt;/&lt;x&gt;/&lt;y&gt;</code> with two optional suffixes: <code class="literal">@&lt;extent&gt;</code> and/or <code class="literal">:&lt;buffer&gt;</code>. For example, <code class="literal">2/0/1</code> or <code class="literal">2/0/1@4096:5</code>.
</p>
<details open>
<summary class="title"><code class="literal">mvt</code> parameters</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;zoom&gt;</code>
</span>
</dt>
<dd>
(Required, integer) Zoom level for the tile. Accepts <code class="literal">0</code>-<code class="literal">29</code>.
</dd>
<dt>
<span class="term">
<code class="literal">&lt;x&gt;</code>
</span>
</dt>
<dd>
(Required, integer) X coordinate for the tile.
</dd>
<dt>
<span class="term">
<code class="literal">&lt;y&gt;</code>
</span>
</dt>
<dd>
(Required, integer) Y coordinate for the tile.
</dd>
<dt>
<span class="term">
<code class="literal">&lt;extent&gt;</code>
</span>
</dt>
<dd>
(Optional, integer) Size, in pixels, of a side of the tile. Vector tiles are
square with equal sides. Defaults to <code class="literal">4096</code>.
</dd>
<dt>
<span class="term">
<code class="literal">&lt;buffer&gt;</code>
</span>
</dt>
<dd>
(Optional, integer) Size, in pixels, of a clipping buffer outside the tile.
This allows renderers to avoid outline artifacts from geometries that extend past the extent of the tile. Defaults to <code class="literal">5</code>.
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">grid_agg</code>
</span>
</dt>
<dd>
<p>
(Optional, string) Aggregation used to create a grid for the <code class="literal">&lt;field&gt;</code>.
</p>
<details open>
<summary class="title">Valid values for <code class="literal">grid_agg</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">geotile</code> (Default)
</span>
</dt>
<dd>
<a class="xref" href="search-aggregations-bucket-geotilegrid-aggregation.html" title="Geotile grid aggregation"><code class="literal">geotile_grid</code></a> aggregation.
</dd>
<dt>
<span class="term">
<code class="literal">geohex</code>
</span>
</dt>
<dd>
<a class="xref" href="search-aggregations-bucket-geohexgrid-aggregation.html" title="Geohex grid aggregation"><code class="literal">geohex_grid</code></a> aggregation.
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">grid_precision</code>
</span>
</dt>
<dd>
<p>
(Optional, integer) Precision level for cells in the <code class="literal">grid_agg</code>. Accepts
<code class="literal">0</code>-<code class="literal">8</code>. Defaults to <code class="literal">8</code>. If <code class="literal">0</code>, results don&#8217;t include the <code class="literal">aggs</code> layer.
</p>
<details open>
<summary class="title">Grid precision for <code class="literal">geotile</code></summary>
<div class="content">
<p>For a <code class="literal">grid_agg</code> of <code class="literal">geotile</code>, you can use cells in the <code class="literal">aggs</code> layer as tiles
for lower zoom levels. <code class="literal">grid_precision</code> represents the additional zoom levels
available through these cells. The final precision is computed by as
follows:</p>
<p><code class="literal">&lt;zoom&gt; + grid_precision</code></p>
<p>For example, if <code class="literal">&lt;zoom&gt;</code> is <code class="literal">7</code> and <code class="literal">grid_precision</code> is <code class="literal">8</code>, then the
<code class="literal">geotile_grid</code> aggregation will use a precision of <code class="literal">15</code>. The maximum final
precision is <code class="literal">29</code>.</p>
<p>The <code class="literal">grid_precision</code> also determines the number of cells for the grid as
follows:</p>
<p><code class="literal">(2^grid_precision) x (2^grid_precision)</code></p>
<p>For example, a value of <code class="literal">8</code> divides the tile into a grid of 256 x 256 cells. The
<code class="literal">aggs</code> layer only contains features for cells with matching data.</p>
</div>
</details>
<details open>
<summary class="title">Grid precision for <code class="literal">geohex</code></summary>
<div class="content">
<p>For a <code class="literal">grid_agg</code> of <code class="literal">geohex</code>, Elasticsearch uses <code class="literal">&lt;zoom&gt;</code> and <code class="literal">grid_precision</code> to
calculate a final precision as follows:</p>
<p><code class="literal">&lt;zoom&gt; + grid_precision</code></p>
<p>This precision determines the <a href="https://h3geo.org/docs/core-library/restable" class="ulink" target="_top">H3
resolution of the hexagonal cells</a> produced by the <code class="literal">geohex</code> aggregation. The
following table maps the H3 resolution for each precision.</p>
<p>For example, if <code class="literal">&lt;zoom&gt;</code> is <code class="literal">3</code> and <code class="literal">grid_precision</code> is <code class="literal">3</code>, the precision is
<code class="literal">6</code>. At a precision of <code class="literal">6</code>, hexagonal cells have an H3 resolution of <code class="literal">2</code>. If
<code class="literal">&lt;zoom&gt;</code> is <code class="literal">3</code> and <code class="literal">grid_precision</code> is <code class="literal">4</code>, the precision is <code class="literal">7</code>. At a
precision of <code class="literal">7</code>, hexagonal cells have an H3 resolution of <code class="literal">3</code>.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
<col class="col_5"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Precision</th>
<th align="left" valign="top">Unique tile bins</th>
<th align="left" valign="top">H3 resolution</th>
<th align="left" valign="top">Unique hex bins</th>
<th align="left" valign="top">Ratio</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>1</p></td>
<td align="left" valign="top"><p>4</p></td>
<td align="left" valign="top"><p>0</p></td>
<td align="left" valign="top"><p>122</p></td>
<td align="left" valign="top"><p>30.5</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>2</p></td>
<td align="left" valign="top"><p>16</p></td>
<td align="left" valign="top"><p>0</p></td>
<td align="left" valign="top"><p>122</p></td>
<td align="left" valign="top"><p>7.625</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>3</p></td>
<td align="left" valign="top"><p>64</p></td>
<td align="left" valign="top"><p>1</p></td>
<td align="left" valign="top"><p>842</p></td>
<td align="left" valign="top"><p>13.15625</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>4</p></td>
<td align="left" valign="top"><p>256</p></td>
<td align="left" valign="top"><p>1</p></td>
<td align="left" valign="top"><p>842</p></td>
<td align="left" valign="top"><p>3.2890625</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>5</p></td>
<td align="left" valign="top"><p>1024</p></td>
<td align="left" valign="top"><p>2</p></td>
<td align="left" valign="top"><p>5882</p></td>
<td align="left" valign="top"><p>5.744140625</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>6</p></td>
<td align="left" valign="top"><p>4096</p></td>
<td align="left" valign="top"><p>2</p></td>
<td align="left" valign="top"><p>5882</p></td>
<td align="left" valign="top"><p>1.436035156</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>7</p></td>
<td align="left" valign="top"><p>16384</p></td>
<td align="left" valign="top"><p>3</p></td>
<td align="left" valign="top"><p>41162</p></td>
<td align="left" valign="top"><p>2.512329102</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>8</p></td>
<td align="left" valign="top"><p>65536</p></td>
<td align="left" valign="top"><p>3</p></td>
<td align="left" valign="top"><p>41162</p></td>
<td align="left" valign="top"><p>0.6280822754</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>9</p></td>
<td align="left" valign="top"><p>262144</p></td>
<td align="left" valign="top"><p>4</p></td>
<td align="left" valign="top"><p>288122</p></td>
<td align="left" valign="top"><p>1.099098206</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>10</p></td>
<td align="left" valign="top"><p>1048576</p></td>
<td align="left" valign="top"><p>4</p></td>
<td align="left" valign="top"><p>288122</p></td>
<td align="left" valign="top"><p>0.2747745514</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>11</p></td>
<td align="left" valign="top"><p>4194304</p></td>
<td align="left" valign="top"><p>5</p></td>
<td align="left" valign="top"><p>2016842</p></td>
<td align="left" valign="top"><p>0.4808526039</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>12</p></td>
<td align="left" valign="top"><p>16777216</p></td>
<td align="left" valign="top"><p>6</p></td>
<td align="left" valign="top"><p>14117882</p></td>
<td align="left" valign="top"><p>0.8414913416</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>13</p></td>
<td align="left" valign="top"><p>67108864</p></td>
<td align="left" valign="top"><p>6</p></td>
<td align="left" valign="top"><p>14117882</p></td>
<td align="left" valign="top"><p>0.2103728354</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>14</p></td>
<td align="left" valign="top"><p>268435456</p></td>
<td align="left" valign="top"><p>7</p></td>
<td align="left" valign="top"><p>98825162</p></td>
<td align="left" valign="top"><p>0.3681524172</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>15</p></td>
<td align="left" valign="top"><p>1073741824</p></td>
<td align="left" valign="top"><p>8</p></td>
<td align="left" valign="top"><p>691776122</p></td>
<td align="left" valign="top"><p>0.644266719</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>16</p></td>
<td align="left" valign="top"><p>4294967296</p></td>
<td align="left" valign="top"><p>8</p></td>
<td align="left" valign="top"><p>691776122</p></td>
<td align="left" valign="top"><p>0.1610666797</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>17</p></td>
<td align="left" valign="top"><p>17179869184</p></td>
<td align="left" valign="top"><p>9</p></td>
<td align="left" valign="top"><p>4842432842</p></td>
<td align="left" valign="top"><p>0.2818666889</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>18</p></td>
<td align="left" valign="top"><p>68719476736</p></td>
<td align="left" valign="top"><p>10</p></td>
<td align="left" valign="top"><p>33897029882</p></td>
<td align="left" valign="top"><p>0.4932667053</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>19</p></td>
<td align="left" valign="top"><p>274877906944</p></td>
<td align="left" valign="top"><p>11</p></td>
<td align="left" valign="top"><p>237279209162</p></td>
<td align="left" valign="top"><p>0.8632167343</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>20</p></td>
<td align="left" valign="top"><p>1099511627776</p></td>
<td align="left" valign="top"><p>11</p></td>
<td align="left" valign="top"><p>237279209162</p></td>
<td align="left" valign="top"><p>0.2158041836</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>21</p></td>
<td align="left" valign="top"><p>4398046511104</p></td>
<td align="left" valign="top"><p>12</p></td>
<td align="left" valign="top"><p>1660954464122</p></td>
<td align="left" valign="top"><p>0.3776573213</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>22</p></td>
<td align="left" valign="top"><p>17592186044416</p></td>
<td align="left" valign="top"><p>13</p></td>
<td align="left" valign="top"><p>11626681248842</p></td>
<td align="left" valign="top"><p>0.6609003122</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>23</p></td>
<td align="left" valign="top"><p>70368744177664</p></td>
<td align="left" valign="top"><p>13</p></td>
<td align="left" valign="top"><p>11626681248842</p></td>
<td align="left" valign="top"><p>0.165225078</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>24</p></td>
<td align="left" valign="top"><p>281474976710656</p></td>
<td align="left" valign="top"><p>14</p></td>
<td align="left" valign="top"><p>81386768741882</p></td>
<td align="left" valign="top"><p>0.2891438866</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>25</p></td>
<td align="left" valign="top"><p>1125899906842620</p></td>
<td align="left" valign="top"><p>15</p></td>
<td align="left" valign="top"><p>569707381193162</p></td>
<td align="left" valign="top"><p>0.5060018015</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>26</p></td>
<td align="left" valign="top"><p>4503599627370500</p></td>
<td align="left" valign="top"><p>15</p></td>
<td align="left" valign="top"><p>569707381193162</p></td>
<td align="left" valign="top"><p>0.1265004504</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>27</p></td>
<td align="left" valign="top"><p>18014398509482000</p></td>
<td align="left" valign="top"><p>15</p></td>
<td align="left" valign="top"><p>569707381193162</p></td>
<td align="left" valign="top"><p>0.03162511259</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>28</p></td>
<td align="left" valign="top"><p>72057594037927900</p></td>
<td align="left" valign="top"><p>15</p></td>
<td align="left" valign="top"><p>569707381193162</p></td>
<td align="left" valign="top"><p>0.007906278149</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>29</p></td>
<td align="left" valign="top"><p>288230376151712000</p></td>
<td align="left" valign="top"><p>15</p></td>
<td align="left" valign="top"><p>569707381193162</p></td>
<td align="left" valign="top"><p>0.001976569537</p></td>
</tr>
</tbody>
</table>
</div>
<p>Hexagonal cells don&#8217;t align perfectly on a vector tile. Some cells may intersect
more than one vector tile. To compute the H3 resolution for each precision, Elasticsearch
compares the average density of hexagonal bins at each resolution with the
average density of tile bins at each zoom level. Elasticsearch uses the H3 resolution
that is closest to the corresponding <code class="literal">geotile</code> density.</p>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">grid_type</code>
</span>
</dt>
<dd>
<p>
(Optional, string) Determines the geometry type for features in the <code class="literal">aggs</code>
layer. In the <code class="literal">aggs</code> layer, each feature represents a cell in the grid.
</p>
<details open>
<summary class="title">Valid values for <code class="literal">grid_type</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">grid</code> (Default)
</span>
</dt>
<dd>
Each feature is a <code class="literal">Polygon</code> of the cell&#8217;s geometry. For a <code class="literal">grid_agg</code> of
<code class="literal">geotile</code>, the feature is the cell&#8217;s bounding box. For a <code class="literal">grid_agg</code> of
<code class="literal">geohex</code>, the feature is the hexagonal cell&#8217;s boundaries.
</dd>
<dt>
<span class="term">
<code class="literal">point</code>
</span>
</dt>
<dd>
Each feature is a <code class="literal">Point</code> that&#8217;s the centroid of the cell.
</dd>
<dt>
<span class="term">
<code class="literal">centroid</code>
</span>
</dt>
<dd>
Each feature is a <code class="literal">Point</code> that&#8217;s the centroid of the data within the cell. For
complex geometries, the actual centroid may be outside the cell. In these cases,
the feature is set to the closest point to the centroid inside the cell.
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">query</code>
</span>
</dt>
<dd>
(Optional, object) <a class="xref" href="query-dsl.html" title="Query DSL">Query DSL</a> used to filter documents for the
search.
</dd>
<dt>
<span class="term">
<code class="literal">runtime_mappings</code>
</span>
</dt>
<dd>
<p>
(Optional, object of objects)
Defines one or more <a class="xref" href="runtime-search-request.html" title="Define runtime fields in a search request">runtime fields</a> in the search
request. These fields take precedence over mapped fields with the same name.
</p>
<details open>
<summary class="title">Properties of <code class="literal">runtime_mappings</code> objects</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;field-name&gt;</code>
</span>
</dt>
<dd>
<p>
(Required, object)
Configuration for the runtime field. The key is the field name.
</p>
<details open>
<summary class="title">Properties of <code class="literal">&lt;field-name&gt;</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">type</code>
</span>
</dt>
<dd>
<p>
(Required, string)
<a class="xref" href="mapping-types.html" title="Field data types">Field type</a>, which can be any of the following:
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">boolean</code>
</li>
<li class="listitem">
<code class="literal">composite</code>
</li>
<li class="listitem">
<code class="literal">date</code>
</li>
<li class="listitem">
<code class="literal">double</code>
</li>
<li class="listitem">
<code class="literal">geo_point</code>
</li>
<li class="listitem">
<code class="literal">ip</code>
</li>
<li class="listitem">
<code class="literal">keyword</code>
</li>
<li class="listitem">
<code class="literal">long</code>
</li>
<li class="listitem">
<a class="xref" href="runtime-retrieving-fields.html#lookup-runtime-fields" title="Retrieve fields from related indices"><code class="literal">lookup</code></a>
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">script</code>
</span>
</dt>
<dd>
<p>
(Optional, string)
<a class="xref" href="modules-scripting-using.html" title="How to write scripts">Painless script</a> executed at query time. The
script has access to the entire context of a document, including the original
<code class="literal">_source</code> and any mapped fields plus their values.
</p>
<p>This script must include <code class="literal">emit</code> to return calculated values. For example:</p>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">"script": "emit(doc['@timestamp'].value.dayOfWeekEnum.toString())"</pre>
</div>
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">size</code>
</span>
</dt>
<dd>
(Optional, integer) Maximum number of features to return in the <code class="literal">hits</code> layer.
Accepts <code class="literal">0</code>-<code class="literal">10000</code>. Defaults to <code class="literal">10000</code>. If <code class="literal">0</code>, results don&#8217;t include the
<code class="literal">hits</code> layer.
</dd>
<dt>
<span class="term">
<code class="literal">sort</code>
</span>
</dt>
<dd>
<p>
(Optional, array of <a class="xref" href="sort-search-results.html" title="Sort search results">sort objects</a>) Sorts features in the
<code class="literal">hits</code> layer.
</p>
<p>By default, the API calculates a bounding box for each feature. It sorts
features based on this box&#8217;s diagonal length, from longest to shortest.</p>
</dd>
<dt>
<span class="term">
<code class="literal">track_total_hits</code>
</span>
</dt>
<dd>
<p>
(Optional, integer or Boolean)
Number of hits matching the query to count accurately. Defaults to <code class="literal">10000</code>.
</p>
<p>If <code class="literal">true</code>, the exact number of hits is returned at the cost of some performance.
If <code class="literal">false</code>, the response does not include the total number of hits matching the query.</p>
</dd>
<dt>
<span class="term">
<code class="literal">with_labels</code>
</span>
</dt>
<dd>
<p>
(Optional, Boolean)
If true, the hits and aggs layers will contain additional point features representing
suggested label positions for the original features.
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">Point</code> and <code class="literal">MultiPoint</code> features will have one of the points selected.
</li>
<li class="listitem">
<code class="literal">Polygon</code> and <code class="literal">MultiPolygon</code> features will have a single point generated,
either the centroid, if it is within the polygon, or another point within the
polygon selected from the <a class="xref" href="geo-shape.html#geoshape-indexing-approach" title="Indexing approach">sorted triangle-tree</a>.
</li>
<li class="listitem">
<code class="literal">LineString</code> features will likewise provide a roughly central point selected
from the <a class="xref" href="geo-shape.html#geoshape-indexing-approach" title="Indexing approach">triangle-tree</a>.
</li>
<li class="listitem">
The aggregation results will provide one central point for each aggregation bucket.
</li>
</ul>
</div>
<p>All attributes from the original features will also be copied to the new label features.
In addition, the new features will be distinguishable using the tag <code class="literal">_mvt_label_position</code>.</p>
</dd>
</dl>
</div>
</div>

<div class="section child_attributes">
<div class="titlepage"><div><div>
<h3 class="title"><a id="search-vector-tile-api-response"></a>Response<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/search/search-vector-tile-api.asciidoc">edit</a></h3>
</div></div></div>
<p>Returned vector tiles contain the following data:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">hits</code>
</span>
</dt>
<dd>
<p>
(object) Layer containing results for the <code class="literal">geo_bounding_box</code> query.
</p>
<details open>
<summary class="title">Properties of <code class="literal">hits</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">extent</code>
</span>
</dt>
<dd>
(integer) Size, in pixels, of a side of the tile. Vector tiles are square with
equal sides.
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">version</code>
</span>
</dt>
<dd>
(integer) Major version number of the
<a href="https://github.com/mapbox/vector-tile-spec" class="ulink" target="_top">Mapbox vector tile specification</a>.
</dd>
<dt>
<span class="term">
<code class="literal">features</code>
</span>
</dt>
<dd>
<p>
(array of objects) Array of features. Contains a feature for each <code class="literal">&lt;field&gt;</code>
value that matches the <code class="literal">geo_bounding_box</code> query.
</p>
<details open>
<summary class="title">Properties of <code class="literal">features</code> objects</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">geometry</code>
</span>
</dt>
<dd>
<p>
(object) Geometry for the feature.
</p>
<details open>
<summary class="title">Properties of <code class="literal">geometry</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">type</code>
</span>
</dt>
<dd>
<p>
(string) Geometry type for the feature. Valid values are:
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">UNKNOWN</code>
</li>
<li class="listitem">
<code class="literal">POINT</code>
</li>
<li class="listitem">
<code class="literal">LINESTRING</code>
</li>
<li class="listitem">
<code class="literal">POLYGON</code>
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">coordinates</code>
</span>
</dt>
<dd>
(array of integers or array of arrays) Tile coordinates for the feature.
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">properties</code>
</span>
</dt>
<dd>
<p>
(object) Properties for the feature.
</p>
<details open>
<summary class="title">Properties of <code class="literal">properties</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">_id</code>
</span>
</dt>
<dd>
(string) Document <code class="literal">_id</code> for the feature&#8217;s document.
</dd>
<dt>
<span class="term">
<code class="literal">_index</code>
</span>
</dt>
<dd>
(string) Name of the index for the feature&#8217;s document.
</dd>
<dt>
<span class="term">
<code class="literal">&lt;field&gt;</code>
</span>
</dt>
<dd>
Field value. Only returned for fields in the <code class="literal">fields</code> parameter.
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">type</code>
</span>
</dt>
<dd>
<p>
(integer) Identifier for the feature&#8217;s geometry type. Values are:
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">1</code> (<code class="literal">POINT</code>)
</li>
<li class="listitem">
<code class="literal">2</code> (<code class="literal">LINESTRING</code>)
</li>
<li class="listitem">
<code class="literal">3</code> (<code class="literal">POLYGON</code>)
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">aggs</code>
</span>
</dt>
<dd>
<p>
(object) Layer containing results for the <code class="literal">grid_agg</code> aggregation and its
sub-aggregations.
</p>
<details open>
<summary class="title">Properties of <code class="literal">aggs</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">extent</code>
</span>
</dt>
<dd>
(integer) Size, in pixels, of a side of the tile. Vector tiles are square with
equal sides.
</dd>
<dt>
<span class="term">
<code class="literal">version</code>
</span>
</dt>
<dd>
(integer) Major version number of the
<a href="https://github.com/mapbox/vector-tile-spec" class="ulink" target="_top">Mapbox vector tile specification</a>.
</dd>
<dt>
<span class="term">
<code class="literal">features</code>
</span>
</dt>
<dd>
<p>
(array of objects) Array of features. Contains a feature for each cell of the grid.
</p>
<details open>
<summary class="title">Properties of <code class="literal">features</code> objects</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">geometry</code>
</span>
</dt>
<dd>
<p>
(object) Geometry for the feature.
</p>
<details open>
<summary class="title">Properties of <code class="literal">geometry</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">type</code>
</span>
</dt>
<dd>
<p>
(string) Geometry type for the feature. Valid values are:
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">UNKNOWN</code>
</li>
<li class="listitem">
<code class="literal">POINT</code>
</li>
<li class="listitem">
<code class="literal">LINESTRING</code>
</li>
<li class="listitem">
<code class="literal">POLYGON</code>
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">coordinates</code>
</span>
</dt>
<dd>
(array of integers or array of arrays) Tile coordinates for the feature.
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">properties</code>
</span>
</dt>
<dd>
<p>
(object) Properties for the feature.
</p>
<details open>
<summary class="title">Properties of <code class="literal">properties</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">_count</code>
</span>
</dt>
<dd>
(long) Count of the cell&#8217;s documents.
</dd>
<dt>
<span class="term">
<code class="literal">_key</code>
</span>
</dt>
<dd>
(string) Bucket key of the cell in the format <code class="literal">&lt;zoom&gt;/&lt;x&gt;/&lt;y&gt;</code>.
</dd>
<dt>
<span class="term">
<code class="literal">&lt;sub-aggregation&gt;.value</code>
</span>
</dt>
<dd>
Sub-aggregation results for the cell. Only returned for sub-aggregations in the
<code class="literal">aggs</code> parameter.
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">type</code>
</span>
</dt>
<dd>
<p>
(integer) Identifier for the feature&#8217;s geometry type. Values are:
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">1</code> (<code class="literal">POINT</code>)
</li>
<li class="listitem">
<code class="literal">2</code> (<code class="literal">LINESTRING</code>)
</li>
<li class="listitem">
<code class="literal">3</code> (<code class="literal">POLYGON</code>)
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">meta</code>
</span>
</dt>
<dd>
<p>
(object) Layer containing metadata for the request.
</p>
<details open>
<summary class="title">Properties of <code class="literal">meta</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">extent</code>
</span>
</dt>
<dd>
(integer) Size, in pixels, of a side of the tile. Vector tiles are square with
equal sides.
</dd>
<dt>
<span class="term">
<code class="literal">version</code>
</span>
</dt>
<dd>
(integer) Major version number of the
<a href="https://github.com/mapbox/vector-tile-spec" class="ulink" target="_top">Mapbox vector tile specification</a>.
</dd>
<dt>
<span class="term">
<code class="literal">features</code>
</span>
</dt>
<dd>
<p>
(array of objects) Contains a feature for a bounding box.
</p>
<details open>
<summary class="title">Properties of <code class="literal">features</code> objects</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">geometry</code>
</span>
</dt>
<dd>
<p>
(object) Geometry for the feature.
</p>
<details open>
<summary class="title">Properties of <code class="literal">geometry</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">type</code>
</span>
</dt>
<dd>
<p>
(string) Geometry type for the feature. Valid values are:
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">UNKNOWN</code>
</li>
<li class="listitem">
<code class="literal">POINT</code>
</li>
<li class="listitem">
<code class="literal">LINESTRING</code>
</li>
<li class="listitem">
<code class="literal">POLYGON</code>
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">coordinates</code>
</span>
</dt>
<dd>
(array of integers or array of arrays) Tile coordinates for the feature.
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">properties</code>
</span>
</dt>
<dd>
<p>
(object) Properties for the feature.
</p>
<details open>
<summary class="title">Properties of <code class="literal">properties</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">_shards.failed</code>
</span>
</dt>
<dd>
(integer) Number of shards that failed to execute the search. See the search
API&#8217;s <a class="xref" href="search-search.html#search-api-shards"><code class="literal">shards</code></a> response property.
</dd>
<dt>
<span class="term">
<code class="literal">_shards.skipped</code>
</span>
</dt>
<dd>
(integer) Number of shards that skipped the search. See the search
API&#8217;s <a class="xref" href="search-search.html#search-api-shards"><code class="literal">shards</code></a> response property.
</dd>
<dt>
<span class="term">
<code class="literal">_shards.successful</code>
</span>
</dt>
<dd>
(integer)  Number of shards that executed the search successfully. See the
search API&#8217;s <a class="xref" href="search-search.html#search-api-shards"><code class="literal">shards</code></a> response property.
</dd>
<dt>
<span class="term">
<code class="literal">_shards.total</code>
</span>
</dt>
<dd>
(integer) Total number of shards that required querying, including unallocated
shards. See the search API&#8217;s <a class="xref" href="search-search.html#search-api-shards"><code class="literal">shards</code></a> response property.
</dd>
<dt>
<span class="term">
<code class="literal">aggregations._count.avg</code>
</span>
</dt>
<dd>
(float) Average <code class="literal">_count</code> value for features in the <code class="literal">aggs</code> layer.
</dd>
<dt>
<span class="term">
<code class="literal">aggregations._count.count</code>
</span>
</dt>
<dd>
(integer) Number of unique <code class="literal">_count</code> values for features in the <code class="literal">aggs</code> layer.
</dd>
<dt>
<span class="term">
<code class="literal">aggregations._count.max</code>
</span>
</dt>
<dd>
(float) Largest <code class="literal">_count</code> value for features in the <code class="literal">aggs</code> layer.
</dd>
<dt>
<span class="term">
<code class="literal">aggregations._count.min</code>
</span>
</dt>
<dd>
(float) Smallest <code class="literal">_count</code> value for features in the <code class="literal">aggs</code> layer.
</dd>
<dt>
<span class="term">
<code class="literal">aggregations._count.sum</code>
</span>
</dt>
<dd>
(float) Sum of <code class="literal">_count</code> values for features in the <code class="literal">aggs</code> layer.
</dd>
<dt>
<span class="term">
<code class="literal">aggregations.&lt;sub-aggregation&gt;.avg</code>
</span>
</dt>
<dd>
(float) Average value for the sub-aggregation&#8217;s results.
</dd>
<dt>
<span class="term">
<code class="literal">aggregations.&lt;agg_name&gt;.count</code>
</span>
</dt>
<dd>
(integer) Number of unique values from the sub-aggregation&#8217;s results.
</dd>
<dt>
<span class="term">
<code class="literal">aggregations.&lt;agg_name&gt;.max</code>
</span>
</dt>
<dd>
(float) Largest value from the sub-aggregation&#8217;s results.
</dd>
<dt>
<span class="term">
<code class="literal">aggregations.&lt;agg_name&gt;.min</code>
</span>
</dt>
<dd>
(float) Smallest value from the sub-aggregation&#8217;s results.
</dd>
<dt>
<span class="term">
<code class="literal">aggregations.&lt;agg_name&gt;.sum</code>
</span>
</dt>
<dd>
(float) Sum of values for the sub-aggregation&#8217;s results.
</dd>
<dt>
<span class="term">
<code class="literal">hits.max_score</code>
</span>
</dt>
<dd>
(float) Highest document <code class="literal">_score</code> for the search&#8217;s hits.
</dd>
<dt>
<span class="term">
<code class="literal">hits.total.relation</code>
</span>
</dt>
<dd>
<p>
(string) Indicates whether <code class="literal">hits.total.value</code> is accurate or a lower bound.
Possible values are:
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">eq</code>
</span>
</dt>
<dd>
Accurate
</dd>
<dt>
<span class="term">
<code class="literal">gte</code>
</span>
</dt>
<dd>
Lower bound
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">hits.total.value</code>
</span>
</dt>
<dd>
(integer) Total number of hits for the search.
</dd>
<dt>
<span class="term">
<code class="literal">timed_out</code>
</span>
</dt>
<dd>
(Boolean) If <code class="literal">true</code>, the search timed out before completion. Results may be
partial or empty.
</dd>
<dt>
<span class="term">
<code class="literal">took</code>
</span>
</dt>
<dd>
(integer) Milliseconds it took Elasticsearch to run the search. See the search API&#8217;s
<a class="xref" href="search-search.html#search-api-took"><code class="literal">took</code></a> response property.
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">type</code>
</span>
</dt>
<dd>
<p>
(integer) Identifier for the feature&#8217;s geometry type. Values are:
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">1</code> (<code class="literal">POINT</code>)
</li>
<li class="listitem">
<code class="literal">2</code> (<code class="literal">LINESTRING</code>)
</li>
<li class="listitem">
<code class="literal">3</code> (<code class="literal">POLYGON</code>)
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="search-vector-tile-api-api-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/search/search-vector-tile-api.asciidoc">edit</a></h3>
</div></div></div>
<p>The following requests create the <code class="literal">museum</code> index and add several geospatial
<code class="literal">location</code> values.</p>
<div class="pre_wrapper lang-ruby alternative">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ruby alternative">response = client.indices.create(
  index: 'museums',
  body: {
    mappings: {
      properties: {
        location: {
          type: 'geo_point'
        },
        name: {
          type: 'keyword'
        },
        price: {
          type: 'long'
        },
        included: {
          type: 'boolean'
        }
      }
    }
  }
)
puts response

response = client.bulk(
  index: 'museums',
  refresh: true,
  body: [
    {
      index: {
        _id: '1'
      }
    },
    {
      location: 'POINT (4.912350 52.374081)',
      name: 'NEMO Science Museum',
      price: 1750,
      included: true
    },
    {
      index: {
        _id: '2'
      }
    },
    {
      location: 'POINT (4.901618 52.369219)',
      name: 'Museum Het Rembrandthuis',
      price: 1500,
      included: false
    },
    {
      index: {
        _id: '3'
      }
    },
    {
      location: 'POINT (4.914722 52.371667)',
      name: 'Nederlands Scheepvaartmuseum',
      price: 1650,
      included: true
    },
    {
      index: {
        _id: '4'
      }
    },
    {
      location: 'POINT (4.914722 52.371667)',
      name: 'Amsterdam Centre for Architecture',
      price: 0,
      included: true
    }
  ]
)
puts response</pre>
</div>
<div class="pre_wrapper lang-js alternative">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js alternative">const response = await client.indices.create({
  index: "museums",
  mappings: {
    properties: {
      location: {
        type: "geo_point",
      },
      name: {
        type: "keyword",
      },
      price: {
        type: "long",
      },
      included: {
        type: "boolean",
      },
    },
  },
});
console.log(response);

const response1 = await client.bulk({
  index: "museums",
  refresh: "true",
  operations: [
    {
      index: {
        _id: "1",
      },
    },
    {
      location: "POINT (4.912350 52.374081)",
      name: "NEMO Science Museum",
      price: 1750,
      included: true,
    },
    {
      index: {
        _id: "2",
      },
    },
    {
      location: "POINT (4.901618 52.369219)",
      name: "Museum Het Rembrandthuis",
      price: 1500,
      included: false,
    },
    {
      index: {
        _id: "3",
      },
    },
    {
      location: "POINT (4.914722 52.371667)",
      name: "Nederlands Scheepvaartmuseum",
      price: 1650,
      included: true,
    },
    {
      index: {
        _id: "4",
      },
    },
    {
      location: "POINT (4.914722 52.371667)",
      name: "Amsterdam Centre for Architecture",
      price: 0,
      included: true,
    },
  ],
});
console.log(response1);</pre>
</div>
<a id="db773f690edf659ac9b044dc854c77eb"></a>
<div class="pre_wrapper lang-console default has-ruby has-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console default has-ruby has-js">PUT museums
{
  "mappings": {
    "properties": {
      "location": {
        "type": "geo_point"
      },
      "name": {
        "type": "keyword"
      },
      "price": {
        "type": "long"
      },
      "included": {
        "type": "boolean"
      }
    }
  }
}

POST museums/_bulk?refresh
{ "index": { "_id": "1" } }
{ "location": "POINT (4.912350 52.374081)", "name": "NEMO Science Museum",  "price": 1750, "included": true }
{ "index": { "_id": "2" } }
{ "location": "POINT (4.901618 52.369219)", "name": "Museum Het Rembrandthuis", "price": 1500, "included": false }
{ "index": { "_id": "3" } }
{ "location": "POINT (4.914722 52.371667)", "name": "Nederlands Scheepvaartmuseum", "price":1650, "included": true }
{ "index": { "_id": "4" } }
{ "location": "POINT (4.914722 52.371667)", "name": "Amsterdam Centre for Architecture", "price":0, "included": true }</pre>
</div>
<div class="console_widget has-ruby has-js" data-snippet="snippets/3140.console"></div>
<p>The following request searches the index for <code class="literal">location</code> values that intersect
the <code class="literal">13/4207/2692</code> vector tile.</p>
<div class="pre_wrapper lang-js alternative">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js alternative">const response = await client.searchMvt({
  index: "museums",
  field: "location",
  zoom: 13,
  x: 4207,
  y: 2692,
  grid_agg: "geotile",
  grid_precision: 2,
  fields: ["name", "price"],
  query: {
    term: {
      included: true,
    },
  },
  aggs: {
    min_price: {
      min: {
        field: "price",
      },
    },
    max_price: {
      max: {
        field: "price",
      },
    },
    avg_price: {
      avg: {
        field: "price",
      },
    },
  },
});
console.log(response);</pre>
</div>
<a id="b88a2d96da1401d548a4540cca223d27"></a>
<div class="pre_wrapper lang-console default has-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console default has-js">GET museums/_mvt/location/13/4207/2692
{
  "grid_agg": "geotile",
  "grid_precision": 2,
  "fields": [
    "name",
    "price"
  ],
  "query": {
    "term": {
      "included": true
    }
  },
  "aggs": {
    "min_price": {
      "min": {
        "field": "price"
      }
    },
    "max_price": {
      "max": {
        "field": "price"
      }
    },
    "avg_price": {
      "avg": {
        "field": "price"
      }
    }
  }
}</pre>
</div>
<div class="console_widget has-js" data-snippet="snippets/3141.console"></div>
<p>The API returns results as a binary vector tile. When decoded into JSON, the
tile contains the following data:</p>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">{
  "hits": {
    "extent": 4096,
    "version": 2,
    "features": [
      {
        "geometry": {
          "type": "Point",
          "coordinates": [
            3208,
            3864
          ]
        },
        "properties": {
          "_id": "1",
          "_index": "museums",
          "name": "NEMO Science Museum",
          "price": 1750
        },
        "type": 1
      },
      {
        "geometry": {
          "type": "Point",
          "coordinates": [
            3429,
            3496
          ]
        },
        "properties": {
          "_id": "3",
          "_index": "museums",
          "name": "Nederlands Scheepvaartmuseum",
          "price": 1650
        },
        "type": 1
      },
      {
        "geometry": {
          "type": "Point",
          "coordinates": [
            3429,
            3496
          ]
        },
        "properties": {
          "_id": "4",
          "_index": "museums",
          "name": "Amsterdam Centre for Architecture",
          "price": 0
        },
        "type": 1
      }
    ]
  },
  "aggs": {
    "extent": 4096,
    "version": 2,
    "features": [
      {
        "geometry": {
          "type": "Polygon",
          "coordinates": [
            [
              [
                3072,
                3072
              ],
              [
                4096,
                3072
              ],
              [
                4096,
                4096
              ],
              [
                3072,
                4096
              ],
              [
                3072,
                3072
              ]
            ]
          ]
        },
        "properties": {
          "_count": 3,
          "max_price.value": 1750.0,
          "min_price.value": 0.0,
          "avg_price.value": 1133.3333333333333
        },
        "type": 3
      }
    ]
  },
  "meta": {
    "extent": 4096,
    "version": 2,
    "features": [
      {
        "geometry": {
          "type": "Polygon",
          "coordinates": [
            [
              [
                0,
                0
              ],
              [
                4096,
                0
              ],
              [
                4096,
                4096
              ],
              [
                0,
                4096
              ],
              [
                0,
                0
              ]
            ]
          ]
        },
        "properties": {
          "_shards.failed": 0,
          "_shards.skipped": 0,
          "_shards.successful": 1,
          "_shards.total": 1,
          "aggregations._count.avg": 3.0,
          "aggregations._count.count": 1,
          "aggregations._count.max": 3.0,
          "aggregations._count.min": 3.0,
          "aggregations._count.sum": 3.0,
          "aggregations.avg_price.avg": 1133.3333333333333,
          "aggregations.avg_price.count": 1,
          "aggregations.avg_price.max": 1133.3333333333333,
          "aggregations.avg_price.min": 1133.3333333333333,
          "aggregations.avg_price.sum": 1133.3333333333333,
          "aggregations.max_price.avg": 1750.0,
          "aggregations.max_price.count": 1,
          "aggregations.max_price.max": 1750.0,
          "aggregations.max_price.min": 1750.0,
          "aggregations.max_price.sum": 1750.0,
          "aggregations.min_price.avg": 0.0,
          "aggregations.min_price.count": 1,
          "aggregations.min_price.max": 0.0,
          "aggregations.min_price.min": 0.0,
          "aggregations.min_price.sum": 0.0,
          "hits.max_score": 0.0,
          "hits.total.relation": "eq",
          "hits.total.value": 3,
          "timed_out": false,
          "took": 2
        },
        "type": 3
      }
    ]
  }
}</pre>
</div>
</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="search-rank-eval.html">« Ranking evaluation API</a>
</span>
<span class="next">
<a href="search-application-apis.html">Search Application APIs »</a>
</span>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>

                        <!-- Feedback widget -->
                        <div id="feedbackWidgetContainer"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


        <div id='elastic-footer'></div>
        <script src='https://www.elastic.co/elastic-footer.js'></script>
        <!-- Footer Section end-->

      </section>
    </div>

    <!-- Feedback modal -->
    <div id="feedbackModalContainer"></div>

    <script src="/guide/static/jquery.js"></script>
    <script type="text/javascript" src="/guide/static/docs-v1.js"></script>
    <script type="text/javascript">
  window.initial_state = {"alternatives":{"console":{"php":{"hasAny":true},"python":{"hasAny":true},"ruby":{"hasAny":true},"go":{"hasAny":true},"js":{"hasAny":true}}}}</script>
  </body>
</html>
