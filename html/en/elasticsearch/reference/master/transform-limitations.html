<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Transform limitations | Elasticsearch Reference [master] | Elastic</title>
<link rel="home" href="index.html" title="Elasticsearch Reference [master]"/>
<link rel="up" href="transforms.html" title="Transforming data"/>
<link rel="prev" href="transform-troubleshooting.html" title="Troubleshooting transforms"/>
<link rel="next" href="high-availability.html" title="Set up a cluster for high availability"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/master"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="master"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!--BEGIN QUALTRICS WEBSITE FEEDBACK SNIPPET-->
    <script type='text/javascript'>
      (function(){var g=function(e,h,f,g){
      this.get=function(a){for(var a=a+"=",c=document.cookie.split(";"),b=0,e=c.length;b<e;b++){for(var d=c[b];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return null};
      this.set=function(a,c){var b="",b=new Date;b.setTime(b.getTime()+6048E5);b="; expires="+b.toGMTString();document.cookie=a+"="+c+b+"; path=/; "};
      this.check=function(){var a=this.get(f);if(a)a=a.split(":");else if(100!=e)"v"==h&&(e=Math.random()>=e/100?0:100),a=[h,e,0],this.set(f,a.join(":"));else return!0;var c=a[1];if(100==c)return!0;switch(a[0]){case "v":return!1;case "r":return c=a[2]%Math.floor(100/c),a[2]++,this.set(f,a.join(":")),!c}return!0};
      this.go=function(){if(this.check()){var a=document.createElement("script");a.type="text/javascript";a.src=g;document.body&&document.body.appendChild(a)}};
      this.start=function(){var a=this;window.addEventListener?window.addEventListener("load",function(){a.go()},!1):window.attachEvent&&window.attachEvent("onload",function(){a.go()})}};
      try{(new g(100,"r","QSI_S_ZN_emkP0oSe9Qrn7kF","https://znemkp0ose9qrn7kf-elastic.siteintercept.qualtrics.com/WRSiteInterceptEngine/?Q_ZID=ZN_emkP0oSe9Qrn7kF")).start()}catch(i){}})();
    </script><div id='ZN_emkP0oSe9Qrn7kF'><!--DO NOT REMOVE-CONTENTS PLACED HERE--></div>
    <!--END WEBSITE FEEDBACK SNIPPET-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <!-- Subnav -->
    <div>
      <div>
        <div class="tertiary-nav d-none d-md-block">
          <div class="container">
            <div class="p-t-b-15 d-flex justify-content-between nav-container">
              <div class="breadcrum-wrapper"><span><a href="/guide/" style="font-size: 14px; font-weight: 600; color: #000;">Docs</a></span></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container">
              <div class="row">
                <div class="col-xs-12 col-sm-8 col-md-8 guide-section">
                  <!-- start body -->
                  <div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Elasticsearch Reference [master]</a></span>
»
<span class="breadcrumb-link"><a href="data-rollup-transform.html">Roll up or transform your data</a></span>
»
<span class="breadcrumb-link"><a href="transforms.html">Transforming data</a></span>
»
<span class="breadcrumb-node">Transform limitations</span>
</div>
<div class="navheader">
<span class="prev">
<a href="transform-troubleshooting.html">« Troubleshooting transforms</a>
</span>
<span class="next">
<a href="high-availability.html">Set up a cluster for high availability »</a>
</span>
</div>
<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="transform-limitations"></a>Transform limitations<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/transform/limitations.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>The following limitations and known problems apply to the 8.0.0 release of
the Elastic transform feature:</p>
<h4><a id="transform-ui-limitation"></a>Transforms UI will not work during a rolling upgrade from 7.2<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/transform/limitations.asciidoc">edit</a></h4>
<p>If your cluster contains mixed version nodes, for example during a rolling
upgrade from 7.2 to a newer version, and transforms have been created in 7.2,
the transforms UI (earler data frame UI) will not work. Please wait until all
nodes have been upgraded to the newer version before using the transforms UI.</p>
<h4><a id="transform-rolling-upgrade-limitation"></a>Transforms reassignment suspended during a rolling upgrade from 7.2 and 7.3<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/transform/limitations.asciidoc">edit</a></h4>
<p>If your cluster contains mixed version nodes, for example during a rolling
upgrade from 7.2 or 7.3 to a newer version, transforms whose nodes are stopped will
not be reassigned until the upgrade is complete. After the upgrade is done, transforms
resume automatically; no action is required.</p>
<h4><a id="transform-datatype-limitations"></a>Data frame data type limitation<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/transform/limitations.asciidoc">edit</a></h4>
<p>Data frames do not (yet) support fields containing arrays – in the UI or
the API. If you try to create one, the UI will fail to show the source index
table.</p>
<h4><a id="transform-kibana-limitations"></a>Up to 1,000 transforms are supported<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/transform/limitations.asciidoc">edit</a></h4>
<p>A single cluster will support up to 1,000 transforms. When using the
<a class="xref" href="get-transform.html" title="Get transforms API">GET transforms API</a> a total <code class="literal">count</code> of transforms
is returned. Use the <code class="literal">size</code> and <code class="literal">from</code> parameters to enumerate through the full
list.</p>
<h4><a id="transform-aggresponse-limitations"></a>Aggregation responses may be incompatible with destination index mappings<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/transform/limitations.asciidoc">edit</a></h4>
<p>When a transform is first started, it will deduce the mappings
required for the destination index. This process is based on the field types of
the source index and the aggregations used. If the fields are derived from
<a class="xref" href="search-aggregations-metrics-scripted-metric-aggregation.html" title="Scripted Metric Aggregation"><code class="literal">scripted_metrics</code></a>
or <a class="xref" href="search-aggregations-pipeline-bucket-script-aggregation.html" title="Bucket Script Aggregation"><code class="literal">bucket_scripts</code></a>,
<a class="xref" href="dynamic-mapping.html" title="Dynamic Mapping">dynamic mappings</a> will be used. In some instances the
deduced mappings may be incompatible with the actual data. For example, numeric
overflows might occur or dynamically mapped fields might contain both numbers
and strings. Please check Elasticsearch logs if you think this may have occurred. As a
workaround, you may define custom mappings prior to starting the
transform. For example,
<a class="xref" href="indices-create-index.html" title="Create index API">create a custom destination index</a> or
<a class="xref" href="indices-templates.html" title="Index templates">define an index template</a>.</p>
<h4><a id="transform-batch-limitations"></a>Batch transforms may not account for changed documents<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/transform/limitations.asciidoc">edit</a></h4>
<p>A batch transform uses a
<a class="xref" href="search-aggregations-bucket-composite-aggregation.html" title="Composite aggregation">composite aggregation</a>
which allows efficient pagination through all buckets. Composite aggregations
do not yet support a search context, therefore if the source data is changed
(deleted, updated, added) while the batch data frame is in progress, then the
results may not include these changes.</p>
<h4><a id="transform-consistency-limitations"></a>Continuous transform consistency does not account for deleted or updated documents<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/transform/limitations.asciidoc">edit</a></h4>
<p>While the process for transforms allows the continual recalculation of the
transform as new data is being ingested, it does also have some limitations.</p>
<p>Changed entities will only be identified if their time field has also been
updated and falls within the range of the action to check for changes. This has
been designed in principle for, and is suited to, the use case where new data is
given a timestamp for the time of ingest.</p>
<p>If the indices that fall within the scope of the source index pattern are
removed, for example when deleting historical time-based indices, then the
composite aggregation performed in consecutive checkpoint processing will search
over different source data, and entities that only existed in the deleted index
will not be removed from the data frame destination index.</p>
<p>Depending on your use case, you may wish to recreate the transform entirely
after deletions. Alternatively, if your use case is tolerant to historical
archiving, you may wish to include a max ingest timestamp in your aggregation.
This will allow you to exclude results that have not been recently updated when
viewing the destination index.</p>
<h4><a id="transform-deletion-limitations"></a>Deleting a transform does not delete the destination index or Kibana index pattern<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/transform/limitations.asciidoc">edit</a></h4>
<p>When deleting a transform using <code class="literal">DELETE _transform/index</code>
neither the destination index nor the Kibana index pattern, should one have been
created, are deleted. These objects must be deleted separately.</p>
<h4><a id="transform-aggregation-page-limitations"></a>Handling dynamic adjustment of aggregation page size<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/transform/limitations.asciidoc">edit</a></h4>
<p>During the development of transforms, control was favoured over performance.
In the design considerations, it is preferred for the transform to take longer
to complete quietly in the background rather than to finish quickly and take
precedence in resource consumption.</p>
<p>Composite aggregations are well suited for high cardinality data enabling
pagination through results. If a <a class="xref" href="circuit-breaker.html" title="Circuit breaker settings">circuit breaker</a> memory
exception occurs when performing the composite aggregated search then we try
again reducing the number of buckets requested. This circuit breaker is
calculated based upon all activity within the cluster, not just activity from
transforms, so it therefore may only be a temporary resource
availability issue.</p>
<p>For a batch transform, the number of buckets requested is only ever adjusted
downwards. The lowering of value may result in a longer duration for the
transform checkpoint to complete. For continuous transforms, the number of buckets
requested is reset back to its default at the start of every checkpoint and it
is possible for circuit breaker exceptions to occur repeatedly in the Elasticsearch logs.</p>
<p>The transform retrieves data in batches which means it calculates several
buckets at once. Per default this is 500 buckets per search/index operation. The
default can be changed using <code class="literal">max_page_search_size</code> and the minimum value is 10.
If failures still occur once the number of buckets requested has been reduced to
its minimum, then the transform will be set to a failed state.</p>
<h4><a id="transform-dynamic-adjustments-limitations"></a>Handling dynamic adjustments for many terms<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/transform/limitations.asciidoc">edit</a></h4>
<p>For each checkpoint, entities are identified that have changed since the last
time the check was performed. This list of changed entities is supplied as a
<a class="xref" href="query-dsl-terms-query.html" title="Terms query">terms query</a> to the transform composite aggregation,
one page at a time. Then updates are applied to the destination index for each
page of entities.</p>
<p>The page <code class="literal">size</code> is defined by <code class="literal">max_page_search_size</code> which is also used to
define the number of buckets returned by the composite aggregation search. The
default value is 500, the minimum is 10.</p>
<p>The index setting <a class="xref" href="index-modules.html#dynamic-index-settings" title="Dynamic index settings"><code class="literal">index.max_terms_count</code></a> defines
the maximum number of terms that can be used in a terms query. The default value
is 65536. If <code class="literal">max_page_search_size</code> exceeds <code class="literal">index.max_terms_count</code> the
transform will fail.</p>
<p>Using smaller values for <code class="literal">max_page_search_size</code> may result in a longer duration
for the transform checkpoint to complete.</p>
<h4><a id="transform-scheduling-limitations"></a>Continuous transform scheduling limitations<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/transform/limitations.asciidoc">edit</a></h4>
<p>A continuous transform periodically checks for changes to source data. The functionality
of the scheduler is currently limited to a basic periodic timer which can be
within the <code class="literal">frequency</code> range from 1s to 1h. The default is 1m. This is designed
to run little and often. When choosing a <code class="literal">frequency</code> for this timer consider
your ingest rate along with the impact that the transform
search/index operations has other users in your cluster. Also note that retries
occur at <code class="literal">frequency</code> interval.</p>
<h4><a id="transform-failed-limitations"></a>Handling of failed transforms<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/transform/limitations.asciidoc">edit</a></h4>
<p>Failed transforms remain as a persistent task and should be handled
appropriately, either by deleting it or by resolving the root cause of the
failure and re-starting.</p>
<p>When using the API to delete a failed transform, first stop it using
<code class="literal">_stop?force=true</code>, then delete it.</p>
<h4><a id="transform-availability-limitations"></a>Continuous transforms may give incorrect results if documents are not yet available to search<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/transform/limitations.asciidoc">edit</a></h4>
<p>After a document is indexed, there is a very small delay until it is available
to search.</p>
<p>A continuous transform periodically checks for changed entities between the time since
it last checked and <code class="literal">now</code> minus <code class="literal">sync.time.delay</code>. This time window moves
without overlapping. If the timestamp of a recently indexed document falls
within this time window but this document is not yet available to search then
this entity will not be updated.</p>
<p>If using a <code class="literal">sync.time.field</code> that represents the data ingest time and using a
zero second or very small <code class="literal">sync.time.delay</code>, then it is more likely that this
issue will occur.</p>
<h4><a id="transform-date-nanos"></a>Support for date nanoseconds data type<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/transform/limitations.asciidoc">edit</a></h4>
<p>If your data uses the <a class="xref" href="date_nanos.html" title="Date nanoseconds field type">date nanosecond data type</a>, aggregations
are nonetheless on millisecond resolution. This limitation also affects the
aggregations in your transforms.</p>
<h4><a id="transform-data-streams-destination"></a>Data streams as destination indices are not supported<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/transform/limitations.asciidoc">edit</a></h4>
<p>Transforms update data in the destination index which requires writing
into the destination. <a class="xref" href="data-streams.html" title="Data streams"><em>Data streams</em></a> are designed to be append-only, which
means you cannot send update or delete requests directly to a data stream. For
this reason, data streams are not supported as destination indices for
transforms.</p>
<h4><a id="transform-ilm-destination"></a>ILM as destination index may cause duplicated documents<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/transform/limitations.asciidoc">edit</a></h4>
<p><a class="xref" href="index-lifecycle-management.html" title="ILM: Manage the index lifecycle">ILM</a> is not recommended to use as a transform
destination index. Transforms update documents in the current destination,
and cannot delete documents in the indices previously used by ILM. This may lead
to duplicated documents when you use transforms combined with ILM in case of a
rollover.</p>
<p>If you use ILM to have time-based indices, please consider using the
<a class="xref" href="date-index-name-processor.html" title="Date index name processor">Date index name</a> instead. The processor works without duplicated
documents if your transform contains a <code class="literal">group_by</code> based on <code class="literal">date_histogram</code>.</p>
</div>
<div class="navfooter">
<span class="prev">
<a href="transform-troubleshooting.html">« Troubleshooting transforms</a>
</span>
<span class="next">
<a href="high-availability.html">Set up a cluster for high availability »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>
                <div class="col-xs-12 col-sm-4 col-md-4" id="right_col">
                  <div id="rtpcontainer" style="display: block;">
                    <div class="mktg-promo">
                      <h3>Most Popular</h3>
                      <ul class="icons">
                        <li class="icon-elasticsearch-white"><a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">Get Started with Elasticsearch: Video</a></li>
                        <li class="icon-kibana-white"><a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">Intro to Kibana: Video</a></li>
                        <li class="icon-logstash-white"><a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">ELK for Logs & Metrics: Video</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";
	var localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}';
</script>
<script src="/static/js/swiftype_app_search.umd.min.js"></script>
<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {"alternatives":{"console":{"php":{"hasAny":true},"csharp":{"hasAny":true},"python":{"hasAny":true},"ruby":{"hasAny":true},"go":{"hasAny":true},"js":{"hasAny":true}}}}</script>
  </body>
</html>
