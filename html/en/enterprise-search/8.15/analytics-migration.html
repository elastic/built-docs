<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Migrating from 8.7 to 8.8 | Enterprise Search documentation [8.15] | Elastic</title>
<meta class="elastic" name="content" content="Migrating from 8.7 to 8.8 | Enterprise Search documentation [8.15]">

<link rel="home" href="index.html" title="Enterprise Search documentation [8.15]"/>
<link rel="up" href="upgrading-and-migrating.html" title="Upgrading &amp; migrating"/>
<link rel="prev" href="migrating-from-self-managed-app-search.html" title="Migrating from self-managed App Search"/>
<link rel="next" href="server-known-issues.html" title="Enterprise Search server known issues"/>
<meta class="elastic" name="product_version" content="8.15"/>
<meta class="elastic" name="product_name" content="Enterprise Search"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Enterprise Search/Guide/8.15"/>
<meta name="DC.subject" content="Enterprise Search"/>
<meta name="DC.identifier" content="8.15"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles-v1.css" />
  </head>

  <!--© 2015-2025 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div class="navheader">
<span class="prev">
<a href="migrating-from-self-managed-app-search.html">« Migrating from self-managed App Search</a>
</span>
<span class="next">
<a href="server-known-issues.html">Enterprise Search server known issues »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link">
<div id="related-products" class="dropdown">
<div class="related-products-title"></div>
<div class="dropdown-anchor" tabindex="0">Enterprise Search<span class="dropdown-icon"></span></div>
<div class="dropdown-content">
<ul>
<li class="dropdown-category">Enterprise Search guides</li>
<ul>
<li><a href="/guide/en/enterprise-search/current/index.html" target="_blank">Enterprise Search</a></li>
<li><a href="/guide/en/app-search/current/index.html" target="_blank">App Search</a></li>
<li><a href="/guide/en/workplace-search/current/index.html" target="_blank">Workplace Search</a></li>
</ul>
<li class="dropdown-category">Programming language clients</li>
<ul>
<li><a href="https://www.elastic.co/guide/en/enterprise-search-clients/enterprise-search-node/current/index.html" target="_blank">Node.js client</a></li>
<li><a href="https://www.elastic.co/guide/en/enterprise-search-clients/php/current/index.html" target="_blank">PHP client</a></li>
<li><a href="https://www.elastic.co/guide/en/enterprise-search-clients/python/current/index.html" target="_blank">Python client</a></li>
<li><a href="https://www.elastic.co/guide/en/enterprise-search-clients/ruby/current/index.html" target="_blank">Ruby client</a></li>
</ul>
</ul>
</div>
</div>
</span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="server.html">Elastic Enterprise Search server</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="upgrading-and-migrating.html">Upgrading &amp; migrating</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Migrating from 8.7 to 8.8</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.15/enterprise-search-docs/analytics-migration.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="analytics-migration"></a>Migrating from 8.7 to 8.8<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.15/enterprise-search-docs/analytics-migration.asciidoc">edit</a></h2>
</div></div></div>
<p>Behavioral analytics were introduced in beta in Elastic 8.7.
In version 8.8, the data model changes to support dashboards and future features.
To use these new features, you must migrate to the new data model.
Follow the steps in this document to migrate.</p>
<h4><a id="analytics-migration-8-7-to-8-8-create-collection"></a>1. Create a collection<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.15/enterprise-search-docs/analytics-migration.asciidoc">edit</a></h4>
<p>Any existing analytics collections can continue to receive data, but to use the new analytics features, you must create new collections.
You will need to create a new collection to store your analytics data.
You can do this through the Kibana UI.
Refer to <a href="/guide/en/elasticsearch/reference/8.15/behavioral-analytics-start.html" class="ulink" target="_top">Get started with Behavioral Analytics</a>.</p>
<h4><a id="analytics-migration-8-7-to-8-8-add-events"></a>2. Add existing events to the new collection<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.15/enterprise-search-docs/analytics-migration.asciidoc">edit</a></h4>
<p>If you want to keep your existing events, you will need to:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Transform the data using the data structure outlined in <a class="xref" href="analytics-migration.html#analytics-migration-8-7-to-8-8-update-events" title="3. Update events"><em>Update events</em></a>.
</li>
<li class="listitem">
<a href="/guide/en/elasticsearch/reference/8.15/docs-reindex.html" class="ulink" target="_blank" rel="noopener">Reindex</a> them into the new datastream.
The datastream name is based on the collection name that you created.
For example, if you created a collection called <code class="literal">website</code>, the datastream name will be <code class="literal">website-behavioral_analytics-events</code>.
</li>
</ol>
</div>
<p>Refer to the Elasticsearch <a href="/guide/en/elasticsearch/client/javascript-api/current/reindex_examples.html" class="ulink" target="_top">JavaScript client documentation</a> for an example of how to reindex documents.</p>
<h4><a id="analytics-migration-8-7-to-8-8-update-events"></a>3. Update events<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.15/enterprise-search-docs/analytics-migration.asciidoc">edit</a></h4>
<p>You will need to update your events to the new data structure.</p>
<p><span class="strong strong"><strong>Required fields</strong></span></p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
All events
</span>
</dt>
<dd>
<p>
All events require the following fields:
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">@timestamp</code> (no change since 8.7)
</li>
<li class="listitem">
<p><code class="literal">data_stream</code>(identifies the datastream the event belongs to)</p>
<div class="pre_wrapper lang-javascript">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-javascript">{
  "@timestamp": 1682671778730,
  "data_stream": {
    "namespace": "&lt;your-collection&gt;", // Name of your collection
    "type": "behavioral_analytics", // Fixed value
    "dataset": "events" // Fixed value
  }
}</pre>
</div>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<p>For the following events, you will need to update certain fields.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Search Event
</span>
</dt>
<dd>
<p>
This event represents when a user searches.
</p>
<p><span class="strong strong"><strong>Required fields</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p><code class="literal">search.query</code></p>
<div class="pre_wrapper lang-javascript">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-javascript">{
  search: {
    "query": "laptop", // required
    "filters": {
      "brand": ["apple"]
    },
    page: {
      current: 1,
      size: 10,
    },
    results: { // optional
      items: [
        {
          document: {
            id: "123",
            index: "products"
          },
          page: {
            url: "http://ww.my-website.com/url"
          }
        }
      ],
      total_results: 100
    },
    sort: {
      name: "relevance"
    }
  },
  event: {
    action: "search"
  },
  session: {
    id: "123"
  },
  user: {
    id: "456"
  }
}</pre>
</div>
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Search Click Event
</span>
</dt>
<dd>
<p>
This event represents when a user clicks a document from a search.
</p>
<p><span class="strong strong"><strong>Required Fields</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">search.query</code>
</li>
<li class="listitem">
<p>Any of: <code class="literal">document</code> or <code class="literal">page</code>. Both are preferable.</p>
<div class="pre_wrapper lang-javascript">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-javascript">{
  search: {
    "query": "laptop", // required
    "filters": {
      "brand": ["apple"]
    },
    page: {
      current: 1,
      size: 10,
    },
    results: { // optional
      items: [
        {
          document: {
            id: "123",
            index: "products"
          },
          page: {
            url: "http://ww.my-website.com/url"
          }
        }
      ],
      total_results: 100
    },
    sort: {
      name: "relevance"
    }
  },
  event: {
    action: "search_click"
  },
  document: { id: "123", index: "products" },
  page: {
    url: "http://localhost:3000/javascript-tracker",
    title: "my product detail"
  },
  session: {
    id: "123"
  },
  user: {
    id: "456"
  }
}</pre>
</div>
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Page View Event
</span>
</dt>
<dd>
<p>
This event represents when a user clicks a document from a search.
</p>
<p><span class="strong strong"><strong>Required Fields</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Any of: <code class="literal">document</code> or <code class="literal">page</code>. Both are preferable.</p>
<div class="pre_wrapper lang-javascript">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-javascript">{
  document: { id: "123", index: "products" },
  page: {
    url: "http://localhost:3000/javascript-tracker",
    title: "my product detail"
  },
  event: {
    action: "page_view"
  },
  session: {
    id: "123"
  },
  user: {
    id: "456"
  }
}</pre>
</div>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="sidebar">
<div class="titlepage"><div><div>
<p class="title"><strong>Need help?</strong></p>
</div></div></div>
<p>If you need help transforming events in an 8.7 datastream, reach out to us on the <a href="https://discuss.elastic.co/c/enterprise-search/" class="ulink" target="_top">Elastic Discuss forums</a>.</p>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Behavioral analytics does not support <em>custom</em> events in 8.8.
You will not be able to use custom events created in 8.7 in the new data model.</p>
</div>
</div>
<h4><a id="analytics-migration-8-7-to-8-8-update-tracker-integration"></a>4. Update your tracker integration<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.15/enterprise-search-docs/analytics-migration.asciidoc">edit</a></h4>
<p>Depending on how you integrated the tracker (using either the <code class="literal">browser-tracker</code> or the <code class="literal">javascript-tracker</code>), you will need to update the integration to continue to capture events.</p>
<p>Follow the steps in your collection&#8217;s integration page to update your integration.
Find this under <span class="strong strong"><strong>Search &gt; Behavioral Analytics &gt;</strong></span> <em>&lt;my-collection&gt;</em> <span class="strong strong"><strong>&gt; Integration</strong></span>.</p>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="migrating-from-self-managed-app-search.html">« Migrating from self-managed App Search</a>
</span>
<span class="next">
<a href="server-known-issues.html">Enterprise Search server known issues »</a>
</span>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>

                        <!-- Feedback widget -->
                        <div id="feedbackWidgetContainer"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


        <div id='elastic-footer'></div>
        <script src='https://www.elastic.co/elastic-footer.js'></script>
        <!-- Footer Section end-->

      </section>
    </div>

    <!-- Feedback modal -->
    <div id="feedbackModalContainer"></div>

    <script src="/guide/static/jquery.js"></script>
    <script type="text/javascript" src="/guide/static/docs-v1.js"></script>
    <script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
