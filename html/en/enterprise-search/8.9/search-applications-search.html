<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Build a search experience with the Search Application client | Enterprise Search documentation [8.9] | Elastic</title>
<meta class="elastic" name="content" content="Build a search experience with the Search Application client | Enterprise Search documentation [8.9]">

<link rel="home" href="index.html" title="Enterprise Search documentation [8.9]"/>
<link rel="up" href="search-applications.html" title="Elastic Search Applications"/>
<link rel="prev" href="search-applications-safe-search.html" title="Using search applications with untrusted clients"/>
<link rel="next" href="server.html" title="Elastic Enterprise Search server"/>
<meta class="elastic" name="product_version" content="8.9"/>
<meta class="elastic" name="product_name" content="Enterprise Search"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Enterprise Search/Guide/8.9"/>
<meta name="DC.subject" content="Enterprise Search"/>
<meta name="DC.identifier" content="8.9"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <!--© 2015-2022 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  <div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link">
<div id="related-products" class="dropdown">
<div class="related-products-title"></div>
<div class="dropdown-anchor" tabindex="0">Enterprise Search<span class="dropdown-icon"></span></div>
<div class="dropdown-content">
<ul>
<li class="dropdown-category">Enterprise Search guides</li>
<ul>
<li><a href="/guide/en/enterprise-search/current/index.html" target="_blank">Enterprise Search</a></li>
<li><a href="/guide/en/app-search/current/index.html" target="_blank">App Search</a></li>
<li><a href="/guide/en/workplace-search/current/index.html" target="_blank">Workplace Search</a></li>
</ul>
<li class="dropdown-category">Programming language clients</li>
<ul>
<li><a href="https://www.elastic.co/guide/en/enterprise-search-clients/enterprise-search-node/current/index.html" target="_blank">Node.js client</a></li>
<li><a href="https://www.elastic.co/guide/en/enterprise-search-clients/php/current/index.html" target="_blank">PHP client</a></li>
<li><a href="https://www.elastic.co/guide/en/enterprise-search-clients/python/current/index.html" target="_blank">Python client</a></li>
<li><a href="https://www.elastic.co/guide/en/enterprise-search-clients/ruby/current/index.html" target="_blank">Ruby client</a></li>
</ul>
</ul>
</div>
</div>
</span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="search-applications.html">Elastic Search Applications</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="search-applications-safe-search.html">« Using search applications with untrusted clients</a>
</span>
<span class="next">
<a href="server.html">Elastic Enterprise Search server »</a>
</span>
</div>
<div class="chapter">
<div class="titlepage"><div><div>
<h2 class="title"><a id="search-applications-search"></a>Build a search experience with the Search Application client<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.9/enterprise-search-docs/search-applications-search.asciidoc">edit</a></h2>
</div></div></div>

<p>This document is a how-to guide to building a search experience with a <a class="xref" href="search-applications.html" title="Elastic Search Applications">search application</a>, using the <a href="https://github.com/elastic/search-application-client" class="ulink" target="_blank" rel="noopener">Search Application client</a>.
The client is a JavaScript library designed to be used in the browser.
You&#8217;ll integrate this library into your web app to simplify querying your search application.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>A <a href="https://github.com/elastic/search-application-client/blob/main/examples/sandbox/README.md" class="ulink" target="_top">sandbox environment</a> is available for testing and experimenting with the <code class="literal">search-application-client</code> library.
Jump there if you&#8217;d like to try out the client without setting up your own web app.</p>
<p>Clone the <a href="https://github.com/elastic/search-application-client" class="ulink" target="_top">repository</a> and follow the instructions in the README to get started.</p>
</div>
</div>
<h3><a id="search-applications-search-client-goal"></a>Goal<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.9/enterprise-search-docs/search-applications-search.asciidoc">edit</a></h3>
<p>This guide assumes you want to build a web app with the following search features:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Search bar and results with custom relevance
</li>
<li class="listitem">
Control over the presentation of results, such as inclusion/exclusion of fields and highlighting of matching terms
</li>
<li class="listitem">
UI controls such as facets, filters, sorts, pagination
</li>
</ul>
</div>
<p>You can think of the search application as the "server side" that persists changes to Elasticsearch.
Your web app acts as the "client side" that queries the search application.
You&#8217;ll be making edits to both your search application and your web app to complete the implementation.</p>
<h3><a id="search-applications-search-client-prerequisites"></a>Prerequisites<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.9/enterprise-search-docs/search-applications-search.asciidoc">edit</a></h3>
<p>To follow this guide, you&#8217;ll need:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>An <span class="strong strong"><strong>Elastic deployment</strong></span>, that satisfies the <a class="xref" href="search-applications.html#search-applications-prerequisites" title="Availability and prerequisites">prerequisites</a> for running a search application.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If you don&#8217;t have an Elastic deployment, start a free trial on <a href="https://cloud.elastic.co" class="ulink" target="_blank" rel="noopener">Elastic Cloud</a>.
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>A <span class="strong strong"><strong>search application</strong></span>.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Create and manage search applications in the <a class="xref" href="search-applications.html#search-applications-get-started-ui" title="Option 1: Get started in the UI">Kibana UI</a> or using the <a href="/guide/en/elasticsearch/reference/8.9/put-search-application.html" class="ulink" target="_top">API</a>.
</li>
</ul>
</div>
</li>
<li class="listitem">
A <span class="strong strong"><strong>web app</strong></span> to query your search application, using <a href="https://github.com/elastic/search-application-client#installation" class="ulink" target="_top">Search Application client</a>.
</li>
</ul>
</div>
<h3><a id="search-applications-search-client-configuration"></a>Install and configure the client<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.9/enterprise-search-docs/search-applications-search.asciidoc">edit</a></h3>
<h4><a id="search-applications-search-client-configuration-install"></a>Install the client<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.9/enterprise-search-docs/search-applications-search.asciidoc">edit</a></h4>
<p><a href="https://github.com/elastic/search-application-client/blob/main/README.md#installation" class="ulink" target="_blank" rel="noopener">Install</a> the client using npm, yarn, or a CDN.</p>
<p><span class="strong strong"><strong>Option 1: Using package manager</strong></span></p>
<p>To install the client using <span class="strong strong"><strong>npm</strong></span>, run the following command:</p>
<div class="pre_wrapper lang-bash">
<pre class="programlisting prettyprint lang-bash">npm install @elastic/search-application-client</pre>
</div>
<p>To install the client using <span class="strong strong"><strong>yarn</strong></span>, run the following command:</p>
<div class="pre_wrapper lang-bash">
<pre class="programlisting prettyprint lang-bash">yarn add @elastic/search-application-client</pre>
</div>
<p><span class="strong strong"><strong>Option 2: Using CDN with HTML <code class="literal">&lt;script&gt;</code> tag</strong></span></p>
<p>Alternatively, you can install the client using a CDN.
Add the following <code class="literal">&lt;script&gt;</code> tag to your web app&#8217;s HTML:</p>
<div class="pre_wrapper lang-html">
<pre class="programlisting prettyprint lang-html">&lt;script src="https://cdn.jsdelivr.net/npm/@elastic/search-application-client@latest"&gt;&lt;/script&gt;</pre>
</div>
<h4><a id="search-applications-search-client-configuration-import"></a>Import and initialize the client<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.9/enterprise-search-docs/search-applications-search.asciidoc">edit</a></h4>
<p>Once installed, you can import the client into your web app.
You&#8217;ll need the following information to initialize the client:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
The <span class="strong strong"><strong>name</strong></span> of your search application
</li>
<li class="listitem">
The <span class="strong strong"><strong>URL endpoint</strong></span> for your search application
</li>
<li class="listitem">
The <span class="strong strong"><strong>API key</strong></span> for your search application
</li>
</ul>
</div>
<p>Find this information on the <span class="strong strong"><strong>Connect</strong></span> page in the Kibana UI.</p>
<h5><a id="search-applications-search-client-configuration-import-js"></a>Option 1: Using JavaScript modules<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.9/enterprise-search-docs/search-applications-search.asciidoc">edit</a></h5>
<p>Use the following import statement:</p>
<div class="pre_wrapper lang-javascript">
<pre class="programlisting prettyprint lang-javascript">import SearchApplicationClient from '@elastic/search-application-client';</pre>
</div>
<p>Configure the client with your deployment details to start making search requests.
You can generate an API key on the <span class="strong strong"><strong>Connect</strong></span> page in the Kibana UI.
Go to <span class="strong strong"><strong>Enterprise Search &gt; Search Applications &gt;</strong></span> &lt;MY_SEARCH_APPLICATION&gt; <span class="strong strong"><strong>&gt; Connect</strong></span>.
You&#8217;ll find the following information prepopulated to initialize the client:</p>
<div class="pre_wrapper lang-javascript">
<pre class="programlisting prettyprint lang-javascript">import Client from '@elastic/search-application-client'

const request = Client(
  'my-search-application', // search application name
  'url-from-connect-page', // url-host
  'api-key-from-connect-page',  // api-key
  {
    // optional configuration
  }
)</pre>
</div>
<p>Once configured you&#8217;ll be able to make search requests to your search application using the <a href="https://github.com/elastic/search-application-client#api-reference" class="ulink" target="_top">client API</a>, like this:</p>
<div class="pre_wrapper lang-javascript">
<pre class="programlisting prettyprint lang-javascript">const results = await request()
  .query('star wars')
  .search()</pre>
</div>
<h5><a id="search-applications-search-client-configuration-import-cdn"></a>Option 2: Using CDN<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.9/enterprise-search-docs/search-applications-search.asciidoc">edit</a></h5>
<p>Alternatively, if you&#8217;re using a CDN, you can import the client using the following statement:</p>
<div class="pre_wrapper lang-html">
<pre class="programlisting prettyprint lang-html">&lt;script&gt;
  const Client = window['SearchApplicationClient'];
&lt;/script&gt;</pre>
</div>
<p>Configure the client with your deployment details to start making search requests.
You can generate an API key on the <span class="strong strong"><strong>Connect</strong></span> page in the Kibana UI.
Go to <span class="strong strong"><strong>Enterprise Search &gt; Search Applications &gt;</strong></span> &lt;MY_SEARCH_APPLICATION&gt; <span class="strong strong"><strong>&gt; Connect</strong></span>.
You&#8217;ll find the following information prepopulated to initialize the client:</p>
<div class="pre_wrapper lang-html">
<pre class="programlisting prettyprint lang-html">&lt;script&gt;
  const request = Client(
    'my-example-app', // search application name
    'url-from-connect-page', // url-host
    'api-key-from-connect-page',  // api-key
    {
    // optional configuration
    }
)
&lt;/script&gt;</pre>
</div>
<p>Once configured you&#8217;ll be able to make search requests to your search application using the <a href="https://github.com/elastic/search-application-client#api-reference" class="ulink" target="_top">client API</a>, like this:</p>
<div class="pre_wrapper lang-html">
<pre class="programlisting prettyprint lang-html">&lt;script&gt;
  const results = await request()
    .query('star wars')
    .search()
&lt;/script&gt;</pre>
</div>
<h3><a id="search-applications-search-client-template"></a>Working with your search template<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.9/enterprise-search-docs/search-applications-search.asciidoc">edit</a></h3>
<p>The Search Application client is designed to work with any <a class="xref" href="search-applications-templates.html" title="Working with search templates">search template</a> you create.
You&#8217;ll use the Search Application APIs to create and manage your search templates.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>When working with the Search Application APIs to manage templates, we provide the API examples using <a href="/guide/en/kibana/8.9/console-kibana.html" class="ulink" target="_blank" rel="noopener">Kibana Console</a> syntax.</p>
</div>
</div>
<p>Here&#8217;s an example template:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT _application/search_application/my-example-app
{
  "indices": ["my-example-app"],
  "template": {
    "script": {
      "lang": "mustache",
      "source": """
        {
          "query": {
            "bool": {
              "must": [
              {{#query}}
              {
                "query_string": {
                  "query": "{{query}}",
                  "search_fields": {{#toJson}}search_fields{{/toJson}}
                }
              }
              {{/query}}
            ]
            }
          }
        }
      """,
      "params": {
        "query": "",
        "search_fields": ""
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/41.console"></div>
<p>This will allow you to add any template parameters you need to your template and then provide the values in your client request.
Use <code class="literal">addParameter</code> to inject actual values into your template parameters.</p>
<p>For example, pass in values for <code class="literal">search_fields</code> like this:</p>
<div class="pre_wrapper lang-javascript">
<pre class="programlisting prettyprint lang-javascript">const results = await request()
  .query('star wars') // requires the template to use query parameter
  .addParameter('search_fields', ['title', 'description'])
  .search()</pre>
</div>
<h4><a id="search-applications-search-client-template-example"></a>Example template<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.9/enterprise-search-docs/search-applications-search.asciidoc">edit</a></h4>
<p>We recommend getting started with the <a href="https://github.com/elastic/search-application-client#boilerplate-template" class="ulink" target="_blank" rel="noopener">boilerplate template</a> provided in the client repository.
<a href="https://github.com/elastic/search-application-client/blob/main/bin/boilerplate_template.js" class="ulink" target="_blank" rel="noopener">View this script</a> to see how this is used.
The <code class="literal">dictionary</code> parameter is used to pass in a JSON schema definition that describes structure and validation rules for the request object.
This schema is important, because it restricts the use of certain features in the Elasticsearch query.
<a href="https://github.com/elastic/search-application-client/blob/main/bin/request_schema.json" class="ulink" target="_blank" rel="noopener">View the schema</a>.</p>
<p>Each search functionality in this guide requires a feature included in this template.
These features require specific parameters to be present in the template:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Query: <code class="literal">query</code>
</li>
<li class="listitem">
Filters: <code class="literal">_es_filters</code>
</li>
<li class="listitem">
Faceting: <code class="literal">_es_filters</code> and  <code class="literal">_es_aggs</code>
</li>
<li class="listitem">
Sorting: <code class="literal">_es_sort_fields</code>
</li>
<li class="listitem">
Pagination: <code class="literal">from</code> and <code class="literal">size</code>
</li>
</ul>
</div>
<h3><a id="search-applications-search-client-features"></a>Search features<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.9/enterprise-search-docs/search-applications-search.asciidoc">edit</a></h3>
<p>We will explore all the essential basics you&#8217;ll need for a search experience.
You&#8217;ll learn how to implement them using your search application and query them using the client.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>Refer to the <a href="https://github.com/elastic/search-application-client#api-reference" class="ulink" target="_blank" rel="noopener">client repo</a> for information on the available methods and their parameters.</p>
</div>
</div>
<h4><a id="search-applications-search-client-features-relevance"></a>Customizing relevance<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.9/enterprise-search-docs/search-applications-search.asciidoc">edit</a></h4>
<p>Our simple template uses <code class="literal">query_string</code> searching across all fields, but this may not suit your use case.
You can update the template to provide better relevance recall.</p>
<p>In the below example, we’re using a <code class="literal">multi-match</code> query against our template, with <code class="literal">best_fields</code> and <code class="literal">phrase_prefix</code> queries targeting different search fields.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT _application/search_application/my-example-app
{
  "indices": ["example-index"],
  "template": {
    "script": {
      "lang": "mustache",
      "source": """
        {
          "query": {
            "bool": {
              "must": [
              {{#query}}
              {
                "multi_match" : {
                  "query":    "{{query}}",
                  "fields": [ "title^4", "plot", "actors", "directors" ]
                }
              },
              {
                "multi_match" : {
                  "query":    "{{query}}",
                  "type": "phrase_prefix",
                  "fields": [ "title^4", "plot"]
                }
              },
              {{/query}}
            ],
            "filter": {{#toJson}}_es_filters{{/toJson}}
            }
          },
          "aggs": {{#toJson}}_es_aggs{{/toJson}},
          "from": {{from}},
          "size": {{size}},
          "sort": {{#toJson}}_es_sort_fields{{/toJson}}
        }
      """,
      "params": {
        "query": "",
        "_es_filters": {},
        "_es_aggs": {},
        "_es_sort_fields": {},
        "size": 10,
        "from": 0
      },
      "dictionary": {
          //  add dictionary restricting
          // _es_filters, _es_sort_fields &amp; _es_aggs params
          // Use example provided in repo: https://github.com/elastic/search-application-client/blob/main/bin/request_schema.json
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/42.console"></div>
<p>Refer to <a class="xref" href="search-applications-templates.html#search-applications-templates-examples" title="Search template examples">Search template examples</a> for examples of different types of queries, including combinations of text search, kNN search, ELSER search, hybrid search with RRF, and more.</p>
<p><span class="strong strong"><strong>Use case: I want to dynamically adjust the search fields</strong></span></p>
<p>If you need to adjust <code class="literal">search_fields</code> at query request time, you can add a new parameter to the template (for example: <code class="literal">search_fields</code>) and use the <code class="literal">addParameter</code> method to provide the fields to the template.</p>
<p><span class="strong strong"><strong>Use case: I want to boost results given a certain proximity to the user</strong></span></p>
<p>You can add additional template parameters to send the geo-coordinates of the user.
Then use <a href="/guide/en/elasticsearch/reference/8.9/query-dsl-function-score-query.html" class="ulink" target="_top"><code class="literal">function_score</code></a> to boost documents which match a certain <a href="/guide/en/elasticsearch/reference/8.9/query-dsl-geo-distance-query.html" class="ulink" target="_top"><code class="literal">geo_distance</code></a> from the user.</p>
<h4><a id="search-applications-search-client-features-result-fields"></a>Result fields<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.9/enterprise-search-docs/search-applications-search.asciidoc">edit</a></h4>
<p>By default, all fields are returned in the <code class="literal">_source</code> field.
To restrict the fields returned, specify the fields in the template.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT _application/search_application/my-example-app
{
  "indices": ["example-index"],
  "template": {
    "script": {
      "lang": "mustache",
      "source": """
        {
          "query": {
            "bool": {
              "must": [
              {{#query}}
                // ...
              {{/query}}
            ],
            "filter": {{#toJson}}_es_filters{{/toJson}}
            }
          },
          "_source": {
            "includes": ["title", "plot"]
          },
          "aggs": {{#toJson}}_es_aggs{{/toJson}},
          "from": {{from}},
          "size": {{size}},
          "sort": {{#toJson}}_es_sort_fields{{/toJson}}
        }
      """,
      "params": {
        "query": "",
        "_es_filters": {},
        "_es_aggs": {},
        "_es_sort_fields": {},
        "size": 10,
        "from": 0
      },
      "dictionary": {
          //  add dictionary restricting _es_filters and _es_aggs params
          // Use the dictionary example provided in repo: https://github.com/elastic/search-application-client/blob/main/bin/request_schema.json
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/43.console"></div>
<p><span class="strong strong"><strong>Use case: I want to dynamically adjust the result fields</strong></span></p>
<p>If you need to adjust the fields returned at query request time, you can add a new parameter to the template (for example: <code class="literal">result_fields</code>) and use the <code class="literal">addParameter</code> method to provide the fields to the template.</p>
<h4><a id="search-applications-search-client-features-highlight-snippets"></a>Highlighting and snippets<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.9/enterprise-search-docs/search-applications-search.asciidoc">edit</a></h4>
<p>Highlighting support is straightforward to add to the template.
With the <a href="/guide/en/elasticsearch/reference/8.9/highlighting.html" class="ulink" target="_top">highlighting API</a>, you can specify which fields you want to highlight for matches.</p>
<p>In the following example, we specify <code class="literal">title</code> and <code class="literal">plot</code> as the highlighted fields.
<code class="literal">title</code> typically has a short value length, compared to <code class="literal">plot</code> which is variable and tends to be longer.</p>
<p>We specify the title to be <code class="literal">fragment_size</code> of <code class="literal">0</code> to return all of the text when there is a highlight.
We specify the plot to be <code class="literal">fragment_size</code> of <code class="literal">200</code>, where each highlighted fragment will be up to 200 characters long.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT _application/search_application/my-example-app
{
  "indices": ["example-index"],
  "template": {
    "script": {
      "lang": "mustache",
      "source": """
        {
          "query": {
            "bool": {
              "must": [
              {{#query}}
                // ...
              {{/query}}
            ],
            "filter": {{#toJson}}_es_filters{{/toJson}}
            }
          },
          "_source": {
            "includes": ["title", "plot"]
            },
            "highlight": {
              "fields": {
                "title": { "fragment_size": 0 },
                "plot": { "fragment_size": 200 }
                }
                },
                "aggs": {{#toJson}}_es_aggs{{/toJson}},
                "from": {{from}},
                "size": {{size}},
                "sort": {{#toJson}}_es_sort_fields{{/toJson}}
                }
                """,
                "params": {
                  "query": "",
                  "_es_filters": {},
                  "_es_aggs": {},
                  "_es_sort_fields": {},
                  "size": 10,
                  "from": 0
                  },
                  "dictionary": {
                    //  add dictionary restricting _es_filters and _es_aggs params
                    // Use the dictionary example provided in repo: https://github.com/elastic/search-application-client/blob/main/bin/request_schema.json
                    }
                }
           }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/44.console"></div>
<p>If a match was found, this will return the results with a highlight field.
For example:</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
  "hits": [
    {
      "_index": "movies",
      "_type": "_doc",
      "_id": "1",
      "_score": 0.2876821,
      "_source": {
        "title": "The Great Gatsby",
        "plot": "The Great Gatsby is a novel by F. Scott Fitzgerald that follows the story of Jay Gatsby, a wealthy and mysterious man, as he tries to win back the love of his life, Daisy Buchanan."
      },
      "highlight": {
        "title": ["The Great &lt;em&gt;Gatsby&lt;/em&gt;"],
        "plot": [
          "The Great &lt;em&gt;Gatsby&lt;/em&gt; is a novel by F. Scott Fitzgerald that follows the story of &lt;em&gt;Jay&lt;/em&gt; &lt;em&gt;Gatsby&lt;/em&gt;, a wealthy and mysterious man, as he tries to win back the love of his life, Daisy Buchanan."
        ]
      }
    }
  ]
}</pre>
</div>
<h5><a id="search-applications-search-client-features-highlight-helpers"></a>Highlighting helper<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.9/enterprise-search-docs/search-applications-search.asciidoc">edit</a></h5>
<p>When displaying the fields in the frontend, you will need to first determine if the field has a highlight.
To simplify this, we provide a helper.</p>
<div class="pre_wrapper lang-javascript">
<pre class="programlisting prettyprint lang-javascript">import Client, { Highlight } from '@elastic/search-application-client'

// example React component
const ResultsList = ({ hits } ) =&gt; {
  return hits.map((hit) =&gt; (
    &lt;div className="result"&gt;
       &lt;div className="title"&gt;{Highlight(hit, "title")}&lt;/div&gt;
       &lt;div className="description"&gt;{Highlight(hit, "plot")}&lt;/div&gt;
    &lt;/div&gt;
  ))
}</pre>
</div>
<h4><a id="search-applications-search-client-features-pagination"></a>Pagination<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.9/enterprise-search-docs/search-applications-search.asciidoc">edit</a></h4>
<p>To use pagination, set the page number and the page size.
By default, the page size is 10.
The <code class="literal">size</code> and <code class="literal">from</code> parameters allow you to control the page and number of hits returned in the response.</p>
<p>We can do this using the client with the <code class="literal">setSize</code> and <code class="literal">setFrom</code> methods.</p>
<div class="pre_wrapper lang-javascript">
<pre class="programlisting prettyprint lang-javascript">// page 1
const results = await request()
 .setSize(20)
 .setFrom(0)
 .search()

// page 2
const results = await request()
 .setSize(20)
 .setFrom(20)
 .search()</pre>
</div>
<h4><a id="search-applications-search-client-features-sorting"></a>Sorting<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.9/enterprise-search-docs/search-applications-search.asciidoc">edit</a></h4>
<p>To use sorting, specify the field name and the sort order or <code class="literal">pass _score</code> to sort by relevance.
Requires the <code class="literal">_es_sort_fields_fields</code> param in the search template.
Refer to our <a class="xref" href="search-applications-search.html#search-applications-search-client-template-example" title="Example template">example template</a> to see where this is used.</p>
<p>By default, the results will be sorted in order of score.
If you need to sort on a field other than the score, use the <code class="literal">setSort</code> method with an array of objects.</p>
<div class="pre_wrapper lang-javascript">
<pre class="programlisting prettyprint lang-javascript">const results = await request()
 .setSort([{ year: 'asc' }, '_score'])
 .search()</pre>
</div>
<h4><a id="search-applications-search-client-features-filter"></a>Filtering<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.9/enterprise-search-docs/search-applications-search.asciidoc">edit</a></h4>
<p>The Search application client also supports filters and facets.
To use these, you need to add two parameters:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">_es_filters</code>
</li>
<li class="listitem">
<code class="literal">_es_aggs</code>
</li>
</ul>
</div>
<p>Refer to our <a class="xref" href="search-applications-search.html#search-applications-search-client-template-example" title="Example template">example template</a> to see where these are used.</p>
<h5><a id="search-applications-search-client-features-filter-base"></a>Base Filtering<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.9/enterprise-search-docs/search-applications-search.asciidoc">edit</a></h5>
<p>With a template that’s configured to use filters, use the <code class="literal">setFilter</code> method to add filters to your query.</p>
<p>The boilerplate template schema only supports term, range, match, nested, geo_bounding_box and geo_distance filters.
If you need to use a particular clause, you can update the template schema.</p>
<p>Below is an example of using <code class="literal">setFilter</code>.</p>
<div class="pre_wrapper lang-javascript">
<pre class="programlisting prettyprint lang-javascript">// return only "star wars" movies that are rated PG
const results = await request()
  .query('star wars')
  .setFilter({
    term: {
      'rated.enum': 'PG',
    },
  })
  .search()</pre>
</div>
<h4><a id="search-applications-search-client-features-facets"></a>Facets<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.9/enterprise-search-docs/search-applications-search.asciidoc">edit</a></h4>
<p>The client supports the ability to configure facets with your results.
Specify facets in the client initialization call.
For example, say we want to add facets for actors, directors and IMDB rating.</p>
<div class="pre_wrapper lang-javascript">
<pre class="programlisting prettyprint lang-javascript">const request = Client(
  'my-example-app', // search application name
  'https://d1bd36862ce54c7b903e2aacd4cd7f0a.us-east4.gcp.elastic-cloud.com:443', // api-host
  'api-key-from-connect-page', // api-key
  {
    facets: {
      actors: {
        type: 'terms',
        field: 'actors.keyword',
        disjunctive: true,
      },
      directors: {
        type: 'terms',
        field: 'director.keyword',
        size: 20,
        disjunctive: true,
      },
      imdbrating: {
        type: 'stats',
        field: 'imdbrating',
      },
    },
  }
)</pre>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>In Elasticsearch, the <code class="literal">keyword</code> type is used for fields that need to be searchable in their exact, unmodified form.
This means these queries are case-sensitive.
We use this type for facets because facets require aggregating and filtering data based on exact values or terms.</p>
</div>
</div>
<p>Use the <code class="literal">addFacetFilter</code> method to add facets to your query.</p>
<p>In the following example, we only want to return movies:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Featuring Harrison Ford as actor
</li>
<li class="listitem">
Directed by George Lucas <em>or</em> Ridley Scott
</li>
<li class="listitem">
With an IMBD rating greater than 7.5
</li>
</ul>
</div>
<div class="pre_wrapper lang-javascript">
<pre class="programlisting prettyprint lang-javascript">const results = await request()
  .addFacetFilter('actors', 'Harrison Ford')
  .addFacetFilter('directors', 'George Lucas')
  .addFacetFilter('directors', 'Ridley Scott')
  .addFacetFilter('imdbrating', {
    gte: 7.5,
  })
  .search()</pre>
</div>
<p>You can access the facets in the results:</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
  "took": 1,
  "timed_out": false,
  "_shards": {
    "total": 1,
    "successful": 1,
    "skipped": 0,
    "failed": 0
  },
  "hits": {
    "total": {
      "value": 2,
      "relation": "eq"
    },
    "max_score": 0,
    "hits": [
      {
        "_index": "imdb_movies",
        "_id": "tt0076759",
        "_score": 0,
        "_source": {
          "title": "Star Wars: Episode IV - A New Hope",
          "actors": [
            "Mark Hamill",
            "Harrison Ford",
            "Carrie Fisher",
            "Peter Cushing"
          ],
          "plot": "Luke Skywalker joins forces with a Jedi Knight, a cocky pilot, a wookiee and two droids to save the universe from the Empire's world-destroying battle-station, while also attempting to rescue Princess Leia from the evil Darth Vader.",
          "poster": "https://s3-eu-west-1.amazonaws.com/imdbimages/images/MV5BMTU4NTczODkwM15BMl5BanBnXkFtZTcwMzEyMTIyMw@@._V1_SX300.jpg"
        }
      },
      {
        "_index": "imdb_movies",
        "_id": "tt0083658",
        "_score": 0,
        "_source": {
          "title": "Blade Runner",
          "actors": [
            "Harrison Ford",
            "Rutger Hauer",
            "Sean Young",
            "Edward James Olmos"
          ],
          "plot": "Deckard, a blade runner, has to track down and terminate 4 replicants who hijacked a ship in space and have returned to Earth seeking their maker.",
          "poster": "https://s3-eu-west-1.amazonaws.com/imdbimages/images/MV5BMTA4MDQxNTk2NDheQTJeQWpwZ15BbWU3MDE2NjIyODk@._V1_SX300.jpg"
        }
      }
    ]
  },
  "aggregations": {},
  "facets": [
    {
      "name": "imdbrating_facet",
      "stats": {
        "min": 8.300000190734863,
        "max": 8.800000190734863,
        "avg": 8.550000190734863,
        "sum": 17.100000381469727,
        "count": 2
      }
    },
    {
      "name": "actors_facet",
      "entries": [
        {
          "value": "Harrison Ford",
          "count": 2
        },
        {
          "value": "Carrie Fisher",
          "count": 1
        },
        {
          "value": "Edward James Olmos",
          "count": 1
        },
        {
          "value": "Mark Hamill",
          "count": 1
        },
        {
          "value": "Peter Cushing",
          "count": 1
        },
        {
          "value": "Rutger Hauer",
          "count": 1
        },
        {
          "value": "Sean Young",
          "count": 1
        }
      ]
    },
    {
      "name": "directors_facet",
      "entries": [
        {
          "value": "Steven Spielberg",
          "count": 3
        },
        {
          "value": "Andrew Davis",
          "count": 1
        },
        {
          "value": "George Lucas",
          "count": 1
        },
        {
          "value": "Irvin Kershner",
          "count": 1
        },
        {
          "value": "Richard Marquand",
          "count": 1
        },
        {
          "value": "Ridley Scott",
          "count": 1
        }
      ]
    }
  ]
}</pre>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="search-applications-safe-search.html">« Using search applications with untrusted clients</a>
</span>
<span class="next">
<a href="server.html">Elastic Enterprise Search server »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
