<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Quick start: Get application traces into the Elastic Stack | Fleet and Elastic Agent Guide [7.15] | Elastic</title>
<link rel="home" href="index.html" title="Fleet and Elastic Agent Guide [7.15]"/>
<link rel="up" href="index.html" title="Fleet and Elastic Agent Guide [7.15]"/>
<link rel="prev" href="fleet-quick-start.html" title="Quick start: Get logs, metrics, and uptime data into the Elastic Stack"/>
<link rel="next" href="integrations.html" title="Integrations"/>
<meta name="DC.type" content="Learn/Docs/Fleet/Guide/Elastic Agent/7.15"/>
<meta name="DC.subject" content="Fleet and Elastic Agent"/>
<meta name="DC.identifier" content="7.15"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <!--© 2015-2022 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!--BEGIN QUALTRICS WEBSITE FEEDBACK SNIPPET-->
    <script type='text/javascript'>
      (function(){var g=function(e,h,f,g){
      this.get=function(a){for(var a=a+"=",c=document.cookie.split(";"),b=0,e=c.length;b<e;b++){for(var d=c[b];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return null};
      this.set=function(a,c){var b="",b=new Date;b.setTime(b.getTime()+6048E5);b="; expires="+b.toGMTString();document.cookie=a+"="+c+b+"; path=/; "};
      this.check=function(){var a=this.get(f);if(a)a=a.split(":");else if(100!=e)"v"==h&&(e=Math.random()>=e/100?0:100),a=[h,e,0],this.set(f,a.join(":"));else return!0;var c=a[1];if(100==c)return!0;switch(a[0]){case "v":return!1;case "r":return c=a[2]%Math.floor(100/c),a[2]++,this.set(f,a.join(":")),!c}return!0};
      this.go=function(){if(this.check()){var a=document.createElement("script");a.type="text/javascript";a.src=g;document.body&&document.body.appendChild(a)}};
      this.start=function(){var a=this;window.addEventListener?window.addEventListener("load",function(){a.go()},!1):window.attachEvent&&window.attachEvent("onload",function(){a.go()})}};
      try{(new g(100,"r","QSI_S_ZN_emkP0oSe9Qrn7kF","https://znemkp0ose9qrn7kf-elastic.siteintercept.qualtrics.com/WRSiteInterceptEngine/?Q_ZID=ZN_emkP0oSe9Qrn7kF")).start()}catch(i){}})();
    </script><div id='ZN_emkP0oSe9Qrn7kF'><!--DO NOT REMOVE-CONTENTS PLACED HERE--></div>
    <!--END WEBSITE FEEDBACK SNIPPET-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  <div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="index.html">Fleet and Elastic Agent Guide [7.15]</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="fleet-quick-start.html">« Quick start: Get logs, metrics, and uptime data into the Elastic Stack</a>
</span>
<span class="next">
<a href="integrations.html">Integrations »</a>
</span>
</div>
<div class="chapter xpack">
<div class="titlepage"><div><div>
<h1 class="title"><a id="fleet-quick-start-traces"></a>Quick start: Get application traces into the Elastic Stack<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/7.15/docs/en/ingest-management/getting-started-traces.asciidoc">edit</a></h1>
</div></div></div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in technical preview and may be changed or removed in a future release. Elastic will apply best effort to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.</p>
</div>
</div>
<p>This guide describes how to:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Collect Application Performance Monitoring (APM) data
</li>
<li class="listitem">
Send APM data to the Elastic Stack
</li>
<li class="listitem">
Explore and visualize the data in real-time
</li>
</ul>
</div>
<p>For feedback and questions, please contact us in the <a href="https://discuss.elastic.co/" class="ulink" target="_top">discuss forum</a>.</p>
<h3><a id="fleet-prereqs-traces"></a>Prerequisites<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/7.15/docs/en/ingest-management/getting-started-traces.asciidoc">edit</a></h3>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
The APM integration is experimental and has a number of known limitations.
Please read the list of <a href="/guide/en/apm/server/7.15/apm-integration.html" class="ulink" target="_top">known limitations</a>.
</li>
<li class="listitem">
<p>You need Elasticsearch for storing and searching your data, and Kibana for visualizing and
managing it. You can use our
<a href="/cloud/elasticsearch-service?baymax=docs-body&amp;elektra=docs" class="ulink" target="_top">hosted Elasticsearch Service</a>
on Elastic Cloud (recommended), or self-manage the Elastic Stack on your own hardware.</p>
<p>Here&#8217;s what you need for each deployment type:</p>
<div class="tabs" data-tab-group="host">
  <div role="tablist" aria-label="Prerequisites">
    <button role="tab"
            aria-selected="true"
            aria-controls="cloud-tab-prereqs"
            id="cloud-prereqs">
      Elasticsearch Service
    </button>
    <button role="tab"
            aria-selected="false"
            aria-controls="self-managed-tab-prereqs"
            id="self-managed-prereqs"
            tabindex="-1">
      Self-managed
    </button>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="cloud-tab-prereqs"
       aria-labelledby="cloud-prereqs">
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Access to a deployment of our <a href="/cloud/elasticsearch-service?baymax=docs-body&amp;elektra=docs" class="ulink" target="_top">hosted Elasticsearch Service</a>
on Elastic Cloud. The Elasticsearch Service is available on AWS, GCP, and Azure. <a href="/cloud/elasticsearch-service/signup?baymax=docs-body&amp;elektra=docs" class="ulink" target="_top">Try it out for free</a>.
This deployment must include an APM &amp; Fleet node.
</li>
<li class="listitem">
User with the superuser role. See <a href="/guide/en/elasticsearch/reference/7.15/built-in-roles.html" class="ulink" target="_top">Built-in roles</a>.
</li>
</ul>
</div>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="self-managed-tab-prereqs"
       aria-labelledby="self-managed-prereqs"
       hidden="">
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Access to an Elasticsearch cluster and Kibana (version 7.15) with a basic
license. <a href="/guide/en/elastic-stack-get-started/7.15/get-started-elastic-stack.html" class="ulink" target="_top">Learn how to install the
Elastic Stack on your own hardware</a>.
</li>
<li class="listitem">
Secure, encrypted connection between Kibana and Elasticsearch. For more information,
see <a href="/guide/en/elasticsearch/reference/7.15/configuring-stack-security.html" class="ulink" target="_top">Configure security for the Elastic Stack</a>.
</li>
<li class="listitem">
User with the superuser role. See <a href="/guide/en/elasticsearch/reference/7.15/built-in-roles.html" class="ulink" target="_top">Built-in roles</a>.
</li>
<li class="listitem">
In the Elasticsearch configuration, the
<a href="/guide/en/elasticsearch/reference/7.15/security-settings.html#api-key-service-settings" class="ulink" target="_top">built-in API key
service</a> must be enabled.
(<code class="literal">xpack.security.authc.api_key.enabled: true</code>)
</li>
<li class="listitem">
In the Kibana configuration, the saved objects encryption key
must be set. Fleet requires this setting in order to save API keys and encrypt
them in Kibana. You can either set <code class="literal">xpack.encryptedSavedObjects.encryptionKey</code> to
an alphanumeric value of at least 32 characters, or run the
<a href="/guide/en/kibana/7.15/kibana-encryption-keys.html" class="ulink" target="_top"><code class="literal">kibana-encryption-keys</code> command</a> to
generate the key.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Example security settings</strong></span></p>
<p>For testing purposes, you can use the following settings to get started quickly,
but make sure you properly secure the Elastic Stack before sending real data.</p>
<p>elasticsearch.yml example:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">xpack.security.enabled: true
xpack.security.authc.api_key.enabled: true</pre>
</div>
<p>kibana.yml example:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">elasticsearch.username: "kibana_system" <a id="CO3-1"></a><i class="conum" data-value="1"></i>
xpack.security.enabled: true
xpack.encryptedSavedObjects.encryptionKey: "something_at_least_32_characters"</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO3-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>The password should be stored in the Kibana keystore as described in the
<a href="/guide/en/elasticsearch/reference/7.15/security-minimal-setup.html" class="ulink" target="_top">Elasticsearch security documentation</a>.</p>
</td>
</tr>
</table>
</div>
  </div>
</div>
</li>
<li class="listitem">
An internet connection is required for Kibana to download integration packages
from the Elastic Package Registry. Make sure the Kibana server can connect to
<code class="literal">https://epr.elastic.co</code> on port <code class="literal">443</code>.
</li>
<li class="listitem">
Fleet is currently only available to users with the
<a href="/guide/en/elasticsearch/reference/7.15/built-in-roles.html" class="ulink" target="_top">superuser role</a>.
</li>
</ul>
</div>
<h3><a id="set-up-fleet-traces"></a>Step 1: Set up Fleet<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/7.15/docs/en/ingest-management/getting-started-traces.asciidoc">edit</a></h3>
<p>Use Fleet in Kibana to get APM data into the Elastic Stack.</p>
<p>The first time you use Fleet, you might need to set it up and add a
Fleet Server:</p>
<div class="tabs" data-tab-group="spin-up-stack">
  <div role="tablist" aria-label="Spin up">
    <button role="tab"
            aria-selected="true"
            aria-controls="cloud-tab-spinup"
            id="cloud-spinup">
      Elasticsearch Service
    </button>
    <button role="tab"
            aria-selected="false"
            aria-controls="self-managed-tab-spinup"
            id="self-managed-spinup"
            tabindex="-1">
      Self-managed
    </button>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="cloud-tab-spinup"
       aria-labelledby="cloud-spinup">
<p>Elastic Cloud runs a hosted version of Fleet Server. No extra setup is required
unless you want to scale your deployment.</p>
<p>To confirm that Fleet Server is available in your deployment:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Log in to Kibana and go to <span class="strong strong"><strong>Management &gt; Fleet</strong></span>.
</li>
<li class="listitem">
Click the <span class="strong strong"><strong>Agents</strong></span> tab.
</li>
<li class="listitem">
Under <span class="strong strong"><strong>Agent policy</strong></span>, look for <span class="strong strong"><strong>Elastic Cloud agent policy</strong></span>&#8201;&#8212;&#8201;Fleet Server is the agent enrolled in the Elastic Cloud agent policy.
This policy is managed by Elastic Cloud. You cannot modify it.
Confirm that the agent status is <span class="strong strong"><strong>Healthy</strong></span>.
</li>
</ol>
</div>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>Don&#8217;t see the Fleet Server agent? Make sure your deployment includes an
APM &amp; Fleet node. This node is required to use Fleet Server.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/fleet-server-hosted-container.png" alt="Fleet Server hosted agent">
</div>
</div>
</div>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>When using our hosted Elasticsearch Service, it&#8217;s recommended that you use our hosted
version of Fleet Server. However, you can choose to deploy and self-manage
Fleet Servers.</p>
</div>
</div>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="self-managed-tab-spinup"
       aria-labelledby="self-managed-spinup"
       hidden="">
<p>To deploy a self-managed Fleet Server, install an Elastic Agent and enroll it in an
agent policy containing the Fleet Server integration.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Log in to Kibana and go to <span class="strong strong"><strong>Management &gt; Fleet</strong></span>. The first time you visit
this page, it might take a minute to load.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Fleet settings</strong></span>, and in the <span class="strong strong"><strong>Fleet Server hosts</strong></span> field, specify the
URLs Elastic Agents will use to connect to Fleet Server. For example,
<code class="literal">https://192.0.2.1:8220</code>, where <code class="literal">192.0.2.1</code> is the host IP where you will
install Fleet Server.
</li>
<li class="listitem">
<p>In the <span class="strong strong"><strong>Elasticsearch hosts</strong></span> field, specify the Elasticsearch URLs where Elastic Agents will send data.
For example, <code class="literal">https://192.0.2.0:9200</code>.</p>
<p>For more information about these settings, see <a class="xref" href="fleet-settings.html" title="Fleet UI settings"><em>Fleet UI settings</em></a>.</p>
</li>
<li class="listitem">
Save and apply the settings.
</li>
<li class="listitem">
<p>Click the <span class="strong strong"><strong>Agents</strong></span> tab and follow the in-product instructions to add a
Fleet server:</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/add-fleet-server.png" alt="In-product instructions for adding a Fleet Server">
</div>
</div>
</li>
</ol>
</div>
<p><span class="strong strong"><strong>Notes:</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Make sure you download an x64 architecture installation package.
</li>
<li class="listitem">
<p>For the agent policy, choose one with a Fleet Server integration. If
one doesn&#8217;t exist, create it.</p>
<div class="sidebar">
<div class="titlepage"><div><div>
<p class="title"><strong>What is a Fleet Server policy?</strong></p>
</div></div></div>
<p>It is an agent policy that contains a Fleet Server integration. In
self-managed clusters, a default Fleet Server policy is created
automatically when you run Fleet for the first time. If you are deploying a
self-managed Fleet Server to work with our hosted Elasticsearch Service, you
must explicitly <a class="xref" href="agent-policy.html#create-a-policy" title="Create a policy">create a new agent policy</a> that includes a
Fleet Server integration.</p>
</div>
</li>
<li class="listitem">
If you choose <span class="strong strong"><strong>Production</strong></span> deployment mode, read <a class="xref" href="secure-connections.html" title="Encrypt traffic in clusters with a self-managed Fleet Server"><em>Encrypt traffic in clusters with a self-managed Fleet Server</em></a> to
learn how to generate certs.
</li>
<li class="listitem">
It&#8217;s recommended you generate a unique service token for each
Fleet Server. For other ways to generate service tokens, see
<a href="/guide/en/elasticsearch/reference/7.15/service-tokens-command.html" class="ulink" target="_top"><code class="literal">elasticsearch-service-tokens</code></a>.
</li>
<li class="listitem">
<p>The <code class="literal">install</code> command installs the Elastic Agent as a managed service and enrolls it
in a Fleet Server policy. For example, the following command installs
a Fleet Server and uses self-signed certs:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">sudo ./elastic-agent install  -f \
  --fleet-server-es=http://localhost:9200 \
  --fleet-server-service-token=AAEbAWVsYXN0aWMvZmxlaXQtc2VydmVzL3Rva2VuLTE2MeIzNTY1NTQ3Mji6dERXeE9XbW5RRTZqNlJMWEdIRzAtZw \
  --fleet-server-policy=27467ed1-1bfd-11ec-9b88-a7c3d83e2897</pre>
</div>
<p>The following command installs a Fleet Server and uses certificates you
provide. Make sure you replace the values in angle brackets.</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">sudo ./elastic-agent install --url=https://192.0.2.1:8220 \ <a id="CO4-1"></a><i class="conum" data-value="1"></i>
 -f \
 --fleet-server-es=https://192.0.2.0:9200 \
 --fleet-server-service-token=AAEAaWVsYXN0aWcvZmxlZXQtc2VydmVyL3rva2VuLTE2MzIzNTYcNTQ3MjI6dER1eE9XbW5RRTZqNlJMWEdIRzAtZw \
  --fleet-server-policy=27467ed1-1bfd-11ec-9b88-a7c3d83e2897 \
  --certificate-authorities=&lt;PATH_TO_CA&gt; \
  --fleet-server-es-ca=&lt;PATH_TO_ES_CERT&gt; \
  --fleet-server-cert=&lt;PATH_TO_FLEET_SERVER_CERT&gt; \
  --fleet-server-cert-key=&lt;PATH_TO_FLEET_SERVER_CERT_KEY&gt;</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO4-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>The URL must match the DNS name used to generate the certificate specified
by <code class="literal">--fleet-server-cert</code>.</p>
</td>
</tr>
</table>
</div>
<p>For more Fleet Server commands, see <a class="xref" href="elastic-agent-cmd-options.html" title="Command reference"><em>Command reference</em></a>.</p>
<p>If installation is successful, you&#8217;ll see the Fleet Server Elastic Agent on the
<span class="strong strong"><strong>Agents</strong></span> tab in <span class="strong strong"><strong>Fleet</strong></span>. Notice that the Default Fleet Server Policy is
assigned to the Elastic Agent. This policy is created when you run Fleet for the
first time.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/agents-tab-fleet-server.png" alt="Agent tab showing a healthy agent enrolled in the Default Fleet Server policy">
</div>
</div>
</li>
</ul>
</div>
  </div>
</div>
<p>For more information, see <a class="xref" href="fleet-server.html" title="Fleet Server"><em>Fleet Server</em></a>.</p>
<h3><a id="add-agent-to-fleet-traces"></a>Step 2: Add an Elastic Agent to Fleet<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/7.15/docs/en/ingest-management/getting-started-traces.asciidoc">edit</a></h3>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>Don&#8217;t confuse Elastic Agent with APM agents–they are different components.
In a later step, you&#8217;ll instrument your code with APM agents and send the data
to an APM Server instance that Elastic Agent spins up.</p>
</div>
</div>
<p>Elastic Agent is a single, unified agent that you can deploy to hosts or containers to
collect data and send it to the Elastic Stack. Behind the scenes, Elastic Agent runs the
Beats shippers or Elastic Endpoint required for your configuration.</p>
<p>If you plan on enabling Real User Monitoring (RUM), you must run Elastic Agent centrally.
If RUM is disabled, you should run Elastic Agent on edge machines.</p>
<p>To send APM data to the Elastic Stack:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
On the <span class="strong strong"><strong>Agents</strong></span> tab in Fleet, click <span class="strong strong"><strong>Add agent</strong></span>.
</li>
<li class="listitem">
<p>Under <span class="strong strong"><strong>Enroll in Fleet</strong></span>, follow the in-product installation steps.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/add-agent.png" alt="add agent">
</div>
</div>
<p>See the <a href="/downloads/elastic-agent" class="ulink" target="_top">download page</a> for other
installation options.</p>
</li>
</ol>
</div>
<p><span class="strong strong"><strong>Notes:</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Use the default agent policy to get started quickly. This policy includes a
system integration for collecting logs and metrics from the host system. You
can change the policy later.
</li>
<li class="listitem">
<p>The <code class="literal">install</code> command installs the Elastic Agent as a managed service,  enrolls it
in the selected policy, and starts the service. For example:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">./elastic-agent install -f --url=https://10.0.2.2:8220 \
--enrollment-token=blJqaUdua0JqYXA0bmNscVVjUkE6ZGh4WWNRSHRRek9aSS1paEs2cHdFQQ==</pre>
</div>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>If you see an "x509: certificate signed by unknown authority" error, you
might be trying to enroll in a Fleet Server that uses self-signed certs. To
fix this problem in a non-production environment, pass the <code class="literal">--insecure</code> flag.
For more information, refer to the <a class="xref" href="fleet-troubleshooting.html#agent-enrollment-certs" title="Elastic Agent enrollment fails on the host with x509: certificate signed by unknown authority message">troubleshooting guide</a>.</p>
</div>
</div>
</li>
<li class="listitem">
Because Elastic Agent is installed as an auto-starting service, it will restart
automatically if the system is rebooted.
</li>
<li class="listitem">
To see where files are installed, see <a class="xref" href="elastic-agent-installation.html#installation-layout" title="Installation layout">Installation layout</a>.
</li>
</ul>
</div>
<p>If installation is successful, you’ll see the agent on the <span class="strong strong"><strong>Agents</strong></span>
tab in <span class="strong strong"><strong>Fleet</strong></span>. Notice that the Default policy is assigned to the
agent.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/kibana-fleet-agents.png" alt="Fleet showing enrolled agents">
</div>
</div>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>If the status hangs at Enrolling, make sure the <code class="literal">elastic-agent</code> process
is running.</p>
</div>
</div>
<p>If you run into problems:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Check the Elastic Agent logs. If you use the default policy, agent logs and metrics
are collected automatically unless you change the default settings. For more
information, refer to <a class="xref" href="elastic-agent-logging.html" title="Configure logging for Fleet-managed Elastic Agents">Configure logging for Fleet-managed Elastic Agents</a>.
</li>
<li class="listitem">
Refer to <a class="xref" href="fleet-troubleshooting.html" title="Troubleshoot common problems"><em>Troubleshoot common problems</em></a>.
</li>
</ul>
</div>
<h3><a id="add-apm-integration"></a>Step 3: Add the APM integration<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/7.15/docs/en/ingest-management/getting-started-traces.asciidoc">edit</a></h3>
<p>Next, you&#8217;ll browse a catalog of integrations, then add an APM integration to
the default policy used by your agent. You use policies to manage settings
across a group of agents. An agent policy may contain any number of integrations
for collecting observability data from the various services running on your
host.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>In Kibana, go to <span class="strong strong"><strong>Management &gt; Integrations</strong></span>,
and search for the <span class="strong strong"><strong>Elastic APM</strong></span> integration.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/kibana-fleet-integrations-apm.png" alt="Fleet showing APM integration">
</div>
</div>
</li>
<li class="listitem">
<p>Click the APM integration to see more details about it, then click
<span class="strong strong"><strong>Add Elastic APM</strong></span>.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/kibana-fleet-integrations-apm-overview.png" alt="Fleet showing APM integration overview">
</div>
</div>
</li>
<li class="listitem">
On the <span class="strong strong"><strong>Add APM integration</strong></span> page,
click the down arrow next to Collect application traces.
Under <span class="strong strong"><strong>Host</strong></span>, define the host and port where APM Server will listen.
Inspect or change other settings.
</li>
<li class="listitem">
<p>Under <span class="strong strong"><strong>Apply to agent policy</strong></span>, select the default policy.</p>
<div class="sidebar">
<div class="titlepage"></div>
<p>In this guide, you add integrations to the default policy created by
Kibana. After you learn the basics, you can create your own policies and assign
them to agents.</p>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="images/add-integration-apm.png" alt="Fleet Add APM integration page">
</div>
</div>
</li>
<li class="listitem">
<p>To see the updated policy, click the <span class="strong strong"><strong>Default policy</strong></span> link.</p>
<p>The newly added APM integration should appear under <span class="strong strong"><strong>Integrations</strong></span> in the
default policy, along with the default <code class="literal">system-1</code> integration.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/kibana-fleet-policies-default-with-apm.png" alt="Fleet showing default agent policy with apm-1 datasource">
</div>
</div>
<p>All Elastic Agents that use this policy will collect APM data from your instrumented services.</p>
</li>
</ol>
</div>
<h3><a id="add-apm-integration-agents"></a>Step 4: Install APM agents<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/7.15/docs/en/ingest-management/getting-started-traces.asciidoc">edit</a></h3>
<p>APM agents are written in the same language as your service.
To monitor a new service, you must install the agent and configure it with a service name,
APM Server host, and Secret token.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Service name</strong></span>: The APM integration maps an instrumented service&#8217;s name–defined in each APM agent&#8217;s configuration–
to the index that its data is stored in Elasticsearch.
Service names are case-insensitive and must be unique.
For example, you cannot have a service named <code class="literal">Foo</code> and another named <code class="literal">foo</code>.
Special characters will be removed from service names and replaced with underscores (<code class="literal">_</code>).
</li>
<li class="listitem">
<span class="strong strong"><strong>APM Server URL</strong></span>: The host and port that APM Server listens for events on.
This should match the host and port defined when setting up the APM integration.
</li>
<li class="listitem">
<span class="strong strong"><strong>Secret token</strong></span>: Authentication method for APM agent and APM Server communication.
This should match the secret token defined when setting up the APM integration.
</li>
</ul>
</div>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>You can edit your APM integration settings if you need to change the APM Server URL
or secret token to match your APM agents.</p>
</div>
</div>
<div class="tabs" data-tab-group="apm-agent">
  <div role="tablist" aria-label="Install">
    <button role="tab"
            aria-selected="false"
            aria-controls="go-tab-install"
            id="go-install">
      Go
    </button>
    <button role="tab"
            aria-selected="false"
            aria-controls="ios-tab-install"
            id="ios-install"
            tabindex="-1">
      iOS
    </button>
    <button role="tab"
            aria-selected="true"
            aria-controls="java-tab-install"
            id="java-install"
            tabindex="-1">
      Java
    </button>
    <button role="tab"
            aria-selected="false"
            aria-controls="net-tab-install"
            id="net-install"
            tabindex="-1">
      .NET
    </button>
    <button role="tab"
            aria-selected="false"
            aria-controls="node-tab-install"
            id="node-install"
            tabindex="-1">
      Node.js
    </button>
    <button role="tab"
            aria-selected="false"
            aria-controls="php-tab-install"
            id="php-install"
            tabindex="-1">
      PHP
    </button>
    <button role="tab"
            aria-selected="false"
            aria-controls="python-tab-install"
            id="python-install"
            tabindex="-1">
      Python
    </button>
    <button role="tab"
            aria-selected="false"
            aria-controls="ruby-tab-install"
            id="ruby-install"
            tabindex="-1">
      Ruby
    </button>
    <button role="tab"
        aria-selected="false"
        aria-controls="rum-tab-install"
        id="rum-install"
        tabindex="-1">
      RUM
    </button>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="go-tab-install"
       aria-labelledby="go-install"
       hidden="">
<p><span class="strong strong"><strong>Install the agent</strong></span></p>
<p>Install the APM agent packages for Go.</p>
<div class="pre_wrapper lang-go">
<pre class="programlisting prettyprint lang-go">go get go.elastic.co/apm</pre>
</div>
<p><span class="strong strong"><strong>Configure the agent</strong></span></p>
<p>Agents are libraries that run inside of your application process.
APM services are created programmatically based on the executable file name, or the <code class="literal">ELASTIC_APM_SERVICE_NAME</code> environment variable.</p>
<div class="pre_wrapper lang-go">
<pre class="programlisting prettyprint lang-go"># Initialize using environment variables:

# Set the service name. Allowed characters: a-z, A-Z, 0-9, -, _, and space.
# If ELASTIC_APM_SERVICE_NAME is not specified, the executable name will be used.
export ELASTIC_APM_SERVICE_NAME=

# Set custom APM Server URL. Default: http://localhost:8200.
export ELASTIC_APM_SERVER_URL=

# Use if APM Server requires a token
export ELASTIC_APM_SECRET_TOKEN=</pre>
</div>
<p><span class="strong strong"><strong>Instrument your application</strong></span></p>
<p>Instrument your Go application by using one of the provided instrumentation modules or by using the tracer API directly.</p>
<div class="pre_wrapper lang-go">
<pre class="programlisting prettyprint lang-go">import (
	"net/http"

	"go.elastic.co/apm/module/apmhttp"
)

func main() {
	mux := http.NewServeMux()
	...
	http.ListenAndServe(":8080", apmhttp.Wrap(mux))
}</pre>
</div>
<p><span class="strong strong"><strong>Learn more in the agent reference</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="/guide/en/apm/agent/go/1.x/supported-tech.html" class="ulink" target="_top">Supported technologies</a>
</li>
<li class="listitem">
<a href="/guide/en/apm/agent/go/1.x/configuration.html" class="ulink" target="_top">Advanced configuration</a>
</li>
<li class="listitem">
<a href="/guide/en/apm/agent/go/1.x/getting-started.html" class="ulink" target="_top">Detailed guide to instrumenting Go source code</a>
</li>
</ul>
</div>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="ios-tab-install"
       aria-labelledby="ios-install"
       hidden="">
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in technical preview and may be changed or removed in a future release. Elastic will apply best effort to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.</p>
</div>
</div>
<p><span class="strong strong"><strong>Add the agent dependency to your project</strong></span></p>
<p>Add the Elastic APM iOS Agent as a
<a href="https://developer.apple.com/documentation/swift_packages/adding_package_dependencies_to_your_app" class="ulink" target="_top">package dependency</a>
to your Xcode project or your <code class="literal">Package.swift</code>:</p>
<div class="pre_wrapper lang-swift">
<pre class="programlisting prettyprint lang-swift">Package(
    dependencies:[
        .package(name: "iOSAgent", url: "git@github.com:elastic/apm-agent-ios.git", .branch("main")),
    ],
  targets:[
    .target(
        name: "MyApp",
        dependencies: [
            .product(name: "iOSAgent", package: "iOSAgent")
        ]
    ),
])</pre>
</div>
<p><span class="strong strong"><strong>Initialize the agent</strong></span></p>
<p>If you&#8217;re using <code class="literal">SwiftUI</code> to build your app, add the following to <code class="literal">App.swift</code>:</p>
<div class="pre_wrapper lang-swift">
<pre class="programlisting prettyprint lang-swift">import SwiftUI
import iOSAgent

@main
struct MyApp: App {
    init() {
        var config = AgentConfiguration()
        config.collectorAddress = "127.0.0.1" <a id="CO5-1"></a><i class="conum" data-value="1"></i>
        config.collectorPort = 8200 <a id="CO5-2"></a><i class="conum" data-value="2"></i>
        config.collectorTLS = false <a id="CO5-3"></a><i class="conum" data-value="3"></i>
        config.secretToken = "&lt;secret token&gt;" <a id="CO5-4"></a><i class="conum" data-value="4"></i>
        Agent.start(with: config)
    }
    var body: some Scene {
        WindowGroup {
            ContentView()
        }
    }
}</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO5-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>APM Server URL or IP address</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO5-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>APM Server port number</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO5-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>Enable TLS for Open telemetry exporters</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO5-4"><i class="conum" data-value="4"></i></a></p>
</td>
<td align="left" valign="top">
<p>Set secret token for APM server connection</p>
</td>
</tr>
</table>
</div>
<p>If you&#8217;re not using <code class="literal">SwiftUI</code>, you can add the same thing to your AppDelegate file:</p>
<p><code class="literal">AppDelegate.swift</code></p>
<div class="pre_wrapper lang-swift">
<pre class="programlisting prettyprint lang-swift">import UIKit
import iOSAgent
@main
class AppDelegate: UIResponder, UIApplicationDelegate {
    func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?) -&gt; Bool {
        var config = AgentConfiguration()
        config.collectorAddress = "127.0.0.1" <a id="CO6-1"></a><i class="conum" data-value="1"></i>
        config.collectorPort = 8200 <a id="CO6-2"></a><i class="conum" data-value="2"></i>
        config.collectorTLS = false <a id="CO6-3"></a><i class="conum" data-value="3"></i>
        config.secretToken = "&lt;secret token&gt;" <a id="CO6-4"></a><i class="conum" data-value="4"></i>
        Agent.start(with: config)
        return true
    }
}</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO6-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>APM Server url or ip address</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO6-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>APM Server port number</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO6-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>Enable TLS for Open telemetry exporters</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO6-4"><i class="conum" data-value="4"></i></a></p>
</td>
<td align="left" valign="top">
<p>Set secret token for APM server connection</p>
</td>
</tr>
</table>
</div>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="java-tab-install"
       aria-labelledby="java-install">
<p><span class="strong strong"><strong>Download the APM agent</strong></span></p>
<p>Download the agent jar from <a href="http://search.maven.org/#search%7Cga%7C1%7Ca%3Aelastic-apm-agent" class="ulink" target="_top">Maven Central</a>.
Do not add the agent as a dependency to your application.</p>
<p><span class="strong strong"><strong>Start your application with the javaagent flag</strong></span></p>
<p>Add the <code class="literal">-javaagent</code> flag and configure the agent with system properties.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Set required service name
</li>
<li class="listitem">
Set custom APM Server URL (default: <a href="http://localhost:8200" class="ulink" target="_top">http://localhost:8200</a>)
</li>
<li class="listitem">
Set the base package of your application
</li>
</ul>
</div>
<div class="pre_wrapper lang-java">
<pre class="programlisting prettyprint lang-java">java -javaagent:/path/to/elastic-apm-agent-&lt;version&gt;.jar \
     -Delastic.apm.service_name=my-application \
     -Delastic.apm.server_urls=http://localhost:8200 \
     -Delastic.apm.secret_token= \
     -Delastic.apm.application_packages=org.example \
     -jar my-application.jar</pre>
</div>
<p><span class="strong strong"><strong>Learn more in the agent reference</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="/guide/en/apm/agent/java/1.x/supported-technologies-details.html" class="ulink" target="_top">Supported technologies</a>
</li>
<li class="listitem">
<a href="/guide/en/apm/agent/java/1.x/configuration.html" class="ulink" target="_top">Advanced configuration</a>
</li>
</ul>
</div>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="net-tab-install"
       aria-labelledby="net-install"
       hidden="">
<p><span class="strong strong"><strong>Download the APM agent</strong></span></p>
<p>Add the agent packages from <a href="https://www.nuget.org/packages?q=Elastic.apm" class="ulink" target="_top">NuGet</a> to your .NET application.
There are multiple NuGet packages available for different use cases.</p>
<p>For an ASP.NET Core application with Entity Framework Core, download the
<a href="https://www.nuget.org/packages/Elastic.Apm.NetCoreAll" class="ulink" target="_top">Elastic.Apm.NetCoreAll</a> package.
This package will automatically add every agent component to your application.</p>
<p>To minimize the number of dependencies, you can use the
<a href="https://www.nuget.org/packages/Elastic.Apm.AspNetCore" class="ulink" target="_top">Elastic.Apm.AspNetCore</a> package for just ASP.NET Core monitoring, or the
<a href="https://www.nuget.org/packages/Elastic.Apm.EntityFrameworkCore" class="ulink" target="_top">Elastic.Apm.EfCore</a> package for just Entity Framework Core monitoring.</p>
<p>If you only want to use the public agent API for manual instrumentation, use the
<a href="https://www.nuget.org/packages/Elastic.Apm" class="ulink" target="_top">Elastic.Apm</a> package.</p>
<p><span class="strong strong"><strong>Add the agent to the application</strong></span></p>
<p>For an ASP.NET Core application with the <code class="literal">Elastic.Apm.NetCoreAll</code> package,
call the <code class="literal">UseAllElasticApm</code> method in the <code class="literal">Configure</code> method within the <code class="literal">Startup.cs</code> file:</p>
<div class="pre_wrapper lang-dotnet">
<pre class="programlisting prettyprint lang-dotnet">public class Startup
{
  public void Configure(IApplicationBuilder app, IHostingEnvironment env)
  {
    app.UseAllElasticApm(Configuration);
    //…rest of the method
  }
  //…rest of the class
}</pre>
</div>
<p>Passing an <code class="literal">IConfiguration</code> instance is optional and by doing so,
the agent will read config settings through this <code class="literal">IConfiguration</code> instance, for example,
from the <code class="literal">appsettings.json</code> file:</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
    "ElasticApm": {
    "SecretToken": "",
    "ServerUrls": "http://localhost:8200", //Set custom APM Server URL (default: http://localhost:8200)
    "ServiceName" : "MyApp", //allowed characters: a-z, A-Z, 0-9, -, _, and space. Default is the entry assembly of the application
  }
}</pre>
</div>
<p>If you don’t pass an <code class="literal">IConfiguration</code> instance to the agent, for example, in a non-ASP.NET Core application,
you can configure the agent with environment variables.
See the agent reference for more information.</p>
<p><span class="strong strong"><strong>Learn more in the agent reference</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="/guide/en/apm/agent/dotnet/1.11/supported-technologies.html" class="ulink" target="_top">Supported technologies</a>
</li>
<li class="listitem">
<a href="/guide/en/apm/agent/dotnet/1.11/configuration.html" class="ulink" target="_top">Advanced configuration</a>
</li>
</ul>
</div>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="node-tab-install"
       aria-labelledby="node-install"
       hidden="">
<p><span class="strong strong"><strong>Install the APM agent</strong></span></p>
<p>Install the APM agent for Node.js as a dependency to your application.</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">npm install elastic-apm-node --save</pre>
</div>
<p><span class="strong strong"><strong>Configure the agent</strong></span></p>
<p>Agents are libraries that run inside of your application process. APM services are created programmatically based on the <code class="literal">serviceName</code>.
This agent supports a variety of frameworks but can also be used with your custom stack.</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">// Add this to the VERY top of the first file loaded in your app
var apm = require('elastic-apm-node').start({
  // Override service name from package.json
  // Allowed characters: a-z, A-Z, 0-9, -, _, and space
  serviceName: '',

  // Use if APM Server requires a token
  secretToken: '',

  // Set custom APM Server URL (default: http://localhost:8200)
  serverUrl: ''
})</pre>
</div>
<p><span class="strong strong"><strong>Learn more in the agent reference</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="/guide/en/apm/agent/nodejs/3.x/supported-technologies.html" class="ulink" target="_top">Supported technologies</a>
</li>
<li class="listitem">
<a href="/guide/en/apm/agent/nodejs/3.x/advanced-setup.html" class="ulink" target="_top">Babel/ES Modules</a>
</li>
<li class="listitem">
<a href="/guide/en/apm/agent/nodejs/3.x/configuring-the-agent.html" class="ulink" target="_top">Advanced configuration</a>
</li>
</ul>
</div>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="php-tab-install"
       aria-labelledby="php-install"
       hidden="">
<p><span class="strong strong"><strong>Install the agent</strong></span></p>
<p>Install the PHP agent using one of the <a href="https://github.com/elastic/apm-agent-php/releases" class="ulink" target="_top">published packages</a>.</p>
<p>To use the RPM Package (RHEL/CentOS and Fedora):</p>
<div class="pre_wrapper lang-php">
<pre class="programlisting prettyprint lang-php">rpm -ivh &lt;package-file&gt;.rpm</pre>
</div>
<p>To use the DEB package (Debian and Ubuntu):</p>
<div class="pre_wrapper lang-php">
<pre class="programlisting prettyprint lang-php">dpkg -i &lt;package-file&gt;.deb</pre>
</div>
<p>To use the APK package (Alpine):</p>
<div class="pre_wrapper lang-php">
<pre class="programlisting prettyprint lang-php">apk add --allow-untrusted &lt;package-file&gt;.apk</pre>
</div>
<p>If you can’t find your distribution,
you can install the agent by <a href="/guide/en/apm/agent/php/1.x/setup.html" class="ulink" target="_top">building it from the source</a>.</p>
<p><span class="strong strong"><strong>Configure the agent</strong></span></p>
<p>Configure your agent inside of the <code class="literal">php.ini</code> file:</p>
<div class="pre_wrapper lang-ini">
<pre class="programlisting prettyprint lang-ini">elastic_apm.server_url=http://localhost:8200
elastic_apm.secret_token=SECRET_TOKEN
elastic_apm.service_name="My-service"</pre>
</div>
<p><span class="strong strong"><strong>Learn more in the agent reference</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="/guide/en/apm/agent/php/1.x/supported-technologies.html" class="ulink" target="_top">Supported technologies</a>
</li>
<li class="listitem">
<a href="/guide/en/apm/agent/php/1.x/configuration.html" class="ulink" target="_top">Configuration</a>
</li>
</ul>
</div>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="python-tab-install"
       aria-labelledby="python-install"
       hidden="">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Django
</span>
</dt>
<dd>
<p><span class="strong strong"><strong>Install the APM agent</strong></span></p>
<p>Install the APM agent for Python as a dependency.</p>
<div class="pre_wrapper lang-python">
<pre class="programlisting prettyprint lang-python">$ pip install elastic-apm</pre>
</div>
<p><span class="strong strong"><strong>Configure the agent</strong></span></p>
<p>Agents are libraries that run inside of your application process.
APM services are created programmatically based on the <code class="literal">SERVICE_NAME</code>.</p>
<div class="pre_wrapper lang-python">
<pre class="programlisting prettyprint lang-python"># Add the agent to the installed apps
INSTALLED_APPS = (
  'elasticapm.contrib.django',
  # ...
)

ELASTIC_APM = {
  # Set required service name. Allowed characters:
  # a-z, A-Z, 0-9, -, _, and space
  'SERVICE_NAME': '',

  # Use if APM Server requires a token
  'SECRET_TOKEN': '',

  # Set custom APM Server URL (default: http://localhost:8200)
  'SERVER_URL': '',
}

# To send performance metrics, add our tracing middleware:
MIDDLEWARE = (
  'elasticapm.contrib.django.middleware.TracingMiddleware',
  #...
)</pre>
</div>
</dd>
<dt>
<span class="term">
Flask
</span>
</dt>
<dd>
<p><span class="strong strong"><strong>Install the APM agent</strong></span></p>
<p>Install the APM agent for Python as a dependency.</p>
<div class="pre_wrapper lang-python">
<pre class="programlisting prettyprint lang-python">$ pip install elastic-apm[flask]</pre>
</div>
<p><span class="strong strong"><strong>Configure the agent</strong></span></p>
<p>Agents are libraries that run inside of your application process.
APM services are created programmatically based on the <code class="literal">SERVICE_NAME</code>.</p>
<div class="pre_wrapper lang-python">
<pre class="programlisting prettyprint lang-python"># initialize using environment variables
from elasticapm.contrib.flask import ElasticAPM
app = Flask(__name__)
apm = ElasticAPM(app)

# or configure to use ELASTIC_APM in your application settings
from elasticapm.contrib.flask import ElasticAPM
app.config['ELASTIC_APM'] = {
  # Set required service name. Allowed characters:
  # a-z, A-Z, 0-9, -, _, and space
  'SERVICE_NAME': '',

  # Use if APM Server requires a token
  'SECRET_TOKEN': '',

  # Set custom APM Server URL (default: http://localhost:8200)
  'SERVER_URL': '',
}

apm = ElasticAPM(app)</pre>
</div>
</dd>
</dl>
</div>
<p><span class="strong strong"><strong>Learn more in the agent reference</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="/guide/en/apm/agent/python/5.x/supported-technologies.html" class="ulink" target="_top">Supported technologies</a>
</li>
<li class="listitem">
<a href="/guide/en/apm/agent/python/5.x/configuration.html" class="ulink" target="_top">Advanced configuration</a>
</li>
</ul>
</div>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="ruby-tab-install"
       aria-labelledby="ruby-install"
       hidden="">
<p><span class="strong strong"><strong>Install the APM agent</strong></span></p>
<p>Add the agent to your Gemfile.</p>
<div class="pre_wrapper lang-ruby">
<pre class="programlisting prettyprint lang-ruby">gem 'elastic-apm'</pre>
</div>
<p><span class="strong strong"><strong>Configure the agent</strong></span></p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Ruby on Rails
</span>
</dt>
<dd>
<p>APM is automatically started when your app boots.
Configure the agent by creating the config file <code class="literal">config/elastic_apm.yml</code>:</p>
<div class="pre_wrapper lang-ruby">
<pre class="programlisting prettyprint lang-ruby"># config/elastic_apm.yml:

# Set service name - allowed characters: a-z, A-Z, 0-9, -, _ and space
# Defaults to the name of your Rails app
service_name: 'my-service'

# Use if APM Server requires a token
secret_token: ''

# Set custom APM Server URL (default: http://localhost:8200)
server_url: 'http://localhost:8200'</pre>
</div>
</dd>
<dt>
<span class="term">
Rack
</span>
</dt>
<dd>
<p>For Rack or a compatible framework, like Sinatra, include the middleware in your app and start the agent.</p>
<div class="pre_wrapper lang-ruby">
<pre class="programlisting prettyprint lang-ruby"># config.ru
  require 'sinatra/base'

  class MySinatraApp &lt; Sinatra::Base
    use ElasticAPM::Middleware

    # ...
  end

  ElasticAPM.start(
    app: MySinatraApp, # required
    config_file: '' # optional, defaults to config/elastic_apm.yml
  )

  run MySinatraApp

  at_exit { ElasticAPM.stop }</pre>
</div>
<p><span class="strong strong"><strong>Create a config file</strong></span></p>
<p>Create a config file config/elastic_apm.yml:</p>
<div class="pre_wrapper lang-ruby">
<pre class="programlisting prettyprint lang-ruby"># config/elastic_apm.yml:

# Set service name - allowed characters: a-z, A-Z, 0-9, -, _ and space
# Defaults to the name of your Rack app's class.
service_name: 'my-service'

# Use if APM Server requires a token
secret_token: ''

# Set custom APM Server URL (default: http://localhost:8200)
server_url: 'http://localhost:8200'</pre>
</div>
</dd>
</dl>
</div>
<p><span class="strong strong"><strong>Learn more in the agent reference</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="/guide/en/apm/agent/ruby/4.x/supported-technologies.html" class="ulink" target="_top">Supported technologies</a>
</li>
<li class="listitem">
<a href="/guide/en/apm/agent/ruby/4.x/configuration.html" class="ulink" target="_top">Advanced configuration</a>
</li>
</ul>
</div>
  </div>
  <div tabindex="0"
      role="tabpanel"
      id="rum-tab-install"
      aria-labelledby="rum-install"
      hidden="">
<p><span class="strong strong"><strong>Enable Real User Monitoring support in APM Server</strong></span></p>
<p>APM Server disables RUM support by default.
To enable it, set <code class="literal">apm-server.rum.enabled: true</code> in your APM Server configuration file.</p>
<p><span class="strong strong"><strong>Set up the agent</strong></span></p>
<p>Once RUM support enabled, you can set up the RUM agent.
There are two ways to do this: add the agent as a dependency,
or set it up with <code class="literal">&lt;script&gt;</code> tags.</p>
<p><span class="strong strong"><strong>Set up the agent as a dependency</strong></span></p>
<p>You can install the agent as a dependency to your application with <code class="literal">npm install @elastic/apm-rum --save</code>.</p>
<p>The agent can then be initialized and configured in your application like this:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">import { init as initApm } from '@elastic/apm-rum'
var apm = initApm({

  // Set required service name (allowed characters: a-z, A-Z, 0-9, -, _, and space)
  serviceName: 'your-app-name',

  // Set custom APM Server URL (default: http://localhost:8200)
  serverUrl: '',

  // Set service version (required for source map feature)
  serviceVersion: ''
})</pre>
</div>
<p>Framework integrations, like React or Angular, have custom dependencies.
See <a href="/guide/en/apm/agent/rum-js/5.x/framework-integrations.html" class="ulink" target="_top">framework integrations</a> for more information.</p>
<p><span class="strong strong"><strong>Set up the agent with <code class="literal">&lt;script&gt;</code> tags</strong></span></p>
<p>Alternatively, you can use <code class="literal">&lt;script&gt;</code> tags to set up and configure the agent.
Add a <code class="literal">&lt;script&gt;</code> tag to the HTML page and use the <code class="literal">elasticApm</code> global object to load and initialize the agent.
Don&#8217;t forget to download the latest version of the RUM agent from
<a href="https://github.com/elastic/apm-agent-rum-js/releases/latest" class="ulink" target="_top">GitHub</a> or
<a href="https://unpkg.com/@elastic/apm-rum/dist/bundles/elastic-apm-rum.umd.min.js" class="ulink" target="_top">UNPKG</a>,
and host the file on your Server/CDN before deploying to production.</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">&lt;script src="https://your-cdn-host.com/path/to/elastic-apm-rum.umd.min.js" crossorigin&gt;&lt;/script&gt;
&lt;script&gt;
  elasticApm.init({
    serviceName: 'your-app-name',
    serverUrl: 'http://localhost:8200',
  })
&lt;/script&gt;</pre>
</div>
<p><span class="strong strong"><strong>Learn more in the agent reference</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="/guide/en/apm/agent/rum-js/5.x/supported-technologies.html" class="ulink" target="_top">Supported technologies</a>
</li>
<li class="listitem">
<a href="/guide/en/apm/agent/rum-js/5.x/configuration.html" class="ulink" target="_top">Advanced configuration</a>
</li>
</ul>
</div>
  </div>
</div>
<h3><a id="view-apm-integration-data"></a>Step 5: View your data<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/7.15/docs/en/ingest-management/getting-started-traces.asciidoc">edit</a></h3>
<p>Back in Kibana, under Observability, select APM.
You should see application performance monitoring data flowing into the Elastic Stack!</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The built-in <code class="literal">apm_user</code> role is not compatible with the APM integration
as it only provides read access to <code class="literal">apm-*</code> indices.
For a list of indices users need access to, see
<a href="/guide/en/apm/server/7.15/apm-integration-data-streams.html" class="ulink" target="_top">APM data streams</a></p>
</div>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="images/kibana-apm-sample-data.png" alt="APM app with data">
</div>
</div>
<h3><a id="_whats_next_2"></a>What&#8217;s next?<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/7.15/docs/en/ingest-management/getting-started-traces.asciidoc">edit</a></h3>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Now that data is streaming into the Elastic Stack, take your investigation to a
deeper level! Use <a href="/observability" class="ulink" target="_top">Elastic Observability</a>
to unify your logs, metrics, uptime, and application performance data.
</li>
<li class="listitem">
Want to protect your endpoints from security threats? Try
<a href="/security" class="ulink" target="_top">Elastic Security</a>. Adding endpoint protection is
just another integration that you add to the agent policy!
</li>
<li class="listitem">
Are your eyes bleary from staring at a wall of screens?
<a href="/guide/en/observability/7.15/create-alerts.html" class="ulink" target="_top">Create alerts</a> and find out about
problems while sipping your favorite beverage poolside.
</li>
<li class="listitem">
Want Elastic to do the heavy lifting? Use machine learning to
<a href="/guide/en/observability/7.15/inspect-log-anomalies.html" class="ulink" target="_top">detect anomalies</a>.
</li>
<li class="listitem">
Got everything working like you want it? Roll out your agent policies to
other hosts by deploying Elastic Agents across your infrastructure!
</li>
</ul>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="fleet-quick-start.html">« Quick start: Get logs, metrics, and uptime data into the Elastic Stack</a>
</span>
<span class="next">
<a href="integrations.html">Integrations »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
