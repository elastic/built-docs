<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Install Elastic Agent from an MSI package | Fleet and Elastic Agent Guide [8.15] | Elastic</title>
<meta class="elastic" name="content" content="Install Elastic Agent from an MSI package | Fleet and Elastic Agent Guide [8.15]">

<link rel="home" href="index.html" title="Fleet and Elastic Agent Guide [8.15]"/>
<link rel="up" href="elastic-agent-installation.html" title="Install Elastic Agents"/>
<link rel="prev" href="elastic-agent-unprivileged.html" title="Run Elastic Agent without administrative privileges"/>
<link rel="next" href="installation-layout.html" title="Installation layout"/>
<meta class="elastic" name="product_version" content="8.15"/>
<meta class="elastic" name="product_name" content="Fleet and Elastic Agent"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Fleet/Guide/Elastic Agent/8.15"/>
<meta name="DC.subject" content="Fleet and Elastic Agent"/>
<meta name="DC.identifier" content="8.15"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles-v1.css" />
  </head>

  <!--© 2015-2025 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div class="navheader">
<span class="prev">
<a href="elastic-agent-unprivileged.html">« Run Elastic Agent without administrative privileges</a>
</span>
<span class="next">
<a href="installation-layout.html">Installation layout »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Fleet and Elastic Agent Guide [8.15]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="elastic-agent-installation.html">Install Elastic Agents</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Install Elastic Agent from an MSI package</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/8.15/docs/en/ingest-management/elastic-agent/install-agent-msi.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="install-agent-msi"></a>Install Elastic Agent from an MSI package</h2><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/8.15/docs/en/ingest-management/elastic-agent/install-agent-msi.asciidoc">edit</a></div>
</div></div></div>
<p>MSI is the file format and command line utility for the <a href="https://en.wikipedia.org/wiki/Windows_Installer" class="ulink" target="_top">Windows Installer</a>. Windows Installer (previously known as Microsoft Installer) is an interface for Microsoft Windows that’s used to install and manage software on Windows systems. This section covers installing Elastic Agent through the MSI package repository.</p>
<p>The MSI package installer must be run by an administrator account. The installer won&#8217;t start without Windows admin permissions.</p>
<div class="position-relative"><h4><a id="_install_elastic_agent"></a>Install Elastic Agent</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/8.15/docs/en/ingest-management/elastic-agent/install-agent-msi.asciidoc">edit</a></div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Download the latest Elastic Agent MSI binary from the <a href="/downloads/elastic-agent" class="ulink" target="_top">Elastic Agent download page</a>.
</li>
<li class="listitem">
<p>Run the installer:</p>
<div class="pre_wrapper lang-shell">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-shell">elastic-agent-&lt;VERSION&gt;-windows-x86_64.msi INSTALLARGS="--url=&lt;URL&gt; --enrollment-token=&lt;TOKEN&gt;"</pre>
</div>
<p>Where:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">VERSION</code> is the Elastic Stack version you&#8217;re installing, indicated in the MSI package name. For example, <code class="literal">8.13.2</code>.
</li>
<li class="listitem">
<code class="literal">URL</code> is the Fleet Server URL used to enroll the Elastic Agent into Fleet. You can find this on the Fleet <span class="strong strong"><strong>Settings</strong></span> tab in Kibana.
</li>
<li class="listitem">
<code class="literal">TOKEN</code> is the authentication token used to enroll the Elastic Agent into Fleet. You can find this on the Fleet <span class="strong strong"><strong>Enrollment tokens</strong></span> tab.
</li>
</ul>
</div>
<p>When you run the command, the value set for <code class="literal">INSTALLARGS</code> will be passed to the <a class="xref" href="elastic-agent-cmd-options.html#elastic-agent-install-command" title="elastic-agent install"><code class="literal">elastic-agent install</code></a> command verbatim.</p>
</li>
<li class="listitem">
<p>If you need to troubleshoot, you can install using <code class="literal">msiexec</code> with the <code class="literal">-L*V "log.txt"</code> option to create installation logs:</p>
<div class="pre_wrapper lang-shell">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-shell">msiexec -i elastic-agent-&lt;VERSION&gt;-windows-x86_64.msi INSTALLARGS="--url=&lt;URL&gt; --enrollment-token=&lt;TOKEN&gt;"  -L*V "log.txt"</pre>
</div>
</li>
</ol>
</div>
<div class="position-relative"><h4><a id="_installation_notes"></a>Installation notes</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/8.15/docs/en/ingest-management/elastic-agent/install-agent-msi.asciidoc">edit</a></div>
<p>Installing using an MSI package has the following behaviors:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If <code class="literal">INSTALLARGS</code> are not provided, the MSI will copy the files to a temporary folder and finish.
</li>
<li class="listitem">
If <code class="literal">INSTALLARGS</code> are provided, the MSI will copy the files to a temporary folder and then run the <a class="xref" href="elastic-agent-cmd-options.html#elastic-agent-install-command" title="elastic-agent install"><code class="literal">elastic-agent install</code></a> command with the provided parameters. If the install flow is successful, the temporary folder is deleted.
</li>
<li class="listitem">
If <code class="literal">INSTALLARGS</code> are provided but the <code class="literal">elastic-agent install</code> command fails, the top-level folder is NOT deleted, in order to allow for further troubleshooting.
</li>
<li class="listitem">
If the <code class="literal">elastic-agent install</code> command fails for any reason, the MSI will rollback all changes.
</li>
<li class="listitem">
If the Elastic Agent enrollment fails, the install will fail as well. To avoid this behavior you can add the <a class="xref" href="elastic-agent-cmd-options.html#elastic-agent-install-command" title="elastic-agent install"><code class="literal">--delay-enroll</code></a> option to the install command.
</li>
</ul>
</div>
<div class="position-relative"><h4><a id="_upgrading"></a>Upgrading</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/8.15/docs/en/ingest-management/elastic-agent/install-agent-msi.asciidoc">edit</a></div>
<p>Upgrades are not supported and are prevented by the MSI itself. Instead, all of your Elastic Agent upgrades can be managed in Fleet.</p>
<div class="position-relative"><h4><a id="_installing_in_a_custom_location"></a>Installing in a custom location</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/8.15/docs/en/ingest-management/elastic-agent/install-agent-msi.asciidoc">edit</a></div>
<p>Starting in version 8.13, it&#8217;s also possible to override the default installation folder by running the MSI from the command line, as shown:</p>
<div class="pre_wrapper lang-shell">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-shell">elastic-agent-&lt;VERSION&gt;-windows-x86_64.msi INSTALLARGS="--url=&lt;URL&gt; --enrollment-token=&lt;TOKEN&gt;" INSTALLDIR="&lt;path of custom folder&gt;"</pre>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="elastic-agent-unprivileged.html">« Run Elastic Agent without administrative privileges</a>
</span>
<span class="next">
<a href="installation-layout.html">Installation layout »</a>
</span>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>

                        <!-- Feedback widget -->
                        <div id="feedbackWidgetContainer"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


        <div id='elastic-footer'></div>
        <script src='https://www.elastic.co/elastic-footer.js'></script>
        <!-- Footer Section end-->

      </section>
    </div>

    <!-- Feedback modal -->
    <div id="feedbackModalContainer"></div>

    <script src="/guide/static/jquery.js"></script>
    <script type="text/javascript" src="/guide/static/docs-v1.js"></script>
    <script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
