<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Elastic Agent policies | Fleet and Elastic Agent Guide [8.15] | Elastic</title>
<meta class="elastic" name="content" content="Elastic Agent policies | Fleet and Elastic Agent Guide [8.15]">

<link rel="home" href="index.html" title="Fleet and Elastic Agent Guide [8.15]"/>
<link rel="up" href="manage-agents-in-fleet.html" title="Centrally manage Elastic Agents in Fleet"/>
<link rel="prev" href="filter-agent-list-by-tags.html" title="Add tags to filter the Agents list"/>
<link rel="next" href="create-a-policy-no-ui.html" title="Create an agent policy without using the UI"/>
<meta class="elastic" name="product_version" content="8.15"/>
<meta class="elastic" name="product_name" content="Fleet and Elastic Agent"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Fleet/Guide/Elastic Agent/8.15"/>
<meta name="DC.subject" content="Fleet and Elastic Agent"/>
<meta name="DC.identifier" content="8.15"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles-v1.css" />
  </head>

  <!--© 2015-2025 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div class="navheader">
<span class="prev">
<a href="filter-agent-list-by-tags.html">« Add tags to filter the Agents list</a>
</span>
<span class="next">
<a href="create-a-policy-no-ui.html">Create an agent policy without using the UI »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Fleet and Elastic Agent Guide [8.15]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="manage-agents-in-fleet.html">Centrally manage Elastic Agents in Fleet</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Elastic Agent policies</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/8.15/docs/en/ingest-management/agent-policies.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="agent-policy"></a>Elastic Agent policies</h2><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/8.15/docs/en/ingest-management/agent-policies.asciidoc">edit</a></div>
</div></div></div>

<p>A policy is a collection of inputs and settings that defines the data to be collected
by an Elastic Agent. Each Elastic Agent can only be enrolled in a single policy.</p>
<p>Within an Elastic Agent policy is a set of individual integration policies.
These integration policies define the settings for each input type.
The available settings in an integration depend on the version of
the integration in use.</p>
<p>Fleet uses Elastic Agent policies in two ways:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Policies are stored in a plain-text YAML file and sent to each Elastic Agent to configure its inputs.
</li>
<li class="listitem">
Policies provide a visual representation of an Elastic Agents configuration
in the Fleet UI.
</li>
</ul>
</div>
<div class="position-relative"><h4><a id="policy-benefits"></a>Policy benefits</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/8.15/docs/en/ingest-management/agent-policies.asciidoc">edit</a></div>
<p>Elastic Agent policies have many benefits that allow you to:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Apply a logical grouping of inputs aimed for a particular set of hosts.
</li>
<li class="listitem">
Maintain flexibility in large-scale deployments by quickly testing changes before rolling them out.
</li>
<li class="listitem">
Provide a way to group and manage larger swaths of your infrastructure landscape.
</li>
</ul>
</div>
<p>For example, it might make sense to create a policy per operating system type:
Windows, macOS, and Linux hosts.
Or, organize policies by functional groupings of how the hosts are
used: IT email servers, Linux servers, user work-stations, etc.
Or perhaps by user categories: engineering department, marketing department, etc.</p>
<div class="position-relative"><h4><a id="agent-policy-types"></a>Policy types</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/8.15/docs/en/ingest-management/agent-policies.asciidoc">edit</a></div>
<p>In most use cases, Fleet provides complete central management of Elastic Agents.
However some use cases, like running in Kubernetes or using our hosted Elasticsearch Service on Elastic Cloud,
require Elastic Agent infrastructure management outside of Fleet.
With this in mind, there are two types of Elastic Agent policies:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>regular policy</strong></span>: The default use case, where Fleet provides full central
management for Elastic Agents. Users can manage Elastic Agent infrastructure by adding,
removing, or upgrading Elastic Agents. Users can also manage Elastic Agent configuration by updating
the Elastic Agent policy.
</li>
<li class="listitem">
<p><span class="strong strong"><strong>hosted policy</strong></span>: A policy where <em>something else</em> provides central management for Elastic Agents.
For example, in Kubernetes, adding, removing, and upgrading Elastic Agents should be configured directly in Kubernetes.
Allowing Fleet users to manage Elastic Agents would conflict with any Kubernetes configuration.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>Hosted policies also apply when using our hosted Elasticsearch Service on Elastic Cloud.
Elastic Cloud is responsible for hosting Elastic Agents and assigning them to a policy.
Platform operators, who create and manage Elastic deployments can add, upgrade,
and remove Elastic Agents through the Elastic Cloud console.</p>
</div>
</div>
</li>
</ul>
</div>
<p>Hosted policies display a lock icon in the Fleet UI, and actions are restricted.
The following table illustrates the Fleet user actions available to different policy types:</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Fleet user action</th>
<th align="left" valign="top">Regular policy</th>
<th align="left" valign="top">Hosted policy</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><a class="xref" href="agent-policy.html#create-a-policy" title="Create a policy">Create a policy</a></p></td>
<td align="left" valign="top"><p><span class="image"><img src="images/green-check.svg" alt="yes"></span></p></td>
<td align="left" valign="top"><p><span class="image"><img src="images/red-x.svg" alt="no"></span></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="agent-policy.html#add-integration" title="Add an integration to a policy">Add an integration</a></p></td>
<td align="left" valign="top"><p><span class="image"><img src="images/green-check.svg" alt="yes"></span></p></td>
<td align="left" valign="top"><p><span class="image"><img src="images/red-x.svg" alt="no"></span></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="agent-policy.html#apply-a-policy" title="Apply a policy">Apply a policy</a></p></td>
<td align="left" valign="top"><p><span class="image"><img src="images/green-check.svg" alt="yes"></span></p></td>
<td align="left" valign="top"><p><span class="image"><img src="images/red-x.svg" alt="no"></span></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="agent-policy.html#policy-edit-or-delete" title="Edit or delete an integration policy">Edit or delete an integration</a></p></td>
<td align="left" valign="top"><p><span class="image"><img src="images/green-check.svg" alt="yes"></span></p></td>
<td align="left" valign="top"><p><span class="image"><img src="images/red-x.svg" alt="no"></span></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="agent-policy.html#copy-policy" title="Copy a policy">Copy a policy</a></p></td>
<td align="left" valign="top"><p><span class="image"><img src="images/green-check.svg" alt="yes"></span></p></td>
<td align="left" valign="top"><p><span class="image"><img src="images/red-x.svg" alt="no"></span></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="agent-policy.html#policy-main-settings" title="Edit or delete a policy">Edit or delete a policy</a></p></td>
<td align="left" valign="top"><p><span class="image"><img src="images/green-check.svg" alt="yes"></span></p></td>
<td align="left" valign="top"><p><span class="image"><img src="images/red-x.svg" alt="no"></span></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="agent-policy.html#add-custom-fields" title="Add custom fields">Add custom fields</a></p></td>
<td align="left" valign="top"><p><span class="image"><img src="images/green-check.svg" alt="yes"></span></p></td>
<td align="left" valign="top"><p><span class="image"><img src="images/red-x.svg" alt="no"></span></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="agent-policy.html#change-policy-enable-agent-monitoring" title="Enable agent monitoring">Enable agent monitoring</a></p></td>
<td align="left" valign="top"><p><span class="image"><img src="images/green-check.svg" alt="yes"></span></p></td>
<td align="left" valign="top"><p><span class="image"><img src="images/red-x.svg" alt="no"></span></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="agent-policy.html#change-policy-output" title="Change the output of a policy">Change the output of a policy</a></p></td>
<td align="left" valign="top"><p><span class="image"><img src="images/green-check.svg" alt="yes"></span></p></td>
<td align="left" valign="top"><p><span class="image"><img src="images/red-x.svg" alt="no"></span></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="agent-policy.html#add-fleet-server-to-policy" title="Add a Fleet Server to a policy">Add a Fleet Server to a policy</a></p></td>
<td align="left" valign="top"><p><span class="image"><img src="images/green-check.svg" alt="yes"></span></p></td>
<td align="left" valign="top"><p><span class="image"><img src="images/red-x.svg" alt="no"></span></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="agent-policy.html#agent-policy-secret-values" title="Configure secret values in a policy">Configure secret values in a policy</a></p></td>
<td align="left" valign="top"><p><span class="image"><img src="images/green-check.svg" alt="yes"></span></p></td>
<td align="left" valign="top"><p><span class="image"><img src="images/red-x.svg" alt="no"></span></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="agent-policy.html#agent-policy-limit-cpu" title="Set the maximum CPU usage">Set the maximum CPU usage</a></p></td>
<td align="left" valign="top"><p><span class="image"><img src="images/green-check.svg" alt="yes"></span></p></td>
<td align="left" valign="top"><p><span class="image"><img src="images/red-x.svg" alt="no"></span></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="agent-policy.html#agent-policy-http-monitoring" title="Override the default monitoring port">Override the default monitoring port</a></p></td>
<td align="left" valign="top"><p><span class="image"><img src="images/green-check.svg" alt="yes"></span></p></td>
<td align="left" valign="top"><p><span class="image"><img src="images/red-x.svg" alt="no"></span></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="agent-policy.html#agent-policy-log-level" title="Set the Elastic Agent log level">Set the Elastic Agent log level</a></p></td>
<td align="left" valign="top"><p><span class="image"><img src="images/green-check.svg" alt="yes"></span></p></td>
<td align="left" valign="top"><p><span class="image"><img src="images/red-x.svg" alt="no"></span></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="agent-policy.html#agent-binary-download-settings" title="Change the Elastic Agent binary download location">Change the Elastic Agent binary download location</a></p></td>
<td align="left" valign="top"><p><span class="image"><img src="images/green-check.svg" alt="yes"></span></p></td>
<td align="left" valign="top"><p><span class="image"><img src="images/red-x.svg" alt="no"></span></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="agent-policy.html#fleet-agent-hostname-format-settings" title="Set the Elastic Agent host name format">Set the Elastic Agent host name format</a></p></td>
<td align="left" valign="top"><p><span class="image"><img src="images/green-check.svg" alt="yes"></span></p></td>
<td align="left" valign="top"><p><span class="image"><img src="images/red-x.svg" alt="no"></span></p></td>
</tr>
</tbody>
</table>
</div>
<p>See also the <a class="xref" href="agent-policy.html#agent-policy-scale" title="Policy scaling recommendations">recommended scaling options</a> for an Elastic Agent policy.</p>
<div class="position-relative"><h4><a id="create-a-policy"></a>Create a policy</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/8.15/docs/en/ingest-management/agent-policies.asciidoc">edit</a></div>
<p>To manage your Elastic Agents and the data they collect, create a new policy:</p>
<p>In Fleet, open the <span class="strong strong"><strong>Agent policies</strong></span> tab and click <span class="strong strong"><strong>Create agent policy</strong></span>.
. Name your policy. All other fields are optional and can be modified later.
By default, each policy enables the <em>system</em> integration, which collects system information and metrics.</p>
<p>+</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/create-agent-policy.png" alt="Fleet in Kibana">
</div>
</div>
<p>+
. Create the agent policy:
* To use the UI, click <span class="strong strong"><strong>Create agent policy</strong></span>.
* To use the Fleet API, click <span class="strong strong"><strong>Preview API request</strong></span> and run the
request.</p>
<p>Also see <a class="xref" href="create-a-policy-no-ui.html" title="Create an agent policy without using the UI">Create an agent policy without using the UI</a>.</p>
<div class="position-relative"><h4><a id="add-integration"></a>Add an integration to a policy</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/8.15/docs/en/ingest-management/agent-policies.asciidoc">edit</a></div>
<p>Policies consist of one or more integrations.
To add a new integration to a policy:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
In Fleet, click <span class="strong strong"><strong>Agent policies</strong></span>.
Click the name of the policy you want to add an integration to.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Add integration</strong></span>.
</li>
<li class="listitem">
Search for and select an integration. You can select a category to narrow your search.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Add &lt;Integration&gt;</strong></span>.
</li>
<li class="listitem">
<p>Name the integration and add any required configuration variables.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Integration policy names must be globally unique across all agent
policies.</p>
</div>
</div>
</li>
<li class="listitem">
<p>Save the integration policy as part of the larger Elastic Agent policy:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
To use the UI, click <span class="strong strong"><strong>Save and continue</strong></span>.
</li>
<li class="listitem">
To use the Fleet API, click <span class="strong strong"><strong>Preview API request</strong></span> and run the
request.
</li>
</ul>
</div>
</li>
</ol>
</div>
<p>Fleet distributes this new policy to all Elastic Agents that are enrolled in the
Elastic Agent policy.</p>
<p>After the policy has finished applying, the selected integration will be running on the host
and communicating with the Elastic Agent.</p>
<div class="position-relative"><h4><a id="apply-a-policy"></a>Apply a policy</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/8.15/docs/en/ingest-management/agent-policies.asciidoc">edit</a></div>
<p>You can apply policies to one or more Elastic Agents.
To apply a policy:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
In Fleet, click <span class="strong strong"><strong>Agents</strong></span>.
</li>
<li class="listitem">
<p>Select the Elastic Agents you want to assign to the new policy.</p>
<p>After selecting one or more Elastic Agents, click <span class="strong strong"><strong>Assign to new policy</strong></span> under the
Actions menu.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/apply-agent-policy.png" alt="Assign to new policy dropdown">
</div>
</div>
<p>Unable to select multiple agents? Confirm that your subscription level supports
selective agent policy reassignment in Fleet. For more information, refer to
<a href="/subscriptions" class="ulink" target="_top">Elastic Stack subscriptions</a>.</p>
</li>
<li class="listitem">
Select the Elastic Agent policy from the dropdown list, and click <span class="strong strong"><strong>Assign policy</strong></span>.
</li>
</ol>
</div>
<p>The Elastic Agent status indicator and Elastic Agent logs indicate that the policy is being applied.
It may take a few minutes for the policy change to complete before the Elastic Agent status updates to "Healthy".</p>
<div class="position-relative"><h4><a id="policy-edit-or-delete"></a>Edit or delete an integration policy</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/8.15/docs/en/ingest-management/agent-policies.asciidoc">edit</a></div>
<p>Integrations can easily be reconfigured or deleted.
To edit or delete an integration policy:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
In Fleet, click <span class="strong strong"><strong>Agent policies</strong></span>.
Click the name of the policy you want to edit or delete.
</li>
<li class="listitem">
<p>Search or scroll to a specific integration.
Open the <span class="strong strong"><strong>Actions</strong></span> menu and select <span class="strong strong"><strong>Edit integration</strong></span> or <span class="strong strong"><strong>Delete integration</strong></span>.</p>
<p>Editing or deleting an integration is permanent and cannot be undone.
If you make a mistake, you can always re-configure or re-add an integration.</p>
</li>
</ol>
</div>
<p>Any saved changes are immediately distributed and applied to all Elastic Agents enrolled in the given policy.</p>
<p>To update any secret values in an integration policy, refer to <a class="xref" href="agent-policy.html#agent-policy-secret-values" title="Configure secret values in a policy">Configure secret values in a policy</a>.</p>
<div class="position-relative"><h4><a id="copy-policy"></a>Copy a policy</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/8.15/docs/en/ingest-management/agent-policies.asciidoc">edit</a></div>
<p>Policy definitions are stored in a plain-text YAML file that can be downloaded or copied to another policy:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
In Fleet, click <span class="strong strong"><strong>Agent policies</strong></span>.
Click the name of the policy you want to copy or download.
</li>
<li class="listitem">
<p>To copy a policy, click <span class="strong strong"><strong>Actions &#8594; Copy policy</strong></span>.
Name the new policy, and provide a description.
The exact policy definition is copied to the new policy.</p>
<p>Alternatively, view and download the policy definition by clicking <span class="strong strong"><strong>Actions &#8594; View policy</strong></span>.</p>
</li>
</ol>
</div>
<div class="position-relative"><h4><a id="policy-main-settings"></a>Edit or delete a policy</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/8.15/docs/en/ingest-management/agent-policies.asciidoc">edit</a></div>
<p>You can change high-level configurations like a policy&#8217;s name, description, default namespace,
and agent monitoring status as necessary:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
In Fleet, click <span class="strong strong"><strong>Agent policies</strong></span>.
Click the name of the policy you want to edit or delete.
</li>
<li class="listitem">
<p>Click the <span class="strong strong"><strong>Settings</strong></span> tab, make changes, and click <span class="strong strong"><strong>Save changes</strong></span></p>
<p>Alternatively, click <span class="strong strong"><strong>Delete policy</strong></span> to delete the policy.
Existing data is not deleted.
Any agents assigned to a policy must be unenrolled or assigned to a different policy before a policy can be deleted.</p>
</li>
</ol>
</div>
<div class="position-relative"><h4><a id="add-custom-fields"></a>Add custom fields</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/8.15/docs/en/ingest-management/agent-policies.asciidoc">edit</a></div>
<p>Use this setting to add a custom field and value set to all data collected from the Elastic Agents enrolled in an Elastic Agent policy.
Custom fields are useful when you want to identify or visualize all of the data from a group of agents, and possibly manipulate the data downstream.</p>
<p>To add a custom field:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
In Fleet, click <span class="strong strong"><strong>Agent policies</strong></span>.
Select the name of the policy you want to edit.
</li>
<li class="listitem">
Click the <span class="strong strong"><strong>Settings</strong></span> tab and scroll to <span class="strong strong"><strong>Custom fields</strong></span>.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Add field</strong></span>.
</li>
<li class="listitem">
<p>Specify a field name and value.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/agent-policy-custom-field.png" alt="Sceen capture showing the UI to add a custom field and value">
</div>
</div>
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Add another field</strong></span> for additional fields. Click <span class="strong strong"><strong>Save changes</strong></span> when you&#8217;re done.
</li>
</ol>
</div>
<p>To edit a custom field:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
In Fleet, click <span class="strong strong"><strong>Agent policies</strong></span>.
Select the name of the policy you want to edit.
</li>
<li class="listitem">
Click the <span class="strong strong"><strong>Settings</strong></span> tab and scroll to <span class="strong strong"><strong>Custom fields</strong></span>. Any custom fields that have been configured are shown.
</li>
<li class="listitem">
Click the edit icon to update a field or click the delete icon to remove it.
</li>
</ol>
</div>
<p>Note that adding custom tags is not supported for a small set of inputs:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">apm</code>
</li>
<li class="listitem">
<code class="literal">cloudbeat</code> and all <code class="literal">cloudbeat/*</code> inputs
</li>
<li class="listitem">
<code class="literal">cloud-defend</code>
</li>
<li class="listitem">
<code class="literal">fleet-server</code>
</li>
<li class="listitem">
<code class="literal">pf-elastic-collector</code>, <code class="literal">pf-elastic-symbolizer</code>, and <code class="literal">pf-host-agent</code>
</li>
</ul>
</div>
<div class="position-relative"><h4><a id="change-policy-enable-agent-monitoring"></a>Enable agent monitoring</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/8.15/docs/en/ingest-management/agent-policies.asciidoc">edit</a></div>
<p>Use this setting to collect monitoring logs and metrics from Elastic Agent. All monitoring data will be written to the specified <span class="strong strong"><strong>Default namespace</strong></span>.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
In Fleet, click <span class="strong strong"><strong>Agent policies</strong></span>.
Select the name of the policy you want to edit.
</li>
<li class="listitem">
Click the <span class="strong strong"><strong>Settings</strong></span> tab and scroll to <span class="strong strong"><strong>Enable agent monitorings</strong></span>.
</li>
<li class="listitem">
Select whether to collect agent logs, agent metrics, or both, from the Elastic Agents that use the policy.
</li>
</ol>
</div>
<p>When this setting is enabled an Elastic Agent integration is created automatically.</p>
<div class="position-relative"><h4><a id="change-policy-output"></a>Change the output of a policy</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/8.15/docs/en/ingest-management/agent-policies.asciidoc">edit</a></div>
<p>Assuming your <a href="/subscriptions" class="ulink" target="_top">Elastic Stack subscription level</a> supports per-policy
outputs, you can change the output of a policy to send data to a different
output.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
In Fleet, click <span class="strong strong"><strong>Settings</strong></span> and view the list of available outputs.
If necessary, click <span class="strong strong"><strong>Add output</strong></span> to add a new output with the settings you
require. For more information, refer to <a class="xref" href="fleet-settings.html#output-settings" title="Output settings">Output settings</a>.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Agent policies</strong></span>.
Click the name of the policy you want to change, then click <span class="strong strong"><strong>Settings</strong></span>.
</li>
<li class="listitem">
<p>Set <span class="strong strong"><strong>Output for integrations</strong></span> and (optionally) <span class="strong strong"><strong>Output for agent monitoring</strong></span>
to use a different output, for example, Logstash. You might need to scroll down to
see these options.</p>
<p>Unable to select a different output? Confirm that your subscription level
supports per-policy outputs in Fleet.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/agent-output-settings.png" alt="Screen capture showing the Logstash output policy selected in an agent policy">
</div>
</div>
</li>
<li class="listitem">
Save your changes.
</li>
</ol>
</div>
<p>Any Elastic Agents enrolled in the agent policy will begin sending data to the
specified outputs.</p>
<div class="position-relative"><h4><a id="add-fleet-server-to-policy"></a>Add a Fleet Server to a policy</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/8.15/docs/en/ingest-management/agent-policies.asciidoc">edit</a></div>
<p>If you want to connect multiple agents to a specific on-premises Fleet Server,
you can add that Fleet Server to a policy.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/add-fleet-server-to-policy.png" alt="Screen capture showing how to add a Fleet Server to a policy when creating or updating the policy.">
</div>
</div>
<p>When the policy is saved, all agents assigned to the policy are configured
to use the new Fleet Server as the controller.</p>
<p>Make sure that the Elastic Agents assigned to this policy all have connectivity to the Fleet Server
that you added. Lack of connectivity will prevent the Elastic Agent
from checking in with the Fleet Server and receiving policy updates, but the agents
will still forward data to the cluster.</p>
<div class="position-relative"><h4><a id="agent-policy-secret-values"></a>Configure secret values in a policy</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/8.15/docs/en/ingest-management/agent-policies.asciidoc">edit</a></div>
<p>When you create an integration policy you often need to provide sensitive information such as an API key or a password. To help ensure that data can&#8217;t be accessed inappropriately, any secret values used in an integration policy are stored separately from other policy details.</p>
<p>As well, after you&#8217;ve saved a secret value in Fleet, the value is hidden in both the Fleet UI and in the agent policy definition. When you view the agent policy (<span class="strong strong"><strong>Actions &#8594; View policy</strong></span>), an environment variable is displayed in place of any secret values, for example <code class="literal">${SECRET_0}</code>.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>In order for sensitive values to be stored secretly in Fleet, all configured Fleet Servers must be on version 8.10.0 or higher.</p>
</div>
</div>
<p>Though secret values stored in Fleet are hidden, they can be updated. To update a secret value in an integration policy:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
In Fleet, click <span class="strong strong"><strong>Agent policies</strong></span>.
Select the name of the policy you want to edit.
</li>
<li class="listitem">
Search or scroll to a specific integration.
Open the <span class="strong strong"><strong>Actions</strong></span> menu and select <span class="strong strong"><strong>Edit integration</strong></span>. Any secret information is marked as being hidden.
</li>
<li class="listitem">
<p>Click the link to replace the secret value with a new one.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/fleet-policy-hidden-secret.png" alt="Screen capture showing a hidden secret value as part of an integration policy">
</div>
</div>
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Save integration</strong></span>. The original secret value is overwritten in the policy.
</li>
</ol>
</div>
<div class="position-relative"><h4><a id="agent-policy-limit-cpu"></a>Set the maximum CPU usage</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/8.15/docs/en/ingest-management/agent-policies.asciidoc">edit</a></div>
<p>You can limit the amount of CPU consumed by Elastic Agent. This parameter limits the number of operating system threads that can be executing Go code simultaneously in each Go process. You can specify an integer value not less than <code class="literal">0</code>, which is the default value that stands for "all available CPUs".</p>
<p>This limit applies independently to the agent and each underlying Go process that it supervises. For example, if Elastic Agent is configured to supervise two Beats with a CPU usage limit of <code class="literal">2</code> set in the policy, then the total CPU limit is six, where each of the three processes (one Elastic Agent and two Beats) may execute independently on two CPUs.</p>
<p>This setting is similar to the Beats <a href="/guide/en/beats/filebeat/8.15/configuration-general-options.html#_max_procs" class="ulink" target="_top"><code class="literal">max_procs</code></a> setting. For more detail, refer to the <a href="https://pkg.go.dev/runtime#GOMAXPROCS" class="ulink" target="_top">GOMAXPROCS</a> function in the Go runtime documentation.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
In Fleet, click <span class="strong strong"><strong>Agent policies</strong></span>.
Select the name of the policy you want to edit.
</li>
<li class="listitem">
Click the <span class="strong strong"><strong>Settings</strong></span> tab and scroll to <span class="strong strong"><strong>Advanced settings</strong></span>.
</li>
<li class="listitem">
Set <span class="strong strong"><strong>Limit CPU usage</strong></span> as needed. For example, to limit Go processes supervised by Elastic Agent to two operating system threads each, set this value to <code class="literal">2</code>.
</li>
</ol>
</div>
<div class="position-relative"><h4><a id="agent-policy-http-monitoring"></a>Override the default monitoring port</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/8.15/docs/en/ingest-management/agent-policies.asciidoc">edit</a></div>
<p>You can override the default port that Elastic Agent uses to send monitoring data. It&#8217;s useful to be able to adjust this setting if you have an application running on the machine on which the agent is deployed, and that is using the same port.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
In Fleet, click <span class="strong strong"><strong>Agent policies</strong></span>.
Select the name of the policy you want to edit.
</li>
<li class="listitem">
Click the <span class="strong strong"><strong>Settings</strong></span> tab and scroll to <span class="strong strong"><strong>Advanced settings</strong></span>.
</li>
</ol>
</div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Specify a host and port for the monitoring data output.
</li>
</ol>
</div>
<div class="position-relative"><h4><a id="agent-policy-log-level"></a>Set the Elastic Agent log level</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/8.15/docs/en/ingest-management/agent-policies.asciidoc">edit</a></div>
<p>You can set the minimum log level that Elastic Agents using the selected policy will send to the configured output. The default setting is <code class="literal">info</code>.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
In Fleet, click <span class="strong strong"><strong>Agent policies</strong></span>.
Select the name of the policy you want to edit.
</li>
<li class="listitem">
Click the <span class="strong strong"><strong>Settings</strong></span> tab and scroll to <span class="strong strong"><strong>Advanced settings</strong></span>.
</li>
<li class="listitem">
Set the <span class="strong strong"><strong>Agent logging level</strong></span>.
</li>
<li class="listitem">
Save your changes.
</li>
</ol>
</div>
<p>You can also set the log level for an individual agent:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
In Fleet, click <span class="strong strong"><strong>Agents</strong></span>.
Under the <span class="strong strong"><strong>Host</strong></span> header, select the Elastic Agent you want to edit.
</li>
<li class="listitem">
On the <span class="strong strong"><strong>Logs</strong></span> tab, set the <span class="strong strong"><strong>Agent logging level</strong></span> and apply your changes. Or, you can choose to reset the agent to use the logging level specified in the agent policy.
</li>
</ol>
</div>
<div class="position-relative"><h4><a id="agent-binary-download-settings"></a>Change the Elastic Agent binary download location</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/8.15/docs/en/ingest-management/agent-policies.asciidoc">edit</a></div>
<p>Elastic Agents must be able to access the Elastic Artifact Registry to download
binaries during upgrades. By default Elastic Agents download artifacts from the
artifact registry at <code class="literal">https://artifacts.elastic.co/downloads/</code>.</p>
<p>For Elastic Agents that cannot access the internet, you can specify agent binary
download settings, and then configure agents to download their artifacts from
the alternate location. For more information about running Elastic Agents in a
restricted environment, refer to <a class="xref" href="air-gapped.html" title="Air-gapped environments">Air-gapped environments</a>.</p>
<p>To change the binary download location:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
In Fleet, click <span class="strong strong"><strong>Agent policies</strong></span>.
Select the name of the policy you want to edit.
</li>
<li class="listitem">
Click the <span class="strong strong"><strong>Settings</strong></span> tab and scroll to <span class="strong strong"><strong>Agent binary download</strong></span>.
</li>
<li class="listitem">
Specify the address where you are hosting the artifacts repository or select the default to use the location specified in the Fleet <a class="xref" href="fleet-settings.html#fleet-agent-binary-download-settings" title="Agent binary download settings">agent binary download settings</a>.
</li>
</ol>
</div>
<div class="position-relative"><h4><a id="fleet-agent-hostname-format-settings"></a>Set the Elastic Agent host name format</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/8.15/docs/en/ingest-management/agent-policies.asciidoc">edit</a></div>
<p>The <span class="strong strong"><strong>Host name format</strong></span> setting controls the format of information provided about the current host through the <a class="xref" href="host-provider.html" title="Host provider">host.name</a> key, in events produced by Elastic Agent.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
In Fleet, click <span class="strong strong"><strong>Agent policies</strong></span>.
Select the name of the policy you want to edit.
</li>
<li class="listitem">
Click the <span class="strong strong"><strong>Settings</strong></span> tab and scroll to <span class="strong strong"><strong>Host name format</strong></span>.
</li>
<li class="listitem">
<p>Select one of the following:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Hostname</strong></span>: Information about the current host is in a non-fully-qualified format (<code class="literal">somehost</code>, rather than <code class="literal">somehost.example.com</code>). This is the default reporting format.
</li>
<li class="listitem">
<span class="strong strong"><strong>Fully Qualified Domain Name (FQDN)</strong></span>: Information about the current host is in FQDN format (<code class="literal">somehost.example.com</code> rather than <code class="literal">somehost</code>). This helps you to distinguish between hosts on different domains that have similar names. The fully qualified hostname allows each host to be more easily identified when viewed in Kibana, for example.
</li>
</ul>
</div>
</li>
<li class="listitem">
Save your changes.
</li>
</ol>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>FQDN reporting is not currently supported in APM.</p>
</div>
</div>
<p>For FQDN reporting to work as expected, the hostname of the current host must either:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Have a CNAME entry defined in DNS.
</li>
<li class="listitem">
Have one of its corresponding IP addresses respond successfully to a reverse DNS lookup.
</li>
</ul>
</div>
<p>If neither pre-requisite is satisfied, <code class="literal">host.name</code> continues to report the hostname of the current host in a non-fully-qualified format.</p>
<div class="position-relative"><h4><a id="agent-policy-scale"></a>Policy scaling recommendations</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/8.15/docs/en/ingest-management/agent-policies.asciidoc">edit</a></div>
<p>A single instance of Fleet supports a maximum of 500 Elastic Agent policies. If more policies are configured, UI performance might be impacted.</p>



</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="filter-agent-list-by-tags.html">« Add tags to filter the Agents list</a>
</span>
<span class="next">
<a href="create-a-policy-no-ui.html">Create an agent policy without using the UI »</a>
</span>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>

                        <!-- Feedback widget -->
                        <div id="feedbackWidgetContainer"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


        <div id='elastic-footer'></div>
        <script src='https://www.elastic.co/elastic-footer.js'></script>
        <!-- Footer Section end-->

      </section>
    </div>

    <!-- Feedback modal -->
    <div id="feedbackModalContainer"></div>

    <script src="/guide/static/jquery.js"></script>
    <script type="text/javascript" src="/guide/static/docs-v1.js"></script>
    <script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
