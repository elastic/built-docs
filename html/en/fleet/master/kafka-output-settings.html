<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Kafka output settings | Fleet and Elastic Agent Guide [master] | Elastic</title>
<meta class="elastic" name="content" content="Kafka output settings | Fleet and Elastic Agent Guide [master]">

<link rel="home" href="index.html" title="Fleet and Elastic Agent Guide [master]"/>
<link rel="up" href="fleet-settings.html" title="Fleet settings"/>
<link rel="prev" href="ls-output-settings.html" title="Logstash output settings"/>
<link rel="next" href="remote-elasticsearch-output.html" title="Remote Elasticsearch output"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="Fleet and Elastic Agent"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Fleet/Guide/Elastic Agent/master"/>
<meta name="DC.subject" content="Fleet and Elastic Agent"/>
<meta name="DC.identifier" content="master"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles-v1.css" />
  </head>

  <!--© 2015-2025 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div class="page_header">
This documentation contains work-in-progress information for future Elastic Stack and Cloud releases. Use the version selector to view supported release docs. It also contains some Elastic Cloud serverless information. Check out our <a href="https://www.elastic.co/docs/current/serverless">serverless docs</a> for more details.
</div>
<div class="navheader">
<span class="prev">
<a href="ls-output-settings.html">« Logstash output settings</a>
</span>
<span class="next">
<a href="remote-elasticsearch-output.html">Remote Elasticsearch output »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Fleet and Elastic Agent Guide [master]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="manage-agents-in-fleet.html">Centrally manage Elastic Agents in Fleet</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="fleet-settings.html">Fleet settings</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Kafka output settings</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/main/docs/en/ingest-management/fleet/fleet-settings-output-kafka.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="kafka-output-settings"></a>Kafka output settings</h3><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/main/docs/en/ingest-management/fleet/fleet-settings-output-kafka.asciidoc">edit</a></div>
</div></div></div>
<p>Specify these settings to send data over a secure connection to Kafka. In the Fleet <a class="xref" href="fleet-settings.html#output-settings" title="Output settings">Output settings</a>, make sure that the Kafka output type is selected.</p>
<div class="position-relative"><h5><a id="_general_settings"></a>General settings</h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/main/docs/en/ingest-management/fleet/fleet-settings-output-kafka.asciidoc">edit</a></div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<tbody>
<tr>
<td align="left" valign="top">
<p><a id="kafka-output-version"></a><span class="strong strong"><strong>Kafka version</strong></span></p>
</td>
<td align="left" valign="top">
<p>The Kafka protocol version that Elastic Agent will request when connecting.
Defaults to <code class="literal">1.0.0</code>.
Currently Kafka versions from <code class="literal">0.8.2.0</code> to <code class="literal">2.6.0</code> are supported, however the latest
Kafka version (<code class="literal">3.x.x</code>) is expected to be compatible when version <code class="literal">2.6.0</code> is selected.</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="kafka-output-hosts"></a><span class="strong strong"><strong>Hosts</strong></span></p>
</td>
<td align="left" valign="top">
<p>The addresses your Elastic Agents will use to connect to one or more Kafka brokers.
Use the format <code class="literal">host:port</code> (without any protocol <code class="literal">http://</code>). Click <span class="strong strong"><strong>Add row</strong></span> to specify additional addresses.</p>
<p><span class="strong strong"><strong>Examples:</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">localhost:9092</code>
</li>
<li class="listitem">
<code class="literal">mykafkahost:9092</code>
</li>
</ul>
</div>
<p>Refer to the <a class="xref" href="fleet-server.html" title="What is Fleet Server?">Fleet Server</a> documentation for default ports and other configuration details.</p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="position-relative"><h5><a id="_authentication_settings"></a>Authentication settings</h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/main/docs/en/ingest-management/fleet/fleet-settings-output-kafka.asciidoc">edit</a></div>
<p>Select the mechanism that Elastic Agent uses to authenticate with Kafka.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<tbody>
<tr>
<td align="left" valign="top">
<p><a id="kafka-output-authentication-none"></a><span class="strong strong"><strong>None</strong></span></p>
</td>
<td align="left" valign="top">
<p>No authentication is used between Elastic Agent and Kafka. This is the default option. In production, it&#8217;s recommended to have an authentication method selected.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Plaintext
</span>
</dt>
<dd>
<p>
Set this option for traffic between Elastic Agent and Kafka to be sent as plaintext, without any transport layer security.
</p>
<p>This is the default option when no authentication is set.</p>
</dd>
<dt>
<span class="term">
Encryption
</span>
</dt>
<dd>
<p>
Set this option for traffic between Elastic Agent and Kafka to use transport layer security.
</p>
<p>When <span class="strong strong"><strong>Encryption</strong></span> is selected, the <span class="strong strong"><strong>Server SSL certificate authorities</strong></span> and <span class="strong strong"><strong>Verification mode</strong></span> mode options become available.</p>
</dd>
</dl>
</div>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="kafka-output-authentication-basic"></a><span class="strong strong"><strong>Username / Password</strong></span></p>
</td>
<td align="left" valign="top">
<p>Connect to Kafka with a username and password.</p>
<p>Provide your username and password, and select a SASL (Simple Authentication and Security Layer) mechanism for your login credentials.</p>
<p>When SCRAM is enabled, Elastic Agent uses the <a href="https://en.wikipedia.org/wiki/Salted_Challenge_Response_Authentication_Mechanism" class="ulink" target="_top">SCRAM</a> mechanism to authenticate the user credential. SCRAM is based on the IETF RFC5802 standard which describes a challenge-response mechanism for authenticating users.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Plain - SCRAM is not used to authenticate
</li>
<li class="listitem">
SCRAM-SHA-256 - uses the SHA-256 hashing function
</li>
<li class="listitem">
SCRAM-SHA-512 - uses the SHA-512 hashing function
</li>
</ul>
</div>
<p>To prevent unauthorized access your Kafka password is stored as a secret value. While secret storage is recommended, you can choose to override this setting and store the password as plain text in the agent policy definition. Secret storage requires Fleet Server version 8.12 or higher.</p>
<p>Note that this setting can also be stored as a secret value or as plain text for preconfigured outputs. See <a href="/guide/en/kibana/master/fleet-settings-kb.html#_preconfiguration_settings_for_advanced_use_cases" class="ulink" target="_top">Preconfiguration settings</a> in the Kibana Guide to learn more.</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="kafka-output-authentication-ssl"></a><span class="strong strong"><strong>SSL</strong></span></p>
</td>
<td align="left" valign="top">
<p>Authenticate using the Secure Sockets Layer (SSL) protocol. Provide the following details for your SSL certificate:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Client SSL certificate
</span>
</dt>
<dd>
<p>
The certificate generated for the client. Copy and paste in the full contents of the certificate. This is the certificate that all the agents will use to connect to Kafka.
</p>
<p>In cases where each client has a unique certificate, the local path to that certificate can be placed here. The agents will pick the certificate in that location when establishing a connection to Kafka.</p>
</dd>
<dt>
<span class="term">
Client SSL certificate key
</span>
</dt>
<dd>
<p>
The private key generated for the client. This must be in PKCS 8 key. Copy and paste in the full contents of the certificate key. This is the certificate key that all the agents will use to connect to Kafka.
</p>
<p>In cases where each client has a unique certificate key, the local path to that certificate key can be placed here. The agents will pick the certificate key in that location when establishing a connection to Kafka.</p>
<p>To prevent unauthorized access the certificate key is stored as a secret value. While secret storage is recommended, you can choose to override this setting and store the key as plain text in the agent policy definition. Secret storage requires Fleet Server version 8.12 or higher.</p>
<p>Note that this setting can also be stored as a secret value or as plain text for preconfigured outputs. See <a href="/guide/en/kibana/master/fleet-settings-kb.html#_preconfiguration_settings_for_advanced_use_cases" class="ulink" target="_top">Preconfiguration settings</a> in the Kibana Guide to learn more.</p>
</dd>
</dl>
</div>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><span class="strong strong"><strong>Server SSL certificate authorities</strong></span></p>
</td>
<td align="left" valign="top">
<p>The CA certificate to use to connect to Kafka. This is the CA used to generate the certificate and key for Kafka. Copy and paste in the full contents for the CA certificate.</p>
<p>This setting is optional. This setting is not available when the authentication <code class="literal">None</code> and <code class="literal">Plaintext</code> options are selected.</p>
<p>Click <span class="strong strong"><strong>Add row</strong></span> to specify additional certificate authories.</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><span class="strong strong"><strong>Verification mode</strong></span></p>
</td>
<td align="left" valign="top">
<p>Controls the verification of server certificates. Valid values are:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">Full</code>
</span>
</dt>
<dd>
Verifies that the provided certificate is signed by a trusted
authority (CA) and also verifies that the server&#8217;s hostname (or IP address)
matches the names identified within the certificate.
</dd>
<dt>
<span class="term">
<code class="literal">None</code>
</span>
</dt>
<dd>
Performs <em>no verification</em> of the server&#8217;s certificate. This
mode disables many of the security benefits of SSL/TLS and should only be used
after cautious consideration. It is primarily intended as a temporary
diagnostic mechanism when attempting to resolve TLS errors; its use in
production environments is strongly discouraged.
</dd>
<dt>
<span class="term">
<code class="literal">Strict</code>
</span>
</dt>
<dd>
Verifies that the provided certificate is signed by a trusted
authority (CA) and also verifies that the server&#8217;s hostname (or IP address)
matches the names identified within the certificate. If the Subject Alternative
Name is empty, it returns an error.
</dd>
<dt>
<span class="term">
<code class="literal">Certificate</code>
</span>
</dt>
<dd>
Verifies that the provided certificate is signed by a
trusted authority (CA), but does not perform any hostname verification.
</dd>
</dl>
</div>
<p>The default value is <code class="literal">Full</code>. This setting is not available when the authentication <code class="literal">None</code> and <code class="literal">Plaintext</code> options are selected.</p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="position-relative"><h5><a id="_partitioning_settings"></a>Partitioning settings</h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/main/docs/en/ingest-management/fleet/fleet-settings-output-kafka.asciidoc">edit</a></div>
<p>The number of partitions created is set automatically by the Kafka broker based on the list of topics. Records are then published to partitions either randomly, in round-robin order, or according to a calculated hash.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<tbody>
<tr>
<td align="left" valign="top">
<p><a id="kafka-output-partitioning-random"></a><span class="strong strong"><strong>Random</strong></span></p>
</td>
<td align="left" valign="top">
<p>Publish records to Kafka output broker event partitions randomly. Specify the number of events to be published to the same partition before the partitioner selects a new partition.</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="kafka-output-partitioning-roundrobin"></a><span class="strong strong"><strong>Round robin</strong></span></p>
</td>
<td align="left" valign="top">
<p>Publish records to Kafka output broker event partitions in a round-robin fashion. Specify the number of events to be published to the same partition before the partitioner selects a new partition.</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="kafka-output-partitioning-hash"></a><span class="strong strong"><strong>Hash</strong></span></p>
</td>
<td align="left" valign="top">
<p>Publish records to Kafka output broker event partitions based on a hash computed from the specified list of fields. If a field is not specified, the Kafka event key value is used.</p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="position-relative"><h5><a id="_topics_settings"></a>Topics settings</h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/main/docs/en/ingest-management/fleet/fleet-settings-output-kafka.asciidoc">edit</a></div>
<p>Use this option to set the Kafka topic for each Elastic Agent event.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<tbody>
<tr>
<td align="left" valign="top">
<p><a id="kafka-output-topics-default"></a><span class="strong strong"><strong>Default topic</strong></span></p>
</td>
<td align="left" valign="top">
<p>Set a default topic to use for events sent by Elastic Agent to the Kafka output, for example <code class="literal">elastic-agent</code>.</p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="position-relative"><h5><a id="_header_settings"></a>Header settings</h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/main/docs/en/ingest-management/fleet/fleet-settings-output-kafka.asciidoc">edit</a></div>
<p>A header is a key-value pair, and multiple headers can be included with the same key. Only string values are supported. These headers will be included in each produced Kafka message.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<tbody>
<tr>
<td align="left" valign="top">
<p><a id="kafka-output-headers-key"></a><span class="strong strong"><strong>Key</strong></span></p>
</td>
<td align="left" valign="top">
<p>The key to set in the Kafka header.</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="kafka-output-headers-value"></a><span class="strong strong"><strong>Value</strong></span></p>
</td>
<td align="left" valign="top">
<p>The value to set in the Kafka header.</p>
<p>Click <span class="strong strong"><strong>Add header</strong></span> to configure additional headers to be included in each Kafka message.</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="kafka-output-headers-clientid"></a><span class="strong strong"><strong>Client ID</strong></span></p>
</td>
<td align="left" valign="top">
<p>The configurable ClientID used for logging, debugging, and auditing purposes. The default is <code class="literal">Elastic</code>. The Client ID is part of the protocol to identify where the messages are coming from.</p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="position-relative"><h5><a id="_compression_settings"></a>Compression settings</h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/main/docs/en/ingest-management/fleet/fleet-settings-output-kafka.asciidoc">edit</a></div>
<p>You can enable compression to reduce the volume of Kafka output.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<tbody>
<tr>
<td align="left" valign="top">
<p><a id="kafka-output-compression-codec"></a><span class="strong strong"><strong>Codec</strong></span></p>
</td>
<td align="left" valign="top">
<p>Select a compression codec to use. Supported codecs are <code class="literal">snappy</code>, <code class="literal">lz4</code> and <code class="literal">gzip</code>.</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="kafka-output-compression-level"></a><span class="strong strong"><strong>Level</strong></span></p>
</td>
<td align="left" valign="top">
<p>For the <code class="literal">gzip</code> codec you can choose a compression level. The level must be in the range of <code class="literal">1</code> (best speed) to <code class="literal">9</code> (best compression).</p>
<p>Increasing the compression level reduces the network usage but increases the CPU usage. The default value is 4.</p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="position-relative"><h5><a id="_broker_settings"></a>Broker settings</h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/main/docs/en/ingest-management/fleet/fleet-settings-output-kafka.asciidoc">edit</a></div>
<p>Configure timeout and buffer size values for the Kafka brokers.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<tbody>
<tr>
<td align="left" valign="top">
<p><a id="kafka-output-broker-timeout"></a><span class="strong strong"><strong>Broker timeout</strong></span></p>
</td>
<td align="left" valign="top">
<p>The maximum length of time a Kafka broker waits for the required number of ACKs before timing out (see the <code class="literal">ACK reliability</code> setting further in). The default is 30 seconds.</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="kafka-output-broker-reachability-timeout"></a><span class="strong strong"><strong>Broker reachability timeout</strong></span></p>
</td>
<td align="left" valign="top">
<p>The maximum length of time that an Elastic Agent waits for a response from a Kafka broker before timing out. The default is 30 seconds.</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="kafka-output-broker-ack-reliability"></a><span class="strong strong"><strong>ACK reliability</strong></span></p>
</td>
<td align="left" valign="top">
<p>The ACK reliability level required from broker. Options are:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Wait for local commit
</li>
<li class="listitem">
Wait for all replicas to commit
</li>
<li class="listitem">
Do not wait
</li>
</ul>
</div>
<p>The default is <code class="literal">Wait for local commit</code>.</p>
<p>Note that if ACK reliability is set to <code class="literal">Do not wait</code> no ACKs are returned by Kafka. Messages might be lost silently in the event of an error.</p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="position-relative"><h5><a id="_other_settings"></a>Other settings</h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/main/docs/en/ingest-management/fleet/fleet-settings-output-kafka.asciidoc">edit</a></div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<tbody>
<tr>
<td align="left" valign="top">
<p><a id="kafka-output-other-key"></a><span class="strong strong"><strong>Key</strong></span></p>
</td>
<td align="left" valign="top">
<p>An optional formatted string specifying the Kafka event key. If configured, the event key can be extracted from the event using a format string.</p>
<p>See the <a href="https://kafka.apache.org/intro#intro_topics" class="ulink" target="_top">Kafka documentation</a> for the implications of a particular choice of key; by default, the key is chosen by the Kafka cluster.</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="kafka-output-other-proxy"></a><span class="strong strong"><strong>Proxy</strong></span></p>
</td>
<td align="left" valign="top">
<p>Select a proxy URL for Elastic Agent to connect to Kafka.
To learn about proxy configuration, refer to <a class="xref" href="fleet-agent-proxy-support.html" title="Using a proxy server with Elastic Agent and Fleet">Using a proxy server with Elastic Agent and Fleet</a>.</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="kafka-output-advanced-yaml-setting"></a><span class="strong strong"><strong>Advanced YAML configuration</strong></span></p>
</td>
<td align="left" valign="top">
<p>YAML settings that will be added to the Kafka output section of each policy
that uses this output. Make sure you specify valid YAML. The UI does not
currently provide validation.</p>
<p>See <a class="xref" href="kafka-output-settings.html#kafka-output-settings-yaml-config" title="Advanced YAML configuration">Advanced YAML configuration</a> for descriptions of the available settings.</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="kafka-output-agent-integrations"></a><span class="strong strong"><strong>Make this output the default for agent integrations</strong></span></p>
</td>
<td align="left" valign="top">
<p>When this setting is on, Elastic Agents use this output to send data if no other
output is set in the <a class="xref" href="agent-policy.html" title="Elastic Agent policies">agent policy</a>.</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="kafka-output-agent-monitoring"></a><span class="strong strong"><strong>Make this output the default for agent monitoring</strong></span></p>
</td>
<td align="left" valign="top">
<p>When this setting is on, Elastic Agents use this output to send <a class="xref" href="monitor-elastic-agent.html" title="Monitor Elastic Agents">agent monitoring data</a> if no other output is set in the <a class="xref" href="agent-policy.html" title="Elastic Agent policies">agent policy</a>.</p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h4 class="title"><a id="kafka-output-settings-yaml-config"></a>Advanced YAML configuration</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/main/docs/en/ingest-management/fleet/fleet-settings-output-kafka.asciidoc">edit</a></div>
</div></div></div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">
Setting
</th>
<th align="left" valign="top">
Description
</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top">
<p><a id="output-kafka-fleet-settings-backoff.init-setting"></a><code class="literal">backoff.init</code></p>
</td>
<td align="left" valign="top">
<p>(string) The number of seconds to wait before trying to reconnect to Kafka
after a network error. After waiting <code class="literal">backoff.init</code> seconds, Elastic Agent tries to
reconnect. If the attempt fails, the backoff timer is increased exponentially up
to <code class="literal">backoff.max</code>. After a successful connection, the backoff timer is reset.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">1s</code></p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="output-kafka-fleet-settings-backoff.max-setting"></a><code class="literal">backoff.max</code></p>
</td>
<td align="left" valign="top">
<p>(string) The maximum number of seconds to wait before attempting to connect to
Kafka after a network error.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">60s</code></p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="output-kafka-fleet-settings-bulk_max_size-setting"></a><code class="literal">bulk_max_size</code></p>
</td>
<td align="left" valign="top">
<p>(int) The maximum number of events to bulk in a single Kafka
request.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">2048</code></p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="output-kafka-fleet-settings-flush_frequency-setting"></a><code class="literal">bulk_flush_frequency</code></p>
</td>
<td align="left" valign="top">
<p>(int) Duration to wait before sending bulk Kafka request. <code class="literal">0`</code> is no delay.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">0</code></p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="output-kafka-fleet-settings-channel_buffer_size-setting"></a><code class="literal">channel_buffer_size</code></p>
</td>
<td align="left" valign="top">
<p>(int) Per Kafka broker number of messages buffered in output pipeline.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">256</code></p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="output-kafka-fleet-settings-client_id-setting"></a><code class="literal">client_id</code></p>
</td>
<td align="left" valign="top">
<p>(string) The configurable ClientID used for logging, debugging, and auditing purposes.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">Elastic Agent</code></p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="output-kafka-fleet-settings-codec-setting"></a><code class="literal">codec</code></p>
</td>
<td align="left" valign="top">
<p>Output codec configuration. You can specify either the <code class="literal">json</code> or <code class="literal">format</code>
codec. By default the <code class="literal">json</code> codec is used.</p>
<p><span class="strong strong"><strong><code class="literal">json.pretty</code></strong></span>: If <code class="literal">pretty</code> is set to true, events will be nicely formatted. The default is false.</p>
<p><span class="strong strong"><strong><code class="literal">json.escape_html</code></strong></span>: If <code class="literal">escape_html</code> is set to true, html symbols will be escaped in strings. The default is false.</p>
<p>Example configuration that uses the <code class="literal">json</code> codec with pretty printing enabled to write events to the console:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">output.console:
  codec.json:
    pretty: true
    escape_html: false</pre>
</div>
<p><span class="strong strong"><strong><code class="literal">format.string</code></strong></span>: Configurable format string used to create a custom formatted message.</p>
<p>Example configurable that uses the <code class="literal">format</code> codec to print the events timestamp and message field to console:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">output.console:
  codec.format:
    string: '%{[@timestamp]} %{[message]}'</pre>
</div>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">json</code></p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="output-kafka-fleet-settings-keep_alive-setting"></a><code class="literal">keep_alive</code></p>
</td>
<td align="left" valign="top">
<p>(string) The keep-alive period for an active network connection. If <code class="literal">0s</code>, keep-alives are disabled.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">0s</code></p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="output-kafka-fleet-settings-max_message_bytes-setting"></a><code class="literal">max_message_bytes</code></p>
</td>
<td align="left" valign="top">
<p>(int) The maximum permitted size of JSON-encoded messages. Bigger messages will be dropped. This value should be equal to or less than the broker&#8217;s <code class="literal">message.max.bytes</code>.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">1000000</code> (bytes)</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="output-kafka-fleet-settings-metadata-setting"></a><code class="literal">metadata</code></p>
</td>
<td align="left" valign="top">
<p>Kafka metadata update settings. The metadata contains information about
brokers, topics, partition, and active leaders to use for publishing.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">refresh_frequency</code></strong></span>
</span>
</dt>
<dd>
Metadata refresh interval. Defaults to 10 minutes.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">full</code></strong></span>
</span>
</dt>
<dd>
Strategy to use when fetching metadata. When this option is <code class="literal">true</code>, the
client will maintain a full set of metadata for all the available topics. When set
to <code class="literal">false</code> it will only refresh the metadata for the configured topics. The default
is false.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">retry.max</code></strong></span>
</span>
</dt>
<dd>
Total number of metadata update retries. The default is 3.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">retry.backoff</code></strong></span>
</span>
</dt>
<dd>
Waiting time between retries. The default is 250ms.
</dd>
</dl>
</div>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="output-kafka-fleet-settings-queue.mem.events-setting"></a><code class="literal">queue.mem.events</code></p>
</td>
<td align="left" valign="top">
<p>The number of events the queue can store. This value should be evenly divisible by the smaller of <code class="literal">queue.mem.flush.min_events</code> or <code class="literal">bulk_max_size</code> to avoid sending partial batches to the output.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">3200 events</code></p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="output-kafka-fleet-settings-queue.mem.flush.min_events-setting"></a><code class="literal">queue.mem.flush.min_events</code></p>
</td>
<td align="left" valign="top">
<p><code class="literal">flush.min_events</code> is a legacy parameter, and new configurations should prefer to control batch size with <code class="literal">bulk_max_size</code>. As of 8.13, there is never a performance advantage to limiting batch size with <code class="literal">flush.min_events</code> instead of <code class="literal">bulk_max_size</code></p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">1600 events</code></p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="output-kafka-fleet-settings-queue.mem.flush.timeout-setting"></a><code class="literal">queue.mem.flush.timeout</code></p>
</td>
<td align="left" valign="top">
<p>(int) The maximum wait time for <code class="literal">queue.mem.flush.min_events</code> to be fulfilled. If set to 0s, events are available to the output immediately.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">10s</code></p>
</td>
</tr>
</tbody>
</table>
</div>
</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="ls-output-settings.html">« Logstash output settings</a>
</span>
<span class="next">
<a href="remote-elasticsearch-output.html">Remote Elasticsearch output »</a>
</span>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>

                        <!-- Feedback widget -->
                        <div id="feedbackWidgetContainer"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


        <div id='elastic-footer'></div>
        <script src='https://www.elastic.co/elastic-footer.js'></script>
        <!-- Footer Section end-->

      </section>
    </div>

    <!-- Feedback modal -->
    <div id="feedbackModalContainer"></div>

    <script src="/guide/static/jquery.js"></script>
    <script type="text/javascript" src="/guide/static/docs-v1.js"></script>
    <script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
