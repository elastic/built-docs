<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Logstash output | Fleet and Elastic Agent Guide [master] | Elastic</title>
<meta class="elastic" name="content" content="Logstash output | Fleet and Elastic Agent Guide [master]">

<link rel="home" href="index.html" title="Fleet and Elastic Agent Guide [master]"/>
<link rel="up" href="elastic-agent-output-configuration.html" title="Configure outputs for standalone Elastic Agents"/>
<link rel="prev" href="kafka-output.html" title="Kafka output"/>
<link rel="next" href="elastic-agent-ssl-configuration.html" title="Configure SSL/TLS for standalone Elastic Agents"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="Fleet and Elastic Agent"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Fleet/Guide/Elastic Agent/master"/>
<meta name="DC.subject" content="Fleet and Elastic Agent"/>
<meta name="DC.identifier" content="master"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles-v1.css" />
  </head>

  <!--© 2015-2025 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div class="page_header">
This documentation contains work-in-progress information for future Elastic Stack and Cloud releases. Use the version selector to view supported release docs. It also contains some Elastic Cloud serverless information. Check out our <a href="https://www.elastic.co/docs/current/serverless">serverless docs</a> for more details.
</div>
<div class="navheader">
<span class="prev">
<a href="kafka-output.html">« Kafka output</a>
</span>
<span class="next">
<a href="elastic-agent-ssl-configuration.html">Configure SSL/TLS for standalone Elastic Agents »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Fleet and Elastic Agent Guide [master]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="elastic-agent-configuration.html">Configure standalone Elastic Agents</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="elastic-agent-output-configuration.html">Configure outputs for standalone Elastic Agents</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Logstash output</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/main/docs/en/ingest-management/elastic-agent/configuration/outputs/output-logstash.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="logstash-output"></a>Logstash output<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/main/docs/en/ingest-management/elastic-agent/configuration/outputs/output-logstash.asciidoc">edit</a></h3>
</div></div></div>

<p>The Logstash output uses an internal protocol to send events directly to Logstash over
TCP. Logstash provides additional parsing, transformation, and routing of data
collected by Elastic Agent.</p>
<p><span class="strong strong"><strong>Compatibility:</strong></span> This output works with all compatible versions of Logstash. Refer
to the <a href="/support/matrix#matrix_compatibility" class="ulink" target="_top">Elastic
Support Matrix</a>.</p>
<p>This example configures a Logstash output called <code class="literal">default</code> in the
<code class="literal">elastic-agent.yml</code> file:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">outputs:
  default:
    type: logstash
    hosts: ["127.0.0.1:5044"] <a id="CO18-1"></a><i class="conum" data-value="1"></i></pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO18-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>The Logstash server and the port (<code class="literal">5044</code>) where Logstash is configured to listen for
incoming Elastic Agent connections.</p>
</td>
</tr>
</table>
</div>
<p>To receive the events in Logstash, you also need to create a Logstash configuration pipeline.
The Logstash configuration pipeline listens for incoming Elastic Agent connections,
processes received events, and then sends the events to Elasticsearch.</p>
<p>The following example configures a Logstash pipeline that listens on port <code class="literal">5044</code> for
incoming Elastic Agent connections and routes received events to Elasticsearch:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">input {
  elastic_agent {
    port =&gt; 5044
    enrich =&gt; none # don't modify the events' schema at all
    # or minimal change, add only ssl and source metadata
    # enrich =&gt; [ssl_peer_metadata, source_metadata]
  }
}

output {
  elasticsearch {
    hosts =&gt; ["http://localhost:9200"] <a id="CO19-1"></a><i class="conum" data-value="1"></i>
    data_stream =&gt; "true"
  }
}</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO19-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>The Elasticsearch server and the port (<code class="literal">9200</code>) where Elasticsearch is running.</p>
</td>
</tr>
</table>
</div>
<p>For more information about configuring Logstash, refer to
<a href="/guide/en/logstash/master/configuration.html" class="ulink" target="_top">Configuring Logstash</a> and
<a href="/guide/en/logstash/master/plugins-inputs-elastic_agent.html" class="ulink" target="_top">Elastic Agent input plugin</a>.</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_logstash_output_configuration_settings"></a>Logstash output configuration settings<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/main/docs/en/ingest-management/elastic-agent/configuration/outputs/output-logstash.asciidoc">edit</a></h4>
</div></div></div>
<p>The <code class="literal">logstash</code> output supports the following settings, grouped by category.
Many of these settings have sensible defaults that allow you to run Elastic Agent with
minimal configuration.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="logstash-output.html#output-logstash-commonly-used-settings" title="Commonly used settings">Commonly used settings</a>
</li>
<li class="listitem">
<a class="xref" href="logstash-output.html#output-logstash-authentication-settings" title="Authentication settings">Authentication settings</a>
</li>
<li class="listitem">
<a class="xref" href="logstash-output.html#output-logstash-memory-queue-settings" title="Memory queue settings">Memory queue settings</a>
</li>
<li class="listitem">
<a class="xref" href="logstash-output.html#output-logstash-performance-tuning-settings" title="Performance tuning settings">Performance tuning settings</a>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="output-logstash-commonly-used-settings"></a>Commonly used settings<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/main/docs/en/ingest-management/elastic-agent/configuration/outputs/output-logstash.asciidoc">edit</a></h4>
</div></div></div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">
Setting
</th>
<th align="left" valign="top">
Description
</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top">
<p><a id="output-logstash-enabled-setting"></a><code class="literal">enabled</code></p>
</td>
<td align="left" valign="top">
<p>(boolean) Enables or disables the output. If set to <code class="literal">false</code>, the output is
disabled.</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="output-logstash-escape_html-setting"></a><code class="literal">escape_html</code></p>
</td>
<td align="left" valign="top">
<p>(boolean) Configures escaping of HTML in strings. Set to <code class="literal">true</code> to enable
escaping.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">false</code></p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="output-logstash-hosts-setting"></a><code class="literal">hosts</code></p>
</td>
<td align="left" valign="top">
<p>(list) The list of known Logstash servers to connect to. If load balancing is
disabled, but multiple hosts are configured, one host is selected randomly
(there is no precedence). If one host becomes unreachable, another one is
selected randomly.</p>
<p>All entries in this list can contain a port number. If no port is specified,
<code class="literal">5044</code> is used.</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="output-logstash-proxy_url-setting"></a><code class="literal">proxy_url</code></p>
</td>
<td align="left" valign="top">
<p>(string) The URL of the SOCKS5 proxy to use when connecting to the Logstash
servers. The value must be a URL with a scheme of <code class="literal">socks5://</code>. The protocol used
to communicate to Logstash is not based on HTTP, so you cannot use a web proxy.</p>
<p>If the SOCKS5 proxy server requires client authentication, embed a username and
password in the URL as shown in the example.</p>
<p>When using a proxy, hostnames are resolved on the proxy server instead of on the
client. To change this behavior, set <code class="literal">proxy_use_local_resolver</code>.</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">outputs:
  default:
    type: logstash
    hosts: ["remote-host:5044"]
    proxy_url: socks5://user:password@socks5-proxy:2233</pre>
</div>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="output-logstash-proxy_use_local_resolver-setting"></a><code class="literal">proxy_use_</code>
<code class="literal">local_resolver</code></p>
</td>
<td align="left" valign="top">
<p>(boolean) Determines whether Logstash hostnames are resolved locally when using a
proxy. If <code class="literal">false</code> and a proxy is used, name resolution occurs on the proxy
server.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">false</code></p>
</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="output-logstash-authentication-settings"></a>Authentication settings<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/main/docs/en/ingest-management/elastic-agent/configuration/outputs/output-logstash.asciidoc">edit</a></h4>
</div></div></div>
<p>When sending data to a secured cluster through the <code class="literal">logstash</code>
output, Elastic Agent can use SSL/TLS. For a list of available settings, refer to
<a class="xref" href="elastic-agent-ssl-configuration.html" title="Configure SSL/TLS for standalone Elastic Agents">SSL/TLS</a>, specifically the settings under
<a class="xref" href="elastic-agent-ssl-configuration.html#common-ssl-options" title="Common configuration options">Table 7, &#8220;Common configuration options&#8221;</a> and <a class="xref" href="elastic-agent-ssl-configuration.html#client-ssl-options" title="Client configuration options">Table 8, &#8220;Client configuration options&#8221;</a>.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>To use SSL/TLS, you must also configure the
<a href="/guide/en/logstash/master/plugins-inputs-beats.html" class="ulink" target="_top">Elastic Agent input plugin for Logstash</a> to
use SSL/TLS.</p>
</div>
</div>
<p>For more information, refer to <a class="xref" href="secure-logstash-connections.html" title="Configure SSL/TLS for the Logstash output">Configure SSL/TLS for the Logstash output</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="output-logstash-memory-queue-settings"></a>Memory queue settings<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/main/docs/en/ingest-management/elastic-agent/configuration/outputs/output-logstash.asciidoc">edit</a></h4>
</div></div></div>
<p>The memory queue keeps all events in memory.</p>
<p>The memory queue waits for the output to acknowledge or drop events. If the queue is full, no new
events can be inserted into the memory queue. Only after the signal from the output will the queue
free up space for more events to be accepted.</p>
<p>The memory queue is controlled by the parameters <code class="literal">flush.min_events</code> and <code class="literal">flush.timeout</code>.
<code class="literal">flush.min_events</code> gives a limit on the number of events that can be included in a single batch, and
<code class="literal">flush.timeout</code> specifies how long the queue should wait to completely fill an event request. If the
output supports a <code class="literal">bulk_max_size</code> parameter, the maximum batch size will be the smaller of
<code class="literal">bulk_max_size</code> and <code class="literal">flush.min_events</code>.</p>
<p><code class="literal">flush.min_events</code> is a legacy parameter, and new configurations should prefer to control batch size
with <code class="literal">bulk_max_size</code>. As of 8.13, there is never a performance advantage to limiting batch size with
<code class="literal">flush.min_events</code> instead of <code class="literal">bulk_max_size</code>.</p>
<p>In synchronous mode, an event request is always filled as soon as events are available, even if
there are not enough events to fill the requested batch. This is useful when latency must be
minimized. To use synchronous mode, set <code class="literal">flush.timeout</code> to 0.</p>
<p>For backwards compatibility, synchronous mode can also be activated by setting <code class="literal">flush.min_events</code> to 0
or 1. In this case, batch size will be capped at 1/2 the queue capacity.</p>
<p>In asynchronous mode, an event request will wait up to the specified timeout to try and fill the
requested batch completely. If the timeout expires, the queue returns a partial batch with all
available events. To use asynchronous mode, set <code class="literal">flush.timeout</code> to a positive duration, for example 5s.</p>
<p>This sample configuration forwards events to the output when there are enough events to fill the
output&#8217;s request (usually controlled by <code class="literal">bulk_max_size</code>, and limited to at most 512 events by
<code class="literal">flush.min_events</code>), or when events have been waiting for 5s without filling the requested size:f 512 events are available or the oldest
available event has been waiting for 5s in the queue:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">  queue.mem.events: 4096
  queue.mem.flush.min_events: 512
  queue.mem.flush.timeout: 5s</pre>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">
Setting
</th>
<th align="left" valign="top">
Description
</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top">
<p><a id="output-logstash-queue.mem.events-setting"></a><code class="literal">queue.mem.events</code></p>
</td>
<td align="left" valign="top">
<p>The number of events the queue can store. This value should be evenly divisible by the smaller of <code class="literal">queue.mem.flush.min_events</code> or <code class="literal">bulk_max_size</code> to avoid sending partial batches to the output.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">3200 events</code></p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="output-logstash-queue.mem.flush.min_events-setting"></a><code class="literal">queue.mem.flush.min_events</code></p>
</td>
<td align="left" valign="top">
<p><code class="literal">flush.min_events</code> is a legacy parameter, and new configurations should prefer to control batch size with <code class="literal">bulk_max_size</code>. As of 8.13, there is never a performance advantage to limiting batch size with <code class="literal">flush.min_events</code> instead of <code class="literal">bulk_max_size</code></p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">1600 events</code></p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="output-logstash-queue.mem.flush.timeout-setting"></a><code class="literal">queue.mem.flush.timeout</code></p>
</td>
<td align="left" valign="top">
<p>(int) The maximum wait time for <code class="literal">queue.mem.flush.min_events</code> to be fulfilled. If set to 0s, events are available to the output immediately.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">10s</code></p>
</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="output-logstash-performance-tuning-settings"></a>Performance tuning settings<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/main/docs/en/ingest-management/elastic-agent/configuration/outputs/output-logstash.asciidoc">edit</a></h4>
</div></div></div>
<p>Settings that may affect performance.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">
Setting
</th>
<th align="left" valign="top">
Description
</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top">
<p><a id="output-logstash-backoff.init-setting"></a><code class="literal">backoff.init</code></p>
</td>
<td align="left" valign="top">
<p>(string) The number of seconds to wait before trying to reconnect to Logstash
after a network error. After waiting <code class="literal">backoff.init</code> seconds, Elastic Agent tries to
reconnect. If the attempt fails, the backoff timer is increased exponentially up
to <code class="literal">backoff.max</code>. After a successful connection, the backoff timer is reset.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">1s</code></p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="output-logstash-backoff.max-setting"></a><code class="literal">backoff.max</code></p>
</td>
<td align="left" valign="top">
<p>(string) The maximum number of seconds to wait before attempting to connect to
Elasticsearch after a network error.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">60s</code></p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="output-logstash-bulk_max_size-setting"></a><code class="literal">bulk_max_size</code></p>
</td>
<td align="left" valign="top">
<p>(int) The maximum number of events to bulk in a single Logstash request.</p>
<p>Events can be collected into batches. Elastic Agent will split batches larger than
<code class="literal">bulk_max_size</code> into multiple batches.</p>
<p>Specifying a larger batch size can improve performance by lowering the overhead
of sending events. However big batch sizes can also increase processing times,
which might result in API errors, killed connections, timed-out publishing
requests, and, ultimately, lower throughput.</p>
<p>Set this value to <code class="literal">0</code> to turn off the splitting of batches. When splitting is
turned off, the queue determines the number of events to be contained in a
batch.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">2048</code></p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="output-logstash-compression_level-setting"></a><code class="literal">compression_level</code></p>
</td>
<td align="left" valign="top">
<p>(int) The gzip compression level. Set this value to <code class="literal">0</code> to disable compression.
The compression level must be in the range of <code class="literal">1</code> (best speed) to <code class="literal">9</code> (best
compression).</p>
<p>Increasing the compression level reduces network usage but increases CPU usage.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">3</code></p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="output-logstash-loadbalance-setting"></a><code class="literal">loadbalance</code></p>
</td>
<td align="left" valign="top">
<p>If <code class="literal">true</code> and multiple Logstash hosts are configured, the output plugin
load balances published events onto all Logstash hosts. If <code class="literal">false</code>,
the output plugin sends all events to one host (determined at random) and
switches to another host if the selected one becomes unresponsive.</p>
<p>With <code class="literal">loadbalance</code> enabled:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic Agent reads batches of events and sends each batch to one Logstash worker dynamically, based on a work-queue shared between the outputs.
</li>
<li class="listitem">
If a connection drops, Elastic Agent takes the disconnected Logstash worker out of its pool.
</li>
<li class="listitem">
Elastic Agent tries to reconnect. If it succeeds, it re-adds the Logstash worker to the pool.
</li>
<li class="listitem">
If one of the Logstash nodes is slow but "healthy", it sends a keep-alive signal until the full batch of data is processed. This prevents Elastic Agent from sending further data until it receives an acknowledgement signal back from Logstash. Elastic Agent keeps all events in memory until after that acknowledgement occurs.
</li>
</ul>
</div>
<p>Without <code class="literal">loadbalance</code> enabled:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic Agent picks a random Logstash host and sends batches of events to it. Due to the random algorithm, the load on the Logstash nodes should be roughly equal.
</li>
<li class="listitem">
In case of any errors, Elastic Agent picks another Logstash node, also at random. If a connection to a host fails, the host is retried only if there are errors on the new connection.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">false</code></p>
<p>Example:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">outputs:
  default:
    type: logstash
    hosts: ["localhost:5044", "localhost:5045"]
    loadbalance: true</pre>
</div>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="output-logstash-max_retries-setting"></a><code class="literal">max_retries</code></p>
</td>
<td align="left" valign="top">
<p>(int) The number of times to retry publishing an event after a publishing
failure. After the specified number of retries, the events are typically
dropped.</p>
<p>Set <code class="literal">max_retries</code> to a value less than 0 to retry until all events are published.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">3</code></p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="output-logstash-pipelining-setting"></a><code class="literal">pipelining</code></p>
</td>
<td align="left" valign="top">
<p>(int) The number of batches to send asynchronously to Logstash while waiting
for an ACK from Logstash. The output becomes blocking after the specified number of
batches are written. Specify <code class="literal">0</code> to turn off pipelining.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">2</code></p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="output-logstash-slow_start-setting"></a><code class="literal">slow_start</code></p>
</td>
<td align="left" valign="top">
<p>(boolean) If <code class="literal">true</code>, only a subset of events in a batch of events is transferred
per transaction. The number of events to be sent increases up to
<code class="literal">bulk_max_size</code> if no error is encountered. On error, the number of events per
transaction is reduced again.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">false</code></p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="output-logstash-timeout-setting"></a><code class="literal">timeout</code></p>
</td>
<td align="left" valign="top">
<p>(string) The number of seconds to wait for responses from the Logstash server
before timing out.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">30s</code></p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="output-logstash-ttl-setting"></a><code class="literal">ttl</code></p>
</td>
<td align="left" valign="top">
<p>(string) Time to live for a connection to Logstash after which the connection will be
reestablished. This setting is useful when Logstash hosts represent load balancers.
Because connections to Logstash hosts are sticky, operating behind load balancers
can lead to uneven load distribution across instances. Specify a TTL on the
connection to achieve equal connection distribution across instances.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">0</code> (turns off the feature)</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The <code class="literal">ttl</code> option is not yet supported on an asynchronous Logstash client (one with
the <code class="literal">pipelining</code> option set).</p>
</div>
</div>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="output-logstash-worker-setting"></a><code class="literal">worker</code></p>
</td>
<td align="left" valign="top">
<p>(int) The number of workers per configured host publishing events. Example: If
you have two hosts and three workers, in total six workers are started (three
for each host).</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">1</code></p>
</td>
</tr>
</tbody>
</table>
</div>
</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="kafka-output.html">« Kafka output</a>
</span>
<span class="next">
<a href="elastic-agent-ssl-configuration.html">Configure SSL/TLS for standalone Elastic Agents »</a>
</span>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>

                        <!-- Feedback widget -->
                        <div id="feedbackWidgetContainer"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


        <div id='elastic-footer'></div>
        <script src='https://www.elastic.co/elastic-footer.js'></script>
        <!-- Footer Section end-->

      </section>
    </div>

    <!-- Feedback modal -->
    <div id="feedbackModalContainer"></div>

    <script src="/guide/static/jquery.js"></script>
    <script type="text/javascript" src="/guide/static/docs-v1.js"></script>
    <script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
