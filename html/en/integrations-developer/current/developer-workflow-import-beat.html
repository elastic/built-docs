<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Import integration from Beats modules | Integrations Developer Guide | Elastic</title>
<meta class="elastic" name="content" content="Import integration from Beats modules | Integrations Developer Guide">

<link rel="home" href="index.html" title="Integrations Developer Guide"/>
<link rel="up" href="developer-workflows.html" title="Developer workflows"/>
<link rel="prev" href="developer-workflow-support-old-package.html" title="Release a bug fix for supporting older package version"/>
<link rel="next" href="integrations-guidelines.html" title="Integrations guidelines"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="Integrations"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Integrations/Developer"/>
<meta name="DC.subject" content="Integrations"/>
<meta name="DC.identifier" content="master"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <!--© 2015-2025 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Integrations Developer Guide</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="developer-workflows.html">Developer workflows</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="developer-workflow-support-old-package.html">« Release a bug fix for supporting older package version</a>
</span>
<span class="next">
<a href="integrations-guidelines.html">Integrations guidelines »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="developer-workflow-import-beat"></a>Import integration from Beats modules<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/integrations/developer-workflow-import-beat.asciidoc">edit</a></h2>
</div></div></div>
<p>The import procedure heavily uses on the <em>import-beats</em> script. If you are interested how does it work internally,
feel free to review the script&#8217;s <a href="https://github.com/elastic/integrations/tree/main/dev/import-beats/README.md" class="ulink" target="_top">README</a>.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Create an issue in the <a href="https://github.com/elastic/integrations" class="ulink" target="_top">integrations</a> to track ongoing progress with
the integration (especially manual changes).</p>
<p>Focus on the one particular product (e.g. MySQL, ActiveMQ) you would like to integrate with.
 Use this issue to mention every manual change that has been applied. It will help in adjusting the <code class="literal">import-beats</code>
 script and reviewing the integration.</p>
</li>
<li class="listitem">
<p>Prepare the developer environment:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Clone/refresh the following repositories:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://github.com/elastic/beats" class="ulink" target="_top">https://github.com/elastic/beats</a>
</li>
<li class="listitem">
<a href="https://github.com/elastic/ecs" class="ulink" target="_top">https://github.com/elastic/ecs</a>
</li>
<li class="listitem">
<a href="https://github.com/elastic/eui" class="ulink" target="_top">https://github.com/elastic/eui</a>
</li>
<li class="listitem">
<p><a href="https://github.com/elastic/kibana" class="ulink" target="_top">https://github.com/elastic/kibana</a></p>
<p>Make sure you don&#8217;t have any manual changes applied as they will reflect on the integration.</p>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Clone/refresh the Elastic Integrations to always use the latest version of the script:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://github.com/elastic/integrations" class="ulink" target="_top">https://github.com/elastic/integrations</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Make sure you&#8217;ve the <code class="literal">mage</code> tool installed:</p>
<div class="pre_wrapper lang-bash">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-bash">$ go get -u -d github.com/magefile/mage</pre>
</div>
</li>
</ol>
</div>
</li>
<li class="listitem">
<p>Use the <code class="literal">elastic-package stack up -v -d</code> command to boot up required dependencies:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Elasticseach instance:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Kibana&#8217;s dependency
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Kibana instance:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>used to migrate dashboards, if not available, you can skip the generation (<code class="literal">SKIP_KIBANA=true</code>)</p>
<p><em>Hint</em>. There is the <code class="literal">elastic-package</code> cheat sheet available <a href="https://github.com/elastic/integrations/blob/main/testing/environments/README.md" class="ulink" target="_top">here</a>.</p>
</li>
</ul>
</div>
</li>
</ol>
</div>
</li>
<li class="listitem">
Create a new branch for the integration in <code class="literal">integrations</code> repository (diverge from main).
</li>
<li class="listitem">
<p>Run the command: <code class="literal">mage ImportBeats</code> to start the import process (note that the import script assumes the projects checked out in step 2 are at <code class="literal">+../{project-name}+</code>).</p>
<p>The outcome of running the <code class="literal">import-beats</code> script is directory with refreshed and updated integrations.</p>
<p>It will take a while to finish, but the console output should be updated frequently to track the progress.
 The command should terminate with an exit code of 0. If it doesn&#8217;t, please open an issue.</p>
<p>Generated packages are stored by default in the <code class="literal">packages</code> directory. Generally, the import process
 updates all of the integrations, so don&#8217;t be surprised if you notice updates to multiple integrations, including
 the one you&#8217;re currently working on (e.g. <code class="literal">packages/foobarbaz</code>). You can either commit these changes
 or leave them for later.</p>
<p>If you want to select a subgroup of packages, set the environment variable <code class="literal">PACKAGES</code> (comma-delimited list):</p>
<div class="pre_wrapper lang-bash">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-bash">$ PACKAGES=aws,cisco mage ImportBeats</pre>
</div>
</li>
</ol>
</div>
<h4><a id="_fine_tune_the_integration"></a>Fine tune the integration<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/integrations/developer-workflow-import-beat.asciidoc">edit</a></h4>
<p>Most of migration work has been done by the <code class="literal">import-beats</code> script, but there&#8217;re tasks that require developer&#8217;s
interaction.</p>
<p>It may happen that your integration misses a screenshot or an icon, it&#8217;s a good moment to add missing resources to
Beats/Kibana repositories and re-import the integration (idempotent).</p>
<h5><a id="_checklist"></a>Checklist<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/integrations/developer-workflow-import-beat.asciidoc">edit</a></h5>
<p>The order of action items on the checklist is advised to prevent the contributor from repeating some actions (fixing
what&#8217;s been already fixed, as the script has overridden part of it).</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Add icon if missing.</p>
<p>The integration icons are presented in different places in Kibana, hence it&#8217;s better to define custom icons to make
 the UI easier to navigate.</p>
<p>As the <code class="literal">import-beats</code> script looks for icons in Kibana and EUI repositories, add an icon to the first one the same
 way as for tutorial resources (Kibana directory: <code class="literal">src/legacy/core_plugins/kibana/public/home/tutorial_resources/logos/</code>).</p>
</li>
<li class="listitem">
<p>Add screenshot if missing.</p>
<p>The Kibana Integration Manager shows screenshots related with the integration. Screenshots present Kibana
 dashboards visualizing the metric/log data.</p>
<p>The <code class="literal">import-beats</code> script finds references to screenshots mentioned in <code class="literal">_meta/docs.asciidoc</code> and copies image files
 from the Beats directories:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">metricbeat/docs/images</code>
</li>
<li class="listitem">
<code class="literal">filebeat/docs/images</code>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Improve/correct spelling product names.</p>
<p>The correct spelling of product names simply makes better impression. The <code class="literal">import-beats</code> scripts uses the <code class="literal">fields.yml</code>
 file as the source of the correct spelling (<code class="literal">title</code> property), e.g. Mysql - MySQL, Nginx - NGINX, Aws - AWS.</p>
<p>Keep in mind that this step requires reimporting package contents.</p>
</li>
<li class="listitem">
<p>Write README template file for the integration.</p>
<p>The README template is used to render the final README file including exported fields. The template should be placed
 in the <code class="literal">package/&lt;integration-name&gt;/_dev/build/docs/README.md</code>. If the directory doesn&#8217;t exist, please create it.</p>
<p>Review the MySQL docs template to see how to use template functions (e.g. <code class="literal">{{fields "data-stream-name"}}</code>).
 If the same data stream name is used in both metrics and logs, please add <code class="literal">-metrics</code> and <code class="literal">-logs</code> in the template. For example, <code class="literal">elb</code> is a data stream for log and also a data stream for metrics. In README.md template, <code class="literal">{{fields "elb_logs"}}</code> and <code class="literal">{{fields "elb_metrics"}}</code> are used to separate them.</p>
</li>
<li class="listitem">
<p>Review fields file and exported fields in docs.</p>
<p>The goal of this action item is to verify if produced artifacts are correct.</p>
<p>The fields files (package-fields.yml, fields.yml and ecs.yml) in the package were created from original fields.yml
 files (that may contain ECS schema fields) and fields.epr.yml (defining some other fields used in the ingest
 pipeline). It may happen that original sources have a typo, bad description or misses a field definition.
 The sum of fields in all present files should contain only fields that are really used, e.g. not all existing ECS
 fields.</p>
<p>It may happen that the ingest pipeline uses fields abstracted from ECS, but not mentioned in <code class="literal">fields.yml</code>.
 Integrations should contain these fields and also have them documented.</p>
<p>The fields for an integration package are divided into the following three files:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
ecs.yml: ECS compliant fields that are used by this particular data stream.
</li>
<li class="listitem">
package-fields.yml: Package level fields that are used by this particular data stream, which does not exist under <code class="literal">&lt;integration-package-name&gt;.&lt;data-stream-name&gt;</code>.
</li>
<li class="listitem">
fields.yml: Dataset level fields that are specific to this particular data stream, and non ECS compliant.
</li>
</ul>
</div>
<p>See the PR <a href="https://github.com/elastic/beats/pull/17895" class="ulink" target="_top">https://github.com/elastic/beats/pull/17895</a> to understand how to add them to Beats (e.g. <code class="literal">event.code</code>,
 <code class="literal">event.provider</code>) using the <code class="literal">fields.epr.yml</code> file.</p>
</li>
<li class="listitem">
<p>Metricbeat: add missing configuration options.</p>
<p>The <code class="literal">import-beats</code> script extracts configuration options from Metricbeat module&#8217;s <code class="literal">_meta</code> directory. It analyzes
the configuration files and selects options based on enabled metricsets (not commented). If you notice that some
configuration options are missing in your package&#8217;s manifest files, simply create the <code class="literal">config.epr.yml</code> file with all
required options.</p>
<p>Sample PR: <a href="https://github.com/elastic/beats/pull/17323" class="ulink" target="_top">https://github.com/elastic/beats/pull/17323</a></p>
</li>
<li class="listitem">
<p>Review <em>titles</em> and <em>descriptions</em> in manifest files.</p>
<p>Titles and descriptions are fields visualized in the Kibana UI. Most users will use them to see how to configure
 the integration with their installation of a product or to how to use advanced configuration options.</p>
</li>
<li class="listitem">
<p>Compact configuration options (vars).</p>
<p>Currently, all configuration options are set by the <code class="literal">import-beats</code> script on the stream level
 (path: <code class="literal">data stream/&lt;data-stream-name&gt;/manifest.yml</code>).</p>
<p>It may happen that some of them in different data streams are simply duplicates or concern the same setting, which
 will be always equal (e.g. MySQL username, password). Keep in mind that two data streams may have the same configuration
 option, but different values (e.g. <code class="literal">period</code>, <code class="literal">paths</code>), hence can&#8217;t be compacted.</p>
<p>To sum up, compacting takes down from the user the necessity to setup the same configuration option few times (one
 per data stream).</p>
</li>
<li class="listitem">
<p>Define all variable properties.</p>
<p>The variable properties customize visualization of configuration options in the Kibana UI. Make sure they&#8217;re
 defined in all manifest files.</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">    vars:
      - name: paths
        required: true
        show_user: true
        title: Access log paths
        description: Paths to the nginx access log file.
        type: text
        multi: true
        default:
          - /var/log/nginx/access.log*</pre>
</div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>required</strong></span> - option is required
</li>
<li class="listitem">
<span class="strong strong"><strong>show_user</strong></span> - don&#8217;t hide the configuration option (collapsed menu)
</li>
<li class="listitem">
<span class="strong strong"><strong>title</strong></span> - human readable variable name
</li>
<li class="listitem">
<span class="strong strong"><strong>description</strong></span> - variable description (may contain some details)
</li>
<li class="listitem">
<span class="strong strong"><strong>type</strong></span> - field type (according to the reference: text, password, bool, integer)
</li>
<li class="listitem">
<span class="strong strong"><strong>multi</strong></span> - the field has mutliple values.
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Review stream configuration.</p>
<p>Due to changed templating engine from a standard Golang one to <a href="https://handlebarsjs.com/" class="ulink" target="_top">handlebars</a>, it may be
hard to automatically convert the Filebeat input configuration (nested variables, many representations, conditions,
loops). Please review the output stream configuration and identify potential bugs.</p>
</li>
<li class="listitem">
<p>Update docs template with sample events.</p>
<p>The events collected by the agent slightly differ from the original, Metricbeat and Filebeat, ones. Adjust the event
content manually basing on already migrated integrations (e.g. <a href="https://github.com/elastic/integrations/blob/main/packages/mysql/_dev/build/docs/README.md" class="ulink" target="_top">MySQL integration</a>)
or copy them once managed to run whole setup with real agent.</p>
</li>
<li class="listitem">
<p>Kibana: use <code class="literal">stream.data stream</code> field instead of <code class="literal">event.data stream</code>.</p>
<p>Using <code class="literal">stream.data stream</code> instead of <code class="literal">event.data stream</code> also makes queries a lot more efficient as this is a
<code class="literal">constant_keyword</code>. Make sure that dashboards in your package don&#8217;t use the <code class="literal">event.data stream</code> field. If so,
simply replace them with the more efficient one.</p>
</li>
</ol>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="developer-workflow-support-old-package.html">« Release a bug fix for supporting older package version</a>
</span>
<span class="next">
<a href="integrations-guidelines.html">Integrations guidelines »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>

                        <!-- Feedback widget -->
                        <div id="feedbackWidgetContainer"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


        <div id='elastic-footer'></div>
        <script src='https://www.elastic.co/elastic-footer.js'></script>
        <!-- Footer Section end-->

      </section>
    </div>

    <!-- Feedback modal -->
    <div id="feedbackModalContainer"></div>

    <script src="/guide/static/jquery.js"></script>
    <script type="text/javascript" src="/guide/static/docs.js"></script>
    <script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
