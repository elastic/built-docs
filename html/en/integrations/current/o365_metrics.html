<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Microsoft Office 365 Metrics Integration | Elastic integrations | Elastic</title>
<meta class="elastic" name="content" content="Microsoft Office 365 Metrics Integration | Elastic integrations">

<link rel="home" href="index.html" title="Elastic integrations"/>
<link rel="up" href="microsoft-intro.html" title="Microsoft"/>
<link rel="prev" href="m365_defender.html" title="M365 Defender integration"/>
<link rel="next" href="microsoft_sentinel.html" title="Microsoft Sentinel"/>
<meta class="elastic" name="product_version" content="main"/>
<meta class="elastic" name="product_name" content="Integrations"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Integrations/Reference"/>
<meta name="DC.subject" content="Integrations"/>
<meta name="DC.identifier" content="main"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles-v1.css" />
  </head>

  <!--© 2015-2025 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div class="navheader">
<span class="prev">
<a href="m365_defender.html">« M365 Defender integration</a>
</span>
<span class="next">
<a href="microsoft_sentinel.html">Microsoft Sentinel »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic integrations</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="microsoft-intro.html">Microsoft</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Microsoft Office 365 Metrics Integration</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/o365_metrics/index.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="o365_metrics"></a>Microsoft Office 365 Metrics Integration</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/o365_metrics/index.asciidoc">edit</a></div>
</div></div></div>

<div class="condensed-table">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<tbody>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Version</strong></span></p></td>
<td align="left" valign="top"><p>0.2.0 <span class="Admonishment Admonishment--beta">
[<span class="Admonishment-title u-mono">beta</span>]
<span class="Admonishment-detail">
This functionality is in beta and is subject to change. The design and code is less mature than official GA features and is being provided as-is with no warranties. Beta features are not subject to the support SLA of official GA features.
</span>
</span> (<a class="xref" href="o365_metrics.html#o365_metrics-changelog" title="Changelog">View all</a>)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Compatible Kibana version(s)</strong></span></p></td>
<td align="left" valign="top"><p>8.16.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Supported Serverless project types</strong></span><br>
 <a class="xref" href="serverless-support.html" title="Supported Serverless project types"><span class="small">What&#8217;s this?</span></a></p></td>
<td align="left" valign="top"><p>Security<br>
Observability</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Subscription level</strong></span><br>
<a href="/subscriptions" class="ulink" target="_top"><span class="small">What&#8217;s this?</span></a></p></td>
<td align="left" valign="top"><p>Basic</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Level of support</strong></span><br>
<a class="xref" href="support.html" title="Level of support"><span class="small">What&#8217;s this?</span></a></p></td>
<td align="left" valign="top"><p>Elastic</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>This integration uses the <a href="https://learn.microsoft.com/en-us/graph/overview" class="ulink" target="_top">Microsoft Graph API</a> to collect essential metrics from Microsoft Office 365, offering detailed insights into user activity, application usage, and overall system performance.</p>
<div class="position-relative"><h4><a id="o365_metrics-setup"></a>Setup</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/o365_metrics/index.asciidoc">edit</a></div>
<p>To use this package you need to enable datastreams you want to collect metrics for and register an application in <a href="https://www.microsoft.com/en-us/security/business/identity-access/microsoft-entra-id" class="ulink" target="_top">Microsoft Entra ID (formerly known as Azure Active Directory)</a>.</p>
<p>Once the application is registered, configure and/or note the following to setup O365 metrics Elastic integration:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Note <code class="literal">Application (client) ID</code> and the <code class="literal">Directory (tenant) ID</code> in the registered application&#8217;s <code class="literal">Overview</code> page.
</li>
<li class="listitem">
<p>Create a new secret to configure the authentication of your application.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Navigate to <code class="literal">Certificates &amp; Secrets</code> section.
</li>
<li class="listitem">
Click <code class="literal">New client secret</code> and provide some description to create new secret.
</li>
<li class="listitem">
Note the <code class="literal">Value</code> which is required for the integration setup.
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Add permissions to your registered application. Please check <a href="https://learn.microsoft.com/en-us/graph/reportroot-authorization" class="ulink" target="_top">O365 Graph API permissions</a> for more details.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Navigate to <code class="literal">API permissions</code> page and click <code class="literal">Add a permission</code>
</li>
<li class="listitem">
Select <code class="literal">Office 365 Management APIs</code> tile from the listed tiles.
</li>
<li class="listitem">
Click <code class="literal">Application permissions</code>.
</li>
<li class="listitem">
If <code class="literal">User.Read</code> and <code class="literal">Reports.Read.All</code> permission under <code class="literal">Microsoft.Graph</code> tile is not added by default, add this permission.
</li>
<li class="listitem">
After the permissions are added, the admin has to grant consent for these permissions.
</li>
</ul>
</div>
</li>
</ol>
</div>
<p>Once the secret is created and permissions are granted by admin, setup Elastic Agent&#8217;s Microsoft O365 integration:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Click <code class="literal">Add Microsoft Office 365</code>.
</li>
<li class="listitem">
Enable <code class="literal">Collect Office 365 metrics via Graph API using CEL Input</code>.
</li>
<li class="listitem">
Add <code class="literal">Directory (tenant) ID</code> noted in Step 1 into <code class="literal">Directory (tenant) ID</code> parameter. This is required field.
</li>
<li class="listitem">
Add <code class="literal">Application (client) ID</code> noted in Step 1 into <code class="literal">Application (client) ID</code> parameter. This is required field.
</li>
<li class="listitem">
Add the secret <code class="literal">Value</code> noted in Step 2 into <code class="literal">Client Secret</code> parameter. This is required field.
</li>
<li class="listitem">
Oauth2 Token URL can be added to generate the tokens during the oauth2 flow. If not provided, above <code class="literal">Directory (tenant) ID</code> will be used for oauth2 token generation.
</li>
<li class="listitem">
Modify any other parameters as necessary.
</li>
</ul>
</div>
<div class="position-relative"><h4><a id="o365_metrics-metrics"></a>Metrics</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/o365_metrics/index.asciidoc">edit</a></div>
<p>Uses the Office 365 Graph API to retrieve metrics from Office 365.</p>
<div class="position-relative"><h5><a id="o365_metrics-mailbox-usage"></a>Mailbox Usage</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/o365_metrics/index.asciidoc">edit</a></div>
<details>
<summary class="title"><span class="strong strong"><strong>Example</strong></span></summary>
<div class="content">
<p>An example event for <code class="literal">mailbox_usage</code> looks as following:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
    "@timestamp": "2024-12-24T09:24:40.827Z",
    "agent": {
        "name": "docker-fleet-agent",
        "id": "abf38fab-f7b6-4e1c-a3b3-a70a64f9e5db",
        "ephemeral_id": "08417a8d-9698-4c62-b7dc-e1b048647626",
        "type": "filebeat",
        "version": "8.16.0"
    },
    "data_stream": {
        "namespace": "default",
        "type": "metrics",
        "dataset": "o365_metrics.mailbox_usage"
    },
    "ecs": {
        "version": "8.16.0"
    },
    "elastic_agent": {
        "id": "abf38fab-f7b6-4e1c-a3b3-a70a64f9e5db",
        "version": "8.16.0",
        "snapshot": false
    },
    "event": {
        "agent_id_status": "verified",
        "ingested": "2024-12-24T09:24:41Z",
        "dataset": "o365_metrics.mailbox_usage"
    },
    "host": {
        "hostname": "docker-fleet-agent",
        "os": {
            "kernel": "5.10.104-linuxkit",
            "name": "Wolfi",
            "type": "linux",
            "family": "",
            "version": "20230201",
            "platform": "wolfi"
        },
        "containerized": false,
        "ip": [
            "192.168.48.7"
        ],
        "name": "docker-fleet-agent",
        "mac": [
            "02-42-C0-A8-30-07"
        ],
        "architecture": "aarch64"
    },
    "o365": {
        "metrics": {
            "mailbox": {
                "usage": {
                    "detail": {
                        "item": {
                            "count": "82"
                        },
                        "deleted_item_size": {
                            "byte": "0"
                        },
                        "prohibit_send_quota": {
                            "byte": "106300440576"
                        },
                        "deleted_item_quota": {
                            "byte": "32212254720"
                        },
                        "issue_warning_quota": {
                            "byte": "105226698752"
                        },
                        "deleted_item": {
                            "count": "0"
                        },
                        "report": {
                            "period": {
                                "day": "7"
                            },
                            "refresh_date": "2024-12-22"
                        },
                        "prohibit_send_receive_quota": {
                            "byte": "107374182400"
                        },
                        "storage_used": {
                            "byte": "7986169"
                        }
                    }
                }
            }
        }
    },
    "tags": [
        "o365.metrics.mailbox.usage"
    ]
}</pre>
</div>
</div>
</details>
<p><span class="strong strong"><strong>ECS Field Reference</strong></span></p>
<p>Please refer to the following <a href="/guide/en/ecs/current/ecs-field-reference.html" class="ulink" target="_top">document</a> for detailed information on ECS fields.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Exported fields</strong></span></summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Field</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Unit</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>@timestamp</p></td>
<td align="left" valign="top"><p>Event timestamp.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cloud.image.id</p></td>
<td align="left" valign="top"><p>Image ID for the cloud instance.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.dataset</p></td>
<td align="left" valign="top"><p>Data stream dataset.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.namespace</p></td>
<td align="left" valign="top"><p>Data stream namespace.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.type</p></td>
<td align="left" valign="top"><p>Data stream type.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.containerized</p></td>
<td align="left" valign="top"><p>If the host is a container.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.build</p></td>
<td align="left" valign="top"><p>OS build information.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.codename</p></td>
<td align="left" valign="top"><p>OS codename, if any.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.mailbox.quota.status.indeterminate.count</p></td>
<td align="left" valign="top"><p>The number of mailboxes where the quota status could not be determined.</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.mailbox.quota.status.report.date</p></td>
<td align="left" valign="top"><p>The specific date for which the report data applies.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.mailbox.quota.status.report.period.day</p></td>
<td align="left" valign="top"><p>The duration (e.g., 7 days) over which the quota status data is aggregated.</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p>d</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.mailbox.quota.status.report.refresh_date</p></td>
<td align="left" valign="top"><p>The date when the report data was last updated.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.mailbox.quota.status.send_prohibited.count</p></td>
<td align="left" valign="top"><p>The number of mailboxes restricted from sending emails due to exceeding their send quota during the reporting period.</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.mailbox.quota.status.send_receive_prohibited.count</p></td>
<td align="left" valign="top"><p>The number of mailboxes restricted from both sending and receiving emails due to exceeding their total quota during the reporting period.</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.mailbox.quota.status.under_limit.count</p></td>
<td align="left" valign="top"><p>The number of mailboxes operating within their assigned quota limits during the reporting period.</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.mailbox.quota.status.warning_issued.count</p></td>
<td align="left" valign="top"><p>The number of mailboxes that have exceeded their warning threshold quota during the reporting period.</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.mailbox.usage.detail.deleted_item.count</p></td>
<td align="left" valign="top"><p>The number of items in the deleted items folder.</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.mailbox.usage.detail.deleted_item_quota.byte</p></td>
<td align="left" valign="top"><p>The quota limit for the deleted items folder (in bytes).</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.mailbox.usage.detail.deleted_item_size.byte</p></td>
<td align="left" valign="top"><p>The total size of items in the deleted items folder (in bytes).</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.mailbox.usage.detail.issue_warning_quota.byte</p></td>
<td align="left" valign="top"><p>The mailbox size limit at which a warning is issued (in bytes).</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.mailbox.usage.detail.item.count</p></td>
<td align="left" valign="top"><p>The total number of items in the mailbox.</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.mailbox.usage.detail.prohibit_send_quota.byte</p></td>
<td align="left" valign="top"><p>The mailbox size limit at which sending messages is prohibited (in bytes).</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.mailbox.usage.detail.prohibit_send_receive_quota.byte</p></td>
<td align="left" valign="top"><p>The mailbox size limit at which sending and receiving messages is prohibited (in bytes).</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.mailbox.usage.detail.report.period.day</p></td>
<td align="left" valign="top"><p>The reporting period over which the data is aggregated (in days).</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p>d</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.mailbox.usage.detail.report.refresh_date</p></td>
<td align="left" valign="top"><p>The date when the report data was last updated.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.mailbox.usage.detail.storage_used.byte</p></td>
<td align="left" valign="top"><p>The total storage used in the mailbox (in bytes).</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
<div class="position-relative"><h5><a id="o365_metrics-one-drive-usage"></a>One Drive Usage</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/o365_metrics/index.asciidoc">edit</a></div>
<details>
<summary class="title"><span class="strong strong"><strong>Example</strong></span></summary>
<div class="content">
<p>An example event for <code class="literal">onedrive_usage</code> looks as following:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
    "@timestamp": "2024-12-24T09:33:50.076Z",
    "agent": {
        "name": "docker-fleet-agent",
        "id": "abf38fab-f7b6-4e1c-a3b3-a70a64f9e5db",
        "ephemeral_id": "08417a8d-9698-4c62-b7dc-e1b048647626",
        "type": "filebeat",
        "version": "8.16.0"
    },
    "data_stream": {
        "namespace": "default",
        "type": "metrics",
        "dataset": "o365_metrics.onedrive_usage"
    },
    "ecs": {
        "version": "8.16.0"
    },
    "elastic_agent": {
        "id": "abf38fab-f7b6-4e1c-a3b3-a70a64f9e5db",
        "version": "8.16.0",
        "snapshot": false
    },
    "event": {
        "agent_id_status": "verified",
        "ingested": "2024-12-24T09:33:51Z",
        "dataset": "o365_metrics.onedrive_usage"
    },
    "host": {
        "hostname": "docker-fleet-agent",
        "os": {
            "kernel": "5.10.104-linuxkit",
            "name": "Wolfi",
            "type": "linux",
            "family": "",
            "version": "20230201",
            "platform": "wolfi"
        },
        "containerized": false,
        "ip": [
            "192.168.48.7"
        ],
        "name": "docker-fleet-agent",
        "mac": [
            "02-42-C0-A8-30-07"
        ],
        "architecture": "aarch64"
    },
    "o365": {
        "metrics": {
            "onedrive": {
                "usage": {
                    "storage": {
                        "report": {
                            "date": "2024-12-16",
                            "period": "7",
                            "refresh_date": "2024-12-22"
                        },
                        "used_byte": "91893426"
                    }
                }
            }
        }
    },
    "tags": [
        "o365.metrics.onedrive"
    ]
}</pre>
</div>
</div>
</details>
<p><span class="strong strong"><strong>ECS Field Reference</strong></span></p>
<p>Please refer to the following <a href="/guide/en/ecs/current/ecs-field-reference.html" class="ulink" target="_top">document</a> for detailed information on ECS fields.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Exported fields</strong></span></summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Field</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>@timestamp</p></td>
<td align="left" valign="top"><p>Event timestamp.</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cloud.image.id</p></td>
<td align="left" valign="top"><p>Image ID for the cloud instance.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.dataset</p></td>
<td align="left" valign="top"><p>Data stream dataset.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.namespace</p></td>
<td align="left" valign="top"><p>Data stream namespace.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.type</p></td>
<td align="left" valign="top"><p>Data stream type.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.containerized</p></td>
<td align="left" valign="top"><p>If the host is a container.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.build</p></td>
<td align="left" valign="top"><p>OS build information.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.codename</p></td>
<td align="left" valign="top"><p>OS codename, if any.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.onedrive.usage.account.counts.active.count</p></td>
<td align="left" valign="top"><p>The number of OneDrive accounts that were active during the reporting period.</p></td>
<td align="left" valign="top"><p>integer</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.onedrive.usage.account.counts.report.date</p></td>
<td align="left" valign="top"><p>The date the report was generated.</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.onedrive.usage.account.counts.report.period</p></td>
<td align="left" valign="top"><p>The duration of the reporting period, in days.</p></td>
<td align="left" valign="top"><p>integer</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.onedrive.usage.account.counts.report.refresh_date</p></td>
<td align="left" valign="top"><p>The date when the data in the report was last refreshed.</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.onedrive.usage.account.counts.total.count</p></td>
<td align="left" valign="top"><p>The total number of OneDrive accounts evaluated in the report.</p></td>
<td align="left" valign="top"><p>integer</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.onedrive.usage.file.counts.active.count</p></td>
<td align="left" valign="top"><p>The number of OneDrive accounts with active file usage during the reporting period.</p></td>
<td align="left" valign="top"><p>integer</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.onedrive.usage.file.counts.report.date</p></td>
<td align="left" valign="top"><p>The date the report was generated.</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.onedrive.usage.file.counts.report.period</p></td>
<td align="left" valign="top"><p>The duration of the reporting period, in days.</p></td>
<td align="left" valign="top"><p>integer</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.onedrive.usage.file.counts.report.refresh_date</p></td>
<td align="left" valign="top"><p>The date when the data in the report was last refreshed.</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.onedrive.usage.file.counts.total.count</p></td>
<td align="left" valign="top"><p>The total number of OneDrive accounts evaluated in the report.</p></td>
<td align="left" valign="top"><p>integer</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.onedrive.usage.storage.report.date</p></td>
<td align="left" valign="top"><p>The date the report was generated.</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.onedrive.usage.storage.report.period</p></td>
<td align="left" valign="top"><p>The duration of the reporting period, in days.</p></td>
<td align="left" valign="top"><p>integer</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.onedrive.usage.storage.report.refresh_date</p></td>
<td align="left" valign="top"><p>The date when the data in the report was last refreshed.</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.onedrive.usage.storage.used_byte</p></td>
<td align="left" valign="top"><p>The total storage used across OneDrive accounts during the reporting period, in bytes.</p></td>
<td align="left" valign="top"><p>integer</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
<div class="position-relative"><h5><a id="o365_metrics-outlook-activity"></a>Outlook Activity</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/o365_metrics/index.asciidoc">edit</a></div>
<details>
<summary class="title"><span class="strong strong"><strong>Example</strong></span></summary>
<div class="content">
<p>An example event for <code class="literal">outlook_activity</code> looks as following:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
    "o365": {
        "metrics": {
            "outlook": {
                "activity": {
                    "meeting_interacted": {
                        "count": ""
                    },
                    "meeting_created": {
                        "count": "0"
                    },
                    "emails_received": {
                        "count": "3"
                    },
                    "emails_sent": {
                        "count": ""
                    },
                    "report": {
                        "date": "2024-12-16",
                        "period": {
                            "day": "7"
                        },
                        "refresh_date": "2024-12-22"
                    },
                    "emails_read": {
                        "count": ""
                    }
                }
            }
        }
    },
    "agent": {
        "name": "docker-fleet-agent",
        "id": "abf38fab-f7b6-4e1c-a3b3-a70a64f9e5db",
        "type": "filebeat",
        "ephemeral_id": "08417a8d-9698-4c62-b7dc-e1b048647626",
        "version": "8.16.0"
    },
    "@timestamp": "2024-12-24T09:36:40.780Z",
    "ecs": {
        "version": "8.16.0"
    },
    "data_stream": {
        "namespace": "default",
        "type": "metrics",
        "dataset": "o365_metrics.outlook_activity"
    },
    "host": {
        "hostname": "docker-fleet-agent",
        "os": {
            "kernel": "5.10.104-linuxkit",
            "name": "Wolfi",
            "family": "",
            "type": "linux",
            "version": "20230201",
            "platform": "wolfi"
        },
        "containerized": false,
        "ip": [
            "192.168.48.7"
        ],
        "name": "docker-fleet-agent",
        "mac": [
            "02-42-C0-A8-30-07"
        ],
        "architecture": "aarch64"
    },
    "elastic_agent": {
        "id": "abf38fab-f7b6-4e1c-a3b3-a70a64f9e5db",
        "version": "8.16.0",
        "snapshot": false
    },
    "event": {
        "agent_id_status": "verified",
        "ingested": "2024-12-24T09:36:41Z",
        "dataset": "o365_metrics.outlook_activity"
    },
    "tags": [
        "o365.metrics.outlook.activity"
    ]
}</pre>
</div>
</div>
</details>
<p><span class="strong strong"><strong>ECS Field Reference</strong></span></p>
<p>Please refer to the following <a href="/guide/en/ecs/current/ecs-field-reference.html" class="ulink" target="_top">document</a> for detailed information on ECS fields.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Exported fields</strong></span></summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Field</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Unit</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>@timestamp</p></td>
<td align="left" valign="top"><p>Event timestamp.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cloud.image.id</p></td>
<td align="left" valign="top"><p>Image ID for the cloud instance.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.dataset</p></td>
<td align="left" valign="top"><p>Data stream dataset.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.namespace</p></td>
<td align="left" valign="top"><p>Data stream namespace.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.type</p></td>
<td align="left" valign="top"><p>Data stream type.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.containerized</p></td>
<td align="left" valign="top"><p>If the host is a container.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.build</p></td>
<td align="left" valign="top"><p>OS build information.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.codename</p></td>
<td align="left" valign="top"><p>OS codename, if any.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.outlook.activity.emails_read.count</p></td>
<td align="left" valign="top"><p>The count of email messages read by users during the reporting period.</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.outlook.activity.emails_received.count</p></td>
<td align="left" valign="top"><p>The count of email messages received by users during the reporting period.</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.outlook.activity.emails_sent.count</p></td>
<td align="left" valign="top"><p>The count of email messages sent by users during the reporting period.</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.outlook.activity.meeting_created.count</p></td>
<td align="left" valign="top"><p>The count of calendar meetings created by users during the reporting period.</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.outlook.activity.meeting_interacted.count</p></td>
<td align="left" valign="top"><p>The count of meetings where users interacted (e.g., accepted, declined, or modified) during the reporting period.</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.outlook.activity.report.date</p></td>
<td align="left" valign="top"><p>The specific date for which the report data applies.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.outlook.activity.report.period.day</p></td>
<td align="left" valign="top"><p>The duration (e.g., 7 days) over which the report data is aggregated.</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p>d</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.outlook.activity.report.refresh_date</p></td>
<td align="left" valign="top"><p>The date when the report data was last updated.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
<div class="position-relative"><h5><a id="o365_metrics-outlook-app-usage"></a>Outlook App Usage</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/o365_metrics/index.asciidoc">edit</a></div>
<details>
<summary class="title"><span class="strong strong"><strong>Example</strong></span></summary>
<div class="content">
<p>An example event for <code class="literal">outlook_app_usage</code> looks as following:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
    "o365": {
        "metrics": {
            "outlook": {
                "app": {
                    "usage": {
                        "outlook_2013": {
                            "count": ""
                        },
                        "outlook_2016": {
                            "count": ""
                        },
                        "outlook_2007": {
                            "count": ""
                        },
                        "undetermined": {
                            "count": ""
                        },
                        "report": {
                            "period": {
                                "day": "7"
                            },
                            "refresh_date": "2024-12-22"
                        },
                        "outlook_2019": {
                            "count": ""
                        },
                        "outlook_m365": {
                            "count": ""
                        },
                        "outlook_2010": {
                            "count": ""
                        }
                    }
                }
            }
        }
    },
    "agent": {
        "name": "docker-fleet-agent",
        "id": "abf38fab-f7b6-4e1c-a3b3-a70a64f9e5db",
        "ephemeral_id": "08417a8d-9698-4c62-b7dc-e1b048647626",
        "type": "filebeat",
        "version": "8.16.0"
    },
    "@timestamp": "2024-12-24T09:39:43.406Z",
    "ecs": {
        "version": "8.16.0"
    },
    "data_stream": {
        "namespace": "default",
        "type": "metrics",
        "dataset": "o365_metrics.outlook_app_usage"
    },
    "host": {
        "hostname": "docker-fleet-agent",
        "os": {
            "kernel": "5.10.104-linuxkit",
            "name": "Wolfi",
            "family": "",
            "type": "linux",
            "version": "20230201",
            "platform": "wolfi"
        },
        "ip": [
            "192.168.48.7"
        ],
        "containerized": false,
        "name": "docker-fleet-agent",
        "mac": [
            "02-42-C0-A8-30-07"
        ],
        "architecture": "aarch64"
    },
    "elastic_agent": {
        "id": "abf38fab-f7b6-4e1c-a3b3-a70a64f9e5db",
        "version": "8.16.0",
        "snapshot": false
    },
    "event": {
        "agent_id_status": "verified",
        "ingested": "2024-12-24T09:39:44Z",
        "dataset": "o365_metrics.outlook_app_usage"
    },
    "tags": [
        "o365metrics-outlook_app_usage"
    ]
}</pre>
</div>
</div>
</details>
<p><span class="strong strong"><strong>ECS Field Reference</strong></span></p>
<p>Please refer to the following <a href="/guide/en/ecs/current/ecs-field-reference.html" class="ulink" target="_top">document</a> for detailed information on ECS fields.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Exported fields</strong></span></summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Field</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Unit</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>@timestamp</p></td>
<td align="left" valign="top"><p>Event timestamp.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cloud.image.id</p></td>
<td align="left" valign="top"><p>Image ID for the cloud instance.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.dataset</p></td>
<td align="left" valign="top"><p>Data stream dataset.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.namespace</p></td>
<td align="left" valign="top"><p>Data stream namespace.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.type</p></td>
<td align="left" valign="top"><p>Data stream type.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.containerized</p></td>
<td align="left" valign="top"><p>If the host is a container.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.build</p></td>
<td align="left" valign="top"><p>OS build information.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.codename</p></td>
<td align="left" valign="top"><p>OS codename, if any.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.outlook.app.usage.outlook_2007.count</p></td>
<td align="left" valign="top"><p>The count of unique users using Outlook 2007 during the reporting period.</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.outlook.app.usage.outlook_2010.count</p></td>
<td align="left" valign="top"><p>The count of unique users using Outlook 2010 during the reporting period.</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.outlook.app.usage.outlook_2013.count</p></td>
<td align="left" valign="top"><p>The count of unique users using Outlook 2013 during the reporting period.</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.outlook.app.usage.outlook_2016.count</p></td>
<td align="left" valign="top"><p>The count of unique users using Outlook 2016 during the reporting period.</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.outlook.app.usage.outlook_2019.count</p></td>
<td align="left" valign="top"><p>The count of unique users using Outlook 2019 during the reporting period.</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.outlook.app.usage.outlook_m365.count</p></td>
<td align="left" valign="top"><p>The count of unique users using the Outlook Microsoft 365 version during the reporting period.</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.outlook.app.usage.report.period.day</p></td>
<td align="left" valign="top"><p>The duration (e.g., 7 days) over which the report data is aggregated.</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p>d</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.outlook.app.usage.report.refresh_date</p></td>
<td align="left" valign="top"><p>The date when the report data was last updated.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.outlook.app.usage.undetermined.count</p></td>
<td align="left" valign="top"><p>The count of unique users whose Outlook version could not be identified.</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
<div class="position-relative"><h5><a id="o365_metrics-active-users"></a>Active Users</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/o365_metrics/index.asciidoc">edit</a></div>
<details>
<summary class="title"><span class="strong strong"><strong>Example</strong></span></summary>
<div class="content">
<p>An example event for <code class="literal">active_users</code> looks as following:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
    "o365": {
        "metrics": {
            "active": {
                "users": {
                    "teams": {
                        "inactive": {
                            "count": "20"
                        },
                        "active": {
                            "count": "0"
                        }
                    },
                    "sharepoint": {
                        "inactive": {
                            "count": "20"
                        },
                        "active": {
                            "count": "0"
                        }
                    },
                    "yammer": {
                        "inactive": {
                            "count": "25"
                        },
                        "active": {
                            "count": "0"
                        }
                    },
                    "office365": {
                        "inactive": {
                            "count": "25"
                        },
                        "active": {
                            "count": "0"
                        }
                    },
                    "report": {
                        "period": {
                            "day": "7"
                        },
                        "refresh_date": "2024-11-29"
                    },
                    "exchange": {
                        "inactive": {
                            "count": "20"
                        },
                        "active": {
                            "count": "0"
                        }
                    },
                    "onedrive": {
                        "inactive": {
                            "count": "20"
                        },
                        "active": {
                            "count": "0"
                        }
                    }
                }
            }
        }
    },
    "agent": {
        "name": "docker-fleet-agent",
        "id": "1bd16076-38b3-44b9-980b-eab55ebe95b9",
        "ephemeral_id": "b21b52df-710e-4014-bb1c-d9e60091e1e7",
        "type": "filebeat",
        "version": "8.16.0"
    },
    "@timestamp": "2024-12-24T10:36:47.702Z",
    "ecs": {
        "version": "8.16.0"
    },
    "data_stream": {
        "namespace": "default",
        "type": "metrics",
        "dataset": "o365_metrics.active_users"
    },
    "elastic_agent": {
        "id": "1bd16076-38b3-44b9-980b-eab55ebe95b9",
        "version": "8.16.0",
        "snapshot": false
    },
    "host": {
        "hostname": "docker-fleet-agent",
        "os": {
            "kernel": "5.15.153.1-microsoft-standard-WSL2",
            "codename": "noble",
            "name": "Ubuntu",
            "type": "linux",
            "family": "debian",
            "version": "24.04.1 LTS (Noble Numbat)",
            "platform": "ubuntu"
        },
        "containerized": true,
        "ip": [
            "172.18.0.7"
        ],
        "name": "docker-fleet-agent",
        "mac": [
            "02-42-AC-12-00-07"
        ],
        "architecture": "x86_64"
    },
    "event": {
        "agent_id_status": "verified",
        "ingested": "2024-12-24T10:36:57Z",
        "dataset": "o365_metrics.active_users"
    },
    "tags": [
        "o365.metrics.active.users"
    ]
}</pre>
</div>
</div>
</details>
<p><span class="strong strong"><strong>ECS Field Reference</strong></span></p>
<p>Please refer to the following <a href="/guide/en/ecs/current/ecs-field-reference.html" class="ulink" target="_top">document</a> for detailed information on ECS fields.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Exported fields</strong></span></summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Field</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>@timestamp</p></td>
<td align="left" valign="top"><p>Event timestamp.</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cloud.image.id</p></td>
<td align="left" valign="top"><p>Image ID for the cloud instance.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.dataset</p></td>
<td align="left" valign="top"><p>Data stream dataset.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.namespace</p></td>
<td align="left" valign="top"><p>Data stream namespace.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.type</p></td>
<td align="left" valign="top"><p>Data stream type.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.containerized</p></td>
<td align="left" valign="top"><p>If the host is a container.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.build</p></td>
<td align="left" valign="top"><p>OS build information.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.codename</p></td>
<td align="left" valign="top"><p>OS codename, if any.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.active.users.exchange.active.count</p></td>
<td align="left" valign="top"><p>Number of Exchange active users.</p></td>
<td align="left" valign="top"><p>integer</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.active.users.exchange.inactive.count</p></td>
<td align="left" valign="top"><p>Number of Exchange inactive users.</p></td>
<td align="left" valign="top"><p>integer</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.active.users.office365.active.count</p></td>
<td align="left" valign="top"><p>Number of Office 365 active users.</p></td>
<td align="left" valign="top"><p>integer</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.active.users.office365.inactive.count</p></td>
<td align="left" valign="top"><p>Number of Office 365 inactive users.</p></td>
<td align="left" valign="top"><p>integer</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.active.users.onedrive.active.count</p></td>
<td align="left" valign="top"><p>Number of OneDrive active users.</p></td>
<td align="left" valign="top"><p>integer</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.active.users.onedrive.inactive.count</p></td>
<td align="left" valign="top"><p>Number of OneDrive inactive users.</p></td>
<td align="left" valign="top"><p>integer</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.active.users.report.period.day</p></td>
<td align="left" valign="top"><p>Report period in days.</p></td>
<td align="left" valign="top"><p>integer</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.active.users.report.refresh_date</p></td>
<td align="left" valign="top"><p>Date when the report was refreshed.</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.active.users.sharepoint.active.count</p></td>
<td align="left" valign="top"><p>Number of SharePoint active users.</p></td>
<td align="left" valign="top"><p>integer</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.active.users.sharepoint.inactive.count</p></td>
<td align="left" valign="top"><p>Number of SharePoint inactive users.</p></td>
<td align="left" valign="top"><p>integer</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.active.users.teams.active.count</p></td>
<td align="left" valign="top"><p>Number of Teams active users.</p></td>
<td align="left" valign="top"><p>integer</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.active.users.teams.inactive.count</p></td>
<td align="left" valign="top"><p>Number of Teams inactive users.</p></td>
<td align="left" valign="top"><p>integer</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.active.users.yammer.active.count</p></td>
<td align="left" valign="top"><p>Number of Yammer active users.</p></td>
<td align="left" valign="top"><p>integer</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.active.users.yammer.inactive.count</p></td>
<td align="left" valign="top"><p>Number of Yammer inactive users.</p></td>
<td align="left" valign="top"><p>integer</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
<div class="position-relative"><h5><a id="o365_metrics-yammer-device-usage"></a>Yammer Device Usage</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/o365_metrics/index.asciidoc">edit</a></div>
<details>
<summary class="title"><span class="strong strong"><strong>Example</strong></span></summary>
<div class="content">
<p>An example event for <code class="literal">yammer_device_usage</code> looks as following:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
    "o365": {
        "metrics": {
            "yammer": {
                "device": {
                    "usage": {
                        "other": {
                            "count": "1"
                        },
                        "windows_phone": {
                            "count": "2"
                        },
                        "web": {
                            "count": "3"
                        },
                        "report": {
                            "date": "2024-12-18",
                            "period": {
                                "day": "7"
                            },
                            "refresh_date": "2024-12-24"
                        },
                        "ipad": {
                            "count": "5"
                        },
                        "android_phone": {
                            "count": "3"
                        },
                        "iphone": {
                            "count": "1"
                        }
                    }
                }
            }
        }
    },
    "agent": {
        "name": "docker-fleet-agent",
        "id": "2f0e797b-2ccc-4639-b6f4-f1d3647cf01d",
        "type": "filebeat",
        "ephemeral_id": "131c1ad1-8f88-4dff-b6f9-d1bd298cb934",
        "version": "8.16.0"
    },
    "@timestamp": "2024-12-26T12:42:17.877Z",
    "ecs": {
        "version": "8.16.0"
    },
    "data_stream": {
        "namespace": "default",
        "type": "metrics",
        "dataset": "o365_metrics.yammer_device_usage"
    },
    "elastic_agent": {
        "id": "2f0e797b-2ccc-4639-b6f4-f1d3647cf01d",
        "version": "8.16.0",
        "snapshot": false
    },
    "host": {
        "hostname": "docker-fleet-agent",
        "os": {
            "kernel": "5.10.104-linuxkit",
            "name": "Wolfi",
            "type": "linux",
            "family": "",
            "version": "20230201",
            "platform": "wolfi"
        },
        "ip": [
            "192.168.144.7"
        ],
        "containerized": false,
        "name": "docker-fleet-agent",
        "mac": [
            "02-42-C0-A8-90-07"
        ],
        "architecture": "aarch64"
    },
    "event": {
        "agent_id_status": "verified",
        "ingested": "2024-12-26T12:42:18Z",
        "dataset": "o365_metrics.yammer_device_usage"
    },
    "tags": [
        "o365metrics-yammer_device_usage"
    ]
}</pre>
</div>
</div>
</details>
<p><span class="strong strong"><strong>ECS Field Reference</strong></span></p>
<p>Please refer to the following <a href="/guide/en/ecs/current/ecs-field-reference.html" class="ulink" target="_top">document</a> for detailed information on ECS fields.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Exported fields</strong></span></summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Field</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Unit</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>@timestamp</p></td>
<td align="left" valign="top"><p>Event timestamp.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cloud.image.id</p></td>
<td align="left" valign="top"><p>Image ID for the cloud instance.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.dataset</p></td>
<td align="left" valign="top"><p>Data stream dataset.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.namespace</p></td>
<td align="left" valign="top"><p>Data stream namespace.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.type</p></td>
<td align="left" valign="top"><p>Data stream type.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.containerized</p></td>
<td align="left" valign="top"><p>If the host is a container.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.build</p></td>
<td align="left" valign="top"><p>OS build information.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.codename</p></td>
<td align="left" valign="top"><p>OS codename, if any.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.yammer.device.usage.android_phone.count</p></td>
<td align="left" valign="top"><p>The count of users accessing Yammer on Android phones.</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.yammer.device.usage.ipad.count</p></td>
<td align="left" valign="top"><p>The count of users accessing Yammer on iPads.</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.yammer.device.usage.iphone.count</p></td>
<td align="left" valign="top"><p>The count of users accessing Yammer on iPhones.</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.yammer.device.usage.other.count</p></td>
<td align="left" valign="top"><p>The count of users accessing Yammer on devices not listed.</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.yammer.device.usage.report.date</p></td>
<td align="left" valign="top"><p>The specific date for which the report data applies.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.yammer.device.usage.report.period.day</p></td>
<td align="left" valign="top"><p>The duration (e.g., 7 days) over which the quota status data is aggregated.</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p>d</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.yammer.device.usage.report.refresh_date</p></td>
<td align="left" valign="top"><p>The date when the report data was last updated.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.yammer.device.usage.web.count</p></td>
<td align="left" valign="top"><p>The count of users accessing Yammer via web browsers.</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.yammer.device.usage.windows_phone.count</p></td>
<td align="left" valign="top"><p>The count of users accessing Yammer on Windows Phone devices.</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
<div class="position-relative"><h5><a id="o365_metrics-sharepoint-site-usage"></a>SharePoint Site Usage</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/o365_metrics/index.asciidoc">edit</a></div>
<details>
<summary class="title"><span class="strong strong"><strong>Example</strong></span></summary>
<div class="content">
<p>An example event for <code class="literal">sharepoint_site_usage</code> looks as following:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
    "o365metrics": {
        "sharepoint": {
            "site": {
                "usage": {
                    "storage": {
                        "report": {
                            "date": "2024-12-25",
                            "period": "7",
                            "refresh_date": "2024-12-25"
                        },
                        "storage_used": {
                            "byte": "1942032506"
                        }
                    }
                }
            }
        }
    },
    "agent": {
        "name": "docker-fleet-agent",
        "id": "027b7b81-b3c6-49b9-8f61-1a5e892e7bfe",
        "ephemeral_id": "f4133cae-978e-44e1-83e0-cab27e682a99",
        "type": "filebeat",
        "version": "8.16.0"
    },
    "@timestamp": "2024-12-26T23:18:42.620Z",
    "ecs": {
        "version": "8.16.0"
    },
    "data_stream": {
        "namespace": "default",
        "type": "metrics",
        "dataset": "o365_metrics.sharepoint_site_usage"
    },
    "host": {
        "hostname": "docker-fleet-agent",
        "os": {
            "kernel": "5.15.153.1-microsoft-standard-WSL2",
            "codename": "noble",
            "name": "Ubuntu",
            "type": "linux",
            "family": "debian",
            "version": "24.04.1 LTS (Noble Numbat)",
            "platform": "ubuntu"
        },
        "containerized": true,
        "ip": [
            "172.18.0.7"
        ],
        "name": "docker-fleet-agent",
        "mac": [
            "02-42-AC-12-00-07"
        ],
        "architecture": "x86_64"
    },
    "elastic_agent": {
        "id": "027b7b81-b3c6-49b9-8f61-1a5e892e7bfe",
        "version": "8.16.0",
        "snapshot": false
    },
    "event": {
        "agent_id_status": "verified",
        "ingested": "2024-12-26T23:18:52Z",
        "dataset": "o365_metrics.sharepoint_site_usage"
    },
    "tags": [
        "o365.metrics.sharepoint_site_usage"
    ]
}</pre>
</div>
</div>
</details>
<p><span class="strong strong"><strong>ECS Field Reference</strong></span></p>
<p>Please refer to the following <a href="/guide/en/ecs/current/ecs-field-reference.html" class="ulink" target="_top">document</a> for detailed information on ECS fields.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Exported fields</strong></span></summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Field</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>@timestamp</p></td>
<td align="left" valign="top"><p>Event timestamp.</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cloud.image.id</p></td>
<td align="left" valign="top"><p>Image ID for the cloud instance.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.dataset</p></td>
<td align="left" valign="top"><p>Data stream dataset.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.namespace</p></td>
<td align="left" valign="top"><p>Data stream namespace.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.type</p></td>
<td align="left" valign="top"><p>Data stream type.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.containerized</p></td>
<td align="left" valign="top"><p>If the host is a container.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.build</p></td>
<td align="left" valign="top"><p>OS build information.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.codename</p></td>
<td align="left" valign="top"><p>OS codename, if any.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365metrics.sharepoint.site.usage.detail.active_file.count</p></td>
<td align="left" valign="top"><p>The number of active files in the SharePoint site during the reporting period.</p></td>
<td align="left" valign="top"><p>integer</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365metrics.sharepoint.site.usage.detail.file.count</p></td>
<td align="left" valign="top"><p>The total number of files in the SharePoint site.</p></td>
<td align="left" valign="top"><p>integer</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365metrics.sharepoint.site.usage.detail.page_view.count</p></td>
<td align="left" valign="top"><p>The number of page views in the SharePoint site during the reporting period.</p></td>
<td align="left" valign="top"><p>integer</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365metrics.sharepoint.site.usage.detail.report.period</p></td>
<td align="left" valign="top"><p>The duration of the reporting period for SharePoint site usage, in days.</p></td>
<td align="left" valign="top"><p>integer</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365metrics.sharepoint.site.usage.detail.report.refresh_date</p></td>
<td align="left" valign="top"><p>The date when the SharePoint site usage data was last refreshed.</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365metrics.sharepoint.site.usage.detail.storage_allocated.byte</p></td>
<td align="left" valign="top"><p>The amount of storage allocated to the SharePoint site, in bytes.</p></td>
<td align="left" valign="top"><p>integer</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365metrics.sharepoint.site.usage.detail.storage_used.byte</p></td>
<td align="left" valign="top"><p>The amount of storage used in the SharePoint site, in bytes.</p></td>
<td align="left" valign="top"><p>integer</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365metrics.sharepoint.site.usage.detail.visited_page.count</p></td>
<td align="left" valign="top"><p>The number of visited pages in the SharePoint site during the reporting period.</p></td>
<td align="left" valign="top"><p>integer</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365metrics.sharepoint.site.usage.storage.report.date</p></td>
<td align="left" valign="top"><p>The date the SharePoint site storage usage report was generated.</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365metrics.sharepoint.site.usage.storage.report.period</p></td>
<td align="left" valign="top"><p>The duration of the reporting period for SharePoint site storage usage, in days.</p></td>
<td align="left" valign="top"><p>integer</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365metrics.sharepoint.site.usage.storage.report.refresh_date</p></td>
<td align="left" valign="top"><p>The date when the SharePoint site storage usage data was last refreshed.</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365metrics.sharepoint.site.usage.storage.storage_used.byte</p></td>
<td align="left" valign="top"><p>The total storage used across SharePoint sites during the reporting period, in bytes.</p></td>
<td align="left" valign="top"><p>integer</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
<div class="position-relative"><h5><a id="o365_metrics-teams-user-activity-user-counts"></a>Teams User Activity User Counts</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/o365_metrics/index.asciidoc">edit</a></div>
<details>
<summary class="title"><span class="strong strong"><strong>Example</strong></span></summary>
<div class="content">
<p>An example event for <code class="literal">teams_user_activity_user_counts</code> looks as following:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
    "o365": {
        "metrics": {
            "teams": {
                "user": {
                    "activity": {
                        "user": {
                            "counts": {
                                "other_actions": {
                                    "count": 0
                                },
                                "calls": {
                                    "count": 0
                                },
                                "private_chat_messages": {
                                    "count": 0
                                },
                                "report": {
                                    "date": "2025-01-13",
                                    "period": {
                                        "day": "7"
                                    },
                                    "refresh_date": "2025-01-19"
                                },
                                "meetings": {
                                    "count": 0
                                },
                                "team_chat_messages": {
                                    "count": 0
                                }
                            }
                        }
                    }
                }
            }
        }
    },
    "agent": {
        "name": "docker-fleet-agent",
        "id": "584e4497-cd3a-4e6f-b4b7-91889923e4e2",
        "type": "filebeat",
        "ephemeral_id": "9beddad6-b97a-43a4-8bd0-ac371e54deb9",
        "version": "8.16.0"
    },
    "@timestamp": "2025-01-13",
    "ecs": {
        "version": "8.16.0"
    },
    "data_stream": {
        "namespace": "default",
        "type": "metrics",
        "dataset": "o365_metrics.teams_user_activity_user_counts"
    },
    "elastic_agent": {
        "id": "584e4497-cd3a-4e6f-b4b7-91889923e4e2",
        "version": "8.16.0",
        "snapshot": false
    },
    "host": {
        "hostname": "docker-fleet-agent",
        "os": {
            "kernel": "5.10.104-linuxkit",
            "name": "Wolfi",
            "family": "",
            "type": "linux",
            "version": "20230201",
            "platform": "wolfi"
        },
        "containerized": false,
        "ip": [
            "172.27.0.7"
        ],
        "name": "docker-fleet-agent",
        "mac": [
            "02-42-AC-1B-00-07"
        ],
        "architecture": "aarch64"
    },
    "event": {
        "agent_id_status": "verified",
        "ingested": "2025-01-21T12:25:43Z",
        "dataset": "o365_metrics.teams_user_activity_user_counts"
    },
    "tags": [
        "o365.metrics.teams.user.activity.user.counts"
    ]
}</pre>
</div>
</div>
</details>
<p><span class="strong strong"><strong>ECS Field Reference</strong></span></p>
<p>Please refer to the following <a href="/guide/en/ecs/current/ecs-field-reference.html" class="ulink" target="_top">document</a> for detailed information on ECS fields.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Exported fields</strong></span></summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Field</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Unit</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>@timestamp</p></td>
<td align="left" valign="top"><p>Event timestamp.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cloud.image.id</p></td>
<td align="left" valign="top"><p>Image ID for the cloud instance.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.dataset</p></td>
<td align="left" valign="top"><p>Data stream dataset.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.namespace</p></td>
<td align="left" valign="top"><p>Data stream namespace.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.type</p></td>
<td align="left" valign="top"><p>Data stream type.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.containerized</p></td>
<td align="left" valign="top"><p>If the host is a container.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.build</p></td>
<td align="left" valign="top"><p>OS build information.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.codename</p></td>
<td align="left" valign="top"><p>OS codename, if any.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.user.activity.user.counts.calls.count</p></td>
<td align="left" valign="top"><p>The number of calls made by Teams users.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.user.activity.user.counts.meetings.count</p></td>
<td align="left" valign="top"><p>The number of meetings attended or organized by Teams users.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.user.activity.user.counts.other_actions.count</p></td>
<td align="left" valign="top"><p>The count of other user actions within Teams.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.user.activity.user.counts.private_chat_messages.count</p></td>
<td align="left" valign="top"><p>The number of messages sent in private 1:1 or group chats.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.user.activity.user.counts.report.date</p></td>
<td align="left" valign="top"><p>The specific date for which the report data applies.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.user.activity.user.counts.report.period.day</p></td>
<td align="left" valign="top"><p>The duration (e.g., 7 days) over which the report data is aggregated.</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p>d</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.user.activity.user.counts.report.refresh_date</p></td>
<td align="left" valign="top"><p>The date when the report data was last updated.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.user.activity.user.counts.team_chat_messages.count</p></td>
<td align="left" valign="top"><p>The number of messages sent in Teams channels.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
<div class="position-relative"><h4><a id="o365_metrics-changelog"></a>Changelog</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/o365_metrics/index.asciidoc">edit</a></div>
<details>
<summary class="title"><span class="strong strong"><strong>Changelog</strong></span></summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Version</th>
<th align="left" valign="top">Details</th>
<th align="left" valign="top">Kibana version(s)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.2.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/12219" class="ulink" target="_top">View pull request</a>)<br>
Add <code class="literal">teams_user_activity_user_counts</code> data stream.</p>
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/12201" class="ulink" target="_top">View pull request</a>)<br>
Add <code class="literal">yammer_device_usage</code> data stream.</p>
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/11934" class="ulink" target="_top">View pull request</a>)<br>
Add <code class="literal">active_users</code> data stream.</p>
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/11687" class="ulink" target="_top">View pull request</a>)<br>
Add <code class="literal">mailbox_quota_staus</code> and <code class="literal">outlook_app_usage</code> data streams.</p>
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/11935" class="ulink" target="_top">View pull request</a>)<br>
Add <code class="literal">sharepoint_site_usage</code> data stream.</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.1.2</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/11814" class="ulink" target="_top">View pull request</a>)<br>
Add <code class="literal">onedrive_usage</code> data stream.</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.1.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/11937" class="ulink" target="_top">View pull request</a>)<br>
Initial draft of the o365_metrics package with the <code class="literal">outlook_activity</code> data stream.</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="m365_defender.html">« M365 Defender integration</a>
</span>
<span class="next">
<a href="microsoft_sentinel.html">Microsoft Sentinel »</a>
</span>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>

                        <!-- Feedback widget -->
                        <div id="feedbackWidgetContainer"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


        <div id='elastic-footer'></div>
        <script src='https://www.elastic.co/elastic-footer.js'></script>
        <!-- Footer Section end-->

      </section>
    </div>

    <!-- Feedback modal -->
    <div id="feedbackModalContainer"></div>

    <script src="/guide/static/jquery.js"></script>
    <script type="text/javascript" src="/guide/static/docs-v1.js"></script>
    <script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
