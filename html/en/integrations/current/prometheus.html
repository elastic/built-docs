<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Prometheus Integration | Elastic integrations | Elastic</title>
<meta class="elastic" name="content" content="Prometheus Integration | Elastic integrations">

<link rel="home" href="index.html" title="Elastic integrations"/>
<link rel="up" href="prometheus-intro.html" title="Prometheus"/>
<link rel="prev" href="prometheus-intro.html" title="Prometheus"/>
<link rel="next" href="prometheus_input.html" title="Prometheus Input Package"/>
<meta class="elastic" name="product_version" content="main"/>
<meta class="elastic" name="product_name" content="Integrations"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Integrations/Reference"/>
<meta name="DC.subject" content="Integrations"/>
<meta name="DC.identifier" content="main"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles-v1.css" />
  </head>

  <!--© 2015-2025 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div class="navheader">
<span class="prev">
<a href="prometheus-intro.html">« Prometheus</a>
</span>
<span class="next">
<a href="prometheus_input.html">Prometheus Input Package »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic integrations</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="prometheus-intro.html">Prometheus</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Prometheus Integration</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/prometheus/index.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="prometheus"></a>Prometheus Integration</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/prometheus/index.asciidoc">edit</a></div>
</div></div></div>

<div class="condensed-table">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<tbody>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Version</strong></span></p></td>
<td align="left" valign="top"><p>1.23.0 (<a class="xref" href="prometheus.html#prometheus-changelog" title="Changelog">View all</a>)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Compatible Kibana version(s)</strong></span></p></td>
<td align="left" valign="top"><p>8.16.0 or higher<br>
9.0.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Supported Serverless project types</strong></span><br>
 <a class="xref" href="serverless-support.html" title="Supported Serverless project types"><span class="small">What&#8217;s this?</span></a></p></td>
<td align="left" valign="top"><p>Security<br>
Observability</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Subscription level</strong></span><br>
<a href="/subscriptions" class="ulink" target="_top"><span class="small">What&#8217;s this?</span></a></p></td>
<td align="left" valign="top"><p>Basic</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Level of support</strong></span><br>
<a class="xref" href="support.html" title="Level of support"><span class="small">What&#8217;s this?</span></a></p></td>
<td align="left" valign="top"><p>Elastic</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>This integration can collect metrics from:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="prometheus.html#prometheus-prometheus-exporters-collectors" title="Prometheus Exporters (Collectors)">Prometheus Exporters (Collectors)</a>
</li>
<li class="listitem">
<a class="xref" href="prometheus.html#prometheus-prometheus-server-remote-write" title="Prometheus Server Remote-Write">Prometheus Server Remote-Write</a>
</li>
<li class="listitem">
<a class="xref" href="prometheus.html#prometheus-prometheus-queries-promql" title="Prometheus Queries (PromQL)">Prometheus Queries (PromQL)</a>
</li>
</ul>
</div>
<div class="position-relative"><h4><a id="prometheus-metrics"></a>Metrics</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/prometheus/index.asciidoc">edit</a></div>
<div class="position-relative"><h5><a id="prometheus-prometheus-exporters-collectors"></a>Prometheus Exporters (Collectors)</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/prometheus/index.asciidoc">edit</a></div>
<p>The Prometheus integration <code class="literal">collector</code> dataset connects to the Prometheus server and pulls metrics using either the <code class="literal">/metrics</code> endpoint or the <a href="https://prometheus.io/docs/prometheus/latest/federation/" class="ulink" target="_top">Prometheus Federation API</a>.</p>
<div class="position-relative"><h6><a id="prometheus-scraping-from-a-prometheus-exporter"></a>Scraping from a Prometheus exporter</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/prometheus/index.asciidoc">edit</a></div>
<p>To scrape metrics from a Prometheus exporter, configure the <code class="literal">hosts</code> setting to it. The path
to retrieve the metrics from (<code class="literal">/metrics</code> by default) can be configured with Metrics Path.</p>
<div class="position-relative"><h6><a id="prometheus-histograms-and-types"></a>Histograms and types</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/prometheus/index.asciidoc">edit</a></div>
<p><code class="literal">Use Types</code> parameter (default: true) enables a different layout for metrics storage, leveraging Elasticsearch
types, including <a href="/guide/en/elasticsearch/reference/current/histogram.html" class="ulink" target="_top">histograms</a>.</p>
<p><code class="literal">Rate Counters</code> parameter (default: true) enables calculating a rate out of Prometheus counters. When enabled, Elastic Agent stores
the counter increment since the last collection. This metric should make some aggregations easier and with better
performance. This parameter can only be enabled in combination with <code class="literal">Use Types</code>.</p>
<p>When <code class="literal">Use Types</code> and <code class="literal">Rate Counters</code> are enabled, metrics are stored like this:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
  "_index": ".ds-metrics-prometheus.collector-default-000001",
  "_id": "JlK9AHMBeyDc0b9rCwVA",
  "_version": 1,
  "_score": null,
  "_source": {
    "@timestamp": "2020-06-29T15:40:55.028Z",
    "prometheus": {
      "labels": {
        "slice": "inner_eval",
        "instance": "localhost:9090",
        "job": "prometheus"
      },
      "prometheus_engine_query_duration_seconds_sum": {
        "counter": 0.002697546,
        "rate": 0.00006945900000000001
      },
      "prometheus_engine_query_duration_seconds_count": {
        "rate": 1,
        "counter": 37
      }
    },
    "dataset": {
      "type": "metrics",
      "name": "prometheus.collector",
      "namespace": "default"
    },
    "agent": {
      "ephemeral_id": "98420e91-ee6d-4883-8ad3-02fa8d47f5c1",
      "id": "9fc3e975-6789-4738-a11a-ba7108b0a92c",
      "name": "minikube",
      "type": "metricbeat",
      "version": "8.0.0"
    },
    "ecs": {
      "version": "1.5.0"
    },
    "event": {
      "module": "prometheus",
      "duration": 15397122,
      "dataset": "prometheus.collector"
    },
    "metricset": {
      "period": 10000,
      "name": "collector"
    },
    "service": {
      "address": "localhost:9090",
      "type": "prometheus"
    },
    "stream": {
      "namespace": "default",
      "type": "metrics",
      "dataset": "prometheus.collector"
    },
    "host": {},
  },
  "fields": {
    "@timestamp": [
      "2020-06-29T15:40:55.028Z"
    ]
  },
  "highlight": {
    "event.dataset": [
      "@kibana-highlighted-field@prometheus.collector@/kibana-highlighted-field@"
    ]
  },
  "sort": [
    1593445255028
  ]
}</pre>
</div>
<div class="position-relative"><h6><a id="prometheus-metrics-count"></a>Metrics count</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/prometheus/index.asciidoc">edit</a></div>
<p>The Prometheus integration&#8217;s <code class="literal">collector</code> dataset provides a <code class="literal">Metrics Count</code> parameter, which is disabled by default. When enabled, it counts the total number of Prometheus metrics within each Elasticsearch document. This count is stored in a field called <code class="literal">metrics_count</code> and its value is calculated prior to any enrichments by Ingest Pipelines or Agent Processors, ensuring consistency. This field name is reserved for internal use and must not be altered using Agent Processors or Ingest Pipelines.</p>
<div class="position-relative"><h6><a id="prometheus-scraping-all-metrics-from-a-prometheus-server"></a>Scraping all metrics from a Prometheus server</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/prometheus/index.asciidoc">edit</a></div>
<p>We recommend using the Remote Write dataset for this, and make Prometheus push metrics to Agent.</p>
<div class="position-relative"><h6><a id="prometheus-filtering-metrics"></a>Filtering metrics</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/prometheus/index.asciidoc">edit</a></div>
<p>In order to filter out/in metrics one can make use of <code class="literal">Metrics Filters Include</code>, <code class="literal">Metrics Filters Exclude</code> settings:</p>
<div class="pre_wrapper lang-yml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yml">Metrics Filters Include: ["node_filesystem_*"]
Metrics Filters Exclude: ["node_filesystem_device_*"]</pre>
</div>
<p>The configuration above will include only metrics that match <code class="literal">node_filesystem_*</code> pattern and do not match <code class="literal">node_filesystem_device_*</code>.</p>
<p>To keep only specific metrics, anchor the start and the end of the regexp of each metric:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
the caret ^ matches the beginning of a text or line,
</li>
<li class="listitem">
the dollar sign $ matches the end of a text.
</li>
</ul>
</div>
<div class="pre_wrapper lang-yml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yml">Metrics Filters Include: ["^node_network_net_dev_group$", "^node_network_up$"]</pre>
</div>
<details>
<summary class="title"><span class="strong strong"><strong>Example</strong></span></summary>
<div class="content">
<p>An example event for <code class="literal">collector</code> looks as following:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
    "@timestamp": "2024-08-20T08:38:11.185Z",
    "agent": {
        "ephemeral_id": "b9fad797-a22c-47be-b2f4-44c0a89b6c25",
        "id": "9822f27e-ae7c-4cee-98af-094356f8bf91",
        "name": "elastic-agent-35087",
        "type": "metricbeat",
        "version": "8.14.0"
    },
    "data_stream": {
        "dataset": "prometheus.collector",
        "namespace": "52976",
        "type": "metrics"
    },
    "ecs": {
        "version": "8.0.0"
    },
    "elastic_agent": {
        "id": "9822f27e-ae7c-4cee-98af-094356f8bf91",
        "snapshot": false,
        "version": "8.14.0"
    },
    "event": {
        "agent_id_status": "verified",
        "dataset": "prometheus.collector",
        "duration": 1958134070,
        "ingested": "2024-08-20T08:38:13Z",
        "module": "prometheus"
    },
    "host": {
        "architecture": "x86_64",
        "containerized": true,
        "hostname": "elastic-agent-35087",
        "id": "345c85cf1fe945e2b19719b370c09a48",
        "ip": [
            "192.168.241.8",
            "192.168.242.2"
        ],
        "mac": [
            "02-42-C0-A8-F1-08",
            "02-42-C0-A8-F2-02"
        ],
        "name": "elastic-agent-35087",
        "os": {
            "codename": "focal",
            "family": "debian",
            "kernel": "5.4.0-189-generic",
            "name": "Ubuntu",
            "platform": "ubuntu",
            "type": "linux",
            "version": "20.04.6 LTS (Focal Fossa)"
        }
    },
    "metricset": {
        "name": "collector",
        "period": 10000
    },
    "prometheus": {
        "labels": {
            "dialer_name": "alertmanager",
            "instance": "svc-prometheus:9090",
            "job": "prometheus"
        },
        "labels_fingerprint": "jn10I8M3W8CSQq1v0nbhVyegvgQ=",
        "net_conntrack_dialer_conn_attempted_total": {
            "counter": 0,
            "rate": 0
        },
        "net_conntrack_dialer_conn_closed_total": {
            "counter": 0,
            "rate": 0
        },
        "net_conntrack_dialer_conn_established_total": {
            "counter": 0,
            "rate": 0
        }
    },
    "service": {
        "address": "http://svc-prometheus:9090/metrics",
        "type": "prometheus"
    }
}</pre>
</div>
</div>
</details>
<p>The fields reported are:</p>
<p><span class="strong strong"><strong>ECS Field Reference</strong></span></p>
<p>Please refer to the following <a href="/guide/en/ecs/current/ecs-field-reference.html" class="ulink" target="_top">document</a> for detailed information on ECS fields.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Exported fields</strong></span></summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Field</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Metric Type</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>@timestamp</p></td>
<td align="left" valign="top"><p>Event timestamp.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>agent.id</p></td>
<td align="left" valign="top"><p>Unique identifier of this agent (if one exists). Example: For Beats this would be beat.id.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cloud.account.id</p></td>
<td align="left" valign="top"><p>The cloud account or organization id used to identify different entities in a multi-tenant environment.  Examples: AWS account id, Google Cloud ORG Id, or other unique identifier.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cloud.availability_zone</p></td>
<td align="left" valign="top"><p>Availability zone in which this host is running.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cloud.image.id</p></td>
<td align="left" valign="top"><p>Image ID for the cloud instance.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cloud.instance.id</p></td>
<td align="left" valign="top"><p>Instance ID of the host machine.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cloud.provider</p></td>
<td align="left" valign="top"><p>Name of the cloud provider. Example values are aws, azure, gcp, or digitalocean.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cloud.region</p></td>
<td align="left" valign="top"><p>Region in which this host is running.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>container.id</p></td>
<td align="left" valign="top"><p>Unique container id.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.dataset</p></td>
<td align="left" valign="top"><p>Data stream dataset.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.namespace</p></td>
<td align="left" valign="top"><p>Data stream namespace.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.type</p></td>
<td align="left" valign="top"><p>Data stream type.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>event.module</p></td>
<td align="left" valign="top"><p>Event module.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.containerized</p></td>
<td align="left" valign="top"><p>If the host is a container.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.name</p></td>
<td align="left" valign="top"><p>Name of the host.  It can contain what <code class="literal">hostname</code> returns on Unix systems, the fully qualified domain name, or a name specified by the user. The sender decides which value to use.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.build</p></td>
<td align="left" valign="top"><p>OS build information.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.codename</p></td>
<td align="left" valign="top"><p>OS codename, if any.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>metrics_count</p></td>
<td align="left" valign="top"><p>Total count of Prometheus metrics within the Elasticsearch document. This value is calculated prior to any enrichments by Ingest Pipelines or Agent Processors, ensuring consistency. This field name is reserved for internal use and must not be altered using Agent Processors or Ingest Pipelines.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>prometheus.*.counter</p></td>
<td align="left" valign="top"><p>Prometheus counter metric</p></td>
<td align="left" valign="top"><p>object</p></td>
<td align="left" valign="top"><p>counter</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>prometheus.*.histogram</p></td>
<td align="left" valign="top"><p>Prometheus histogram metric</p></td>
<td align="left" valign="top"><p>object</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>prometheus.*.rate</p></td>
<td align="left" valign="top"><p>Prometheus rated counter metric</p></td>
<td align="left" valign="top"><p>object</p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>prometheus.*.value</p></td>
<td align="left" valign="top"><p>Prometheus gauge metric</p></td>
<td align="left" valign="top"><p>object</p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>prometheus.labels.*</p></td>
<td align="left" valign="top"><p>Prometheus metric labels.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>prometheus.labels_fingerprint</p></td>
<td align="left" valign="top"><p>Autogenerated ID representing the fingerprint of labels object and includes query name.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>prometheus.metrics.*</p></td>
<td align="left" valign="top"><p>Prometheus metric</p></td>
<td align="left" valign="top"><p>object</p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>service.address</p></td>
<td align="left" valign="top"><p>Address where data about this service was collected from. This should be a URI, network address (ipv4:port or [ipv6]:port) or a resource path (sockets).</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
<div class="position-relative"><h5><a id="prometheus-prometheus-server-remote-write"></a>Prometheus Server Remote-Write</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/prometheus/index.asciidoc">edit</a></div>
<p>The Prometheus <code class="literal">remote_write</code> can receive metrics from a Prometheus server that
has configured <a href="https://prometheus.io/docs/prometheus/latest/configuration/configuration/#remote%5Fwrite" class="ulink" target="_top">remote_write</a>
setting accordingly, for instance:</p>
<div class="pre_wrapper lang-yml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yml">remote_write:
  - url: "http://localhost:9201/write"</pre>
</div>
<p>In Kuberneter additionally should be created a Service resource:</p>
<div class="pre_wrapper lang-yml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yml">---
apiVersion: v1
kind: Service
metadata:
  name: elastic-agent
  namespace: kube-system
  labels:
    app: elastic-agent
spec:
  ports:
    - port: 9201
      protocol: TCP
      targetPort: 9201
  selector:
    app: elastic-agent
  sessionAffinity: None
  type: ClusterIP</pre>
</div>
<p>This Service can be used as a <code class="literal">remote_write.url</code> in Prometheus configuration:</p>
<div class="pre_wrapper lang-yml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yml">remote_write:
  - url: "http://elastic-agent.kube-system:9201/write"</pre>
</div>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>In order to assure the health of the whole queue, the following configuration
<a href="https://prometheus.io/docs/practices/remote%5Fwrite/#parameters" class="ulink" target="_top">parameters</a> should be considered:</p>
</div>
</div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">max_shards</code>: Sets the maximum number of parallelism with which Prometheus will try to send samples to Elastic Agent.
It is recommended that this setting should be equal to the number of cores of the machine where Elastic Agent runs.
Elastic Agent can handle connections in parallel and hence setting <code class="literal">max_shards</code> to the number of parallelism that
Elastic Agent can actually achieve is the optimal queue configuration.
</li>
<li class="listitem">
<code class="literal">max_samples_per_send</code>: Sets the number of samples to batch together for each send. Recommended values are
between 100 (default) and 1000. Having a bigger batch can lead to improved throughput and in more efficient
storage since Elastic Agent groups metrics with the same labels into same event documents.
However this will increase the memory usage of Elastic Agent.
</li>
<li class="listitem">
<code class="literal">capacity</code>: It is recommended to set capacity to 3-5 times <code class="literal">max_samples_per_send</code>.
Capacity sets the number of samples that are queued in memory per shard, and hence capacity should be high enough so as to
be able to cover <code class="literal">max_samples_per_send</code>.
</li>
</ul>
</div>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>To limit amount of samples that are sent by the Prometheus Server can be used <a href="https://prometheus.io/docs/prometheus/latest/configuration/configuration/#remote%5Fwrite" class="ulink" target="_top"><code class="literal">write_relabel_configs</code></a>
configuration. It is a relabeling, that applies to samples before sending them to the remote endpoint. Example:</p>
</div>
</div>
<div class="pre_wrapper lang-txt">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-txt">remote_write:
  - url: "http://localhost:9201/write"
    write_relabel_configs:
      - source_labels: [job]
        regex: 'prometheus'
        action: keep</pre>
</div>
<p>Metrics sent to the http endpoint will be put by default under the <code class="literal">prometheus.</code> prefix with their labels under <code class="literal">prometheus.labels</code>.
A basic configuration would look like:</p>
<div class="pre_wrapper lang-yml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yml">host: "localhost"
port: "9201"</pre>
</div>
<p>Also consider using secure settings for the server, configuring the module with TLS/SSL as shown:</p>
<div class="pre_wrapper lang-yml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yml">host: "localhost"
ssl.certificate: "/etc/pki/server/cert.pem"
ssl.key: "/etc/pki/server/cert.key"
port: "9201"</pre>
</div>
<p>and on Prometheus side:</p>
<div class="pre_wrapper lang-yml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yml">remote_write:
  - url: "https://localhost:9201/write"
    tls_config:
        cert_file: "/etc/prometheus/my_key.pem"
        key_file: "/etc/prometheus/my_key.key"
        # Disable validation of the server certificate.
        #insecure_skip_verify: true</pre>
</div>
<details>
<summary class="title"><span class="strong strong"><strong>Example</strong></span></summary>
<div class="content">
<p>An example event for <code class="literal">remote_write</code> looks as following:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
    "@timestamp": "2022-09-22T12:23:35.757Z",
    "agent": {
        "ephemeral_id": "5c3d912b-9bf3-4747-b784-1f7c275a5979",
        "id": "af0df4c2-33b7-41fd-8eb5-573376996db2",
        "name": "kind-control-plane",
        "type": "metricbeat",
        "version": "8.4.0"
    },
    "data_stream": {
        "dataset": "prometheus.remote_write",
        "namespace": "default",
        "type": "metrics"
    },
    "ecs": {
        "version": "8.11.0"
    },
    "elastic_agent": {
        "id": "af0df4c2-33b7-41fd-8eb5-573376996db2",
        "snapshot": true,
        "version": "8.4.0"
    },
    "event": {
        "agent_id_status": "verified",
        "dataset": "prometheus.remote_write",
        "ingested": "2022-09-22T12:24:16Z",
        "module": "prometheus"
    },
    "host": {},
    "metricset": {
        "name": "remote_write"
    },
    "prometheus": {
        "labels": {
            "app": "prometheus",
            "app_kubernetes_io_managed_by": "Helm",
            "chart": "prometheus-15.10.1",
            "component": "node-exporter",
            "cpu": "5",
            "heritage": "Helm",
            "instance": "172.19.0.2:9100",
            "job": "kubernetes-service-endpoints",
            "mode": "user",
            "namespace": "kube-system",
            "node": "kind-control-plane",
            "release": "prometheus-server",
            "service": "prometheus-server-node-exporter"
        },
        "node_cpu_guest_seconds_total": {
            "counter": 0,
            "rate": 0
        },
        "node_cpu_seconds_total": {
            "counter": 2284.68,
            "rate": 0
        }
    },
    "service": {
        "type": "prometheus"
    }
}</pre>
</div>
</div>
</details>
<p>The fields reported are:</p>
<p><span class="strong strong"><strong>ECS Field Reference</strong></span></p>
<p>Please refer to the following <a href="/guide/en/ecs/current/ecs-field-reference.html" class="ulink" target="_top">document</a> for detailed information on ECS fields.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Exported fields</strong></span></summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Field</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Metric Type</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>@timestamp</p></td>
<td align="left" valign="top"><p>Event timestamp.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>agent.id</p></td>
<td align="left" valign="top"><p>Unique identifier of this agent (if one exists). Example: For Beats this would be beat.id.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cloud.account.id</p></td>
<td align="left" valign="top"><p>The cloud account or organization id used to identify different entities in a multi-tenant environment.  Examples: AWS account id, Google Cloud ORG Id, or other unique identifier.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cloud.availability_zone</p></td>
<td align="left" valign="top"><p>Availability zone in which this host is running.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cloud.image.id</p></td>
<td align="left" valign="top"><p>Image ID for the cloud instance.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cloud.instance.id</p></td>
<td align="left" valign="top"><p>Instance ID of the host machine.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cloud.provider</p></td>
<td align="left" valign="top"><p>Name of the cloud provider. Example values are aws, azure, gcp, or digitalocean.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cloud.region</p></td>
<td align="left" valign="top"><p>Region in which this host is running.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>container.id</p></td>
<td align="left" valign="top"><p>Unique container id.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.dataset</p></td>
<td align="left" valign="top"><p>Data stream dataset.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.namespace</p></td>
<td align="left" valign="top"><p>Data stream namespace.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.type</p></td>
<td align="left" valign="top"><p>Data stream type.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>event.module</p></td>
<td align="left" valign="top"><p>Event module.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.containerized</p></td>
<td align="left" valign="top"><p>If the host is a container.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.name</p></td>
<td align="left" valign="top"><p>Name of the host.  It can contain what <code class="literal">hostname</code> returns on Unix systems, the fully qualified domain name, or a name specified by the user. The sender decides which value to use.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.build</p></td>
<td align="left" valign="top"><p>OS build information.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.codename</p></td>
<td align="left" valign="top"><p>OS codename, if any.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>metrics_count</p></td>
<td align="left" valign="top"><p>Total count of Prometheus metrics within the Elasticsearch document. This value is calculated prior to any enrichments by Ingest Pipelines or Agent Processors, ensuring consistency. This field name is reserved for internal use and must not be altered using Agent Processors or Ingest Pipelines.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>prometheus.*.counter</p></td>
<td align="left" valign="top"><p>Prometheus counter metric</p></td>
<td align="left" valign="top"><p>object</p></td>
<td align="left" valign="top"><p>counter</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>prometheus.*.histogram</p></td>
<td align="left" valign="top"><p>Prometheus histogram metric</p></td>
<td align="left" valign="top"><p>object</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>prometheus.*.rate</p></td>
<td align="left" valign="top"><p>Prometheus rated counter metric</p></td>
<td align="left" valign="top"><p>object</p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>prometheus.*.value</p></td>
<td align="left" valign="top"><p>Prometheus gauge metric</p></td>
<td align="left" valign="top"><p>object</p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>prometheus.labels.*</p></td>
<td align="left" valign="top"><p>Prometheus metric labels.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>prometheus.labels_fingerprint</p></td>
<td align="left" valign="top"><p>Autogenerated ID representing the fingerprint of labels object and includes query name.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>prometheus.metrics.*</p></td>
<td align="left" valign="top"><p>Prometheus metric</p></td>
<td align="left" valign="top"><p>object</p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>prometheus.metrics_names_fingerprint</p></td>
<td align="left" valign="top"><p>Autogenerated ID representing the fingerprint of the list of metrics names</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
<div class="position-relative"><h6><a id="_histograms_and_types"></a>Histograms and types</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/prometheus/index.asciidoc">edit</a></div>
<p><code class="literal">use_types</code> parameter (default: true) enables a different layout for metrics storage, leveraging Elasticsearch
types, including <a href="/guide/en/elasticsearch/reference/current/histogram.html" class="ulink" target="_top">histograms</a>.</p>
<p><code class="literal">rate_counters</code> parameter (default: true) enables calculating a rate out of Prometheus counters. When enabled, Elastic Agent stores
the counter increment since the last collection. This metric should make some aggregations easier and with better
performance. This parameter can only be enabled in combination with <code class="literal">use_types</code>.</p>
<p><code class="literal">period</code> parameter (default: 60s) configures the timeout of internal cache, which stores counter values in order to calculate rates between consecutive fetches. The parameter will be validated and all values lower than 60sec will be reset to the default value.</p>
<p>Note that by default prometheus pushes data with the interval of 60s (in remote write). In case that prometheus push rate is changed, the <code class="literal">period</code> parameter needs to be configured accordingly.</p>
<p>When <code class="literal">use_types</code> and <code class="literal">rate_counters</code> are enabled, metrics are stored like this:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
    "prometheus": {
        "labels": {
            "instance": "172.27.0.2:9090",
            "job": "prometheus"
        },
        "prometheus_target_interval_length_seconds_count": {
            "counter": 1,
            "rate": 0
        },
        "prometheus_target_interval_length_seconds_sum": {
            "counter": 15.000401344,
            "rate": 0
        }
        "prometheus_tsdb_compaction_chunk_range_seconds_bucket": {
            "histogram": {
                "values": [50, 300, 1000, 4000, 16000],
                "counts": [10, 2, 34, 7]
            }
        }
    },
}</pre>
</div>
<div class="position-relative"><h6><a id="prometheus-types-patterns"></a>Types' patterns</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/prometheus/index.asciidoc">edit</a></div>
<p>Unlike <code class="literal">collector</code> metricset, <code class="literal">remote_write</code> receives metrics in raw format from the prometheus server.
In this, the module has to internally use a heuristic in order to identify efficiently the type of each raw metric.
For these purpose some name patterns are used in order to identify the type of each metric.
The default patterns are the following:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<code class="literal">_total</code> suffix: the metric is of Counter type
</li>
<li class="listitem">
<code class="literal">_sum</code> suffix: the metric is of Counter type
</li>
<li class="listitem">
<code class="literal">_count</code> suffix: the metric is of Counter type
</li>
<li class="listitem">
<code class="literal">_bucket</code> suffix and <code class="literal">le</code> in labels: the metric is of Histogram type
</li>
</ol>
</div>
<p>Everything else is handled as a Gauge. In addition there is no special handling for Summaries so it is expected that
Summary&#8217;s quantiles are handled as Gauges and Summary&#8217;s sum and count as Counters.</p>
<p>Users have the flexibility to add their own patterns using the following configuration:</p>
<div class="pre_wrapper lang-yml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yml">types_patterns:
    counter_patterns: ["_my_counter_suffix"]
    histogram_patterns: ["_my_histogram_suffix"]</pre>
</div>
<p>The configuration above will consider metrics with names that match <code class="literal">_my_counter_suffix</code> as Counters
and those that match <code class="literal">_my_histogram_suffix</code> (and have <code class="literal">le</code> in their labels) as Histograms.</p>
<p>To match only specific metrics, anchor the start and the end of the regexp of each metric:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
the caret <code class="literal">^</code> matches the beginning of a text or line,
</li>
<li class="listitem">
the dollar sign <code class="literal">$</code> matches the end of a text.
</li>
</ul>
</div>
<div class="pre_wrapper lang-yml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yml">types_patterns:
    histogram_patterns: ["^my_histogram_metric$"]</pre>
</div>
<p>Note that when using <code class="literal">types_patterns</code>, the provided patterns have higher priority than the default patterns.
For instance if <code class="literal">_histogram_total</code> is a defined histogram pattern, then a metric like <code class="literal">network_bytes_histogram_total</code>
will be handled as a histogram, even if it has the suffix <code class="literal">_total</code> which is a default pattern for counters.</p>
<div class="position-relative"><h6><a id="_metrics_count"></a>Metrics count</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/prometheus/index.asciidoc">edit</a></div>
<p>The Prometheus integration&#8217;s <code class="literal">remote_write</code> dataset provides a <code class="literal">Metrics Count</code> parameter, which is disabled by default. When enabled, it counts the total number of Prometheus metrics within each Elasticsearch document. This count is stored in a field called <code class="literal">metrics_count</code> and its value is calculated prior to any enrichments by Ingest Pipelines or Agent Processors, ensuring consistency. This field name is reserved for internal use and must not be altered using Agent Processors or Ingest Pipelines.</p>
<div class="position-relative"><h5><a id="prometheus-prometheus-queries-promql"></a>Prometheus Queries (PromQL)</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/prometheus/index.asciidoc">edit</a></div>
<p>The Prometheus <code class="literal">query</code> dataset executes specific Prometheus queries against <a href="https://prometheus.io/docs/prometheus/latest/querying/api/#expression-queries" class="ulink" target="_top">Promethes Query API</a>.</p>
<div class="position-relative"><h6><a id="prometheus-instant-queries"></a>Instant queries</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/prometheus/index.asciidoc">edit</a></div>
<p>The following configuration performs an instant query for <code class="literal">up</code> metric at a single point in time:</p>
<div class="pre_wrapper lang-yml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yml">queries:
- name: 'up'
  path: '/api/v1/query'
  params:
    query: "up"</pre>
</div>
<p>More complex PromQL expressions can also be used like the following one which calculates the per-second rate of HTTP
requests as measured over the last 5 minutes.</p>
<div class="pre_wrapper lang-yml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yml">queries:
- name: "rate_http_requests_total"
  path: "/api/v1/query"
  params:
    query: "rate(prometheus_http_requests_total[5m])"</pre>
</div>
<div class="position-relative"><h6><a id="prometheus-range-queries"></a>Range queries</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/prometheus/index.asciidoc">edit</a></div>
<p>The following example evaluates the expression <code class="literal">up</code> over a 30-second range with a query resolution of 15 seconds:</p>
<div class="pre_wrapper lang-yml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yml">queries:
- name: "up_master"
  path: "/api/v1/query_range"
  params:
    query: "up{node='master01'}"
    start: "2019-12-20T23:30:30.000Z"
    end: "2019-12-21T23:31:00.000Z"
    step: 15s</pre>
</div>
<details>
<summary class="title"><span class="strong strong"><strong>Example</strong></span></summary>
<div class="content">
<p>An example event for <code class="literal">query</code> looks as following:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
    "@timestamp": "2024-08-20T08:39:07.000Z",
    "agent": {
        "ephemeral_id": "cc18c40d-dcb8-4192-aede-e988d68c376c",
        "id": "842b000b-c1bd-4608-bbd8-2a1849afc2f5",
        "name": "elastic-agent-31805",
        "type": "metricbeat",
        "version": "8.14.0"
    },
    "data_stream": {
        "dataset": "prometheus.query",
        "namespace": "54564",
        "type": "metrics"
    },
    "ecs": {
        "version": "8.0.0"
    },
    "elastic_agent": {
        "id": "842b000b-c1bd-4608-bbd8-2a1849afc2f5",
        "snapshot": false,
        "version": "8.14.0"
    },
    "event": {
        "agent_id_status": "verified",
        "dataset": "prometheus.query",
        "duration": 6078736,
        "ingested": "2024-08-20T08:39:10Z",
        "module": "prometheus"
    },
    "host": {
        "architecture": "x86_64",
        "containerized": true,
        "hostname": "elastic-agent-31805",
        "id": "345c85cf1fe945e2b19719b370c09a48",
        "ip": [
            "192.168.241.8",
            "192.168.242.2"
        ],
        "mac": [
            "02-42-C0-A8-F1-08",
            "02-42-C0-A8-F2-02"
        ],
        "name": "elastic-agent-31805",
        "os": {
            "codename": "focal",
            "family": "debian",
            "kernel": "5.4.0-189-generic",
            "name": "Ubuntu",
            "platform": "ubuntu",
            "type": "linux",
            "version": "20.04.6 LTS (Focal Fossa)"
        }
    },
    "metricset": {
        "name": "query",
        "period": 10000
    },
    "prometheus": {
        "labels": {
            "query_name": "scalar"
        },
        "labels_fingerprint": "uE8iX47vrW1H38mLYMD73p8/CcA=",
        "query": {
            "scalar": 100
        }
    },
    "service": {
        "address": "http://svc-prometheus:9090",
        "type": "prometheus"
    }
}</pre>
</div>
</div>
</details>
<p>The fields reported are:</p>
<p><span class="strong strong"><strong>ECS Field Reference</strong></span></p>
<p>Please refer to the following <a href="/guide/en/ecs/current/ecs-field-reference.html" class="ulink" target="_top">document</a> for detailed information on ECS fields.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Exported fields</strong></span></summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Field</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Metric Type</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>@timestamp</p></td>
<td align="left" valign="top"><p>Event timestamp.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>agent.id</p></td>
<td align="left" valign="top"><p>Unique identifier of this agent (if one exists). Example: For Beats this would be beat.id.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cloud.account.id</p></td>
<td align="left" valign="top"><p>The cloud account or organization id used to identify different entities in a multi-tenant environment.  Examples: AWS account id, Google Cloud ORG Id, or other unique identifier.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cloud.availability_zone</p></td>
<td align="left" valign="top"><p>Availability zone in which this host is running.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cloud.image.id</p></td>
<td align="left" valign="top"><p>Image ID for the cloud instance.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cloud.instance.id</p></td>
<td align="left" valign="top"><p>Instance ID of the host machine.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cloud.provider</p></td>
<td align="left" valign="top"><p>Name of the cloud provider. Example values are aws, azure, gcp, or digitalocean.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cloud.region</p></td>
<td align="left" valign="top"><p>Region in which this host is running.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>container.id</p></td>
<td align="left" valign="top"><p>Unique container id.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.dataset</p></td>
<td align="left" valign="top"><p>Data stream dataset.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.namespace</p></td>
<td align="left" valign="top"><p>Data stream namespace.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.type</p></td>
<td align="left" valign="top"><p>Data stream type.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>event.module</p></td>
<td align="left" valign="top"><p>Event module.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.containerized</p></td>
<td align="left" valign="top"><p>If the host is a container.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.name</p></td>
<td align="left" valign="top"><p>Name of the host.  It can contain what <code class="literal">hostname</code> returns on Unix systems, the fully qualified domain name, or a name specified by the user. The sender decides which value to use.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.build</p></td>
<td align="left" valign="top"><p>OS build information.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.codename</p></td>
<td align="left" valign="top"><p>OS codename, if any.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>prometheus.labels.*</p></td>
<td align="left" valign="top"><p>Prometheus metric labels.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>prometheus.labels_fingerprint</p></td>
<td align="left" valign="top"><p>Autogenerated ID representing the fingerprint of labels object and includes query name.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>prometheus.query.*</p></td>
<td align="left" valign="top"><p>Prometheus value resulted from PromQL</p></td>
<td align="left" valign="top"><p>object</p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>service.address</p></td>
<td align="left" valign="top"><p>Address where data about this service was collected from. This should be a URI, network address (ipv4:port or [ipv6]:port) or a resource path (sockets).</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
<div class="position-relative"><h4><a id="prometheus-dashboard"></a>Dashboard</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/prometheus/index.asciidoc">edit</a></div>
<p>Prometheus integration is shipped including default overview dashboard.
Default dashboard works only for <code class="literal">remote_write</code> datastream and <code class="literal">collector</code> datastream, if metrics are scraped from the Prometheus server metrics endpoint.</p>
<div class="position-relative"><h4><a id="prometheus-changelog"></a>Changelog</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/prometheus/index.asciidoc">edit</a></div>
<details>
<summary class="title"><span class="strong strong"><strong>Changelog</strong></span></summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Version</th>
<th align="left" valign="top">Details</th>
<th align="left" valign="top">Kibana version(s)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.23.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/12475" class="ulink" target="_top">View pull request</a>)<br>
Add support for Kibana <code class="literal">9.0.0</code>.</p>
</td>
<td align="left" valign="top"><p>8.16.0 or higher<br>
9.0.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.22.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/11996" class="ulink" target="_top">View pull request</a>)<br>
Added custom configuration option to all data streams.</p>
</td>
<td align="left" valign="top"><p>8.16.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.21.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/11988" class="ulink" target="_top">View pull request</a>)<br>
Upgrade the package format_version to 3.3.0.</p>
</td>
<td align="left" valign="top"><p>8.16.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.20.1</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/11876" class="ulink" target="_top">View pull request</a>)<br>
Improve documentation to replace references to Metricbeat with Elastic Agent.</p>
</td>
<td align="left" valign="top"><p>8.16.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.20.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/11447" class="ulink" target="_top">View pull request</a>)<br>
Add support for <code class="literal">metrics_count</code> to count number of metrics per Elasticsearch document.</p>
</td>
<td align="left" valign="top"><p>8.16.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.19.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/10592" class="ulink" target="_top">View pull request</a>)<br>
Allow automatic rerouting in promethues ingest-pipelines. E.g. for rerouting of events in Kubernetes environments.</p>
</td>
<td align="left" valign="top"><p>8.14.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.18.2</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/10840" class="ulink" target="_top">View pull request</a>)<br>
Add missing SSL parameters to the collector data stream.</p>
</td>
<td align="left" valign="top"><p>8.14.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.18.1</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-bug"></span> <span class="strong strong"><strong>Bug fix</strong></span> (<a href="https://github.com/elastic/integrations/pull/10766" class="ulink" target="_top">View pull request</a>)<br>
Add a dimension field with a fingerprint value applied over Prometheus label values to avoid document drop.</p>
</td>
<td align="left" valign="top"><p>8.14.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.18.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/10171" class="ulink" target="_top">View pull request</a>)<br>
ECS version updated to 8.11.0. Update the kibana constraint to ^8.14.0. Modified the field definitions to remove ECS fields made redundant by the ecs@mappings component template.</p>
</td>
<td align="left" valign="top"><p>8.14.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.17.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/9785" class="ulink" target="_top">View pull request</a>)<br>
Remove labels fingerprint, leading to better TSDB performance and storage reduction.</p>
</td>
<td align="left" valign="top"><p>8.14.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.16.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-bug"></span> <span class="strong strong"><strong>Bug fix</strong></span> (<a href="https://github.com/elastic/integrations/pull/9995" class="ulink" target="_top">View pull request</a>)<br>
Add global filter on data_stream.dataset to improve performance.</p>
</td>
<td align="left" valign="top"><p>8.12.1 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.15.3</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-bug"></span> <span class="strong strong"><strong>Bug fix</strong></span> (<a href="https://github.com/elastic/integrations/pull/10088" class="ulink" target="_top">View pull request</a>)<br>
Adding ssl verfication mode and removing default username for collector</p>
</td>
<td align="left" valign="top"><p>8.12.1 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.15.2</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-bug"></span> <span class="strong strong"><strong>Bug fix</strong></span> (<a href="https://github.com/elastic/integrations/pull/7914" class="ulink" target="_top">View pull request</a>)<br>
Fix typo - Replace "darastream" with "datastream"</p>
</td>
<td align="left" valign="top"><p>8.12.1 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.15.1</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-bug"></span> <span class="strong strong"><strong>Bug fix</strong></span> (<a href="https://github.com/elastic/integrations/pull/9424" class="ulink" target="_top">View pull request</a>)<br>
Add a "period" parameter to the counter cache.</p>
</td>
<td align="left" valign="top"><p>8.12.1 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.15.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/9321" class="ulink" target="_top">View pull request</a>)<br>
Enable secrets for sensitive fields. For more details, refer <a href="/guide/en/fleet/current/agent-policy.html#agent-policy-secret-values" class="ulink" target="_top">https://www.elastic.co/guide/en/fleet/current/agent-policy.html#agent-policy-secret-values</a></p>
</td>
<td align="left" valign="top"><p>8.12.1 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.14.2</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-bug"></span> <span class="strong strong"><strong>Bug fix</strong></span> (<a href="https://github.com/elastic/integrations/pull/9279" class="ulink" target="_top">View pull request</a>)<br>
Disable secrets for older stack versions due to errors.</p>
</td>
<td align="left" valign="top"><p>8.9.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.14.1</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/9264" class="ulink" target="_top">View pull request</a>)<br>
Add Certificate Authorities for Remote Write</p>
</td>
<td align="left" valign="top"><p>8.9.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.14.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/9009" class="ulink" target="_top">View pull request</a>)<br>
Enable <em>secret</em> for the sensitive fields, supported from 8.12.</p>
</td>
<td align="left" valign="top"><p>8.9.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.13.1</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/8016" class="ulink" target="_top">View pull request</a>)<br>
Migrate Prometheus Server Overview dashboard to lens.</p>
</td>
<td align="left" valign="top"><p>8.9.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.13.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/7082" class="ulink" target="_top">View pull request</a>)<br>
Ensure event.kind is correctly set for pipeline errors.</p>
</td>
<td align="left" valign="top"><p>8.9.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.12.1</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-bug"></span> <span class="strong strong"><strong>Bug fix</strong></span> (<a href="https://github.com/elastic/integrations/pull/7882" class="ulink" target="_top">View pull request</a>)<br>
Fix remote_write ingest pipeline to include both metric path <em>prometheus.<span class="strong strong"><strong></em> and <em>prometheus.metrics.</strong></span></em> to fingerprint calculation</p>
</td>
<td align="left" valign="top"><p>8.9.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.12.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/7667" class="ulink" target="_top">View pull request</a>)<br>
Use ecs definition of the <em>event.dataset</em> field</p>
</td>
<td align="left" valign="top"><p>8.9.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.11.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/7598" class="ulink" target="_top">View pull request</a>)<br>
Enable TSDB by default for remote_write datastreams. This improves storage usage and query performance. For more details, see <a href="/guide/en/elasticsearch/reference/current/tsds.html" class="ulink" target="_top">https://www.elastic.co/guide/en/elasticsearch/reference/current/tsds.html</a></p>
</td>
<td align="left" valign="top"><p>8.9.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.10.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/7594" class="ulink" target="_top">View pull request</a>)<br>
Align fingerprint field name across all datastreams, add handling of pipeline failures to the collector and query datastreams</p>
</td>
<td align="left" valign="top"><p>8.9.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.9.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/7565" class="ulink" target="_top">View pull request</a>)<br>
Add dimension and metric_type fields to remote_write datastream</p>
</td>
<td align="left" valign="top"><p>8.9.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.8.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/7261" class="ulink" target="_top">View pull request</a>)<br>
Enable TSDB by default for collector and query metrics data streams. This improves storage usage and query performance. For more details, see <a href="/guide/en/elasticsearch/reference/current/tsds.html" class="ulink" target="_top">https://www.elastic.co/guide/en/elasticsearch/reference/current/tsds.html</a>. Still TSDB is not supported for remote_write</p>
</td>
<td align="left" valign="top"><p>8.9.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.7.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/7324" class="ulink" target="_top">View pull request</a>)<br>
Revert metrics field definition to the format used before introducing metric_type</p>
</td>
<td align="left" valign="top"><p>8.9.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.6.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/6981" class="ulink" target="_top">View pull request</a>)<br>
Add metric_type fields to collector and query datastreams for TSDB support</p>
</td>
<td align="left" valign="top"><p>8.9.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.5.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/5974" class="ulink" target="_top">View pull request</a>)<br>
Add dimension fields to collector and query datastreams for TSDB support</p>
</td>
<td align="left" valign="top"><p>8.4.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.4.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/6536" class="ulink" target="_top">View pull request</a>)<br>
Add processor configuration</p>
</td>
<td align="left" valign="top"><p>8.4.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.3.2</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-bug"></span> <span class="strong strong"><strong>Bug fix</strong></span> (<a href="https://github.com/elastic/integrations/pull/6140" class="ulink" target="_top">View pull request</a>)<br>
Fix timeout and connect_timeout parameter parsing issue</p>
</td>
<td align="left" valign="top"><p>8.4.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.3.1</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/5123" class="ulink" target="_top">View pull request</a>)<br>
Added categories and/or subcategories.</p>
</td>
<td align="left" valign="top"><p>8.4.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.3.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/5336" class="ulink" target="_top">View pull request</a>)<br>
Support data_stream.dataset name</p>
</td>
<td align="left" valign="top"><p>8.4.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.2.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/5317" class="ulink" target="_top">View pull request</a>)<br>
Enable setting condition on Prometheus Collector</p>
</td>
<td align="left" valign="top"><p>8.4.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.1.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/4983" class="ulink" target="_top">View pull request</a>)<br>
Remove "integration" from the package name</p>
</td>
<td align="left" valign="top"><p>8.4.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.0.1</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/4545" class="ulink" target="_top">View pull request</a>)<br>
Removing x-pack references and updating default values</p>
</td>
<td align="left" valign="top"><p>8.4.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.0.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/4315" class="ulink" target="_top">View pull request</a>)<br>
Promote integration to GA</p>
</td>
<td align="left" valign="top"><p>8.4.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.14.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/4275" class="ulink" target="_top">View pull request</a>)<br>
Update default dashboard</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.13.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/4060" class="ulink" target="_top">View pull request</a>)<br>
Revert index mapping changes for histogram type</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.12.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-bug"></span> <span class="strong strong"><strong>Bug fix</strong></span> (<a href="https://github.com/elastic/integrations/pull/4034" class="ulink" target="_top">View pull request</a>)<br>
Disable leader election by default, remove bearer token file default value</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.11.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-bug"></span> <span class="strong strong"><strong>Bug fix</strong></span> (<a href="https://github.com/elastic/integrations/pull/3891" class="ulink" target="_top">View pull request</a>)<br>
Fix histogram type in collector data_stream</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.10.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/3662" class="ulink" target="_top">View pull request</a>)<br>
Hide some configuration for remote_write data_stream; Add leader election for collector and query data_streams</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.9.2</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/2916" class="ulink" target="_top">View pull request</a>)<br>
reworded a link to related documentation in the Readme so it is clearer</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.9.1</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/2916" class="ulink" target="_top">View pull request</a>)<br>
Add documentation for multi-fields</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.9.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/2632" class="ulink" target="_top">View pull request</a>)<br>
Add standard HTTP options to the package</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.8.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/2619" class="ulink" target="_top">View pull request</a>)<br>
Improve default datastream enablement</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.7.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/2189" class="ulink" target="_top">View pull request</a>)<br>
Release prometheus package for v8.0.0</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.6.1</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/2050" class="ulink" target="_top">View pull request</a>)<br>
Uniform with guidelines</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.6.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/1705" class="ulink" target="_top">View pull request</a>)<br>
Update to ECS 1.12.0</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.5.1</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/1405" class="ulink" target="_top">View pull request</a>)<br>
Escape special characters in docs</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.5.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/1364" class="ulink" target="_top">View pull request</a>)<br>
Update integration description</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.4.1</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/1323" class="ulink" target="_top">View pull request</a>)<br>
Fix yml code blocks</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.4.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/1249" class="ulink" target="_top">View pull request</a>)<br>
Set <code class="literal">event.module</code> and <code class="literal">event.dataset</code></p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.3.5</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/766" class="ulink" target="_top">View pull request</a>)<br>
Updating package owner</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.3.4</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-bug"></span> <span class="strong strong"><strong>Bug fix</strong></span> (<a href="https://github.com/elastic/integrations/pull/754" class="ulink" target="_top">View pull request</a>)<br>
Correct sample event file.</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.3.3</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-bug"></span> <span class="strong strong"><strong>Bug fix</strong></span> (<a href="https://github.com/elastic/integrations/pull/749" class="ulink" target="_top">View pull request</a>)<br>
Change kibana.version constraint to be more conservative.</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.1.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/114" class="ulink" target="_top">View pull request</a>)<br>
initial release</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="prometheus-intro.html">« Prometheus</a>
</span>
<span class="next">
<a href="prometheus_input.html">Prometheus Input Package »</a>
</span>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>

                        <!-- Feedback widget -->
                        <div id="feedbackWidgetContainer"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


        <div id='elastic-footer'></div>
        <script src='https://www.elastic.co/elastic-footer.js'></script>
        <!-- Footer Section end-->

      </section>
    </div>

    <!-- Feedback modal -->
    <div id="feedbackModalContainer"></div>

    <script src="/guide/static/jquery.js"></script>
    <script type="text/javascript" src="/guide/static/docs-v1.js"></script>
    <script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
