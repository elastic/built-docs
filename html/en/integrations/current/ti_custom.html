<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Custom Threat Intelligence integration | Elastic integrations | Elastic</title>
<meta class="elastic" name="content" content="Custom Threat Intelligence integration | Elastic integrations">

<link rel="home" href="index.html" title="Elastic integrations"/>
<link rel="up" href="threat-intelligence-intro.html" title="Threat intelligence"/>
<link rel="prev" href="ti_cif3.html" title="Collective Intelligence Framework v3 Integration"/>
<link rel="next" href="ti_cybersixgill.html" title="Cybersixgill Darkfeed TAXII Integration"/>
<meta class="elastic" name="product_version" content="main"/>
<meta class="elastic" name="product_name" content="Integrations"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Integrations/Reference"/>
<meta name="DC.subject" content="Integrations"/>
<meta name="DC.identifier" content="main"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles-v1.css" />
  </head>

  <!--© 2015-2025 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div class="navheader">
<span class="prev">
<a href="ti_cif3.html">« Collective Intelligence Framework v3 Integration</a>
</span>
<span class="next">
<a href="ti_cybersixgill.html">Cybersixgill Darkfeed TAXII Integration »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic integrations</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="threat-intelligence-intro.html">Threat intelligence</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Custom Threat Intelligence integration</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/ti_custom/index.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="ti_custom"></a>Custom Threat Intelligence integration</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/ti_custom/index.asciidoc">edit</a></div>
</div></div></div>

<div class="condensed-table">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<tbody>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Version</strong></span></p></td>
<td align="left" valign="top"><p>0.8.1 <span class="Admonishment Admonishment--beta">
[<span class="Admonishment-title u-mono">beta</span>]
<span class="Admonishment-detail">
This functionality is in beta and is subject to change. The design and code is less mature than official GA features and is being provided as-is with no warranties. Beta features are not subject to the support SLA of official GA features.
</span>
</span> (<a class="xref" href="ti_custom.html#ti_custom-changelog" title="Changelog">View all</a>)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Compatible Kibana version(s)</strong></span></p></td>
<td align="left" valign="top"><p>8.14.0 or higher<br>
9.0.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Supported Serverless project types</strong></span><br>
 <a class="xref" href="serverless-support.html" title="Supported Serverless project types"><span class="small">What&#8217;s this?</span></a></p></td>
<td align="left" valign="top"><p>Security<br>
Observability</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Subscription level</strong></span><br>
<a href="/subscriptions" class="ulink" target="_top"><span class="small">What&#8217;s this?</span></a></p></td>
<td align="left" valign="top"><p>Basic</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Level of support</strong></span><br>
<a class="xref" href="support.html" title="Level of support"><span class="small">What&#8217;s this?</span></a></p></td>
<td align="left" valign="top"><p>Elastic</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The Custom Threat Intelligence package is an integration designed to ingest threat intelligence IOCs in the <a href="https://docs.oasis-open.org/cti/stix/v2.1/os/stix-v2.1-os.html" class="ulink" target="_top">STIX 2.1</a> format and convert them into the Elastic Common Schema (ECS) for seamless ingestion into Elasticsearch. It has been delivered to ingest threat intelligence data for those APIs that do not currently have an existing integration.</p>
<p>The integration comes with a default pipeline that automatically maps standard STIX 2.1 data into ECS fields. However, it also offers the flexibility to handle custom STIX data by allowing users to add custom pipelines accordingly.</p>
<div class="position-relative"><h4><a id="ti_custom-key-features"></a>Key features</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/ti_custom/index.asciidoc">edit</a></div>
<div class="position-relative"><h6><a id="ti_custom-supported-data-sources"></a>Supported data sources</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/ti_custom/index.asciidoc">edit</a></div>
<p>RESTful API:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Connects to public or private RESTful APIs that provide threat intelligence in STIX 2.1 format.
</li>
<li class="listitem">
Supports standard HTTP methods for data retrieval, including GET and POST.
</li>
</ul>
</div>
<p>TAXII 2.1 Protocol:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Acts as a <a href="https://docs.oasis-open.org/cti/taxii/v2.1/os/taxii-v2.1-os.html" class="ulink" target="_top">TAXII</a> client to connect to TAXII 2.x servers, enabling the collection of threat intelligence feeds in STIX format.
</li>
<li class="listitem">
It only supports collection models for TAXII data retrieval.
</li>
</ul>
</div>
<p>Log files:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Ingests threat intelligence indicators provided in logfile, for air-gapped environments.
</li>
</ul>
</div>
<div class="position-relative"><h6><a id="ti_custom-stix-21-compliance"></a>STIX 2.1 Compliance</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/ti_custom/index.asciidoc">edit</a></div>
<p>Indicators are categorized based on their type and stored for further processing. Currently, the supported IOCs types are:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Autonomous System
</li>
<li class="listitem">
Domain Name
</li>
<li class="listitem">
Email
</li>
<li class="listitem">
File
</li>
<li class="listitem">
IPv4
</li>
<li class="listitem">
IPv6
</li>
<li class="listitem">
URL
</li>
<li class="listitem">
Windows Registry
</li>
<li class="listitem">
x509 Certificates
</li>
</ul>
</div>
<p>The default pipeline is able to ingest other types of indicators, although they are not 100% mapped into ECS.</p>
<div class="position-relative"><h5><a id="ti_custom-configuration-guidelines"></a>Configuration guidelines</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/ti_custom/index.asciidoc">edit</a></div>
<p>Due to the lack of standards from some TI providers, it is possible that some extra configuration is required for certain use cases.</p>
<p>When connecting to STIX APIs, by default, the integration provides a native way of acting as a TAXII client. Therefore, for collecting data from TAXII 2.x servers no extra configuration is needed apart from providing the server URL, and authentication credentials when needed.</p>
<p>However, for APIs that don&#8217;t follow a specific communication protocol. The correct ingestion of STIX data would require:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Add a CEL program where API specifications are met. Pay special attention to HTTP headers, query parameters, pagination, and the processing of the payload.
</li>
<li class="listitem">
Add a initial state to be provided to the program. Generally, it would include the API URL, authentication parameters and intervals. More information can be found in the <a href="/guide/en/beats/filebeat/current/filebeat-input-cel.html#input-state-cel" class="ulink" target="_top">documentation</a>.
</li>
</ul>
</div>
<p>By default the integration only supports STIX 2.1 indicators. This means that to process IOCs in other formats, the <code class="literal">Restrict STIX 2.1 format</code> option must be disabled, and a custom pipeline added to map the indicators correctly.</p>
<div class="position-relative"><h5><a id="ti_custom-collecting-threat-intelligence-from-isac-feeds"></a>Collecting Threat Intelligence from ISAC Feeds</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/ti_custom/index.asciidoc">edit</a></div>
<p>The Custom Threat Intelligence integration allows you to connect to and pull threat indicators from any server supporting the TAXII protocol. This makes this integration the perfect fit for retrieving structured threat intelligence from Information Sharing and Analysis Centers (ISACs), such as MS-ISAC, FS-ISAC, H-ISAC, and others. These ISACs provide STIX-formatted threat data through TAXII servers.</p>
<p>To configure the integration to pull threat intelligence from an ISAC feed, follow these steps:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Ensure ISAC Membership: Confirm that you are a member of the desired ISAC (e.g., MS-ISAC, FS-ISAC) and have access to its TAXII server credentials. Some ISACs require registration and approval before providing TAXII feed access.
</li>
<li class="listitem">
<p>Obtain the following information from your ISAC:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Server URL: The endpoint for the ISAC’s TAXII server (e.g. <a href="https://example-isac.org/taxii/" class="ulink" target="_top">https://example-isac.org/taxii/</a>).
</li>
<li class="listitem">
Collection Name: The specific collection containing the threat intelligence you want to retrieve.
</li>
<li class="listitem">
Authentication Credentials: Username, password, API Key, or client certificate, as required by the ISAC.
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Set up the integration:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
The server URL and collection name should be used to build the URL as follows: <code class="literal">https://{base_url}/{api-root}/collections/{name}/objects/</code>
</li>
<li class="listitem">
Provide the username/password, API Key or upload a client certificate, depending on the ISAC’s requirements.
</li>
<li class="listitem">
Set how often the integration should pull updates (e.g. every hour). You can also set the time range to search for indicators when the agent runs for the first time with the Initial Interval.
</li>
</ul>
</div>
</li>
</ol>
</div>
<p>Once the integration is running and pulling data, it automatically maps threat indicator fields from STIX to ECS. Verify that the imported indicators (e.g. IPs, domains, hashes) align with your detection rules.</p>
<div class="position-relative"><h5><a id="ti_custom-expiration-of-indicators-of-compromise-iocs"></a>Expiration of Indicators of Compromise (IOCs)</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/ti_custom/index.asciidoc">edit</a></div>
<p>The Custom Threat Intelligence integration supports IOC expiration. The ingested IOCs expire after certain duration. Based on the <a href="https://docs.oasis-open.org/cti/stix/v2.1/os/stix-v2.1-os.html" class="ulink" target="_top">STIX 2.1 reference</a>, the following options are available to determine the expiration of indicators:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
The <code class="literal">valid_until</code> field that indicates the time at which this Indicator should no longer be considered a valid indicator
</li>
<li class="listitem">
The <code class="literal">revoked</code> field that means that the indicator is no longer considered valid by the object creator.
</li>
<li class="listitem">
When missing <code class="literal">valid_until</code> and <code class="literal">revoked</code>, the indicator expires according to the default expiration set by <code class="literal">IOC Expiration Duration</code> configuration parameter. For more details, see <a class="xref" href="ti_custom.html#ti_custom-handling-orphaned-iocs" title="Handling orphaned IOCs">Handling Orphaned IOCs</a>.
</li>
</ul>
</div>
<p>The field <code class="literal">stix.ioc_expiration_reason</code> indicates which among the 3 methods stated above is the reason for indicator expiration.</p>
<p>An <a href="/guide/en/elasticsearch/reference/current/transforms.html" class="ulink" target="_top">Elastic Transform</a> is created to faciliate only active IOCs be available to the end users. This transform creates destination indices named <code class="literal">logs-ti_custom_latest.dest_indicator-*</code> which only contains active and unexpired IOCs. The latest destination index also has an alias named <code class="literal">logs-ti_custom_latest.indicator</code>. When querying for active indicators or setting up indicator match rules, only use the latest destination indices or the alias to avoid false positives from expired IOCs.</p>
<div class="position-relative"><h6><a id="ti_custom-handling-orphaned-iocs"></a>Handling orphaned IOCs</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/ti_custom/index.asciidoc">edit</a></div>
<p>Some IOCs may never expire and will continue to stay in the latest destination indices <code class="literal">logs-ti_custom_latest.dest_indicator-*</code>. To avoid any false positives from such orphaned IOCs, users are allowed to configure <code class="literal">IOC Expiration Duration</code> parameter while setting up the integration. This parameter deletes any indicator ingested into destination indices <code class="literal">logs-ti_custom_latest.dest_indicator-*</code> after this specified duration is reached, defaults to <code class="literal">90d</code> from source&#8217;s <code class="literal">@timestamp</code> field. Note that <code class="literal">IOC Expiration Duration</code> parameter only exists to add a fail-safe default expiration in case IOCs never expire.</p>
<div class="position-relative"><h6><a id="ti_custom-ilm-policy"></a>ILM Policy</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/ti_custom/index.asciidoc">edit</a></div>
<p>To facilitate IOC expiration, source datastream-backed indices <code class="literal">.ds-logs-ti_custom.indicator-*</code> are allowed to contain duplicates from each polling interval. ILM policy is added to these source indices so it doesn&#8217;t lead to unbounded growth. This means data in these source indices will be deleted after <code class="literal">5 days</code> from ingested date.</p>
<div class="position-relative"><h4><a id="ti_custom-logs-reference"></a>Logs reference</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/ti_custom/index.asciidoc">edit</a></div>
<div class="position-relative"><h5><a id="ti_custom-indicator"></a>indicator</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/ti_custom/index.asciidoc">edit</a></div>
<p>The <code class="literal">indicator</code> dataset stores STIX 2.1 indicators processed into ECS.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Example</strong></span></summary>
<div class="content">
<p>An example event for <code class="literal">indicator</code> looks as following:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
    "@timestamp": "2015-05-15T09:12:16.432Z",
    "agent": {
        "ephemeral_id": "3179505d-300c-450f-9a13-6c48e97a6453",
        "id": "f2593b61-002f-42d8-b72b-c4181b590c92",
        "name": "elastic-agent-77457",
        "type": "filebeat",
        "version": "8.14.0"
    },
    "data_stream": {
        "dataset": "ti_custom.indicator",
        "namespace": "36027",
        "type": "logs"
    },
    "ecs": {
        "version": "8.11.0"
    },
    "elastic_agent": {
        "id": "f2593b61-002f-42d8-b72b-c4181b590c92",
        "snapshot": false,
        "version": "8.14.0"
    },
    "event": {
        "agent_id_status": "verified",
        "category": [
            "threat"
        ],
        "dataset": "ti_custom.indicator",
        "ingested": "2024-10-02T10:51:17Z",
        "kind": "enrichment",
        "original": "{\"type\":\"indicator\",\"spec_version\":\"2.1\",\"pattern_type\":\"stix\",\"id\":\"indicator--745e1537-b4f3-49da-9f64-df6b1b5df190\",\"created\":\"2015-05-15T09:12:16.432Z\",\"modified\":\"2015-05-15T09:12:16.432Z\",\"name\":\"Appendix E MD5 hash '002325a0a67fded0381b5648d7fe9b8e'\",\"description\":\"Test description.\",\"pattern\":\"[file:hashes.md5 = '002325a0a67fded0381b5648d7fe9b8e']\",\"indicator_types\":[\"malicious-activity\"],\"valid_from\":\"2015-05-15T09:12:16.432678Z\"}",
        "type": [
            "indicator"
        ]
    },
    "input": {
        "type": "filestream"
    },
    "log": {
        "file": {
            "device_id": "36",
            "inode": "125",
            "path": "/tmp/service_logs/stix-indicators-ndjson.log"
        },
        "offset": 3409
    },
    "related": {
        "hash": [
            "002325a0a67fded0381b5648d7fe9b8e"
        ]
    },
    "stix": {
        "created": "2015-05-15T09:12:16.432Z",
        "id": "indicator--745e1537-b4f3-49da-9f64-df6b1b5df190",
        "indicator_types": [
            "malicious-activity"
        ],
        "ioc_expiration_date": "2015-05-20T09:12:16.432Z",
        "ioc_expiration_duration": "5d",
        "ioc_expiration_reason": "Expiration set by Elastic from the integration's parameter `IOC Expiration Duration`",
        "modified": "2015-05-15T09:12:16.432Z",
        "pattern": "[file:hashes.md5 = '002325a0a67fded0381b5648d7fe9b8e']",
        "pattern_type": "stix",
        "spec_version": "2.1",
        "type": "indicator",
        "valid_from": "2015-05-15T09:12:16.432678Z"
    },
    "tags": [
        "preserve_original_event",
        "forwarded",
        "ti_custom-indicator"
    ],
    "threat": {
        "feed": {
            "name": "STIX Provider",
            "reference": "https://stix-example.com"
        },
        "indicator": {
            "description": "Test description.",
            "file": {
                "hash": {
                    "md5": [
                        "002325a0a67fded0381b5648d7fe9b8e"
                    ]
                }
            },
            "first_seen": "2015-05-15T09:12:16.432Z",
            "last_seen": "2015-05-15T09:12:16.432Z",
            "modified_at": "2015-05-15T09:12:16.432Z",
            "name": "Appendix E MD5 hash '002325a0a67fded0381b5648d7fe9b8e'",
            "type": "file"
        }
    }
}</pre>
</div>
</div>
</details>
<details>
<summary class="title"><span class="strong strong"><strong>Exported fields</strong></span></summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Field</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>@timestamp</p></td>
<td align="left" valign="top"><p>Event timestamp.</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.dataset</p></td>
<td align="left" valign="top"><p>Data stream dataset.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.namespace</p></td>
<td align="left" valign="top"><p>Data stream namespace.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.type</p></td>
<td align="left" valign="top"><p>Data stream type.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>event.dataset</p></td>
<td align="left" valign="top"><p>Event dataset</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>event.module</p></td>
<td align="left" valign="top"><p>Event module</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>input.type</p></td>
<td align="left" valign="top"><p>Input type</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>labels.is_ioc_transform_source</p></td>
<td align="left" valign="top"><p>Indicates whether an IOC is in the raw source data stream, or the in latest destination index.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>log.file.device_id</p></td>
<td align="left" valign="top"><p>ID of the device containing the filesystem where the file resides.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>log.file.fingerprint</p></td>
<td align="left" valign="top"><p>The sha256 fingerprint identity of the file when fingerprinting is enabled.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>log.file.inode</p></td>
<td align="left" valign="top"><p>Inode number of the log file.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>log.file.path</p></td>
<td align="left" valign="top"><p>Path to the log file.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>log.flags</p></td>
<td align="left" valign="top"><p>Flags for the log file.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>log.offset</p></td>
<td align="left" valign="top"><p>Offset of the entry in the log file.</p></td>
<td align="left" valign="top"><p>long</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>stix.confidence</p></td>
<td align="left" valign="top"><p>The confidence property identifies the confidence that the creator has in the correctness of their data. The confidence value MUST be a number in the range of 0-100.</p></td>
<td align="left" valign="top"><p>integer</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>stix.created</p></td>
<td align="left" valign="top"><p>The time at which the STIX Indicator Object was originally created</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>stix.created_by_ref</p></td>
<td align="left" valign="top"><p>The created_by_ref property specifies the id property of the identity object that describes the entity that created this object.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>stix.extensions</p></td>
<td align="left" valign="top"><p>Specifies any extensions of the object, as a dictionary.</p></td>
<td align="left" valign="top"><p>flattened</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>stix.external_references</p></td>
<td align="left" valign="top"><p>The external_references property specifies a list of external references which refers to non-STIX information. This property is used to provide one or more URLs, descriptions, or IDs to records in other systems.</p></td>
<td align="left" valign="top"><p>flattened</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>stix.id</p></td>
<td align="left" valign="top"><p>The ID of the indicator.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>stix.indicator_types</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>stix.ioc_expiration_date</p></td>
<td align="left" valign="top"><p>The expiration date of the indicator. It can be defined from the source event, by the revoked or valid_until fields, or from the integration configuration by ioc_expiration_duration.</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>stix.ioc_expiration_duration</p></td>
<td align="left" valign="top"><p>The configured expiration duration for the indicator.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>stix.ioc_expiration_reason</p></td>
<td align="left" valign="top"><p>Reason why the indicator is expired. Defined by the integration in the ingest pipeline.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>stix.kill_chain_phases</p></td>
<td align="left" valign="top"><p>Describes the various phases of the kill chain that the attacker undertakes.</p></td>
<td align="left" valign="top"><p>flattened</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>stix.lang</p></td>
<td align="left" valign="top"><p>Feed language.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>stix.modified</p></td>
<td align="left" valign="top"><p>Date of the last modification.</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>stix.object_marking_refs</p></td>
<td align="left" valign="top"><p>The object_marking_refs property specifies a list of id properties of marking-definition objects that apply to this object.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>stix.pattern</p></td>
<td align="left" valign="top"><p>The detection pattern for the indicator.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>stix.pattern_type</p></td>
<td align="left" valign="top"><p>The pattern language used in this indicator, which is always "stix".</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>stix.pattern_version</p></td>
<td align="left" valign="top"><p>The version of the pattern language that is used in this indicator.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>stix.revoked</p></td>
<td align="left" valign="top"><p>The revoked property is only used by STIX Objects that support versioning and indicates whether the object has been revoked. Revoked objects are no longer considered valid by the object creator. Revoking an object is permanent; future versions of the object with this id must not be created.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>stix.spec_version</p></td>
<td align="left" valign="top"><p>The version of the STIX specification used to represent this object. The value of this property must be 2.1.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>stix.type</p></td>
<td align="left" valign="top"><p>Type of the STIX Object.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>stix.valid_from</p></td>
<td align="left" valign="top"><p>The time from which the indicator is considered a valid indicator.</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>stix.valid_until</p></td>
<td align="left" valign="top"><p>The time at which the indicator should no longer be considered a valid indicator.</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>threat.indicator.first_seen</p></td>
<td align="left" valign="top"><p>The date and time when intelligence source first reported sighting this indicator.</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>threat.indicator.last_seen</p></td>
<td align="left" valign="top"><p>The date and time when intelligence source last reported sighting this indicator.</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>threat.indicator.modified_at</p></td>
<td align="left" valign="top"><p>The date and time when intelligence source last modified information for this indicator.</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
<div class="position-relative"><h4><a id="ti_custom-changelog"></a>Changelog</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/ti_custom/index.asciidoc">edit</a></div>
<details>
<summary class="title"><span class="strong strong"><strong>Changelog</strong></span></summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Version</th>
<th align="left" valign="top">Details</th>
<th align="left" valign="top">Kibana version(s)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.8.1</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-bug"></span> <span class="strong strong"><strong>Bug fix</strong></span> (<a href="http://github.com/elastic/integrations/pull/12841" class="ulink" target="_top">View pull request</a>)<br>
Add mapping for threat.indicator.url.original in transform.</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.8.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/12593" class="ulink" target="_top">View pull request</a>)<br>
Update Kibana constraint to support 9.0.0.</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.7.1</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-bug"></span> <span class="strong strong"><strong>Bug fix</strong></span> (<a href="https://github.com/elastic/integrations/pull/12697" class="ulink" target="_top">View pull request</a>)<br>
Updated SSL description to be uniform and to include links to documentation.</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.7.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/12549" class="ulink" target="_top">View pull request</a>)<br>
Add mapping for log file fingerprint.</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.6.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/12084" class="ulink" target="_top">View pull request</a>)<br>
Support for limit parameter in API requests.</p>
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/12084" class="ulink" target="_top">View pull request</a>)<br>
Use the header X-Taxii-Date-Added-Last to avoid duplicates in successive requests.</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.5.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/12098" class="ulink" target="_top">View pull request</a>)<br>
Improve documentation on how to proceed with ISAC feeds.</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.4.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/12046" class="ulink" target="_top">View pull request</a>)<br>
Add "preserve_original_event" tag to documents with <code class="literal">event.kind</code> set to "pipeline_error".</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.3.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/11867" class="ulink" target="_top">View pull request</a>)<br>
Support for SSL and Proxy settings.</p>
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/11867" class="ulink" target="_top">View pull request</a>)<br>
Add feed name and feed reference options for API section.</p>
<p><span class="eui-icon icon-bug"></span> <span class="strong strong"><strong>Bug fix</strong></span> (<a href="https://github.com/elastic/integrations/pull/11867" class="ulink" target="_top">View pull request</a>)<br>
Fix CEL program to follow TAXII 2.1 specifications.</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.2.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/11202" class="ulink" target="_top">View pull request</a>)<br>
Add support for basic authentication.</p>
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/11202" class="ulink" target="_top">View pull request</a>)<br>
Add fingerprint to avoid ingesting duplicated indicators.</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.1.3</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-bug"></span> <span class="strong strong"><strong>Bug fix</strong></span> (<a href="https://github.com/elastic/integrations/pull/11314" class="ulink" target="_top">View pull request</a>)<br>
Use triple-brace Mustache templating when referencing variables in ingest pipelines.</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.1.2</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-bug"></span> <span class="strong strong"><strong>Bug fix</strong></span> (<a href="https://github.com/elastic/integrations/pull/11284" class="ulink" target="_top">View pull request</a>)<br>
Use triple-brace Mustache templating when referencing variables in ingest pipelines.</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.1.1</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-bug"></span> <span class="strong strong"><strong>Bug fix</strong></span> (<a href="https://github.com/elastic/integrations/pull/11231" class="ulink" target="_top">View pull request</a>)<br>
Fix labels.is_ioc_transform_source values</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.1.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/11066" class="ulink" target="_top">View pull request</a>)<br>
Initial release of Custom Threat Intelligence package</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="ti_cif3.html">« Collective Intelligence Framework v3 Integration</a>
</span>
<span class="next">
<a href="ti_cybersixgill.html">Cybersixgill Darkfeed TAXII Integration »</a>
</span>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>

                        <!-- Feedback widget -->
                        <div id="feedbackWidgetContainer"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


        <div id='elastic-footer'></div>
        <script src='https://www.elastic.co/elastic-footer.js'></script>
        <!-- Footer Section end-->

      </section>
    </div>

    <!-- Feedback modal -->
    <div id="feedbackModalContainer"></div>

    <script src="/guide/static/jquery.js"></script>
    <script type="text/javascript" src="/guide/static/docs-v1.js"></script>
    <script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
