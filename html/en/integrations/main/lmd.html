<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Lateral Movement Detection Model | Elastic integrations | Elastic</title>
<meta class="elastic" name="content" content="Lateral Movement Detection Model | Elastic integrations">

<link rel="home" href="index.html" title="Elastic integrations"/>
<link rel="up" href="index.html" title="Elastic integrations"/>
<link rel="prev" href="lastpass.html" title="LastPass"/>
<link rel="next" href="linux.html" title="Linux Integration"/>
<meta class="elastic" name="product_version" content="main"/>
<meta class="elastic" name="product_name" content="Integrations"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Integrations/Reference"/>
<meta name="DC.subject" content="Integrations"/>
<meta name="DC.identifier" content="main"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles-v1.css" />
  </head>

  <!--© 2015-2025 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div class="navheader">
<span class="prev">
<a href="lastpass.html">« LastPass</a>
</span>
<span class="next">
<a href="linux.html">Linux Integration »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic integrations</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Lateral Movement Detection Model</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/lmd/index.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="chapter">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="lmd"></a>Lateral Movement Detection Model</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/lmd/index.asciidoc">edit</a></div>
</div></div></div>

<div class="condensed-table">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<tbody>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Version</strong></span></p></td>
<td align="left" valign="top"><p>2.2.0 (<a class="xref" href="lmd.html#lmd-changelog" title="Changelog">View all</a>)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Compatible Kibana version(s)</strong></span></p></td>
<td align="left" valign="top"><p>8.9.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Supported Serverless project types</strong></span><br>
 <a class="xref" href="serverless-support.html" title="Supported Serverless project types"><span class="small">What&#8217;s this?</span></a></p></td>
<td align="left" valign="top"><p>Security</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Subscription level</strong></span><br>
<a href="/subscriptions" class="ulink" target="_top"><span class="small">What&#8217;s this?</span></a></p></td>
<td align="left" valign="top"><p>Platinum</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Level of support</strong></span><br>
<a class="xref" href="support.html" title="Level of support"><span class="small">What&#8217;s this?</span></a></p></td>
<td align="left" valign="top"><p>Elastic</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>The Lateral movement detection model package contains assets that detect lateral movement based on file transfer activity and Windows RDP events. This package requires a Platinum subscription. Please ensure that you have a Trial, Platinum, or Enterprise subscription before proceeding. This package is licensed under <a href="/licensing/elastic-license" class="ulink" target="_top">Elastic License 2.0</a>.</p>
<p>For more detailed information refer to the following blogs:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="/blog/detecting-lateral-movement-activity-a-new-kibana-integration" class="ulink" target="_top">Detecting Lateral Movement activity: A new Kibana integration</a>
</li>
<li class="listitem">
<a href="/blog/remote-desktop-protocol-connections-elastic-security" class="ulink" target="_top">Identifying malicious Remote Desktop Protocol (RDP) connections with Elastic Security</a>
</li>
</ul>
</div>
<div class="position-relative"><h3><a id="lmd-installation"></a>Installation</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/lmd/index.asciidoc">edit</a></div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<span class="strong strong"><strong>Upgrading</strong></span>: If upgrading from a version below v2.0.0, see the section v2.0.0 and beyond.
</li>
<li class="listitem">
<span class="strong strong"><strong>Add the Integration Package</strong></span>: Install the package via <span class="strong strong"><strong>Management &gt; Integrations &gt; Add Lateral Movement Detection</strong></span>. Configure the integration name and agent policy. Click <span class="strong strong"><strong>Save and Continue</strong></span>. (Note that this integration does not rely on an agent, and can be assigned to a policy without an agent.)
</li>
<li class="listitem">
<span class="strong strong"><strong>Check the health of the transform</strong></span>: The transform is scheduled to run every hour. This transform creates the index <code class="literal">ml-rdp-lmd</code>. To check the health of the transform go to <span class="strong strong"><strong>Management &gt; Stack Management &gt; Data &gt; Transforms</strong></span> under <code class="literal">logs-lmd.pivot_transform-default-&lt;FLEET-TRANSFORM-VERSION&gt;</code>.
</li>
<li class="listitem">
<p><span class="strong strong"><strong>Create data views for anomaly detection jobs</strong></span>: The anomaly detection jobs under this package rely on two indices. One has file transfer events (<code class="literal">logs-*</code>), and the other index (<code class="literal">ml-rdp-lmd</code>) collects RDP session information from a transform. Before enabling the anomaly detection jobs, create a data view with both index patterns.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Go to <span class="strong strong"><strong>Stack Management &gt; Kibana &gt; Data Views</strong></span> and click <span class="strong strong"><strong>Create data view</strong></span>.
</li>
<li class="listitem">
Enter the name of your respective index patterns in the <span class="strong strong"><strong>Index pattern</strong></span> box, i.e., <code class="literal">logs-*, ml-rdp-lmd</code>, and copy the same in the <span class="strong strong"><strong>Name</strong></span> field.
</li>
<li class="listitem">
Select <code class="literal">@timestamp</code> under the <span class="strong strong"><strong>Timestamp</strong></span> field and click on <span class="strong strong"><strong>Save data view to Kibana</strong></span>.
</li>
<li class="listitem">
Use the new data view (<code class="literal">logs-*, ml-rdp-lmd</code>) to create anomaly detection jobs for this package.
</li>
</ol>
</div>
</li>
<li class="listitem">
<span class="strong strong"><strong>Add preconfigured anomaly detection jobs</strong></span>: In <span class="strong strong"><strong>Machine Learning &gt; Anomaly Detection</strong></span>, when you create a job, you should see an option to <code class="literal">Use preconfigured jobs</code> with a card for <span class="strong strong"><strong>Lateral Movement Detection</strong></span>. When you select the card, you will see pre-configured anomaly detection jobs that you can enable depending on what makes the most sense for your environment. <span class="strong strong"><strong><em>Note</em></strong></span>: In the Machine Learning app, these configurations are available only when data exists that matches the query specified in the <a href="https://github.com/elastic/integrations/blob/main/packages/lmd/kibana/ml%5Fmodule/lmd-ml.json#L10" class="ulink" target="_top">lmd-ml file</a>. For example, this would be available in <code class="literal">logs-endpoint.events.*</code> if you used Elastic Defend to collect events.
</li>
<li class="listitem">
<p><span class="strong strong"><strong>Data view configuration for Dashboards</strong></span>: For the dashboard to work as expected, the following settings need to be configured in Kibana.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
You have started the above anomaly detection jobs.
</li>
<li class="listitem">
You have <span class="strong strong"><strong>read</strong></span> access to <code class="literal">.ml-anomalies-shared</code> index or are assigned the <code class="literal">machine_learning_user</code> role. For more information on roles, please refer to <a href="/guide/en/elasticsearch/reference/current/built-in-roles.html" class="ulink" target="_top">Built-in roles in Elastic</a>. Please be aware that a user who has access to the underlying machine learning results indices can see the results of <em>all</em> jobs in <em>all</em> spaces. Be mindful of granting permissions if you use Kibana spaces to control which users can see which machine learning results. For more information on machine learning privileges, refer to <a href="/guide/en/machine-learning/current/setup.html#setup-privileges" class="ulink" target="_top">setup-privileges</a>.
</li>
<li class="listitem">
<p>After enabling the jobs, go to <span class="strong strong"><strong>Management &gt; Stack Management &gt; Kibana &gt; Data Views</strong></span>.  Click on <span class="strong strong"><strong>Create data view</strong></span> with the following settings:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: <code class="literal">.ml-anomalies-shared</code>
</li>
<li class="listitem">
Index pattern : <code class="literal">.ml-anomalies-shared</code>
</li>
<li class="listitem">
Select <span class="strong strong"><strong>Show Advanced settings</strong></span> enable <span class="strong strong"><strong>Allow hidden and system indices</strong></span>
</li>
<li class="listitem">
Custom data view ID: <code class="literal">.ml-anomalies-shared</code>
</li>
</ul>
</div>
</li>
</ol>
</div>
</li>
<li class="listitem">
<span class="strong strong"><strong>Enabling detection rules</strong></span>:  You can also enable detection rules to alert on Lateral Movement activity in your environment, based on anomalies flagged by the above ML jobs. As of version 2.0.0 of this package, these rules are available as part of the Detection Engine, and can be found using the tag <code class="literal">Use Case: Lateral Movement Detection</code>. See this <a href="/guide/en/security/current/prebuilt-rules-management.html#load-prebuilt-rules" class="ulink" target="_top">documentation</a> for more information on importing and enabling the rules.
</li>
<li class="listitem">
<span class="strong strong"><strong>Use with Living off the Land Detection</strong></span>: This integration package can be used along with Living off the Land detection, see the section Install Living off the Land package to detect malicious processes.
</li>
</ol>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="images/lmd/lmdrules.png" alt="Data Exfiltration Detection Rules">
</div>
</div>
<p><em>In Security &gt; Rules, filtering with the “Use Case: Lateral Movement Detection” tag</em></p>
<div class="position-relative"><h3><a id="lmd-dashboard"></a>Dashboard</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/lmd/index.asciidoc">edit</a></div>
<p>After the anomaly detectors and the data views for the dashboard are configured, the <span class="strong strong"><strong>Lateral Movement Detection Dashboard</strong></span> is available under <span class="strong strong"><strong>Analytics &gt; Dashboard</strong></span>. This dashboard gives an overview of anomalies triggered for the lateral movement detection package.</p>
<div class="position-relative"><h4><a id="lmd-install-problemchild-package-to-detect-malicious-processes"></a>Install ProblemChild package to detect malicious processes</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/lmd/index.asciidoc">edit</a></div>
<p>To detect malicious RDP processes started in a session, install the <a href="https://docs.elastic.co/integrations/problemchild" class="ulink" target="_top">Living off the Land Attack (LotL) Detection package</a>. Follow the steps under the package <a href="https://docs.elastic.co/integrations/problemchild" class="ulink" target="_top">overview</a> to install the related assets. Use the below filter query to examine model predictions on RDP events only.</p>
<p>Clone the anomaly detection jobs available under the Living off the Land Attack (LotL) Detection package and follow the below steps to customize them only to process Windows RDP events in the datafeed:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Click on the <span class="strong strong"><strong>Actions</strong></span> panel at the right-most corner of the anomaly detection job and then select the <span class="strong strong"><strong>Edit job</strong></span> option.
</li>
<li class="listitem">
Under the <span class="strong strong"><strong>Datafeed</strong></span> panel, enter the below query to filter malicious RDP processes.
</li>
</ol>
</div>
<div class="pre_wrapper lang-txt">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-txt">{
  "bool": {
    "minimum_should_match": 1,
    "should": [
      {
        "match": {
          "problemchild.prediction": 1
        }
      },
      {
        "match": {
          "blocklist_label": 1
        }
      }
    ],
    "must_not": [
      {
        "terms": {
          "user.name": [
            "system"
          ]
        }
      }
    ],
    "filter": [
      {
        "exists": {
          "field": "process.Ext.session_info.client_address"
        }
      },
      {
        "exists": {
          "field": "process.Ext.authentication_id"
        }
      },
      {
        "exists": {
          "field": "host.ip"
        }
      },
      {
        "term": {
          "event.category": "process"
        }
      },
      {
        "term": {
          "process.Ext.session_info.logon_type": "RemoteInteractive"
        }
      }
    ]
  }
}</pre>
</div>
<div class="position-relative"><h3><a id="lmd-anomaly-detection-jobs"></a>Anomaly Detection Jobs</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/lmd/index.asciidoc">edit</a></div>
<p>Detects potential lateral movement activity by identifying malicious file transfers and RDP sessions in an environment.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Job</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>lmd_high_count_remote_file_transfer</p></td>
<td align="left" valign="top"><p>Detects unusually high file transfers to a remote host in the network.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>lmd_high_file_size_remote_file_transfer</p></td>
<td align="left" valign="top"><p>Detects unusually high size of files shared with a remote host in the network.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>lmd_rare_file_extension_remote_transfer</p></td>
<td align="left" valign="top"><p>Detects rare file extensions shared with a remote host in the network.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>lmd_rare_file_path_remote_transfer</p></td>
<td align="left" valign="top"><p>Detects unusual folders and directories on which a file is transferred (by a host).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>lmd_high_mean_rdp_session_duration</p></td>
<td align="left" valign="top"><p>Detects unusually high mean of RDP session duration.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>lmd_high_var_rdp_session_duration</p></td>
<td align="left" valign="top"><p>Detects unusually high variance in RDP session duration.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>lmd_high_sum_rdp_number_of_processes</p></td>
<td align="left" valign="top"><p>Detects unusually high number of processes started in a single RDP session.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>lmd_unusual_time_weekday_rdp_session_start</p></td>
<td align="left" valign="top"><p>Detects an RDP session started at an usual time or weekday.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>lmd_high_rdp_distinct_count_source_ip_for_destination</p></td>
<td align="left" valign="top"><p>Detects a high count of source IPs making an RDP connection with a single destination IP.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>lmd_high_rdp_distinct_count_destination_ip_for_source</p></td>
<td align="left" valign="top"><p>Detects a high count of destination IPs establishing an RDP connection with a single source IP.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>lmd_high_mean_rdp_process_args</p></td>
<td align="left" valign="top"><p>Detects unusually high number of process arguments in an RDP session.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="position-relative"><h3><a id="lmd-v200-and-beyond"></a>v2.0.0 and beyond</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/lmd/index.asciidoc">edit</a></div>
<p>v2.0.0 of the package introduces breaking changes, namely deprecating detection rules from the package. To continue receiving updates to Lateral Movement Detection, we recommend upgrading to v2.0.0 after doing the following:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Delete existing ML jobs: Navigate to <span class="strong strong"><strong>Machine Learning &gt; Anomaly Detection</strong></span> and delete jobs corresponding to the following IDs:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
high-count-remote-file-transfer
</li>
<li class="listitem">
high-file-size-remote-file-transfer
</li>
<li class="listitem">
rare-file-extension-remote-transfer
</li>
<li class="listitem">
rare-file-path-remote-transfer
</li>
<li class="listitem">
high-mean-rdp-session-duration
</li>
<li class="listitem">
high-var-rdp-session-duration
</li>
<li class="listitem">
high-sum-rdp-number-of-processes
</li>
<li class="listitem">
unusual-time-weekday-rdp-session-start
</li>
<li class="listitem">
high-rdp-distinct-count-source-ip-for-destination
</li>
<li class="listitem">
high-rdp-distinct-count-destination-ip-for-source
</li>
<li class="listitem">
high-mean-rdp-process-args
</li>
</ul>
</div>
</li>
</ul>
</div>
<p>Depending on the version of the package you&#8217;re using, you might also be able to search for the above jobs using the group <code class="literal">lateral_movement</code>.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Uninstall existing rules associated with this package: Navigate to <span class="strong strong"><strong>Security &gt; Rules</strong></span> and delete the following rules:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Spike in Remote File Transfers
</li>
<li class="listitem">
Unusual Remote File Size
</li>
<li class="listitem">
Unusual Remote File Directory
</li>
<li class="listitem">
Unusual Remote File Extension
</li>
<li class="listitem">
Malicious Remote File Creation
</li>
<li class="listitem">
Remote File Creation on a Sensitive Directory
</li>
<li class="listitem">
Spike in number of processes in an RDP session
</li>
<li class="listitem">
High mean of RDP session duration
</li>
<li class="listitem">
High variance in RDP session duration
</li>
<li class="listitem">
Unusually high number of process arguments in an RDP session
</li>
<li class="listitem">
Spike in number of connections made to a source IP
</li>
<li class="listitem">
Spike in number of connections made to a destination IP
</li>
<li class="listitem">
Unusual time or day for an RDP session start
</li>
</ul>
</div>
</li>
</ul>
</div>
<p>Depending on the version of the package you&#8217;re using, you might also be able to search for the above rules using the tag <code class="literal">Lateral Movement</code>.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Upgrade the Lateral Movement Detection package to v2.0.0 using the steps <a href="/guide/en/fleet/current/upgrade-integration.html" class="ulink" target="_top">here</a>
</li>
<li class="listitem">
Install the new rules as described in the <em>Enabling detection rules</em> section below
</li>
</ul>
</div>
<p>In version 2.1.2, the package ignores data in cold and frozen data tiers to reduce heap memory usage, avoid running on outdated data, and to follow best practices.</p>
<div class="position-relative"><h3><a id="lmd-licensing"></a>Licensing</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/lmd/index.asciidoc">edit</a></div>
<p>Usage in production requires that you have a license key that permits use of machine learning features.</p>
<div class="position-relative"><h3><a id="lmd-changelog"></a>Changelog</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/lmd/index.asciidoc">edit</a></div>
<details>
<summary class="title"><span class="strong strong"><strong>Changelog</strong></span></summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Version</th>
<th align="left" valign="top">Details</th>
<th align="left" valign="top">Kibana version(s)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>2.2.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-bug"></span> <span class="strong strong"><strong>Bug fix</strong></span> (<a href="https://github.com/elastic/integrations/pull/12427" class="ulink" target="_top">View pull request</a>)<br>
Fix bug in the pivot transform</p>
</td>
<td align="left" valign="top"><p>8.9.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>2.1.5</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/12168" class="ulink" target="_top">View pull request</a>)<br>
Add agent policy documentation</p>
</td>
<td align="left" valign="top"><p>8.9.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>2.1.4</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/10820" class="ulink" target="_top">View pull request</a>)<br>
Remove scripted_metric aggregation from pivot transform</p>
</td>
<td align="left" valign="top"><p>8.9.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>2.1.3</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/9791" class="ulink" target="_top">View pull request</a>)<br>
Improve package installation documentation</p>
</td>
<td align="left" valign="top"><p>8.9.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>2.1.2</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/8500" class="ulink" target="_top">View pull request</a>)<br>
Add query settings to ignore frozen and cold data tiers</p>
</td>
<td align="left" valign="top"><p>8.9.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>2.1.1</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/8320" class="ulink" target="_top">View pull request</a>)<br>
Add unattended flag for Serverless</p>
</td>
<td align="left" valign="top"><p>8.9.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>2.1.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/8121" class="ulink" target="_top">View pull request</a>)<br>
Add serverless support</p>
</td>
<td align="left" valign="top"><p>8.9.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>2.0.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/7901" class="ulink" target="_top">View pull request</a>)<br>
Removing detection rules from the package</p>
</td>
<td align="left" valign="top"><p>8.9.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.0.2</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/6588" class="ulink" target="_top">View pull request</a>)<br>
Added additional ml jobs and security rules to the package</p>
</td>
<td align="left" valign="top"><p>8.8.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.0.1</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/6241" class="ulink" target="_top">View pull request</a>)<br>
Add the Advanced Analytics (UEBA) subcategory</p>
</td>
<td align="left" valign="top"><p>8.5.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.0.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/4974" class="ulink" target="_top">View pull request</a>)<br>
Added dashboard and released the package in production</p>
</td>
<td align="left" valign="top"><p>8.5.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.0.1</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/4833" class="ulink" target="_top">View pull request</a>)<br>
Initial release of the package</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="lastpass.html">« LastPass</a>
</span>
<span class="next">
<a href="linux.html">Linux Integration »</a>
</span>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>

                        <!-- Feedback widget -->
                        <div id="feedbackWidgetContainer"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


        <div id='elastic-footer'></div>
        <script src='https://www.elastic.co/elastic-footer.js'></script>
        <!-- Footer Section end-->

      </section>
    </div>

    <!-- Feedback modal -->
    <div id="feedbackModalContainer"></div>

    <script src="/guide/static/jquery.js"></script>
    <script type="text/javascript" src="/guide/static/docs-v1.js"></script>
    <script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
