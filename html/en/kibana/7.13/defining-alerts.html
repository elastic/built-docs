<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<meta name="description" content="Add interactive capabilities to your dashboard, such as controls that allow you to apply dashboard-level filters, and drilldowns that allow you to navigate to other dashboards and external websites.">
<meta name="keywords" content="administrator, analyst, concept, task, analyze, dashboard, controls, drilldowns">
<title>Defining rules | Kibana Guide [7.13] | Elastic</title>
<meta class="elastic" name="content" content="Defining rules | Kibana Guide [7.13]">

<link rel="home" href="index.html" title="Kibana Guide [7.13]"/>
<link rel="up" href="alerting-getting-started.html" title="Alerting"/>
<link rel="prev" href="alerting-getting-started.html" title="Alerting"/>
<link rel="next" href="alert-management.html" title="Managing rules"/>
<meta class="elastic" name="product_version" content="7.13"/>
<meta class="elastic" name="product_name" content="Kibana"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Kibana/Reference/7.13"/>
<meta name="DC.subject" content="Kibana"/>
<meta name="DC.identifier" content="7.13"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <!--© 2015-2022 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  <div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Kibana Guide [7.13]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="alerting-getting-started.html">Alerting</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="alerting-getting-started.html">« Alerting</a>
</span>
<span class="next">
<a href="alert-management.html">Managing rules »</a>
</span>
</div>
<div class="chapter xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="defining-alerts"></a>Defining rules<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.13/docs/user/alerting/defining-rules.asciidoc">edit</a></h2>
</div></div></div>
<p>Kibana alerting rules can be created in a variety of apps including <a class="xref" href="xpack-apm.html" title="APM"><span class="strong strong"><strong>APM</strong></span></a>, <a class="xref" href="xpack-ml.html" title="Machine learning"><span class="strong strong"><strong>Machine Learning</strong></span></a>, <a class="xref" href="observability.html#metrics-app" title="Metrics"><span class="strong strong"><strong>Metrics</strong></span></a>, <a class="xref" href="xpack-siem.html" title="Elastic Security overview"><span class="strong strong"><strong>Security</strong></span></a>, <a class="xref" href="observability.html#uptime-app" title="Uptime"><span class="strong strong"><strong>Uptime</strong></span></a> and from the <a class="xref" href="management.html" title="Stack Management"><span class="strong strong"><strong>Management</strong></span></a> UI. While alerting details may differ from app to app, they share a common interface for defining and configuring rules that this section describes in more detail.</p>
<h3><a id="_create_a_rule"></a>Create a rule<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.13/docs/user/alerting/defining-rules.asciidoc">edit</a></h3>
<p>When you create a rule, you must define the rule details, conditions, and actions.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<a class="xref" href="defining-alerts.html#defining-alerts-general-details" title="General rule details">General rule details</a>
</li>
<li class="listitem">
<a class="xref" href="defining-alerts.html#defining-alerts-type-conditions" title="Rule type and conditions">Rule type and conditions</a>
</li>
<li class="listitem">
<a class="xref" href="defining-alerts.html#defining-alerts-actions-details" title="Action type and action details">Action type and action details</a>
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/rule-flyout-sections.png" alt="The three sections of a rule definition">
</div>
</div>
<h3><a id="defining-alerts-general-details"></a>General rule details<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.13/docs/user/alerting/defining-rules.asciidoc">edit</a></h3>
<p>All rules share the following four properties.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/rule-flyout-general-details.png" alt="All rules have name, tags, check every, and notify properties in common">
</div>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Name
</span>
</dt>
<dd>
The name of the rule. While this name does not have to be unique, the name can be referenced in actions and also appears in the searchable rule listing in the management UI. A distinctive name can help identify and find a rule.
</dd>
<dt>
<span class="term">
Tags
</span>
</dt>
<dd>
A list of tag names that can be applied to a rule. Tags can help you organize and find rules, because tags appear in the rule listing in the management UI which is searchable by tag.
</dd>
<dt>
<span class="term">
Check every
</span>
</dt>
<dd>
This value determines how frequently the rule conditions below are checked. Note that the timing of background rule checks are not guaranteed, particularly for intervals of less than 10 seconds. See <a class="xref" href="alerting-production-considerations.html" title="Alerting production considerations">Alerting production considerations</a> for more information.
</dd>
<dt>
<span class="term">
Notify
</span>
</dt>
<dd>
<p>
This value limits how often actions are repeated when an alert remains active across rule checks. See <a class="xref" href="alerting-getting-started.html#alerting-concepts-suppressing-duplicate-notifications" title="Suppressing duplicate notifications">Suppressing duplicate notifications</a> for more information.<br>
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Only on status change</strong></span>: Actions are not repeated when an alert remains active across checks. Actions run only when the alert status changes.
</li>
<li class="listitem">
<span class="strong strong"><strong>Every time alert is active</strong></span>: Actions are repeated when an alert remains active across checks.
</li>
<li class="listitem">
<span class="strong strong"><strong>On a custom action interval</strong></span>: Actions are suppressed for the throttle interval, but repeat when an alert remains active across checks for a duration longer than the throttle interval.
</li>
</ul>
</div>
</dd>
</dl>
</div>
<h3><a id="defining-alerts-type-conditions"></a>Rule type and conditions<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.13/docs/user/alerting/defining-rules.asciidoc">edit</a></h3>
<p>Depending upon the Kibana app and context, you may be prompted to choose the type of rule you wish to create. Some apps will pre-select the type of rule for you.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/rule-flyout-rule-type-selection.png" alt="Choosing the type of rule to create">
</div>
</div>
<p>Each rule type provides its own way of defining the conditions to detect, but an expression formed by a series of clauses is a common pattern. Each clause has a UI control that allows you to define the clause. For example, in an index threshold rule the <code class="literal">WHEN</code> clause allows you to select an aggregation operation to apply to a numeric field.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/rule-flyout-rule-conditions.png" alt="UI for defining rule conditions on an index threshold rule">
</div>
</div>
<h3><a id="defining-alerts-actions-details"></a>Action type and action details<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.13/docs/user/alerting/defining-rules.asciidoc">edit</a></h3>
<p>To add an action to a rule, you first select the type of connector:</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/rule-flyout-connector-type-selection.png" alt="UI for selecting an action type">
</div>
</div>
<p>When an alert matches a condition, the rule is marked as <em>Active</em> and assigned an action group. The actions in that group are triggered.
When the condition is no longer detected, the rule is assigned to the <em>Recovered</em> action group, which triggers any actions assigned to that group.</p>
<p><span class="strong strong"><strong>Run When</strong></span> allows you to assign an action to an action group. This will trigger the action in accordance with your <span class="strong strong"><strong>Notify</strong></span> setting.</p>
<p>Each action must specify a <a class="xref" href="alerting-getting-started.html#alerting-concepts-connectors" title="Connectors">connector</a> instance. If no connectors exist for that action type, click <span class="strong strong"><strong>Add connector</strong></span> to create one.</p>
<p>Each action type exposes different properties. For example an email action allows you to set the recipients, the subject, and a message body in markdown format. See <a class="xref" href="action-types.html" title="Connectors"><em>Connectors</em></a> for details on the types of actions provided by Kibana and their properties.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/rule-flyout-action-details.png" alt="UI for defining an email action">
</div>
</div>
<h4><a id="defining-alerts-actions-variables"></a>Action variables<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.13/docs/user/alerting/defining-rules.asciidoc">edit</a></h4>
<p>Using the <a href="https://mustache.github.io/" class="ulink" target="_top">Mustache</a> template syntax <code class="literal">{{variable name}}</code>, you can pass rule values at the time a condition is detected to an action. You can access the list of available variables using the "add variable" button. Although available variables differ by rule type, all rule types pass the following variables:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">rule.id</code>
</span>
</dt>
<dd>
The ID of the rule.
</dd>
<dt>
<span class="term">
<code class="literal">rule.name</code>
</span>
</dt>
<dd>
The name of the rule.
</dd>
<dt>
<span class="term">
<code class="literal">rule.spaceId</code>
</span>
</dt>
<dd>
The ID of the space for the rule.
</dd>
<dt>
<span class="term">
<code class="literal">rule.tags</code>
</span>
</dt>
<dd>
The list of tags applied to the rule.
</dd>
<dt>
<span class="term">
<code class="literal">date</code>
</span>
</dt>
<dd>
The date the rule scheduled the action, in ISO format.
</dd>
<dt>
<span class="term">
<code class="literal">alert.id</code>
</span>
</dt>
<dd>
The ID of the alert that scheduled the action.
</dd>
<dt>
<span class="term">
<code class="literal">alert.actionGroup</code>
</span>
</dt>
<dd>
The ID of the action group of the alert that scheduled the action.
</dd>
<dt>
<span class="term">
<code class="literal">alert.actionSubgroup</code>
</span>
</dt>
<dd>
The action subgroup of the alert that scheduled the action.
</dd>
<dt>
<span class="term">
<code class="literal">alert.actionGroupName</code>
</span>
</dt>
<dd>
The name of the action group of the alert that scheduled the action.
</dd>
<dt>
<span class="term">
<code class="literal">kibanaBaseUrl</code>
</span>
</dt>
<dd>
The configured <a class="xref" href="settings.html#server-publicBaseUrl"><code class="literal">server.publicBaseUrl</code></a>. If not configured, this will be empty.
</dd>
</dl>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="images/rule-flyout-action-variables.png" alt="Passing rule values to an action">
</div>
</div>
<p>Some cases exist where the variable values will be "escaped", when used in a context where escaping is needed:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For the <a class="xref" href="email-action-type.html" title="Email connector and action">Email</a> connector, the <code class="literal">message</code> action configuration property escapes any characters that would be interpreted as Markdown.
</li>
<li class="listitem">
For the <a class="xref" href="slack-action-type.html" title="Slack connector and action">Slack</a> connector, the <code class="literal">message</code> action configuration property escapes any characters that would be interpreted as Slack Markdown.
</li>
<li class="listitem">
For the <a class="xref" href="webhook-action-type.html" title="Webhook connector and action">Webhook</a> connector, the <code class="literal">body</code> action configuration property escapes any characters that are invalid in JSON string values.
</li>
</ul>
</div>
<p>Mustache also supports "triple braces" of the form <code class="literal">{{{variable name}}}</code>, which indicates no escaping should be done at all.  Care should be used when using this form, as it could end up rendering the variable content in such a way as to make the resulting parameter invalid or formatted incorrectly.</p>
<p>Each rule type defines additional variables as properties of the variable <code class="literal">context</code>.  For example, if a rule type defines a variable <code class="literal">value</code>, it can be used in an action parameter as <code class="literal">{{context.value}}</code>.</p>
<p>For diagnostic or exploratory purposes, action variables whose values are objects, such as <code class="literal">context</code>, can be referenced directly as variables.  The resulting value will be a JSON representation of the object.  For example, if an action parameter includes <code class="literal">{{context}}</code>, it will expand to the JSON representation of all the variables and values provided by the rule type.</p>
<p>You can attach more than one action. Clicking the "Add action" button will prompt you to select another rule type and repeat the above steps again.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/rule-flyout-add-action.png" alt="You can add multiple actions on a rule">
</div>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Actions are not required on rules. You can run a rule without actions to understand its behavior, and then <a class="xref" href="alert-action-settings-kb.html#action-settings" title="Action settings">configure actions</a> later.</p>
</div>
</div>
<h3><a id="_manage_rules"></a>Manage rules<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.13/docs/user/alerting/defining-rules.asciidoc">edit</a></h3>
<p>To modify a rule after it was created, including muting or disabling it, use the <a class="xref" href="alert-management.html" title="Managing rules">rule listing in the Management UI</a>.</p>
</div>
<div class="navfooter">
<span class="prev">
<a href="alerting-getting-started.html">« Alerting</a>
</span>
<span class="next">
<a href="alert-management.html">Managing rules »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
