<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<meta name="description" content="A list of the supported authentication mechanisms in Kibana.">
<meta name="keywords" content="administrator, concept, security, authentication">
<title>Audit logs | Kibana Guide [7.14] | Elastic</title>
<meta class="elastic" name="content" content="Audit logs | Kibana Guide [7.14]">

<link rel="home" href="index.html" title="Kibana Guide [7.14]"/>
<link rel="up" href="using-kibana-with-security.html" title="Configure security in Kibana"/>
<link rel="prev" href="elasticsearch-mutual-tls.html" title="Mutual TLS authentication between Kibana and Elasticsearch"/>
<link rel="next" href="xpack-security-access-agreement.html" title="Access agreement"/>
<meta class="elastic" name="product_version" content="7.14"/>
<meta class="elastic" name="product_name" content="Kibana"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Kibana/Reference/7.14"/>
<meta name="DC.subject" content="Kibana"/>
<meta name="DC.identifier" content="7.14"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <!--© 2015-2022 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  <div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Kibana Guide [7.14]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="setup.html">Set up</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="using-kibana-with-security.html">Configure security in Kibana</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="elasticsearch-mutual-tls.html">« Mutual TLS authentication between Kibana and Elasticsearch</a>
</span>
<span class="next">
<a href="xpack-security-access-agreement.html">Access agreement »</a>
</span>
</div>
<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="xpack-security-audit-logging"></a>Audit logs<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.14/docs/user/security/audit-logging.asciidoc">edit</a></h2>
</div></div></div>
<p>Audit logging is a <a href="/subscriptions" class="ulink" target="_top">subscription feature</a> that you can enable to keep track of security-related events,
such as authorization success and failures. Logging these events enables you to monitor Kibana for suspicious activity and provides evidence
in the event of an attack.</p>
<p>Use the Kibana audit logs in conjunction with <a href="/guide/en/elasticsearch/reference/7.14/enable-audit-logging.html" class="ulink" target="_top">Elasticsearch audit logging</a> to get a
holistic view of all security related events. Kibana defers to the Elasticsearch security
model for authentication, data index authorization, and features that are driven
by cluster-wide privileges. For more information on enabling audit logging in
Elasticsearch, refer to <a href="/guide/en/elasticsearch/reference/7.14/auditing.html" class="ulink" target="_top">Auditing security events</a>.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Audit logs are <span class="strong strong"><strong>disabled</strong></span> by default. To enable this functionality, you must
set <code class="literal">xpack.security.audit.enabled</code> to <code class="literal">true</code> in <code class="literal">kibana.yml</code>.</p>
</div>
</div>
<p>The current version of the audit logger uses the standard Kibana logging output,
which can be configured in <code class="literal">kibana.yml</code>. For more information, refer to <a class="xref" href="settings.html" title="Configure Kibana"><em>Configure Kibana</em></a>.
The audit logger uses a separate logger and can be configured using
the options in <a class="xref" href="security-settings-kb.html#audit-logging-settings" title="Audit logging settings">Audit logging settings</a>.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_audit_event_types"></a>Audit event types<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.14/docs/user/security/audit-logging.asciidoc">edit</a></h3>
</div></div></div>
<p>When you are auditing security events, each request can generate multiple audit
events. The following is a list of the events that can be generated:</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">saved_objects_authorization_success</code></p></td>
<td align="left" valign="top"><p>Logged when a user is authorized to access a saved
                                             objects when using a role with <a class="xref" href="kibana-privileges.html" title="Kibana privileges">Kibana privileges</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">saved_objects_authorization_failure</code></p></td>
<td align="left" valign="top"><p>Logged when a user isn&#8217;t authorized to access a saved
                                             objects when using a role with <a class="xref" href="kibana-privileges.html" title="Kibana privileges">Kibana privileges</a></p></td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="xpack-security-ecs-audit-logging"></a>ECS audit events<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.14/docs/user/security/audit-logging.asciidoc">edit</a></h3>
</div></div></div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>The following events are only logged if the ECS audit logger is enabled.
For information on how to configure <code class="literal">xpack.security.audit.appender</code>, refer to
<a class="xref" href="security-settings-kb.html#ecs-audit-logging-settings" title="ECS audit logging settings">ECS audit logging settings</a>.</p>
</div>
</div>
<p>Refer to the table of events that can be logged for auditing purposes.</p>
<p>Each event is broken down into <a class="xref" href="xpack-security-audit-logging.html#field-event-category">category</a>, <a class="xref" href="xpack-security-audit-logging.html#field-event-type">type</a>, <a class="xref" href="xpack-security-audit-logging.html#field-event-action">action</a> and
<a class="xref" href="xpack-security-audit-logging.html#field-event-outcome">outcome</a> fields to make it easy to filter, query and aggregate the resulting logs. The <a class="xref" href="xpack-security-audit-logging.html#field-trace-id">trace.id</a>
field can be used to correlate multiple events that originate from the same request.</p>
<p>Refer to <a class="xref" href="xpack-security-audit-logging.html#xpack-security-ecs-audit-schema" title="ECS audit schema">ECS audit schema</a> for a table of fields that get logged with audit event.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>To ensure that a record of every operation is persisted even in case of an
unexpected error, asynchronous write operations are logged immediately after all
authorization checks have passed, but before the response from Elasticsearch is received.
Refer to the corresponding Elasticsearch logs for potential write errors.</p>
</div>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<tbody>
<tr>
<td align="left" colspan="3" valign="top">
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_category_authentication"></a>Category: authentication<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.14/docs/user/security/audit-logging.asciidoc">edit</a></h4>
</div></div></div>

</div>

</td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Action</strong></span></p></td>
<td align="left" valign="top"><p><span class="strong strong"><strong>Outcome</strong></span></p></td>
<td align="left" valign="top"><p><span class="strong strong"><strong>Description</strong></span></p></td>
</tr>
<tr>
<td align="left" rowspan="2" valign="top"><p><code class="literal">user_login</code></p></td>
<td align="left" valign="top"><p><code class="literal">success</code></p></td>
<td align="left" valign="top"><p>User has logged in successfully.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">failure</code></p></td>
<td align="left" valign="top"><p>Failed login attempt (e.g. due to invalid credentials).</p></td>
</tr>
<tr>
<td align="left" colspan="3" valign="top">
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_category_database"></a>Category: database<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.14/docs/user/security/audit-logging.asciidoc">edit</a></h4>
</div></div></div>
<div class="section">
<div class="titlepage"><div><div>
<h5 class="title"><a id="_type_creation"></a>Type: creation<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.14/docs/user/security/audit-logging.asciidoc">edit</a></h5>
</div></div></div>

</div>

</div>

</td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Action</strong></span></p></td>
<td align="left" valign="top"><p><span class="strong strong"><strong>Outcome</strong></span></p></td>
<td align="left" valign="top"><p><span class="strong strong"><strong>Description</strong></span></p></td>
</tr>
<tr>
<td align="left" rowspan="2" valign="top"><p><code class="literal">saved_object_create</code></p></td>
<td align="left" valign="top"><p><code class="literal">unknown</code></p></td>
<td align="left" valign="top"><p>User is creating a saved object.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">failure</code></p></td>
<td align="left" valign="top"><p>User is not authorized to create a saved object.</p></td>
</tr>
<tr>
<td align="left" rowspan="2" valign="top"><p><code class="literal">saved_object_open_point_in_time</code></p></td>
<td align="left" valign="top"><p><code class="literal">unknown</code></p></td>
<td align="left" valign="top"><p>User is creating a Point In Time to use when querying saved objects.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">failure</code></p></td>
<td align="left" valign="top"><p>User is not authorized to create a Point In Time for the provided saved object types.</p></td>
</tr>
<tr>
<td align="left" rowspan="2" valign="top"><p><code class="literal">connector_create</code></p></td>
<td align="left" valign="top"><p><code class="literal">unknown</code></p></td>
<td align="left" valign="top"><p>User is creating a connector.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">failure</code></p></td>
<td align="left" valign="top"><p>User is not authorized to create a connector.</p></td>
</tr>
<tr>
<td align="left" rowspan="2" valign="top"><p><code class="literal">rule_create</code></p></td>
<td align="left" valign="top"><p><code class="literal">unknown</code></p></td>
<td align="left" valign="top"><p>User is creating a rule.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">failure</code></p></td>
<td align="left" valign="top"><p>User is not authorized to create a rule.</p></td>
</tr>
<tr>
<td align="left" rowspan="2" valign="top"><p><code class="literal">space_create</code></p></td>
<td align="left" valign="top"><p><code class="literal">unknown</code></p></td>
<td align="left" valign="top"><p>User is creating a space.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">failure</code></p></td>
<td align="left" valign="top"><p>User is not authorized to create a space.</p></td>
</tr>
<tr>
<td align="left" colspan="3" valign="top">
<div class="section">
<div class="titlepage"><div><div>
<h5 class="title"><a id="_type_change"></a>Type: change<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.14/docs/user/security/audit-logging.asciidoc">edit</a></h5>
</div></div></div>

</div>

</td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Action</strong></span></p></td>
<td align="left" valign="top"><p><span class="strong strong"><strong>Outcome</strong></span></p></td>
<td align="left" valign="top"><p><span class="strong strong"><strong>Description</strong></span></p></td>
</tr>
<tr>
<td align="left" rowspan="2" valign="top"><p><code class="literal">saved_object_update</code></p></td>
<td align="left" valign="top"><p><code class="literal">unknown</code></p></td>
<td align="left" valign="top"><p>User is updating a saved object.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">failure</code></p></td>
<td align="left" valign="top"><p>User is not authorized to update a saved object.</p></td>
</tr>
<tr>
<td align="left" rowspan="2" valign="top"><p><code class="literal">saved_object_add_to_spaces</code></p></td>
<td align="left" valign="top"><p><code class="literal">unknown</code></p></td>
<td align="left" valign="top"><p>User is adding a saved object to other spaces.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">failure</code></p></td>
<td align="left" valign="top"><p>User is not authorized to add a saved object to other spaces.</p></td>
</tr>
<tr>
<td align="left" rowspan="2" valign="top"><p><code class="literal">saved_object_delete_from_spaces</code></p></td>
<td align="left" valign="top"><p><code class="literal">unknown</code></p></td>
<td align="left" valign="top"><p>User is removing a saved object from other spaces.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">failure</code></p></td>
<td align="left" valign="top"><p>User is not authorized to remove a saved object from other spaces.</p></td>
</tr>
<tr>
<td align="left" rowspan="2" valign="top"><p><code class="literal">saved_object_remove_references</code></p></td>
<td align="left" valign="top"><p><code class="literal">unknown</code></p></td>
<td align="left" valign="top"><p>User is removing references to a saved object.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">failure</code></p></td>
<td align="left" valign="top"><p>User is not authorized to remove references to a saved object.</p></td>
</tr>
<tr>
<td align="left" rowspan="2" valign="top"><p><code class="literal">connector_update</code></p></td>
<td align="left" valign="top"><p><code class="literal">unknown</code></p></td>
<td align="left" valign="top"><p>User is updating a connector.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">failure</code></p></td>
<td align="left" valign="top"><p>User is not authorized to update a connector.</p></td>
</tr>
<tr>
<td align="left" rowspan="2" valign="top"><p><code class="literal">rule_update</code></p></td>
<td align="left" valign="top"><p><code class="literal">unknown</code></p></td>
<td align="left" valign="top"><p>User is updating a rule.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">failure</code></p></td>
<td align="left" valign="top"><p>User is not authorized to update a rule.</p></td>
</tr>
<tr>
<td align="left" rowspan="2" valign="top"><p><code class="literal">rule_update_api_key</code></p></td>
<td align="left" valign="top"><p><code class="literal">unknown</code></p></td>
<td align="left" valign="top"><p>User is updating the API key of a rule.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">failure</code></p></td>
<td align="left" valign="top"><p>User is not authorized to update the API key of a rule.</p></td>
</tr>
<tr>
<td align="left" rowspan="2" valign="top"><p><code class="literal">rule_enable</code></p></td>
<td align="left" valign="top"><p><code class="literal">unknown</code></p></td>
<td align="left" valign="top"><p>User is enabling a rule.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">failure</code></p></td>
<td align="left" valign="top"><p>User is not authorized to enable a rule.</p></td>
</tr>
<tr>
<td align="left" rowspan="2" valign="top"><p><code class="literal">rule_disable</code></p></td>
<td align="left" valign="top"><p><code class="literal">unknown</code></p></td>
<td align="left" valign="top"><p>User is disabling a rule.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">failure</code></p></td>
<td align="left" valign="top"><p>User is not authorized to disable a rule.</p></td>
</tr>
<tr>
<td align="left" rowspan="2" valign="top"><p><code class="literal">rule_mute</code></p></td>
<td align="left" valign="top"><p><code class="literal">unknown</code></p></td>
<td align="left" valign="top"><p>User is muting a rule.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">failure</code></p></td>
<td align="left" valign="top"><p>User is not authorized to mute a rule.</p></td>
</tr>
<tr>
<td align="left" rowspan="2" valign="top"><p><code class="literal">rule_unmute</code></p></td>
<td align="left" valign="top"><p><code class="literal">unknown</code></p></td>
<td align="left" valign="top"><p>User is unmuting a rule.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">failure</code></p></td>
<td align="left" valign="top"><p>User is not authorized to unmute a rule.</p></td>
</tr>
<tr>
<td align="left" rowspan="2" valign="top"><p><code class="literal">rule_alert_mute</code></p></td>
<td align="left" valign="top"><p><code class="literal">unknown</code></p></td>
<td align="left" valign="top"><p>User is muting an alert.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">failure</code></p></td>
<td align="left" valign="top"><p>User is not authorized to mute an alert.</p></td>
</tr>
<tr>
<td align="left" rowspan="2" valign="top"><p><code class="literal">rule_alert_unmute</code></p></td>
<td align="left" valign="top"><p><code class="literal">unknown</code></p></td>
<td align="left" valign="top"><p>User is unmuting an alert.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">failure</code></p></td>
<td align="left" valign="top"><p>User is not authorized to unmute an alert.</p></td>
</tr>
<tr>
<td align="left" rowspan="2" valign="top"><p><code class="literal">space_update</code></p></td>
<td align="left" valign="top"><p><code class="literal">unknown</code></p></td>
<td align="left" valign="top"><p>User is updating a space.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">failure</code></p></td>
<td align="left" valign="top"><p>User is not authorized to update a space.</p></td>
</tr>
<tr>
<td align="left" colspan="3" valign="top">
<div class="section">
<div class="titlepage"><div><div>
<h5 class="title"><a id="_type_deletion"></a>Type: deletion<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.14/docs/user/security/audit-logging.asciidoc">edit</a></h5>
</div></div></div>

</div>

</td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Action</strong></span></p></td>
<td align="left" valign="top"><p><span class="strong strong"><strong>Outcome</strong></span></p></td>
<td align="left" valign="top"><p><span class="strong strong"><strong>Description</strong></span></p></td>
</tr>
<tr>
<td align="left" rowspan="2" valign="top"><p><code class="literal">saved_object_delete</code></p></td>
<td align="left" valign="top"><p><code class="literal">unknown</code></p></td>
<td align="left" valign="top"><p>User is deleting a saved object.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">failure</code></p></td>
<td align="left" valign="top"><p>User is not authorized to delete a saved object.</p></td>
</tr>
<tr>
<td align="left" rowspan="2" valign="top"><p><code class="literal">saved_object_close_point_in_time</code></p></td>
<td align="left" valign="top"><p><code class="literal">unknown</code></p></td>
<td align="left" valign="top"><p>User is deleting a Point In Time that was used to query saved objects.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">failure</code></p></td>
<td align="left" valign="top"><p>User is not authorized to delete a Point In Time.</p></td>
</tr>
<tr>
<td align="left" rowspan="2" valign="top"><p><code class="literal">connector_delete</code></p></td>
<td align="left" valign="top"><p><code class="literal">unknown</code></p></td>
<td align="left" valign="top"><p>User is deleting a connector.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">failure</code></p></td>
<td align="left" valign="top"><p>User is not authorized to delete a connector.</p></td>
</tr>
<tr>
<td align="left" rowspan="2" valign="top"><p><code class="literal">rule_delete</code></p></td>
<td align="left" valign="top"><p><code class="literal">unknown</code></p></td>
<td align="left" valign="top"><p>User is deleting a rule.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">failure</code></p></td>
<td align="left" valign="top"><p>User is not authorized to delete a rule.</p></td>
</tr>
<tr>
<td align="left" rowspan="2" valign="top"><p><code class="literal">space_delete</code></p></td>
<td align="left" valign="top"><p><code class="literal">unknown</code></p></td>
<td align="left" valign="top"><p>User is deleting a space.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">failure</code></p></td>
<td align="left" valign="top"><p>User is not authorized to delete a space.</p></td>
</tr>
<tr>
<td align="left" colspan="3" valign="top">
<div class="section">
<div class="titlepage"><div><div>
<h5 class="title"><a id="_type_access"></a>Type: access<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.14/docs/user/security/audit-logging.asciidoc">edit</a></h5>
</div></div></div>

</div>

</td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Action</strong></span></p></td>
<td align="left" valign="top"><p><span class="strong strong"><strong>Outcome</strong></span></p></td>
<td align="left" valign="top"><p><span class="strong strong"><strong>Description</strong></span></p></td>
</tr>
<tr>
<td align="left" rowspan="2" valign="top"><p><code class="literal">saved_object_get</code></p></td>
<td align="left" valign="top"><p><code class="literal">success</code></p></td>
<td align="left" valign="top"><p>User has accessed a saved object.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">failure</code></p></td>
<td align="left" valign="top"><p>User is not authorized to access a saved object.</p></td>
</tr>
<tr>
<td align="left" rowspan="2" valign="top"><p><code class="literal">saved_object_resolve</code></p></td>
<td align="left" valign="top"><p><code class="literal">success</code></p></td>
<td align="left" valign="top"><p>User has accessed a saved object.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">failure</code></p></td>
<td align="left" valign="top"><p>User is not authorized to access a saved object.</p></td>
</tr>
<tr>
<td align="left" rowspan="2" valign="top"><p><code class="literal">saved_object_find</code></p></td>
<td align="left" valign="top"><p><code class="literal">success</code></p></td>
<td align="left" valign="top"><p>User has accessed a saved object as part of a search operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">failure</code></p></td>
<td align="left" valign="top"><p>User is not authorized to search for saved objects.</p></td>
</tr>
<tr>
<td align="left" rowspan="2" valign="top"><p><code class="literal">connector_get</code></p></td>
<td align="left" valign="top"><p><code class="literal">success</code></p></td>
<td align="left" valign="top"><p>User has accessed a connector.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">failure</code></p></td>
<td align="left" valign="top"><p>User is not authorized to access a connector.</p></td>
</tr>
<tr>
<td align="left" rowspan="2" valign="top"><p><code class="literal">connector_find</code></p></td>
<td align="left" valign="top"><p><code class="literal">success</code></p></td>
<td align="left" valign="top"><p>User has accessed a connector as part of a search operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">failure</code></p></td>
<td align="left" valign="top"><p>User is not authorized to search for connectors.</p></td>
</tr>
<tr>
<td align="left" rowspan="2" valign="top"><p><code class="literal">rule_get</code></p></td>
<td align="left" valign="top"><p><code class="literal">success</code></p></td>
<td align="left" valign="top"><p>User has accessed a rule.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">failure</code></p></td>
<td align="left" valign="top"><p>User is not authorized to access a rule.</p></td>
</tr>
<tr>
<td align="left" rowspan="2" valign="top"><p><code class="literal">rule_find</code></p></td>
<td align="left" valign="top"><p><code class="literal">success</code></p></td>
<td align="left" valign="top"><p>User has accessed a rule as part of a search operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">failure</code></p></td>
<td align="left" valign="top"><p>User is not authorized to search for rules.</p></td>
</tr>
<tr>
<td align="left" rowspan="2" valign="top"><p><code class="literal">space_get</code></p></td>
<td align="left" valign="top"><p><code class="literal">success</code></p></td>
<td align="left" valign="top"><p>User has accessed a space.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">failure</code></p></td>
<td align="left" valign="top"><p>User is not authorized to access a space.</p></td>
</tr>
<tr>
<td align="left" rowspan="2" valign="top"><p><code class="literal">space_find</code></p></td>
<td align="left" valign="top"><p><code class="literal">success</code></p></td>
<td align="left" valign="top"><p>User has accessed a space as part of a search operation.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">failure</code></p></td>
<td align="left" valign="top"><p>User is not authorized to search for spaces.</p></td>
</tr>
<tr>
<td align="left" colspan="3" valign="top">
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_category_web"></a>Category: web<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.14/docs/user/security/audit-logging.asciidoc">edit</a></h4>
</div></div></div>

</div>

</td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Action</strong></span></p></td>
<td align="left" valign="top"><p><span class="strong strong"><strong>Outcome</strong></span></p></td>
<td align="left" valign="top"><p><span class="strong strong"><strong>Description</strong></span></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">http_request</code></p></td>
<td align="left" valign="top"><p><code class="literal">unknown</code></p></td>
<td align="left" valign="top"><p>User is making an HTTP request.</p></td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="xpack-security-ecs-audit-schema"></a>ECS audit schema<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.14/docs/user/security/audit-logging.asciidoc">edit</a></h3>
</div></div></div>
<p>Audit logs are written in JSON using <a href="/guide/en/ecs/1.6/index.html" class="ulink" target="_top">Elastic Common Schema (ECS)</a> specification.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<tbody>
<tr>
<td align="left" colspan="2" valign="top">
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_base_fields"></a>Base Fields<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.14/docs/user/security/audit-logging.asciidoc">edit</a></h4>
</div></div></div>

</div>

</td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Field</strong></span></p></td>
<td align="left" valign="top"><p><span class="strong strong"><strong>Description</strong></span></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">@timestamp</code></p></td>
<td align="left" valign="top"><p>Time when the event was generated.</p>
<p>Example: <code class="literal">2016-05-23T08:05:34.853Z</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">message</code></p></td>
<td align="left" valign="top"><p>Human readable description of the event.</p></td>
</tr>
<tr>
<td align="left" colspan="2" valign="top">
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_event_fields"></a>Event Fields<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.14/docs/user/security/audit-logging.asciidoc">edit</a></h4>
</div></div></div>

</div>

</td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Field</strong></span></p></td>
<td align="left" valign="top"><p><span class="strong strong"><strong>Description</strong></span></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a id="field-event-action"></a> <code class="literal">event.action</code></p></td>
<td align="left" valign="top"><p>The action captured by the event.</p>
<p>Refer to <a class="xref" href="xpack-security-audit-logging.html#xpack-security-ecs-audit-logging" title="ECS audit events">ECS audit events</a> for a table of possible actions.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a id="field-event-category"></a> <code class="literal">event.category</code></p></td>
<td align="left" valign="top"><p>High level category associated with the event.</p>
<p>This field is closely related to <code class="literal">event.type</code>, which is used as a subcategory.</p>
<p>Possible values:
<code class="literal">database</code>,
<code class="literal">web</code>,
<code class="literal">authentication</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a id="field-event-type"></a> <code class="literal">event.type</code></p></td>
<td align="left" valign="top"><p>Subcategory associated with the event.</p>
<p>This field can be used along with the <code class="literal">event.category</code> field to enable filtering events down to a level appropriate for single visualization.</p>
<p>Possible values:
<code class="literal">creation</code>,
<code class="literal">access</code>,
<code class="literal">change</code>,
<code class="literal">deletion</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a id="field-event-outcome"></a> <code class="literal">event.outcome</code></p></td>
<td align="left" valign="top"><p>Denotes whether the event represents a success or failure.</p>
<p>Possible values:
<code class="literal">success</code>,
<code class="literal">failure</code>,
<code class="literal">unknown</code></p></td>
</tr>
<tr>
<td align="left" colspan="2" valign="top">
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_user_fields"></a>User Fields<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.14/docs/user/security/audit-logging.asciidoc">edit</a></h4>
</div></div></div>

</div>

</td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Field</strong></span></p></td>
<td align="left" valign="top"><p><span class="strong strong"><strong>Description</strong></span></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">user.name</code></p></td>
<td align="left" valign="top"><p>Login name of the user.</p>
<p>Example: <code class="literal">jdoe</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">user.roles[]</code></p></td>
<td align="left" valign="top"><p>Set of user roles at the time of the event.</p>
<p>Example: <code class="literal">[kibana_admin, reporting_user]</code></p></td>
</tr>
<tr>
<td align="left" colspan="2" valign="top">
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_kibana_fields"></a>Kibana Fields<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.14/docs/user/security/audit-logging.asciidoc">edit</a></h4>
</div></div></div>

</div>

</td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Field</strong></span></p></td>
<td align="left" valign="top"><p><span class="strong strong"><strong>Description</strong></span></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">kibana.space_id</code></p></td>
<td align="left" valign="top"><p>ID of the space associated with the event.</p>
<p>Example: <code class="literal">default</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">kibana.session_id</code></p></td>
<td align="left" valign="top"><p>ID of the user session associated with the event.</p>
<p>Each login attempt results in a unique session id.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">kibana.saved_object.type</code></p></td>
<td align="left" valign="top"><p>Type of saved object associated with the event.</p>
<p>Example: <code class="literal">dashboard</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">kibana.saved_object.id</code></p></td>
<td align="left" valign="top"><p>ID of the saved object associated with the event.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">kibana.authentication_provider</code></p></td>
<td align="left" valign="top"><p>Name of the authentication provider associated with the event.</p>
<p>Example: <code class="literal">my-saml-provider</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">kibana.authentication_type</code></p></td>
<td align="left" valign="top"><p>Type of the authentication provider associated with the event.</p>
<p>Example: <code class="literal">saml</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">kibana.authentication_realm</code></p></td>
<td align="left" valign="top"><p>Name of the Elasticsearch realm that has authenticated the user.</p>
<p>Example: <code class="literal">native</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">kibana.lookup_realm</code></p></td>
<td align="left" valign="top"><p>Name of the Elasticsearch realm where the user details were retrieved from.</p>
<p>Example: <code class="literal">native</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">kibana.add_to_spaces[]</code></p></td>
<td align="left" valign="top"><p>Set of space IDs that a saved object is being shared to as part of the event.</p>
<p>Example: <code class="literal">[default, marketing]</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">kibana.delete_from_spaces[]</code></p></td>
<td align="left" valign="top"><p>Set of space IDs that a saved object is being removed from as part of the event.</p>
<p>Example: <code class="literal">[marketing]</code></p></td>
</tr>
<tr>
<td align="left" colspan="2" valign="top">
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_error_fields"></a>Error Fields<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.14/docs/user/security/audit-logging.asciidoc">edit</a></h4>
</div></div></div>

</div>

</td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Field</strong></span></p></td>
<td align="left" valign="top"><p><span class="strong strong"><strong>Description</strong></span></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">error.code</code></p></td>
<td align="left" valign="top"><p>Error code describing the error.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">error.message</code></p></td>
<td align="left" valign="top"><p>Error message.</p></td>
</tr>
<tr>
<td align="left" colspan="2" valign="top">
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_http_and_url_fields"></a>HTTP and URL Fields<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.14/docs/user/security/audit-logging.asciidoc">edit</a></h4>
</div></div></div>

</div>

</td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Field</strong></span></p></td>
<td align="left" valign="top"><p><span class="strong strong"><strong>Description</strong></span></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">http.request.method</code></p></td>
<td align="left" valign="top"><p>HTTP request method.</p>
<p>Example: <code class="literal">get</code>, <code class="literal">post</code>, <code class="literal">put</code>, <code class="literal">delete</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">url.domain</code></p></td>
<td align="left" valign="top"><p>Domain of the url.</p>
<p>Example: <code class="literal">www.elastic.co</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">url.path</code></p></td>
<td align="left" valign="top"><p>Path of the request.</p>
<p>Example: <code class="literal">/search</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">url.port</code></p></td>
<td align="left" valign="top"><p>Port of the request.</p>
<p>Example: <code class="literal">443</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">url.query</code></p></td>
<td align="left" valign="top"><p>The query field describes the query string of the request.</p>
<p>Example: <code class="literal">q=elasticsearch</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">url.scheme</code></p></td>
<td align="left" valign="top"><p>Scheme of the request.</p>
<p>Example: <code class="literal">https</code></p></td>
</tr>
<tr>
<td align="left" colspan="2" valign="top">
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_tracing_fields"></a>Tracing Fields<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.14/docs/user/security/audit-logging.asciidoc">edit</a></h4>
</div></div></div>

</div>

</td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Field</strong></span></p></td>
<td align="left" valign="top"><p><span class="strong strong"><strong>Description</strong></span></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a id="field-trace-id"></a> <code class="literal">trace.id</code></p></td>
<td align="left" valign="top"><p>Unique identifier allowing events of the same transaction from Kibana and Elasticsearch to be be correlated.</p></td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="xpack-security-ecs-audit-correlation"></a>Correlating ECS audit events<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.14/docs/user/security/audit-logging.asciidoc">edit</a></h3>
</div></div></div>
<p>Audit events can be correlated in two ways:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Multiple Kibana audit events that resulted from the same request can be correlated together.
</li>
<li class="listitem">
If <a href="/guide/en/elasticsearch/reference/7.14/enable-audit-logging.html" class="ulink" target="_top">Elasticsearch audit logging</a> is enabled, Kibana audit events from one request can be correlated with backend
calls that create Elasticsearch audit events.
</li>
</ol>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The examples below are simplified, many fields have been omitted and values have been shortened for clarity.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_example_1_correlating_multiple_kibana_audit_events"></a>Example 1: correlating multiple Kibana audit events<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.14/docs/user/security/audit-logging.asciidoc">edit</a></h4>
</div></div></div>
<p>When "thom" creates a new alerting rule, five audit events are written:</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{"event":{"action":"http_request","category":["web"],"outcome":"unknown"},"http":{"request":{"method":"post"}},"url":{"domain":"localhost","path":"/api/alerting/rule","port":5601,"scheme":"https"},"user":{"name":"thom","roles":["superuser"]},"kibana":{"space_id":"default","session_id":"3dHCZRB..."},"@timestamp":"2022-01-25T13:05:34.449-05:00","message":"User is requesting [/api/alerting/rule] endpoint","trace":{"id":"e300e06..."}}
{"event":{"action":"space_get","category":["database"],"type":["access"],"outcome":"success"},"kibana":{"space_id":"default","session_id":"3dHCZRB...","saved_object":{"type":"space","id":"default"}},"user":{"name":"thom","roles":["superuser"]},"@timestamp":"2022-01-25T13:05:34.454-05:00","message":"User has accessed space [id=default]","trace":{"id":"e300e06..."}}
{"event":{"action":"connector_get","category":["database"],"type":["access"],"outcome":"success"},"kibana":{"space_id":"default","session_id":"3dHCZRB...","saved_object":{"type":"action","id":"5e3b1ae..."}},"user":{"name":"thom","roles":["superuser"]},"@timestamp":"2022-01-25T13:05:34.948-05:00","message":"User has accessed connector [id=5e3b1ae...]","trace":{"id":"e300e06..."}}
{"event":{"action":"connector_get","category":["database"],"type":["access"],"outcome":"success"},"kibana":{"space_id":"default","session_id":"3dHCZRB...","saved_object":{"type":"action","id":"5e3b1ae..."}},"user":{"name":"thom","roles":["superuser"]},"@timestamp":"2022-01-25T13:05:34.956-05:00","message":"User has accessed connector [id=5e3b1ae...]","trace":{"id":"e300e06..."}}
{"event":{"action":"rule_create","category":["database"],"type":["creation"],"outcome":"unknown"},"kibana":{"space_id":"default","session_id":"3dHCZRB...","saved_object":{"type":"alert","id":"64517c3..."}},"user":{"name":"thom","roles":["superuser"]},"@timestamp":"2022-01-25T13:05:34.956-05:00","message":"User is creating rule [id=64517c3...]","trace":{"id":"e300e06..."}}</pre>
</div>
<p>All of these audit events can be correlated together by the same <code class="literal">trace.id</code> value <code class="literal">"e300e06..."</code>. The first event is the HTTP API call, the
next audit events are checks to validate the space and the connectors, and the last audit event is the actual rule creation.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_example_2_correlating_a_kibana_audit_event_with_elasticsearch_audit_events"></a>Example 2: correlating a Kibana audit event with Elasticsearch audit events<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.14/docs/user/security/audit-logging.asciidoc">edit</a></h4>
</div></div></div>
<p>When "thom" logs in, a "user_login" Kibana audit event is written:</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{"event":{"action":"user_login","category":["authentication"],"outcome":"success"},"user":{"name":"thom","roles":["superuser"]},"@timestamp":"2022-01-25T09:40:39.267-05:00","message":"User [thom] has logged in using basic provider [name=basic]","trace":{"id":"818cbf3..."}}</pre>
</div>
<p>The <code class="literal">trace.id</code> value <code class="literal">"818cbf3..."</code> in the Kibana audit event can be correlated with the <code class="literal">opaque_id</code> value in these six Elasticsearch audit events:</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{"type":"audit", "timestamp":"2022-01-25T09:40:38,604-0500", "event.action":"access_granted", "user.name":"thom", "user.roles":["superuser"], "request.id":"YCx8wxs...", "action":"cluster:admin/xpack/security/user/authenticate", "request.name":"AuthenticateRequest", "opaque_id":"818cbf3..."}
{"type":"audit", "timestamp":"2022-01-25T09:40:38,613-0500", "event.action":"access_granted", "user.name":"kibana_system", "user.roles":["kibana_system"], "request.id":"Ksx73Ad...", "action":"indices:data/write/index", "request.name":"IndexRequest", "indices":[".kibana_security_session_1"], "opaque_id":"818cbf3..."}
{"type":"audit", "timestamp":"2022-01-25T09:40:38,613-0500", "event.action":"access_granted", "user.name":"kibana_system", "user.roles":["kibana_system"], "request.id":"Ksx73Ad...", "action":"indices:data/write/bulk", "request.name":"BulkRequest", "opaque_id":"818cbf3..."}
{"type":"audit", "timestamp":"2022-01-25T09:40:38,613-0500", "event.action":"access_granted", "user.name":"kibana_system", "user.roles":["kibana_system"], "request.id":"Ksx73Ad...", "action":"indices:data/write/bulk[s]", "request.name":"BulkShardRequest", "indices":[".kibana_security_session_1"], "opaque_id":"818cbf3..."}
{"type":"audit", "timestamp":"2022-01-25T09:40:38,613-0500", "event.action":"access_granted", "user.name":"kibana_system", "user.roles":["kibana_system"], "request.id":"Ksx73Ad...", "action":"indices:data/write/index:op_type/create", "request.name":"BulkItemRequest", "indices":[".kibana_security_session_1"], "opaque_id":"818cbf3..."}
{"type":"audit", "timestamp":"2022-01-25T09:40:38,613-0500", "event.action":"access_granted", "user.name":"kibana_system", "user.roles":["kibana_system"], "request.id":"Ksx73Ad...", "action":"indices:data/write/bulk[s][p]", "request.name":"BulkShardRequest", "indices":[".kibana_security_session_1"], "opaque_id":"818cbf3..."}</pre>
</div>
<p>The Elasticsearch audit events show that "thom" authenticated, then subsequently "kibana_system" created a session for that user.</p>
</div>

</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="elasticsearch-mutual-tls.html">« Mutual TLS authentication between Kibana and Elasticsearch</a>
</span>
<span class="next">
<a href="xpack-security-access-agreement.html">Access agreement »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
