<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Snapshot repositories | Kibana Guide [7.2] | Elastic</title>
<link rel="home" href="index.html" title="Kibana Guide [7.2]"/>
<link rel="up" href="management.html" title="Management"/>
<link rel="prev" href="working-remote-clusters.html" title="Working with remote clusters"/>
<link rel="next" href="xpack-spaces.html" title="Spaces"/>
<meta name="DC.type" content="Learn/Docs/Kibana/Reference/7.2"/>
<meta name="DC.subject" content="Kibana"/>
<meta name="DC.identifier" content="7.2"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!--BEGIN QUALTRICS WEBSITE FEEDBACK SNIPPET-->
    <script type='text/javascript'>
      (function(){var g=function(e,h,f,g){
      this.get=function(a){for(var a=a+"=",c=document.cookie.split(";"),b=0,e=c.length;b<e;b++){for(var d=c[b];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return null};
      this.set=function(a,c){var b="",b=new Date;b.setTime(b.getTime()+6048E5);b="; expires="+b.toGMTString();document.cookie=a+"="+c+b+"; path=/; "};
      this.check=function(){var a=this.get(f);if(a)a=a.split(":");else if(100!=e)"v"==h&&(e=Math.random()>=e/100?0:100),a=[h,e,0],this.set(f,a.join(":"));else return!0;var c=a[1];if(100==c)return!0;switch(a[0]){case "v":return!1;case "r":return c=a[2]%Math.floor(100/c),a[2]++,this.set(f,a.join(":")),!c}return!0};
      this.go=function(){if(this.check()){var a=document.createElement("script");a.type="text/javascript";a.src=g;document.body&&document.body.appendChild(a)}};
      this.start=function(){var a=this;window.addEventListener?window.addEventListener("load",function(){a.go()},!1):window.attachEvent&&window.attachEvent("onload",function(){a.go()})}};
      try{(new g(100,"r","QSI_S_ZN_emkP0oSe9Qrn7kF","https://znemkp0ose9qrn7kf-elastic.siteintercept.qualtrics.com/WRSiteInterceptEngine/?Q_ZID=ZN_emkP0oSe9Qrn7kF")).start()}catch(i){}})();
    </script><div id='ZN_emkP0oSe9Qrn7kF'><!--DO NOT REMOVE-CONTENTS PLACED HERE--></div>
    <!--END WEBSITE FEEDBACK SNIPPET-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <!-- Subnav -->
    <div>
      <div>
        <div class="tertiary-nav d-none d-md-block">
          <div class="container">
            <div class="p-t-b-15 d-flex justify-content-between nav-container">
              <div class="breadcrum-wrapper"><span><a href="/guide/" style="font-size: 14px; font-weight: 600; color: #000;">Docs</a></span></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container">
              <div class="row">
                <div class="col-xs-12 col-sm-8 col-md-8 guide-section">
                  <!-- start body -->
                  <div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Kibana Guide [7.2]</a></span>
»
<span class="breadcrumb-link"><a href="management.html">Management</a></span>
»
<span class="breadcrumb-node">Snapshot repositories</span>
</div>
<div class="navheader">
<span class="prev">
<a href="working-remote-clusters.html">« Working with remote clusters</a>
</span>
<span class="next">
<a href="xpack-spaces.html">Spaces »</a>
</span>
</div>
<div class="chapter xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="snapshot-repositories"></a>Snapshot repositories<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.2/docs/management/snapshot-restore/index.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>
<p>Use <span class="strong strong"><strong>Snapshot Repositories</strong></span> to store backups of your
Elasticsearch indices and clusters. Snapshots are important because they provide
a copy of your data in case something goes wrong. If you need to roll
back to an older version of your data, you can restore a snapshot from the repository.</p>
<p>Before using this feature, you should be familiar with how snapshots work.
<a href="/guide/en/elasticsearch/reference/7.2/modules-snapshots.html" class="ulink" target="_top">Snapshot and Restore</a> is a good source for
more detailed information.</p>
<p>To get started, go to <span class="strong strong"><strong>Management &gt; Elasticsearch &gt; Snapshot Repositories</strong></span>.  You
begin with an overview of your repositories. You can then use the UI to
drill down into your repositories and snapshots.</p>
<p class="screenshot"><span class="image"><img src="management/snapshot-restore/images/repository_list.png" alt="Repository list"></span></p>
<h3><a id="_registering_a_repository"></a>Registering a repository<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.2/docs/management/snapshot-restore/index.asciidoc">edit</a></h3>
<p>You must have a registry before you can save your snapshots. If you don’t see a
repository in the list, navigate to <span class="strong strong"><strong>Register repository</strong></span> to create one.</p>
<p class="screenshot"><span class="image"><img src="management/snapshot-restore/images/register_repo.png" alt="Register repository"></span></p>
<p>Kibana supports three types of repositories on startup:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Shared file system.</strong></span>  Uses a shared file system to store the snapshots.
</li>
<li class="listitem">
<span class="strong strong"><strong>Read-only url.</strong></span>  Provides a read-only alternative to access snapshot data
in another repository.
</li>
<li class="listitem">
<span class="strong strong"><strong>Source-only.</strong></span>  Enables storage of minimal, source-only snapshots.
A source-only repository can take up to 50% less disk space.
</li>
</ul>
</div>
<p>For more information on these repositories and the settings that you can
configure, see <a href="/guide/en/elasticsearch/reference/7.2/modules-snapshots.html#_repositories" class="ulink" target="_top">Repositories</a>.
To add support for additional types, see
<a href="/guide/en/elasticsearch/reference/7.2/modules-snapshots.html#_repository_plugins" class="ulink" target="_top">Repository plugins</a>.</p>
<p>A best practice is to register a repository for each major version of
Elasticsearch. If you register the same snapshot repository with multiple clusters,
give only one cluster write access to the repository. All other clusters
connected to that repository should have read-only access.</p>
<h3><a id="_creating_a_snapshot"></a>Creating a snapshot<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.2/docs/management/snapshot-restore/index.asciidoc">edit</a></h3>
<p>Use the Kibana <a class="xref" href="console-kibana.html" title="Console">Console</a> to create your snapshots. The
<a href="/guide/en/elasticsearch/reference/7.2//modules-snapshots.html#_snapshot" class="ulink" target="_top">snapshot API</a>
takes the current state and data in your index or cluster and saves it to a
shared repository.</p>
<p>The snapshot process is "smart." Your first snapshot is a complete copy of data.
All subsequent snapshots save the changes between the existing snapshots and
the new data.</p>
<p>For an overview of the snapshots in your cluster, go to the <span class="strong strong"><strong>Snapshots</strong></span> tab in <span class="strong strong"><strong>Snapshot Repositories</strong></span>.
You can then drill down into the details for each snapshot.</p>
<p class="screenshot"><span class="image"><img src="management/snapshot-restore/images/snapshot_details.png" alt="Snapshot details"></span></p>
<h3><a id="_example_register_a_shared_file_system_repository"></a>Example: Register a shared file system repository<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.2/docs/management/snapshot-restore/index.asciidoc">edit</a></h3>
<p>This example shows how to register a shared file system repository
and store snapshots.</p>
<h4><a id="_register_the_repository_location"></a>Register the repository location<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.2/docs/management/snapshot-restore/index.asciidoc">edit</a></h4>
<p>You must register the location of the repository in the <code class="literal">path.repo</code> setting on
your master and data nodes.  You can do this in one of two ways:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Edit  your <code class="literal">elasticsearch.yml</code> to include the <code class="literal">path.repo</code> setting.
</li>
<li class="listitem">
<p>Pass the <code class="literal">path.repo</code> setting when you start Elasticsearch.</p>
<p><code class="literal">bin/elasticsearch -E path.repo=/tmp/es-backups</code></p>
</li>
</ul>
</div>
<h4><a id="_register_the_repository"></a>Register the repository<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.2/docs/management/snapshot-restore/index.asciidoc">edit</a></h4>
<p>Use <span class="strong strong"><strong>Snapshot Repositories</strong></span> to register a repository.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Go to <span class="strong strong"><strong>Management &gt; Elasticsearch &gt; Snapshot Repositories</strong></span>.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Register a repository</strong></span>.
</li>
<li class="listitem">
Enter a name for your repository. For example, <code class="literal">my_backup</code>.
</li>
<li class="listitem">
<p>Set <span class="strong strong"><strong>Repository type</strong></span> to Shared file system.</p>
<p class="screenshot"><span class="image"><img src="management/snapshot-restore/images/register_repo.png" alt="Register repository"></span></p>
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Next</strong></span>.
</li>
<li class="listitem">
In <span class="strong strong"><strong>Location</strong></span>, enter the path to the snapshot repository, <code class="literal">/tmp/es-backups</code>.
</li>
<li class="listitem">
In <span class="strong strong"><strong>Chunk size</strong></span>, enter 100mb so that snapshot files are not bigger than that size.
</li>
<li class="listitem">
Use the defaults for all other fields.
</li>
<li class="listitem">
<p>Click <span class="strong strong"><strong>Register</strong></span>.</p>
<p>Your new repository is listed on the <span class="strong strong"><strong>Repositories</strong></span> tab.</p>
</li>
<li class="listitem">
<p>Inspect the details for the repository.</p>
<p>The repository currently doesn’t have any snapshots.</p>
</li>
<li class="listitem">
<p>Click <span class="strong strong"><strong>Verify repository</strong></span> to view the repository connection status.</p>
<p class="screenshot"><span class="image"><img src="management/snapshot-restore/images/verify_repository.png" alt="Verify repository"></span></p>
</li>
</ol>
</div>
<h4><a id="_add_a_snapshot_to_the_repository"></a>Add a snapshot to the repository<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.2/docs/management/snapshot-restore/index.asciidoc">edit</a></h4>
<p>Use the <a href="/guide/en/elasticsearch/reference/7.2//modules-snapshots.html#_snapshot" class="ulink" target="_top">snapshot API</a> to create a snapshot.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Go to <span class="strong strong"><strong>Dev Tools &gt; Console</strong></span>.
</li>
<li class="listitem">
<p>Create the snapshot.</p>
<p>In this example, the snapshot name is <code class="literal">2019-04-25_snapshot</code>. You can also
use <a href="/guide/en/elasticsearch/reference/7.2//date-math-index-names.html" class="ulink" target="_top">date math expression</a> for the snapshot name.</p>
<p class="screenshot"><span class="image"><img src="management/snapshot-restore/images/create_snapshot.png" alt="Create snapshot"></span></p>
</li>
<li class="listitem">
<p>Open <span class="strong strong"><strong>Snapshot Repositories</strong></span>.</p>
<p>Your new snapshot is available in the <span class="strong strong"><strong>Snapshots</strong></span> tab.</p>
</li>
</ol>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="working-remote-clusters.html">« Working with remote clusters</a>
</span>
<span class="next">
<a href="xpack-spaces.html">Spaces »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>
                <div class="col-xs-12 col-sm-4 col-md-4" id="right_col">
                  <div id="rtpcontainer" style="display: block;">
                    <div class="mktg-promo">
                      <h3>Most Popular</h3>
                      <ul class="icons">
                        <li class="icon-elasticsearch-white"><a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">Get Started with Elasticsearch: Video</a></li>
                        <li class="icon-kibana-white"><a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">Intro to Kibana: Video</a></li>
                        <li class="icon-logstash-white"><a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">ELK for Logs & Metrics: Video</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";
	var localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}';
</script>
<script src="/static/js/swiftype_app_search.umd.min.js"></script>
<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
