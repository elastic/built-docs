<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Legacy editors | Kibana Guide [8.16] | Elastic</title>
<meta class="elastic" name="content" content="Legacy editors | Kibana Guide [8.16]">

<link rel="home" href="index.html" title="Kibana Guide [8.16]"/>
<link rel="up" href="_panels_and_visualizations.html" title="Panels and visualizations"/>
<link rel="prev" href="dashboard-links.html" title="Link panels"/>
<link rel="next" href="_manage_dashboards.html" title="Manage dashboards"/>
<meta class="elastic" name="product_version" content="8.16"/>
<meta class="elastic" name="product_name" content="Kibana"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Kibana/Reference/8.16"/>
<meta name="DC.subject" content="Kibana"/>
<meta name="DC.identifier" content="8.16"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles-v1.css" />
  </head>

  <!--© 2015-2025 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div class="page_header">
This documentation contains work-in-progress information for future Elastic Stack and Cloud releases. Use the version selector to view supported release docs. It also contains some Elastic Cloud serverless information. Check out our <a href="https://www.elastic.co/docs/current/serverless">serverless docs</a> for more details.
</div>
<div class="navheader">
<span class="prev">
<a href="dashboard-links.html">« Link panels</a>
</span>
<span class="next">
<a href="_manage_dashboards.html">Manage dashboards »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Kibana Guide [8.16]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="dashboard.html">Dashboards</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="_panels_and_visualizations.html">Panels and visualizations</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Legacy editors</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.16/docs/user/dashboard/create-visualizations.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="legacy-editors"></a>Legacy editors</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.16/docs/user/dashboard/create-visualizations.asciidoc">edit</a></div>
</div></div></div>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="add-aggregation-based-visualization-panels"></a>Aggregation-based</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.16/docs/user/dashboard/aggregation-based.asciidoc">edit</a></div>
</div></div></div>
<p>Aggregation-based visualizations are the core Kibana panels, and are not optimized for a specific use case.</p>
<p>With aggregation-based visualizations, you can:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Split charts up to three aggregation levels, which is more than <span class="strong strong"><strong>Lens</strong></span> and <span class="strong strong"><strong>TSVB</strong></span>
</li>
<li class="listitem">
Create visualization with non-time series data
</li>
<li class="listitem">
Use a <a class="xref" href="save-open-search.html" title="Save a search for reuse">saved search</a> as an input
</li>
<li class="listitem">
Sort data tables and use the summary row and percentage column features
</li>
<li class="listitem">
Assign colors to data series
</li>
<li class="listitem">
Extend features with plugins
</li>
</ul>
</div>
<p>Aggregation-based visualizations include the following limitations:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Limited styling options
</li>
<li class="listitem">
Math is unsupported
</li>
<li class="listitem">
Multiple indices is unsupported
</li>
</ul>
</div>
<div class="position-relative"><h5><a id="types-of-visualizations"></a>Types of aggregation-based visualizations</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.16/docs/user/dashboard/aggregation-based.asciidoc">edit</a></div>
<p>Kibana supports the following types of aggregation-based visualizations.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<tbody>
<tr>
<td align="left" valign="top">
<p><span class="strong strong"><strong>Area</strong></span></p>
<p>Displays data points, connected by a line, where the area between the line and axes are shaded.
Use area charts to compare two or more categories over time, and display the magnitude of trends.</p>
</td>
<td align="left" valign="top"><p><span class="image"><img src="images/area.png" alt="Area chart"></span></p></td>
</tr>
<tr>
<td align="left" valign="top">
<p><span class="strong strong"><strong>Data table</strong></span></p>
<p>Displays your aggregation results in a tabular format. Use data tables to display server configuration details, track counts, min,
or max values for a specific field, and monitor the status of key services.</p>
</td>
<td align="left" valign="top"><p><span class="image"><img src="images/data_table.png" alt="Data table"></span></p></td>
</tr>
<tr>
<td align="left" valign="top">
<p><span class="strong strong"><strong>Gauge</strong></span></p>
<p>Displays your data along a scale that changes color according to where your data falls on the expected scale. Use the gauge to show how metric
values relate to reference threshold values, or determine how a specified field is performing versus how it is expected to perform.</p>
</td>
<td align="left" valign="top"><p><span class="image"><img src="images/gauge.png" alt="Gauge"></span></p></td>
</tr>
<tr>
<td align="left" valign="top">
<p><span class="strong strong"><strong>Goal</strong></span></p>
<p>Displays how your metric progresses toward a fixed goal. Use the goal to display an easy to read visual of the status of your goal progression.</p>
</td>
<td align="left" valign="top"><p><span class="image"><img src="images/goal.png" alt="Goal"></span></p></td>
</tr>
<tr>
<td align="left" valign="top">
<p><span class="strong strong"><strong>Heat map</strong></span></p>
<p>Displays graphical representations of data where the individual values are represented by colors. Use heat maps when your data set includes
categorical data. For example, use a heat map to see the flights of origin countries compared to destination countries using the sample flight data.</p>
</td>
<td align="left" valign="top"><p><span class="image"><img src="images/heat_map.png" alt="Heat map"></span></p></td>
</tr>
<tr>
<td align="left" valign="top">
<p><span class="strong strong"><strong>Horizontal Bar</strong></span></p>
<p>Displays bars side-by-side where each bar represents a category. Use bar charts to compare data across a
large number of categories, display data that includes categories with negative values, and easily identify
the categories that represent the highest and lowest values. Kibana also supports vertical bar charts.</p>
</td>
<td align="left" valign="top"><p><span class="image"><img src="images/bar.png" alt="Bar chart"></span></p></td>
</tr>
<tr>
<td align="left" valign="top">
<p><span class="strong strong"><strong>Line</strong></span></p>
<p>Displays data points that are connected by a line. Use line charts to visualize a sequence of values, discover
trends over time, and forecast future values.</p>
</td>
<td align="left" valign="top"><p><span class="image"><img src="images/line.png" alt="Line chart"></span></p></td>
</tr>
<tr>
<td align="left" valign="top">
<p><span class="strong strong"><strong>Metric</strong></span></p>
<p>Displays a single numeric value for an aggregation. Use the metric visualization when you have a numeric value that is powerful enough to tell
a story about your data.</p>
</td>
<td align="left" valign="top"><p><span class="image"><img src="images/metric.png" alt="Metric"></span></p></td>
</tr>
<tr>
<td align="left" valign="top">
<p><span class="strong strong"><strong>Pie</strong></span></p>
<p>Displays slices that represent a data category, where the slice size is proportional to the quantity it represents.
Use pie charts to show comparisons between multiple categories, illustrate the dominance of one category over others,
and show percentage or proportional data.</p>
</td>
<td align="left" valign="top"><p><span class="image"><img src="images/pie.png" alt="Pie chart"></span></p></td>
</tr>
<tr>
<td align="left" valign="top">
<p><span class="strong strong"><strong>Tag cloud</strong></span></p>
<p>Graphical representations of how frequently a word appears in the source text. Use tag clouds to easily produce a summary of large documents and
create visual art for a specific topic.</p>
</td>
<td align="left" valign="top"><p><span class="image"><img src="images/tag_cloud.png" alt="Tag cloud"></span></p></td>
</tr>
</tbody>
</table>
</div>
<div class="position-relative"><h5><a id="create-aggregation-based-panel"></a>Create an aggregation-based visualization panel</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.16/docs/user/dashboard/aggregation-based.asciidoc">edit</a></div>
<p>Choose the type of visualization you want to create, then use the editor to configure the options.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>On the dashboard, click <span class="strong strong"><strong>All types &gt; Aggregation based</strong></span>.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Select the visualization type you want to create.
</li>
<li class="listitem">
<p>Select the data source you want to visualize.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>There is no performance impact on the data source you select. For example, <span class="strong strong"><strong>Discover</strong></span> saved searches perform the same as data views.</p>
</div>
</div>
</li>
</ol>
</div>
</li>
<li class="listitem">
<p>Add the <a class="xref" href="chart-types.html#aggregation-reference">aggregations</a> you want to visualize using the editor, then click <span class="strong strong"><strong>Update</strong></span>.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>For the <span class="strong strong"><strong>Date Histogram</strong></span> to use an <span class="strong strong"><strong>auto interval</strong></span>, the date field must match the primary time field of the data view.</p>
</div>
</div>
</li>
<li class="listitem">
<p>To change the order, drag and drop the aggregations in the editor.</p>
<p class="screenshot"><span class="image"><img src="images/bar-chart-tutorial-3.png" alt="Option to change the order of aggregations"></span></p>
</li>
<li class="listitem">
<p>To customize the series colors, click the series in the legend, then select the color you want to use.</p>
<p class="screenshot"><span class="image"><img src="images/aggregation-based-color-picker.png" alt="Color picker"></span></p>
</li>
</ol>
</div>
<div class="position-relative"><h5><a id="try-it-aggregation-based-panel"></a>Try it: Create an aggregation-based bar chart</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.16/docs/user/dashboard/aggregation-based.asciidoc">edit</a></div>
<p>You collected data from your web server, and you want to visualize and analyze the data on a dashboard. To create a dashboard panel of the data, create
a bar chart that displays the top five log traffic sources for every three hours.</p>
<div class="position-relative"><h6><a id="_add_the_data_and_create_the_dashboard"></a>Add the data and create the dashboard</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.16/docs/user/dashboard/aggregation-based.asciidoc">edit</a></div>
<p>Add the sample web logs data that you&#8217;ll use to create the bar chart, then create the dashboard.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
On the home page, click <span class="strong strong"><strong>Try sample data</strong></span>.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Other sample data sets</strong></span>.
</li>
<li class="listitem">
On the <span class="strong strong"><strong>Sample web logs</strong></span> card, click <span class="strong strong"><strong>Add data</strong></span>.
</li>
<li class="listitem">
Open the main menu, then click <span class="strong strong"><strong>Dashboard</strong></span>.
</li>
<li class="listitem">
On the <span class="strong strong"><strong>Dashboards</strong></span> page, click <span class="strong strong"><strong>Create dashboard</strong></span>.
</li>
</ol>
</div>
<div class="position-relative"><h6><a id="_open_and_set_up_the_aggregation_based_bar_chart"></a>Open and set up the aggregation-based bar chart</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.16/docs/user/dashboard/aggregation-based.asciidoc">edit</a></div>
<p>Open the <span class="strong strong"><strong>Aggregation based</strong></span> editor and change the time range.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
On the dashboard, click <span class="strong strong"><strong>All types &gt; Aggregation based</strong></span>, select <span class="strong strong"><strong>Vertical bar</strong></span>, then select <span class="strong strong"><strong>Kibana Sample Data Logs</strong></span>.
</li>
<li class="listitem">
Make sure the <a class="xref" href="set-time-filter.html" title="Set the time range">time filter</a> is <span class="strong strong"><strong>Last 7 days</strong></span>.
</li>
</ol>
</div>
<div class="position-relative"><h6><a id="tutorial-configure-the-bar-chart"></a>Create the bar chart</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.16/docs/user/dashboard/aggregation-based.asciidoc">edit</a></div>
<p>To create the bar chart, add a <a class="xref" href="chart-types.html#bucket-aggregations" title="Bucket aggregations">bucket aggregation</a>, then add the terms sub-aggregation to display the top values.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Add a <span class="strong strong"><strong>Buckets</strong></span> aggregation.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Click <span class="strong strong"><strong>Add</strong></span>, then select <span class="strong strong"><strong>X-axis</strong></span>.
</li>
<li class="listitem">
From the <span class="strong strong"><strong>Aggregation</strong></span> dropdown, select <span class="strong strong"><strong>Date Histogram</strong></span>.
</li>
<li class="listitem">
<p>Click <span class="strong strong"><strong>Update</strong></span>.</p>
<p class="screenshot"><span class="image"><img src="images/aggBased_barChartTutorial1_8.4.png" alt="Bar chart with sample logs data"></span></p>
</li>
</ol>
</div>
</li>
<li class="listitem">
<p>To show the top five log traffic sources, add a sub-bucket aggregation.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Click <span class="strong strong"><strong>Add</strong></span>, then select <span class="strong strong"><strong>Split series</strong></span>.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>Aggregation-based panels support a maximum of three <span class="strong strong"><strong>Split series</strong></span>.</p>
</div>
</div>
</li>
<li class="listitem">
From the <span class="strong strong"><strong>Sub aggregation</strong></span> dropdown, select <span class="strong strong"><strong>Terms</strong></span>.
</li>
<li class="listitem">
From the <span class="strong strong"><strong>Field</strong></span> dropdown, select <span class="strong strong"><strong>geo.src</strong></span>.
</li>
<li class="listitem">
<p>Click <span class="strong strong"><strong>Update</strong></span>.</p>
<p class="screenshot"><span class="image"><img src="images/aggBased_barChartTutorial2_8.4.png" alt="Bar chart with sample logs data"></span></p>
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="position-relative"><h5><a id="edit-agg-based-visualizations-in-lens"></a>Open and edit aggregation-based visualizations in Lens</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.16/docs/user/dashboard/aggregation-based.asciidoc">edit</a></div>
<p>When you open aggregation-based visualizations in <span class="strong strong"><strong>Lens</strong></span>, all configuration options appear in the <span class="strong strong"><strong>Lens</strong></span> visualization editor.</p>
<p>You can open the following aggregation-based visualizations in <span class="strong strong"><strong>Lens</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Area
</li>
<li class="listitem">
Data table
</li>
<li class="listitem">
Gauge
</li>
<li class="listitem">
Goal
</li>
<li class="listitem">
Heat map
</li>
<li class="listitem">
Horizontal bar
</li>
<li class="listitem">
Line
</li>
<li class="listitem">
Metric
</li>
<li class="listitem">
Pie
</li>
<li class="listitem">
Vertical bar
</li>
</ul>
</div>
<p>To get started, click <span class="strong strong"><strong>Edit visualization in Lens</strong></span> in the toolbar.</p>
<p>For more information, check out <a class="xref" href="lens.html" title="Create visualizations with Lens">Create visualizations with Lens</a>.</p>
<div class="position-relative"><h6><a id="save-the-aggregation-based-panel"></a>Save and add the panel</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.16/docs/user/dashboard/aggregation-based.asciidoc">edit</a></div>
<p>Save the panel to the <span class="strong strong"><strong>Visualize Library</strong></span> and add it to the dashboard, or add it to the dashboard without saving.</p>
<p>To save the panel to the <span class="strong strong"><strong>Visualize Library</strong></span>:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Click <span class="strong strong"><strong>Save to library</strong></span>.
</li>
<li class="listitem">
Enter the <span class="strong strong"><strong>Title</strong></span> and add any applicable <a class="xref" href="managing-tags.html" title="Tags"><span class="strong strong"><strong>Tags</strong></span></a>.
</li>
<li class="listitem">
Make sure that <span class="strong strong"><strong>Add to Dashboard after saving</strong></span> is selected.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Save and return</strong></span>.
</li>
</ol>
</div>
<p>To save the panel to the dashboard:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Click <span class="strong strong"><strong>Save and return</strong></span>.
</li>
<li class="listitem">
<p>Add an optional title to the panel.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
In the panel header, click <span class="strong strong"><strong>No Title</strong></span>.
</li>
<li class="listitem">
On the <span class="strong strong"><strong>Panel settings</strong></span> window, select <span class="strong strong"><strong>Show title</strong></span>.
</li>
<li class="listitem">
Enter the <span class="strong strong"><strong>Title</strong></span>, then click <span class="strong strong"><strong>Save</strong></span>.
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="tsvb-panel"></a>TSVB</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.16/docs/user/dashboard/tsvb.asciidoc">edit</a></div>
</div></div></div>
<p><span class="strong strong"><strong>TSVB</strong></span> is a set of visualization types that you configure and display on dashboards.</p>
<p>With <span class="strong strong"><strong>TSVB</strong></span>, you can:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Combine an infinite number of <a class="xref" href="chart-types.html#aggregation-reference">aggregations</a> to display your data.
</li>
<li class="listitem">
Annotate time series data with timestamped events from an Elasticsearch index.
</li>
<li class="listitem">
View the data in several types of visualizations, including charts, data tables, and markdown panels.
</li>
<li class="listitem">
Display multiple <a class="xref" href="data-views.html" title="Create a data view">data views</a> in each visualization.
</li>
<li class="listitem">
Use custom functions and some math on aggregations.
</li>
<li class="listitem">
Customize the data with labels and colors.
</li>
</ul>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="images/tsvb-screenshot.png" alt="TSVB overview">
</div>
</div>
<div class="position-relative"><h5><a id="tsvb-data-view-mode"></a>Open and set up TSVB</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.16/docs/user/dashboard/tsvb.asciidoc">edit</a></div>
<p>Open <span class="strong strong"><strong>TSVB</strong></span>, then configure the required settings. You can create <span class="strong strong"><strong>TSVB</strong></span> visualizations with only data views, or Elasticsearch index strings.</p>
<p>When you use only data views, you are able to:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Create visualizations with runtime fields
</li>
<li class="listitem">
Add URL drilldowns
</li>
<li class="listitem">
Add interactive filters for time series visualizations
</li>
<li class="listitem">
Improve performance
</li>
</ul>
</div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<a id="tsvb-index-patterns-mode"></a>
<p>Creating <span class="strong strong"><strong>TSVB</strong></span> visualizations with an Elasticsearch index string is deprecated and will be removed in a future release. By default, you create <span class="strong strong"><strong>TSVB</strong></span> visualizations with only data views. To use an Elasticsearch index string, contact your administrator, or go to <a class="xref" href="advanced-options.html" title="Advanced Settings">Advanced Settings</a> and set <code class="literal">metrics:allowStringIndices</code> to <code class="literal">true</code>.</p>
</div>
</div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
On the dashboard, click <span class="strong strong"><strong>Select type</strong></span>, then select <span class="strong strong"><strong>TSVB</strong></span>.
</li>
<li class="listitem">
In <span class="strong strong"><strong>TSVB</strong></span>, click <span class="strong strong"><strong>Panel options</strong></span>, then specify the <span class="strong strong"><strong>Data</strong></span> settings.
</li>
<li class="listitem">
Open the <span class="strong strong"><strong>Data view mode</strong></span> options next to the <span class="strong strong"><strong>Data view</strong></span> dropdown.
</li>
<li class="listitem">
Select <span class="strong strong"><strong>Use only Kibana data views</strong></span>.
</li>
<li class="listitem">
From the <span class="strong strong"><strong>Data view</strong></span> dropdown, select the data view, then select the <span class="strong strong"><strong>Time field</strong></span> and <span class="strong strong"><strong>Interval</strong></span>.
</li>
<li class="listitem">
<p>Select a <span class="strong strong"><strong>Drop last bucket</strong></span> option.</p>
<p>By default, <span class="strong strong"><strong>TSVB</strong></span> drops the last bucket because the time filter intersects the time range of the last bucket. To view the partial data, select <span class="strong strong"><strong>No</strong></span>.</p>
</li>
<li class="listitem">
To view a filtered set of documents, enter <a class="xref" href="kuery-query.html" title="Kibana Query Language">KQL filters</a> in the <span class="strong strong"><strong>Panel filter</strong></span> field.
</li>
</ol>
</div>
<div class="position-relative"><h5><a id="tsvb-function-reference"></a>Configure the series</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.16/docs/user/dashboard/tsvb.asciidoc">edit</a></div>
<p>Each <span class="strong strong"><strong>TSVB</strong></span> visualization shares the same options to create a <span class="strong strong"><strong>Series</strong></span>. Each series can be thought of as a separate Elasticsearch aggregation.
The <span class="strong strong"><strong>Options</strong></span> control the styling and Elasticsearch options, and are inherited from <span class="strong strong"><strong>Panel options</strong></span>.
When you have separate options for each series, you can compare different Elasticsearch indices, and view two time ranges from the same index.</p>
<p>To configure the value of each series, select the function, then configure the function inputs. Only the last function is displayed.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>From the <span class="strong strong"><strong>Aggregation</strong></span> dropdown, select the function for the series. <span class="strong strong"><strong>TSVB</strong></span> provides you with shortcuts for some frequently-used functions:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<span class="strong strong"><strong>Filter Ratio</strong></span>
</span>
</dt>
<dd>
Returns a percent value by calculating a metric on two sets of documents.
For example, calculate the error rate as a percentage of the overall events over time.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong>Counter Rate</strong></span>
</span>
</dt>
<dd>
Used when dealing with monotonically increasing counters. Shortcut for <span class="strong strong"><strong>Max</strong></span>, <span class="strong strong"><strong>Derivative</strong></span>, and <span class="strong strong"><strong>Positive Only</strong></span>.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong>Positive Only</strong></span>
</span>
</dt>
<dd>
Removes any negative values from the results, which can be used as a post-processing step
after a derivative.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong>Series Agg</strong></span>
</span>
</dt>
<dd>
Applies a function to all of the <span class="strong strong"><strong>Group by</strong></span> series to reduce the values to a single number.
This function must always be the last metric in the series.
For example, if the <span class="strong strong"><strong>Time Series</strong></span> visualization shows 10 series, the sum <span class="strong strong"><strong>Series Agg</strong></span> calculates
the sum of all 10 bars and outputs a single Y value per X value. This is often confused
with the overall sum function, which outputs a single Y value per unique series.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong>Math</strong></span>
</span>
</dt>
<dd>
For each series, apply simple and advanced calculations. Only use <span class="strong strong"><strong>Math</strong></span> for the last function in a series.
</dd>
</dl>
</div>
</li>
<li class="listitem">
<p>To display each group separately, select one of the following options from the <span class="strong strong"><strong>Group by</strong></span> dropdown:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Filters</strong></span> &mdash; Groups the data into the specified filters. To differentiate the groups, assign a color to each filter.
</li>
<li class="listitem">
<span class="strong strong"><strong>Terms</strong></span> &mdash; Displays the top values of the field. The color is only configurable in the <span class="strong strong"><strong>Time Series</strong></span> chart. To configure, click <span class="strong strong"><strong>Options</strong></span>, then select an option from the <span class="strong strong"><strong>Split color theme</strong></span> dropdown.
</li>
</ul>
</div>
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Options</strong></span>, then configure the inputs for the function. For example, to use a different field format, make a selection from the <span class="strong strong"><strong>Data formatter</strong></span> dropdown.
</li>
</ol>
</div>
<div class="position-relative"><h5><a id="configure-the-visualizations"></a>TSVB visualization options</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.16/docs/user/dashboard/tsvb.asciidoc">edit</a></div>
<p>The configuration options differ for each <span class="strong strong"><strong>TSVB</strong></span> visualization.</p>
<div class="position-relative"><h6><a id="tsvb-time-series"></a>Time Series</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.16/docs/user/dashboard/tsvb.asciidoc">edit</a></div>
<p>By default, the y-axis displays the full range of data, including zero. To automatically scale the y-axis from
the minimum to maximum values of the data, click <span class="strong strong"><strong>Data &gt; Options &gt; Fill</strong></span>, then enter <code class="literal">0</code> in the <span class="strong strong"><strong>Fill</strong></span> field.
You can add annotations to the x-axis based on timestamped documents in a separate Elasticsearch index.</p>
<div class="position-relative"><h6><a id="all-chart-types-except-time-series"></a>All chart types except Time Series</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.16/docs/user/dashboard/tsvb.asciidoc">edit</a></div>
<p>The <span class="strong strong"><strong>Data timerange mode</strong></span> dropdown in <span class="strong strong"><strong>Panel options</strong></span> controls the timespan that <span class="strong strong"><strong>TSVB</strong></span> uses to match documents.
<span class="strong strong"><strong>Last value</strong></span> is unable to match all documents, only the specific interval. <span class="strong strong"><strong>Entire timerange</strong></span> matches all documents specified in the time filter.</p>
<div class="position-relative"><h6><a id="metric-topn-gauge"></a>Metric, Top N, and Gauge</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.16/docs/user/dashboard/tsvb.asciidoc">edit</a></div>
<p><span class="strong strong"><strong>Color rules</strong></span> in <span class="strong strong"><strong>Panel options</strong></span> contains conditional coloring based on the values.</p>
<div class="position-relative"><h6><a id="topn-table"></a>Top N and Table</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.16/docs/user/dashboard/tsvb.asciidoc">edit</a></div>
<p>When you click a series, <span class="strong strong"><strong>TSVB</strong></span> applies a filter based on the series name.
To change this behavior, click <span class="strong strong"><strong>Panel options</strong></span>, then specify a URL in the <span class="strong strong"><strong>Item URL</strong></span> field, which opens a URL instead of applying a filter on click.</p>
<div class="position-relative"><h6><a id="tsvb-markdown"></a>Markdown</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.16/docs/user/dashboard/tsvb.asciidoc">edit</a></div>
<p>The <span class="strong strong"><strong>Markdown</strong></span> visualization supports Markdown with Handlebar (mustache) syntax to insert dynamic data, and supports custom CSS.</p>
<div class="position-relative"><h5><a id="edit-visualizations-in-lens"></a>Open and edit TSVB visualizations in Lens</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.16/docs/user/dashboard/tsvb.asciidoc">edit</a></div>
<p>When you open <span class="strong strong"><strong>TSVB</strong></span> visualizations in <span class="strong strong"><strong>Lens</strong></span>, all configuration options and annotations appear in the <span class="strong strong"><strong>Lens</strong></span> visualization editor.</p>
<p>You can open the following <span class="strong strong"><strong>TSVB</strong></span> visualizations in <span class="strong strong"><strong>Lens</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Time Series
</li>
<li class="listitem">
Metric
</li>
<li class="listitem">
Top N
</li>
<li class="listitem">
Gauge
</li>
<li class="listitem">
Table
</li>
</ul>
</div>
<p>To get started, click <span class="strong strong"><strong>Edit visualization in Lens</strong></span> in the toolbar.</p>
<p>For more information, check out <a class="xref" href="lens.html" title="Create visualizations with Lens">Create visualizations with Lens</a>.</p>
<div class="position-relative"><h5><a id="view-data-and-requests-tsvb"></a>View the visualization data requests</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.16/docs/user/dashboard/tsvb.asciidoc">edit</a></div>
<p>View the requests that collect the visualization data.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
In the toolbar, click <span class="strong strong"><strong>Inspect</strong></span>.
</li>
<li class="listitem">
From the <span class="strong strong"><strong>Request</strong></span> dropdown, select the series you want to view.
</li>
</ol>
</div>
<div class="position-relative"><h5><a id="save-the-tsvb-panel"></a>Save and add the panel</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.16/docs/user/dashboard/tsvb.asciidoc">edit</a></div>
<p>Save the panel to the <span class="strong strong"><strong>Visualize Library</strong></span> and add it to the dashboard, or add it to the dashboard without saving.</p>
<p>To save the panel to the <span class="strong strong"><strong>Visualize Library</strong></span>:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Click <span class="strong strong"><strong>Save to library</strong></span>.
</li>
<li class="listitem">
Enter the <span class="strong strong"><strong>Title</strong></span> and add any applicable <a class="xref" href="managing-tags.html" title="Tags"><span class="strong strong"><strong>Tags</strong></span></a>.
</li>
<li class="listitem">
Make sure that <span class="strong strong"><strong>Add to Dashboard after saving</strong></span> is selected.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Save and return</strong></span>.
</li>
</ol>
</div>
<p>To save the panel to the dashboard:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Click <span class="strong strong"><strong>Save and return</strong></span>.
</li>
<li class="listitem">
<p>Add an optional title to the panel.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
In the panel header, click <span class="strong strong"><strong>No Title</strong></span>.
</li>
<li class="listitem">
On the <span class="strong strong"><strong>Panel settings</strong></span> window, select <span class="strong strong"><strong>Show title</strong></span>.
</li>
<li class="listitem">
Enter the <span class="strong strong"><strong>Title</strong></span>, then click <span class="strong strong"><strong>Save</strong></span>.
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="position-relative"><h5><a id="tsvb-faq"></a>Frequently asked questions</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.16/docs/user/dashboard/tsvb.asciidoc">edit</a></div>
<p>For answers to frequently asked <span class="strong strong"><strong>TSVB</strong></span> question, review the following.</p>
<details id="how-do-i-create-dashboard-drilldowns">
<summary class="title"><span class="strong strong"><strong>How do I create dashboard drilldowns for Top N and Table visualizations?</strong></span></summary>
<div class="content">
<p>You can create dashboard drilldowns that include the specified time range for <span class="strong strong"><strong>Top N</strong></span> and <span class="strong strong"><strong>Table</strong></span> visualizations.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Open the dashboard that you want to link to, then copy the URL.
</li>
<li class="listitem">
Open the dashboard with the <span class="strong strong"><strong>Top N</strong></span> and <span class="strong strong"><strong>Table</strong></span> visualization panel, then click <span class="strong strong"><strong>Edit</strong></span> in the toolbar.
</li>
<li class="listitem">
Open the <span class="strong strong"><strong>Top N</strong></span> or <span class="strong strong"><strong>Table</strong></span> panel menu, then select <span class="strong strong"><strong>Edit visualization</strong></span>.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Panel options</strong></span>.
</li>
<li class="listitem">
<p>In the <span class="strong strong"><strong>Item URL</strong></span> field, enter the URL.</p>
<p>For example <code class="literal">dashboards#/view/f193ca90-c9f4-11eb-b038-dd3270053a27</code>.</p>
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Save and return</strong></span>.
</li>
<li class="listitem">
In the toolbar, click <span class="strong strong"><strong>Save as</strong></span>, then make sure <span class="strong strong"><strong>Store time with dashboard</strong></span> is deselected.
</li>
</ol>
</div>
</div>
</details>
<details id="how-do-i-base-drilldowns-on-data">
<summary class="title"><span class="strong strong"><strong>How do I base drilldown URLs on my data?</strong></span></summary>
<div class="content">
<p>You can build drilldown URLs dynamically with your visualization data.</p>
<p>Do this by adding the <code class="literal">{{key}}</code> placeholder to your URL</p>
<p>For example <code class="literal">https://example.org/{{key}}</code></p>
<p>This instructs TSVB to substitute the value from your visualization wherever it sees <code class="literal">{{key}}</code>.</p>
<p>If your data contain reserved or invalid URL characters such as "#" or "&amp;", you should apply a transform to URL-encode the key like this <code class="literal">{{encodeURIComponent key}}</code>. If you are dynamically constructing a drilldown to another location in Kibana (for example, clicking a table row takes to you a value-scoped saved search), you will likely want to Rison-encode your key as it may contain invalid Rison characters. (<a href="https://github.com/Nanonid/rison#rison---compact-data-in-uris" class="ulink" target="_top">Rison</a> is the serialization format many parts of Kibana use to store information in their URL.)</p>
<p>For example: <code class="literal">discover#/view/0ac50180-82d9-11ec-9f4a-55de56b00cc0?_a=(filters:!((query:(match_phrase:(foo.keyword:{{rison key}})))))</code></p>
<p>If both conditions apply, you can cover all cases by applying both transforms: <code class="literal">{{encodeURIComponent (rison key)}}</code>.</p>
<p>Technical note: TSVB uses <a href="https://handlebarsjs.com/" class="ulink" target="_top">Handlebars</a> to perform these interpolations. <code class="literal">rison</code> and <code class="literal">encodeURIComponent</code> are custom Handlebars helpers provided by Kibana.</p>
</div>
</details>
<details id="why-is-my-tsvb-visualiztion-missing-data">
<summary class="title"><span class="strong strong"><strong>Why is my TSVB visualization missing data?</strong></span></summary>
<div class="content">
<p>It depends, but most often there are two causes:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For <span class="strong strong"><strong>Time series</strong></span> visualizations with a derivative function, the time interval can be too small. Derivatives require sequential values.
</li>
<li class="listitem">
For all other <span class="strong strong"><strong>TSVB</strong></span> visualizations, the cause is probably the <span class="strong strong"><strong>Data timerange mode</strong></span>, which is controlled by <span class="strong strong"><strong>Panel options &gt; Data timerange mode &gt; Entire time range</strong></span>.
By default, <span class="strong strong"><strong>TSVB</strong></span> displays the last whole bucket. For example, if the time filter is set to <span class="strong strong"><strong>Last 24 hours</strong></span>, and the
current time is 9:41, <span class="strong strong"><strong>TSVB</strong></span> displays only the last 10 minutes &mdash; from 9:30 to 9:40.
</li>
</ul>
</div>
</div>
</details>
<details id="how-do-i-calculate-the-difference-between-two-data-series">
<summary class="title"><span class="strong strong"><strong>How do I calculate the difference between two data series?</strong></span></summary>
<div class="content">
<p>Performing math across data series is unsupported in <span class="strong strong"><strong>TSVB</strong></span>. To calculate the difference between two data series, use <a class="xref" href="legacy-editors.html#timelion" title="Timelion"><span class="strong strong"><strong>Timelion</strong></span></a> or <a class="xref" href="vega.html" title="Custom visualizations with Vega"><span class="strong strong"><strong>Vega</strong></span></a>.</p>
</div>
</details>
<details id="how-do-i-compare-the-current-versus-previous-month">
<summary class="title"><span class="strong strong"><strong>How do I compare the current versus previous month?</strong></span></summary>
<div class="content">
<p><span class="strong strong"><strong>TSVB</strong></span> can display two series with time offsets, but it can&#8217;t perform math across series. To add a time offset:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Click <span class="strong strong"><strong>Clone Series</strong></span>, then choose a color for the new series.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/tsvb_clone_series.png" alt="Clone Series action">
</div>
</div>
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Options</strong></span>, then enter the offset value in the <span class="strong strong"><strong>Offset series time by</strong></span> field.
</li>
</ol>
</div>
</div>
</details>
<details id="how-do-i-calculate-a-month-over-month-change">
<summary class="title"><span class="strong strong"><strong>How do I calculate a month over month change?</strong></span></summary>
<div class="content">
<p>The ability to calculate a month over month change is not fully supported in <span class="strong strong"><strong>TSVB</strong></span>, but there is a special case that is supported <em>if</em> the
time filter is set to 3 months or more <em>and</em> the <span class="strong strong"><strong>Interval</strong></span> is <code class="literal">1m</code>. Use the <span class="strong strong"><strong>Derivative</strong></span> to get the absolute monthly change. To convert to a percent,
add the <span class="strong strong"><strong>Math</strong></span> function with the <code class="literal">params.current / (params.current - params.derivative)</code> formula, then select <span class="strong strong"><strong>Percent</strong></span> from the <span class="strong strong"><strong>Data Formatter</strong></span> dropdown.</p>
<p>For other types of month over month calculations, use <a class="xref" href="legacy-editors.html#timelion" title="Timelion"><span class="strong strong"><strong>Timelion</strong></span></a> or <a class="xref" href="vega.html" title="Custom visualizations with Vega"><span class="strong strong"><strong>Vega</strong></span></a>.</p>
</div>
</details>
<details id="calculate-duration-start-end">
<summary class="title"><span class="strong strong"><strong>How do I calculate the duration between the start and end of an event?</strong></span></summary>
<div class="content">
<p>Calculating the duration between the start and end of an event is unsupported in <span class="strong strong"><strong>TSVB</strong></span> because <span class="strong strong"><strong>TSVB</strong></span> requires correlation between different time periods.
<span class="strong strong"><strong>TSVB</strong></span> requires that the duration is pre-calculated.</p>
</div>
</details>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="timelion"></a>Timelion</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.16/docs/user/dashboard/timelion.asciidoc">edit</a></div>
</div></div></div>
<p>To use <span class="strong strong"><strong>Timelion</strong></span>, you define a graph by chaining functions together, using the <span class="strong strong"><strong>Timelion</strong></span>-specific syntax.
The syntax enables some features that classical point series charts don&#8217;t offer, such as pulling data from different indices or data sources into one graph.</p>
<p><span class="strong strong"><strong>Timelion</strong></span> is driven by a simple expression language that you use to:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Retrieve time series data from one or more indices
</li>
<li class="listitem">
Perform math across two or more time series
</li>
<li class="listitem">
Visualize the results
</li>
</ul>
</div>
<p class="screenshot"><span class="image"><img src="dashboard/images/timelion.png" alt="Timelion"></span></p>
<div class="position-relative"><h5><a id="_timelion_expressions"></a>Timelion expressions</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.16/docs/user/dashboard/timelion.asciidoc">edit</a></div>
<p>Timelion functions always start with a dot, followed by the function name, followed by parentheses containing all the parameters to the function.</p>
<p>The <code class="literal">.es</code> (or <code class="literal">.elasticsearch</code> if you are a fan of typing long words) function gathers data from Elasticsearch and draws it over time. By default the .es function will just count the number of documents, resulting in a graph showing the amount of documents over time.</p>
<div class="position-relative"><h5><a id="_function_parameters"></a>Function parameters</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.16/docs/user/dashboard/timelion.asciidoc">edit</a></div>
<p>Functions can have multiple parameters, and so does the <code class="literal">.es</code> function. Each parameter has a name, that you can use inside the parentheses to set its value. The parameters also have an order, which is shown by the autocompletion or the documentation (using the Docs button in the top menu).</p>
<p>If you don&#8217;t specify the parameter name, timelion assigns the values to the parameters in the order, they are listed in the documentation.</p>
<p>The fist parameter of the .es function is the parameter q (for query), which is a Query String used to filter the data for this series. You can also explicitly reference this parameter by its name, and I would always recommend doing so as soon as you are passing more than one parameter to the function. The following two expressions are thus equivalent:</p>
<p><strong>es(q=*)</strong>Multiple parameters are separated by a comma. The .es function has another parameter called index, that can be used to specify a data view for this series, so the query won&#8217;t be executed against all indexes (or whatever you changed the setting to).</p>
<p><strong>es(q=<span class="strong strong"><strong>, index=logstash-</strong></span>)</strong>If the value of your parameter contains spaces or commas you have to put the value in single or double quotes. You can omit these quotes otherwise.</p>
<div class="position-relative"><h6><a id="customize-data-series-y-axis"></a>.yaxis() function</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.16/docs/user/dashboard/timelion.asciidoc">edit</a></div>
<p>Kibana supports many y-axis scales and ranges for your data series.</p>
<p>The <code class="literal">.yaxis()</code> function supports the following parameters:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>yaxis</strong></span> &mdash; The numbered y-axis to plot the series on. For example, use <code class="literal">.yaxis(2)</code> to display a second y-axis.
</li>
<li class="listitem">
<span class="strong strong"><strong>min</strong></span> &mdash; The minimum value for the y-axis range.
</li>
<li class="listitem">
<span class="strong strong"><strong>max</strong></span> &mdash; The maximum value for the y-axis range.
</li>
<li class="listitem">
<span class="strong strong"><strong>position</strong></span> &mdash; The location of the units. Values include <code class="literal">left</code> or <code class="literal">right</code>.
</li>
<li class="listitem">
<span class="strong strong"><strong>label</strong></span> &mdash; The label for the axis.
</li>
<li class="listitem">
<span class="strong strong"><strong>color</strong></span> &mdash; The color of the axis label.
</li>
<li class="listitem">
<span class="strong strong"><strong>units</strong></span> &mdash; The function to use for formatting the y-axis labels. Values include <code class="literal">bits</code>, <code class="literal">bits/s</code>, <code class="literal">bytes</code>, <code class="literal">bytes/s</code>, <code class="literal">currency(:ISO 4217 currency code)</code>, <code class="literal">percent</code>, and <code class="literal">custom(:prefix:suffix)</code>.
</li>
<li class="listitem">
<span class="strong strong"><strong>tickDecimals</strong></span> &mdash; The tick decimal precision.
</li>
</ul>
</div>
<p>Example:</p>
<div class="pre_wrapper lang-text">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-text">.es(index= kibana_sample_data_logs,
    timefield='@timestamp',
    metric='avg:bytes')
  .label('Average Bytes for request')
  .title('Memory consumption over time in bytes').yaxis(1,units=bytes,position=left), <a id="CO28-1"></a><i class="conum" data-value="1"></i>
.es(index= kibana_sample_data_logs,
    timefield='@timestamp',
    metric=avg:machine.ram)
  .label('Average Machine RAM amount').yaxis(2,units=bytes,position=right) <a id="CO28-2"></a><i class="conum" data-value="2"></i></pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO28-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p><code class="literal">.yaxis(1,units=bytes,position=left)</code> &mdash; Specifies the first y-axis for the first data series, and changes the units on the left.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO28-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p><code class="literal">.yaxis(2,units=bytes,position=left)</code> &mdash; Specifies the second y-axis for the second data series, and changes the units on the right.</p>
</td>
</tr>
</table>
</div>
<div class="position-relative"><h4><a id="_tutorial_create_visualizations_with_timelion"></a>Tutorial: Create visualizations with Timelion</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.16/docs/user/dashboard/timelion.asciidoc">edit</a></div>
<p>You collected data from your operating system using Metricbeat, and you want to visualize and analyze the data on a dashboard. To create panels of the data, use <span class="strong strong"><strong>Timelion</strong></span> to
create a time series visualization,</p>
<div class="position-relative"><h5><a id="_add_the_data_and_create_the_dashboard_2"></a>Add the data and create the dashboard</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.16/docs/user/dashboard/timelion.asciidoc">edit</a></div>
<p>Set up Metricbeat, then create the dashboard.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
To set up Metricbeat, go to <a href="/guide/en/beats/metricbeat/8.16/metricbeat-installation-configuration.html" class="ulink" target="_top">Metricbeat quick start: installation and configuration</a>
</li>
<li class="listitem">
From Kibana, open the main menu, then click <span class="strong strong"><strong>Dashboard</strong></span>.
</li>
<li class="listitem">
On the <span class="strong strong"><strong>Dashboards</strong></span> page, click <span class="strong strong"><strong>Create dashboard</strong></span>.
</li>
</ol>
</div>
<div class="position-relative"><h5><a id="_open_and_set_up_timelion"></a>Open and set up Timelion</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.16/docs/user/dashboard/timelion.asciidoc">edit</a></div>
<p>Open <span class="strong strong"><strong>Timelion</strong></span> and change the time range.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
On the dashboard, click <span class="strong strong"><strong>All types &gt; Aggregation based</strong></span>, then select <span class="strong strong"><strong>Timelion</strong></span>.
</li>
<li class="listitem">
Make sure the <a class="xref" href="set-time-filter.html" title="Set the time range">time filter</a> is <span class="strong strong"><strong>Last 7 days</strong></span>.
</li>
</ol>
</div>
<div class="position-relative"><h5><a id="timelion-tutorial-create-time-series-visualizations"></a>Create a time series visualization</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.16/docs/user/dashboard/timelion.asciidoc">edit</a></div>
<p>To compare the real-time percentage of CPU time spent in user space to the results offset by one hour, create a time series visualization.</p>
<div class="position-relative"><h6><a id="define-the-functions"></a>Define the functions</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.16/docs/user/dashboard/timelion.asciidoc">edit</a></div>
<p>To track the real-time percentage of CPU, enter the following in the <span class="strong strong"><strong>Timelion Expression</strong></span> field, then click <span class="strong strong"><strong>Update</strong></span>:</p>
<div class="pre_wrapper lang-text">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-text">.es(index=metricbeat-*,
    timefield='@timestamp',
    metric='avg:system.cpu.user.pct')</pre>
</div>
<div class="position-relative"><h6><a id="compare-the-data"></a>Compare the data</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.16/docs/user/dashboard/timelion.asciidoc">edit</a></div>
<p>To compare two data sets, add another series, and offset the data back by one hour, then click <span class="strong strong"><strong>Update</strong></span>:</p>
<div class="pre_wrapper lang-text">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-text">.es(index=metricbeat-*,
    timefield='@timestamp',
    metric='avg:system.cpu.user.pct'),
.es(offset=-1h,
    index=metricbeat-*,
    timefield='@timestamp',
    metric='avg:system.cpu.user.pct')</pre>
</div>
<div class="position-relative"><h6><a id="add-label-names"></a>Add label names</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.16/docs/user/dashboard/timelion.asciidoc">edit</a></div>
<p>To easily distinguish between the two data sets, add label names, then click <span class="strong strong"><strong>Update</strong></span>:</p>
<div class="pre_wrapper lang-text">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-text">.es(offset=-1h,index=metricbeat-*,
    timefield='@timestamp',
    metric='avg:system.cpu.user.pct').label('last hour'),
.es(index=metricbeat-*,
    timefield='@timestamp',
    metric='avg:system.cpu.user.pct').label('current hour')</pre>
</div>
<div class="position-relative"><h6><a id="add-a-title"></a>Add a title</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.16/docs/user/dashboard/timelion.asciidoc">edit</a></div>
<p>To make is easier for unfamiliar users to understand the purpose of the visualization, add a title, then click <span class="strong strong"><strong>Update</strong></span>:</p>
<div class="pre_wrapper lang-text">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-text">.es(offset=-1h,
    index=metricbeat-*,
    timefield='@timestamp',
    metric='avg:system.cpu.user.pct')
  .label('last hour'),
.es(index=metricbeat-*,
    timefield='@timestamp',
    metric='avg:system.cpu.user.pct')
  .label('current hour')
  .title('CPU usage over time')</pre>
</div>
<div class="position-relative"><h6><a id="change-the-chart-type"></a>Change the appearance of the chart lines</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.16/docs/user/dashboard/timelion.asciidoc">edit</a></div>
<p>To differentiate between the current hour and the last hour, change the appearance of the chart lines, then click <span class="strong strong"><strong>Update</strong></span>:</p>
<div class="pre_wrapper lang-text">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-text">.es(offset=-1h,
    index=metricbeat-*,
    timefield='@timestamp',
    metric='avg:system.cpu.user.pct')
  .label('last hour')
  .lines(fill=1,width=0.5),
.es(index=metricbeat-*,
    timefield='@timestamp',
    metric='avg:system.cpu.user.pct')
  .label('current hour')
  .title('CPU usage over time')</pre>
</div>
<div class="position-relative"><h6><a id="change-the-line-colors"></a>Change the line colors</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.16/docs/user/dashboard/timelion.asciidoc">edit</a></div>
<p><span class="strong strong"><strong>Timelion</strong></span> supports standard color names, hexadecimal values, or a color schema for grouped data.</p>
<p>To make the first data series stand out, change the line colors, then click <span class="strong strong"><strong>Update</strong></span>:</p>
<div class="pre_wrapper lang-text">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-text">.es(offset=-1h,
    index=metricbeat-*,
    timefield='@timestamp',
    metric='avg:system.cpu.user.pct')
  .label('last hour')
  .lines(fill=1,width=0.5)
  .color(gray),
.es(index=metricbeat-*,
    timefield='@timestamp',
    metric='avg:system.cpu.user.pct')
  .label('current hour')
  .title('CPU usage over time')
  .color(#1E90FF)</pre>
</div>
<div class="position-relative"><h6><a id="make-adjustments-to-the-legend"></a>Adjust the legend</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.16/docs/user/dashboard/timelion.asciidoc">edit</a></div>
<p>Move the legend to the north west position  with two columns, then click <span class="strong strong"><strong>Update</strong></span>:</p>
<div class="pre_wrapper lang-text">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-text">.es(offset=-1h,
    index=metricbeat-*,
    timefield='@timestamp',
    metric='avg:system.cpu.user.pct')
  .label('last hour')
  .lines(fill=1,width=0.5)
  .color(gray),
.es(index=metricbeat-*,
    timefield='@timestamp',
    metric='avg:system.cpu.user.pct')
  .label('current hour')
  .title('CPU usage over time')
  .color(#1E90FF)
  .legend(columns=2, position=nw) <a id="CO29-1"></a><i class="conum" data-value="1"></i></pre>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="images/timelion-customize04.png" alt="Final time series visualization">
</div>
</div>
<p>&#160;</p>
<div class="position-relative"><h6><a id="save-the-timelion-panel"></a>Save and add the panel</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.16/docs/user/dashboard/timelion.asciidoc">edit</a></div>
<p>Save the panel to the <span class="strong strong"><strong>Visualize Library</strong></span> and add it to the dashboard, or add it to the dashboard without saving.</p>
<p>To save the panel to the <span class="strong strong"><strong>Visualize Library</strong></span>:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Click <span class="strong strong"><strong>Save to library</strong></span>.
</li>
<li class="listitem">
Enter the <span class="strong strong"><strong>Title</strong></span> and add any applicable <a class="xref" href="managing-tags.html" title="Tags"><span class="strong strong"><strong>Tags</strong></span></a>.
</li>
<li class="listitem">
Make sure that <span class="strong strong"><strong>Add to Dashboard after saving</strong></span> is selected.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Save and return</strong></span>.
</li>
</ol>
</div>
<p>To save the panel to the dashboard:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Click <span class="strong strong"><strong>Save and return</strong></span>.
</li>
<li class="listitem">
<p>Add an optional title to the panel.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
In the panel header, click <span class="strong strong"><strong>No Title</strong></span>.
</li>
<li class="listitem">
On the <span class="strong strong"><strong>Panel settings</strong></span> window, select <span class="strong strong"><strong>Show title</strong></span>.
</li>
<li class="listitem">
Enter the <span class="strong strong"><strong>Title</strong></span>, then click <span class="strong strong"><strong>Save</strong></span>.
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="position-relative"><h4><a id="timelion-tutorial-create-visualizations-with-mathematical-functions"></a>Visualize the inbound and outbound network traffic</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.16/docs/user/dashboard/timelion.asciidoc">edit</a></div>
<p>To create a visualization for inbound and outbound network traffic, use mathematical functions.</p>
<div class="position-relative"><h5><a id="mathematical-functions-define-functions"></a>Define the functions</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.16/docs/user/dashboard/timelion.asciidoc">edit</a></div>
<p>To start tracking the inbound and outbound network traffic, enter the following in the <span class="strong strong"><strong>Timelion Expression</strong></span> field, then click <span class="strong strong"><strong>Update</strong></span>:</p>
<div class="pre_wrapper lang-text">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-text">.es(index=metricbeat*,
    timefield=@timestamp,
    metric=max:system.network.in.bytes)</pre>
</div>
<div class="position-relative"><h5><a id="mathematical-functions-plot-change"></a>Plot the rate of change</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.16/docs/user/dashboard/timelion.asciidoc">edit</a></div>
<p>To easily monitor the inbound traffic, plots the change in values over time, then click <span class="strong strong"><strong>Update</strong></span>:</p>
<div class="pre_wrapper lang-text">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-text">.es(index=metricbeat*,
    timefield=@timestamp,
    metric=max:system.network.in.bytes)
  .derivative()</pre>
</div>
<p>Add a similar calculation for outbound traffic, then click <span class="strong strong"><strong>Update</strong></span>:</p>
<div class="pre_wrapper lang-text">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-text">.es(index=metricbeat*,
    timefield=@timestamp,
    metric=max:system.network.in.bytes)
  .derivative(),
.es(index=metricbeat*,
    timefield=@timestamp,
    metric=max:system.network.out.bytes)
  .derivative()
  .multiply(-1) <a id="CO29-2"></a><i class="conum" data-value="1"></i></pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO29-1"><i class="conum" data-value="1"></i></a><a href="#CO29-2"></a></p>
</td>
<td align="left" valign="top">
<p><code class="literal">.multiply(-1)</code> converts the outbound network traffic to a negative value since the outbound network traffic is leaving your machine.
<code class="literal">.multiply()</code> multiplies the data series by a number, the result of a data series, or a list of data series.</p>
</td>
</tr>
</table>
</div>
<div class="position-relative"><h5><a id="mathematical-functions-convert-data"></a>Change the data metric</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.16/docs/user/dashboard/timelion.asciidoc">edit</a></div>
<p>To make the data easier to analyze, change the data metric from <code class="literal">bytes</code> to <code class="literal">megabytes</code>, then click <span class="strong strong"><strong>Update</strong></span>:</p>
<div class="pre_wrapper lang-text">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-text">.es(index=metricbeat*,
    timefield=@timestamp,
    metric=max:system.network.in.bytes)
  .derivative()
  .divide(1048576),
.es(index=metricbeat*,
    timefield=@timestamp,
    metric=max:system.network.out.bytes)
  .derivative()
  .multiply(-1)
  .divide(1048576) <a id="CO30-1"></a><i class="conum" data-value="1"></i></pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO30-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p><code class="literal">.divide()</code> accepts the same input as <code class="literal">.multiply()</code>, then divides the data series by the defined divisor.</p>
</td>
</tr>
</table>
</div>
<div class="position-relative"><h5><a id="mathematical-functions-add-labels"></a>Customize and format the visualization</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.16/docs/user/dashboard/timelion.asciidoc">edit</a></div>
<p>Customize and format the visualization using the following functions, then click <span class="strong strong"><strong>Update</strong></span>:</p>
<div class="pre_wrapper lang-text">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-text">.es(index=metricbeat*,
    timefield=@timestamp,
    metric=max:system.network.in.bytes)
  .derivative()
  .divide(1048576)
  .lines(fill=2, width=1)
  .color(green)
  .label("Inbound traffic")
  .title("Network traffic (MB/s)"),
.es(index=metricbeat*,
    timefield=@timestamp,
    metric=max:system.network.out.bytes)
  .derivative()
  .multiply(-1)
  .divide(1048576)
  .lines(fill=2, width=1)
  .color(blue)
  .label("Outbound traffic")
  .legend(columns=2, position=nw)</pre>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="images/timelion-math05.png" alt="Final visualization that displays inbound and outbound network traffic">
</div>
</div>
<p>&#160;</p>
<div class="position-relative"><h6><a id="save-the-network-timelion-panel"></a>Save and add the panel</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.16/docs/user/dashboard/timelion.asciidoc">edit</a></div>
<p>Save the panel to the <span class="strong strong"><strong>Visualize Library</strong></span> and add it to the dashboard, or add it to the dashboard without saving.</p>
<p>To save the panel to the <span class="strong strong"><strong>Visualize Library</strong></span>:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Click <span class="strong strong"><strong>Save to library</strong></span>.
</li>
<li class="listitem">
Enter the <span class="strong strong"><strong>Title</strong></span> and add any applicable <a class="xref" href="managing-tags.html" title="Tags"><span class="strong strong"><strong>Tags</strong></span></a>.
</li>
<li class="listitem">
Make sure that <span class="strong strong"><strong>Add to Dashboard after saving</strong></span> is selected.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Save and return</strong></span>.
</li>
</ol>
</div>
<p>To save the panel to the dashboard:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Click <span class="strong strong"><strong>Save and return</strong></span>.
</li>
<li class="listitem">
<p>Add an optional title to the panel.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
In the panel header, click <span class="strong strong"><strong>No Title</strong></span>.
</li>
<li class="listitem">
On the <span class="strong strong"><strong>Panel settings</strong></span> window, select <span class="strong strong"><strong>Show title</strong></span>.
</li>
<li class="listitem">
Enter the <span class="strong strong"><strong>Title</strong></span>, then click <span class="strong strong"><strong>Save</strong></span>.
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="position-relative"><h5><a id="timelion-tutorial-create-visualizations-withconditional-logic-and-tracking-trends"></a>Detect outliers and discover patterns over time</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.16/docs/user/dashboard/timelion.asciidoc">edit</a></div>
<p>To easily detect outliers and discover patterns over time, modify the time series data with conditional logic and create a trend with a moving average.</p>
<p>With <span class="strong strong"><strong>Timelion</strong></span> conditional logic, you can use the following operator values to compare your data:</p>
<div class="informaltable">
<table border="0" cellpadding="4px">
<colgroup>
<col/>
<col/>
</colgroup>
<tbody valign="top">
<tr>
<td valign="top">
<p>
<code class="literal">eq</code>
</p>
</td>
<td valign="top">
<p>
equal
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">ne</code>
</p>
</td>
<td valign="top">
<p>
not equal
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">lt</code>
</p>
</td>
<td valign="top">
<p>
less than
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">lte</code>
</p>
</td>
<td valign="top">
<p>
less than or equal to
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">gt</code>
</p>
</td>
<td valign="top">
<p>
greater than
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<code class="literal">gte</code>
</p>
</td>
<td valign="top">
<p>
greater than or equal to
</p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="position-relative"><h6><a id="conditional-define-functions"></a>Define the functions</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.16/docs/user/dashboard/timelion.asciidoc">edit</a></div>
<p>To chart the maximum value of <code class="literal">system.memory.actual.used.bytes</code>, enter the following in the <span class="strong strong"><strong>Timelion Expression</strong></span> field, then click <span class="strong strong"><strong>Update</strong></span>:</p>
<div class="pre_wrapper lang-text">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-text">.es(index=metricbeat-*,
    timefield='@timestamp',
    metric='max:system.memory.actual.used.bytes')</pre>
</div>
<div class="position-relative"><h6><a id="conditional-track-memory"></a>Track used memory</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.16/docs/user/dashboard/timelion.asciidoc">edit</a></div>
<p>To track the amount of memory used, create two thresholds, then click <span class="strong strong"><strong>Update</strong></span>:</p>
<div class="pre_wrapper lang-text">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-text">.es(index=metricbeat-*,
    timefield='@timestamp',
    metric='max:system.memory.actual.used.bytes'),
.es(index=metricbeat-*,
    timefield='@timestamp',
    metric='max:system.memory.actual.used.bytes')
  .if(gt,                             <a id="CO31-1"></a><i class="conum" data-value="1"></i>
      11300000000,                    <a id="CO31-2"></a><i class="conum" data-value="2"></i>
      .es(index=metricbeat-*,
          timefield='@timestamp',
          metric='max:system.memory.actual.used.bytes'),
      null)
    .label('warning')
    .color('#FFCC11'),
.es(index=metricbeat-*,
    timefield='@timestamp',
    metric='max:system.memory.actual.used.bytes')
  .if(gt,
      11375000000,
      .es(index=metricbeat-*,
          timefield='@timestamp',
          metric='max:system.memory.actual.used.bytes'),
      null)
  .label('severe')
  .color('red')</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO31-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p><code class="literal">if()</code> compares each point to a number. When the condition is <code class="literal">true</code>, adjust the styling. When the condition is <code class="literal">false</code>, use the default styling.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO31-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p><span class="strong strong"><strong>Timelion</strong></span> conditional logic for the <em>greater than</em> operator. In this example, the warning threshold is 11.3GB (<code class="literal">11300000000</code>),
and the severe threshold is 11.375GB (<code class="literal">11375000000</code>). If the threshold values are too high or low for your machine, adjust the values.</p>
</td>
</tr>
</table>
</div>
<div class="position-relative"><h6><a id="conditional-determine-trend"></a>Determine the trend</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.16/docs/user/dashboard/timelion.asciidoc">edit</a></div>
<p>To determine the trend, create a new data series, then click <span class="strong strong"><strong>Update</strong></span>:</p>
<div class="pre_wrapper lang-text">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-text">.es(index=metricbeat-*,
    timefield='@timestamp',
    metric='max:system.memory.actual.used.bytes'),
.es(index=metricbeat-*,
    timefield='@timestamp',
    metric='max:system.memory.actual.used.bytes')
  .if(gt,11300000000,
      .es(index=metricbeat-*,
          timefield='@timestamp',
          metric='max:system.memory.actual.used.bytes'),
      null)
      .label('warning')
      .color('#FFCC11'),
.es(index=metricbeat-*,
    timefield='@timestamp',
    metric='max:system.memory.actual.used.bytes')
  .if(gt,11375000000,
      .es(index=metricbeat-*,
          timefield='@timestamp',
          metric='max:system.memory.actual.used.bytes'),
      null).
      label('severe')
      .color('red'),
.es(index=metricbeat-*,
    timefield='@timestamp',
    metric='max:system.memory.actual.used.bytes')
  .mvavg(10) <a id="CO32-1"></a><i class="conum" data-value="1"></i></pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO32-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p><code class="literal">mvavg()</code> calculates the moving average over a specified period of time.
In this example, <code class="literal">.mvavg(10)</code> creates a moving average with a window of 10 data points.</p>
</td>
</tr>
</table>
</div>
<div class="position-relative"><h6><a id="conditional-format-visualization"></a>Customize and format the visualization</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.16/docs/user/dashboard/timelion.asciidoc">edit</a></div>
<p>Customize and format the visualization using the following functions, then click <span class="strong strong"><strong>Update</strong></span>:</p>
<div class="pre_wrapper lang-text">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-text">.es(index=metricbeat-*,
    timefield='@timestamp',
    metric='max:system.memory.actual.used.bytes')
  .label('max memory')                    <a id="CO33-1"></a><i class="conum" data-value="1"></i>
  .title('Memory consumption over time'), <a id="CO33-2"></a><i class="conum" data-value="2"></i>
.es(index=metricbeat-*,
    timefield='@timestamp',
    metric='max:system.memory.actual.used.bytes')
  .if(gt,
      11300000000,
      .es(index=metricbeat-*,
          timefield='@timestamp',
          metric='max:system.memory.actual.used.bytes'),
      null)
    .label('warning')
    .color('#FFCC11')                 <a id="CO33-3"></a><i class="conum" data-value="3"></i>
    .lines(width=5),                  <a id="CO33-4"></a><i class="conum" data-value="4"></i>
.es(index=metricbeat-*,
    timefield='@timestamp',
    metric='max:system.memory.actual.used.bytes')
  .if(gt,
      11375000000,
      .es(index=metricbeat-*,
          timefield='@timestamp',
          metric='max:system.memory.actual.used.bytes'),
      null)
    .label('severe')
    .color('red')
    .lines(width=5),
.es(index=metricbeat-*,
    timefield='@timestamp',
    metric='max:system.memory.actual.used.bytes')
  .mvavg(10)
  .label('mvavg')
  .lines(width=2)
  .color(#5E5E5E)
  .legend(columns=4, position=nw)    <a id="CO33-5"></a><i class="conum" data-value="5"></i></pre>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="images/timelion-conditional04.png" alt="Final visualization that displays outliers and patterns over time">
</div>
</div>
<p>&#160;</p>
<div class="position-relative"><h6><a id="save-the-outlier-timelion-panel"></a>Save and add the panel</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.16/docs/user/dashboard/timelion.asciidoc">edit</a></div>
<p>Save the panel to the <span class="strong strong"><strong>Visualize Library</strong></span> and add it to the dashboard, or add it to the dashboard without saving.</p>
<p>To save the panel to the <span class="strong strong"><strong>Visualize Library</strong></span>:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Click <span class="strong strong"><strong>Save to library</strong></span>.
</li>
<li class="listitem">
Enter the <span class="strong strong"><strong>Title</strong></span> and add any applicable <a class="xref" href="managing-tags.html" title="Tags"><span class="strong strong"><strong>Tags</strong></span></a>.
</li>
<li class="listitem">
Make sure that <span class="strong strong"><strong>Add to Dashboard after saving</strong></span> is selected.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Save and return</strong></span>.
</li>
</ol>
</div>
<p>To save the panel to the dashboard:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Click <span class="strong strong"><strong>Save and return</strong></span>.
</li>
<li class="listitem">
<p>Add an optional title to the panel.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
In the panel header, click <span class="strong strong"><strong>No Title</strong></span>.
</li>
<li class="listitem">
On the <span class="strong strong"><strong>Panel settings</strong></span> window, select <span class="strong strong"><strong>Show title</strong></span>.
</li>
<li class="listitem">
Enter the <span class="strong strong"><strong>Title</strong></span>, then click <span class="strong strong"><strong>Save</strong></span>.
</li>
</ol>
</div>
</li>
</ol>
</div>
<p>For more information about <span class="strong strong"><strong>Timelion</strong></span> conditions, refer to <a href="/blog/timeseries-if-then-else-with-timelion" class="ulink" target="_top">I have but one .condition()</a>.</p>
</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="dashboard-links.html">« Link panels</a>
</span>
<span class="next">
<a href="_manage_dashboards.html">Manage dashboards »</a>
</span>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>

                        <!-- Feedback widget -->
                        <div id="feedbackWidgetContainer"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


        <div id='elastic-footer'></div>
        <script src='https://www.elastic.co/elastic-footer.js'></script>
        <!-- Footer Section end-->

      </section>
    </div>

    <!-- Feedback modal -->
    <div id="feedbackModalContainer"></div>

    <script src="/guide/static/jquery.js"></script>
    <script type="text/javascript" src="/guide/static/docs-v1.js"></script>
    <script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
