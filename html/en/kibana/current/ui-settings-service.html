<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<meta name="description" content="Conceptual and step-by-step procedures for using runtime fields, scripted fields, and field formatters.">
<meta name="keywords" content="administrator, data view, data views, management, runtime fields, runtime fields in Kibana, scripted fields, field formatters, data fields, index pattern, index patterns">
<title>UI settings service | Kibana Guide [8.3] | Elastic</title>
<link rel="home" href="index.html" title="Kibana Guide [8.3]"/>
<link rel="up" href="kibana-architecture.html" title="Architecture"/>
<link rel="prev" href="saved-objects-service.html" title="Saved Objects service"/>
<link rel="next" href="patterns.html" title="Patterns"/>
<meta name="DC.type" content="Learn/Docs/Kibana/Reference/8.3"/>
<meta name="DC.subject" content="Kibana"/>
<meta name="DC.identifier" content="8.3"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <!--© 2015-2022 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!--BEGIN QUALTRICS WEBSITE FEEDBACK SNIPPET-->
    <script type='text/javascript'>
      (function(){var g=function(e,h,f,g){
      this.get=function(a){for(var a=a+"=",c=document.cookie.split(";"),b=0,e=c.length;b<e;b++){for(var d=c[b];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return null};
      this.set=function(a,c){var b="",b=new Date;b.setTime(b.getTime()+6048E5);b="; expires="+b.toGMTString();document.cookie=a+"="+c+b+"; path=/; "};
      this.check=function(){var a=this.get(f);if(a)a=a.split(":");else if(100!=e)"v"==h&&(e=Math.random()>=e/100?0:100),a=[h,e,0],this.set(f,a.join(":"));else return!0;var c=a[1];if(100==c)return!0;switch(a[0]){case "v":return!1;case "r":return c=a[2]%Math.floor(100/c),a[2]++,this.set(f,a.join(":")),!c}return!0};
      this.go=function(){if(this.check()){var a=document.createElement("script");a.type="text/javascript";a.src=g;document.body&&document.body.appendChild(a)}};
      this.start=function(){var a=this;window.addEventListener?window.addEventListener("load",function(){a.go()},!1):window.attachEvent&&window.attachEvent("onload",function(){a.go()})}};
      try{(new g(100,"r","QSI_S_ZN_emkP0oSe9Qrn7kF","https://znemkp0ose9qrn7kf-elastic.siteintercept.qualtrics.com/WRSiteInterceptEngine/?Q_ZID=ZN_emkP0oSe9Qrn7kF")).start()}catch(i){}})();
    </script><div id='ZN_emkP0oSe9Qrn7kF'><!--DO NOT REMOVE-CONTENTS PLACED HERE--></div>
    <!--END WEBSITE FEEDBACK SNIPPET-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="index.html">Kibana Guide [8.3]</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="development.html">Developer guide</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="kibana-architecture.html">Architecture</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="saved-objects-service.html">« Saved Objects service</a>
</span>
<span class="next">
<a href="patterns.html">Patterns »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="ui-settings-service"></a>UI settings service<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/8.3/docs/developer/architecture/core/uisettings-service.asciidoc">edit</a></h2>
</div></div></div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The UI settings service is available both server and client side.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_overview"></a>Overview<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/8.3/docs/developer/architecture/core/uisettings-service.asciidoc">edit</a></h3>
</div></div></div>
<p>UI settings are configurable from the Advanced Settings page in Management and control the behavior of Kibana. uiSettings are stored in a config saved object and, as such, conform to the same conditions as other <a class="xref" href="saved-objects-service.html" title="Saved Objects service">Saved Objects</a>.</p>
<p>There are several ways to configure an advanced setting:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="ui-settings-service.html#advanced-settings-ui" title="Configuration with Advanced Settings UI">Through the Advanced Settings UI</a>
</li>
<li class="listitem">
<a class="xref" href="ui-settings-service.html#uisettings-overrides" title="Configuration with UI settings overrides">Locked via kibana.yml&#8217;s uiSettings.overrides</a>
</li>
<li class="listitem">
<a class="xref" href="ui-settings-service.html#client-side-usage" title="Client side usage">Through the client-side uiSettings Service</a>
</li>
<li class="listitem">
<a class="xref" href="ui-settings-service.html#server-side-usage" title="Server side usage">Through the server-side uiSettings Service</a>
</li>
</ul>
</div>
<p>Keep in mind that once you add a new advanced setting, you cannot change or remove it without <a class="xref" href="ui-settings-service.html#uisettings-migrations" title="Migrations">registering a migration in core</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="advanced-settings-ui"></a>Configuration with Advanced Settings UI<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/8.3/docs/developer/architecture/core/uisettings-service.asciidoc">edit</a></h3>
</div></div></div>
<p>The uiSettings service is the programmatic interface to Kibana&#8217;s Advanced Settings UI. Kibana plugins use the service to extend Kibana UI Settings Management with custom settings for their plugin.</p>
<p>Configuration through the Advanced Settings UI is restricted to users authorised to acces the Advanced Settings page. Users who don&#8217;t have permissions to change these values default to using the settings configured to the space they are in. Config saved objects can be shared between spaces.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="uisettings-overrides"></a>Configuration with UI settings overrides<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/8.3/docs/developer/architecture/core/uisettings-service.asciidoc">edit</a></h3>
</div></div></div>
<p><span class="Admonishment Admonishment--preview">
[<span class="Admonishment-title u-mono">preview</span>]
<span class="Admonishment-detail">
This functionality is in technical preview and may be changed or removed in a future release. Elastic will apply best effort to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.
</span>
</span> When a setting is configured as an override in kibana.yml, it will override any other value stored in the config saved object. If an override is misconfigured, it will fail config validation and prevent Kibana from starting up. The override applies to Kibana as a whole for all spaces and users and the option will be disabled in the Advanced Settings page. We refer to these as "global" overrides.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="client-side-usage"></a>Client side usage<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/8.3/docs/developer/architecture/core/uisettings-service.asciidoc">edit</a></h3>
</div></div></div>
<p>On the client, the <code class="literal">uiSettings</code> service is exposed directly from <code class="literal">core</code> and the <a href="https://github.com/elastic/kibana/blob/8.3/docs/development/core/public/kibana-plugin-core-public.iuisettingsclient.md" class="ulink" target="_top">client</a> provides plugins access to the <code class="literal">config</code> entries stored in Elasticsearch.</p>
<p>In the interest of performance, <code class="literal">uiSettings</code> are cached. Any changes that require cache refreshes should register an instruction to reload the page when settings are configured in Advanced Settings using the <code class="literal">requiresPageReload</code> <a href="https://github.com/elastic/kibana/blob/8.3/docs/development/core/public/kibana-plugin-core-public.uisettingsparams.md" class="ulink" target="_top">parameter</a>.</p>
<div class="pre_wrapper lang-typescript">
<pre class="programlisting prettyprint lang-typescript">import { CoreSetup, Plugin } from 'src/core/public';

export class MyPlugin implements Plugin&lt;MyPluginSetup, MyPluginStart&gt; {
  public setup(core: CoreSetup): MyPluginSetup {
    …
    core.uiSettings.getUpdate$().subscribe(({ key, newValue }) =&gt; {
      if (key === 'custom') {
        // do something with changes...
        myPluginService.register({
          …
        })
      }
    });
    …
  }

  public start(core: CoreStart): MyPluginStart {
    return {
      …
      settings: {
        getCustomValue: () =&gt; core.uiSettings.get('custom'),
        …
      },
    };
  }
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="server-side-usage"></a>Server side usage<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/8.3/docs/developer/architecture/core/uisettings-service.asciidoc">edit</a></h3>
</div></div></div>
<p>On the server, <code class="literal">uiSettings</code> are exposed directly from <code class="literal">core</code>.</p>
<p>The following example shows how to <a href="https://github.com/elastic/kibana/blob/8.3/docs/development/core/server/kibana-plugin-core-server.uisettingsservicesetup.register.md" class="ulink" target="_top">register</a> a new <code class="literal">custom</code> setting with a default value of <em>42</em>. When registering a new setting, you must provide a schema against which validations are performed on read and write. All the other <a href="https://github.com/elastic/kibana/blob/8.3/docs/development/core/server/kibana-plugin-core-server.uisettingsparams.md" class="ulink" target="_top">parameters</a> are optional.</p>
<div class="pre_wrapper lang-typescript">
<pre class="programlisting prettyprint lang-typescript">import { schema } from '@kbn/config-schema';
import type { CoreSetup,Plugin } from '@kbn/core/server';

export class MyPlugin implements Plugin {
  public setup(core: CoreSetup) {
    core.uiSettings.register({
      custom: {
        value: '42',
        schema: schema.string(),
      },
    });
    const router = core.http.createRouter();
    router.get({
      path: 'my_plugin/{id}',
      validate: …,
    },
    async (context, request, response) =&gt; {
      const customSetting = await context.uiSettings.client.get('custom');
      …
    });
  }
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="uisettings-migrations"></a>Migrations<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/8.3/docs/developer/architecture/core/uisettings-service.asciidoc">edit</a></h3>
</div></div></div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Migrations for 3rd party plugin advanced settings are not currently supported. If a 3rd party plugin registers an advanced setting, the setting is essentially permanent and cannot be fixed without manual intervention.</p>
</div>
</div>
<p>To change or remove a <code class="literal">uiSetting</code>, the whole <code class="literal">config</code> Saved Object needs to be migrated. <code class="literal">uiSettings</code> <a href="https://github.com/elastic/kibana/blob/8.3/src/core/server/ui_settings/saved_objects/migrations.ts" class="ulink" target="_top">migrations</a> are declared directly in the service.</p>
<p>For example, if we wanted to remove a <code class="literal">custom</code> setting, or rename <code class="literal">my_setting:fourtyTwo</code> to <code class="literal">my_other_setting:fourtyTwo</code>, we&#8217;d need two migration entries, one for each change targeting the version in which these changes apply:</p>
<div class="pre_wrapper lang-typescript">
<pre class="programlisting prettyprint lang-typescript">export const migrations = {
  ...
  '8.1.0': (doc: SavedObjectUnsanitizedDoc&lt;any&gt;): SavedObjectSanitizedDoc&lt;any&gt; =&gt; ({
  ...doc,
  ...(doc.attributes &amp;&amp; {
    attributes: Object.keys(doc.attributes).reduce(
      (acc, key) =&gt;
        [
          // other settings to remove for 8.1.0...
          'custom',
        ].includes(key)
          ? {
              ...acc,
            }
          : {
              ...acc,
              [key]: doc.attributes[key],
            },
      {}
    ),
  }),
  references: doc.references || [],
  }),
  '8.2.0': (doc: SavedObjectUnsanitizedDoc&lt;any&gt;): SavedObjectSanitizedDoc&lt;any&gt; =&gt; ({
    ...doc,
    ...(doc.attributes &amp;&amp; {
      attributes: Object.keys(doc.attributes).reduce(
        (acc, key) =&gt;
          key.startsWith('my_setting:')
            ? {
                ...acc,
                [key.replace('my_setting', 'my_other_setting')]: doc.attributes[key],
              }
            : {
                ...acc,
                [key]: doc.attributes[key],
              },
        {}
      ),
    }),
    references: doc.references || [],
  }),
  …
}</pre>
</div>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>Plugins can leverage the optional deprecation parameter on registration for handling deprecation notices and renames. The deprecation warnings are rendered in the Advanced Settings UI and should also be added to the <a class="xref" href="settings.html" title="Configure Kibana">Configure Kibana</a> guide.</p>
</div>
</div>
</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="saved-objects-service.html">« Saved Objects service</a>
</span>
<span class="next">
<a href="patterns.html">Patterns »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
