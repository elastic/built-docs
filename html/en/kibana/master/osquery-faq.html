<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<meta name="description" content="Kibana provides you with several options to share *Discover* saved searches, dashboards, *Visualize Library* visualizations, and *Canvas* workpads with others, or on a website.">
<meta name="keywords" content="analyst, concept, task, reporting">
<title>Osquery FAQ | Kibana Guide [master] | Elastic</title>
<link rel="home" href="index.html" title="Kibana Guide [master]"/>
<link rel="up" href="osquery.html" title="Osquery"/>
<link rel="prev" href="prebuilt-packs.html" title="Prebuilt packs reference"/>
<link rel="next" href="xpack-monitoring.html" title="Stack Monitoring"/>
<meta name="DC.type" content="Learn/Docs/Kibana/Reference/master"/>
<meta name="DC.subject" content="Kibana"/>
<meta name="DC.identifier" content="master"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <!--© 2015-2022 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!--BEGIN QUALTRICS WEBSITE FEEDBACK SNIPPET-->
    <script type='text/javascript'>
      (function(){var g=function(e,h,f,g){
      this.get=function(a){for(var a=a+"=",c=document.cookie.split(";"),b=0,e=c.length;b<e;b++){for(var d=c[b];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return null};
      this.set=function(a,c){var b="",b=new Date;b.setTime(b.getTime()+6048E5);b="; expires="+b.toGMTString();document.cookie=a+"="+c+b+"; path=/; "};
      this.check=function(){var a=this.get(f);if(a)a=a.split(":");else if(100!=e)"v"==h&&(e=Math.random()>=e/100?0:100),a=[h,e,0],this.set(f,a.join(":"));else return!0;var c=a[1];if(100==c)return!0;switch(a[0]){case "v":return!1;case "r":return c=a[2]%Math.floor(100/c),a[2]++,this.set(f,a.join(":")),!c}return!0};
      this.go=function(){if(this.check()){var a=document.createElement("script");a.type="text/javascript";a.src=g;document.body&&document.body.appendChild(a)}};
      this.start=function(){var a=this;window.addEventListener?window.addEventListener("load",function(){a.go()},!1):window.attachEvent&&window.attachEvent("onload",function(){a.go()})}};
      try{(new g(100,"r","QSI_S_ZN_emkP0oSe9Qrn7kF","https://znemkp0ose9qrn7kf-elastic.siteintercept.qualtrics.com/WRSiteInterceptEngine/?Q_ZID=ZN_emkP0oSe9Qrn7kF")).start()}catch(i){}})();
    </script><div id='ZN_emkP0oSe9Qrn7kF'><!--DO NOT REMOVE-CONTENTS PLACED HERE--></div>
    <!--END WEBSITE FEEDBACK SNIPPET-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  <div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="index.html">Kibana Guide [master]</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="osquery.html">Osquery</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="prebuilt-packs.html">« Prebuilt packs reference</a>
</span>
<span class="next">
<a href="xpack-monitoring.html">Stack Monitoring »</a>
</span>
</div>
<div class="chapter">
<div class="titlepage"><div><div>
<h2 class="title"><a id="osquery-faq"></a>Osquery FAQ<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/main/docs/osquery/osquery-faq.asciidoc">edit</a></h2>
</div></div></div>
<p>This list of frequently asked questions answers common questions about
using Osquery in Kibana.</p>
<h3><a id="osquery-differences"></a>How is Osquery Manager different from Osquery?<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/main/docs/osquery/osquery-faq.asciidoc">edit</a></h3>
<p>The Osquery Manager integration brings <a href="https://osquery.io/" class="ulink" target="_top">Osquery</a> capabilities to the Elastic Stack and
makes it easier to manage Osquery across a large number of hosts.
Most Osquery functionality works the same way in Kibana as it does when you deploy Osquery yourself.
However, there are a few differences and known issues, outlined below.</p>
<h3><a id="osquery-fda"></a>How do I grant Full Disk Access?<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/main/docs/osquery/osquery-faq.asciidoc">edit</a></h3>
<p>Full Disk Access (FDA) is required to fully query some tables on MacOS. Granting FDA is
not yet supported for Osquery Manager. This impacts a small set
of tables that access file directories that are restricted due to heightened permissions from Apple,
including <a href="https://osquery.io/schema/current#file" class="ulink" target="_top">file</a>,
<a href="https://osquery.io/schema/current#file_events" class="ulink" target="_top">file_events</a>,
<a href="https://osquery.io/schema/current#es_process_events" class="ulink" target="_top">es_process_events</a>,
and any custom tables configured with
<a href="https://osquery.readthedocs.io/en/stable/deployment/configuration/#automatic-table-construction" class="ulink" target="_top">ATC</a>
that require access to these directories.
When querying these tables, you won&#8217;t get results from the restricted directories.</p>
<h3><a id="osquery-carves"></a>Why can&#8217;t I query the carves table?<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/main/docs/osquery/osquery-faq.asciidoc">edit</a></h3>
<p>File carving is not yet supported in the Elastic Stack, and
<a href="https://osquery.io/schema/current#carves" class="ulink" target="_top">carves</a> table queries do not return results.</p>
<h3><a id="osquery-help-command"></a>Does the Osquery <code class="literal">.help</code> command work in Kibana?<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/main/docs/osquery/osquery-faq.asciidoc">edit</a></h3>
<p>The <a href="https://osquery.readthedocs.io/en/stable/introduction/sql/#shell-help" class="ulink" target="_top">Osquery <code class="literal">.help</code> command</a>
is not available when running live queries in Kibana. Instead, refer to the
<a href="https://osquery.io/schema/" class="ulink" target="_top">Osquery schema</a> for all available tables, fields,
and supported Operating Systems for each.</p>
<h3><a id="osquery-extensions"></a>Can I use Osquery extensions in Kibana?<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/main/docs/osquery/osquery-faq.asciidoc">edit</a></h3>
<p>Osquery Manager does not currently support
<a href="https://osquery.readthedocs.io/en/stable/deployment/extensions/" class="ulink" target="_top">Osquery extensions</a>.</p>
<h3><a id="osquery-fim"></a>Can I  do File Integrity Monitoring (FIM)?<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/main/docs/osquery/osquery-faq.asciidoc">edit</a></h3>
<p>Yes, you can set up
<a href="https://osquery.readthedocs.io/en/stable/deployment/file-integrity-monitoring/" class="ulink" target="_top">Osquery FIM</a> using
the Advanced configuration option for Osquery Manager (see <a class="xref" href="manage-osquery-integration.html#osquery-custom-config" title="Customize Osquery configuration">Customize Osquery configuration</a>).
However, Elastic also provides a <a href="https://docs.elastic.co/en/integrations/fim" class="ulink" target="_top">File Integrity Monitoring</a> integration for Elastic Agent, which might prove
to be easier to configure than the current options available for Osquery Manager.</p>
<h3><a id="osquery-syntax"></a>Where can I get help with osquery syntax?<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/main/docs/osquery/osquery-faq.asciidoc">edit</a></h3>
<p>Osquery uses a superset of SQLite for queries.
To get started with osquery SQL, refer to the
<a href="https://osquery.readthedocs.io/en/stable/introduction/sql/" class="ulink" target="_top">Osquery documentation</a>.
For help with more advanced questions, the Osquery community has an active
Slack workspace and GitHub project. You can find links for both at <a href="https://osquery.io/" class="ulink" target="_top">osquery.io</a>.</p>
<h3><a id="osquery-updates"></a>How often is Osquery updated for Osquery Manager?<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/main/docs/osquery/osquery-faq.asciidoc">edit</a></h3>
<p>When a new <a href="https://github.com/osquery/osquery/releases" class="ulink" target="_top">version of Osquery is released</a>,
it is included in a subsequent Elastic Agent release and applied when the agent is upgraded.
After that, when running queries from Osquery Manager in Kibana, the updated Osquery version is used.
Refer to the Fleet and Elastic Agent Guide for help with
<a href="/guide/en/fleet/master/upgrade-elastic-agent.html" class="ulink" target="_top">upgrading Fleet-managed Elastic Agents</a>.</p>
<p>To check what Osquery version is installed on an Elastic Agent, you can run
<code class="literal">SELECT version FROM osquery_info;</code> as a live query in Kibana. The <code class="literal">version</code> in the
response is the Osquery version installed on the agent.</p>
</div>
<div class="navfooter">
<span class="prev">
<a href="prebuilt-packs.html">« Prebuilt packs reference</a>
</span>
<span class="next">
<a href="xpack-monitoring.html">Stack Monitoring »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
