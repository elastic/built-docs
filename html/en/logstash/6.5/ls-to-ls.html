<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Logstash-to-Logstash Communication | Logstash Reference [6.5] | Elastic</title>
<meta class="elastic" name="content" content="Logstash-to-Logstash Communication | Logstash Reference [6.5]">

<link rel="home" href="index.html" title="Logstash Reference [6.5]"/>
<link rel="up" href="configuration.html" title="Configuring Logstash"/>
<link rel="prev" href="ingest-converter.html" title="Converting Ingest Node Pipelines"/>
<link rel="next" href="configuring-centralized-pipelines.html" title="Configuring Centralized Pipeline Management"/>
<meta class="elastic" name="product_version" content="6.5"/>
<meta class="elastic" name="product_name" content="Logstash"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Logstash/Reference/6.5"/>
<meta name="DC.subject" content="Logstash"/>
<meta name="DC.identifier" content="6.5"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="icon" href="/favicon.ico" sizes="32x32"/>
    <link rel="icon" href="/favicon.svg" type="image/svg+xml"/>
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" sizes="180x180"/>
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles-v1.css" />
  </head>

  <!--© 2015-2025 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div class="navheader">
<span class="prev">
<a href="ingest-converter.html">« Converting Ingest Node Pipelines</a>
</span>
<span class="next">
<a href="configuring-centralized-pipelines.html">Configuring Centralized Pipeline Management »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Logstash Reference [6.5]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="configuration.html">Configuring Logstash</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Logstash-to-Logstash Communication</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/logstash/edit/6.5/docs/static/ls-ls-config.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div id="url-to-v3" class="version-warning">
    <strong>IMPORTANT</strong>: This documentation is no longer updated. Refer to <a href="https://www.elastic.co/support/eol">Elastic's version policy</a> and the <a href="https://www.elastic.co/docs/reference/logstash/logstash-to-logstash-communications">latest documentation</a>.
</div>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="ls-to-ls"></a>Logstash-to-Logstash Communication</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/logstash/edit/6.5/docs/static/ls-ls-config.asciidoc">edit</a></div>
</div></div></div>
<p>You can set up communication between two Logstash machines by connecting the Lumberjack output to the Beats input. You may need this configuration if the data path crosses network or firewall boundaries, for example. If you don&#8217;t have a compelling need for Logstash-to-Logstash communication, then don&#8217;t implement it.</p>
<p>If you are looking for information on connecting multiple pipelines within one
Logstash instance, see <a class="xref" href="pipeline-to-pipeline.html" title="Pipeline-to-Pipeline Communication (Beta)">Pipeline-to-Pipeline Communication (Beta)</a>.</p>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_configuration_overview"></a>Configuration overview</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/logstash/edit/6.5/docs/static/ls-ls-config.asciidoc">edit</a></div>
</div></div></div>
<p>Use the Lumberjack protocol to connect two Logstash machines.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Generate a trusted SSL certificate (required by the lumberjack protocol).
</li>
<li class="listitem">
Copy the SSL certificate to the upstream Logstash machine.
</li>
<li class="listitem">
Copy the SSL certificate and key to the downstream Logstash machine.
</li>
<li class="listitem">
Set the upstream Logstash machine to use the Lumberjack output to send data.
</li>
<li class="listitem">
Set the downstream Logstash machine to listen for incoming Lumberjack connections through the Beats input.
</li>
<li class="listitem">
Test it.
</li>
</ol>
</div>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h4 class="title"><a id="generate-self-signed-cert"></a>Generate a self-signed SSL certificate and key</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/logstash/edit/6.5/docs/static/ls-ls-config.asciidoc">edit</a></div>
</div></div></div>
<p>Use the <code class="literal">openssl req</code> command to generate a self-signed certificate and key. The <code class="literal">openssl req</code> command is available with some operating systems. You may need to install the openssl command line program for others.</p>
<p>Run the following command:</p>
<div class="pre_wrapper lang-shell">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-shell">openssl req -x509 -batch -nodes -newkey rsa:2048 -keyout lumberjack.key -out lumberjack.cert -subj /CN=localhost</pre>
</div>
<p>where:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">lumberjack.key</code> is the name of the SSL key to be created
</li>
<li class="listitem">
<code class="literal">lumberjack.cert</code> is the name of the SSL certificate to be created
</li>
<li class="listitem">
<code class="literal">localhost</code> is the name of the upstream Logstash computer
</li>
</ul>
</div>
<p>This command produces output similar to the following:</p>
<div class="pre_wrapper lang-shell">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-shell">Generating a 2048 bit RSA private key
.................................+++
....................+++
writing new private key to 'lumberjack.key'</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h4 class="title"><a id="copy-cert-key"></a>Copy the SSL certificate and key</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/logstash/edit/6.5/docs/static/ls-ls-config.asciidoc">edit</a></div>
</div></div></div>
<p>Copy the SSL certificate to the upstream Logstash machine.</p>
<p>Copy the SSL certificate and key to the downstream Logstash machine.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h4 class="title"><a id="save-cert-ls1"></a>Start the upstream Logstash instance</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/logstash/edit/6.5/docs/static/ls-ls-config.asciidoc">edit</a></div>
</div></div></div>
<p>Start Logstash and generate test events:</p>
<div class="pre_wrapper lang-shell">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-shell">bin/logstash -e 'input { generator { count =&gt; 5 } } output { lumberjack { codec =&gt; json hosts =&gt; "mydownstreamhost" ssl_certificate =&gt; "lumberjack.cert" port =&gt; 5000 } }'</pre>
</div>
<p>This sample command sends five events to mydownstreamhost:5000 using the SSL certificate provided.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h4 class="title"><a id="save-cert-ls2"></a>Start the downstream Logstash instance</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/logstash/edit/6.5/docs/static/ls-ls-config.asciidoc">edit</a></div>
</div></div></div>
<p>Start the downstream instance of Logstash:</p>
<div class="pre_wrapper lang-shell">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-shell">bin/logstash -e 'input { beats { codec =&gt; json port =&gt; 5000 ssl =&gt; true ssl_certificate =&gt; "lumberjack.cert" ssl_key =&gt; "lumberjack.key"} }'</pre>
</div>
<p>This sample command sets port 5000 to listen for incoming Beats input.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h4 class="title"><a id="test-ls-to-ls"></a>Verify the communication</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/logstash/edit/6.5/docs/static/ls-ls-config.asciidoc">edit</a></div>
</div></div></div>
<p>Watch the downstream Logstash machine for the incoming events. You should see five incrementing events similar to the following:</p>
<div class="pre_wrapper lang-shell">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-shell">{
  "@timestamp" =&gt; 2018-02-07T12:16:39.415Z,
  "sequence"   =&gt; 0
  "tags"       =&gt; [
    [0] "beats_input_codec_json_applied"
  ],
  "message"    =&gt; "Hello world",
  "@version"   =&gt; "1",
  "host"       =&gt; "ls1.semicomplete.com"
}</pre>
</div>
<p>If you see all five events with consistent fields and formatting, incrementing by one, then your configuration is correct.</p>
</div>

</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="ingest-converter.html">« Converting Ingest Node Pipelines</a>
</span>
<span class="next">
<a href="configuring-centralized-pipelines.html">Configuring Centralized Pipeline Management »</a>
</span>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>

                        <!-- Feedback widget -->
                        <div id="feedbackWidgetContainer"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


        <div id='elastic-footer'></div>
        <script src='https://www.elastic.co/elastic-footer.js'></script>
        <!-- Footer Section end-->

      </section>
    </div>

    <!-- Feedback modal -->
    <div id="feedbackModalContainer"></div>

    <script src="/guide/static/jquery.js"></script>
    <script type="text/javascript" src="/guide/static/docs-v1.js"></script>
    <script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
