<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>JVM settings | Logstash Reference [7.12] | Elastic</title>
<link rel="home" href="index.html" title="Logstash Reference [7.12]"/>
<link rel="up" href="tips.html" title="Tips and Best Practices"/>
<link rel="prev" href="tips.html" title="Tips and Best Practices"/>
<link rel="next" href="troubleshooting.html" title="Troubleshooting"/>
<meta name="DC.type" content="Learn/Docs/Logstash/Reference/7.12"/>
<meta name="DC.subject" content="Logstash"/>
<meta name="DC.identifier" content="7.12"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!--BEGIN QUALTRICS WEBSITE FEEDBACK SNIPPET-->
    <script type='text/javascript'>
      (function(){var g=function(e,h,f,g){
      this.get=function(a){for(var a=a+"=",c=document.cookie.split(";"),b=0,e=c.length;b<e;b++){for(var d=c[b];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return null};
      this.set=function(a,c){var b="",b=new Date;b.setTime(b.getTime()+6048E5);b="; expires="+b.toGMTString();document.cookie=a+"="+c+b+"; path=/; "};
      this.check=function(){var a=this.get(f);if(a)a=a.split(":");else if(100!=e)"v"==h&&(e=Math.random()>=e/100?0:100),a=[h,e,0],this.set(f,a.join(":"));else return!0;var c=a[1];if(100==c)return!0;switch(a[0]){case "v":return!1;case "r":return c=a[2]%Math.floor(100/c),a[2]++,this.set(f,a.join(":")),!c}return!0};
      this.go=function(){if(this.check()){var a=document.createElement("script");a.type="text/javascript";a.src=g;document.body&&document.body.appendChild(a)}};
      this.start=function(){var a=this;window.addEventListener?window.addEventListener("load",function(){a.go()},!1):window.attachEvent&&window.attachEvent("onload",function(){a.go()})}};
      try{(new g(100,"r","QSI_S_ZN_emkP0oSe9Qrn7kF","https://znemkp0ose9qrn7kf-elastic.siteintercept.qualtrics.com/WRSiteInterceptEngine/?Q_ZID=ZN_emkP0oSe9Qrn7kF")).start()}catch(i){}})();
    </script><div id='ZN_emkP0oSe9Qrn7kF'><!--DO NOT REMOVE-CONTENTS PLACED HERE--></div>
    <!--END WEBSITE FEEDBACK SNIPPET-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <!-- Subnav -->
    <div>
      <div>
        <div class="tertiary-nav d-none d-md-block">
          <div class="container">
            <div class="p-t-b-15 d-flex justify-content-between nav-container">
              <div class="breadcrum-wrapper"><span><a href="/guide/" style="font-size: 14px; font-weight: 600; color: #000;">Docs</a></span></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container">
              <div class="row">
                <div class="col-xs-12 col-sm-8 col-md-8 guide-section">
                  <!-- start body -->
                  <div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Logstash Reference [7.12]</a></span>
»
<span class="breadcrumb-link"><a href="tips.html">Tips and Best Practices</a></span>
»
<span class="breadcrumb-node">JVM settings</span>
</div>
<div class="navheader">
<span class="prev">
<a href="tips.html">« Tips and Best Practices</a>
</span>
<span class="next">
<a href="troubleshooting.html">Troubleshooting »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="jvm-settings"></a>JVM settings<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/logstash/edit/7.12/docs/static/config-details.asciidoc">edit</a></h2>
</div></div></div>
<p>Configure the jvm settings in the <code class="literal">jvm.options</code> <a class="xref" href="config-setting-files.html#settings-files" title="Settings Files">settings file</a>.
This file contains a line-delimited list of JVM arguments following a special syntax:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
lines consisting of whitespace only are ignored
</li>
<li class="listitem">
<p>lines beginning with <code class="literal">#</code> are treated as comments and are ignored</p>
<div class="pre_wrapper lang-text">
<pre class="programlisting prettyprint lang-text"># this is a comment</pre>
</div>
</li>
<li class="listitem">
<p>lines beginning with a <code class="literal">-</code> are treated as a JVM option that applies
independent of the version of the JVM</p>
<div class="pre_wrapper lang-text">
<pre class="programlisting prettyprint lang-text">-Xmx2g</pre>
</div>
</li>
<li class="listitem">
<p>lines beginning with a number followed by a <code class="literal">:</code> followed by a <code class="literal">-</code> are treated
as a JVM option that applies only if the version of the JVM matches the number</p>
<div class="pre_wrapper lang-text">
<pre class="programlisting prettyprint lang-text">8:-Xmx2g</pre>
</div>
</li>
<li class="listitem">
<p>lines beginning with a number followed by a <code class="literal">-</code> followed by a <code class="literal">:</code> are treated
as a JVM option that applies only if the version of the JVM is greater than or
equal to the number</p>
<div class="pre_wrapper lang-text">
<pre class="programlisting prettyprint lang-text">8-:-Xmx2g</pre>
</div>
</li>
<li class="listitem">
<p>lines beginning with a number followed by a <code class="literal">-</code> followed by a number followed
by a <code class="literal">:</code> are treated as a JVM option that applies only if the version of the
JVM falls in the inclusive range of the two numbers</p>
<div class="pre_wrapper lang-text">
<pre class="programlisting prettyprint lang-text">8-9:-Xmx2g</pre>
</div>
</li>
<li class="listitem">
all other lines are rejected
</li>
</ul>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="heap-size"></a>Setting the JVM heap size<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/logstash/edit/7.12/docs/static/config-details.asciidoc">edit</a></h3>
</div></div></div>
<p>Here are some tips for adjusting the JVM heap size:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
The recommended heap size for typical ingestion scenarios should be no
less than 4GB and no more than 8GB.
</li>
<li class="listitem">
CPU utilization can increase unnecessarily if the heap size is too low,
resulting in the JVM constantly garbage collecting. You can check for this issue
by doubling the heap size to see if performance improves.
</li>
<li class="listitem">
Do not increase the heap size past the amount of physical memory. Some memory
must be left to run the OS and other processes.  As a general guideline for most
installations, don&#8217;t exceed 50-75% of physical memory. The more memory you have,
the higher percentage you can use.
</li>
<li class="listitem">
Set the minimum (Xms) and maximum (Xmx) heap allocation size to the same
value to prevent the heap from resizing at runtime, which is a very costly
process.
</li>
<li class="listitem">
You can make more accurate measurements of the JVM heap by using either the
<code class="literal">jmap</code> command line utility distributed with Java or by using VisualVM. For more
info, see <a class="xref" href="tuning-logstash.html#profiling-the-heap" title="Profiling the Heap">Profiling the Heap</a>.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="stacks-size"></a>Setting the JVM stack size<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/logstash/edit/7.12/docs/static/config-details.asciidoc">edit</a></h3>
</div></div></div>
<p>Large configurations may require additional JVM stack memory.
If you see a stack overflow error, try increasing the JVM stack size.
Add an entry similar to this one in the <code class="literal">jvm.options</code>
<a class="xref" href="config-setting-files.html#settings-files" title="Settings Files">settings file</a>:</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">-Xss4M</pre>
</div>
<p>Note that the default stack size is different per platform and per OS
flavor. You can find out what the default is by running:</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">java -XX:+PrintFlagsFinal -version | grep ThreadStackSize</pre>
</div>
<p>Depending on the default stack size, start by multiplying by 4x, then 8x, and
then 16x until the overflow error resolves.</p>
</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="tips.html">« Tips and Best Practices</a>
</span>
<span class="next">
<a href="troubleshooting.html">Troubleshooting »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>
                <div class="col-xs-12 col-sm-4 col-md-4" id="right_col">
                  <div id="rtpcontainer" style="display: block;">
                    <div class="mktg-promo">
                      <h3>Most Popular</h3>
                      <ul class="icons">
                        <li class="icon-elasticsearch-white"><a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">Get Started with Elasticsearch: Video</a></li>
                        <li class="icon-kibana-white"><a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">Intro to Kibana: Video</a></li>
                        <li class="icon-logstash-white"><a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">ELK for Logs & Metrics: Video</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";
	var localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}';
</script>
<script src="/static/js/swiftype_app_search.umd.min.js"></script>
<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
