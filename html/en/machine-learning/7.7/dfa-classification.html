<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Classification | Machine Learning in the Elastic Stack [7.7] | Elastic</title>
<link rel="home" href="index.html" title="Machine Learning in the Elastic Stack [7.7]"/>
<link rel="up" href="ml-dfa-concepts.html" title="Concepts"/>
<link rel="prev" href="dfa-regression.html" title="Regression"/>
<link rel="next" href="ml-inference.html" title="Inference"/>
<meta name="DC.type" content="Learn/Docs/Elastic Stack/Machine Learning/7.7"/>
<meta name="DC.subject" content="Machine Learning"/>
<meta name="DC.identifier" content="7.7"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <!--© 2015-2022 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!--BEGIN QUALTRICS WEBSITE FEEDBACK SNIPPET-->
    <script type='text/javascript'>
      (function(){var g=function(e,h,f,g){
      this.get=function(a){for(var a=a+"=",c=document.cookie.split(";"),b=0,e=c.length;b<e;b++){for(var d=c[b];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return null};
      this.set=function(a,c){var b="",b=new Date;b.setTime(b.getTime()+6048E5);b="; expires="+b.toGMTString();document.cookie=a+"="+c+b+"; path=/; "};
      this.check=function(){var a=this.get(f);if(a)a=a.split(":");else if(100!=e)"v"==h&&(e=Math.random()>=e/100?0:100),a=[h,e,0],this.set(f,a.join(":"));else return!0;var c=a[1];if(100==c)return!0;switch(a[0]){case "v":return!1;case "r":return c=a[2]%Math.floor(100/c),a[2]++,this.set(f,a.join(":")),!c}return!0};
      this.go=function(){if(this.check()){var a=document.createElement("script");a.type="text/javascript";a.src=g;document.body&&document.body.appendChild(a)}};
      this.start=function(){var a=this;window.addEventListener?window.addEventListener("load",function(){a.go()},!1):window.attachEvent&&window.attachEvent("onload",function(){a.go()})}};
      try{(new g(100,"r","QSI_S_ZN_emkP0oSe9Qrn7kF","https://znemkp0ose9qrn7kf-elastic.siteintercept.qualtrics.com/WRSiteInterceptEngine/?Q_ZID=ZN_emkP0oSe9Qrn7kF")).start()}catch(i){}})();
    </script><div id='ZN_emkP0oSe9Qrn7kF'><!--DO NOT REMOVE-CONTENTS PLACED HERE--></div>
    <!--END WEBSITE FEEDBACK SNIPPET-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  <div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="index.html">Machine Learning in the Elastic Stack [7.7]</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="ml-dfanalytics.html">Data frame analytics</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="ml-dfa-concepts.html">Concepts</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="dfa-regression.html">« Regression</a>
</span>
<span class="next">
<a href="ml-inference.html">Inference »</a>
</span>
</div>
<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="dfa-classification"></a>Classification<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/stack-docs/edit/7.7/docs/en/stack/ml/df-analytics/dfa-classification.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in technical preview and may be changed or removed in a future release. Elastic will apply best effort to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.</p>
</div>
</div>
<p>Classification is a machine learning process that enables you to predict the class or
category of a data point in your data set. Typical examples of classification
problems are predicting loan risk, classifying music, or detecting the potential
for cancer in a DNA sequence. In the first case, for example, the data set might
contain the investment history, employment status, debit status, and other
financial details for loan applicants. Based on this data, you could use
classification analysis to create a model that predicts whether it is safe or risky to
lend money to applicants. In the second case, the data contains song details
that enable you to classify music into genres like hip-hop, country, or
classical, for example. Classification is for predicting discrete,
categorical values, whereas <a class="xref" href="dfa-regression.html" title="Regression">regression analysis</a> predicts
continuous, numerical values.</p>
<p>When you create a classification job, you must specify which field contains
the classes that you want to predict. This field is known as the <em>dependent variable</em>. It
must contain no more than 30 classes. By default, all other
<a href="/guide/en/elasticsearch/reference/7.7/put-dfanalytics.html#dfa-supported-fields" class="ulink" target="_top">supported fields</a> are included
in the analysis and are known as <em>feature variables</em>. The runtime and resources
used by the job increase with the number of feature variables. Therefore, you
can optionally include or exclude fields from the analysis. For more information
about field selection, see the
<a href="/guide/en/elasticsearch/reference/7.7/explain-dfanalytics.html" class="ulink" target="_top">explain data frame analytics API</a>.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="dfa-classification-supervised"></a>Training the classification model<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/stack-docs/edit/7.7/docs/en/stack/ml/df-analytics/dfa-classification.asciidoc">edit</a></h3>
</div></div></div>
<p>Classification – just like regression – is a supervised machine learning process.
When you create the data frame analytics job, you must provide a data set that contains
the <em>ground truth</em>. That is to say, your data set must contain the dependent variable
and the feature variables fields that are related to it. You can divide the data
set into training and testing data by specifying a <code class="literal">training_percent</code>. By
default when you use the
<a href="/guide/en/elasticsearch/reference/7.7/put-dfanalytics.html" class="ulink" target="_top">create data frame analytics jobs API</a>, 100% of the
<a class="xref" href="ml-dfa-limitations.html#dfa-classification-field-type-docs-limitations" title="Classification field types">eligible documents</a> in the
data set are used for training. If you divide your data set, the job stratifies
the data to ensure that both the training and testing data sets contains classes
in proportions that are representative of the class proportions in the full data
set.</p>
<p>When you are collecting a data set to train your model, ensure that it
captures information for all of the classes. If some classes are poorly
represented in the training data set (that is, you have very few data points per
class), the model might be unaware of them. In general, complex decision
boundaries between classes are harder to learn and require more data points per
class in the training data.</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="dfa-classification-algorithm"></a>Classification algorithms<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/stack-docs/edit/7.7/docs/en/stack/ml/df-analytics/dfa-classification.asciidoc">edit</a></h4>
</div></div></div>
<p>Classification analysis uses an ensemble algorithm that is a type of boosting called
boosted tree regression model which combines multiple weak models into a
composite one. It uses decision trees to learn to predict the probability that a
data point belongs to a certain class. A sequence of decision trees are trained
and every decision tree learns from the mistakes of the previous one. Every tree
is an iteration of the last one, hence it improves the decision made by the
previous tree.</p>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="dfa-classification-performance"></a>Classification performance<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/stack-docs/edit/7.7/docs/en/stack/ml/df-analytics/dfa-classification.asciidoc">edit</a></h3>
</div></div></div>
<p>As a rule of thumb, a classification analysis with many classes takes more time to run
than a binary classification process when there are only two classes. The
relationship between the number of classes and the runtime is roughly linear.</p>
<p>The runtime also scales approximately linearly with the number of involved
documents below 200,000 data points. Therefore, if you double the number of
documents, then the runtime of the analysis doubles respectively.</p>
<p>To improve the performance of your classification analysis, consider using a smaller
<code class="literal">training_percent</code> value when you create the job. That is to say, use a smaller
percentage of your documents to train the model more quickly. It is a good
strategy to make progress iteratively: use a smaller training percentage first,
run the analysis, and evaluate the performance. Then, based on the results,
decide if it is necessary to increase the <code class="literal">training_percent</code> value. If possible,
prepare your input data such that it has less classes. You can also remove the
fields that are not relevant from the analysis by specifying <code class="literal">excludes</code> patterns
in the <code class="literal">analyzed_fields</code> object when configuring the data frame analytics job.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="dfa-classification-interpret"></a>Interpreting classification results<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/stack-docs/edit/7.7/docs/en/stack/ml/df-analytics/dfa-classification.asciidoc">edit</a></h3>
</div></div></div>
<p>The following sections help you understand and interpret the results of a
classification analysis.</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="dfa-classification-class-probability"></a><code class="literal">class_probability</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/stack-docs/edit/7.7/docs/en/stack/ml/df-analytics/dfa-classification.asciidoc">edit</a></h4>
</div></div></div>
<p>The value of <code class="literal">class_probability</code> shows how likely it is that a given data point
belongs to a certain class. It is a value between 0 and 1. The higher the
number, the higher the probability that the data point belongs to the named
class. This information is stored in the <code class="literal">top_classes</code> array for each document
in your destination index. See the
<a href="/guide/en/machine-learning/7.7/flightdata-classification.html#flightdata-classification-results" class="ulink" target="_top">Viewing classification results</a>
section in the classification example.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="dfa-classification-class-score"></a><code class="literal">class_score</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/stack-docs/edit/7.7/docs/en/stack/ml/df-analytics/dfa-classification.asciidoc">edit</a></h4>
</div></div></div>
<p>The value of <code class="literal">class_score</code> controls the probability at which a class label is
assigned to a data point. In normal case – that you maximize the number of
correct labels – a class label is assigned when its predicted probability is
greater than 0.5. The <code class="literal">class_score</code> makes it possible to change this behavior,
so it can be less than or greater than 0.5. For example, suppose our two classes
are denoted <code class="literal">class 0</code> and <code class="literal">class 1</code>, then the value of <code class="literal">class_score</code> is always
non-negative and its definition is:</p>
<p>\$\text{class_score(class 0)} = 0.5 / (1.0 - k) * probability(class 0)\$</p>
<p>\$\text{class_score(class 1)}= 0.5 / k * probability(class 1)\$</p>
<p>Here, <code class="literal">k</code> is a positive constant less than one. It represents the predicted
probability of <code class="literal">class 1</code> for a data point at which to label it <code class="literal">class 1</code> and is
chosen to maximize the minimum recall of any class. This is useful for example
in case of highly imbalanced data. If <code class="literal">class 0</code> is much more frequent in the
training data than <code class="literal">class 1</code>, then it can mean that you achieve the best
accuracy by assigning <code class="literal">class 0</code> to every data point. This is equivalent to zero
recall for <code class="literal">class 1</code>. Instead of this behavior, the default scheme of the
Elastic Stack classification analysis is to choose <code class="literal">k &lt; 0.5</code> and accept a higher rate of
actual <code class="literal">class 0</code> predicted <code class="literal">class 1</code> errors, or in other words, a slight
degradation of the overall accuracy.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="dfa-classification-feature-importance"></a>Feature importance<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/stack-docs/edit/7.7/docs/en/stack/ml/df-analytics/dfa-classification.asciidoc">edit</a></h4>
</div></div></div>
<p>Feature importance provides further information about the results of an analysis and
helps to interpret the results in a more subtle way. If you want to learn more
about feature importance, <a class="xref" href="ml-feature-importance.html" title="Feature importance">click here</a>.</p>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="dfa-classification-evaluation"></a>Measuring model performance<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/stack-docs/edit/7.7/docs/en/stack/ml/df-analytics/dfa-classification.asciidoc">edit</a></h3>
</div></div></div>
<p>You can measure how well the model has performed on your data set by using the
<code class="literal">classification</code> evaluation type of the
<a href="/guide/en/elasticsearch/reference/7.7/evaluate-dfanalytics.html" class="ulink" target="_top">evaluate data frame analytics API</a>. The metric that the
evaluation provides you is a confusion matrix. The more classes you have, the
more complex the confusion matrix is. The matrix tells you how many data points
that belong to a given class were classified correctly and incorrectly.</p>
<p>If you split your data set into training and testing data, you can determine how
well your model performs on data it has never seen before and compare the
prediction to the actual value.</p>
<p>For more information, see <a class="xref" href="ml-dfanalytics-evaluate.html" title="Evaluating data frame analytics">Evaluating data frame analytics</a>.</p>
</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="dfa-regression.html">« Regression</a>
</span>
<span class="next">
<a href="ml-inference.html">Inference »</a>
</span>
</div>
</div>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { equationNumbers: { autoNumber: "none" } }
})
MathJax.Hub.Register.StartupHook("AsciiMath Jax Ready", function () {
  MathJax.InputJax.AsciiMath.postfilterHooks.Add(function (data, node) {
    if ((node = data.script.parentNode) && (node = node.parentNode) && node.classList.contains('stemblock')) {
      data.math.root.display = "block"
    }
    return data
  })
})
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
