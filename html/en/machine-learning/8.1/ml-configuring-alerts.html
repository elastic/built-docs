<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<meta name="description" content="This tutorial shows you how to create anomaly detection jobs, interpret the results, and forecast future behavior in Kibana.">
<meta name="keywords" content="ML, Elastic Stack, anomaly detection, tutorial">
<title>Generating alerts for anomaly detection jobs | Machine Learning in the Elastic Stack [8.1] | Elastic</title>
<link rel="home" href="index.html" title="Machine Learning in the Elastic Stack [8.1]"/>
<link rel="up" href="anomaly-examples.html" title="Anomaly detection examples"/>
<link rel="prev" href="ml-getting-started.html" title="Getting started with anomaly detection"/>
<link rel="next" href="ml-configuring-aggregation.html" title="Aggregating data for faster performance"/>
<meta name="DC.type" content="Learn/Docs/Elastic Stack/Machine Learning/8.1"/>
<meta name="DC.subject" content="Machine Learning"/>
<meta name="DC.identifier" content="8.1"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <!--© 2015-2022 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!--BEGIN QUALTRICS WEBSITE FEEDBACK SNIPPET-->
    <script type='text/javascript'>
      (function(){var g=function(e,h,f,g){
      this.get=function(a){for(var a=a+"=",c=document.cookie.split(";"),b=0,e=c.length;b<e;b++){for(var d=c[b];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return null};
      this.set=function(a,c){var b="",b=new Date;b.setTime(b.getTime()+6048E5);b="; expires="+b.toGMTString();document.cookie=a+"="+c+b+"; path=/; "};
      this.check=function(){var a=this.get(f);if(a)a=a.split(":");else if(100!=e)"v"==h&&(e=Math.random()>=e/100?0:100),a=[h,e,0],this.set(f,a.join(":"));else return!0;var c=a[1];if(100==c)return!0;switch(a[0]){case "v":return!1;case "r":return c=a[2]%Math.floor(100/c),a[2]++,this.set(f,a.join(":")),!c}return!0};
      this.go=function(){if(this.check()){var a=document.createElement("script");a.type="text/javascript";a.src=g;document.body&&document.body.appendChild(a)}};
      this.start=function(){var a=this;window.addEventListener?window.addEventListener("load",function(){a.go()},!1):window.attachEvent&&window.attachEvent("onload",function(){a.go()})}};
      try{(new g(100,"r","QSI_S_ZN_emkP0oSe9Qrn7kF","https://znemkp0ose9qrn7kf-elastic.siteintercept.qualtrics.com/WRSiteInterceptEngine/?Q_ZID=ZN_emkP0oSe9Qrn7kF")).start()}catch(i){}})();
    </script><div id='ZN_emkP0oSe9Qrn7kF'><!--DO NOT REMOVE-CONTENTS PLACED HERE--></div>
    <!--END WEBSITE FEEDBACK SNIPPET-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  <div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="index.html">Machine Learning in the Elastic Stack [8.1]</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="ml-ad-overview.html">Anomaly detection</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="anomaly-examples.html">Anomaly detection examples</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="ml-getting-started.html">« Getting started with anomaly detection</a>
</span>
<span class="next">
<a href="ml-configuring-aggregation.html">Aggregating data for faster performance »</a>
</span>
</div>
<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="ml-configuring-alerts"></a>Generating alerts for anomaly detection jobs<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.1/docs/reference/ml/anomaly-detection/ml-configuring-alerts.asciidoc">edit</a></h2>
</div></div></div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in beta and is subject to change. The design and code is less mature than official GA features and is being provided as-is with no warranties. Beta features are not subject to the support SLA of official GA features.</p>
</div>
</div>
<p>Kibana alerting features include support for machine learning rules, which run scheduled
checks for anomalies in one or more anomaly detection jobs or check the
health of the job with certain conditions. If the conditions of the rule are met, an
alert is created and the associated action is triggered. For example, you can
create a rule to check an anomaly detection job every fifteen minutes for critical
anomalies and to notify you in an email. To learn more about Kibana
alerting features, refer to
<a href="/guide/en/kibana/8.1/alerting-getting-started.html#alerting-getting-started" class="ulink" target="_top">Alerting</a>.</p>
<p>The following machine learning rules are available:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Anomaly detection alert
</span>
</dt>
<dd>
Checks if the anomaly detection job results contain anomalies that match the rule
conditions.
</dd>
<dt>
<span class="term">
Anomaly detection jobs health
</span>
</dt>
<dd>
Monitors job health and alerts if an operational issue occurred that may
prevent the job from detecting anomalies.
</dd>
</dl>
</div>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>If you have created rules for specific anomaly detection jobs and you want to
monitor whether these jobs work as expected, anomaly detection jobs health rules are
ideal for this purpose.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="creating-ml-rules"></a>Creating a rule<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.1/docs/reference/ml/anomaly-detection/ml-configuring-alerts.asciidoc">edit</a></h3>
</div></div></div>
<p>You can create machine learning rules in the anomaly detection job wizard after you start the job,
from the job list, or under <span class="strong strong"><strong>Stack Management &gt; Alerts and Actions</strong></span>.</p>
<p>On the <span class="strong strong"><strong>Create rule</strong></span> window, give a name to the rule and optionally provide
tags. Specify the time interval for the rule to check detected anomalies or job
health changes. It is recommended to select an interval that is close to the
bucket span of the job. You can also select a notification option with the
<em>Notify</em> selector. An alert remains active as long as the configured conditions
are met during the check interval. When there is no matching condition in the
next interval, the <code class="literal">Recovered</code> action group is invoked and the status of the
alert changes to <code class="literal">OK</code>. For more details, refer to the documentation of
<a href="/guide/en/kibana/8.1/create-and-manage-rules.html#defining-rules-general-details" class="ulink" target="_top">general rule details</a>.</p>
<p>Select the rule type you want to create under the machine learning section and continue to
configure it depending on whether it is an
<a class="xref" href="ml-configuring-alerts.html#creating-anomaly-alert-rules" title="Anomaly detection alert">anomaly detection alert</a> or an
<a class="xref" href="ml-configuring-alerts.html#creating-anomaly-jobs-health-rules" title="Anomaly detection jobs health">anomaly detection job health</a> rule.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/ml-rule.jpg" alt="Creating a new machine learning rule">
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="creating-anomaly-alert-rules"></a>Anomaly detection alert<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.1/docs/reference/ml/anomaly-detection/ml-configuring-alerts.asciidoc">edit</a></h4>
</div></div></div>
<p>Select the job that the rule applies to.</p>
<p>You must select a type of machine learning result. In particular, you can create rules based
on bucket, record, or influencer results.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/ml-anomaly-alert-severity.jpg" alt="Selecting result type, severity, and test interval">
</div>
</div>
<p>For each rule, you can configure the <code class="literal">anomaly_score</code> that triggers the action.
The <code class="literal">anomaly_score</code> indicates the significance of a given anomaly compared to
previous anomalies. The default severity threshold is 75 which means every
anomaly with an <code class="literal">anomaly_score</code> of 75 or higher triggers the associated action.</p>
<p>You can select whether you want to include interim results. Interim results are
created by the anomaly detection job before a bucket is finalized. These results might
disappear after the bucket is fully processed. Include interim results if you
want to be notified earlier about a potential anomaly even if it might be a
false positive. If you want to get notified only about anomalies of fully
processed buckets, do not include interim results.</p>
<p>You can also configure advanced settings. <em>Lookback interval</em> sets an interval
that is used to query previous anomalies during each condition check. Its value
is derived from the bucket span of the job and the query delay of the datafeed by
default. It is not recommended to set the lookback interval lower than the
default value as it might result in missed anomalies. <em>Number of latest buckets</em>
sets how many buckets to check to obtain the highest anomaly from all the
anomalies that are found during the <em>Lookback interval</em>. An alert is created
based on the anomaly with the highest anomaly score from the most anomalous
bucket.</p>
<p>You can also test the configured conditions against your existing data and check
the sample results by providing a valid interval for your data. The generated
preview contains the number of potentially created alerts during the relative
time range you defined.</p>
<p>As the last step in the rule creation process,
<a class="xref" href="ml-configuring-alerts.html#defining-actions" title="Defining actions">define the actions</a> that occur when the conditions
are met.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="creating-anomaly-jobs-health-rules"></a>Anomaly detection jobs health<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.1/docs/reference/ml/anomaly-detection/ml-configuring-alerts.asciidoc">edit</a></h4>
</div></div></div>
<p>Select the job or group that
the rule applies to. If you assign more jobs to the group, they are
included the next time the rule conditions are checked.</p>
<p>You can also use a special character (<code class="literal">*</code>) to apply the rule to all your jobs.
Jobs created after the rule are automatically included. You can exclude jobs
that are not critically important by using the <em>Exclude</em> field.</p>
<p>Enable the health check types that you want to apply. All checks are enabled by
default. At least one check needs to be enabled to create the rule. The
following health checks are available:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<em>Datafeed is not started</em>
</span>
</dt>
<dd>
Notifies if the corresponding datafeed of the job is not started but the job is
in an opened state. The notification message recommends the necessary
actions to solve the error.
</dd>
<dt>
<span class="term">
<em>Model memory limit reached</em>
</span>
</dt>
<dd>
Notifies if the model memory status of the job reaches the soft or hard model
memory limit. Optimize your job by following
<a class="xref" href="anomaly-detection-scale.html#detector-configuration" title="4. Understand how detector configuration can impact model memory">these guidelines</a> or consider
<a class="xref" href="anomaly-detection-scale.html#set-model-memory-limit" title="7. Set the model memory limit">amending the model memory limit</a>.
</dd>
<dt>
<span class="term">
<em>Data delay has occurred</em>
</span>
</dt>
<dd>
Notifies when the job missed some data. You can define the threshold for the
amount of missing documents you get alerted on by setting
<em>Number of documents</em>. You can control the lookback interval for checking
delayed data with <em>Time interval</em>. Refer to the
<a class="xref" href="ml-delayed-data-detection.html" title="Handling delayed data">Handling delayed data</a> page to see what to do about delayed data.
</dd>
<dt>
<span class="term">
<em>Errors in job messages</em>
</span>
</dt>
<dd>
Notifies when the job messages contain error messages. Review the
notification; it contains the error messages, the corresponding job IDs and
recommendations on how to fix the issue. This check looks for job errors
that occur after the rule is created; it does not look at historic behavior.
</dd>
</dl>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="images/ml-health-check-config.jpg" alt="Selecting health checkers">
</div>
</div>
<p>As the last step in the rule creation process,
<a class="xref" href="ml-configuring-alerts.html#defining-actions" title="Defining actions">define the actions</a> that occur when the conditions
are met.</p>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="defining-actions"></a>Defining actions<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.1/docs/reference/ml/anomaly-detection/ml-configuring-alerts.asciidoc">edit</a></h3>
</div></div></div>
<p>Connect your rule to actions that use supported built-in integrations by
selecting a connector type. Connectors are Kibana services or third-party
integrations that perform an action when the rule conditions are met.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/ml-anomaly-alert-actions.jpg" alt="Selecting connector type">
</div>
</div>
<p>For example, you can choose <em>Slack</em> as a connector type and configure it to send
a message to a channel you selected. You can also create an index connector that
writes the JSON object you configure to a specific index. It&#8217;s also possible to
customize the notification messages. A list of variables is available to include
in the message, like job ID, anomaly score, time, top influencers, datafeed ID,
memory status and so on based on the selected rule type. Refer to
<a class="xref" href="ml-configuring-alerts.html#action-variables" title="Action variables">Action variables</a> to see the full list of available variables by rule type.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/ml-anomaly-alert-messages.jpg" alt="Customizing your message">
</div>
</div>
<p>After you save the configurations, the rule appears in the <span class="strong strong"><strong>Alerts and Actions</strong></span> list
where you can check its status and see the overview of its configuration
information.</p>
<p>The name of an alert is always the same as the job ID of the associated
anomaly detection job that triggered it. You can mute the notifications for a particular
anomaly detection job on the page of the rule that lists the individual alerts. You can
open it via <span class="strong strong"><strong>Alerts and Actions</strong></span> by selecting the rule name.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="action-variables"></a>Action variables<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.1/docs/reference/ml/anomaly-detection/ml-configuring-alerts.asciidoc">edit</a></h3>
</div></div></div>
<p>You can add different variables to your action. The following variables are
specific to the machine learning rule types.</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="anomaly-alert-action-variables"></a>Anomaly detection alert action variables<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.1/docs/reference/ml/anomaly-detection/ml-configuring-alerts.asciidoc">edit</a></h4>
</div></div></div>
<p>Every anomaly detection alert has the following action variables:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">context</code>.<code class="literal">anomalyExplorerUrl</code>
</span>
</dt>
<dd>
URL to open in the Anomaly Explorer.
</dd>
<dt>
<span class="term">
<code class="literal">context</code>.<code class="literal">isInterim</code>
</span>
</dt>
<dd>
Indicates if top hits contain interim results.
</dd>
<dt>
<span class="term">
<code class="literal">context</code>.<code class="literal">jobIds</code>
</span>
</dt>
<dd>
List of job IDs that triggered the alert.
</dd>
<dt>
<span class="term">
<code class="literal">context</code>.<code class="literal">message</code>
</span>
</dt>
<dd>
A preconstructed message for the alert.
</dd>
<dt>
<span class="term">
<code class="literal">context</code>.<code class="literal">score</code>
</span>
</dt>
<dd>
Anomaly score at the time of the notification action.
</dd>
<dt>
<span class="term">
<code class="literal">context</code>.<code class="literal">timestamp</code>
</span>
</dt>
<dd>
The bucket timestamp of the anomaly.
</dd>
<dt>
<span class="term">
<code class="literal">context</code>.<code class="literal">timestampIso8601</code>
</span>
</dt>
<dd>
The bucket timestamp of the anomaly in ISO8601 format.
</dd>
<dt>
<span class="term">
<code class="literal">context</code>.<code class="literal">topInfluencers</code>
</span>
</dt>
<dd>
<p>
The list of top influencers.
</p>
<details open>
<summary class="title">Properties of <code class="literal">context.topInfluencers</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">influencer_field_name</code>
</span>
</dt>
<dd>
The field name of the influencer.
</dd>
<dt>
<span class="term">
<code class="literal">influencer_field_value</code>
</span>
</dt>
<dd>
The entity that influenced, contributed to, or was to blame for the anomaly.
</dd>
<dt>
<span class="term">
<code class="literal">score</code>
</span>
</dt>
<dd>
The influencer score. A normalized score between 0-100 which shows the
influencer&#8217;s overall contribution to the anomalies.
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">context</code>.<code class="literal">topRecords</code>
</span>
</dt>
<dd>
<p>
The list of top records.
</p>
<details open>
<summary class="title">Properties of <code class="literal">context.topRecords</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">actual</code>
</span>
</dt>
<dd>
The actual value for the bucket.
</dd>
<dt>
<span class="term">
<code class="literal">by_field_value</code>
</span>
</dt>
<dd>
The value of the by field.
</dd>
<dt>
<span class="term">
<code class="literal">field_name</code>
</span>
</dt>
<dd>
Certain functions require a field to operate on, for example, <code class="literal">sum()</code>. For those
functions, this value is the name of the field to be analyzed.
</dd>
<dt>
<span class="term">
<code class="literal">function</code>
</span>
</dt>
<dd>
The function in which the anomaly occurs, as specified in the detector
configuration. For example, <code class="literal">max</code>.
</dd>
<dt>
<span class="term">
<code class="literal">over_field_name</code>
</span>
</dt>
<dd>
The field used to split the data.
</dd>
<dt>
<span class="term">
<code class="literal">partition_field_value</code>
</span>
</dt>
<dd>
The field used to segment the analysis.
</dd>
<dt>
<span class="term">
<code class="literal">score</code>
</span>
</dt>
<dd>
A normalized score between 0-100, which is based on the probability of the
anomalousness of this record.
</dd>
<dt>
<span class="term">
<code class="literal">typical</code>
</span>
</dt>
<dd>
The typical value for the bucket, according to analytical modeling.
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="anomaly-jobs-health-action-variables"></a>Anomaly detection jobs health action variables<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.1/docs/reference/ml/anomaly-detection/ml-configuring-alerts.asciidoc">edit</a></h4>
</div></div></div>
<p>Every health check has two main variables: <code class="literal">context.message</code> and
<code class="literal">context.results</code>. The properties of <code class="literal">context.results</code> may vary based on the
type of check. You can find the possible properties for all the checks below.</p>
<div class="section">
<div class="titlepage"><div><div>
<h5 class="title"><a id="_datafeed_is_not_started"></a><em>Datafeed is not started</em><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.1/docs/reference/ml/anomaly-detection/ml-configuring-alerts.asciidoc">edit</a></h5>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">context.message</code>
</span>
</dt>
<dd>
A preconstructed message for the alert.
</dd>
<dt>
<span class="term">
<code class="literal">context.results</code>
</span>
</dt>
<dd>
<p>
Contains the following properties:
</p>
<details open>
<summary class="title">Properties of <code class="literal">context.results</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">datafeed_id</code>
</span>
</dt>
<dd>
The datafeed identifier.
</dd>
<dt>
<span class="term">
<code class="literal">datafeed_state</code>
</span>
</dt>
<dd>
The state of the datafeed. It can be <code class="literal">starting</code>, <code class="literal">started</code>,
<code class="literal">stopping</code>, <code class="literal">stopped</code>.
</dd>
<dt>
<span class="term">
<code class="literal">job_id</code>
</span>
</dt>
<dd>
The job identifier.
</dd>
<dt>
<span class="term">
<code class="literal">job_state</code>
</span>
</dt>
<dd>
The state of the job. It can be <code class="literal">opening</code>, <code class="literal">opened</code>, <code class="literal">closing</code>,
<code class="literal">closed</code>, or <code class="literal">failed</code>.
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h5 class="title"><a id="_model_memory_limit_reached"></a><em>Model memory limit reached</em><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.1/docs/reference/ml/anomaly-detection/ml-configuring-alerts.asciidoc">edit</a></h5>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">context.message</code>
</span>
</dt>
<dd>
A preconstructed message for the rule.
</dd>
<dt>
<span class="term">
<code class="literal">context.results</code>
</span>
</dt>
<dd>
<p>
Contains the following properties:
</p>
<details open>
<summary class="title">Properties of <code class="literal">context.results</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">job_id</code>
</span>
</dt>
<dd>
The job identifier.
</dd>
<dt>
<span class="term">
<code class="literal">memory_status</code>
</span>
</dt>
<dd>
<p>
The status of the mathematical model. It can have one of the following values:
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">soft_limit</code>: The model used more than 60% of the configured memory limit and
older unused models will be pruned to free up space. In categorization jobs no
further category examples will be stored.
</li>
<li class="listitem">
<code class="literal">hard_limit</code>: The model used more space than the configured memory limit. As a
result, not all incoming data was processed.
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">model_bytes</code>
</span>
</dt>
<dd>
The number of bytes of memory used by the models.
</dd>
<dt>
<span class="term">
<code class="literal">model_bytes_exceeded</code>
</span>
</dt>
<dd>
The number of bytes over the high limit for memory usage at the last allocation
failure.
</dd>
<dt>
<span class="term">
<code class="literal">model_bytes_memory_limit</code>
</span>
</dt>
<dd>
The upper limit for model memory usage.
</dd>
<dt>
<span class="term">
<code class="literal">log_time</code>
</span>
</dt>
<dd>
The timestamp of the model size statistics according to server time. Time
formatting is based on the Kibana settings.
</dd>
<dt>
<span class="term">
<code class="literal">peak_model_bytes</code>
</span>
</dt>
<dd>
The peak number of bytes of memory ever used by the model.
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h5 class="title"><a id="_data_delay_has_occurred"></a><em>Data delay has occurred</em><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.1/docs/reference/ml/anomaly-detection/ml-configuring-alerts.asciidoc">edit</a></h5>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">context.message</code>
</span>
</dt>
<dd>
A preconstructed message for the rule.
</dd>
<dt>
<span class="term">
<code class="literal">context.results</code>
</span>
</dt>
<dd>
<p>
Contains the following properties:
</p>
<details open>
<summary class="title">Properties of <code class="literal">context.results</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">annotation</code>
</span>
</dt>
<dd>
The annotation corresponding to the data delay in the job.
</dd>
<dt>
<span class="term">
<code class="literal">end_timestamp</code>
</span>
</dt>
<dd>
Timestamp of the latest finalized buckets with missing documents. Time
formatting is based on the Kibana settings.
</dd>
<dt>
<span class="term">
<code class="literal">job_id</code>
</span>
</dt>
<dd>
The job identifier.
</dd>
<dt>
<span class="term">
<code class="literal">missed_docs_count</code>
</span>
</dt>
<dd>
The number of missed documents.
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h5 class="title"><a id="_error_in_job_messages"></a><em>Error in job messages</em><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.1/docs/reference/ml/anomaly-detection/ml-configuring-alerts.asciidoc">edit</a></h5>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">context.message</code>
</span>
</dt>
<dd>
A preconstructed message for the rule.
</dd>
<dt>
<span class="term">
<code class="literal">context.results</code>
</span>
</dt>
<dd>
<p>
Contains the following properties:
</p>
<details open>
<summary class="title">Properties of <code class="literal">context.results</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">timestamp</code>
</span>
</dt>
<dd>
Timestamp of the latest finalized buckets with missing documents.
</dd>
<dt>
<span class="term">
<code class="literal">job_id</code>
</span>
</dt>
<dd>
The job identifier.
</dd>
<dt>
<span class="term">
<code class="literal">message</code>
</span>
</dt>
<dd>
The error message.
</dd>
<dt>
<span class="term">
<code class="literal">node_name</code>
</span>
</dt>
<dd>
The name of the node that runs the job.
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>

</div>

</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="ml-getting-started.html">« Getting started with anomaly detection</a>
</span>
<span class="next">
<a href="ml-configuring-aggregation.html">Aggregating data for faster performance »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
