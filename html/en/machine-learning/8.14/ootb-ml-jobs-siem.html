<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<meta name="keywords" content="ML, Elastic Stack, anomaly detection, data frame analytics">
<title>Appendix H: Security anomaly detection configurations | Machine Learning in the Elastic Stack [8.14] | Elastic</title>
<meta class="elastic" name="content" content="Appendix H: Security anomaly detection configurations | Machine Learning in the Elastic Stack [8.14]">

<link rel="home" href="index.html" title="Machine Learning in the Elastic Stack [8.14]"/>
<link rel="up" href="index.html" title="Machine Learning in the Elastic Stack [8.14]"/>
<link rel="prev" href="ootb-ml-jobs-nginx.html" title="Appendix G: Nginx anomaly detection configurations"/>
<link rel="next" href="ootb-ml-jobs-uptime.html" title="Appendix I: Uptime anomaly detection configurations"/>
<meta class="elastic" name="product_version" content="8.14"/>
<meta class="elastic" name="product_name" content="Machine Learning"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Elastic Stack/Machine Learning/8.14"/>
<meta name="DC.subject" content="Machine Learning"/>
<meta name="DC.identifier" content="8.14"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles-v1.css" />
  </head>

  <!--© 2015-2025 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div class="navheader">
<span class="prev">
<a href="ootb-ml-jobs-nginx.html">« Appendix G: Nginx anomaly detection configurations</a>
</span>
<span class="next">
<a href="ootb-ml-jobs-uptime.html">Appendix I: Uptime anomaly detection configurations »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Machine Learning in the Elastic Stack [8.14]</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Appendix H: Security anomaly detection configurations</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/stack-docs/edit/8.14/docs/en/stack/ml/anomaly-detection/ootb-ml-jobs-siem.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="appendix exclude">
<div class="titlepage"><div><div>
<h2 class="title"><a id="ootb-ml-jobs-siem"></a>Appendix H: Security anomaly detection configurations<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/stack-docs/edit/8.14/docs/en/stack/ml/anomaly-detection/ootb-ml-jobs-siem.asciidoc">edit</a></h2>
</div></div></div>
<p>These anomaly detection jobs automatically detect file system and network anomalies on
your hosts. They appear in the <span class="strong strong"><strong>Anomaly Detection</strong></span> interface of the
Elastic Security app in Kibana when you have data that matches their configuration.
For more information, refer to
<a href="/guide/en/security/8.14/machine-learning.html" class="ulink" target="_top">Anomaly detection with machine learning</a>.</p>
<h2><a id="security-authentication"></a>Security: Authentication<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/stack-docs/edit/8.14/docs/en/stack/ml/anomaly-detection/ootb-ml-jobs-siem.asciidoc">edit</a></h2>
<p>Detect anomalous activity in your ECS-compatible authentication logs.</p>
<p>In the Machine Learning app, these configurations are available only when data exists
that matches the query specified in the
<a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_auth/manifest.json" class="ulink" target="_top">manifest file</a>.
In the Elastic Security app, it looks in the data view specified in the
<a href="/guide/en/kibana/8.14/advanced-options.html#securitysolution-defaultindex" class="ulink" target="_top"><code class="literal">securitySolution:defaultIndex</code> advanced setting</a>
for data that matches the query.</p>
<p>By default, when you create these job in the Elastic Security app, it uses a
data view that applies to multiple indices. To get the same results if you
use the Machine Learning app, create a similar
<a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_auth/manifest.json#L7" class="ulink" target="_top">data view</a>
then select it in the job wizard.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Job</th>
<th align="left" valign="top">Datafeed</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>auth_high_count_logon_events</p></td>
<td align="left" valign="top"><p>Looks for an unusually large spike in successful authentication events. This can be due to password spraying, user enumeration, or brute force activity.</p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_auth/ml/auth_high_count_logon_events.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_auth/ml/datafeed_auth_high_count_logon_events.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>auth_high_count_logon_events_for_a_source_ip</p></td>
<td align="left" valign="top"><p>Looks for an unusually large spike in successful authentication events from a particular source IP address. This can be due to password spraying, user enumeration or brute force activity.</p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_auth/ml/auth_high_count_logon_events_for_a_source_ip.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_auth/ml/datafeed_auth_high_count_logon_events_for_a_source_ip.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>auth_high_count_logon_fails</p></td>
<td align="left" valign="top"><p>Looks for an unusually large spike in authentication failure events. This can be due to password spraying, user enumeration, or brute force activity and may be a precursor to account takeover or credentialed access.</p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_auth/ml/auth_high_count_logon_fails.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_auth/ml/datafeed_auth_high_count_logon_fails.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>auth_rare_hour_for_a_user</p></td>
<td align="left" valign="top"><p>Looks for a user logging in at a time of day that is unusual for the user. This can be due to credentialed access via a compromised account when the user and the threat actor are in different time zones. In addition, unauthorized user activity often takes place during non-business hours.</p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_auth/ml/auth_rare_hour_for_a_user.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_auth/ml/datafeed_auth_rare_hour_for_a_user.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>auth_rare_source_ip_for_a_user</p></td>
<td align="left" valign="top"><p>Looks for a user logging in from an IP address that is unusual for the user. This can be due to credentialed access via a compromised account when the user and the threat actor are in different locations. An unusual source IP address for a username could also be due to lateral movement when a compromised account is used to pivot between hosts.</p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_auth/ml/auth_rare_source_ip_for_a_user.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_auth/ml/datafeed_auth_rare_source_ip_for_a_user.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>auth_rare_user</p></td>
<td align="left" valign="top"><p>Looks for an unusual user name in the authentication logs. An unusual user name is one way of detecting credentialed access by means of a new or dormant user account. A user account that is normally inactive, because the user has left the organization, which becomes active, may be due to credentialed access using a compromised account password. Threat actors will sometimes also create new users as a means of persisting in a compromised web application.</p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_auth/ml/auth_rare_user.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_auth/ml/datafeed_auth_rare_user.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>suspicious_login_activity</p></td>
<td align="left" valign="top"><p>Detect unusually high number of authentication attempts.</p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_auth/ml/datafeed_suspicious_login_activity.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_auth/ml/suspicious_login_activity.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
</tr>
</tbody>
</table>
</div>
<h2><a id="security-cloudtrail-jobs"></a>Security: CloudTrail<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/stack-docs/edit/8.14/docs/en/stack/ml/anomaly-detection/ootb-ml-jobs-siem.asciidoc">edit</a></h2>
<p>Detect suspicious activity recorded in your CloudTrail logs.</p>
<p>In the Machine Learning app, these configurations are available only when data exists
that matches the query specified in the
<a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_cloudtrail/manifest.json" class="ulink" target="_top">manifest file</a>.
In the Elastic Security app, it looks in the data view specified in the
<a href="/guide/en/kibana/8.14/advanced-options.html#securitysolution-defaultindex" class="ulink" target="_top"><code class="literal">securitySolution:defaultIndex</code> advanced setting</a>
for data that matches the query.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Job</th>
<th align="left" valign="top">Datafeed</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>high_distinct_count_error_message</p></td>
<td align="left" valign="top"><p>Looks for a spike in the rate of an error message which may simply indicate an impending service failure but these can also be byproducts of attempted or successful persistence, privilege escalation, defense evasion, discovery, lateral movement, or collection activity by a threat actor.</p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/siem_cloudtrail/ml/high_distinct_count_error_message.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/siem_cloudtrail/ml/datafeed_high_distinct_count_error_message.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rare_error_code</p></td>
<td align="left" valign="top"><p>Looks for unusual errors. Rare and unusual errors may simply indicate an impending service failure but they can also be byproducts of attempted or successful persistence, privilege escalation, defense evasion, discovery, lateral movement, or collection activity by a threat actor.</p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/siem_cloudtrail/ml/rare_error_code.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/siem_cloudtrail/ml/datafeed_rare_error_code.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rare_method_for_a_city</p></td>
<td align="left" valign="top"><p>Looks for AWS API calls that, while not inherently suspicious or abnormal, are sourcing from a geolocation (city) that is unusual. This can be the result of compromised credentials or keys.</p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/siem_cloudtrail/ml/rare_method_for_a_city.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/siem_cloudtrail/ml/datafeed_rare_method_for_a_city.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rare_method_for_a_country</p></td>
<td align="left" valign="top"><p>Looks for AWS API calls that, while not inherently suspicious or abnormal, are sourcing from a geolocation (country) that is unusual. This can be the result of compromised credentials or keys.</p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/siem_cloudtrail/ml/rare_method_for_a_country.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/siem_cloudtrail/ml/datafeed_rare_method_for_a_country.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rare_method_for_a_username</p></td>
<td align="left" valign="top"><p>Looks for AWS API calls that, while not inherently suspicious or abnormal, are sourcing from a user context that does not normally call the method. This can be the result of compromised credentials or keys as someone uses a valid account to persist, move laterally, or exfil data.</p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/siem_cloudtrail/ml/rare_method_for_a_username.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/siem_cloudtrail/ml/datafeed_rare_method_for_a_username.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
</tr>
</tbody>
</table>
</div>
<h2><a id="security-linux-jobs"></a>Security: Linux<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/stack-docs/edit/8.14/docs/en/stack/ml/anomaly-detection/ootb-ml-jobs-siem.asciidoc">edit</a></h2>
<p>Anomaly detection jobs for Linux host-based threat hunting and detection.</p>
<p>In the Machine Learning app, these configurations are available only when data exists
that matches the query specified in the
<a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_linux/manifest.json" class="ulink" target="_top">manifest file</a>.
In the Elastic Security app, it looks in the data view specified in the
<a href="/guide/en/kibana/8.14/advanced-options.html#securitysolution-defaultindex" class="ulink" target="_top"><code class="literal">securitySolution:defaultIndex</code> advanced setting</a>
for data that matches the query.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Job</th>
<th align="left" valign="top">Datafeed</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>v3_linux_anomalous_network_activity</p></td>
<td align="left" valign="top"><p>Looks for unusual processes using the network which could indicate command-and-control, lateral movement, persistence, or data exfiltration activity.</p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_linux/ml/v3_linux_anomalous_network_activity.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_linux/ml/datafeed_v3_linux_anomalous_network_activity.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>v3_linux_anomalous_network_port_activity</p></td>
<td align="left" valign="top"><p>Looks for unusual destination port activity that could indicate command-and-control, persistence mechanism, or data exfiltration activity.</p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_linux/ml/v3_linux_anomalous_network_port_activity.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_linux/ml/datafeed_v3_linux_anomalous_network_port_activity.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>v3_linux_anomalous_process_all_hosts</p></td>
<td align="left" valign="top"><p>Looks for processes that are unusual to all Linux hosts. Such unusual processes may indicate unauthorized software, malware, or persistence mechanisms.</p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_linux/ml/v3_linux_anomalous_process_all_hosts.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_linux/ml/datafeed_v3_linux_anomalous_process_all_hosts.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>v3_linux_anomalous_user_name</p></td>
<td align="left" valign="top"><p>Rare and unusual users that are not normally active may indicate unauthorized changes or activity by an unauthorized user which may be credentialed access or lateral movement.</p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_linux/ml/v3_linux_anomalous_user_name.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_linux/ml/datafeed_v3_linux_anomalous_user_name.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>v3_linux_network_configuration_discovery</p></td>
<td align="left" valign="top"><p>Looks for commands related to system network configuration discovery from an unusual user context. This can be due to uncommon troubleshooting activity or due to a compromised account. A compromised account may be used by a threat actor to engage in system network configuration discovery to increase their understanding of connected networks and hosts. This information may be used to shape follow-up behaviors such as lateral movement or additional discovery.</p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_linux/ml/v3_linux_network_configuration_discovery.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_linux/ml/v3_datafeed_linux_network_configuration_discovery.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>v3_linux_network_connection_discovery</p></td>
<td align="left" valign="top"><p>Looks for commands related to system network connection discovery from an unusual user context. This can be due to uncommon troubleshooting activity or due to a compromised account. A compromised account may be used by a threat actor to engage in system network connection discovery to increase their understanding of connected services and systems. This information may be used to shape follow-up behaviors such as lateral movement or additional discovery.</p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_linux/ml/v3_linux_network_connection_discovery.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_linux/ml/v3_datafeed_linux_network_connection_discovery.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>v3_linux_rare_metadata_process</p></td>
<td align="left" valign="top"><p>Looks for anomalous access to the metadata service by an unusual process. The metadata service may be targeted in order to harvest credentials or user data scripts containing secrets.</p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_linux/ml/v3_linux_rare_metadata_process.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_linux/ml/datafeed_v3_linux_rare_metadata_process.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>v3_linux_rare_metadata_user</p></td>
<td align="left" valign="top"><p>Looks for anomalous access to the metadata service by an unusual user. The metadata service may be targeted in order to harvest credentials or user data scripts containing secrets.</p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_linux/ml/v3_linux_rare_metadata_user.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_linux/ml/datafeed_v3_linux_rare_metadata_user.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>v3_linux_rare_sudo_user</p></td>
<td align="left" valign="top"><p>Looks for sudo activity from an unusual user context. Unusual user context changes can be due to privilege escalation.</p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_linux/ml/v3_linux_rare_sudo_user.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/securiity_linux/ml/datafeed_v3_linux_rare_sudo_user.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>v3_linux_rare_user_compiler</p></td>
<td align="left" valign="top"><p>Looks for compiler activity by a user context which does not normally run compilers. This can be ad-hoc software changes or unauthorized software deployment. This can also be due to local privilege elevation via locally run exploits or malware activity.</p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_linux/ml/v3_linux_rare_user_compiler.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_linux/ml/datafeed_v3_linux_rare_user_compiler.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>v3_linux_system_information_discovery</p></td>
<td align="left" valign="top"><p>Looks for commands related to system information discovery from an unusual user context. This can be due to uncommon troubleshooting activity or due to a compromised account. A compromised account may be used to engage in system information discovery to gather detailed information about system configuration and software versions. This may be a precursor to the selection of a persistence mechanism or a method of privilege elevation.</p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_linux/ml/v3_linux_system_information_discovery.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_linux/ml/datafeed_v3_linux_system_information_discovery.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>v3_linux_system_process_discovery</p></td>
<td align="left" valign="top"><p>Looks for commands related to system process discovery from an unusual user context. This can be due to uncommon troubleshooting activity or due to a compromised account. A compromised account may be used to engage in system process discovery to increase their understanding of software applications running on a target host or network. This may be a precursor to the selection of a persistence mechanism or a method of privilege elevation.</p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_linux/ml/v3_linux_system_process_discovery.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_linux/ml/datafeed_v3_linux_system_process_discovery.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>v3_linux_system_user_discovery</p></td>
<td align="left" valign="top"><p>Looks for commands related to system user or owner discovery from an unusual user context. This can be due to uncommon troubleshooting activity or due to a compromised account. A compromised account may be used to engage in system owner or user discovery to identify currently active or primary users of a system. This may be a precursor to additional discovery, credential dumping, or privilege elevation activity.</p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_linux/ml/v3_linux_system_user_discovery.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_linux/ml/datafeed_v3_linux_system_user_discovery.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>v3_rare_process_by_host_linux</p></td>
<td align="left" valign="top"><p>Looks for processes that are unusual to a particular Linux host. Such unusual processes may indicate unauthorized software, malware, or persistence mechanisms.</p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_linux/ml/v3_rare_process_by_host_linux.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_linux/ml/datafeed_v3_rare_process_by_host_linux.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
</tr>
</tbody>
</table>
</div>
<h2><a id="security-network-jobs"></a>Security: Network<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/stack-docs/edit/8.14/docs/en/stack/ml/anomaly-detection/ootb-ml-jobs-siem.asciidoc">edit</a></h2>
<p>Detect anomalous network activity in your ECS-compatible network logs.</p>
<p>In the Machine Learning app, these configurations are available only when data exists
that matches the query specified in the
<a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_network/manifest.json" class="ulink" target="_top">manifest file</a>.
In the Elastic Security app, it looks in the data view specified in the
<a href="/guide/en/kibana/8.14/advanced-options.html#securitysolution-defaultindex" class="ulink" target="_top"><code class="literal">securitySolution:defaultIndex</code> advanced setting</a>
for data that matches the query.</p>
<p>By default, when you create these jobs in the Elastic Security app, it uses a
data view that applies to multiple indices. To get the same results if you
use the Machine Learning app, create a similar
<a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_network/manifest.json#L7" class="ulink" target="_top">data view</a>
then select it in the job wizard.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Job</th>
<th align="left" valign="top">Datafeed</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>high_count_by_destination_country</p></td>
<td align="left" valign="top"><p>Looks for an unusually large spike in network activity to one destination country in the network logs. This could be due to unusually large amounts of reconnaissance or enumeration traffic. Data exfiltration activity may also produce such a surge in traffic to a destination country which does not normally appear in network traffic or business work-flows. Malware instances and persistence mechanisms may communicate with command-and-control (C2) infrastructure in their country of origin, which may be an unusual destination country for the source network.</p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_network/ml/high_count_by_destination_country.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_network/ml/datafeed_high_count_by_destination_country.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>high_count_network_denies</p></td>
<td align="left" valign="top"><p>Looks for an unusually large spike in network traffic that was denied by network ACLs or firewall rules. Such a burst of denied traffic is usually either 1) a misconfigured application or firewall or 2) suspicious or malicious activity. Unsuccessful attempts at network transit, in order to connect to command-and-control (C2), or engage in data exfiltration, may produce a burst of failed connections. This could also be due to unusually large amounts of reconnaissance or enumeration traffic.  Denial-of-service attacks or traffic floods may also produce such a surge in traffic.</p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_network/ml/high_count_network_denies.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_network/ml/datafeed_high_count_network_denies.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>high_count_network_events</p></td>
<td align="left" valign="top"><p>Looks for an unusually large spike in network traffic. Such a burst of traffic, if not caused by a surge in business activity, can be due to suspicious or malicious activity. Large-scale data exfiltration may produce a burst of network traffic; this could also be due to unusually large amounts of reconnaissance or enumeration traffic.  Denial-of-service attacks or traffic floods may also produce such a surge in traffic.</p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_network/ml/high_count_network_events.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_network/ml/datafeed_high_count_network_events.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rare_destination_country</p></td>
<td align="left" valign="top"><p>Looks for an unusual destination country name in the network logs. This can be due to initial access, persistence, command-and-control, or exfiltration activity. For example, when a user clicks on a link in a phishing email or opens a malicious document, a request may be sent to download and run a payload from a server in a country which does not normally appear in network traffic or business work-flows. Malware instances and persistence mechanisms may communicate with command-and-control (C2) infrastructure in their country of origin, which may be an unusual destination country for the source network.</p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_network/ml/rare_destination_country.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_network/ml/datafeed_rare_destination_country.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
</tr>
</tbody>
</table>
</div>
<h2><a id="security-packetbeat-jobs"></a>Security: Packetbeat<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/stack-docs/edit/8.14/docs/en/stack/ml/anomaly-detection/ootb-ml-jobs-siem.asciidoc">edit</a></h2>
<p>Detect suspicious network activity in Packetbeat data.</p>
<p>In the Machine Learning app, these configurations are available only when data exists
that matches the query specified in the
<a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_packetbeat/manifest.json" class="ulink" target="_top">manifest file</a>.
In the Elastic Security app, it looks in the data view specified in the
<a href="/guide/en/kibana/8.14/advanced-options.html#securitysolution-defaultindex" class="ulink" target="_top"><code class="literal">securitySolution:defaultIndex</code> advanced setting</a>
for data that matches the query.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Job</th>
<th align="left" valign="top">Datafeed</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>packetbeat_dns_tunneling</p></td>
<td align="left" valign="top"><p>Looks for unusual DNS activity that could indicate command-and-control or data exfiltration activity.</p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/siem_packetbeat/ml/packetbeat_dns_tunneling.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/siem_packetbeat/ml/datafeed_packetbeat_dns_tunneling.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>packetbeat_rare_dns_question</p></td>
<td align="left" valign="top"><p>Looks for unusual DNS activity that could indicate command-and-control activity.</p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/siem_packetbeat/ml/packetbeat_rare_dns_question.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/siem_packetbeat/ml/datafeed_packetbeat_rare_dns_question.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>packetbeat_rare_server_domain</p></td>
<td align="left" valign="top"><p>Looks for unusual HTTP or TLS destination domain activity that could indicate execution, persistence, command-and-control or data exfiltration activity.</p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/siem_packetbeat/ml/packetbeat_rare_server_domain.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/siem_packetbeat/ml/datafeed_packetbeat_rare_server_domain.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>packetbeat_rare_urls</p></td>
<td align="left" valign="top"><p>Looks for unusual web browsing URL activity that could indicate execution, persistence, command-and-control or data exfiltration activity.</p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/siem_packetbeat/ml/packetbeat_rare_urls.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/siem_packetbeat/ml/datafeed_packetbeat_rare_urls.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>packetbeat_rare_user_agent</p></td>
<td align="left" valign="top"><p>Looks for unusual HTTP user agent activity that could indicate execution, persistence, command-and-control or data exfiltration activity.</p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/siem_packetbeat/ml/packetbeat_rare_user_agent.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/siem_packetbeat/ml/datafeed_packetbeat_rare_user_agent.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
</tr>
</tbody>
</table>
</div>
<h2><a id="security-windows-jobs"></a>Security: Windows<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/stack-docs/edit/8.14/docs/en/stack/ml/anomaly-detection/ootb-ml-jobs-siem.asciidoc">edit</a></h2>
<p>Anomaly detection jobs for Windows host-based threat hunting and detection.</p>
<p>In the Machine Learning app, these configurations are available only when data exists
that matches the query specified in the
<a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_windows/manifest.json" class="ulink" target="_top">manifest file</a>.
In the Elastic Security app, it looks in the data view specified in the
<a href="/guide/en/kibana/8.14/advanced-options.html#securitysolution-defaultindex" class="ulink" target="_top"><code class="literal">securitySolution:defaultIndex</code> advanced setting</a>
for data that matches the query.</p>
<p>If there are additional requirements such as installing the Windows System
Monitor (Sysmon) or auditing process creation in the Windows security event log,
they are listed for each job.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Job</th>
<th align="left" valign="top">Datafeed</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>v3_rare_process_by_host_windows</p></td>
<td align="left" valign="top"><p>Looks for processes that are unusual to a particular Windows host. Such unusual processes may indicate unauthorized software, malware, or persistence mechanisms.</p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_windows/ml/v3_rare_process_by_host_windows.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_windows/ml/datafeed_v3_rare_process_by_host_windows.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>v3_windows_anomalous_network_activity</p></td>
<td align="left" valign="top"><p>Looks for unusual processes using the network which could indicate command-and-control, lateral movement, persistence, or data exfiltration activity.</p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_windows/ml/v3_windows_anomalous_network_activity.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_windows/ml/datafeed_v3_windows_anomalous_network_activity.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>v3_windows_anomalous_path_activity</p></td>
<td align="left" valign="top"><p>Looks for activity in unusual paths that may indicate execution of malware or persistence mechanisms. Windows payloads often execute from user profile paths.</p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_windows/ml/v3_windows_anomalous_path_activity.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_windows/ml/datafeed_v3_windows_anomalous_path_activity.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>v3_windows_anomalous_process_all_hosts</p></td>
<td align="left" valign="top"><p>Looks for processes that are unusual to all Windows hosts. Such unusual processes may indicate execution of unauthorized software, malware, or persistence mechanisms.</p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_windows/ml/v3_windows_anomalous_process_all_hosts.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_windows/ml/datafeed_v3_windows_anomalous_process_all_hosts.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>v3_windows_anomalous_process_creation</p></td>
<td align="left" valign="top"><p>Looks for unusual process relationships which may indicate execution of malware or persistence mechanisms.</p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_windows/ml/v3_windows_anomalous_process_creation.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_windows/ml/datafeed_v3_windows_anomalous_process_creation.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>v3_windows_anomalous_script</p></td>
<td align="left" valign="top"><p>Looks for unusual powershell scripts that may indicate execution of malware, or persistence mechanisms.</p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_windows/ml/v3_windows_anomalous_script.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_windows/ml/datafeed_v3_windows_anomalous_script.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>v3_windows_anomalous_service</p></td>
<td align="left" valign="top"><p>Looks for rare and unusual Windows service names which may indicate execution of unauthorized services, malware, or persistence mechanisms.</p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_windows/ml/v3_windows_anomalous_service.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_windows/ml/datafeed_v3_windows_anomalous_service.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>v3_windows_anomalous_user_name</p></td>
<td align="left" valign="top"><p>Rare and unusual users that are not normally active may indicate unauthorized changes or activity by an unauthorized user which may be credentialed access or lateral movement.</p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_windows/ml/v3_windows_anomalous_user_name.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_windows/ml/datafeed_v3_windows_anomalous_user_name.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>v3_windows_rare_metadata_process</p></td>
<td align="left" valign="top"><p>Looks for anomalous access to the metadata service by an unusual process. The metadata service may be targeted in order to harvest credentials or user data scripts containing secrets.</p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_windows/ml/v3_windows_rare_metadata_process.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_windows/ml/datafeed_v3_windows_rare_metadata_process.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>v3_windows_rare_metadata_user</p></td>
<td align="left" valign="top"><p>Looks for anomalous access to the metadata service by an unusual user. The metadata service may be targeted in order to harvest credentials or user data scripts containing secrets.</p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_windows/ml/v3_windows_rare_metadata_user.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_windows/ml/datafeed_v3_windows_rare_metadata_user.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>v3_windows_rare_user_runas_event</p></td>
<td align="left" valign="top"><p>Unusual user context switches can be due to privilege escalation.</p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_windows/ml/v3_windows_rare_user_runas_event.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_windows/ml/datafeed_v3_windows_rare_user_runas_event.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>v3_windows_rare_user_type10_remote_login</p></td>
<td align="left" valign="top"><p>Unusual RDP (remote desktop protocol) user logins can indicate account takeover or credentialed access.</p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_windows/ml/v3_windows_rare_user_type10_remote_login.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
<td align="left" valign="top"><p><a href="https://github.com/elastic/kibana/blob/8.14/x-pack/plugins/ml/server/models/data_recognizer/modules/security_windows/ml/datafeed_v3_windows_rare_user_type10_remote_login.json" class="ulink" target="_top"><span class="image"><img src="images/link.svg" alt="A link icon"></span></a></p></td>
</tr>
</tbody>
</table>
</div>
<h2><a id="security-integrations-jobs"></a>Security: Elastic Integrations<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/stack-docs/edit/8.14/docs/en/stack/ml/anomaly-detection/ootb-ml-jobs-siem.asciidoc">edit</a></h2>
<p><a href="https://docs.elastic.co/integrations" class="ulink" target="_top">Elastic Integrations</a> are a streamlined way
to add Elastic assets to your environment, such as data ingestion, transforms,
and in this case, machine learning capabilities for Security.</p>
<p>The following Integrations use machine learning to analyze patterns of user and entity
behavior, and help detect and alert when there is related suspicious activity in
your environment.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://docs.elastic.co/integrations/ded" class="ulink" target="_top">Data Exfiltration Detection</a>
</li>
<li class="listitem">
<a href="https://docs.elastic.co/integrations/dga" class="ulink" target="_top">Domain Generation Algorithm Detection</a>
</li>
<li class="listitem">
<a href="https://docs.elastic.co/integrations/lmd" class="ulink" target="_top">Lateral Movement Detection</a>
</li>
<li class="listitem">
<a href="https://docs.elastic.co/integrations/problemchild" class="ulink" target="_top">Living off the Land Attack Detection</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Domain Generation Algorithm (DGA) Detection</strong></span></p>
<p>Machine learning solution package to detect domain generation algorithm (DGA) activity
in your network data. Refer to the <a href="/subscriptions" class="ulink" target="_top">subscription page</a> to learn
more about the required subscription.</p>
<p>To download, refer to the <a href="https://docs.elastic.co/integrations/dga" class="ulink" target="_top">documentation</a>.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>dga_high_sum_probability</p></td>
<td align="left" valign="top"><p>Detect domain generation algorithm (DGA) activity in your network data.</p></td>
</tr>
</tbody>
</table>
</div>
<p>The job configurations and datafeeds can be found
<a href="https://github.com/elastic/integrations/blob/main/packages/dga/kibana/ml_module/dga-ml.json" class="ulink" target="_top">here</a>.</p>
<p><span class="strong strong"><strong>Living off the Land Attack (LotL) Detection</strong></span></p>
<p>Machine learning solution package to detect Living off the Land (LotL) attacks in your
environment. Refer to the <a href="/subscriptions" class="ulink" target="_top">subscription page</a> to learn more about
the required subscription. (Also known as ProblemChild).</p>
<p>To download, refer to the <a href="https://docs.elastic.co/integrations/problemchild" class="ulink" target="_top">documentation</a>.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>problem_child_rare_process_by_host</p></td>
<td align="left" valign="top"><p>Looks for a process that has been classified as malicious on a host that does not commonly manifest malicious process activity.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>problem_child_high_sum_by_host</p></td>
<td align="left" valign="top"><p>Looks for a set of one or more malicious child processes on a single host.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>problem_child_rare_process_by_user</p></td>
<td align="left" valign="top"><p>Looks for a process that has been classified as malicious where the user context is unusual and does not commonly manifest malicious process activity.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>problem_child_rare_process_by_parent</p></td>
<td align="left" valign="top"><p>Looks for rare malicious child processes spawned by a parent process.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>problem_child_high_sum_by_user</p></td>
<td align="left" valign="top"><p>Looks for a set of one or more malicious processes, started by the same user.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>problem_child_high_sum_by_parent</p></td>
<td align="left" valign="top"><p>Looks for a set of one or more malicious child processes spawned by the same parent process.</p></td>
</tr>
</tbody>
</table>
</div>
<p>The job configurations and datafeeds can be found
<a href="https://github.com/elastic/integrations/blob/main/packages/problemchild/kibana/ml_module/problemchild-ml.json" class="ulink" target="_top">here</a>.</p>
<p><span class="strong strong"><strong>Data Exfiltration Detection (DED)</strong></span></p>
<p>Machine learning package to detect data exfiltration in your network and file data. Refer to the <a href="/subscriptions" class="ulink" target="_top">subscription page</a> to learn more about the required subscription.</p>
<p>To download, refer to the <a href="https://docs.elastic.co/integrations/ded" class="ulink" target="_top">documentation</a>.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>ded_high_sent_bytes_destination_geo_country_iso_code</p></td>
<td align="left" valign="top"><p>Detects data exfiltration to an unusual geo-location (by country iso code).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>ded_high_sent_bytes_destination_ip</p></td>
<td align="left" valign="top"><p>Detects data exfiltration to an unusual geo-location (by IP address).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>ded_high_sent_bytes_destination_port</p></td>
<td align="left" valign="top"><p>Detects data exfiltration to an unusual destination port.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>ded_high_sent_bytes_destination_region_name</p></td>
<td align="left" valign="top"><p>Detects data exfiltration to an unusual geo-location (by region name).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>ded_high_bytes_written_to_external_device</p></td>
<td align="left" valign="top"><p>Detects data exfiltration activity by identifying high bytes written to an external device.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>ded_rare_process_writing_to_external_device</p></td>
<td align="left" valign="top"><p>Detects data exfiltration activity by identifying a file write started by a rare process to an external device.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>ded_high_bytes_written_to_external_device_airdrop</p></td>
<td align="left" valign="top"><p>Detects data exfiltration activity by identifying high bytes written to an external device via Airdrop.</p></td>
</tr>
</tbody>
</table>
</div>
<p>The job configurations and datafeeds can be found
<a href="https://github.com/elastic/integrations/blob/main/packages/ded/kibana/ml_module/ded-ml.json" class="ulink" target="_top">here</a>.</p>
<p><span class="strong strong"><strong>Lateral Movement Detection (LMD)</strong></span></p>
<p>Machine learning package to detect lateral movement based on file transfer activity and
Windows RDP events. Refer to the <a href="/subscriptions" class="ulink" target="_top">subscription page</a> to learn
more about the required subscription.</p>
<p>To download, refer to the <a href="https://docs.elastic.co/integrations/lmd" class="ulink" target="_top">documentation</a>.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>lmd_high_count_remote_file_transfer</p></td>
<td align="left" valign="top"><p>Detects unusually high file transfers to a remote host in the network.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>lmd_high_file_size_remote_file_transfer</p></td>
<td align="left" valign="top"><p>Detects unusually high size of files shared with a remote host in the network.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>lmd_rare_file_extension_remote_transfer</p></td>
<td align="left" valign="top"><p>Detects data exfiltration to an unusual destination port.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>lmd_rare_file_path_remote_transfer</p></td>
<td align="left" valign="top"><p>Detects unusual folders and directories on which a file is transferred.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>lmd_high_mean_rdp_session_duration</p></td>
<td align="left" valign="top"><p>Detects unusually high mean of RDP session duration.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>lmd_high_var_rdp_session_duration</p></td>
<td align="left" valign="top"><p>Detects unusually high variance in RDP session duration.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>lmd_high_sum_rdp_number_of_processes</p></td>
<td align="left" valign="top"><p>Detects unusually high number of processes started in a single RDP session.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>lmd_unusual_time_weekday_rdp_session_start</p></td>
<td align="left" valign="top"><p>Detects an RDP session started at an usual time or weekday.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>lmd_high_rdp_distinct_count_source_ip_for_destination</p></td>
<td align="left" valign="top"><p>Detects a high count of source IPs making an RDP connection with a single destination IP.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>lmd_high_rdp_distinct_count_destination_ip_for_source</p></td>
<td align="left" valign="top"><p>Detects a high count of destination IPs establishing an RDP connection with a single source IP.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>lmd_high_mean_rdp_process_args</p></td>
<td align="left" valign="top"><p>Detects unusually high number of process arguments in an RDP session.</p></td>
</tr>
</tbody>
</table>
</div>
<p>The job configurations and datafeeds can be found
<a href="https://github.com/elastic/integrations/blob/main/packages/lmd/kibana/ml_module/lmd-ml.json" class="ulink" target="_top">here</a>.</p>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="ootb-ml-jobs-nginx.html">« Appendix G: Nginx anomaly detection configurations</a>
</span>
<span class="next">
<a href="ootb-ml-jobs-uptime.html">Appendix I: Uptime anomaly detection configurations »</a>
</span>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>

                        <!-- Feedback widget -->
                        <div id="feedbackWidgetContainer"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


        <div id='elastic-footer'></div>
        <script src='https://www.elastic.co/elastic-footer.js'></script>
        <!-- Footer Section end-->

      </section>
    </div>

    <!-- Feedback modal -->
    <div id="feedbackModalContainer"></div>

    <script src="/guide/static/jquery.js"></script>
    <script type="text/javascript" src="/guide/static/docs-v1.js"></script>
    <script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
