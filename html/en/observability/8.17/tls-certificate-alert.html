<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Create a TLS certificate rule | Elastic Observability [8.17] | Elastic</title>
<meta class="elastic" name="content" content="Create a TLS certificate rule | Elastic Observability [8.17]">

<link rel="home" href="index.html" title="Elastic Observability [8.17]"/>
<link rel="up" href="create-alerts-rules.html" title="Create and manage rules"/>
<link rel="prev" href="monitor-status-alert.html" title="Create a monitor status rule"/>
<link rel="next" href="duration-anomaly-alert.html" title="Create an uptime duration anomaly rule"/>
<meta class="elastic" name="product_version" content="8.17"/>
<meta class="elastic" name="product_name" content="Observability"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Observability/Guide/8.17"/>
<meta name="DC.subject" content="Observability"/>
<meta name="DC.identifier" content="8.17"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="icon" href="/favicon.ico" sizes="32x32"/>
    <link rel="icon" href="/favicon.svg" type="image/svg+xml"/>
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" sizes="180x180"/>
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles-v1.css" />
  </head>

  <!--© 2015-2025 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div class="navheader">
<span class="prev">
<a href="monitor-status-alert.html">« Create a monitor status rule</a>
</span>
<span class="next">
<a href="duration-anomaly-alert.html">Create an uptime duration anomaly rule »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Observability [8.17]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="incident-management.html">Incident management</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="create-alerts.html">Alerting</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="create-alerts-rules.html">Create and manage rules</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Create a TLS certificate rule</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.17/docs/en/observability/synthetics-uptime-tls-alert.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div id="url-to-v3" class="version-warning">
    <strong>IMPORTANT</strong>: This documentation is no longer updated. Refer to <a href="https://www.elastic.co/support/eol">Elastic's version policy</a> and the <a href="https://www.elastic.co/docs/solutions/observability/incident-management/create-tls-certificate-rule">latest documentation</a>.
</div>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h4 class="title"><a id="tls-certificate-alert"></a>Create a TLS certificate rule</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.17/docs/en/observability/synthetics-uptime-tls-alert.asciidoc">edit</a></div>
</div></div></div>

<p>In Kibana, you can create a rule that notifies you when one or more of your monitors
has a TLS certificate expiring within a specified threshold, or when it exceeds an age limit.</p>
<p>There are two types of TLS certificate rule:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="tls-certificate-alert.html#tls-rule-synthetics" title="Synthetics TLS certificate rule">Synthetics TLS certificate rule</a> for use with <a class="xref" href="monitor-uptime-synthetics.html" title="Synthetic monitoring">Elastic Synthetics</a>.
</li>
<li class="listitem">
<span class="Admonishment Admonishment--change">
[<span class="Admonishment-version u-mono u-strikethrough">8.15.0</span>]
<span class="Admonishment-detail">
Deprecated in 8.15.0.
</span>
</span> <a class="xref" href="tls-certificate-alert.html#tls-rule-uptime" title="Uptime TLS rule">Uptime TLS rule</a> for use with the Uptime app.
</li>
</ul>
</div>
<div class="position-relative"><h6><a id="tls-rule-synthetics"></a>Synthetics TLS certificate rule</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.17/docs/en/observability/synthetics-uptime-tls-alert.asciidoc">edit</a></div>
<p>Within the Synthetics UI, create a <span class="strong strong"><strong>TLS certificate</strong></span> rule to receive notifications
based on errors and outages.</p>
<div class="position-relative"><h7><a id="tls-rule-synthetics-conditions"></a>Conditions</h7><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.17/docs/en/observability/synthetics-uptime-tls-alert.asciidoc">edit</a></div>
<p>You can specify the following thresholds for your rule:</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<tbody>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Expiration threshold</strong></span></p></td>
<td align="left" valign="top"><p>The <code class="literal">HAS A CERTIFICATE EXPIRING WITHIN DAYS</code> condition specifies when you are notified
about certificates that are approaching expiration dates.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Age limit</strong></span></p></td>
<td align="left" valign="top"><p>The <code class="literal">OR OLDER THAN DAYS</code> condition specifies when you are notified about certificates
that have been valid for too long.</p></td>
</tr>
</tbody>
</table>
</div>
<p>The <span class="strong strong"><strong>Rule schedule</strong></span> defines how often to evaluate the condition.</p>
<p>You can also set <span class="strong strong"><strong>Advanced options</strong></span> such as the number of consecutive runs that must meet the rule conditions before
an alert occurs.</p>
<p>In this example, the conditions are met when any of the TLS certificates on sites we’re monitoring
is expiring within 30 days or is older than 730 days. These conditions are evaluated every 6 hours,
and you will only receive an alert when the conditions are met three times consecutively.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/tls-rule-synthetics-conditions.png" alt="Conditions and advanced options defining a Synthetics TLS certificate rule" width="600">
</div>
</div>
<div class="position-relative"><h7><a id="tls-rule-synthetics-action-types"></a>Action types</h7><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.17/docs/en/observability/synthetics-uptime-tls-alert.asciidoc">edit</a></div>
<p>Extend your rules by connecting them to actions that use the following supported built-in integrations.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="/guide/en/kibana/8.17/d3security-action-type.html" class="ulink" target="_top">D3 Security</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.17/email-action-type.html" class="ulink" target="_top">Email</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.17/resilient-action-type.html" class="ulink" target="_top">IBM Resilient</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.17/index-action-type.html" class="ulink" target="_top">Index</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.17/jira-action-type.html" class="ulink" target="_top">Jira</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.17/teams-action-type.html" class="ulink" target="_top">Microsoft Teams</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.17/obs-ai-assistant-action-type.html" class="ulink" target="_top">Observability AI Assistant connector</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.17/opsgenie-action-type.html" class="ulink" target="_top">Opsgenie</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.17/pagerduty-action-type.html" class="ulink" target="_top">PagerDuty</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.17/server-log-action-type.html" class="ulink" target="_top">Server log</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.17/servicenow-itom-action-type.html" class="ulink" target="_top">ServiceNow ITOM</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.17/servicenow-action-type.html" class="ulink" target="_top">ServiceNow ITSM</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.17/servicenow-sir-action-type.html" class="ulink" target="_top">ServiceNow SecOps</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.17/slack-action-type.html" class="ulink" target="_top">Slack</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.17/swimlane-action-type.html" class="ulink" target="_top">Swimlane</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.17/torq-action-type.html" class="ulink" target="_top">Torq</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.17/webhook-action-type.html" class="ulink" target="_top">Webhook</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.17/xmatters-action-type.html" class="ulink" target="_top">xMatters</a>
</li>
</ul>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Some connector types are paid commercial features, while others are free.
For a comparison of the Elastic subscription levels, go to
<a href="/subscriptions" class="ulink" target="_top">the subscription page</a>.</p>
</div>
</div>
<p>After you select a connector, you must set the action frequency.
You can choose to create a summary of alerts on each check interval or on a custom interval.
For example, send email notifications that summarize the new, ongoing, and recovered alerts each hour:</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/tls-rule-synthetics-action-types-summary.png" alt="tls rule synthetics action types summary" width="600">
</div>
</div>
<p>Alternatively, you can set the action frequency such that you choose how often the action runs
(for example, at each check interval, only when the alert status changes, or at a custom action interval).
In this case, you must also select the specific threshold condition that affects when actions run:
the <em>Synthetics TLS certificate</em> changes or when it is <em>Recovered</em> (went from down to up).</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/tls-rule-synthetics-action-types-each-alert.png" alt="tls rule synthetics action types each alert" width="600">
</div>
</div>
<p>You can also further refine the conditions under which actions run by specifying that actions only run
when they match a KQL query or when an alert occurs within a specific time frame:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>If alert matches query</strong></span>: Enter a KQL query that defines field-value pairs or query conditions that must
be met for notifications to send. The query only searches alert documents in the indices specified for the rule.
</li>
<li class="listitem">
<span class="strong strong"><strong>If alert is generated during timeframe</strong></span>: Set timeframe details. Notifications are only sent if alerts are
generated within the timeframe you define.
</li>
</ul>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="images/tls-rule-synthetics-action-types-more-options.png" alt="tls rule synthetics action types more options" width="600">
</div>
</div>
<div class="position-relative"><h8><a id="tls-rule-synthetics-action-variables"></a>Action variables</h8><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.17/docs/en/observability/synthetics-uptime-tls-alert.asciidoc">edit</a></div>
<p>Use the default notification message or customize it.
You can add more context to the message by clicking the icon above the message text box
and selecting from a list of available variables.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/tls-rule-synthetics-action-variables.png" alt="tls rule synthetics action variables" width="600">
</div>
</div>
<p>The following variables are specific to this rule type.
You an also specify <a href="/guide/en/kibana/8.17/rule-action-variables.html" class="ulink" target="_top">variables common to all rules</a>.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">context.checkedAt</code>
</span>
</dt>
<dd>
Timestamp of the monitor run.
</dd>
<dt>
<span class="term">
<code class="literal">context.hostName</code>
</span>
</dt>
<dd>
Hostname of the location from which the check is performed.
</dd>
<dt>
<span class="term">
<code class="literal">context.labels</code>
</span>
</dt>
<dd>
Labels associated with the monitor.
</dd>
<dt>
<span class="term">
<code class="literal">context.lastErrorMessage</code>
</span>
</dt>
<dd>
Monitor last error message.
</dd>
<dt>
<span class="term">
<code class="literal">context.lastErrorStack</code>
</span>
</dt>
<dd>
Monitor last error stack trace.
</dd>
<dt>
<span class="term">
<code class="literal">context.locationId</code>
</span>
</dt>
<dd>
Location ID from which the check is performed.
</dd>
<dt>
<span class="term">
<code class="literal">context.locationName</code>
</span>
</dt>
<dd>
Location name from which the check is performed.
</dd>
<dt>
<span class="term">
<code class="literal">context.locationNames</code>
</span>
</dt>
<dd>
Location names from which the checks are performed.
</dd>
<dt>
<span class="term">
<code class="literal">context.monitorType</code>
</span>
</dt>
<dd>
Type (for example, HTTP/TCP) of the monitor.
</dd>
<dt>
<span class="term">
<code class="literal">context.monitorUrl</code>
</span>
</dt>
<dd>
URL of the monitor.
</dd>
<dt>
<span class="term">
<code class="literal">context.reason</code>
</span>
</dt>
<dd>
A concise description of the reason for the alert.
</dd>
<dt>
<span class="term">
<code class="literal">context.recoveryReason</code>
</span>
</dt>
<dd>
A concise description of the reason for the recovery.
</dd>
<dt>
<span class="term">
<code class="literal">context.serviceName</code>
</span>
</dt>
<dd>
Service name associated with the monitor.
</dd>
<dt>
<span class="term">
<code class="literal">context.status</code>
</span>
</dt>
<dd>
Monitor status (for example, "down").
</dd>
<dt>
<span class="term">
<code class="literal">context.viewInAppUrl</code>
</span>
</dt>
<dd>
Open alert details and context in Synthetics app.
</dd>
</dl>
</div>
<div class="position-relative"><h6><a id="tls-rule-uptime"></a>Uptime TLS rule</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.17/docs/en/observability/synthetics-uptime-tls-alert.asciidoc">edit</a></div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>Deprecated in 8.15.0.</p>
</div>
</div>
<p>Within the Uptime app, create a <span class="strong strong"><strong>TLS certificate</strong></span> rule to receive notifications
based on errors and outages.</p>
<div class="position-relative"><h7><a id="tls-rule-uptime-filters"></a>Filters</h7><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.17/docs/en/observability/synthetics-uptime-tls-alert.asciidoc">edit</a></div>
<p>The <span class="strong strong"><strong>Filter by</strong></span> section controls the scope of the rule.
The rule will only check monitors that match the filters defined in this section.</p>
<div class="position-relative"><h7><a id="tls-alert-conditions"></a>Conditions</h7><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.17/docs/en/observability/synthetics-uptime-tls-alert.asciidoc">edit</a></div>
<p>You can specify the following thresholds for your rule:</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<tbody>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Expiration threshold</strong></span></p></td>
<td align="left" valign="top"><p>The <code class="literal">HAS A CERTIFICATE EXPIRING WITHIN DAYS</code> threshold specifies when you are notified
about certificates that are approaching expiration dates.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Age limit</strong></span></p></td>
<td align="left" valign="top"><p>The <code class="literal">OR OLDER THAN DAYS</code> threshold specifies when you are notified about certificates
that have been valid for too long.</p></td>
</tr>
</tbody>
</table>
</div>
<p>In this example, the conditions are met when any of the TLS certificates on sites we’re monitoring
is expiring within 30 days or is older than 730 days. These conditions are evaluated every 6 hours,
and you will only receive an alert when the conditions are met three times consecutively.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/tls-rule-uptime-conditions.png" alt="Monitor status rule">
</div>
</div>
<div class="position-relative"><h7><a id="action-types-certs"></a>Action types</h7><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.17/docs/en/observability/synthetics-uptime-tls-alert.asciidoc">edit</a></div>
<p>Extend your rules by connecting them to actions that use the following
supported built-in integrations. Actions are Kibana services or integrations with
third-party systems that run as background tasks on the Kibana server when rule conditions are met.</p>
<p>You can configure action types on the <a class="xref" href="configure-uptime-settings.html#configure-uptime-alert-connectors" title="Configure connectors">Settings</a> page.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="/guide/en/kibana/8.17/d3security-action-type.html" class="ulink" target="_top">D3 Security</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.17/email-action-type.html" class="ulink" target="_top">Email</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.17/resilient-action-type.html" class="ulink" target="_top">IBM Resilient</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.17/index-action-type.html" class="ulink" target="_top">Index</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.17/jira-action-type.html" class="ulink" target="_top">Jira</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.17/teams-action-type.html" class="ulink" target="_top">Microsoft Teams</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.17/obs-ai-assistant-action-type.html" class="ulink" target="_top">Observability AI Assistant connector</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.17/opsgenie-action-type.html" class="ulink" target="_top">Opsgenie</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.17/pagerduty-action-type.html" class="ulink" target="_top">PagerDuty</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.17/server-log-action-type.html" class="ulink" target="_top">Server log</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.17/servicenow-itom-action-type.html" class="ulink" target="_top">ServiceNow ITOM</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.17/servicenow-action-type.html" class="ulink" target="_top">ServiceNow ITSM</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.17/servicenow-sir-action-type.html" class="ulink" target="_top">ServiceNow SecOps</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.17/slack-action-type.html" class="ulink" target="_top">Slack</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.17/swimlane-action-type.html" class="ulink" target="_top">Swimlane</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.17/torq-action-type.html" class="ulink" target="_top">Torq</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.17/webhook-action-type.html" class="ulink" target="_top">Webhook</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.17/xmatters-action-type.html" class="ulink" target="_top">xMatters</a>
</li>
</ul>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Some connector types are paid commercial features, while others are free.
For a comparison of the Elastic subscription levels, go to
<a href="/subscriptions" class="ulink" target="_top">the subscription page</a>.</p>
</div>
</div>
<p>After you select a connector, you must set the action frequency.
You can choose to create a summary of alerts on each check interval or on a custom interval.
For example, send email notifications that summarize the new, ongoing, and recovered alerts each hour:</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/tls-rule-uptime-action-types-summary.png" alt="tls rule uptime action types summary" width="600">
</div>
</div>
<p>Alternatively, you can set the action frequency such that you choose how often the action runs
(for example, at each check interval, only when the alert status changes, or at a custom action interval).
In this case, you must also select the specific threshold condition that affects when actions run:
<em>Uptime TLS Alert</em> or <em>Recovered</em> (went from down to up).</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/tls-rule-uptime-action-types-each-alert.png" alt="tls rule uptime action types each alert" width="600">
</div>
</div>
<p>You can also further refine the conditions under which actions run by specifying that actions only run
when they match a KQL query or when an alert occurs within a specific time frame:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>If alert matches query</strong></span>: Enter a KQL query that defines field-value pairs or query conditions that must
be met for notifications to send. The query only searches alert documents in the indices specified for the rule.
</li>
<li class="listitem">
<span class="strong strong"><strong>If alert is generated during timeframe</strong></span>: Set timeframe details. Notifications are only sent if alerts are
generated within the timeframe you define.
</li>
</ul>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="images/tls-rule-uptime-action-types-more-options.png" alt="tls rule uptime action types more options" width="600">
</div>
</div>
<div class="position-relative"><h8><a id="action-variables-certs"></a>Action variables</h8><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.17/docs/en/observability/synthetics-uptime-tls-alert.asciidoc">edit</a></div>
<p>Use the default notification message or customize it.
You can add more context to the message by clicking the icon above the message text box
and selecting from a list of available variables.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/tls-rule-uptime-default-message.png" alt="Default notification message for TLS rules with open &quot;Add variable&quot; popup listing available action variables" width="600">
</div>
</div>
<p>The following variables are specific to this rule type.
You an also specify <a href="/guide/en/kibana/8.17/rule-action-variables.html" class="ulink" target="_top">variables common to all rules</a>.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">context.agingCommonNameAndDate</code>
</span>
</dt>
<dd>
The common names and expiration date/time of the detected certs.
</dd>
<dt>
<span class="term">
<code class="literal">context.agingCount</code>
</span>
</dt>
<dd>
The number of detected certs that are becoming too old.
</dd>
<dt>
<span class="term">
<code class="literal">context.alertDetailsUrl</code>
</span>
</dt>
<dd>
Link to the alert troubleshooting view for further context and details. This will be an empty string if the <code class="literal">server.publicBaseUrl</code> is not configured.
</dd>
<dt>
<span class="term">
<code class="literal">context.count</code>
</span>
</dt>
<dd>
The number of certs detected by the alert executor.
</dd>
<dt>
<span class="term">
<code class="literal">context.currentTriggerStarted</code>
</span>
</dt>
<dd>
Timestamp indicating when the current trigger state began, if alert is triggered.
</dd>
<dt>
<span class="term">
<code class="literal">context.expiringCommonNameAndDate</code>
</span>
</dt>
<dd>
The common names and expiration date/time of the detected certs.
</dd>
<dt>
<span class="term">
<code class="literal">context.expiringCount</code>
</span>
</dt>
<dd>
The number of expiring certs detected by the alert.
</dd>
<dt>
<span class="term">
<code class="literal">context.firstCheckedAt</code>
</span>
</dt>
<dd>
Timestamp indicating when this alert first checked.
</dd>
<dt>
<span class="term">
<code class="literal">context.firstTriggeredAt</code>
</span>
</dt>
<dd>
Timestamp indicating when the alert first triggered.
</dd>
<dt>
<span class="term">
<code class="literal">context.isTriggered</code>
</span>
</dt>
<dd>
Flag indicating if the alert is currently triggering.
</dd>
<dt>
<span class="term">
<code class="literal">context.lastCheckedAt</code>
</span>
</dt>
<dd>
Timestamp indicating the alert&#8217;s most recent check time.
</dd>
<dt>
<span class="term">
<code class="literal">context.lastResolvedAt</code>
</span>
</dt>
<dd>
Timestamp indicating the most recent resolution time for this alert.
</dd>
<dt>
<span class="term">
<code class="literal">context.lastTriggeredAt</code>
</span>
</dt>
<dd>
Timestamp indicating the alert&#8217;s most recent trigger time.
</dd>
</dl>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="monitor-status-alert.html">« Create a monitor status rule</a>
</span>
<span class="next">
<a href="duration-anomaly-alert.html">Create an uptime duration anomaly rule »</a>
</span>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>

                        <!-- Feedback widget -->
                        <div id="feedbackWidgetContainer"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


        <div id='elastic-footer'></div>
        <script src='https://www.elastic.co/elastic-footer.js'></script>
        <!-- Footer Section end-->

      </section>
    </div>

    <!-- Feedback modal -->
    <div id="feedbackModalContainer"></div>

    <script src="/guide/static/jquery.js"></script>
    <script type="text/javascript" src="/guide/static/docs-v1.js"></script>
    <script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
