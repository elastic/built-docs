<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<meta name="description" content="Learn configuration options for Elastic Serverless Forwarder and how to transform your AWS data as it is collected from Amazon Web Services (AWS).">
<meta name="keywords" content="serverless">
<title>Manage multiline messages | Observability Guide [8.3] | Elastic</title>
<meta class="elastic" name="content" content="Manage multiline messages | Observability Guide [8.3]">

<link rel="home" href="index.html" title="Observability Guide [8.3]"/>
<link rel="up" href="aws-elastic-serverless-forwarder-configuration.html" title="Configuration options for Elastic Serverless Forwarder"/>
<link rel="prev" href="aws-serverless-json-content.html" title="JSON content discovery"/>
<link rel="next" href="aws-serverless-troubleshooting.html" title="Troubleshooting and error handling"/>
<meta class="elastic" name="product_version" content="8.3"/>
<meta class="elastic" name="product_name" content="Observability"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Observability/Guide/8.3"/>
<meta name="DC.subject" content="Observability"/>
<meta name="DC.identifier" content="8.3"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <!--© 2015-2022 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  <div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Observability Guide [8.3]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="add-observability-data.html">Send data to Elasticsearch</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="aws-elastic-serverless-forwarder.html">Elastic Serverless Forwarder for AWS</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="aws-elastic-serverless-forwarder-configuration.html">Configuration options for Elastic Serverless Forwarder</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="aws-serverless-json-content.html">« JSON content discovery</a>
</span>
<span class="next">
<a href="aws-serverless-troubleshooting.html">Troubleshooting and error handling »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="aws-serverless-manage-multiline-messages"></a>Manage multiline messages<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.3/docs/en/observability/aws-elastic-serverless-forwarder-configuration.asciidoc">edit</a></h4>
</div></div></div>
<p>Forwarded content may contain messages that span multiple lines of text. For example, multiline messages are common in files that contain Java stack traces. In order to correctly handle these multiline events, you need to configure <code class="literal">multiline</code> settings for a specific input to specify which lines are part of a single event.</p>
<div class="section">
<div class="titlepage"><div><div>
<h5 class="title"><a id="aws-serverless-multiline-config"></a>Configuration options<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.3/docs/en/observability/aws-elastic-serverless-forwarder-configuration.asciidoc">edit</a></h5>
</div></div></div>
<p>You can specify the following options for a specific input in the <code class="literal">config.yaml</code> file to control how the Elastic Serverless Forwarder deals with messages that span multiple lines.</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">inputs:
  - type: "s3-sqs"
    id: "arn:aws:sqs:%REGION%:%ACCOUNT%:%QUEUENAME%"
    multiline:
      type: pattern
      pattern: '^\\['
      negate: true
      match: after
    outputs:
      - type: "elasticsearch"
        args:
          elasticsearch_url: "arn:aws:secretsmanager:eu-central-1:123456789:secret:es_url"
          username: "arn:aws:secretsmanager:eu-west-1:123456789:secret:es_secrets:username"
          password: "arn:aws:secretsmanager:eu-west-1:123456789:secret:es_secrets:password"
          es_datastream_name: "logs-generic-default"</pre>
</div>
<p>The forwarder takes all the lines that do not start with <code class="literal">[</code> and combines them with the previous line that does. For example, you could use this configuration to join the following lines of a multiline message into a single event:</p>
<div class="pre_wrapper lang-shell">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-shell">[beat-logstash-some-name-832-2015.11.28] IndexNotFoundException[no such index]
    at org.elasticsearch.cluster.metadata.IndexNameExpressionResolver$WildcardExpressionResolver.resolve(IndexNameExpressionResolver.java:566)
    at org.elasticsearch.cluster.metadata.IndexNameExpressionResolver.concreteIndices(IndexNameExpressionResolver.java:133)
    at org.elasticsearch.cluster.metadata.IndexNameExpressionResolver.concreteIndices(IndexNameExpressionResolver.java:77)
    at org.elasticsearch.action.admin.indices.delete.TransportDeleteIndexAction.checkBlock(TransportDeleteIndexAction.java:75)</pre>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Note that you should escape the opening square bracket (<code class="literal">[</code>) in the regular expression, because it specifies a character class i.e. a set of characters that you wish to match. You also have to escape the backslash (<code class="literal">\</code>) used for escaping the opening square bracket as raw strings are not used. Thus, <code class="literal">^\\[</code> will produce the required regular expression upon compiling.</p>
</div>
</div>
<p><code class="literal">inputs.[].multiline.type</code> defines which aggregation method to use. The default is <code class="literal">pattern</code>. The other options are <code class="literal">count</code>, which enables you to aggregate a constant number of lines, and <code class="literal">while_pattern</code>, which aggregates lines by pattern without matching options.</p>
<p><code class="literal">inputs.[].multiline.pattern</code> differs from the patterns supported by Logstash. See <a href="https://docs.python.org/3.9/library/re.html#regular-expression-syntax" class="ulink" target="_top">Python&#8217;s 3.9 regular expression syntax</a> for a list of supported regexp patterns. Depending on how you configure other multiline options, lines that match the specified regular expression are considered either continuations of a previous line or the start of a new multiline event.</p>
<p><code class="literal">inputs.[].multiline.negate</code> defines whether the pattern is negated. The default is <code class="literal">false</code>. This setting works only with <code class="literal">pattern</code> and <code class="literal">while_pattern</code> types.</p>
<p><code class="literal">inputs.[].multiline.match</code> changes the grouping of multiple lines according to the schema below (works only with <code class="literal">pattern</code> type):</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<tbody>
<tr>
<td align="left" valign="top"><p>Setting for <code class="literal">negate</code></p></td>
<td align="left" valign="top"><p>Setting for <code class="literal">match</code></p></td>
<td align="left" valign="top"><p>Result</p></td>
<td align="left" valign="top"><p>Example <code class="literal">pattern: ^b</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p><code class="literal">after</code></p></td>
<td align="left" valign="top"><p>Consecutive lines that match the pattern are appended to the previous line that doesn’t match.</p></td>
<td align="left" valign="top"><p><span class="image"><img src="images/false-after-multi.png" alt="Lines a b b c b b become &quot;abb&quot; and &quot;cbb&quot;"></span></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p><code class="literal">before</code></p></td>
<td align="left" valign="top"><p>Consecutive lines that match the pattern are prepended to the next line that doesn’t match.</p></td>
<td align="left" valign="top"><p><span class="image"><img src="images/false-after-multi.png" alt="Lines b b a b b c become &quot;bba&quot; and &quot;bbc&quot;"></span></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">true</code></p></td>
<td align="left" valign="top"><p><code class="literal">after</code></p></td>
<td align="left" valign="top"><p>Consecutive lines that don’t match the pattern are appended to the previous line that does match.</p></td>
<td align="left" valign="top"><p><span class="image"><img src="images/true-after-multi.png" alt="Lines b a c b d e become &quot;bac&quot; and &quot;bde&quot;"></span></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p><code class="literal">before</code></p></td>
<td align="left" valign="top"><p>Consecutive lines that don’t match the pattern are prepended to the next line that does match.</p></td>
<td align="left" valign="top"><p><span class="image"><img src="images/true-before-multi.png" alt="Lines a c b d e b become &quot;acb&quot; and &quot;deb&quot;"></span></p></td>
</tr>
</tbody>
</table>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The <code class="literal">after</code> setting is equivalent to <code class="literal">previous</code> in <a href="/guide/en/logstash/current/plugins-codecs-multiline.html" class="ulink" target="_top">Logstash</a>, and <code class="literal">before</code> is equivalent to <code class="literal">next</code>.</p>
</div>
</div>
<p><code class="literal">inputs.[].multiline.flush_pattern</code> specifies a regular expression, in which the current multiline will be flushed from memory, ending the multiline-message. Works only with <code class="literal">pattern</code> type.</p>
<p><code class="literal">inputs.[].multiline.max_lines</code> defines the maximum number of lines that can be combined into one event. If the multiline message contains more than <code class="literal">max_lines</code>, any additional lines are truncated from the event. The default is <code class="literal">500</code>.</p>
<p><code class="literal">inputs.[].multiline.max_bytes</code> defines the maximum number of bytes that can be combined into one event. If the multiline message contains more than <code class="literal">max_bytes</code>, any additional content is truncated from the event. The default is <code class="literal">10485760</code>.</p>
<p><code class="literal">inputs.[].multiline.count_lines</code> defines the number of lines to aggregate into a single event. Works only with <code class="literal">count</code> type.</p>
<p><code class="literal">inputs.[].multiline.skip_newline</code> defined whether multiline events must be concatenated, stripping the line separator. If set to <code class="literal">true</code>, the line separator will be stripped. The default is <code class="literal">false</code>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h5 class="title"><a id="aws-serverless-multiline-config-examples"></a>Examples of multiline configuration<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.3/docs/en/observability/aws-elastic-serverless-forwarder-configuration.asciidoc">edit</a></h5>
</div></div></div>
<p>The examples in this section cover the following use cases:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Combining a Java stack trace into a single event
</li>
<li class="listitem">
Combining C-style line continuations into a single event
</li>
<li class="listitem">
Combining multiple lines from time-stamped events
</li>
</ul>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h6 class="title"><a id="aws-serverless-multiline-config-example-java"></a>Java stack traces<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.3/docs/en/observability/aws-elastic-serverless-forwarder-configuration.asciidoc">edit</a></h6>
</div></div></div>
<p>Java stack traces consist of multiple lines, with each line after the initial line beginning with whitespace, as in this example:</p>
<div class="pre_wrapper lang-java">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-java">Exception in thread "main" java.lang.NullPointerException
        at com.example.myproject.Book.getTitle(Book.java:16)
        at com.example.myproject.Author.getBookTitles(Author.java:25)
        at com.example.myproject.Bootstrap.main(Bootstrap.java:14)</pre>
</div>
<p>This configuration merges any line that begins with whitespace up to the previous line:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">multiline:
  type: pattern
  pattern: '^\s'
  negate: false
  match: after</pre>
</div>
<p>This is a slightly more complex Java stack trace example:</p>
<div class="pre_wrapper lang-java">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-java">Exception in thread "main" java.lang.IllegalStateException: A book has a null property
       at com.example.myproject.Author.getBookIds(Author.java:38)
       at com.example.myproject.Bootstrap.main(Bootstrap.java:14)
Caused by: java.lang.NullPointerException
       at com.example.myproject.Book.getId(Book.java:22)
       at com.example.myproject.Author.getBookIds(Author.java:35)
       ... 1 more</pre>
</div>
<p>To consolidate these lines into a single event, use the following multiline configuration:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">multiline:
  type: pattern
  pattern: '^\s+(at|.{3})\s+\\b|^Caused by:'
  negate: false
  match: after</pre>
</div>
<p>In this example, the pattern matches and merges the following lines:
-   a line that begins with spaces followed by the word <code class="literal">at</code> or <code class="literal">...</code>
-   a line that begins with the words <code class="literal">Caused by:</code></p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>In Python’s string literals, <code class="literal">\b</code> is the backspace character (ASCII value 8). As raw strings are not used, Python would convert the <code class="literal">\b</code> to a backspace. In order for our regular expression to match as expected, you need to escape the backslash <code class="literal">\</code> in <code class="literal">\b</code> to <code class="literal">\\b</code>, which will produce the correct regular expression upon compiling.</p>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h6 class="title"><a id="aws-serverless-multiline-line-continuations"></a>Line continuations<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.3/docs/en/observability/aws-elastic-serverless-forwarder-configuration.asciidoc">edit</a></h6>
</div></div></div>
<p>Several programming languages use the backslash (<code class="literal">\</code>) character at the end of a line to denote that the line continues, as in this example:</p>
<div class="pre_wrapper lang-c">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-c">printf ("%10.10ld  \t %10.10ld \t %s\
  %f", w, x, y, z );</pre>
</div>
<p>To consolidate these lines into a single event, use the following multiline configuration:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">multiline:
  type: pattern
  pattern: '\\\\$'
  negate: false
  match: after</pre>
</div>
<p>This configuration merges any line that ends with the <code class="literal">\</code> character with the line that follows it.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Note that you should escape the opening backslash (<code class="literal">\</code>) twice in the regular expression, as raw strings are not used. Thus, <code class="literal">\\\\$</code> will produce the required regular expression upon compiling.</p>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h6 class="title"><a id="aws-serverless-multiline-timestamps"></a>Timestamps<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.3/docs/en/observability/aws-elastic-serverless-forwarder-configuration.asciidoc">edit</a></h6>
</div></div></div>
<p>Activity logs from services such as Elasticsearch typically begin with a timestamp, followed by information on the specific activity, as in this example:</p>
<div class="pre_wrapper lang-shell">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-shell">[2015-08-24 11:49:14,389][INFO ][env                      ] [Letha] using [1] data paths, mounts [[/
(/dev/disk1)]], net usable_space [34.5gb], net total_space [118.9gb], types [hfs]</pre>
</div>
<p>To consolidate these lines into a single event, use the following multiline configuration:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">multiline:
  type: pattern
  pattern: '^\\[[0-9]{4}-[0-9]{2}-[0-9]{2}'
  negate: true
  match: after</pre>
</div>
<p>This configuration uses the <code class="literal">negate: true</code> and <code class="literal">match: after</code> settings to specify that any line that does not match the specified pattern belongs to the previous line.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Note that you should escape the opening square bracket (<code class="literal">[</code>) in the regular expression, because it specifies a character class i.e. a set of characters that you wish to match. You also have to escape the backslash (<code class="literal">\</code>) used for escaping the opening square bracket as raw strings are not used. Thus, <code class="literal">^\\[</code> will produce the required regular expression upon compiling.</p>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h6 class="title"><a id="aws-serverless-multiline-application-events"></a>Application events<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.3/docs/en/observability/aws-elastic-serverless-forwarder-configuration.asciidoc">edit</a></h6>
</div></div></div>
<p>Sometimes your application logs contain events, that begin and end with custom markers, such as the following example:</p>
<div class="pre_wrapper lang-shell">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-shell">[2015-08-24 11:49:14,389] Start new event
[2015-08-24 11:49:14,395] Content of processing something
[2015-08-24 11:49:14,399] End event</pre>
</div>
<p>To consolidate these lines into a single event, use the following multiline configuration:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">multiline:
  type: pattern
  pattern: 'Start new event'
  negate: true
  match: after
  flush_pattern: 'End event'</pre>
</div>
<p>The <code class="literal">flush_pattern</code> option specifies a regex at which the current multiline will be flushed. If you think of the <code class="literal">pattern</code> option specifying the beginning of an event, the <code class="literal">flush_pattern</code> option will specify the end or last line of the event.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This example will not work correctly if start/end log blocks are mixed with non-multiline logs, or if different start/end log blocks overlap with each other. For instance, <code class="literal">Some other log</code> log lines in the following example will be merged into a <span class="strong strong"><strong>single</strong></span> multiline document because they neither match <code class="literal">inputs.[].multiline.pattern</code> nor <code class="literal">inputs.[].multiline.flush_pattern</code>, and <code class="literal">inputs.[].multiline.negate</code> is set to <code class="literal">true</code>.</p>
</div>
</div>
<div class="pre_wrapper lang-shell">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-shell">[2015-08-24 11:49:14,389] Start new event
[2015-08-24 11:49:14,395] Content of processing something
[2015-08-24 11:49:14,399] End event
[2015-08-24 11:50:14,389] Some other log
[2015-08-24 11:50:14,395] Some other log
[2015-08-24 11:50:14,399] Some other log
[2015-08-24 11:51:14,389] Start new event
[2015-08-24 11:51:14,395] Content of processing something
[2015-08-24 11:51:14,399] End event</pre>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h5 class="title"><a id="aws-serverless-multiline-test-regexp"></a>Test your regexp pattern for multiline<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.3/docs/en/observability/aws-elastic-serverless-forwarder-configuration.asciidoc">edit</a></h5>
</div></div></div>
<p>To make it easier for you to test the regexp patterns in your multiline config, you can use this <a href="https://replit.com/@AndreaSpacca/Multiline-Regexp-Test#main.py" class="ulink" target="_top">Multiline Regexp Test</a>:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Plug in the regexp pattern at line <code class="literal">3</code>, along with the <code class="literal">multiline.negate</code> setting that you plan to use at line <code class="literal">4</code>
</li>
<li class="listitem">
Paste a sample message between the three double quote delimiters (<code class="literal">""" """</code>) at line <code class="literal">5</code>
</li>
<li class="listitem">
Click <code class="literal">Run</code> to see which lines in the message match your specified configuration.
</li>
</ol>
</div>
<p class="screenshot"><span class="image"><img src="images/multiline-regexp-test-repl-main.png" alt="Add your test message to Multiline Regexp test"></span></p>
<p class="screenshot"><span class="image"><img src="images/multiline-regexp-test-repl-run.png" alt="View the test results"></span></p>
</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="aws-serverless-json-content.html">« JSON content discovery</a>
</span>
<span class="next">
<a href="aws-serverless-troubleshooting.html">Troubleshooting and error handling »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>

                        <!-- Feedback widget -->
                        <div id="feedbackWidgetContainer"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


        <div id='elastic-footer'></div>
        <script src='https://www.elastic.co/elastic-footer.js'></script>
        <!-- Footer Section end-->

      </section>
    </div>

    <!-- Feedback modal -->
    <div id="feedbackModalContainer"></div>

    <script src="/guide/static/jquery.js"></script>
    <script type="text/javascript" src="/guide/static/docs.js"></script>
    <script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
