<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Use Synthetics with traffic filters | Elastic Observability [8.9] | Elastic</title>
<meta class="elastic" name="content" content="Use Synthetics with traffic filters | Elastic Observability [8.9]">

<link rel="home" href="index.html" title="Elastic Observability [8.9]"/>
<link rel="up" href="monitor-uptime-synthetics.html" title="Synthetic monitoring"/>
<link rel="prev" href="synthetics-manage-retention.html" title="Manage data retention"/>
<link rel="next" href="synthetics-migrate-from-integration.html" title="Migrate from the Elastic Synthetics integration"/>
<meta class="elastic" name="product_version" content="8.9"/>
<meta class="elastic" name="product_name" content="Observability"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Observability/Guide/8.9"/>
<meta name="DC.subject" content="Observability"/>
<meta name="DC.identifier" content="8.9"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <!--© 2015-2022 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  <div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Observability [8.9]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="monitor-uptime-synthetics.html">Synthetic monitoring</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="synthetics-manage-retention.html">« Manage data retention</a>
</span>
<span class="next">
<a href="synthetics-migrate-from-integration.html">Migrate from the Elastic Synthetics integration »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="synthetics-traffic-filters"></a>Use Synthetics with traffic filters<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.9/docs/en/observability/synthetics-traffic-filters.asciidoc">edit</a></h2>
</div></div></div>
<p>If you are setting up Synthetics for a deployment configured with
<a href="/guide/en/cloud/current/ec-traffic-filtering-deployment-configuration.html" class="ulink" target="_top">traffic filters</a>,
none of your results will be visible in the Synthetics app until permission
to write the results to Elasticsearch is explicitly granted.</p>
<p>If you don&#8217;t configure the traffic filters, the tests will run,
but in the UI it will appear like they are not running because the results
cannot be written back to Elasticsearch.</p>
<h3><a id="_obtain_the_ip_address"></a>Obtain the IP address<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.9/docs/en/observability/synthetics-traffic-filters.asciidoc">edit</a></h3>
<p>The IP address or CIDR block of the hosts running the tests
need to be configured in your <a href="/guide/en/cloud/current/ec-traffic-filtering-ip.html" class="ulink" target="_top">Traffic filters</a>
to allow inbound connection into your Elasticsearch instance to store the results.</p>
<p>The IP addresses to be used depend on where the monitors are running, either
on Elastic&#8217;s global managed testing infrastructure or Private Locations.</p>
<h4><a id="_elastics_global_managed_testing_infrastructure"></a>Elastic&#8217;s global managed testing infrastructure<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.9/docs/en/observability/synthetics-traffic-filters.asciidoc">edit</a></h4>
<p>If you&#8217;re running tests on Elastic&#8217;s global managed testing infrastructure,
you can find the relevant IP CIDR block (a single address or /32 block for each region)
in  <a href="https://manifest.synthetics.elastic-cloud.com/v1/ip-ranges.json" class="ulink" target="_top">this list of egress IPs</a>.
This list is a JSON object that contains each region in Elastic&#8217;s global managed testing
infrastructure and the address that outbound connections will be made from.
These will be the connections into your Elasticsearch cluster.</p>
<p>For example, the <code class="literal">Europe - United Kingdom</code> region has the following entry:</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">"europe-west2-a": {
   "ip_prefix": ["34.89.88.187/32"],
   "name": "Europe - United Kingdom"
}</pre>
</div>
<p>To run tests from the <code class="literal">Europe - United Kingdom</code> region, you need to enable access
from the <code class="literal">34.89.88.187/32</code> CIDR block.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Note that as regions are added, this list will change.
Similarly existing region addresses are subject to change.</p>
</div>
</div>
<h4><a id="_private_locations"></a>Private Locations<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.9/docs/en/observability/synthetics-traffic-filters.asciidoc">edit</a></h4>
<p>If you&#8217;re running tests from <a class="xref" href="synthetics-private-location.html" title="Monitor resources on private networks">Private Locations</a>,
you will have the Elastic Agent installed on host machines that run the tests.
You need to obtain the address ranges for these machines.
This needs to be the IP address that the host is making the connection from
into the Elasticsearch cluster. This <em>might not</em> be the IP address bound to the
network interface of the host machine, but the proxy or other address based on
your network configuration.</p>
<h3><a id="_add_the_traffic_filter"></a>Add the traffic filter<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.9/docs/en/observability/synthetics-traffic-filters.asciidoc">edit</a></h3>
<p>Once you know the CIDR blocks for your testing sources, add them to your Elasticsearch deployment.
Find detailed instructions in the <a href="/guide/en/cloud/current/ec-traffic-filtering-ip.html" class="ulink" target="_top">IP traffic filters</a> docs.</p>
<p>For example, if you had a Private Location running with a public CIDR block of <code class="literal">1.2.3.4/32</code>
and were running tests from the <code class="literal">Europe - United Kingdom</code> region,
you would first create a traffic filter with the following:</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/synthetics-traffic-filters-create-filter.png" alt="Create a traffic filter in https://www.elastic.co/guide/en/cloud/current">
</div>
</div>
<p>Once the traffic filter has been created, it needs to be assigned to the deployment from which
you&#8217;re managing monitors from (the deployment containing the Elasticsearch cluster where your results need to go).</p>
</div>
<div class="navfooter">
<span class="prev">
<a href="synthetics-manage-retention.html">« Manage data retention</a>
</span>
<span class="next">
<a href="synthetics-migrate-from-integration.html">Migrate from the Elastic Synthetics integration »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
