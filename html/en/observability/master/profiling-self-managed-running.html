<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Step 4: Run the backend applications | Elastic Observability [master] | Elastic</title>
<meta class="elastic" name="content" content="Step 4: Run the backend applications | Elastic Observability [master]">

<link rel="home" href="index.html" title="Elastic Observability [master]"/>
<link rel="up" href="profiling-self-managed-installation.html" title="Install the backend"/>
<link rel="prev" href="profiling-self-managed-setup-kibana.html" title="Step 3: Set up Universal Profiling in Kibana"/>
<link rel="next" href="profiling-self-managed-install-next-steps.html" title="Step 5: Next steps"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="Observability"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Observability/Guide/master"/>
<meta name="DC.subject" content="Observability"/>
<meta name="DC.identifier" content="master"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles-v1.css" />
  </head>

  <!--© 2015-2025 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div class="page_header">
This documentation contains work-in-progress information for future Elastic Stack and Cloud releases. Use the version selector to view supported release docs. It also contains some Elastic Cloud serverless information. Check out our <a href="https://www.elastic.co/docs/current/serverless">serverless docs</a> for more details.
</div>
<div class="navheader">
<span class="prev">
<a href="profiling-self-managed-setup-kibana.html">« Step 3: Set up Universal Profiling in Kibana</a>
</span>
<span class="next">
<a href="profiling-self-managed-install-next-steps.html">Step 5: Next steps »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Observability [master]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="universal-profiling.html">Universal Profiling</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="profiling-self-managed.html">Run Universal Profiling on self-hosted Elastic stack</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="profiling-self-managed-installation.html">Install the backend</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Step 4: Run the backend applications</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/observability/profiling-self-managed.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="profiling-self-managed-running"></a>Step 4: Run the backend applications<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/observability/profiling-self-managed.asciidoc">edit</a></h4>
</div></div></div>
<p>The next step is to run the backend applications. To do this:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<a class="xref" href="profiling-self-managed-running.html#profiling-self-managed-create-api-keys" title="Create API keys">Create API keys</a> to authenticate the backend applications.
</li>
<li class="listitem">
Run the application on <a class="xref" href="profiling-self-managed-running.html#profiling-self-managed-running-linux" title="Run on Linux">Linux</a> or <a class="xref" href="profiling-self-managed-running.html#profiling-self-managed-running-kubernetes" title="Run on Kubernetes">Kubernetes</a>.
</li>
</ol>
</div>
<h4><a id="profiling-self-managed-create-api-keys"></a>Create API keys<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/observability/profiling-self-managed.asciidoc">edit</a></h4>
<p>Both the collector and symbolizer need to authenticate to Elasticsearch to process profiling data.
For this, you need to create an API key for each application.</p>
<p>Refer to <a href="/guide/en/kibana/master/api-keys.html#create-api-key" class="ulink" target="_top">Create an API key</a> to create an API key using Kibana.
Select a <span class="strong strong"><strong>User API key</strong></span> and assign the following permissions  under <span class="strong strong"><strong>Control security privileges</strong></span>:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
  "profiling": {
    "indices": [
      {
        "names": [
          "profiling-*"
        ],
        "privileges": [
          "read",
          "write"
        ]
      }
    ]
  }
}</pre>
</div>
<p>Store the "Encoded" version of the API keys, as you will need them to run the Universal Profiling backend.
Continue to <a class="xref" href="profiling-self-managed-running.html#profiling-self-managed-running-linux" title="Run on Linux">Run on Linux</a> or <a class="xref" href="profiling-self-managed-running.html#profiling-self-managed-running-kubernetes" title="Run on Kubernetes">Run on Kubernetes</a> for information on running the backend applications.</p>
<h4><a id="profiling-self-managed-running-linux"></a>Run on Linux<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/observability/profiling-self-managed.asciidoc">edit</a></h4>
<p>Before running the backend applications on Linux, we recommend creating <a class="xref" href="profiling-self-managed-running.html#profiling-self-managed-running-linux-configfile" title="Create configuration files">configuration files</a> to manage the applications.
CLI flags are also supported, but they might result in a more complex management of the backend applications.</p>
<p>Install the backend applications using one of the following options:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<a class="xref" href="profiling-self-managed-running.html#profiling-self-managed-install-os-packages" title="OS packages (DEB/RPM)">OS packages (DEB/RPM)</a>
</li>
<li class="listitem">
<a class="xref" href="profiling-self-managed-running.html#profiling-self-managed-running-linux-container" title="OCI containers">OCI containers</a>
</li>
<li class="listitem">
<a class="xref" href="profiling-self-managed-running.html#profiling-self-managed-running-linux-binary" title="Binary">Binary</a>: orchestrated with your configuration management system of choice (Ansible, Puppet, Chef, Salt, etc.)
</li>
</ol>
</div>
<h5><a id="profiling-self-managed-running-linux-configfile"></a>Create configuration files<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/observability/profiling-self-managed.asciidoc">edit</a></h5>
<p>The configuration files are in YAML format, and are composed of two top-level sections: an "application" section, and an "output" section.</p>
<p>The "application" section contains the configuration for the backend applications, and the "output" section contains the configuration to connect to where the data will be read and sent to.
The "application" section is named after the name of the binary.
The "output" section currently supports only Elasticsearch.</p>
<p>The configuration files are read from the following default locations:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Collector: <code class="literal">/etc/Elastic/universal-profiling/pf-elastic-collector.yml</code>
</li>
<li class="listitem">
Symbolizer: <code class="literal">/etc/Elastic/universal-profiling/pf-elastic-symbolizer.yml</code>
</li>
</ul>
</div>
<p>You can customize the location of the configuration files by using the <code class="literal">-c</code> flag when running the application.</p>
<p>For the sake of simplicity, we will use the default locations in the examples below.
We also display the default application settings; you can refer to the comments in the YAML to understand how to customize them.</p>
<h6><a id="profiling-self-managed-running-linux-configfile-collector"></a>Collector Configuration file<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/observability/profiling-self-managed.asciidoc">edit</a></h6>
<p>Copy the content of the snippet below in the <code class="literal">/etc/Elastic/universal-profiling/pf-elastic-collector.yml</code> file.</p>
<p>Customize the content of <code class="literal">pf-elastic-collector.auth.secret_token</code> with a secret token of your choice.
This token will be used by the Universal Profiling Agent to authenticate to the collector; you cannot use an empty string as a token.
Adjust the <code class="literal">ssl</code> section if you want to protect the collector&#8217;s endpoint with TLS.</p>
<p>Customize the content of the <code class="literal">output.elasticsearch</code> section, using the Elasticsearch endpoint and <a class="xref" href="profiling-self-managed-running.html#profiling-self-managed-create-api-keys" title="Create API keys">API key</a> to set the <code class="literal">hosts</code> and <code class="literal">api_key</code> values, respectively.
Adjust the <code class="literal">protocol</code> value and other TLS related settings as needed.</p>
<details>
<summary class="title">Collector configuration file</summary>
<div class="content">
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">pf-elastic-collector:
  # Defines the host and port the server is listening on.
  host: "0.0.0.0:8260"

  # Verbose log output option.
  #verbose: true

  # Configure metrics exposition. Both expvar and Prometheus formats are supported. Both can be
  # configured at the same time. By default, no metrics are exposed.
  # 'prometheus_host' can only be configured with a 'host:port' pair.
  # 'expvar_host' can be configured either with a 'host:port' pair or with a Unix Domain Socket path (with a  'unix://' prefix).
  # When host:port is used, an HTTP server is exposed. The server does not support TLS.
  # An empty value disables metrics exposition for the corresponding format.
  #metrics:
  #  prometheus_host: 'localhost:9090'
  #  expvar_host: unix:///tmp/collector-metrics.sock

  # Define the suggested upper limit of memory that pf-elastic-collector should apply. Using a lower
  # amount of memory might trigger garbage collection more often.
  #memory_limit: 500M

  # Agent authorization configuration. If no methods are defined, all requests will be allowed.
  auth:
    # Define a shared secret token for authorizing agents.
    secret_token: ""

  # Controls storage of Universal Profiling agent metrics/metadata to the customer's cluster and to a
  # cluster controlled by Elastic. By default, the full set of metrics and metadata is written to
  # an Elastic-controlled cluster, and a subset of metrics and metadata to the customer
  # cluster. These are used to monitor agent health and debug/resolve issues.
  agent_metrics:
    # Do not write Universal Profiling agent metrics/metadata to a centralized (non-customer controlled)
    # cluster. This does not affect writing metrics/metadata to the customer cluster.
    #disable: false

    # Write full set of Universal Profiling agent metrics to the customer ES cluster. If false, which
    # is the default, only a limited set of CPU usage and I/O metrics will be written.
    #write_all: false

  # Enable secure communication between pf-host-agent and pf-elastic-collector.
  ssl:
    enabled: false

    # Path to file containing the certificate for server authentication.
    # Needs to be configured when ssl is enabled.
    #certificate: ''

    # Path to file containing server certificate key.
    # Needs to be configured when ssl is enabled.
    #key: ''

    # Optional configuration options for ssl communication.

    # Passphrase for decrypting the Certificate Key.
    # It is recommended to use the provided keystore instead of entering the passphrase in plain text.
    #key_passphrase: ''

    # List of supported/valid protocol versions. By default TLS versions 1.3 is enabled.
    #supported_protocols: [TLSv1.3]

    # Configure cipher suites to be used for SSL connections.
    # Note that cipher suites are not configurable for TLS 1.3.
    #cipher_suites: []

    # Configure curve types for ECDHE based cipher suites.
    #curve_types: []

#================================ Outputs =================================

# Configure the output to use when sending the data collected by pf-elastic-collector.

#-------------------------- Elasticsearch output --------------------------
output:
  elasticsearch:
    # Array of hosts to connect to.
    # Scheme and port can be left out and will be set to the default (`http` and `9200`).
    # In case you specify an additional path, the scheme is required: `http://localhost:9200/path`.
    # IPv6 addresses should always be defined as: `https://[2001:db8::1]:9200`.
    hosts: ["localhost:9200"]

    # Set gzip compression level.
    #compression_level: 0

    # Protocol - either `http` (default) or `https`.
    protocol: "https"

    # Authentication credentials - either API key or username/password.
    #api_key: "id:api_key"

    # Optional HTTP Path.
    #path: "/elasticsearch"

    # Proxy server url.
    #proxy_url: http://proxy:3128

    # The number of times a particular Elasticsearch index operation is attempted. If
    # the indexing operation doesn't succeed after this many retries, the events are
    # dropped. The default is 3.
    #max_retries: 3

    # Enable custom SSL settings. Set to false to ignore custom SSL settings for secure communication.
    #ssl.enabled: true

    # Optional SSL configuration options. SSL is off by default, change the `protocol` option if you want to enable `https`.
    #
    # Control the verification of Elasticsearch certificates. Valid values are:
    # * full, which verifies that the provided certificate is signed by a trusted
    # authority (CA) and also verifies that the server's hostname (or IP address)
    # matches the names identified within the certificate.
    # * strict, which verifies that the provided certificate is signed by a trusted
    # authority (CA) and also verifies that the server's hostname (or IP address)
    # matches the names identified within the certificate. If the Subject Alternative
    # Name is empty, it returns an error.
    # * certificate, which verifies that the provided certificate is signed by a
    # trusted authority (CA), but does not perform any hostname verification.
    #  * none, which performs no verification of the server's certificate. This
    # mode disables many of the security benefits of SSL/TLS and should only be used
    # after very careful consideration. It is primarily intended as a temporary
    # diagnostic mechanism when attempting to resolve TLS errors; its use in
    # production environments is strongly discouraged.
    #ssl.verification_mode: full

    # List of supported/valid TLS versions. By default all TLS versions 1.0 up to
    # 1.2 are enabled.
    #ssl.supported_protocols: [TLSv1.0, TLSv1.1, TLSv1.2]

    # List of root certificates for HTTPS server verifications.
    #ssl.certificate_authorities: ["/etc/pki/root/ca.pem"]

    # Certificate for SSL client authentication.
    #ssl.certificate: "/etc/pki/client/cert.pem"

    # Client Certificate Key
    #ssl.key: "/etc/pki/client/cert.key"

    # Optional passphrase for decrypting the Certificate Key.
    # It is recommended to use the provided keystore instead of entering the passphrase in plain text.
    #ssl.key_passphrase: ''

    # Configure cipher suites to be used for SSL connections.
    #ssl.cipher_suites: []

    # Configure curve types for ECDHE based cipher suites.
    #ssl.curve_types: []

    # Configure what types of renegotiation are supported. Valid options are
    # never, once, and freely. Default is never.
    #ssl.renegotiation: never</pre>
</div>
</div>
</details>
<h6><a id="profiling-self-managed-running-linux-configfile-symbolizer"></a>Symbolizer Configuration file<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/observability/profiling-self-managed.asciidoc">edit</a></h6>
<p>Copy the content of the snippet below in the <code class="literal">/etc/Elastic/universal-profiling/pf-elastic-symbolizer.yml</code> file.</p>
<p>You don&#8217;t need to customize any values in the <code class="literal">pf-elastic-symbolizer</code> section.
Adjust the <code class="literal">ssl</code> section if you want to protect the symbolizer&#8217;s endpoint with TLS.</p>
<p>Customize the content of the <code class="literal">output.elasticsearch</code> section, using the Elasticsearch endpoint and <a class="xref" href="profiling-self-managed-running.html#profiling-self-managed-create-api-keys" title="Create API keys">API key</a> to set the <code class="literal">hosts</code> and <code class="literal">api_key</code> values, respectively.
Adjust the <code class="literal">protocol</code> value and other TLS related settings as needed.</p>
<details>
<summary class="title">Symbolizer configuration file</summary>
<div class="content">
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">pf-elastic-symbolizer:
  # Defines the host and port the server is listening on.
  host: "0.0.0.0:8240"

  # Endpoint for the service to connect to and query for software packages.
  # Do not set this value unless you are running a local instance of the debug symbols mirror.
  endpoint: ""

  # Verbose log output option. (default: false)
  #verbose: true

  # Configure metrics exposition. Both expvar and Prometheus formats are supported. Both can be
  # configured at the same time. By default, no metrics are exposed.
  # 'prometheus_host' can only be configured with a 'host:port' pair.
  # 'expvar_host' can be configured either with a 'host:port' pair or with a Unix Domain Socket path (with a  'unix://' prefix).
  # When host:port is used, an HTTP server is exposed. The server does not support TLS.
  # An empty value disables metrics exposition for the corresponding format.
  #metrics:
  #  prometheus_host: 'localhost:9090'
  #  expvar_host: unix:///tmp/collector-metrics.sock

  # Define the suggested upper limit of memory that pf-elastic-symbolizer should apply. Using a lower
  # amount of memory might trigger garbage collection more often. (default: 200MB)
  #memory_limit: 500M

  # Enable secure communication between symbtool and pf-elastic-symbolizer.
  ssl:
    enabled: false

    # Path to file containing the certificate for server authentication.
    # Needs to be configured when ssl is enabled.
    #certificate: ''

    # Path to file containing server certificate key.
    # Needs to be configured when ssl is enabled.
    #key: ''

    # Optional configuration options for ssl communication.

    # Passphrase for decrypting the Certificate Key.
    # It is recommended to use the provided keystore instead of entering the passphrase in plain text.
    #key_passphrase: ''

    # List of supported/valid protocol versions. By default TLS versions 1.1 up to 1.3 are enabled.
    #supported_protocols: [TLSv1.1, TLSv1.2, TLSv1.3]

    # Configure cipher suites to be used for SSL connections.
    # Note that cipher suites are not configurable for TLS 1.3.
    #cipher_suites: []

    # Configure curve types for ECDHE based cipher suites.
    #curve_types: []

#================================ Outputs =================================

# Configure the output to use when sending the data collected by pf-elastic-symbolizer.

#-------------------------- Elasticsearch output --------------------------
output:
  elasticsearch:
    # Array of hosts to connect to.
    # Scheme and port can be left out and will be set to the default (`http` and `9200`).
    # In case you specify an additional path, the scheme is required: `http://localhost:9200/path`.
    # IPv6 addresses should always be defined as: `https://[2001:db8::1]:9200`.
    hosts: ["localhost:9200"]

    # Set gzip compression level.
    #compression_level: 0

    # Protocol - either `http` (default) or `https`.
    protocol: "https"

    # Authentication credentials - either API key or username/password.
    #api_key: "id:api_key"

    # Optional HTTP Path.
    #path: "/elasticsearch"

    # Proxy server url.
    #proxy_url: http://proxy:3128

    # The number of times a particular Elasticsearch index operation is attempted. If
    # the indexing operation doesn't succeed after this many retries, the events are
    # dropped. The default is 3.
    #max_retries: 3

    # Enable custom SSL settings. Set to false to ignore custom SSL settings for secure communication.
    #ssl.enabled: true

    # Optional SSL configuration options. SSL is off by default, change the `protocol` option if you want to enable `https`.
    #
    # Control the verification of Elasticsearch certificates. Valid values are:
    # * full, which verifies that the provided certificate is signed by a trusted
    # authority (CA) and also verifies that the server's hostname (or IP address)
    # matches the names identified within the certificate.
    # * strict, which verifies that the provided certificate is signed by a trusted
    # authority (CA) and also verifies that the server's hostname (or IP address)
    # matches the names identified within the certificate. If the Subject Alternative
    # Name is empty, it returns an error.
    # * certificate, which verifies that the provided certificate is signed by a
    # trusted authority (CA), but does not perform any hostname verification.
    #  * none, which performs no verification of the server's certificate. This
    # mode disables many of the security benefits of SSL/TLS and should only be used
    # after very careful consideration. It is primarily intended as a temporary
    # diagnostic mechanism when attempting to resolve TLS errors; its use in
    # production environments is strongly discouraged.
    #ssl.verification_mode: full

    # List of supported/valid TLS versions. By default all TLS versions 1.0 up to
    # 1.2 are enabled.
    #ssl.supported_protocols: [TLSv1.0, TLSv1.1, TLSv1.2]

    # List of root certificates for HTTPS server verifications.
    #ssl.certificate_authorities: ["/etc/pki/root/ca.pem"]

    # Certificate for SSL client authentication.
    #ssl.certificate: "/etc/pki/client/cert.pem"

    # Client Certificate Key
    #ssl.key: "/etc/pki/client/cert.key"

    # Optional passphrase for decrypting the Certificate Key.
    # It is recommended to use the provided keystore instead of entering the passphrase in plain text.
    #ssl.key_passphrase: ''

    # Configure cipher suites to be used for SSL connections.
    #ssl.cipher_suites: []

    # Configure curve types for ECDHE based cipher suites.
    #ssl.curve_types: []

    # Configure what types of renegotiation are supported. Valid options are
    # never, once, and freely. Default is never.
    #ssl.renegotiation: never</pre>
</div>
</div>
</details>
<h5><a id="profiling-self-managed-install-os-packages"></a>OS packages (DEB/RPM)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/observability/profiling-self-managed.asciidoc">edit</a></h5>
<p>Follow these steps to install the backend using OS packages.</p>
<h6><a id="profiling-run-backend-deb"></a>DEB packages<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/observability/profiling-self-managed.asciidoc">edit</a></h6>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Configure the APT repository:</p>
<div class="pre_wrapper lang-shell">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-shell">wget -qO - https://artifacts.elastic.co/GPG-KEY-elasticsearch | sudo apt-key add -
sudo apt-get install apt-transport-https
echo "deb https://artifacts.elastic.co/packages/8.x/apt stable main" | sudo tee -a /etc/apt/sources.list.d/elastic-8.x.list</pre>
</div>
</li>
<li class="listitem">
<p>Install the packages:</p>
<div class="pre_wrapper lang-shell">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-shell">sudo apt update
sudo apt install -y pf-elastic-collector pf-elastic-symbolizer</pre>
</div>
</li>
</ol>
</div>
<h6><a id="profiling-run-backend-rpm"></a>RPM packages<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/observability/profiling-self-managed.asciidoc">edit</a></h6>
<p>For RPM packages, configure the YUM repository and install the packages:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Download and install the public signing key:</p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">sudo rpm --import https://packages.elastic.co/GPG-KEY-elasticsearch</pre>
</div>
</li>
<li class="listitem">
<p>Create a file with a <code class="literal">.repo</code> extension (for example, <code class="literal">elastic.repo</code>) in your <code class="literal">/etc/yum.repos.d/</code> directory and add the following lines:</p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">[elastic-8.x]
name=Elastic repository for 8.x packages
baseurl=https://artifacts.elastic.co/packages/8.x/yum
gpgcheck=1
gpgkey=https://artifacts.elastic.co/GPG-KEY-elasticsearch
enabled=1
autorefresh=1
type=rpm-md</pre>
</div>
</li>
<li class="listitem">
<p>Install the backend services by running:</p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">sudo yum update
sudo yum install -y pf-elastic-collector pf-elastic-symbolizer</pre>
</div>
</li>
</ol>
</div>
<h6><a id="_run_the_services"></a>Run the services<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/observability/profiling-self-managed.asciidoc">edit</a></h6>
<p>After installing the packages, enable and start the systemd services:</p>
<div class="pre_wrapper lang-shell">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-shell">sudo systemctl enable pf-elastic-collector
sudo systemctl start pf-elastic-collector

sudo systemctl enable pf-elastic-symbolizer
sudo systemctl start pf-elastic-symbolizer</pre>
</div>
<p>Now you can check the services' logs to spot any problems:</p>
<div class="pre_wrapper lang-shell">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-shell">sudo journalctl -xu pf-elastic-collector
sudo journalctl -xu pf-elastic-symbolizer</pre>
</div>
<p>Refer to <a class="xref" href="profiling-self-managed-troubleshooting.html" title="Troubleshoot the Universal Profiling backend">Troubleshooting Universal Profiling backend</a> for more information on troubleshooting possible errors in the logs.</p>
<h6><a id="profiling-self-managed-running-linux-container"></a>OCI containers<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/observability/profiling-self-managed.asciidoc">edit</a></h6>
<p>We provide OCI images in the Elastic registry to run the backend services in containers.
The images are multi-platform, so they both work on x86_64 and ARM64 architectures.</p>
<p>With the config file in place in your system, you can run the containers with the following commands (the example command uses Docker, but any OCI runtime will work):</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Collector:</p>
<div class="pre_wrapper lang-shell">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-shell">docker run -d --name pf-elastic-collector -p 8260:8260 -v /etc/Elastic/universal-profiling/pf-elastic-collector.yml:/pf-elastic-collector.yml:ro \
  docker.elastic.co/observability/profiling-collector:{version} -c /pf-elastic-collector.yml</pre>
</div>
</li>
<li class="listitem">
<p>Symbolizer:</p>
<div class="pre_wrapper lang-shell">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-shell">docker run -d --name pf-elastic-symbolizer -p 8240:8240 -v /etc/Elastic/universal-profiling/pf-elastic-symbolizer.yml:/pf-elastic-symbolizer.yml:ro \
  docker.elastic.co/observability/profiling-symbolizer:{version} -c /pf-elastic-symbolizer.yml</pre>
</div>
</li>
</ol>
</div>
<p>With the above commands, the backend containers will serve the HTTP endpoints on the host ports 8260 and 8240, respectively.
We provided the <code class="literal">-v</code> flag to mount the configuration files in the containers, and then we used the <code class="literal">-c</code> flag to tell the applications to read the configuration files from the mounted path.</p>
<p>Container processes will be running in the background, you can check the logs with <code class="literal">docker logs &lt;container_name&gt;</code>, e.g.</p>
<div class="pre_wrapper lang-shell">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-shell">docker logs pf-elastic-collector
docker logs pf-elastic-symbolizer</pre>
</div>
<h6><a id="profiling-self-managed-running-linux-binary"></a>Binary<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/observability/profiling-self-managed.asciidoc">edit</a></h6>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Download and unpack the binaries for your platform:</p>
<p>For x86_64</p>
<div class="pre_wrapper lang-shell">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-shell">wget -O- "https://artifacts.elastic.co/downloads/prodfiler/pf-elastic-collector-8.16.0-linux-x86_64.tar.gz" | tar xzf -
wget -O- "https://artifacts.elastic.co/downloads/prodfiler/pf-elastic-symbolizer-8.16.0-linux-x86_64.tar.gz" | tar xzf -</pre>
</div>
<p>For ARM64</p>
<div class="pre_wrapper lang-shell">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-shell">wget -O- "https://artifacts.elastic.co/downloads/prodfiler/pf-elastic-collector-8.16.0-linux-arm64.tar.gz" | tar xzf -
wget -O- "https://artifacts.elastic.co/downloads/prodfiler/pf-elastic-symbolizer-8.16.0-linux-arm64.tar.gz" | tar xzf -</pre>
</div>
</li>
<li class="listitem">
Copy the <code class="literal">pf-elastic-collector</code> and <code class="literal">pf-elastic-symbolizer</code> binaries to a directory in the machine&#8217;s <code class="literal">PATH</code>.
</li>
<li class="listitem">
<p>Run the backend application processes, instructing them to read the configuration files created previously.</p>
<div class="pre_wrapper lang-shell">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-shell">pf-elastic-collector -c /etc/Elastic/universal-profiling/pf-elastic-collector.yml
pf-elastic-symbolizer -c /etc/Elastic/universal-profiling/pf-elastic-symbolizer.yml</pre>
</div>
</li>
</ol>
</div>
<p>If you want to customize configuration options passed to the binaries, you can use command line flags. All overrides are specified using the <code class="literal">-E</code> flag.
For example, if you want to override the <code class="literal">host</code> value for the <code class="literal">pf-elastic-collector</code> application, you can use the <code class="literal">-E pf-elastic-collector.host</code> flag as follows:</p>
<div class="pre_wrapper lang-shell">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-shell">pf-elastic-collector -c /etc/Elastic/universal-profiling/pf-elastic-collector.yml -E pf-elastic-collector.host=0.0.0.0:8844</pre>
</div>
<p>In the previous example, we configured the collector to listen on all network interfaces on port 8844, instead of the 8260 value contained in the YAML configuration file.</p>
<p>You can use the <code class="literal">-E</code> flag to override any values contained in the configuration files, as lng as you specify the full YAML path on the command line flag.
We recommend sticking with the configuration files for simpler orchestration.</p>
<p>The same configuration overrides and recommendations apply to the <code class="literal">pf-elastic-symbolizer</code> binary.</p>
<h4><a id="profiling-self-managed-running-kubernetes"></a>Run on Kubernetes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/observability/profiling-self-managed.asciidoc">edit</a></h4>
<p>We provide <a href="https://helm.io" class="ulink" target="_top">Helm</a> charts to deploy the backend services on Kubernetes.</p>
<p>To install the backend services, you need to add the Elastic Helm repository to your Helm installation and then install the charts.</p>
<p>We recommend creating a <code class="literal">values.yaml</code> file defining the Kubernetes-specific options of the chart. If you want to stick with the default values provided by the chart, you don&#8217;t need to create a <code class="literal">values.yaml</code> file for each chart.
For the applications' configuration, you can reuse the configuration files detailed in <a class="xref" href="profiling-self-managed-running.html#profiling-self-managed-running-linux-configfile" title="Create configuration files">"Create configuration files"</a> and pass them to Helm as a values file (using the <code class="literal">--values</code> of <code class="literal">-f</code> flags), or copy them in the <code class="literal">values.yaml</code> file.</p>
<p>In the example below we don&#8217;t apply any modifications to the Kubernetes configs, so we will use the default values provided by the chart.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Install and update the Elastic Helm registry:</p>
<div class="pre_wrapper lang-shell">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-shell">helm repo add elastic https://helm.elastic.co
helm repo update elastic</pre>
</div>
</li>
<li class="listitem">
<p>Install the charts (we are using the <code class="literal">universal-profiling</code> namespace, but you can customize at will):</p>
<div class="pre_wrapper lang-shell">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-shell">helm install --create-namespace -n universal-profiling collector elastic/profiling-collector -f /etc/Elastic/universal-profiling/pf-elastic-collector.yml
helm install --create-namespace -n universal-profiling symbolizer elastic/profiling-symbolizer -f /etc/Elastic/universal-profiling/pf-elastic-symbolizer.yml</pre>
</div>
</li>
<li class="listitem">
Check the pods are running and read their logs, by following the steps listed in the output of the <code class="literal">helm install</code> commands.
</li>
</ol>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>In the previous examples, we used the charts' default values to configure Kubernetes resources. These <span class="strong strong"><strong>do not</strong></span> include the creation of an <code class="literal">Ingress</code> resource.
If you want to expose the services to an Universal Profiling Agent and symbtool deployment outside the Kubernetes cluster, you need to set up the <code class="literal">ingress</code> section of each chart.</p>
</div>
</div>
<p>Continue to <a class="xref" href="profiling-self-managed-install-next-steps.html" title="Step 5: Next steps">Step 5: Next steps</a>.</p>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="profiling-self-managed-setup-kibana.html">« Step 3: Set up Universal Profiling in Kibana</a>
</span>
<span class="next">
<a href="profiling-self-managed-install-next-steps.html">Step 5: Next steps »</a>
</span>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>

                        <!-- Feedback widget -->
                        <div id="feedbackWidgetContainer"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


        <div id='elastic-footer'></div>
        <script src='https://www.elastic.co/elastic-footer.js'></script>
        <!-- Footer Section end-->

      </section>
    </div>

    <!-- Feedback modal -->
    <div id="feedbackModalContainer"></div>

    <script src="/guide/static/jquery.js"></script>
    <script type="text/javascript" src="/guide/static/docs-v1.js"></script>
    <script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
