<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<meta name="keywords" content="search-bar-in-header">
<title>Elasticsearch Connector | Search UI | Elastic</title>
<meta class="elastic" name="content" content="Elasticsearch Connector | Search UI">

<link rel="home" href="index.html" title="Search UI"/>
<link rel="up" href="api-connectors-app-search.html" title="App Search Connector"/>
<link rel="prev" href="api-connectors-workplace-search.html" title="Workplace Search Connector"/>
<link rel="next" href="api-core-plugins-analytics-plugin.html" title="Analytics Plugin"/>
<meta class="elastic" name="product_version" content="main"/>
<meta class="elastic" name="product_name" content="Search UI"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Search UI/Guide"/>
<meta name="DC.subject" content="Search UI"/>
<meta name="DC.identifier" content="main"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles-v1.css" />
  </head>

  <!--© 2015-2025 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div class="navheader">
<span class="prev">
<a href="api-connectors-workplace-search.html">« Workplace Search Connector</a>
</span>
<span class="next">
<a href="api-core-plugins-analytics-plugin.html">Analytics Plugin »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Search UI</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="api-architecture.html">Architecture</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="api-connectors-app-search.html">App Search Connector</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Elasticsearch Connector</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/search-ui/edit/main/docs/api-connectors-elasticsearch.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="api-connectors-elasticsearch"></a>Elasticsearch Connector</h3><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/search-ui/edit/main/docs/api-connectors-elasticsearch.asciidoc">edit</a></div>
</div></div></div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p class="admon_title">Technical preview</p>
<p>Elasticsearch connector for Search UI is currently in technical preview
status. It is not ready for production use.</p>
</div>
</div>
<p>Search UI provides a way to connect to Elasticsearch directly without needing Enterprise Search. This is useful for when you dont need the features of Enterprise Search, such as relevance tuning.</p>
<p>The connector uses the same Search UI configuration that other connectors use.</p>
<p>You must specify either the cloud id or on-premise host url for the Elasticsearch connector.</p>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">import ElasticsearchAPIConnector from "@elastic/search-ui-elasticsearch-connector";

const connector = new ElasticsearchAPIConnector({
  // Either specify the cloud id or host to connect to elasticsearch
  cloud: {
    id: "&lt;elastic-cloud-id&gt;" // cloud id found under your cloud deployment overview page
  },
  host: "http://localhost:9200", // host url for the Elasticsearch instance
  index: "&lt;index-name&gt;", // index name where the search documents are contained
  apiKey: "&lt;api-key&gt;", // Optional. apiKey used to authorize a connection to Elasticsearch instance.
  // This key will be visible to everyone so ensure its setup with restricted privileges.
  // See Authentication section for more details.
  connectionOptions: {
    // Optional connection options.
    headers: {
      "x-custom-header": "value" // Optional. Specify custom headers to send with the request
    }
  }
});</pre>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Param</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>cloud</p></td>
<td align="left" valign="top"><p>Required if <code class="literal">host</code> not provided. Object type. The cloud id for the deployment within elastic cloud.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host</p></td>
<td align="left" valign="top"><p>Required if <code class="literal">cloud</code> not provided. String type. The host url to the Elasticsearch instance</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>index</p></td>
<td align="left" valign="top"><p>Required. String type. The search index name</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>apiKey</p></td>
<td align="left" valign="top"><p>Optional. a credential used to access the Elasticsearch instance. See <a class="xref" href="api-connectors-elasticsearch.html#api-connectors-elasticsearch-connection-and-authentication" title="Connection &amp; Authentication">Connection &amp; Authentication</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>connectionOptions</p></td>
<td align="left" valign="top"><p>Optional. Object containing <code class="literal">headers</code> dictionary of header name to header value.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="position-relative"><h5><a id="api-connectors-elasticsearch-differences-between-app-search-and-elasticsearch-connector"></a>Differences between App Search and Elasticsearch connector</h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/search-ui/edit/main/docs/api-connectors-elasticsearch.asciidoc">edit</a></div>
<div class="position-relative"><h6><a id="api-connectors-elasticsearch-applying-filters-to-range-facets"></a>Applying Filters to Range Facets</h6><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/search-ui/edit/main/docs/api-connectors-elasticsearch.asciidoc">edit</a></div>
<p>Elasticsearch connector differs in the way filters can be applied to facets. Currently its not possible to apply an explicit range filter to range facets. Elasticsearch connector uses the name thats been given to the option to apply the filter. It uses this name to match the option and creates a the range filter query for the option.</p>
<div class="position-relative"><h7><a id="api-connectors-elasticsearch-example-facet-configuration"></a>Example Facet Configuration</h7><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/search-ui/edit/main/docs/api-connectors-elasticsearch.asciidoc">edit</a></div>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">{
  visitors: {
    type: "range",
    ranges: [
      { from: 0, to: 10000, name: "0 - 10000" },
      { from: 10001, to: 100000, name: "10001 - 100000" },
      { from: 100001, to: 500000, name: "100001 - 500000" },
      { from: 500001, to: 1000000, name: "500001 - 1000000" },
      { from: 1000001, to: 5000000, name: "1000001 - 5000000" },
      { from: 5000001, to: 10000000, name: "5000001 - 10000000" },
      { from: 10000001, name: "10000001+" }
    ]
  }
}</pre>
</div>
<div class="position-relative"><h7><a id="api-connectors-elasticsearch-how-to-apply-the-filter"></a>How to apply the filter</h7><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/search-ui/edit/main/docs/api-connectors-elasticsearch.asciidoc">edit</a></div>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">    setFilter("visitors", {
      name: "10001 - 100000", // name of the option
      from: 10001, // both from and to will be ignored
      to: 100000
    });</pre>
</div>
<div class="position-relative"><h7><a id="api-connectors-elasticsearch-applying-a-range-to-a-field-that-isnt-a-facet"></a>Applying a range to a field that isn&#8217;t a facet</h7><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/search-ui/edit/main/docs/api-connectors-elasticsearch.asciidoc">edit</a></div>
<p>If the field isn&#8217;t a facet, you will be able to apply filters to the search using <code class="literal">value</code>, <code class="literal">numeric range</code> and <code class="literal">date range</code>, depending on the field type.</p>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">    setFilter("precio", {
      name: "precio",
      from: rangePrices[0],
      to: rangePrices[1],
    });</pre>
</div>
<div class="position-relative"><h6><a id="api-connectors-elasticsearch-none-filter-type"></a><em>None</em> Filter Type</h6><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/search-ui/edit/main/docs/api-connectors-elasticsearch.asciidoc">edit</a></div>
<p>Currently the None filter type is not supported. If this is a feature thats needed, please mention it in this <a href="https://github.com/elastic/search-ui/issues/783" class="ulink" target="_top">issue</a>.</p>
<div class="position-relative"><h5><a id="api-connectors-elasticsearch-connection-and-authentication"></a>Connection &amp; Authentication</h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/search-ui/edit/main/docs/api-connectors-elasticsearch.asciidoc">edit</a></div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p class="admon_title">A note about security</p>
<p>This connector will talk to the Elasticsearch instance directly from the
browser. We <span class="strong strong"><strong>strongly</strong></span> suggest you take additional steps to keep your
Elasticsearch instance as secure as possible.</p>
</div>
</div>
<p>You have the following options available to you for securely exposing your Elasticsearch instance to the internet:</p>
<div class="position-relative"><h6><a id="api-connectors-elasticsearch-proxy-the-_search-api-call-through-your-api"></a>Proxy the _search API call through your API</h6><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/search-ui/edit/main/docs/api-connectors-elasticsearch.asciidoc">edit</a></div>
<p>This envolves building an API route that will proxy the Elasticsearch call through your API. During the proxy, you are able to:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Ability to add any additional authentication headers / keys as you proxy the request through the API and to Elasticsearch.
</li>
<li class="listitem">
Update the Elasticsearch query request to add any filters to filter restricted documents
</li>
<li class="listitem">
Application performance monitoring of functionality
</li>
<li class="listitem">
Your own user based authentication for your API
</li>
<li class="listitem">
Add a caching layer between the API and Elasticsearch
</li>
</ul>
</div>
<p>The connector will perform a <code class="literal">_search</code> query and will derive the endpoint path with the host and index. With <code class="literal">http://localhost:9200</code> host and <code class="literal">search-ui-example</code> index, the endpoint path will be <code class="literal">http://localhost:9200/search-ui-example/_search</code>. The connector will make a POST call with the elasticsearch query in the body of the request. To proxy the request through your API, you need to implement a route and update the connector&#8217;s settings to use the proxy route.</p>
<div class="position-relative"><h6><a id="api-connectors-elasticsearch-use-an-elasticsearch-api-key"></a>Use an Elasticsearch api-key</h6><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/search-ui/edit/main/docs/api-connectors-elasticsearch.asciidoc">edit</a></div>
<p>You can restrict access to indices by using an API key. We recommend you create an apiKey that is restricted to the particular index and has read-only authorization. See <a href="/guide/en/kibana/8.17/api-keys.html" class="ulink" target="_top">Kibana API keys guide</a>. To use the API key, place it within the Elasticsearch connection configuration.</p>
<div class="position-relative"><h5><a id="api-connectors-elasticsearch-autocomplete"></a>Autocomplete</h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/search-ui/edit/main/docs/api-connectors-elasticsearch.asciidoc">edit</a></div>
<p>Search UI supports autocomplete functionality to suggest search terms that provide results. The autocomplete functionality is built on top of the Elasticsearch <code class="literal">suggest</code> and <code class="literal">bool prefix query</code> API.</p>
<p>To take advantage of the feature, first update the <a class="xref" href="api-core-configuration.html#api-core-configuration-autocomplete-query" title="Autocomplete Query">autocomplete query</a> configuration.</p>
<p>Below is an example of what the <code class="literal">autocompleteQuery</code> may look like.</p>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">autocompleteQuery: {
  // performs a prefix search on the query
  results: {
    resultsPerPage: 5, // number of results to display. Default is 5.
    search_fields: {
      // the fields to prefix search on
      title_suggest: {}
    },
    result_fields: {
      // Add snippet highlighting within autocomplete suggestions
      title: { snippet: { size: 100, fallback: true }},
      nps_link: { raw: {} }
    }
  },
  // performs a query to suggest for values that partially match the incomplete query
  suggestions: {
    types: {
      // Limit query to only suggest based on "title" field
      documents: {  fields: ["title_completion"] }
    },
    // Limit the number of suggestions returned from the server
    size: 4
  }
}</pre>
</div>
<p>Above we are configuring both the <code class="literal">results</code> and <code class="literal">suggestions</code> sections of the autocomplete query.</p>
<p><code class="literal">results</code> will need a search field to perform a prefix search on the query. We advise using a <code class="literal">search_as_you_type</code> field to be used.
<code class="literal">suggestions</code> require a <code class="literal">completion</code> type field to perform a query to suggest for values that partially match the incomplete query.</p>
<p>Below is an example of the mappings for the above example. <code class="literal">title_suggest</code> is a <code class="literal">search_as_you_type</code> field and <code class="literal">title_completion</code> is a <code class="literal">completion</code> type field.</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
  "mappings": {
    "properties": {
      "title_suggest": {
        "type": "search_as_you_type"
      },
      "title_completion": {
        "type": "completion"
      }
    }
  }
}</pre>
</div>
<p>With a combination of this configuration + the <a class="xref" href="api-react-components-search-box.html" title="SearchBox">Searchbox</a> component with autocomplete configuration, your users will be able to see suggestions as they type within the search box.</p>
<div class="position-relative"><h5><a id="api-connectors-elasticsearch-nodejs-integration"></a>Node.js Integration</h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/search-ui/edit/main/docs/api-connectors-elasticsearch.asciidoc">edit</a></div>
<p>The Elasticsearch API Connector builds the Elasticsearch query and performs the request directly to Elasticsearch from the browser. Depending on what you&#8217;re building, you may want this logic to be done on the server and provide your clients a simplified API.</p>
<p>First step is to implement two routes to handle <code class="literal">search</code> and <code class="literal">autocomplete</code> requests. In example below, we are using express.js framework to implement these http routes within node.js.</p>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">// index.js

var express = require("express");
var APIConnector =
  require("@elastic/search-ui-elasticsearch-connector").default;
require("cross-fetch/polyfill");

var app = express();

app.use(express.json());
app.use(express.urlencoded({ extended: false }));

const connector = new APIConnector({
  host: "http://localhost:9200", // host url for the Elasticsearch instance
  index: "search-ui-examples", // index name where the search documents are contained
  apiKey: "apiKeyExample" // Optional. apiKey used to authorize a connection to Elasticsearch instance.
});

app.post("/search", async (req, res) =&gt; {
  const { query, options } = req.body;
  const response = await connector.onSearch(query, options);
  res.json(response);
});

app.post("/autocomplete", async (req, res) =&gt; {
  const { query, options } = req.body;
  const response = await connector.onAutocomplete(query, options);
  res.json(response);
});

var listener = app.listen(8080, function () {
  console.log("Listening on port " + listener.address().port);
});</pre>
</div>
<p>Next, you can add a simple connector which passes the configuration and query from the client to the server.</p>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">class CustomConnector {
  constructor(host) {
    this.host = host;
  }

  async onSearch(query, options) {
    const response = await fetch(this.host + "/search", {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        query,
        options
      })
    });
    return response.json();
  }

  async onAutocomplete(query, options) {
    const response = await fetch(this.host + "/autocomplete", {
      method: "POST",
      headers: {
        "Content-Type": "application/json"
      },
      body: JSON.stringify({
        query,
        options
      })
    });
    return response.json();
  }
}

const connector = new CustomConnector("https://my-api-host/");

const config = {
  alwaysSearchOnInitialLoad: true,
  apiConnector: connector
  // ... typical search-ui configuration
};</pre>
</div>
<p>Thats it!. You should see the <code class="literal">CustomConnector</code> executing requests to the server, providing the search state and configuration in the body. The node.js server will use the Elasticsearch connector to perform a search to Elasticsearch and return the results back to the client.</p>
<div class="position-relative"><h5><a id="api-connectors-elasticsearch-customise-the-elasticsearch-request-body"></a>Customise the Elasticsearch Request Body</h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/search-ui/edit/main/docs/api-connectors-elasticsearch.asciidoc">edit</a></div>
<p>Elasticsearch connector allows you to customise the Elasticsearch request body before its performed on Elasticsearch. This is useful if you want to customise the query or options before the request is sent to Elasticsearch.</p>
<p>This is an advanced option, the underlying query may change between versions and reading from / mutating the query is brittle, so please be aware to use this sparingly and let us know what you want to achieve through github issues.</p>
<p>Example below is overriding the <code class="literal">query</code> section of the Elasticsearch request body.</p>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">const connector = new ElasticsearchAPIConnector(
  {
    host: "https://example-host.es.us-central1.gcp.cloud.es.io:9243",
    index: "national-parks",
    apiKey: "exampleApiKey"
  },
  (requestBody, requestState, queryConfig) =&gt; {
    console.log("postProcess requestBody Call", requestBody); // logging out the requestBody before sending to Elasticsearch
    if (!requestState.searchTerm) return requestBody;

    // transforming the query before sending to Elasticsearch using the requestState and queryConfig
    const searchFields = queryConfig.search_fields;

    requestBody.query = {
      multi_match: {
        query: requestState.searchTerm,
        fields: Object.keys(searchFields).map((fieldName) =&gt; {
          const weight = searchFields[fieldName].weight || 1;
          return `${fieldName}^${weight}`;
        })
      }
    };

    return requestBody;
  }
);</pre>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="api-connectors-workplace-search.html">« Workplace Search Connector</a>
</span>
<span class="next">
<a href="api-core-plugins-analytics-plugin.html">Analytics Plugin »</a>
</span>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>

                        <!-- Feedback widget -->
                        <div id="feedbackWidgetContainer"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


        <div id='elastic-footer'></div>
        <script src='https://www.elastic.co/elastic-footer.js'></script>
        <!-- Footer Section end-->

      </section>
    </div>

    <!-- Feedback modal -->
    <div id="feedbackModalContainer"></div>

    <script src="/guide/static/jquery.js"></script>
    <script type="text/javascript" src="/guide/static/docs-v1.js"></script>
    <script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
