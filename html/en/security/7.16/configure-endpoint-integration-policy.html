<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Configure the Endpoint Security integration policy | Elastic Security Solution [7.16] | Elastic</title>
<meta class="elastic" name="content" content="Configure the Endpoint Security integration policy | Elastic Security Solution [7.16]">

<link rel="home" href="index.html" title="Elastic Security Solution [7.16]"/>
<link rel="up" href="getting-started.html" title="Get started with Elastic Security"/>
<link rel="prev" href="install-endpoint.html" title="Configure and install the Endpoint Security integration"/>
<link rel="next" href="advanced-settings.html" title="Configure advanced settings"/>
<meta class="elastic" name="product_version" content="7.16"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/7.16"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="7.16"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="icon" href="/favicon.ico" sizes="32x32"/>
    <link rel="icon" href="/favicon.svg" type="image/svg+xml"/>
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" sizes="180x180"/>
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles-v1.css" />
  </head>

  <!--© 2015-2025 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div class="navheader">
<span class="prev">
<a href="install-endpoint.html">« Configure and install the Endpoint Security integration</a>
</span>
<span class="next">
<a href="advanced-settings.html">Configure advanced settings »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [7.16]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="getting-started.html">Get started with Elastic Security</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Configure the Endpoint Security integration policy</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/7.16/docs/getting-started/configure-integration-policy.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div id="url-to-v3" class="version-warning">
    <strong>IMPORTANT</strong>: This documentation is no longer updated. Refer to <a href="https://www.elastic.co/support/eol">Elastic's version policy</a> and the <a href="https://www.elastic.co/docs/solutions/security/configure-elastic-defend/configure-an-integration-policy-for-elastic-defend">latest documentation</a>.
</div>
<div class="chapter">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="configure-endpoint-integration-policy"></a>Configure the Endpoint Security integration policy</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/7.16/docs/getting-started/configure-integration-policy.asciidoc">edit</a></div>
</div></div></div>
<p>After the Elastic Agent is installed with the Endpoint Security integration, several protections features — including preventions against malware, ransomware, memory threats, and malicious behavior — are automatically enabled on protected hosts (a Platinum or Enterprise license feature). If needed, you can update the integration policy to configure protection settings, event collection, antivirus settings, and trusted applications to meet your organization&#8217;s security needs.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>You must have admin permissions in Kibana to configure an integration policy.</p>
</div>
</div>
<p>To configure the integration policy:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
In the Elastic Security app, go to <span class="strong strong"><strong>Manage</strong></span> &#8594; <span class="strong strong"><strong>Endpoints</strong></span> to view the Endpoints list.
</li>
<li class="listitem">
From the <span class="strong strong"><strong>Policy</strong></span> column, select the integration policy you want to configure. The integration policy configuration page appears.
</li>
<li class="listitem">
<p>Review the following settings on the <span class="strong strong"><strong>Policy settings</strong></span> tab and configure them as appropriate:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="configure-endpoint-integration-policy.html#malware-protection" title="Malware protection">Malware protection</a>
</li>
<li class="listitem">
<a class="xref" href="configure-endpoint-integration-policy.html#ransomware-protection" title="Ransomware protection">Ransomware protection</a>
</li>
<li class="listitem">
<a class="xref" href="configure-endpoint-integration-policy.html#memory-protection" title="Memory threat protection">Memory threat protection</a>
</li>
<li class="listitem">
<a class="xref" href="configure-endpoint-integration-policy.html#behavior-protection" title="Malicious behavior protection">Malicious behavior protection</a>
</li>
<li class="listitem">
<a class="xref" href="configure-endpoint-integration-policy.html#event-collection" title="Event collection">Event collection</a>
</li>
<li class="listitem">
<a class="xref" href="configure-endpoint-integration-policy.html#register-as-antivirus" title="Register Elastic Security as antivirus (optional)">Register Elastic Security as antivirus (optional)</a>
</li>
<li class="listitem">
<a class="xref" href="configure-endpoint-integration-policy.html#adv-policy-settings" title="Advanced policy settings (optional)">Advanced policy settings (optional)</a>
</li>
<li class="listitem">
<a class="xref" href="configure-endpoint-integration-policy.html#save-policy" title="Save the general policy settings">Save the general policy settings</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Click the <span class="strong strong"><strong>Trusted applications</strong></span> tab to review the list of <a class="xref" href="trusted-apps-ov.html" title="Trusted applications">trusted applications</a> assigned to this integration policy. On this tab, you can:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Expand and view a trusted application — Click the arrow next to the application&#8217;s name.
</li>
<li class="listitem">
View full details for a trusted application — Click the actions button (<span class="strong strong"><strong>&#8230;&#8203;</strong></span>), then select <span class="strong strong"><strong>View full details</strong></span>.
</li>
<li class="listitem">
Unassign a trusted application (Platinum or Enterprise subscription) — Click the actions button (<span class="strong strong"><strong>&#8230;&#8203;</strong></span>), then select <span class="strong strong"><strong>Remove from policy</strong></span>. This does not delete the trusted application; this just unassigns it from the current policy.
</li>
<li class="listitem">
Assign an existing trusted application (Platinum or Enterprise subscription) — Click <span class="strong strong"><strong>Assign trusted application to policy</strong></span>, then select an application from the Assign trusted applications flyout. This view lists any existing trusted applications that aren&#8217;t already assigned to the current policy.
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>You can&#8217;t create new trusted applications while configuring an integration policy. To create a new trusted application, go to <span class="strong strong"><strong>Manage</strong></span> &#8594; <span class="strong strong"><strong>Trusted applications</strong></span>.</p>
</div>
</div>
<div class="position-relative"><h3><a id="malware-protection"></a>Malware protection</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/7.16/docs/getting-started/configure-integration-policy.asciidoc">edit</a></div>
<p>Malware prevention on the Elastic Agent detects and stops malicious attacks by using a <a class="xref" href="detection-engine-overview.html#machine-learning-model" title="Machine learning model">machine learning model</a> that looks for static attributes to determine if a file is malicious or benign.</p>
<p>By default, malware protection is enabled on Windows, macOS, and Linux hosts. To disable malware protection, switch the <span class="strong strong"><strong>Malware protections enabled</strong></span> toggle off.</p>
<p>Malware protection levels are:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Detect</strong></span>: Detects malware on the host and generates an alert. The agent will <span class="strong strong"><strong>not</strong></span> block malware. You must pay attention to and analyze any malware alerts that are generated. Notifications do not appear by default. Select the <span class="strong strong"><strong>Notify User</strong></span> option to enable them.
</li>
<li class="listitem">
<p><span class="strong strong"><strong>Prevent</strong></span> (Default): Detects malware on the host, blocks it from executing, and generates an alert. Notifications appear by default. Deselect the <span class="strong strong"><strong>Notify User</strong></span> option to disable them.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>Platinum and Enterprise customers can customize these notifications using the <code class="literal">Elastic Security {action} {filename}</code> syntax.</p>
</div>
</div>
</li>
</ul>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="images/install-endpoint/malware-protection.png" alt="Detail of malware protection section.">
</div>
</div>
<div class="position-relative"><h3><a id="ransomware-protection"></a>Ransomware protection</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/7.16/docs/getting-started/configure-integration-policy.asciidoc">edit</a></div>
<p>Behavioral ransomware prevention detects and stops ransomware attacks on Windows systems by analyzing data from low-level system processes. It is effective across an array of widespread ransomware families — including those targeting the system’s master boot record.</p>
<p>Ransomware protection is a paid feature and is enabled by default if you have a <a href="/pricing" class="ulink" target="_top">Platinum or Enterprise license</a>. If you upgrade to a Platinum or Enterprise license from Basic or Gold, ransomware protection will be disabled by default.</p>
<p>Ransomware protection levels are:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Detect</strong></span>: Detects ransomware on the host and generates an alert. The Elastic Agent will <span class="strong strong"><strong>not</strong></span> block ransomware. Select the <span class="strong strong"><strong>Notify User</strong></span> option to enable user notifications.
</li>
<li class="listitem">
<p><span class="strong strong"><strong>Prevent</strong></span> (Default): Detects ransomware on the host, blocks it from executing, and generates an alert. User notifications are enabled by default. Deselect the <span class="strong strong"><strong>Notify User</strong></span> option to disable them.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>Platinum and Enterprise customers can customize these notifications using the <code class="literal">Elastic Security {action} {filename}</code> syntax.</p>
</div>
</div>
</li>
</ul>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="images/install-endpoint/ransomware-protection.png" alt="Detail of ransomware protection section.">
</div>
</div>
<div class="position-relative"><h3><a id="memory-protection"></a>Memory threat protection</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/7.16/docs/getting-started/configure-integration-policy.asciidoc">edit</a></div>
<p>Memory threat protection detects and stops in-memory threats, such as shellcode injection, which are used to evade traditional file-based detection techniques.</p>
<p>Memory threat protection is a paid feature and is enabled by default if you have a <a href="/pricing" class="ulink" target="_top">Platinum or Enterprise license</a>. If you upgrade to a Platinum or Enterprise license from Basic or Gold, memory threat protection will be disabled by default.</p>
<p>Memory threat protection levels are:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Detect</strong></span>: Detects memory threat activity on the host and generates an alert. The Elastic Agent will <span class="strong strong"><strong>not</strong></span> block the in-memory activity. Select the <span class="strong strong"><strong>Notify User</strong></span> option to enable user notifications.
</li>
<li class="listitem">
<p><span class="strong strong"><strong>Prevent</strong></span> (Default): Detects memory threat activity on the host, forces the process or thread to stop, and generates an alert. User notifications are enabled by default. Deselect the <span class="strong strong"><strong>Notify User</strong></span> option to disable them.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>Platinum and Enterprise customers can customize these notifications using the <code class="literal">Elastic Security {action} {rule}</code> syntax.</p>
</div>
</div>
</li>
</ul>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="images/install-endpoint/memory-protection.png" alt="Detail of memory protection section.">
</div>
</div>
<div class="position-relative"><h3><a id="behavior-protection"></a>Malicious behavior protection</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/7.16/docs/getting-started/configure-integration-policy.asciidoc">edit</a></div>
<p>Malicious behavior protection detects and stops threats by monitoring the behavior of system processes for suspicious activity. Behavioral signals are much more difficult for adversaries to evade than traditional file-based detection techniques.</p>
<p>Malicious behavior protection is a paid feature and is enabled by default if you have a <a href="/pricing" class="ulink" target="_top">Platinum or Enterprise license</a>. If you upgrade to a Platinum or Enterprise license from Basic or Gold, malicious behavior protection will be disabled by default.</p>
<p>Malicious behavior protection levels are:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Detect</strong></span>: Detects malicious behavior on the host and generates an alert. The Elastic Agent will <span class="strong strong"><strong>not</strong></span> block the malicious behavior. Select the <span class="strong strong"><strong>Notify User</strong></span> option to enable user notifications.
</li>
<li class="listitem">
<p><span class="strong strong"><strong>Prevent</strong></span> (Default): Detects malicious behavior on the host, forces the process to stop, and generates an alert. User notifications are enabled by default. Deselect the <span class="strong strong"><strong>Notify User</strong></span> option to disable them.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>Platinum and Enterprise customers can customize these notifications using the <code class="literal">Elastic Security {action} {rule}</code> syntax.</p>
</div>
</div>
</li>
</ul>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="images/install-endpoint/behavior-protection.png" alt="Detail of behavior protection section.">
</div>
</div>
<div class="position-relative"><h3><a id="event-collection"></a>Event collection</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/7.16/docs/getting-started/configure-integration-policy.asciidoc">edit</a></div>
<p>In the <span class="strong strong"><strong>Settings</strong></span> section, review the events that Elastic Agent will collect on each operating system. By default, all event data is collected. If you no longer want to collect a specific type of event, deselect it.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/install-endpoint/event-collection.png" alt="Detail of event collection section.">
</div>
</div>
<div class="position-relative"><h3><a id="register-as-antivirus"></a>Register Elastic Security as antivirus (optional)</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/7.16/docs/getting-started/configure-integration-policy.asciidoc">edit</a></div>
<p>If you download the Elastic Agent version 7.10 or later on Windows 7 or above, you can configure Elastic Security as your antivirus software by switching the <span class="strong strong"><strong>Register as antivirus</strong></span> toggle on.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/register-as-antivirus.png" alt="Detail of Register as antivirus option.">
</div>
</div>
<div class="position-relative"><h3><a id="adv-policy-settings"></a>Advanced policy settings (optional)</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/7.16/docs/getting-started/configure-integration-policy.asciidoc">edit</a></div>
<p>Users with unique configuration and security requirements can select <span class="strong strong"><strong>Show Advanced Settings</strong></span> to configure the policy to support advanced use cases. Hover over each setting to view its description.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Advanced settings are not recommended for most users.</p>
</div>
</div>
<div class="position-relative"><h3><a id="save-policy"></a>Save the general policy settings</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/7.16/docs/getting-started/configure-integration-policy.asciidoc">edit</a></div>
<p>After you have configured the general settings on the <span class="strong strong"><strong>Policy settings</strong></span> tab, click <span class="strong strong"><strong>Save</strong></span>. A confirmation message appears.</p>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="install-endpoint.html">« Configure and install the Endpoint Security integration</a>
</span>
<span class="next">
<a href="advanced-settings.html">Configure advanced settings »</a>
</span>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>

                        <!-- Feedback widget -->
                        <div id="feedbackWidgetContainer"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


        <div id='elastic-footer'></div>
        <script src='https://www.elastic.co/elastic-footer.js'></script>
        <!-- Footer Section end-->

      </section>
    </div>

    <!-- Feedback modal -->
    <div id="feedbackModalContainer"></div>

    <script src="/guide/static/jquery.js"></script>
    <script type="text/javascript" src="/guide/static/docs-v1.js"></script>
    <script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
