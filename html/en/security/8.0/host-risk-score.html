<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Host risk score | Elastic Security [8.0] | Elastic</title>
<meta class="elastic" name="content" content="Host risk score | Elastic Security [8.0]">

<link rel="home" href="index.html" title="Elastic Security [8.0]"/>
<link rel="up" href="sec-experimental-intro.html" title="Technical preview"/>
<link rel="prev" href="sec-experimental-intro.html" title="Technical preview"/>
<link rel="next" href="network-beaconing-framework.html" title="Network Beaconing"/>
<meta class="elastic" name="product_version" content="8.0"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.0"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.0"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="icon" href="/favicon.ico" sizes="32x32"/>
    <link rel="icon" href="/favicon.svg" type="image/svg+xml"/>
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" sizes="180x180"/>
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles-v1.css" />
  </head>

  <!--© 2015-2025 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div class="navheader">
<span class="prev">
<a href="sec-experimental-intro.html">« Technical preview</a>
</span>
<span class="next">
<a href="network-beaconing-framework.html">Network Beaconing »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security [8.0]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="sec-experimental-intro.html">Technical preview</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Host risk score</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.0/docs/experimental-features/host-risk-score.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div id="url-to-v3" class="version-warning">
    <strong>IMPORTANT</strong>: This documentation is no longer updated. Refer to <a href="https://www.elastic.co/support/eol">Elastic's version policy</a> and the <a href="https://www.elastic.co/docs">latest documentation</a>.
</div>
<div class="chapter">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="host-risk-score"></a>Host risk score</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.0/docs/experimental-features/host-risk-score.asciidoc">edit</a></div>
</div></div></div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This feature is available for Elastic Stack versions 7.16.0 and newer.</p>
</div>
</div>
<p>The host risk score feature highlights risky hosts from within your environment. It utilizes a transform with a scripted metric aggregation to calculate host risk scores based on alerts that were generated within the past five days. The transform runs hourly to update the score as new alerts are generated.</p>
<p>Each rule&#8217;s contribution to the host risk score is based on the rule&#8217;s risk score (<code class="literal">signal.rule.risk_score</code>) and a time decay factor to reduce the impact of stale alerts. The risk score is calculated using a weighted sum where rules with higher time-corrected risk scores also have higher weights. Each host risk score is normalized to a scale of 0 to 100.</p>
<p>Specific host attributes can boost the final risk score. For example, alert activity on a server poses a greater risk than that on a laptop. Therefore, the host risk score is 1.5 times higher if the host is a server. This boosted score is finalized after calculating the weighted sum of the time-corrected risks.</p>
<p>The following table shows how risk levels are applied to a host, based on the normalized risk score:</p>
<div class="informaltable">
<table border="1" cellpadding="4px" width="100%">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Risk level</th>
<th align="left" valign="top">Host risk score</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>Unknown</p></td>
<td align="left" valign="top"><p>&lt; 20</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Low</p></td>
<td align="left" valign="top"><p>20-40</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Moderate</p></td>
<td align="left" valign="top"><p>40-70</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>High</p></td>
<td align="left" valign="top"><p>70-90</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Critical</p></td>
<td align="left" valign="top"><p>&gt; 90</p></td>
</tr>
</tbody>
</table>
</div>
<div class="position-relative"><h3><a id="_deploy_the_host_risk_score_package"></a>Deploy the host risk score package</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.0/docs/experimental-features/host-risk-score.asciidoc">edit</a></div>
<p>To deploy the host risk score framework in your environment, follow <a href="https://github.com/elastic/detection-rules/blob/main/docs/experimental-machine-learning/host-risk-score.md" class="ulink" target="_top">these steps</a>. These instructions also include steps to enable the <code class="literal">riskyHostsEnabled</code> feature flag.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Update host risk score artifacts after you upgrade the Elastic Stack. To do this, download a release bundle that&#8217;s compatible with the new Elastic Stack version and repeat all the steps referenced above. Failure to do so might cause views in the Elastic Security app to break.</p>
</div>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>To view host risk score data in the Elastic Security app, you must <a href="https://github.com/elastic/detection-rules/blob/main/docs/experimental-machine-learning/host-risk-score.md#8-enable-kibana-features" class="ulink" target="_top">enable the <code class="literal">riskyHostsEnabled</code> feature flag</a>. However, enabling the feature flag is NOT required to view the Lens dashboards.</p>
</div>
</div>
<div class="position-relative"><h3><a id="view-host-risk-score"></a>View host risk score data</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.0/docs/experimental-features/host-risk-score.asciidoc">edit</a></div>
<p>If the <code class="literal">riskyHostsEnabled</code> feature flag is enabled:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
In the Elastic Security app, go to the <span class="strong strong"><strong>Overview</strong></span> page, then locate the <span class="strong strong"><strong>Current host risk scores</strong></span> card in the lower-right corner.
</li>
<li class="listitem">
<p>Click <span class="strong strong"><strong>View dashboard</strong></span>.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/host-score-overview.png" alt="host score overview">
</div>
</div>
</li>
</ol>
</div>
<p>If the <code class="literal">riskyHostsEnabled</code> feature flag is NOT enabled:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
In Kibana, go to <span class="strong strong"><strong>Analytics &#8594; Dashboard</strong></span>.
</li>
<li class="listitem">
<p>Select the <span class="strong strong"><strong>Current Risk Score for Hosts</strong></span> dashboard.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/select-dashboard.png" alt="select dashboard">
</div>
</div>
</li>
<li class="listitem">
<p>In the <span class="strong strong"><strong>Current Risk Scores for Hosts</strong></span> list, hover over the host name to view, click the <span class="strong strong"><strong>+</strong></span> button, then select <span class="strong strong"><strong>Go to Dashboard</strong></span>.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/go-to-dashboard.png" alt="go to dashboard">
</div>
</div>
</li>
</ol>
</div>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>It is recommended you analyze hosts with the highest risk scores&#8201;&#8212;&#8201;or those in the <code class="literal">Critical</code> and <code class="literal">Moderate</code> categories first.</p>
</div>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="images/full-dashboard.png" alt="full dashboard">
</div>
</div>
<p>Use the histogram to track how the risk score for a particular host has changed over time. To specify a date range, use the date and time picker or drag and select a time range within the histogram.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/histogram.png" alt="histogram">
</div>
</div>
<p>To go to the host&#8217;s detail page, left-click any host&#8217;s corresponding bar in the histogram, then select <span class="strong strong"><strong>Go to Host View</strong></span>.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/go-to-host-view.png" alt="go to host view">
</div>
</div>
<p>The data tables beneath the histogram display associated rules, users, and MITRE tactics of risky hosts. The table data is sorted in reverse chronological order by default, with the highest total risk score at the top. Use this information to triage alerts that pose the highest risk to your network.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/data-tables.png" alt="data tables">
</div>
</div>
<div class="position-relative"><h4><a id="_additional_places_to_visualize_host_risk_score_data"></a>Additional places to visualize host risk score data</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.0/docs/experimental-features/host-risk-score.asciidoc">edit</a></div>
<p>If the <code class="literal">riskyHostsEnabled</code> feature flag is enabled, you can visualize host risk score data in the following places in the Elastic Security app:</p>
<p>The <span class="strong strong"><strong>Overview</strong></span> tab on the Alert details flyout:</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/score-in-flyout.png" alt="score in flyout">
</div>
</div>
<p>The <span class="strong strong"><strong>Host risk classification</strong></span> column in the All hosts table on the Hosts page:</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/hrs-all-hosts.png" alt="hrs all hosts">
</div>
</div>
<p>The <span class="strong strong"><strong>Hosts by risk</strong></span> tab on the Hosts page:</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/hosts-by-risk-tab.png" alt="hosts by risk tab">
</div>
</div>
<p>The <span class="strong strong"><strong>Overview</strong></span> section on the Host details page:</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/hrs-overview-section.png" alt="hrs overview section">
</div>
</div>
<p>The <span class="strong strong"><strong>Hosts by risk</strong></span> tab on the Host details page:</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/hosts-by-risk-details-page.png" alt="hosts by risk details page">
</div>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="sec-experimental-intro.html">« Technical preview</a>
</span>
<span class="next">
<a href="network-beaconing-framework.html">Network Beaconing »</a>
</span>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>

                        <!-- Feedback widget -->
                        <div id="feedbackWidgetContainer"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


        <div id='elastic-footer'></div>
        <script src='https://www.elastic.co/elastic-footer.js'></script>
        <!-- Footer Section end-->

      </section>
    </div>

    <!-- Feedback modal -->
    <div id="feedbackModalContainer"></div>

    <script src="/guide/static/jquery.js"></script>
    <script type="text/javascript" src="/guide/static/docs-v1.js"></script>
    <script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
