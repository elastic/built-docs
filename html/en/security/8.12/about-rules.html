<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>About detection rules | Elastic Security Solution [8.12] | Elastic</title>
<meta class="elastic" name="content" content="About detection rules | Elastic Security Solution [8.12]">

<link rel="home" href="index.html" title="Elastic Security Solution [8.12]"/>
<link rel="up" href="detection-engine-overview.html" title="Detections and alerts"/>
<link rel="prev" href="detection-engine-overview.html" title="Detections and alerts"/>
<link rel="next" href="rules-ui-create.html" title="Create a detection rule"/>
<meta class="elastic" name="product_version" content="8.12"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.12"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.12"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles-v1.css" />
  </head>

  <!--© 2015-2025 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div class="navheader">
<span class="prev">
<a href="detection-engine-overview.html">« Detections and alerts</a>
</span>
<span class="next">
<a href="rules-ui-create.html">Create a detection rule »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [8.12]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="detection-engine-overview.html">Detections and alerts</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>About detection rules</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.12/docs/detections/about-rules.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="chapter xpack">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="about-rules"></a>About detection rules</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.12/docs/detections/about-rules.asciidoc">edit</a></div>
</div></div></div>
<p>Rules run periodically and search for source events, matches, sequences, or machine learning job anomaly results
that meet their criteria. When a rule&#8217;s criteria are met, a detection alert is
created.</p>
<div class="position-relative"><h3><a id="rule-types"></a>Rule types</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.12/docs/detections/about-rules.asciidoc">edit</a></div>
<p>You can create the following types of rules:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="rules-ui-create.html#create-custom-rule" title="Create a custom query rule"><span class="strong strong"><strong>Custom query</strong></span></a>: Query-based rule, which searches the defined indices and
creates an alert when one or more documents match the rule&#8217;s query.
</li>
<li class="listitem">
<p><a class="xref" href="rules-ui-create.html#create-ml-rule" title="Create a machine learning rule"><span class="strong strong"><strong>Machine learning</a></strong></span>: Machine learning rule, which creates an alert when a machine learning job
discovers an anomaly above the defined threshold (see <a class="xref" href="machine-learning.html" title="Anomaly detection">Anomaly detection</a>).</p>
<p>For machine learning rules, the associated machine learning job must be running. If the machine learning job isn&#8217;t
running, the rule will:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Run and create alerts if existing anomaly results with scores above the defined threshold
are discovered.
</li>
<li class="listitem">
Issue an error stating the machine learning job was not running when the rule executed.
</li>
</ul>
</div>
</li>
<li class="listitem">
<p><a class="xref" href="rules-ui-create.html#create-threshold-rule" title="Create a threshold rule"><span class="strong strong"><strong>Threshold</strong></span></a>: Searches the defined indices and creates a detections alert
when the number of times the specified field&#8217;s value is present and meets the threshold during
a single execution. When multiple values meet the threshold, an alert is
generated for each value.</p>
<p>For example, if the threshold <code class="literal">field</code> is <code class="literal">source.ip</code> and its <code class="literal">value</code> is <code class="literal">10</code>, an
alert is generated for every source IP address that appears in at least 10 of
the rule&#8217;s search results.</p>
</li>
<li class="listitem">
<a class="xref" href="rules-ui-create.html#create-eql-rule" title="Create an event correlation rule"><span class="strong strong"><strong>Event correlation</strong></span></a>: Searches the defined indices and creates an alert when results match an
<a href="/guide/en/elasticsearch/reference/8.12/eql.html" class="ulink" target="_top">Event Query Language (EQL)</a> query.
</li>
<li class="listitem">
<p><a class="xref" href="rules-ui-create.html#create-indicator-rule" title="Create an indicator match rule"><span class="strong strong"><strong>Indicator match</strong></span></a>: Creates an alert when Elastic Security index field values match field values defined in the specified indicator index patterns. For example, you can create an indicator index for IP addresses and use this index to create an alert whenever an event&#8217;s <code class="literal">destination.ip</code> equals a value in the index. Indicator index field mappings should be <a href="/guide/en/ecs/8.11" class="ulink" target="_top">ECS-compliant</a>. For information on creating Elasticsearch indices and field types, see
<a href="/guide/en/elasticsearch/reference/8.12/getting-started-index.html" class="ulink" target="_top">Index some documents</a>,
<a href="/guide/en/elasticsearch/reference/8.12/indices-create-index.html" class="ulink" target="_top">Create index API</a>, and
<a href="/guide/en/elasticsearch/reference/8.12/mapping-types.html" class="ulink" target="_top">Field data types</a>. If you have indicators in a standard file format, such as CSV or JSON, you can also use the Machine Learning Data Visualizer to import your indicators into an indicator index. See <a href="/guide/en/machine-learning/8.12/ml-getting-started.html#sample-data-visualizer" class="ulink" target="_top">Explore the data in Kibana</a> and use the <span class="strong strong"><strong>Import Data</strong></span> option to import your indicators.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>You can also use value lists as the indicator match index. See <a class="xref" href="rules-ui-create.html#indicator-value-lists" title="Use value lists with indicator match rules">Use value lists with indicator match rules</a> at the end of this topic for more information.</p>
</div>
</div>
</li>
<li class="listitem">
<a class="xref" href="rules-ui-create.html#create-new-terms-rule" title="Create a new terms rule"><span class="strong strong"><strong>New terms</strong></span></a>: Generates an alert for each new term detected in source documents within a specified time range. You can also detect a combination of up to three new terms (for example, a <code class="literal">host.ip</code> and <code class="literal">host.id</code> that have never been observed together before).
</li>
<li class="listitem">
<p><a class="xref" href="rules-ui-create.html#create-esql-rule" title="Create an ES|QL rule"><span class="strong strong"><strong>ES|QL</strong></span></a>: Searches the defined indices and creates an alert when results match an <a href="/guide/en/elasticsearch/reference/8.12/esql.html" class="ulink" target="_top">Elasticsearch Query Language (ES|QL)</a> query.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>Do not use ES|QL on production environments. This functionality is in technical preview and may be changed or removed in a future release. Elastic will work to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.</p>
</div>
</div>
</li>
</ul>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="images/all-rules.png" alt="Shows the Rules page">
</div>
</div>
<div class="position-relative"><h3><a id="views-index-patterns"></a>Data views and index patterns</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.12/docs/detections/about-rules.asciidoc">edit</a></div>
<p>When you create a rule, you must either specify the Elasticsearch index pattens for which you&#8217;d like the rule to run, or select a <a class="xref" href="data-views-in-sec.html" title="Data views in Elastic Security">data view field</a> as the data source. If you select a data view, you can select <a class="xref" href="runtime-fields.html" title="Create runtime fields in Elastic Security">runtime fields</a> associated with that data view to create a query for the rule (with the exception of machine learning rules, which do not use queries).</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>To access data views, ensure you have the <a href="/guide/en/kibana/8.12/data-views.html#data-views-read-only-access" class="ulink" target="_top">required permissions</a>.</p>
</div>
</div>
<div class="position-relative"><h3><a id="about-notifications"></a>Notifications</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.12/docs/detections/about-rules.asciidoc">edit</a></div>
<p>For both prebuilt and custom rules, you can send notifications when alerts are created. Notifications can be sent via Jira, Microsoft Teams, PagerDuty, Slack, and others, and can be configured when you create or edit a rule.</p>
<div class="position-relative"><h3><a id="alerting-authorization-model"></a>Authorization</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.12/docs/detections/about-rules.asciidoc">edit</a></div>
<p>Rules, including all background detection and the actions they generate, are authorized using an <a href="/guide/en/kibana/8.12/api-keys.html" class="ulink" target="_top">API key</a> associated with the last user to edit the rule. Upon creating or modifying a rule, an API key is generated for that user, capturing a snapshot of their privileges. The API key is then used to run all background tasks associated with the rule including detection checks and executing actions.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>If a rule requires certain privileges to run, such as index privileges, keep in mind that if a user without those privileges updates the rule, the rule will no longer function.</p>
</div>
</div>
<div class="position-relative"><h3><a id="about-exceptions"></a>Exceptions</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.12/docs/detections/about-rules.asciidoc">edit</a></div>
<p>When modifying rules or managing detection alerts, you can <a class="xref" href="add-exceptions.html" title="Add and manage exceptions">add exceptions</a> that prevent a rule from generating alerts even when its criteria are met. This is useful for reducing noise, such as preventing alerts from trusted processes and internal IP addresses.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>You can add exceptions to custom query, machine learning, event correlation, and indicator match rule types.</p>
</div>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="detection-engine-overview.html">« Detections and alerts</a>
</span>
<span class="next">
<a href="rules-ui-create.html">Create a detection rule »</a>
</span>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>

                        <!-- Feedback widget -->
                        <div id="feedbackWidgetContainer"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


        <div id='elastic-footer'></div>
        <script src='https://www.elastic.co/elastic-footer.js'></script>
        <!-- Footer Section end-->

      </section>
    </div>

    <!-- Feedback modal -->
    <div id="feedbackModalContainer"></div>

    <script src="/guide/static/jquery.js"></script>
    <script type="text/javascript" src="/guide/static/docs-v1.js"></script>
    <script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
