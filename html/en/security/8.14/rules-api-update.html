<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Update rule | Elastic Security Solution [8.14] | Elastic</title>
<meta class="elastic" name="content" content="Update rule | Elastic Security Solution [8.14]">

<link rel="home" href="index.html" title="Elastic Security Solution [8.14]"/>
<link rel="up" href="rule-api-overview.html" title="Detections API"/>
<link rel="prev" href="rules-api-find.html" title="Find rules"/>
<link rel="next" href="rules-api-delete.html" title="Delete rule"/>
<meta class="elastic" name="product_version" content="8.14"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.14"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.14"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles-v1.css" />
  </head>

  <!--© 2015-2025 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div class="navheader">
<span class="prev">
<a href="rules-api-find.html">« Find rules</a>
</span>
<span class="next">
<a href="rules-api-delete.html">Delete rule »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [8.14]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="security-apis.html">Elastic Security APIs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="rule-api-overview.html">Detections API</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Update rule</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.14/docs/detections/api/rules/rules-api-update.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="rules-api-update"></a>Update rule<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.14/docs/detections/api/rules/rules-api-update.asciidoc">edit</a></h2>
</div></div></div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>When used with <a href="/guide/en/kibana/8.14/api-keys.html" class="ulink" target="_top">API key</a> authentication, the user&#8217;s key gets assigned to the affected rules. If the user&#8217;s key gets deleted or the user becomes inactive, the rules will stop running.</p>
<p>If the API key that is used for authorization has different privileges than the key that created or most recently updated the rule, the rule behavior might change.</p>
</div>
</div>
<p>Updates an existing detection rule.</p>
<p>You can use <code class="literal">PUT</code> or <code class="literal">PATCH</code> methods to update rules, where:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">PUT</code> replaces the original rule and deletes fields that are not specified.
</li>
<li class="listitem">
<code class="literal">PATCH</code> updates the specified fields.
</li>
</ul>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_request_url_4"></a>Request URL<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.14/docs/detections/api/rules/rules-api-update.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">PUT &lt;kibana host&gt;:&lt;port&gt;/api/detection_engine/rules</code></p>
<p><code class="literal">PATCH &lt;kibana host&gt;:&lt;port&gt;/api/detection_engine/rules</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_request_body_2"></a>Request body<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.14/docs/detections/api/rules/rules-api-update.asciidoc">edit</a></h3>
</div></div></div>
<p>A JSON object with:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
The <code class="literal">id</code> or <code class="literal">rule_id</code> field of the rule you want to update.
</li>
<li class="listitem">
The fields you want to modify.
</li>
</ul>
</div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>If you call <code class="literal">PUT</code> to update a rule, all unspecified fields are
deleted. You cannot modify the <code class="literal">id</code> or <code class="literal">rule_id</code> values.</p>
</div>
</div>
<p>For <code class="literal">PATCH</code> calls any of the fields can be modified, whereas for <code class="literal">PUT</code> calls
some fields are required.</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_fields_required_for_put_calls"></a>Fields required for <code class="literal">PUT</code> calls<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.14/docs/detections/api/rules/rules-api-update.asciidoc">edit</a></h4>
</div></div></div>
<div class="informaltable">
<table border="1" cellpadding="4px" width="100%">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>description</p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>The rule&#8217;s description.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>name</p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>The rule&#8217;s name.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>risk_score</p></td>
<td align="left" valign="top"><p>Integer</p></td>
<td align="left" valign="top">
<p>A numerical representation of the alert&#8217;s severity from
0 to 100, where:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">0</code> - <code class="literal">21</code> represents low severity
</li>
<li class="listitem">
<code class="literal">22</code> - <code class="literal">47</code> represents medium severity
</li>
<li class="listitem">
<code class="literal">48</code> - <code class="literal">73</code> represents high severity
</li>
<li class="listitem">
<code class="literal">74</code> - <code class="literal">100</code> represents critical severity
</li>
</ul>
</div>
</td>
</tr>
<tr>
<td align="left" valign="top"><p>severity</p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top">
<p>Severity level of alerts produced by the rule, which must
be one of the following:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">low</code>: Alerts that are of interest but generally not considered to be
security incidents
</li>
<li class="listitem">
<code class="literal">medium</code>: Alerts that require investigation
</li>
<li class="listitem">
<code class="literal">high</code>: Alerts that require immediate investigation
</li>
<li class="listitem">
<code class="literal">critical</code>: Alerts that indicate it is highly likely a security incident has
occurred
</li>
</ul>
</div>
</td>
</tr>
<tr>
<td align="left" valign="top"><p>type</p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top">
<p>Data type on which the rule is based:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">eql</code>: EQL query (see <a href="/guide/en/elasticsearch/reference/8.14/eql.html" class="ulink" target="_top">Event Query Language</a>).
</li>
<li class="listitem">
<code class="literal">esql</code>: ES|QL query (refer to <a href="/guide/en/elasticsearch/reference/8.14/esql.html" class="ulink" target="_top">Elasticsearch Query Language</a>).
</li>
<li class="listitem">
<code class="literal">query</code>: query with or without additional filters.
</li>
<li class="listitem">
<code class="literal">saved_query</code>: saved search, identified in the <code class="literal">saved_id</code> field.
</li>
<li class="listitem">
<code class="literal">machine_learning</code>: rule based on a machine learning job&#8217;s anomaly scores.
</li>
<li class="listitem">
<code class="literal">threat_match</code>: rule that matches event values with values in the specified
Elasticsearch index.
</li>
<li class="listitem">
<code class="literal">threshold</code>: rule based on the number of times a <code class="literal">query</code> matches the
specified field.
</li>
<li class="listitem">
<code class="literal">new_terms</code>: rule that alerts on values that have not been seen before
</li>
</ul>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_field_required_for_query_threat_match_threshold_and_new_terms_rules_put_calls"></a>Field required for query, threat-match, threshold, and new terms rules <code class="literal">PUT</code> calls<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.14/docs/detections/api/rules/rules-api-update.asciidoc">edit</a></h4>
</div></div></div>
<div class="informaltable">
<table border="1" cellpadding="4px" width="100%">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>query</p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top">
<p><a href="/guide/en/kibana/8.14/search.html" class="ulink" target="_top">Query</a> used by the rule to create
alerts. For threat-match rules, only the query&#8217;s results are used to determine
whether an alert is generated.</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_field_required_for_threshold_rules_put_calls"></a>Field required for threshold rules <code class="literal">PUT</code> calls<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.14/docs/detections/api/rules/rules-api-update.asciidoc">edit</a></h4>
</div></div></div>
<div class="informaltable">
<table border="1" cellpadding="4px" width="100%">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>threshold</p></td>
<td align="left" valign="top"><p>Object</p></td>
<td align="left" valign="top">
<p>Defines the field and threshold value for when alerts
are generated, where:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">cardinality</code> (Array of length 1): The field on which the cardinality is applied.
</li>
<li class="listitem">
<code class="literal">cardinality.field</code> (string, required): The field on which to calculate and compare the
cardinality.
</li>
<li class="listitem">
<code class="literal">cardinality.value</code> (integer, required): The threshold value from which an alert is
generated based on unique number of values of <code class="literal">cardinality.field</code>.
</li>
<li class="listitem">
<code class="literal">field</code> (string or string[], required): The field on which the threshold is applied. If
you specify an empty array (<code class="literal">[]</code>), alerts are generated when the query returns
at least the number of results specified in the <code class="literal">value</code> field.
</li>
<li class="listitem">
<code class="literal">value</code> (integer, required): The threshold value from which an alert is
generated.
</li>
</ul>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_field_required_for_saved_query_rules_put_calls"></a>Field required for saved-query rules <code class="literal">PUT</code> calls<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.14/docs/detections/api/rules/rules-api-update.asciidoc">edit</a></h4>
</div></div></div>
<div class="informaltable">
<table border="1" cellpadding="4px" width="100%">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>saved_id</p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>Kibana saved search used by the rule to create alerts.</p></td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_field_required_for_eql_rules_put_calls"></a>Field required for EQL rules <code class="literal">PUT</code> calls<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.14/docs/detections/api/rules/rules-api-update.asciidoc">edit</a></h4>
</div></div></div>
<div class="informaltable">
<table border="1" cellpadding="4px" width="100%">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>language</p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>Must be <code class="literal">eql</code>.</p></td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_field_required_for_esql_rules_put_calls"></a>Field required for ES|QL rules <code class="literal">PUT</code> calls<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.14/docs/detections/api/rules/rules-api-update.asciidoc">edit</a></h4>
</div></div></div>
<div class="informaltable">
<table border="1" cellpadding="4px" width="100%">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>language</p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>Must be <code class="literal">esql</code>.</p></td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_fields_required_for_machine_learning_rules_put_calls"></a>Fields required for machine-learning rules <code class="literal">PUT</code> calls<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.14/docs/detections/api/rules/rules-api-update.asciidoc">edit</a></h4>
</div></div></div>
<div class="informaltable">
<table border="1" cellpadding="4px" width="100%">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>anomaly_threshold</p></td>
<td align="left" valign="top"><p>Integer</p></td>
<td align="left" valign="top"><p>Anomaly score threshold above which the rule
creates an alert. Valid values are from <code class="literal">0</code> to <code class="literal">100</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>machine_learning_job_id</p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>Machine learning job ID the rule monitors for
anomaly scores.</p></td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_fields_required_for_threat_match_rules_put_calls"></a>Fields required for threat-match rules <code class="literal">PUT</code> calls<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.14/docs/detections/api/rules/rules-api-update.asciidoc">edit</a></h4>
</div></div></div>
<div class="informaltable">
<table border="1" cellpadding="4px" width="100%">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>threat_index</p></td>
<td align="left" valign="top"><p>String[]</p></td>
<td align="left" valign="top"><p>Elasticsearch indices used to check which field values generate
alerts.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>threat_query</p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>Query used to determine which fields in the Elasticsearch index
are used for generating alerts.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>threat_mapping</p></td>
<td align="left" valign="top"><p>Object[]</p></td>
<td align="left" valign="top">
<p>Array of <code class="literal">entries</code> objects that define mappings
between the source event fields and the values in the Elasticsearch threat index. Each
<code class="literal">entries</code> object must contain these fields:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">field</code>: field from the event indices on which the rule runs
</li>
<li class="listitem">
<code class="literal">type</code>: must be <code class="literal">mapping</code>
</li>
<li class="listitem">
<code class="literal">value</code>: field from the Elasticsearch threat index
</li>
</ul>
</div>
<p>You can use Boolean <code class="literal">and</code> and <code class="literal">or</code> logic to define the conditions for when
matching fields and values generate alerts. Sibling <code class="literal">entries</code> objects
are evaluated using <code class="literal">or</code> logic, whereas multiple entries in a single <code class="literal">entries</code>
object use <code class="literal">and</code> logic. See <a class="xref" href="rules-api-create.html#threat-match-example">below</a> for an example that
uses both <code class="literal">and</code> and <code class="literal">or</code> logic.</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_fields_required_for_new_terms_rules_put_calls"></a>Fields required for new terms rules <code class="literal">PUT</code> calls<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.14/docs/detections/api/rules/rules-api-update.asciidoc">edit</a></h4>
</div></div></div>
<div class="informaltable">
<table border="1" cellpadding="4px" width="100%">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>new_terms_fields</p></td>
<td align="left" valign="top"><p>String[]</p></td>
<td align="left" valign="top"><p>Fields to monitor for new values. Must contain 1–3 field names.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>history_window_start</p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>Start date to use when checking if a term has been seen before.
Supports relative dates – for example, <code class="literal">now-30d</code> will search the last 30 days of data when checking if a term
is new. We do not recommend using absolute dates, which can cause issues with rule performance
due to querying increasing amounts of data over time.</p></td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_optional_fields_for_all_rule_types"></a>Optional fields for all rule types<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.14/docs/detections/api/rules/rules-api-update.asciidoc">edit</a></h4>
</div></div></div>
<div class="informaltable">
<table border="1" cellpadding="4px" width="100%">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>actions</p></td>
<td align="left" valign="top"><p><a class="xref" href="rules-api-create.html#actions-object-schema" title="actions schema">actions[]</a></p></td>
<td align="left" valign="top"><p>Array defining the automated
actions (notifications) taken when alerts are generated.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>author</p></td>
<td align="left" valign="top"><p>String[]</p></td>
<td align="left" valign="top"><p>The rule&#8217;s author.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>building_block_type</p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>Determines if the rule acts as a building block.
By default, building-block alerts are not displayed in the UI. These rules are
used as a foundation for other rules that do generate alerts. Its value must be
<code class="literal">default</code>. For more information, refer to <a class="xref" href="building-block-rule.html" title="About building block rules"><em>About building block rules</em></a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>enabled</p></td>
<td align="left" valign="top"><p>Boolean</p></td>
<td align="left" valign="top"><p>Determines whether the rule is enabled. Defaults to <code class="literal">true</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>false_positives</p></td>
<td align="left" valign="top"><p>String[]</p></td>
<td align="left" valign="top"><p>String array used to describe common reasons why
the rule may issue false-positive alerts. Defaults to an empty array.</p>
<p><a id="detection-rules-from"></a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>from</p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>Time from which data is analyzed each time the rule executes,
using a <a href="/guide/en/elasticsearch/reference/8.14/common-options.html#date-math" class="ulink" target="_top">date math range</a>. For example,
<code class="literal">now-4200s</code> means the rule analyzes data from 70 minutes before its start
time. Defaults to <code class="literal">now-6m</code> (analyzes data from 6 minutes before the start
time).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>interval</p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>Frequency of rule execution, using a
<a href="/guide/en/elasticsearch/reference/8.14/common-options.html#date-math" class="ulink" target="_top">date math range</a>. For example, <code class="literal">"1h"</code>
means the rule runs every hour. Defaults to <code class="literal">5m</code> (5 minutes).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>license</p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>The rule&#8217;s license.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>max_signals</p></td>
<td align="left" valign="top"><p>Integer</p></td>
<td align="left" valign="top"><p>Maximum number of alerts the rule can create during a
single execution. Defaults to <code class="literal">100</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>meta</p></td>
<td align="left" valign="top"><p>Object</p></td>
<td align="left" valign="top">
<p>Placeholder for metadata about the rule.</p>
<p><span class="strong strong"><strong>NOTE</strong></span>: This field is overwritten when you save changes to the rule&#8217;s settings.</p>
</td>
</tr>
<tr>
<td align="left" valign="top"><p>note</p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>Notes to help investigate alerts produced by the rule.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>references</p></td>
<td align="left" valign="top"><p>String[]</p></td>
<td align="left" valign="top"><p>Array containing notes about or references to
relevant information about the rule. Defaults to an empty array.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>setup</p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>Populates the rule&#8217;s setup guide with instructions on rule
prerequisites such as required integrations, configuration steps, and anything
else needed for the rule to work correctly.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>tags</p></td>
<td align="left" valign="top"><p>String[]</p></td>
<td align="left" valign="top"><p>String array containing words and phrases to help categorize,
filter, and search rules. Defaults to an empty array.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>threat</p></td>
<td align="left" valign="top"><p><a class="xref" href="rules-api-create.html#threats-object-create" title="threat schema">threat[]</a></p></td>
<td align="left" valign="top"><p>Object containing attack
information about the type of threat the rule monitors, see
<a href="/guide/en/ecs/8.11/ecs-threat.html" class="ulink" target="_top">ECS threat fields</a>. Defaults to an empty array.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>throttle</p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top">
<p>Determines how often actions are taken:</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The rule level <code class="literal">throttle</code> field is deprecated in Elastic Security 8.8 and will remain active for at least the next 12 months.</p>
<p>In Elastic Security 8.8 and later, you can use the (<a class="xref" href="bulk-actions-rules-api.html#optional-actions-fields-bulk-update" title="Optional action fields"><code class="literal">frequency</code></a>) field to define frequencies for individual actions. Actions without frequencies will acquire a converted version of the rule&#8217;s <code class="literal">throttle</code> field. In the response, the converted <code class="literal">throttle</code> setting appears in the individual actions' <code class="literal">frequency</code> field.</p>
</div>
</div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">no_actions</code>: Never
</li>
<li class="listitem">
<code class="literal">rule</code>: Every time new alerts are detected
</li>
<li class="listitem">
<code class="literal">1h</code>: Every hour
</li>
<li class="listitem">
<code class="literal">1d</code>: Every day
</li>
<li class="listitem">
<code class="literal">7d</code>: Every week
</li>
</ul>
</div>
<p>Required when <code class="literal">actions</code> are used to send notifications.</p>
</td>
</tr>
<tr>
<td align="left" valign="top"><p>version</p></td>
<td align="left" valign="top"><p>Integer</p></td>
<td align="left" valign="top">
<p>The rule&#8217;s version number. If this is not provided, the
rule&#8217;s version number is incremented by 1.</p>
<p><code class="literal">PATCH</code> calls enabling and disabling the rule do not increment its version
number.</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_optional_fields_for_threat_match_rules"></a>Optional fields for threat-match rules<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.14/docs/detections/api/rules/rules-api-update.asciidoc">edit</a></h4>
</div></div></div>
<div class="informaltable">
<table border="1" cellpadding="4px" width="100%">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>threat_filters</p></td>
<td align="left" valign="top"><p>Object[]</p></td>
<td align="left" valign="top"><p><a href="/guide/en/elasticsearch/reference/8.14/query-filter-context.html" class="ulink" target="_top">Query and filter context</a> array used to filter
documents from the Elasticsearch index containing the threat values.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>threat_indicator_path</p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>Much like an ingest processor, users can use this field to define where their threat indicator can be found on their indicator documents. Defaults to <code class="literal">threatintel.indicator</code>.</p></td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_optional_fields_for_query_threat_match_threshold_and_new_terms_rules"></a>Optional fields for query, threat-match, threshold, and new terms rules<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.14/docs/detections/api/rules/rules-api-update.asciidoc">edit</a></h4>
</div></div></div>
<div class="informaltable">
<table border="1" cellpadding="4px" width="100%">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>language</p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>Determines the query language, which must be
<code class="literal">kuery</code> or <code class="literal">lucene</code>. Defaults to <code class="literal">kuery</code>.</p></td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_optional_fields_for_eql_query_threshold_indicator_match_new_terms_rules_and_esql_rules"></a>Optional fields for EQL, query, threshold, indicator match, new terms rules, and ES|QL rules<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.14/docs/detections/api/rules/rules-api-update.asciidoc">edit</a></h4>
</div></div></div>
<div class="informaltable">
<table border="1" cellpadding="4px" width="100%">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>filters</p></td>
<td align="left" valign="top"><p>Object[]</p></td>
<td align="left" valign="top">
<p>The <a href="/guide/en/elasticsearch/reference/8.14/query-filter-context.html" class="ulink" target="_top">query and filter
context</a> array used to define the conditions for when alerts are created from
events. Defaults to an empty array.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This field is not supported for ES|QL rules.</p>
</div>
</div>
</td>
</tr>
<tr>
<td align="left" valign="top"><p>index</p></td>
<td align="left" valign="top"><p>String[]</p></td>
<td align="left" valign="top">
<p>Indices on which the rule functions. Defaults to the
Security Solution indices defined on the Kibana Advanced Settings page
(<span class="strong strong"><strong>Kibana</strong></span> → <span class="strong strong"><strong>Stack Management</strong></span> → <span class="strong strong"><strong>Advanced Settings</strong></span> →
<code class="literal">securitySolution:defaultIndex</code>).</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This field is not supported for ES|QL rules.</p>
</div>
</div>
</td>
</tr>
<tr>
<td align="left" valign="top"><p>risk_score_mapping</p></td>
<td align="left" valign="top"><p>Object[]</p></td>
<td align="left" valign="top">
<p>Overrides generated alerts' <code class="literal">risk_score</code> with
a value from the source event:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">field</code> (string, required): Source event field used to override the default
<code class="literal">risk_score</code>. This field must be an integer.
</li>
<li class="listitem">
<code class="literal">operator</code> (string, required): Must be <code class="literal">equals</code>.
</li>
<li class="listitem">
<code class="literal">value</code>(string, required): Must be an empty string (<code class="literal">""</code>).
</li>
</ul>
</div>
</td>
</tr>
<tr>
<td align="left" valign="top"><p>rule_name_override</p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>Sets which field in the source event is used to
populate the alert&#8217;s <code class="literal">signal.rule.name</code> value (in the UI, this value is
displayed on the <span class="strong strong"><strong>Rules</strong></span> page in the <span class="strong strong"><strong>Rule</strong></span> column). When unspecified, the
rule&#8217;s <code class="literal">name</code> value is used. The source field must be a string data type.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>severity_mapping</p></td>
<td align="left" valign="top"><p>Object[]</p></td>
<td align="left" valign="top">
<p>Overrides generated alerts' <code class="literal">severity</code> with
values from the source event:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">field</code> (string, required): Source event field used to override the default
<code class="literal">severity</code>.
</li>
<li class="listitem">
<code class="literal">operator</code> (string, required): Must be <code class="literal">equals</code>.
</li>
<li class="listitem">
<code class="literal">severity</code> (string, required): Mapped severity value, must be <code class="literal">low</code>,
<code class="literal">medium</code>, <code class="literal">high</code>, or <code class="literal">critical</code>.
</li>
<li class="listitem">
<code class="literal">value</code>(string, required): Field value used to determine the <code class="literal">severity</code>.
</li>
</ul>
</div>
</td>
</tr>
<tr>
<td align="left" valign="top"><p>timestamp_override</p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>Sets the time field used to query indices.
When unspecified, rules query the <code class="literal">@timestamp</code> field. The source field
must be an Elasticsearch date data type.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>exceptions_list</p></td>
<td align="left" valign="top"><p>Object[]</p></td>
<td align="left" valign="top">
<p>Array of
<a class="xref" href="exceptions-api-overview.html" title="Exceptions API">exception containers</a>, which define
exceptions that prevent the rule from generating alerts even when its other
criteria are met. The object has these fields:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">id</code> (string, required): ID of the exception container.
</li>
<li class="listitem">
<code class="literal">list_id</code> (string, required): List ID of the exception container.
</li>
<li class="listitem">
<code class="literal">namespace_type</code> (string required): Determines whether the exceptions are
valid in only the rule&#8217;s Kibana space (<code class="literal">single</code>) or in all Kibana spaces
(<code class="literal">agnostic</code>).
</li>
<li class="listitem">
<code class="literal">type</code> (string, required): The exception type, which must be either
a detection rule exception (<code class="literal">detection</code>) or an endpoint exception (<code class="literal">endpoint</code>).
</li>
</ul>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="opt-fields-eql-update"></a>Optional fields for EQL rules<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.14/docs/detections/api/rules/rules-api-update.asciidoc">edit</a></h4>
</div></div></div>
<div class="informaltable">
<table border="1" cellpadding="4px" width="100%">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>event_category_field</p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>Contains the event classification, such as <code class="literal">process</code>, <code class="literal">file</code>, or <code class="literal">network</code>. This field is typically mapped as a field type in the <a href="/guide/en/elasticsearch/reference/8.14/keyword.html" class="ulink" target="_top">keyword family</a>. Defaults to the <code class="literal">event.category</code> ECS field.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>tiebreaker_field</p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>Sets a secondary field for sorting events (in ascending, lexicographic order) if they have the same timestamp.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>timestamp_field</p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>Contains the event timestamp used for sorting a sequence of events. This is different from <code class="literal">timestamp_override</code>, which is used for querying events within a range. Defaults to the <code class="literal">@timestamp</code> ECS field.</p></td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="actions-object-schema-update"></a><code class="literal">actions</code> schema<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.14/docs/detections/api/rules/rules-api-update.asciidoc">edit</a></h4>
</div></div></div>
<p>These fields are required when calling <code class="literal">PUT</code> to modify the <code class="literal">actions</code> object:</p>
<div class="informaltable">
<table border="1" cellpadding="4px" width="100%">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>action_type_id</p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top">
<p>The action type used for sending notifications, can
be:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">.slack</code>
</li>
<li class="listitem">
<code class="literal">.slack_api</code>
</li>
<li class="listitem">
<code class="literal">.email</code>
</li>
<li class="listitem">
<code class="literal">.index</code>
</li>
<li class="listitem">
<code class="literal">.pagerduty</code>
</li>
<li class="listitem">
<code class="literal">.swimlane</code>
</li>
<li class="listitem">
<code class="literal">.webhook</code>
</li>
<li class="listitem">
<code class="literal">.servicenow</code>
</li>
<li class="listitem">
<code class="literal">.servicenow-itom</code>
</li>
<li class="listitem">
<code class="literal">.servicenow-sir</code>
</li>
<li class="listitem">
<code class="literal">.jira</code>
</li>
<li class="listitem">
<code class="literal">.resilient</code>
</li>
<li class="listitem">
<code class="literal">.opsgenie</code>
</li>
<li class="listitem">
<code class="literal">.teams</code>
</li>
<li class="listitem">
<code class="literal">.torq</code>
</li>
<li class="listitem">
<code class="literal">.tines</code>
</li>
<li class="listitem">
<code class="literal">.d3security</code>
</li>
</ul>
</div>
</td>
</tr>
<tr>
<td align="left" valign="top"><p>group</p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>Optionally groups actions by use cases. Use <code class="literal">default</code> for alert
notifications.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>id</p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>The connector ID.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>params</p></td>
<td align="left" valign="top"><p>Object</p></td>
<td align="left" valign="top">
<p>Object containing the allowed connector fields, which varies according to the connector type:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>For Slack:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">message</code> (string, required): The notification message.
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>For email:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">to</code>, <code class="literal">cc</code>, <code class="literal">bcc</code> (string): Email addresses to which the notifications are
sent. At least one field must have a value.
</li>
<li class="listitem">
<code class="literal">subject</code> (string, optional): Email subject line.
</li>
<li class="listitem">
<code class="literal">message</code> (string, required): Email body text.
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>For Webhook:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">body</code> (string, required): JSON payload.
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>For PagerDuty:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">severity</code> (string, required): Severity of on the alert notification, can
be: <code class="literal">Critical</code>, <code class="literal">Error</code>, <code class="literal">Warning</code> or <code class="literal">Info</code>.
</li>
<li class="listitem">
<code class="literal">eventAction</code> (string, required):  Event <a href="https://v2.developer.pagerduty.com/docs/events-api-v2#event-action" class="ulink" target="_top">action type</a>, which can be <code class="literal">trigger</code>,
<code class="literal">resolve</code>, or <code class="literal">acknowledge</code>.
</li>
<li class="listitem">
<code class="literal">dedupKey</code> (string, optional): Groups alert notifications with the same
PagerDuty alert.
</li>
<li class="listitem">
<code class="literal">timestamp</code> (DateTime, optional): <a href="https://v2.developer.pagerduty.com/v2/docs/types#datetime" class="ulink" target="_top">ISO-8601 format timestamp</a>.
</li>
<li class="listitem">
<code class="literal">component</code> (string, optional): Source machine component responsible for the
event, for example <code class="literal">security-solution</code>.
</li>
<li class="listitem">
<code class="literal">group</code> (string, optional): Enables logical grouping of service components.
</li>
<li class="listitem">
<code class="literal">source</code> (string, optional): The affected system. Defaults to the Kibana
saved object ID of the action.
</li>
<li class="listitem">
<code class="literal">summary</code> (string, options): Summary of the event. Defaults to
<code class="literal">No summary provided</code>. Maximum length is 1024 characters.
</li>
<li class="listitem">
<code class="literal">class</code> (string, optional): Value indicating the class/type of the event.
</li>
</ul>
</div>
</li>
</ul>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<h5><a id="optional-actions-fields-rule-update"></a>Optional <code class="literal">action</code> fields<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.14/docs/detections/api/rules/rules-api-update.asciidoc">edit</a></h5>
<div class="informaltable">
<table border="1" cellpadding="4px" width="100%">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>frequency</p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top">
<p>Object containing an action’s frequency:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">summary</code> (Boolean, required): Defines whether to send notifications as a summary of alerts or for each generated alert.
</li>
<li class="listitem">
<p><code class="literal">notifyWhen</code> (String, required`): Defines how often alerts generate actions. Valid values are:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">onActiveAlert</code>: Actions run when the alert is generated.
</li>
<li class="listitem">
<code class="literal">onThrottleInterval</code>: Actions run on the specified throttle interval and summarize new alerts generated during that interval.
</li>
</ul>
</div>
</li>
<li class="listitem">
<code class="literal">throttle</code> (String, optional): Defines how often an alert generates repeated actions. This custom action interval must be specified in seconds, minutes, hours, or days. For example, <code class="literal">10m</code> or <code class="literal">1h</code>. This property is used only if <code class="literal">notifyWhen</code> is <code class="literal">onThrottleInterval</code>.
</li>
</ul>
</div>
</td>
</tr>
<tr>
<td align="left" valign="top"><p>alerts_filter</p></td>
<td align="left" valign="top"><p>Object</p></td>
<td align="left" valign="top">
<p>Object containing an action’s conditional filters:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p><code class="literal">timeframe</code> (Object, optional): Object containing the time frame for when this action can be run.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">days</code> (Array of integers, required): List of days of the week on which this action can be run. Days of the week are expressed as numbers between <code class="literal">1-7</code>, where <code class="literal">1</code> is Monday and <code class="literal">7</code> is Sunday. To select all days of the week, enter an empty array.
</li>
<li class="listitem">
<p><code class="literal">hours</code> (Object, required): The hours of the day during which this action can run. Hours of the day are expressed as two strings in the format <code class="literal">hh:mm</code> in <code class="literal">24</code> hour time. A start of <code class="literal">00:00</code> and an end of <code class="literal">24:00</code> means the action can run all day.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">start</code> (String, required)
</li>
<li class="listitem">
<code class="literal">end</code> (String, required)
</li>
</ul>
</div>
</li>
<li class="listitem">
<code class="literal">timezone</code> (String, required): An ISO timezone name, such as <code class="literal">Europe/Madrid</code> or <code class="literal">America/New_York</code>. Specific offsets such as UTC or UTC+1 will also work, but lack built-in DST.
</li>
</ul>
</div>
</li>
<li class="listitem">
<p><code class="literal">query</code> (Object, optional): Object containing a query filter which gets applied to an action and determines whether the action should run.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">kql</code> (String, required): A KQL string.
</li>
<li class="listitem">
<code class="literal">filters</code> (Array of objects, required): A filter object, as defined in the <code class="literal">kbn-es-query</code> package.
</li>
</ul>
</div>
</li>
</ul>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="threats-object-update"></a><code class="literal">threat</code> schema<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.14/docs/detections/api/rules/rules-api-update.asciidoc">edit</a></h4>
</div></div></div>
<p>These fields are required when calling <code class="literal">PUT</code> to modify the <code class="literal">threat</code> object:</p>
<div class="informaltable">
<table border="1" cellpadding="4px" width="100%">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>framework</p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>Relevant attack framework.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>tactic</p></td>
<td align="left" valign="top"><p>Object</p></td>
<td align="left" valign="top">
<p>Object containing information on the attack type:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">id</code> - string, required
</li>
<li class="listitem">
<code class="literal">name</code> - string, required
</li>
<li class="listitem">
<code class="literal">reference</code> - string, required
</li>
</ul>
</div>
</td>
</tr>
<tr>
<td align="left" valign="top"><p>technique</p></td>
<td align="left" valign="top"><p>Object</p></td>
<td align="left" valign="top">
<p>Object containing information on the attack
technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">id</code> - string, required
</li>
<li class="listitem">
<code class="literal">name</code> - string, required
</li>
<li class="listitem">
<code class="literal">reference</code> - string, required
</li>
</ul>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Only threats described using the MITRE ATT&amp;CK<sup>TM</sup> framework are displayed
in the UI (<span class="strong strong"><strong>Rules</strong></span> &#8594; <span class="strong strong"><strong>Detection rules (SIEM)</strong></span> &#8594; <span class="strong strong"><strong><em>Rule name</em></strong></span>).</p>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="opt-fields-alert-suppression-update"></a>Optional alert suppression fields for query, indicator match, threshold, event correlation (non-sequence queries only), and new terms rules<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.14/docs/detections/api/rules/rules-api-update.asciidoc">edit</a></h4>
</div></div></div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>Alert suppression is in technical preview for threshold, indicator match, event correlation, and new terms rules. The functionality may be changed or removed in a future release. Elastic will work to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h5 class="title"><a id="_query_indicator_match_event_correlation_non_sequence_queries_only_and_new_terms_rules_2"></a>Query, indicator match, event correlation (non-sequence queries only), and new terms rules<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.14/docs/detections/api/rules/rules-api-update.asciidoc">edit</a></h5>
</div></div></div>
<div class="informaltable">
<table border="1" cellpadding="4px" width="100%">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>alert_suppression</p></td>
<td align="left" valign="top"><p>Object</p></td>
<td align="left" valign="top">
<p>Defines alert suppression configuration. Available fields:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">group_by</code> (string[], required): An array of 1-3 field names to use for suppressing alerts.
</li>
<li class="listitem">
<code class="literal">duration</code> (<a class="xref" href="rules-api-create.html#alert-suppression-duration-schema" title="alert_suppression.duration schema">duration object</a>, optional): The time period in which alerts will be suppressed, beginning when the rule first meets its criteria and creates the alert. If not specified, alerts will be suppressed on rule execution only.
</li>
<li class="listitem">
<p><code class="literal">missing_fields_strategy</code> (string, optional): Defines how to handle events with missing suppression fields. Possible values:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">doNotSuppress</code>: Create a separate alert for each matching event.
</li>
<li class="listitem">
<code class="literal">suppress</code>: Create one alert for each group of events with missing fields.
</li>
</ul>
</div>
</li>
</ul>
</div>
</td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h5 class="title"><a id="_threshold_rule_2"></a>Threshold rule<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.14/docs/detections/api/rules/rules-api-update.asciidoc">edit</a></h5>
</div></div></div>
<div class="informaltable">
<table border="1" cellpadding="4px" width="100%">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>alert_suppression</p></td>
<td align="left" valign="top">
<p>Object</p>
</td>
<td align="left" valign="top"><p>Defines alert suppression configuration. Available fields:</p>
<p>* <code class="literal">duration</code> (<a class="xref" href="rules-api-create.html#alert-suppression-duration-schema" title="alert_suppression.duration schema">duration object</a>, required): The time period in which alerts will be suppressed, beginning when the rule first meets its criteria and creates the alert.</p></td>
</tr>
</tbody>
</table>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_example_request_3"></a>Example request<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.14/docs/detections/api/rules/rules-api-update.asciidoc">edit</a></h4>
</div></div></div>
<p>Updates the <code class="literal">threat</code> object:</p>
<div class="pre_wrapper lang-kibana">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-kibana">PATCH api/detection_engine/rules
{
  "rule_id": "process_started_by_ms_office_program_possible_payload",
  "threat": [
   {
      "framework": "MITRE ATT&amp;CK",
      "tactic": {
         "id": "TA0001",
         "reference": "https://attack.mitre.org/tactics/TA0001",
         "name": "Initial Access"
      },
      "technique": [
         {
            "id": "T1193",
            "name": "Spearphishing Attachment",
            "reference": "https://attack.mitre.org/techniques/T1193"
         }
      ]
   }
  ]
}</pre>
</div>
<div class="kibana_widget" data-snippet="snippets/19.kibana"></div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_response_code_4"></a>Response code<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.14/docs/detections/api/rules/rules-api-update.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">200</code>
</span>
</dt>
<dd>
Indicates a successful call.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_response_payload_4"></a>Response payload<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.14/docs/detections/api/rules/rules-api-update.asciidoc">edit</a></h3>
</div></div></div>
<p>The rule&#8217;s updated JSON object, including the time the rule was updated and an
incremented version number.</p>
<p>Example response:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
  "created_at": "2020-01-05T09:56:11.805Z",
  "updated_at": "2020-01-05T09:59:59.129Z",
  "created_by": "elastic",
  "description": "Process started by MS Office program - possible payload",
  "enabled": false,
  "false_positives": [],
  "filters": [
    {
      "query": {
        "match": {
          "event.action": {
            "query": "Process Create (rule: ProcessCreate)",
            "type": "phrase"
          }
        }
      }
    }
  ],
  "from": "now-6m",
  "id": "4f228868-9928-47e4-9785-9a1a9b520c7f",
  "interval": "5m",
  "rule_id": "process_started_by_ms_office_program_possible_payload",
  "language": "kuery",
  "max_signals": 100,
  "risk_score": 50,
  "name": "MS Office child process",
  "query": "process.parent.name:EXCEL.EXE or process.parent.name:MSPUB.EXE or process.parent.name:OUTLOOK.EXE or process.parent.name:POWERPNT.EXE or process.parent.name:VISIO.EXE or process.parent.name:WINWORD.EXE",
  "references": [],
  "severity": "low",
  "updated_by": "elastic",
  "tags": [
    "child process",
    "ms office"
  ],
  "related_integrations": [],       <a id="CO20-1"></a><i class="conum" data-value="1"></i>
  "required_fields": [],            <a id="CO20-2"></a><i class="conum" data-value="1"></i>
  "setup": "",
  "type": "query",
  "threat": [
    {
      "framework": "MITRE ATT&amp;CK",
      "tactic": {
        "id": "TA0001",
        "reference": "https://attack.mitre.org/tactics/TA0001",
        "name": "Initial Access"
      },
      "technique": [
        {
          "id": "T1193",
          "name": "Spearphishing Attachment",
          "reference": "https://attack.mitre.org/techniques/T1193"
        }
      ]
    }
  ],
  "execution_summary": {                      <a id="CO20-3"></a><i class="conum" data-value="1"></i>
    "last_execution": {
      "date": "2022-03-23T16:06:12.787Z",
      "status": "partial failure",
      "status_order": 20,
      "message": "This rule attempted to query data from Elasticsearch indices listed in the \"Index pattern\" section of the rule definition, but no matching index was found.",
      "metrics": {
          "total_search_duration_ms": 135,
          "total_indexing_duration_ms": 15,
          "execution_gap_duration_s": 0,
      }
    }
  },
  "version": 2
}</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO20-1"><i class="conum" data-value="1"></i></a><a href="#CO20-2"></a><a href="#CO20-3"></a></p>
</td>
<td align="left" valign="top">
<p><span class="Admonishment Admonishment--dev">
[<span class="Admonishment-title u-mono">dev</span>]
<span class="Admonishment-detail">
This functionality is in development and may be changed or removed completely in a future release. These features are unsupported and not subject to the support SLA of official GA features.
</span>
</span> These fields are under development and their usage or schema may change: <code class="literal">related_integrations</code>, <code class="literal">required_fields</code>, and <code class="literal">execution_summary</code>.</p>
</td>
</tr>
</table>
</div>
</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="rules-api-find.html">« Find rules</a>
</span>
<span class="next">
<a href="rules-api-delete.html">Delete rule »</a>
</span>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>

                        <!-- Feedback widget -->
                        <div id="feedbackWidgetContainer"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


        <div id='elastic-footer'></div>
        <script src='https://www.elastic.co/elastic-footer.js'></script>
        <!-- Footer Section end-->

      </section>
    </div>

    <!-- Feedback modal -->
    <div id="feedbackModalContainer"></div>

    <script src="/guide/static/jquery.js"></script>
    <script type="text/javascript" src="/guide/static/docs-v1.js"></script>
    <script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
