<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Configure an integration policy for Elastic Defend | Elastic Security Solution [8.15] | Elastic</title>
<meta class="elastic" name="content" content="Configure an integration policy for Elastic Defend | Elastic Security Solution [8.15]">

<link rel="home" href="index.html" title="Elastic Security Solution [8.15]"/>
<link rel="up" href="getting-started.html" title="Get started with Elastic Security"/>
<link rel="prev" href="offline-endpoint.html" title="Configure offline endpoints and air-gapped environments"/>
<link rel="next" href="artifact-control.html" title="Configure updates for protection artifacts"/>
<meta class="elastic" name="product_version" content="8.15"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.15"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.15"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles-v1.css" />
  </head>

  <!--© 2015-2025 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div class="navheader">
<span class="prev">
<a href="offline-endpoint.html">« Configure offline endpoints and air-gapped environments</a>
</span>
<span class="next">
<a href="artifact-control.html">Configure updates for protection artifacts »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [8.15]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="getting-started.html">Get started with Elastic Security</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Configure an integration policy for Elastic Defend</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.15/docs/getting-started/configure-integration-policy.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="chapter">
<div class="titlepage"><div><div>
<h2 class="title"><a id="configure-endpoint-integration-policy"></a>Configure an integration policy for Elastic Defend<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.15/docs/getting-started/configure-integration-policy.asciidoc">edit</a></h2>
</div></div></div>
<p>After the Elastic Agent is installed with the Elastic Defend integration, several protections features — including
preventions against malware, ransomware, memory threats, and malicious behavior — are automatically enabled
on protected hosts (some features require a Platinum or Enterprise license). If needed, you can update the
integration policy to configure protection settings, event collection, antivirus settings, trusted applications,
event filters, host isolation exceptions, and blocked applications to meet your organization&#8217;s security needs.</p>
<p>You can also create multiple Elastic Defend integration policies to maintain unique configuration profiles. To create an additional Elastic Defend integration policy, go to <span class="strong strong"><strong>Management</strong></span> &#8594; <span class="strong strong"><strong>Integrations</strong></span>, then follow the steps for <a class="xref" href="install-endpoint.html#add-security-integration" title="Add the Elastic Defend integration">adding the Elastic Defend integration</a>.</p>
<div class="sidebar">
<div class="titlepage"><div><div>
<p class="title"><strong>Requirements</strong></p>
</div></div></div>
<p>You must have the <span class="strong strong"><strong>Elastic Defend Policy Management : All</strong></span> <a class="xref" href="endpoint-management-req.html" title="Elastic Defend feature privileges">privilege</a> to configure an integration policy.</p>
</div>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>In addition to configuring an Elastic Defend policy through the Elastic Security UI, you can create and customize an Elastic Defend policy <a class="xref" href="create-defend-policy-api.html" title="Create an Elastic Defend policy using API">through the API</a>.</p>
</div>
</div>
<p>To configure an integration policy:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
In the Elastic Security app, go to <span class="strong strong"><strong>Manage</strong></span> &#8594; <span class="strong strong"><strong>Policies</strong></span> to view the <span class="strong strong"><strong>Policies</strong></span> page.
</li>
<li class="listitem">
Select the integration policy you want to configure. The integration policy configuration page appears.
</li>
<li class="listitem">
<p>On the <span class="strong strong"><strong>Policy settings</strong></span> tab, review and configure the following settings as appropriate:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="configure-endpoint-integration-policy.html#malware-protection" title="Malware protection">Malware protection</a>
</li>
<li class="listitem">
<a class="xref" href="configure-endpoint-integration-policy.html#ransomware-protection" title="Ransomware protection">Ransomware protection</a>
</li>
<li class="listitem">
<a class="xref" href="configure-endpoint-integration-policy.html#memory-protection" title="Memory threat protection">Memory threat protection</a>
</li>
<li class="listitem">
<a class="xref" href="configure-endpoint-integration-policy.html#behavior-protection" title="Malicious behavior protection">Malicious behavior protection</a>
</li>
<li class="listitem">
<a class="xref" href="configure-endpoint-integration-policy.html#attack-surface-reduction" title="Attack surface reduction">Attack surface reduction</a>
</li>
<li class="listitem">
<a class="xref" href="configure-endpoint-integration-policy.html#event-collection" title="Event collection">Event collection</a>
</li>
<li class="listitem">
<a class="xref" href="configure-endpoint-integration-policy.html#register-as-antivirus" title="Register Elastic Security as antivirus (optional)">Register Elastic Security as antivirus (optional)</a>
</li>
<li class="listitem">
<a class="xref" href="configure-endpoint-integration-policy.html#adv-policy-settings" title="Advanced policy settings (optional)">Advanced policy settings (optional)</a>
</li>
<li class="listitem">
<a class="xref" href="configure-endpoint-integration-policy.html#save-policy" title="Save the general policy settings">Save the general policy settings</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Click the <span class="strong strong"><strong>Trusted applications</strong></span>, <span class="strong strong"><strong>Event filters</strong></span>, <span class="strong strong"><strong>Host isolation exceptions</strong></span>,
and <span class="strong strong"><strong>Blocklist</strong></span> tabs to review the endpoint policy artifacts assigned to this integration policy
(for more information, refer to <a class="xref" href="trusted-apps-ov.html" title="Trusted applications"><em>Trusted applications</em></a>, <a class="xref" href="event-filters.html" title="Event filters"><em>Event filters</em></a>, <a class="xref" href="host-isolation-exceptions.html" title="Host isolation exceptions"><em>Host isolation exceptions</em></a>, and <a class="xref" href="blocklist.html" title="Blocklist"><em>Blocklist</em></a>). On these tabs, you can:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Expand and view an artifact — Click the arrow next to its name.
</li>
<li class="listitem">
View an artifact&#8217;s details — Click the actions menu (<span class="strong strong"><strong>&#8230;&#8203;</strong></span>), then select <span class="strong strong"><strong>View full details</strong></span>.
</li>
<li class="listitem">
Unassign an artifact (Platinum or Enterprise subscription) — Click the actions menu (<span class="strong strong"><strong>&#8230;&#8203;</strong></span>),
then select <span class="strong strong"><strong>Remove from policy</strong></span>. This does not delete the artifact; this just unassigns it from the current policy.
</li>
<li class="listitem">
Assign an existing artifact (Platinum or Enterprise subscription) — Click <span class="strong strong"><strong>Assign <em>x</em> to policy</strong></span>,
then select an item from the flyout. This view lists any existing artifacts that aren&#8217;t already assigned to the current policy.
</li>
</ul>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>You can&#8217;t create a new endpoint policy artifact while configuring an integration policy.
To create a new artifact, go to its main page in the Elastic Security app (for example,
to create a new trusted application, go to <span class="strong strong"><strong>Manage</strong></span> &#8594; <span class="strong strong"><strong>Trusted applications</strong></span>).</p>
</div>
</div>
</li>
<li class="listitem">
Click the <span class="strong strong"><strong>Protection updates</strong></span> tab to configure how Elastic Defend receives updates from Elastic with the latest threat detections, malware models, and other protection artifacts. Refer to <a class="xref" href="artifact-control.html" title="Configure updates for protection artifacts">Configure updates for protection artifacts</a> for more information.
</li>
</ol>
</div>
<h3><a id="malware-protection"></a>Malware protection<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.15/docs/getting-started/configure-integration-policy.asciidoc">edit</a></h3>
<p>Elastic Defend malware prevention detects and stops malicious attacks by using a <a class="xref" href="detection-engine-overview.html#machine-learning-model" title="Machine learning model">machine learning model</a>
that looks for static attributes to determine if a file is malicious or benign.</p>
<p>By default, malware protection is enabled on Windows, macOS, and Linux hosts.
To disable malware protection, turn off the <span class="strong strong"><strong>Malware protections</strong></span> toggle.</p>
<p>Malware protection levels are:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Detect</strong></span>: Detects malware on the host and generates an alert. The agent will <span class="strong strong"><strong>not</strong></span> block malware.
You must pay attention to and analyze any malware alerts that are generated.
</li>
<li class="listitem">
<span class="strong strong"><strong>Prevent</strong></span> (Default): Detects malware on the host, blocks it from executing, and generates an alert.
</li>
</ul>
</div>
<p>These additional options are available for malware protection:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Blocklist</strong></span>: Enable or disable the <a class="xref" href="blocklist.html" title="Blocklist">blocklist</a> for all hosts associated with this Elastic Defend policy. The blocklist allows you to prevent specified applications from running on hosts, extending the list of processes that Elastic Defend considers malicious.
</li>
<li class="listitem">
<span class="strong strong"><strong>Scan files upon modification</strong></span>: By default, Elastic Defend scans files every time they&#8217;re modified, which can be resource-intensive on hosts where files are frequently modified, such as servers and developer machines. Turn off this option to only scan files when they&#8217;re executed. Elastic Defend will continue to identify malware as it attempts to run, providing a robust level of protection while improving endpoint performance.
</li>
</ul>
</div>
<p>Select <span class="strong strong"><strong>Notify user</strong></span> to send a push notification in the host operating system when activity is detected or prevented. Notifications are enabled by default for the <span class="strong strong"><strong>Prevent</strong></span> option.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>Platinum and Enterprise customers can customize these notifications using the <code class="literal">Elastic Security {action} {filename}</code> syntax.</p>
</div>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="images/install-endpoint/malware-protection.png" alt="Detail of malware protection section.">
</div>
</div>
<h4><a id="manage-quarantined-files"></a>Manage quarantined files<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.15/docs/getting-started/configure-integration-policy.asciidoc">edit</a></h4>
<p>When <span class="strong strong"><strong>Prevent</strong></span> is enabled for malware protection, Elastic Defend will quarantine any malicious file it finds. Specifically Elastic Defend will remove the file from its current location, encrypt it with the encryption key <code class="literal">ELASTIC</code>, move it to a different folder, and rename it as a GUID string, such as <code class="literal">318e70c2-af9b-4c3a-939d-11410b9a112c</code>.</p>
<p>The quarantine folder location varies by operating system:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
macOS: <code class="literal">/System/Volumes/Data/.equarantine</code>
</li>
<li class="listitem">
Linux: <code class="literal">.equarantine</code> at the root of the mount point of the file being quarantined
</li>
<li class="listitem">
Windows - Elastic Defend versions 8.5 and later: <code class="literal">[DriveLetter:]\.quarantine</code>, unless the files are from the <code class="literal">C:</code> drive. These files are moved to <code class="literal">C:\Program Files\Elastic\Endpoint\state\.equarantine</code>.
</li>
<li class="listitem">
Windows - Elastic Defend versions 8.4 and earlier: <code class="literal">[DriveLetter:]\.quarantine</code>, for any drive
</li>
</ul>
</div>
<p>To restore a quarantined file to its original state and location, <a class="xref" href="add-exceptions.html" title="Add and manage exceptions">add an exception</a> to the rule that identified the file as malicious. If the exception would&#8217;ve stopped the rule from identifying the file as malicious, Elastic Defend restores the file.</p>
<p>You can access a quarantined file by using the <code class="literal">get-file</code> <a class="xref" href="response-actions.html#response-action-commands" title="Response action commands">response action command</a> in the response console. To do this, copy the path from the alert&#8217;s <span class="strong strong"><strong>Quarantined file path</strong></span> field (<code class="literal">file.Ext.quarantine_path</code>), which appears under <span class="strong strong"><strong>Highlighted fields</strong></span> in the alert details flyout. Then paste the value into the <code class="literal">--path</code> parameter. This action doesn&#8217;t restore the file to its original location, so you will need to do this manually.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Response actions and the response console UI are <a href="/pricing" class="ulink" target="_top">Enterprise subscription</a> features.</p>
</div>
</div>
<h3><a id="ransomware-protection"></a>Ransomware protection<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.15/docs/getting-started/configure-integration-policy.asciidoc">edit</a></h3>
<p>Behavioral ransomware prevention detects and stops ransomware attacks on Windows systems by
analyzing data from low-level system processes. It is effective across an array of widespread
ransomware families — including those targeting the system’s master boot record.</p>
<p>Ransomware protection is a paid feature and is enabled by default if you have a <a href="/pricing" class="ulink" target="_top">Platinum or Enterprise license</a>.
If you upgrade to a Platinum or Enterprise license from Basic or Gold, ransomware protection will be disabled by default.</p>
<p>Ransomware protection levels are:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Detect</strong></span>: Detects ransomware on the host and generates an alert. Elastic Defend
will <span class="strong strong"><strong>not</strong></span> block ransomware. You must pay attention to and analyze any ransomware alerts that are generated.
</li>
<li class="listitem">
<span class="strong strong"><strong>Prevent</strong></span> (Default): Detects ransomware on the host, blocks it from executing,
and generates an alert.
</li>
</ul>
</div>
<p>When ransomware protection is enabled, canary files placed in targeted locations on your hosts provide an early warning system for potential ransomware activity. When a canary file is modified, Elastic Defend immediately generates a ransomware alert. If <span class="strong strong"><strong>prevent</strong></span> ransomware is active, Elastic Defend terminates the process that modified the file.</p>
<p>Select <span class="strong strong"><strong>Notify user</strong></span> to send a push notification in the host operating system when activity is detected or prevented. Notifications are enabled by default for the <span class="strong strong"><strong>Prevent</strong></span> option.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>Platinum and Enterprise customers can customize these notifications using the <code class="literal">Elastic Security {action} {filename}</code> syntax.</p>
</div>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="images/install-endpoint/ransomware-protection.png" alt="Detail of ransomware protection section.">
</div>
</div>
<h3><a id="memory-protection"></a>Memory threat protection<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.15/docs/getting-started/configure-integration-policy.asciidoc">edit</a></h3>
<p>Memory threat protection detects and stops in-memory threats, such as shellcode injection,
which are used to evade traditional file-based detection techniques.</p>
<p>Memory threat protection is a paid feature and is enabled by default if you have
a <a href="/pricing" class="ulink" target="_top">Platinum or Enterprise license</a>.
If you upgrade to a Platinum or Enterprise license from Basic or Gold, memory threat protection will be disabled by default.</p>
<p>Memory threat protection levels are:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Detect</strong></span>: Detects memory threat activity on the host and generates an alert.
Elastic Defend will <span class="strong strong"><strong>not</strong></span> block the in-memory activity. You must pay attention to and analyze any alerts that are generated.
</li>
<li class="listitem">
<span class="strong strong"><strong>Prevent</strong></span> (Default): Detects memory threat activity on the host, forces the process
or thread to stop, and generates an alert.
</li>
</ul>
</div>
<p>Select <span class="strong strong"><strong>Notify user</strong></span> to send a push notification in the host operating system when activity is detected or prevented. Notifications are enabled by default for the <span class="strong strong"><strong>Prevent</strong></span> option.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>Platinum and Enterprise customers can customize these notifications using the <code class="literal">Elastic Security {action} {rule}</code> syntax.</p>
</div>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="images/install-endpoint/memory-protection.png" alt="Detail of memory protection section.">
</div>
</div>
<h3><a id="behavior-protection"></a>Malicious behavior protection<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.15/docs/getting-started/configure-integration-policy.asciidoc">edit</a></h3>
<p>Malicious behavior protection detects and stops threats by monitoring the behavior
of system processes for suspicious activity. Behavioral signals are much more difficult
for adversaries to evade than traditional file-based detection techniques.</p>
<p>Malicious behavior protection is a paid feature and is enabled by default if you
have a <a href="/pricing" class="ulink" target="_top">Platinum or Enterprise license</a>.
If you upgrade to a Platinum or Enterprise license from Basic or Gold,
malicious behavior protection will be disabled by default.</p>
<p>Malicious behavior protection levels are:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Detect</strong></span>: Detects malicious behavior on the host and generates an alert.
Elastic Defend will <span class="strong strong"><strong>not</strong></span> block the malicious behavior. You must pay attention to and analyze any alerts that are generated.
</li>
<li class="listitem">
<span class="strong strong"><strong>Prevent</strong></span> (Default): Detects malicious behavior on the host, forces the process to stop,
and generates an alert.
</li>
</ul>
</div>
<p>Select whether you want to use <span class="strong strong"><strong>Reputation service</strong></span> for additional protection. Elastic&#8217;s reputation service leverages our extensive threat intelligence knowledge to make high confidence real-time prevention decisions. For example, reputation service can detect suspicious downloads of binaries with low or malicious reputation. Endpoints communicate with the reputation service directly at <a href="https://cloud.security.elastic.co" class="ulink" target="_top">https://cloud.security.elastic.co</a>.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Reputation service requires an active <a href="/pricing" class="ulink" target="_top">Platinum or Enterprise subscription</a> and is available on cloud deployments only.</p>
</div>
</div>
<p>Select <span class="strong strong"><strong>Notify user</strong></span> to send a push notification in the host operating system when activity is detected or prevented. Notifications are enabled by default for the <span class="strong strong"><strong>Prevent</strong></span> option.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>Platinum and Enterprise customers can customize these notifications using the <code class="literal">Elastic Security {action} {rule}</code> syntax.</p>
</div>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="images/install-endpoint/behavior-protection.png" alt="Detail of behavior protection section.">
</div>
</div>
<h3><a id="attack-surface-reduction"></a>Attack surface reduction<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.15/docs/getting-started/configure-integration-policy.asciidoc">edit</a></h3>
<p>This section helps you reduce vulnerabilities that attackers can target on Windows endpoints.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Credential hardening</strong></span>: Prevents attackers from stealing credentials stored in Windows system process memory. Turn on the toggle to remove any overly permissive access rights that aren&#8217;t required for standard interaction with the Local Security Authority Subsystem Service (LSASS). This feature enforces the principle of least privilege without interfering with benign system activity that is related to LSASS.
</li>
</ul>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="images/install-endpoint/attack-surface-reduction.png" alt="Detail of attack surface reduction section.">
</div>
</div>
<h3><a id="event-collection"></a>Event collection<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.15/docs/getting-started/configure-integration-policy.asciidoc">edit</a></h3>
<p>In the <span class="strong strong"><strong>Settings</strong></span> section, select which categories of events to collect on each operating system.
Most categories are collected by default, as seen below.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/install-endpoint/event-collection.png" alt="Detail of event collection section.">
</div>
</div>
<h3><a id="register-as-antivirus"></a>Register Elastic Security as antivirus (optional)<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.15/docs/getting-started/configure-integration-policy.asciidoc">edit</a></h3>
<p>With Elastic Defend version 7.10 or later on Windows 7 or later, you can
register Elastic Security as your hosts' antivirus software by enabling <span class="strong strong"><strong>Register as antivirus</strong></span>.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Windows Server versions are not supported. Antivirus registration requires Windows Security Center, which is not included in Windows Server operating systems.</p>
</div>
</div>
<p>You can also choose <span class="strong strong"><strong>Sync with malware protection level</strong></span> to automatically set antivirus registration based on how you&#8217;ve configured Elastic Defend&#8217;s <a class="xref" href="configure-endpoint-integration-policy.html#malware-protection" title="Malware protection">malware protection</a>. If malware protection is turned on and set to <span class="strong strong"><strong>Prevent</strong></span>, antivirus registration will also be enabled; in any other case, antivirus registration will be disabled.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/register-as-antivirus.png" alt="Detail of Register as antivirus option.">
</div>
</div>
<h3><a id="adv-policy-settings"></a>Advanced policy settings (optional)<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.15/docs/getting-started/configure-integration-policy.asciidoc">edit</a></h3>
<p>Users with unique configuration and security requirements can select <span class="strong strong"><strong>Show advanced settings</strong></span>
to configure the policy to support advanced use cases. Hover over each setting to view its description.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Advanced settings are not recommended for most users.</p>
</div>
</div>
<p>This section includes:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="endpoint-diagnostic-data.html" title="Turn off diagnostic data for Elastic Defend">Turn off diagnostic data for Elastic Defend</a>
</li>
<li class="listitem">
<a class="xref" href="self-healing-rollback.html" title="Configure self-healing rollback for Windows endpoints">Configure self-healing rollback for Windows endpoints</a>
</li>
<li class="listitem">
<a class="xref" href="linux-file-monitoring.html" title="Configure Linux file system monitoring">Configure Linux file system monitoring</a>
</li>
</ul>
</div>
<h3><a id="save-policy"></a>Save the general policy settings<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.15/docs/getting-started/configure-integration-policy.asciidoc">edit</a></h3>
<p>After you have configured the general settings on the <span class="strong strong"><strong>Policy settings</strong></span> tab, click <span class="strong strong"><strong>Save</strong></span>. A confirmation message appears.</p>





</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="offline-endpoint.html">« Configure offline endpoints and air-gapped environments</a>
</span>
<span class="next">
<a href="artifact-control.html">Configure updates for protection artifacts »</a>
</span>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>

                        <!-- Feedback widget -->
                        <div id="feedbackWidgetContainer"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


        <div id='elastic-footer'></div>
        <script src='https://www.elastic.co/elastic-footer.js'></script>
        <!-- Footer Section end-->

      </section>
    </div>

    <!-- Feedback modal -->
    <div id="feedbackModalContainer"></div>

    <script src="/guide/static/jquery.js"></script>
    <script type="text/javascript" src="/guide/static/docs-v1.js"></script>
    <script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
