<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Troubleshoot Elastic Defend | Elastic Security [8.16] | Elastic</title>
<meta class="elastic" name="content" content="Troubleshoot Elastic Defend | Elastic Security [8.16]">

<link rel="home" href="index.html" title="Elastic Security [8.16]"/>
<link rel="up" href="troubleshooting-ov.html" title="Troubleshooting"/>
<link rel="prev" href="ts-detection-rules.html" title="Troubleshoot detection rules"/>
<link rel="next" href="release-notes.html" title="Release notes"/>
<meta class="elastic" name="product_version" content="8.16"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.16"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.16"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="icon" href="/favicon.ico" sizes="32x32"/>
    <link rel="icon" href="/favicon.svg" type="image/svg+xml"/>
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" sizes="180x180"/>
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles-v1.css" />
  </head>

  <!--© 2015-2025 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div class="navheader">
<span class="prev">
<a href="ts-detection-rules.html">« Troubleshoot detection rules</a>
</span>
<span class="next">
<a href="release-notes.html">Release notes »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security [8.16]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="troubleshooting-ov.html">Troubleshooting</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Troubleshoot Elastic Defend</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.16/docs/troubleshooting/ts-management.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div id="url-to-v3" class="version-warning">
    <strong>IMPORTANT</strong>: This documentation is no longer updated. Refer to <a href="https://www.elastic.co/support/eol">Elastic's version policy</a> and the <a href="https://www.elastic.co/docs/troubleshoot/security/elastic-defend">latest documentation</a>.
</div>
<div class="chapter">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="ts-management"></a>Troubleshoot Elastic Defend</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.16/docs/troubleshooting/ts-management.asciidoc">edit</a></div>
</div></div></div>

<p>This topic covers common troubleshooting issues when using Elastic Defend&#8217;s <a class="xref" href="sec-manage-intro.html" title="Manage Elastic Defend">endpoint management tools</a>.</p>
<div class="position-relative"><h3><a id="ts-endpoints"></a>Endpoints</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.16/docs/troubleshooting/ts-management.asciidoc">edit</a></div>
<details id="ts-unhealthy-agent">
<summary class="title">Unhealthy Elastic Agent status</summary>
<div class="content">
<p>In some cases, an <code class="literal">Unhealthy</code> Elastic Agent status may be caused by a failure in the Elastic Defend integration policy. In this situation, the integration and any failing features are flagged on the agent details page in Fleet. Expand each section and subsection to display individual responses from the agent.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>Integration policy response information is also available from the <span class="strong strong"><strong>Endpoints</strong></span> page in the Elastic Security app (<span class="strong strong"><strong>Manage</strong></span> &#8594; <span class="strong strong"><strong>Endpoints</strong></span>, then click the link in the <span class="strong strong"><strong>Policy status</strong></span> column).</p>
</div>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="images/unhealthy-agent-fleet.png" alt="Agent details page in Fleet with Unhealthy status and integration failures">
</div>
</div>
<p>Common causes of failure in the Elastic Defend integration policy include missing prerequisites or unexpected system configuration. Consult the following topics to resolve a specific error:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="deploy-elastic-endpoint.html#system-extension-endpoint" title="Approve the system extension for Elastic Endpoint">Approve the system extension for Elastic Endpoint</a> (macOS)
</li>
<li class="listitem">
<a class="xref" href="deploy-elastic-endpoint.html#enable-fda-endpoint" title="Enable Full Disk Access for Elastic Endpoint">Enable Full Disk Access for Elastic Endpoint</a> (macOS)
</li>
<li class="listitem">
<a class="xref" href="ts-management.html#linux-deadlock" title="Disabled to avoid potential system deadlock (Linux)">Resolve a potential system deadlock</a> (Linux)
</li>
</ul>
</div>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>If the Elastic Defend integration policy is not the cause of the <code class="literal">Unhealthy</code> agent status, refer to <a href="/guide/en/fleet/8.16/fleet-troubleshooting.html" class="ulink" target="_top">Fleet troubleshooting</a> for help with the Elastic Agent.</p>
</div>
</div>
</div>
</details>
<details id="linux-deadlock">
<summary class="title">Disabled to avoid potential system deadlock (Linux)</summary>
<div class="content">
<p>If you have an <code class="literal">Unhealthy</code> Elastic Agent status with the message <code class="literal">Disabled due to potential system deadlock</code>, that means malware protection was disabled on the Elastic Defend integration policy due to errors while monitoring a Linux host.</p>
<p>You can resolve the issue by configuring the policy&#8217;s <a class="xref" href="linux-file-monitoring.html" title="Configure Linux file system monitoring">advanced settings</a> related to <span class="strong strong"><strong>fanotify</strong></span>, a Linux feature that monitors file system events. By default, Elastic Defend works with fanotify to monitor specific file system types that Elastic has tested for compatibility, and ignores other unknown file system types.</p>
<p>If your network includes nonstandard, proprietary, or otherwise unrecognized Linux file systems that cause errors while being monitored, you can configure Elastic Defend to ignore those file systems. This allows Elastic Defend to resume monitoring and protecting the hosts on the integration policy.</p>
<div class="caution admon">
<div class="icon"></div>
<div class="admon_content">
<p>Ignoring file systems can create gaps in your security coverage. Use additional security layers for any file systems ignored by Elastic Defend.</p>
</div>
</div>
<p>To resolve the potential system deadlock error:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Go to <span class="strong strong"><strong>Manage</strong></span> &#8594; <span class="strong strong"><strong>Policies</strong></span>, then click a policy&#8217;s name.
</li>
<li class="listitem">
Scroll to the bottom of the policy and click <span class="strong strong"><strong>Show advanced settings</strong></span>.
</li>
<li class="listitem">
In the setting <code class="literal">linux.advanced.fanotify.ignored_filesystems</code>, enter a comma-separated list of file system names to ignore, as they appear in <code class="literal">/proc/filesystems</code> (for example: <code class="literal">ext4,tmpfs</code>). Refer to <a class="xref" href="linux-file-monitoring.html#find-file-system-names" title="Find file system names">Find file system names</a> for more on determining the file system names.
</li>
<li class="listitem">
<p>Click <span class="strong strong"><strong>Save</strong></span>.</p>
<p>Once you save the policy, malware protection is re-enabled.</p>
</li>
</ol>
</div>
</div>
</details>
<details id="ts-transform-failed">
<summary class="title">Required transform failed</summary>
<div class="content">
<p>If you encounter a <code class="literal">“Required transform failed”</code> notice on the Endpoints page, you can usually resolve the issue by restarting the transform. Refer to <a href="/guide/en/elasticsearch/reference/8.16/transforms.html" class="ulink" target="_top">Transforming data</a> for more information about transforms.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/endpoints-transform-failed.png" alt="Endpoints page with Required transform failed notice">
</div>
</div>
<p>To restart a transform that’s not running:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Go to <span class="strong strong"><strong>Kibana</strong></span> &#8594; <span class="strong strong"><strong>Stack Management</strong></span> &#8594; <span class="strong strong"><strong>Data</strong></span> &#8594; <span class="strong strong"><strong>Transforms</strong></span>.
</li>
<li class="listitem">
Enter <code class="literal">endpoint.metadata</code> in the search box to find the transforms for Elastic Defend.
</li>
<li class="listitem">
<p>Click the <span class="strong strong"><strong>Actions</strong></span> menu (<span class="strong strong"><strong>&#8230;&#8203;</strong></span>) and do one of the following for each transform, depending on the value in the <span class="strong strong"><strong>Status</strong></span> column:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">stopped</code>: Select <span class="strong strong"><strong>Start</strong></span> to restart the transform.
</li>
<li class="listitem">
<p><code class="literal">failed</code>: Select <span class="strong strong"><strong>Stop</strong></span> to first stop the transform, and then select <span class="strong strong"><strong>Start</strong></span> to restart it.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/transforms-start.png" alt="Transforms page with Start option selected">
</div>
</div>
</li>
</ul>
</div>
</li>
<li class="listitem">
On the confirmation message that displays, click <span class="strong strong"><strong>Start</strong></span> to restart the transform.
</li>
<li class="listitem">
The transform’s status changes to <code class="literal">started</code>. If it doesn&#8217;t change, refresh the page.
</li>
</ol>
</div>
</div>
</details>
<details id="ts-agent-connection">
<summary class="title">Elastic Agent and Endpoint connection issues</summary>
<div class="content">
<p>After Elastic Agent installs Endpoint, Endpoint connects to Elastic Agent over a local relay connection to report its health status and receive policy updates and response action requests. If that connection cannot be established, the Elastic Defend integration will cause Elastic Agent to be in an <code class="literal">Unhealthy</code> status, and Endpoint won&#8217;t operate properly.</p>
<div class="position-relative"><h4><a id="_identify_if_the_issue_is_happening"></a>Identify if the issue is happening</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.16/docs/troubleshooting/ts-management.asciidoc">edit</a></div>
<p>You can identify if this issue is happening in the following ways:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Run Elastic Agent&#8217;s status command:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">sudo /opt/Elastic/Agent/elastic-agent status</code> (Linux)
</li>
<li class="listitem">
<code class="literal">sudo /Library/Elastic/Agent/elastic-agent status</code> (macOS)
</li>
<li class="listitem">
<code class="literal">c:\Program Files\Elastic\Agent\elastic-agent.exe status</code> (Windows)
</li>
</ul>
</div>
<p>If the status result for <code class="literal">endpoint-security</code> says that Endpoint has missed check-ins or <code class="literal">localhost:6788</code> cannot be bound to, it might indicate this problem is occurring.</p>
</li>
<li class="listitem">
<p>If the problem starts happening right after installing Endpoint, check the value of <code class="literal">fleet.agent.id</code> in the following file:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">/opt/Elastic/Endpoint/elastic-endpoint.yaml</code> (Linux)
</li>
<li class="listitem">
<code class="literal">/Library/Elastic/Endpoint/elastic-endpoint.yaml</code> (macOS)
</li>
<li class="listitem">
<code class="literal">c:\Program Files\Elastic\Endpoint\elastic-endpoint.yaml</code> (Windows)
</li>
</ul>
</div>
<p>If the value of <code class="literal">fleet.agent.id</code> is <code class="literal">00000000-0000-0000-0000-000000000000</code>, this indicates this problem is occurring.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>If this problem starts happening after Endpoint has already been installed and working properly, then this value will have changed even though the problem is happening.</p>
</div>
</div>
</li>
</ul>
</div>
<div class="position-relative"><h4><a id="_examine_endpoint_logs"></a>Examine Endpoint logs</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.16/docs/troubleshooting/ts-management.asciidoc">edit</a></div>
<p>If you&#8217;ve confirmed that the issue is happening, you can look at Endpoint log messages to identify the cause:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">Failed to find connection to validate. Is Agent listening on 127.0.0.1:6788?</code> or <code class="literal">Failed to validate connection. Is Agent running as root/admin?</code> means that Endpoint is not able to create an initial connection to Elastic Agent over port <code class="literal">6788</code>.
</li>
<li class="listitem">
<code class="literal">Unable to make GRPC connection in deadline(60s). Fetching connection info again</code> means that Endpoint&#8217;s original connection to Elastic Agent over port <code class="literal">6788</code> worked, but the connection over port <code class="literal">6789</code> is failing.
</li>
</ul>
</div>
<div class="position-relative"><h4><a id="_resolve_the_issue"></a>Resolve the issue</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.16/docs/troubleshooting/ts-management.asciidoc">edit</a></div>
<p>To debug and resolve the issue, follow these steps:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Since 8.7.0, Endpoint diagnostics contain a file named <code class="literal">analysis.txt</code> that contains information about what may cause this issue. As of 8.11.2, Elastic Agent diagnostics automatically include Endpoint diagnostics. For previous versions, you can gather Endpoint diagnostics by running:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">sudo /opt/Elastic/Endpoint/elastic-endpoint diagnostics</code> (Linux)
</li>
<li class="listitem">
<code class="literal">sudo /Library/Elastic/Endpoint/elastic-endpoint diagnostics</code> (macOS)
</li>
<li class="listitem">
<code class="literal">c:\Program Files\Elastic\Endpoint\elastic-endpoint.exe diagnostics</code> (Windows)
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Make sure nothing else on your device is listening on ports <code class="literal">6788</code> or <code class="literal">6789</code> by running:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">sudo netstat -anp --tcp</code> (Linux)
</li>
<li class="listitem">
<code class="literal">sudo netstat -an -f inet</code> (macOS)
</li>
<li class="listitem">
<code class="literal">netstat -an</code> (Windows)
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Make sure <code class="literal">localhost</code> can be resolved to <code class="literal">127.0.0.1</code> by running:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">ping -4 -c 1 localhost</code> (Linux)
</li>
<li class="listitem">
<code class="literal">ping -c 1 localhost</code> (macOS)
</li>
<li class="listitem">
<code class="literal">ping -4 localhost</code> (Windows)
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>
</details>
<details id="defend-deployment">
<summary class="title">Elastic Defend deployment issues</summary>
<div class="content">
<p>After deploying Elastic Defend, you might encounter warnings or errors in the endpoint&#8217;s <span class="strong strong"><strong>Policy status</strong></span> in Fleet if your mobile device management (MDM) is misconfigured or certain permissions for Elastic Endpoint aren&#8217;t granted. The following sections explain issues that can cause warnings or failures in the endpoint&#8217;s policy status.</p>
<div class="position-relative"><h4><a id="_connect_kernel_has_failed"></a>Connect Kernel has failed</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.16/docs/troubleshooting/ts-management.asciidoc">edit</a></div>
<p>This means that the system extension or kernel extension was not approved. Consult the following topics for approving the system extension with or without MDM:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="deploy-with-mdm.html#system-extension-jamf" title="Approve the system extension">Approve the system extension with MDM</a>
</li>
<li class="listitem">
<a class="xref" href="deploy-elastic-endpoint.html#system-extension-endpoint" title="Approve the system extension for Elastic Endpoint">Approve the system extension without MDM</a>
</li>
</ul>
</div>
<p>You can validate the system extension is loaded by running:</p>
<div class="pre_wrapper lang-shell">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-shell">sudo systemextensionsctl list | grep co.elastic.systemextension</pre>
</div>
<p>In the command output, the system extension should be marked as "active enabled".</p>
<div class="position-relative"><h4><a id="_connect_kernel_has_failed_and_the_system_extension_is_loaded"></a>Connect Kernel has failed and the system extension is loaded</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.16/docs/troubleshooting/ts-management.asciidoc">edit</a></div>
<p>If the system extension is loaded and kernel connection still fails, this means that Full Disk Access was not granted. Elastic Endpoint requires Full Disk Access to subscribe to system events through the Elastic Defend framework, which is one of the primary sources of eventing information used by Elastic Endpoint. Consult the following topics for granting Full Disk Access with or without MDM:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="deploy-with-mdm.html#fda-jamf" title="Enable Full Disk Access">Enable Full Disk Access with MDM</a>
</li>
<li class="listitem">
<a class="xref" href="deploy-elastic-endpoint-ven.html#enable-fda-endpoint-ven" title="Enable Full Disk Access for Elastic Endpoint">Enable Full Disk Access without MDM</a>
</li>
</ul>
</div>
<p>You can validate that Full Disk Access is approved by running</p>
<div class="pre_wrapper lang-shell">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-shell">sudo /Library/Elastic/Endpoint/elastic-endpoint test install</pre>
</div>
<p>If the command output doesn&#8217;t contain a message about enabling Full Disk Access, the approval was successful.</p>
<div class="position-relative"><h4><a id="_detect_network_events_has_failed"></a>Detect Network Events has failed</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.16/docs/troubleshooting/ts-management.asciidoc">edit</a></div>
<p>This means that the network extension content filtering was not approved. Consult the following topics for approving network content filtering with or without MDM:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="deploy-with-mdm.html#content-filtering-jamf" title="Approve network content filtering">Approve network content filtering with MDM</a>
</li>
<li class="listitem">
<a class="xref" href="deploy-elastic-endpoint-ven.html#allow-filter-content-ven" title="Approve network content filtering for Elastic Endpoint">Approve network content filtering without MDM</a>
</li>
</ul>
</div>
<p>You can validate that network content filtering is approved by running</p>
<div class="pre_wrapper lang-shell">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-shell">sudo /Library/Elastic/Endpoint/elastic-endpoint test install</pre>
</div>
<p>If the command output doesn&#8217;t contain a message about approving network content filtering, the approval was successful.</p>
<div class="position-relative"><h4><a id="_full_disk_access_has_a_warning"></a>Full Disk Access has a warning</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.16/docs/troubleshooting/ts-management.asciidoc">edit</a></div>
<p>This means that Full Disk Access was not granted for one or all Elastic Endpoint components. Consult the following topics for granting Full Disk Access with or without MDM:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="deploy-with-mdm.html#fda-jamf" title="Enable Full Disk Access">Enable Full Disk Access with MDM</a>
</li>
<li class="listitem">
<a class="xref" href="deploy-elastic-endpoint-ven.html#enable-fda-endpoint-ven" title="Enable Full Disk Access for Elastic Endpoint">Enable Full Disk Access without MDM</a>
</li>
</ul>
</div>
<p>You can validate that Full Disk Access is approved by running</p>
<div class="pre_wrapper lang-shell">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-shell">sudo /Library/Elastic/Endpoint/elastic-endpoint test install</pre>
</div>
<p>If the command output doesn&#8217;t contain a message about enabling Full Disk Access, the approval was successful.</p>
</div>
</details>
<details id="disable-self-healing">
<summary class="title">Disable Elastic Defend&#8217;s self-healing feature on Windows</summary>
<div class="content">
<div class="position-relative"><h4><a id="self-healing-vss-issues"></a>Volume Snapshot Service issues</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.16/docs/troubleshooting/ts-management.asciidoc">edit</a></div>
<p>Elastic Defend&#8217;s self-healing feature rolls back recent filesystem changes when a prevention alert is triggered. This feature uses the Windows Volume Snapshot Service. Although it&#8217;s uncommon for this to cause issues, you can turn off this Elastic Defend feature if needed.</p>
<p>If issues occur and the self-healing feature is enabled, you can turn it off by setting <code class="literal">windows.advanced.alerts.rollback.self_healing.enabled</code> to <code class="literal">false</code> in the integration policy advanced settings. Refer to <a class="xref" href="self-healing-rollback.html" title="Configure self-healing rollback for Windows endpoints">Configure self-healing rollback for Windows endpoints</a> for more information.</p>
<p>Elastic Defend may also use the Volume Snapshot Service to ensure the feature works properly even when it&#8217;s turned off. To opt out of this, set <code class="literal">windows.advanced.diagnostic.rollback_telemetry_enabled</code> to <code class="literal">false</code> in the same settings.</p>
<div class="position-relative"><h4><a id="self-healing-compatibility-issues"></a>Known compatibility issues</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.16/docs/troubleshooting/ts-management.asciidoc">edit</a></div>
<p>There are some known compatibility issues between Elastic Defend&#8217;s self-healing feature and filesystem replication features, including <a href="https://learn.microsoft.com/en-us/windows-server/storage/dfs-replication/dfsr-overview" class="ulink" target="_top">DFS Replication</a> and Veeam Replication. This may manifest as <code class="literal">DFSR Event ID 1102</code>:</p>
<p><code class="literal">The DFS Replication service has temporarily stopped replication because another application is performing a backup or restore operation. Replication will resume after the backup or restore operation has finished.</code></p>
<p>There are no known workarounds for this issue other than to turn off the self-healing feature.</p>
</div>
</details>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="ts-detection-rules.html">« Troubleshoot detection rules</a>
</span>
<span class="next">
<a href="release-notes.html">Release notes »</a>
</span>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>

                        <!-- Feedback widget -->
                        <div id="feedbackWidgetContainer"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


        <div id='elastic-footer'></div>
        <script src='https://www.elastic.co/elastic-footer.js'></script>
        <!-- Footer Section end-->

      </section>
    </div>

    <!-- Feedback modal -->
    <div id="feedbackModalContainer"></div>

    <script src="/guide/static/jquery.js"></script>
    <script type="text/javascript" src="/guide/static/docs-v1.js"></script>
    <script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
