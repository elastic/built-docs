<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Update v8.18.15 | Elastic Security [8.18] | Elastic</title>
<meta class="elastic" name="content" content="Update v8.18.15 | Elastic Security [8.18]">

<link rel="home" href="index.html" title="Elastic Security [8.18]"/>
<link rel="up" href="prebuilt-rules-downloadable-updates.html" title="Downloadable rule updates"/>
<link rel="prev" href="prebuilt-rule-8-18-14-prebuilt-rules-8-18-14-summary.html" title="Update v8.18.14"/>
<link rel="next" href="endpoint-protection-intro.html" title="Configure endpoint protection with Elastic Defend"/>
<meta class="elastic" name="product_version" content="8.18"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.18"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.18"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="icon" href="/favicon.ico" sizes="32x32"/>
    <link rel="icon" href="/favicon.svg" type="image/svg+xml"/>
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" sizes="180x180"/>
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles-v1.css" />
  </head>

  <!--© 2015-2025 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div class="navheader">
<span class="prev">
<a href="prebuilt-rule-8-18-14-prebuilt-rules-8-18-14-summary.html">« Update v8.18.14</a>
</span>
<span class="next">
<a href="endpoint-protection-intro.html">Configure endpoint protection with Elastic Defend »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security [8.18]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="detection-engine-overview.html">Detections and alerts</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="prebuilt-rules-downloadable-updates.html">Downloadable rule updates</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Update v8.18.15</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.18/docs/detections/prebuilt-rules/downloadable-packages/8-18-15/prebuilt-rules-8-18-15-summary.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div id="url-to-v3" class="version-warning">
    A newer version is available. Check out the <a href="https://www.elastic.co/docs">latest documentation</a>.
</div>
<div class="section xpack">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="prebuilt-rule-8-18-15-prebuilt-rules-8-18-15-summary"></a>Update v8.18.15</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.18/docs/detections/prebuilt-rules/downloadable-packages/8-18-15/prebuilt-rules-8-18-15-summary.asciidoc">edit</a></div>
</div></div></div>
<p>This section lists all updates associated with version 8.18.15 of the Fleet integration <span class="strong strong"><strong>Prebuilt Security Detection Rules</strong></span>.</p>
<div class="informaltable">
<table border="1" cellpadding="4px" width="100%">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Rule</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Status</th>
<th align="left" valign="top">Version</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-credential-access-via-trufflehog-execution.html" title="Credential Access via TruffleHog Execution">Credential Access via TruffleHog Execution</a></p></td>
<td align="left" valign="top"><p>This rule detects the execution of TruffleHog, a tool used to search for high-entropy strings and secrets in code repositories, which may indicate an attempt to access credentials. This tool was abused by the Shai-Hulud worm to search for credentials in code repositories.</p></td>
<td align="left" valign="top"><p>new</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-azure-storage-account-blob-public-access-enabled.html" title="Azure Storage Account Blob Public Access Enabled">Azure Storage Account Blob Public Access Enabled</a></p></td>
<td align="left" valign="top"><p>Identifies when Azure Storage Account Blob public access is enabled, allowing external access to blob containers. This technique was observed in cloud ransom-based campaigns where threat actors modified storage accounts to expose non-remotely accessible accounts to the internet for data exfiltration. Adversaries abuse the Microsoft.Storage/storageAccounts/write operation to modify public access settings.</p></td>
<td align="left" valign="top"><p>new</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-azure-storage-account-keys-accessed-by-privileged-user.html" title="Azure Storage Account Keys Accessed by Privileged User">Azure Storage Account Keys Accessed by Privileged User</a></p></td>
<td align="left" valign="top"><p>Identifies unusual high-privileged access to Azure Storage Account keys by users with Owner, Contributor, or Storage Account Contributor roles. This technique was observed in STORM-0501 ransomware campaigns where compromised identities with high-privilege Azure RBAC roles retrieved access keys to perform unauthorized operations on Storage Accounts. Microsoft recommends using Shared Access Signature (SAS) models instead of direct key access for improved security. This rule detects when a user principal with high-privilege roles accesses storage keys for the first time in 7 days.</p></td>
<td align="left" valign="top"><p>new</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-entra-id-actor-token-user-impersonation-abuse.html" title="Entra ID Actor Token User Impersonation Abuse">Entra ID Actor Token User Impersonation Abuse</a></p></td>
<td align="left" valign="top"><p>Identifies potential abuse of actor tokens in Microsoft Entra ID audit logs. Actor tokens are undocumented backend mechanisms used by Microsoft for service-to-service (S2S) operations, allowing services to perform actions on behalf of users. These tokens appear in logs with the service&#8217;s display name but the impersonated user&#8217;s UPN. While some legitimate Microsoft operations use actor tokens, unexpected usage may indicate exploitation of CVE-2025-55241, which allowed unauthorized access to Azure AD Graph API across tenants before being patched by Microsoft.</p></td>
<td align="left" valign="top"><p>new</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-microsoft-entra-id-protection-alert-and-device-registration.html" title="Microsoft Entra ID Protection Alert and Device Registration">Microsoft Entra ID Protection Alert and Device Registration</a></p></td>
<td align="left" valign="top"><p>Identifies sequence of events where a Microsoft Entra ID protection alert is followed by an attempt to register a new device by the same user principal. This behavior may indicate an adversary using a compromised account to register a device, potentially leading to unauthorized access to resources or persistence in the environment.</p></td>
<td align="left" valign="top"><p>new</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-azure-rbac-built-in-administrator-roles-assigned.html" title="Azure RBAC Built-In Administrator Roles Assigned">Azure RBAC Built-In Administrator Roles Assigned</a></p></td>
<td align="left" valign="top"><p>Identifies when a user is assigned a built-in administrator role in Azure RBAC (Role-Based Access Control). These roles provide significant privileges and can be abused by attackers for lateral movement, persistence, or privilege escalation. The privileged built-in administrator roles include Owner, Contributor, User Access Administrator, Azure File Sync Administrator, Reservations Administrator, and Role Based Access Control Administrator.</p></td>
<td align="left" valign="top"><p>new</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-curl-or-wget-spawned-via-node-js.html" title="Curl or Wget Spawned via Node.js">Curl or Wget Spawned via Node.js</a></p></td>
<td align="left" valign="top"><p>This rule detects when Node.js, directly or via a shell, spawns the curl or wget command. This may indicate command and control behavior. Adversaries may use Node.js to download additional tools or payloads onto the system.</p></td>
<td align="left" valign="top"><p>new</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-github-authentication-token-access-via-node-js.html" title="GitHub Authentication Token Access via Node.js">GitHub Authentication Token Access via Node.js</a></p></td>
<td align="left" valign="top"><p>This rule detects when the Node.js runtime spawns a shell to execute the GitHub CLI (gh) command to retrieve a GitHub authentication token. The GitHub CLI is a command-line tool that allows users to interact with GitHub from the terminal. The "gh auth token" command is used to retrieve an authentication token for GitHub, which can be used to authenticate API requests and perform actions on behalf of the user. Adversaries may use this technique to access GitHub repositories and potentially exfiltrate sensitive information or perform malicious actions. This activity was observed in the wild as part of the Shai-Hulud worm.</p></td>
<td align="left" valign="top"><p>new</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-attempt-to-clear-logs-via-journalctl.html" title="Attempt to Clear Logs via Journalctl">Attempt to Clear Logs via Journalctl</a></p></td>
<td align="left" valign="top"><p>This rule monitors for attempts to clear logs using the "journalctl" command on Linux systems. Adversaries may use this technique to cover their tracks by deleting or truncating log files, making it harder for defenders to investigate their activities. The rule looks for the execution of "journalctl" with arguments that indicate log clearing actions, such as "--vacuum-time", "--vacuum-size", or "--vacuum-files".</p></td>
<td align="left" valign="top"><p>new</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-node-js-pre-or-post-install-script-execution.html" title="Node.js Pre or Post-Install Script Execution">Node.js Pre or Post-Install Script Execution</a></p></td>
<td align="left" valign="top"><p>This rule detects the execution of Node.js pre or post-install scripts. These scripts are executed by the Node.js package manager (npm) during the installation of packages. Adversaries may abuse this technique to execute arbitrary commands on the system and establish persistence. This activity was observed in the wild as part of the Shai-Hulud worm.</p></td>
<td align="left" valign="top"><p>new</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-potential-cve-2025-32463-nsswitch-file-creation.html" title="Potential CVE-2025-32463 Nsswitch File Creation">Potential CVE-2025-32463 Nsswitch File Creation</a></p></td>
<td align="left" valign="top"><p>Detects suspicious creation of the nsswitch.conf file, outside of the regular /etc/nsswitch.conf path, consistent with attempts to exploit CVE-2025-32463 (the "sudo chroot" privilege escalation), where an attacker tricks sudo into using attacker-controlled NSS files or libraries to gain root.</p></td>
<td align="left" valign="top"><p>new</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-potential-cve-2025-32463-sudo-chroot-execution-attempt.html" title="Potential CVE-2025-32463 Sudo Chroot Execution Attempt">Potential CVE-2025-32463 Sudo Chroot Execution Attempt</a></p></td>
<td align="left" valign="top"><p>Detects suspicious use of sudo&#8217;s --chroot / -R option consistent with attempts to exploit CVE-2025-32463 (the "sudo chroot" privilege escalation), where an attacker tricks sudo into using attacker-controlled NSS files or libraries to gain root.</p></td>
<td align="left" valign="top"><p>new</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-potential-cve-2025-41244-vmtoolsd-lpe-exploitation-attempt.html" title="Potential CVE-2025-41244 vmtoolsd LPE Exploitation Attempt">Potential CVE-2025-41244 vmtoolsd LPE Exploitation Attempt</a></p></td>
<td align="left" valign="top"><p>This rule looks for processes that behave like an attacker trying to exploit a known vulnerability in VMware tools (CVE-2025-41244). The vulnerable behavior involves the VMware tools service or its discovery scripts executing other programs to probe their version strings. An attacker can place a malicious program in a writable location (for example /tmp) and have the tools execute it with elevated privileges, resulting in local privilege escalation. The rule flags launches where vmtoolsd or the service discovery scripts start other child processes.</p></td>
<td align="left" valign="top"><p>new</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-suspicious-seincreasebasepriorityprivilege-use.html" title="Suspicious SeIncreaseBasePriorityPrivilege Use">Suspicious SeIncreaseBasePriorityPrivilege Use</a></p></td>
<td align="left" valign="top"><p>Identifies attempts to use the SeIncreaseBasePriorityPrivilege privilege by an unusual process. This could be related to hijack execution flow of a process via threats priority manipulation.</p></td>
<td align="left" valign="top"><p>new</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-aws-s3-bucket-enumeration-or-brute-force.html" title="AWS S3 Bucket Enumeration or Brute Force">AWS S3 Bucket Enumeration or Brute Force</a></p></td>
<td align="left" valign="top"><p>Identifies a high number of failed S3 operations against a single bucket from a single source address within a short timeframe. This activity can indicate attempts to collect bucket objects or cause an increase in billing to an account via internal "AccessDenied" errors.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>6</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-potential-aws-s3-bucket-ransomware-note-uploaded.html" title="Potential AWS S3 Bucket Ransomware Note Uploaded">Potential AWS S3 Bucket Ransomware Note Uploaded</a></p></td>
<td align="left" valign="top"><p>Identifies potential ransomware note being uploaded to an AWS S3 bucket. This rule detects the PutObject S3 API call with a common ransomware note file name or extension such as ransom or .lock. Adversaries with access to a misconfigured S3 bucket may retrieve, delete, and replace objects with ransom notes to extort victims.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>7</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-aws-s3-static-site-javascript-file-uploaded.html" title="AWS S3 Static Site JavaScript File Uploaded">AWS S3 Static Site JavaScript File Uploaded</a></p></td>
<td align="left" valign="top"><p>This rule detects when a JavaScript file is uploaded or accessed in an S3 static site directory (<code class="literal">static/js/</code>) by an IAM user or assumed role. This can indicate suspicious modification of web content hosted on S3, such as injecting malicious scripts into a static website frontend.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>3</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-aws-sts-role-chaining.html" title="AWS STS Role Chaining">AWS STS Role Chaining</a></p></td>
<td align="left" valign="top"><p>Identifies role chaining activity. Role chaining is when you use one assumed role to assume a second role through the AWS CLI or API. While this a recognized functionality in AWS, role chaining can be abused for privilege escalation if the subsequent assumed role provides additional privileges. Role chaining can also be used as a persistence mechanism as each AssumeRole action results in a refreshed session token with a 1 hour maximum duration. This is a new terms rule that looks for the first occurance of one role (aws.cloudtrail.user_identity.session_context.session_issuer.arn) assuming another (aws.cloudtrail.resources.arn).</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>3</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-microsoft-entra-id-concurrent-sign-ins-with-suspicious-properties.html" title="Microsoft Entra ID Concurrent Sign-Ins with Suspicious Properties">Microsoft Entra ID Concurrent Sign-Ins with Suspicious Properties</a></p></td>
<td align="left" valign="top"><p>Identifies concurrent azure signin events for the same user and from multiple sources, and where one of the authentication event has some suspicious properties often associated to DeviceCode and OAuth phishing. Adversaries may steal Refresh Tokens (RTs) via phishing to bypass multi-factor authentication (MFA) and gain unauthorized access to Azure resources.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>3</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-microsoft-entra-id-mfa-totp-brute-force-attempts.html" title="Microsoft Entra ID MFA TOTP Brute Force Attempts">Microsoft Entra ID MFA TOTP Brute Force Attempts</a></p></td>
<td align="left" valign="top"><p>Identifies brute force attempts against Azure Entra multi-factor authentication (MFA) Time-based One-Time Password (TOTP) verification codes. This rule detects high frequency failed TOTP code attempts for a single user in a short time-span with a high number of distinct session IDs. Adversaries may programmatically attemopt to brute-force TOTP codes by generating several sessions and attempt to guess the correct code.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>5</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-azure-full-network-packet-capture-detected.html" title="Azure Full Network Packet Capture Detected">Azure Full Network Packet Capture Detected</a></p></td>
<td align="left" valign="top"><p>Identifies potential full network packet capture in Azure. Packet Capture is an Azure Network Watcher feature that can be used to inspect network traffic. This feature can potentially be abused to read sensitive data from unencrypted internal traffic.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>107</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-excessive-secret-or-key-retrieval-from-azure-key-vault.html" title="Excessive Secret or Key Retrieval from Azure Key Vault">Excessive Secret or Key Retrieval from Azure Key Vault</a></p></td>
<td align="left" valign="top"><p>Identifies excessive secret or key retrieval operations from Azure Key Vault. This rule detects when a user principal retrieves secrets or keys from Azure Key Vault multiple times within a short time frame, which may indicate potential abuse or unauthorized access attempts. The rule focuses on high-frequency retrieval operations that deviate from normal user behavior, suggesting possible credential harvesting or misuse of sensitive information.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>3</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-microsoft-entra-id-sign-in-brute-force-activity.html" title="Microsoft Entra ID Sign-In Brute Force Activity">Microsoft Entra ID Sign-In Brute Force Activity</a></p></td>
<td align="left" valign="top"><p>Identifies potential brute-force attacks targeting user accounts by analyzing failed sign-in patterns in Microsoft Entra ID Sign-In Logs. This detection focuses on a high volume of failed interactive or non-interactive authentication attempts within a short time window, often indicative of password spraying, credential stuffing, or password guessing. Adversaries may use these techniques to gain unauthorized access to applications integrated with Entra ID or to compromise valid user accounts.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>5</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-microsoft-entra-id-exccessive-account-lockouts-detected.html" title="Microsoft Entra ID Exccessive Account Lockouts Detected">Microsoft Entra ID Exccessive Account Lockouts Detected</a></p></td>
<td align="left" valign="top"><p>Identifies a high count of failed Microsoft Entra ID sign-in attempts as the result of the target user account being locked out. Adversaries may attempt to brute-force user accounts by repeatedly trying to authenticate with incorrect credentials, leading to account lockouts by Entra ID Smart Lockout policies.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>3</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-microsoft-365-brute-force-via-entra-id-sign-ins.html" title="Microsoft 365 Brute Force via Entra ID Sign-Ins">Microsoft 365 Brute Force via Entra ID Sign-Ins</a></p></td>
<td align="left" valign="top"><p>Identifies potential brute-force attacks targeting Microsoft 365 user accounts by analyzing failed sign-in patterns in Microsoft Entra ID Sign-In Logs. This detection focuses on a high volume of failed interactive or non-interactive authentication attempts within a short time window, often indicative of password spraying, credential stuffing, or password guessing. Adversaries may use these techniques to gain unauthorized access to Microsoft 365 services such as Exchange Online, SharePoint, or Teams.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>107</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-azure-storage-account-key-regenerated.html" title="Azure Storage Account Key Regenerated">Azure Storage Account Key Regenerated</a></p></td>
<td align="left" valign="top"><p>Identifies a rotation to storage account access keys in Azure. Regenerating access keys can affect any applications or Azure services that are dependent on the storage account key. Adversaries may regenerate a key as a means of acquiring credentials to access systems and resources.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>106</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-azure-automation-runbook-deleted.html" title="Azure Automation Runbook Deleted">Azure Automation Runbook Deleted</a></p></td>
<td align="left" valign="top"><p>Identifies when an Azure Automation runbook is deleted. An adversary may delete an Azure Automation runbook in order to disrupt their target&#8217;s automated business operations or to remove a malicious runbook for defense evasion.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>106</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-azure-blob-permissions-modification.html" title="Azure Blob Permissions Modification">Azure Blob Permissions Modification</a></p></td>
<td align="left" valign="top"><p>Identifies when the Azure role-based access control (Azure RBAC) permissions are modified for an Azure Blob. An adversary may modify the permissions on a blob to weaken their target&#8217;s security controls or an administrator may inadvertently modify the permissions, which could lead to data exposure or loss.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>108</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-azure-diagnostic-settings-deletion.html" title="Azure Diagnostic Settings Deletion">Azure Diagnostic Settings Deletion</a></p></td>
<td align="left" valign="top"><p>Identifies the deletion of diagnostic settings in Azure, which send platform logs and metrics to different destinations. An adversary may delete diagnostic settings in an attempt to evade defenses.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>106</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-azure-event-hub-deletion.html" title="Azure Event Hub Deletion">Azure Event Hub Deletion</a></p></td>
<td align="left" valign="top"><p>Identifies an Event Hub deletion in Azure. An Event Hub is an event processing service that ingests and processes large volumes of events and data. An adversary may delete an Event Hub in an attempt to evade detection.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>106</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-azure-firewall-policy-deletion.html" title="Azure Firewall Policy Deletion">Azure Firewall Policy Deletion</a></p></td>
<td align="left" valign="top"><p>Identifies the deletion of a firewall policy in Azure. An adversary may delete a firewall policy in an attempt to evade defenses and/or to eliminate barriers to their objective.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>106</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-azure-frontdoor-web-application-firewall-waf-policy-deleted.html" title="Azure Frontdoor Web Application Firewall (WAF) Policy Deleted">Azure Frontdoor Web Application Firewall (WAF) Policy Deleted</a></p></td>
<td align="left" valign="top"><p>Identifies the deletion of a Frontdoor Web Application Firewall (WAF) Policy in Azure. An adversary may delete a Frontdoor Web Application Firewall (WAF) Policy in an attempt to evade defenses and/or to eliminate barriers to their objective.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>106</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-azure-kubernetes-events-deleted.html" title="Azure Kubernetes Events Deleted">Azure Kubernetes Events Deleted</a></p></td>
<td align="left" valign="top"><p>Identifies when events are deleted in Azure Kubernetes. Kubernetes events are objects that log any state changes. Example events are a container creation, an image pull, or a pod scheduling on a node. An adversary may delete events in Azure Kubernetes in an attempt to evade detection.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>106</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-azure-network-watcher-deletion.html" title="Azure Network Watcher Deletion">Azure Network Watcher Deletion</a></p></td>
<td align="left" valign="top"><p>Identifies the deletion of a Network Watcher in Azure. Network Watchers are used to monitor, diagnose, view metrics, and enable or disable logs for resources in an Azure virtual network. An adversary may delete a Network Watcher in an attempt to evade defenses.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>106</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-azure-alert-suppression-rule-created-or-modified.html" title="Azure Alert Suppression Rule Created or Modified">Azure Alert Suppression Rule Created or Modified</a></p></td>
<td align="left" valign="top"><p>Identifies the creation of suppression rules in Azure. Suppression rules are a mechanism used to suppress alerts previously identified as false positives or too noisy to be in production. This mechanism can be abused or mistakenly configured, resulting in defense evasions and loss of security visibility.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>106</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-azure-blob-container-access-level-modification.html" title="Azure Blob Container Access Level Modification">Azure Blob Container Access Level Modification</a></p></td>
<td align="left" valign="top"><p>Identifies changes to container access levels in Azure. Anonymous public read access to containers and blobs in Azure is a way to share data broadly, but can present a security risk if access to sensitive data is not managed judiciously.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>106</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-azure-automation-runbook-created-or-modified.html" title="Azure Automation Runbook Created or Modified">Azure Automation Runbook Created or Modified</a></p></td>
<td align="left" valign="top"><p>Identifies when an Azure Automation runbook is created or modified. An adversary may create or modify an Azure Automation runbook to execute malicious code and maintain persistence in their target&#8217;s environment.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>106</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-azure-command-execution-on-virtual-machine.html" title="Azure Command Execution on Virtual Machine">Azure Command Execution on Virtual Machine</a></p></td>
<td align="left" valign="top"><p>Identifies command execution on a virtual machine (VM) in Azure. A Virtual Machine Contributor role lets you manage virtual machines, but not access them, nor access the virtual network or storage account they’re connected to. However, commands can be run via PowerShell on the VM, which execute as System. Other roles, such as certain Administrator roles may be able to execute commands on a VM as well.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>106</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-azure-kubernetes-pods-deleted.html" title="Azure Kubernetes Pods Deleted">Azure Kubernetes Pods Deleted</a></p></td>
<td align="left" valign="top"><p>Identifies the deletion of Azure Kubernetes Pods. Adversaries may delete a Kubernetes pod to disrupt the normal behavior of the environment.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>106</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-azure-resource-group-deletion.html" title="Azure Resource Group Deletion">Azure Resource Group Deletion</a></p></td>
<td align="left" valign="top"><p>Identifies the deletion of a resource group in Azure, which includes all resources within the group. Deletion is permanent and irreversible. An adversary may delete a resource group in an attempt to evade defenses or intentionally destroy data.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>106</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-azure-active-directory-high-risk-user-sign-in-heuristic.html" title="Azure Active Directory High Risk User Sign-in Heuristic">Azure Active Directory High Risk User Sign-in Heuristic</a></p></td>
<td align="left" valign="top"><p>Identifies high risk Azure Active Directory (AD) sign-ins by leveraging Microsoft Identity Protection machine learning and heuristics.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>108</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-azure-active-directory-powershell-sign-in.html" title="Azure Active Directory PowerShell Sign-in">Azure Active Directory PowerShell Sign-in</a></p></td>
<td align="left" valign="top"><p>Identifies a sign-in using the Azure Active Directory PowerShell module. PowerShell for Azure Active Directory allows for managing settings from the command line, which is intended for users who are members of an admin role.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>108</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-entra-id-device-code-auth-with-broker-client.html" title="Entra ID Device Code Auth with Broker Client">Entra ID Device Code Auth with Broker Client</a></p></td>
<td align="left" valign="top"><p>Identifies device code authentication with an Azure broker client for Entra ID. Adversaries abuse Primary Refresh Tokens (PRTs) to bypass multi-factor authentication (MFA) and gain unauthorized access to Azure resources. PRTs are used in Conditional Access policies to enforce device-based controls. Compromising PRTs allows attackers to bypass these policies and gain unauthorized access. This rule detects successful sign-ins using device code authentication with the Entra ID broker client application ID (29d9ed98-a469-4536-ade2-f981bc1d605e).</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>5</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-microsoft-entra-id-high-risk-sign-in.html" title="Microsoft Entra ID High Risk Sign-in">Microsoft Entra ID High Risk Sign-in</a></p></td>
<td align="left" valign="top"><p>Identifies high risk Microsoft Entra ID sign-ins by leveraging Microsoft&#8217;s Identity Protection machine learning and heuristics. Identity Protection categorizes risk into three tiers: low, medium, and high. While Microsoft does not provide specific details about how risk is calculated, each level brings higher confidence that the user or sign-in is compromised.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>109</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-suspicious-entra-id-oauth-user-impersonation-scope-detected.html" title="Suspicious Entra ID OAuth User Impersonation Scope Detected">Suspicious Entra ID OAuth User Impersonation Scope Detected</a></p></td>
<td align="left" valign="top"><p>Identifies rare occurrences of OAuth workflow for a user principal that is single factor authenticated, with an OAuth scope containing user_impersonation for a token issued by Entra ID. Adversaries may use this scope to gain unauthorized access to user accounts, particularly when the sign-in session status is unbound, indicating that the session is not associated with a specific device or session. This behavior is indicative of potential account compromise or unauthorized access attempts. This rule flags when this pattern is detected for a user principal that has not been seen in the last 10 days, indicating potential abuse or unusual activity.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>2</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-suspicious-microsoft-oauth-flow-via-auth-broker-to-drs.html" title="Suspicious Microsoft OAuth Flow via Auth Broker to DRS">Suspicious Microsoft OAuth Flow via Auth Broker to DRS</a></p></td>
<td align="left" valign="top"><p>Identifies separate OAuth authorization flows in Microsoft Entra ID where the same user principal and session ID are observed across multiple IP addresses within a 5-minute window. These flows involve the Microsoft Authentication Broker (MAB) as the client application and the Device Registration Service (DRS) as the target resource. This pattern is highly indicative of OAuth phishing activity, where an adversary crafts a legitimate Microsoft login URL to trick a user into completing authentication and sharing the resulting authorization code, which is then exchanged for an access and refresh token by the attacker.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>4</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-microsoft-entra-id-user-reported-suspicious-activity.html" title="Microsoft Entra ID User Reported Suspicious Activity">Microsoft Entra ID User Reported Suspicious Activity</a></p></td>
<td align="left" valign="top"><p>Identifies suspicious activity reported by users in Microsoft Entra ID where users have reported suspicious activity related to their accounts, which may indicate potential compromise or unauthorized access attempts. Reported suspicious activity typically occurs during the authentication process and may involve various authentication methods, such as password resets, account recovery, or multi-factor authentication challenges. Adversaries may attempt to exploit user accounts by leveraging social engineering techniques or other methods to gain unauthorized access to sensitive information or resources.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>3</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-microsoft-entra-id-illicit-consent-grant-via-registered-application.html" title="Microsoft Entra ID Illicit Consent Grant via Registered Application">Microsoft Entra ID Illicit Consent Grant via Registered Application</a></p></td>
<td align="left" valign="top"><p>Identifies an illicit consent grant request on-behalf-of a registered Entra ID application. Adversaries may create and register an application in Microsoft Entra ID for the purpose of requesting user consent to access resources. This is accomplished by tricking a user into granting consent to the application, typically via a pre-made phishing URL. This establishes an OAuth grant that allows the malicious client applocation to access resources on-behalf-of the user.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>218</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-microsoft-entra-id-oauth-phishing-via-visual-studio-code-client.html" title="Microsoft Entra ID OAuth Phishing via Visual Studio Code Client">Microsoft Entra ID OAuth Phishing via Visual Studio Code Client</a></p></td>
<td align="left" valign="top"><p>Detects potentially suspicious OAuth authorization activity in Microsoft Entra ID where the Visual Studio Code first-party application (client_id = aebc6443-996d-45c2-90f0-388ff96faa56) is used to request access to Microsoft Graph resources. While this client ID is legitimately used by Visual Studio Code, threat actors have been observed abusing it in phishing campaigns to make OAuth requests appear trustworthy. These attacks rely on redirect URIs such as VSCode&#8217;s Insiders redirect location, prompting victims to return an OAuth authorization code that can be exchanged for access tokens. This rule may help identify unauthorized use of the VS Code OAuth flow as part of social engineering or credential phishing activity.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>4</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-azure-entra-id-rare-app-id-for-principal-authentication.html" title="Azure Entra ID Rare App ID for Principal Authentication">Azure Entra ID Rare App ID for Principal Authentication</a></p></td>
<td align="left" valign="top"><p>Identifies rare Azure Entra ID apps IDs requesting authentication on-behalf-of a principal user. An adversary with stolen credentials may specify an Azure-managed app ID to authenticate on-behalf-of a user. This is a rare event and may indicate an attempt to bypass conditional access policies (CAP) and multi-factor authentication (MFA) requirements. The app ID specified may not be commonly used by the user based on their historical sign-in activity.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>4</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-microsoft-entra-id-rare-authentication-requirement-for-principal-user.html" title="Microsoft Entra ID Rare Authentication Requirement for Principal User">Microsoft Entra ID Rare Authentication Requirement for Principal User</a></p></td>
<td align="left" valign="top"><p>Identifies rare instances of authentication requirements for Azure Entra ID principal users. An adversary with stolen credentials may attempt to authenticate with unusual authentication requirements, which is a rare event and may indicate an attempt to bypass conditional access policies (CAP) and multi-factor authentication (MFA) requirements. The authentication requirements specified may not be commonly used by the user based on their historical sign-in activity.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>5</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-azure-external-guest-user-invitation.html" title="Azure External Guest User Invitation">Azure External Guest User Invitation</a></p></td>
<td align="left" valign="top"><p>Identifies an invitation to an external user in Azure Active Directory (AD). Azure AD is extended to include collaboration, allowing you to invite people from outside your organization to be guest users in your cloud account. Unless there is a business need to provision guest access, it is best practice avoid creating guest users. Guest users could potentially be overlooked indefinitely leading to a potential vulnerability.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>106</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-first-occurrence-of-entra-id-auth-via-devicecode-protocol.html" title="First Occurrence of Entra ID Auth via DeviceCode Protocol">First Occurrence of Entra ID Auth via DeviceCode Protocol</a></p></td>
<td align="left" valign="top"><p>Identifies when a user is observed for the first time in the last 14 days authenticating using the device code authentication workflow. This authentication workflow can be abused by attackers to phish users and steal access tokens to impersonate the victim. By its very nature, device code should only be used when logging in to devices without keyboards, where it is difficult to enter emails and passwords.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>6</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-microsoft-graph-first-occurrence-of-client-request.html" title="Microsoft Graph First Occurrence of Client Request">Microsoft Graph First Occurrence of Client Request</a></p></td>
<td align="left" valign="top"><p>This New Terms rule focuses on the first occurrence of a client application ID (azure.graphactivitylogs.properties.app_id) making a request to Microsoft Graph API for a specific tenant ID (azure.tenant_id) and user principal object ID (azure.graphactivitylogs.properties.user_principal_object_id). This rule may helps identify unauthorized access or actions performed by compromised accounts. Advesaries may succesfully compromise a user&#8217;s credentials and use the Microsoft Graph API to access resources or perform actions on behalf of the user.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>4</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-azure-application-credential-modification.html" title="Azure Application Credential Modification">Azure Application Credential Modification</a></p></td>
<td align="left" valign="top"><p>Identifies when a new credential is added to an application in Azure. An application may use a certificate or secret string to prove its identity when requesting a token. Multiple certificates and secrets can be added for an application and an adversary may abuse this by creating an additional authentication method to evade defenses or persist in an environment.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>106</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-azure-automation-account-created.html" title="Azure Automation Account Created">Azure Automation Account Created</a></p></td>
<td align="left" valign="top"><p>Identifies when an Azure Automation account is created. Azure Automation accounts can be used to automate management tasks and orchestrate actions across systems. An adversary may create an Automation account in order to maintain persistence in their target&#8217;s environment.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>106</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-azure-automation-webhook-created.html" title="Azure Automation Webhook Created">Azure Automation Webhook Created</a></p></td>
<td align="left" valign="top"><p>Identifies when an Azure Automation webhook is created. Azure Automation runbooks can be configured to execute via a webhook. A webhook uses a custom URL passed to Azure Automation along with a data payload specific to the runbook. An adversary may create a webhook in order to trigger a runbook that contains malicious code.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>106</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-entra-id-global-administrator-role-assigned.html" title="Entra ID Global Administrator Role Assigned">Entra ID Global Administrator Role Assigned</a></p></td>
<td align="left" valign="top"><p>In Microsoft Entra ID, permissions to manage resources are assigned using roles. The Global Administrator is a role that enables users to have access to all administrative features in Microsoft Entra ID and services that use Microsoft Entra ID identities like the Microsoft 365 Defender portal, the Microsoft 365 compliance center, Exchange, SharePoint Online, and Skype for Business Online. Attackers can add users as Global Administrators to maintain access and manage all subscriptions and their settings and resources. They can also elevate privilege to User Access Administrator to pivot into Azure resources.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>106</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-azure-global-administrator-role-addition-to-pim-user.html" title="Azure Global Administrator Role Addition to PIM User">Azure Global Administrator Role Addition to PIM User</a></p></td>
<td align="left" valign="top"><p>Identifies an Azure Active Directory (AD) Global Administrator role addition to a Privileged Identity Management (PIM) user account. PIM is a service that enables you to manage, control, and monitor access to important resources in an organization. Users who are assigned to the Global administrator role can read and modify any administrative setting in your Azure AD organization.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>106</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-azure-privilege-identity-management-role-modified.html" title="Azure Privilege Identity Management Role Modified">Azure Privilege Identity Management Role Modified</a></p></td>
<td align="left" valign="top"><p>Azure Active Directory (AD) Privileged Identity Management (PIM) is a service that enables you to manage, control, and monitor access to important resources in an organization. PIM can be used to manage the built-in Azure resource roles such as Global Administrator and Application Administrator. An adversary may add a user to a PIM role in order to maintain persistence in their target&#8217;s environment or modify a PIM role to weaken their target&#8217;s security controls.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>108</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-microsoft-entra-id-conditional-access-policy-cap-modified.html" title="Microsoft Entra ID Conditional Access Policy (CAP) Modified">Microsoft Entra ID Conditional Access Policy (CAP) Modified</a></p></td>
<td align="left" valign="top"><p>Identifies a modification to a conditional access policy (CAP) in Microsoft Entra ID. Adversaries may modify existing CAPs to loosen access controls and maintain persistence in the environment with a compromised identity or entity.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>107</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-oidc-discovery-url-changed-in-entra-id.html" title="OIDC Discovery URL Changed in Entra ID">OIDC Discovery URL Changed in Entra ID</a></p></td>
<td align="left" valign="top"><p>Detects a change to the OpenID Connect (OIDC) discovery URL in the Entra ID Authentication Methods Policy. This behavior may indicate an attempt to federate Entra ID with an attacker-controlled identity provider, enabling bypass of multi-factor authentication (MFA) and unauthorized access through bring-your-own IdP (BYOIDP) methods.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>4</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-entra-id-rt-to-prt-transition-from-same-user-and-device.html" title="Entra ID RT to PRT Transition from Same User and Device">Entra ID RT to PRT Transition from Same User and Device</a></p></td>
<td align="left" valign="top"><p>Identifies when a user signs in with a refresh token using the Microsoft Authentication Broker (MAB) client, followed by a Primary Refresh Token (PRT) sign-in from the same device within 1 hour. This pattern may indicate that an attacker has successfully registered a device using ROADtx and transitioned from short-term token access to long-term persistent access via PRTs. Excluding access to the Device Registration Service (DRS) ensures the PRT is being used beyond registration, often to access Microsoft 365 resources like Outlook or SharePoint.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>2</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-azure-event-hub-authorization-rule-created-or-updated.html" title="Azure Event Hub Authorization Rule Created or Updated">Azure Event Hub Authorization Rule Created or Updated</a></p></td>
<td align="left" valign="top"><p>Identifies when an Event Hub Authorization Rule is created or updated in Azure. An authorization rule is associated with specific rights, and carries a pair of cryptographic keys. When you create an Event Hubs namespace, a policy rule named RootManageSharedAccessKey is created for the namespace. This has manage permissions for the entire namespace and it&#8217;s recommended that you treat this rule like an administrative root account and don&#8217;t use it in your application.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>107</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-user-added-as-owner-for-azure-application.html" title="User Added as Owner for Azure Application">User Added as Owner for Azure Application</a></p></td>
<td align="left" valign="top"><p>Identifies when a user is added as an owner for an Azure application. An adversary may add a user account as an owner for an Azure application in order to grant additional permissions and modify the application&#8217;s configuration using another account.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>106</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-user-added-as-owner-for-azure-service-principal.html" title="User Added as Owner for Azure Service Principal">User Added as Owner for Azure Service Principal</a></p></td>
<td align="left" valign="top"><p>Identifies when a user is added as an owner for an Azure service principal. The service principal object defines what the application can do in the specific tenant, who can access the application, and what resources the app can access. A service principal object is created when an application is given permission to access resources in a tenant. An adversary may add a user account as an owner for a service principal and use that account in order to define what an application can do in the Azure AD tenant.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>106</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-azure-kubernetes-rolebindings-created.html" title="Azure Kubernetes Rolebindings Created">Azure Kubernetes Rolebindings Created</a></p></td>
<td align="left" valign="top"><p>Identifies the creation of role binding or cluster role bindings. You can assign these roles to Kubernetes subjects (users, groups, or service accounts) with role bindings and cluster role bindings. An adversary who has permissions to create bindings and cluster-bindings in the cluster can create a binding to the cluster-admin ClusterRole or to other high privileges roles.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>106</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-microsoft-entra-id-elevated-access-to-user-access-administrator.html" title="Microsoft Entra ID Elevated Access to User Access Administrator">Microsoft Entra ID Elevated Access to User Access Administrator</a></p></td>
<td align="left" valign="top"><p>Identifies when a user has elevated their access to User Access Administrator for their Azure Resources. The User Access Administrator role allows users to manage user access to Azure resources, including the ability to assign roles and permissions. Adversaries may target an Entra ID Global Administrator or other privileged role to elevate their access to User Access Administrator, which can lead to further privilege escalation and unauthorized access to sensitive resources. This is a New Terms rule that only signals if the user principal name has not been seen doing this activity in the last 14 days.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>2</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-microsoft-365-inbox-forwarding-rule-created.html" title="Microsoft 365 Inbox Forwarding Rule Created">Microsoft 365 Inbox Forwarding Rule Created</a></p></td>
<td align="left" valign="top"><p>Identifies when a new Inbox forwarding rule is created in Microsoft 365. Inbox rules process messages in the Inbox based on conditions and take actions. In this case, the rules will forward the emails to a defined address. Attackers can abuse Inbox Rules to intercept and exfiltrate email data without making organization-wide configuration changes or having the corresponding privileges.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>210</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-m365-onedrive-excessive-file-downloads-with-oauth-token.html" title="M365 OneDrive Excessive File Downloads with OAuth Token">M365 OneDrive Excessive File Downloads with OAuth Token</a></p></td>
<td align="left" valign="top"><p>Identifies when an excessive number of files are downloaded from OneDrive using OAuth authentication. Adversaries may conduct phishing campaigns to steal OAuth tokens and impersonate users. These access tokens can then be used to download files from OneDrive.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>4</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-microsoft-365-oauth-redirect-to-device-registration-for-user-principal.html" title="Microsoft 365 OAuth Redirect to Device Registration for User Principal">Microsoft 365 OAuth Redirect to Device Registration for User Principal</a></p></td>
<td align="left" valign="top"><p>Identifies attempts to register a new device in Microsoft Entra ID after OAuth authentication with authorization code grant. Adversaries may use OAuth phishing techniques to obtain an OAuth authorization code, which can then be exchanged for access and refresh tokens. This rule detects a sequence of events where a user principal authenticates via OAuth, followed by a device registration event, indicating potential misuse of the OAuth flow to establish persistence or access resources.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>2</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-multiple-microsoft-365-user-account-lockouts-in-short-time-window.html" title="Multiple Microsoft 365 User Account Lockouts in Short Time Window">Multiple Microsoft 365 User Account Lockouts in Short Time Window</a></p></td>
<td align="left" valign="top"><p>Detects a burst of Microsoft 365 user account lockouts within a short 5-minute window. A high number of IdsLocked login errors across multiple user accounts may indicate brute-force attempts for the same users resulting in lockouts.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>4</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-o365-excessive-single-sign-on-logon-errors.html" title="O365 Excessive Single Sign-On Logon Errors">O365 Excessive Single Sign-On Logon Errors</a></p></td>
<td align="left" valign="top"><p>Identifies accounts with a high number of single sign-on (SSO) logon errors. Excessive logon errors may indicate an attempt to brute force a password or SSO token.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>211</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-microsoft-365-exchange-anti-phish-policy-deletion.html" title="Microsoft 365 Exchange Anti-Phish Policy Deletion">Microsoft 365 Exchange Anti-Phish Policy Deletion</a></p></td>
<td align="left" valign="top"><p>Identifies the deletion of an anti-phishing policy in Microsoft 365. By default, Microsoft 365 includes built-in features that help protect users from phishing attacks. Anti-phishing polices increase this protection by refining settings to better detect and prevent attacks.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>210</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-microsoft-365-exchange-anti-phish-rule-modification.html" title="Microsoft 365 Exchange Anti-Phish Rule Modification">Microsoft 365 Exchange Anti-Phish Rule Modification</a></p></td>
<td align="left" valign="top"><p>Identifies the modification of an anti-phishing rule in Microsoft 365. By default, Microsoft 365 includes built-in features that help protect users from phishing attacks. Anti-phishing rules increase this protection by refining settings to better detect and prevent attacks.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>210</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-microsoft-365-exchange-dkim-signing-configuration-disabled.html" title="Microsoft 365 Exchange DKIM Signing Configuration Disabled">Microsoft 365 Exchange DKIM Signing Configuration Disabled</a></p></td>
<td align="left" valign="top"><p>Identifies when a DomainKeys Identified Mail (DKIM) signing configuration is disabled in Microsoft 365. With DKIM in Microsoft 365, messages that are sent from Exchange Online will be cryptographically signed. This will allow the receiving email system to validate that the messages were generated by a server that the organization authorized and were not spoofed.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>210</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-microsoft-365-exchange-dlp-policy-removed.html" title="Microsoft 365 Exchange DLP Policy Removed">Microsoft 365 Exchange DLP Policy Removed</a></p></td>
<td align="left" valign="top"><p>Identifies when a Data Loss Prevention (DLP) policy is removed in Microsoft 365. An adversary may remove a DLP policy to evade existing DLP monitoring.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>210</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-microsoft-365-exchange-malware-filter-policy-deletion.html" title="Microsoft 365 Exchange Malware Filter Policy Deletion">Microsoft 365 Exchange Malware Filter Policy Deletion</a></p></td>
<td align="left" valign="top"><p>Identifies when a malware filter policy has been deleted in Microsoft 365. A malware filter policy is used to alert administrators that an internal user sent a message that contained malware. This may indicate an account or machine compromise that would need to be investigated. Deletion of a malware filter policy may be done to evade detection.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>210</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-microsoft-365-exchange-malware-filter-rule-modification.html" title="Microsoft 365 Exchange Malware Filter Rule Modification">Microsoft 365 Exchange Malware Filter Rule Modification</a></p></td>
<td align="left" valign="top"><p>Identifies when a malware filter rule has been deleted or disabled in Microsoft 365. An adversary or insider threat may want to modify a malware filter rule to evade detection.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>210</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-microsoft-365-exchange-safe-attachment-rule-disabled.html" title="Microsoft 365 Exchange Safe Attachment Rule Disabled">Microsoft 365 Exchange Safe Attachment Rule Disabled</a></p></td>
<td align="left" valign="top"><p>Identifies when a safe attachment rule is disabled in Microsoft 365. Safe attachment rules can extend malware protections to include routing all messages and attachments without a known malware signature to a special hypervisor environment. An adversary or insider threat may disable a safe attachment rule to exfiltrate data or evade defenses.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>210</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-microsoft-365-exchange-safe-link-policy-disabled.html" title="Microsoft 365 Exchange Safe Link Policy Disabled">Microsoft 365 Exchange Safe Link Policy Disabled</a></p></td>
<td align="left" valign="top"><p>Identifies when a Safe Link policy is disabled in Microsoft 365. Safe Link policies for Office applications extend phishing protection to documents that contain hyperlinks, even after they have been delivered to a user.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>210</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-o365-mailbox-audit-logging-bypass.html" title="O365 Mailbox Audit Logging Bypass">O365 Mailbox Audit Logging Bypass</a></p></td>
<td align="left" valign="top"><p>Detects the occurrence of mailbox audit bypass associations. The mailbox audit is responsible for logging specified mailbox events (like accessing a folder or a message or permanently deleting a message). However, actions taken by some authorized accounts, such as accounts used by third-party tools or accounts used for lawful monitoring, can create a large number of mailbox audit log entries and may not be of interest to your organization. Because of this, administrators can create bypass associations, allowing certain accounts to perform their tasks without being logged. Attackers can abuse this allowlist mechanism to conceal actions taken, as the mailbox audit will log no activity done by the account.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>210</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-suspicious-microsoft-365-userloggedin-via-oauth-code.html" title="Suspicious Microsoft 365 UserLoggedIn via OAuth Code">Suspicious Microsoft 365 UserLoggedIn via OAuth Code</a></p></td>
<td align="left" valign="top"><p>Identifies sign-ins on behalf of a principal user to the Microsoft Graph API from multiple IPs using the Microsoft Authentication Broker or Visual Studio Code application. This behavior may indicate an adversary using a phished OAuth refresh token.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>4</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-microsoft-365-teams-custom-application-interaction-allowed.html" title="Microsoft 365 Teams Custom Application Interaction Allowed">Microsoft 365 Teams Custom Application Interaction Allowed</a></p></td>
<td align="left" valign="top"><p>Identifies when custom applications are allowed in Microsoft Teams. If an organization requires applications other than those available in the Teams app store, custom applications can be developed as packages and uploaded. An adversary may abuse this behavior to establish persistence in an environment.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>211</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-microsoft-365-teams-external-access-enabled.html" title="Microsoft 365 Teams External Access Enabled">Microsoft 365 Teams External Access Enabled</a></p></td>
<td align="left" valign="top"><p>Identifies when external access is enabled in Microsoft Teams. External access lets Teams and Skype for Business users communicate with other users that are outside their organization. An adversary may enable external access or add an allowed domain to exfiltrate data or maintain persistence in an environment.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>210</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-microsoft-365-exchange-transport-rule-creation.html" title="Microsoft 365 Exchange Transport Rule Creation">Microsoft 365 Exchange Transport Rule Creation</a></p></td>
<td align="left" valign="top"><p>Identifies a transport rule creation in Microsoft 365. As a best practice, Exchange Online mail transport rules should not be set to forward email to domains outside of your organization. An adversary may create transport rules to exfiltrate data.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>210</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-microsoft-365-exchange-transport-rule-modification.html" title="Microsoft 365 Exchange Transport Rule Modification">Microsoft 365 Exchange Transport Rule Modification</a></p></td>
<td align="left" valign="top"><p>Identifies when a transport rule has been disabled or deleted in Microsoft 365. Mail flow rules (also known as transport rules) are used to identify and take action on messages that flow through your organization. An adversary or insider threat may modify a transport rule to exfiltrate data or evade defenses.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>210</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-microsoft-365-potential-ransomware-activity.html" title="Microsoft 365 Potential ransomware activity">Microsoft 365 Potential ransomware activity</a></p></td>
<td align="left" valign="top"><p>Identifies when Microsoft Cloud App Security reports that a user has uploaded files to the cloud that might be infected with ransomware.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>210</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-microsoft-365-unusual-volume-of-file-deletion.html" title="Microsoft 365 Unusual Volume of File Deletion">Microsoft 365 Unusual Volume of File Deletion</a></p></td>
<td align="left" valign="top"><p>Identifies that a user has deleted an unusually large volume of files as reported by Microsoft Cloud App Security.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>210</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-microsoft-365-illicit-consent-grant-via-registered-application.html" title="Microsoft 365 Illicit Consent Grant via Registered Application">Microsoft 365 Illicit Consent Grant via Registered Application</a></p></td>
<td align="left" valign="top"><p>Identifies an Microsoft 365 illicit consent grant request on-behalf-of a registered Entra ID application. Adversaries may create and register an application in Microsoft Entra ID for the purpose of requesting user consent to access resources in Microsoft 365. This is accomplished by tricking a user into granting consent to the application, typically via a pre-made phishing URL. This establishes an OAuth grant that allows the malicious client applocation to access resources in Microsoft 365 on-behalf-of the user.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>5</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-microsoft-365-user-restricted-from-sending-email.html" title="Microsoft 365 User Restricted from Sending Email">Microsoft 365 User Restricted from Sending Email</a></p></td>
<td align="left" valign="top"><p>Identifies when a user has been restricted from sending email due to exceeding sending limits of the service policies per the Security Compliance Center.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>210</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-o365-email-reported-by-user-as-malware-or-phish.html" title="O365 Email Reported by User as Malware or Phish">O365 Email Reported by User as Malware or Phish</a></p></td>
<td align="left" valign="top"><p>Detects the occurrence of emails reported as Phishing or Malware by Users. Security Awareness training is essential to stay ahead of scammers and threat actors, as security products can be bypassed, and the user can still receive a malicious message. Educating users to report suspicious messages can help identify gaps in security controls and prevent malware infections and Business Email Compromise attacks.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>210</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-onedrive-malware-file-upload.html" title="OneDrive Malware File Upload">OneDrive Malware File Upload</a></p></td>
<td align="left" valign="top"><p>Identifies the occurence of files uploaded to OneDrive being detected as Malware by the file scanning engine. Attackers can use File Sharing and Organization Repositories to spread laterally within the company and amplify their access. Users can inadvertently share these files without knowing their maliciousness, giving adversaries opportunity to gain initial access to other endpoints in the environment.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>210</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-sharepoint-malware-file-upload.html" title="SharePoint Malware File Upload">SharePoint Malware File Upload</a></p></td>
<td align="left" valign="top"><p>Identifies the occurence of files uploaded to SharePoint being detected as Malware by the file scanning engine. Attackers can use File Sharing and Organization Repositories to spread laterally within the company and amplify their access. Users can inadvertently share these files without knowing their maliciousness, giving adversaries opportunities to gain initial access to other endpoints in the environment.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>210</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-microsoft-365-exchange-management-group-role-assignment.html" title="Microsoft 365 Exchange Management Group Role Assignment">Microsoft 365 Exchange Management Group Role Assignment</a></p></td>
<td align="left" valign="top"><p>Identifies when a new role is assigned to a management group in Microsoft 365. An adversary may attempt to add a role in order to maintain persistence in an environment.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>210</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-microsoft-365-teams-guest-access-enabled.html" title="Microsoft 365 Teams Guest Access Enabled">Microsoft 365 Teams Guest Access Enabled</a></p></td>
<td align="left" valign="top"><p>Identifies when guest access is enabled in Microsoft Teams. Guest access in Teams allows people outside the organization to access teams and channels. An adversary may enable guest access to maintain persistence in an environment.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>210</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-new-or-modified-federation-domain.html" title="New or Modified Federation Domain">New or Modified Federation Domain</a></p></td>
<td align="left" valign="top"><p>Identifies a new or modified federation domain, which can be used to create a trust between O365 and an external identity provider.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>211</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-multiple-device-token-hashes-for-single-okta-session.html" title="Multiple Device Token Hashes for Single Okta Session">Multiple Device Token Hashes for Single Okta Session</a></p></td>
<td align="left" valign="top"><p>This rule detects when a specific Okta actor has multiple device token hashes for a single Okta session. This may indicate an authenticated session has been hijacked or is being used by multiple devices. Adversaries may hijack a session to gain unauthorized access to Okta admin console, applications, tenants, or other resources.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>308</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-multiple-okta-user-authentication-events-with-client-address.html" title="Multiple Okta User Authentication Events with Client Address">Multiple Okta User Authentication Events with Client Address</a></p></td>
<td align="left" valign="top"><p>Detects when a certain threshold of Okta user authentication events are reported for multiple users from the same client address. Adversaries may attempt to launch a credential stuffing or password spraying attack from the same device by using a list of known usernames and passwords to gain unauthorized access to user accounts.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>207</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-multiple-okta-user-authentication-events-with-same-device-token-hash.html" title="Multiple Okta User Authentication Events with Same Device Token Hash">Multiple Okta User Authentication Events with Same Device Token Hash</a></p></td>
<td align="left" valign="top"><p>Detects when a high number of Okta user authentication events are reported for multiple users in a short time frame. Adversaries may attempt to launch a credential stuffing or password spraying attack from the same device by using a list of known usernames and passwords to gain unauthorized access to user accounts.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>207</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-high-number-of-okta-device-token-cookies-generated-for-authentication.html" title="High Number of Okta Device Token Cookies Generated for Authentication">High Number of Okta Device Token Cookies Generated for Authentication</a></p></td>
<td align="left" valign="top"><p>Detects when an Okta client address has a certain threshold of Okta user authentication events with multiple device token hashes generated for single user authentication. Adversaries may attempt to launch a credential stuffing or password spraying attack from the same device by using a list of known usernames and passwords to gain unauthorized access to user accounts.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>207</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-okta-user-sessions-started-from-different-geolocations.html" title="Okta User Sessions Started from Different Geolocations">Okta User Sessions Started from Different Geolocations</a></p></td>
<td align="left" valign="top"><p>Detects when a specific Okta actor has multiple sessions started from different geolocations. Adversaries may attempt to launch an attack by using a list of known usernames and passwords to gain unauthorized access to user accounts from different locations.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>308</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-unusual-instance-metadata-service-imds-api-request.html" title="Unusual Instance Metadata Service (IMDS) API Request">Unusual Instance Metadata Service (IMDS) API Request</a></p></td>
<td align="left" valign="top"><p>This rule identifies potentially malicious processes attempting to access the cloud service provider&#8217;s instance metadata service (IMDS) API endpoint, which can be used to retrieve sensitive instance-specific information such as instance ID, public IP address, and even temporary security credentials if role&#8217;s are assumed by that instance. The rule monitors for various tools and scripts like curl, wget, python, and perl that might be used to interact with the metadata API.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>7</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-attempt-to-disable-syslog-service.html" title="Attempt to Disable Syslog Service">Attempt to Disable Syslog Service</a></p></td>
<td align="left" valign="top"><p>Adversaries may attempt to disable the syslog service in an attempt to an attempt to disrupt event logging and evade detection by security controls.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>215</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-dynamic-linker-creation-or-modification.html" title="Dynamic Linker Creation or Modification">Dynamic Linker Creation or Modification</a></p></td>
<td align="left" valign="top"><p>Detects the creation or modification of files related to the configuration of the dynamic linker on Linux systems. The dynamic linker is a shared library that is used by the Linux kernel to load and execute programs. Attackers may attempt to hijack the execution flow of a program by modifying the dynamic linker configuration files. This technique is often observed by userland rootkits that leverage shared objects to maintain persistence on a compromised host.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>7</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-kill-command-execution.html" title="Kill Command Execution">Kill Command Execution</a></p></td>
<td align="left" valign="top"><p>This rule detects the execution of kill, pkill, and killall commands on Linux systems. These commands are used to terminate processes on a system. Attackers may use these commands to kill security tools or other processes to evade detection or disrupt system operations.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>4</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-dynamic-linker-ld-so-creation.html" title="Dynamic Linker (ld.so) Creation">Dynamic Linker (ld.so) Creation</a></p></td>
<td align="left" valign="top"><p>This rule detects the creation of the dynamic linker (ld.so). The dynamic linker is used to load shared libraries needed by an executable. Attackers may attempt to replace the dynamic linker with a malicious version to execute arbitrary code.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>105</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-potential-port-scanning-activity-from-compromised-host.html" title="Potential Port Scanning Activity from Compromised Host">Potential Port Scanning Activity from Compromised Host</a></p></td>
<td align="left" valign="top"><p>This rule detects potential port scanning activity from a compromised host. Port scanning is a common reconnaissance technique used by attackers to identify open ports and services on a target system. A compromised host may exhibit port scanning behavior when an attacker is attempting to map out the network topology, identify vulnerable services, or prepare for further exploitation. This rule identifies potential port scanning activity by monitoring network connection attempts from a single host to a large number of ports within a short time frame. ESQL rules have limited fields available in its alert documents. Make sure to review the original documents to aid in the investigation of this alert.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>7</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-suspicious-path-invocation-from-command-line.html" title="Suspicious Path Invocation from Command Line">Suspicious Path Invocation from Command Line</a></p></td>
<td align="left" valign="top"><p>This rule detects the execution of a PATH variable in a command line invocation by a shell process. This behavior is unusual and may indicate an attempt to execute a command from a non-standard location. This technique may be used to evade detection or perform unauthorized actions on the system.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>5</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-unusual-remote-file-creation.html" title="Unusual Remote File Creation">Unusual Remote File Creation</a></p></td>
<td align="left" valign="top"><p>This rule leverages the new_terms rule type to detect file creation via a commonly used file transfer service while excluding typical remote file creation activity. This behavior is often linked to lateral movement, potentially indicating an attacker attempting to move within a network.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>4</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-cron-job-created-or-modified.html" title="Cron Job Created or Modified">Cron Job Created or Modified</a></p></td>
<td align="left" valign="top"><p>This rule monitors for (ana)cron jobs being created or renamed. Linux cron jobs are scheduled tasks that can be leveraged by system administrators to set up scheduled tasks, but may be abused by malicious actors for persistence, privilege escalation and command execution. By creating or modifying cron job configurations, attackers can execute malicious commands or scripts at predefined intervals, ensuring their continued presence and enabling unauthorized activities.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>18</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-initramfs-extraction-via-cpio.html" title="Initramfs Extraction via CPIO">Initramfs Extraction via CPIO</a></p></td>
<td align="left" valign="top"><p>This rule detects the extraction of an initramfs image using the "cpio" command on Linux systems. The "cpio" command is used to create or extract cpio archives. Attackers may extract the initramfs image to modify the contents or add malicious files, which can be leveraged to maintain persistence on the system.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>5</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-network-activity-to-a-suspicious-top-level-domain.html" title="Network Activity to a Suspicious Top Level Domain">Network Activity to a Suspicious Top Level Domain</a></p></td>
<td align="left" valign="top"><p>Identifies DNS queries to commonly abused Top Level Domains by common LOLBINs or executable running from world writable directories or unsigned binaries. This behavior matches on common malware C2 abusing less formal domain names.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>3</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-potential-remotemonologue-attack.html" title="Potential RemoteMonologue Attack">Potential RemoteMonologue Attack</a></p></td>
<td align="left" valign="top"><p>Identifies attempt to perform session hijack via COM object registry modification by setting the RunAs value to Interactive User.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>4</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-suspicious-powershell-engine-imageload.html" title="Suspicious PowerShell Engine ImageLoad">Suspicious PowerShell Engine ImageLoad</a></p></td>
<td align="left" valign="top"><p>Identifies the PowerShell engine being invoked by unexpected processes. Rather than executing PowerShell functionality with powershell.exe, some attackers do this to operate more stealthily.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>214</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-suspicious-windows-powershell-arguments.html" title="Suspicious Windows Powershell Arguments">Suspicious Windows Powershell Arguments</a></p></td>
<td align="left" valign="top"><p>Identifies the execution of PowerShell with suspicious argument values. This behavior is often observed during malware installation leveraging PowerShell.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>209</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-potential-ransomware-behavior-note-files-by-system.html" title="Potential Ransomware Behavior - Note Files by System">Potential Ransomware Behavior - Note Files by System</a></p></td>
<td align="left" valign="top"><p>This rule identifies the creation of multiple files with same name and over SMB by the same user. This behavior may indicate the successful remote execution of a ransomware dropping file notes to different folders.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>211</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-unusual-file-operation-by-dns-exe.html" title="Unusual File Operation by dns.exe">Unusual File Operation by dns.exe</a></p></td>
<td align="left" valign="top"><p>Identifies an unexpected file being modified by dns.exe, the process responsible for Windows DNS Server services, which may indicate activity related to remote code execution or other forms of exploitation.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>216</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-18-15-startup-or-run-key-registry-modification.html" title="Startup or Run Key Registry Modification">Startup or Run Key Registry Modification</a></p></td>
<td align="left" valign="top"><p>Identifies run key or startup key registry modifications. In order to survive reboots and other system interrupts, attackers will modify run keys within the registry or leverage startup folder items as a form of persistence.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>118</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="prebuilt-rule-8-18-14-prebuilt-rules-8-18-14-summary.html">« Update v8.18.14</a>
</span>
<span class="next">
<a href="endpoint-protection-intro.html">Configure endpoint protection with Elastic Defend »</a>
</span>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>

                        <!-- Feedback widget -->
                        <div id="feedbackWidgetContainer"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


        <div id='elastic-footer'></div>
        <script src='https://www.elastic.co/elastic-footer.js'></script>
        <!-- Footer Section end-->

      </section>
    </div>

    <!-- Feedback modal -->
    <div id="feedbackModalContainer"></div>

    <script src="/guide/static/jquery.js"></script>
    <script type="text/javascript" src="/guide/static/docs-v1.js"></script>
    <script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
