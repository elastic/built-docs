<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Monitor and troubleshoot rule executions | Elastic Security [8.19] | Elastic</title>
<meta class="elastic" name="content" content="Monitor and troubleshoot rule executions | Elastic Security [8.19]">

<link rel="home" href="index.html" title="Elastic Security [8.19]"/>
<link rel="up" href="detection-engine-overview.html" title="Detections and alerts"/>
<link rel="prev" href="rules-ui-management.html" title="Manage detection rules"/>
<link rel="next" href="detections-ui-exceptions.html" title="Rule exceptions"/>
<meta class="elastic" name="product_version" content="8.19"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.19"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.19"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles-v1.css" />
  </head>

  <!--© 2015-2025 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div class="page_header">
This documentation contains work-in-progress information for future Elastic Stack and Cloud releases. Use the version selector to view supported release docs. It also contains some Elastic Cloud serverless information. Check out our <a href="https://www.elastic.co/docs/current/serverless">serverless docs</a> for more details.
</div>
<div class="navheader">
<span class="prev">
<a href="rules-ui-management.html">« Manage detection rules</a>
</span>
<span class="next">
<a href="detections-ui-exceptions.html">Rule exceptions »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security [8.19]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="detection-engine-overview.html">Detections and alerts</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Monitor and troubleshoot rule executions</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.19/docs/detections/rules-ui-monitor.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div id="url-to-v3" class="version-warning">
    <strong>IMPORTANT</strong>: This documentation is no longer updated. Refer to <a href="https://www.elastic.co/support/eol">Elastic's version policy</a> and the <a href="https://www.elastic.co/docs/solutions/security/detect-and-alert/monitor-rule-executions">latest documentation</a>.
</div>
<div class="chapter">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="alerts-ui-monitor"></a>Monitor and troubleshoot rule executions</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.19/docs/detections/rules-ui-monitor.asciidoc">edit</a></div>
</div></div></div>
<p>Several tools can help you gain insight into the performance of your detection rules:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="alerts-ui-monitor.html#rule-monitoring-tab" title="Rule Monitoring tab">Rule Monitoring tab</a> — The current state of all detection rules and their most recent executions. Go to the <span class="strong strong"><strong>Rule Monitoring</strong></span> tab to get an overview of which rules are running, how long they&#8217;re taking, and if they&#8217;re having any trouble.
</li>
<li class="listitem">
<a class="xref" href="alerts-ui-monitor.html#rule-execution-logs" title="Execution results tab">Execution results</a> — Historical data for a single detection rule&#8217;s executions over time. Consult the execution results to understand how a particular rule is running and whether it&#8217;s creating the alerts you expect.
</li>
<li class="listitem">
<a class="xref" href="rule-monitoring-dashboard.html" title="Detection rule monitoring dashboard">Detection rule monitoring dashboard</a> — Visualizations to help you monitor the overall health and performance of Elastic Security&#8217;s detection rules. Consult this dashboard for a high-level view of whether your rules are running successfully and how long they&#8217;re taking to run, search data, and create alerts.
</li>
</ul>
</div>
<p>Refer to the <a class="xref" href="alerts-ui-monitor.html#troubleshoot-signals" title="Troubleshoot missing alerts">Troubleshoot missing alerts</a> section below for strategies on adjusting rules if they aren&#8217;t creating the expected alerts.</p>
<div class="position-relative"><h3><a id="rule-monitoring-tab"></a>Rule Monitoring tab</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.19/docs/detections/rules-ui-monitor.asciidoc">edit</a></div>
<p>To view a summary of all rule executions (including the most recent failures, execution times, and gaps in rule executions), select the <span class="strong strong"><strong>Rule Monitoring</strong></span> tab on the <span class="strong strong"><strong>Rules</strong></span> page. To access the tab, find <span class="strong strong"><strong>Detection rules (SIEM)</strong></span> in the navigation menu or look for “Detection rules (SIEM)” using the <a href="/guide/en/kibana/8.19/introduction.html#kibana-navigation-search" class="ulink" target="_top">global search field</a>, then go to the <span class="strong strong"><strong>Rule Monitoring</strong></span> tab.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/monitor-table.png" alt="monitor table">
</div>
</div>
<p>On the <span class="strong strong"><strong>Rule Monitoring</strong></span> tab, you can <a class="xref" href="rules-ui-management.html#sort-filter-rules" title="Sort and filter the rules list">sort and filter rules</a> just like you can on the <span class="strong strong"><strong>Installed Rules</strong></span> tab.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>To sort the rules list, click any column header. To sort in descending order, click the column header again.</p>
</div>
</div>
<p>For detailed information on a rule, the alerts it generated, and associated errors, click on its name in the table. This also allows you to perform the same actions that are available on the <a class="xref" href="rules-ui-management.html" title="Manage detection rules"><span class="strong strong"><strong>Installed Rules</strong></span> tab</a>, such as modifying or deleting rules, activating or deactivating rules, exporting or importing rules, and duplicating prebuilt rules.</p>
<p>For information about rule execution gaps (which are periods of time when a rule didn&#8217;t run), use the panel above the table. The time filter on the left allows you to select a time range for viewing gap data. The <span class="strong strong"><strong>Total rules with gaps:</strong></span> field provides two metrics:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Right metric: Tells you the remaining number of rules with unfilled gaps.
</li>
<li class="listitem">
Left metric: Tells you the number of rules that are currently having their gaps resolved.
</li>
</ul>
</div>
<p>The <span class="strong strong"><strong>Only rules with unfilled gaps</strong></span> filter on the right of the panel lets you only display rules with unfilled gaps. Note that the filter excludes rules with gaps that are being filled.</p>
<p>Within the Rules table, the <span class="strong strong"><strong>Last Gap (if any)</strong></span> column conveys how long the most recent gap for a rule lasted. The <span class="strong strong"><strong>Unfilled gaps duration</strong></span> column shows whether a rule still has gaps and provides a total sum of the remaining unfilled or partially filled gaps. The total sum can change based on the time range that you select in the panel above the table. If a rule has no gaps, the columns display a dash (<code class="literal">––</code>).</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>For a detailed view of a rule&#8217;s gaps, go to the <span class="strong strong"><strong>Execution results</strong></span> tab and check the <a class="xref" href="alerts-ui-monitor.html#gaps-table" title="Gaps table">Gaps table</a>.</p>
</div>
</div>
<div class="position-relative"><h3><a id="rule-execution-logs"></a>Execution results tab</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.19/docs/detections/rules-ui-monitor.asciidoc">edit</a></div>
<p>From the <span class="strong strong"><strong>Execution results</strong></span> tab, you can access the rule’s execution log, monitor and address gaps in a rule&#8217;s execution schedule, and check manual runs for the rule. To find the tab, click the rule&#8217;s name to open its details, then scroll down.</p>
<div class="position-relative"><h4><a id="execution-results-tab"></a>Execution log table</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.19/docs/detections/rules-ui-monitor.asciidoc">edit</a></div>
<p>Each detection rule execution is logged, including the execution type, the execution&#8217;s success or failure, any warning or error messages, how long it took to search for data, create alerts, and complete. This can help you troubleshoot a particular rule if it isn&#8217;t behaving as expected (for example, if it isn&#8217;t creating alerts or takes a long time to run).</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/rule-execution-logs.png" alt="Execution log table on the rule execution results tab">
</div>
</div>
<p>You can hover over each column heading to display a tooltip about that column&#8217;s data. Click a column heading to sort the table by that column. Within the Execution log table, you can click the arrow at the end of a row to expand a long warning or error message.</p>
<p>Use these controls to filter what&#8217;s included in the logs table:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>The <span class="strong strong"><strong>Run type</strong></span> drop-down filters the table by rule execution type:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Scheduled</strong></span>: Automatic, scheduled rule executions.
</li>
<li class="listitem">
<span class="strong strong"><strong>Manual</strong></span>: Rule executions that were <a class="xref" href="rules-ui-management.html#manually-run-rules" title="Run rules manually">started manually</a>.
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>The <span class="strong strong"><strong>Status</strong></span> drop-down filters the table by rule execution status:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Succeeded</strong></span>: The rule completed its defined search. This doesn&#8217;t necessarily mean it generated an alert, just that it ran without error.
</li>
<li class="listitem">
<span class="strong strong"><strong>Failed</strong></span>: The rule encountered an error that prevented it from running. For example, a machine learning rule whose corresponding machine learning job wasn&#8217;t running.
</li>
<li class="listitem">
<span class="strong strong"><strong>Warning</strong></span>: Nothing prevented the rule from running, but it might have returned unexpected results. For example, a custom query rule tried to search an index pattern that couldn&#8217;t be found in Elasticsearch.
</li>
</ul>
</div>
</li>
<li class="listitem">
The date and time picker sets the time range of rule executions included in the table. This is separate from the global date and time picker at the top of the rule details page.
</li>
<li class="listitem">
The <span class="strong strong"><strong>Source event time range</strong></span> button toggles the display of data pertaining to the time range of manual runs.
</li>
<li class="listitem">
The <span class="strong strong"><strong>Show metrics columns</strong></span> toggle includes more or less data in the table, pertaining to the timing of each rule execution.
</li>
<li class="listitem">
The <span class="strong strong"><strong>Actions</strong></span> column allows you to show alerts generated from a given rule execution. Click the filter icon (<span class="image"><img src="images/filter-icon.png" alt="Filter icon" width="18" height="17"></span>) to create a global search filter based on the rule execution&#8217;s ID value. This replaces any previously applied filters, changes the global date and time range to 24 hours before and after the rule execution, and displays a confirmation notification. You can revert this action by clicking <span class="strong strong"><strong>Restore previous filters</strong></span> in the notification.
</li>
</ul>
</div>
<div class="position-relative"><h4><a id="gaps-table"></a>Gaps table</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.19/docs/detections/rules-ui-monitor.asciidoc">edit</a></div>
<p>Gaps in rule executions are periods of time where a rule didn’t run. They can be caused by various disruptions, including system updates, rule failures, or simply turning off a rule. Addressing gaps is essential for maintaining consistent coverage and avoiding missed alerts.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>Refer to the <a class="xref" href="alerts-ui-monitor.html#troubleshoot-gaps" title="Troubleshoot gaps">Troubleshoot gaps</a> section for strategies for avoiding gaps.</p>
</div>
</div>
<p>Use the information in the Gaps table to assess the scope and severity of rule execution gaps. To control what&#8217;s shown in the table, you can filter the table by gap status, select a time range for viewing gap data, and sort multiple columns. Click <span class="strong strong"><strong>Fill all gaps</strong></span> to start manual runs that fill the rule&#8217;s existing gaps.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>From the Rules table, fill gaps for multiple rules with the <a class="xref" href="rules-ui-management.html#bulk-fill-gaps-multiple-rules" title="Fill gaps for multiple rules"><span class="strong strong"><strong>Fill gaps</strong></span> bulk action</a>.</p>
</div>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="images/gaps-table.png" alt="Gaps table on the rule execution results tab">
</div>
</div>
<p>The Gaps table has the following columns:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Status</strong></span>: The current state of the gap. It can be <code class="literal">Filled</code>, <code class="literal">Partially filled</code>, or <code class="literal">Unfilled</code>.
</li>
<li class="listitem">
<span class="strong strong"><strong>Detected at</strong></span>: The date and time the gap was first discovered.
</li>
<li class="listitem">
<span class="strong strong"><strong>Manual fill tasks</strong></span>: The status of the manual run that’s filling the gap. For more details about the manual run, refer to its entry in the <a class="xref" href="alerts-ui-monitor.html#manual-runs-table" title="Manual runs table">Manual runs table</a>.
</li>
<li class="listitem">
<p><span class="strong strong"><strong>Event time covered</strong></span>: How much progress the manual run has made filling the gap.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>If you stop a manual run that hasn&#8217;t finished filling a gap, the gap’s status will be set to <code class="literal">Partially filled</code>. To fill the remaining gap, you can select the <span class="strong strong"><strong>Fill remaining gap</strong></span> action or <a class="xref" href="rules-ui-management.html#manually-run-rules" title="Run rules manually">manually run</a> the rule over the gap&#8217;s time frame.</p>
</div>
</div>
</li>
<li class="listitem">
<span class="strong strong"><strong>Range</strong></span>: When the gap started and ended.
</li>
<li class="listitem">
<span class="strong strong"><strong>Total gap duration</strong></span>: How long the gap lasted.
</li>
<li class="listitem">
<span class="strong strong"><strong>Actions</strong></span>: The actions that you can take for the gap. They can be <span class="strong strong"><strong>Fill gap</strong></span> (starts a manual run to fill the gap) or <span class="strong strong"><strong>Fill remaining gap</strong></span> (starts a manual run that fills the leftover portion of the gap).
</li>
</ul>
</div>
<div class="position-relative"><h4><a id="manual-runs-table"></a>Manual runs table</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.19/docs/detections/rules-ui-monitor.asciidoc">edit</a></div>
<p>You can <a class="xref" href="rules-ui-management.html#manually-run-rules" title="Run rules manually">manually run</a> enabled rules for a specified period of time to deliberately test them, provide additional rule coverage, or fill gaps in rule executions. Each manual run can produce multiple rule executions, depending on the time range of the run and the rule&#8217;s execution schedule.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Manual runs are executed with low priority and limited concurrency, meaning they might take longer to complete. This can be especially apparent for rules requiring multiple executions.</p>
</div>
</div>
<p>The Manual runs table tracks manual rule executions and provides important details such as:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
The total number of rule executions that the manual run will produce and how many are failing, pending, running, and completed.
</li>
<li class="listitem">
<p>When the manual run started and the time range that it will cover.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>To stop an active run, go to the appropriate row in the table and click <span class="strong strong"><strong>Stop run</strong></span> in the <span class="strong strong"><strong>Actions</strong></span> column. Completed rule executions for each manual run are logged in the Execution log table.</p>
</div>
</div>
</li>
<li class="listitem">
<p>The status of each manual run:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">Pending</code>: The rule is not yet running.
</li>
<li class="listitem">
<code class="literal">Running</code>: The rule is executing during the time range you specified. Some rule types, such as indicator match rules, can take longer to run.
</li>
<li class="listitem">
<code class="literal">Error</code>: The rule&#8217;s configuration is preventing it from running correctly. For example, the rule&#8217;s conditions cannot be validated.
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="images/manual-rule-run-table.png" alt="Manual rule runs table on the rule execution results tab">
</div>
</div>
<div class="position-relative"><h3><a id="troubleshoot-signals"></a>Troubleshoot missing alerts</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.19/docs/detections/rules-ui-monitor.asciidoc">edit</a></div>
<p>When a rule fails to run close to its scheduled time, some alerts may be
missing. There are a number of ways to try to resolve this issue:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="alerts-ui-monitor.html#troubleshoot-gaps" title="Troubleshoot gaps">Troubleshoot gaps</a>
</li>
<li class="listitem">
<a class="xref" href="alerts-ui-monitor.html#troubleshoot-ingestion-pipeline-delay" title="Troubleshoot ingestion pipeline delay">Troubleshoot ingestion pipeline delay</a>
</li>
<li class="listitem">
<a class="xref" href="alerts-ui-monitor.html#ml-job-compatibility" title="Troubleshoot missing alerts for machine learning jobs">Troubleshoot missing alerts for machine learning jobs</a>
</li>
</ul>
</div>
<p>You can also use Task Manager in Kibana to troubleshoot background tasks and processes that may be related to missing alerts:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="/guide/en/kibana/8.19/task-manager-health-monitoring.html" class="ulink" target="_top">Task Manager health monitoring</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.19/task-manager-troubleshooting.html" class="ulink" target="_top">Task Manager troubleshooting</a>
</li>
</ul>
</div>
<div class="position-relative"><h4><a id="troubleshoot-max-alerts"></a>Troubleshoot maximum alerts warning</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.19/docs/detections/rules-ui-monitor.asciidoc">edit</a></div>
<p>When a rule reaches the maximum number of alerts it can generate during a single rule execution, the following warning appears on the rule&#8217;s details page and in the rule execution log: <code class="literal">This rule reached the maximum alert limit for the rule execution. Some alerts were not created.</code></p>
<p>If you receive this warning, go to the rule&#8217;s <span class="strong strong"><strong>Alerts</strong></span> tab and check for anything unexpected. Unexpected alerts might be created from data source issues or queries that are too broadly scoped. To further reduce alert volume, you can also add <a class="xref" href="add-exceptions.html" title="Add and manage exceptions">rule exceptions</a> or <a class="xref" href="alert-suppression.html" title="Suppress detection alerts">suppress alerts</a>.</p>
<div class="position-relative"><h4><a id="troubleshoot-gaps"></a>Troubleshoot gaps</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.19/docs/detections/rules-ui-monitor.asciidoc">edit</a></div>
<p>If you see values in the Gaps column in the Rule Monitoring table or on the Rule details page
for a small number of rules, you can edit those rules and increase their additional look-back time.</p>
<p>It&#8217;s recommended to set the <code class="literal">Additional look-back time</code> to at
least 1 minute. This ensures there are no missing alerts when a rule doesn&#8217;t
run exactly at its scheduled time.</p>
<p>Elastic Security prevents duplication. Any duplicate alerts that are discovered during the
<code class="literal">Additional look-back time</code> are <em>not</em> created.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>If the rule that experiences gaps is an indicator match rule, see <a class="xref" href="tuning-detection-signals.html#tune-indicator-rules" title="Tune indicator match rules">how to tune indicator match rules</a>. Also please note that Elastic Security provides <a class="xref" href="detection-engine-overview.html#support-indicator-rules" title="Limited support for indicator match rules">limited support for indicator match rules</a>.</p>
</div>
</div>
<p>If you see gaps for numerous rules:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If you restarted Kibana when many rules were activated, try deactivating them
and then reactivating them in small batches at staggered intervals. This
ensures Kibana does not attempt to run all the rules at the same time.
</li>
<li class="listitem">
Consider adding another Kibana instance to your environment.
</li>
</ul>
</div>
<div class="position-relative"><h4><a id="troubleshoot-ingestion-pipeline-delay"></a>Troubleshoot ingestion pipeline delay</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.19/docs/detections/rules-ui-monitor.asciidoc">edit</a></div>
<p>Even if your rule runs at its scheduled time, there might still be missing alerts if your ingestion pipeline delay is greater than your rule interval + additional look-back time. Prebuilt rules have a minimum interval + additional look-back time of 6 minutes in Elastic Stack version &gt;=7.11.0. To avoid missed alerts for prebuilt rules, use caution to ensure that ingestion pipeline delays remain below 6 minutes.</p>
<p>In addition, use caution when creating custom rule schedules to ensure that the specified interval + additional look-back time is greater than your deployment&#8217;s ingestion pipeline delay.</p>
<p>You can reduce the number of missed alerts due to ingestion pipeline delay by specifying the <code class="literal">Timestamp override</code> field value to <code class="literal">event.ingested</code> in <a class="xref" href="rules-ui-create.html#rule-ui-advanced-params" title="Configure advanced rule settings (optional)">advanced settings</a> during rule creation or editing. The detection engine uses the value from the <code class="literal">event.ingested</code> field as the timestamp when executing the rule.</p>
<p>For example, say an event occurred at 10:00 but wasn&#8217;t ingested into Elasticsearch until 10:10 due to an ingestion pipeline delay. If you created a rule to detect that event with an interval + additional look-back time of 6 minutes, and the rule executes at 10:12, it would still detect the event because the <code class="literal">event.ingested</code> timestamp was from 10:10, only 2 minutes before the rule executed and well within the rule&#8217;s 6-minute interval + additional look-back time.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/timestamp-override.png" alt="timestamp override">
</div>
</div>
<div class="position-relative"><h4><a id="ml-job-compatibility"></a>Troubleshoot missing alerts for machine learning jobs</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.19/docs/detections/rules-ui-monitor.asciidoc">edit</a></div>
<p>Machine learning detection rules use machine learning jobs that have dependencies on data fields populated by the Beats and Elastic Agent integrations. In Elastic Stack version 8.3, new machine learning jobs (prefixed with <code class="literal">v3</code>) were released to operate on the ECS fields available at that time.</p>
<p>If you&#8217;re using 8.2 or earlier versions of Beats or Elastic Agent with Elastic Stack version 8.3 or later, you may need to duplicate prebuilt rules or create new custom rules <em>before</em> you update the Elastic prebuilt rules. Once you update the prebuilt rules, they will only use <code class="literal">v3</code> machine learning jobs. Duplicating the relevant prebuilt rules before updating them ensures continued coverage by allowing you to keep using <code class="literal">v1</code> or <code class="literal">v2</code> jobs (in the duplicated rules) while also running the new <code class="literal">v3</code> jobs (in the updated prebuilt rules).</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Duplicated rules may result in duplicate anomaly detections and alerts.
</li>
<li class="listitem">
Ensure that the relevant <code class="literal">v3</code> machine learning jobs are running before you update the Elastic prebuilt rules.
</li>
</ul>
</div>
</div>
</div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If you only have <span class="strong strong"><strong>8.3 or later versions of Beats and Elastic Agent</strong></span>: You can download or update your prebuilt rules and use the latest <code class="literal">v3</code> machine learning jobs. No additional action is required.
</li>
<li class="listitem">
If you only have <span class="strong strong"><strong>8.2 or earlier versions of Beats or Elastic Agent</strong></span>, or <span class="strong strong"><strong>a mix of old and new versions</strong></span>: To continue using the <code class="literal">v1</code> and <code class="literal">v2</code> machine learning jobs specified by pre-8.3 prebuilt detection rules, you must duplicate affected prebuilt rules <em>before</em> updating them to the latest rule versions. The duplicated rules can continue using the same <code class="literal">v1</code> and <code class="literal">v2</code> machine learning jobs, and the updated prebuilt machine learning rules will use the new <code class="literal">v3</code> machine learning jobs.
</li>
<li class="listitem">
If you have <span class="strong strong"><strong>a non-Elastic data shipper that gathers ECS-compatible events</strong></span>: You can use the latest <code class="literal">v3</code> machine learning jobs with no additional action required, as long as your data shipper uses the latest ECS specifications. However, if you&#8217;re migrating from machine learning rules using <code class="literal">v1</code>/<code class="literal">v2</code> jobs, ensure that you start the relevant <code class="literal">v3</code> jobs before updating the Elastic prebuilt rules.
</li>
</ul>
</div>
<p>The following Elastic prebuilt rules use the new <code class="literal">v3</code> machine learning jobs to generate alerts. Duplicate their associated <code class="literal">v1</code>/<code class="literal">v2</code> prebuilt rules <em>before</em> updating them if you need continued coverage from the <code class="literal">v1</code>/<code class="literal">v2</code> machine learning jobs:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="unusual-linux-network-port-activity.html" title="Unusual Linux Network Port Activity">Unusual Linux Network Port Activity</a>: <code class="literal">v3_linux_anomalous_network_port_activity</code>
</li>
<li class="listitem">
<a class="xref" href="unusual-linux-network-connection-discovery.html" title="Unusual Linux Network Connection Discovery">Unusual Linux Network Connection Discovery</a>: <code class="literal">v3_linux_anomalous_network_connection_discovery</code>
</li>
<li class="listitem">
<a class="xref" href="anomalous-process-for-a-linux-population.html" title="Anomalous Process For a Linux Population">Anomalous Process For a Linux Population</a>: <code class="literal">v3_linux_anomalous_process_all_hosts</code>
</li>
<li class="listitem">
<a class="xref" href="unusual-linux-username.html" title="Unusual Linux Username">Unusual Linux Username</a>: <code class="literal">v3_linux_anomalous_user_name</code>
</li>
<li class="listitem">
<a class="xref" href="unusual-linux-process-calling-the-metadata-service.html" title="Unusual Linux Process Calling the Metadata Service">Unusual Linux Process Calling the Metadata Service</a>: <code class="literal">v3_linux_rare_metadata_process</code>
</li>
<li class="listitem">
<a class="xref" href="unusual-linux-user-calling-the-metadata-service.html" title="Unusual Linux User Calling the Metadata Service">Unusual Linux User Calling the Metadata Service</a>: <code class="literal">v3_linux_rare_metadata_user</code>
</li>
<li class="listitem">
<a class="xref" href="unusual-process-for-a-linux-host.html" title="Unusual Process For a Linux Host">Unusual Process For a Linux Host</a>: <code class="literal">v3_rare_process_by_host_linux</code>
</li>
<li class="listitem">
<a class="xref" href="unusual-process-for-a-windows-host.html" title="Unusual Process For a Windows Host">Unusual Process For a Windows Host</a>: <code class="literal">v3_rare_process_by_host_windows</code>
</li>
<li class="listitem">
<a class="xref" href="unusual-windows-network-activity.html" title="Unusual Windows Network Activity">Unusual Windows Network Activity</a>: <code class="literal">v3_windows_anomalous_network_activity</code>
</li>
<li class="listitem">
<a class="xref" href="unusual-windows-path-activity.html" title="Unusual Windows Path Activity">Unusual Windows Path Activity</a>: <code class="literal">v3_windows_anomalous_path_activity</code>
</li>
<li class="listitem">
<a class="xref" href="anomalous-windows-process-creation.html" title="Anomalous Windows Process Creation">Anomalous Windows Process Creation</a>: <code class="literal">v3_windows_anomalous_process_creation</code>
</li>
<li class="listitem">
<a class="xref" href="anomalous-process-for-a-windows-population.html" title="Anomalous Process For a Windows Population">Anomalous Process For a Windows Population</a>: <code class="literal">v3_windows_anomalous_process_all_hosts</code>
</li>
<li class="listitem">
<a class="xref" href="unusual-windows-username.html" title="Unusual Windows Username">Unusual Windows Username</a>: <code class="literal">v3_windows_anomalous_user_name</code>
</li>
<li class="listitem">
<a class="xref" href="unusual-windows-process-calling-the-metadata-service.html" title="Unusual Windows Process Calling the Metadata Service">Unusual Windows Process Calling the Metadata Service</a>: <code class="literal">v3_windows_rare_metadata_process</code>
</li>
<li class="listitem">
<a class="xref" href="unusual-windows-user-calling-the-metadata-service.html" title="Unusual Windows User Calling the Metadata Service">Unusual Windows User Calling the Metadata Service</a>: <code class="literal">v3_windows_rare_metadata_user</code>
</li>
</ul>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="rules-ui-management.html">« Manage detection rules</a>
</span>
<span class="next">
<a href="detections-ui-exceptions.html">Rule exceptions »</a>
</span>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>

                        <!-- Feedback widget -->
                        <div id="feedbackWidgetContainer"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


        <div id='elastic-footer'></div>
        <script src='https://www.elastic.co/elastic-footer.js'></script>
        <!-- Footer Section end-->

      </section>
    </div>

    <!-- Feedback modal -->
    <div id="feedbackModalContainer"></div>

    <script src="/guide/static/jquery.js"></script>
    <script type="text/javascript" src="/guide/static/docs-v1.js"></script>
    <script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
