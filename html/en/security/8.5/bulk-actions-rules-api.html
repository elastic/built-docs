<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Bulk rule actions | Elastic Security Solution [8.5] | Elastic</title>
<link rel="home" href="index.html" title="Elastic Security Solution [8.5]"/>
<link rel="up" href="rule-api-overview.html" title="Detections API"/>
<link rel="prev" href="rules-api-delete.html" title="Delete rule"/>
<link rel="next" href="index-api-overview.html" title="Index endpoint"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.5"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.5"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <!--© 2015-2022 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <!--BEGIN QUALTRICS WEBSITE FEEDBACK SNIPPET-->
    <script type='text/javascript'>
      (function(){var g=function(e,h,f,g){
      this.get=function(a){for(var a=a+"=",c=document.cookie.split(";"),b=0,e=c.length;b<e;b++){for(var d=c[b];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return null};
      this.set=function(a,c){var b="",b=new Date;b.setTime(b.getTime()+6048E5);b="; expires="+b.toGMTString();document.cookie=a+"="+c+b+"; path=/; "};
      this.check=function(){var a=this.get(f);if(a)a=a.split(":");else if(100!=e)"v"==h&&(e=Math.random()>=e/100?0:100),a=[h,e,0],this.set(f,a.join(":"));else return!0;var c=a[1];if(100==c)return!0;switch(a[0]){case "v":return!1;case "r":return c=a[2]%Math.floor(100/c),a[2]++,this.set(f,a.join(":")),!c}return!0};
      this.go=function(){if(this.check()){var a=document.createElement("script");a.type="text/javascript";a.src=g;document.body&&document.body.appendChild(a)}};
      this.start=function(){var a=this;window.addEventListener?window.addEventListener("load",function(){a.go()},!1):window.attachEvent&&window.attachEvent("onload",function(){a.go()})}};
      try{(new g(100,"r","QSI_S_ZN_emkP0oSe9Qrn7kF","https://znemkp0ose9qrn7kf-elastic.siteintercept.qualtrics.com/WRSiteInterceptEngine/?Q_ZID=ZN_emkP0oSe9Qrn7kF")).start()}catch(i){}})();
    </script><div id='ZN_emkP0oSe9Qrn7kF'><!--DO NOT REMOVE-CONTENTS PLACED HERE--></div>
    <!--END WEBSITE FEEDBACK SNIPPET-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  <div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [8.5]</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="security-apis.html">Elastic Security APIs</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="rule-api-overview.html">Detections API</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="rules-api-delete.html">« Delete rule</a>
</span>
<span class="next">
<a href="index-api-overview.html">Index endpoint »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="bulk-actions-rules-api"></a>Bulk rule actions<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/detections/api/rules/rules-api-bulk-actions.asciidoc">edit</a></h2>
</div></div></div>
<p>You can bulk create, update, and delete rules.</p>
<hr>
<h4><a id="bulk-actions-rules-api-create"></a>Bulk create<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/detections/api/rules/rules-api-bulk-actions.asciidoc">edit</a></h4>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>This API has been deprecated since version 8.2, and is scheduled for end of life in Q4 2023. Please use the <a class="xref" href="bulk-actions-rules-api.html#bulk-actions-rules-api-action" title="Bulk action">bulk action API</a> instead.</p>
</div>
</div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This API supports <a href="/guide/en/kibana/8.5/api.html#token-api-authentication" class="ulink" target="_top">Token-based authentication</a> only.</p>
</div>
</div>
<p>Creates new rules.</p>
<h5><a id="_request_url_6"></a>Request URL<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/detections/api/rules/rules-api-bulk-actions.asciidoc">edit</a></h5>
<p><code class="literal">POST &lt;kibana host&gt;:&lt;port&gt;/api/detection_engine/rules/_bulk_create</code></p>
<h5><a id="_request_body_3"></a>Request body<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/detections/api/rules/rules-api-bulk-actions.asciidoc">edit</a></h5>
<p>A JSON array of rules, where each rule contains the
<a class="xref" href="rules-api-create.html" title="Create rule">required fields</a>.</p>
<h5><a id="_example_request_5"></a>Example request<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/detections/api/rules/rules-api-bulk-actions.asciidoc">edit</a></h5>
<div class="pre_wrapper lang-kibana">
<pre class="programlisting prettyprint lang-kibana">POST api/detection_engine/rules/_bulk_create
[
  {
    "rule_id": "process_started_by_ms_office_program_possible_payload",
    "risk_score": 50,
    "description": "Process started by MS Office program - possible payload",
    "interval": "5m",
    "name": "MS Office child process",
    "severity": "low",
    "tags": [
     "child process",
     "ms office"
     ],
    "type": "query",
    "from": "now-6m",
    "query": "process.parent.name:EXCEL.EXE or process.parent.name:MSPUB.EXE or process.parent.name:OUTLOOK.EXE or process.parent.name:POWERPNT.EXE or process.parent.name:VISIO.EXE or process.parent.name:WINWORD.EXE",
    "language": "kuery",
    "filters": [
       {
        "query": {
           "match": {
              "event.action": {
                 "query": "Process Create (rule: ProcessCreate)",
                 "type": "phrase"
              }
           }
        }
       }
    ],
    "enabled": false
  },
  {
    "name": "Second bulk rule",
    "description": "Query with a rule_id for referencing an external id",
    "rule_id": "query-rule-id-2",
    "risk_score": 2,
    "severity": "low",
    "type": "query",
    "from": "now-6m",
    "query": "user.name: root or user.name: admin"
  }
]</pre>
</div>
<div class="kibana_widget" data-snippet="snippets/16.kibana"></div>
<h5><a id="_response_code_6"></a>Response code<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/detections/api/rules/rules-api-bulk-actions.asciidoc">edit</a></h5>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">200</code>
</span>
</dt>
<dd>
Indicates a successful call.
</dd>
</dl>
</div>
<h5><a id="_response_payload_5"></a>Response payload<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/detections/api/rules/rules-api-bulk-actions.asciidoc">edit</a></h5>
<p>A JSON array that includes a unique ID for each rule. A unique rule ID is
generated for all rules that did not include a <code class="literal">rule_id</code> field.</p>
<hr>
<h4><a id="bulk-actions-rules-api-delete"></a>Bulk delete<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/detections/api/rules/rules-api-bulk-actions.asciidoc">edit</a></h4>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>This API has been deprecated since version 8.2, and is scheduled for end of life in Q4 2023. Please use the <a class="xref" href="bulk-actions-rules-api.html#bulk-actions-rules-api-action" title="Bulk action">bulk action API</a> instead.</p>
</div>
</div>
<p>Deletes multiple rules.</p>
<h5><a id="_request_url_7"></a>Request URL<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/detections/api/rules/rules-api-bulk-actions.asciidoc">edit</a></h5>
<p><code class="literal">DELETE  &lt;kibana host&gt;:&lt;port&gt;/api/detection_engine/rules/_bulk_delete</code></p>
<h5><a id="_request_body_4"></a>Request body<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/detections/api/rules/rules-api-bulk-actions.asciidoc">edit</a></h5>
<p>A JSON array of <code class="literal">id</code> or <code class="literal">rule_id</code> fields of the rules you want to delete.</p>
<h5><a id="_example_request_6"></a>Example request<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/detections/api/rules/rules-api-bulk-actions.asciidoc">edit</a></h5>
<div class="pre_wrapper lang-kibana">
<pre class="programlisting prettyprint lang-kibana">DELETE api/detection_engine/rules/_bulk_delete
[
  {
    "rule_id": "process_started_by_ms_office_program_possible_payload"
  },
  {
    "id": "51658332-a15e-4c9e-912a-67214e2e2359"
  }
]</pre>
</div>
<div class="kibana_widget" data-snippet="snippets/17.kibana"></div>
<h5><a id="_response_code_7"></a>Response code<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/detections/api/rules/rules-api-bulk-actions.asciidoc">edit</a></h5>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">200</code>
</span>
</dt>
<dd>
Indicates a successful call.
</dd>
</dl>
</div>
<h5><a id="_response_payload_6"></a>Response payload<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/detections/api/rules/rules-api-bulk-actions.asciidoc">edit</a></h5>
<p>A JSON array containing the deleted rules.</p>
<hr>
<h4><a id="bulk-actions-rules-api-update"></a>Bulk update<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/detections/api/rules/rules-api-bulk-actions.asciidoc">edit</a></h4>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>This API has been deprecated since version 8.2, and is scheduled for end of life in Q4 2023. Please use the <a class="xref" href="bulk-actions-rules-api.html#bulk-actions-rules-api-action" title="Bulk action">bulk action API</a> instead.</p>
</div>
</div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This API supports <a href="/guide/en/kibana/8.5/api.html#token-api-authentication" class="ulink" target="_top">Token-based authentication</a> only.</p>
</div>
</div>
<p>Updates multiple rules.</p>
<p>You can use <code class="literal">PUT</code> or <code class="literal">PATCH</code> methods to bulk update rules, where:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">PUT</code> replaces the original rule and deletes fields that are not specified.
</li>
<li class="listitem">
<code class="literal">PATCH</code> updates the specified fields.
</li>
</ul>
</div>
<h5><a id="_request_url_8"></a>Request URL<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/detections/api/rules/rules-api-bulk-actions.asciidoc">edit</a></h5>
<p><code class="literal">PUT  &lt;kibana host&gt;:&lt;port&gt;/api/detection_engine/rules/_bulk_update</code></p>
<p><code class="literal">PATCH &lt;kibana host&gt;:&lt;port&gt;/api/detection_engine/rules/_bulk_update</code></p>
<h5><a id="_request_body_5"></a>Request body<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/detections/api/rules/rules-api-bulk-actions.asciidoc">edit</a></h5>
<p>A JSON array where each element includes:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
The <code class="literal">id</code> or <code class="literal">rule_id</code> field of the rule you want to update.
</li>
<li class="listitem">
The <a class="xref" href="rules-api-update.html" title="Update rule">fields</a> you want to modify.
</li>
</ul>
</div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>If you call <code class="literal">PUT</code> to update rules, all unspecified fields are
deleted. You cannot modify the <code class="literal">id</code> or <code class="literal">rule_id</code> values.</p>
</div>
</div>
<p>For <code class="literal">PATCH</code> calls, any of the fields can be modified. For <code class="literal">PUT</code> calls,
some fields are required (see <a class="xref" href="rules-api-update.html" title="Update rule">Update rule</a> for a list of required
fields).</p>
<h5><a id="_example_request_7"></a>Example request<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/detections/api/rules/rules-api-bulk-actions.asciidoc">edit</a></h5>
<div class="pre_wrapper lang-kibana">
<pre class="programlisting prettyprint lang-kibana">PATCH api/detection_engine/rules/_bulk_update
[
  {
    "threat": [
     {
        "framework": "MITRE ATT&amp;CK",
        "tactic": {
           "id": "TA0001",
           "reference": "https://attack.mitre.org/tactics/TA0001",
           "name": "Initial Access"
        },
        "technique": [
           {
              "id": "T1193",
              "name": "Spearphishing Attachment",
              "reference": "https://attack.mitre.org/techniques/T1193"
           }
        ]
     }
   ],
    "rule_id": "process_started_by_ms_office_program_possible_payload"
  },
  {
    "name": "New name",
    "id": "56b22b65-173e-4a5b-b27a-82599cb1433e"
  }
]</pre>
</div>
<div class="kibana_widget" data-snippet="snippets/18.kibana"></div>
<h5><a id="_response_code_8"></a>Response code<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/detections/api/rules/rules-api-bulk-actions.asciidoc">edit</a></h5>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">200</code>
</span>
</dt>
<dd>
Indicates a successful call.
</dd>
</dl>
</div>
<h5><a id="_response_payload_7"></a>Response payload<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/detections/api/rules/rules-api-bulk-actions.asciidoc">edit</a></h5>
<p>A JSON array containing the updated rules.</p>
<hr>
<h4><a id="bulk-actions-rules-api-action"></a>Bulk action<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/detections/api/rules/rules-api-bulk-actions.asciidoc">edit</a></h4>
<p>Applies a bulk action to multiple rules. The bulk action is applied to all rules that match the filter or to the list of rules by their IDs.</p>
<h5><a id="_request_url_9"></a>Request URL<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/detections/api/rules/rules-api-bulk-actions.asciidoc">edit</a></h5>
<p><code class="literal">POST  &lt;kibana host&gt;:&lt;port&gt;/api/detection_engine/rules/_bulk_action</code></p>
<h5><a id="_url_query_parameters_4"></a>URL query parameters<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/detections/api/rules/rules-api-bulk-actions.asciidoc">edit</a></h5>
<div class="informaltable">
<table border="1" cellpadding="4px" width="100%">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Required</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">dry_run</code></p></td>
<td align="left" valign="top"><p>Boolean</p></td>
<td align="left" valign="top"><p>Enables <a class="xref" href="bulk-actions-rules-api.html#bulk-actions-rules-api-dry-run" title="Dry run mode">dry run mode</a> for the request call.</p></td>
<td align="left" valign="top"><p>No</p></td>
</tr>
</tbody>
</table>
</div>
<h5><a id="_request_body_6"></a>Request body<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/detections/api/rules/rules-api-bulk-actions.asciidoc">edit</a></h5>
<p>A JSON object with the following properties:</p>
<div class="informaltable">
<table border="1" cellpadding="4px" width="100%">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Required</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">query</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>A KQL search query to match the rules.</p></td>
<td align="left" valign="top"><p>No</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ids</code></p></td>
<td align="left" valign="top"><p>String[]</p></td>
<td align="left" valign="top"><p>Array of rule IDs to which a bulk action will be applied. Only valid when query property is undefined.</p></td>
<td align="left" valign="top"><p>No</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">action</code></p></td>
<td align="left" valign="top"><p>Enum</p></td>
<td align="left" valign="top">
<p>A bulk action
to apply.</p>
<div class="ulist itemizedlist">
<p class="title"><strong>Possible values:</strong></p>
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">enable</code>
</li>
<li class="listitem">
<code class="literal">disable</code>
</li>
<li class="listitem">
<code class="literal">delete</code>
</li>
<li class="listitem">
<code class="literal">duplicate</code>
</li>
<li class="listitem">
<code class="literal">export</code>
</li>
<li class="listitem">
<code class="literal">edit</code>
</li>
</ul>
</div>
</td>
<td align="left" valign="top"><p>Yes</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">edit</code></p></td>
<td align="left" valign="top"><p><a class="xref" href="bulk-actions-rules-api.html#bulk-edit-object-schema" title="BulkEditAction object">BulkEditAction[]</a></p></td>
<td align="left" valign="top"><p>Edit object that describes applying an update action.</p></td>
<td align="left" valign="top"><p>No.</p>
<p>Yes, if action is <code class="literal">edit</code>.</p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="bulk-actions-rules-api-dry-run"></a>Dry run mode<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/detections/api/rules/rules-api-bulk-actions.asciidoc">edit</a></h4>
<p>Enable dry run mode to verify that bulk actions can be applied to specified rules. Certain rules, such as prebuilt Elastic rules, can&#8217;t be edited and will return errors in the request response. Error details will contain an explanation, the rule name and/or ID, and additional troubleshooting information.</p>
<p>To enable dry run mode on a request, add the query parameter <code class="literal">dry_run=true</code> to the end of the request URL. Rules specified in the request will be temporarily updated. These updates won&#8217;t be written to Elasticsearch.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Dry run mode is not supported for the <code class="literal">export</code> bulk action. A <code class="literal">400</code> error will be returned in the request response.</p>
</div>
</div>
<h4><a id="bulk-edit-object-schema"></a>BulkEditAction object<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/detections/api/rules/rules-api-bulk-actions.asciidoc">edit</a></h4>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">type</code> field: enum. Defines what will be updated in rules.
</li>
<li class="listitem">
<code class="literal">value</code> field: any. value which will be applied in edit action.
</li>
</ul>
</div>
<h5><a id="_possible_bulkeditaction_object_values"></a>Possible <code class="literal">BulkEditAction</code> object values<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/detections/api/rules/rules-api-bulk-actions.asciidoc">edit</a></h5>
<div class="informaltable">
<table border="1" cellpadding="4px" width="100%">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top"><code class="literal">type</code> field</th>
<th align="left" valign="top"><code class="literal">value</code> field</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">add_tags</code></p></td>
<td align="left" valign="top"><p>String[]</p></td>
<td align="left" valign="top"><p>Add tags to rules</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">delete_tags</code></p></td>
<td align="left" valign="top"><p>String[]</p></td>
<td align="left" valign="top"><p>Delete rules' tags</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">set_tags</code></p></td>
<td align="left" valign="top"><p>String[]</p></td>
<td align="left" valign="top"><p>Overwrite rules' tags</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">add_index_patterns</code></p></td>
<td align="left" valign="top"><p>String[]</p></td>
<td align="left" valign="top"><p>Add index patterns to rules</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">delete_index_patterns</code></p></td>
<td align="left" valign="top"><p>String[]</p></td>
<td align="left" valign="top"><p>Delete rules' index patterns</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">set_index_patterns</code></p></td>
<td align="left" valign="top"><p>String[]</p></td>
<td align="left" valign="top"><p>Overwrite rules' index patterns</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">set_timeline</code></p></td>
<td align="left" valign="top"><p>{ <code class="literal">timeline_id</code>: String; <code class="literal">timeline_title</code>: String }</p></td>
<td align="left" valign="top"><p>Overwrite rules' Timeline template</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">set_schedule</code></p></td>
<td align="left" valign="top"><p>{ <code class="literal">interval</code>: String; <code class="literal">lookback</code>: String }</p></td>
<td align="left" valign="top"><p>Overwrite rules' schedule</p>
<p><code class="literal">interval</code>: Frequency of rule execution. For example, <code class="literal">"1h"</code> means the rule runs every hour.</p>
<p><code class="literal">lookback</code>: Additional look-back time that the rule analyzes. For example, <code class="literal">"10m"</code> means the rule analyzes the last 10 minutes of data in addition to the frequency interval.</p>
<p>If <code class="literal">interval</code> is set to <code class="literal">"10m"</code> and <code class="literal">lookback</code> to <code class="literal">"1m"</code>, then the rule runs every 5 minutes but analyzes the documents added to indices during the last 11 minutes.</p>
<p>Both <code class="literal">interval</code> and <code class="literal">lookback</code> have a format of <code class="literal">"{integer}{time_unit}"</code>, where accepted time units are <code class="literal">s</code> for seconds, <code class="literal">m</code> for minutes, and <code class="literal">h</code> for hours. The integer must be positive and larger than 0. Examples: <code class="literal">"45s"</code>, <code class="literal">"30m"</code>, <code class="literal">"6h"</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">add_rule_actions</code></p></td>
<td align="left" valign="top"><p>{
        <code class="literal">actions</code>: <a class="xref" href="bulk-actions-rules-api.html#actions-object-schema-bulk" title="actions schema">actions[]</a> ,
        <code class="literal">throttle</code>: <a class="xref" href="bulk-actions-rules-api.html#throttle-schema-bulk" title="throttle schema">throttle</a>
      }</p></td>
<td align="left" valign="top"><p>Add actions to rules</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">set_rule_actions</code></p></td>
<td align="left" valign="top"><p>{
        <code class="literal">actions</code>: <a class="xref" href="bulk-actions-rules-api.html#actions-object-schema-bulk" title="actions schema">actions[]</a> ,
        <code class="literal">throttle</code>: <a class="xref" href="bulk-actions-rules-api.html#throttle-schema-bulk" title="throttle schema">throttle</a>
      }</p></td>
<td align="left" valign="top"><p>Overwrite rules' existing actions</p></td>
</tr>
</tbody>
</table>
</div>
<p><a class="xref" href="bulk-actions-rules-api.html#bulk-edit-object-schema" title="BulkEditAction object">Actions</a> are shown in order of oldest to newest in the <code class="literal">edit</code> array payload&#8217;s property.</p>
<h5><a id="actions-object-schema-bulk"></a><code class="literal">actions</code> schema<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/detections/api/rules/rules-api-bulk-actions.asciidoc">edit</a></h5>
<p>These fields are required when calling <code class="literal">PUT</code> to modify the <code class="literal">actions</code> object:</p>
<div class="informaltable">
<table border="1" cellpadding="4px" width="100%">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>action_type_id</p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top">
<p>The action type used for sending notifications, can
be:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">.slack</code>
</li>
<li class="listitem">
<code class="literal">.email</code>
</li>
<li class="listitem">
<code class="literal">.pagerduty</code>
</li>
<li class="listitem">
<code class="literal">.webhook</code>
</li>
</ul>
</div>
</td>
</tr>
<tr>
<td align="left" valign="top"><p>group</p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>Optionally groups actions by use cases. Use <code class="literal">default</code> for alert
notifications.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>id</p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>The connector ID.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>params</p></td>
<td align="left" valign="top"><p>Object</p></td>
<td align="left" valign="top">
<p>Object containing the allowed connector fields, which varies according to the connector type:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>For Slack:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">message</code> (string, required): The notification message.
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>For email:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">to</code>, <code class="literal">cc</code>, <code class="literal">bcc</code> (string): Email addresses to which the notifications are
sent. At least one field must have a value.
</li>
<li class="listitem">
<code class="literal">subject</code> (string, optional): Email subject line.
</li>
<li class="listitem">
<code class="literal">message</code> (string, required): Email body text.
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>For Webhook:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">body</code> (string, required): JSON payload.
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>For PagerDuty:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">severity</code> (string, required): Severity of on the alert notification, can
be: <code class="literal">Critical</code>, <code class="literal">Error</code>, <code class="literal">Warning</code> or <code class="literal">Info</code>.
</li>
<li class="listitem">
<code class="literal">eventAction</code> (string, required):  Event <a href="https://v2.developer.pagerduty.com/docs/events-api-v2#event-action" class="ulink" target="_top">action type</a>, which can be <code class="literal">trigger</code>,
<code class="literal">resolve</code>, or <code class="literal">acknowledge</code>.
</li>
<li class="listitem">
<code class="literal">dedupKey</code> (string, optional): Groups alert notifications with the same
PagerDuty alert.
</li>
<li class="listitem">
<code class="literal">timestamp</code> (DateTime, optional): <a href="https://v2.developer.pagerduty.com/v2/docs/types#datetime" class="ulink" target="_top">ISO-8601 format timestamp</a>.
</li>
<li class="listitem">
<code class="literal">component</code> (string, optional): Source machine component responsible for the
event, for example <code class="literal">security-solution</code>.
</li>
<li class="listitem">
<code class="literal">group</code> (string, optional): Enables logical grouping of service components.
</li>
<li class="listitem">
<code class="literal">source</code> (string, optional): The affected system. Defaults to the Kibana
saved object ID of the action.
</li>
<li class="listitem">
<code class="literal">summary</code> (string, options): Summary of the event. Defaults to
<code class="literal">No summary provided</code>. Maximum length is 1024 characters.
</li>
<li class="listitem">
<code class="literal">class</code> (string, optional): Value indicating the class/type of the event.
</li>
</ul>
</div>
</li>
</ul>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<h5><a id="throttle-schema-bulk"></a><code class="literal">throttle</code> schema<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/detections/api/rules/rules-api-bulk-actions.asciidoc">edit</a></h5>
<p><code class="literal">throttle</code> defines the maximum interval in which a rule&#8217;s actions are executed. It accepts the following values:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">"rule"</code>: Execute actions on each rule execution
</li>
<li class="listitem">
<code class="literal">"1h"</code>: Execute actions once per hour
</li>
<li class="listitem">
<code class="literal">"1d"</code>: Execute actions once per day
</li>
<li class="listitem">
<code class="literal">"7d"</code>: Execute actions once per week
</li>
</ul>
</div>
<h5><a id="_example_requests_2"></a>Example requests<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/detections/api/rules/rules-api-bulk-actions.asciidoc">edit</a></h5>
<p><span class="strong strong"><strong>Example 1</strong></span></p>
<p>The following request activates all rules with the <code class="literal">test</code> tag:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST api/detection_engine/rules/_bulk_action
{
  "query": "alert.attributes.tags: \"test\"",
  "action": "enable"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/19.console"></div>
<h5><a id="_response_code_9"></a>Response code<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/detections/api/rules/rules-api-bulk-actions.asciidoc">edit</a></h5>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">200</code>
</span>
</dt>
<dd>
Indicates a successful call.
</dd>
</dl>
</div>
<h5><a id="_response_payload_8"></a>Response payload<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/detections/api/rules/rules-api-bulk-actions.asciidoc">edit</a></h5>
<p>For <code class="literal">enable</code>, <code class="literal">disable</code>, <code class="literal">delete</code>, <code class="literal">edit</code>, and <code class="literal">duplicate</code> actions, a JSON object containing the action&#8217;s outcome: number of failed and successful outcomes, number of rules, and number of rule objects created, deleted or updated (depending on the action).</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
   "success":true,
   "rules_count": 1,
   "attributes":{
      "results":{
         "updated":[
            {
               "id":"8bc7dad0-9320-11ec-9265-8b772383a08d",
               "updated_at":"2022-02-21T17:05:50.883Z",
               "updated_by":"elastic",
               "created_at":"2022-02-21T14:14:13.801Z",
               "created_by":"elastic",
               "name":"DNS Tunneling [Duplicate]",
               "tags":[
                  "Elastic",
                  "Network",
                  "Threat Detection",
                  "ML"
               ],
               "interval":"15m",
               "enabled":true,
               "description":"A machine learning job detected unusually large numbers of DNS queries for a single top-level DNS domain, which is often used for DNS tunneling. DNS tunneling can be used for command-and-control, persistence, or data exfiltration activity. For example, dnscat tends to generate many DNS questions for a top-level domain as it uses the DNS protocol to tunnel data.",
               "risk_score":21,
               "severity":"low",
               "license":"Elastic License v2",
               "output_index":".siem-signals-default",
               "author":[
                  "Elastic"
               ],
               "false_positives":[
                  "DNS domains that use large numbers of child domains, such as software or content distribution networks, can trigger this alert and such parent domains can be excluded."
               ],
               "from":"now-45m",
               "rule_id":"7289bf08-4e91-4c70-bf01-e04c4c5d7756",
               "max_signals":100,
               "risk_score_mapping":[

               ],
               "severity_mapping":[

               ],
               "threat":[

               ],
               "to":"now",
               "references":[
                  "https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html"
               ],
               "version":6,
               "exceptions_list":[

               ],
               "immutable":false,
               "related_integrations": [],       <a id="CO14-1"></a><i class="conum" data-value="1"></i>
               "required_fields": [],            <a id="CO14-2"></a><i class="conum" data-value="1"></i>
               "setup": "",                      <a id="CO14-3"></a><i class="conum" data-value="1"></i>
               "type":"machine_learning",
               "anomaly_threshold":50,
               "machine_learning_job_id":[
                  "packetbeat_dns_tunneling"
               ],
               "throttle":"no_actions",
               "actions":[

               ],
               "execution_summary": {                 <a id="CO14-4"></a><i class="conum" data-value="1"></i>
                 "last_execution": {
                   "date": "2022-03-23T16:06:12.787Z",
                   "status": "partial failure",
                   "status_order": 20,
                   "message": "This rule attempted to query data from Elasticsearch indices listed in the \"Index pattern\" section of the rule definition, but no matching index was found.",
                   "metrics": {
                       "total_search_duration_ms": 135,
                       "total_indexing_duration_ms": 15,
                       "execution_gap_duration_s": 0,
                   }
                 }
               }
            }
         ],
         "created":[

         ],
         "deleted":[

         ]
      },
      "summary":{
         "failed":0,
         "succeeded":1,
         "total":1
      }
   }
}</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO14-1"><i class="conum" data-value="1"></i></a><a href="#CO14-2"></a><a href="#CO14-3"></a><a href="#CO14-4"></a></p>
</td>
<td align="left" valign="top">
<p><span class="Admonishment Admonishment--dev">
[<span class="Admonishment-title u-mono">dev</span>]
<span class="Admonishment-detail">
This functionality is in development and may be changed or removed completely in a future release. These features are unsupported and not subject to the support SLA of official GA features.
</span>
</span> These fields are under development and their usage or schema may change: <code class="literal">related_integrations</code>, <code class="literal">required_fields</code>, <code class="literal">setup</code>, and <code class="literal">execution_summary</code>.</p>
</td>
</tr>
</table>
</div>
<p>For an <code class="literal">export</code> action, an <code class="literal">.ndjson</code> file containing exported rules.</p>
<p><span class="strong strong"><strong>Example 2, Partial failure</strong></span></p>
<p>The following request adds tags <code class="literal">tag-1</code> and <code class="literal">tag-2</code> to the rules that have the IDs sent in the payload:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST api/detection_engine/rules/_bulk_action
{
  "ids":[
    "8bc7dad0-9320-11ec-9265-8b772383a08d",
    "8e5c1a40-9320-11ec-9265-8b772383a08d",
  ],
  "action": "edit",
  "edit": [{ action: "add_tags", value:["tag-1", "tag-2"] }]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/20.console"></div>
<h5><a id="_response_code_10"></a>Response code<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/detections/api/rules/rules-api-bulk-actions.asciidoc">edit</a></h5>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">500</code>
</span>
</dt>
<dd>
Indicates partial bulk action failure.
</dd>
</dl>
</div>
<h5><a id="_response_payload_9"></a>Response payload<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/detections/api/rules/rules-api-bulk-actions.asciidoc">edit</a></h5>
<p>If processing of any rule fails, a partial error outputs the ID and/or name of the affected rule and the corresponding error, as well as successfully processed rules (in the same format as a successful 200 request).</p>
<h4><a id="_example_payload"></a>Example payload<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/detections/api/rules/rules-api-bulk-actions.asciidoc">edit</a></h4>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
    "message": "Bulk edit partially failed",
    "status_code": 500,
    "attributes": {
        "errors": [
            {
                "message": "Index patterns can't be added. Machine learning rule doesn't have index patterns property",
                "status_code": 500,
                "rules": [
                    {
                        "id": "8bc7dad0-9320-11ec-9265-8b772383a08d",
                        "name": "DNS Tunneling [Duplicate]"
                    }
                ]
            }
        ],
        "results": {
            "updated": [
                {
                    "id": "8e5c1a40-9320-11ec-9265-8b772383a08d",
                    "updated_at": "2022-02-21T16:56:22.818Z",
                    "updated_by": "elastic",
                    "created_at": "2022-02-21T14:14:17.883Z",
                    "created_by": "elastic",
                    "name": "External Alerts [Duplicate]",
                    "tags": [
                        "Elastic",
                        "Network",
                        "Windows",
                        "APM",
                        "macOS",
                        "Linux"
                    ],
                    "interval": "5m",
                    "enabled": true,
                    "description": "Generates a detection alert for each external alert written to the configured indices. Enabling this rule allows you to immediately begin investigating external alerts in the app.",
                    "risk_score": 47,
                    "severity": "medium",
                    "license": "Elastic License v2",
                    "output_index": ".siem-signals-default",
                    "rule_name_override": "message",
                    "timestamp_override": "event.ingested",
                    "author": [
                        "Elastic"
                    ],
                    "false_positives": [],
                    "from": "now-6m",
                    "rule_id": "941faf98-0cdc-4569-b16d-4af962914d61",
                    "max_signals": 10000,
                    "risk_score_mapping": [
                        {
                            "field": "event.risk_score",
                            "value": "",
                            "operator": "equals"
                        }
                    ],
                    "severity_mapping": [
                        {
                            "severity": "low",
                            "field": "event.severity",
                            "value": "21",
                            "operator": "equals"
                        },
                        {
                            "severity": "medium",
                            "field": "event.severity",
                            "value": "47",
                            "operator": "equals"
                        },
                        {
                            "severity": "high",
                            "field": "event.severity",
                            "value": "73",
                            "operator": "equals"
                        },
                        {
                            "severity": "critical",
                            "field": "event.severity",
                            "value": "99",
                            "operator": "equals"
                        }
                    ],
                    "threat": [],
                    "to": "now",
                    "references": [],
                    "version": 5,
                    "exceptions_list": [],
                    "immutable": false,
                    "related_integrations": [],       <a id="CO15-1"></a><i class="conum" data-value="1"></i>
                    "required_fields": [],            <a id="CO15-2"></a><i class="conum" data-value="1"></i>
                    "setup": "",                      <a id="CO15-3"></a><i class="conum" data-value="1"></i>
                    "type": "query",
                    "language": "kuery",
                    "index": [
                        "apm-*-transaction*",
                        "traces-apm*",
                        "auditbeat-*",
                        "filebeat-*",
                        "logs-*",
                        "packetbeat-*",
                        "winlogbeat-*",
                        "added-by-id-*"
                    ],
                    "query": "event.kind:alert and not event.module:(endgame or endpoint)\n",
                    "throttle": "no_actions",
                    "actions": [],
                    "execution_summary": {                 <a id="CO15-4"></a><i class="conum" data-value="1"></i>
                    "last_execution": {
                      "date": "2022-03-23T16:06:12.787Z",
                      "status": "partial failure",
                      "status_order": 20,
                      "message": "This rule attempted to query data from Elasticsearch indices listed in the \"Index pattern\" section of the rule definition, but no matching index was found.",
                      "metrics": {
                          "total_search_duration_ms": 135,
                          "total_indexing_duration_ms": 15,
                          "execution_gap_duration_s": 0,
                      }
                    }
                  }
                }
            ],
            "created": [],
            "deleted": []
        },
        "summary": {
            "failed": 1,
            "succeeded": 1,
            "total": 2
        }
    }
}</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO15-1"><i class="conum" data-value="1"></i></a><a href="#CO15-2"></a><a href="#CO15-3"></a><a href="#CO15-4"></a></p>
</td>
<td align="left" valign="top">
<p><span class="Admonishment Admonishment--dev">
[<span class="Admonishment-title u-mono">dev</span>]
<span class="Admonishment-detail">
This functionality is in development and may be changed or removed completely in a future release. These features are unsupported and not subject to the support SLA of official GA features.
</span>
</span> These fields are under development and their usage or schema may change: <code class="literal">related_integrations</code>, <code class="literal">required_fields</code>, <code class="literal">setup</code>, and <code class="literal">execution_summary</code>.</p>
</td>
</tr>
</table>
</div>
<p><span class="strong strong"><strong>Example 3, Dry run</strong></span></p>
<p>The following request will validate that the <code class="literal">add_index_patterns</code> bulk action can be successfully applied to three rules. Each rule (specified by its rule ID) is different: one is a prebuilt Elastic rule, another is a custom machine learning rule, and another is a custom query rule. Because dry run mode is enabled, changes to these rules will not be permanent or saved to Elasticsearch.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST api/detection_engine/rules/_bulk_action?dry_run=true
{
    "action": "edit",
    "edit": [
        {
            "value": [
                "test-*"
            ],
            "type": "add_index_patterns"
        }
    ],
    "ids": ["81aa0480-06af-11ed-94fb-dd1a0597d8d2", "dc015d10-0831-11ed-ac8b-05a222bd8d4a", "de8f5af0-0831-11ed-ac8b-05a222bd8d4a"]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/21.console"></div>
<h5><a id="_response_code_11"></a>Response code<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/detections/api/rules/rules-api-bulk-actions.asciidoc">edit</a></h5>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">500</code>
</span>
</dt>
<dd>
Indicates a partial bulk action failure.
</dd>
</dl>
</div>
<h5><a id="_response_payload_10"></a>Response payload<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/detections/api/rules/rules-api-bulk-actions.asciidoc">edit</a></h5>
<p>The <code class="literal">attributes.errors</code> section of the response shows that two rules failed to update and one succeeded. The same results would be returned if you ran the request without dry run mode enabled.
Notice that there are no arrays in <code class="literal">attributes.results</code>. In dry run mode, rule updates are not applied and saved to Elasticsearch, so the endpoint wouldn&#8217;t return results for rules that have been <code class="literal">updated</code>, <code class="literal">created</code>, or <code class="literal">deleted</code>.</p>
<h5><a id="_response_body"></a>Response body<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/detections/api/rules/rules-api-bulk-actions.asciidoc">edit</a></h5>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
    "message": "Bulk edit partially failed",
    "status_code": 500,
    "attributes": {
        "errors": [
            {
                "message": "Elastic rule can't be edited",
                "status_code": 500,
                "err_code": "IMMUTABLE",
                "rules": [
                    {
                        "id": "81aa0480-06af-11ed-94fb-dd1a0597d8d2",
                        "name": "Unusual AWS Command for a User"
                    }
                ]
            },
            {
                "message": "Machine learning rule doesn't have index patterns",
                "status_code": 500,
                "err_code": "MACHINE_LEARNING_INDEX_PATTERN",
                "rules": [
                    {
                        "id": "dc015d10-0831-11ed-ac8b-05a222bd8d4a",
                        "name": "Suspicious Powershell Script [Duplicate]"
                    }
                ]
            }
        ],
        "results": {
            "updated": [],
            "created": [],
            "deleted": []
        },
        "summary": {
            "failed": 2,
            "succeeded": 1,
            "total": 3
        }
    }
}</pre>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="rules-api-delete.html">« Delete rule</a>
</span>
<span class="next">
<a href="index-api-overview.html">Index endpoint »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
