<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Enable Full Disk Access for the Endgame sensor | Elastic Security Solution [8.7] | Elastic</title>
<meta class="elastic" name="content" content="Enable Full Disk Access for the Endgame sensor | Elastic Security Solution [8.7]">

<link rel="home" href="index.html" title="Elastic Security Solution [8.7]"/>
<link rel="up" href="sec-requirements.html" title="Elastic Security system requirements"/>
<link rel="prev" href="conf-map-ui.html" title="Configure network map data"/>
<link rel="next" href="security-spaces.html" title="Spaces and Elastic Security"/>
<meta class="elastic" name="product_version" content="8.7"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.7"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.7"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <!--© 2015-2022 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <!--BEGIN QUALTRICS WEBSITE FEEDBACK SNIPPET-->
    <script type='text/javascript'>
      (function(){var g=function(e,h,f,g){
      this.get=function(a){for(var a=a+"=",c=document.cookie.split(";"),b=0,e=c.length;b<e;b++){for(var d=c[b];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return null};
      this.set=function(a,c){var b="",b=new Date;b.setTime(b.getTime()+6048E5);b="; expires="+b.toGMTString();document.cookie=a+"="+c+b+"; path=/; "};
      this.check=function(){var a=this.get(f);if(a)a=a.split(":");else if(100!=e)"v"==h&&(e=Math.random()>=e/100?0:100),a=[h,e,0],this.set(f,a.join(":"));else return!0;var c=a[1];if(100==c)return!0;switch(a[0]){case "v":return!1;case "r":return c=a[2]%Math.floor(100/c),a[2]++,this.set(f,a.join(":")),!c}return!0};
      this.go=function(){if(this.check()){var a=document.createElement("script");a.type="text/javascript";a.src=g;document.body&&document.body.appendChild(a)}};
      this.start=function(){var a=this;window.addEventListener?window.addEventListener("load",function(){a.go()},!1):window.attachEvent&&window.attachEvent("onload",function(){a.go()})}};
      try{(new g(100,"r","QSI_S_ZN_emkP0oSe9Qrn7kF","https://znemkp0ose9qrn7kf-elastic.siteintercept.qualtrics.com/WRSiteInterceptEngine/?Q_ZID=ZN_emkP0oSe9Qrn7kF")).start()}catch(i){}})();
    </script><div id='ZN_emkP0oSe9Qrn7kF'><!--DO NOT REMOVE-CONTENTS PLACED HERE--></div>
    <!--END WEBSITE FEEDBACK SNIPPET-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  <div class="page_header">
A newer version is available. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [8.7]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="getting-started.html">Get started with Elastic Security</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="sec-requirements.html">Elastic Security system requirements</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="conf-map-ui.html">« Configure network map data</a>
</span>
<span class="next">
<a href="security-spaces.html">Spaces and Elastic Security »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="endgame-sensor-full-disk-access"></a>Enable Full Disk Access for the Endgame sensor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.7/docs/getting-started/endgame-sensor-FDA.asciidoc">edit</a></h2>
</div></div></div>
<p>If your solution includes Elastic Endgame, it requires Full Disk Access to protect you from malware and other cybersecurity threats. Full Disk Access permissions is a new privacy feature introduced in macOS Mojave (10.14) that controls which applications can access your data. This means you need to manually enable Full Disk Access permission for the Endgame sensor to access these protected areas of your Mac.</p>
<h4><a id="macos-permissions"></a>macOS permissions<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.7/docs/getting-started/endgame-sensor-FDA.asciidoc">edit</a></h4>
<p>The behavior of the Endgame sensor differs based on your macOS version. MDM/Jamf users can pre-approve all Full Disk Access without granting permission to the sensor. However, depending on the macOS version and sensor type, non-MDM/Jamf users may be prompted to enable Full Disk Access for required security files.</p>
<p>Here are the following Full Disk Access requirements for specific versions of macOS:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">10.13, 10.14, 10.15</code>: You cannot install the sensor without allowing it to load a <a class="xref" href="endgame-sensor-full-disk-access.html#kernel-ext-approval-endgame" title="Approve the kernel extension for the Endgame sensor">kernel extension</a>. During installation, you&#8217;ll be prompted to go to System Preferences and approve it. Upon approval, installation proceeds.
</li>
<li class="listitem">
<p><code class="literal">11.0</code>, <code class="literal">12.0</code>: You cannot install the sensor without allowing it to load a <a class="xref" href="endgame-sensor-full-disk-access.html#system-extension" title="Approve the system extension for the Endgame sensor">system extension</a>. During installation, you&#8217;ll be prompted to go to System Preferences and approve it. Upon approval, a second prompt appears to enable Network Filtering. Approve this final prompt to proceed.</p>
<p>You must also grant Full Disk Access to <code class="literal">com.endgame.systemextension</code>.</p>
</li>
<li class="listitem">
<code class="literal">10.14.6+, 10.15, 11.0, 12.0</code>: Grant the <a class="xref" href="endgame-sensor-full-disk-access.html#endpoint-endgame-sensor" title="Enable Full Disk Access for the Endgame sensor">esensor file</a> Full Disk Access.
</li>
</ul>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The following instructions apply to the Endgame sensor only. To see requirements for the Elastic Endpoint, refer to <a class="xref" href="deploy-elastic-endpoint.html" title="Install Elastic Endpoint manually"><em>Install Elastic Endpoint manually</em></a>.</p>
</div>
</div>
<h4><a id="kernel-ext-approval-endgame"></a>Approve the kernel extension for the Endgame sensor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.7/docs/getting-started/endgame-sensor-FDA.asciidoc">edit</a></h4>
<p>For endpoints running macOS Mojave (10.14) and earlier, the Endgame sensor will attempt to load a kernel extension (as opposed to a system extension) during installation. This kernel extension is required to provide insight into system events such as process events, file system events, and network events. The following prompt appears during installation:</p>
<div class="imageblock">
<div class="content">
<img src="images/fda/sys-ext-blocked.png" alt="System extension blocked">
</div>
</div>
<p>To approve the extension:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Click <span class="strong strong"><strong>Open Security Preferences</strong></span>.
</li>
<li class="listitem">
In the lower-left corner of the pane, click the <span class="strong strong"><strong>Lock button</strong></span>, then enter your credentials to authenticate.
</li>
<li class="listitem">
<p>Click <span class="strong strong"><strong>Allow</strong></span> to load the kernel extension.</p>
<div class="imageblock">
<div class="content">
<img src="images/fda/allow-kernel-ext.png" alt="Allow kernel extension">
</div>
</div>
<p>If the prompt does not appear, enable the extension by doing the following:</p>
</li>
<li class="listitem">
Open a Terminal application.
</li>
<li class="listitem">
Enter <code class="literal">kextload /Library/Extension/kendpoint.kext</code>. Prepend the command with <code class="literal">sudo</code> if necessary.
You should receive an output similar to <code class="literal">149    0 0xffffff7f82e7b000 0x21000    0x21000    co.elastic.kendpoint (7.11.0) BD152A57-ABD3-370A-BBE8-D15A0FCBD19A &lt;6 5 2 1&gt;</code>. If you receive this output, the kernel extension is enabled.
</li>
</ol>
</div>
<h4><a id="system-extension"></a>Approve the system extension for the Endgame sensor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.7/docs/getting-started/endgame-sensor-FDA.asciidoc">edit</a></h4>
<p>To fully protect endpoints from malware and other cybersecurity threats when using Elastic Endgame with system extensions, you must enable Full Disk Access for the system extension during installation on macOS Big Sur (11.0) and later.</p>
<p>When you receive the prompt to approve loading the system extension:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Open the <span class="strong strong"><strong>System Preferences</strong></span> application.
</li>
<li class="listitem">
<p>Select <span class="strong strong"><strong>Security and Privacy</strong></span>.</p>
<div class="imageblock">
<div class="content">
<img src="images/fda/sec-privacy-pane.png" alt="sec privacy pane">
</div>
</div>
</li>
<li class="listitem">
On the Security and Privacy pane, select the <span class="strong strong"><strong>Privacy</strong></span> tab.
</li>
<li class="listitem">
<p>From the left pane, select <span class="strong strong"><strong>Full Disk Access</strong></span>.</p>
<div class="imageblock">
<div class="content">
<img src="images/fda/select-fda.png" alt="Select Full Disk Access">
</div>
</div>
</li>
<li class="listitem">
In the lower-left corner of the pane, click the <span class="strong strong"><strong>Lock button</strong></span>, then enter your credentials to authenticate.
</li>
<li class="listitem">
Click the <span class="strong strong"><strong>+</strong></span> button to view <span class="strong strong"><strong>Finder</strong></span>. Find  <code class="literal">com.endgame.systemextension</code> and select it.
</li>
<li class="listitem">
Continue below to enable Full Disk Access for the Endgame sensor.
</li>
</ol>
</div>
<h4><a id="endpoint-endgame-sensor"></a>Enable Full Disk Access for the Endgame sensor<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.7/docs/getting-started/endgame-sensor-FDA.asciidoc">edit</a></h4>
<p>For the Endgame sensor to detect events from a macOS host, you must enable Full Disk Access for the <code class="literal">esensor</code> file, which appears once you&#8217;ve downloaded the sensor on your host.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Open the <span class="strong strong"><strong>System Preferences</strong></span> application.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Security and Privacy</strong></span>.
</li>
<li class="listitem">
On the <span class="strong strong"><strong>Security and Privacy</strong></span> pane, select the <span class="strong strong"><strong>Privacy</strong></span> tab.
</li>
<li class="listitem">
<p>From the left pane, select <span class="strong strong"><strong>Full Disk Access</strong></span>.</p>
<div class="imageblock">
<div class="content">
<img src="images/select-fda.png" alt="Select Full Disk Access">
</div>
</div>
</li>
<li class="listitem">
In the lower-left corner of the pane, click the <span class="strong strong"><strong>Lock button</strong></span>, then enter your credentials to authenticate. You can now add the <code class="literal">elastic-endpoint</code> or <code class="literal">esensor</code> file.
</li>
<li class="listitem">
Click the <span class="strong strong"><strong>+</strong></span> button to view <span class="strong strong"><strong>Finder</strong></span>.
</li>
<li class="listitem">
Navigate to <code class="literal">/Library/Endgame</code>, then select the <code class="literal">esensor</code> file.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Open</strong></span>.
</li>
<li class="listitem">
In the <span class="strong strong"><strong>Privacy</strong></span> tab, confirm that the <code class="literal">elastic-agent</code> or <code class="literal">esensor</code> file appears in the list of applications with Full Disk Access permissions.
</li>
</ol>
</div>
<p>The Endgame sensor now has the access required to fully protect your system.</p>
</div>
<div class="navfooter">
<span class="prev">
<a href="conf-map-ui.html">« Configure network map data</a>
</span>
<span class="next">
<a href="security-spaces.html">Spaces and Elastic Security »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
