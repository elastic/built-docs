<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Rule exceptions and value lists | Elastic Security Solution [8.3] | Elastic</title>
<link rel="home" href="index.html" title="Elastic Security Solution [8.3]"/>
<link rel="up" href="detection-engine-overview.html" title="Detections and alerts"/>
<link rel="prev" href="alerts-ui-monitor.html" title="Monitor and troubleshoot rule executions"/>
<link rel="next" href="building-block-rule.html" title="About building block rules"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.3"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.3"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <!--© 2015-2022 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!--BEGIN QUALTRICS WEBSITE FEEDBACK SNIPPET-->
    <script type='text/javascript'>
      (function(){var g=function(e,h,f,g){
      this.get=function(a){for(var a=a+"=",c=document.cookie.split(";"),b=0,e=c.length;b<e;b++){for(var d=c[b];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return null};
      this.set=function(a,c){var b="",b=new Date;b.setTime(b.getTime()+6048E5);b="; expires="+b.toGMTString();document.cookie=a+"="+c+b+"; path=/; "};
      this.check=function(){var a=this.get(f);if(a)a=a.split(":");else if(100!=e)"v"==h&&(e=Math.random()>=e/100?0:100),a=[h,e,0],this.set(f,a.join(":"));else return!0;var c=a[1];if(100==c)return!0;switch(a[0]){case "v":return!1;case "r":return c=a[2]%Math.floor(100/c),a[2]++,this.set(f,a.join(":")),!c}return!0};
      this.go=function(){if(this.check()){var a=document.createElement("script");a.type="text/javascript";a.src=g;document.body&&document.body.appendChild(a)}};
      this.start=function(){var a=this;window.addEventListener?window.addEventListener("load",function(){a.go()},!1):window.attachEvent&&window.attachEvent("onload",function(){a.go()})}};
      try{(new g(100,"r","QSI_S_ZN_emkP0oSe9Qrn7kF","https://znemkp0ose9qrn7kf-elastic.siteintercept.qualtrics.com/WRSiteInterceptEngine/?Q_ZID=ZN_emkP0oSe9Qrn7kF")).start()}catch(i){}})();
    </script><div id='ZN_emkP0oSe9Qrn7kF'><!--DO NOT REMOVE-CONTENTS PLACED HERE--></div>
    <!--END WEBSITE FEEDBACK SNIPPET-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [8.3]</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="detection-engine-overview.html">Detections and alerts</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="alerts-ui-monitor.html">« Monitor and troubleshoot rule executions</a>
</span>
<span class="next">
<a href="building-block-rule.html">About building block rules »</a>
</span>
</div>
<div class="chapter xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="detections-ui-exceptions"></a>Rule exceptions and value lists<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.3/docs/detections/detections-ui-exceptions.asciidoc">edit</a></h2>
</div></div></div>
<p>To prevent the creation of unwanted alerts, you can add exceptions to any rule. Exceptions contain the source event conditions that determine when
alerts are not generated. They provide a convenient way of allowing trusted
processes and network activity to function without producing unnecessary noise.</p>
<p>You can add multiple exceptions to one rule.</p>
<p>In addition to defining exception queries for source event values, you can use rule
exceptions with value lists. Value lists are lists of items with
the same Elasticsearch <a href="/guide/en/elasticsearch/reference/8.3/mapping-types.html" class="ulink" target="_top">data type</a>. You can create value lists
with these types:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">Keywords</code> (many <a href="/guide/en/ecs/8.3/ecs-field-reference.html" class="ulink" target="_top">ECS fields</a> are keywords)
</li>
<li class="listitem">
<code class="literal">IP Addresses</code>
</li>
<li class="listitem">
<code class="literal">IP Ranges</code>
</li>
<li class="listitem">
<code class="literal">Text</code>
</li>
</ul>
</div>
<p>After creating value lists, you can use <code class="literal">is in list</code> and <code class="literal">is not in list</code>
operators to define exceptions.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Operators <code class="literal">is in list</code> and <code class="literal">is not in list</code> are not available for
threshold and event correlation rules.</p>
</div>
</div>
<h2><a id="manage-value-lists"></a>Create value lists<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.3/docs/detections/detections-ui-exceptions.asciidoc">edit</a></h2>
<p>To create a value list:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Prepare a <code class="literal">txt</code> or <code class="literal">csv</code> file with all the values you want to use for
determining exceptions from a single list. If you use a <code class="literal">txt</code> file, new lines
act as value delimiters.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
All values in the file must be of the same Elasticsearch type.
</li>
<li class="listitem">
Wildcards are not supported in rule exceptions or value lists. Values must be literal values.
</li>
</ul>
</div>
</div>
</div>
</li>
<li class="listitem">
Go to <span class="strong strong"><strong>Detect</strong></span> &#8594; <span class="strong strong"><strong>Rules</strong></span>.
</li>
<li class="listitem">
<p>Click <span class="strong strong"><strong>Upload value lists</strong></span>. The <span class="strong strong"><strong>Upload value lists</strong></span> window opens.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/upload-lists-ui.png" alt="upload lists ui">
</div>
</div>
</li>
<li class="listitem">
Select the list type (<span class="strong strong"><strong>Keywords</strong></span>, <span class="strong strong"><strong>IP addresses</strong></span>, <span class="strong strong"><strong>IP ranges</strong></span>, or <span class="strong strong"><strong>Text</strong></span>) from the <span class="strong strong"><strong>Type of value list</strong></span> drop-down.
</li>
<li class="listitem">
Drag or select the <code class="literal">csv</code> or <code class="literal">txt</code> file that contains the values.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Upload list</strong></span>.
</li>
</ol>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>When the name of the file you are uploading already exists, the values in
the new file are appended to the previously uploaded values.</p>
</div>
</div>
<h3><a id="edit-value-lists"></a>Manage value lists<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.3/docs/detections/detections-ui-exceptions.asciidoc">edit</a></h3>
<p>To view, delete, or export existing value lists:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Go to <span class="strong strong"><strong>Detect</strong></span> &#8594; <span class="strong strong"><strong>Rules</strong></span>.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Upload value lists</strong></span>. The <span class="strong strong"><strong>Upload value lists</strong></span> window opens.
</li>
<li class="listitem">
In the <span class="strong strong"><strong>Value lists</strong></span> table, click the required action button.
</li>
</ol>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="images/manage-value-list.png" alt="manage value list">
</div>
</div>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>You can also use value lists as the indicator match index when creating an indicator match rule. See <a class="xref" href="rules-ui-create.html#indicator-value-lists" title="Use value lists with indicator match rules">Use value lists with indicator match rules</a> for more information.</p>
</div>
</div>
<h3><a id="detection-rule-exceptions"></a>Add exceptions to a rule<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.3/docs/detections/detections-ui-exceptions.asciidoc">edit</a></h3>
<p>You can add exceptions to a rule from the rule details page or the Alerts table.
When you add an exception, you can also close all alerts that meet the
exception&#8217;s criteria.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>To ensure an exception is successfully applied, make sure that the fields you&#8217;ve defined for the exception query are correctly and consistently mapped in their respective indices. Refer to <a href="/guide/en/ecs/8.3" class="ulink" target="_top">ECS</a> to learn more about supported mappings.</p>
</div>
</div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Be careful when adding exceptions to event correlation rules. Exceptions are evaluated against every event in the sequence, and when the exception matches <em>all</em> event(s) in the sequence, alerts <em>are not</em> generated. If the exception only matches <em>some</em> of the events in the sequence, alerts <em>are</em> generated.</p>
<p>To exclude values from a
specific event in the sequence, update the rule&#8217;s EQL statement. For example:</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">`sequence
  [file where file.extension == "exe"
  and file.name != "app-name.exe"]
  [process where true
  and process.name != "process-name.exe"]`</pre>
</div>
</div>
</div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Do one of the following:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>To add an exception from the rule details page:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Go to the rule details page of the rule to which you want to add an
exception (<span class="strong strong"><strong>Detect</strong></span> &#8594; <span class="strong strong"><strong>Rules</strong></span> &#8594; <span class="strong strong"><strong><em>&lt;Rule name&gt;</em></strong></span>).
</li>
<li class="listitem">
<p>Scroll down below the rule details and select the <span class="strong strong"><strong>Exceptions</strong></span> tab.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/exception-histogram.png" alt="Detail of Exceptions tab" width="75%">
</div>
</div>
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Add new exception</strong></span> &#8594; <span class="strong strong"><strong>Add rule exception</strong></span>.
</li>
</ol>
</div>
</li>
<li class="listitem">
<p>To add an exception from the Alerts table:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Go to <span class="strong strong"><strong>Detect</strong></span> &#8594; <span class="strong strong"><strong>Alerts</strong></span>.
</li>
<li class="listitem">
Scroll down to the Alerts table, go to the alert you want to create an exception for, click the <span class="strong strong"><strong>More Actions</strong></span> menu (<span class="strong strong"><strong>&#8230;&#8203;</strong></span>), then select <span class="strong strong"><strong>Add rule exception</strong></span>.
</li>
</ol>
</div>
</li>
</ul>
</div>
<p>The <span class="strong strong"><strong>Add Rule Exception</strong></span> flyout opens (the example below was opened from the Alerts table):</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/add-exception-ui.png" alt="add exception ui">
</div>
</div>
</li>
<li class="listitem">
<p>Add conditions that define when the exception prevents alerts. You can define
multiple conditions with <code class="literal">OR</code> and <code class="literal">AND</code> relationships. In the example above,
the exception prevents the rule from generating alerts when the
<code class="literal">svchost.exe</code> process runs on agent hostname <code class="literal">siem-kibana</code>.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
You can use nested conditions. However, this is only required for
<a class="xref" href="detections-ui-exceptions.html#nested-field-list">these fields</a>. For all other fields, nested conditions
should not be used.
</li>
<li class="listitem">
Wildcards are not supported in rule exceptions or value lists. Values must be literal values.
</li>
</ul>
</div>
</div>
</div>
<p>If you have created value lists, you can use them to exclude or include all
values in a list with <code class="literal">is in list</code> and <code class="literal">is not in list</code> operators:</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/exceptions-ui-list.png" alt="exceptions ui list">
</div>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>When using a list, all exception statements must use <code class="literal">is in list</code> and
<code class="literal">is not in list</code> operators.</p>
</div>
</div>
</li>
<li class="listitem">
<p>Select one of the following alert actions:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Close this alert</strong></span>: Closes the alert when the exception is added. This option
is only available when adding exceptions from the Alerts table.
</li>
<li class="listitem">
<span class="strong strong"><strong>Close all alerts that match this exception and were generated by this rule</strong></span>:
Closes all alerts that match the exception&#8217;s conditions and were generated only by the current rule.
</li>
</ul>
</div>
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Add Rule Exception</strong></span>.
</li>
</ol>
</div>
<h3><a id="endpoint-rule-exceptions"></a>Add Elastic Endpoint exceptions<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.3/docs/detections/detections-ui-exceptions.asciidoc">edit</a></h3>
<p>Like detection rule exceptions, you can add Endpoint agent exceptions either by editing the Elastic Endpoint Security rule or by adding them as an action on alerts generated by the Endpoint Security rule. Elastic Endpoint alerts have the following fields:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">kibana.alert.original_event.module determined:endpoint</code>
</li>
<li class="listitem">
<code class="literal">kibana.alert.original_event.kind:alert</code>
</li>
</ul>
</div>
<p>You can also add Endpoint exceptions to rules that are associated with Elastic Endpoint rule exceptions. To associate rules, when creating or editing a rule, select the <a class="xref" href="rules-ui-create.html#rule-ui-advanced-params" title="Configure advanced rule settings (optional)"><span class="strong strong"><strong>Elastic Endpoint exceptions</strong></span></a> option.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>When you add an exception to the
<a class="xref" href="detections-ui-exceptions.html#endpoint-rule-exceptions" title="Add Elastic Endpoint exceptions">Elastic Endpoint Security</a> rule, you can select to
add the exception to the endpoint. When selected, the exception is added to
both the detection rule <span class="strong strong"><strong>and</strong></span> the Elastic Endpoint agent on your hosts.</p>
<p><a href="/guide/en/elasticsearch/reference/8.3/binary.html" class="ulink" target="_top">Binary fields</a> are not supported in detection rule exceptions.</p>
</div>
</div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Exceptions added to the Elastic Endpoint Security rule affect all alerts sent
from the Endpoint agent. Be careful not to unintentionally prevent some Endpoint
alerts.</p>
<p>Additionally, to add an Endpoint exception to the Elastic Endpoint Security rule, there must be at least one Endpoint Security alert generated in the system. For non-production use, if no alerts exist, you can trigger a test alert using malware emulation techniques or tools such as the Anti Malware Testfile from the <a href="https://www.eicar.org/" class="ulink" target="_top">European Institute for Computer Anti-Virus Research (EICAR)</a>.</p>
</div>
</div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Do one of the following:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>To add an Endpoint exception from the rule details page:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Go to the rule details page (<span class="strong strong"><strong>Detect</strong></span> &#8594; <span class="strong strong"><strong>Rules</strong></span>), and then search for and  select the Elastic <span class="strong strong"><strong>Endpoint Security</strong></span> rule.
</li>
<li class="listitem">
Scroll down to the <span class="strong strong"><strong>Trend</strong></span> histogram and select the <span class="strong strong"><strong>Exceptions</strong></span> tab.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Add new exception</strong></span> &#8594; <span class="strong strong"><strong>Add Endpoint exception</strong></span>.
</li>
</ol>
</div>
</li>
<li class="listitem">
<p>To add an Endpoint exception from the Alerts table:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Go to <span class="strong strong"><strong>Detect</strong></span> &#8594; <span class="strong strong"><strong>Alerts</strong></span>.
</li>
<li class="listitem">
Scroll down to the Alerts table, and from an Elastic Endpoint
alert, click the <span class="strong strong"><strong>More actions</strong></span> menu (<span class="strong strong"><strong>&#8230;&#8203;</strong></span>), then select <span class="strong strong"><strong>Add Endpoint exception</strong></span>.
</li>
</ol>
</div>
</li>
</ul>
</div>
<p>The <span class="strong strong"><strong>Add Endpoint Exception</strong></span> flyout opens, from either the rule details page or the Alerts table.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/endpoint-add-exp.png" alt="endpoint add exp">
</div>
</div>
</li>
<li class="listitem">
<p>If required, modify the conditions.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>See <a class="xref" href="detections-ui-exceptions.html#ex-nested-conditions" title="Exceptions with nested conditions">Exceptions with nested conditions</a> for more information on when nested conditions are required.</p>
</div>
</div>
</li>
<li class="listitem">
<p>You can select any of the following:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Close this alert</strong></span>: Closes the alert when the exception is added. This option
is only available when adding exceptions from the Alerts table.
</li>
<li class="listitem">
<span class="strong strong"><strong>Close all alerts that match this exception and were generated by this rule</strong></span>:
Closes all alerts that match the exception&#8217;s conditions.
</li>
</ul>
</div>
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Add Endpoint Exception</strong></span>. An exception is created for both the detection rule and the Elastic Endpoint.
</li>
</ol>
</div>
<h3><a id="ex-nested-conditions"></a>Exceptions with nested conditions<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.3/docs/detections/detections-ui-exceptions.asciidoc">edit</a></h3>
<p>Some Endpoint objects contain nested fields, and the only way to ensure you are
excluding the correct fields is with nested conditions. One example is the
<code class="literal">process.Ext</code> object:</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
  "ancestry": [],
  "code_signature": {
    "trusted": true,
    "subject_name": "LFC",
    "exists": true,
    "status": "trusted"
  },
  "user": "WDAGUtilityAccount",
  "token": {
    "elevation": true,
    "integrity_level_name": "high",
    "domain": "27FB305D-3838-4",
    "user": "WDAGUtilityAccount",
    "elevation_type": "default",
    "sid": "S-1-5-21-2047949552-857980807-821054962-504"
  }
}</pre>
</div>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p><code class="literal">code_signature.subject_name</code> refers to the process signature not the
process name.</p>
</div>
</div>
<p><a id="nested-field-list"></a>Only these objects require nested conditions to ensure the exception functions
correctly:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">Endpoint.policy.applied.artifacts.global.identifiers</code>
</li>
<li class="listitem">
<code class="literal">Endpoint.policy.applied.artifacts.user.identifiers</code>
</li>
<li class="listitem">
<code class="literal">Target.dll.Ext.code_signature</code>
</li>
<li class="listitem">
<code class="literal">Target.process.Ext.code_signature</code>
</li>
<li class="listitem">
<code class="literal">Target.process.Ext.token.privileges</code>
</li>
<li class="listitem">
<code class="literal">Target.process.parent.Ext.code_signature</code>
</li>
<li class="listitem">
<code class="literal">Target.process.thread.Ext.token.privileges</code>
</li>
<li class="listitem">
<code class="literal">dll.Ext.code_signature</code>
</li>
<li class="listitem">
<code class="literal">file.Ext.code_signature</code>
</li>
<li class="listitem">
<code class="literal">file.Ext.macro.errors</code>
</li>
<li class="listitem">
<code class="literal">file.Ext.macro.stream</code>
</li>
<li class="listitem">
<code class="literal">process.Ext.code_signature</code>
</li>
<li class="listitem">
<code class="literal">process.Ext.token.privileges</code>
</li>
<li class="listitem">
<code class="literal">process.parent.Ext.code_signature</code>
</li>
<li class="listitem">
<code class="literal">process.thread.Ext.token.privileges</code>
</li>
</ul>
</div>
<h4><a id="_nested_condition_example"></a>Nested condition example<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.3/docs/detections/detections-ui-exceptions.asciidoc">edit</a></h4>
<p>Creates an exception that excludes all LFC-signed trusted processes:</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/nested-exp.png" alt="nested exp">
</div>
</div>
<h3><a id="manage-exceptions"></a>View and manage exception lists<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.3/docs/detections/detections-ui-exceptions.asciidoc">edit</a></h3>
<p>The Exception lists table enables you to view and manage all exceptions that have been assigned to rules. To view the Exception lists table, go to <span class="strong strong"><strong>Detect</strong></span> &#8594; <span class="strong strong"><strong>Exception lists</strong></span>.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/exceptions-page.png" alt="exceptions page">
</div>
</div>
<p>Exceptions are automatically grouped into exception lists. The table displays each exception list on an individual row, with the most recently created list at the top. Each row contains information such as the name of the rule to which the exception list is assigned, the dates when the list was created and last edited, and options to export or delete it.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>To view details of the rule the exception list is assigned to, click the link in the <code class="literal">Rules assigned to</code> column.</p>
</div>
</div>
<p>To filter exception lists by a specific value, enter a query in the <a href="https://elastic.github.io/eui/#/forms/search-bar" class="ulink" target="_top">Search bar</a>. You can search the following attributes:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">name</code>
</li>
<li class="listitem">
<code class="literal">list_id</code>
</li>
<li class="listitem">
<code class="literal">created_by</code>
</li>
<li class="listitem">
<code class="literal">type</code>
</li>
<li class="listitem">
<code class="literal">tags</code>
</li>
</ul>
</div>
<p>If no attribute is selected, the app searches the list name by default.</p>
<p>To export or delete an exception list, select the required action button on the appropriate list. Note that:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Exception lists are exported to <code class="literal">.ndjson</code> files.
</li>
<li class="listitem">
Exception lists are also exported as part of any exported detection rules configured with exceptions. See <a class="xref" href="rules-ui-management.html#import-export-rules-ui" title="Export and import rules">Export and import rules</a>.
</li>
<li class="listitem">
If a list is linked to any rules, you&#8217;ll see a warning appear that asks you to confirm the deletion. If no rules are linked to a list, it is deleted without confirmation.
</li>
</ul>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="images/actions-exception-list.png" alt="Detail of Exception lists table with export and delete buttons highlighted" width="400">
</div>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="alerts-ui-monitor.html">« Monitor and troubleshoot rule executions</a>
</span>
<span class="next">
<a href="building-block-rule.html">About building block rules »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
