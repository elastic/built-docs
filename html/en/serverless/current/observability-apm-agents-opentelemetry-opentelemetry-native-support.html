<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Upstream OpenTelemetry Collectors and language SDKs | Serverless | Elastic</title>
<meta class="elastic" name="content" content="Upstream OpenTelemetry Collectors and language SDKs | Serverless">

<link rel="home" href="index.html" title="Serverless"/>
<link rel="up" href="observability-apm-agents-opentelemetry.html" title="Use OpenTelemetry with APM"/>
<link rel="prev" href="observability-apm-agents-opentelemetry.html" title="Use OpenTelemetry with APM"/>
<link rel="next" href="observability-apm-agents-opentelemetry-collect-metrics.html" title="Collect metrics"/>
<meta class="elastic" name="product_version" content="main"/>
<meta class="elastic" name="product_name" content="Serverless"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Serverless/Guide"/>
<meta name="DC.subject" content="Serverless"/>
<meta name="DC.identifier" content="main"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles-v1.css" />
  </head>

  <!--© 2015-2025 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div class="navheader">
<span class="prev">
<a href="observability-apm-agents-opentelemetry.html">« Use OpenTelemetry with APM</a>
</span>
<span class="next">
<a href="observability-apm-agents-opentelemetry-collect-metrics.html">Collect metrics »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Serverless</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="what-is-observability-serverless.html">Elastic Observability serverless</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="observability-apm.html">Application performance monitoring (APM)</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="observability-apm-send-data-to-elastic.html">Send APM data to Elastic</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="observability-apm-agents-opentelemetry.html">Use OpenTelemetry with APM</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Upstream OpenTelemetry Collectors and language SDKs</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/serverless/apm-agents/apm-agents-opentelemetry-opentelemetry-native-support.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h5 class="title"><a id="observability-apm-agents-opentelemetry-opentelemetry-native-support"></a>Upstream OpenTelemetry Collectors and language SDKs</h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/serverless/apm-agents/apm-agents-opentelemetry-opentelemetry-native-support.asciidoc">edit</a></div>
</div></div></div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This is one of several approaches you can use to integrate Elastic with OpenTelemetry.
<span class="strong strong"><strong>To compare approaches and choose the best approach for your use case, refer to <a class="xref" href="observability-apm-agents-opentelemetry.html" title="Use OpenTelemetry with APM">Use OpenTelemetry with APM</a>.</strong></span></p>
</div>
</div>
<p>Elastic natively supports the OpenTelemetry protocol (OTLP).
This means trace data and metrics collected from your applications and infrastructure can
be sent directly to Elastic.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Send data to Elastic from an upstream <a class="xref" href="observability-apm-agents-opentelemetry-opentelemetry-native-support.html#observability-apm-agents-opentelemetry-opentelemetry-native-support-send-data-from-an-upstream-opentelemetry-collector" title="Send data from an upstream OpenTelemetry Collector">OpenTelemetry Collector</a>
</li>
<li class="listitem">
Send data to Elastic from an upstream <a class="xref" href="observability-apm-agents-opentelemetry-opentelemetry-native-support.html#observability-apm-agents-opentelemetry-opentelemetry-native-support-send-data-from-an-upstream-opentelemetry-sdk" title="Send data from an upstream OpenTelemetry SDK">OpenTelemetry language SDK</a>
</li>
</ul>
</div>
<div class="position-relative"><h7><a id="observability-apm-agents-opentelemetry-opentelemetry-native-support-send-data-from-an-upstream-opentelemetry-collector"></a>Send data from an upstream OpenTelemetry Collector</h7><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/serverless/apm-agents/apm-agents-opentelemetry-opentelemetry-native-support.asciidoc">edit</a></div>
<p>Connect your OpenTelemetry Collector instances to Elastic Observability Serverless using the OTLP exporter:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">receivers:   <a id="CO18-1"></a><i class="conum" data-value="1"></i>
  # ...
  otlp:

processors:   <a id="CO18-2"></a><i class="conum" data-value="2"></i>
  # ...
  memory_limiter:
    check_interval: 1s
    limit_mib: 2000
  batch:

exporters:
  logging:
    loglevel: warn   <a id="CO18-3"></a><i class="conum" data-value="3"></i>
  otlp/elastic:   <a id="CO18-4"></a><i class="conum" data-value="4"></i>
    # Elastic https endpoint without the "https://" prefix
    endpoint: "${ELASTIC_APM_SERVER_ENDPOINT}" <a id="CO18-5"></a><i class="conum" data-value="5"></i> <a id="CO18-6"></a><i class="conum" data-value="7"></i>
    headers:
      # Elastic API key
      Authorization: "ApiKey ${ELASTIC_APM_API_KEY}" <a id="CO18-7"></a><i class="conum" data-value="6"></i> <a id="CO18-8"></a><i class="conum" data-value="7"></i>

service:
  pipelines:
    traces:
      receivers: [otlp]
      processors: [..., memory_limiter, batch]
      exporters: [logging, otlp/elastic]
    metrics:
      receivers: [otlp]
      processors: [..., memory_limiter, batch]
      exporters: [logging, otlp/elastic]
    logs:   <a id="CO18-9"></a><i class="conum" data-value="8"></i>
      receivers: [otlp]
      processors: [..., memory_limiter, batch]
      exporters: [logging, otlp/elastic]</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO18-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>The receivers, like the
<a href="https://github.com/open-telemetry/opentelemetry-collector/tree/main/receiver/otlpreceiver" class="ulink" target="_top">OTLP receiver</a>, that forward data emitted by APM agents, or the <a href="https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/receiver/hostmetricsreceiver" class="ulink" target="_top">host metrics receiver</a>.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO18-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>We recommend using the <a href="https://github.com/open-telemetry/opentelemetry-collector/blob/main/processor/batchprocessor/README.md" class="ulink" target="_top">Batch processor</a> and the <a href="https://github.com/open-telemetry/opentelemetry-collector/blob/main/processor/memorylimiterprocessor/README.md" class="ulink" target="_top">memory limiter processor</a>. For more information, see <a href="https://github.com/open-telemetry/opentelemetry-collector/blob/main/processor/README.md#recommended-processors" class="ulink" target="_top">recommended processors</a>.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO18-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>The <a href="https://github.com/open-telemetry/opentelemetry-collector/tree/main/exporter/loggingexporter" class="ulink" target="_top">logging exporter</a> is helpful for troubleshooting and supports various logging levels, like <code class="literal">debug</code>, <code class="literal">info</code>, <code class="literal">warn</code>, and <code class="literal">error</code>.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO18-4"><i class="conum" data-value="4"></i></a></p>
</td>
<td align="left" valign="top">
<p>Elastic Observability Serverless endpoint configuration.
Elastic supports a ProtoBuf payload via both the OTLP protocol over gRPC transport <a href="https://github.com/open-telemetry/opentelemetry-specification/blob/main/specification/protocol/otlp.md#otlpgrpc" class="ulink" target="_top">(OTLP/gRPC)</a>
and the OTLP protocol over HTTP transport <a href="https://github.com/open-telemetry/opentelemetry-specification/blob/main/specification/protocol/otlp.md#otlphttp" class="ulink" target="_top">(OTLP/HTTP)</a>.
To learn more about these exporters, see the OpenTelemetry Collector documentation:
<a href="https://github.com/open-telemetry/opentelemetry-collector/tree/main/exporter/otlphttpexporter" class="ulink" target="_top">OTLP/HTTP Exporter</a> or
<a href="https://github.com/open-telemetry/opentelemetry-collector/tree/main/exporter/otlpexporter" class="ulink" target="_top">OTLP/gRPC exporter</a>.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO18-5"><i class="conum" data-value="5"></i></a></p>
</td>
<td align="left" valign="top">
<p>Hostname and port of the Elastic endpoint. For example, <code class="literal">elastic-apm-server:8200</code>.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO18-7"><i class="conum" data-value="6"></i></a></p>
</td>
<td align="left" valign="top">
<p>Credential for Elastic APM API key authorization (<code class="literal">Authorization: "ApiKey an_api_key"</code>).</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO18-6"><i class="conum" data-value="7"></i></a><a href="#CO18-8"></a></p>
</td>
<td align="left" valign="top">
<p>Environment-specific configuration parameters can be conveniently passed in as environment variables documented <a href="https://opentelemetry.io/docs/collector/configuration/#configuration-environment-variables" class="ulink" target="_top">here</a> (e.g. <code class="literal">ELASTIC_APM_SERVER_ENDPOINT</code> and <code class="literal">ELASTIC_APM_API_KEY</code>).</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO18-9"><i class="conum" data-value="8"></i></a></p>
</td>
<td align="left" valign="top">
<p><span class="Admonishment Admonishment--preview">
[<span class="Admonishment-title u-mono">preview</span>]
<span class="Admonishment-detail">
This functionality is in technical preview and may be changed or removed in a future release. Elastic will work to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.
</span>
</span>  To send OpenTelemetry logs to your project, declare a <code class="literal">logs</code> pipeline.</p>
</td>
</tr>
</table>
</div>
<p>You&#8217;re now ready to export traces and metrics from your services and applications.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>When using the OpenTelemetry Collector, you should always prefer sending data via the <a href="https://github.com/open-telemetry/opentelemetry-collector/tree/main/exporter/otlphttpexporter" class="ulink" target="_top"><code class="literal">OTLP</code> exporter</a>.
Using other methods, like the <a href="https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/exporter/elasticsearchexporter" class="ulink" target="_top"><code class="literal">elasticsearch</code> exporter</a>, will bypass all of the validation and data processing that Elastic performs.
In addition, your data will not be viewable in your Observability project if you use the <code class="literal">elasticsearch</code> exporter.</p>
</div>
</div>
<div class="position-relative"><h7><a id="observability-apm-agents-opentelemetry-opentelemetry-native-support-send-data-from-an-upstream-opentelemetry-sdk"></a>Send data from an upstream OpenTelemetry SDK</h7><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/serverless/apm-agents/apm-agents-opentelemetry-opentelemetry-native-support.asciidoc">edit</a></div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This document outlines how to send data directly from an upstream OpenTelemetry SDK to APM Server, which is appropriate when getting started. However, in many cases you should use the OpenTelemetry SDK to send data to an OpenTelemetry Collector that processes and exports data to APM Server. Read more about when and how to use a collector in the <a href="https://opentelemetry.io/docs/collector/#when-to-use-a-collector" class="ulink" target="_top">OpenTelemetry documentation</a>.</p>
</div>
</div>
<p>To export traces and metrics to Elastic, instrument your services and applications
with the OpenTelemetry API, SDK, or both. For example, if you are a Java developer, you need to instrument your Java app with the
<a href="https://github.com/open-telemetry/opentelemetry-java-instrumentation" class="ulink" target="_top">OpenTelemetry agent for Java</a>.
See the <a href="https://opentelemetry.io/docs/instrumentation/" class="ulink" target="_top">OpenTelemetry Instrumentation guides</a> to download the
OpenTelemetry agent or SDK for your language.</p>
<p>Define environment variables to configure the OpenTelemetry agent or SDK and enable communication with Elastic APM.
For example, if you are instrumenting a Java app, define the following environment variables:</p>
<div class="pre_wrapper lang-bash">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-bash">export OTEL_RESOURCE_ATTRIBUTES=service.name=checkoutService,service.version=1.1,deployment.environment=production
export OTEL_EXPORTER_OTLP_ENDPOINT=https://apm_server_url:8200
export OTEL_EXPORTER_OTLP_HEADERS="Authorization=ApiKey an_apm_api_key"
export OTEL_METRICS_EXPORTER="otlp" \
export OTEL_LOGS_EXPORTER="otlp" \   <a id="CO19-1"></a><i class="conum" data-value="1"></i>
java -javaagent:/path/to/opentelemetry-javaagent-all.jar \
     -classpath lib/*:classes/ \
     com.mycompany.checkout.CheckoutServiceServer</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO19-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p><span class="Admonishment Admonishment--preview">
[<span class="Admonishment-title u-mono">preview</span>]
<span class="Admonishment-detail">
This functionality is in technical preview and may be changed or removed in a future release. Elastic will work to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.
</span>
</span>  The OpenTelemetry logs intake via Elastic is currently in technical preview.</p>
</td>
</tr>
</table>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top"></th>
<th align="left" valign="top"></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">OTEL_RESOURCE_ATTRIBUTES</code></p></td>
<td align="left" valign="top"><p>Fields that describe the service and the environment that the service runs in. See <a class="xref" href="observability-apm-agents-opentelemetry-resource-attributes.html" title="Resource attributes">resource attributes</a> for more information.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">OTEL_EXPORTER_OTLP_ENDPOINT</code></p></td>
<td align="left" valign="top"><p>Elastic URL. The host and port that Elastic listens for APM events on.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">OTEL_EXPORTER_OTLP_HEADERS</code></p></td>
<td align="left" valign="top">
<p>Authorization header that includes the Elastic APM API key: <code class="literal">"Authorization=ApiKey an_api_key"</code>.
Note the required space between <code class="literal">ApiKey</code> and <code class="literal">an_api_key</code>.</p>
<p>For information on how to format an API key, refer to <a class="xref" href="observability-apm-keep-data-secure.html#observability-apm-keep-data-secure-secure-communication-with-apm-agents" title="Secure communication with APM agents">Secure communication with APM agents</a>.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>If you are using a version of the Python OpenTelemetry agent <em>before</em> 1.27.0, the content of the header <em>must</em> be URL-encoded. You can use the Python standard library&#8217;s <code class="literal">urllib.parse.quote</code> function to encode the content of the header.</p>
</div>
</div>
</td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">OTEL_METRICS_EXPORTER</code></p></td>
<td align="left" valign="top"><p>Metrics exporter to use. See <a href="https://opentelemetry.io/docs/specs/otel/configuration/sdk-environment-variables/#exporter-selection" class="ulink" target="_top">exporter selection</a> for more information.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">OTEL_LOGS_EXPORTER</code></p></td>
<td align="left" valign="top"><p>Logs exporter to use. See <a href="https://opentelemetry.io/docs/specs/otel/configuration/sdk-environment-variables/#exporter-selection" class="ulink" target="_top">exporter selection</a> for more information.</p></td>
</tr>
</tbody>
</table>
</div>
<p>You are now ready to collect traces and <a class="xref" href="observability-apm-agents-opentelemetry-collect-metrics.html" title="Collect metrics">metrics</a> before <a class="xref" href="observability-apm-agents-opentelemetry-collect-metrics.html#open-telemetry-verify-metrics" title="Verify OpenTelemetry metrics data">verifying metrics</a>
and <a class="xref" href="observability-apm-agents-opentelemetry-collect-metrics.html#open-telemetry-visualize" title="Visualize">visualizing metrics</a>.</p>
<div class="position-relative"><h7><a id="observability-apm-agents-opentelemetry-opentelemetry-native-support-proxy-requests-to-elastic"></a>Proxy requests to Elastic</h7><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/serverless/apm-agents/apm-agents-opentelemetry-opentelemetry-native-support.asciidoc">edit</a></div>
<p>Elastic supports both the <a href="https://github.com/open-telemetry/opentelemetry-specification/blob/main/specification/protocol/otlp.md#otlpgrpc" class="ulink" target="_top">(OTLP/gRPC)</a> and <a href="https://github.com/open-telemetry/opentelemetry-specification/blob/main/specification/protocol/otlp.md#otlphttp" class="ulink" target="_top">(OTLP/HTTP)</a> protocol on the same port as Elastic APM agent requests. For ease of setup, we recommend using OTLP/HTTP when proxying or load balancing requests to Elastic.</p>
<p>If you use the OTLP/gRPC protocol, requests to Elastic must use either HTTP/2 over TLS or HTTP/2 Cleartext (H2C). No matter which protocol is used, OTLP/gRPC requests will have the header: <code class="literal">"Content-Type: application/grpc"</code>.</p>
<p>When using a layer 7 (L7) proxy like AWS ALB, requests must be proxied in a way that ensures requests to Elastic follow the rules outlined above. For example, with ALB you can create rules to select an alternative backend protocol based on the headers of requests coming into ALB. In this example, you&#8217;d select the gRPC protocol when the  <code class="literal">"Content-Type: application/grpc"</code> header exists on a request.</p>
<p>For more information on how to configure an AWS ALB to support gRPC, see this AWS blog post:
<a href="https://aws.amazon.com/blogs/aws/new-application-load-balancer-support-for-end-to-end-http-2-and-grpc/" class="ulink" target="_top">Application Load Balancer Support for End-to-End HTTP/2 and gRPC</a>.</p>
<p>For more information on how Elastic services gRPC requests, see
<a href="https://github.com/elastic/apm-server/blob/main/dev_docs/otel.md#muxing-grpc-and-http11" class="ulink" target="_top">Muxing gRPC and HTTP/1.1</a>.</p>
<div class="position-relative"><h7><a id="observability-apm-agents-opentelemetry-opentelemetry-native-support-next-steps"></a>Next steps</h7><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/serverless/apm-agents/apm-agents-opentelemetry-opentelemetry-native-support.asciidoc">edit</a></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="observability-apm-agents-opentelemetry-collect-metrics.html" title="Collect metrics">Collect metrics</a>
</li>
<li class="listitem">
Add <a class="xref" href="observability-apm-agents-opentelemetry-resource-attributes.html" title="Resource attributes">Resource attributes</a>
</li>
<li class="listitem">
Learn about the <a class="xref" href="observability-apm-agents-opentelemetry-limitations.html" title="Limitations">limitations of this integration</a>
</li>
</ul>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="observability-apm-agents-opentelemetry.html">« Use OpenTelemetry with APM</a>
</span>
<span class="next">
<a href="observability-apm-agents-opentelemetry-collect-metrics.html">Collect metrics »</a>
</span>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>

                        <!-- Feedback widget -->
                        <div id="feedbackWidgetContainer"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


        <div id='elastic-footer'></div>
        <script src='https://www.elastic.co/elastic-footer.js'></script>
        <!-- Footer Section end-->

      </section>
    </div>

    <!-- Feedback modal -->
    <div id="feedbackModalContainer"></div>

    <script src="/guide/static/jquery.js"></script>
    <script type="text/javascript" src="/guide/static/docs-v1.js"></script>
    <script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
