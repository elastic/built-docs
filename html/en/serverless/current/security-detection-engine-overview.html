<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<meta name="description" content="">
<title>Detection engine overview | Serverless | Elastic</title>
<meta class="elastic" name="content" content="Detection engine overview | Serverless">

<link rel="home" href="index.html" title="Serverless"/>
<link rel="up" href="what-is-security-serverless.html" title="Elastic Security Serverless"/>
<link rel="prev" href="security-rule-monitoring-dashboard.html" title="Detection rule monitoring dashboard"/>
<link rel="next" href="security-detections-requirements.html" title="Detections requirements"/>
<meta class="elastic" name="product_version" content="main"/>
<meta class="elastic" name="product_name" content="Serverless"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Serverless/Guide"/>
<meta name="DC.subject" content="Serverless"/>
<meta name="DC.identifier" content="main"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles-v1.css" />
  </head>

  <!--© 2015-2025 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div class="navheader">
<span class="prev">
<a href="security-rule-monitoring-dashboard.html">« Detection rule monitoring dashboard</a>
</span>
<span class="next">
<a href="security-detections-requirements.html">Detections requirements »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Serverless</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="what-is-security-serverless.html">Elastic Security Serverless</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Detection engine overview</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/do-not-delete_legacy-docs/docs/serverless/rules/detection-engine-overview.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="security-detection-engine-overview"></a>Detection engine overview</h2><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/do-not-delete_legacy-docs/docs/serverless/rules/detection-engine-overview.asciidoc">edit</a></div>
</div></div></div>
<p>Use the detection engine to create and manage rules and view the alerts
these rules create. Rules periodically search indices (such as <code class="literal">logs-*</code> and
<code class="literal">filebeat-*</code>) for suspicious source events and create alerts when a rule&#8217;s
conditions are met. When an alert is created, its status is <code class="literal">Open</code>. To help
track investigations, an alert&#8217;s <a class="xref" href="security-alerts-manage.html#detection-alert-status" title="Change an alert&#8217;s status">status</a> can be set as
<code class="literal">Open</code>, <code class="literal">Acknowledged</code>, or <code class="literal">Closed</code>.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/detection-engine-overview/-detections-alert-page.png" alt="Alerts page">
</div>
</div>
<p>In addition to creating <a class="xref" href="security-rules-create.html" title="Create a detection rule">your own rules</a>, enable
<a class="xref" href="security-prebuilt-rules-management.html#load-prebuilt-rules" title="Install and enable Elastic prebuilt rules">Elastic prebuilt rules</a> to immediately start detecting
suspicious activity. For detailed information on all the prebuilt rules, see the <a class="xref" href="security-prebuilt-rules.html" title="Prebuilt rule reference">Prebuilt rules reference</a>. Once the prebuilt rules are loaded and
running, <a class="xref" href="security-tune-detection-signals.html" title="Tune detection rules">Tune detection rules</a> and <a class="xref" href="security-add-exceptions.html" title="Add and manage exceptions">Add and manage exceptions</a> explain
how to modify the rules to reduce false positives and get a better set of
actionable alerts. You can also use exceptions and value lists when creating or
modifying your own rules.</p>
<p>There are several special prebuilt rules you need to know about:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="endpoint-protection-rules.html" title="Endpoint protection rules"><span class="strong strong"><strong>Endpoint protection rules</strong></span></a>: Automatically create alerts based on Elastic Defend&#8217;s threat monitoring and prevention.
</li>
</ul>
</div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>External Alerts</strong></span>: Automatically creates an alert for
all incoming third-party system alerts (for example, Suricata alerts).
</li>
</ul>
</div>
<p>If you want to receive notifications via external systems, such as Slack or
email, when alerts are created, use the <a href="/guide/en/kibana/master/alerting-getting-started.html" class="ulink" target="_top">Alerting and Actions</a> framework.</p>
<p>After rules have started running, you can monitor their executions to verify
they are functioning correctly, as well as view, manage, and troubleshoot
alerts (see <a class="xref" href="security-alerts-manage.html" title="Manage detection alerts">Manage detection alerts</a> and <a class="xref" href="security-alerts-ui-monitor.html" title="Monitor and troubleshoot rule executions">Monitor and troubleshoot rule executions</a>).</p>
<p>You can create and manage rules and alerts via the UI or the <a href="/guide/en/security/master/rule-api-overview.html" class="ulink" target="_top">Detections API</a>.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>To make sure you can access Detections and manage rules, see
<a class="xref" href="security-detections-requirements.html" title="Detections requirements">Detections prerequisites and requirements</a>.</p>
</div>
</div>
<div class="position-relative"><h4><a id="support-indicator-rules"></a>Limited support for indicator match rules</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/do-not-delete_legacy-docs/docs/serverless/rules/detection-engine-overview.asciidoc">edit</a></div>
<p>Indicator match rules provide a powerful capability to search your security data; however, their queries can consume significant deployment resources. When creating an <a class="xref" href="security-rules-create.html#create-indicator-rule" title="Create an indicator match rule">indicator match rule</a>, we recommend limiting the time range of the indicator index query to the minimum period necessary for the desired rule coverage. For example, the default indicator index query <code class="literal">@timestamp &gt; "now-30d/d"</code> searches specified indicator indices for indicators ingested during the past 30 days and rounds the query start time down to the nearest day (resolves to UTC <code class="literal">00:00:00</code>). Without this limitation, the rule will include all of the indicators in your indicator indices, which may extend the time it takes for the indicator index query to complete.</p>
<p>In addition, indicator match rules with an additional look-back time value greater than 24 hours are not supported.</p>
<div class="position-relative"><h4><a id="detections-permissions"></a>Detections configuration and prerequisites</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/do-not-delete_legacy-docs/docs/serverless/rules/detection-engine-overview.asciidoc">edit</a></div>
<p><a class="xref" href="security-detections-requirements.html" title="Detections requirements">Detections requirements</a> provides detailed information on all the
permissions required to initiate and use the Detections feature.</p>
<div class="position-relative"><h4><a id="malware-prevention"></a>Malware prevention</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/do-not-delete_legacy-docs/docs/serverless/rules/detection-engine-overview.asciidoc">edit</a></div>
<p>Malware, short for malicious software, is any software program designed to damage or execute unauthorized actions on a
computer system. Examples of malware include viruses, worms, Trojan horses, adware, scareware, and spyware. Some
malware, such as viruses, can severely damage a computer&#8217;s hard drive by deleting files or directory information. Other
malware, such as spyware, can obtain user data without their knowledge.</p>
<p>Malware may be stealthy and appear as legitimate executable code, scripts, active content, and other software. It is also
often embedded in non-malicious files, non-suspicious websites, and standard programs — sometimes making the root
source difficult to identify. If infected and not resolved promptly, malware can cause irreparable damage to a computer
network.</p>
<p>For information on how to enable malware protection on your host, see <a class="xref" href="security-configure-endpoint-integration-policy.html#malware-protection" title="Malware protection">Malware Protection</a>.</p>
<div class="position-relative"><h5><a id="machine-learning-model"></a>Machine learning model</h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/do-not-delete_legacy-docs/docs/serverless/rules/detection-engine-overview.asciidoc">edit</a></div>
<p>To determine if a file is malicious or benign, a machine learning model looks for static attributes of files (without executing
the file) that include file structure, layout, and content. This includes information such as file header data, imports, exports,
section names, and file size. These attributes are extracted from millions of benign and malicious file samples, which then
are passed to a machine-learning algorithm that distinguishes a benign file from a malicious one. The machine learning
model is updated as new data is procured and analyzed.</p>
<div class="position-relative"><h5><a id="security-detection-engine-overview-threshold"></a>Threshold</h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/do-not-delete_legacy-docs/docs/serverless/rules/detection-engine-overview.asciidoc">edit</a></div>
<p>A malware threshold determines the action the agent should take if malware is detected. The Elastic Agent uses a recommended threshold level that generates a balanced number of alerts with a low probability of undetected malware. This threshold also minimizes the number of false positive alerts.</p>
<div class="position-relative"><h4><a id="ransomware-prevention"></a>Ransomware prevention</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/do-not-delete_legacy-docs/docs/serverless/rules/detection-engine-overview.asciidoc">edit</a></div>
<p>Ransomware is computer malware that installs discreetly on a user&#8217;s computer and encrypts data until a specified amount of money (ransom) is paid. Ransomware is usually similar to other malware in its delivery and execution, infecting systems
through spear-phishing or drive-by downloads. If not resolved immediately, ransomware can cause irreparable damage to an entire computer network.</p>
<p>Behavioral ransomware prevention on the Elastic Endpoint detects and stops ransomware attacks on Windows systems by analyzing data from low-level system processes, and is effective across an array of widespread ransomware families — including those targeting the system’s master boot record.</p>
<p>For information on how to enable ransomware protection on your host, see <a class="xref" href="security-configure-endpoint-integration-policy.html#ransomware-protection" title="Ransomware protection">Ransomware protection</a>.</p>
<div class="position-relative"><h5><a id="security-detection-engine-overview-resolve-ui-error-messages"></a>Resolve UI error messages</h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/do-not-delete_legacy-docs/docs/serverless/rules/detection-engine-overview.asciidoc">edit</a></div>
<p>Depending on your user role privileges and whether detection system indices have already been created, you might get one of these error messages when you
open the <span class="strong strong"><strong>Alerts</strong></span> or <span class="strong strong"><strong>Rules</strong></span> page:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p><span class="strong strong"><strong><code class="literal">Let’s set up your detection engine</code></strong></span></p>
<p>If you get this message, a user with specific privileges must visit the
<span class="strong strong"><strong>Alerts</strong></span> or <span class="strong strong"><strong>Rules</strong></span> page before you can view detection alerts and rules.
Refer to <a class="xref" href="security-detections-requirements.html#enable-detections-ui" title="Enable and access detections">Enable and access detections</a> for a list of all the requirements.</p>
</li>
<li class="listitem">
<p><span class="strong strong"><strong><code class="literal">Detection engine permissions required</code></strong></span></p>
<p>If you get this message, you do not have the
<a class="xref" href="security-detection-engine-overview.html#detections-permissions" title="Detections configuration and prerequisites">required privileges</a> to view the <span class="strong strong"><strong>Detections</strong></span> feature,
and you should contact your project administrator.</p>
</li>
</ul>
</div>
<div class="position-relative"><h4><a id="detections-logsdb-index-mode"></a>Using logsdb index mode</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/do-not-delete_legacy-docs/docs/serverless/rules/detection-engine-overview.asciidoc">edit</a></div>
<p>logsdb is enabled by default for Elastic serverless. Refer to <a class="xref" href="detections-logsdb-index-mode-impact.html" title="Using logsdb index mode with Elastic Security Serverless">Using logsdb index mode with Elastic Security Serverless</a> to learn more.</p>


</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="security-rule-monitoring-dashboard.html">« Detection rule monitoring dashboard</a>
</span>
<span class="next">
<a href="security-detections-requirements.html">Detections requirements »</a>
</span>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>

                        <!-- Feedback widget -->
                        <div id="feedbackWidgetContainer"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


        <div id='elastic-footer'></div>
        <script src='https://www.elastic.co/elastic-footer.js'></script>
        <!-- Footer Section end-->

      </section>
    </div>

    <!-- Feedback modal -->
    <div id="feedbackModalContainer"></div>

    <script src="/guide/static/jquery.js"></script>
    <script type="text/javascript" src="/guide/static/docs-v1.js"></script>
    <script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
