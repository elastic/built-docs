<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<meta name="description" content="">
<title>Event capture and Elastic Defend | Serverless | Elastic</title>
<meta class="elastic" name="content" content="Event capture and Elastic Defend | Serverless">

<link rel="home" href="index.html" title="Serverless"/>
<link rel="up" href="security-manage-endpoint-protection.html" title="Manage Elastic Defend"/>
<link rel="prev" href="security-optimize-edr.html" title="Optimize Elastic Defend"/>
<link rel="next" href="endpoint-protection-rules.html" title="Endpoint protection rules"/>
<meta class="elastic" name="product_version" content="main"/>
<meta class="elastic" name="product_name" content="Serverless"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Serverless/Guide"/>
<meta name="DC.subject" content="Serverless"/>
<meta name="DC.identifier" content="main"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="icon" href="/favicon.ico" sizes="32x32"/>
    <link rel="icon" href="/favicon.svg" type="image/svg+xml"/>
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" sizes="180x180"/>
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles-v1.css" />
  </head>

  <!--© 2015-2025 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div class="navheader">
<span class="prev">
<a href="security-optimize-edr.html">« Optimize Elastic Defend</a>
</span>
<span class="next">
<a href="endpoint-protection-rules.html">Endpoint protection rules »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Serverless</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="what-is-security-serverless.html">Elastic Security Serverless</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="security-manage-endpoint-protection.html">Manage Elastic Defend</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Event capture and Elastic Defend</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/do-not-delete_legacy-docs/docs/serverless/edr-manage/endpoint-event-capture.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div id="url-to-v3" class="version-warning">
    <strong>IMPORTANT</strong>: This documentation is no longer updated. Refer to <a href="https://www.elastic.co/support/eol">Elastic's version policy</a> and the <a href="https://www.elastic.co/docs/solutions/security/manage-elastic-defend/event-capture-elastic-defend">latest documentation</a>.
</div>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="security-endpoint-event-capture"></a>Event capture and Elastic Defend</h3><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/do-not-delete_legacy-docs/docs/serverless/edr-manage/endpoint-event-capture.asciidoc">edit</a></div>
</div></div></div>
<p>Elastic Defend collects select data on system activity in order to detect and prevent as many threats as possible, while balancing storage and performance overhead. To that end, Elastic Defend isn&#8217;t designed to capture all system events. Some event data that Elastic Defend generates gets aggregated, truncated, or deduplicated as needed to optimize threat detection and prevention.</p>
<p>You can supplement Elastic Defend&#8217;s protection capabilities with <a href="https://docs.elastic.co/en/integrations" class="ulink" target="_top">Elastic integrations</a> and tools that provide more visibility and historical data. Consult the following sections to expand data collection for specific types of system events.</p>
<div class="position-relative"><h5><a id="security-endpoint-event-capture-network-port-creation-and-deletion"></a>Network port creation and deletion</h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/do-not-delete_legacy-docs/docs/serverless/edr-manage/endpoint-event-capture.asciidoc">edit</a></div>
<p>Elastic Defend tracks TCP connections. If a port is created but no traffic flows, no events are generated.</p>
<p>For complete capture of network port creation and deletion, consider capturing Windows event ID 5158 using the <a href="https://docs.elastic.co/en/integrations/winlog" class="ulink" target="_top">Custom Windows Event Logs</a> integration.</p>
<div class="position-relative"><h5><a id="security-endpoint-event-capture-network-inout-connections"></a>Network in/out connections</h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/do-not-delete_legacy-docs/docs/serverless/edr-manage/endpoint-event-capture.asciidoc">edit</a></div>
<p>Elastic Defend tracks TCP connections, which don&#8217;t include network in/out connections.</p>
<p>For complete network capture, consider deploying Packetbeat using the <a href="https://docs.elastic.co/en/integrations/network_traffic" class="ulink" target="_top">Network Packet Capture</a> integration.</p>
<div class="position-relative"><h5><a id="security-endpoint-event-capture-user-behavior"></a>User behavior</h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/do-not-delete_legacy-docs/docs/serverless/edr-manage/endpoint-event-capture.asciidoc">edit</a></div>
<p>Elastic Defend only captures user security events required by its behavioral protection. This doesn&#8217;t include every user event such as logins and logouts, or every time a user account is created, deleted, or modified.</p>
<p>For complete capture of all or specific Windows security events, consider the <a href="https://docs.elastic.co/en/integrations/winlog" class="ulink" target="_top">Custom Windows Event Logs</a> integration.</p>
<div class="position-relative"><h5><a id="security-endpoint-event-capture-system-service-registration-deletion-and-modification"></a>System service registration, deletion, and modification</h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/do-not-delete_legacy-docs/docs/serverless/edr-manage/endpoint-event-capture.asciidoc">edit</a></div>
<p>Elastic Defend only captures system service security events required by its behavioral protection engine. Service creation and modification can also be detected in registry activity, for which Elastic Defend has internal rules such as <a href="https://github.com/elastic/protections-artifacts/blob/6d54ae289b290b1d42a7717569483f6ce907200a/behavior/rules/persistence_registry_or_file_modification_from_suspicious_memory.toml" class="ulink" target="_top">Registry or File Modification from Suspicious Memory</a>.</p>
<p>For complete capture of all or specific Windows security events, consider the <a href="https://docs.elastic.co/en/integrations/winlog" class="ulink" target="_top">Custom Windows Event Logs</a> integration. In particular, capture events such as <a href="https://learn.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4697" class="ulink" target="_top">Windows event ID 4697</a>.</p>
<div class="position-relative"><h5><a id="security-endpoint-event-capture-kernel-driver-registration-deletion-and-queries"></a>Kernel driver registration, deletion, and queries</h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/do-not-delete_legacy-docs/docs/serverless/edr-manage/endpoint-event-capture.asciidoc">edit</a></div>
<p>Elastic Defend scans every driver as it is loaded, but it doesn&#8217;t generate an event each time.</p>
<p>Drivers are registered in the system as system services. You can capture this with Windows event ID 4697 using the <a href="https://docs.elastic.co/en/integrations/winlog" class="ulink" target="_top">Custom Windows Event Logs</a> integration.</p>
<p>Also consider capturing Windows event ID 6 using Winlogbeat&#8217;s <a href="/guide/en/beats/winlogbeat/8.19/winlogbeat-module-sysmon.html" class="ulink" target="_top">Sysmon module</a>.</p>
<div class="position-relative"><h5><a id="security-endpoint-event-capture-system-configuration-file-creation-modification-and-deletion"></a>System configuration file creation, modification, and deletion</h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/do-not-delete_legacy-docs/docs/serverless/edr-manage/endpoint-event-capture.asciidoc">edit</a></div>
<p>Elastic Defend tracks creation, modification, and deletion of all files on the system. However, as mentioned above, the data might be aggregated, truncated, or deduplicated to provide only what&#8217;s required for threat detection and prevention.</p>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="security-optimize-edr.html">« Optimize Elastic Defend</a>
</span>
<span class="next">
<a href="endpoint-protection-rules.html">Endpoint protection rules »</a>
</span>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>

                        <!-- Feedback widget -->
                        <div id="feedbackWidgetContainer"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


        <div id='elastic-footer'></div>
        <script src='https://www.elastic.co/elastic-footer.js'></script>
        <!-- Footer Section end-->

      </section>
    </div>

    <!-- Feedback modal -->
    <div id="feedbackModalContainer"></div>

    <script src="/guide/static/jquery.js"></script>
    <script type="text/javascript" src="/guide/static/docs-v1.js"></script>
    <script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
