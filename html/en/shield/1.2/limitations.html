<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Appendix 3. Limitations | Shield - Elasticsearch Security Plugin [1.2] | Elastic</title>
<meta class="elastic" name="content" content="Appendix 3. Limitations | Shield - Elasticsearch Security Plugin [1.2]">

<link rel="home" href="index.html" title="Shield - Elasticsearch Security Plugin [1.2]"/>
<link rel="up" href="index.html" title="Shield - Elasticsearch Security Plugin [1.2]"/>
<link rel="prev" href="license-management.html" title="Appendix 2. License Management"/>
<link rel="next" href="securing-aliases.html" title="Appendix 4. Securing Indices &amp; Aliases"/>
<meta class="elastic" name="product_version" content="1.2"/>
<meta class="elastic" name="product_name" content="Shield"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Legacy/Shield/Reference/1.2"/>
<meta name="DC.subject" content="Shield"/>
<meta name="DC.identifier" content="1.2"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <!--© 2015-2022 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  <div class="page_header">
From version 5.0 onward, Shield is part of X-Pack. For more information, see
<a href=https://www.elastic.co/guide/en/elastic-stack-overview/current/elasticsearch-security.html>
    Securing the Elastic Stack</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Shield - Elasticsearch Security Plugin [1.2]</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="license-management.html">« Appendix 2. License Management</a>
</span>
<span class="next">
<a href="securing-aliases.html">Appendix 4. Securing Indices &amp; Aliases »</a>
</span>
</div>
<div class="chapter">
<div class="titlepage"><div><div>
<h1 class="title"><a id="limitations"></a>Appendix 3. Limitations<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/x-pack/edit/shield-1.2/docs/public/shield/appendices/03-limitations.asciidoc">edit</a></h1>
</div></div></div>
<h3><a id="_plugins"></a>Plugins<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/x-pack/edit/shield-1.2/docs/public/shield/appendices/03-limitations.asciidoc">edit</a></h3>
<p>Elasticsearch&#8217;s plugin infrastructure is extremely flexible in terms of what can be extended. While it opens up Elasticsearch
to a wide variety of (often custom) additional functionality, when it comes to security, this high extensibility level
comes at a cost. We have no control over the third-party plugins' code (open source or not) and therefore we cannot
guarantee their compliance with Shield. For this reason, third-party plugins are not officially supported on clusters
with the Shield security plugin installed.</p>
<h3><a id="_changes_in_index_wildcard_behavior"></a>Changes in Index Wildcard Behavior<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/x-pack/edit/shield-1.2/docs/public/shield/appendices/03-limitations.asciidoc">edit</a></h3>
<p>Elasticsearch clusters with the Shield security plugin installed apply the <code class="literal">/_all</code> wildcard, and all other wildcards,
to the indices that the current user has privileges for, not the set of all indices on the cluster. There are two
notable results of this behavior:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elasticsearch clusters with the Shield security plugin installed do not honor the <code class="literal">ignore_unavailable</code> option.
This behavior means that requests involving indices that the current user lacks authorization for throw an
<code class="literal">AuthorizationException</code> error, regardless of the option&#8217;s setting.
</li>
<li class="listitem">
The <code class="literal">allow_no_indices</code> option is ignored, resulting in the following behavior: when the final set of indices after
wildcard expansion and replacement is empty, the request throws a <code class="literal">IndexMissingException</code> error.
</li>
</ul>
</div>
<p>As a general principle, core Elasticsearch will return empty results in scenarios where wildcard expansion returns no
indices, while Elasticsearch with Shield returns exceptions. Note that this behavior means that operations with
multiple items will fail the entire set of operations if any one operation throws an exception due to wildcard
expansion resulting in an empty set of authorized indices.</p>
<h3><a id="limitations-filtered-aliases"></a>Filtered Index Aliases<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/x-pack/edit/shield-1.2/docs/public/shield/appendices/03-limitations.asciidoc">edit</a></h3>
<p>You can combine a secured index alias with a <a href="http://www.elastic.co/guide/en/elasticsearch/reference/1.7/query-dsl-filters.html" class="ulink" target="_top">filter</a>
to approximate document-level security. By manipulating the specific filtering, you can control the set of documents
that users with privileges on that index alias can access.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>Filtering secured index aliases does not provide security for documents retrieved through the
<a href="http://www.elastic.co/guide/en/elasticsearch/reference/1.7/docs-get.html" class="ulink" target="_top">get api</a>. Read
<a href="https://github.com/elasticsearch/elasticsearch/issues/3861" class="ulink" target="_top">elasticsearch issue #3861</a> to learn more about this limitation.
Users can obtain secure near-real-time get under this restriction with searches by document ID, using the
<a href="http://www.elastic.co/guide/en/elasticsearch/reference/1.7/search-search.html" class="ulink" target="_top">search api</a> instead. Restrict get operations when you use this approach by granting the <code class="literal">search</code>
privilege and disallowing <code class="literal">get</code>.</p>
</div>
</div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>In Elasticsearch, issuing a delete operation on an alias also deletes all of the indices that the alias
points to, regardless of the filter that the alias might hold. Keep this behavior in mind when granting users
administrative privileges to filtered index aliases. Read
<a href="https://github.com/elasticsearch/elasticsearch/issues/2318" class="ulink" target="_top">elasticsearch issue #2318</a> to learn more about this limitation.</p>
</div>
</div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>A filtered index alias will not provide document-level security for the <a href="http://www.elastic.co/guide/en/elasticsearch/reference/1.7/search-suggesters.html" class="ulink" target="_top">suggesters apis</a>
as they do not take into account the filters placed on aliases.</p>
</div>
</div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>A filtered index alias will not provide document-level security when using a
<a href="http://www.elastic.co/guide/en/elasticsearch/reference/1.7/search-aggregations-bucket-children-aggregation.html" class="ulink" target="_top">Children Aggregation</a> as the filter from the alias is not used
when computing the aggregation results.</p>
</div>
</div>
<h3><a id="_queries_and_filters"></a>Queries and Filters<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/x-pack/edit/shield-1.2/docs/public/shield/appendices/03-limitations.asciidoc">edit</a></h3>
<h4><a id="limitations-disable-cache"></a>Elasticsearch 1.6+<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/x-pack/edit/shield-1.2/docs/public/shield/appendices/03-limitations.asciidoc">edit</a></h4>
<p>Elasticsearch 1.6 removes all of the limitations below with queries and filters, <span class="strong strong"><strong>but</strong></span> there is the possibility of
authorization being bypassed when using a terms filter with the
<a href="http://www.elastic.co/guide/en/elasticsearch/reference/1.7/query-dsl-terms-filter.html#_terms_lookup_mechanism" class="ulink" target="_top">terms lookup mechanism</a>. The authorization that could be
bypassed is for the index containing the terms. In order to ensure that all requests are properly authorized when using
Shield 1.2.0 and 1.2.1, add the following setting to your <code class="literal">elasticsearch.yml</code> file:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">indices.cache.filter.terms.size: 0</pre>
</div>
<h4><a id="_elasticsearch_pre_1_6_0"></a>Elasticsearch pre-1.6.0<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/x-pack/edit/shield-1.2/docs/public/shield/appendices/03-limitations.asciidoc">edit</a></h4>
<p>Certain Elasticsearch requests execute other requests as part of their implementation. Some of these requests do not
maintain the security context that the original request was made with. This causes an <code class="literal">AuthorizationException</code> even when
the user has authorization to make the subsequent requests. The following requests have this behavior:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="http://www.elastic.co/guide/en/elasticsearch/reference/1.7/query-dsl-mlt-query.html" class="ulink" target="_top">More Like This Query</a>
</li>
<li class="listitem">
<a href="http://www.elastic.co/guide/en/elasticsearch/reference/1.7/query-dsl-geo-shape-query.html" class="ulink" target="_top">GeoShape Query</a> and <a href="http://www.elastic.co/guide/en/elasticsearch/reference/1.7/query-dsl-geo-shape-filter.html" class="ulink" target="_top">GeoShape Filter</a> when
used with an <a href="http://www.elastic.co/guide/en/elasticsearch/reference/1.7/query-dsl-geo-shape-filter.html#_pre_indexed_shape" class="ulink" target="_top">indexed shape</a>
</li>
<li class="listitem">
<a href="http://www.elastic.co/guide/en/elasticsearch/reference/1.7/query-dsl-terms-filter.html" class="ulink" target="_top">Terms Filter</a> when using the <a href="http://www.elastic.co/guide/en/elasticsearch/reference/1.7/query-dsl-terms-filter.html#_terms_lookup_mechanism" class="ulink" target="_top">terms lookup mechanism</a>
</li>
<li class="listitem">
<a href="http://www.elastic.co/guide/en/elasticsearch/reference/1.7/search-suggesters-phrase.html" class="ulink" target="_top">Phrase Suggester</a> when specifying the <code class="literal">collate</code> field
</li>
<li class="listitem">
Any query using <a href="http://www.elastic.co/guide/en/elasticsearch/reference/1.7/modules-scripting.html#_indexed_scripts" class="ulink" target="_top">indexed scripts</a>
</li>
<li class="listitem">
Queries using a <a href="http://www.elastic.co/guide/en/elasticsearch/reference/1.7/search-template.html" class="ulink" target="_top">search template</a>
</li>
</ul>
</div>
<h3><a id="_document_expiration_ttl"></a>Document Expiration (_ttl)<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/x-pack/edit/shield-1.2/docs/public/shield/appendices/03-limitations.asciidoc">edit</a></h3>
<p>Document expiration handled using the built-in <a href="http://www.elastic.co/guide/en/elasticsearch/reference/1.7/mapping-ttl-field.html#mapping-ttl-field" class="ulink" target="_top"><code class="literal">_ttl</code> (time to live) mechanism</a>
does not work with Shield. The document deletions will fail and the documents continue to live past their expiration.</p>
<h3><a id="_ldap_realm"></a>LDAP Realm<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/x-pack/edit/shield-1.2/docs/public/shield/appendices/03-limitations.asciidoc">edit</a></h3>
<p>The <a class="xref" href="ldap.html" title="LDAP Authentication">LDAP Realm</a> does not currently support the discovery of nested LDAP Groups.  For example, if a user is a member
of GroupA and GroupA is a member of GroupB, only GroupA will be discovered.  However, the <a class="xref" href="active_directory.html" title="Active Directory Authentication">Active Directory Realm</a> <em>does</em>
support transitive group membership.</p>
</div>
<div class="navfooter">
<span class="prev">
<a href="license-management.html">« Appendix 2. License Management</a>
</span>
<span class="next">
<a href="securing-aliases.html">Appendix 4. Securing Indices &amp; Aliases »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
