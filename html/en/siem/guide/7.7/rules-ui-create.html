<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Managing signal detection rules | SIEM Guide [7.7] | Elastic</title>
<link rel="home" href="index.html" title="SIEM Guide [7.7]"/>
<link rel="up" href="detection-engine-overview.html" title="Detections (beta)"/>
<link rel="prev" href="detection-engine-overview.html" title="Detections (beta)"/>
<link rel="next" href="prebuilt-rules.html" title="Prebuilt rule reference"/>
<meta name="DC.type" content="Learn/Docs/SIEM/Guide/7.7"/>
<meta name="DC.subject" content="SIEM"/>
<meta name="DC.identifier" content="7.7"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!--BEGIN QUALTRICS WEBSITE FEEDBACK SNIPPET-->
    <script type='text/javascript'>
      (function(){var g=function(e,h,f,g){
      this.get=function(a){for(var a=a+"=",c=document.cookie.split(";"),b=0,e=c.length;b<e;b++){for(var d=c[b];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return null};
      this.set=function(a,c){var b="",b=new Date;b.setTime(b.getTime()+6048E5);b="; expires="+b.toGMTString();document.cookie=a+"="+c+b+"; path=/; "};
      this.check=function(){var a=this.get(f);if(a)a=a.split(":");else if(100!=e)"v"==h&&(e=Math.random()>=e/100?0:100),a=[h,e,0],this.set(f,a.join(":"));else return!0;var c=a[1];if(100==c)return!0;switch(a[0]){case "v":return!1;case "r":return c=a[2]%Math.floor(100/c),a[2]++,this.set(f,a.join(":")),!c}return!0};
      this.go=function(){if(this.check()){var a=document.createElement("script");a.type="text/javascript";a.src=g;document.body&&document.body.appendChild(a)}};
      this.start=function(){var a=this;window.addEventListener?window.addEventListener("load",function(){a.go()},!1):window.attachEvent&&window.attachEvent("onload",function(){a.go()})}};
      try{(new g(100,"r","QSI_S_ZN_emkP0oSe9Qrn7kF","https://znemkp0ose9qrn7kf-elastic.siteintercept.qualtrics.com/WRSiteInterceptEngine/?Q_ZID=ZN_emkP0oSe9Qrn7kF")).start()}catch(i){}})();
    </script><div id='ZN_emkP0oSe9Qrn7kF'><!--DO NOT REMOVE-CONTENTS PLACED HERE--></div>
    <!--END WEBSITE FEEDBACK SNIPPET-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <!-- Subnav -->
    <div>
      <div>
        <div class="tertiary-nav d-none d-md-block">
          <div class="container">
            <div class="p-t-b-15 d-flex justify-content-between nav-container">
              <div class="breadcrum-wrapper"><span><a href="/guide/" style="font-size: 14px; font-weight: 600; color: #000;">Docs</a></span></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container">
              <div class="row">
                <div class="col-xs-12 col-sm-8 col-md-8 guide-section">
                  <!-- start body -->
                  <div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">SIEM Guide [7.7]</a></span>
»
<span class="breadcrumb-link"><a href="detection-engine-overview.html">Detections (beta)</a></span>
»
<span class="breadcrumb-node">Managing signal detection rules</span>
</div>
<div class="navheader">
<span class="prev">
<a href="detection-engine-overview.html">« Detections (beta)</a>
</span>
<span class="next">
<a href="prebuilt-rules.html">Prebuilt rule reference »</a>
</span>
</div>
<div class="chapter xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="rules-ui-create"></a>Managing signal detection rules<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/stack-docs/edit/7.7/docs/en/siem/detections/rules-ui-create.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in beta and is subject to change. The design and code is less mature than official GA features and is being provided as-is with no warranties. Beta features are not subject to the support SLA of official GA features.</p>
</div>
</div>
<p>Rules run periodically and search for documents or machine learning job anomaly scores
that meet their criteria. For both prebuilt and custom rules, you can use the
Kibana <a href="/guide/en/kibana/7.7/alerting-getting-started.html" class="ulink" target="_top">Alerting and Actions</a> feature
to send notifications when signals are created. Notifications can be sent via
Email, PagerDuty, Slack, and Webhook, and can be configured in the SIEM app
when you create or edit a rule.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>After you activate a rule, periodically check the rule is running as expected
in the <a class="xref" href="rules-ui-create.html#monitor-rule-exe" title="Monitor all rule executions">Monitoring tab</a> on the All rules page. If you see
values in the <code class="literal">Gap</code> column, you can <a class="xref" href="rules-ui-create.html#troubleshoot-signals" title="Troubleshoot missing signals">Troubleshoot missing signals</a>.</p>
<p>When a rule fails to run, the SIEM app tries to rerun it at its next
scheduled run time.</p>
</div>
</div>
<p>On the Rules page, you can:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="rules-ui-create.html#load-prebuilt-rules" title="Load prebuilt Elastic rules">Load prebuilt Elastic rules</a>
</li>
<li class="listitem">
<a class="xref" href="rules-ui-create.html#select-all-prebuilt-rules" title="Select and duplicate all prebuilt rules">Select and duplicate all prebuilt rules</a>
</li>
<li class="listitem">
<a class="xref" href="rules-ui-create.html#create-rule-ui" title="Create a new rule">Create your own rules</a>
</li>
<li class="listitem">
<a class="xref" href="rules-ui-create.html#manage-rules-ui" title="Modify existing rules">Clone, edit, delete, activate, and deactivate rules</a>
</li>
<li class="listitem">
<a class="xref" href="rules-ui-create.html#monitor-rule-exe" title="Monitor all rule executions">Monitor all rule executions</a>
</li>
<li class="listitem">
<a class="xref" href="rules-ui-create.html#import-export-rules-ui" title="Import and export rules">Import and export rules</a>
</li>
<li class="listitem">
<a class="xref" href="rules-ui-create.html#troubleshoot-signals" title="Troubleshoot missing signals">Troubleshoot missing signals</a>
</li>
</ul>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="all-rules.png" alt="all rules">
</div>
</div>
<h3><a id="load-prebuilt-rules"></a>Load prebuilt Elastic rules<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/stack-docs/edit/7.7/docs/en/siem/detections/rules-ui-create.asciidoc">edit</a></h3>
<p>To load the SIEM app&#8217;s <a class="xref" href="prebuilt-rules.html" title="Prebuilt rule reference">prebuilt rules</a>, click
<span class="strong strong"><strong>Load Elastic prebuilt rules</strong></span> on the <span class="strong strong"><strong>Signal detection rules</strong></span> page (<span class="strong strong"><strong>SIEM</strong></span> &#8594;
<span class="strong strong"><strong>Detections</strong></span> &#8594; <span class="strong strong"><strong>Manage signal detection rules</strong></span>).</p>
<p>If you delete any of the prebuilt rules, a button appears that enables
reloading all the deleted prebuilt rules.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>By default, prebuilt rules are not activated. If you want to modify a prebuilt
rule, you must first duplicate it and then make your changes to the duplicated
rule. <a class="xref" href="tuning-detection-signals.html#filter-rule-process" title="Filter out uncommon application signals">Filter out uncommon application signals</a> provides a detailed example of duplicating and modifying a rule.</p>
<p>All Elastic prebuilt rules are tagged with the word <code class="literal">Elastic</code>.</p>
</div>
</div>
<h3><a id="select-all-prebuilt-rules"></a>Select and duplicate all prebuilt rules<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/stack-docs/edit/7.7/docs/en/siem/detections/rules-ui-create.asciidoc">edit</a></h3>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Select the <span class="strong strong"><strong>Elastic rules</strong></span> tab.
</li>
<li class="listitem">
Scroll to the bottom of the page.
</li>
<li class="listitem">
Click the <code class="literal">Rows per page</code> menu, and then select <em>200 rows</em>.
</li>
<li class="listitem">
When the page reloads, select all the rules.
</li>
<li class="listitem">
Click <em>Bulk actions</em> &#8594; <em>Duplicate selected</em>.
</li>
<li class="listitem">
Select the <span class="strong strong"><strong>Custom rules</strong></span> tab.
</li>
</ol>
</div>
<p>You can then modify the duplicated rules and, if required, delete the prebuilt
ones.</p>
<h3><a id="create-rule-ui"></a>Create a new rule<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/stack-docs/edit/7.7/docs/en/siem/detections/rules-ui-create.asciidoc">edit</a></h3>
<p>You can create two types of rules:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Custom query</strong></span>: Query-based rule, which searches the defined indices and creates a signal when a document matches the rule&#8217;s query.
</li>
<li class="listitem">
<p><span class="strong strong"><strong>Machine learning</strong></span>: Machine learning rule, which creates a signal when a machine learning job discovers an anomaly above the defined threshold (see <a class="xref" href="machine-learning.html" title="Anomaly Detection with Machine Learning">Anomaly Detection with Machine Learning</a>).</p>
<p>For machine learning rules, the associated machine learning job must be running. If the machine learning job is not
running, the rule will:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Run and create signals if existing anomaly scores above the defined threshold
are discovered.
</li>
<li class="listitem">
Issue an error stating the machine learning job was not running when the rule executed.
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>To create machine learning rules, you must have the
<a href="/subscriptions" class="ulink" target="_top">appropriate license</a> or use a
<a href="/cloud/elasticsearch-service/signup?baymax=docs-body&amp;elektra=docs" class="ulink" target="_top">cloud deployment</a>.</p>
</div>
</div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Go to <span class="strong strong"><strong>SIEM</strong></span> &#8594; <span class="strong strong"><strong>Detections</strong></span> &#8594; <span class="strong strong"><strong>Manage signal detection rules</strong></span>.
</li>
<li class="listitem">
<p>Click <span class="strong strong"><strong>Create new rule</strong></span>.</p>
<p>The <span class="strong strong"><strong>Create new rule</strong></span> page is displayed.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/create-new-rule.png" alt="create new rule">
</div>
</div>
</li>
<li class="listitem">
<p>Do <span class="strong strong"><strong>one</strong></span> of the following:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>To create a rule based on a machine learning anomaly threshold, select <em>Machine Learning</em>
and then:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
The required machine learning job.
</li>
<li class="listitem">
<p>The anomaly score threshold above which signals are created.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>The selected machine learning job must be running for the rule to function
correctly.</p>
</div>
</div>
</li>
</ol>
</div>
</li>
<li class="listitem">
<p>To create a rule based on a KQL or Lucene query, select <em>Custom query</em> and
then:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Define which Elasticsearch indices the rule analyzes for signals.
</li>
<li class="listitem">
<p>Use the filter and query fields to create the criteria used for detecting
signals.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>You can use Kibana saved queries (save icon) and queries from saved timelines (<code class="literal">Import query from saved timeline</code>) as rule conditions.</p>
</div>
</div>
<p>For example, the following rule detects when the <code class="literal">vssadmin delete shadows</code>
Windows command is executed:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p><em>Index patterns</em>: <code class="literal">winlogbeat-*</code></p>
<p>Winlogbeat ships Windows event logs to the SIEM app.</p>
</li>
<li class="listitem">
<p><em>Custom query</em>: <code class="literal">event.action:"Process Create (rule: ProcessCreate)" and process.name:"vssadmin.exe" and process.args:("delete" and "shadows")</code></p>
<p>Searches the <code class="literal">winlogbeat-*</code> indices for <code class="literal">vssadmin.exe</code> executions with
the <code class="literal">delete</code> and <code class="literal">shadow</code> arguments, which are used to delete a volume&#8217;s shadow
copies.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="rule-query-example.png" alt="rule query example">
</div>
</div>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>This example is based on the
<a class="xref" href="volume-shadow-copy-deletion-via-vssadmin.html" title="Volume Shadow Copy Deletion via VssAdmin">Volume Shadow Copy Deletion via VssAdmin</a> prebuilt rule.</p>
</div>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Select the timeline template used when you investigate a signal created by
the rule in Timeline (optional).</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>Before you create rules, create and save relevant
<a class="xref" href="siem-ui-overview.html#timelines-ui" title="Timelines">timelines</a> so they can be selected here. When signals generated
by the rule are investigated in Timeline,
<a class="xref" href="detection-engine-overview.html#signals-to-timelines" title="Investigate signals in Timeline">some query field values</a> are replaced with their
corresponding signal field values.</p>
</div>
</div>
</li>
<li class="listitem">
<p>Click <span class="strong strong"><strong>Continue</strong></span>.</p>
<p>The <span class="strong strong"><strong>About rule</strong></span> pane is displayed.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/about-rule-pane.png" alt="about rule pane">
</div>
</div>
</li>
<li class="listitem">
<p>Fill in the following fields:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<em>Name</em>: The rule&#8217;s name.
</li>
<li class="listitem">
<em>Description</em>: A description of what the rule does.
</li>
<li class="listitem">
<p><em>Severity</em>: Select the severity levels of signals created by the rule:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">Low</code>: Signals that are of interest but generally not considered to be
security incidents. Sometimes, a combination of low severity events can
indicate suspicious activity.
</li>
<li class="listitem">
<code class="literal">Medium</code>: Signals that require investigation.
</li>
<li class="listitem">
<code class="literal">High</code>: Signals that require an immediate investigation.
</li>
<li class="listitem">
<code class="literal">Critical</code>: Signals that indicate it is highly likely a security incident has
occurred.
</li>
</ul>
</div>
</li>
<li class="listitem">
<p><em>Risk score</em>: A numerical value between 0 and 100 that correlates with the <em>Severity</em> level. General guidelines are:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">0</code> - <code class="literal">21</code> represents low severity.
</li>
<li class="listitem">
<code class="literal">22</code> - <code class="literal">47</code> represents medium severity.
</li>
<li class="listitem">
<code class="literal">48</code> - <code class="literal">73</code> represents high severity.
</li>
<li class="listitem">
<code class="literal">74</code> - <code class="literal">100</code> represents critical severity.
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>For additional options, click <span class="strong strong"><strong>Advanced settings</strong></span> and fill in any of
these fields:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li class="listitem">
<em>Reference URLs</em> (optional): References to information that is relevant to
the rule. For example, links to relevant background information.
</li>
<li class="listitem">
<em>False positives</em> (optional): List of common scenarios that may produce
false-positive signals.
</li>
<li class="listitem">
<em>MITRE ATT&amp;CK<sup>TM</sup></em> (optional): Relevant MITRE framework tactics and techniques.
</li>
<li class="listitem">
<em>Tags</em> (optional): Words and phrases used to categorize, filter, and search
the rule.
</li>
<li class="listitem">
<em>Investigation guide</em> (optional): Information for analysts investigating
signals created by the rule.
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
<li class="listitem">
<p>Click <span class="strong strong"><strong>Continue</strong></span>.</p>
<p><a id="rule-schedule"></a>The <span class="strong strong"><strong>Schedule rule</strong></span> pane is displayed.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/schedule-rule.png" alt="schedule rule">
</div>
</div>
</li>
<li class="listitem">
Select how often the rule runs.
</li>
<li class="listitem">
<p>Optionally, add <code class="literal">Additional look-back time</code> to the rule. When defined, the
rule searches indices with the additional time.</p>
<p>For example, if you set a rule to run every 5 minutes with an additional
look-back time of 1 minute, the rule runs every 5 minutes but analyses the
documents added to indices during the last 6 minutes.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>It is recommended to set the <code class="literal">Additional look-back time</code> to at
least 1 minute. This ensures there are no missing signals when a rule does not
run exactly at its scheduled time.</p>
<p>The SIEM app performs deduplication. Duplicate signals discovered during the
<code class="literal">Additional look-back time</code> are <span class="strong strong"><strong>not</strong></span> created.</p>
</div>
</div>
</li>
<li class="listitem">
<p>Click <span class="strong strong"><strong>Continue</strong></span>.</p>
<p><a id="rule-actions"></a>The <span class="strong strong"><strong>Rule actions</strong></span> pane is displayed.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/rule-actions.png" alt="rule actions">
</div>
</div>
</li>
<li class="listitem">
<p>Optionally, use Kibana Actions to set up notifications sent via other systems
when new signals are detected.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>To use Kibana Actions for signal notifications, you need the
<a href="/subscriptions" class="ulink" target="_top">appropriate license</a>.</p>
</div>
</div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Set how often notifications are sent:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<em>On each rule execution</em>: Sends a notification every time new signals are
detected.
</li>
<li class="listitem">
<em>Hourly</em>: Sends a notification every hour.
</li>
<li class="listitem">
<em>Daily</em>: Sends a notification every day.
</li>
<li class="listitem">
<p><em>Weekly</em>: Sends a notification every week.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Notifications are sent only when new signals are detected.</p>
</div>
</div>
<p>The available action types are displayed.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/available-action-types.png" alt="available action types">
</div>
</div>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Select the required action type, which determines how notifications are sent (Email, PagerDuty, Slack, Webhook).</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Each action type requires a connector. Connectors store the
information required to send the notification from the external system. You can
configure connectors while creating the rule or on the Kibana Alerts and Actions
page (<span class="strong strong"><strong>Management</strong></span> &#8594; <span class="strong strong"><strong>Alerts and Actions</strong></span> &#8594; <span class="strong strong"><strong>Connectors</strong></span>). For more
information, see <a href="/guide/en/kibana/7.7/action-types.html" class="ulink" target="_top">Action and connector types</a>.</p>
</div>
</div>
<p>The selected action type fields are displayed (Slack example).</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/selected-action-type.png" alt="selected action type">
</div>
</div>
</li>
<li class="listitem">
Fill in the fields for the selected action types. For all action types, click
the icon above the <code class="literal">Message</code> field to add
<a class="xref" href="rules-ui-create.html#rule-action-variables" title="Notification placeholders">placeholders</a> for rule and signal details to the
notifications.
</li>
</ol>
</div>
</li>
<li class="listitem">
<p>Save the rule with or without activation.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>When you activate a rule, it is queued and its schedule is determined by
its initial run time. For example, if you activate a rule that runs every 5
minutes at 14:03 but it does not run until 14:04, it will run again at 14:09.</p>
</div>
</div>
</li>
</ol>
</div>
<h4><a id="rule-action-variables"></a>Notification placeholders<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/stack-docs/edit/7.7/docs/en/siem/detections/rules-ui-create.asciidoc">edit</a></h4>
<p>These placeholders can be added to <a class="xref" href="rules-ui-create.html#rule-actions">rule action</a> fields:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">{{state.signals_count}}</code>: Number of signals detected
</li>
<li class="listitem">
<code class="literal">{{{context.results_link}}}</code>: URL to the signals in Kibana
</li>
<li class="listitem">
<code class="literal">{{context.rule.anomaly_threshold}}</code>: Anomaly threshold score above which
signals are generated (machine learning rules only)
</li>
<li class="listitem">
<code class="literal">{{context.rule.description}}</code>: Rule description
</li>
<li class="listitem">
<code class="literal">{{context.rule.false_positives}}</code>: Rule false positives
</li>
<li class="listitem">
<code class="literal">{{context.rule.filters}}</code>: Rule filters (query-based rules only)
</li>
<li class="listitem">
<code class="literal">{{context.rule.id}}</code>: Unique rule ID returned after creating the rule
</li>
<li class="listitem">
<code class="literal">{{context.rule.index}}</code>: Indices rule runs on (query-based rules only)
</li>
<li class="listitem">
<code class="literal">{{context.rule.language}}</code>: Rule query language (query-based rules only)
</li>
<li class="listitem">
<code class="literal">{{context.rule.machine_learning_job_id}}</code>: ID of associated machine learning job (machine learning
rules only)
</li>
<li class="listitem">
<code class="literal">{{context.rule.max_signals}}</code>: Maximum allowed number of signals per rule
execution
</li>
<li class="listitem">
<code class="literal">{{context.rule.name}}</code>: Rule name
</li>
<li class="listitem">
<code class="literal">{{context.rule.output_index}}</code>: Index to which signals are written
</li>
<li class="listitem">
<code class="literal">{{context.rule.query}}</code>: Rule query (query-based rules only)
</li>
<li class="listitem">
<code class="literal">{{context.rule.references}}</code>: Rule references
</li>
<li class="listitem">
<code class="literal">{{context.rule.risk_score}}</code>: Rule risk score
</li>
<li class="listitem">
<code class="literal">{{context.rule.rule_id}}</code>: Generated or user-defined rule ID that can be
used as an identifier across systems
</li>
<li class="listitem">
<code class="literal">{{context.rule.saved_id}}</code>: Saved search ID
</li>
<li class="listitem">
<code class="literal">{{context.rule.severity}}</code>: Rule severity
</li>
<li class="listitem">
<code class="literal">{{context.rule.threat}}</code>: Rule threat framework
</li>
<li class="listitem">
<code class="literal">{{context.rule.timeline_id}}</code>: Associated timeline ID
</li>
<li class="listitem">
<code class="literal">{{context.rule.timeline_title}}</code>: Associated timeline name
</li>
<li class="listitem">
<code class="literal">{{context.rule.type}}</code>: Rule type
</li>
<li class="listitem">
<code class="literal">{{context.rule.version}}</code>: Rule version
</li>
</ul>
</div>
<h3><a id="manage-rules-ui"></a>Modify existing rules<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/stack-docs/edit/7.7/docs/en/siem/detections/rules-ui-create.asciidoc">edit</a></h3>
<p>You can clone, edit, activate, deactivate, and delete rules:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Go to <span class="strong strong"><strong>SIEM</strong></span> &#8594; <span class="strong strong"><strong>Detections</strong></span> &#8594; <span class="strong strong"><strong>Manage signal detection rules</strong></span>.
</li>
<li class="listitem">
<p>Do one of the following:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Click the actions icon (three dots) and then select the required action.
</li>
<li class="listitem">
In the <span class="strong strong"><strong>Rule</strong></span> column, select all the rules you want to modify, and then the
required action from the <code class="literal">Bulk actions</code> menu.
</li>
</ul>
</div>
</li>
<li class="listitem">
To activate or deactivate a rule, click the Activate toggle button.
</li>
</ol>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>For prebuilt rules, you can only activate, deactivate, delete, and edit
<a class="xref" href="rules-ui-create.html#rule-actions">rule actions</a>.</p>
</div>
</div>
<h3><a id="monitor-rule-exe"></a>Monitor all rule executions<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/stack-docs/edit/7.7/docs/en/siem/detections/rules-ui-create.asciidoc">edit</a></h3>
<p>To view a summary of all rule executions, such as failures and last execution
times, click the Monitoring tab in the <span class="strong strong"><strong>All rules</strong></span> table (<span class="strong strong"><strong>SIEM</strong></span> &#8594;
<span class="strong strong"><strong>Detections</strong></span> &#8594; <span class="strong strong"><strong>Manage signal detection rules</strong></span>).</p>
<p>For detailed information on a rule, its produced signals, and errors, click on
a rule name in the <span class="strong strong"><strong>All rules</strong></span> table.</p>
<h3><a id="import-export-rules-ui"></a>Import and export rules<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/stack-docs/edit/7.7/docs/en/siem/detections/rules-ui-create.asciidoc">edit</a></h3>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Go to <span class="strong strong"><strong>SIEM</strong></span> &#8594; <span class="strong strong"><strong>Detections</strong></span> &#8594; <span class="strong strong"><strong>Manage signal detection rules</strong></span>.
</li>
<li class="listitem">
<p>To import rules:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Click <span class="strong strong"><strong>Import rule</strong></span>.
</li>
<li class="listitem">
<p>Drag-and-drop files containing the signal detection rules.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Imported rules must be in an <code class="literal">ndjson</code> file.</p>
</div>
</div>
</li>
</ol>
</div>
</li>
<li class="listitem">
<p>To export rules:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
In the <span class="strong strong"><strong>All rules</strong></span> table, select the rules you want to export.
</li>
<li class="listitem">
<p>Select <span class="strong strong"><strong>Bulk actions</strong></span> &#8594; <span class="strong strong"><strong>Export selected</strong></span>.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>You cannot export prebuilt rules.</p>
</div>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
<h3><a id="troubleshoot-signals"></a>Troubleshoot missing signals<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/stack-docs/edit/7.7/docs/en/siem/detections/rules-ui-create.asciidoc">edit</a></h3>
<p>When a rule fails to run close to its scheduled time, some signals may be
missing. There are a number of steps you can perform to try and resolve this
issue.</p>
<p>If you see <code class="literal">Gaps</code> in the All rules table or on the Rule details page
for a small number of rules, you can increase those rules'
<code class="literal">Additional look-back time</code> (<span class="strong strong"><strong>Signal detection rules</strong></span> page &#8594; the rule&#8217;s
actions icon &#8594; <span class="strong strong"><strong>Edit rule settings</strong></span> &#8594; <span class="strong strong"><strong>Schedule</strong></span> &#8594; <em>Additional look-back time</em>).</p>
<p>If you see gaps for a lot of rules:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If you restarted Kibana when many rules were activated, try deactivating them
and then reactivating them in small batches at staggered intervals. This
ensures Kibana does not attempt to run all the rules at the same time.
</li>
<li class="listitem">
Consider adding another Kibana instance to your environment.
</li>
</ul>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="detection-engine-overview.html">« Detections (beta)</a>
</span>
<span class="next">
<a href="prebuilt-rules.html">Prebuilt rule reference »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>
                <div class="col-xs-12 col-sm-4 col-md-4" id="right_col">
                  <div id="rtpcontainer" style="display: block;">
                    <div class="mktg-promo">
                      <h3>Most Popular</h3>
                      <ul class="icons">
                        <li class="icon-elasticsearch-white"><a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">Get Started with Elasticsearch: Video</a></li>
                        <li class="icon-kibana-white"><a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">Intro to Kibana: Video</a></li>
                        <li class="icon-logstash-white"><a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">ELK for Logs & Metrics: Video</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";
	var localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}';
</script>
<script src="/static/js/swiftype_app_search.umd.min.js"></script>
<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
