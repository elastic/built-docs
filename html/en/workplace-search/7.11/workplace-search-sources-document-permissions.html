<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>Managing Document Access &amp; Permissions for Content Sources | Workplace Search Guide [7.11] | Elastic</title>
<link rel="home" href="index.html" title="Workplace Search Guide [7.11]"/>
<link rel="up" href="workplace-search-permissions.html" title="Permissions &amp; Access Control"/>
<link rel="prev" href="workplace-search-permissions.html" title="Permissions &amp; Access Control"/>
<link rel="next" href="workplace-search-document-permissions.html" title="Defining Document Permissions for custom sources"/>
<meta name="DC.type" content="Learn/Docs/Workplace Search/Guide/7.11"/>
<meta name="DC.subject" content="Workplace Search"/>
<meta name="DC.identifier" content="7.11"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="apple-touch-icon" sizes="57x57" href="/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-icon-180x180.png">
    <link rel="icon" type="image/png" href="/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/android-chrome-192x192.png" sizes="192x192">
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
    <link rel="icon" type="image/png" href="/favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://www.elastic.co/static/images/elastic-logo-200.png" />
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="apple-touch-icon-precomposed" sizes="64x64" href="/favicon_64x64_16bit.png">
    <link rel="apple-touch-icon-precomposed" sizes="32x32" href="/favicon_32x32.png">
    <link rel="apple-touch-icon-precomposed" sizes="16x16" href="/favicon_16x16.png">
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles.css" />
  </head>

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->
    
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!--BEGIN QUALTRICS WEBSITE FEEDBACK SNIPPET-->
    <script type='text/javascript'>
      (function(){var g=function(e,h,f,g){
      this.get=function(a){for(var a=a+"=",c=document.cookie.split(";"),b=0,e=c.length;b<e;b++){for(var d=c[b];" "==d.charAt(0);)d=d.substring(1,d.length);if(0==d.indexOf(a))return d.substring(a.length,d.length)}return null};
      this.set=function(a,c){var b="",b=new Date;b.setTime(b.getTime()+6048E5);b="; expires="+b.toGMTString();document.cookie=a+"="+c+b+"; path=/; "};
      this.check=function(){var a=this.get(f);if(a)a=a.split(":");else if(100!=e)"v"==h&&(e=Math.random()>=e/100?0:100),a=[h,e,0],this.set(f,a.join(":"));else return!0;var c=a[1];if(100==c)return!0;switch(a[0]){case "v":return!1;case "r":return c=a[2]%Math.floor(100/c),a[2]++,this.set(f,a.join(":")),!c}return!0};
      this.go=function(){if(this.check()){var a=document.createElement("script");a.type="text/javascript";a.src=g;document.body&&document.body.appendChild(a)}};
      this.start=function(){var a=this;window.addEventListener?window.addEventListener("load",function(){a.go()},!1):window.attachEvent&&window.attachEvent("onload",function(){a.go()})}};
      try{(new g(100,"r","QSI_S_ZN_emkP0oSe9Qrn7kF","https://znemkp0ose9qrn7kf-elastic.siteintercept.qualtrics.com/WRSiteInterceptEngine/?Q_ZID=ZN_emkP0oSe9Qrn7kF")).start()}catch(i){}})();
    </script><div id='ZN_emkP0oSe9Qrn7kF'><!--DO NOT REMOVE-CONTENTS PLACED HERE--></div>
    <!--END WEBSITE FEEDBACK SNIPPET-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <!-- Subnav -->
    <div>
      <div>
        <div class="tertiary-nav d-none d-md-block">
          <div class="container">
            <div class="p-t-b-15 d-flex justify-content-between nav-container">
              <div class="breadcrum-wrapper"><span><a href="/guide/" style="font-size: 14px; font-weight: 600; color: #000;">Docs</a></span></div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container">
              <div class="row">
                <div class="col-xs-12 col-sm-8 col-md-8 guide-section">
                  <!-- start body -->
                  <div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Workplace Search Guide [7.11]</a></span>
»
<span class="breadcrumb-link"><a href="workplace-search-permissions.html">Permissions &amp; Access Control</a></span>
»
<span class="breadcrumb-node">Managing Document Access &amp; Permissions for Content Sources</span>
</div>
<div class="navheader">
<span class="prev">
<a href="workplace-search-permissions.html">« Permissions &amp; Access Control</a>
</span>
<span class="next">
<a href="workplace-search-document-permissions.html">Defining Document Permissions for custom sources »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="workplace-search-sources-document-permissions"></a>Managing Document Access &amp; Permissions for Content Sources<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/7.11/workplace-search-docs/guides/permissions/sources-document-permissions.asciidoc">edit</a></h2>
</div></div></div>

<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The following guide applies to <span class="strong strong"><strong>first-party content sources</strong></span>. For more information on custom sources, visit the <a class="xref" href="workplace-search-document-permissions.html" title="Defining Document Permissions for custom sources">Document permissions for custom sources</a> guide.</p>
</div>
</div>
<p>Workplace Search can associate its notion of a user to a third-party&#8217;s, and in doing so limit access to documents. If a person has certain permissions on Google Drive, for example, you can associate their Google Drive user via the <a class="xref" href="workplace-search-external-identities-api.html" title="External Identities API Reference">External Identities API reference</a> to their Workplace Search user. When their Workplace Search user tries to search, their permissions are honoured. As a result, they will see documents they can see and <span class="strong strong"><strong>not</strong></span> see documents which they cannot.</p>
<p>This guide will walk you through how to do so with each supporting third-party.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_first_party_content_sources"></a>First-party content sources<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/7.11/workplace-search-docs/guides/permissions/sources-document-permissions.asciidoc">edit</a></h3>
</div></div></div>
<p>Document permission synchronization can be enabled for sources when connecting an instance to Workplace Search.</p>
<p>We support document permission synchronization within:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="workplace-search-sources-document-permissions.html#sources-permissions-google" title="Document-level permissions for Google">Document-level permissions for Google</a>: Google Drive
</li>
<li class="listitem">
<a class="xref" href="workplace-search-sources-document-permissions.html#sources-permissions-microsoft" title="Document-level permissions for Microsoft">Document-level permissions for Microsoft</a>: SharePoint Online &amp; OneDrive
</li>
</ul>
</div>
<p>Once activated during connector setup, document access for a user must be mapped to Workplace Search&#8217;s notion of that user. Use the <a class="xref" href="workplace-search-external-identities-api.html" title="External Identities API Reference">External Identities API reference</a>, to provide the external <code class="literal">source_user_id</code> and link it to its associated Workplace Search <code class="literal">user</code>:</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
	"source_user_id": "john.doe@example.com",
	"user": "john.doe"
}</pre>
</div>
<p>The above example would link Google&#8217;s notion of <code class="literal">john.doe@example.com</code> and Workplace Search&#8217;s notion of <code class="literal">john.doe</code> as the same entity. Permissions are then synchronized between these entities, restricting or enabling access to documents. Different content sources will expose their notion of a user in different ways.</p>
<h5><a id="sources-permissions-google"></a>Document-level permissions for Google<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/7.11/workplace-search-docs/guides/permissions/sources-document-permissions.asciidoc">edit</a></h5>
<p>Applies to Google Drive.</p>
<p>Google attributes an <code class="literal">id</code> to each user.</p>
<p>The <code class="literal">id</code> is a string, a person&#8217;s email: <code class="literal">personal.person@example.com</code></p>
<p>You can retrieve a comma separated list in CSV format from Google. Read <a href="https://support.google.com/a/answer/9772903?hl=en" class="ulink" target="_top">Google documentation</a>. An example query to the <a class="xref" href="workplace-search-external-identities-api.html" title="External Identities API Reference">External Identities API reference</a> that takes a person&#8217;s Google&#8217;s <code class="literal">id</code> and associates it with their Workplace Search user looks as follows:</p>
<div class="pre_wrapper lang-bash">
<pre class="programlisting prettyprint lang-bash">curl -X POST http://localhost:3002/api/ws/v1/sources/[CONTENT_SOURCE_ID]/external_identities \
-H "Authorization: Bearer [ACCESS_TOKEN]" \
-H "Content-Type: application/json" \
-d '{
  "user": "personal.person",
  "source_user_id": "personal.person@example.com"
}'</pre>
</div>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
  "user": "personal.person",
  "source_user_id": "personal.person@example.com"
}</pre>
</div>
<h5><a id="sources-permissions-microsoft"></a>Document-level permissions for Microsoft<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/7.11/workplace-search-docs/guides/permissions/sources-document-permissions.asciidoc">edit</a></h5>
<p>Applies to: OneDrive and SharePoint Online</p>
<p>Workplace Search can synchronize with Microsoft Office 365 Groups.</p>
<p>Microsoft attributes an <code class="literal">Id</code> to each user.</p>
<p>The <code class="literal">Id</code> is a string, it looks something like this: <code class="literal">32ad7bda-3de1-4a77-ee97-f3476c2cf58d</code>.</p>
<p>Associate the <code class="literal">Id</code> string with a Workplace Search user using the <a class="xref" href="workplace-search-external-identities-api.html" title="External Identities API Reference">External Identities API reference</a>. You can get a list of user ``Id``s by visiting the Users section of <a href="https://admin.microsoft.com/Adminportal/Home?source=applauncher#/users" class="ulink" target="_top">Microsoft Admin</a>. From there, select the user&#8217;s you would like to map, then click <span class="strong strong"><strong>Export Users</strong></span>.</p>
<p>An example query to the <a class="xref" href="workplace-search-external-identities-api.html" title="External Identities API Reference">External Identities API reference</a> that takes a person&#8217;s Microsoft Office 365 Group <code class="literal">Id</code> and associates it with their Workplace Search user:</p>
<div class="pre_wrapper lang-bash">
<pre class="programlisting prettyprint lang-bash">curl -X POST http://localhost:3002/api/ws/v1/sources/[CONTENT_SOURCE_ID]/external_identities \
-H "Authorization: Bearer [ACCESS_TOKEN]" \
-H "Content-Type: application/json" \
-d '{
  "user": "firstname.lastname",
  "source_user_id": "string"
}'</pre>
</div>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
  "source_user_id": "string",
  "user": "firstname.lastname"
}</pre>
</div>
<p>Please note that SharePoint Online is nuanced and has a limitation.</p>
<p>SharePoint Online has the concept of a "Members" group that SharePoint Online manages itself. The API endpoints for the "Visitors" and "Owners" groups within their grouping system cannot be accessed via API. Therefore, if you are trying to grant access using those groups, it will not work&#8201;&#8212;&#8201;Workplace Search cannot understand them. We recommend creating the equivalent groups in Office 365 Groups and use that to map instead.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_custom_sources"></a>Custom sources<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/7.11/workplace-search-docs/guides/permissions/sources-document-permissions.asciidoc">edit</a></h3>
</div></div></div>
<p>custom sources allow you to ingest document access information using the <code class="literal">_allow_permissions</code> and <code class="literal">_deny_permissions</code> fields. For more information, refer to <a class="xref" href="workplace-search-custom-api-sources.html" title="Connecting custom sources">Custom API sources</a> guide.</p>
<hr>
<p>Further reading:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="workplace-search-enabling-private-sources.html" title="Enabling private content sources">Enabling private content sources</a>
</li>
<li class="listitem">
<a class="xref" href="workplace-search-document-permissions.html" title="Defining Document Permissions for custom sources">Document permissions for custom sources</a>
</li>
<li class="listitem">
<a class="xref" href="workplace-search-external-identities-api.html" title="External Identities API Reference">External Identities API reference</a>
</li>
<li class="listitem">
<a class="xref" href="workplace-search-content-sources.html" title="Content Sources Overview"><em>Content sources</em></a>
</li>
<li class="listitem">
<a class="xref" href="workplace-search-custom-api-sources.html" title="Connecting custom sources">Custom API sources</a>
</li>
</ul>
</div>
<hr>
<p>The following sections have moved:</p>
<p><a id="sources-permissions-org-private"></a><em>Organizational Sources and Private Sources</em> → <a class="xref" href="workplace-search-permissions.html#organizational-sources-private-sources" title="Organizational Sources and Private Sources">Organizational Sources and Private Sources</a></p>
<p><a id="sources-permissions-strategy"></a><em>Which strategy should I choose?</em> → <a class="xref" href="workplace-search-permissions.html#permissions-strategy" title="Which strategy should I choose?">Which strategy should I choose?</a></p>
<p><a id="sources-permissions-private-sources"></a><em>Enabling private sources</em> → <a class="xref" href="workplace-search-enabling-private-sources.html" title="Enabling private content sources">Enabling private content sources</a></p>
<p><a id="sources-permissions-private-sources-enabling-remote"></a><em>Enabling Private Sources for Remote Content Sources</em> → <a class="xref" href="workplace-search-enabling-private-sources.html#enabling-private-sources-remote" title="Enabling private sources for remote content sources">Enabling private sources for remote content sources</a></p>
<p><a id="sources-permissions-private-sources-enabling-standard"></a><em>Enabling Private Sources for Standard Content Sources</em> → <a class="xref" href="workplace-search-enabling-private-sources.html#enabling-private-sources-standard" title="Enabling private sources for standard content sources">Enabling private sources for standard content sources</a></p>
</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="workplace-search-permissions.html">« Permissions &amp; Access Control</a>
</span>
<span class="next">
<a href="workplace-search-document-permissions.html">Defining Document Permissions for custom sources »</a>
</span>
</div>
</div>

                  <!-- end body -->
                </div>
                <div class="col-xs-12 col-sm-4 col-md-4" id="right_col">
                  <div id="rtpcontainer" style="display: block;">
                    <div class="mktg-promo">
                      <h3>Most Popular</h3>
                      <ul class="icons">
                        <li class="icon-elasticsearch-white"><a href="https://www.elastic.co/webinars/getting-started-elasticsearch?baymax=default&elektra=docs&storm=top-video">Get Started with Elasticsearch: Video</a></li>
                        <li class="icon-kibana-white"><a href="https://www.elastic.co/webinars/getting-started-kibana?baymax=default&elektra=docs&storm=top-video">Intro to Kibana: Video</a></li>
                        <li class="icon-logstash-white"><a href="https://www.elastic.co/webinars/introduction-elk-stack?baymax=default&elektra=docs&storm=top-video">ELK for Logs & Metrics: Video</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


<div id='elastic-footer'></div>
<script src='https://www.elastic.co/elastic-footer.js'></script>
<!-- Footer Section end-->

      </section>
    </div>

<script type="text/javascript">
	var suggestionsUrl = "https://search.elastic.co/suggest";
	var localeUrl = '{"relative_url_prefix":"/","code":"en-us","display_code":"en-us","url":"/guide_template"}';
</script>
<script src="/static/js/swiftype_app_search.umd.min.js"></script>
<script src="/guide/static/jquery.js"></script>
<script type="text/javascript" src="/guide/static/docs.js"></script>
<script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
