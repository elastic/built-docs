<!DOCTYPE html>
<html lang="en-us">
  <head>
    
<meta charset="UTF-8">
<title>api_key.* configuration options | APM Server Reference [7.7] | Elastic</title>
<meta class="elastic" name="content" content="api_key.* configuration options | APM Server Reference [7.7]">

<link rel="home" href="index.html" title="APM Server Reference [7.7]"/>
<link rel="up" href="secure-communication-agents.html" title="Secure communication with APM Agents"/>
<link rel="prev" href="api-key.html" title="API keys"/>
<link rel="next" href="secret-token.html" title="Secret token"/>
<meta class="elastic" name="product_version" content="7.7"/>
<meta class="elastic" name="product_name" content="APM"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/APM Server/Reference/7.7"/>
<meta name="DC.subject" content="APM"/>
<meta name="DC.identifier" content="7.7"/>
<meta name="robots" content="noindex,nofollow"/>

    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://cdn.optimizely.com/js/18132920325.js"></script>
    <link rel="icon" href="/favicon.ico" sizes="32x32"/>
    <link rel="icon" href="/favicon.svg" type="image/svg+xml"/>
    <link rel="apple-touch-icon" href="/apple-touch-icon.png" sizes="180x180"/>
    <link rel="manifest" href="/manifest.json">
    <meta name="apple-mobile-web-app-title" content="Elastic">
    <meta name="application-name" content="Elastic">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="/mstile-144x144.png">
    <meta name="theme-color" content="#ffffff">
    <meta name="naver-site-verification" content="936882c1853b701b3cef3721758d80535413dbfd" />
    <meta name="yandex-verification" content="d8a47e95d0972434" />
    <meta name="localized" content="true" />
    <meta name="st:robots" content="follow,index" />
    <meta property="og:image" content="https://static-www.elastic.co/v3/assets/bltefdd0b53724fa2ce/blt280217a63b82a734/6202d3378b1f312528798412/elastic-logo.svg" />
    <meta property="og:image:width" content="500" />
    <meta property="og:image:height" content="172" />
    <!-- Give IE8 a fighting chance -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <link rel="stylesheet" type="text/css" href="/guide/static/styles-v1.css" />
  </head>

  <!--© 2015-2025 Elasticsearch B.V. -->
  <!-- All Elastic documentation is licensed under a Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License. -->
  <!-- http://creativecommons.org/licenses/by-nc-nd/4.0/ -->

  <body>
    <!-- Google Tag Manager -->
    <script>dataLayer = [];</script><noscript><iframe src="//www.googletagmanager.com/ns.html?id=GTM-58RLH5" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src= '//www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-58RLH5');</script>
    <!-- End Google Tag Manager -->

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-16"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'UA-12395217-16');
    </script>

    <!-- Google Tag Manager for GA4 -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KNJMG2M');</script>
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KNJMG2M" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager for GA4-->

    <div id='elastic-nav' style="display:none;"></div>
    <script src='https://www.elastic.co/elastic-nav.js'></script>

    <div class="main-container">
      <section id="content" >
        <div class="content-wrapper">

          <section id="guide" lang="en">
            <div class="container-fluid">
              <div class="row pb-3">
                <div class="col-12 order-2 col-md-4 order-md-1 col-lg-3 h-almost-full-md sticky-top-md" id="left_col">
                  <!-- The TOC is appended here -->
                </div>

                <div class="col-12 order-1 col-md-8 order-md-2 col-lg-7 order-lg-2 guide-section" id="middle_col">
                  <!-- start body -->
                  
<div class="page_header">
A newer version is available. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div class="navheader">
<span class="prev">
<a href="api-key.html">« API keys</a>
</span>
<span class="next">
<a href="secret-token.html">Secret token »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link">
  <div id="related-products" class="dropdown">
  <div class="related-products-title">APM:</div>
  <div class="dropdown-anchor" tabindex="0">Server Reference<span class="dropdown-icon"></span></div>
  <div class="dropdown-content">
  <ul>
  <li class="dropdown-category">APM</li>
  <ul>
  <li><a href="/guide/en/observability/current/apm.html">Observability › APM</a></li>
  </ul>
  <li class="dropdown-category">APM agents</li>
  <ul>
  <li><a href="/guide/en/apm/agent/android/current/intro.html">Android Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/go/current/introduction.html">Go Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/swift/current/intro.html">iOS Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/java/current/intro.html">Java Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/dotnet/current/intro.html">.NET Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/nodejs/current/intro.html">Node.js Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/php/current/intro.html">PHP Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/python/current/getting-started.html">Python Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/ruby/current/introduction.html">Ruby Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/rum-js/current/intro.html">Real User Monitoring JavaScript Agent Reference</a></li>
  </ul>
  <li class="dropdown-category">APM extensions</li>
  <ul>
  <li><a href="/guide/en/apm/lambda/current/aws-lambda-arch.html">AWS Lambda extension</a></li>
  <li><a href="/guide/en/apm/attacher/current/apm-attacher.html">Attacher</a></li>
  </ul>
  </ul>
  </div>
  </div>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="securing-apm-server.html">Secure APM Server</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="secure-communication-agents.html">Secure communication with APM Agents</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>api_key.* configuration options</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/7.7/docs/secure-communication-agents.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div id="url-to-v3" class="version-warning">
    <strong>IMPORTANT</strong>: This documentation is no longer updated. Refer to <a href="https://www.elastic.co/support/eol">Elastic's version policy</a> and the <a href="https://www.elastic.co/docs">latest documentation</a>.
</div>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="api-key-settings"></a><code class="literal">api_key.*</code> configuration options</h2><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/7.7/docs/secure-communication-agents.asciidoc">edit</a></div>
</div></div></div>
<p>You can specify the following options in the <code class="literal">apm-server.api_key.*</code> section of the
<code class="literal">apm-server.yml</code> configuration file.
They apply to API key communication between the APM Server and APM Agents.</p>
<p>These are different from the API key settings used for the Elasticsearch output and monitoring.</p>
<div class="position-relative"><h5><a id="_enabled_9"></a><code class="literal">enabled</code></h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/7.7/docs/secure-communication-agents.asciidoc">edit</a></div>
<p>Enable API key authorization by setting <code class="literal">enabled</code> to <code class="literal">true</code>.
Agents will include a valid API key in the following format: <code class="literal">Authorization: ApiKey &lt;token&gt;</code>.
The key must be the base64 encoded representation of the API key&#8217;s <code class="literal">id:name</code>.
By default, <code class="literal">enabled</code> is set to <code class="literal">false</code>, and API key support is disabled.</p>
<div class="position-relative"><h5><a id="_limit"></a><code class="literal">limit</code></h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/7.7/docs/secure-communication-agents.asciidoc">edit</a></div>
<p>Each unique API key triggers one request to Elasticsearch.
This setting restricts the number of unique API keys are allowed per minute.
The minimum value for this setting should be the number of API keys configured in your monitored services.
The default <code class="literal">limit</code> is <code class="literal">100</code>.</p>
<div class="position-relative"><h3><a id="_api_key_elasticsearch_configuration_options"></a><code class="literal">api_key.elasticsearch.*</code> configuration options</h3><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/7.7/docs/secure-communication-agents.asciidoc">edit</a></div>
<p>All of the <code class="literal">api_key.elasticsearch.*</code> configurations are optional.
If none are set, configuration settings from the <code class="literal">apm-server.output</code> section will be reused.</p>
<div class="position-relative"><h5><a id="_elasticsearch_hosts"></a><code class="literal">elasticsearch.hosts</code></h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/7.7/docs/secure-communication-agents.asciidoc">edit</a></div>
<p>API keys are fetched from Elasticsearch.
This configuration needs to point to a secured Elasticsearch cluster that is able to serve API key requests.</p>
<div class="position-relative"><h5><a id="_elasticsearch_protocol"></a><code class="literal">elasticsearch.protocol</code></h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/7.7/docs/secure-communication-agents.asciidoc">edit</a></div>
<p>The name of the protocol Elasticsearch is reachable on.
The options are: <code class="literal">http</code> or <code class="literal">https</code>. The default is <code class="literal">http</code>.
If nothing is configured, configuration settings from the <code class="literal">output</code> section will be reused.</p>
<div class="position-relative"><h5><a id="_elasticsearch_path"></a><code class="literal">elasticsearch.path</code></h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/7.7/docs/secure-communication-agents.asciidoc">edit</a></div>
<p>An optional HTTP path prefix that is prepended to the HTTP API calls.
If nothing is configured, configuration settings from the <code class="literal">output</code> section will be reused.</p>
<div class="position-relative"><h5><a id="_elasticsearch_proxy_url"></a><code class="literal">elasticsearch.proxy_url</code></h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/7.7/docs/secure-communication-agents.asciidoc">edit</a></div>
<p>The URL of the proxy to use when connecting to the Elasticsearch servers.
The value may be either a complete URL or a "host[:port]", in which case the "http"scheme is assumed.
If nothing is configured, configuration settings from the <code class="literal">output</code> section will be reused.</p>
<div class="position-relative"><h5><a id="_elasticsearch_timeout"></a><code class="literal">elasticsearch.timeout</code></h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/7.7/docs/secure-communication-agents.asciidoc">edit</a></div>
<p>The http request timeout in seconds for the Elasticsearch request.
If nothing is configured, configuration settings from the <code class="literal">output</code> section will be reused.</p>
<div class="position-relative"><h4><a id="_api_key_elasticsearch_ssl_configuration_options"></a><code class="literal">api_key.elasticsearch.ssl.*</code> configuration options</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/7.7/docs/secure-communication-agents.asciidoc">edit</a></div>
<p>SSL is off by default. Set <code class="literal">elasticsearch.protocol</code> to <code class="literal">https</code> if you want to enable <code class="literal">https</code>.</p>
<div class="position-relative"><h5><a id="_elasticsearch_ssl_enabled"></a><code class="literal">elasticsearch.ssl.enabled</code></h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/7.7/docs/secure-communication-agents.asciidoc">edit</a></div>
<p>Enable custom SSL settings.
Set to false to ignore custom SSL settings for secure communication.</p>
<div class="position-relative"><h5><a id="_elasticsearch_ssl_verification_mode"></a><code class="literal">elasticsearch.ssl.verification_mode</code></h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/7.7/docs/secure-communication-agents.asciidoc">edit</a></div>
<p>Configure SSL verification mode.
If <code class="literal">none</code> is configured, all server hosts and certificates will be accepted.
In this mode, SSL based connections are susceptible to man-in-the-middle attacks.
<span class="strong strong"><strong>Use only for testing</strong></span>. Default is <code class="literal">full</code>.</p>
<div class="position-relative"><h5><a id="_elasticsearch_ssl_supported_protocols"></a><code class="literal">elasticsearch.ssl.supported_protocols</code></h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/7.7/docs/secure-communication-agents.asciidoc">edit</a></div>
<p>List of supported/valid TLS versions.
By default, all TLS versions from 1.0 to 1.2 are enabled.</p>
<div class="position-relative"><h5><a id="_elasticsearch_ssl_certificate_authorities"></a><code class="literal">elasticsearch.ssl.certificate_authorities</code></h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/7.7/docs/secure-communication-agents.asciidoc">edit</a></div>
<p>List of root certificates for HTTPS server verifications.</p>
<div class="position-relative"><h5><a id="_elasticsearch_ssl_certificate"></a><code class="literal">elasticsearch.ssl.certificate</code></h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/7.7/docs/secure-communication-agents.asciidoc">edit</a></div>
<p>The path to the certificate for SSL client authentication.</p>
<div class="position-relative"><h5><a id="_elasticsearch_ssl_key"></a><code class="literal">elasticsearch.ssl.key</code></h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/7.7/docs/secure-communication-agents.asciidoc">edit</a></div>
<p>The client certificate key used for client authentication.
This option is required if certificate is specified.</p>
<div class="position-relative"><h5><a id="_elasticsearch_ssl_key_passphrase"></a><code class="literal">elasticsearch.ssl.key_passphrase</code></h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/7.7/docs/secure-communication-agents.asciidoc">edit</a></div>
<p>An optional passphrase used to decrypt an encrypted key stored in the configured key file.
It is recommended to use the provided keystore instead of entering the passphrase in plain text.</p>
<div class="position-relative"><h5><a id="_elasticsearch_ssl_cipher_suites"></a><code class="literal">elasticsearch.ssl.cipher_suites</code></h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/7.7/docs/secure-communication-agents.asciidoc">edit</a></div>
<p>The list of cipher suites to use. The first entry has the highest priority.
If this option is omitted, the Go crypto library’s default suites are used (recommended).</p>
<div class="position-relative"><h5><a id="_elasticsearch_ssl_curve_types"></a><code class="literal">elasticsearch.ssl.curve_types</code></h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/7.7/docs/secure-communication-agents.asciidoc">edit</a></div>
<p>The list of curve types for ECDHE (Elliptic Curve Diffie-Hellman ephemeral key exchange).</p>
<div class="position-relative"><h5><a id="_elasticsearch_ssl_renegotiation"></a><code class="literal">elasticsearch.ssl.renegotiation</code></h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/7.7/docs/secure-communication-agents.asciidoc">edit</a></div>
<p>Configure what types of renegotiation are supported.
Valid options are <code class="literal">never</code>, <code class="literal">once</code>, and <code class="literal">freely</code>. Default is <code class="literal">never</code>.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">never</code> - Disables renegotiation.
</li>
<li class="listitem">
<code class="literal">once</code> - Allows a remote server to request renegotiation once per connection.
</li>
<li class="listitem">
<code class="literal">freely</code> - Allows a remote server to repeatedly request renegotiation.
</li>
</ul>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="api-key.html">« API keys</a>
</span>
<span class="next">
<a href="secret-token.html">Secret token »</a>
</span>
</div>

                  <!-- end body -->
                </div>

                <div class="col-12 order-3 col-lg-2 order-lg-3 h-almost-full-lg sticky-top-lg" id="right_col">
                  <div id="sticky_content">
                    <!-- The OTP is appended here -->
                    <div class="row">
                      <div class="col-0 col-md-4 col-lg-0" id="bottom_left_col"></div>
                      <div class="col-12 col-md-8 col-lg-12">
                        <div id="rtpcontainer">
                          <div class="mktg-promo" id="most-popular">
                            <p class="aside-heading">Most Popular</p>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-elasticsearch?page=docs&placement=top-video">
                                <p class="mb-0">Get Started with Elasticsearch</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/getting-started-kibana?page=docs&placement=top-video">
                                <p class="mb-0">Intro to Kibana</p>
                              </a>
                            </div>
                            <div class="pb-2">
                              <p class="media-type">Video</p>
                              <a href="https://www.elastic.co/webinars/introduction-elk-stack?page=docs&placement=top-video">
                                <p class="mb-0">ELK for Logs & Metrics</p>
                              </a>
                            </div>
                          </div>
                        </div>

                        <!-- Feedback widget -->
                        <div id="feedbackWidgetContainer"></div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </section>

        </div>


        <div id='elastic-footer'></div>
        <script src='https://www.elastic.co/elastic-footer.js'></script>
        <!-- Footer Section end-->

      </section>
    </div>

    <!-- Feedback modal -->
    <div id="feedbackModalContainer"></div>

    <script src="/guide/static/jquery.js"></script>
    <script type="text/javascript" src="/guide/static/docs-v1.js"></script>
    <script type="text/javascript">
  window.initial_state = {}</script>
  </body>
</html>
