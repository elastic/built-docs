<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Configuration | APM Go Agent Reference [2.x] | Elastic</title>
<meta class="elastic" name="content" content="Configuration | APM Go Agent Reference [2.x]">

<link rel="home" href="index.html" title="APM Go Agent Reference [2.x]"/>
<link rel="up" href="index.html" title="APM Go Agent Reference [2.x]"/>
<link rel="prev" href="supported-tech.html" title="Supported Technologies"/>
<link rel="next" href="api.html" title="API Documentation"/>
<meta class="elastic" name="product_version" content="2.x"/>
<meta class="elastic" name="product_name" content="APM"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/APM Go Agent/Reference/2.x"/>
<meta name="DC.subject" content="APM"/>
<meta name="DC.identifier" content="2.x"/>
</head>
<body>
<div class="navheader">
<span class="prev">
<a href="supported-tech.html">« Supported Technologies</a>
</span>
<span class="next">
<a href="api.html">API Documentation »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link">
  <div id="related-products" class="dropdown">
  <div class="related-products-title">APM:</div>
  <div class="dropdown-anchor" tabindex="0">Go Agent Reference<span class="dropdown-icon"></span></div>
  <div class="dropdown-content">
  <ul>
  <li class="dropdown-category">APM</li>
  <ul>
  <li><a href="/guide/en/observability/current/apm.html">Observability › APM</a></li>
  </ul>
  <li class="dropdown-category">APM agents</li>
  <ul>
  <li><a href="/guide/en/apm/agent/android/current/intro.html">Android Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/go/current/introduction.html">Go Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/swift/current/intro.html">iOS Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/java/current/intro.html">Java Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/dotnet/current/intro.html">.NET Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/nodejs/current/intro.html">Node.js Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/php/current/intro.html">PHP Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/python/current/getting-started.html">Python Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/ruby/current/introduction.html">Ruby Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/rum-js/current/intro.html">Real User Monitoring JavaScript Agent Reference</a></li>
  </ul>
  <li class="dropdown-category">APM extensions</li>
  <ul>
  <li><a href="/guide/en/apm/lambda/current/aws-lambda-arch.html">AWS Lambda extension</a></li>
  <li><a href="/guide/en/apm/attacher/current/apm-attacher.html">Attacher</a></li>
  </ul>
  </ul>
  </div>
  </div>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Configuration</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/2.x/docs/configuration.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="chapter">
<div class="titlepage"><div><div>
<h2 class="title"><a id="configuration"></a>Configuration<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/2.x/docs/configuration.asciidoc">edit</a></h2>
</div></div></div>
<p>Adapt the Elastic APM Go agent to your needs with one of the following methods&#8212;&#8203;listed in descending order of precedence:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<a href="/guide/en/kibana/8.15/agent-configuration.html" class="ulink" target="_top">APM Agent Configuration via Kibana</a>
(supported options are marked with <a class="xref" href="configuration.html#dynamic-configuration" title="Dynamic configuration"><span class="image"><img src="./images/dynamic-config.svg" alt="dynamic config"></span> </a>)
</li>
<li class="listitem">
In code, using the <a class="xref" href="api.html#tracer-config-api" title="Tracer Config">Tracer Config API</a>
</li>
<li class="listitem">
Environment variables
</li>
</ol>
</div>
<p>Configuration defined via Kibana will take precedence over the same
configuration defined in code, which takes precedence over environment
variables. If configuration is defined via Kibana, and then that is
later removed, the agent will revert to configuration defined locally
via either the Tracer Config API or environment variables.</p>
<p>To simplify development and testing,
the agent defaults to sending data to the Elastic APM Server at <code class="literal">http://localhost:8200</code>.
To send data to an alternative location, you must configure
<a class="xref" href="configuration.html#config-server-url" title="ELASTIC_APM_SERVER_URL">ELASTIC_APM_SERVER_URL</a>. Depending on the configuration
of your server, you may also need to set <a class="xref" href="configuration.html#config-api-key" title="ELASTIC_APM_API_KEY">ELASTIC_APM_API_KEY</a>,
<a class="xref" href="configuration.html#config-secret-token" title="ELASTIC_APM_SECRET_TOKEN">ELASTIC_APM_SECRET_TOKEN</a>, and
<a class="xref" href="configuration.html#config-verify-server-cert" title="ELASTIC_APM_VERIFY_SERVER_CERT">ELASTIC_APM_VERIFY_SERVER_CERT</a>. All other variables
have usable defaults.</p>
<h3><a id="dynamic-configuration"></a>Dynamic configuration<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/2.x/docs/configuration.asciidoc">edit</a></h3>
<p>Configuration options marked with the <span class="image"><img src="./images/dynamic-config.svg" alt="dynamic config"></span> badge can be changed at runtime
when set from a supported source.</p>
<p>The Go Agent supports <a href="/guide/en/kibana/8.15/agent-configuration.html" class="ulink" target="_top">Central configuration</a>,
which allows you to fine-tune certain configurations via the APM app.
This feature is enabled in the Agent by default, with <a class="xref" href="configuration.html#config-central-config" title="ELASTIC_APM_CENTRAL_CONFIG"><code class="literal">ELASTIC_APM_CENTRAL_CONFIG</code></a>.</p>
<h3><a id="_configuration_formats"></a>Configuration formats<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/2.x/docs/configuration.asciidoc">edit</a></h3>
<p>Some options require a unit, either duration or size. These need to be provided
in a specific format.</p>
<h4><a id="_duration_format"></a>Duration format<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/2.x/docs/configuration.asciidoc">edit</a></h4>
<p>The <em>duration</em> format is used for options like timeouts. The unit is provided as
a suffix directly after the number, without any whitespace.</p>
<p><span class="strong strong"><strong>Example:</strong></span> <code class="literal">5ms</code></p>
<p><span class="strong strong"><strong>Supported units:</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">ms</code> (milliseconds)
</li>
<li class="listitem">
<code class="literal">s</code> (seconds)
</li>
<li class="listitem">
<code class="literal">m</code> (minutes)
</li>
</ul>
</div>
<h4><a id="_size_format"></a>Size format<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/2.x/docs/configuration.asciidoc">edit</a></h4>
<p>The <em>size</em> format is used for options such as maximum buffer sizes. The unit is
provided as a suffix directly after the number, without any whitespace.</p>
<p><span class="strong strong"><strong>Example:</strong></span> <code class="literal">10KB</code></p>
<p><span class="strong strong"><strong>Supported units:</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
B (bytes)
</li>
<li class="listitem">
KB (kilobytes)
</li>
<li class="listitem">
MB (megabytes)
</li>
<li class="listitem">
GB (gigabytes)
</li>
</ul>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>We use the power-of-two sizing convention, e.g. 1KB = 1024B.</p>
</div>
</div>
<h3><a id="config-server-url"></a><code class="literal">ELASTIC_APM_SERVER_URL</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/2.x/docs/configuration.asciidoc">edit</a></h3>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Environment</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_SERVER_URL</code></p></td>
<td align="left" valign="top"><p><code class="literal">http://localhost:8200</code></p></td>
<td align="left" valign="top"><p><code class="literal">http://localhost:8200</code></p></td>
</tr>
</tbody>
</table>
</div>
<p>The URL for your Elastic APM Server. The Server supports both HTTP and HTTPS.
If you use HTTPS, then you may need to configure your client machines so
that the server certificate can be verified. You can disable certificate
verification with <a class="xref" href="configuration.html#config-verify-server-cert" title="ELASTIC_APM_VERIFY_SERVER_CERT"><code class="literal">ELASTIC_APM_VERIFY_SERVER_CERT</code></a>.</p>
<h3><a id="config-server-timeout"></a><code class="literal">ELASTIC_APM_SERVER_TIMEOUT</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/2.x/docs/configuration.asciidoc">edit</a></h3>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Environment</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_SERVER_TIMEOUT</code></p></td>
<td align="left" valign="top"><p><code class="literal">30s</code></p></td>
<td align="left" valign="top"><p><code class="literal">30s</code></p></td>
</tr>
</tbody>
</table>
</div>
<p>The timeout for requests made to your Elastic APM server. When set to zero
or a negative value, timeouts will be disabled.</p>
<h3><a id="config-secret-token"></a><code class="literal">ELASTIC_APM_SECRET_TOKEN</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/2.x/docs/configuration.asciidoc">edit</a></h3>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Environment</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_SECRET_TOKEN</code></p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>"A random string"</p></td>
</tr>
</tbody>
</table>
</div>
<p>This string is used to ensure that only your agents can send data to your APM server.
Both the agents and the APM server have to be configured with the same secret token.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>The secret token is sent as plain-text in every request to the server, so you
should also secure your communications using HTTPS. Unless you do so, your secret token
could be observed by an attacker.</p>
</div>
</div>
<h3><a id="config-api-key"></a><code class="literal">ELASTIC_APM_API_KEY</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/2.x/docs/configuration.asciidoc">edit</a></h3>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Environment</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_API_KEY</code></p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>"A base64-encoded string"</p></td>
</tr>
</tbody>
</table>
</div>
<p>This base64-encoded string is used to ensure that only your agents can send data to your APM server.
The API key must be created using the APM Server <a href="/guide/en/apm/guide/8.15/api-key.html" class="ulink" target="_top">command line tool</a>.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>The API Key is sent as plain-text in every request to the server, so you should also secure
your communications using HTTPS. Unless you do so, your API Key could be observed by an attacker.</p>
</div>
</div>
<h3><a id="config-service-name"></a><code class="literal">ELASTIC_APM_SERVICE_NAME</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/2.x/docs/configuration.asciidoc">edit</a></h3>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Environment</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_SERVICE_NAME</code></p></td>
<td align="left" valign="top"><p>Executable name</p></td>
<td align="left" valign="top"><p><code class="literal">my-app</code></p></td>
</tr>
</tbody>
</table>
</div>
<p>The name of your service or application.  This is used to keep all the errors and
transactions of your service together and is the primary filter in the Elastic APM
user interface.</p>
<p>If you do not specify <code class="literal">ELASTIC_APM_SERVICE_NAME</code>, the Go agent will use the
executable name. e.g. if your executable is called "my-app.exe", then your
service will be identified as "my-app".</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The service name must conform to this regular expression: <code class="literal">^[a-zA-Z0-9 _-]+$</code>.
In other words: your service name must only contain characters from the ASCII
alphabet, numbers, dashes, underscores, and spaces.</p>
</div>
</div>
<h3><a id="config-service-version"></a><code class="literal">ELASTIC_APM_SERVICE_VERSION</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/2.x/docs/configuration.asciidoc">edit</a></h3>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Environment</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_SERVICE_VERSION</code></p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>A string indicating the version of the deployed service</p></td>
</tr>
</tbody>
</table>
</div>
<p>A version string for the currently deployed version of the service.
If you don&#8217;t version your deployments, the recommended value for this field is the commit identifier
of the deployed revision, e.g. the output of <code class="literal">git rev-parse HEAD</code>.</p>
<h3><a id="config-service-node-name"></a><code class="literal">ELASTIC_APM_SERVICE_NODE_NAME</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/2.x/docs/configuration.asciidoc">edit</a></h3>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Environment</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_SERVICE_NODE_NAME</code></p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p><code class="literal">my-node-name</code></p></td>
</tr>
</tbody>
</table>
</div>
<p>Optional name used to differentiate between nodes in a service.
Must be unique, otherwise data from multiple nodes will be aggregated together.</p>
<p>If you do not specify <code class="literal">ELASTIC_APM_SERVICE_NODE_NAME</code>, service nodes will be identified using the container ID if available,
otherwise the host name.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This feature is fully supported in the APM Server versions &gt;= 7.5.</p>
</div>
</div>
<h3><a id="config-environment"></a><code class="literal">ELASTIC_APM_ENVIRONMENT</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/2.x/docs/configuration.asciidoc">edit</a></h3>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Environment</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_ENVIRONMENT</code></p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p><code class="literal">"production"</code></p></td>
</tr>
</tbody>
</table>
</div>
<p>The name of the environment this service is deployed in, e.g. "production" or "staging".</p>
<p>Environments allow you to easily filter data on a global level in the APM app.
It&#8217;s important to be consistent when naming environments across agents.
See <a href="/guide/en/kibana/8.15/filters.html#environment-selector" class="ulink" target="_top">environment selector</a> in the APM app for more information.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This feature is fully supported in the APM app in Kibana versions &gt;= 7.2.
You must use the query bar to filter for a specific environment in versions prior to 7.2.</p>
</div>
</div>
<h3><a id="config-active"></a><code class="literal">ELASTIC_APM_ACTIVE</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/2.x/docs/configuration.asciidoc">edit</a></h3>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Environment</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_ACTIVE</code></p></td>
<td align="left" valign="top"><p>true</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
</tr>
</tbody>
</table>
</div>
<p>Enable or disable the agent. If set to false, then the Go agent does not send
any data to the Elastic APM server, and instrumentation overhead is minimized.</p>
<h3><a id="config-recording"></a><code class="literal">ELASTIC_APM_RECORDING</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/2.x/docs/configuration.asciidoc">edit</a></h3>
<p><a class="xref" href="configuration.html#dynamic-configuration" title="Dynamic configuration"><span class="image"><img src="./images/dynamic-config.svg" alt="dynamic config"></span> </a></p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Environment</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_RECORDING</code></p></td>
<td align="left" valign="top"><p>true</p></td>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
</tr>
</tbody>
</table>
</div>
<p>Enable or disable recording of events. If set to false, then the Go agent does not
send any events to the Elastic APM server, and instrumentation overhead is
minimized, but the agent will continue to poll the server for configuration changes.</p>
<h3><a id="config-global-labels"></a><code class="literal">ELASTIC_APM_GLOBAL_LABELS</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/2.x/docs/configuration.asciidoc">edit</a></h3>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Environment</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_GLOBAL_LABELS</code></p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p><code class="literal">dept=engineering,rack=number8</code></p></td>
</tr>
</tbody>
</table>
</div>
<p>Labels are added to all events. The format for labels is: <code class="literal">key=value[,key=value[,...]]</code>.
Any labels set by application via the API will override global labels with the same keys.</p>
<p>This option requires APM Server 7.2 or greater, and will have no effect when using older
server versions.</p>
<h3><a id="config-ignore-urls"></a><code class="literal">ELASTIC_APM_TRANSACTION_IGNORE_URLS</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/2.x/docs/configuration.asciidoc">edit</a></h3>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Environment</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_TRANSACTION_IGNORE_URLS</code></p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p><code class="literal">/heartbeat*, *.jpg</code></p></td>
</tr>
</tbody>
</table>
</div>
<p>A list of patterns to match HTTP requests to ignore. An incoming HTTP request
whose request line matches any of the patterns will not be reported as a transaction.</p>
<p>This option supports the wildcard <code class="literal">*</code>, which matches zero or more characters.
Examples: <code class="literal">/foo/*/bar/*/baz*</code>, <code class="literal">*foo*</code>. Matching is case insensitive by default.
Prefixing a pattern with <code class="literal">(?-i)</code> makes the matching case sensitive.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This configuration was previously known as <code class="literal">ELASTIC_APM_IGNORE_URLS</code>, which has been deprecated and will be removed in a future major
version of the agent.</p>
</div>
</div>
<h3><a id="config-sanitize-field-names"></a><code class="literal">ELASTIC_APM_SANITIZE_FIELD_NAMES</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/2.x/docs/configuration.asciidoc">edit</a></h3>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Environment</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_SANITIZE_FIELD_NAMES</code></p></td>
<td align="left" valign="top"><p><code class="literal">password, passwd, pwd, secret, *key, *token*, *session*, *credit*, *card*, *auth*, set-cookie, *principal*</code></p></td>
<td align="left" valign="top"><p><code class="literal">sekrits</code></p></td>
</tr>
</tbody>
</table>
</div>
<p>A list of patterns to match the names of HTTP headers, cookies, and POST form fields to redact.</p>
<p>This option supports the wildcard <code class="literal">*</code>, which matches zero or more characters.
Examples: <code class="literal">/foo/*/bar/*/baz*</code>, <code class="literal">*foo*</code>. Matching is case insensitive by default.
Prefixing a pattern with <code class="literal">(?-i)</code> makes the matching case sensitive.</p>
<h3><a id="config-capture-headers"></a><code class="literal">ELASTIC_APM_CAPTURE_HEADERS</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/2.x/docs/configuration.asciidoc">edit</a></h3>
<p><a class="xref" href="configuration.html#dynamic-configuration" title="Dynamic configuration"><span class="image"><img src="./images/dynamic-config.svg" alt="dynamic config"></span> </a></p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Environment</th>
<th align="left" valign="top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_CAPTURE_HEADERS</code></p></td>
<td align="left" valign="top"><p><code class="literal">true</code></p></td>
</tr>
</tbody>
</table>
</div>
<p>For transactions that are HTTP requests, the Go agent can optionally capture request and response headers.</p>
<p>Possible values: <code class="literal">true</code>, <code class="literal">false</code>.</p>
<p>Captured headers are subject to sanitization, per <a class="xref" href="configuration.html#config-sanitize-field-names" title="ELASTIC_APM_SANITIZE_FIELD_NAMES"><code class="literal">ELASTIC_APM_SANITIZE_FIELD_NAMES</code></a>.</p>
<h3><a id="config-capture-body"></a><code class="literal">ELASTIC_APM_CAPTURE_BODY</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/2.x/docs/configuration.asciidoc">edit</a></h3>
<p><a class="xref" href="configuration.html#dynamic-configuration" title="Dynamic configuration"><span class="image"><img src="./images/dynamic-config.svg" alt="dynamic config"></span> </a></p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Environment</th>
<th align="left" valign="top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_CAPTURE_BODY</code></p></td>
<td align="left" valign="top"><p><code class="literal">off</code></p></td>
</tr>
</tbody>
</table>
</div>
<p>For transactions that are HTTP requests, the Go agent can optionally capture the request body.</p>
<p>Possible values: <code class="literal">errors</code>, <code class="literal">transactions</code>, <code class="literal">all</code>, <code class="literal">off</code>.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>Request bodies often contain sensitive values like passwords, credit card numbers, and so on.
If your service handles data like this, enable this feature with care.</p>
</div>
</div>
<h3><a id="config-hostname"></a><code class="literal">ELASTIC_APM_HOSTNAME</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/2.x/docs/configuration.asciidoc">edit</a></h3>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Environment</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_HOSTNAME</code></p></td>
<td align="left" valign="top"><p><code class="literal">os.Hostname()</code></p></td>
<td align="left" valign="top"><p><code class="literal">app-server01</code></p></td>
</tr>
</tbody>
</table>
</div>
<p>The host name to use when sending error and transaction data to the APM server.</p>
<h3><a id="config-api-request-time"></a><code class="literal">ELASTIC_APM_API_REQUEST_TIME</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/2.x/docs/configuration.asciidoc">edit</a></h3>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Environment</th>
<th align="left" valign="top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_API_REQUEST_TIME</code></p></td>
<td align="left" valign="top"><p><code class="literal">10s</code></p></td>
</tr>
</tbody>
</table>
</div>
<p>The amount of time to wait before ending a request to the Elastic APM server.
When you report transactions, spans and errors, the agent will initiate a
request and send them to the server when there is enough data to send; the
request will remain open until this time has been exceeded, or until the
<a class="xref" href="configuration.html#config-api-request-size" title="ELASTIC_APM_API_REQUEST_SIZE">maximum request size</a> has been reached.</p>
<h3><a id="config-api-request-size"></a><code class="literal">ELASTIC_APM_API_REQUEST_SIZE</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/2.x/docs/configuration.asciidoc">edit</a></h3>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Environment</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Minimum</th>
<th align="left" valign="top">Maximum</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_API_REQUEST_SIZE</code></p></td>
<td align="left" valign="top"><p><code class="literal">750KB</code></p></td>
<td align="left" valign="top"><p><code class="literal">1KB</code></p></td>
<td align="left" valign="top"><p><code class="literal">5MB</code></p></td>
</tr>
</tbody>
</table>
</div>
<p>The maximum size of request bodies to send to the Elastic APM server.
The agent will maintain an in-memory buffer of compressed data for streaming
to the APM server.</p>
<h3><a id="config-api-buffer-size"></a><code class="literal">ELASTIC_APM_API_BUFFER_SIZE</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/2.x/docs/configuration.asciidoc">edit</a></h3>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Environment</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Minimum</th>
<th align="left" valign="top">Maximum</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_API_BUFFER_SIZE</code></p></td>
<td align="left" valign="top"><p><code class="literal">1MB</code></p></td>
<td align="left" valign="top"><p><code class="literal">10KB</code></p></td>
<td align="left" valign="top"><p><code class="literal">100MB</code></p></td>
</tr>
</tbody>
</table>
</div>
<p>The maximum number of bytes of uncompressed, encoded events to store in memory
while the agent is busy. When the agent is able to, it will transfer buffered
data to the request buffer, and start streaming it to the server. If the buffer
fills up, new events will start replacing older ones.</p>
<h3><a id="config-transaction-max-spans"></a><code class="literal">ELASTIC_APM_TRANSACTION_MAX_SPANS</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/2.x/docs/configuration.asciidoc">edit</a></h3>
<p><a class="xref" href="configuration.html#dynamic-configuration" title="Dynamic configuration"><span class="image"><img src="./images/dynamic-config.svg" alt="dynamic config"></span> </a></p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Environment</th>
<th align="left" valign="top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_TRANSACTION_MAX_SPANS</code></p></td>
<td align="left" valign="top"><p><code class="literal">500</code></p></td>
</tr>
</tbody>
</table>
</div>
<p>Limits the amount of spans that are recorded per transaction.</p>
<p>This is helpful in cases where a transaction creates a large number
of spans (e.g. thousands of SQL queries). Setting an upper limit will
prevent overloading the agent and the APM server with too much work
for such edge cases.</p>
<h3><a id="config-exit-span-min-duration"></a><code class="literal">ELASTIC_APM_EXIT_SPAN_MIN_DURATION</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/2.x/docs/configuration.asciidoc">edit</a></h3>
<p><a class="xref" href="configuration.html#dynamic-configuration" title="Dynamic configuration"><span class="image"><img src="./images/dynamic-config.svg" alt="dynamic config"></span> </a></p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Environment</th>
<th align="left" valign="top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_EXIT_SPAN_MIN_DURATION</code></p></td>
<td align="left" valign="top"><p><code class="literal">1ms</code></p></td>
</tr>
</tbody>
</table>
</div>
<p>Sets the minimum duration for an exit span to be reported. Spans shorter or
equal to this threshold will be dropped by the agent and reported as statistics
in the span&#8217;s transaction, as long as the transaction didn&#8217;t end before the span
was reported.</p>
<p>When span compression is enabled (<a class="xref" href="configuration.html#config-span-compression-enabled" title="ELASTIC_APM_SPAN_COMPRESSION_ENABLED"><code class="literal">ELASTIC_APM_SPAN_COMPRESSION_ENABLED</code></a>), the sum
of the compressed span composite is considered.</p>
<p>The minimum duration allowed for this setting is 1 microsecond (<code class="literal">us</code>).</p>
<h3><a id="config-span-frames-min-duration-ms"></a><code class="literal">ELASTIC_APM_SPAN_FRAMES_MIN_DURATION</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/2.x/docs/configuration.asciidoc">edit</a></h3>
<p><a class="xref" href="configuration.html#dynamic-configuration" title="Dynamic configuration"><span class="image"><img src="./images/dynamic-config.svg" alt="dynamic config"></span> </a></p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Environment</th>
<th align="left" valign="top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_SPAN_FRAMES_MIN_DURATION</code></p></td>
<td align="left" valign="top"><p><code class="literal">5ms</code></p></td>
</tr>
</tbody>
</table>
</div>
<p>The APM agent will collect a stack trace for every recorded span whose duration
exceeds this configured value. While this is very helpful to find the exact
place in your code that causes the span, collecting this stack trace does have
some processing and storage overhead.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This configuration has been deprecated and will be removed in a future major version of the agent.</p>
</div>
</div>
<h3><a id="config-span-stack-trace-min-duration"></a><code class="literal">ELASTIC_APM_SPAN_STACK_TRACE_MIN_DURATION</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/2.x/docs/configuration.asciidoc">edit</a></h3>
<p><a class="xref" href="configuration.html#dynamic-configuration" title="Dynamic configuration"><span class="image"><img src="./images/dynamic-config.svg" alt="dynamic config"></span> </a></p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Environment</th>
<th align="left" valign="top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_SPAN_STACK_TRACE_MIN_DURATION</code></p></td>
<td align="left" valign="top"><p><code class="literal">5ms</code></p></td>
</tr>
</tbody>
</table>
</div>
<p>The APM agent will collect a stack trace for every recorded span whose duration
exceeds this configured value. While this is very helpful to find the exact
place in your code that causes the span, collecting this stack trace does have
some processing and storage overhead.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This configuration was previously known as <code class="literal">ELASTIC_APM_SPAN_FRAMES_MIN_DURATION</code>, which has been deprecated and will be removed in a future major
version of the agent.</p>
</div>
</div>
<h3><a id="config-stack-trace-limit"></a><code class="literal">ELASTIC_APM_STACK_TRACE_LIMIT</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/2.x/docs/configuration.asciidoc">edit</a></h3>
<p><a class="xref" href="configuration.html#dynamic-configuration" title="Dynamic configuration"><span class="image"><img src="./images/dynamic-config.svg" alt="dynamic config"></span> </a></p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Environment</th>
<th align="left" valign="top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_STACK_TRACE_LIMIT</code></p></td>
<td align="left" valign="top"><p><code class="literal">50</code></p></td>
</tr>
</tbody>
</table>
</div>
<p>Limits the number of frames captured for each stack trace.</p>
<p>Setting the limit to 0 will disable stack trace collection, while any positive
integer value will be used as the maximum number of frames to collect. Setting
a negative value, such as -1, means that all frames will be collected.</p>
<h3><a id="config-transaction-sample-rate"></a><code class="literal">ELASTIC_APM_TRANSACTION_SAMPLE_RATE</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/2.x/docs/configuration.asciidoc">edit</a></h3>
<p><a class="xref" href="configuration.html#dynamic-configuration" title="Dynamic configuration"><span class="image"><img src="./images/dynamic-config.svg" alt="dynamic config"></span> </a></p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Environment</th>
<th align="left" valign="top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_TRANSACTION_SAMPLE_RATE</code></p></td>
<td align="left" valign="top"><p><code class="literal">1.0</code></p></td>
</tr>
</tbody>
</table>
</div>
<p>By default, the agent will sample every transaction (e.g. request to your service).
To reduce overhead and storage requirements, set the sample rate to a value
between <code class="literal">0.0</code> and <code class="literal">1.0</code>. We still record overall time and the result for unsampled
transactions, but no context information, tags, or spans.</p>
<h3><a id="config-metrics-interval"></a><code class="literal">ELASTIC_APM_METRICS_INTERVAL</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/2.x/docs/configuration.asciidoc">edit</a></h3>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Environment</th>
<th align="left" valign="top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_METRICS_INTERVAL</code></p></td>
<td align="left" valign="top"><p>30s</p></td>
</tr>
</tbody>
</table>
</div>
<p>The interval at which APM agent gathers and reports metrics. Set to <code class="literal">0s</code> to disable.</p>
<h3><a id="config-disable-metrics"></a><code class="literal">ELASTIC_APM_DISABLE_METRICS</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/2.x/docs/configuration.asciidoc">edit</a></h3>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Environment</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_DISABLE_METRICS</code></p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p><code class="literal">system.*, *cpu*</code></p></td>
</tr>
</tbody>
</table>
</div>
<p>Disables the collection of certain metrics. If the name of a metric matches any of
the wildcard expressions, it will not be collected.</p>
<p>This option supports the wildcard <code class="literal">*</code>, which matches zero or more characters.
Examples: <code class="literal">/foo/*/bar/*/baz*</code>, <code class="literal">*foo*</code>. Matching is case insensitive by default.
Prefixing a pattern with <code class="literal">(?-i)</code> makes the matching case sensitive.</p>
<h3><a id="config-breakdown-metrics"></a><code class="literal">ELASTIC_APM_BREAKDOWN_METRICS</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/2.x/docs/configuration.asciidoc">edit</a></h3>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Environment</th>
<th align="left" valign="top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_BREAKDOWN_METRICS</code></p></td>
<td align="left" valign="top"><p><code class="literal">true</code></p></td>
</tr>
</tbody>
</table>
</div>
<p>Capture breakdown metrics. Set to <code class="literal">false</code> to disable.</p>
<h3><a id="config-server-cert"></a><code class="literal">ELASTIC_APM_SERVER_CERT</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/2.x/docs/configuration.asciidoc">edit</a></h3>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Environment</th>
<th align="left" valign="top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_SERVER_CERT</code></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
</tbody>
</table>
</div>
<p>If you have configured your APM Server with a self signed TLS certificate, or you
want to pin the server certificate, specify the path to the PEM-encoded
certificate via the <code class="literal">ELASTIC_APM_SERVER_CERT</code> configuration.</p>
<h3><a id="config-server-ca-cert-file"></a><code class="literal">ELASTIC_APM_SERVER_CA_CERT_FILE</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/2.x/docs/configuration.asciidoc">edit</a></h3>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Environment</th>
<th align="left" valign="top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_SERVER_CA_CERT_FILE</code></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
</tbody>
</table>
</div>
<p>The path to a PEM-encoded TLS Certificate Authority certificate that will be
used for verifying the server&#8217;s TLS certificate chain.</p>
<h3><a id="config-verify-server-cert"></a><code class="literal">ELASTIC_APM_VERIFY_SERVER_CERT</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/2.x/docs/configuration.asciidoc">edit</a></h3>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Environment</th>
<th align="left" valign="top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_VERIFY_SERVER_CERT</code></p></td>
<td align="left" valign="top"><p><code class="literal">true</code></p></td>
</tr>
</tbody>
</table>
</div>
<p>By default, the agent verifies the server&#8217;s certificate if you use an
HTTPS connection to the APM server. Verification can be disabled by
changing this setting to <code class="literal">false</code>. This setting is ignored when
<code class="literal">ELASTIC_APM_SERVER_CERT</code> is set.</p>
<h3><a id="config-log-file"></a><code class="literal">ELASTIC_APM_LOG_FILE</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/2.x/docs/configuration.asciidoc">edit</a></h3>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Environment</th>
<th align="left" valign="top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_LOG_FILE</code></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
</tbody>
</table>
</div>
<p><code class="literal">ELASTIC_APM_LOG_FILE</code> specifies the output file for the agent&#8217;s default, internal
logger. The file will be created, or truncated if it exists, when the process starts.
By default, logging is disabled. You must specify <code class="literal">ELASTIC_APM_LOG_FILE</code> to enable
it. This environment variable will be ignored if a logger is configured programatically.</p>
<p>There are two special file names that the agent recognizes: <code class="literal">stdout</code> and <code class="literal">stderr</code>.
These will configure the logger to write to standard output and standard error
respectively.</p>
<h3><a id="config-log-level"></a><code class="literal">ELASTIC_APM_LOG_LEVEL</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/2.x/docs/configuration.asciidoc">edit</a></h3>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Environment</th>
<th align="left" valign="top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_LOG_LEVEL</code></p></td>
<td align="left" valign="top"><p><code class="literal">"error"</code></p></td>
</tr>
</tbody>
</table>
</div>
<p><code class="literal">ELASTIC_APM_LOG_LEVEL</code> specifies the log level for the agent&#8217;s default, internal
logger. The only two levels used by the logger are "error" and "debug". By default,
logging is disabled. You must specify <code class="literal">ELASTIC_APM_LOG_FILE</code> to enable it.</p>
<p>This environment variable will be ignored if a logger is configured programatically.</p>
<h4><a id="config-central-config"></a><code class="literal">ELASTIC_APM_CENTRAL_CONFIG</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/2.x/docs/configuration.asciidoc">edit</a></h4>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Environment</th>
<th align="left" valign="top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_CENTRAL_CONFIG</code></p></td>
<td align="left" valign="top"><p><code class="literal">true</code></p></td>
</tr>
</tbody>
</table>
</div>
<p>Activate APM Agent central configuration via Kibana. By default the agent will poll the server
for agent configuration changes. This can be disabled by changing the setting to <code class="literal">false</code>.
See <a href="/guide/en/kibana/8.15/agent-configuration.html" class="ulink" target="_top">APM Agent central configuration</a> for more information.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This feature requires APM Server v7.3 or later.</p>
</div>
</div>
<h4><a id="config-use-elastic-traceparent-header"></a><code class="literal">ELASTIC_APM_USE_ELASTIC_TRACEPARENT_HEADER</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/2.x/docs/configuration.asciidoc">edit</a></h4>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<tbody>
<tr>
<td align="left" valign="top"><p>Environment</p></td>
<td align="left" valign="top"><p>Default</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_USE_ELASTIC_TRACEPARENT_HEADER</code></p></td>
<td align="left" valign="top"><p><code class="literal">true</code></p></td>
</tr>
</tbody>
</table>
</div>
<p>To enable <a href="/guide/en/apm/guide/8.15/apm-distributed-tracing.html" class="ulink" target="_top">distributed tracing</a>, the agent
adds trace context headers to outgoing HTTP requests made with <a class="xref" href="builtin-modules.html#builtin-modules-apmhttp" title="module/apmhttp">module/apmhttp</a>.
These headers (<code class="literal">traceparent</code> and <code class="literal">tracestate</code>) are defined in the
<a href="https://www.w3.org/TR/trace-context-1/" class="ulink" target="_top">W3C Trace Context</a> specification.</p>
<p>When this setting is <code class="literal">true</code>, the agent will also add the header <code class="literal">elastic-apm-traceparent</code>
for backwards compatibility with older versions of Elastic APM agents.</p>
<h4><a id="config-cloud-provider"></a><code class="literal">ELASTIC_APM_CLOUD_PROVIDER</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/2.x/docs/configuration.asciidoc">edit</a></h4>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Environment</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Example</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_CLOUD_PROVIDER</code></p></td>
<td align="left" valign="top"><p><code class="literal">"none"</code></p></td>
<td align="left" valign="top"><p><code class="literal">"aws"</code></p></td>
</tr>
</tbody>
</table>
</div>
<p>This config value allows you to specify which cloud provider should be assumed
for metadata collection. By default, the agent will use trial and error to
automatically collect the cloud metadata.</p>
<p>Valid options are <code class="literal">"none"</code>, <code class="literal">"auto"</code>, <code class="literal">"aws"</code>, <code class="literal">"gcp"</code>, and <code class="literal">"azure"</code>
If this config value is set to <code class="literal">"none"</code>, then no cloud metadata will be collected.</p>
<h3><a id="config-span-compression-enabled"></a><code class="literal">ELASTIC_APM_SPAN_COMPRESSION_ENABLED</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/2.x/docs/configuration.asciidoc">edit</a></h3>
<p><a class="xref" href="configuration.html#dynamic-configuration" title="Dynamic configuration"><span class="image"><img src="./images/dynamic-config.svg" alt="dynamic config"></span> </a></p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Environment</th>
<th align="left" valign="top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_SPAN_COMPRESSION_ENABLED</code></p></td>
<td align="left" valign="top"><p><code class="literal">true</code></p></td>
</tr>
</tbody>
</table>
</div>
<p>When enabled, the agent will attempt to compress <em>short</em> exit spans that share the
same parent into a composite span. The exact duration for what is considered
<em>short</em>, depends on the compression strategy used (<code class="literal">same_kind</code> or <code class="literal">exact_match</code>).</p>
<p>In order for a span to be compressible, these conditions need to be met:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Spans are exit spans.
</li>
<li class="listitem">
Spans are siblings (share the same parent).
</li>
<li class="listitem">
Spans have not propagated their context downstream.
</li>
<li class="listitem">
Each span duration is equal or lower to the compression strategy maximum duration.
</li>
<li class="listitem">
<p>Spans are compressed with <code class="literal">same_kind</code> strategy when these attributes are equal:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">span.type</code>.
</li>
<li class="listitem">
<code class="literal">span.subtype</code>.
</li>
<li class="listitem">
<code class="literal">span.context.destination.service.resource</code>
</li>
</ul>
</div>
</li>
<li class="listitem">
Spans are compressed with <code class="literal">exact_match</code> strategy when all the previous conditions
are met and the <code class="literal">span.name</code> is equal.
</li>
</ul>
</div>
<p>Compressing short exit spans should provide some storage savings for services that
create a lot of consecutive short exit spans to for example databases or cache
services which are generally uninteresting when viewing a trace.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This feature is experimental and requires APM Server v7.15 or later.</p>
</div>
</div>
<h3><a id="config-span-compression-exact-match-duration"></a><code class="literal">ELASTIC_APM_SPAN_COMPRESSION_EXACT_MATCH_MAX_DURATION</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/2.x/docs/configuration.asciidoc">edit</a></h3>
<p><a class="xref" href="configuration.html#dynamic-configuration" title="Dynamic configuration"><span class="image"><img src="./images/dynamic-config.svg" alt="dynamic config"></span> </a></p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Environment</th>
<th align="left" valign="top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_SPAN_COMPRESSION_EXACT_MATCH_MAX_DURATION</code></p></td>
<td align="left" valign="top"><p><code class="literal">50ms</code></p></td>
</tr>
</tbody>
</table>
</div>
<p>The maximum duration to consider for compressing sibling exit spans that are an
exact match for compression.</p>
<h3><a id="config-span-compression-same-kind-duration"></a><code class="literal">ELASTIC_APM_SPAN_COMPRESSION_SAME_KIND_MAX_DURATION</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/2.x/docs/configuration.asciidoc">edit</a></h3>
<p><a class="xref" href="configuration.html#dynamic-configuration" title="Dynamic configuration"><span class="image"><img src="./images/dynamic-config.svg" alt="dynamic config"></span> </a></p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Environment</th>
<th align="left" valign="top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_SPAN_COMPRESSION_SAME_KIND_MAX_DURATION</code></p></td>
<td align="left" valign="top"><p><code class="literal">0ms</code></p></td>
</tr>
</tbody>
</table>
</div>
<p>The maximum duration to consider for compressing sibling exit spans that are of
the same kind for compression.</p>
<h3><a id="config-trace-continuation-strategy"></a><code class="literal">ELASTIC_APM_TRACE_CONTINUATION_STRATEGY</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-go/edit/2.x/docs/configuration.asciidoc">edit</a></h3>
<p><a class="xref" href="configuration.html#dynamic-configuration" title="Dynamic configuration"><span class="image"><img src="./images/dynamic-config.svg" alt="dynamic config"></span> </a></p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Environment</th>
<th align="left" valign="top">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_TRACE_CONTINUATION_STRATEGY</code></p></td>
<td align="left" valign="top"><p><code class="literal">continue</code></p></td>
</tr>
</tbody>
</table>
</div>
<p>This option allows some control over how the APM agent handles W3C trace-context headers on incoming requests.
By default, the traceparent and tracestate headers are used per W3C spec for distributed tracing.
However, in certain cases it can be helpful to not use the incoming traceparent header. Some example use cases:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
An Elastic-monitored service is receiving requests with traceparent headers from unmonitored services.
</li>
<li class="listitem">
An Elastic-monitored service is publicly exposed, and does not want tracing data (trace-ids, sampling decisions) to possibly be spoofed by user requests.
</li>
</ul>
</div>
<p>Valid options are <code class="literal">continue</code>, <code class="literal">restart</code>, and <code class="literal">restart_external</code>:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
continue
</span>
</dt>
<dd>
The default behavior. An incoming <code class="literal">traceparent</code> value is used to continue the trace and determine the sampling decision.
</dd>
<dt>
<span class="term">
restart
</span>
</dt>
<dd>
Always ignores the <code class="literal">traceparent</code> header of incoming requests. A new trace-id will be generated and the sampling decision will be made based on <code class="literal">transaction_sample_rate</code>. A span link will be made to the incoming <code class="literal">traceparent</code>.
</dd>
<dt>
<span class="term">
restart_external
</span>
</dt>
<dd>
If an incoming request includes the <code class="literal">es</code> vendor flag in <code class="literal">tracestate</code>, then any <code class="literal">traceparent</code> will be considered internal and will be handled as described for <span class="strong strong"><strong>continue</strong></span> above. Otherwise, any <code class="literal">traceparent</code> is considered external and will be handled as described for <span class="strong strong"><strong>restart</strong></span> above.
</dd>
</dl>
</div>
<p>Starting with Elastic Observability 8.2, span links are visible in trace views.</p>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="supported-tech.html">« Supported Technologies</a>
</span>
<span class="next">
<a href="api.html">API Documentation »</a>
</span>
</div>
</body>
</html>
