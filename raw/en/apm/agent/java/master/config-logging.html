<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Logging configuration options | APM Java Agent Reference [master] | Elastic</title>
<link rel="home" href="index.html" title="APM Java Agent Reference [master]"/>
<link rel="up" href="configuration.html" title="Configuration"/>
<link rel="prev" href="config-jmx.html" title="JMX configuration options"/>
<link rel="next" href="config-messaging.html" title="Messaging configuration options"/>
<meta name="DC.type" content="Learn/Docs/APM Java Agent/Reference/master"/>
<meta name="DC.subject" content="APM"/>
<meta name="DC.identifier" content="master"/>
</head>
<body><div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">APM Java Agent Reference [master]</a></span>
»
<span class="breadcrumb-link"><a href="configuration.html">Configuration</a></span>
»
<span class="breadcrumb-node">Logging configuration options</span>
</div>
<div class="navheader">
<span class="prev">
<a href="config-jmx.html">« JMX configuration options</a>
</span>
<span class="next">
<a href="config-messaging.html">Messaging configuration options »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="config-logging"></a>Logging configuration options<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/master/docs/configuration.asciidoc">edit</a></h2>
</div></div></div>
<h4><a id="config-log-level"></a><code class="literal">log_level</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/master/docs/configuration.asciidoc">edit</a></h4>
<p>Sets the logging level for the agent.
This option is case-insensitive.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p><code class="literal">CRITICAL</code> is a valid option, but it is mapped to <code class="literal">ERROR</code>; <code class="literal">WARN</code> and <code class="literal">WARNING</code> are equivalent;
<code class="literal">OFF</code> is only available since version 1.16.0</p>
</div>
</div>
<p><a class="xref" href="configuration.html#configuration-dynamic" title="Dynamic configuration"><span class="image"><img src="./images/dynamic-config.svg" alt="dynamic config"></span> </a></p>
<p>Valid options: <code class="literal">OFF</code>, <code class="literal">ERROR</code>, <code class="literal">CRITICAL</code>, <code class="literal">WARN</code>, <code class="literal">WARNING</code>, <code class="literal">INFO</code>, <code class="literal">DEBUG</code>, <code class="literal">TRACE</code></p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Dynamic</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">INFO</code></p></td>
<td align="left" valign="top"><p>LogLevel</p></td>
<td align="left" valign="top"><p>true</p></td>
</tr>
</tbody>
</table>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Java System Properties</th>
<th align="left" valign="top">Property file</th>
<th align="left" valign="top">Environment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">elastic.apm.log_level</code></p></td>
<td align="left" valign="top"><p><code class="literal">log_level</code></p></td>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_LOG_LEVEL</code></p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="config-log-file"></a><code class="literal">log_file</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/master/docs/configuration.asciidoc">edit</a></h4>
<p>Sets the path of the agent logs.
The special value <code class="literal">_AGENT_HOME_</code> is a placeholder for the folder the elastic-apm-agent.jar is in.
Example: <code class="literal">_AGENT_HOME_/logs/elastic-apm.log</code></p>
<p>When set to the special value <em>System.out</em>,
the logs are sent to standard out.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>When logging to a file,
the log will be formatted in new-line-delimited JSON.
When logging to std out, the log will be formatted as plain-text.</p>
</div>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Dynamic</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">System.out</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>false</p></td>
</tr>
</tbody>
</table>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Java System Properties</th>
<th align="left" valign="top">Property file</th>
<th align="left" valign="top">Environment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">elastic.apm.log_file</code></p></td>
<td align="left" valign="top"><p><code class="literal">log_file</code></p></td>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_LOG_FILE</code></p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="config-enable-log-correlation"></a><code class="literal">enable_log_correlation</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/master/docs/configuration.asciidoc">edit</a></h4>
<p>A boolean specifying if the agent should integrate into SLF4J&#8217;s <a href="https://www.slf4j.org/api/org/slf4j/MDC.html" class="ulink" target="_top">MDC</a> to enable trace-log correlation.
If set to <code class="literal">true</code>, the agent will set the <code class="literal">trace.id</code> and <code class="literal">transaction.id</code> for the currently active spans and transactions to the MDC.
Since version 1.16.0, the agent also adds <code class="literal">error.id</code> of captured error to the MDC just before the error message is logged.
See <a class="xref" href="log-correlation.html" title="Log correlation"><em>Log correlation</em></a> for more details.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>While it&#8217;s allowed to enable this setting at runtime, you can&#8217;t disable it without a restart.</p>
</div>
</div>
<p><a class="xref" href="configuration.html#configuration-dynamic" title="Dynamic configuration"><span class="image"><img src="./images/dynamic-config.svg" alt="dynamic config"></span> </a></p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Dynamic</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Boolean</p></td>
<td align="left" valign="top"><p>true</p></td>
</tr>
</tbody>
</table>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Java System Properties</th>
<th align="left" valign="top">Property file</th>
<th align="left" valign="top">Environment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">elastic.apm.enable_log_correlation</code></p></td>
<td align="left" valign="top"><p><code class="literal">enable_log_correlation</code></p></td>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_ENABLE_LOG_CORRELATION</code></p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="config-log-ecs-reformatting"></a><code class="literal">log_ecs_reformatting</code> (<span class="Admonishment Admonishment--change">
[<span class="Admonishment-version u-mono">1.22.0</span>]
<span class="Admonishment-detail">
Added in 1.22.0.
</span>
</span> experimental)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/master/docs/configuration.asciidoc">edit</a></h4>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This feature is currently experimental, which means it is disabled by default and it is not guaranteed to be backwards compatible in future releases.</p>
</div>
</div>
<p>Specifying whether and how the agent should automatically reformat application logs
into <a href="/guide/en/ecs-logging/overview/master/index.html" class="ulink" target="_top">ECS-compatible JSON</a>, suitable for ingestion into Elasticsearch for
further Log analysis. This functionality is available for log4j1, log4j2 and Logback.
Once this option is enabled with any valid option, log correlation will be activated as well, regardless of the <a class="xref" href="config-logging.html#config-enable-log-correlation" title="enable_log_correlation"><code class="literal">enable_log_correlation</code></a> configuration.</p>
<p>Available options:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
OFF - application logs are not reformatted.
</li>
<li class="listitem">
SHADE - agent logs are reformatted and "shade" ECS-JSON-formatted logs are automatically created in
addition to the original application logs. Shade logs will have the same name as the original logs,
but with the ".ecs.json" extension instead of the original extension. Destination directory for the
shade logs can be configured through the <a class="xref" href="config-logging.html#config-log-ecs-reformatting-dir" title="log_ecs_reformatting_dir"><code class="literal">log_ecs_reformatting_dir</code></a>
configuration. Shade logs do not inherit file-rollover strategy from the original logs. Instead, they
use their own size-based rollover strategy according to the <a class="xref" href="config-logging.html#config-log-file-size" title="log_file_size ()"><code class="literal">log_file_size</code></a>
configuration and while allowing maximum of two shade log files.
</li>
<li class="listitem">
REPLACE - similar to <code class="literal">SHADE</code>, but the original logs will not be written. This option is useful if
you wish to maintain similar logging-related overhead, but write logs to a different location and/or
with a different file extension.
</li>
</ul>
</div>
<p><a class="xref" href="configuration.html#configuration-dynamic" title="Dynamic configuration"><span class="image"><img src="./images/dynamic-config.svg" alt="dynamic config"></span> </a></p>
<p>Valid options: <code class="literal">OFF</code>, <code class="literal">SHADE</code>, <code class="literal">REPLACE</code></p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Dynamic</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">OFF</code></p></td>
<td align="left" valign="top"><p>LogEcsReformatting</p></td>
<td align="left" valign="top"><p>true</p></td>
</tr>
</tbody>
</table>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Java System Properties</th>
<th align="left" valign="top">Property file</th>
<th align="left" valign="top">Environment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">elastic.apm.log_ecs_reformatting</code></p></td>
<td align="left" valign="top"><p><code class="literal">log_ecs_reformatting</code></p></td>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_LOG_ECS_REFORMATTING</code></p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="config-log-ecs-reformatting-dir"></a><code class="literal">log_ecs_reformatting_dir</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/master/docs/configuration.asciidoc">edit</a></h4>
<p>If <a class="xref" href="config-logging.html#config-log-ecs-reformatting" title="log_ecs_reformatting ( experimental)"><code class="literal">log_ecs_reformatting</code></a> is set to <code class="literal">SHADE</code> or <code class="literal">REPLACE</code>,
the shade log files will be written alongside the original logs in the same directory by default.
Use this configuration in order to write the shade logs into an alternative destination. Omitting this
config or setting it to an empty string will restore the default behavior. If relative path is used,
this path will be used relative to the original logs directory.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Dynamic</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">&lt;none&gt;</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>false</p></td>
</tr>
</tbody>
</table>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Java System Properties</th>
<th align="left" valign="top">Property file</th>
<th align="left" valign="top">Environment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">elastic.apm.log_ecs_reformatting_dir</code></p></td>
<td align="left" valign="top"><p><code class="literal">log_ecs_reformatting_dir</code></p></td>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_LOG_ECS_REFORMATTING_DIR</code></p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="config-log-file-size"></a><code class="literal">log_file_size</code> (<span class="Admonishment Admonishment--change">
[<span class="Admonishment-version u-mono">1.17.0</span>]
<span class="Admonishment-detail">
Added in 1.17.0.
</span>
</span>)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/master/docs/configuration.asciidoc">edit</a></h4>
<p>The size of the log file.</p>
<p>The agent always keeps one history file so that the max total log file size is twice the value of this setting.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Dynamic</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">50mb</code></p></td>
<td align="left" valign="top"><p>ByteValue</p></td>
<td align="left" valign="top"><p>false</p></td>
</tr>
</tbody>
</table>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Java System Properties</th>
<th align="left" valign="top">Property file</th>
<th align="left" valign="top">Environment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">elastic.apm.log_file_size</code></p></td>
<td align="left" valign="top"><p><code class="literal">log_file_size</code></p></td>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_LOG_FILE_SIZE</code></p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="config-log-format-sout"></a><code class="literal">log_format_sout</code> (<span class="Admonishment Admonishment--change">
[<span class="Admonishment-version u-mono">1.17.0</span>]
<span class="Admonishment-detail">
Added in 1.17.0.
</span>
</span>)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/master/docs/configuration.asciidoc">edit</a></h4>
<p>Defines the log format when logging to <code class="literal">System.out</code>.</p>
<p>When set to <code class="literal">JSON</code>, the agent will format the logs in an <a href="https://github.com/elastic/ecs-logging-java" class="ulink" target="_top">ECS-compliant JSON format</a>
where each log event is serialized as a single line.</p>
<p>Valid options: <code class="literal">PLAIN_TEXT</code>, <code class="literal">JSON</code></p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Dynamic</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">PLAIN_TEXT</code></p></td>
<td align="left" valign="top"><p>LogFormat</p></td>
<td align="left" valign="top"><p>false</p></td>
</tr>
</tbody>
</table>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Java System Properties</th>
<th align="left" valign="top">Property file</th>
<th align="left" valign="top">Environment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">elastic.apm.log_format_sout</code></p></td>
<td align="left" valign="top"><p><code class="literal">log_format_sout</code></p></td>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_LOG_FORMAT_SOUT</code></p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="config-log-format-file"></a><code class="literal">log_format_file</code> (<span class="Admonishment Admonishment--change">
[<span class="Admonishment-version u-mono">1.17.0</span>]
<span class="Admonishment-detail">
Added in 1.17.0.
</span>
</span>)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/master/docs/configuration.asciidoc">edit</a></h4>
<p>Defines the log format when logging to a file.</p>
<p>When set to <code class="literal">JSON</code>, the agent will format the logs in an <a href="https://github.com/elastic/ecs-logging-java" class="ulink" target="_top">ECS-compliant JSON format</a>
where each log event is serialized as a single line.</p>
<p>Valid options: <code class="literal">PLAIN_TEXT</code>, <code class="literal">JSON</code></p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Dynamic</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">PLAIN_TEXT</code></p></td>
<td align="left" valign="top"><p>LogFormat</p></td>
<td align="left" valign="top"><p>false</p></td>
</tr>
</tbody>
</table>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Java System Properties</th>
<th align="left" valign="top">Property file</th>
<th align="left" valign="top">Environment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">elastic.apm.log_format_file</code></p></td>
<td align="left" valign="top"><p><code class="literal">log_format_file</code></p></td>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_LOG_FORMAT_FILE</code></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="config-jmx.html">« JMX configuration options</a>
</span>
<span class="next">
<a href="config-messaging.html">Messaging configuration options »</a>
</span>
</div>
</div>
</body>
</html>
