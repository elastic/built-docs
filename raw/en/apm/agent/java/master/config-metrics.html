<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Metrics configuration options | APM Java Agent Reference [master] | Elastic</title>
<meta class="elastic" name="content" content="Metrics configuration options | APM Java Agent Reference [master]">

<link rel="home" href="index.html" title="APM Java Agent Reference [master]"/>
<link rel="up" href="configuration.html" title="Configuration"/>
<link rel="prev" href="config-messaging.html" title="Messaging configuration options"/>
<link rel="next" href="config-profiling.html" title="Profiling configuration options"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="APM"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/APM Java Agent/Reference/master"/>
<meta name="DC.subject" content="APM"/>
<meta name="DC.identifier" content="master"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body><div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link">
  <div id="related-products" class="dropdown">
  <div class="related-products-title">APM:</div>
  <div class="dropdown-anchor" tabindex="0">Java Agent Reference<span class="dropdown-icon"></span></div>
  <div class="dropdown-content">
  <ul>
  <li class="dropdown-category">APM</li>
  <ul>
  <li><a href="/guide/en/observability/current/apm.html">Observability › APM</a></li>
  </ul>
  <li class="dropdown-category">APM agents</li>
  <ul>
  <li><a href="/guide/en/apm/agent/android/current/intro.html">Android Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/go/current/introduction.html">Go Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/swift/current/intro.html">iOS Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/java/current/intro.html">Java Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/dotnet/current/intro.html">.NET Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/nodejs/current/intro.html">Node.js Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/php/current/intro.html">PHP Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/python/current/getting-started.html">Python Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/ruby/current/introduction.html">Ruby Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/rum-js/current/intro.html">Real User Monitoring JavaScript Agent Reference</a></li>
  </ul>
  <li class="dropdown-category">APM extensions</li>
  <ul>
  <li><a href="/guide/en/apm/lambda/current/aws-lambda-arch.html">AWS Lambda extension</a></li>
  <li><a href="/guide/en/apm/attacher/current/apm-attacher.html">Attacher</a></li>
  </ul>
  </ul>
  </div>
  </div>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="configuration.html">Configuration</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="config-messaging.html">« Messaging configuration options</a>
</span>
<span class="next">
<a href="config-profiling.html">Profiling configuration options »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="config-metrics"></a>Metrics configuration options<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/main/docs/configuration.asciidoc">edit</a></h2>
</div></div></div>

<h4><a id="config-dedot-custom-metrics"></a><code class="literal">dedot_custom_metrics</code> (<span class="Admonishment Admonishment--change">
[<span class="Admonishment-version u-mono">1.22.0</span>]
<span class="Admonishment-detail">
Added in 1.22.0.
</span>
</span>)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/main/docs/configuration.asciidoc">edit</a></h4>
<p>Replaces dots with underscores in the metric names for Micrometer metrics.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>Setting this to <code class="literal">false</code> can lead to mapping conflicts as dots indicate nesting in Elasticsearch.
An example of when a conflict happens is two metrics with the name <code class="literal">foo</code> and <code class="literal">foo.bar</code>.
The first metric maps <code class="literal">foo</code> to a number and the second metric maps <code class="literal">foo</code> as an object.</p>
</div>
</div>
<p><a class="xref" href="configuration.html#configuration-dynamic" title="Dynamic configuration"><span class="image"><img src="./images/dynamic-config.svg" alt="dynamic config"></span> </a></p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Dynamic</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">true</code></p></td>
<td align="left" valign="top"><p>Boolean</p></td>
<td align="left" valign="top"><p>true</p></td>
</tr>
</tbody>
</table>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Java System Properties</th>
<th align="left" valign="top">Property file</th>
<th align="left" valign="top">Environment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">elastic.apm.dedot_custom_metrics</code></p></td>
<td align="left" valign="top"><p><code class="literal">dedot_custom_metrics</code></p></td>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_DEDOT_CUSTOM_METRICS</code></p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="config-custom-metrics-histogram-boundaries"></a><code class="literal">custom_metrics_histogram_boundaries</code> (<span class="Admonishment Admonishment--change">
[<span class="Admonishment-version u-mono">1.37.0</span>]
<span class="Admonishment-detail">
Added in 1.37.0.
</span>
</span> experimental)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/main/docs/configuration.asciidoc">edit</a></h4>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This feature is currently experimental, which means it is disabled by default and it is not guaranteed to be backwards compatible in future releases.</p>
</div>
</div>
<p>Defines the default bucket boundaries to use for OpenTelemetry histograms.</p>
<p>Note that for OpenTelemetry 1.32.0 or newer this setting will only work when using API only. The default buckets will not be applied when bringing your own SDK.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Dynamic</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">0.00390625, 0.00552427, 0.0078125, 0.0110485, 0.015625, 0.0220971, 0.03125, 0.0441942, 0.0625, 0.0883883, 0.125, 0.176777, 0.25, 0.353553, 0.5, 0.707107, 1.0, 1.41421, 2.0, 2.82843, 4.0, 5.65685, 8.0, 11.3137, 16.0, 22.6274, 32.0, 45.2548, 64.0, 90.5097, 128.0, 181.019, 256.0, 362.039, 512.0, 724.077, 1024.0, 1448.15, 2048.0, 2896.31, 4096.0, 5792.62, 8192.0, 11585.2, 16384.0, 23170.5, 32768.0, 46341.0, 65536.0, 92681.9, 131072.0</code></p></td>
<td align="left" valign="top"><p>List</p></td>
<td align="left" valign="top"><p>false</p></td>
</tr>
</tbody>
</table>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Java System Properties</th>
<th align="left" valign="top">Property file</th>
<th align="left" valign="top">Environment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">elastic.apm.custom_metrics_histogram_boundaries</code></p></td>
<td align="left" valign="top"><p><code class="literal">custom_metrics_histogram_boundaries</code></p></td>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_CUSTOM_METRICS_HISTOGRAM_BOUNDARIES</code></p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="config-metric-set-limit"></a><code class="literal">metric_set_limit</code> (<span class="Admonishment Admonishment--change">
[<span class="Admonishment-version u-mono">1.33.0</span>]
<span class="Admonishment-detail">
Added in 1.33.0.
</span>
</span>)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/main/docs/configuration.asciidoc">edit</a></h4>
<p>Limits the number of active metric sets.
The metrics sets have associated labels, and the metrics sets are held internally in a map using the labels as keys. The map is limited in size by this option to prevent unbounded growth. If you hit the limit, you&#8217;ll receive a warning in the agent log.
The recommended option to workaround the limit is to try to limit the cardinality of the labels, eg naming your transactions so that there are fewer distinct transaction names.
But if you must, you can use this option to increase the limit.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Dynamic</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">1000</code></p></td>
<td align="left" valign="top"><p>Integer</p></td>
<td align="left" valign="top"><p>false</p></td>
</tr>
</tbody>
</table>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Java System Properties</th>
<th align="left" valign="top">Property file</th>
<th align="left" valign="top">Environment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">elastic.apm.metric_set_limit</code></p></td>
<td align="left" valign="top"><p><code class="literal">metric_set_limit</code></p></td>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_METRIC_SET_LIMIT</code></p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="config-agent-reporter-health-metrics"></a><code class="literal">agent_reporter_health_metrics</code> (<span class="Admonishment Admonishment--change">
[<span class="Admonishment-version u-mono">1.35.0</span>]
<span class="Admonishment-detail">
Added in 1.35.0.
</span>
</span> experimental)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/main/docs/configuration.asciidoc">edit</a></h4>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This feature is currently experimental, which means it is disabled by default and it is not guaranteed to be backwards compatible in future releases.</p>
</div>
</div>
<p>Enables metrics which capture the health state of the agent&#8217;s event reporting mechanism.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Dynamic</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Boolean</p></td>
<td align="left" valign="top"><p>false</p></td>
</tr>
</tbody>
</table>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Java System Properties</th>
<th align="left" valign="top">Property file</th>
<th align="left" valign="top">Environment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">elastic.apm.agent_reporter_health_metrics</code></p></td>
<td align="left" valign="top"><p><code class="literal">agent_reporter_health_metrics</code></p></td>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_AGENT_REPORTER_HEALTH_METRICS</code></p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="config-agent-background-overhead-metrics"></a><code class="literal">agent_background_overhead_metrics</code> (<span class="Admonishment Admonishment--change">
[<span class="Admonishment-version u-mono">1.35.0</span>]
<span class="Admonishment-detail">
Added in 1.35.0.
</span>
</span> experimental)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-java/edit/main/docs/configuration.asciidoc">edit</a></h4>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This feature is currently experimental, which means it is disabled by default and it is not guaranteed to be backwards compatible in future releases.</p>
</div>
</div>
<p>Enables metrics which capture the resource consumption of agent background tasks.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Dynamic</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">false</code></p></td>
<td align="left" valign="top"><p>Boolean</p></td>
<td align="left" valign="top"><p>false</p></td>
</tr>
</tbody>
</table>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Java System Properties</th>
<th align="left" valign="top">Property file</th>
<th align="left" valign="top">Environment</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">elastic.apm.agent_background_overhead_metrics</code></p></td>
<td align="left" valign="top"><p><code class="literal">agent_background_overhead_metrics</code></p></td>
<td align="left" valign="top"><p><code class="literal">ELASTIC_APM_AGENT_BACKGROUND_OVERHEAD_METRICS</code></p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="config-messaging.html">« Messaging configuration options</a>
</span>
<span class="next">
<a href="config-profiling.html">Profiling configuration options »</a>
</span>
</div>
</div>
</body>
</html>
