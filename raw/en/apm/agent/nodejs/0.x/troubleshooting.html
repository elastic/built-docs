<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Troubleshooting | APM Node.js Agent Reference (Beta) [0.x] | Elastic</title>
<link rel="home" href="index.html" title="APM Node.js Agent Reference (Beta) [0.x]"/>
<link rel="up" href="index.html" title="APM Node.js Agent Reference (Beta) [0.x]"/>
<link rel="prev" href="compatibility.html" title="Compatibility Overview"/>
<meta name="DC.type" content="Learn/Docs/APM Node.js Agent/Reference/0.x"/>
<meta name="DC.subject" content="APM"/>
<meta name="DC.identifier" content="0.x"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body><div class="page_header">
You are looking at the documentation for a beta release.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">APM Node.js Agent Reference (Beta) [0.x]</a></span>
»
<span class="breadcrumb-node">Troubleshooting</span>
</div>
<div class="navheader">
<span class="prev">
<a href="compatibility.html">« Compatibility Overview</a>
</span>
<span class="next">
</span>
</div>
<div class="chapter">
<div class="titlepage"><div><div>
<h1 class="title"><a id="troubleshooting"></a>Troubleshooting<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/apm-agent-nodejs/edit/0.x/docs/troubleshooting.asciidoc">edit</a></h1>
</div></div></div>
<h3><a id="no-data-sent"></a>No data is sent to the APM Server<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/apm-agent-nodejs/edit/0.x/docs/troubleshooting.asciidoc">edit</a></h3>
<p>If neither errors or performance metrics are being sent to the APM Server,
it&#8217;s a good idea to first check your log file and look for output just as the app starts.</p>
<h4><a id="error-messages"></a>Explanation of error messages<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/apm-agent-nodejs/edit/0.x/docs/troubleshooting.asciidoc">edit</a></h4>
<h5><a id="message-agent-inactive"></a>Agent Inactive<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/apm-agent-nodejs/edit/0.x/docs/troubleshooting.asciidoc">edit</a></h5>
<pre class="screen">Elastic APM agent is inactive due to configuration</pre>
<p>You&#8217;ve most likely set the <code class="literal">active</code> option or the <code class="literal">ELASTIC_APM_ACTIVE</code> environment variable to <code class="literal">false</code>.
Ensure that it&#8217;s set to <code class="literal">true</code> and try again.</p>
<p>See the API documentation about <a class="xref" href="agent-api.html#active" title="active"><code class="literal">active</code></a> for details.</p>
<h5><a id="message-missing-app-name"></a>Missing <code class="literal">appName</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/apm-agent-nodejs/edit/0.x/docs/troubleshooting.asciidoc">edit</a></h5>
<pre class="screen">Elastic APM isn't correctly configured: Missing appName</pre>
<p>Ensure that the agent is correctly configured with an <code class="literal">appName</code> config option either by passing it to the <code class="literal">start()</code> function,
by specifying it in the optional configuration file,
or by using environment variables.</p>
<p>See the API documentation on <a class="xref" href="agent-api.html#app-name" title="appName"><code class="literal">appName</code></a> for details.</p>
<h5><a id="message-invalid-app-name"></a>Invalid <code class="literal">appName</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/apm-agent-nodejs/edit/0.x/docs/troubleshooting.asciidoc">edit</a></h5>
<pre class="screen">Elastic APM isn't correctly configured: appName "..." contains invalid characters! (allowed: a-z, A-Z, 0-9, _, -, &lt;space&gt;)</pre>
<p>The <code class="literal">appName</code> you provided contained invalid characters.
You can only use the the letters a-z (both upper and lowercase), numbers, underscore (<code class="literal">_</code>), hyphen (<code class="literal">-</code>), and space (` `).</p>
<p>See the API documentation on <a class="xref" href="agent-api.html#app-name" title="appName"><code class="literal">appName</code></a> for details.</p>
<h3><a id="missing-performance-metrics"></a>No performance metrics sent to APM Server<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/apm-agent-nodejs/edit/0.x/docs/troubleshooting.asciidoc">edit</a></h3>
<p>Errors gets tracked just fine,
but you don&#8217;t see any performance metrics.</p>
<p>First make sure you have <a href="https://www.npmjs.com/package/elastic-apm-node" class="ulink" target="_top">the latest version</a> of the Elastic APM Node.js agent.
Issues are fixed and support for new metrics are added all the time,
so make sure you keep your dependency up to date.</p>
<p>If you are using the latest version but still don&#8217;t see any performance metrics,
make sure that the agent is <span class="strong strong"><strong>both required and started at the very top of your main app file</strong></span> (usually the <code class="literal">index.js</code>, <code class="literal">server.js</code> or <code class="literal">app.js</code> file).
It&#8217;s important that the agent is started before any other modules are required.
If not,
the agent will not be able to hook into any modules and will not be able to measure the performance of your application.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>If you are using Babel / ES modules in your application,
make sure you have read about the <a class="xref" href="advanced-setup.html#es-modules" title="Babel / ES Modules support">Babel / ES Module support</a>.</p>
</div>
</div>
<p>If this is not the issue,
your app dependencies might be incompatible with the agent.
Please create a new topic in the <a href="https://discuss.elastic.co/c/apm" class="ulink" target="_top">Elastic APM discuss forum</a> and try to include as much information as possible, e.g:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
The dependencies in you <code class="literal">package.json</code> file
</li>
<li class="listitem">
Your app&#8217;s main js file showing how the agent is initialized (usually the <code class="literal">index.js</code>, <code class="literal">server.js</code> or <code class="literal">app.js</code> file)
</li>
<li class="listitem">
Your server logs with Elastic APM debugging enabled
</li>
</ul>
</div>
<h3><a id="debug-mode"></a>Debug mode<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/apm-agent-nodejs/edit/0.x/docs/troubleshooting.asciidoc">edit</a></h3>
<p>To enable agent debugging and capture enough information,
perform these steps:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Start your app with the environment variable <code class="literal">DEBUG=elastic-apm</code>
</li>
<li class="listitem">
Send a few HTTP requests to some of the app endpoints
</li>
<li class="listitem">
Wait at least one minute to allow the agent to try and connect to the APM Server
</li>
</ol>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="compatibility.html">« Compatibility Overview</a>
</span>
<span class="next">
</span>
</div>
</div>
</body>
</html>
