<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Troubleshooting | APM Node.js Agent Reference [1.x] | Elastic</title>
<meta class="elastic" name="content" content="Troubleshooting | APM Node.js Agent Reference [1.x]">

<link rel="home" href="index.html" title="APM Node.js Agent Reference [1.x]"/>
<link rel="up" href="index.html" title="APM Node.js Agent Reference [1.x]"/>
<link rel="prev" href="upgrade-to-v1.html" title="Upgrade to v1.x"/>
<meta class="elastic" name="product_version" content="1.x"/>
<meta class="elastic" name="product_name" content="APM"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/APM Node.js Agent/Reference/1.x"/>
<meta name="DC.subject" content="APM"/>
<meta name="DC.identifier" content="1.x"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div class="navheader">
<span class="prev">
<a href="upgrade-to-v1.html">« Upgrade to v1.x</a>
</span>
<span class="next">
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link">
  <div id="related-products" class="dropdown">
  <div class="related-products-title">APM:</div>
  <div class="dropdown-anchor" tabindex="0">Node.js Agent Reference<span class="dropdown-icon"></span></div>
  <div class="dropdown-content">
  <ul>
  <li class="dropdown-category">APM</li>
  <ul>
  <li><a href="/guide/en/observability/current/apm.html">Observability › APM</a></li>
  </ul>
  <li class="dropdown-category">APM agents</li>
  <ul>
  <li><a href="/guide/en/apm/agent/android/current/intro.html">Android Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/go/current/introduction.html">Go Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/swift/current/intro.html">iOS Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/java/current/intro.html">Java Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/dotnet/current/intro.html">.NET Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/nodejs/current/intro.html">Node.js Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/php/current/intro.html">PHP Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/python/current/getting-started.html">Python Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/ruby/current/introduction.html">Ruby Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/rum-js/current/intro.html">Real User Monitoring JavaScript Agent Reference</a></li>
  </ul>
  <li class="dropdown-category">APM extensions</li>
  <ul>
  <li><a href="/guide/en/apm/lambda/current/aws-lambda-arch.html">AWS Lambda extension</a></li>
  <li><a href="/guide/en/apm/attacher/current/apm-attacher.html">Attacher</a></li>
  </ul>
  </ul>
  </div>
  </div>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Troubleshooting</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/apm-agent-nodejs/edit/1.x/docs/troubleshooting.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div id="url-to-v3" class="version-warning">
    <strong>IMPORTANT</strong>: This documentation is no longer updated. Refer to <a href="https://www.elastic.co/support/eol">Elastic's version policy</a> and the <a href="https://www.elastic.co/docs/troubleshoot/observability/apm-agent-nodejs/apm-nodejs-agent">latest documentation</a>.
</div>
<div class="chapter">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="troubleshooting"></a>Troubleshooting</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/apm-agent-nodejs/edit/1.x/docs/troubleshooting.asciidoc">edit</a></div>
</div></div></div>
<div class="position-relative"><h3><a id="no-data-sent"></a>No data is sent to the APM Server</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/apm-agent-nodejs/edit/1.x/docs/troubleshooting.asciidoc">edit</a></div>
<p>If neither errors nor performance metrics are being sent to the APM Server,
it&#8217;s a good idea to first check your log file and look for output just as the app starts.</p>
<div class="position-relative"><h4><a id="error-messages"></a>Explanation of error messages</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/apm-agent-nodejs/edit/1.x/docs/troubleshooting.asciidoc">edit</a></div>
<div class="position-relative"><h5><a id="message-agent-inactive"></a>Agent Inactive</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/apm-agent-nodejs/edit/1.x/docs/troubleshooting.asciidoc">edit</a></div>
<pre class="screen">Elastic APM agent is inactive due to configuration</pre>
<p>You&#8217;ve most likely set the <code class="literal">active</code> option or the <code class="literal">ELASTIC_APM_ACTIVE</code> environment variable to <code class="literal">false</code>.
Ensure that it&#8217;s set to <code class="literal">true</code> and try again.</p>
<p>See the API documentation about <a class="xref" href="agent-api.html#active" title="active"><code class="literal">active</code></a> for details.</p>
<div class="position-relative"><h5><a id="message-missing-service-name"></a>Missing <code class="literal">serviceName</code></h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/apm-agent-nodejs/edit/1.x/docs/troubleshooting.asciidoc">edit</a></div>
<pre class="screen">Elastic APM isn't correctly configured: Missing serviceName</pre>
<p>Ensure that the agent is correctly configured with a <code class="literal">serviceName</code> config option either by passing it to the <code class="literal">start()</code> function,
by specifying it in the optional configuration file,
or by using environment variables.</p>
<p>See the API documentation on <a class="xref" href="agent-api.html#service-name" title="serviceName"><code class="literal">serviceName</code></a> for details.</p>
<div class="position-relative"><h5><a id="message-invalid-service-name"></a>Invalid <code class="literal">serviceName</code></h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/apm-agent-nodejs/edit/1.x/docs/troubleshooting.asciidoc">edit</a></div>
<pre class="screen">Elastic APM isn't correctly configured: serviceName "..." contains invalid characters! (allowed: a-z, A-Z, 0-9, _, -, &lt;space&gt;)</pre>
<p>The <code class="literal">serviceName</code> you provided contained invalid characters.
You can only use the letters a-z (both upper and lowercase), numbers, underscore (<code class="literal">_</code>), hyphen (<code class="literal">-</code>), and space (` `).</p>
<p>See the API documentation on <a class="xref" href="agent-api.html#service-name" title="serviceName"><code class="literal">serviceName</code></a> for details.</p>
<div class="position-relative"><h3><a id="missing-performance-metrics"></a>No performance metrics sent to APM Server</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/apm-agent-nodejs/edit/1.x/docs/troubleshooting.asciidoc">edit</a></div>
<p>Errors get tracked just fine,
but you don&#8217;t see any performance metrics.</p>
<p>First, make sure you have <a href="https://www.npmjs.com/package/elastic-apm-node" class="ulink" target="_top">the latest version</a> of the Elastic APM Node.js agent.
Issues are fixed and support for new metrics are added all the time,
so make sure you keep your dependency up to date.</p>
<p>If you are using the latest version but still don&#8217;t see any performance metrics,
make sure that the agent is <span class="strong strong"><strong>both required and started at the very top of your main app file</strong></span> (usually the <code class="literal">index.js</code>, <code class="literal">server.js</code> or <code class="literal">app.js</code> file).
It&#8217;s important that the agent is started before any other modules are required.
If not,
the agent will not be able to hook into any modules and will not be able to measure the performance of your application.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>If you are using Babel / ES modules in your application,
make sure you have read about the <a class="xref" href="advanced-setup.html#es-modules" title="Babel / ES Modules support">Babel / ES Module support</a>.</p>
</div>
</div>
<p>If this is not the issue,
your app dependencies might be incompatible with the agent.
Please create a new topic in the <a href="https://discuss.elastic.co/c/apm" class="ulink" target="_top">Elastic APM discuss forum</a> and try to include as much information as possible, such as:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
The dependencies in you <code class="literal">package.json</code> file
</li>
<li class="listitem">
Your app&#8217;s main js file showing how the agent is initialized (usually the <code class="literal">index.js</code>, <code class="literal">server.js</code> or <code class="literal">app.js</code> file)
</li>
<li class="listitem">
Your server logs with Elastic APM debugging enabled
</li>
</ul>
</div>
<div class="position-relative"><h3><a id="debug-mode"></a>Debug mode</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/apm-agent-nodejs/edit/1.x/docs/troubleshooting.asciidoc">edit</a></div>
<p>To enable agent debugging and capture enough information,
perform these steps:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Start your app with the environment variable <code class="literal">ELASTIC_APM_LOG_LEVEL=debug</code> or add <code class="literal">logLevel: 'debug'</code> to the config file or <code class="literal">start(options)</code> call
</li>
<li class="listitem">
Send a few HTTP requests to some of the app endpoints
</li>
<li class="listitem">
Wait at least one minute to allow the agent to try and connect to the APM Server
</li>
</ol>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="upgrade-to-v1.html">« Upgrade to v1.x</a>
</span>
<span class="next">
</span>
</div>
</body>
</html>
