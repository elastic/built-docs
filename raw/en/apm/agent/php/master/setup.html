<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Set up the Agent | APM PHP Agent Reference [master] | Elastic</title>
<meta class="elastic" name="content" content="Set up the Agent | APM PHP Agent Reference [master]">

<link rel="home" href="index.html" title="APM PHP Agent Reference [master]"/>
<link rel="up" href="index.html" title="APM PHP Agent Reference [master]"/>
<link rel="prev" href="intro.html" title="Introduction"/>
<link rel="next" href="supported-technologies.html" title="Supported technologies"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="APM"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/APM PHP Agent/Reference/master"/>
<meta name="DC.subject" content="APM"/>
<meta name="DC.identifier" content="master"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
This documentation contains work-in-progress information for future Elastic Stack and Cloud releases. Use the version selector to view supported release docs. It also contains some Elastic Cloud serverless information. Check out our <a href="https://www.elastic.co/docs/current/serverless">serverless docs</a> for more details.
</div>
<div class="navheader">
<span class="prev">
<a href="intro.html">« Introduction</a>
</span>
<span class="next">
<a href="supported-technologies.html">Supported technologies »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link">
  <div id="related-products" class="dropdown">
  <div class="related-products-title">APM:</div>
  <div class="dropdown-anchor" tabindex="0">PHP Agent Reference<span class="dropdown-icon"></span></div>
  <div class="dropdown-content">
  <ul>
  <li class="dropdown-category">APM</li>
  <ul>
  <li><a href="/guide/en/observability/current/apm.html">Observability › APM</a></li>
  </ul>
  <li class="dropdown-category">APM agents</li>
  <ul>
  <li><a href="/guide/en/apm/agent/android/current/intro.html">Android Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/go/current/introduction.html">Go Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/swift/current/intro.html">iOS Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/java/current/intro.html">Java Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/dotnet/current/intro.html">.NET Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/nodejs/current/intro.html">Node.js Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/php/current/intro.html">PHP Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/python/current/getting-started.html">Python Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/ruby/current/introduction.html">Ruby Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/rum-js/current/intro.html">Real User Monitoring JavaScript Agent Reference</a></li>
  </ul>
  <li class="dropdown-category">APM extensions</li>
  <ul>
  <li><a href="/guide/en/apm/lambda/current/aws-lambda-arch.html">AWS Lambda extension</a></li>
  <li><a href="/guide/en/apm/attacher/current/apm-attacher.html">Attacher</a></li>
  </ul>
  </ul>
  </div>
  </div>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Set up the Agent</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-php/edit/main/docs/setup.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="chapter">
<div class="titlepage"><div><div>
<h2 class="title"><a id="setup"></a>Set up the Agent<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-php/edit/main/docs/setup.asciidoc">edit</a></h2>
</div></div></div>
<h3><a id="setup-prerequisites"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-php/edit/main/docs/setup.asciidoc">edit</a></h3>
<h4><a id="_operating_system_and_architecture"></a>Operating system and architecture<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-php/edit/main/docs/setup.asciidoc">edit</a></h4>
<p>We officially support Linux systems (glibc, deb and rpm packages) and Alpine Linux (musl libc - apk packages) for x86_64 (AMD64) processors.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Experimentally, we also provide packages for the ARM64 architecture - please note that these packages have not been fully tested.</p>
</div>
</div>
<h4><a id="_php"></a>PHP<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-php/edit/main/docs/setup.asciidoc">edit</a></h4>
<p>The agent supports PHP versions 7.2-8.3.</p>
<h4><a id="_curl"></a>curl<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-php/edit/main/docs/setup.asciidoc">edit</a></h4>
<p>The agent requires <code class="literal">libcurl</code> 7.58 or later.</p>
<h3><a id="setup-installation"></a>Installation<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-php/edit/main/docs/setup.asciidoc">edit</a></h3>
<p>Install the agent using one of the <a href="https://github.com/elastic/apm-agent-php/releases/latest" class="ulink" target="_top">packages for supported platforms</a>.</p>
<h4><a id="setup-rpm"></a>Using RPM package (RHEL/CentOS, Fedora)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-php/edit/main/docs/setup.asciidoc">edit</a></h4>
<div class="pre_wrapper lang-bash">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-bash">rpm -ivh &lt;package-file&gt;.rpm</pre>
</div>
<h4><a id="setup-deb"></a>Using DEB package (Debian, Ubuntu 18+)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-php/edit/main/docs/setup.asciidoc">edit</a></h4>
<div class="pre_wrapper lang-bash">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-bash">dpkg -i &lt;package-file&gt;.deb</pre>
</div>
<h4><a id="setup-apk"></a>Using APK package (Alpine)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-php/edit/main/docs/setup.asciidoc">edit</a></h4>
<div class="pre_wrapper lang-bash">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-bash">apk add --allow-untrusted &lt;package-file&gt;.apk</pre>
</div>
<h4><a id="build-from-source"></a>Build from source<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-php/edit/main/docs/setup.asciidoc">edit</a></h4>
<p>If you can’t find your distribution, you can install the agent by building it from the source.
The following instructions will build the APM agent using the same docker environment that Elastic uses to build our official packages.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The agent is currently only available for Linux operating system.</p>
</div>
</div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Download the agent source from <a href="https://github.com/elastic/apm-agent-php/" class="ulink" target="_top">https://github.com/elastic/apm-agent-php/</a>.
</li>
<li class="listitem">
Execute the following commands to build the agent and install it:
</li>
</ol>
</div>
<div class="pre_wrapper lang-bash">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-bash">cd apm-agent-php
# for linux glibc - libc distributions (Ubuntu, Redhat, etc)
export BUILD_ARCHITECTURE=linux-x86-64
# for linux with musl - libc distributions (Alpine)
export BUILD_ARCHITECTURE=linuxmusl-x86-64
# provide a path to php-config tool
export PHP_CONFIG=php-config

# build extensions
make -f .ci/Makefile build

# run extension tests
PHP_VERSION=`$PHP_CONFIG --version | cut -d'.' -f 1,2` make -f .ci/Makefile run-phpt-tests

# install agent extensions
sudo cp agent/native/_build/${BUILD_ARCHITECTURE}-release/ext/elastic_apm-*.so `$PHP_CONFIG --extension-dir`

# install automatic loader
sudo cp agent/native/_build/${BUILD_ARCHITECTURE}-release/loader/code/elastic_apm_loader.so `$PHP_CONFIG --extension-dir`</pre>
</div>
<p>Enable the extension by adding the following to your <code class="literal">php.ini</code> file:</p>
<div class="pre_wrapper lang-ini">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ini">extension=elastic_apm_loader.so
elastic_apm.bootstrap_php_part_file=&lt;repo root&gt;/agent/php/bootstrap_php_part.php</pre>
</div>
<p>To work, the agent needs both the built <code class="literal">elastic_apm-*.so</code>
and the downloaded source files.
So if you would like to build <code class="literal">elastic_apm-*.so</code> on one machine and
then deploy it on a different machine, you will need to copy both
the built <code class="literal">elastic_apm-*.so</code> and the downloaded source files.</p>
<h3><a id="limitations"></a>Limitations<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-php/edit/main/docs/setup.asciidoc">edit</a></h3>
<h4><a id="limitation-open_basedir"></a><code class="literal">open_basedir</code> PHP configuration option<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-agent-php/edit/main/docs/setup.asciidoc">edit</a></h4>
<p>Please be aware that if the <a href="https://www.php.net/manual/en/ini.core.php#ini.open-basedir" class="ulink" target="_top"><code class="literal">open_basedir</code></a>
option is configured in your php.ini,
the installation directory of the agent (by default <code class="literal">/opt/elastic/apm-agent-php</code>)
must be located within a path included in the
<a href="https://www.php.net/manual/en/ini.core.php#ini.open-basedir" class="ulink" target="_top"><code class="literal">open_basedir</code></a> value.
Otherwise, the agent will not be loaded correctly.</p>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="intro.html">« Introduction</a>
</span>
<span class="next">
<a href="supported-technologies.html">Supported technologies »</a>
</span>
</div>
</body>
</html>
