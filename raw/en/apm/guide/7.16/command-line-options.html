<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>APM Server command reference | APM User Guide [7.16] | Elastic</title>
<meta class="elastic" name="content" content="APM Server command reference | APM User Guide [7.16]">

<link rel="home" href="index.html" title="APM User Guide [7.16]"/>
<link rel="up" href="setting-up-and-running.html" title="Set up APM Server"/>
<link rel="prev" href="keystore.html" title="Secrets keystore for secure settings"/>
<link rel="next" href="high-availability.html" title="High Availability"/>
<meta class="elastic" name="product_version" content="7.16"/>
<meta class="elastic" name="product_name" content="APM"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/APM Guide/7.16"/>
<meta name="DC.subject" content="APM"/>
<meta name="DC.identifier" content="7.16"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body><div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link">
  <div id="related-products" class="dropdown">
  <div class="related-products-title">APM:</div>
  <div class="dropdown-anchor" tabindex="0">User Guide<span class="dropdown-icon"></span></div>
  <div class="dropdown-content">
  <ul>
  <li class="dropdown-category">APM</li>
  <ul>
  <li><a href="/guide/en/observability/current/apm.html">Observability › APM</a></li>
  </ul>
  <li class="dropdown-category">APM agents</li>
  <ul>
  <li><a href="/guide/en/apm/agent/android/current/intro.html">Android Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/go/current/introduction.html">Go Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/swift/current/intro.html">iOS Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/java/current/intro.html">Java Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/dotnet/current/intro.html">.NET Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/nodejs/current/intro.html">Node.js Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/php/current/intro.html">PHP Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/python/current/getting-started.html">Python Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/ruby/current/introduction.html">Ruby Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/rum-js/current/intro.html">Real User Monitoring JavaScript Agent Reference</a></li>
  </ul>
  <li class="dropdown-category">APM extensions</li>
  <ul>
  <li><a href="/guide/en/apm/lambda/current/aws-lambda-arch.html">AWS Lambda extension</a></li>
  <li><a href="/guide/en/apm/attacher/current/apm-attacher.html">Attacher</a></li>
  </ul>
  </ul>
  </div>
  </div>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="overview.html">Legacy APM Server Reference</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="setting-up-and-running.html">Set up APM Server</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="keystore.html">« Secrets keystore for secure settings</a>
</span>
<span class="next">
<a href="high-availability.html">High Availability »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="command-line-options"></a>APM Server command reference<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/7.16/docs/en/apm-server/legacy/copied-from-beats/docs/command-reference.asciidoc">edit</a></h2>
</div></div></div>

<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>This documentation refers to configuring the standalone (legacy) APM Server. This method of running APM Server will be deprecated and removed in a future release. Please consider <a class="xref" href="upgrade-to-apm-integration.html" title="Switch to the Elastic APM integration">upgrading to Fleet and the APM integration</a>.</p>
</div>
</div>
<p>APM Server provides a command-line interface for starting APM Server and
performing common tasks, like testing configuration files.</p>
<p>The command-line also supports <a class="xref" href="command-line-options.html#global-flags" title="Global flags">global flags</a>
for controlling global behaviors.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>Use <code class="literal">sudo</code> to run the following commands if:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
the config file is owned by <code class="literal">root</code>, or
</li>
<li class="listitem">
APM Server is configured to capture data that requires <code class="literal">root</code> access
</li>
</ul>
</div>
</div>
</div>
<p>Some of the features described here require an Elastic license. For
more information, see <a href="/subscriptions" class="ulink" target="_top">https://www.elastic.co/subscriptions</a> and
<a href="/guide/en/kibana/7.16/managing-licenses.html" class="ulink" target="_top">License Management</a>.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Commands</th>
<th align="left" valign="top"></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><a class="xref" href="command-line-options.html#apikey-command" title="apikey command"><code class="literal">apikey</code></a></p></td>
<td align="left" valign="top"><p>Manage API Keys for communication between APM agents and server..</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="command-line-options.html#export-command" title="export command"><code class="literal">export</code></a></p></td>
<td align="left" valign="top"><p>Exports the configuration, index template, or ILM policy to stdout.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="command-line-options.html#help-command" title="help command"><code class="literal">help</code></a></p></td>
<td align="left" valign="top"><p>Shows help for any command.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="command-line-options.html#keystore-command" title="keystore command"><code class="literal">keystore</code></a></p></td>
<td align="left" valign="top"><p>Manages the <a class="xref" href="keystore.html" title="Secrets keystore for secure settings">secrets keystore</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="command-line-options.html#run-command" title="run command"><code class="literal">run</code></a></p></td>
<td align="left" valign="top"><p>Runs APM Server. This command is used by default if you start APM Server without specifying a command.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="command-line-options.html#setup-command" title="setup command"><code class="literal">setup</code></a></p></td>
<td align="left" valign="top"><p>Sets up the initial environment, including the ES index template, and ILM policy and write alias.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="command-line-options.html#test-command" title="test command"><code class="literal">test</code></a></p></td>
<td align="left" valign="top"><p>Tests the configuration.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="command-line-options.html#version-command" title="version command"><code class="literal">version</code></a></p></td>
<td align="left" valign="top"><p>Shows information about the current version.</p></td>
</tr>
</tbody>
</table>
</div>
<p>Also see <a class="xref" href="command-line-options.html#global-flags" title="Global flags">Global flags</a>.</p>
<h4><a id="apikey-command"></a><code class="literal">apikey</code> command<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/7.16/docs/en/apm-server/legacy/copied-from-beats/docs/command-reference.asciidoc">edit</a></h4>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in technical preview and may be changed or removed in a future release. Elastic will work to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.</p>
</div>
</div>
<p>Communication between APM agents and APM Server now supports sending an
<a class="xref" href="api-key-legacy.html" title="API keys">API Key in the Authorization header</a>.
APM Server provides an <code class="literal">apikey</code> command that can create, verify, invalidate,
and show information about API Keys for agent/server communication.
Most operations require the <code class="literal">manage_own_api_key</code> cluster privilege,
and you must ensure that <code class="literal">apm-server.api_key</code> or <code class="literal">output.elasticsearch</code> are configured appropriately.</p>
<p><span class="strong strong"><strong>SYNOPSIS</strong></span></p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">apm-server apikey SUBCOMMAND [FLAGS]</pre>
</div>
<p><span class="strong strong"><strong>SUBCOMMANDS</strong></span></p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">create</code></strong></span>
</span>
</dt>
<dd>
<p>
Create an API Key with the specified privilege(s). No required flags.
</p>
<p>The user requesting to create an API Key needs to have APM privileges used by the APM Server.
A superuser, by default, has these privileges. For other users,
you can create them. See <a class="xref" href="privileges-api-key.html" title="Grant privileges and roles needed for API key management">create an API key user</a> for required privileges.</p>
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">info</code></strong></span>
</span>
</dt>
<dd>
Query API Key(s). <code class="literal">--id</code> or <code class="literal">--name</code> required.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">invalidate</code></strong></span>
</span>
</dt>
<dd>
Invalidate API Key(s). <code class="literal">--id</code> or <code class="literal">--name</code> required.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">verify</code></strong></span>
</span>
</dt>
<dd>
Check if a credentials string has the given privilege(s).
 <code class="literal">--credentials</code> required.
</dd>
</dl>
</div>
<p><span class="strong strong"><strong>FLAGS</strong></span></p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">--agent-config</code></strong></span>
</span>
</dt>
<dd>
Required for agents to read configuration remotely. Valid with the <code class="literal">create</code> and <code class="literal">verify</code> subcommands.
When used with <code class="literal">create</code>, gives the <code class="literal">config_agent:read</code> privilege to the created key.
When used with <code class="literal">verify</code>, asks for the <code class="literal">config_agent:read</code> privilege.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">--credentials CREDS</code></strong></span>
</span>
</dt>
<dd>
Required for the <code class="literal">verify</code> subcommand. Specifies the credentials for which to to check privileges.
Credentials are the base64 encoded representation of the API key&#8217;s <code class="literal">id:api_key</code>.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">--expiration TIME</code></strong></span>
</span>
</dt>
<dd>
When used with <code class="literal">create</code>, specifies the expiration for the key, e.g., "1d" (default never).
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">--id ID</code></strong></span>
</span>
</dt>
<dd>
ID of the API key. Valid with the <code class="literal">info</code> and <code class="literal">invalidate</code> subcommands.
When used with <code class="literal">info</code>, queries the specified ID.
When used with <code class="literal">invalidate</code>, deletes the specified ID.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">--ingest</code></strong></span>
</span>
</dt>
<dd>
Required for ingesting events. Valid with the <code class="literal">create</code> and <code class="literal">verify</code> subcommands.
When used with <code class="literal">create</code>, gives the <code class="literal">event:write</code> privilege to the created key.
When used with <code class="literal">verify</code>, asks for the <code class="literal">event:write</code> privilege.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">--json</code></strong></span>
</span>
</dt>
<dd>
Prints the output of the command as JSON.
Valid with all <code class="literal">apikey</code> subcommands.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">--name NAME</code></strong></span>
</span>
</dt>
<dd>
Name of the API key(s). Valid with the <code class="literal">create</code>, <code class="literal">info</code>, and <code class="literal">invalidate</code> subcommands.
When used with <code class="literal">create</code>, specifies the name of the API key to be created (default: "apm-key").
When used with <code class="literal">info</code>, specifies the API key to query (multiple matches are possible).
When used with <code class="literal">invalidate</code>, specifies the API key to delete (multiple matches are possible).
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">--sourcemap</code></strong></span>
</span>
</dt>
<dd>
Required for uploading sourcemaps. Valid with the <code class="literal">create</code> and <code class="literal">verify</code> subcommands.
When used with <code class="literal">create</code>, gives the <code class="literal">sourcemap:write</code> privilege to the created key.
When used with <code class="literal">verify</code>, asks for the <code class="literal">sourcemap:write</code> privilege.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">--valid-only</code></strong></span>
</span>
</dt>
<dd>
When used with <code class="literal">info</code>, only returns valid API Keys (not expired or invalidated).
</dd>
</dl>
</div>
<p>Also see <a class="xref" href="command-line-options.html#global-flags" title="Global flags">Global flags</a>.</p>
<p><span class="strong strong"><strong>EXAMPLES</strong></span></p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">apm-server apikey create --ingest --agent-config --name example-001
apm-server apikey info --name example-001 --valid-only
apm-server apikey invalidate --name example-001</pre>
</div>
<p>For more information, see <a class="xref" href="api-key-legacy.html" title="API keys">API keys</a>.</p>
<h4><a id="export-command"></a><code class="literal">export</code> command<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/7.16/docs/en/apm-server/legacy/copied-from-beats/docs/command-reference.asciidoc">edit</a></h4>
<p>Exports the configuration, index template, or ILM policy to stdout. You can use this
command to quickly view your configuration or see the contents of the index
template or the ILM policy.</p>
<p><span class="strong strong"><strong>SYNOPSIS</strong></span></p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">apm-server export SUBCOMMAND [FLAGS]</pre>
</div>
<p><span class="strong strong"><strong>SUBCOMMANDS</strong></span></p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">config</code></strong></span>
</span>
</dt>
<dd>
Exports the current configuration to stdout. If you use the <code class="literal">-c</code> flag, this
command exports the configuration that&#8217;s defined in the specified file.
</dd>
<dt>
<span class="term">
<a id="template-subcommand"></a><span class="strong strong"><strong><code class="literal">template</code></strong></span>
</span>
</dt>
<dd>
Exports the index template to stdout. You can specify the <code class="literal">--es.version</code> and
<code class="literal">--index</code> flags to further define what gets exported. Furthermore you can export
the template to a file instead of <code class="literal">stdout</code> by defining a directory via <code class="literal">--dir</code>.
</dd>
</dl>
</div>
<div class="variablelist">
<a id="ilm-policy-subcommand"></a>
<dl class="variablelist">
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">ilm-policy</code></strong></span>
</span>
</dt>
<dd>
Exports the index lifecycle management policy to stdout. You can specify the
<code class="literal">--es.version</code> and a <code class="literal">--dir</code> to which the policy should be exported as a
file rather than exporting to <code class="literal">stdout</code>.
</dd>
</dl>
</div>
<p><span class="strong strong"><strong>FLAGS</strong></span></p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">--es.version VERSION</code></strong></span>
</span>
</dt>
<dd>
When used with <a class="xref" href="command-line-options.html#template-subcommand"><code class="literal">template</code></a>, exports an index
template that is compatible with the specified version.
When used with <a class="xref" href="command-line-options.html#ilm-policy-subcommand"><code class="literal">ilm-policy</code></a>, exports the ILM policy
if the specified ES version is enabled for ILM.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">-h, --help</code></strong></span>
</span>
</dt>
<dd>
Shows help for the <code class="literal">export</code> command.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">--index BASE_NAME</code></strong></span>
</span>
</dt>
<dd>
When used with <a class="xref" href="command-line-options.html#template-subcommand"><code class="literal">template</code></a>, sets the base name to use for
the index template. If this flag is not specified, the default base name is
<code class="literal">apm-server</code>.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">--dir DIRNAME</code></strong></span>
</span>
</dt>
<dd>
Define a directory to which the template and ILM policy should be exported to
as files instead of printing them to <code class="literal">stdout</code>.
</dd>
</dl>
</div>
<p>Also see <a class="xref" href="command-line-options.html#global-flags" title="Global flags">Global flags</a>.</p>
<p><span class="strong strong"><strong>EXAMPLES</strong></span></p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">apm-server export config
apm-server export template --es.version 7.16.3 --index myindexname</pre>
</div>
<h4><a id="help-command"></a><code class="literal">help</code> command<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/7.16/docs/en/apm-server/legacy/copied-from-beats/docs/command-reference.asciidoc">edit</a></h4>
<p>Shows help for any command.
If no command is specified, shows help for the <code class="literal">run</code> command.</p>
<p><span class="strong strong"><strong>SYNOPSIS</strong></span></p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">apm-server help COMMAND_NAME [FLAGS]</pre>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">COMMAND_NAME</code></strong></span>
</span>
</dt>
<dd>
Specifies the name of the command to show help for.
</dd>
</dl>
</div>
<p><span class="strong strong"><strong>FLAGS</strong></span></p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">-h, --help</code></strong></span>
</span>
</dt>
<dd>
Shows help for the <code class="literal">help</code> command.
</dd>
</dl>
</div>
<p>Also see <a class="xref" href="command-line-options.html#global-flags" title="Global flags">Global flags</a>.</p>
<p><span class="strong strong"><strong>EXAMPLE</strong></span></p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">apm-server help export</pre>
</div>
<h4><a id="keystore-command"></a><code class="literal">keystore</code> command<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/7.16/docs/en/apm-server/legacy/copied-from-beats/docs/command-reference.asciidoc">edit</a></h4>
<p>Manages the <a class="xref" href="keystore.html" title="Secrets keystore for secure settings">secrets keystore</a>.</p>
<p><span class="strong strong"><strong>SYNOPSIS</strong></span></p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">apm-server keystore SUBCOMMAND [FLAGS]</pre>
</div>
<p><span class="strong strong"><strong>SUBCOMMANDS</strong></span></p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">add KEY</code></strong></span>
</span>
</dt>
<dd>
Adds the specified key to the keystore. Use the <code class="literal">--force</code> flag to overwrite an
existing key. Use the <code class="literal">--stdin</code> flag to pass the value through <code class="literal">stdin</code>.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">create</code></strong></span>
</span>
</dt>
<dd>
Creates a keystore to hold secrets. Use the <code class="literal">--force</code> flag to overwrite the
existing keystore.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">list</code></strong></span>
</span>
</dt>
<dd>
Lists the keys in the keystore.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">remove KEY</code></strong></span>
</span>
</dt>
<dd>
Removes the specified key from the keystore.
</dd>
</dl>
</div>
<p><span class="strong strong"><strong>FLAGS</strong></span></p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">--force</code></strong></span>
</span>
</dt>
<dd>
Valid with the <code class="literal">add</code> and <code class="literal">create</code> subcommands. When used with <code class="literal">add</code>, overwrites
the specified key. When used with <code class="literal">create</code>, overwrites the keystore.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">--stdin</code></strong></span>
</span>
</dt>
<dd>
When used with <code class="literal">add</code>, uses the stdin as the source of the key&#8217;s value.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">-h, --help</code></strong></span>
</span>
</dt>
<dd>
Shows help for the <code class="literal">keystore</code> command.
</dd>
</dl>
</div>
<p>Also see <a class="xref" href="command-line-options.html#global-flags" title="Global flags">Global flags</a>.</p>
<p><span class="strong strong"><strong>EXAMPLES</strong></span></p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">apm-server keystore create
apm-server keystore add ES_PWD
apm-server keystore remove ES_PWD
apm-server keystore list</pre>
</div>
<p>See <a class="xref" href="keystore.html" title="Secrets keystore for secure settings">Secrets keystore</a> for more examples.</p>
<h4><a id="run-command"></a><code class="literal">run</code> command<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/7.16/docs/en/apm-server/legacy/copied-from-beats/docs/command-reference.asciidoc">edit</a></h4>
<p>Runs APM Server. This command is used by default if you start APM Server without specifying a command.</p>
<p><span class="strong strong"><strong>SYNOPSIS</strong></span></p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">apm-server run [FLAGS]</pre>
</div>
<p>Or:</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">apm-server [FLAGS]</pre>
</div>
<p><span class="strong strong"><strong>FLAGS</strong></span></p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">-N, --N</code></strong></span>
</span>
</dt>
<dd>
Disables publishing for testing purposes.
This option disables all outputs except the <a class="xref" href="file-output.html" title="Configure the File output">File output</a>.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">--cpuprofile FILE</code></strong></span>
</span>
</dt>
<dd>
Writes CPU profile data to the specified file. This option is useful for
troubleshooting APM Server.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">-h, --help</code></strong></span>
</span>
</dt>
<dd>
Shows help for the <code class="literal">run</code> command.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">--httpprof [HOST]:PORT</code></strong></span>
</span>
</dt>
<dd>
Starts an http server for profiling. This option is useful for troubleshooting
and profiling APM Server.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">--memprofile FILE</code></strong></span>
</span>
</dt>
<dd>
Writes memory profile data to the specified output file. This option is useful
for troubleshooting APM Server.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">--system.hostfs MOUNT_POINT</code></strong></span>
</span>
</dt>
<dd>
Specifies the mount point of the host&#8217;s filesystem for use in monitoring a host.
</dd>
</dl>
</div>
<p>Also see <a class="xref" href="command-line-options.html#global-flags" title="Global flags">Global flags</a>.</p>
<p><span class="strong strong"><strong>EXAMPLE</strong></span></p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">apm-server run -e</pre>
</div>
<p>Or:</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">apm-server -e</pre>
</div>
<h4><a id="setup-command"></a><code class="literal">setup</code> command<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/7.16/docs/en/apm-server/legacy/copied-from-beats/docs/command-reference.asciidoc">edit</a></h4>
<p>Sets up the initial environment, including the ES index template, and ILM policy and write alias</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
The index template ensures that fields are mapped correctly in Elasticsearch.
If index lifecycle management is enabled it also ensures that the defined ILM policy
and write alias are connected to the indices matching the index template.
The ILM policy takes care of the lifecycle of an index, when to do a rollover,
when to move an index from the hot phase to the next phase, etc.
</li>
</ul>
</div>
<p>This command sets up the environment without actually running
APM Server and ingesting data.</p>
<p><span class="strong strong"><strong>SYNOPSIS</strong></span></p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">apm-server setup [FLAGS]</pre>
</div>
<p><span class="strong strong"><strong>FLAGS</strong></span></p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">-h, --help</code></strong></span>
</span>
</dt>
<dd>
Shows help for the <code class="literal">setup</code> command.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">--index-management</code></strong></span>
</span>
</dt>
<dd>
Sets up components related to Elasticsearch index management including
template, ILM policy, and write alias (if supported and configured).
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">--pipelines</code></strong></span>
</span>
</dt>
<dd>
Registers the <a class="xref" href="configuring-ingest-node.html" title="Parse data using ingest node pipelines">pipeline</a> definitions set in <code class="literal">ingest/pipeline/definition.json</code>.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">--template</code></strong></span>
</span>
</dt>
<dd>
<span class="Admonishment Admonishment--change">
[<span class="Admonishment-version u-mono u-strikethrough">7.2</span>]
<span class="Admonishment-detail">
Deprecated in 7.2.
</span>
</span>
Sets up the index template only.
It is recommended to use <code class="literal">--index-management</code> instead.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">--ilm-policy</code></strong></span>
</span>
</dt>
<dd>
<span class="Admonishment Admonishment--change">
[<span class="Admonishment-version u-mono u-strikethrough">7.2</span>]
<span class="Admonishment-detail">
Deprecated in 7.2.
</span>
</span>
Sets up the index lifecycle management policy.
It is recommended to use <code class="literal">--index-management</code> instead.
</dd>
</dl>
</div>
<p>Also see <a class="xref" href="command-line-options.html#global-flags" title="Global flags">Global flags</a>.</p>
<p><span class="strong strong"><strong>EXAMPLES</strong></span></p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">apm-server setup --index-management
apm-server setup --pipelines</pre>
</div>
<h4><a id="test-command"></a><code class="literal">test</code> command<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/7.16/docs/en/apm-server/legacy/copied-from-beats/docs/command-reference.asciidoc">edit</a></h4>
<p>Tests the configuration.</p>
<p><span class="strong strong"><strong>SYNOPSIS</strong></span></p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">apm-server test SUBCOMMAND [FLAGS]</pre>
</div>
<p><span class="strong strong"><strong>SUBCOMMANDS</strong></span></p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">config</code></strong></span>
</span>
</dt>
<dd>
Tests the configuration settings.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">output</code></strong></span>
</span>
</dt>
<dd>
Tests that APM Server can connect to the output by using the
current settings.
</dd>
</dl>
</div>
<p><span class="strong strong"><strong>FLAGS</strong></span></p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">-h, --help</code></strong></span>
</span>
</dt>
<dd>
Shows help for the <code class="literal">test</code> command.
</dd>
</dl>
</div>
<p>Also see <a class="xref" href="command-line-options.html#global-flags" title="Global flags">Global flags</a>.</p>
<p><span class="strong strong"><strong>EXAMPLE</strong></span></p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">apm-server test config</pre>
</div>
<h4><a id="version-command"></a><code class="literal">version</code> command<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/7.16/docs/en/apm-server/legacy/copied-from-beats/docs/command-reference.asciidoc">edit</a></h4>
<p>Shows information about the current version.</p>
<p><span class="strong strong"><strong>SYNOPSIS</strong></span></p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">apm-server version [FLAGS]</pre>
</div>
<p><span class="strong strong"><strong>FLAGS</strong></span></p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">-h, --help</code></strong></span>
</span>
</dt>
<dd>
Shows help for the <code class="literal">version</code> command.
</dd>
</dl>
</div>
<p>Also see <a class="xref" href="command-line-options.html#global-flags" title="Global flags">Global flags</a>.</p>
<p><span class="strong strong"><strong>EXAMPLE</strong></span></p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">apm-server version</pre>
</div>
<h3><a id="global-flags"></a>Global flags<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/7.16/docs/en/apm-server/legacy/copied-from-beats/docs/command-reference.asciidoc">edit</a></h3>
<p>These global flags are available whenever you run APM Server.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">-E, --E "SETTING_NAME=VALUE"</code></strong></span>
</span>
</dt>
<dd>
<p>
Overrides a specific configuration setting. You can specify multiple overrides.
For example:
</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">apm-server -E "name=mybeat" -E "output.elasticsearch.hosts=['http://myhost:9200']"</pre>
</div>
<p>This setting is applied to the currently running APM Server process.
The APM Server configuration file is not changed.</p>
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">-c, --c FILE</code></strong></span>
</span>
</dt>
<dd>
Specifies the configuration file to use for APM Server. The file you specify
here is relative to <code class="literal">path.config</code>. If the <code class="literal">-c</code> flag is not specified, the
default config file, <code class="literal">apm-server.yml</code>, is used.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">-d, --d SELECTORS</code></strong></span>
</span>
</dt>
<dd>
Enables debugging for the specified selectors. For the selectors, you can
specify a comma-separated
list of components, or you can use <code class="literal">-d "*"</code> to enable debugging for all
components. For example, <code class="literal">-d "publisher"</code> displays all the publisher-related
messages.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">-e, --e</code></strong></span>
</span>
</dt>
<dd>
Logs to stderr and disables syslog/file output.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">-environment</code></strong></span>
</span>
</dt>
<dd>
For logging purposes, specifies the environment that APM Server is running in.
This setting is used to select a default log output when no log output is configured.
Supported values are: <code class="literal">systemd</code>, <code class="literal">container</code>, <code class="literal">macos_service</code>, and <code class="literal">windows_service</code>.
If <code class="literal">systemd</code> or <code class="literal">container</code> is specified, APM Server will log to stdout and stderr
by default.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">--path.config</code></strong></span>
</span>
</dt>
<dd>
Sets the path for configuration files. See the <a class="xref" href="directory-layout.html" title="Directory layout">Directory layout</a> section for
details.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">--path.data</code></strong></span>
</span>
</dt>
<dd>
Sets the path for data files. See the <a class="xref" href="directory-layout.html" title="Directory layout">Directory layout</a> section for details.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">--path.home</code></strong></span>
</span>
</dt>
<dd>
Sets the path for miscellaneous files. See the <a class="xref" href="directory-layout.html" title="Directory layout">Directory layout</a> section for
details.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">--path.logs</code></strong></span>
</span>
</dt>
<dd>
Sets the path for log files. See the <a class="xref" href="directory-layout.html" title="Directory layout">Directory layout</a> section for details.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">--strict.perms</code></strong></span>
</span>
</dt>
<dd>
Sets strict permission checking on configuration files. The default is <code class="literal">-strict.perms=true</code>.
See <a class="xref" href="running-with-systemd.html#config-file-ownership" title="Configuration file ownership">Configuration file ownership</a> for more information.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">-v, --v</code></strong></span>
</span>
</dt>
<dd>
Logs INFO-level messages.
</dd>
</dl>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="keystore.html">« Secrets keystore for secure settings</a>
</span>
<span class="next">
<a href="high-availability.html">High Availability »</a>
</span>
</div>
</div>
</body>
</html>
