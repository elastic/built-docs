<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Collect metrics | APM User Guide [8.10] | Elastic</title>
<meta class="elastic" name="content" content="Collect metrics | APM User Guide [8.10]">

<link rel="home" href="index.html" title="APM User Guide [8.10]"/>
<link rel="up" href="open-telemetry.html" title="OpenTelemetry integration"/>
<link rel="prev" href="open-telemetry-other-env.html" title="AWS Lambda Support"/>
<link rel="next" href="open-telemetry-known-limitations.html" title="Limitations"/>
<meta class="elastic" name="product_version" content="8.10"/>
<meta class="elastic" name="product_name" content="APM"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/APM Guide/8.10"/>
<meta name="DC.subject" content="APM"/>
<meta name="DC.identifier" content="8.10"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div class="navheader">
<span class="prev">
<a href="open-telemetry-other-env.html">« AWS Lambda Support</a>
</span>
<span class="next">
<a href="open-telemetry-known-limitations.html">Limitations »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link">
  <div id="related-products" class="dropdown">
  <div class="related-products-title">APM:</div>
  <div class="dropdown-anchor" tabindex="0">User Guide<span class="dropdown-icon"></span></div>
  <div class="dropdown-content">
  <ul>
  <li class="dropdown-category">APM</li>
  <ul>
  <li><a href="/guide/en/observability/current/apm.html">Observability › APM</a></li>
  </ul>
  <li class="dropdown-category">APM agents</li>
  <ul>
  <li><a href="/guide/en/apm/agent/android/current/intro.html">Android Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/go/current/introduction.html">Go Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/swift/current/intro.html">iOS Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/java/current/intro.html">Java Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/dotnet/current/intro.html">.NET Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/nodejs/current/intro.html">Node.js Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/php/current/intro.html">PHP Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/python/current/getting-started.html">Python Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/ruby/current/introduction.html">Ruby Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/rum-js/current/intro.html">Real User Monitoring JavaScript Agent Reference</a></li>
  </ul>
  <li class="dropdown-category">APM extensions</li>
  <ul>
  <li><a href="/guide/en/apm/lambda/current/aws-lambda-arch.html">AWS Lambda extension</a></li>
  <li><a href="/guide/en/apm/attacher/current/apm-attacher.html">Attacher</a></li>
  </ul>
  </ul>
  </div>
  </div>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="open-telemetry.html">OpenTelemetry integration</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Collect metrics</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.10/docs/en/apm-server/otel-metrics.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div id="url-to-v3" class="version-warning">
    <strong>IMPORTANT</strong>: This documentation is no longer updated. Refer to <a href="https://www.elastic.co/support/eol">Elastic's version policy</a> and the <a href="https://www.elastic.co/docs">latest documentation</a>.
</div>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="open-telemetry-collect-metrics"></a>Collect metrics</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.10/docs/en/apm-server/otel-metrics.asciidoc">edit</a></div>
</div></div></div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>When collecting metrics, please note that the <a href="https://www.javadoc.io/doc/io.opentelemetry/opentelemetry-api/latest/io/opentelemetry/api/metrics/DoubleValueRecorder.html" class="ulink" target="_top"><code class="literal">DoubleValueRecorder</code></a>
and <a href="https://www.javadoc.io/doc/io.opentelemetry/opentelemetry-api/latest/io/opentelemetry/api/metrics/LongValueObserver.html" class="ulink" target="_top"><code class="literal">LongValueRecorder</code></a> metrics are not yet supported.</p>
</div>
</div>
<p>Here&#8217;s an example of how to capture business metrics from a Java application.</p>
<div class="pre_wrapper lang-java">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-java">// initialize metric
Meter meter = GlobalMetricsProvider.getMeter("my-frontend");
DoubleCounter orderValueCounter = meter.doubleCounterBuilder("order_value").build();

public void createOrder(HttpServletRequest request) {

   // create order in the database
   ...
   // increment business metrics for monitoring
   orderValueCounter.add(orderPrice);
}</pre>
</div>
<p>See the <a href="https://github.com/open-telemetry/opentelemetry-specification/blob/main/specification/metrics/api.md" class="ulink" target="_top">Open Telemetry Metrics API</a>
for more information.</p>
<div class="position-relative"><h4><a id="open-telemetry-verify-metrics"></a>Verify OpenTelemetry metrics data</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.10/docs/en/apm-server/otel-metrics.asciidoc">edit</a></div>
<p>Use <span class="strong strong"><strong>Discover</strong></span> to validate that metrics are successfully reported to Kibana.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Launch Kibana:</p>
<div class="tabs" data-tab-group="spin-up-stack">
  <div role="tablist" aria-label="Configure Server">
    <button role="tab"
            aria-selected="true"
            aria-controls="cloud-tab-open-kib"
            id="cloud-open-kib">
      Elasticsearch Service
    </button>
    <button role="tab"
            aria-selected="false"
            aria-controls="self-managed-tab-open-kib"
            id="self-managed-open-kib"
            tabindex="-1">
      Self-managed
    </button>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="cloud-tab-open-kib"
       aria-labelledby="cloud-open-kib">
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<a href="https://cloud.elastic.co/" class="ulink" target="_top">Log in</a> to your Elastic Cloud account.
</li>
<li class="listitem">
Navigate to the Kibana endpoint in your deployment.
</li>
</ol>
</div>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="self-managed-tab-open-kib"
       aria-labelledby="self-managed-open-kib"
       hidden="">
<p>Point your browser to <a href="http://localhost:5601" class="ulink" target="_top">http://localhost:5601</a>, replacing
<code class="literal">localhost</code> with the name of the Kibana host.</p>
  </div>
</div>
</li>
<li class="listitem">
Open the main menu, then click <span class="strong strong"><strong>Discover</strong></span>.
</li>
<li class="listitem">
Select <code class="literal">apm-*</code> as your index pattern.
</li>
<li class="listitem">
Filter the data to only show documents with metrics: <code class="literal">[data_stream][type]: "metrics"</code>
</li>
<li class="listitem">
Narrow your search with a known OpenTelemetry field. For example, if you have an <code class="literal">order_value</code> field, add <code class="literal">order_value: *</code> to your search to return
only OpenTelemetry metrics documents.
</li>
</ol>
</div>
<div class="position-relative"><h4><a id="open-telemetry-visualize"></a>Visualize in Kibana</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.10/docs/en/apm-server/otel-metrics.asciidoc">edit</a></div>
<p>Use <span class="strong strong"><strong>Lens</strong></span> to create visualizations for OpenTelemetry metrics. Lens enables you to build visualizations by dragging and dropping data fields. It makes smart visualization suggestions for your data, allowing you to switch between visualization types.</p>
<p>For more information on using Lens, refer to the <a href="/guide/en/kibana/8.10/lens.html" class="ulink" target="_top">Lens documentation</a>.</p>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="open-telemetry-other-env.html">« AWS Lambda Support</a>
</span>
<span class="next">
<a href="open-telemetry-known-limitations.html">Limitations »</a>
</span>
</div>
</body>
</html>
