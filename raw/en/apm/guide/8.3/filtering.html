<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Built-in data filters | APM User Guide [8.3] | Elastic</title>
<link rel="home" href="index.html" title="APM User Guide [8.3]"/>
<link rel="up" href="apm-data-security.html" title="Data security"/>
<link rel="prev" href="apm-data-security.html" title="Data security"/>
<link rel="next" href="custom-filter.html" title="Custom filters"/>
<meta name="DC.type" content="Learn/Docs/APM Guide/8.3"/>
<meta name="DC.subject" content="APM"/>
<meta name="DC.identifier" content="8.3"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body><div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link">
  <div id="related-products" class="dropdown">
    <div class="related-products-title">APM:</div>
    <div class="dropdown-anchor" tabindex="0">User Guide<span class="dropdown-icon"></span></div>
    <div class="dropdown-content">
      <ul>
        <li class="dropdown-category">APM</li>
        <ul>
          <li><a href="/guide/en/apm/guide/current/apm-overview.html">User Guide</a></li>
        </ul>
        <li class="dropdown-category">APM agents</li>
        <ul>
          <li><a href="/guide/en/apm/agent/android/current/intro.html">Android Agent Reference</a></li>
          <li><a href="/guide/en/apm/agent/go/current/introduction.html">Go Agent Reference</a></li>
          <li><a href="/guide/en/apm/agent/swift/current/intro.html">iOS Agent Reference</a></li>
          <li><a href="/guide/en/apm/agent/java/current/intro.html">Java Agent Reference</a></li>
          <li><a href="/guide/en/apm/agent/dotnet/current/intro.html">.NET Agent Reference</a></li>
          <li><a href="/guide/en/apm/agent/nodejs/current/intro.html">Node.js Agent Reference</a></li>
          <li><a href="/guide/en/apm/agent/php/current/intro.html">PHP Agent Reference</a></li>
          <li><a href="/guide/en/apm/agent/python/current/getting-started.html">Python Agent Reference</a></li>
          <li><a href="/guide/en/apm/agent/ruby/current/introduction.html">Ruby Agent Reference</a></li>
          <li><a href="/guide/en/apm/agent/rum-js/current/intro.html">Real User Monitoring JavaScript Agent Reference</a></li>
        </ul>
        <li class="dropdown-category">APM extensions</li>
        <ul>
          <li><a href="/guide/en/apm/lambda/current/aws-lambda-arch.html">Monitoring AWS Lambda Functions</a></li>
          <li><a href="/guide/en/apm/attacher/current/apm-attacher.html">Attacher</a></li>
        </ul>
      </ul>
    </div>
  </div>
</span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="features.html">Elastic APM features</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="apm-data-security.html">Data security</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="apm-data-security.html">« Data security</a>
</span>
<span class="next">
<a href="custom-filter.html">Custom filters »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="filtering"></a>Built-in data filters<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/apm-server/edit/8.3/docs/apm-data-security.asciidoc">edit</a></h3>
</div></div></div>
<p>Built-in data filters allow you to filter or turn off ingestion of the following types of data:</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Data type</th>
<th align="left" valign="top">Common sensitive data</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><a class="xref" href="filtering.html#filters-http-header" title="HTTP headers">HTTP headers</a></p></td>
<td align="left" valign="top"><p>Passwords, credit card numbers, authorization, etc.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="filtering.html#filters-http-body" title="HTTP bodies">HTTP bodies</a></p></td>
<td align="left" valign="top"><p>Passwords, credit card numbers, etc.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="filtering.html#filters-personal-data" title="Personal data">Personal data</a></p></td>
<td align="left" valign="top"><p>Client IP address and user agent.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="filtering.html#filters-real-user-data" title="Real user monitoring data">Real user monitoring data</a></p></td>
<td align="left" valign="top"><p>URLs visited, click events, user browser errors, resources used, etc.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="filtering.html#filters-database-statements" title="Database statements">Database statements</a></p></td>
<td align="left" valign="top"><p>Sensitive user or business information</p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="filters-http-header"></a>HTTP headers<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/apm-server/edit/8.3/docs/apm-data-security.asciidoc">edit</a></h4>
<p>By default, APM agents capture HTTP request and response headers (including cookies).
Most Elastic APM agents provide the ability to sanitize HTTP header fields,
including cookies and <code class="literal">application/x-www-form-urlencoded</code> data (POST form fields).
Query string and captured request bodies, like <code class="literal">application/json</code> data, are not sanitized.</p>
<p>The default list of sanitized fields attempts to target common field names for data relating to
passwords, credit card numbers, authorization, etc., but can be customized to fit your data.
This sensitive data never leaves the instrumented service.</p>
<p>This setting supports <a href="/guide/en/kibana/8.3/agent-configuration.html" class="ulink" target="_top">Central configuration</a>,
which means the list of sanitized fields can be updated without needing to redeploy your services:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Go: <a href="/guide/en/apm/agent/go/2.x/configuration.html#config-sanitize-field-names" class="ulink" target="_top"><code class="literal">ELASTIC_APM_SANITIZE_FIELD_NAMES</code></a>
</li>
<li class="listitem">
Java: <a href="/guide/en/apm/agent/java/1.x/config-core.html#config-sanitize-field-names" class="ulink" target="_top"><code class="literal">sanitize_field_names</code></a>
</li>
<li class="listitem">
.NET: <a href="/guide/en/apm/agent/dotnet/1.x/config-core.html#config-sanitize-field-names" class="ulink" target="_top"><code class="literal">sanitizeFieldNames</code></a>
</li>
<li class="listitem">
Node.js: <a href="/guide/en/apm/agent/nodejs/3.x/configuration.html#sanitize-field-names" class="ulink" target="_top"><code class="literal">sanitizeFieldNames</code></a>
</li>
<li class="listitem">
Python: <a href="/guide/en/apm/agent/python/6.x/configuration.html#config-sanitize-field-names" class="ulink" target="_top"><code class="literal">sanitize_field_names</code></a>
</li>
<li class="listitem">
Ruby: <a href="/guide/en/apm/agent/ruby/4.x/configuration.html#config-sanitize-field-names" class="ulink" target="_top"><code class="literal">sanitize_field_names</code></a>
</li>
</ul>
</div>
<p>Alternatively, you can completely disable the capturing of HTTP headers.
This setting also supports <a href="/guide/en/kibana/8.3/agent-configuration.html" class="ulink" target="_top">Central configuration</a>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Go: <a href="/guide/en/apm/agent/go/2.x/configuration.html#config-capture-headers" class="ulink" target="_top"><code class="literal">ELASTIC_APM_CAPTURE_HEADERS</code></a>
</li>
<li class="listitem">
Java: <a href="/guide/en/apm/agent/java/1.x/config-core.html#config-capture-headers" class="ulink" target="_top"><code class="literal">capture_headers</code></a>
</li>
<li class="listitem">
.NET: <a href="/guide/en/apm/agent/dotnet/1.x/config-http.html#config-capture-headers" class="ulink" target="_top"><code class="literal">CaptureHeaders</code></a>
</li>
<li class="listitem">
Node.js: <a href="/guide/en/apm/agent/nodejs/3.x/configuration.html#capture-headers" class="ulink" target="_top"><code class="literal">captureHeaders</code></a>
</li>
<li class="listitem">
Python: <a href="/guide/en/apm/agent/python/6.x/configuration.html#config-capture-headers" class="ulink" target="_top"><code class="literal">capture_headers</code></a>
</li>
<li class="listitem">
Ruby: <a href="/guide/en/apm/agent/ruby/4.x/configuration.html#config-capture-headers" class="ulink" target="_top"><code class="literal">capture_headers</code></a>
</li>
</ul>
</div>
<h4><a id="filters-http-body"></a>HTTP bodies<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/apm-server/edit/8.3/docs/apm-data-security.asciidoc">edit</a></h4>
<p>By default, the body of HTTP requests is not recorded.
Request bodies often contain sensitive data like passwords or credit card numbers,
so use care when enabling this feature.</p>
<p>This setting supports <a href="/guide/en/kibana/8.3/agent-configuration.html" class="ulink" target="_top">Central configuration</a>,
which means the list of sanitized fields can be updated without needing to redeploy your services:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Go: <a href="/guide/en/apm/agent/go/2.x/configuration.html#config-capture-body" class="ulink" target="_top"><code class="literal">ELASTIC_APM_CAPTURE_BODY</code></a>
</li>
<li class="listitem">
Java: <a href="/guide/en/apm/agent/java/1.x/config-core.html#config-capture-body" class="ulink" target="_top"><code class="literal">capture_body</code></a>
</li>
<li class="listitem">
.NET: <a href="/guide/en/apm/agent/dotnet/1.x/config-http.html#config-capture-body" class="ulink" target="_top"><code class="literal">CaptureBody</code></a>
</li>
<li class="listitem">
Node.js: <a href="/guide/en/apm/agent/nodejs/3.x//configuration.html#capture-body" class="ulink" target="_top"><code class="literal">captureBody</code></a>
</li>
<li class="listitem">
Python: <a href="/guide/en/apm/agent/python/6.x/configuration.html#config-capture-body" class="ulink" target="_top"><code class="literal">capture_body</code></a>
</li>
<li class="listitem">
Ruby: <a href="/guide/en/apm/agent/ruby/4.x/configuration.html#config-capture-body" class="ulink" target="_top"><code class="literal">capture_body</code></a>
</li>
</ul>
</div>
<h4><a id="filters-personal-data"></a>Personal data<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/apm-server/edit/8.3/docs/apm-data-security.asciidoc">edit</a></h4>
<p>By default, the APM Server captures some personal data associated with trace events:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">client.ip</code>: The client&#8217;s IP address. Typically derived from the HTTP headers of incoming requests.
<code class="literal">client.ip</code> is also used in conjunction with the <a href="/guide/en/elasticsearch/reference/8.3/geoip-processor.html" class="ulink" target="_top"><code class="literal">geoip</code> processor</a> to assign
geographical information to trace events. To learn more about how <code class="literal">client.ip</code> is derived,
see <a class="xref" href="anonymous-auth.html#derive-client-ip" title="Deriving an incoming request&#8217;s client.ip address">Deriving an incoming request&#8217;s <code class="literal">client.ip</code> address</a>.
</li>
<li class="listitem">
<code class="literal">user_agent</code>: User agent data, including the client operating system, device name, vendor, and version.
</li>
</ul>
</div>
<p>The capturing of this data can be turned off by setting
<span class="strong strong"><strong>Capture personal data</strong></span> to <code class="literal">false</code>.</p>
<h4><a id="filters-real-user-data"></a>Real user monitoring data<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/apm-server/edit/8.3/docs/apm-data-security.asciidoc">edit</a></h4>
<p>Protecting user data is important.
For that reason, individual RUM instrumentations can be disabled in the RUM agent with the
<a href="/guide/en/apm/agent/rum-js/5.x/configuration.html#disable-instrumentations" class="ulink" target="_top"><code class="literal">disableInstrumentations</code></a> configuration variable.
Disabled instrumentations produce no spans or transactions.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Disable</th>
<th align="left" valign="top">Configuration value</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>HTTP requests</p></td>
<td align="left" valign="top"><p><code class="literal">fetch</code> and <code class="literal">xmlhttprequest</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Page load metrics including static resources</p></td>
<td align="left" valign="top"><p><code class="literal">page-load</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>JavaScript errors on the browser</p></td>
<td align="left" valign="top"><p><code class="literal">error</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>User click events including URLs visited, mouse clicks, and navigation events</p></td>
<td align="left" valign="top"><p><code class="literal">eventtarget</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Single page application route changes</p></td>
<td align="left" valign="top"><p><code class="literal">history</code></p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="filters-database-statements"></a>Database statements<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/apm-server/edit/8.3/docs/apm-data-security.asciidoc">edit</a></h4>
<p>For SQL databases, APM agents do not capture the parameters of prepared statements.
Note that Elastic APM currently does not make an effort to strip parameters of regular statements.
Not using prepared statements makes your code vulnerable to SQL injection attacks,
so be sure to use prepared statements.</p>
<p>For non-SQL data stores, such as Elasticsearch or MongoDB,
Elastic APM captures the full statement for queries.
For inserts or updates, the full document is not stored.
To filter or obfuscate data in non-SQL database statements,
or to remove the statement entirely,
you can set up an ingest node pipeline.</p>
<h4><a id="filters-agent-specific"></a>Agent-specific options<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/apm-server/edit/8.3/docs/apm-data-security.asciidoc">edit</a></h4>
<p>Certain agents offer additional filtering and obfuscating options:</p>
<p><span class="strong strong"><strong>Agent configuration options</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
(Node.js) Remove errors raised by the server-side process:
disable with <a href="/guide/en/apm/agent/nodejs/3.x/configuration.html#capture-exceptions" class="ulink" target="_top">captureExceptions</a>.
</li>
<li class="listitem">
(Java) Remove process arguments from transactions:
disabled by default with <a href="/guide/en/apm/agent/java/1.x/config-reporter.html#config-include-process-args" class="ulink" target="_top"><code class="literal">include_process_args</code></a>.
</li>
</ul>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="apm-data-security.html">« Data security</a>
</span>
<span class="next">
<a href="custom-filter.html">Custom filters »</a>
</span>
</div>
</div>
</body>
</html>
