<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Switch an Elastic Cloud cluster to the APM integration | APM User Guide [8.7] | Elastic</title>
<meta class="elastic" name="content" content="Switch an Elastic Cloud cluster to the APM integration | APM User Guide [8.7]">

<link rel="home" href="index.html" title="APM User Guide [8.7]"/>
<link rel="up" href="upgrade-to-apm-integration.html" title="Switch to the Elastic APM integration"/>
<link rel="prev" href="apm-integration-upgrade-steps.html" title="Switch a self-installation to the APM integration"/>
<link rel="next" href="release-notes.html" title="Release notes"/>
<meta class="elastic" name="product_version" content="8.7"/>
<meta class="elastic" name="product_name" content="APM"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/APM Guide/8.7"/>
<meta name="DC.subject" content="APM"/>
<meta name="DC.identifier" content="8.7"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body><div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link">
  <div id="related-products" class="dropdown">
    <div class="related-products-title">APM:</div>
    <div class="dropdown-anchor" tabindex="0">User Guide<span class="dropdown-icon"></span></div>
    <div class="dropdown-content">
      <ul>
        <li class="dropdown-category">APM</li>
        <ul>
          <li><a href="/guide/en/apm/guide/current/apm-overview.html">User Guide</a></li>
        </ul>
        <li class="dropdown-category">APM agents</li>
        <ul>
          <li><a href="/guide/en/apm/agent/android/current/intro.html">Android Agent Reference</a></li>
          <li><a href="/guide/en/apm/agent/go/current/introduction.html">Go Agent Reference</a></li>
          <li><a href="/guide/en/apm/agent/swift/current/intro.html">iOS Agent Reference</a></li>
          <li><a href="/guide/en/apm/agent/java/current/intro.html">Java Agent Reference</a></li>
          <li><a href="/guide/en/apm/agent/dotnet/current/intro.html">.NET Agent Reference</a></li>
          <li><a href="/guide/en/apm/agent/nodejs/current/intro.html">Node.js Agent Reference</a></li>
          <li><a href="/guide/en/apm/agent/php/current/intro.html">PHP Agent Reference</a></li>
          <li><a href="/guide/en/apm/agent/python/current/getting-started.html">Python Agent Reference</a></li>
          <li><a href="/guide/en/apm/agent/ruby/current/introduction.html">Ruby Agent Reference</a></li>
          <li><a href="/guide/en/apm/agent/rum-js/current/intro.html">Real User Monitoring JavaScript Agent Reference</a></li>
        </ul>
        <li class="dropdown-category">APM extensions</li>
        <ul>
          <li><a href="/guide/en/apm/lambda/current/aws-lambda-arch.html">Monitoring AWS Lambda Functions</a></li>
          <li><a href="/guide/en/apm/attacher/current/apm-attacher.html">Attacher</a></li>
        </ul>
      </ul>
    </div>
  </div>
</span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="upgrade.html">Upgrade</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="upgrade-to-apm-integration.html">Switch to the Elastic APM integration</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="apm-integration-upgrade-steps.html">« Switch a self-installation to the APM integration</a>
</span>
<span class="next">
<a href="release-notes.html">Release notes »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="apm-integration-upgrade-steps-ess"></a>Switch an Elastic Cloud cluster to the APM integration<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/apm-server/edit/8.7/docs/upgrading-to-integration.asciidoc">edit</a></h3>
</div></div></div>

<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<a class="xref" href="apm-integration-upgrade-steps-ess.html#apm-integration-upgrade-ess-1" title="Upgrade the Elastic Stack">Upgrade the Elastic Stack</a>
</li>
<li class="listitem">
<a class="xref" href="apm-integration-upgrade-steps-ess.html#apm-integration-upgrade-ess-2" title="Switch to Elastic Agent">Switch to Elastic Agent</a>
</li>
<li class="listitem">
<a class="xref" href="apm-integration-upgrade-steps-ess.html#apm-integration-upgrade-ess-3" title="Configure the APM integration">Configure the APM integration</a>
</li>
<li class="listitem">
<a class="xref" href="apm-integration-upgrade-steps-ess.html#apm-integration-upgrade-ess-4" title="Scale APM and Fleet">Scale APM and Fleet</a>
</li>
</ol>
</div>
<h4><a id="apm-integration-upgrade-ess-1"></a>Upgrade the Elastic Stack<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/apm-server/edit/8.7/docs/upgrading-to-integration.asciidoc">edit</a></h4>
<p>Use the Elastic Cloud console to upgrade the Elastic Stack to version 8.7.0.
See the <a href="/guide/en/cloud/current/ec-upgrade-deployment.html" class="ulink" target="_top">Elasticsearch Service upgrade guide</a> for details.</p>
<h4><a id="apm-integration-upgrade-ess-2"></a>Switch to Elastic Agent<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/apm-server/edit/8.7/docs/upgrading-to-integration.asciidoc">edit</a></h4>
<p>APM data collection will be interrupted while the migration is in progress.
The process of migrating should only take a few minutes.</p>
<p>With a Superuser account, complete the following steps:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>In Kibana, navigate to <span class="strong strong"><strong>Observability</strong></span> &gt; <span class="strong strong"><strong>APM</strong></span> &gt; <span class="strong strong"><strong>Settings</strong></span> &gt; <span class="strong strong"><strong>Schema</strong></span>.</p>
<div class="imageblock">
<div class="content">
<img src="./images/schema-agent.png" alt="switch to Elastic Agent">
</div>
</div>
</li>
<li class="listitem">
<p>Click <span class="strong strong"><strong>Switch to Elastic Agent</strong></span>.
Make a note of the <code class="literal">apm-server.yml</code> user settings that are incompatible with Elastic Agent.
Check the confirmation box and click <span class="strong strong"><strong>Switch to Elastic Agent</strong></span>.</p>
<div class="imageblock">
<div class="content">
<img src="./images/agent-settings-migration.png" alt="Elastic Agent settings migration">
</div>
</div>
</li>
</ol>
</div>
<p>Elastic Cloud will now create a Fleet Server instance to contain the new APM integration,
and then will shut down the old APM server instance.
Within minutes your data should begin appearing in the APM app again.</p>
<h4><a id="apm-integration-upgrade-ess-3"></a>Configure the APM integration<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/apm-server/edit/8.7/docs/upgrading-to-integration.asciidoc">edit</a></h4>
<p>You can now update settings that were removed during the upgrade.
See <a class="xref" href="input-apm.html" title="APM input settings"><em>Input settings</em></a> for a reference of all available settings.</p>
<p>In Kibana, navigate to <span class="strong strong"><strong>Management</strong></span> &gt; <span class="strong strong"><strong>Fleet</strong></span>.
Select the <span class="strong strong"><strong>Elastic Cloud Agent Policy</strong></span>.
Next to the <span class="strong strong"><strong>Elastic APM</strong></span> integration, select <span class="strong strong"><strong>Actions</strong></span> &gt; <span class="strong strong"><strong>Edit integration</strong></span>.</p>
<h4><a id="apm-integration-upgrade-ess-4"></a>Scale APM and Fleet<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/apm-server/edit/8.7/docs/upgrading-to-integration.asciidoc">edit</a></h4>
<p>Certain Elasticsearch output configuration options are not available with the APM integration.
To ensure data is not lost, you can scale APM and Fleet up and out.
APM&#8217;s capacity to process events increases with the instance memory size.</p>
<p>Go to the <a href="https://cloud.elastic.co?baymax=docs-body&amp;elektra=docs" class="ulink" target="_top">Elastic Cloud console</a>, select your deployment and click <span class="strong strong"><strong>Edit</strong></span>.
Here you can edit the number and size of each availability zone.</p>
<div class="imageblock">
<div class="content">
<img src="./images/scale-apm.png" alt="scale APM">
</div>
</div>
<p>Congratulations -- you now have the latest and greatest in Elastic APM!</p>
</div>
<div class="navfooter">
<span class="prev">
<a href="apm-integration-upgrade-steps.html">« Switch a self-installation to the APM integration</a>
</span>
<span class="next">
<a href="release-notes.html">Release notes »</a>
</span>
</div>
</div>
</body>
</html>
