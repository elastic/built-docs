<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Metrics | APM User Guide [master] | Elastic</title>
<meta class="elastic" name="content" content="Metrics | APM User Guide [master]">

<link rel="home" href="index.html" title="APM User Guide [master]"/>
<link rel="up" href="data-model.html" title="Data Model"/>
<link rel="prev" href="data-model-errors.html" title="Errors"/>
<link rel="next" href="data-model-metadata.html" title="Metadata"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="APM"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/APM Guide/master"/>
<meta name="DC.subject" content="APM"/>
<meta name="DC.identifier" content="master"/>
</head>
<body><div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link">
  <div id="related-products" class="dropdown">
  <div class="related-products-title">APM:</div>
  <div class="dropdown-anchor" tabindex="0">User Guide<span class="dropdown-icon"></span></div>
  <div class="dropdown-content">
  <ul>
  <li class="dropdown-category">APM</li>
  <ul>
  <li><a href="/guide/en/apm/guide/current/apm-overview.html">User Guide</a></li>
  </ul>
  <li class="dropdown-category">APM agents</li>
  <ul>
  <li><a href="/guide/en/apm/agent/android/current/intro.html">Android Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/go/current/introduction.html">Go Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/swift/current/intro.html">iOS Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/java/current/intro.html">Java Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/dotnet/current/intro.html">.NET Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/nodejs/current/intro.html">Node.js Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/php/current/intro.html">PHP Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/python/current/getting-started.html">Python Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/ruby/current/introduction.html">Ruby Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/rum-js/current/intro.html">Real User Monitoring JavaScript Agent Reference</a></li>
  </ul>
  <li class="dropdown-category">APM extensions</li>
  <ul>
  <li><a href="/guide/en/apm/lambda/current/aws-lambda-arch.html">Monitoring AWS Lambda Functions</a></li>
  <li><a href="/guide/en/apm/attacher/current/apm-attacher.html">Attacher</a></li>
  </ul>
  </ul>
  </div>
  </div>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="data-model.html">Data Model</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="data-model-errors.html">« Errors</a>
</span>
<span class="next">
<a href="data-model-metadata.html">Metadata »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="data-model-metrics"></a>Metrics<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/main/docs/data-model.asciidoc">edit</a></h2>
</div></div></div>
<p><span class="strong strong"><strong>Metrics</strong></span> measure the state of a system by gathering information on a regular interval. There are two types of APM metrics:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>System metrics</strong></span>: Basic infrastructure and application metrics.
</li>
<li class="listitem">
<span class="strong strong"><strong>Calculated metrics</strong></span>: Aggregated trace event metrics used to power visualizations in the APM app.
</li>
</ul>
</div>
<h4><a id="_system_metrics"></a>System metrics<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/main/docs/data-model.asciidoc">edit</a></h4>
<p>APM agents automatically pick up basic host-level metrics,
including system and process-level CPU and memory metrics.
Agent specific metrics are also available,
like <a href="/guide/en/apm/agent/java/1.x/metrics.html" class="ulink" target="_top">JVM metrics</a> in the Java Agent,
and <a href="/guide/en/apm/agent/go/2.x/metrics.html" class="ulink" target="_top">Go runtime</a> metrics in the Go Agent.</p>
<p>Infrastructure and application metrics are important sources of information when debugging production systems,
which is why we&#8217;ve made it easy to filter metrics for specific hosts or containers in the Kibana <a href="/guide/en/kibana/master/metrics.html" class="ulink" target="_top">metrics overview</a>.</p>
<p>Metrics have the <code class="literal">processor.event</code> property set to <code class="literal">metric</code>.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>Most agents limit keyword fields (e.g. <code class="literal">processor.event</code>) to 1024 characters,
non-keyword fields (e.g. <code class="literal">system.memory.total</code>) to 10,000 characters.</p>
</div>
</div>
<p>Metrics are stored in metric indices.</p>
<p>For a full list of tracked metrics, see the relevant agent documentation:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="/guide/en/apm/agent/go/2.x/metrics.html" class="ulink" target="_top">Go</a>
</li>
<li class="listitem">
<a href="/guide/en/apm/agent/java/1.x/metrics.html" class="ulink" target="_top">Java</a>
</li>
<li class="listitem">
<a href="/guide/en/apm/agent/nodejs/3.x/metrics.html" class="ulink" target="_top">Node.js</a>
</li>
<li class="listitem">
<a href="/guide/en/apm/agent/python/6.x/metrics.html" class="ulink" target="_top">Python</a>
</li>
<li class="listitem">
<a href="/guide/en/apm/agent/ruby/4.x/metrics.html" class="ulink" target="_top">Ruby</a>
</li>
</ul>
</div>
<h4><a id="_calculated_metrics"></a>Calculated metrics<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/main/docs/data-model.asciidoc">edit</a></h4>
<p>APM agents and APM Server calculate metrics from trace events to power visualizations in the APM app.
These metrics are described below.</p>
<h5><a id="_breakdown_metrics"></a>Breakdown metrics<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/main/docs/data-model.asciidoc">edit</a></h5>
<p>To power the <a href="/guide/en/kibana/master/transactions.html" class="ulink" target="_top">Time spent by span type</a> graph,
agents collect summarized metrics about the timings of spans and transactions,
broken down by span type.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">span.self_time.count</code></strong></span> and <span class="strong strong"><strong><code class="literal">span.self_time.sum.us</code></strong></span>
</span>
</dt>
<dd>
<p>These metrics measure the "self-time" for a span type, and optional subtype,
within a transaction group. Together these metrics can be used to calculate
the average duration and percentage of time spent on each type of operation
within a transaction group.</p>
<p>These metric documents can be identified by searching for <code class="literal">metricset.name: span_breakdown</code>.</p>
<p>You can filter and group by these dimensions:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">transaction.name</code>: The name of the enclosing transaction group, for example <code class="literal">GET /</code>
</li>
<li class="listitem">
<code class="literal">transaction.type</code>: The type of the enclosing transaction, for example <code class="literal">request</code>
</li>
<li class="listitem">
<code class="literal">span.type</code>: The type of the span, for example <code class="literal">app</code>, <code class="literal">template</code> or <code class="literal">db</code>
</li>
<li class="listitem">
<code class="literal">span.subtype</code>: The sub-type of the span, for example <code class="literal">mysql</code> (optional)
</li>
</ul>
</div>
</dd>
</dl>
</div>
<h5><a id="_transaction_metrics"></a>Transaction metrics<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/main/docs/data-model.asciidoc">edit</a></h5>
<p>To power <a href="/guide/en/kibana/master/xpack-apm.html" class="ulink" target="_top">APM app</a> visualizations,
APM Server aggregates transaction events into latency distribution metrics.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">transaction.duration.histogram</code></strong></span>
</span>
</dt>
<dd>
<p>This metric measures the latency distribution of transaction groups,
used to power visualizations and analytics in Elastic APM.</p>
<p>These metric documents can be identified by searching for <code class="literal">metricset.name: transaction</code>.</p>
<p>You can filter and group by these dimensions (some of which are optional, for example <code class="literal">container.id</code>):</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">transaction.name</code>: The name of the transaction, for example <code class="literal">GET /</code>
</li>
<li class="listitem">
<code class="literal">transaction.type</code>: The type of the transaction, for example <code class="literal">request</code>
</li>
<li class="listitem">
<code class="literal">transaction.result</code>: The result of the transaction, for example <code class="literal">HTTP 2xx</code>
</li>
<li class="listitem">
<code class="literal">transaction.root</code>: A boolean flag indicating whether the transaction is the root of a trace
</li>
<li class="listitem">
<code class="literal">metricset.interval</code>: A string with the aggregation interval the metricset represents.
</li>
<li class="listitem">
<code class="literal">event.outcome</code>: The outcome of the transaction, for example <code class="literal">success</code>
</li>
<li class="listitem">
<code class="literal">agent.name</code>: The name of the APM agent that instrumented the transaction, for example <code class="literal">java</code>
</li>
<li class="listitem">
<code class="literal">service.name</code>: The name of the service that served the transaction
</li>
<li class="listitem">
<code class="literal">service.version</code>: The version of the service that served the transaction
</li>
<li class="listitem">
<code class="literal">service.node.name</code>: The name of the service instance that served the transaction
</li>
<li class="listitem">
<code class="literal">service.environment</code>: The environment of the service that served the transaction
</li>
<li class="listitem">
<code class="literal">service.language.name</code>: The language name of the service that served the transaction, for example <code class="literal">Go</code>
</li>
<li class="listitem">
<code class="literal">service.language.version</code>: The language version of the service that served the transaction
</li>
<li class="listitem">
<code class="literal">service.runtime.name</code>: The runtime name of the service that served the transaction, for example <code class="literal">jRuby</code>
</li>
<li class="listitem">
<code class="literal">service.runtime.version</code>: The runtime version that served the transaction
</li>
<li class="listitem">
<code class="literal">host.hostname</code>: The hostname of the service that served the transaction
</li>
<li class="listitem">
<code class="literal">host.os.platform</code>: The platform name of the service that served the transaction, for example <code class="literal">linux</code>
</li>
<li class="listitem">
<code class="literal">container.id</code>: The container ID of the service that served the transaction
</li>
<li class="listitem">
<code class="literal">kubernetes.pod.name</code>: The name of the Kubernetes pod running the service that served the transaction
</li>
<li class="listitem">
<code class="literal">cloud.provider</code>: The cloud provider hosting the service instance that served the transaction
</li>
<li class="listitem">
<code class="literal">cloud.region</code>: The cloud region hosting the service instance that served the transaction
</li>
<li class="listitem">
<code class="literal">cloud.availability_zone</code>: The cloud availability zone hosting the service instance that served the transaction
</li>
<li class="listitem">
<code class="literal">cloud.account.id</code>: The cloud account id of the service that served the transaction
</li>
<li class="listitem">
<code class="literal">cloud.account.name</code>: The cloud account name of the service that served the transaction
</li>
<li class="listitem">
<code class="literal">cloud.machine.type</code>: The cloud machine type or instance type of the service that served the transaction
</li>
<li class="listitem">
<code class="literal">cloud.project.id</code>: The cloud project identifier of the service that served the transaction
</li>
<li class="listitem">
<code class="literal">cloud.project.name</code>: The cloud project name of the service that served the transaction
</li>
<li class="listitem">
<code class="literal">cloud.service.name</code>: The cloud service name of the service that served the transaction
</li>
<li class="listitem">
<code class="literal">faas.coldstart</code>: Whether the <em>serverless</em> service that served the transaction had a cold start
</li>
<li class="listitem">
<code class="literal">faas.trigger.type</code>: The trigger type that the lambda function was executed by of the service that served the transaction
</li>
<li class="listitem">
<code class="literal">faas.id</code>: The unique identifier of the invoked serverless function
</li>
<li class="listitem">
<code class="literal">faas.name</code>: The name of the lambda function
</li>
<li class="listitem">
<code class="literal">faas.version</code>: The version of the lambda function
</li>
<li class="listitem">
<code class="literal">labels</code>: Key-value object containing string labels set globally by the APM agents.
</li>
<li class="listitem">
<code class="literal">numeric_labels</code>: Key-value object containing numeric labels set globally by the APM agents.
</li>
</ul>
</div>
</dd>
</dl>
</div>
<p>The <code class="literal">@timestamp</code> field of these documents holds the start of the aggregation interval.</p>
<h5><a id="_service_destination_metrics"></a>Service-destination metrics<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/main/docs/data-model.asciidoc">edit</a></h5>
<p>To power <a href="/guide/en/kibana/master/xpack-apm.html" class="ulink" target="_top">APM app</a> visualizations,
APM Server aggregates span events into service-destination metrics.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">span.destination.service.response_time.count</code></strong></span> and <span class="strong strong"><strong><code class="literal">span.destination.service.response_time.sum.us</code></strong></span>
</span>
</dt>
<dd>
<p>These metrics measure the count and total duration of requests from one service to another service.
These are used to calculate the throughput and latency of requests to backend services such as databases in
<a href="/guide/en/kibana/master/service-maps.html" class="ulink" target="_top">Service maps</a>.</p>
<p>These metric documents can be identified by searching for <code class="literal">metricset.name: service_destination</code>.</p>
<p>You can filter and group by these dimensions:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">span.destination.service.resource</code>: The destination service resource, for example <code class="literal">mysql</code>
</li>
<li class="listitem">
<code class="literal">span.name</code>: The name of the operation, for example <code class="literal">SELECT FROM table_name</code>.
</li>
<li class="listitem">
<code class="literal">event.outcome</code>: The outcome of the operation, for example <code class="literal">success</code>
</li>
<li class="listitem">
<code class="literal">agent.name</code>: The name of the APM agent that instrumented the operation, for example <code class="literal">java</code>
</li>
<li class="listitem">
<code class="literal">service.name</code>: The name of the service that made the request
</li>
<li class="listitem">
<code class="literal">service.environment</code>: The environment of the service that made the request
</li>
<li class="listitem">
<code class="literal">service.target.name</code>: The target service name, for example <code class="literal">customer_db</code>
</li>
<li class="listitem">
<code class="literal">service.target.type</code>: The target service type, for example <code class="literal">mysql</code>
</li>
<li class="listitem">
<code class="literal">metricset.interval</code>: A string with the aggregation interval the metricset represents.
</li>
<li class="listitem">
<code class="literal">labels</code>: Key-value object containing string labels set globally by the APM agents.
</li>
<li class="listitem">
<code class="literal">numeric_labels</code>: Key-value object containing numeric labels set globally by the APM agents.
</li>
</ul>
</div>
</dd>
</dl>
</div>
<p>The <code class="literal">@timestamp</code> field of these documents holds the start of the aggregation interval.</p>
<h4><a id="_data_streams_4"></a>Data streams<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/main/docs/data-model.asciidoc">edit</a></h4>
<p>Metrics are stored in the following data streams:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
APM internal metrics: <code class="literal">metrics-apm.internal-&lt;namespace&gt;</code>
</li>
<li class="listitem">
APM transaction metrics: <code class="literal">metrics-apm.transaction.&lt;metricset.interval&gt;-&lt;namespace&gt;</code>
</li>
<li class="listitem">
APM service destination metrics: <code class="literal">metrics-apm.service_destination.&lt;metricset.interval&gt;-&lt;namespace&gt;</code>
</li>
<li class="listitem">
APM service transaction metrics: <code class="literal">metrics-apm.service_transaction.&lt;metricset.interval&gt;-&lt;namespace&gt;</code>
</li>
<li class="listitem">
APM service summary metrics: <code class="literal">metrics-apm.service_summary.&lt;metricset.interval&gt;-&lt;namespace&gt;</code>
</li>
<li class="listitem">
Application metrics: <code class="literal">metrics-apm.app.&lt;service.name&gt;-&lt;namespace&gt;</code>
</li>
</ul>
</div>
<p>See <a class="xref" href="apm-data-streams.html" title="Data streams">Data streams</a> to learn more.</p>
<h4><a id="_example_metric_document"></a>Example metric document<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/main/docs/data-model.asciidoc">edit</a></h4>
<p>This example shows what metric documents can look like when indexed in Elasticsearch.</p>
<details>
<summary class="title">Expand Elasticsearch document</summary>
<div class="content">
<p>This example contains JVM metrics produced by the Elastic APM Java agent.
and contains two related metrics: <code class="literal">jvm.gc.time</code> and <code class="literal">jvm.gc.count</code>. These are accompanied by various fields describing
the environment in which the metrics were captured: service name, host name, Kubernetes pod UID, container ID, process ID, and more.
These fields make it possible to search and aggregate across various dimensions, such as by service, host, and Kubernetes pod.</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
  "container": {
    "id": "a47ed147c6ee269400f7ea4e296b3d01ec7398471bb2951907e4ea12f028bc69"
  },
  "kubernetes": {
    "pod": {
      "uid": "b0cb3baa-4619-4b82-bef5-84cc87b5f853",
      "name": "opbeans-java-7c68f48dc6-n6mzc"
    }
  },
  "process": {
    "pid": 8,
    "title": "/opt/java/openjdk/bin/java",
    "parent": {
      "pid": 1
    },
  },
  "agent": {
    "name": "java",
    "ephemeral_id": "29a27947-ed3a-4d87-b2e6-28f7a940ec2d",
    "version": "1.25.1-SNAPSHOT.UNKNOWN"
  },
  "jvm.gc.time": 11511,
  "processor": {
    "name": "metric",
    "event": "metric"
  },
  "labels": {
    "name": "Copy"
  },
  "metricset.name": "app",
  "observer": {
    "hostname": "3c5ac040e8f9",
    "name": "instance-0000000002",
    "type": "apm-server",
    "version": "7.15.0"
  },
  "@timestamp": "2021-09-14T09:52:49.454Z",
  "ecs": {
    "version": "1.11.0"
  },
  "service": {
    "node": {
      "name": "a47ed147c6ee269400f7ea4e296b3d01ec7398471bb2951907e4ea12f028bc69"
    },
    "environment": "production",
    "name": "opbeans-java",
    "runtime": {
      "name": "Java",
      "version": "11.0.11"
    },
    "language": {
      "name": "Java",
      "version": "11.0.11"
    },
    "version": "2021-09-08 03:55:06"
  },
  "jvm.gc.count": 2224,
  "host": {
    "os": {
      "platform": "Linux"
    },
    "ip": ["35.240.52.17"],
    "architecture": "amd64"
  },
  "event": {
    "ingested": "2021-09-14T09:53:00.834276431Z"
  }
}</pre>
</div>
</div>
</details>
</div>
<div class="navfooter">
<span class="prev">
<a href="data-model-errors.html">« Errors</a>
</span>
<span class="next">
<a href="data-model-metadata.html">Metadata »</a>
</span>
</div>
</div>
</body>
</html>
