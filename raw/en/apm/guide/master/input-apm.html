<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>APM input settings | APM User Guide [master] | Elastic</title>
<link rel="home" href="index.html" title="APM User Guide [master]"/>
<link rel="up" href="index.html" title="APM User Guide [master]"/>
<link rel="prev" href="apm-tune-elasticsearch.html" title="Tune Elasticsearch for data ingestion"/>
<link rel="next" href="apm-data-streams.html" title="Data streams"/>
<meta name="DC.type" content="Learn/Docs/APM Guide/master"/>
<meta name="DC.subject" content="APM"/>
<meta name="DC.identifier" content="master"/>
</head>
<body>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">APM User Guide [master]</a></span>
»
<span class="breadcrumb-node">APM input settings</span>
</div>
<div class="navheader">
<span class="prev">
<a href="apm-tune-elasticsearch.html">« Tune Elasticsearch for data ingestion</a>
</span>
<span class="next">
<a href="apm-data-streams.html">Data streams »</a>
</span>
</div>
<div class="chapter">
<div class="titlepage"><div><div>
<h1 class="title"><a id="input-apm"></a>APM input settings<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/master/docs/input-apm.asciidoc">edit</a></h1>
</div></div></div>

<p>To edit the APM integration input settings, open Kibana, select <span class="strong strong"><strong>Add data</strong></span>,
and search for and select "Elastic APM".
If the integration is already installed, under the polices tab, select <span class="strong strong"><strong>Actions</strong></span> &gt; <span class="strong strong"><strong>Edit integration</strong></span>.
If the integration has not been installed, select <span class="strong strong"><strong>Add Elastic APM</strong></span>.</p>
<h3><a id="apm-input-general-settings"></a>General settings<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/master/docs/input-apm.asciidoc">edit</a></h3>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<tbody>
<tr>
<td align="left" valign="top">
<p><a id="input-apm-host-setting"></a><code class="literal">host</code></p>
</td>
<td align="left" valign="top">
<p>(text) Defines the host and port the server is listening on.
Use <code class="literal">unix:/path/to.sock</code> to listen on a unix domain socket.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">localhost:8200</code></p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="input-apm-url-setting"></a><code class="literal">URL</code></p>
</td>
<td align="left" valign="top">
<p>The unchangeable, publicly reachable server URL for deployments on Elastic Cloud or ECK.</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="input-apm-max_header_bytes-setting"></a><code class="literal">max_header_bytes</code></p>
</td>
<td align="left" valign="top">
<p>(int) Maximum permitted size of a request&#8217;s header accepted by the server to be processed (in Bytes).</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">1048576</code> Bytes</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="input-apm-idle_timeout-setting"></a><code class="literal">idle_timeout</code></p>
</td>
<td align="left" valign="top">
<p>(text) Maximum amount of time to wait for the next incoming request before underlying connection is closed.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">45s</code> (45 seconds)</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="input-apm-read_timeout-setting"></a><code class="literal">read_timeout</code></p>
</td>
<td align="left" valign="top">
<p>(text) Maximum permitted duration for reading an entire request.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">3600s</code> (3600 seconds)</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="input-apm-shutdown_timeout-setting"></a><code class="literal">shutdown_timeout</code></p>
</td>
<td align="left" valign="top">
<p>(text) Maximum duration in seconds before releasing resources when shutting down the server.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">30s</code> (30 seconds)</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="input-apm-max_event_bytes-setting"></a><code class="literal">max_event_bytes</code></p>
</td>
<td align="left" valign="top">
<p>(int) Maximum permitted size of an event accepted by the server to be processed (in Bytes).</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">307200</code> Bytes</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="input-apm-max_connections-setting"></a><code class="literal">max_connections</code></p>
</td>
<td align="left" valign="top">
<p>(int) Maximum number of TCP connections to accept simultaneously. <code class="literal">0</code> means unlimited.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">0</code> (unlimited)</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="input-apm-response_headers-setting"></a><code class="literal">response_headers</code></p>
</td>
<td align="left" valign="top">
<p>(text) Custom HTTP headers to add to HTTP responses. Useful for security policy compliance.</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="input-apm-capture_personal_data-setting"></a><code class="literal">capture_personal_data</code></p>
</td>
<td align="left" valign="top">
<p>(bool) Capture personal data such as IP or User Agent.
If true, APM Server captures the IP of the instrumented service and its User Agent if any.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">true</code></p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="input-apm-default_service_environment-setting"></a><code class="literal">default_service_environment</code></p>
</td>
<td align="left" valign="top">
<p>(text) The default service environment for events without a defined service environment.</p>
<p><span class="strong strong"><strong>Default:</strong></span> none</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="input-apm-golang_xpvar-setting"></a><code class="literal">golang_xpvar</code></p>
</td>
<td align="left" valign="top">
<p>(bool) When set to <code class="literal">true</code>, the server exposes <a href="https://golang.org/pkg/expvar/" class="ulink" target="_top">Golang expvar</a> under <code class="literal">/debug/vars</code>.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">false</code></p>
</td>
</tr>
</tbody>
</table>
</div>
<h3><a id="apm-input-rum-settings"></a>Real User Monitoring (RUM) settings<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/master/docs/input-apm.asciidoc">edit</a></h3>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<tbody>
<tr>
<td align="left" valign="top">
<p><a id="input-apm-enable_rum-setting"></a><code class="literal">enable_rum</code></p>
</td>
<td align="left" valign="top">
<p>(bool) Enables and disables Real User Monitoring (RUM).</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">false</code> (disabled)</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="input-apm-rum_allow_origins-setting"></a><code class="literal">rum_allow_origins</code></p>
</td>
<td align="left" valign="top">
<p>(text) A list of permitted origins for RUM support.
User-agents send an Origin header that will be validated against this list.
This is done automatically by modern browsers as part of the <a href="https://www.w3.org/TR/cors/" class="ulink" target="_top">CORS specification</a>.
An origin is made of a protocol scheme, host and port, without the URL path.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">["*"]</code> (allows everything)</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="input-apm-rum_allow_headers-setting"></a><code class="literal">rum_allow_headers</code></p>
</td>
<td align="left" valign="top">
<p>(text) By default, HTTP requests made from the RUM agent to the APM integration are limited in the HTTP headers they are allowed to have.
If any other headers are added, the request will be rejected by the browser due to Cross-Origin Resource Sharing (CORS) restrictions.
If you need to add extra headers to these requests, use this configuration to allow additional headers.</p>
<p>The default list of values includes <code class="literal">"Content-Type"</code>, <code class="literal">"Content-Encoding"</code>, and <code class="literal">"Accept"</code>.
Configured values are appended to the default list and used as the value for the
<code class="literal">Access-Control-Allow-Headers</code> header.</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="input-apm-rum_response_headers-setting"></a><code class="literal">rum_response_headers</code></p>
</td>
<td align="left" valign="top">
<p>(text) Custom HTTP headers to add to RUM responses. For example, for security policy compliance.</p>
<p><span class="strong strong"><strong>Default:</strong></span> none</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="input-apm-rum_library_frame_pattern-setting"></a><code class="literal">rum_library_frame_pattern</code></p>
</td>
<td align="left" valign="top">
<p>(text) RegExp to be matched against a stacktrace frame&#8217;s <code class="literal">file_name</code> and <code class="literal">abs_path</code> attributes.
If the RegExp matches, the stacktrace frame is considered to be a library frame.
When source mapping is applied, the <code class="literal">error.culprit</code> is set to reflect the <em>function</em> and the <em>filename</em>
of the first non-library frame.
This aims to provide an entry point for identifying issues.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">"node_modules|bower_components|~"</code></p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="input-apm-rum_exclude_from_grouping-setting"></a><code class="literal">rum_exclude_from_grouping</code></p>
</td>
<td align="left" valign="top">
<p>(text) RegExp to be matched against a stacktrace frame&#8217;s <code class="literal">file_name</code>.
If the RegExp matches, the stacktrace frame is excluded from being used for calculating error groups.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">"^/webpack"</code> (excludes stacktrace frames that have a filename starting with <code class="literal">/webpack</code>)</p>
</td>
</tr>
</tbody>
</table>
</div>
<h3><a id="apm-input-tls-settings"></a>TLS settings<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/master/docs/input-apm.asciidoc">edit</a></h3>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<tbody>
<tr>
<td align="left" valign="top">
<p><a id="input-apm-tls_enabled-setting"></a><code class="literal">tls_enabled</code></p>
</td>
<td align="left" valign="top">
<p>(bool) Enable TLS.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">false</code></p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="input-apm-tls_certificate-setting"></a><code class="literal">tls_certificate</code></p>
</td>
<td align="left" valign="top">
<p>(text) The path to the file containing the certificate for server authentication. Required when TLS is enabled.</p>
<p><span class="strong strong"><strong>Default:</strong></span> none</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="input-apm-tls_key-setting"></a><code class="literal">tls_key</code></p>
</td>
<td align="left" valign="top">
<p>(text) The path to the file containing the Server certificate key. Required when TLS is enabled.</p>
<p><span class="strong strong"><strong>Default:</strong></span> none</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="input-apm-tls_supported_protocols-setting"></a><code class="literal">tls_supported_protocols</code></p>
</td>
<td align="left" valign="top">
<p>(array) A list of allowed TLS protocol versions.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">["TLSv1.0", "TLSv1.1", "TLSv1.2"]</code></p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="input-apm-tls_cipher_suites-setting"></a><code class="literal">tls_cipher_suites</code></p>
</td>
<td align="left" valign="top">
<p>(text) The list of cipher suites to use. The first entry has the highest priority.
If this option is omitted, the Go crypto library’s <a href="https://golang.org/pkg/crypto/tls/" class="ulink" target="_top">default suites</a> are used (recommended).
Note that TLS 1.3 cipher suites are not individually configurable in Go, so they are not included in this list.</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="input-apm-tls_curve_types-setting"></a><code class="literal">tls_curve_types</code></p>
</td>
<td align="left" valign="top">
<p>(text) The list of curve types for ECDHE (Elliptic Curve Diffie-Hellman ephemeral key exchange).</p>
<p><span class="strong strong"><strong>Default:</strong></span> none</p>
</td>
</tr>
</tbody>
</table>
</div>
<h3><a id="apm-input-agent-auth-settings"></a>Agent authorization settings<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/master/docs/input-apm.asciidoc">edit</a></h3>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<tbody>
<tr>
<td align="left" valign="top">
<p><a id="input-apm-api_key_enabled-setting"></a><code class="literal">api_key_enabled</code></p>
</td>
<td align="left" valign="top">
<p>(bool) Enable or disable API key authorization between APM Server and APM agents.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">false</code> (disabled)</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="input-apm-api_key_limit-setting"></a><code class="literal">api_key_limit</code></p>
</td>
<td align="left" valign="top">
<p>(int) Each unique API key triggers one request to Elasticsearch.
This setting restricts the number of unique API keys are allowed per minute.
The minimum value for this setting should be the number of API keys configured in your monitored services.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">100</code></p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="input-apm-secret_token-setting"></a><code class="literal">secret_token</code></p>
</td>
<td align="left" valign="top">
<p>(text) Authorization token for sending APM data.
The same token must also be set in each APM agent.
This token is not used for RUM endpoints.</p>
<p><span class="strong strong"><strong>Default:</strong></span> No secret token set</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="input-apm-anonymous_enabled-setting"></a><code class="literal">anonymous_enabled</code></p>
</td>
<td align="left" valign="top">
<p>(bool) Enable or disable anonymous authentication.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">true</code> (enabled)</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="input-apm-anonymous_allow_agent-setting"></a><code class="literal">anonymous_allow_agent</code></p>
</td>
<td align="left" valign="top">
<p>(array) A list of permitted APM agent names for anonymous authentication.
Names in this list must match the agent&#8217;s <code class="literal">agent.name</code>.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">[rum-js, js-base, iOS/swift]</code> (only RUM and iOS/Swift agent events are accepted)</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="input-apm-anonymous_allow_service-setting"></a><code class="literal">anonymous_allow_service</code></p>
</td>
<td align="left" valign="top">
<p>(array) A list of permitted service names for anonymous authentication.
Names in this list must match the agent&#8217;s <code class="literal">service.name</code>.
This can be used to limit the number of service-specific indices or data streams created.</p>
<p><span class="strong strong"><strong>Default:</strong></span> Not set (any service name is accepted)</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="input-apm-anonymous_rate_limit_ip_limit-setting"></a><code class="literal">anonymous_rate_limit_ip_limit</code></p>
</td>
<td align="left" valign="top">
<p>(int) The number of unique IP addresses to track in an LRU cache.
IP addresses in the cache will be rate limited according to the <code class="literal">anonymous_rate_limit_event_limit</code> setting.
Consider increasing this default if your application has many concurrent clients.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">10000</code></p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="input-apm-anonymous_rate_limit_event_limit-setting"></a><code class="literal">anonymous_rate_limit_event_limit</code></p>
</td>
<td align="left" valign="top">
<p>(int) The maximum amount of events allowed to be sent to the APM Server anonymous auth endpoint per IP per second.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">10</code></p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="apm-tune-elasticsearch.html">« Tune Elasticsearch for data ingestion</a>
</span>
<span class="next">
<a href="apm-data-streams.html">Data streams »</a>
</span>
</div>
</div>
</body>
</html>
