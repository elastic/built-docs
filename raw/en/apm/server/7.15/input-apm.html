<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>APM input settings | APM Server Reference [7.15] | Elastic</title>
<meta class="elastic" name="content" content="APM input settings | APM Server Reference [7.15]">

<link rel="home" href="index.html" title="APM Server Reference [7.15]"/>
<link rel="up" href="apm-integration.html" title="APM integration for Elastic Agent"/>
<link rel="prev" href="apm-integration-data-streams.html" title="Data streams"/>
<link rel="next" href="apm-integration-configure.html" title="Configure APM integration"/>
<link rel="canonical" href="https://www.elastic.co/guide/en/apm/guide/current/input-apm.html"/>
<meta class="elastic" name="product_version" content="7.15"/>
<meta class="elastic" name="product_name" content="APM"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/APM Server/Reference/7.15"/>
<meta name="DC.subject" content="APM"/>
<meta name="DC.identifier" content="7.15"/>
</head>
<body><div class="page_header">
The Elastic APM integration became generally available in 7.16 &mdash; see the <a href="https://www.elastic.co/guide/en/apm/guide/current/index.html">APM Guide</a> for updated documentation. Standalone APM Server users can see the&nbsp;<a href="https://www.elastic.co/guide/en/apm/guide/current/legacy-apm-overview.html" title="Legacy APM Overview">Legacy APM Overview</a>&nbsp;and&nbsp;<a href="https://www.elastic.co/guide/en/apm/guide/current/overview.html" title="Legacy APM Server Reference">Legacy APM Server Reference</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link">
  <div id="related-products" class="dropdown">
  <div class="related-products-title">APM:</div>
  <div class="dropdown-anchor" tabindex="0">Server Reference<span class="dropdown-icon"></span></div>
  <div class="dropdown-content">
  <ul>
  <li class="dropdown-category">APM</li>
  <ul>
  <li><a href="/guide/en/apm/guide/current/apm-overview.html">User Guide</a></li>
  </ul>
  <li class="dropdown-category">APM agents</li>
  <ul>
  <li><a href="/guide/en/apm/agent/android/current/intro.html">Android Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/go/current/introduction.html">Go Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/swift/current/intro.html">iOS Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/java/current/intro.html">Java Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/dotnet/current/intro.html">.NET Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/nodejs/current/intro.html">Node.js Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/php/current/intro.html">PHP Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/python/current/getting-started.html">Python Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/ruby/current/introduction.html">Ruby Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/rum-js/current/intro.html">Real User Monitoring JavaScript Agent Reference</a></li>
  </ul>
  <li class="dropdown-category">APM extensions</li>
  <ul>
  <li><a href="/guide/en/apm/lambda/current/aws-lambda-arch.html">Monitoring AWS Lambda Functions</a></li>
  <li><a href="/guide/en/apm/attacher/current/apm-attacher.html">Attacher</a></li>
  </ul>
  </ul>
  </div>
  </div>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="apm-integration.html">APM integration for Elastic Agent</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="apm-integration-data-streams.html">« Data streams</a>
</span>
<span class="next">
<a href="apm-integration-configure.html">Configure APM integration »</a>
</span>
</div>
<div class="chapter">
<div class="titlepage"><div><div>
<h2 class="title"><a id="input-apm"></a>APM input settings<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/7.15/docs/apm-package/input-apm.asciidoc">edit</a></h2>
</div></div></div>

<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in beta and is subject to change. The design and code is less mature than official GA features and is being provided as-is with no warranties. Beta features are not subject to the support SLA of official GA features.</p>
</div>
</div>
<p>To edit the APM integration input settings, open Kibana and select:
<span class="strong strong"><strong>Integrations</strong></span> &gt; <span class="strong strong"><strong>Elastic APM</strong></span> &gt; <span class="strong strong"><strong>Add Elastic APM</strong></span>.
Expand the carrot to view all settings.</p>
<p>A limited number of settings are currently supported.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Templates, pipelines, index lifecycle management, etc., cannot be configured
with APM Server or Fleet, and must instead be configured with Kibana or Elasticsearch.
<a class="xref" href="apm-integration-configure.html" title="Configure APM integration">Learn more</a>.</p>
</div>
</div>
<h3><a id="apm-input-general-settings"></a>General settings<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/7.15/docs/apm-package/input-apm.asciidoc">edit</a></h3>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<tbody>
<tr>
<td align="left" valign="top">
<p><a id="input-apm-host-setting"></a><code class="literal">host</code></p>
</td>
<td align="left" valign="top">
<p>(string) Defines the host and port the server is listening on.
Use <code class="literal">unix:/path/to.sock</code> to listen on a unix domain socket.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">localhost:8200</code></p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="input-apm-secret_token-setting"></a><code class="literal">secret_token</code></p>
</td>
<td align="left" valign="top">
<p>(string) Authorization token for sending APM data.
The same token must also be set in each APM agent.
This token is not used for RUM endpoints.</p>
<p><span class="strong strong"><strong>Default:</strong></span> No secret token set</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="input-apm-max_event_bytes-setting"></a><code class="literal">max_event_bytes</code></p>
</td>
<td align="left" valign="top">
<p>(int) Maximum permitted size of an event accepted by the server to be processed (in Bytes).</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">307200</code> Bytes</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="input-apm-default_service_environment-setting"></a><code class="literal">default_service_environment</code></p>
</td>
<td align="left" valign="top">
<p>(string) The default service environment for events without a defined service environment.</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="input-apm-capture_personal_data-setting"></a><code class="literal">capture_personal_data</code></p>
</td>
<td align="left" valign="top">
<p>(bool) Capture personal data such as IP or User Agent.
If true, APM Server captures the IP of the instrumented service and its User Agent if any.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">true</code></p>
</td>
</tr>
</tbody>
</table>
</div>
<h3><a id="apm-input-anon-auth-settings"></a>Anonymous authentication settings<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/7.15/docs/apm-package/input-apm.asciidoc">edit</a></h3>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<tbody>
<tr>
<td align="left" valign="top">
<p><a id="input-apm-anonymous_enabled-setting"></a><code class="literal">anonymous_enabled</code></p>
</td>
<td align="left" valign="top">
<p>(bool) Enable or disable anonymous authentication.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">true</code> (enabled)</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="input-apm-anonymous_allow_agent-setting"></a><code class="literal">anonymous_allow_agent</code></p>
</td>
<td align="left" valign="top">
<p>(array) A list of permitted APM agent names for anonymous authentication.
Names in this list must match the agent&#8217;s <code class="literal">agent.name</code>.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">[rum-js, js-base, iOS/swift]</code> (only RUM and iOS/Swift agent events are accepted)</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="input-apm-anonymous_allow_service-setting"></a><code class="literal">anonymous_allow_service</code></p>
</td>
<td align="left" valign="top">
<p>(array) A list of permitted service names for anonymous authentication.
Names in this list must match the agent&#8217;s <code class="literal">service.name</code>.
This can be used to limit the number of service-specific indices or data streams created.</p>
<p><span class="strong strong"><strong>Default:</strong></span> Not set (any service name is accepted)</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="input-apm-anonymous_rate_limit_event_limit-setting"></a><code class="literal">anonymous_rate_limit_event_limit</code></p>
</td>
<td align="left" valign="top">
<p>(int) The maximum amount of events allowed to be sent to the APM Server anonymous auth endpoint per IP per second.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">10</code></p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="input-apm-anonymous_rate_limit_ip_limit-setting"></a><code class="literal">anonymous_rate_limit_ip_limit</code></p>
</td>
<td align="left" valign="top">
<p>(int) The number of unique IP addresses to track in an LRU cache.
IP addresses in the cache will be rate limited according to the <code class="literal">anonymous_rate_limit_event_limit</code> setting.
Consider increasing this default if your application has many concurrent clients.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">10000</code></p>
</td>
</tr>
</tbody>
</table>
</div>
<h3><a id="apm-input-rum-settings"></a>Real User Monitoring (RUM) settings<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/7.15/docs/apm-package/input-apm.asciidoc">edit</a></h3>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<tbody>
<tr>
<td align="left" valign="top">
<p><a id="input-apm-enable_rum-setting"></a><code class="literal">enable_rum</code></p>
</td>
<td align="left" valign="top">
<p>(bool) Enables and disables Real User Monitoring (RUM).</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">false</code> (disabled)</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="input-apm-rum_allow_origins-setting"></a><code class="literal">rum_allow_origins</code></p>
</td>
<td align="left" valign="top">
<p>(string) A list of permitted origins for RUM support.
User-agents send an Origin header that will be validated against this list.
This is done automatically by modern browsers as part of the <a href="https://www.w3.org/TR/cors/" class="ulink" target="_top">CORS specification</a>.
An origin is made of a protocol scheme, host and port, without the URL path.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">["*"]</code> (allows everything)</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="input-apm-rum_allow_headers-setting"></a><code class="literal">rum_allow_headers</code></p>
</td>
<td align="left" valign="top">
<p>(string) By default, HTTP requests made from the RUM agent to the APM integration are limited in the HTTP headers they are allowed to have.
If any other headers are added, the request will be rejected by the browser due to Cross-Origin Resource Sharing (CORS) restrictions.
If you need to add extra headers to these requests, use this configuration to allow additional headers.</p>
<p>The default list of values includes <code class="literal">"Content-Type"</code>, <code class="literal">"Content-Encoding"</code>, and <code class="literal">"Accept"</code>.
Configured values are appended to the default list and used as the value for the
<code class="literal">Access-Control-Allow-Headers</code> header.</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="input-apm-rum_response_headers-setting"></a><code class="literal">rum_response_headers</code></p>
</td>
<td align="left" valign="top">
<p>(yaml) Custom HTTP headers to add to RUM responses. For example, for security policy compliance.</p>
</td>
</tr>
</tbody>
</table>
</div>
<h3><a id="_api_key_settings"></a>API key settings<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/7.15/docs/apm-package/input-apm.asciidoc">edit</a></h3>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<tbody>
<tr>
<td align="left" valign="top">
<p><a id="input-apm-api_key_enabled-setting"></a><code class="literal">api_key_enabled</code></p>
</td>
<td align="left" valign="top">
<p>(bool) Enable or disable API key authorization between APM Server and APM agents.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">false</code> (disabled)</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="input-apm-api_key_limit-setting"></a><code class="literal">api_key_limit</code></p>
</td>
<td align="left" valign="top">
<p>(int) Each unique API key triggers one request to Elasticsearch.
This setting restricts the number of unique API keys are allowed per minute.
The minimum value for this setting should be the number of API keys configured in your monitored services.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">100</code></p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="input-apm-sourcemap_api_key-setting"></a><code class="literal">sourcemap_api_key</code></p>
</td>
<td align="left" valign="top">
<p>(string) RUM API key for sourcemaps. Formatted as <code class="literal">&lt;Id&gt;:&lt;API Key&gt;</code>.</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="input-apm-kibana_api_key-setting"></a><code class="literal">kibana_api_key</code></p>
</td>
<td align="left" valign="top">
<p>(string) API Key for APM central configuration feature. Formatted as <code class="literal">&lt;Id&gt;:&lt;API Key&gt;</code>.</p>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="apm-integration-data-streams.html">« Data streams</a>
</span>
<span class="next">
<a href="apm-integration-configure.html">Configure APM integration »</a>
</span>
</div>
</div>
</body>
</html>
