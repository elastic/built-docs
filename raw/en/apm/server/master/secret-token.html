<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Secret token | APM Server Reference [master] | Elastic</title>
<link rel="home" href="index.html" title="APM Server Reference [master]"/>
<link rel="up" href="secure-communication-agents.html" title="Secure communication with APM Agents"/>
<link rel="prev" href="api-key-settings.html" title="api_key.* configuration options"/>
<link rel="next" href="securing-communication-elasticsearch.html" title="Secure communication with Elasticsearch"/>
<meta name="DC.type" content="Learn/Docs/APM Server/Reference/master"/>
<meta name="DC.subject" content="APM"/>
<meta name="DC.identifier" content="master"/>
</head>
<body><div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">APM Server Reference [master]</a></span>
»
<span class="breadcrumb-link"><a href="securing-apm-server.html">Secure APM Server</a></span>
»
<span class="breadcrumb-link"><a href="secure-communication-agents.html">Secure communication with APM Agents</a></span>
»
<span class="breadcrumb-node">Secret token</span>
</div>
<div class="navheader">
<span class="prev">
<a href="api-key-settings.html">« <code class="literal">api_key.*</code> configuration options</a>
</span>
<span class="next">
<a href="securing-communication-elasticsearch.html">Secure communication with Elasticsearch »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="secret-token"></a>Secret token<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/master/docs/secure-communication-agents.asciidoc">edit</a></h2>
</div></div></div>
<p>You can configure a secret token to authorize requests to the APM Server.
This ensures that only your agents are able to send data to your APM servers.
Both the agents and the APM servers have to be configured with the same secret token.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Secret tokens are sent as plain-text,
so they only provide security when used in combination with <a class="xref" href="ssl-setup.html" title="SSL/TLS communication">SSL/TLS</a>.</p>
</div>
</div>
<p>To secure the communication between APM Agents and the APM Server with a secret token:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Make sure <a class="xref" href="ssl-setup.html" title="SSL/TLS communication">SSL/TLS</a> is enabled
</li>
<li class="listitem">
<a class="xref" href="secret-token.html#set-secret-token" title="Set a secret token">Set a secret token in your Agents and Server</a>
</li>
<li class="listitem">
<a class="xref" href="secret-token.html#https-in-agents" title="HTTPS communication in APM Agents">Enable HTTPS in your APM Agents</a>
</li>
</ol>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Secret tokens are not applicable for the RUM Agent,
as there is no way to prevent them from being publicly exposed.</p>
</div>
</div>
<h3><a id="set-secret-token"></a>Set a secret token<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/master/docs/secure-communication-agents.asciidoc">edit</a></h3>
<p><span class="strong strong"><strong>APM Server configuration</strong></span></p>
<p>Here&#8217;s how you set the secret token in APM Server:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">apm-server.secret_token: &lt;secret-token&gt;</pre>
</div>
<p>We recommend saving the token in the APM Server <a class="xref" href="keystore.html" title="Secrets keystore for secure settings">Secrets keystore</a>.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Secret tokens are not applicable for the RUM Agent,
as there is no way to prevent them from being publicly exposed.</p>
</div>
</div>
<p><span class="strong strong"><strong>Agent specific configuration</strong></span></p>
<p>Each Agent has a configuration for setting the value of the secret token:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Go Agent</strong></span>: <a href="/guide/en/apm/agent/go/current/configuration.html#config-secret-token" class="ulink" target="_top"><code class="literal">ELASTIC_APM_SECRET_TOKEN</code></a>
</li>
<li class="listitem">
<span class="strong strong"><strong>Java Agent</strong></span>: <a href="/guide/en/apm/agent/java/current/config-reporter.html#config-secret-token" class="ulink" target="_top"><code class="literal">secret_token</code></a>
</li>
<li class="listitem">
<span class="strong strong"><strong>.NET Agent</strong></span>: <a href="/guide/en/apm/agent/dotnet/current/config-reporter.html#config-secret-token" class="ulink" target="_top"><code class="literal">ELASTIC_APM_SECRET_TOKEN</code></a>
</li>
<li class="listitem">
<span class="strong strong"><strong>Node.js Agent</strong></span>: <a href="/guide/en/apm/agent/nodejs/current/configuration.html#secret-token" class="ulink" target="_top"><code class="literal">Secret Token</code></a>
</li>
<li class="listitem">
<span class="strong strong"><strong>Python Agent</strong></span>: <a href="/guide/en/apm/agent/python/current/configuration.html#config-secret-token" class="ulink" target="_top"><code class="literal">secret_token</code></a>
</li>
<li class="listitem">
<span class="strong strong"><strong>Ruby Agent</strong></span>: <a href="/guide/en/apm/agent/ruby/current/configuration.html#config-secret-token" class="ulink" target="_top"><code class="literal">secret_token</code></a>
</li>
</ul>
</div>
<h3><a id="https-in-agents"></a>HTTPS communication in APM Agents<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/master/docs/secure-communication-agents.asciidoc">edit</a></h3>
<p>To enable secure communication in your Agents, you need to update the configured server URL to use <code class="literal">HTTPS</code> instead of <code class="literal">HTTP</code>.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Go Agent</strong></span>: <a href="/guide/en/apm/agent/go/current/configuration.html#config-server-url" class="ulink" target="_top"><code class="literal">ELASTIC_APM_SERVER_URL</code></a>
</li>
<li class="listitem">
<span class="strong strong"><strong>Java Agent</strong></span>: <a href="/guide/en/apm/agent/java/current/config-reporter.html#config-server-urls" class="ulink" target="_top"><code class="literal">server_urls</code></a>
</li>
<li class="listitem">
<span class="strong strong"><strong>Node.js Agent</strong></span>: <a href="/guide/en/apm/agent/nodejs/current/configuration.html#server-url" class="ulink" target="_top"><code class="literal">serverUrl</code></a>
</li>
<li class="listitem">
<span class="strong strong"><strong>Python Agent</strong></span>: <a href="/guide/en/apm/agent/python/current/" class="ulink" target="_top"><code class="literal">server_url</code></a>
</li>
<li class="listitem">
<span class="strong strong"><strong>Ruby Agent</strong></span>: <a href="/guide/en/apm/agent/ruby/current/configuration.html#config-server-url" class="ulink" target="_top"><code class="literal">server_url</code></a>
</li>
</ul>
</div>
<p>Some Agents also allow you to specify a custom certificate authority for connecting to APM Server.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Go Agent</strong></span>: <a href="/guide/en/apm/agent/go/current/configuration.html#config-server-cert" class="ulink" target="_top"><code class="literal">ELASTIC_APM_SERVER_CERT</code></a>
</li>
<li class="listitem">
<span class="strong strong"><strong>Python Agent</strong></span>: <a href="/guide/en/apm/agent/python/current/configuration.html#config-server-cert" class="ulink" target="_top"><code class="literal">ELASTIC_APM_SERVER_CERT</code></a>
</li>
<li class="listitem">
<span class="strong strong"><strong>Ruby Agent</strong></span>: <a href="/guide/en/apm/agent/ruby/current/configuration.html#config-ssl-ca-cert" class="ulink" target="_top"><code class="literal">server_ca_certedit</code></a>
</li>
</ul>
</div>
<p>Most Agents that don&#8217;t allow you specify a custom certificate will allow you to
disable verification of the SSL certificate.
This ensures encryption, but does not verify that you are sending data to the correct APM Server.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Java Agent</strong></span>: <a href="/guide/en/apm/agent/java/current/config-reporter.html#config-verify-server-cert" class="ulink" target="_top"><code class="literal">verify_server_cert</code></a>
</li>
<li class="listitem">
<span class="strong strong"><strong>Node.js Agent</strong></span>: <a href="/guide/en/apm/agent/nodejs/current/configuration.html#validate-server-cert" class="ulink" target="_top"><code class="literal">verifyServerCert</code></a>
</li>
<li class="listitem">
<span class="strong strong"><strong>.NET Agent</strong></span>: <a href="/guide/en/apm/agent/dotnet/current/config-reporter.html#config-verify-server-cert" class="ulink" target="_top"><code class="literal">VerifyServerCert</code></a>
</li>
</ul>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="api-key-settings.html">« <code class="literal">api_key.*</code> configuration options</a>
</span>
<span class="next">
<a href="securing-communication-elasticsearch.html">Secure communication with Elasticsearch »</a>
</span>
</div>
</div>
</body>
</html>
