<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Elasticsearch index engines | Elastic App Search Documentation [8.6] | Elastic</title>
<link rel="home" href="index.html" title="Elastic App Search Documentation [8.6]"/>
<link rel="up" href="guides.html" title="Guides"/>
<link rel="prev" href="elasticsearch-search-guide.html" title="Elasticsearch search for App Search Guide"/>
<link rel="next" href="elasticsearch-engines-create.html" title="Create Elasticsearch index engines"/>
<meta name="DC.type" content="Learn/Docs/App Search/Guide/8.6"/>
<meta name="DC.subject" content="App Search"/>
<meta name="DC.identifier" content="8.6"/>
</head>
<body>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="index.html">Elastic App Search Documentation [8.6]</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="guides.html">Guides</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="elasticsearch-search-guide.html">« Elasticsearch search for App Search Guide</a>
</span>
<span class="next">
<a href="elasticsearch-engines-create.html">Create Elasticsearch index engines »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="elasticsearch-engines"></a>Elasticsearch index engines<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.6/app-search-docs/guides/elasticsearch-engines.asciidoc">edit</a></h2>
</div></div></div>
<p>Since 8.2.0, Elastic Enterprise Search allows you to generate Engines based on existing Elasticsearch indices.
With these engines you can use Enterprise Search features on data that has already been ingested into Elasticsearch.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<a class="xref" href="elasticsearch-engines.html#elasticsearch-engines-features" title="Elasticsearch index engines features">Elasticsearch index engines features</a>
</li>
<li class="listitem">
<a class="xref" href="elasticsearch-engines.html#elasticsearch-engines-supported-fields" title="Elasticsearch index engines supported field types">Elasticsearch index engines supported field types</a>
</li>
<li class="listitem">
<a class="xref" href="elasticsearch-engines-create.html" title="Create Elasticsearch index engines">Create Elasticsearch index engines</a>
</li>
<li class="listitem">
<a class="xref" href="elasticsearch-engines-text-subfields-support-conventions.html" title="Elasticsearch engines precision tuning - text field conventions">Elasticsearch engines precision tuning - text field conventions</a>
</li>
</ol>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="elasticsearch-engines-features"></a>Elasticsearch index engines features<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.6/app-search-docs/guides/elasticsearch-engines.asciidoc">edit</a></h3>
</div></div></div>
<p>The following table compares Enterprise Search managed engines with Elasticsearch index engines:</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<tbody>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Feature</strong></span></p></td>
<td align="left" valign="top"><p><span class="strong strong"><strong>Engine</strong></span></p></td>
<td align="left" valign="top"><p><span class="strong strong"><strong>Elasticsearch Index Engine</strong></span></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="documents.html" title="Documents API">Documents API</a></p></td>
<td align="left" valign="top"><p>Get, List, Create, Update, Delete</p></td>
<td align="left" valign="top"><p>Get, List</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="schema.html" title="Schema API">Schema API</a></p></td>
<td align="left" valign="top"><p>List, Update</p></td>
<td align="left" valign="top"><p>List</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="search-api-precision.html" title="Search API precision (beta)">Search API precision (beta)</a>, <a class="xref" href="precision-tuning.html" title="Precision tuning (beta)">Precision tuning (beta)</a></p></td>
<td align="left" valign="top"><p>Supported</p></td>
<td align="left" valign="top"><p>Supported for specific fields, see <a class="xref" href="elasticsearch-engines-text-subfields-support-conventions.html" title="Elasticsearch engines precision tuning - text field conventions">Elasticsearch engines precision tuning - text field conventions</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Usable as a source engine in <a class="xref" href="meta-engines.html" title="Source engines API">meta engines</a></p></td>
<td align="left" valign="top"><p>Supported</p></td>
<td align="left" valign="top"><p>Supported</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="synonyms.html" title="Synonyms API">Synonyms</a></p></td>
<td align="left" valign="top"><p>Supported</p></td>
<td align="left" valign="top"><p>Supported</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="curations.html" title="Curations API reference">Curations</a></p></td>
<td align="left" valign="top"><p>Supported</p></td>
<td align="left" valign="top"><p>Supported</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="api-logs.html" title="API logs API">API logs</a></p></td>
<td align="left" valign="top"><p>Supported</p></td>
<td align="left" valign="top"><p>Supported</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="analytics.html" title="Analytics APIs">Analytics</a></p></td>
<td align="left" valign="top"><p>Supported</p></td>
<td align="left" valign="top"><p>Supported</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="adaptive-relevance-api-reference.html" title="Adaptive relevance API reference (beta)">Adaptive relevance</a></p></td>
<td align="left" valign="top"><p>Supported</p></td>
<td align="left" valign="top"><p>Supported</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="query-suggestions-guide.html" title="Query Suggestions Guide">Query suggestions</a></p></td>
<td align="left" valign="top"><p>Supported</p></td>
<td align="left" valign="top"><p>Supported</p></td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="elasticsearch-engines-supported-fields"></a>Elasticsearch index engines supported field types<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.6/app-search-docs/guides/elasticsearch-engines.asciidoc">edit</a></h3>
</div></div></div>
<p>App Search engines do not support all Elasticsearch field types.
Enterprise Search will ignore unsupported Elasticsearch field types.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Enterprise Search will not modify your data and index mappings.</p>
<p>Unsupported field types will not be removed or altered and will remain available for Elasticsearch features and APIs.</p>
</div>
</div>
<p>Enterprise Search supports the following Elasticsearch field types:</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<tbody>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Elasticsearch field type</strong></span></p></td>
<td align="left" valign="top"><p><span class="strong strong"><strong>Corresponding Enterprise Search field type</strong></span></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p>text</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p>text</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>wildcard</p></td>
<td align="left" valign="top"><p>text</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>text</p></td>
<td align="left" valign="top"><p>text</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>geo_point</p></td>
<td align="left" valign="top"><p>geolocation</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>date_nanos</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p>number</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p>number</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>short</p></td>
<td align="left" valign="top"><p>number</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>byte</p></td>
<td align="left" valign="top"><p>number</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>double</p></td>
<td align="left" valign="top"><p>number</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>float</p></td>
<td align="left" valign="top"><p>number</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>half_float</p></td>
<td align="left" valign="top"><p>number</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>scaled_float</p></td>
<td align="left" valign="top"><p>number</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>unsigned_long</p></td>
<td align="left" valign="top"><p>number</p></td>
</tr>
</tbody>
</table>
</div>
<p>See <a class="xref" href="api-reference.html#overview-api-references-supported-features" title="Supported Features, By Field Type">Supported Features, By Field Type</a> for a full App Search field types reference.</p>
<p>Unlike the <code class="literal">text</code> field type in Enterprise Search, not all Elasticsearch text fields above have the same features as Enterprise Search text fields:
<code class="literal">keyword</code>, <code class="literal">constant_keyword</code>, <code class="literal">wildcard</code> can be filtered, sorted, grouped and faceted. <code class="literal">text</code> fields cannot.
Having a subfield for <code class="literal">text</code> fields will provide those capabilities to the field.</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="elasticsearch-engines-object-fields"></a>Object fields<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.6/app-search-docs/guides/elasticsearch-engines.asciidoc">edit</a></h4>
</div></div></div>
<p>Elasticsearch has an <a href="/guide/en/elasticsearch/reference/8.6/object.html" class="ulink" target="_blank" rel="noopener">object field type</a> intended to support JSON inner objects.</p>
<p>In the following mapping the fields <code class="literal">manager</code> and <code class="literal">manager.name</code> are object fields:</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
  "mappings": {
    "properties": {
      "manager": {
        "properties": {
          "age":  { "type": "integer" },
          "name": {
            "properties": {
              "first": { "type": "text" },
              "last":  { "type": "text" }
            }
          }
        }
      }
    }
  }
}</pre>
</div>
<p>When using such a mapping, subfields of the object fields are added to the <a class="xref" href="schema.html#schema-read" title="List Schema">schema</a> of the Elasticsearch index engine:</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
  "manager.age": "number",
  "manager.name.first": "text",
  "manager.name.last": "text"
}</pre>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h5 class="title"><a id="elasticsearch-engines-object-fields-features"></a>Object fields features<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.6/app-search-docs/guides/elasticsearch-engines.asciidoc">edit</a></h5>
</div></div></div>
<p>Use subfields of an object just like any other standard field in <a class="xref" href="search.html" title="Search API">Search API</a> features, including in filters, facets, sorting, and groups.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h5 class="title"><a id="elasticsearch-engines-object-fields-search-results"></a>Object fields in search results<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.6/app-search-docs/guides/elasticsearch-engines.asciidoc">edit</a></h5>
</div></div></div>
<p>Object fields are rendered like any other field in <a class="xref" href="result-fields-highlights.html" title="Search API result fields">search results</a>:</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
  "manager.age": {
    "raw": 30
  },
  "manager.name.first": {
    "raw": "John"
  },
  "manager.name.last": {
    "raw": "Smith"
  }
}</pre>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p><span class="strong strong"><strong>Elasticsearch flattens object field data.</strong></span></p>
<p>Internally, Elasticsearch flattens object field data into multi-value fields.</p>
<p>Given the following document:</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
  "manager": [
    {
      "name": {
        "first" : "John",
        "last" :  "Smith"
      }
    },
    {
      "name": {
        "first" : "Alice",
        "last" :  "White"
      }
    }
  ]
}</pre>
</div>
<p>Elasticsearch will store it internally this way:</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
  "manager.name.first": ["John", "Alice"],
  "manager.mame.last": ["Smith", "White"]
}</pre>
</div>
<p>In order to stay consistent with how objects are internally stored, the App Search Search API returns flattened object fields:</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">"manager.name.first": {
    "raw": ["John", "Alice"]
  },
  "manager.name.last": {
    "raw": ["Smith", "White"]
  }</pre>
</div>
<p>To keep the independence of each object in the array and not lose the association between <code class="literal">Alice</code> and <code class="literal">White</code>, use the <a href="/guide/en/elasticsearch/reference/8.6/nested.html" class="ulink" target="_blank" rel="noopener">nested field type</a> instead of the <a href="/guide/en/elasticsearch/reference/8.6/object.html" class="ulink" target="_blank" rel="noopener">object field type</a>.</p>
</div>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="elasticsearch-engines-nested-fields"></a>Nested fields<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.6/app-search-docs/guides/elasticsearch-engines.asciidoc">edit</a></h4>
</div></div></div>
<p>Elasticsearch has a <a href="/guide/en/elasticsearch/reference/8.6/nested.html" class="ulink" target="_blank" rel="noopener">nested field type</a> intended to support JSON inner objects.
Unlike the <a href="/guide/en/elasticsearch/reference/8.6/object.html" class="ulink" target="_blank" rel="noopener">object field type</a>, Elasticsearch does not flatten nested object values into multi-value fields.</p>
<p>In the following mapping the field <code class="literal">manager</code> is a nested object field:</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
  "mappings": {
    "properties": {
      "manager": {
        "type": "nested",
        "properties": {
          "age":  { "type": "integer" },
          "name": {
            "properties": {
              "first": { "type": "text" },
              "last":  { "type": "text" }
            }
          }
        }
      }
    }
  }
}</pre>
</div>
<p>When using such a mapping, the nested field and its subfields are added to the Elasticsearch index engine <a class="xref" href="schema.html#schema-read" title="List Schema">schema</a> in a flattened form:</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
  "manager": "nested",
  "manager.age": "number",
  "manager.name.first": "text",
  "manager.name.last": "text"
}</pre>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h5 class="title"><a id="elasticsearch-engines-nested-fields-filters"></a>Nested fields filters<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.6/app-search-docs/guides/elasticsearch-engines.asciidoc">edit</a></h5>
</div></div></div>
<p>It is possible to use subfields of a nested field as <a class="xref" href="filters.html" title="Search API filters">filters</a> in the Search API.</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
  "query": "",
  "filters": {
    "manager.name.first": "Rich"
  }
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h5 class="title"><a id="elasticsearch-engines-nested-fields-limitations"></a>Nested fields limitations<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.6/app-search-docs/guides/elasticsearch-engines.asciidoc">edit</a></h5>
</div></div></div>
<p>Nested fields cannot be used as <code class="literal">search_fields</code> in the Search API.
Nested fields do not contribute to full-text search.</p>
<p>Additionally, nested fields and their subfield are not usable with the following features of the Search API:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="boosts.html" title="Search API boosts">Boosts</a>
</li>
<li class="listitem">
<a class="xref" href="facets.html" title="Search API facets">Facets</a>
</li>
<li class="listitem">
<a class="xref" href="grouping.html" title="Search API group">Grouping</a>
</li>
<li class="listitem">
<a class="xref" href="sort.html" title="Search API sort">Sort order</a>
</li>
</ul>
</div>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p><span class="strong strong"><strong>Searching, faceting, boosting, and sorting with nested fields</strong></span></p>
<p>To include a nested field&#8217;s textual value in a full-text search query, you can copy the value of the subfield into the root of the document by remapping your Elasticsearch index using <a href="/guide/en/elasticsearch/reference/8.6/copy-to.html" class="ulink" target="_blank" rel="noopener"><code class="literal">copy_to</code></a>.</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
  "mappings": {
    "properties": {
      "manager_first_name": {
        "type": "text"
      },
      "manager": {
        "type": "nested",
        "properties": {
          "age":  { "type": "integer" },
          "name": {
            "properties": {
              "first": {
                "type": "text",
                "copy_to": "manager_first_name"
              },
              "last": {
                "type": "text"
              }
            }
          }
        }
      }
    }
  }
}</pre>
</div>
<p>By doing so, you create a new <code class="literal">manager_first_name</code> field containing all the values of <code class="literal">manager.name.first</code>.
Because the copied field exists outside of the nested object it can be used as a full-text search field.</p>
<p>You can use this technique to build facets, boosts, sort orders or groups from nested object subfields.</p>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h5 class="title"><a id="elasticsearch-engines-nested-fields-search-results"></a>Nested fields in search results<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.6/app-search-docs/guides/elasticsearch-engines.asciidoc">edit</a></h5>
</div></div></div>
<p>Unlike with the <a href="/guide/en/elasticsearch/reference/8.6/object.html" class="ulink" target="_blank" rel="noopener">object field type</a>, App Search does not flatten nested object values into multi-value fields in search results.
App Search flattens objects but preserves the overall structure of the original document.</p>
<p>Given the following document:</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
  "manager": [
    {
      "name": {
        "first" : "John",
        "last" :  "Smith"
      }
    },
    {
      "name": {
        "first" : "Alice",
        "last" :  "White"
      }
    }
  ]
}</pre>
</div>
<p>App Search will render it this way in Search API results:</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
  "manager": [
    {
      "name.first": { "raw": "John" },
      "name.last": { "raw": "Smith" }
    },
    {
      "name.first": { "raw": "Alice" },
      "name.last": { "raw": "White" }
    }
  ]
}</pre>
</div>
<p>Because nested object subfields cannot be used in full-text search, using them as a <code class="literal">snippet</code> in search results is not possible.
App Search will raise an error if you use a nested field or subfield as a <code class="literal">snippet</code>.</p>
</div>

</div>

</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="elasticsearch-search-guide.html">« Elasticsearch search for App Search Guide</a>
</span>
<span class="next">
<a href="elasticsearch-engines-create.html">Create Elasticsearch index engines »</a>
</span>
</div>
</div>
</body>
</html>
