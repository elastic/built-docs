<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title xmlns="">Configure authentication credentials
        | Filebeat Reference [6.6]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Filebeat Reference [6.6]" /><link rel="up" href="securing-beats.html" title="Configure Filebeat to use X-Pack security" /><link rel="prev" href="feature-roles.html" title="Filebeat features that require authorization" /><link rel="next" href="beats-user-access.html" title="Grant users access to Filebeat indices" /><meta xmlns="" name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta xmlns="" name="DC.type" content="Learn/Docs/Filebeat/Reference/6.6" /><meta xmlns="" name="DC.subject" content="Filebeat" /><meta xmlns="" name="DC.identifier" content="6.6" /></head><body><div xmlns="" class="page_header">You are looking at documentation for an older release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div xmlns="" class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Filebeat Reference
      [6.6]
    </a></span> » <span class="breadcrumb-link"><a href="securing-filebeat.html">Securing Filebeat</a></span> » <span class="breadcrumb-link"><a href="securing-beats.html">Configure Filebeat to use X-Pack security</a></span> » <span class="breadcrumb-node">Configure authentication credentials</span></div><div xmlns="" class="navheader"><span class="prev"><a href="feature-roles.html">
              « 
              Filebeat features that require authorization</a>
           
        </span><span class="next">
           
          <a href="beats-user-access.html">Grant users access to Filebeat indices
               »
            </a></span></div><div class="xpack section"><div class="titlepage"><div><div><h2 class="title"><a id="beats-basic-auth"></a>Configure authentication credentials<a xmlns="" href="https://github.com/elastic/beats/edit/6.6/libbeat/docs/security/basic-auth.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a><a xmlns="" class="xpack_tag" href="/subscriptions"></a></h2></div></div></div><p>When sending data to a secured cluster through the <code class="literal">elasticsearch</code>
output, Filebeat must either provide basic authentication credentials
or present a client certificate.</p><p>To configure authentication credentials for Filebeat:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem"><p class="simpara">
Create a writer role that has the following privileges:
</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<span class="strong strong"><strong>Cluster</strong></span>: <code class="literal">manage_index_templates</code>, <code class="literal">monitor</code>, and
<code class="literal">manage_ingest_pipelines</code>
</li><li class="listitem">
<span class="strong strong"><strong>Index</strong></span>: <code class="literal">write</code> and <code class="literal">create_index</code> on the Filebeat indices
</li></ul></div><p class="simpara">You can create roles from the <span class="strong strong"><strong>Management / Roles</strong></span> UI in Kibana or through the
<code class="literal">role</code> API. For example, the following request creates a role named
<code class="literal">filebeat_writer</code>:</p><div xmlns="" class="pre_wrapper lang-sh"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-sh">POST _xpack/security/role/filebeat_writer
{
  "cluster": ["manage_index_templates","monitor","manage_ingest_pipelines"], <a id="CO19-1"></a><i xmlns="" class="conum" data-value="1"></i>
  "indices": [
    {
      "names": [ "filebeat-*" ], <a id="CO19-2"></a><i xmlns="" class="conum" data-value="2"></i>
      "privileges": ["write","create_index"]
    }
  ]
}</pre></div><div xmlns="" class="console_widget" data-snippet=":CONSOLE:"></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO19-1"><i xmlns="" class="conum" data-value="1"></i></a> </p></td><td valign="top" align="left"><p>
The <code class="literal">manage_ingest_pipelines</code> cluster privilege is required to run
Filebeat modules.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO19-2"><i xmlns="" class="conum" data-value="2"></i></a> </p></td><td valign="top" align="left"><p>
If you use a custom Filebeat index pattern, specify that pattern
instead of the default <code class="literal">filebeat-*</code> pattern.
</p></td></tr></table></div></li><li class="listitem"><p class="simpara">
If you plan to use <a class="ulink" href="https://www.elastic.co/guide/en/elasticsearch/reference/6.6/getting-started-index-lifecycle-management.html" target="_top">index
lifecycle management</a>, create a role that has the following privileges. These
privileges are required to load index lifecycle policies and create and manage
rollover indices:
</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<span class="strong strong"><strong>Cluster:</strong></span> <code class="literal">manage_ilm</code>
</li><li class="listitem"><p class="simpara">
<span class="strong strong"><strong>Index:</strong></span> <code class="literal">write</code>, <code class="literal">create_index</code>, <code class="literal">manage</code>, and <code class="literal">manage_ilm</code> on the
Filebeat indices
</p><div xmlns="" class="pre_wrapper lang-sh"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-sh">POST _xpack/security/role/filebeat_ilm
{
  "cluster": ["manage_ilm"],
  "indices": [
    {
      "names": [ "filebeat-*","shrink-filebeat-*"],
      "privileges": ["write","create_index","manage","manage_ilm"]
    }
  ]
}</pre></div><div xmlns="" class="console_widget" data-snippet=":CONSOLE:"></div></li></ul></div></li><li class="listitem"><p class="simpara">
Assign the writer role to the user that Filebeat will use to connect to
Elasticsearch. Make sure you also assign any roles that are required for specific
features. For the list of features and required roles, see <a class="xref" href="feature-roles.html" title="Filebeat features that require authorization">Filebeat features that require authorization</a>.
</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
To authenticate as a native user, create a user for Filebeat to use
internally and assign it the writer role, plus any other roles that are
needed.
</p><p class="simpara">You can create users from the <span class="strong strong"><strong>Management / Users</strong></span> UI in Kibana or through the
<code class="literal">user</code> API. For example, following request creates a user
named <code class="literal">filebeat_internal</code> that has the
<code class="literal">filebeat_writer</code> and <code class="literal">kibana_user</code> roles:</p><div xmlns="" class="pre_wrapper lang-sh"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-sh">POST /_xpack/security/user/filebeat_internal
{
  "password" : "YOUR_PASSWORD",
  "roles" : [ "filebeat_writer","kibana_user"],
  "full_name" : "Internal Filebeat User"
}</pre></div><div xmlns="" class="console_widget" data-snippet=":CONSOLE:"></div></li><li class="listitem"><p class="simpara">
To use PKI authentication, assign the writer role, plus any other roles that are
needed, in the <code class="literal">role_mapping.yml</code> configuration file. Specify the user by the
distinguished name that appears in its certificate:
</p><div xmlns="" class="pre_wrapper lang-yaml"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-yaml">filebeat_writer:
  - "cn=Internal Filebeat User,ou=example,o=com"
kibana_user:
  - "cn=Internal Filebeat User,ou=example,o=com"</pre></div><p class="simpara">For more information, see
<a class="ulink" href="https://www.elastic.co/guide/en/elastic-stack-overview/6.6/mapping-roles.html#mapping-roles-file" target="_top">Using Role Mapping Files</a>.</p></li></ol></div></li><li class="listitem"><p class="simpara">
In the Filebeat configuration file, specify authentication credentials
for the <code class="literal">elasticsearch</code> output:
</p><div class="orderedlist"><ol class="orderedlist" type="a"><li class="listitem"><p class="simpara">
To use basic authentication, configure the <code class="literal">username</code> and <code class="literal">password</code> settings.
For example, the following Filebeat output configuration uses the native
<code class="literal">filebeat_internal</code> user to connect to Elasticsearch:
</p><div xmlns="" class="pre_wrapper lang-js"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">output.elasticsearch:
  hosts: ["localhost:9200"]
  username: "filebeat_internal" <a id="CO20-1"></a><i xmlns="" class="conum" data-value="1"></i>
  password: "YOUR_PASSWORD" <a id="CO20-2"></a><i xmlns="" class="conum" data-value="2"></i></pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO20-1"><i xmlns="" class="conum" data-value="1"></i></a> </p></td><td valign="top" align="left"><p>
You created this user earlier.
</p></td></tr><tr><td width="5%" valign="top" align="left"><p><a href="#CO20-2"><i xmlns="" class="conum" data-value="2"></i></a> </p></td><td valign="top" align="left"><p>
The example shows a hard-coded password, but you should store sensitive
values in the <a class="link" href="keystore.html" title="Secrets keystore for secure settings">secrets keystore</a>.
</p></td></tr></table></div></li><li class="listitem"><p class="simpara">
To use PKI authentication, configure the <code class="literal">certificate</code> and <code class="literal">key</code> settings:
</p><div xmlns="" class="pre_wrapper lang-js"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-js">output.elasticsearch:
  hosts: ["localhost:9200"]
  ssl.certificate: "/etc/pki/client/cert.pem" <a id="CO21-1"></a><i xmlns="" class="conum" data-value="1"></i>
  ssl.key: "/etc/pki/client/cert.key"</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO21-1"><i xmlns="" class="conum" data-value="1"></i></a> </p></td><td valign="top" align="left"><p>
The distinguished name (DN) in the certificate must be mapped to
the <code class="literal">filebeat_writer</code> and <code class="literal">kibana_user</code> roles in the
<code class="literal">role_mapping.yml</code> configuration file on each node in the Elasticsearch cluster.
</p></td></tr></table></div></li></ol></div></li></ol></div></div><div xmlns="" class="navfooter"><span class="prev"><a href="feature-roles.html">
              « 
              Filebeat features that require authorization</a>
           
        </span><span class="next">
           
          <a href="beats-user-access.html">Grant users access to Filebeat indices
               »
            </a></span></div></body></html>