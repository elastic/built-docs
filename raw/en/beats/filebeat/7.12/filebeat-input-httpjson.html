<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>HTTP JSON input | Filebeat Reference [7.12] | Elastic</title>
<meta class="elastic" name="content" content="HTTP JSON input | Filebeat Reference [7.12]">

<link rel="home" href="index.html" title="Filebeat Reference [7.12]"/>
<link rel="up" href="configuration-filebeat-options.html" title="Configure inputs"/>
<link rel="prev" href="filebeat-input-http_endpoint.html" title="HTTP Endpoint input"/>
<link rel="next" href="filebeat-input-kafka.html" title="Kafka input"/>
<meta class="elastic" name="product_version" content="7.12"/>
<meta class="elastic" name="product_name" content="Filebeat"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Filebeat/Reference/7.12"/>
<meta name="DC.subject" content="Filebeat"/>
<meta name="DC.identifier" content="7.12"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body><div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Filebeat Reference [7.12]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="configuring-howto-filebeat.html">Configure Filebeat</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="configuration-filebeat-options.html">Configure inputs</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="filebeat-input-http_endpoint.html">« HTTP Endpoint input</a>
</span>
<span class="next">
<a href="filebeat-input-kafka.html">Kafka input »</a>
</span>
</div>
<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="filebeat-input-httpjson"></a>HTTP JSON input<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h2>
</div></div></div>

<p>Use the <code class="literal">httpjson</code> input to read messages from an HTTP API with JSON payloads.</p>
<p>This input supports:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Auth</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Basic
</li>
<li class="listitem">
OAuth2
</li>
</ul>
</div>
</li>
<li class="listitem">
Retrieval at a configurable interval
</li>
<li class="listitem">
Pagination
</li>
<li class="listitem">
Retries
</li>
<li class="listitem">
Rate limiting
</li>
<li class="listitem">
Request transformations
</li>
<li class="listitem">
Response transformations
</li>
</ul>
</div>
<p>Example configurations:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
# Fetch your public IP every minute.
- type: httpjson
  config_version: 2
  interval: 1m
  request.url: https://api.ipify.org/?format=json
  processors:
    - decode_json_fields:
        fields: ["message"]
        target: "json"</pre>
</div>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: httpjson
  config_version: 2
  request.url: http://localhost:9200/_search?scroll=5m
  request.method: POST
  response.split:
    target: body.hits.hits
  response.pagination:
    - set:
        target: url.value
        value: http://localhost:9200/_search/scroll
    - set:
        target: url.params.scroll_id
        value: '[[.last_response.body._scroll_id]]'
    - set:
        target: body.scroll
        value: 5m</pre>
</div>
<p>Additionally, it supports authentication via Basic auth, HTTP Headers or oauth2.</p>
<p>Example configurations with authentication:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: httpjson
  config_version: 2
  request.url: http://localhost
  request.transforms:
    - set:
        target: header.Authorization
        value: 'Basic aGVsbG86d29ybGQ='</pre>
</div>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: httpjson
  config_version: 2
  auth.oauth2:
    client.id: 12345678901234567890abcdef
    client.secret: abcdef12345678901234567890
    token_url: http://localhost/oauth2/token
  request.url: http://localhost</pre>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="input-state"></a>Input state<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h3>
</div></div></div>
<p>The <code class="literal">httpjson</code> input keeps a runtime state between requests. This state can be accessed by some configuration options and transforms.</p>
<p>The state has the following elements:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">last_response.url.value</code>: The full URL with params and fragments from the last request with a successful response.
</li>
<li class="listitem">
<code class="literal">last_response.url.params</code>: A map containing the params from the URL in <code class="literal">last_response.url.value</code>.
</li>
<li class="listitem">
<code class="literal">last_response.header</code>: A map containing the headers from the last successful response.
</li>
<li class="listitem">
<code class="literal">last_response.body</code>: A map containing the parsed JSON body from the last successful response. This is the response as it comes from the remote server.
</li>
<li class="listitem">
<code class="literal">last_response.page</code>: A number indicating the page number of the last response.
</li>
<li class="listitem">
<code class="literal">first_event</code>: A map representing the first event sent to the output (result from applying transforms to <code class="literal">last_response.body</code>).
</li>
<li class="listitem">
<code class="literal">last_event</code>: A map representing the last event sent to the output (result from applying transforms to <code class="literal">last_response.body</code>).
</li>
<li class="listitem">
<code class="literal">url.value</code>: The full URL with params and fragments.
</li>
<li class="listitem">
<code class="literal">url.params</code>: A map containing the URL params.
</li>
<li class="listitem">
<code class="literal">header</code>: A map containing the headers. References request headers when used in <a class="xref" href="filebeat-input-httpjson.html#request-transforms" title="request.transforms"><code class="literal">request.transforms</code></a> or <a class="xref" href="filebeat-input-httpjson.html#request-rate-limit" title="request.rate_limit.limit"><code class="literal">request.rate_limit.limit</code></a> configuration sections, and to the last response headers when used in <a class="xref" href="filebeat-input-httpjson.html#response-transforms" title="response.transforms"><code class="literal">response.transforms</code></a>, <a class="xref" href="filebeat-input-httpjson.html#response-split" title="response.split"><code class="literal">response.split</code></a> or <a class="xref" href="filebeat-input-httpjson.html#response-pagination" title="response.pagination"><code class="literal">response.pagination</code></a> configuration sections.
</li>
<li class="listitem">
<code class="literal">body</code>: A map containing the body. References request body when used in <a class="xref" href="filebeat-input-httpjson.html#request-transforms" title="request.transforms"><code class="literal">request.transforms</code></a> configuration section, and to the last response body when used in <a class="xref" href="filebeat-input-httpjson.html#response-transforms" title="response.transforms"><code class="literal">response.transforms</code></a>, <a class="xref" href="filebeat-input-httpjson.html#response-split" title="response.split"><code class="literal">response.split</code></a> or <a class="xref" href="filebeat-input-httpjson.html#response-pagination" title="response.pagination"><code class="literal">response.pagination</code></a> configuration sections.
</li>
<li class="listitem">
<code class="literal">cursor</code>: A map containing any data the user configured to be stored between restarts (See <a class="xref" href="filebeat-input-httpjson.html#cursor" title="cursor"><code class="literal">cursor</code></a>).
</li>
</ul>
</div>
<p>All of the mentioned objects are only stored at runtime, except <code class="literal">cursor</code>, which has values that are persisted between restarts.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="transforms"></a>Transforms<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h3>
</div></div></div>
<p>A transform is an action that lets the user modify the <a class="xref" href="filebeat-input-httpjson.html#input-state" title="Input state">input state</a>. Depending on where the transform is defined, it will have access for reading or writing different elements of the <a class="xref" href="filebeat-input-httpjson.html#input-state" title="Input state">state</a>.</p>
<p>The access limitations are described in the corresponding configuration sections.</p>
<h4><a id="_append"></a><code class="literal">append</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>Appends a value to a list. If the field does not exist, the first entry will be a scalar value, and subsequent additions will convert the value to a list.</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">- append:
    target: body.foo.bar
    value: '[[.cursor.baz]]'
    default: "a default value"</pre>
</div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">target</code> defines the destination field where the value is stored.
</li>
<li class="listitem">
<code class="literal">value</code> defines the value that will be stored and it is a <a class="xref" href="filebeat-input-httpjson.html#value-templates" title="Value templates">value template</a>.
</li>
<li class="listitem">
<code class="literal">default</code> defines the fallback value whenever <code class="literal">value</code> is empty or the template parsing fails. Default templates do not have access to any state, only to functions.
</li>
<li class="listitem">
<code class="literal">fail_on_template_error</code> if set to <code class="literal">true</code> an error will be returned and the request will be aborted when the template evaluation fails. Default is <code class="literal">false</code>.
</li>
</ul>
</div>
<h4><a id="_delete"></a><code class="literal">delete</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>Deletes the target field.</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">- delete:
    target: body.foo.bar</pre>
</div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">target</code> defines the destination field to delete. If <code class="literal">target</code> is a list and not a single element, the complete list will be deleted.
</li>
</ul>
</div>
<h4><a id="_set"></a><code class="literal">set</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>Sets a value.</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">- set:
    target: body.foo.bar
    value: '[[.cursor.baz]]'
    default: "a default value"</pre>
</div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">target</code> defines the destination field where the value is stored.
</li>
<li class="listitem">
<code class="literal">value</code> defines the value that will be stored and it is a <a class="xref" href="filebeat-input-httpjson.html#value-templates" title="Value templates">value template</a>.
</li>
<li class="listitem">
<code class="literal">default</code> defines the fallback value whenever <code class="literal">value</code> is empty or the template parsing fails. Default templates do not have access to any state, only to functions.
</li>
<li class="listitem">
<code class="literal">fail_on_template_error</code> if set to <code class="literal">true</code> an error will be returned and the request will be aborted when the template evaluation fails. Default is <code class="literal">false</code>.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="value-templates"></a>Value templates<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h3>
</div></div></div>
<p>Some configuration options and transforms can use value templates. Value templates are Go templates with access to the input state and to some built-in functions.
Please note that delimiters are changed from the default <code class="literal">{{ }}</code> to <code class="literal">[[ ]]</code> to improve interoperability with other templating mechanisms.</p>
<p>To see which <a class="xref" href="filebeat-input-httpjson.html#input-state" title="Input state">state elements</a> and operations are available, see the documentation for the option or <a class="xref" href="filebeat-input-httpjson.html#transforms" title="Transforms">transform</a> where you want to use a value template.</p>
<p>A value template looks like:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">- set:
    target: body.foo.bar
    value: '[[.cursor.baz]] more data'
    default: "a default value"</pre>
</div>
<p>The content inside the brackets <code class="literal">[[</code> <code class="literal">]]</code> is evaluated. For more information on Go templates please refer to <a href="https://golang.org/pkg/text/template" class="ulink" target="_top">the Go docs</a>.</p>
<p>Some built-in helper functions are provided to work with the input state inside value templates:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">parseDuration</code>: parses duration strings and returns <code class="literal">time.Duration</code>. Example: <code class="literal">[[parseDuration "1h"]]</code>.
</li>
<li class="listitem">
<code class="literal">now</code>: returns the current <code class="literal">time.Time</code> object in UTC. Optionally, it can receive a <code class="literal">time.Duration</code> as a parameter. Example: <code class="literal">[[now (parseDuration "-1h")]]</code> returns the time at 1 hour before now.
</li>
<li class="listitem">
<code class="literal">parseTimestamp</code>: parses a timestamp in seconds and returns a <code class="literal">time.Time</code> in UTC. Example: <code class="literal">[[parseTimestamp 1604582732]]</code> returns <code class="literal">2020-11-05 13:25:32 +0000 UTC</code>.
</li>
<li class="listitem">
<code class="literal">parseTimestampMilli</code>: parses a timestamp in milliseconds and returns a <code class="literal">time.Time</code> in UTC. Example: <code class="literal">[[parseTimestamp 1604582732000]]</code> returns <code class="literal">2020-11-05 13:25:32 +0000 UTC</code>.
</li>
<li class="listitem">
<code class="literal">parseTimestampNano</code>: parses a timestamp in nanoseconds and returns a <code class="literal">time.Time</code> in UTC. Example: <code class="literal">[[parseTimestamp 1604582732000000000]]</code> returns <code class="literal">2020-11-05 13:25:32 +0000 UTC</code>.
</li>
<li class="listitem">
<code class="literal">parseDate</code>: parses a date string and returns a <code class="literal">time.Time</code> in UTC. By default the expected layout is <code class="literal">RFC3339</code> but optionally can accept any of the Golang predefined layouts or a custom one. Example: <code class="literal">[[ parseDate "2020-11-05T12:25:32Z" ]]</code>, <code class="literal">[[ parseDate "2020-11-05T12:25:32.1234567Z" "RFC3339Nano" ]]</code>, <code class="literal">[[ (parseDate "Thu Nov  5 12:25:32 +0000 2020" "Mon Jan _2 15:04:05 -0700 2006").UTC ]]</code>.
</li>
<li class="listitem">
<code class="literal">formatDate</code>: formats a <code class="literal">time.Time</code>. By default the format layout is <code class="literal">RFC3339</code> but optionally can accept any of the Golang predefined layouts or a custom one. It will default to UTC timezone when formatting, but you can specify a different timezone. If the timezone is incorrect, it will default to UTC. Example: <code class="literal">[[ formatDate (now) "UnixDate" ]]</code>, <code class="literal">[[ formatDate (now) "UnixDate" "America/New_York" ]]</code>.
</li>
<li class="listitem">
<code class="literal">getRFC5988Link</code>: extracts a specific relation from a list of <a href="https://tools.ietf.org/html/rfc5988" class="ulink" target="_top">RFC5988</a> links. It is useful when parsing header values for pagination. Example: <code class="literal">[[ getRFC5988Link "next" .last_response.header.Link ]]</code>.
</li>
<li class="listitem">
<code class="literal">toInt</code>: converts a string to an integer. Returns 0 if the conversion fails.
</li>
<li class="listitem">
<code class="literal">add</code>: adds a list of integers and returns their sum.
</li>
</ul>
</div>
<p>In addition to the provided functions, any of the native functions for <code class="literal">time.Time</code> and <code class="literal">http.Header</code> types can be used on the corresponding objects. Examples: <code class="literal">[[(now).Day]]</code>, <code class="literal">[[.last_response.header.Get "key"]]</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_configuration_options_7"></a>Configuration options<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h3>
</div></div></div>
<p>The <code class="literal">httpjson</code> input supports the following configuration options plus the
<a class="xref" href="filebeat-input-httpjson.html#filebeat-input-httpjson-common-options" title="Common options">Common options</a> described later.</p>
<h4><a id="_config_version"></a><code class="literal">config_version</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>Defines the configuration version. Current supported versions are: <code class="literal">1</code> and <code class="literal">2</code>. Default: <code class="literal">1</code>.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This setting defaults to <code class="literal">1</code> to avoid breaking current configurations. V1 configuration is deprecated and will be unsupported in future releases. Any new configuration should use <code class="literal">config_version: 2</code>.</p>
</div>
</div>
<h4><a id="_interval"></a><code class="literal">interval</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>Duration between repeated requests. It may make additional pagination requests in response to the initial request if pagination is enabled. Default: <code class="literal">60s</code>.</p>
<h4><a id="_auth_basic_enabled"></a><code class="literal">auth.basic.enabled</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>When set to <code class="literal">false</code>, disables the basic auth configuration. Default: <code class="literal">true</code>.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Basic auth settings are disabled if either <code class="literal">enabled</code> is set to <code class="literal">false</code> or
the <code class="literal">auth.basic</code> section is missing.</p>
</div>
</div>
<h4><a id="_auth_basic_user"></a><code class="literal">auth.basic.user</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>The user to authenticate with.</p>
<h4><a id="_auth_basic_password"></a><code class="literal">auth.basic.password</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>The password to use.</p>
<h4><a id="_auth_oauth2_enabled"></a><code class="literal">auth.oauth2.enabled</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>When set to <code class="literal">false</code>, disables the oauth2 configuration. Default: <code class="literal">true</code>.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>OAuth2 settings are disabled if either <code class="literal">enabled</code> is set to <code class="literal">false</code> or
the <code class="literal">auth.oauth2</code> section is missing.</p>
</div>
</div>
<h4><a id="_auth_oauth2_provider"></a><code class="literal">auth.oauth2.provider</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>Used to configure supported oauth2 providers.
Each supported provider will require specific settings. It is not set by default.
Supported providers are: <code class="literal">azure</code>, <code class="literal">google</code>.</p>
<h4><a id="_auth_oauth2_client_id"></a><code class="literal">auth.oauth2.client.id</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>The client ID used as part of the authentication flow. It is always required
except if using <code class="literal">google</code> as provider. Required for providers: <code class="literal">default</code>, <code class="literal">azure</code>.</p>
<h4><a id="_auth_oauth2_client_secret"></a><code class="literal">auth.oauth2.client.secret</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>The client secret used as part of the authentication flow. It is always required
except if using <code class="literal">google</code> as provider. Required for providers: <code class="literal">default</code>, <code class="literal">azure</code>.</p>
<h4><a id="_auth_oauth2_scopes"></a><code class="literal">auth.oauth2.scopes</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>A list of scopes that will be requested during the oauth2 flow.
It is optional for all providers.</p>
<h4><a id="_auth_oauth2_token_url"></a><code class="literal">auth.oauth2.token_url</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>The endpoint that will be used to generate the tokens during the oauth2 flow. It is required if no provider is specified.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>For <code class="literal">azure</code> provider either <code class="literal">token_url</code> or <code class="literal">azure.tenant_id</code> is required.</p>
</div>
</div>
<h4><a id="_auth_oauth2_endpoint_params"></a><code class="literal">auth.oauth2.endpoint_params</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>Set of values that will be sent on each request to the <code class="literal">token_url</code>. Each param key can have multiple values.
Can be set for all providers except <code class="literal">google</code>.</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">- type: httpjson
  config_version: 2
  auth.oauth2:
    endpoint_params:
      Param1:
        - ValueA
        - ValueB
      Param2:
        - Value</pre>
</div>
<h4><a id="_auth_oauth2_azure_tenant_id"></a><code class="literal">auth.oauth2.azure.tenant_id</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>Used for authentication when using <code class="literal">azure</code> provider.
Since it is used in the process to generate the <code class="literal">token_url</code>, it can&#8217;t be used in
combination with it. It is not required.</p>
<p>For information about where to find it, you can refer to
<a href="https://docs.microsoft.com/en-us/azure/active-directory/develop/howto-create-service-principal-portal" class="ulink" target="_top">https://docs.microsoft.com/en-us/azure/active-directory/develop/howto-create-service-principal-portal</a>.</p>
<h4><a id="_auth_oauth2_azure_resource"></a><code class="literal">auth.oauth2.azure.resource</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>The accessed WebAPI resource when using <code class="literal">azure</code> provider.
It is not required.</p>
<h4><a id="_auth_oauth2_google_credentials_file"></a><code class="literal">auth.oauth2.google.credentials_file</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>The credentials file for Google.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Only one of the credentials settings can be set at once. If none is provided, loading
default credentials from the environment will be attempted via ADC. For more information about
how to provide Google credentials, please refer to <a href="https://cloud.google.com/docs/authentication" class="ulink" target="_top">https://cloud.google.com/docs/authentication</a>.</p>
</div>
</div>
<h4><a id="_auth_oauth2_google_credentials_json"></a><code class="literal">auth.oauth2.google.credentials_json</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>Your credentials information as raw JSON.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Only one of the credentials settings can be set at once. If none is provided, loading
default credentials from the environment will be attempted via ADC. For more information about
how to provide Google credentials, please refer to <a href="https://cloud.google.com/docs/authentication" class="ulink" target="_top">https://cloud.google.com/docs/authentication</a>.</p>
</div>
</div>
<h4><a id="_auth_oauth2_google_jwt_file"></a><code class="literal">auth.oauth2.google.jwt_file</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>The JWT Account Key file for Google.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Only one of the credentials settings can be set at once. If none is provided, loading
default credentials from the environment will be attempted via ADC. For more information about
how to provide Google credentials, please refer to <a href="https://cloud.google.com/docs/authentication" class="ulink" target="_top">https://cloud.google.com/docs/authentication</a>.</p>
</div>
</div>
<h4><a id="_request_url"></a><code class="literal">request.url</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>The URL of the HTTP API. Required.</p>
<h4><a id="_request_method"></a><code class="literal">request.method</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>HTTP method to use when making requests. <code class="literal">GET</code> or <code class="literal">POST</code> are the options. Default: <code class="literal">GET</code>.</p>
<h4><a id="_request_encode_as"></a><code class="literal">request.encode_as</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>ContentType used for encoding the request body. If set it will force the encoding in the specified format regardless of the <code class="literal">Content-Type</code> header value, otherwise it will honor it if possible or fallback to <code class="literal">application/json</code>. By default the requests are sent with <code class="literal">Content-Type: application/json</code>. Supported values: <code class="literal">application/json</code> and <code class="literal">application/x-www-form-urlencoded</code>. <code class="literal">application/x-www-form-urlencoded</code> will url encode the <code class="literal">url.params</code> and set them as the body. It is not set by default.</p>
<h4><a id="_request_body"></a><code class="literal">request.body</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>An optional HTTP POST body. The configuration value must be an object, and it
will be encoded to JSON. This is only valid when <code class="literal">request.method</code> is <code class="literal">POST</code>.
Defaults to <code class="literal">null</code> (no HTTP body).</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">- type: httpjson
  config_version: 2
  request.method: POST
  request.body:
    query:
      bool:
        filter:
          term:
            type: authentication</pre>
</div>
<h4><a id="_request_timeout"></a><code class="literal">request.timeout</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>Duration before declaring that the HTTP client connection has timed out. Valid time units are <code class="literal">ns</code>, <code class="literal">us</code>, <code class="literal">ms</code>, <code class="literal">s</code>, <code class="literal">m</code>, <code class="literal">h</code>. Default: <code class="literal">30s</code>.</p>
<h4><a id="_request_ssl"></a><code class="literal">request.ssl</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>This specifies SSL/TLS configuration. If the ssl section is missing, the host&#8217;s
CAs are used for HTTPS connections. See <a class="xref" href="configuration-ssl.html" title="Configure SSL"><em>SSL</em></a> for more
information.</p>
<h4><a id="_request_retry_max_attempts"></a><code class="literal">request.retry.max_attempts</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>The maximum number of retries for the HTTP client. Default: <code class="literal">5</code>.</p>
<h4><a id="_request_retry_wait_min"></a><code class="literal">request.retry.wait_min</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>The minimum time to wait before a retry is attempted. Default: <code class="literal">1s</code>.</p>
<h4><a id="_request_retry_wait_max"></a><code class="literal">request.retry.wait_max</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>The maximum time to wait before a retry is attempted. Default: <code class="literal">60s</code>.</p>
<h4><a id="_request_redirect_forward_headers"></a><code class="literal">request.redirect.forward_headers</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>When set to <code class="literal">true</code> request headers are forwarded in case of a redirect. Default: <code class="literal">false</code>.</p>
<h4><a id="_request_redirect_headers_ban_list"></a><code class="literal">request.redirect.headers_ban_list</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>When <code class="literal">redirect.forward_headers</code> is set to <code class="literal">true</code>, all headers <em>except</em> the ones defined in this list will be forwarded. Default: <code class="literal">[]</code>.</p>
<h4><a id="_request_redirect_max_redirects"></a><code class="literal">request.redirect.max_redirects</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>The maximum number of redirects to follow for a request. Default: <code class="literal">10</code>.</p>
<h4><a id="request-rate-limit"></a><code class="literal">request.rate_limit.limit</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>The value of the response that specifies the total limit. It is defined with a Go template value. Can read state from: [<code class="literal">.last_response.header</code>]</p>
<h4><a id="_request_rate_limit_remaining"></a><code class="literal">request.rate_limit.remaining</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>The value of the response that specifies the remaining quota of the rate limit. It is defined with a Go template value. Can read state from: [<code class="literal">.last_response.header</code>]</p>
<h4><a id="_request_rate_limit_reset"></a><code class="literal">request.rate_limit.reset</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>The value of the response that specifies the epoch time when the rate limit will reset. It is defined with a Go template value. Can read state from: [<code class="literal">.last_response.header</code>]</p>
<h4><a id="request-transforms"></a><code class="literal">request.transforms</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>List of transforms to apply to the request before each execution.</p>
<p>Available transforms for request: [<code class="literal">append</code>, <code class="literal">delete</code>, <code class="literal">set</code>].</p>
<p>Can read state from: [<code class="literal">.last_response.*</code>, <code class="literal">.last_event.*</code>, <code class="literal">.cursor.*</code>].</p>
<p>Can write state to: [<code class="literal">header.*</code>, <code class="literal">url.params.*</code>, <code class="literal">body.*</code>].</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: httpjson
  config_version: 2
  request.url: http://localhost:9200/_search?scroll=5m
  request.method: POST
  request.transforms:
    - set:
        target: body.from
        value: '[[now (parseDuration "-1h")]]'</pre>
</div>
<h4><a id="_response_decode_as"></a><code class="literal">response.decode_as</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>ContentType used for decoding the response body. If set it will force the decoding in the specified format regardless of the <code class="literal">Content-Type</code> header value, otherwise it will honor it if possible or fallback to <code class="literal">application/json</code>. Supported values: <code class="literal">application/json, application/x-ndjson</code>. It is not set by default.</p>
<h4><a id="response-transforms"></a><code class="literal">response.transforms</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>List of transforms to apply to the response once it is received.</p>
<p>Available transforms for response: [<code class="literal">append</code>, <code class="literal">delete</code>, <code class="literal">set</code>].</p>
<p>Can read state from: [<code class="literal">.last_response.*</code>, <code class="literal">.last_event.*</code>, <code class="literal">.cursor.*</code>, <code class="literal">.header.*</code>, <code class="literal">.url.*</code>].</p>
<p>Can write state to: [<code class="literal">body.*</code>].</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: httpjson
  config_version: 2
  request.url: http://localhost:9200/_search?scroll=5m
  request.method: POST
  response.transforms:
    - delete:
        target: body.very_confidential
  response.split:
    target: body.hits.hits
  response.pagination:
    - set:
        target: url.value
        value: http://localhost:9200/_search/scroll
    - set:
        target: url.params.scroll_id
        value: '[[.last_response.body._scroll_id]]'
    - set:
        target: body.scroll
        value: 5m</pre>
</div>
<h4><a id="response-split"></a><code class="literal">response.split</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>Split operation to apply to the response once it is received. A split can convert a map, array, or string into multiple events.</p>
<h4><a id="_response_split_target"></a><code class="literal">response.split[].target</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>Defines the target field upon the split operation will be performed.</p>
<h4><a id="_response_split_type"></a><code class="literal">response.split[].type</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>Defines the field type of the target. Allowed values: <code class="literal">array</code>, <code class="literal">map</code>, <code class="literal">string</code>. <code class="literal">string</code> requires the use of the <code class="literal">delimiter</code> options to specify what characters to split the string on.  <code class="literal">delimiter</code> always behaves as if <code class="literal">keep_parent</code> is set to <code class="literal">true</code>. Default: <code class="literal">array</code>.</p>
<h4><a id="_response_split_transforms"></a><code class="literal">response.split[].transforms</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>A set of transforms can be defined. This list will be applied after <code class="literal">response.transforms</code> and after the object has been modified based on <code class="literal">response.split[].keep_parent</code> and <code class="literal">response.split[].key_field</code>.</p>
<p>Available transforms for response: [<code class="literal">append</code>, <code class="literal">delete</code>, <code class="literal">set</code>].</p>
<p>Can read state from: [<code class="literal">.last_response.*</code>, <code class="literal">.first_event.*</code>, <code class="literal">.last_event.*</code>, <code class="literal">.cursor.*</code>, <code class="literal">.header.*</code>, <code class="literal">.url.*</code>].</p>
<p>Can write state to: [<code class="literal">body.*</code>].</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>in this context, <code class="literal">body.*</code> will be the result of all the previous transformations.</p>
</div>
</div>
<h4><a id="_response_split_keep_parent"></a><code class="literal">response.split[].keep_parent</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>If set to true, the fields from the parent document (at the same level as <code class="literal">target</code>) will be kept. Otherwise a new document will be created using <code class="literal">target</code> as the root. Default: <code class="literal">false</code>.</p>
<h4><a id="_response_split_delimiter"></a><code class="literal">response.split[].delimiter</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>Required if using split type of <code class="literal">string</code>.  This is the sub string used to split the string.  For example if <code class="literal">delimiter</code> was "\n" and the string was "line 1\nline 2", then the split would result in "line 1" and "line 2".</p>
<h4><a id="_response_split_key_field"></a><code class="literal">response.split[].key_field</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>Valid when used with <code class="literal">type: map</code>. When not empty, defines a new field where the original key value will be stored.</p>
<h4><a id="_response_split_split"></a><code class="literal">response.split[].split</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>Nested split operation. Split operations can be nested at will. An event won&#8217;t be created until the deepest split operation is applied.</p>
<h4><a id="_response_request_body_on_pagination"></a><code class="literal">response.request_body_on_pagination</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>If set to true, the values in <code class="literal">request.body</code> are sent for pagination requests. Default: <code class="literal">false</code>.</p>
<h4><a id="response-pagination"></a><code class="literal">response.pagination</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>List of transforms that will be applied to the response to every new page request. All the transforms from <code class="literal">request.transform</code> will be executed and then <code class="literal">response.pagination</code> will be added to modify the next request as needed. For subsequent responses, the usual <code class="literal">response.transforms</code> and <code class="literal">response.split</code> will be executed normally.</p>
<p>Available transforms for pagination: [<code class="literal">append</code>, <code class="literal">delete</code>, <code class="literal">set</code>].</p>
<p>Can read state from: [<code class="literal">.last_response.*</code>, <code class="literal">.first_event.*</code>, <code class="literal">.last_event.*</code>, <code class="literal">.cursor.*</code>].</p>
<p>Can write state to: [<code class="literal">body.*</code>, <code class="literal">header.*</code>, <code class="literal">url.*</code>].</p>
<p>Examples using split:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>We have a response with two nested arrays, and we want a document for each of the elements of the inner array:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
  "this": "is kept",
  "alerts": [
    {
      "this_is": "also kept",
      "entities": [
        {
          "something": "something"
        },
        {
          "else": "else"
        }
      ]
    },
    {
      "this_is": "also kept 2",
      "entities": [
        {
          "something": "something 2"
        },
        {
          "else": "else 2"
        }
      ]
    }
  ]
}</pre>
</div>
<p>The config will look like:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: httpjson
  config_version: 2
  interval: 1m
  request.url: https://example.com
  response.split:
    target: body.alerts
    type: array
    keep_parent: true
    split:
      # paths in nested splits need to represent the state of body, not only their current level of nesting
      target: body.alerts.entities
      type: array
      keep_parent: true</pre>
</div>
<p>This will output:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">[
  {
    "this": "is kept",
    "alerts": {
      "this_is": "also kept",
      "entities": {
        "something": "something"
      }
    }
  },
  {
    "this": "is kept",
    "alerts": {
      "this_is": "also kept",
      "entities": {
        "else": "else"
      }
    }
  },
  {
    "this": "is kept",
    "alerts": {
      "this_is": "also kept 2",
      "entities": {
        "something": "something 2"
      }
    }
  },
  {
    "this": "is kept",
    "alerts": {
      "this_is": "also kept 2",
      "entities": {
        "else": "else 2"
      }
    }
  }
]</pre>
</div>
</li>
<li class="listitem">
<p>We have a response with an array with two objects, and we want a document for each of the object keys while keeping the keys values:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
  "this": "is not kept",
  "alerts": [
    {
      "this_is": "kept",
      "entities": {
        "id1": {
          "something": "something"
        }
      }
    },
    {
      "this_is": "kept 2",
      "entities": {
        "id2": {
          "something": "something 2"
        }
      }
    }
  ]
}</pre>
</div>
<p>The config will look like:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: httpjson
  config_version: 2
  interval: 1m
  request.url: https://example.com
  response.split:
    target: body.alerts
    type: array
    keep_parent: false
    split:
      # this time alerts will not exist because previous keep_parent is false
      target: body.entities
      type: map
      keep_parent: true
      key_field: id</pre>
</div>
<p>This will output:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">[
  {
    "this_is": "kept",
    "entities": {
      "id": "id1",
      "something": "something"
    }
  },
  {
    "this_is": "kept 2",
    "entities": {
      "id": "id2",
      "something": "something 2"
    }
  }
]</pre>
</div>
</li>
<li class="listitem">
<p>We have a response with an array with two objects, and we want a document for each of the object keys while applying a transform to each:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
  "this": "is not kept",
  "alerts": [
    {
      "this_is": "also not kept",
      "entities": {
        "id1": {
          "something": "something"
        }
      }
    },
    {
      "this_is": "also not kept",
      "entities": {
        "id2": {
          "something": "something 2"
        }
      }
    }
  ]
}</pre>
</div>
<p>The config will look like:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: httpjson
  config_version: 2
  interval: 1m
  request.url: https://example.com
  response.split:
    target: body.alerts
    type: array
    split:
      transforms:
        - set:
            target: body.new
            value: will be added to each
      target: body.entities
      type: map</pre>
</div>
<p>This will output:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">[
  {
    "something": "something",
    "new": "will be added for each"
  },
  {
    "something": "something 2",
    "new": "will be added for each"
  }
]</pre>
</div>
</li>
<li class="listitem">
<p>We have a response with a keys whose value is a string.  We want the string to be split on a delimiter and a document for each sub strings.</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
  "this": "is kept",
  "lines": "Line 1\nLine 2\nLine 3"
}</pre>
</div>
<p>The config will look like:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: httpjson
  config_version: 2
  interval: 1m
  request.url: https://example.com
  response.split:
    target: body.lines
    type: string
    delimiter: "\n"</pre>
</div>
<p>This will output:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">[
  {
    "this": "is kept",
    "lines": "Line 1"
  },
  {
    "this": "is kept",
    "lines": "Line 2"
  },
  {
    "this": "is kept",
    "lines": "Line 3"
  }
]</pre>
</div>
</li>
</ul>
</div>
<h4><a id="cursor"></a><code class="literal">cursor</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>Cursor is a list of key value objects where arbitrary values are defined. The values are interpreted as  <a class="xref" href="filebeat-input-httpjson.html#value-templates" title="Value templates">value templates</a> and a default template can be set. Cursor state is kept between input restarts and updated once all the events for a request are published.</p>
<p>Can read state from: [<code class="literal">.last_response.*</code>, <code class="literal">.first_event.*</code>, <code class="literal">.last_event.*</code>].</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Default templates do not have access to any state, only to functions.</p>
</div>
</div>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: httpjson
  config_version: 2
  interval: 1m
  request.url: https://api.ipify.org/?format=json
  response.transforms:
    - set:
        target: body.last_requested_at
        value: '[[.cursor.last_requested_at]]'
        default: "[[now]]"
  cursor:
    last_requested_at:
      value: '[[now]]'
  processors:
    - decode_json_fields:
        fields: ["message"]
        target: "json"</pre>
</div>
<h4><a id="_api_key"></a><code class="literal">api_key</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>Deprecated, use <code class="literal">request.transforms</code>.</p>
<h4><a id="_http_client_timeout"></a><code class="literal">http_client_timeout</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>Deprecated, use <code class="literal">request.timeout</code>.</p>
<h4><a id="_http_headers"></a><code class="literal">http_headers</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>Deprecated, use <code class="literal">request.transforms</code>.</p>
<h4><a id="_http_method"></a><code class="literal">http_method</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>Deprecated, use <code class="literal">request.method</code>.</p>
<h4><a id="_http_request_body"></a><code class="literal">http_request_body</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>Deprecated, use <code class="literal">request.body</code>.</p>
<h4><a id="_json_objects_array"></a><code class="literal">json_objects_array</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>Deprecated, use <code class="literal">request.split</code>.</p>
<h4><a id="_split_events_by"></a><code class="literal">split_events_by</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>Deprecated, use <code class="literal">request.split</code>.</p>
<h4><a id="_no_http_body"></a><code class="literal">no_http_body</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>Deprecated.</p>
<h4><a id="_pagination"></a><code class="literal">pagination.*</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>Deprecated, use <code class="literal">response.pagination</code>.</p>
<h4><a id="_rate_limit"></a><code class="literal">rate_limit.*</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>Deprecated, use <code class="literal">request.rate_limit.*</code>.</p>
<h4><a id="_retry"></a><code class="literal">retry.*</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>Deprecated, use <code class="literal">request.retry.*</code>.</p>
<h4><a id="_ssl_2"></a><code class="literal">ssl</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>Deprecated, use <code class="literal">request.ssl</code>.</p>
<h4><a id="_url_2"></a><code class="literal">url</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>Deprecated, use <code class="literal">request.url</code>.</p>
<h4><a id="_oauth2"></a><code class="literal">oauth2.*</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h4>
<p>Deprecated, use <code class="literal">auth.oauth2.*</code>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_request_life_cycle"></a>Request life cycle<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/x-pack/filebeat/docs/inputs/input-httpjson.asciidoc">edit</a></h3>
</div></div></div>
<p><span class="image"><img src="images/input-httpjson-lifecycle.png" alt="Request lifecycle"></span></p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
At every defined interval a new request is created.
</li>
<li class="listitem">
The request is transformed using the configured <code class="literal">request.transforms</code>.
</li>
<li class="listitem">
The resulting transformed request is executed.
</li>
<li class="listitem">
The server responds (here is where any retry or rate limit policy takes place when configured).
</li>
<li class="listitem">
The response is transformed using the configured <code class="literal">response.transforms</code> and <code class="literal">response.split</code>.
</li>
<li class="listitem">
Each resulting event is published to the output.
</li>
<li class="listitem">
If a <code class="literal">response.pagination</code> is configured and there are more pages, a new request is created using it, otherwise the process ends until the next interval.
</li>
</ol>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="filebeat-input-httpjson-common-options"></a>Common options<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></h3>
</div></div></div>
<p>The following configuration options are supported by all inputs.</p>
<h5><a id="_enabled_9"></a><code class="literal">enabled</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></h5>
<p>Use the <code class="literal">enabled</code> option to enable and disable inputs. By default, enabled is
set to true.</p>
<h5><a id="_tags_9"></a><code class="literal">tags</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></h5>
<p>A list of tags that Filebeat includes in the <code class="literal">tags</code> field of each published
event. Tags make it easy to select specific events in Kibana or apply
conditional filtering in Logstash. These tags will be appended to the list of
tags specified in the general configuration.</p>
<p>Example:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: httpjson
  . . .
  tags: ["json"]</pre>
</div>
<h5><a id="filebeat-input-httpjson-fields"></a><code class="literal">fields</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></h5>
<p>Optional fields that you can specify to add additional information to the
output. For example, you might add fields that you can use for filtering log
data. Fields can be scalar values, arrays, dictionaries, or any nested
combination of these. By default, the fields that you specify here will be
grouped under a <code class="literal">fields</code> sub-dictionary in the output document. To store the
custom fields as top-level fields, set the <code class="literal">fields_under_root</code> option to true.
If a duplicate field is declared in the general configuration, then its value
will be overwritten by the value declared here.</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: httpjson
  . . .
  fields:
    app_id: query_engine_12</pre>
</div>
<h5><a id="fields-under-root-httpjson"></a><code class="literal">fields_under_root</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></h5>
<p>If this option is set to true, the custom
<a class="xref" href="filebeat-input-httpjson.html#filebeat-input-httpjson-fields" title="fields">fields</a> are stored as top-level fields in
the output document instead of being grouped under a <code class="literal">fields</code> sub-dictionary. If
the custom field names conflict with other field names added by Filebeat,
then the custom fields overwrite the other fields.</p>
<h5><a id="_processors_9"></a><code class="literal">processors</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></h5>
<p>A list of processors to apply to the input data.</p>
<p>See <a class="xref" href="filtering-and-enhancing-data.html" title="Filter and enhance data with processors"><em>Processors</em></a> for information about specifying
processors in your config.</p>
<h5><a id="_pipeline_9"></a><code class="literal">pipeline</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></h5>
<p>The Ingest Node pipeline ID to set for the events generated by this input.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The pipeline ID can also be configured in the Elasticsearch output, but
this option usually results in simpler configuration files. If the pipeline is
configured both in the input and output, the option from the
input is used.</p>
</div>
</div>
<h5><a id="_keep_null_9"></a><code class="literal">keep_null</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></h5>
<p>If this option is set to true, fields with <code class="literal">null</code> values will be published in
the output document. By default, <code class="literal">keep_null</code> is set to <code class="literal">false</code>.</p>
<h5><a id="_index_9"></a><code class="literal">index</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></h5>
<p>If present, this formatted string overrides the index for events from this input
(for elasticsearch outputs), or sets the <code class="literal">raw_index</code> field of the event&#8217;s
metadata (for other outputs). This string can only refer to the agent name and
version and the event timestamp; for access to dynamic fields, use
<code class="literal">output.elasticsearch.index</code> or a processor.</p>
<p>Example value: <code class="literal">"%{[agent.name]}-myindex-%{+yyyy.MM.dd}"</code> might
expand to <code class="literal">"filebeat-myindex-2019.11.01"</code>.</p>
<h5><a id="_publisher_pipeline_disable_host_9"></a><code class="literal">publisher_pipeline.disable_host</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/7.12/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></h5>
<p>By default, all events contain <code class="literal">host.name</code>. This option can be set to <code class="literal">true</code> to
disable the addition of this field to all events. The default value is <code class="literal">false</code>.</p>
</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="filebeat-input-http_endpoint.html">« HTTP Endpoint input</a>
</span>
<span class="next">
<a href="filebeat-input-kafka.html">Kafka input »</a>
</span>
</div>
</div>
</body>
</html>
