<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title xmlns="">Enroll Beats in central management
        | Filebeat Reference [7.2]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Filebeat Reference [7.2]" /><link rel="up" href="configuration-central-management.html" title="Beats central management" /><link rel="prev" href="how-central-managment-works.html" title="How central management works" /><link rel="next" href="filebeat-modules.html" title="Modules" /><meta xmlns="" name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta xmlns="" name="DC.type" content="Learn/Docs/Filebeat/Reference/7.2" /><meta xmlns="" name="DC.subject" content="Filebeat" /><meta xmlns="" name="DC.identifier" content="7.2" /></head><body><div xmlns="" class="page_header">You are looking at documentation for an older release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div xmlns="" class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Filebeat Reference
      [7.2]
    </a></span> » <span class="breadcrumb-link"><a href="configuration-central-management.html">Beats central management</a></span> » <span class="breadcrumb-node">Enroll Beats in central management</span></div><div xmlns="" class="navheader"><span class="prev"><a href="how-central-managment-works.html">
              « 
              How central management works</a>
           
        </span><span class="next">
           
          <a href="filebeat-modules.html">Modules
               »
            </a></span></div><div class="xpack chapter"><div class="titlepage"><div><div><h2 class="title"><a id="enroll-beats"></a>Enroll Beats in central management<a xmlns="" href="https://github.com/elastic/beats/edit/7.2/libbeat/docs/shared-central-management.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a><a xmlns="" class="xpack_tag" href="/subscriptions"></a></h2></div></div></div><div xmlns="" class="warning admon"><div class="icon"><img alt="Warning" src="images/icons/warning.png" /></div><div class="admon_content"><p>This functionality is in beta and is subject to change. The design and code is less mature than official GA features and is being provided as-is with no warranties. Beta features are not subject to the support SLA of official GA features.</p></div></div><p>You need to enroll Beats to register them in
<a class="link" href="configuration-central-management.html" title="Beats central management">central management</a> and establish
trust. Enrolled Beats will have the credentials needed to retrieve
configurations from Kibana.</p><p>During the enrollment process:</p><div class="orderedlist"><ol class="orderedlist" type="1"><li class="listitem">
The Beat contacts Kibana and tries to register
</li><li class="listitem">
Kibana registers the Beat instance and returns an access token
 for configuration polling
</li><li class="listitem">
The enroll command creates a backup of your configuration and then
 <span class="strong strong"><strong>overwrites the current settings</strong></span> so they can be managed centrally
</li></ol></div><p>To enroll Beats, use either <a class="link" href="enroll-beats.html#token-based-enrollment" title="Token-based enrollment">token-based</a>
or <a class="link" href="enroll-beats.html#username-password-enrollment" title="Username and password-based enrollment">username and password-based</a> enrollment.</p><h3><a id="_prerequisites_2"></a>Prerequisites<a xmlns="" href="https://github.com/elastic/beats/edit/7.2/libbeat/docs/shared-central-management.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem"><p class="simpara">
Verify that your Elastic license includes the Beats central management
feature.
</p><p class="simpara">Don’t have a license? You can start a 30-day trial. At the end of the trial
period, you can purchase a subscription to keep using central management. For
more information, see <a class="ulink" href="https://www.elastic.co/subscriptions" target="_top">https://www.elastic.co/subscriptions</a> and
<a class="ulink" href="https://www.elastic.co/guide/en/elastic-stack-overview/7.2/license-management.html" target="_top">License Management</a>.</p></li><li class="listitem">
<a class="ulink" href="https://www.elastic.co/guide/en/kibana/7.2/using-kibana-with-security.html" target="_top">Enable security</a> in Kibana to
ensure that only users with sufficient privileges are able to access Beats
configurations.
</li><li class="listitem">
Assign the <code class="literal">beats_admin</code> role to any users who need to enroll Beats or
manage configuration settings in central management.
</li><li class="listitem">
If you plan to use the sample Kibana dashboards provided with Filebeat,
<a class="link" href="load-kibana-dashboards.html" title="Step 4: Set up the Kibana dashboards">load the dashboards</a> before enrolling the
Beat.
</li><li class="listitem">
If you plan to define module configurations in central management, set up the
ingest pipelines before enrolling the Beat. For more information, see
<a class="xref" href="filebeat-modules-quickstart.html#load-ingest-pipelines" title="Load ingest pipelines manually">Load ingest pipelines manually</a>.
</li></ul></div><h3><a id="token-based-enrollment"></a>Token-based enrollment<a xmlns="" href="https://github.com/elastic/beats/edit/7.2/libbeat/docs/shared-central-management.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>Token-based enrollment is recommended if you are enrolling Beats manually.</p><p>To use token-based enrollment, go to Kibana → Management → Beats and click
<code class="literal">Enroll Beat</code>. Select the Beat type and operating system, then copy and run the
command for enrolling the Beat.</p><p>The command has this format:</p><div xmlns="" class="pre_wrapper lang-shell"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-shell">filebeat enroll KIBANA_URL TOKEN</pre></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">
<span class="strong strong"><strong><code class="literal">KIBANA_URL</code></strong></span>
</span></dt><dd>
The URL of the Kibana instance you will use for central management.
</dd><dt><span class="term">
<span class="strong strong"><strong><code class="literal">TOKEN</code></strong></span>
</span></dt><dd>
The enrollment token generated by the Central Management UI. The enrollment token will
expire as soon as it’s used.
</dd></dl></div><p>For example:</p><div xmlns="" class="pre_wrapper lang-shell"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-shell">filebeat enroll http://xyz.gov:5601 70f4b584e8024b96b682c46125a8d81</pre></div><p>Repeat this process to enroll additional Beats.</p><div xmlns="" class="important admon"><div class="icon"><img alt="Important" src="images/icons/important.png" /></div><div class="admon_content"><p xmlns="http://www.w3.org/1999/xhtml"><span class="strong strong"><strong>Windows users:</strong></span> If you installed Filebeat as a service, you must also set
<code class="literal">-path.data</code> to <code class="literal">"C:\ProgramData\filebeat"</code> when you
run the enroll command. For example:</p><p xmlns="http://www.w3.org/1999/xhtml"><code class="literal">.\filebeat.exe enroll <a class="ulink" href="http://xyz.gov:5601" target="_top">http://xyz.gov:5601</a> 70f4b584e8024b96b682c46125a8d81a
-path.data "C:\ProgramData\filebeat"</code></p><p xmlns="http://www.w3.org/1999/xhtml">Why? The service installation script, <code class="literal">install-service-filebeat.ps1</code>,
changes the default data path to match the convention used for Windows. If you
run the enroll command without specifying the correct data path, Filebeat
will be enrolled in central management with the wrong UUID and unable to receive
the configuration.</p></div></div><h3><a id="username-password-enrollment"></a>Username and password-based enrollment<a xmlns="" href="https://github.com/elastic/beats/edit/7.2/libbeat/docs/shared-central-management.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>You can also enroll by specifying a username and password. This is the
recommended way for scripted deploys:</p><div xmlns="" class="pre_wrapper lang-shell"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-shell">filebeat enroll KIBANA_URL --username USER --password METHOD [--force]</pre></div><div class="variablelist"><dl class="variablelist"><dt><span class="term">
<span class="strong strong"><strong><code class="literal">--username USER</code></strong></span>
</span></dt><dd>
The username to use for password-based enrollment. The default
username is <code class="literal">elastic</code>.
</dd><dt><span class="term">
<span class="strong strong"><strong><code class="literal">--password METHOD</code></strong></span>
</span></dt><dd><p class="simpara">
The method to use for getting the password. Available options are:
</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
<code class="literal">env:VAR_NAME</code> gets the password from the environment variable <code class="literal">VAR_NAME</code>
</li><li class="listitem">
<code class="literal">stdin</code> prompts the user for a password. This is the default.
</li></ul></div></dd><dt><span class="term">
<span class="strong strong"><strong><code class="literal">--force</code></strong></span>
</span></dt><dd>
Overwrites the current settings without asking for confirmation.
</dd></dl></div><p>For example:</p><div xmlns="" class="pre_wrapper lang-shell"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-shell">filebeat enroll http://xyz.gov:5601 --username myuser --password stdin</pre></div><div xmlns="" class="important admon"><div class="icon"><img alt="Important" src="images/icons/important.png" /></div><div class="admon_content"><p xmlns="http://www.w3.org/1999/xhtml"><span class="strong strong"><strong>Windows users:</strong></span> If you installed Filebeat as a service, you must also set
<code class="literal">-path.data</code> to <code class="literal">"C:\ProgramData\filebeat"</code> when you
run the enroll command. For example:</p><p xmlns="http://www.w3.org/1999/xhtml"><code class="literal">.\filebeat.exe enroll <a class="ulink" href="http://xyz.gov:5601" target="_top">http://xyz.gov:5601</a> --username myuser --password stdin
-path.data "C:\ProgramData\filebeat"</code></p><p xmlns="http://www.w3.org/1999/xhtml">Why? The service installation script, <code class="literal">install-service-filebeat.ps1</code>,
changes the default data path to match the convention used for Windows. If you
run the enroll command without specifying the correct data path, Filebeat
will be enrolled in central management with the wrong UUID and unable to receive
the configuration.</p></div></div></div><div xmlns="" class="navfooter"><span class="prev"><a href="how-central-managment-works.html">
              « 
              How central management works</a>
           
        </span><span class="next">
           
          <a href="filebeat-modules.html">Modules
               »
            </a></span></div></body></html>