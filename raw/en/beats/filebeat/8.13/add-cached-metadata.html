<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Add cached metadata | Filebeat Reference [8.13] | Elastic</title>
<meta class="elastic" name="content" content="Add cached metadata | Filebeat Reference [8.13]">

<link rel="home" href="index.html" title="Filebeat Reference [8.13]"/>
<link rel="up" href="filtering-and-enhancing-data.html" title="Filter and enhance data with processors"/>
<link rel="prev" href="append.html" title="Append Processor"/>
<link rel="next" href="community-id.html" title="Community ID Network Flow Hash"/>
<meta class="elastic" name="product_version" content="8.13"/>
<meta class="elastic" name="product_name" content="Filebeat"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Filebeat/Reference/8.13"/>
<meta name="DC.subject" content="Filebeat"/>
<meta name="DC.identifier" content="8.13"/>
</head>
<body>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Filebeat Reference [8.13]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="configuring-howto-filebeat.html">Configure Filebeat</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="filtering-and-enhancing-data.html">Filter and enhance data with processors</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="append.html">« Append Processor</a>
</span>
<span class="next">
<a href="community-id.html">Community ID Network Flow Hash »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="add-cached-metadata"></a>Add cached metadata<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.13/libbeat/processors/cache/docs/cache.asciidoc">edit</a></h2>
</div></div></div>

<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in technical preview and may be changed or removed in a future release. Elastic will work to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.</p>
</div>
</div>
<p>The <code class="literal">cache</code> processor enriches events with information from a previously
cached events.</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">processors:
  - cache:
      backend:
        memory:
          id: cache_id
      put:
        key_field: join_key_field
        value_field: source_field</pre>
</div>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">processors:
  - cache:
      backend:
        memory:
          id: cache_id
      get:
        key_field: join_key_field
        target_field: destination_field</pre>
</div>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">processors:
  - cache:
      backend:
        memory:
          id: cache_id
      delete:
        key_field: join_key_field</pre>
</div>
<p>The fields added to the target field will depend on the provider.</p>
<p>It has the following settings:</p>
<p>One of <code class="literal">backend.memory.id</code> or <code class="literal">backend.file.id</code> must be provided.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">backend.capacity</code>
</span>
</dt>
<dd>
The number of elements that can be stored in the cache. <code class="literal">put</code> operations that would cause the capacity to be exceeded will result in evictions of the oldest elements. Values at or below zero indicate no limit. The capacity should not be lower than the number of elements that are expected to be referenced when processing the input as evicted elements are lost. The default is <code class="literal">0</code>, no limit.
</dd>
<dt>
<span class="term">
<code class="literal">backend.memory.id</code>
</span>
</dt>
<dd>
The ID of a memory-based cache. Use the same ID across instance to reference the same cache.
</dd>
<dt>
<span class="term">
<code class="literal">backend.file.id</code>
</span>
</dt>
<dd>
The ID of a file-based cache. Use the same ID across instance to reference the same cache.
</dd>
<dt>
<span class="term">
<code class="literal">backend.file.write_interval</code>
</span>
</dt>
<dd>
The interval between periodic cache writes to the backing file. Valid time units are h, m, s, ms, us/µs and ns. Periodic writes are only made if <code class="literal">backend.file.write_interval</code> is greater than zero. The contents are always written out to the backing file when the processor is closed. Default is zero, no periodic writes.
</dd>
</dl>
</div>
<p>One of <code class="literal">put</code>, <code class="literal">get</code> or <code class="literal">delete</code> must be provided.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">put.key_field</code>
</span>
</dt>
<dd>
Name of the field containing the key to put into the cache. Required if <code class="literal">put</code> is present.
</dd>
<dt>
<span class="term">
<code class="literal">put.value_field</code>
</span>
</dt>
<dd>
Name of the field containing the value to put into the cache. Required if <code class="literal">put</code> is present.
</dd>
<dt>
<span class="term">
<code class="literal">put.ttl</code>
</span>
</dt>
<dd>
The TTL to associate with the cached key/value. Valid time units are h, m, s, ms, us/µs and ns. Required if <code class="literal">put</code> is present.
</dd>
<dt>
<span class="term">
<code class="literal">get.key_field</code>
</span>
</dt>
<dd>
Name of the field containing the key to get. Required if <code class="literal">get</code> is present.
</dd>
<dt>
<span class="term">
<code class="literal">get.target_field</code>
</span>
</dt>
<dd>
Name of the field to which the cached value will be written. Required if <code class="literal">get</code> is present.
</dd>
<dt>
<span class="term">
<code class="literal">delete.key_field</code>
</span>
</dt>
<dd>
Name of the field containing the key to delete. Required if <code class="literal">delete</code> is present.
</dd>
<dt>
<span class="term">
<code class="literal">ignore_missing</code>
</span>
</dt>
<dd>
(Optional) When set to <code class="literal">false</code>, events that don&#8217;t contain any
of the fields in <code class="literal">match_keys</code> will be discarded and an error will be generated. By
default, this condition is ignored.
</dd>
<dt>
<span class="term">
<code class="literal">overwrite_keys</code>
</span>
</dt>
<dd>
(Optional) By default, if a target field already exists, it
will not be overwritten and an error will be logged. If <code class="literal">overwrite_keys</code> is
set to <code class="literal">true</code>, this condition will be ignored.
</dd>
</dl>
</div>
<p>The <code class="literal">cache</code> processor can be used to perform joins within the Beat between
documents within an event stream.</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">processors:
  - if:
      contains:
        log.file.path: fdrv2/aidmaster
    then:
      - cache:
          backend:
            memory:
              id: aidmaster
            capacity: 10000
          put:
            ttl: 168h
            key_field: crowdstrike.aid
            value_field: crowdstrike.metadata
    else:
      - cache:
          backend:
            memory:
              id: aidmaster
          get:
            key_field: crowdstrike.aid
            target_field: crowdstrike.metadata</pre>
</div>
<p>This would enrich an event events with <code class="literal">log.file.path</code> not equal to
"fdrv2/aidmaster" with the <code class="literal">crowdstrike.metadata</code> fields from events with
 <code class="literal">log.file.path</code> equal to that value where the <code class="literal">crowdstrike.aid</code> field
 matches between the source and destination documents. The capacity allows up
 to 10,000 metadata object to be cached between <code class="literal">put</code> and <code class="literal">get</code> operations.</p>
</div>
<div class="navfooter">
<span class="prev">
<a href="append.html">« Append Processor</a>
</span>
<span class="next">
<a href="community-id.html">Community ID Network Flow Hash »</a>
</span>
</div>
</div>
</body>
</html>
