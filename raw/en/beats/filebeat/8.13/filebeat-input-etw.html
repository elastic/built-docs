<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>ETW input | Filebeat Reference [8.13] | Elastic</title>
<meta class="elastic" name="content" content="ETW input | Filebeat Reference [8.13]">

<link rel="home" href="index.html" title="Filebeat Reference [8.13]"/>
<link rel="up" href="configuration-filebeat-options.html" title="Configure inputs"/>
<link rel="prev" href="filebeat-input-entity-analytics.html" title="Entity Analytics Input"/>
<link rel="next" href="filebeat-input-filestream.html" title="filestream input"/>
<meta class="elastic" name="product_version" content="8.13"/>
<meta class="elastic" name="product_name" content="Filebeat"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Filebeat/Reference/8.13"/>
<meta name="DC.subject" content="Filebeat"/>
<meta name="DC.identifier" content="8.13"/>
</head>
<body>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Filebeat Reference [8.13]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="configuring-howto-filebeat.html">Configure Filebeat</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="configuration-filebeat-options.html">Configure inputs</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="filebeat-input-entity-analytics.html">« Entity Analytics Input</a>
</span>
<span class="next">
<a href="filebeat-input-filestream.html">filestream input »</a>
</span>
</div>
<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="filebeat-input-etw"></a>ETW input<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.13/x-pack/filebeat/docs/inputs/input-etw.asciidoc">edit</a></h2>
</div></div></div>

<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in beta and is subject to change. The design and code is less mature than official GA features and is being provided as-is with no warranties. Beta features are not subject to the support SLA of official GA features.</p>
</div>
</div>
<p><a href="https://learn.microsoft.com/en-us/windows/win32/etw/event-tracing-portal" class="ulink" target="_top">Event Tracing for Windows</a> is a powerful logging and tracing mechanism built into the Windows operating system. It provides a detailed view of application and system behavior, performance issues, and runtime diagnostics. Trace events contain an event header and provider-defined data that describes the current state of an application or operation. You can use the events to debug an application and perform capacity and performance analysis.</p>
<p>The ETW input can interact with ETW in three distinct ways: it can create a new session to capture events from user-mode providers, attach to an already existing session to collect ongoing event data, or read events from a pre-recorded .etl file. This functionality enables the module to adapt to different scenarios, such as real-time event monitoring or analyzing historical data.</p>
<p>This input currently supports manifest-based, MOF (classic) and TraceLogging providers while WPP providers are not supported. <a href="https://learn.microsoft.com/en-us/windows/win32/etw/about-event-tracing#types-of-providers" class="ulink" target="_top">Here</a> you can find more information about the available types of providers.</p>
<p>It has been tested in every Windows versions supported by Filebeat, starting from Windows 8.1 and Windows Server 2016. In addition, administrative privileges are required in order to control event tracing sessions.</p>
<p>Example configurations:</p>
<p>Read from a provider by name:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: etw
  id: etw-dnsserver
  enabled: true
  provider.name: Microsoft-Windows-DNSServer
  session_name: DNSServer-Analytical
  trace_level: verbose
  match_any_keyword: 0x8000000000000000
  match_all_keyword: 0</pre>
</div>
<p>Same provider can be defined by its GUID:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: etw
  id: etw-dnsserver
  enabled: true
  provider.guid: {EB79061A-A566-4698-9119-3ED2807060E7}
  session_name: DNSServer-Analytical
  trace_level: verbose
  match_any_keyword: 0x8000000000000000
  match_all_keyword: 0</pre>
</div>
<p>Read from a current session:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: etw
  enabled: true
  id: etw-dnsserver-session
  session: UAL_Usermode_Provider</pre>
</div>
<p>Read from a .etl file:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: etw
  enabled: true
  id: etw-dnsserver-session
  file: "C\Windows\System32\Winevt\Logs\Logfile.etl"</pre>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Examples shown above are mutually exclusive, since the options <code class="literal">provider.name</code>, <code class="literal">provider.guid</code>, <code class="literal">session</code> and <code class="literal">file</code> cannot be present at the same time. Nevertheless, it is a requirement that one of them appears.</p>
</div>
</div>
<p>Multiple providers example:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: etw
  id: etw-dnsserver
  enabled: true
  provider.name: Microsoft-Windows-DNSServer
  session_name: DNSServer-Analytical
  trace_level: verbose
  match_any_keyword: 0xfffffffffffffffff
  match_all_keyword: 0
- type: etw
  id: etw-security
  enabled: true
  provider.name: Microsoft-Windows-Security-Auditing
  session_name: Security-Auditing
  trace_level: warning
  match_any_keyword: 0xffffffffffffffff
  match_all_keyword: 0</pre>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_configuration_options_7"></a>Configuration options<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.13/x-pack/filebeat/docs/inputs/input-etw.asciidoc">edit</a></h3>
</div></div></div>
<p>The <code class="literal">ETW</code> input supports the following configuration options.</p>
<h4><a id="_file"></a><code class="literal">file</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.13/x-pack/filebeat/docs/inputs/input-etw.asciidoc">edit</a></h4>
<p>Specifies the path to an .etl file for reading ETW events. This file format is commonly used for storing ETW event logs.</p>
<h4><a id="_provider_guid"></a><code class="literal">provider.guid</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.13/x-pack/filebeat/docs/inputs/input-etw.asciidoc">edit</a></h4>
<p>Identifies the GUID of an ETW provider. To see available providers, use the command <code class="literal">logman query providers</code>.</p>
<h4><a id="_provider_name"></a><code class="literal">provider.name</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.13/x-pack/filebeat/docs/inputs/input-etw.asciidoc">edit</a></h4>
<p>Specifies the name of the ETW provider. Available providers can be listed using <code class="literal">logman query providers</code>.</p>
<h4><a id="_session_name"></a><code class="literal">session_name</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.13/x-pack/filebeat/docs/inputs/input-etw.asciidoc">edit</a></h4>
<p>When specified a provider, a new session is created. It sets the name for a new ETW session associated with the provider. If not provided, the default is the provider ID prefixed with <em>Elastic-</em>.</p>
<h4><a id="_trace_level"></a><code class="literal">trace_level</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.13/x-pack/filebeat/docs/inputs/input-etw.asciidoc">edit</a></h4>
<p>Defines the filtering level for events based on severity. Valid options include critical, error, warning, informational, and verbose.</p>
<h4><a id="_match_any_keyword"></a><code class="literal">match_any_keyword</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.13/x-pack/filebeat/docs/inputs/input-etw.asciidoc">edit</a></h4>
<p>An 8-byte bitmask used for filtering events from specific provider subcomponents based on keyword matching. Any matching keyword will enable the event to be written. Default value is <code class="literal">0xfffffffffffffffff</code> so it matches every available keyword.</p>
<p>Run <code class="literal">logman query providers "&lt;provider.name&gt;"</code> to list the available keywords for a specific provider.</p>
<h4><a id="_match_all_keyword"></a><code class="literal">match_all_keyword</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.13/x-pack/filebeat/docs/inputs/input-etw.asciidoc">edit</a></h4>
<p>Similar to MatchAnyKeyword, this 8-byte bitmask filters events that match all specified keyword bits. Default value is <code class="literal">0</code> to let every event pass.</p>
<p>Run <code class="literal">logman query providers "&lt;provider.name&gt;"</code> to list the available keywords for a specific provider.</p>
<h4><a id="_session"></a><code class="literal">session</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.13/x-pack/filebeat/docs/inputs/input-etw.asciidoc">edit</a></h4>
<p>Names an existing ETW session to read from. Existing sessions can be listed using <code class="literal">logman query -ets</code>.</p>
</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="filebeat-input-entity-analytics.html">« Entity Analytics Input</a>
</span>
<span class="next">
<a href="filebeat-input-filestream.html">filestream input »</a>
</span>
</div>
</div>
</body>
</html>
