<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Juniper module | Filebeat Reference [8.15] | Elastic</title>
<meta class="elastic" name="content" content="Juniper module | Filebeat Reference [8.15]">

<link rel="home" href="index.html" title="Filebeat Reference [8.15]"/>
<link rel="up" href="filebeat-modules.html" title="Modules"/>
<link rel="prev" href="filebeat-module-iptables.html" title="Iptables module"/>
<link rel="next" href="filebeat-module-kafka.html" title="Kafka module"/>
<meta class="elastic" name="product_version" content="8.15"/>
<meta class="elastic" name="product_name" content="Filebeat"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Filebeat/Reference/8.15"/>
<meta name="DC.subject" content="Filebeat"/>
<meta name="DC.identifier" content="8.15"/>
</head>
<body>
<div class="navheader">
<span class="prev">
<a href="filebeat-module-iptables.html">« Iptables module</a>
</span>
<span class="next">
<a href="filebeat-module-kafka.html">Kafka module »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Filebeat Reference [8.15]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="filebeat-modules.html">Modules</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Juniper module</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/module/juniper/_meta/docs.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="chapter xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="filebeat-module-juniper"></a>Juniper module<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/module/juniper/_meta/docs.asciidoc">edit</a></h2>
</div></div></div>
<div class="sidebar">
<div class="titlepage"><div><div>
<p class="title"><strong>Prefer to use Elastic Agent for this use case?</strong></p>
</div></div></div>
<p>Refer to the
<a href="https://docs.elastic.co/en/integrations/juniper" class="ulink" target="_top">Elastic Integrations documentation</a>.</p>
<details>
<summary class="title">Learn more</summary>
<div class="content">
<p>Elastic Agent is a single, unified way to add monitoring for logs, metrics, and
other types of data to a host. It can also protect hosts from security threats,
query data from operating systems, forward data from remote services or
hardware, and more. Refer to the documentation for a detailed
<a href="/guide/en/fleet/8.15/beats-agent-comparison.html" class="ulink" target="_top">comparison of Beats and Elastic Agent</a>.</p>
</div>
</details>
</div>
<p>This is a module for ingesting data from the different Juniper Products. Currently supports these filesets:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">srx</code> fileset: Supports Juniper SRX logs
</li>
</ul>
</div>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>Read the <a class="xref" href="filebeat-installation-configuration.html" title="Filebeat quick start: installation and configuration">quick start</a> to learn
how to configure and run modules.</p>
</div>
</div>
<h3><a id="configuring-juniper-module"></a>Configure the module<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/module/juniper/_meta/docs.asciidoc">edit</a></h3>
<p>You can further refine the behavior of the <code class="literal">juniper</code> module by specifying
<a class="xref" href="filebeat-module-juniper.html#juniper-settings" title="Variable settings">variable settings</a> in the
<code class="literal">modules.d/juniper.yml</code> file, or overriding settings at the command line.</p>
<p>You must enable at least one fileset in the module.
<span class="strong strong"><strong>Filesets are disabled by default.</strong></span></p>
<h4><a id="juniper-settings"></a>Variable settings<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/module/juniper/_meta/docs.asciidoc">edit</a></h4>
<p>Each fileset has separate variable settings for configuring the behavior of the
module. If you don’t specify variable settings, the <code class="literal">juniper</code> module uses
the defaults.</p>
<p>For advanced use cases, you can also override input settings. See
<a class="xref" href="advanced-settings.html" title="Override input settings">Override input settings</a>.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>When you specify a setting at the command line, remember to prefix the
setting with the module name, for example, <code class="literal">juniper.{fileset_ex}.var.paths</code>
instead of <code class="literal">{fileset_ex}.var.paths</code>.</p>
</div>
</div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in beta and is subject to change. The design and code is less mature than official GA features and is being provided as-is with no warranties. Beta features are not subject to the support SLA of official GA features.</p>
</div>
</div>
<h4><a id="_srx_fileset_settings"></a><code class="literal">srx</code> fileset settings<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/module/juniper/_meta/docs.asciidoc">edit</a></h4>
<p>The Juniper-SRX module only supports syslog messages in the format "structured-data + brief" <a href="https://www.juniper.net/documentation/en_US/junos/topics/reference/configuration-statement/structured-data-edit-system.html" class="ulink" target="_top">JunOS Documentation structured-data</a></p>
<p>To configure a remote syslog destination, please reference the <a href="https://kb.juniper.net/InfoCenter/index?page=content&amp;id=kb16502" class="ulink" target="_top">SRX Getting Started - Configure System Logging</a>.</p>
<p>The following processes and tags are supported:</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">JunOS processes</th>
<th align="left" valign="top">JunOS tags</th>
<th align="left" valign="top"></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>RT_FLOW</p></td>
<td align="left" valign="top"><p>RT_FLOW_SESSION_CREATE</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>RT_FLOW_SESSION_CLOSE</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>RT_FLOW_SESSION_DENY</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>APPTRACK_SESSION_CREATE</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>APPTRACK_SESSION_CLOSE</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>APPTRACK_SESSION_VOL_UPDATE</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>RT_IDS</p></td>
<td align="left" valign="top"><p>RT_SCREEN_TCP</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>RT_SCREEN_UDP</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>RT_SCREEN_ICMP</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>RT_SCREEN_IP</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>RT_SCREEN_TCP_DST_IP</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>RT_SCREEN_TCP_SRC_IP</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>RT_UTM</p></td>
<td align="left" valign="top"><p>WEBFILTER_URL_PERMITTED</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>WEBFILTER_URL_BLOCKED</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>AV_VIRUS_DETECTED_MT</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>CONTENT_FILTERING_BLOCKED_MT</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>ANTISPAM_SPAM_DETECTED_MT</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>RT_IDP</p></td>
<td align="left" valign="top"><p>IDP_ATTACK_LOG_EVENT</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>IDP_APPDDOS_APP_STATE_EVENT</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>RT_AAMW</p></td>
<td align="left" valign="top"><p>SRX_AAMW_ACTION_LOG</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>AAMW_MALWARE_EVENT_LOG</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>AAMW_HOST_INFECTED_EVENT_LOG</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>AAMW_ACTION_LOG</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>RT_SECINTEL</p></td>
<td align="left" valign="top"><p>SECINTEL_ACTION_LOG</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
</tbody>
</table>
</div>
<p>The syslog format choosen should be <code class="literal">Default</code>.</p>
<h3><a id="_compatibility_18"></a>Compatibility<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/module/juniper/_meta/docs.asciidoc">edit</a></h3>
<p>This module has been tested against JunOS version 19.x and 20.x.
Versions above this are expected to work but have not been tested.</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">- module: juniper
  junos:
    enabled: true
    var.input: udp
    var.syslog_host: 0.0.0.0
    var.syslog_port: 9006</pre>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">var.paths</code></strong></span>
</span>
</dt>
<dd>
An array of glob-based paths that specify where to look for the log files. All
patterns supported by <a href="https://golang.org/pkg/path/filepath/#Glob" class="ulink" target="_top">Go Glob</a>
are also supported here. For example, you can use wildcards to fetch all files
from a predefined level of subdirectories: <code class="literal">/path/to/log/*/*.log</code>. This
fetches all <code class="literal">.log</code> files from the subfolders of <code class="literal">/path/to/log</code>. It does not
fetch log files from the <code class="literal">/path/to/log</code> folder itself. If this setting is left
empty, Filebeat will choose log paths based on your operating system.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">var.input</code></strong></span>
</span>
</dt>
<dd>
The input to use, can be either the value <code class="literal">tcp</code>, <code class="literal">udp</code> or <code class="literal">file</code>.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">var.syslog_host</code></strong></span>
</span>
</dt>
<dd>
The interface to listen to all syslog traffic. Defaults to localhost.
Set to 0.0.0.0 to bind to all available interfaces.
</dd>
<dt>
<span class="term">
<span class="strong strong"><strong><code class="literal">var.syslog_port</code></strong></span>
</span>
</dt>
<dd>
The port to listen for syslog traffic. Defaults to 9006.
</dd>
</dl>
</div>
<h4><a id="_juniper_srx_ecs_fields"></a>Juniper SRX ECS fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/module/juniper/_meta/docs.asciidoc">edit</a></h4>
<p>This is a list of JunOS fields that are mapped to ECS.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Juniper SRX Fields</th>
<th align="left" valign="top">ECS Fields</th>
<th align="left" valign="top"></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>application-risk</p></td>
<td align="left" valign="top"><p>event.risk_score</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>bytes-from-client</p></td>
<td align="left" valign="top"><p>source.bytes</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>bytes-from-server</p></td>
<td align="left" valign="top"><p>destination.bytes</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>destination-interface-name</p></td>
<td align="left" valign="top"><p>observer.egress.interface.name</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>destination-zone-name</p></td>
<td align="left" valign="top"><p>observer.egress.zone</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>destination-address</p></td>
<td align="left" valign="top"><p>destination.ip</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>destination-port</p></td>
<td align="left" valign="top"><p>destination.port</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>dst_domainname</p></td>
<td align="left" valign="top"><p>url.domain</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>elapsed-time</p></td>
<td align="left" valign="top"><p>event.duration</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>filename</p></td>
<td align="left" valign="top"><p>file.name</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>nat-destination-address</p></td>
<td align="left" valign="top"><p>destination.nat.ip</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>nat-destination-port</p></td>
<td align="left" valign="top"><p>destination.nat.port</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>nat-source-address</p></td>
<td align="left" valign="top"><p>source.nat.ip</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>nat-source-port</p></td>
<td align="left" valign="top"><p>source.nat.port</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>message</p></td>
<td align="left" valign="top"><p>message</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>obj</p></td>
<td align="left" valign="top"><p>url.path</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>packets-from-client</p></td>
<td align="left" valign="top"><p>source.packets</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>packets-from-server</p></td>
<td align="left" valign="top"><p>destination.packets</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>policy-name</p></td>
<td align="left" valign="top"><p>rule.name</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>protocol</p></td>
<td align="left" valign="top"><p>network.transport</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>source-address</p></td>
<td align="left" valign="top"><p>source.ip</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>source-interface-name</p></td>
<td align="left" valign="top"><p>observer.ingress.interface.name</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>source-port</p></td>
<td align="left" valign="top"><p>source.port</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>source-zone-name</p></td>
<td align="left" valign="top"><p>observer.ingress.zone</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>url</p></td>
<td align="left" valign="top"><p>url.domain</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
</tbody>
</table>
</div>
<h3><a id="_fields_25"></a>Fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/main/x-pack/filebeat/module/juniper/_meta/docs.asciidoc">edit</a></h3>
<p>For a description of each field in the module, see the
<a class="xref" href="exported-fields-juniper.html" title="Juniper JUNOS fields">exported fields</a> section.</p>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="filebeat-module-iptables.html">« Iptables module</a>
</span>
<span class="next">
<a href="filebeat-module-kafka.html">Kafka module »</a>
</span>
</div>
</body>
</html>
