<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>ETW input | Filebeat Reference [8.16] | Elastic</title>
<meta class="elastic" name="content" content="ETW input | Filebeat Reference [8.16]">

<link rel="home" href="index.html" title="Filebeat Reference [8.16]"/>
<link rel="up" href="configuration-filebeat-options.html" title="Configure inputs"/>
<link rel="prev" href="filebeat-input-entity-analytics.html" title="Entity Analytics Input"/>
<link rel="next" href="filebeat-input-filestream.html" title="filestream input"/>
<meta class="elastic" name="product_version" content="8.16"/>
<meta class="elastic" name="product_name" content="Filebeat"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Filebeat/Reference/8.16"/>
<meta name="DC.subject" content="Filebeat"/>
<meta name="DC.identifier" content="8.16"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
This documentation contains work-in-progress information for future Elastic Stack and Cloud releases. Use the version selector to view supported release docs. It also contains some Elastic Cloud serverless information. Check out our <a href="https://www.elastic.co/docs/current/serverless">serverless docs</a> for more details.
</div>
<div class="navheader">
<span class="prev">
<a href="filebeat-input-entity-analytics.html">« Entity Analytics Input</a>
</span>
<span class="next">
<a href="filebeat-input-filestream.html">filestream input »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Filebeat Reference [8.16]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="configuring-howto-filebeat.html">Configure Filebeat</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="configuration-filebeat-options.html">Configure inputs</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>ETW input</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.x/x-pack/filebeat/docs/inputs/input-etw.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section xpack">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="filebeat-input-etw"></a>ETW input</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.x/x-pack/filebeat/docs/inputs/input-etw.asciidoc">edit</a></div>
</div></div></div>

<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in beta and is subject to change. The design and code is less mature than official GA features and is being provided as-is with no warranties. Beta features are not subject to the support SLA of official GA features.</p>
</div>
</div>
<p><a href="https://learn.microsoft.com/en-us/windows/win32/etw/event-tracing-portal" class="ulink" target="_top">Event
Tracing for Windows</a> is a powerful logging and tracing mechanism built into the
Windows operating system. It provides a detailed view of application and system
behavior, performance issues, and runtime diagnostics. Trace events contain an
event header and provider-defined data that describes the current state of an
application or operation. You can use the events to debug an application and
perform capacity and performance analysis.</p>
<p>The ETW input can interact with ETW in three distinct ways: it can create a new
session to capture events from user-mode providers, attach to an already
existing session to collect ongoing event data, or read events from a
pre-recorded .etl file. This functionality enables the module to adapt to
different scenarios, such as real-time event monitoring or analyzing historical
data.</p>
<p>This input currently supports manifest-based, MOF (classic) and TraceLogging
providers while WPP providers are not supported.
<a href="https://learn.microsoft.com/en-us/windows/win32/etw/about-event-tracing#types-of-providers" class="ulink" target="_top">Here</a>
you can find more information about the available types of providers.</p>
<p>It has been tested in the Windows versions supported by Filebeat, starting
from Windows 10 and Windows Server 2016. In addition, administrative privileges
are required to control event tracing sessions.</p>
<p>Example configurations:</p>
<p>Read from a provider by name:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: etw
  id: etw-dnsserver
  enabled: true
  provider.name: Microsoft-Windows-DNSServer
  session_name: DNSServer-Analytical
  trace_level: verbose
  match_any_keyword: 0x8000000000000000
  match_all_keyword: 0</pre>
</div>
<p>Read from a provider by its GUID:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: etw
  id: etw-dnsserver
  enabled: true
  provider.guid: {EB79061A-A566-4698-9119-3ED2807060E7}
  session_name: DNSServer-Analytical
  trace_level: verbose
  match_any_keyword: 0x8000000000000000
  match_all_keyword: 0</pre>
</div>
<p>Read from an existing session:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: etw
  enabled: true
  id: etw-dnsserver-session
  session: UAL_Usermode_Provider</pre>
</div>
<p>Read from a .etl file:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: etw
  enabled: true
  id: etw-dnsserver-session
  file: "C\Windows\System32\Winevt\Logs\Logfile.etl"</pre>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Examples shown above are mutually exclusive, the options
<code class="literal">provider.name</code>, <code class="literal">provider.guid</code>, <code class="literal">session</code> and <code class="literal">file</code> cannot be present at the
same time. Nevertheless, it is a requirement that one of them is present.</p>
</div>
</div>
<p>Multiple providers example:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: etw
  id: etw-dnsserver
  enabled: true
  provider.name: Microsoft-Windows-DNSServer
  session_name: DNSServer-Analytical
  trace_level: verbose
  match_any_keyword: 0xffffffffffffffff
  match_all_keyword: 0
- type: etw
  id: etw-security
  enabled: true
  provider.name: Microsoft-Windows-Security-Auditing
  session_name: Security-Auditing
  trace_level: warning
  match_any_keyword: 0xfffffffffffffff
  match_all_keyword: 0</pre>
</div>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_configuration_options_8"></a>Configuration options</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.x/x-pack/filebeat/docs/inputs/input-etw.asciidoc">edit</a></div>
</div></div></div>
<p>The <code class="literal">etw</code> input supports the following configuration options plus the
<a class="xref" href="filebeat-input-etw.html#filebeat-input-etw-common-options" title="Common options">Common options</a> described later.</p>
<div class="position-relative"><h4><a id="_file"></a><code class="literal">file</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.x/x-pack/filebeat/docs/inputs/input-etw.asciidoc">edit</a></div>
<p>Specifies the path to an .etl file for reading ETW events. This file format is
commonly used for storing ETW event logs.</p>
<div class="position-relative"><h4><a id="_provider_guid"></a><code class="literal">provider.guid</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.x/x-pack/filebeat/docs/inputs/input-etw.asciidoc">edit</a></div>
<p>Identifies the GUID of an ETW provider. To see available providers, use the
command <code class="literal">logman query providers</code>.</p>
<div class="position-relative"><h4><a id="_provider_name"></a><code class="literal">provider.name</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.x/x-pack/filebeat/docs/inputs/input-etw.asciidoc">edit</a></div>
<p>Specifies the name of the ETW provider. Available providers can be listed using
<code class="literal">logman query providers</code>.</p>
<div class="position-relative"><h4><a id="_session_name"></a><code class="literal">session_name</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.x/x-pack/filebeat/docs/inputs/input-etw.asciidoc">edit</a></div>
<p>When specifying a provider, a new session is created. This controls the name for
the new ETW session it will create. If not specified, the session will be named
using the provider ID prefixed by <em>Elastic-</em>.</p>
<div class="position-relative"><h4><a id="_trace_level"></a><code class="literal">trace_level</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.x/x-pack/filebeat/docs/inputs/input-etw.asciidoc">edit</a></div>
<p>Defines the filtering level for events based on severity. Valid options include
critical, error, warning, information, and verbose.</p>
<div class="position-relative"><h4><a id="_match_any_keyword"></a><code class="literal">match_any_keyword</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.x/x-pack/filebeat/docs/inputs/input-etw.asciidoc">edit</a></div>
<p>An 8-byte bitmask used for filtering events from specific provider subcomponents
based on keyword matching. Any matching keyword will enable the event to be
written. Default value is <code class="literal">0xffffffffffffffff</code> so it matches every available
keyword.</p>
<p>Run <code class="literal">logman query providers "&lt;provider.name&gt;"</code> to list the available keywords
for a specific provider.</p>
<div class="position-relative"><h4><a id="_match_all_keyword"></a><code class="literal">match_all_keyword</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.x/x-pack/filebeat/docs/inputs/input-etw.asciidoc">edit</a></div>
<p>Similar to MatchAnyKeyword, this 8-byte bitmask filters events that match all
specified keyword bits. Default value is <code class="literal">0</code> to let every event pass.</p>
<p>Run <code class="literal">logman query providers "&lt;provider.name&gt;"</code> to list the available keywords
for a specific provider.</p>
<div class="position-relative"><h4><a id="_session"></a><code class="literal">session</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.x/x-pack/filebeat/docs/inputs/input-etw.asciidoc">edit</a></div>
<p>Names an existing ETW session to read from. Existing sessions can be listed
using <code class="literal">logman query -ets</code>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="filebeat-input-etw-common-options"></a>Common options</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.x/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></div>
</div></div></div>
<p>The following configuration options are supported by all inputs.</p>
<div class="position-relative"><h5><a id="_enabled_8"></a><code class="literal">enabled</code></h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.x/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></div>
<p>Use the <code class="literal">enabled</code> option to enable and disable inputs. By default, enabled is
set to true.</p>
<div class="position-relative"><h5><a id="_tags_8"></a><code class="literal">tags</code></h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.x/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></div>
<p>A list of tags that Filebeat includes in the <code class="literal">tags</code> field of each published
event. Tags make it easy to select specific events in Kibana or apply
conditional filtering in Logstash. These tags will be appended to the list of
tags specified in the general configuration.</p>
<p>Example:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: etw
  . . .
  tags: ["json"]</pre>
</div>
<div class="position-relative"><h5><a id="filebeat-input-etw-fields"></a><code class="literal">fields</code></h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.x/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></div>
<p>Optional fields that you can specify to add additional information to the
output. For example, you might add fields that you can use for filtering log
data. Fields can be scalar values, arrays, dictionaries, or any nested
combination of these. By default, the fields that you specify here will be
grouped under a <code class="literal">fields</code> sub-dictionary in the output document. To store the
custom fields as top-level fields, set the <code class="literal">fields_under_root</code> option to true.
If a duplicate field is declared in the general configuration, then its value
will be overwritten by the value declared here.</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">filebeat.inputs:
- type: etw
  . . .
  fields:
    app_id: query_engine_12</pre>
</div>
<div class="position-relative"><h5><a id="fields-under-root-etw"></a><code class="literal">fields_under_root</code></h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.x/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></div>
<p>If this option is set to true, the custom
<a class="xref" href="filebeat-input-etw.html#filebeat-input-etw-fields" title="fields">fields</a> are stored as top-level fields in
the output document instead of being grouped under a <code class="literal">fields</code> sub-dictionary. If
the custom field names conflict with other field names added by Filebeat,
then the custom fields overwrite the other fields.</p>
<div class="position-relative"><h5><a id="_processors_8"></a><code class="literal">processors</code></h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.x/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></div>
<p>A list of processors to apply to the input data.</p>
<p>See <a class="xref" href="filtering-and-enhancing-data.html" title="Filter and enhance data with processors"><em>Processors</em></a> for information about specifying
processors in your config.</p>
<div class="position-relative"><h5><a id="_pipeline_8"></a><code class="literal">pipeline</code></h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.x/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></div>
<p>The ingest pipeline ID to set for the events generated by this input.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The pipeline ID can also be configured in the Elasticsearch output, but
this option usually results in simpler configuration files. If the pipeline is
configured both in the input and output, the option from the
input is used.</p>
</div>
</div>
<div class="position-relative"><h5><a id="_keep_null_8"></a><code class="literal">keep_null</code></h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.x/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></div>
<p>If this option is set to true, fields with <code class="literal">null</code> values will be published in
the output document. By default, <code class="literal">keep_null</code> is set to <code class="literal">false</code>.</p>
<div class="position-relative"><h5><a id="_index_8"></a><code class="literal">index</code></h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.x/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></div>
<p>If present, this formatted string overrides the index for events from this input
(for elasticsearch outputs), or sets the <code class="literal">raw_index</code> field of the event&#8217;s
metadata (for other outputs). This string can only refer to the agent name and
version and the event timestamp; for access to dynamic fields, use
<code class="literal">output.elasticsearch.index</code> or a processor.</p>
<p>Example value: <code class="literal">"%{[agent.name]}-myindex-%{+yyyy.MM.dd}"</code> might
expand to <code class="literal">"filebeat-myindex-2019.11.01"</code>.</p>
<div class="position-relative"><h5><a id="_publisher_pipeline_disable_host_8"></a><code class="literal">publisher_pipeline.disable_host</code></h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.x/filebeat/docs/inputs/input-common-options.asciidoc">edit</a></div>
<p>By default, all events contain <code class="literal">host.name</code>. This option can be set to <code class="literal">true</code> to
disable the addition of this field to all events. The default value is <code class="literal">false</code>.</p>
<div class="position-relative"><h3><a id="_metrics_7"></a>Metrics</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.x/x-pack/filebeat/docs/inputs/input-etw.asciidoc">edit</a></div>
<p>This input exposes metrics under the <a class="xref" href="http-endpoint.html" title="Configure an HTTP endpoint for metrics">HTTP monitoring endpoint</a>.
These metrics are exposed under the <code class="literal">/inputs/</code> path. They can be used to
observe the activity of the input.</p>
<p>You must assign a unique <code class="literal">id</code> to the input to expose metrics.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Metric</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">session</code></p></td>
<td align="left" valign="top"><p>Name of the ETW session.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">received_events_total</code></p></td>
<td align="left" valign="top"><p>Total number of events received.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">discarded_events_total</code></p></td>
<td align="left" valign="top"><p>Total number of discarded events.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">errors_total</code></p></td>
<td align="left" valign="top"><p>Total number of errors.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">source_lag_time</code></p></td>
<td align="left" valign="top"><p>Histogram of the difference between timestamped event&#8217;s creation and reading.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">arrival_period</code></p></td>
<td align="left" valign="top"><p>Histogram of the elapsed time between event notification callbacks.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">processing_time</code></p></td>
<td align="left" valign="top"><p>Histogram of the elapsed time between event notification callback and publication to the internal queue.</p></td>
</tr>
</tbody>
</table>
</div>
<p>Histogram metrics are aggregated over the previous 1024 events.</p>
</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="filebeat-input-entity-analytics.html">« Entity Analytics Input</a>
</span>
<span class="next">
<a href="filebeat-input-filestream.html">filestream input »</a>
</span>
</div>
</body>
</html>
