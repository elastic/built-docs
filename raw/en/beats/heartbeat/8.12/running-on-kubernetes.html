<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Running Heartbeat on Kubernetes | Heartbeat Reference [8.12] | Elastic</title>
<meta class="elastic" name="content" content="Running Heartbeat on Kubernetes | Heartbeat Reference [8.12]">

<link rel="home" href="index.html" title="Heartbeat Reference [8.12]"/>
<link rel="up" href="setting-up-and-running.html" title="Set up and run Heartbeat"/>
<link rel="prev" href="running-on-docker.html" title="Run Heartbeat on Docker"/>
<link rel="next" href="running-with-systemd.html" title="Heartbeat and systemd"/>
<meta class="elastic" name="product_version" content="8.12"/>
<meta class="elastic" name="product_name" content="Heartbeat"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Heartbeat/Reference/8.12"/>
<meta name="DC.subject" content="Heartbeat"/>
<meta name="DC.identifier" content="8.12"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div class="navheader">
<span class="prev">
<a href="running-on-docker.html">« Run Heartbeat on Docker</a>
</span>
<span class="next">
<a href="running-with-systemd.html">Heartbeat and systemd »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Heartbeat Reference [8.12]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="setting-up-and-running.html">Set up and run Heartbeat</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Running Heartbeat on Kubernetes</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.12/heartbeat/docs/running-on-kubernetes.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="running-on-kubernetes"></a>Running Heartbeat on Kubernetes</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.12/heartbeat/docs/running-on-kubernetes.asciidoc">edit</a></div>
</div></div></div>
<p>Heartbeat <a class="xref" href="running-on-docker.html" title="Run Heartbeat on Docker">Docker images</a> can be used on Kubernetes to
check resources uptime.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>Running Elastic Cloud on Kubernetes? See <a href="/guide/en/cloud-on-k8s/current/k8s-beat.html" class="ulink" target="_top">Run Beats on ECK</a></p>
</div>
</div>
<div class="position-relative"><h4><a id="_kubernetes_deploy_manifests"></a>Kubernetes deploy manifests</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.12/heartbeat/docs/running-on-kubernetes.asciidoc">edit</a></div>
<p>A single Heartbeat can check for uptime of the whole cluster.</p>
<p>Everything is deployed under <code class="literal">kube-system</code> namespace, you can change that by
updating the YAML file.</p>
<p>To get the manifests just run:</p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">curl -L -O https://raw.githubusercontent.com/elastic/beats/8.12/deploy/kubernetes/heartbeat-kubernetes.yaml</pre>
</div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>If you are using Kubernetes 1.7 or earlier: Heartbeat uses a hostPath volume to persist internal data, it&#8217;s located
under /var/lib/heartbeat-data. The manifest uses folder autocreation (<code class="literal">DirectoryOrCreate</code>), which was introduced in
Kubernetes 1.8. You will need to remove <code class="literal">type: DirectoryOrCreate</code> from the manifest and create the host folder yourself.</p>
</div>
</div>
<div class="position-relative"><h4><a id="_settings"></a>Settings</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.12/heartbeat/docs/running-on-kubernetes.asciidoc">edit</a></div>
<p>Some parameters are exposed in the manifest to configure logs destination, by
default they will use an existing Elasticsearch deploy if it&#8217;s present, but you
may want to change that behavior, so just edit the YAML file and modify them:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">- name: ELASTICSEARCH_HOST
  value: elasticsearch
- name: ELASTICSEARCH_PORT
  value: "9200"
- name: ELASTICSEARCH_USERNAME
  value: elastic
- name: ELASTICSEARCH_PASSWORD
  value: changeme</pre>
</div>
<div class="position-relative"><h4><a id="_deploy"></a>Deploy</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.12/heartbeat/docs/running-on-kubernetes.asciidoc">edit</a></div>
<p>To deploy Heartbeat to Kubernetes just run:</p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">kubectl create -f heartbeat-kubernetes.yaml</pre>
</div>
<p>Then you should be able to check the status by running:</p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">$ kubectl --namespace=kube-system get deployment/heartbeat

NAME        READY   UP-TO-DATE   AVAILABLE   AGE
heartbeat   1/1     1            1           1m</pre>
</div>
<div class="position-relative"><h4><a id="_running_heartbeat_as_unprivileged_user"></a>Running Heartbeat as unprivileged user</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.12/heartbeat/docs/running-on-kubernetes.asciidoc">edit</a></div>
<p>Under Kubernetes, Heartbeat can run as a non-root user, but requires some privileged
network capabilities to operate correctly. Ensure that the <code class="literal">NET_RAW</code>
capability is available to the container.</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">containers:
- name: heartbeat
  image: docker.elastic.co/beats/heartbeat:8.12.2
  securityContext:
    runAsUser: 1000
    runAsGroup: 1000
    capabilities:
      add: [ NET_RAW ]</pre>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="running-on-docker.html">« Run Heartbeat on Docker</a>
</span>
<span class="next">
<a href="running-with-systemd.html">Heartbeat and systemd »</a>
</span>
</div>
</body>
</html>
