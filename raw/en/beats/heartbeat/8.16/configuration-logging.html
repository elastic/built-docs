<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Configure logging | Heartbeat Reference [8.16] | Elastic</title>
<meta class="elastic" name="content" content="Configure logging | Heartbeat Reference [8.16]">

<link rel="home" href="index.html" title="Heartbeat Reference [8.16]"/>
<link rel="up" href="configuring-howto-heartbeat.html" title="Configure Heartbeat"/>
<link rel="prev" href="configuring-internal-queue.html" title="Configure the internal queue"/>
<link rel="next" href="http-endpoint.html" title="Configure an HTTP endpoint for metrics"/>
<meta class="elastic" name="product_version" content="8.16"/>
<meta class="elastic" name="product_name" content="Heartbeat"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Heartbeat/Reference/8.16"/>
<meta name="DC.subject" content="Heartbeat"/>
<meta name="DC.identifier" content="8.16"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
This documentation contains work-in-progress information for future Elastic Stack and Cloud releases. Use the version selector to view supported release docs. It also contains some Elastic Cloud serverless information. Check out our <a href="https://www.elastic.co/docs/current/serverless">serverless docs</a> for more details.
</div>
<div class="navheader">
<span class="prev">
<a href="configuring-internal-queue.html">« Configure the internal queue</a>
</span>
<span class="next">
<a href="http-endpoint.html">Configure an HTTP endpoint for metrics »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Heartbeat Reference [8.16]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="configuring-howto-heartbeat.html">Configure Heartbeat</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Configure logging</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.x/libbeat/docs/loggingconfig.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="chapter">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="configuration-logging"></a>Configure logging</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.x/libbeat/docs/loggingconfig.asciidoc">edit</a></div>
</div></div></div>

<p>The <code class="literal">logging</code> section of the <code class="literal">heartbeat.yml</code> config file contains options
for configuring the logging output.
The logging system can write logs to the syslog or rotate log files. If logging
is not explicitly configured the file output is used.</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">logging.level: info
logging.to_files: true
logging.files:
  path: /var/log/heartbeat
  name: heartbeat
  keepfiles: 7
  permissions: 0640</pre>
</div>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>In addition to setting logging options in the config file, you can modify
the logging output configuration from the command line. See
<a class="xref" href="command-line-options.html" title="Heartbeat command reference">Command reference</a>.</p>
</div>
</div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>When Heartbeat is running on a Linux system with systemd, it uses
by default the <code class="literal">-e</code> command line option, that makes it write all the logging output
to stderr so it can be captured by journald. Other outputs are disabled. See
<a class="xref" href="running-with-systemd.html" title="Heartbeat and systemd">Heartbeat and systemd</a> to know more and learn how to change this.</p>
</div>
</div>
<div class="position-relative"><h3><a id="_configuration_options_13"></a>Configuration options</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.x/libbeat/docs/loggingconfig.asciidoc">edit</a></div>
<p>You can specify the following options in the <code class="literal">logging</code> section of the
<code class="literal">heartbeat.yml</code> config file:</p>
<div class="position-relative"><h4><a id="_logging_to_stderr"></a><code class="literal">logging.to_stderr</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.x/libbeat/docs/loggingconfig.asciidoc">edit</a></div>
<p>When true, writes all logging output to standard error output. This is
equivalent to using the <code class="literal">-e</code> command line option.</p>
<div class="position-relative"><h4><a id="_logging_to_syslog"></a><code class="literal">logging.to_syslog</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.x/libbeat/docs/loggingconfig.asciidoc">edit</a></div>
<p>When true, writes all logging output to the syslog.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This option is not supported on Windows.</p>
</div>
</div>
<div class="position-relative"><h4><a id="_logging_to_eventlog"></a><code class="literal">logging.to_eventlog</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.x/libbeat/docs/loggingconfig.asciidoc">edit</a></div>
<p>When true, writes all logging output to the Windows Event Log.</p>
<div class="position-relative"><h4><a id="_logging_to_files"></a><code class="literal">logging.to_files</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.x/libbeat/docs/loggingconfig.asciidoc">edit</a></div>
<p>When true, writes all logging output to files. The log files are automatically
rotated when the log file size limit is reached.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Heartbeat only creates a log file if there is logging output. For
example, if you set the log <a class="xref" href="configuration-logging.html#level" title="logging.level"><code class="literal">level</code></a> to <code class="literal">error</code> and there are no
errors, there will be no log file in the directory specified for logs.</p>
</div>
</div>
<div class="position-relative"><h4><a id="level"></a><code class="literal">logging.level</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.x/libbeat/docs/loggingconfig.asciidoc">edit</a></div>
<p>Minimum log level. One of <code class="literal">debug</code>, <code class="literal">info</code>, <code class="literal">warning</code>, or <code class="literal">error</code>. The default
log level is <code class="literal">info</code>.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">debug</code>
</span>
</dt>
<dd>
Logs debug messages, including a detailed printout of all events
flushed. Also logs informational messages, warnings, errors, and
critical errors. When the log level is <code class="literal">debug</code>, you can specify a list of
<a class="xref" href="configuration-logging.html#selectors" title="logging.selectors"><code class="literal">selectors</code></a> to display debug messages for specific components. If
no selectors are specified, the <code class="literal">*</code> selector is used to display debug messages
for all components.
</dd>
<dt>
<span class="term">
<code class="literal">info</code>
</span>
</dt>
<dd>
Logs informational messages, including the number of events that are
published. Also logs any warnings, errors, or critical errors.
</dd>
<dt>
<span class="term">
<code class="literal">warning</code>
</span>
</dt>
<dd>
Logs warnings, errors, and critical errors.
</dd>
<dt>
<span class="term">
<code class="literal">error</code>
</span>
</dt>
<dd>
Logs errors and critical errors.
</dd>
</dl>
</div>
<div class="position-relative"><h4><a id="selectors"></a><code class="literal">logging.selectors</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.x/libbeat/docs/loggingconfig.asciidoc">edit</a></div>
<p>The list of debugging-only selector tags used by different Heartbeat components.
Use <code class="literal">*</code> to enable debug output for all components. Use <code class="literal">publisher</code> to display
debug messages related to event publishing.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>The list of available selectors may change between releases, so avoid creating
tests that depend on specific selectors.</p>
<p>To see which selectors are available, run Heartbeat in debug mode
(set <code class="literal">logging.level: debug</code> in the configuration). The selector name appears
after the log level and is enclosed in brackets.</p>
</div>
</div>
<p>To configure multiple selectors, use the following <a href="/guide/en/beats/libbeat/8.16/config-file-format.html" class="ulink" target="_top">YAML list syntax</a>:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">logging.selectors: [ harvester, input ]</pre>
</div>
<p>To override selectors at the command line, use the <code class="literal">-d</code> global flag (<code class="literal">-d</code> also
sets the debug log level). For more information, see <a class="xref" href="command-line-options.html" title="Heartbeat command reference">Command reference</a>.</p>
<div class="position-relative"><h4><a id="_logging_metrics_enabled"></a><code class="literal">logging.metrics.enabled</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.x/libbeat/docs/loggingconfig.asciidoc">edit</a></div>
<p>By default, Heartbeat periodically logs its internal metrics that have
changed in the last period. For each metric that changed, the delta from the
value at the beginning of the period is logged. Also, the total values for all
non-zero internal metrics are logged on shutdown. Set this to false to disable
this behavior. The default is true.</p>
<p>Here is an example log line:</p>
<div class="pre_wrapper lang-shell">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-shell">2017-12-17T19:17:42.667-0500    INFO    [metrics]       log/log.go:110  Non-zero metrics in the last 30s: beat.info.uptime.ms=30004 beat.memstats.gc_next=5046416</pre>
</div>
<p>Note that we currently offer no backwards compatible guarantees for the internal
metrics and for this reason they are also not documented.</p>
<div class="position-relative"><h4><a id="_logging_metrics_period"></a><code class="literal">logging.metrics.period</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.x/libbeat/docs/loggingconfig.asciidoc">edit</a></div>
<p>The period after which to log the internal metrics. The default is 30s.</p>
<div class="position-relative"><h4><a id="_logging_metrics_namespaces"></a><code class="literal">logging.metrics.namespaces</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.x/libbeat/docs/loggingconfig.asciidoc">edit</a></div>
<p>A list of metrics namespaces to report in the logs. Defaults to <code class="literal">[stats]</code>.
<code class="literal">stats</code> contains general Beat metrics. <code class="literal">dataset</code> and <code class="literal">inputs</code> may be present in
some Beats and contains module or input metrics.</p>
<div class="position-relative"><h4><a id="_logging_files_path"></a><code class="literal">logging.files.path</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.x/libbeat/docs/loggingconfig.asciidoc">edit</a></div>
<p>The directory that log files are written to. The default is the logs path. See
the <a class="xref" href="directory-layout.html" title="Directory layout">Directory layout</a> section for details.</p>
<div class="position-relative"><h4><a id="_logging_files_name"></a><code class="literal">logging.files.name</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.x/libbeat/docs/loggingconfig.asciidoc">edit</a></div>
<p>The name of the file that logs are written to. The default is <em>heartbeat</em>.</p>
<div class="position-relative"><h4><a id="_logging_files_rotateeverybytes"></a><code class="literal">logging.files.rotateeverybytes</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.x/libbeat/docs/loggingconfig.asciidoc">edit</a></div>
<p>The maximum size of a log file. If the limit is reached, a new log file is
generated. The default size limit is 10485760 (10 MB).</p>
<div class="position-relative"><h4><a id="_logging_files_keepfiles"></a><code class="literal">logging.files.keepfiles</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.x/libbeat/docs/loggingconfig.asciidoc">edit</a></div>
<p>The number of most recent rotated log files to keep on disk. Older files are
deleted during log rotation. The default value is 7. The <code class="literal">keepfiles</code> options has
to be in the range of 2 to 1024 files.</p>
<div class="position-relative"><h4><a id="_logging_files_permissions"></a><code class="literal">logging.files.permissions</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.x/libbeat/docs/loggingconfig.asciidoc">edit</a></div>
<p>The permissions mask to apply when rotating log files. The default value is
0600. The <code class="literal">permissions</code> option must be a valid Unix-style file permissions mask
expressed in octal notation. In Go, numbers in octal notation must start with
<em>0</em>.</p>
<p>The most permissive mask allowed is 0640. If a higher permissions mask is
specified via this setting, it will be subject to an umask of 0027.</p>
<p>This option is not supported on Windows.</p>
<p>Examples:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
0640: give read and write access to the file owner, and read access to members of the group associated with the file.
</li>
<li class="listitem">
0600: give read and write access to the file owner, and no access to all others.
</li>
</ul>
</div>
<div class="position-relative"><h4><a id="_logging_files_interval"></a><code class="literal">logging.files.interval</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.x/libbeat/docs/loggingconfig.asciidoc">edit</a></div>
<p>Enable log file rotation on time intervals in addition to size-based rotation.
Intervals must be at least 1s. Values of 1m, 1h, 24h, 7*24h, 30*24h, and 365*24h
are boundary-aligned with minutes, hours, days, weeks, months, and years as
reported by the local system clock. All other intervals are calculated from the
unix epoch. Defaults to disabled.</p>
<div class="position-relative"><h4><a id="_logging_files_rotateonstartup"></a><code class="literal">logging.files.rotateonstartup</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.x/libbeat/docs/loggingconfig.asciidoc">edit</a></div>
<p>If the log file already exists on startup, immediately rotate it and start
writing to a new file instead of appending to the existing one. Defaults to
true.</p>
<div class="position-relative"><h4><a id="_logging_files_redirect_stderr"></a><code class="literal">logging.files.redirect_stderr</code> <span class="Admonishment Admonishment--preview">
[<span class="Admonishment-title u-mono">preview</span>]
<span class="Admonishment-detail">
This functionality is in technical preview and may be changed or removed in a future release. Elastic will work to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.
</span>
</span></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.x/libbeat/docs/loggingconfig.asciidoc">edit</a></div>
<p>When true, diagnostic messages printed to Heartbeat&#8217;s standard error output
will also be logged to the log file. This can be helpful in situations were
Heartbeat terminates unexpectedly because an error has been detected by
Go&#8217;s runtime but diagnostic information is not present in the log file.
This feature is only available when logging to files (<code class="literal">logging.to_files</code> is true).
Disabled by default.</p>
<div class="position-relative"><h3><a id="_logging_format"></a>Logging format</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.x/libbeat/docs/loggingconfig.asciidoc">edit</a></div>
<p>The logging format is generally the same for each logging output. The one
exception is with the syslog output where the timestamp is not included in the
message because syslog adds its own timestamp.</p>
<p>Each log message consists of the following parts:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Timestamp in ISO8601 format
</li>
<li class="listitem">
Level
</li>
<li class="listitem">
Logger name contained in brackets (Optional)
</li>
<li class="listitem">
File name and line number of the caller
</li>
<li class="listitem">
Message
</li>
<li class="listitem">
Structured data encoded in JSON (Optional)
</li>
</ul>
</div>
<p>Below are some samples:</p>
<p><code class="literal">2017-12-17T18:54:16.241-0500	INFO	logp/core_test.go:13	unnamed global logger</code></p>
<p><code class="literal">2017-12-17T18:54:16.242-0500	INFO	[example]	logp/core_test.go:16	some message</code></p>
<p><code class="literal">2017-12-17T18:54:16.242-0500	INFO	[example]	logp/core_test.go:19	some message	{"x": 1}</code></p>
<div class="position-relative"><h3><a id="_configuration_options_for_event_data_logger"></a>Configuration options for event_data logger</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.x/libbeat/docs/loggingconfig.asciidoc">edit</a></div>
<p>Some outputs will log raw events on errors like indexing errors in the
Elasticsearch output, to prevent logging raw events (that may contain
sensitive information) together with other log messages, a different
log file, only for log entries containing raw events, is used. It will
use the same level, selectors and all other configurations from the
default logger, but it will have it&#8217;s own file configuration.</p>
<p>Having a different log file for raw events also prevents event data
from drowning out the regular log files.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>No matter the default logger output configuration, raw events
will <span class="strong strong"><strong>always</strong></span> be logged to a file configured by <code class="literal">logging.event_data.files</code>.</p>
</div>
</div>
<div class="position-relative"><h4><a id="_logging_event_data_files_path"></a><code class="literal">logging.event_data.files.path</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.x/libbeat/docs/loggingconfig.asciidoc">edit</a></div>
<p>The directory that log files are written to. The default is the logs path. See
the <a class="xref" href="directory-layout.html" title="Directory layout">Directory layout</a> section for details.</p>
<div class="position-relative"><h4><a id="_logging_event_data_files_name"></a><code class="literal">logging.event_data.files.name</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.x/libbeat/docs/loggingconfig.asciidoc">edit</a></div>
<p>The name of the file that logs are written to. The default is <em>heartbeat</em>-event-data.</p>
<div class="position-relative"><h4><a id="_logging_event_data_files_rotateeverybytes"></a><code class="literal">logging.event_data.files.rotateeverybytes</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.x/libbeat/docs/loggingconfig.asciidoc">edit</a></div>
<p>The maximum size of a log file. If the limit is reached, a new log file is
generated. The default size limit is 5242880 (5 MB).</p>
<div class="position-relative"><h4><a id="_logging_event_data_files_keepfiles"></a><code class="literal">logging.event_data.files.keepfiles</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.x/libbeat/docs/loggingconfig.asciidoc">edit</a></div>
<p>The number of most recent rotated log files to keep on disk. Older files are
deleted during log rotation. The default value is 2. The <code class="literal">keepfiles</code> options has
to be in the range of 2 to 1024 files.</p>
<div class="position-relative"><h4><a id="_logging_event_data_files_permissions"></a><code class="literal">logging.event_data.files.permissions</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.x/libbeat/docs/loggingconfig.asciidoc">edit</a></div>
<p>The permissions mask to apply when rotating log files. The default value is
0600. The <code class="literal">permissions</code> option must be a valid Unix-style file permissions mask
expressed in octal notation. In Go, numbers in octal notation must start with
<em>0</em>.</p>
<p>The most permissive mask allowed is 0640. If a higher permissions mask is
specified via this setting, it will be subject to an umask of 0027.</p>
<p>This option is not supported on Windows.</p>
<p>Examples:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
0640: give read and write access to the file owner, and read access to members of the group associated with the file.
</li>
<li class="listitem">
0600: give read and write access to the file owner, and no access to all others.
</li>
</ul>
</div>
<div class="position-relative"><h4><a id="_logging_event_data_files_interval"></a><code class="literal">logging.event_data.files.interval</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.x/libbeat/docs/loggingconfig.asciidoc">edit</a></div>
<p>Enable log file rotation on time intervals in addition to size-based rotation.
Intervals must be at least 1s. Values of 1m, 1h, 24h, 7*24h, 30*24h, and 365*24h
are boundary-aligned with minutes, hours, days, weeks, months, and years as
reported by the local system clock. All other intervals are calculated from the
unix epoch. Defaults to disabled.</p>
<div class="position-relative"><h4><a id="_logging_event_data_files_rotateonstartup"></a><code class="literal">logging.event_data.files.rotateonstartup</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/8.x/libbeat/docs/loggingconfig.asciidoc">edit</a></div>
<p>If the log file already exists on startup, immediately rotate it and start
writing to a new file instead of appending to the existing one. Defaults to
false.</p>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="configuring-internal-queue.html">« Configure the internal queue</a>
</span>
<span class="next">
<a href="http-endpoint.html">Configure an HTTP endpoint for metrics »</a>
</span>
</div>
</body>
</html>
