<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Elastic Logging Plugin configuration options | Elastic Logging Plugin for Docker [7.12] | Elastic</title>
<link rel="home" href="index.html" title="Elastic Logging Plugin for Docker [7.12]"/>
<link rel="up" href="index.html" title="Elastic Logging Plugin for Docker [7.12]"/>
<link rel="prev" href="log-driver-installation.html" title="Install and configure the Elastic Logging Plugin"/>
<link rel="next" href="log-driver-usage-examples.html" title="Elastic Logging Plugin usage examples"/>
<meta name="DC.type" content="Learn/Docs/Elastic Logging Plugin/Reference/7.12"/>
<meta name="DC.subject" content="Elastic Logging Plugin"/>
<meta name="DC.identifier" content="7.12"/>
</head>
<body><div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Elastic Logging Plugin for Docker [7.12]</a></span>
»
<span class="breadcrumb-node">Elastic Logging Plugin configuration options</span>
</div>
<div class="navheader">
<span class="prev">
<a href="log-driver-installation.html">« Install and configure the Elastic Logging Plugin</a>
</span>
<span class="next">
<a href="log-driver-usage-examples.html">Elastic Logging Plugin usage examples »</a>
</span>
</div>
<div class="chapter xpack">
<div class="titlepage"><div><div>
<h1 class="title"><a id="log-driver-configuration"></a>Elastic Logging Plugin configuration options<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/7.12/x-pack/dockerlogbeat/docs/configuration.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h1>
</div></div></div>

<p>Use the following options to configure the Elastic Logging Plugin for Docker. You can
pass these options with the <code class="literal">--log-opt</code> flag when you start a container, or
you can set them in the <code class="literal">daemon.json</code> file for all containers.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="log-driver-configuration.html#cloud-options" title="Elastic Cloud options">Elastic Cloud options</a>
</li>
<li class="listitem">
<a class="xref" href="log-driver-configuration.html#es-output-options" title="Elasticsearch output options">Elasticsearch output options</a>
</li>
</ul>
</div>
<h3><a id="_usage_examples"></a>Usage examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/7.12/x-pack/dockerlogbeat/docs/configuration.asciidoc">edit</a></h3>
<p>To set configuration options when you start a container:</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">docker run --log-driver=elastic/elastic-logging-plugin:7.12.0 \
           --log-opt hosts="https://myhost:9200" \
           --log-opt user="myusername" \
           --log-opt password="mypassword" \
           -it debian:jessie /bin/bash</pre>
</div>
<p>To set configuration options for all containers in the <code class="literal">daemon.json</code> file:</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
  "log-driver" : "elastic/elastic-logging-plugin:7.12.0",
  "log-opts" : {
    "hosts" : "https://myhost:9200",
    "user" : "myusername",
    "password" : "mypassword"
  }
}</pre>
</div>
<p>For more examples, see <a class="xref" href="log-driver-usage-examples.html" title="Elastic Logging Plugin usage examples"><em>Usage examples</em></a>.</p>
<h3><a id="cloud-options"></a>Elastic Cloud options<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/7.12/x-pack/dockerlogbeat/docs/configuration.asciidoc">edit</a></h3>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Option</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">cloud_id</code></p></td>
<td align="left" valign="top"><p>The Cloud ID found in the Elastic Cloud web console. This ID is
used to resolve the Elastic Stack URLs when connecting to Elasticsearch Service on Elastic Cloud.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">cloud_auth</code></p></td>
<td align="left" valign="top"><p>The username and password combination for connecting to Elasticsearch Service on Elastic Cloud. The
format is <code class="literal">"username:password"</code>.</p></td>
</tr>
</tbody>
</table>
</div>
<h3><a id="es-output-options"></a>Elasticsearch output options<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/7.12/x-pack/dockerlogbeat/docs/configuration.asciidoc">edit</a></h3>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Option</th>
<th align="left" valign="top">Default</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">hosts</code></p></td>
<td align="left" valign="top"><p><code class="literal">"localhost:9200"</code></p></td>
<td align="left" valign="top"><p>The list of Elasticsearch nodes to connect to. Specify each node as a <code class="literal">URL</code> or
<code class="literal">IP:PORT</code>. For example: <code class="literal">http://192.0.2.0</code>, <code class="literal">https://myhost:9230</code> or
<code class="literal">192.0.2.0:9300</code>. If no port is specified, the default is <code class="literal">9200</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">user</code></p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>The basic authentication username for connecting to Elasticsearch.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">password</code></p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>The basic authentication password for connecting to Elasticsearch.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">index</code></p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>A <a href="/guide/en/beats/libbeat/7.12/config-file-format-type.html#_format_string_sprintf" class="ulink" target="_top">format string</a>
value that specifies the index to write events to when you&#8217;re using daily
indices. For example: <code class="literal">"dockerlogs-%{+yyyy.MM.dd}"</code>.</p></td>
</tr>
<tr>
<td align="left" colspan="3" valign="top"><p><span class="strong strong"><strong>Advanced:</strong></span></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">name</code></p></td>
<td align="left" valign="top"><p><code class="literal">testbeat</code></p></td>
<td align="left" valign="top"><p>A custom value that will be inserted into the document as <code class="literal">agent.name</code>.
If not set, it will be the hostname of Docker host.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">backoff_init</code></p></td>
<td align="left" valign="top"><p><code class="literal">1s</code></p></td>
<td align="left" valign="top"><p>The number of seconds to wait before trying to reconnect to Elasticsearch after
a network error. After waiting <code class="literal">backoff.init</code> seconds, the Elastic Logging Plugin
tries to reconnect. If the attempt fails, the backoff timer is increased
exponentially up to <code class="literal">backoff.max</code>. After a successful connection, the backoff
timer is reset.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">backoff_max</code></p></td>
<td align="left" valign="top"><p><code class="literal">60s</code></p></td>
<td align="left" valign="top"><p>The maximum number of seconds to wait before attempting to connect to
Elasticsearch after a network error.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">api_key</code></p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>Instead of using usernames and passwords,
you can use API keys to secure communication with Elasticsearch.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">pipeline</code></p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>A format string value that specifies the ingest node pipeline to write events to.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">timeout</code></p></td>
<td align="left" valign="top"><p><code class="literal">90</code></p></td>
<td align="left" valign="top"><p>The http request timeout in seconds for the Elasticsearch request.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">proxy_url</code></p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>The URL of the proxy to use when connecting to the Elasticsearch servers. The
value may be either a complete URL or a <code class="literal">host[:port]</code>, in which case the <code class="literal">http</code>
scheme is assumed. If a value is not specified through the configuration file
then proxy environment variables are used. See the
<a href="https://golang.org/pkg/net/http/#ProxyFromEnvironment" class="ulink" target="_top">Go documentation</a>
for more information about the environment variables.</p></td>
</tr>
</tbody>
</table>
</div>
<h3><a id="local-log-opts"></a>Configuring the local log<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/7.12/x-pack/dockerlogbeat/docs/configuration.asciidoc">edit</a></h3>
<p>This plugin fully supports <code class="literal">docker logs</code>, and it maintains a local copy of logs that can be read without a connection to Elasticsearch. The plugin mounts the <code class="literal">/var/lib/docker</code> directory on the host to write logs to <code class="literal">/var/log/containers</code> on the host. If you want to change the log location on the host, you must change the mount inside the plugin:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Disable the plugin:</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">docker plugin disable elastic/elastic-logging-plugin:7.12.0</pre>
</div>
</li>
<li class="listitem">
<p>Set the bindmount directory:</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">docker plugin set elastic/elastic-logging-plugin:7.12.0 LOG_DIR.source=NEW_LOG_LOCATION</pre>
</div>
</li>
<li class="listitem">
<p>Enable the plugin:</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">docker plugin enable elastic/elastic-logging-plugin:7.12.0</pre>
</div>
</li>
</ol>
</div>
<p>The local log also supports the <code class="literal">max-file</code>, <code class="literal">max-size</code> and <code class="literal">compress</code> options that are <a href="https://docs.docker.com/config/containers/logging/json-file/#options" class="ulink" target="_top">a part of the Docker default file logger</a>. For example:</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">docker run --log-driver=elastic/elastic-logging-plugin:7.12.0 \
           --log-opt hosts="myhost:9200" \
           --log-opt user="myusername" \
           --log-opt password="mypassword" \
           --log-opt max-file=10 \
           --log-opt max-size=5M \
           --log-opt compress=true \
           -it debian:jessie /bin/bash</pre>
</div>
<p>In situations where logs can&#8217;t be easily managed, for example, you can also configure the plugin to remove log files when a container is stopped. This will prevent you from reading logs on a stopped container, but it will rotate logs without user intervention. To enable removal of logs for stopped containers, you must change the <code class="literal">DESTROY_LOGS_ON_STOP</code> environment variable:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Disable the plugin:</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">docker plugin disable elastic/elastic-logging-plugin:7.12.0</pre>
</div>
</li>
<li class="listitem">
<p>Enable log removal:</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">docker plugin set elastic/elastic-logging-plugin:7.12.0 DESTROY_LOGS_ON_STOP=true</pre>
</div>
</li>
<li class="listitem">
<p>Enable the plugin:</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">docker plugin enable elastic/elastic-logging-plugin:7.12.0</pre>
</div>
</li>
</ol>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="log-driver-installation.html">« Install and configure the Elastic Logging Plugin</a>
</span>
<span class="next">
<a href="log-driver-usage-examples.html">Elastic Logging Plugin usage examples »</a>
</span>
</div>
</div>
</body>
</html>
