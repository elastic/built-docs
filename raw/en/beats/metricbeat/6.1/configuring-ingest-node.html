<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Parse logs by using ingest node | Metricbeat Reference [6.1] | Elastic</title>
<meta class="elastic" name="content" content="Parse logs by using ingest node | Metricbeat Reference [6.1]">

<link rel="home" href="index.html" title="Metricbeat Reference [6.1]"/>
<link rel="up" href="configuring-howto-metricbeat.html" title="Configuring Metricbeat"/>
<link rel="prev" href="add-docker-metadata.html" title="Add Docker metadata"/>
<link rel="next" href="configuration-path.html" title="Set up project paths"/>
<meta class="elastic" name="product_version" content="6.1"/>
<meta class="elastic" name="product_name" content="Metricbeat"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Metricbeat/Reference/6.1"/>
<meta name="DC.subject" content="Metricbeat"/>
<meta name="DC.identifier" content="6.1"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body><div class="page_header">
<p>
  <strong>WARNING</strong>: Version 6.1 of Metricbeat has passed its 
  <a href="https://www.elastic.co/support/eol">EOL date</a>. 
</p>  
<p>
  This documentation is no longer being maintained and may be removed. 
  If you are running this version, we strongly advise you to upgrade. 
  For the latest information, see the 
  <a href="../current/index.html">current release documentation</a>. 
</p>
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Metricbeat Reference [6.1]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="configuring-howto-metricbeat.html">Configuring Metricbeat</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="add-docker-metadata.html">« Add Docker metadata</a>
</span>
<span class="next">
<a href="configuration-path.html">Set up project paths »</a>
</span>
</div>
<div class="chapter">
<div class="titlepage"><div><div>
<h2 class="title"><a id="configuring-ingest-node"></a>Parse logs by using ingest node<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/beats/edit/6.1/libbeat/docs/shared-config-ingest.asciidoc">edit</a></h2>
</div></div></div>
<p>When you use Elasticsearch for output, you can configure Metricbeat to use
<a href="/guide/en/elasticsearch/reference/6.1/ingest.html" class="ulink" target="_top">ingest node</a> to pre-process documents
before the actual indexing takes place in Elasticsearch. Ingest node is a convenient processing option when you
want to do some extra processing on your data, but you do not require the full power of Logstash. For
example, you can create an ingest node pipeline in Elasticsearch that consists of one processor
that removes a field in a document followed by another processor that renames a field.</p>
<p>After defining the pipeline in Elasticsearch, you simply configure your Beat to use the pipeline. To configure
Metricbeat, you specify the pipeline ID in the <code class="literal">parameters</code> option under <code class="literal">elasticsearch</code> in the
<code class="literal">metricbeat.yml</code> file:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">output.elasticsearch:
  hosts: ["localhost:9200"]
  pipeline: my_pipeline_id</pre>
</div>
<p>For example, let&#8217;s say that you&#8217;ve defined the following pipeline in a file named <code class="literal">pipeline.json</code>:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
    "description": "Test pipeline",
    "processors": [
        {
            "lowercase": {
                "field": "beat.name"
            }
        }
    ]
}</pre>
</div>
<p>To add the pipeline in Elasticsearch, you would run:</p>
<div class="pre_wrapper lang-shell">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-shell">curl -H 'Content-Type: application/json' -XPUT 'http://localhost:9200/_ingest/pipeline/test-pipeline' -d@pipeline.json</pre>
</div>
<p>Then in the <code class="literal">metricbeat.yml</code> file, you would specify:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">output.elasticsearch:
  hosts: ["localhost:9200"]
  pipeline: "test-pipeline"</pre>
</div>
<p>When you run Metricbeat, the value of <code class="literal">beat.name</code> is converted to lowercase before indexing.</p>
<p>For more information about defining a pre-processing pipeline, see the <a href="/guide/en/elasticsearch/reference/6.1/ingest.html" class="ulink" target="_top">Ingest Node</a>
documentation.</p>
</div>
<div class="navfooter">
<span class="prev">
<a href="add-docker-metadata.html">« Add Docker metadata</a>
</span>
<span class="next">
<a href="configuration-path.html">Set up project paths »</a>
</span>
</div>
</div>
</body>
</html>
