<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title xmlns="">Configuring Thrift-RPC Support
        | Packetbeat Reference [1.3]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Packetbeat Reference [1.3]" /><link rel="up" href="configuring-howto-packetbeat.html" title="Configuring Packetbeat" /><link rel="prev" href="capturing-options.html" title="Setting Traffic Capturing Options" /><link rel="next" href="maintaining-topology.html" title="Maintaining the Real-Time State of the Network Topology" /><meta xmlns="" name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta xmlns="" name="DC.type" content="Learn/Docs/Packetbeat/Reference/1.3" /><meta xmlns="" name="DC.subject" content="Packetbeat" /><meta xmlns="" name="DC.identifier" content="1.3" /></head><body><div xmlns="" class="page_header">You are looking at documentation for an older release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div xmlns="" class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Packetbeat Reference
      [1.3]
    </a></span> » <span class="breadcrumb-link"><a href="configuring-howto-packetbeat.html">Configuring Packetbeat</a></span> » <span class="breadcrumb-node">Configuring Thrift-RPC Support</span></div><div xmlns="" class="navheader"><span class="prev"><a href="capturing-options.html">
              « 
              Setting Traffic Capturing Options</a>
           
        </span><span class="next">
           
          <a href="maintaining-topology.html">Maintaining the Real-Time State of the Network Topology
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="_configuring_thrift_rpc_support"></a>Configuring Thrift-RPC Support<a xmlns="" href="https://github.com/elastic/beats/edit/1.3/packetbeat/docs/thrift.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p><a class="ulink" href="https://thrift.apache.org/" target="_top">Apache Thrift</a> is a communication protocol and RPC
framework initially created at Facebook. It is sometimes used in
<a class="ulink" href="http://martinfowler.com/articles/microservices.html" target="_top">microservices</a>
architectures because it provides better performance when compared to the more
obvious HTTP/RESTful API choice, while still supporting a wide range of
programming languages and frameworks.</p><p>Packetbeat works based on a copy of the traffic, which means that you get
performance management features without having to modify your services in
any way and without any latency overhead. Packetbeat captures the transactions from the
network and indexes them in Elasticsearch so that they can be analyzed and
searched.</p><p>Packetbeat indexes the method, parameters, return value, and
exceptions of each Thrift-RPC call. You can search by and create statistics
based on any of these fields. Packetbeat automatically fills in the <code class="literal">status</code>
column with either <code class="literal">OK</code> or <code class="literal">Error</code>, so it’s easy to find the problematic RPC calls.
A transaction is put into the <code class="literal">Error</code> state if it returned an exception.</p><p>Packetbeat also indexes the <code class="literal">responsetime</code> field so you can get performance
analytics and find the slow RPC calls.</p><p>Here is an example performance dashboard:</p><p><span class="inlinemediaobject"><img src="./images/thrift-dashboard.png" alt="Thrift-RPC dashboard" /></span></p><p>Thrift supports multiple <a class="ulink" href="http://en.wikipedia.org/wiki/Apache_Thrift" target="_top">transport
and protocol types</a>. Currently Packetbeat supports the default <code class="literal">TSocket</code>
transport as well as the <code class="literal">TFramed</code> transport. From the protocol point of view,
Packetbeat currently supports only the default <code class="literal">TBinary</code> protocol.</p><p>Packetbeat also has several configuration options that allow you to get
the right balance between visibility, disk usage, and data protection. You can,
for example, choose to obfuscate all strings or to store the requests but not
the responses, while still capturing the response time for each of the RPC
calls. You can also choose to limit the size of strings and lists to a given
number of elements, so you can fine tune how much data you want to have stored in
Elasticsearch.</p><p>Here is an example configuration section for the Thrift protocol:</p><div xmlns="" class="pre_wrapper lang-yaml"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-yaml">protocols:
  thrift:
    transport_type = "socket"
    protocol_type = "binary"
    idl_files = ["tutorial.thrift", "shared.thrift"]
    string_max_size = 200
    collection_max_size = 20
    capture_reply = true
    obfuscate_strings = true
    drop_after_n_struct_fields = 100</pre></div><p>For more details about the configuration options, see the
<a class="xref" href="configuration-protocols.html#configuration-thrift" title="Thrift Configuration Options">Thrift Configuration Options</a> section.</p><p>Providing the Thrift IDL files to Packetbeat is optional. The binary
Thrift messages include the called method name and enough structural information
to decode the messages without needing the IDL files. However, if you
provide the IDL files, Packetbeat can also resolve the service name,
arguments, and exception names.</p></div><div xmlns="" class="navfooter"><span class="prev"><a href="capturing-options.html">
              « 
              Setting Traffic Capturing Options</a>
           
        </span><span class="next">
           
          <a href="maintaining-topology.html">Maintaining the Real-Time State of the Network Topology
               »
            </a></span></div></body></html>