<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title xmlns="">Set up flows to monitor network traffic
        | Packetbeat Reference [6.8]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Packetbeat Reference [6.8]" /><link rel="up" href="configuring-howto-packetbeat.html" title="Configuring Packetbeat" /><link rel="prev" href="configuration-interfaces.html" title="Set traffic capturing options" /><link rel="next" href="configuration-protocols.html" title="Specify which transaction protocols to monitor" /><meta xmlns="" name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta xmlns="" name="DC.type" content="Learn/Docs/Packetbeat/Reference/6.8" /><meta xmlns="" name="DC.subject" content="Packetbeat" /><meta xmlns="" name="DC.identifier" content="6.8" /></head><body><div xmlns="" class="page_header">You are looking at documentation for an older release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div xmlns="" class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Packetbeat Reference
      [6.8]
    </a></span> » <span class="breadcrumb-link"><a href="configuring-howto-packetbeat.html">Configuring Packetbeat</a></span> » <span class="breadcrumb-node">Set up flows to monitor network traffic</span></div><div xmlns="" class="navheader"><span class="prev"><a href="configuration-interfaces.html">
              « 
              Set traffic capturing options</a>
           
        </span><span class="next">
           
          <a href="configuration-protocols.html">Specify which transaction protocols to monitor
               »
            </a></span></div><div class="chapter"><div class="titlepage"><div><div><h2 class="title"><a id="configuration-flows"></a>Set up flows to monitor network traffic<a xmlns="" href="https://github.com/elastic/beats/edit/6.8/packetbeat/docs/packetbeat-options.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>You can configure Packetbeat to collect and report statistics on network flows.
A <span class="emphasis"><em>flow</em></span> is a group of packets sent over the same time period that share
common properties, such as the same source and destination address and protocol.
You can use this feature to analyze network traffic over specific protocols on
your network.</p><p>For each flow, Packetbeat reports the number of packets and the total number of
bytes sent from the source to the destination. Each flow event also contains
information about the source and destination hosts, such as their IP address.
For bi-directional flows, Packetbeat reports statistics for the reverse flow.</p><p>Packetbeat collects and reports statistics up to and including the transport
layer. See <a class="xref" href="exported-fields-flows_event.html" title="Flow Event fields"><em>Flow Event fields</em></a> for more info about the exported
data.</p><p>Here’s an example of flow events visualized in the Flows dashboard:</p><p><span class="inlinemediaobject"><img src="./images/flows.png" alt="./images/flows.png" /></span></p><p>To configure flows, use the <code class="literal">packetbeat.flows</code> option in the <code class="literal">packetbeat.yml</code>
config file. Flows are enabled by default. If this section is missing
from the configuration file, network flows are disabled.</p><div xmlns="" class="pre_wrapper lang-yaml"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-yaml">packetbeat.flows:
  timeout: 30s
  period: 10s</pre></div><p>Here’s an example of a flow information sent by Packetbeat. See
<a class="xref" href="exported-fields-flows_event.html" title="Flow Event fields"><em>Flow Event fields</em></a> for a description of each field.</p><div xmlns="" class="pre_wrapper lang-json"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-json">{
  "@timestamp": "2017-05-03T19:42:40.003Z",
  "beat": {
    "hostname": "host.example.com",
    "name": "host.example.com",
    "version": "6.8.2"
  },
  "connection_id": "AQAAAAAAAAA=",
  "dest": {
    "ip": "192.0.2.0",
    "mac": "fe:ff:20:00:01:00",
    "port": 80,
    "stats": {
      "net_bytes_total": 19236,
      "net_packets_total": 16
    }
  },
  "final": false, <a id="CO6-1"></a><i xmlns="" class="conum" data-value="1"></i>
  "flow_id": "EQwA////DP//////FBgBAAEAAAEAAAD+/yAAAQCR/qDtQdDk3ywNUAABAAAAAAAAAA",
  "last_time": "2017-05-03T19:42:24.151Z",
  "source": {
    "ip": "203.0.113.0",
    "mac": "00:00:01:00:00:00",
    "port": 3372,
    "stats": {
      "net_bytes_total": 1243,
      "net_packets_total": 14
    }
  },
  "start_time": "2017-05-03T19:42:24.151Z",
  "transport": "tcp",
  "type": "flow"
}</pre></div><div class="calloutlist"><table border="0" summary="Callout list"><tr><td width="5%" valign="top" align="left"><p><a href="#CO6-1"><i xmlns="" class="conum" data-value="1"></i></a> </p></td><td valign="top" align="left"><p>
Packetbeat sets the <code class="literal">final</code> flag to <code class="literal">false</code> to indicate that the event
contains an intermediate report about a flow that it’s tracking. When the flow
completes, Packetbeat sends one last event with <code class="literal">final</code> set to <code class="literal">true</code>. If you
want to aggregate sums of traffic, you need to filter on <code class="literal">final:true</code>, or use
some other technique, so that you get only the latest update from each flow.
You can disable intermediate reports by setting <code class="literal">period: -1s</code>.
</p></td></tr></table></div><h3><a id="_configuration_options"></a>Configuration options<a xmlns="" href="https://github.com/elastic/beats/edit/6.8/packetbeat/docs/packetbeat-options.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h3><p>You can specify the following options in the <code class="literal">packetbeat.flows</code> section of
the <code class="literal">packetbeat.yml</code> config file:</p><h4><a id="_literal_enabled_literal"></a><code class="literal">enabled</code><a xmlns="" href="https://github.com/elastic/beats/edit/6.8/packetbeat/docs/packetbeat-options.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>Enables flows support if set to true. Set to false to disable network flows
support without having to delete or comment out the flows section. The default
value is true.</p><h4><a id="_literal_timeout_literal"></a><code class="literal">timeout</code><a xmlns="" href="https://github.com/elastic/beats/edit/6.8/packetbeat/docs/packetbeat-options.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>Timeout configures the lifetime of a flow. If no packets have been received for
a flow within the timeout time window, the flow is killed and reported. The
default value is 30s.</p><h4><a id="_literal_period_literal"></a><code class="literal">period</code><a xmlns="" href="https://github.com/elastic/beats/edit/6.8/packetbeat/docs/packetbeat-options.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>Configure the reporting interval. All flows are reported at the very same point
in time. Periodical reporting can be disabled by setting the value to -1. If
disabled, flows are still reported once being timed out. The default value is
10s.</p><h4><a id="packetbeat-configuration-flows-fields"></a><code class="literal">fields</code><a xmlns="" href="https://github.com/elastic/beats/edit/6.8/packetbeat/docs/packetbeat-options.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>Optional fields that you can specify to add additional information to the
output. For example, you might add fields that you can use for filtering log
data. Fields can be scalar values, arrays, dictionaries, or any nested
combination of these. By default, the fields that you specify here will be
grouped under a <code class="literal">fields</code> sub-dictionary in the output document. To store the
custom fields as top-level fields, set the <code class="literal">fields_under_root</code> option to true.
If a duplicate field is declared in the general configuration, then its value
will be overwritten by the value declared here.</p><h4><a id="_literal_fields_under_root_literal"></a><code class="literal">fields_under_root</code><a xmlns="" href="https://github.com/elastic/beats/edit/6.8/packetbeat/docs/packetbeat-options.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>If this option is set to true, the custom <a class="link" href="configuration-flows.html#packetbeat-configuration-flows-fields" title="fields">fields</a>
are stored as top-level fields in the output document instead of being grouped
under a <code class="literal">fields</code> sub-dictionary. If the custom field names conflict with other
field names added by Packetbeat, then the custom fields overwrite the other
fields.</p><h4><a id="_literal_tags_literal"></a><code class="literal">tags</code><a xmlns="" href="https://github.com/elastic/beats/edit/6.8/packetbeat/docs/packetbeat-options.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>A list of tags that will be sent with the protocol event. This setting is optional.</p><h4><a id="_literal_processors_literal"></a><code class="literal">processors</code><a xmlns="" href="https://github.com/elastic/beats/edit/6.8/packetbeat/docs/packetbeat-options.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>A list of processors to apply to the data generated by the protocol.</p><p>See <a class="xref" href="filtering-and-enhancing-data.html" title="Filter and enhance the exported data"><em>Filter and enhance the exported data</em></a> for information about specifying
processors in your config.</p></div><div xmlns="" class="navfooter"><span class="prev"><a href="configuration-interfaces.html">
              « 
              Set traffic capturing options</a>
           
        </span><span class="next">
           
          <a href="configuration-protocols.html">Specify which transaction protocols to monitor
               »
            </a></span></div></body></html>