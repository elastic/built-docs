<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title xmlns="">Common protocol options
        | Packetbeat Reference [master]
      | Elastic
    </title><meta name="generator" content="DocBook XSL Stylesheets V1.78.1" /><link rel="home" href="index.html" title="Packetbeat Reference [master]" /><link rel="up" href="configuration-protocols.html" title="Specify which transaction protocols to monitor" /><link rel="prev" href="configuration-protocols.html" title="Specify which transaction protocols to monitor" /><link rel="next" href="packetbeat-icmp-options.html" title="Capture ICMP traffic" /><meta xmlns="" name="description" content="Get started with the documentation for Elasticsearch, Kibana, Logstash, Beats, X-Pack, Elastic Cloud, Elasticsearch for Apache Hadoop, and our language clients." /><meta xmlns="" name="DC.type" content="Learn/Docs/Packetbeat/Reference/master" /><meta xmlns="" name="DC.subject" content="Packetbeat" /><meta xmlns="" name="DC.identifier" content="master" /></head><body><div xmlns="" class="page_header">You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div><div xmlns="" class="breadcrumbs"><span class="breadcrumb-link"><a href="index.html">Packetbeat Reference
      [master]
    </a></span> » <span class="breadcrumb-link"><a href="configuring-howto-packetbeat.html">Configuring Packetbeat</a></span> » <span class="breadcrumb-link"><a href="configuration-protocols.html">Specify which transaction protocols to monitor</a></span> » <span class="breadcrumb-node">Common protocol options</span></div><div xmlns="" class="navheader"><span class="prev"><a href="configuration-protocols.html">
              « 
              Specify which transaction protocols to monitor</a>
           
        </span><span class="next">
           
          <a href="packetbeat-icmp-options.html">Capture ICMP traffic
               »
            </a></span></div><div class="section"><div class="titlepage"><div><div><h2 class="title"><a id="common-protocol-options"></a>Common protocol options<a xmlns="" href="https://github.com/elastic/beats/edit/master/packetbeat/docs/packetbeat-options.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h2></div></div></div><p>The following options are available for all protocols:</p><h4><a id="_literal_enabled_literal_2"></a><code class="literal">enabled</code><a xmlns="" href="https://github.com/elastic/beats/edit/master/packetbeat/docs/packetbeat-options.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>The enabled setting is a boolean setting to enable or disable protocols without
having to comment out configuration sections. If set to false, the protocol is
disabled.</p><p>The default value is true.</p><h4><a id="_literal_ports_literal"></a><code class="literal">ports</code><a xmlns="" href="https://github.com/elastic/beats/edit/master/packetbeat/docs/packetbeat-options.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>Exception: For ICMP the option <code class="literal">enabled</code> has to be used instead.</p><p>The ports where Packetbeat will look to capture traffic for specific
protocols. Packetbeat installs a <a class="ulink" href="https://en.wikipedia.org/wiki/Berkeley_Packet_Filter" target="_top">BPF</a>
filter based on the ports specified in this section.
If a packet doesn’t match the filter, very little CPU is required to discard
the packet. Packetbeat also uses the ports specified here to determine which
parser to use for each packet.</p><h4><a id="send-request-option"></a><code class="literal">send_request</code><a xmlns="" href="https://github.com/elastic/beats/edit/master/packetbeat/docs/packetbeat-options.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>If this option is enabled, the raw message of the request (<code class="literal">request</code> field) is
sent to Elasticsearch. The default is false. This option is useful when you want to
index the whole request. Note that for HTTP, the body is not included by
default, only the HTTP headers.</p><h4><a id="send-response-option"></a><code class="literal">send_response</code><a xmlns="" href="https://github.com/elastic/beats/edit/master/packetbeat/docs/packetbeat-options.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>If this option is enabled, the raw message of the response (<code class="literal">response</code> field)
is sent to Elasticsearch. The default is false.  This option is useful when you
want to index the whole response. Note that for HTTP, the body is not included
by default, only the HTTP headers.</p><h4><a id="transaction-timeout-option"></a><code class="literal">transaction_timeout</code><a xmlns="" href="https://github.com/elastic/beats/edit/master/packetbeat/docs/packetbeat-options.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>The per protocol transaction timeout. Expired transactions will no longer be correlated to incoming responses, but sent to Elasticsearch immediately.</p><h4><a id="packetbeat-configuration-fields"></a><code class="literal">fields</code><a xmlns="" href="https://github.com/elastic/beats/edit/master/packetbeat/docs/packetbeat-options.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>Optional fields that you can specify to add additional information to the
output. For example, you might add fields that you can use for filtering log
data. Fields can be scalar values, arrays, dictionaries, or any nested
combination of these. By default, the fields that you specify here will be
grouped under a <code class="literal">fields</code> sub-dictionary in the output document. To store the
custom fields as top-level fields, set the <code class="literal">fields_under_root</code> option to true.
If a duplicate field is declared in the general configuration, then its value
will be overwritten by the value declared here.</p><div xmlns="" class="pre_wrapper lang-yaml"><pre xmlns="http://www.w3.org/1999/xhtml" class="programlisting prettyprint lang-yaml">packetbeat.protocols:
- type: http
  ports: [80]
  fields:
    service_id: nginx</pre></div><h4><a id="packetbeat-fields-under-root"></a><code class="literal">fields_under_root</code><a xmlns="" href="https://github.com/elastic/beats/edit/master/packetbeat/docs/packetbeat-options.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>If this option is set to true, the custom <a class="link" href="common-protocol-options.html#packetbeat-configuration-fields" title="fields">fields</a>
are stored as top-level fields in the output document instead of being grouped
under a <code class="literal">fields</code> sub-dictionary. If the custom field names conflict with other
field names added by Packetbeat, then the custom fields overwrite the other
fields.</p><h4><a id="_literal_tags_literal_2"></a><code class="literal">tags</code><a xmlns="" href="https://github.com/elastic/beats/edit/master/packetbeat/docs/packetbeat-options.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>A list of tags that will be sent with the transaction event. This setting is optional.</p><h4><a id="_literal_processors_literal_2"></a><code class="literal">processors</code><a xmlns="" href="https://github.com/elastic/beats/edit/master/packetbeat/docs/packetbeat-options.asciidoc" class="edit_me" title="Edit this page on GitHub" rel="nofollow">edit</a></h4><p>A list of processors to apply to the data generated by the protocol.</p><p>See <a class="xref" href="filtering-and-enhancing-data.html" title="Filter and enhance the exported data"><em>Filter and enhance the exported data</em></a> for information about specifying
processors in your config.</p></div><div xmlns="" class="navfooter"><span class="prev"><a href="configuration-protocols.html">
              « 
              Specify which transaction protocols to monitor</a>
           
        </span><span class="next">
           
          <a href="packetbeat-icmp-options.html">Capture ICMP traffic
               »
            </a></span></div></body></html>