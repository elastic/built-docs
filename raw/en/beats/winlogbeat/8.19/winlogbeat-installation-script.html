<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Windows Installation Script | Winlogbeat Reference [8.19] | Elastic</title>
<meta class="elastic" name="content" content="Windows Installation Script | Winlogbeat Reference [8.19]">

<link rel="home" href="index.html" title="Winlogbeat Reference [8.19]"/>
<link rel="up" href="setting-up-and-running.html" title="Set up and run Winlogbeat"/>
<link rel="prev" href="shutdown.html" title="Stop Winlogbeat"/>
<link rel="next" href="upgrading-winlogbeat.html" title="Upgrade Winlogbeat"/>
<meta class="elastic" name="product_version" content="8.19"/>
<meta class="elastic" name="product_name" content="Winlogbeat"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Winlogbeat/Reference/8.19"/>
<meta name="DC.subject" content="Winlogbeat"/>
<meta name="DC.identifier" content="8.19"/>
</head>
<body>
<div class="navheader">
<span class="prev">
<a href="shutdown.html">« Stop Winlogbeat</a>
</span>
<span class="next">
<a href="upgrading-winlogbeat.html">Upgrade Winlogbeat »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Winlogbeat Reference [8.19]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="setting-up-and-running.html">Set up and run Winlogbeat</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Windows Installation Script</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.19/libbeat/docs/shared/installation-script.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div id="url-to-v3" class="version-warning">
    <strong>IMPORTANT</strong>: This documentation is no longer updated. Refer to <a href="https://www.elastic.co/support/eol">Elastic's version policy</a> and the <a href="https://www.elastic.co/docs">latest documentation</a>.
</div>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="winlogbeat-installation-script"></a>Windows Installation Script</h2><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.19/libbeat/docs/shared/installation-script.asciidoc">edit</a></div>
</div></div></div>
<p>The installation script, <code class="literal">install-service-winlogbeat.ps1</code> is responsible
for creating the Windows Service for Winlogbeat. Starting in 8.19.3, the
base folder has changed from <code class="literal">C:\ProgramData\</code> to  <code class="literal">C:\Program Files\</code>
because the latter has stricter permissions, therefore the home path
(base for state and logs) is now <code class="literal">C:\Program Files\Winlogbeat-Data</code>.</p>
<p>The install script (<code class="literal">install-service-winlogbeat.ps1</code>) will check whether
<code class="literal">C:\ProgramData\winlogbeat</code> exits and attempt to move it to <code class="literal">C:\Program Files\Winlogbeat-Data</code>.
If an error occurs, the script will stop and print the error.</p>
<p>On success, it will create the Windows Service setting:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">path.home</code> as <code class="literal">$env:ProgramFiles\Winlogbeat-Data</code>
</li>
<li class="listitem">
<code class="literal">path.logs</code> as <code class="literal">$env:ProgramFiles\Winlogbeat-Data\logs</code>
</li>
</ul>
</div>
<p>The script also supports passing the parameter <code class="literal">-ForceLegacyPath</code> to
use the old default <code class="literal">C:\ProgramData\</code> that is set using
<code class="literal">$env:PROGRAMDATA</code>. However using <code class="literal">-ForceLegacyPath</code> is <span class="strong strong"><strong>not
recommended</strong></span>.</p>
<p>In a PowerShell prompt, can use <code class="literal">Get-Help install-service-winlogbeat.ps1
-detailed</code> to get detailed help.</p>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_troubleshooting"></a>Troubleshooting</h3><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/beats/edit/8.19/libbeat/docs/shared/installation-script.asciidoc">edit</a></div>
</div></div></div>
<p>If there is a permission error when the installation script is moving
the folder, ensure the user running the script has enough permissions
to do so. If the problem persists, the folder can be moved manually,
then the installation script can be executed again.</p>
<p>If the script still cannot move the files, you can manually move
<code class="literal">C:\ProgramData\winlogbeat</code> to
<code class="literal">C:\Program Files\Winlogbeat-Data</code>.
and run the install script again.</p>
</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="shutdown.html">« Stop Winlogbeat</a>
</span>
<span class="next">
<a href="upgrading-winlogbeat.html">Upgrade Winlogbeat »</a>
</span>
</div>
</body>
</html>
