<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>elastic-cloud-enterprise.sh install | Elastic Cloud Enterprise Reference [2.7] | Elastic</title>
<link rel="home" href="index.html" title="Elastic Cloud Enterprise Reference [2.7]"/>
<link rel="up" href="ece-script-reference.html" title="Script reference"/>
<link rel="prev" href="ece-script-reference.html" title="Script reference"/>
<link rel="next" href="ece-installation-script-upgrade.html" title="elastic-cloud-enterprise.sh upgrade"/>
<meta name="DC.type" content="Learn/Docs/CloudEnterprise/Reference/2.7"/>
<meta name="DC.subject" content="ECE"/>
<meta name="DC.identifier" content="2.7"/>
</head>
<body><div class="page_header">
A newer version is available. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Elastic Cloud Enterprise Reference [2.7]</a></span>
»
<span class="breadcrumb-link"><a href="ece-script-reference.html">Script reference</a></span>
»
<span class="breadcrumb-node"><code class="literal">elastic-cloud-enterprise.sh install</code></span>
</div>
<div class="navheader">
<span class="prev">
<a href="ece-script-reference.html">« Script reference</a>
</span>
<span class="next">
<a href="ece-installation-script-upgrade.html"><code class="literal">elastic-cloud-enterprise.sh upgrade</code> »</a>
</span>
</div>
<div class="chapter">
<div class="titlepage"><div><div>
<h2 class="title"><a id="ece-installation-script"></a><code class="literal">elastic-cloud-enterprise.sh install</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-47/docs/cloud-enterprise/ce-script-reference.asciidoc">edit</a></h2>
</div></div></div>
<p><span class="strong strong"><strong>NAME</strong></span></p>
<p>bash elastic-cloud-enterprise.sh install&#8201;&#8212;&#8201;Install Elastic Cloud Enterprise</p>
<p><span class="strong strong"><strong>SYNOPSIS</strong></span></p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">bash elastic-cloud-enterprise.sh [install] [--coordinator-host C_HOST_IP]
[--roles-token 'TOKEN'] [--roles "ROLE_LIST"]
[--host-docker-host "PATH_NAME/docker.sock"] [--host-storage-path PATH_NAME]
[--cloud-enterprise-version VERSION_NAME] [--debug]
[--timeout-factor NUMBER]
[--docker-registry REGISTRY] [--ece-docker-repository REPOSITORY] [--overwrite-existing-image]
[--runner-id ID] [--host-ip HOST_IP] [--availability-zone ZONE_NAME]
[--capacity MB_VALUE] [--memory-settings JVM_SETTINGS] [--force]</pre>
</div>
<p><span class="strong strong"><strong>REQUIRED PRIVILEGES</strong></span></p>
<p>To run this script, a user must be part of the <code class="literal">docker</code> group. You must not install Elastic Cloud Enterprise as the <code class="literal">root</code> user.</p>
<p><span class="strong strong"><strong>DESCRIPTION</strong></span></p>
<p>Installs Elastic Cloud Enterprise according to the specified parameters, both to start a new Elastic Cloud Enterprise installation and to add hosts to an existing installation. Can be used to automate installation or to customize how you install Elastic Cloud Enterprise. The script defaults to this action, if no other action is specified.</p>
<p><span class="strong strong"><strong>PARAMETERS</strong></span></p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
--coordinator-host <code class="literal">COORDINATOR_HOST_IP</code>
</span>
</dt>
<dd>
Specifies the IP address of the first host used to start a new Elastic Cloud Enterprise installation. Must be specified together with --roles-token <code class="literal">'TOKEN'</code> when installing Elastic Cloud Enterprise on additional hosts to add them to an existing installation.
</dd>
<dt>
<span class="term">
--roles-token <code class="literal">'TOKEN'</code>
</span>
</dt>
<dd>
Specifies a token that enables the host to join an existing Elastic Cloud Enterprise installation. A basic token is provided after installation on the first host. For automation purposes, a <a class="xref" href="ece-generate-roles-token.html" title="Generate roles tokens">token you generate</a> with additional role permissions is preferred. Required when --coordinator-host <code class="literal">COORDINATOR_HOST_IP</code> is also specified.
</dd>
<dt>
<span class="term">
--roles <code class="literal">"ROLE_LIST"</code>
</span>
</dt>
<dd>
Assigns a comma-separated list of runner roles to the host during installation. The supported roles are <code class="literal">director</code>, <code class="literal">coordinator</code>, <code class="literal">allocator</code>, and <code class="literal">proxy</code>.
</dd>
<dt>
<span class="term">
--host-docker-host <code class="literal">/PATH_NAME/docker.sock</code>
</span>
</dt>
<dd>
Specifies the location of the Docker socket used to communicate with the Docker daemon. Defaults to /var/run/docker.sock.
</dd>
<dt>
<span class="term">
--host-storage-path <code class="literal">PATH_NAME</code>
</span>
</dt>
<dd>
Specifies the host storage path used by the Elastic Cloud Enterprise installation. Defaults to <code class="literal">/mnt/data/elastic</code>.<br>
<span class="strong strong"><strong>WARNING:</strong></span> This path cannot be the exact XFS volume mount point, it <span class="strong strong"><strong>must be the subdirectory of it</strong></span>.
By default, the XFS volume should be mounted at <code class="literal">/mnt/data</code>.
</dd>
<dt>
<span class="term">
--cloud-enterprise-version <code class="literal">VERSION_NAME</code>
</span>
</dt>
<dd>
Specifies the version of Elastic Cloud Enterprise to install. Defaults to <code class="literal">:version:</code>.
</dd>
<dt>
<span class="term">
--debug
</span>
</dt>
<dd>
If specified, outputs debugging information.
</dd>
<dt>
<span class="term">
--timeout-factor <code class="literal">NUMBER</code>
</span>
</dt>
<dd>
If specified, increases all timeout values used during installation by multiplying with this number. Defaults to <code class="literal">1.0</code>.
</dd>
<dt>
<span class="term">
--docker-registry <code class="literal">REGISTRY</code>
</span>
</dt>
<dd>
Specifies the Docker registry from where Elastic Cloud Enterprise assets are retrieved during installation. Defaults to <code class="literal">docker.elastic.co</code>.
</dd>
<dt>
<span class="term">
--ece-docker-repository <code class="literal">REPOSITORY</code>
</span>
</dt>
<dd>
Specifies the docker repository prefix for Elastic Cloud Enterprise docker image. Defaults to <code class="literal">cloud-enterprise</code>
</dd>
<dt>
<span class="term">
--overwrite-existing-image
</span>
</dt>
<dd>
Overwrites any existing local image when retrieving the Elastic Cloud Enterprise installation image from the repository. Defaults to false.
</dd>
<dt>
<span class="term">
--runner-id <code class="literal">ID</code>
</span>
</dt>
<dd>
Assigns an arbitrary ID to the host (runner) that you are installing Elastic Cloud Enterprise on. Runners provide a supervisor service on all nodes and deploy containers based on their role definitions. Using the machine name or IP address can help identify which host the runner ID refers to. Defaults to <code class="literal">host-ip</code>.
</dd>
<dt>
<span class="term">
--host-ip <code class="literal">HOST_IP</code>
</span>
</dt>
<dd>
Specifies an IP address for the host that you are installing Elastic Cloud Enterprise on. Used for internal communication within the cluster. This must be a routable IP in your network. On AWS, the private IP of the host must be used. In VirtualBox, it is the eth0 inet address of the virtual machine. If a route to the default gateway can be determined, defaults to the IP address for the network interface.<sup>1</sup>
</dd>
<dt>
<span class="term">
--availability-zone <code class="literal">ZONE_NAME</code>
</span>
</dt>
<dd>
Specifies an availability zone for the host that you are installing Elastic Cloud Enterprise on. Zones are defined by your use case, and although the zone name is arbitrary, it must be identical among all machines in a given zone. For AWS users, the zones are predefined and Elastic recommends a two or three zone deployment. The default zone name is <code class="literal">ece-zone-1</code>.
</dd>
<dt>
<span class="term">
--capacity <code class="literal">MB_VALUE</code>
</span>
</dt>
<dd>
Specifies the amount of RAM in megabytes this runner makes available for Elasticsearch clusters. Must be at least 8192 MB. For future coordinators, set this value relatively low. For future allocators, set this value to the total memory available on the machine minus some memory reserved for Elastic Cloud Enterprise and any other systems running on this host. Defaults to 85% of total RAM if not specified.
</dd>
<dt>
<span class="term">
--memory-settings <code class="literal">JVM_SETTINGS</code>
</span>
</dt>
<dd>
Specifies a custom JVM setting for a service, such as heap size. Settings must be specified in JSON format. Supported services include: <code class="literal">admin-console</code>, <code class="literal">zookeeper</code>, <code class="literal">client-forwarder</code>, <code class="literal">client-observer</code>, <code class="literal">runner</code>, <code class="literal">director</code>, <code class="literal">blueprint</code>, <code class="literal">constructor</code>, <code class="literal">allocator</code>, <code class="literal">services-forwarder</code>, <code class="literal">beats-runner</code>, and <code class="literal">cloud-ui</code>.
</dd>
<dt>
<span class="term">
--force
</span>
</dt>
<dd>
Checks the installation requirements, but does not exit the installation process if a check fails. If not specified, a failed installation check causes the installation process to exit.
</dd>
<dt>
<span class="term">
--external-hostname
</span>
</dt>
<dd>
Comma separated list of names to include in the SAN extension of the self generated TLS certificates for HTTP.
</dd>
</dl>
</div>
<p><sup>1</sup><span class="small">The default value for <code class="literal">host-ip</code> is passed in by the installation script. If you perform installation through some other method such as Ansible, you must specify a value for <code class="literal">host-ip</code> or an error is returned.</span></p>
<h2><a id="ece-installation-script-examples"></a>Examples<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-47/docs/cloud-enterprise/ce-script-reference.asciidoc">edit</a></h2>
<p>Install Elastic Cloud Enterprise on the first host to start a new installation, using a single combined cURL and bash command:</p>
<pre class="literallayout">bash &lt;(curl -fsSL https://download.elastic.co/cloud/elastic-cloud-enterprise.sh) install</pre>

<p>Install Elastic Cloud Enterprise on additional hosts by including the <code class="literal">--coordinator-host</code> parameter to add them to an existing installation, using a single combined cURL and bash command. No availability zone is specified, so the installer will assign a default zone. The token specified with `--roles-token`is required to enable the host to join the existing Elastic Cloud Enterprise installation.</p>
<pre class="literallayout">bash &lt;(curl -fsSL https://download.elastic.co/cloud/elastic-cloud-enterprise.sh) install --coordinator-host 192.168.50.10 --roles-token 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiI2ZDE2ZDY3YS01NGUzLTQ0MzMtYTlmZC05MTJjYzQwZmIxYmQiLCJyb2xlcyI6W10sImlzcyI6ImN1cnJlbnQiLCJwZXJzaXN0ZW50Ijp0cnVlfQ.MGEpEj0JmUGuucazf55sURNX-Q6QIMhKP0gdNJ2-vnk'</pre>

<p>Install Elastic Cloud Enterprise on the first host  to start a new installation with additional parameters to set the runner ID, the host IP address, an availability zone, and capacity. The token specified with `--roles-token`is required to enable the host to join the existing Elastic Cloud Enterprise installation.</p>
<pre class="literallayout">bash &lt;(curl -fsSL https://download.elastic.co/cloud/elastic-cloud-enterprise.sh) install --runner-id runner-1 --host-ip 10.142.0.4 --availability-zone zone-1a --capacity 30000 --roles-token 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiI2ZDE2ZDY3YS01NGUzLTQ0MzMtYTlmZC05MTJjYzQwZmIxYmQiLCJyb2xlcyI6W10sImlzcyI6ImN1cnJlbnQiLCJwZXJzaXN0ZW50Ijp0cnVlfQ.MGEpEj0JmUGuucazf55sURNX-Q6QIMhKP0gdNJ2-vnk'</pre>

<p>Download the script and run it separately to start a new Elastic Cloud Enterprise installation:</p>
<pre class="literallayout">curl -L -O https://download.elastic.co/cloud/elastic-cloud-enterprise.sh
bash elastic-cloud-enterprise.sh install</pre>

<p><a id="ece-installation-script-9"></a>Install Elastic Cloud Enterprise on nine hosts, placing them into three different availability zones. These steps require that you first download the installation script with <code class="literal">curl -L -O https://download.elastic.co/cloud/elastic-cloud-enterprise.sh</code> on each host or make it available somewhere on your network. Alternatively, you can modify these commands to download and run the script in one step as shown in some of the other examples.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Start your installation by installing Elastic Cloud Enterprise on your first host and specify the runner ID and availability zone:</p>
<pre class="literallayout">bash elastic-cloud-enterprise.sh install --runner-id runner-10.142.0.1 --availability-zone zone-1a</pre>

</li>
<li class="listitem">
<p>Add eight more hosts to the installation and specify a runner ID, availability zone, and the required token, so that you end up with three hosts in each of the availability zones:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Add two more hosts to different availability-zones, here <code class="literal">zone-1b</code> and <code class="literal">zone-1c</code>, include the required token, and assign them the <code class="literal">director</code> and <code class="literal">coordinator</code> roles (run one of these commands on each host; requires a <a class="xref" href="ece-generate-roles-token.html" title="Generate roles tokens">generated roles token</a> with the correct permissions):</p>
<pre class="literallayout">bash elastic-cloud-enterprise.sh install --runner-id runner-10.142.0.2 --coordinator-host 10.142.0.4 --availability-zone zone-1b --roles-token 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiI2ZDE2ZDY3YS01NGUzLTQ0MzMtYTlmZC05MTJjYzQwZmIxYmQiLCJyb2xlcyI6W10sImlzcyI6ImN1cnJlbnQiLCJwZXJzaXN0ZW50Ijp0cnVlfQ.MGEpEj0JmUGuucazf55sURNX-Q6QIMhKP0gdNJ2-vnk' --roles "director,coordinator"</pre>

<pre class="literallayout">bash elastic-cloud-enterprise.sh install --runner-id runner-10.142.0.3 --coordinator-host 10.142.0.4 --availability-zone zone-1c --roles-token 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiI2ZDE2ZDY3YS01NGUzLTQ0MzMtYTlmZC05MTJjYzQwZmIxYmQiLCJyb2xlcyI6W10sImlzcyI6ImN1cnJlbnQiLCJwZXJzaXN0ZW50Ijp0cnVlfQ.MGEpEj0JmUGuucazf55sURNX-Q6QIMhKP0gdNJ2-vnk' --roles "director,coordinator"</pre>

</li>
<li class="listitem">
<p>Add three to six more hosts spread across the availability-zones to handle the Elasticsearch and Kibana workload, include the required token, and assign them the <code class="literal">allocator</code> role (run one of these commands on each host):</p>
<pre class="literallayout">bash elastic-cloud-enterprise.sh install --runner-id runner-10.142.0.4 --coordinator-host 10.142.0.4 --availability-zone zone-1a --roles-token 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiI2ZDE2ZDY3YS01NGUzLTQ0MzMtYTlmZC05MTJjYzQwZmIxYmQiLCJyb2xlcyI6W10sImlzcyI6ImN1cnJlbnQiLCJwZXJzaXN0ZW50Ijp0cnVlfQ.MGEpEj0JmUGuucazf55sURNX-Q6QIMhKP0gdNJ2-vnk' --roles "allocator"</pre>

<pre class="literallayout">bash elastic-cloud-enterprise.sh install --runner-id runner-10.142.0.5 --coordinator-host 10.142.0.4 --availability-zone zone-1b --roles-token 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiI2ZDE2ZDY3YS01NGUzLTQ0MzMtYTlmZC05MTJjYzQwZmIxYmQiLCJyb2xlcyI6W10sImlzcyI6ImN1cnJlbnQiLCJwZXJzaXN0ZW50Ijp0cnVlfQ.MGEpEj0JmUGuucazf55sURNX-Q6QIMhKP0gdNJ2-vnk' --roles "allocator"</pre>

<pre class="literallayout">bash elastic-cloud-enterprise.sh install --runner-id runner-10.142.0.6 --coordinator-host 10.142.0.4 --availability-zone zone-1c --roles-token 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiI2ZDE2ZDY3YS01NGUzLTQ0MzMtYTlmZC05MTJjYzQwZmIxYmQiLCJyb2xlcyI6W10sImlzcyI6ImN1cnJlbnQiLCJwZXJzaXN0ZW50Ijp0cnVlfQ.MGEpEj0JmUGuucazf55sURNX-Q6QIMhKP0gdNJ2-vnk' --roles "allocator"</pre>

</li>
<li class="listitem">
<p>Add three more hosts spread across the availability-zones to handle the routing of user requests, include the required token, and assign them the <code class="literal">proxy</code> role (run one of these commands on each host; requires a <a class="xref" href="ece-generate-roles-token.html" title="Generate roles tokens">generated roles token</a> with the correct permissions):</p>
<pre class="literallayout">bash elastic-cloud-enterprise.sh install --runner-id runner-10.142.0.7 --coordinator-host 10.142.0.4 --availability-zone zone-1a --roles-token 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiI2ZDE2ZDY3YS01NGUzLTQ0MzMtYTlmZC05MTJjYzQwZmIxYmQiLCJyb2xlcyI6W10sImlzcyI6ImN1cnJlbnQiLCJwZXJzaXN0ZW50Ijp0cnVlfQ.MGEpEj0JmUGuucazf55sURNX-Q6QIMhKP0gdNJ2-vnk' --roles "proxy"</pre>

<pre class="literallayout">bash elastic-cloud-enterprise.sh install --runner-id runner-10.142.0.8 --coordinator-host 10.142.0.4 --availability-zone zone-1b --roles-token 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiI2ZDE2ZDY3YS01NGUzLTQ0MzMtYTlmZC05MTJjYzQwZmIxYmQiLCJyb2xlcyI6W10sImlzcyI6ImN1cnJlbnQiLCJwZXJzaXN0ZW50Ijp0cnVlfQ.MGEpEj0JmUGuucazf55sURNX-Q6QIMhKP0gdNJ2-vnk' --roles "proxy"</pre>

<pre class="literallayout">bash elastic-cloud-enterprise.sh install --runner-id runner-10.142.0.9 --coordinator-host 10.142.0.4 --availability-zone zone-1c --roles-token 'eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiI2ZDE2ZDY3YS01NGUzLTQ0MzMtYTlmZC05MTJjYzQwZmIxYmQiLCJyb2xlcyI6W10sImlzcyI6ImN1cnJlbnQiLCJwZXJzaXN0ZW50Ijp0cnVlfQ.MGEpEj0JmUGuucazf55sURNX-Q6QIMhKP0gdNJ2-vnk' --roles "proxy"</pre>

</li>
</ol>
</div>
</li>
<li class="listitem">
If you are using these examples to create your own version of the playbook, some roles need to be removed from the first host that you installed on. To learn more, see <a class="xref" href="ece-install-large-cloud.html" title="Deploy a large installation">Deploy a large installation</a>.
</li>
</ol>
</div>
<p>Specify a custom JVM heap size of 1 GB for the <code class="literal">admin-console</code> service and 512 MB for the <code class="literal">proxy</code> service when you install Elastic Cloud Enterprise on the first host:</p>
<pre class="literallayout">bash elastic-cloud-enterprise.sh install  --memory-settings '{"admin-console":{"xmx":"1024M","xms":"1024M"}'</pre>

<p>Specify custom JVM settings that assign 80% of memory to the <code class="literal">admin-console</code> service and set heap size to 512 MB for the <code class="literal">proxy</code> service when you install Elastic Cloud Enterprise on the first host.</p>
<pre class="literallayout">bash elastic-cloud-enterprise.sh install --memory-settings '{"admin-console":{"percentage":"80"}'</pre>

</div>
<div class="navfooter">
<span class="prev">
<a href="ece-script-reference.html">« Script reference</a>
</span>
<span class="next">
<a href="ece-installation-script-upgrade.html"><code class="literal">elastic-cloud-enterprise.sh upgrade</code> »</a>
</span>
</div>
</div>
</body>
</html>
