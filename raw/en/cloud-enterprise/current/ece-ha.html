<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>High availability | Elastic Cloud Enterprise Reference [3.7] | Elastic</title>
<meta class="elastic" name="content" content="High availability | Elastic Cloud Enterprise Reference [3.7]">

<link rel="home" href="index.html" title="Elastic Cloud Enterprise Reference [3.7]"/>
<link rel="up" href="ece-prereqs.html" title="Preparing your installation"/>
<link rel="prev" href="ece-networking-prereq.html" title="Networking prerequisites"/>
<link rel="next" href="ece-roles.html" title="Separation of roles"/>
<meta class="elastic" name="product_version" content="3.7"/>
<meta class="elastic" name="product_name" content="ECE"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/CloudEnterprise/Reference/3.7"/>
<meta name="DC.subject" content="ECE"/>
<meta name="DC.identifier" content="3.7"/>
</head>
<body>
<div class="navheader">
<span class="prev">
<a href="ece-networking-prereq.html">« Networking prerequisites</a>
</span>
<span class="next">
<a href="ece-roles.html">Separation of roles »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Cloud Enterprise Reference [3.7]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="ece-prereqs.html">Preparing your installation</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>High availability</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-105/docs/cloud-enterprise/ce-high-availability.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="chapter">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="ece-ha"></a>High availability</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-105/docs/cloud-enterprise/ce-high-availability.asciidoc">edit</a></div>
</div></div></div>
<div class="position-relative"><h3><a id="ece-ece-ha-1-az"></a>Availability zones</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-105/docs/cloud-enterprise/ce-high-availability.asciidoc">edit</a></div>
<p>Fault tolerance for Elastic Cloud Enterprise is based around the concept of <em>availability zones</em>.</p>
<p>An availability zone contains resources available to an Elastic Cloud Enterprise installation that are isolated from other availability zones to safeguard against potential failure.</p>
<p>Planning for a fault-tolerant installation with multiple availability zones means avoiding any single point of failure that could bring down Elastic Cloud Enterprise.</p>
<p>The main difference between Elastic Cloud Enterprise installations that include two or three availability zones is that three availability zones enable Elastic Cloud Enterprise to create clusters with a <em>tiebreaker</em>. If you have only two availability zones in total in your installation, no tiebreaker is created.</p>
<p>We recommend that for each deployment you use at least two availability zones for production and three for mission-critical systems. Using more than three availability zones for a deployment is not required nor supported. Availability zones are intended for high availability, not scalability.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>Elasticsearch clusters that are set up to use only one availability zone are not <a href="/guide/en/elasticsearch/reference/8.17/high-availability-cluster-design.html" class="ulink" target="_top">highly available</a> and are at risk of data loss. To safeguard against data loss, you must use at least two Elastic Cloud Enterprise availability zones.</p>
</div>
</div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>Increasing the number of zones should not be used to add more resources. The concept of zones is meant for High Availability (2 zones) and Fault Tolerance (3 zones), but neither will work if the cluster relies on the resources from those zones to be operational. The recommendation is to scale up the resources within a single zone until the cluster can take the full load (add some buffer to be prepared for a peak of requests), then scale out by adding additional zones depending on your requirements: 2 zones for High Availability, 3 zones for Fault Tolerance.</p>
</div>
</div>
<div class="position-relative"><h3><a id="ece-ece-ha-2-master-nodes"></a>Master nodes</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-105/docs/cloud-enterprise/ce-high-availability.asciidoc">edit</a></div>
<p><a id="ece-ha-tiebreaker"></a>Tiebreakers are used in distributed clusters to avoid cases of <a href="https://en.wikipedia.org/wiki/Split-brain_(computing)" class="ulink" target="_top">split brain</a>, where an Elasticsearch cluster splits into multiple, autonomous parts that continue to handle requests independently of each other, at the risk of affecting cluster consistency and data loss. A split-brain scenario is avoided by making sure that a minimum number of <a href="/guide/en/elasticsearch/reference/8.17/modules-node.html#master-node" class="ulink" target="_top">master-eligible nodes</a> must be present in order for any part of the cluster to elect a master node and accept user requests. To prevent multiple parts of a cluster from being eligible, there must be a <a href="/guide/en/elasticsearch/reference/8.17/modules-discovery-quorums.html" class="ulink" target="_top">quorum-based majority</a> of <code class="literal">(n/2)+1</code> nodes, where <code class="literal">n</code> is the number of master-eligible nodes in the cluster. The minimum number of master nodes to reach quorum in a two-node cluster is the same as for a three-node cluster: two nodes must be available.</p>
<p>When you create a cluster with nodes in two availability zones when a third zone is available, Elastic Cloud Enterprise can create a tiebreaker in the third availability zone to help establish quorum in case of loss of an availability zone. The extra tiebreaker node that helps to provide quorum does not have to be a full-fledged and expensive node, as it does not hold data. For example: By tagging allocators hosts in Elastic Cloud Enterprise, can you create a cluster with eight nodes each in zones <code class="literal">ece-1a</code> and <code class="literal">ece-1b</code>, for a total of 16 nodes, and one tiebreaker node in zone <code class="literal">ece-1c</code>. This cluster can lose any of the three availability zones whilst maintaining quorum, which means that the cluster can continue to process user requests, provided that there is sufficient capacity available when an availability zone goes down.</p>
<p>By default, each node in an Elasticsearch cluster is a master-eligible node and a data node. In larger clusters, such as production clusters, it&#8217;s a good practice to split the roles, so that master nodes are not handling search or indexing work. When you create a cluster, you can specify to use dedicated <a href="/guide/en/elasticsearch/reference/8.17/modules-node.html#master-node" class="ulink" target="_top">master-eligible nodes</a>, one per availability zone.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>Clusters that only have two or fewer master-eligible node are not <a href="/guide/en/elasticsearch/reference/8.17/high-availability-cluster-design.html" class="ulink" target="_top">highly available</a> and are at risk of data loss. You must have <a href="/guide/en/elasticsearch/reference/8.17/modules-discovery-quorums.html" class="ulink" target="_top">at least three master-eligible nodes</a>.</p>
</div>
</div>
<div class="position-relative"><h3><a id="ece-ece-ha-3-replica-shards"></a>Replica shards</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-105/docs/cloud-enterprise/ce-high-availability.asciidoc">edit</a></div>
<p>With multiple Elasticsearch nodes in multiple availability zones you have the recommended hardware, the next thing to consider is having the recommended
index replication. Each index, with the exception of searchable snapshot indexes, should have one or more replicas. Use the index settings API to find any indices with no replica:</p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">GET _all/_settings/index.number_of_replicas</pre>
</div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>Indices with no replica, except for <a href="/guide/en/elasticsearch/reference/8.17/searchable-snapshots.html" class="ulink" target="_top">searchable snapshot indices</a>, are not highly available. You should use replicas to mitigate against possible data loss.</p>
</div>
</div>
<div class="position-relative"><h3><a id="ece-ece-ha-4-snapshot"></a>Snapshot backups</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-105/docs/cloud-enterprise/ce-high-availability.asciidoc">edit</a></div>
<p>You should configure and use <a href="/guide/en/elasticsearch/reference/8.17/snapshot-restore.html" class="ulink" target="_top">Elasticsearch snapshots</a>. Snapshots provide a way to backup and restore your Elasticsearch indices. They can be used to copy indices for testing, to recover from failures or accidental deletions, or to migrate data to other deployments. We recommend configuring an <a class="xref" href="ece-manage-repositories.html" title="Manage snapshot repositories">Elastic Cloud Enterprise-level repository</a> to apply across all deployments. See <a class="xref" href="ece-snapshots.html" title="Work with snapshots">Work with snapshots</a> for more guidance.</p>
<div class="position-relative"><h3><a id="ece-ece-ha-5-other"></a>Furthermore considerations</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-105/docs/cloud-enterprise/ce-high-availability.asciidoc">edit</a></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Make sure you have three Zookeepers - by default, on the Director host - for your ECE installation. Similar to three Elasticsearch master nodes can form a quorum, three Zookeepers can forum the quorum for high availability purposes. Backing up Zookeeper data directory is also recommended, read <a class="xref" href="ece-troubleshooting-zookeeper-quorum.html" title="Rebuilding a broken Zookeeper quorum">this doc</a> for more guidance.
</li>
<li class="listitem">
Make sure that if you&#8217;re using a <a class="xref" href="ece-install-offline-with-registry.html" title="With your private Docker registry">private Docker registry server</a> or are using any <a class="xref" href="ece-add-custom-bundle-plugin.html" title="Add custom bundles and plugins to your deployment">custom bundles and plugins</a> hosted on a web server, that these are available to all ECE allocators, so that they can continue to be accessed in the event of a network partition or zone outage.
</li>
<li class="listitem">
Don&#8217;t delete containers unless guided by Elastic Support or there&#8217;s public documentation explicitly describing this as required action. Otherwise, it can cause issues and you may lose access or functionality of your Elastic Cloud Enterprise platform. See <a class="xref" href="ece-troubleshooting-containers.html" title="Troubleshooting container engines">Troubleshooting container engines</a> for more information.
</li>
</ul>
</div>
<p>If in doubt, please <a class="xref" href="ece-getting-help.html" title="Ask for help">contact support for help</a>.</p>
</div>
</div>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { equationNumbers: { autoNumber: "none" } }
})
MathJax.Hub.Register.StartupHook("AsciiMath Jax Ready", function () {
  MathJax.InputJax.AsciiMath.postfilterHooks.Add(function (data, node) {
    if ((node = data.script.parentNode) && (node = node.parentNode) && node.classList.contains('stemblock')) {
      data.math.root.display = "block"
    }
    return data
  })
})
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>
</div><div class="navfooter">
<span class="prev">
<a href="ece-networking-prereq.html">« Networking prerequisites</a>
</span>
<span class="next">
<a href="ece-roles.html">Separation of roles »</a>
</span>
</div>
</body>
</html>
