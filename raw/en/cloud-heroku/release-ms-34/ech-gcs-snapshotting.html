<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Configure a snapshot repository using GCS | Elasticsearch Add-On for Heroku Documentation | Elastic</title>
<link rel="home" href="index.html" title="Elasticsearch Add-On for Heroku Documentation"/>
<link rel="up" href="ech-custom-repository.html" title="Snapshot and restore with custom repositories"/>
<link rel="prev" href="ech-aws-custom-repository.html" title="Configure a snapshot repository using AWS"/>
<link rel="next" href="ech-billing.html" title="Your account and billing"/>
<meta name="DC.type" content="Learn/Docs/Cloud-Heroku/Reference"/>
<meta name="DC.subject" content="Elasticsearch Add-On for Heroku"/>
<meta name="DC.identifier" content="release-ms-34"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Elasticsearch Add-On for Heroku Documentation</a></span>
»
<span class="breadcrumb-link"><a href="ech-snapshot-restore.html">Snapshot and restore</a></span>
»
<span class="breadcrumb-link"><a href="ech-custom-repository.html">Snapshot and restore with custom repositories</a></span>
»
<span class="breadcrumb-node">Configure a snapshot repository using GCS</span>
</div>
<div class="navheader">
<span class="prev">
<a href="ech-aws-custom-repository.html">« Configure a snapshot repository using AWS</a>
</span>
<span class="next">
<a href="ech-billing.html">Your account and billing »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="ech-gcs-snapshotting"></a>Configure a snapshot repository using GCS</h2>
</div></div></div>
<p>To configure a custom repository using your GCS account, create the bucket with your custom GCS account. Make sure the bucket is in the same region as your cluster.</p>
<h4><a id="ech-configure-gcs-keystore"></a>Configure the keystore</h4>
<p>Create an entry for the GCS client in the Elasticsearch keystore:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Log in to the <a href="https://cloud.elastic.co/" class="ulink" target="_top">Elasticsearch Add-On for Heroku console</a>.
</li>
<li class="listitem">
Create a deployment with an Elasticsearch cluster that has the <code class="literal">repository-gcs</code> plugin enabled.
</li>
<li class="listitem">
From your deployment menu, go to the <span class="strong strong"><strong>Security</strong></span> page, then click <span class="strong strong"><strong>Create settings</strong></span> to create an Elasticsearch keystore entry.
</li>
<li class="listitem">
<p>Enter as <span class="strong strong"><strong>Setting name</strong></span> <code class="literal">gcs.client.default.credentials_file</code>, click <span class="strong strong"><strong>JSON block / file</strong></span> and specify the options.</p>
<p>For more information on how to get the JSON account service key, see <a href="/guide/en/elasticsearch/plugins/7.5/repository-gcs-usage.html#repository-gcs-using-service-account" class="ulink" target="_top">Using a Service Account</a>.</p>
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Save</strong></span>.
</li>
</ol>
</div>
<h4><a id="ech-create-gcs-repository"></a>Create the repository</h4>
<p>With the bucket ready, you can create a repository by <code class="literal">PUT</code>-ing the following to <code class="literal">/_snapshot/repository_name</code>:</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
  "type": "gcs",
  "settings": {
    "bucket": "name-of-bucket",
    "region": "region-of-bucket-same-as-cluster",
    "access_key": "YOURKEYHERE",
    "secret_key": "secret-key-with-just-permission-to-that-bucket-do-not-use-a-master-key",
    "compress": true
  }
}</pre>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="ech-aws-custom-repository.html">« Configure a snapshot repository using AWS</a>
</span>
<span class="next">
<a href="ech-billing.html">Your account and billing »</a>
</span>
</div>
</div>
</body>
</html>
