<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Configuration | Elastic Cloud on Kubernetes [2.12] | Elastic</title>
<meta class="elastic" name="content" content="Configuration | Elastic Cloud on Kubernetes [2.12]">

<link rel="home" href="index.html" title="Elastic Cloud on Kubernetes [2.12]"/>
<link rel="up" href="k8s-elastic-agent.html" title="Run standalone Elastic Agent on ECK"/>
<link rel="prev" href="k8s-elastic-agent-quickstart.html" title="Quickstart"/>
<link rel="next" href="k8s-elastic-agent-configuration-examples.html" title="Configuration examples"/>
<meta class="elastic" name="product_version" content="2.12"/>
<meta class="elastic" name="product_name" content="ECK"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Kubernetes/Reference/2.12"/>
<meta name="DC.subject" content="ECK"/>
<meta name="DC.identifier" content="2.12"/>
</head>
<body>
<div class="page_header">
A newer version is available. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div class="navheader">
<span class="prev">
<a href="k8s-elastic-agent-quickstart.html">« Quickstart</a>
</span>
<span class="next">
<a href="k8s-elastic-agent-configuration-examples.html">Configuration examples »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Cloud on Kubernetes [2.12]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="k8s-orchestrating-elastic-stack-applications.html">Orchestrating Elastic Stack applications</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="k8s-elastic-agent.html">Run standalone Elastic Agent on ECK</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Configuration</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/cloud-on-k8s/edit/2.12/docs/orchestrating-elastic-stack-applications/agent-standalone.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="k8s-elastic-agent-configuration"></a>Configuration<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/cloud-on-k8s/edit/2.12/docs/orchestrating-elastic-stack-applications/agent-standalone.asciidoc">edit</a></h2>
</div></div></div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="k8s-elastic-agent-upgrade-specification"></a>Upgrade the Elastic Agent specification<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/cloud-on-k8s/edit/2.12/docs/orchestrating-elastic-stack-applications/agent-standalone.asciidoc">edit</a></h3>
</div></div></div>
<p>You can upgrade the Elastic Agent version or change settings by editing the YAML specification. ECK applies the changes by performing a rolling restart of the Agent&#8217;s Pods. Depending on the settings that you used, ECK will set the <a class="xref" href="k8s-elastic-agent-configuration.html#k8s-elastic-agent-set-output" title="Set manually Elastic Agent outputs">outputs</a> part of the configuration, or restart Elastic Agent on certificate rollover.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="k8s-elastic-agent-custom-configuration"></a>Customize the Elastic Agent configuration<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/cloud-on-k8s/edit/2.12/docs/orchestrating-elastic-stack-applications/agent-standalone.asciidoc">edit</a></h3>
</div></div></div>
<p>The Elastic Agent configuration is defined in the <code class="literal">config</code> element:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">apiVersion: agent.k8s.elastic.co/v1alpha1
kind: Agent
metadata:
  name: quickstart
spec:
  version: 8.14.2
  elasticsearchRefs:
  - name: quickstart
  daemonSet:
    podTemplate:
      spec:
        securityContext:
          runAsUser: 0 <a id="CO17-1"></a><i class="conum" data-value="1"></i>
  config:
    inputs:
      - name: system-1
        revision: 1
        type: system/metrics
        use_output: default
        meta:
          package:
            name: system
            version: 0.9.1
        data_stream:
          namespace: default
        streams:
          - id: system/metrics-system.cpu
            data_stream:
              dataset: system.cpu
              type: metrics
            metricsets:
              - cpu
            cpu.metrics:
              - percentages
              - normalized_percentages
            period: 10s</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO17-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>The root user is required to persist state in a <code class="literal">hostPath</code> volume. See <a class="xref" href="k8s-elastic-agent-configuration-examples.html#k8s_storing_local_state_in_host_path_volume" title="Storing local state in host path volume">Storing local state in host path volume</a> for options to not run the Agent container as root.</p>
</td>
</tr>
</table>
</div>
<p>Alternatively, it can be provided through a Secret specified in the <code class="literal">configRef</code> element. The Secret must have an <code class="literal">agent.yml</code> entry with this configuration:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">apiVersion: agent.k8s.elastic.co/v1alpha1
kind: Agent
metadata:
  name: quickstart
spec:
  version: 8.14.2
  elasticsearchRefs:
  - name: quickstart
  daemonSet:
    podTemplate:
      spec:
        securityContext:
          runAsUser: 0
  configRef:
    secretName: system-cpu-config
---
apiVersion: v1
kind: Secret
metadata:
  name: system-cpu-config
stringData:
  agent.yml: |-
    inputs:
      - name: system-1
        revision: 1
        type: system/metrics
        use_output: default
        meta:
          package:
            name: system
            version: 0.9.1
        data_stream:
          namespace: default
        streams:
          - id: system/metrics-system.cpu
            data_stream:
              dataset: system.cpu
              type: metrics
            metricsets:
              - cpu
            cpu.metrics:
              - percentages
              - normalized_percentages
            period: 10s</pre>
</div>
<p>You can use the Fleet application in Kibana to generate the configuration for Elastic Agent, even when running in standalone mode. Check the <a href="/guide/en/fleet/current/install-standalone-elastic-agent.html" class="ulink" target="_top">Elastic Agent standalone</a> documentation. Adding the corresponding integration package to Kibana also adds the related dashboards and visualizations.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="k8s-elastic-agent-multi-output"></a>Use multiple Elastic Agent outputs<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/cloud-on-k8s/edit/2.12/docs/orchestrating-elastic-stack-applications/agent-standalone.asciidoc">edit</a></h3>
</div></div></div>
<p>Elastic Agent supports the use of multiple outputs. Therefore, the <code class="literal">elasticsearchRefs</code> element accepts multiple references to Elasticsearch clusters. ECK populates the outputs section of the Elastic Agent configuration based on those references. If you configure more than one output, you also have to specify a unique <code class="literal">outputName</code> attribute.</p>
<p>To send Elastic Agent&#8217;s internal monitoring and log data to a different Elasticsearch cluster called <code class="literal">agent-monitoring</code> in the <code class="literal">elastic-monitoring</code> namespace, and the harvested metrics to our <code class="literal">quickstart</code> cluster, you have to define two <code class="literal">elasticsearchRefs</code> as shown in the following example:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">apiVersion: agent.k8s.elastic.co/v1alpha1
kind: Agent
metadata:
  name: quickstart
spec:
  version: 8.14.2
  daemonSet:
    podTemplate:
      spec:
        securityContext:
          runAsUser: 0
  elasticsearchRefs:
  - name: quickstart
    outputName: default
  - name: agent-monitoring
    namespace: elastic-monitoring
    outputName: monitoring
  config:
    agent:
      monitoring:
        enabled: true
        use_output: monitoring
        logs: true
        metrics: true
    inputs:
      - name: system-1
        revision: 1
        type: system/metrics
        use_output: default
...</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="k8s-elastic-agent-connect-es"></a>Customize the connection to an Elasticsearch cluster<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/cloud-on-k8s/edit/2.12/docs/orchestrating-elastic-stack-applications/agent-standalone.asciidoc">edit</a></h3>
</div></div></div>
<p>The <code class="literal">elasticsearchRefs</code> element allows ECK to automatically configure Elastic Agent to establish a secured connection to one or more managed Elasticsearch clusters. By default, it targets all nodes in your cluster. If you want to direct traffic to specific nodes of your Elasticsearch cluster, refer to <a class="xref" href="k8s-traffic-splitting.html" title="Traffic Splitting"><em>Traffic Splitting</em></a> for more information and examples.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="k8s-elastic-agent-set-output"></a>Set manually Elastic Agent outputs<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/cloud-on-k8s/edit/2.12/docs/orchestrating-elastic-stack-applications/agent-standalone.asciidoc">edit</a></h3>
</div></div></div>
<p>If the <code class="literal">elasticsearchRefs</code> element is specified, ECK populates the outputs section of the Elastic Agent configuration. ECK creates a user with appropriate roles and permissions and uses its credentials. If required, it also mounts the CA certificate in all Agent Pods, and recreates Pods when this certificate changes.</p>
<p>The outputs can also be set manually. To do that, remove the <code class="literal">elasticsearchRefs</code> element from the specification and include an appropriate output configuration in the <code class="literal">config</code>, or indirectly through the <code class="literal">configRef</code> mechanism.</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">apiVersion: agent.k8s.elastic.co/v1alpha1
kind: Agent
metadata:
  name: quickstart
spec:
  version: 8.14.2
  daemonSet:
    podTemplate:
      spec:
        securityContext:
          runAsUser: 0
  config:
    outputs:
      default:
        type: elasticsearch
        hosts:
          - "https://my-custom-elasticsearch-cluster.cloud.elastic.co:9243"
        password: ES_PASSWORD
        username: ES_USER
...</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="k8s-elastic-agent-chose-the-deployment-model"></a>Choose the deployment model<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/cloud-on-k8s/edit/2.12/docs/orchestrating-elastic-stack-applications/agent-standalone.asciidoc">edit</a></h3>
</div></div></div>
<p>Depending on the use case, Elastic Agent may need to be deployed as a <a href="https://kubernetes.io/docs/concepts/workloads/controllers/deployment/" class="ulink" target="_top">Deployment</a>, a <a href="https://kubernetes.io/docs/concepts/workloads/controllers/daemonset/" class="ulink" target="_top">DaemonSet</a>, or a <a href="https://kubernetes.io/docs/concepts/workloads/controllers/statefulSet/" class="ulink" target="_top">StatefulSet</a>. Provide a <code class="literal">podTemplate</code> element under either the <code class="literal">deployment</code> or the <code class="literal">daemonSet</code> element in the specification to choose how your Elastic Agents should be deployed. When choosing the <code class="literal">deployment</code> option you can additionally specify the <a href="https://kubernetes.io/docs/concepts/workloads/controllers/deployment/#strategy" class="ulink" target="_top">strategy</a> used to replace old Pods with new ones.</p>
<p>Similarly, you can set the <a href="https://kubernetes.io/docs/tasks/manage-daemon/update-daemon-set/" class="ulink" target="_top">update strategy</a> when deploying as a DaemonSet. This allows you to control the rollout speed for new configuration by modifying the <code class="literal">maxUnavailable</code> setting:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">apiVersion: agent.k8s.elastic.co/v1alpha1
kind: Agent
metadata:
  name: quickstart
spec:
  version: 8.14.2
  daemonSet:
    podTemplate:
      spec:
        securityContext:
          runAsUser: 0
    strategy:
      type: RollingUpdate
      rollingUpdate:
        maxUnavailable: 3
...</pre>
</div>
<p>Check <a class="xref" href="k8s-managing-compute-resources.html#k8s-compute-resources-beats-agent" title="Set compute resources for Beats and Elastic Agent">Set compute resources for Beats and Elastic Agent</a> for more information on how to use the Pod template to adjust the resources given to Elastic Agent.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="k8s-elastic-agent-role-based-access-control"></a>Role Based Access Control for Elastic Agent<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/cloud-on-k8s/edit/2.12/docs/orchestrating-elastic-stack-applications/agent-standalone.asciidoc">edit</a></h3>
</div></div></div>
<p>Some Elastic Agent features, such as the <a href="https://epr.elastic.co/package/kubernetes/0.2.8/" class="ulink" target="_top">Kubernetes integration</a>, require that Agent Pods interact with Kubernetes APIs. This functionality requires specific permissions. The standard Kubernetes <a href="https://kubernetes.io/docs/reference/access-authn-authz/rbac/" class="ulink" target="_top">RBAC</a> rules apply. For example, to allow API interactions:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">apiVersion: agent.k8s.elastic.co/v1alpha1
kind: Agent
metadata:
  name: elastic-agent
spec:
  version: 8.14.2
  elasticsearchRefs:
  - name: elasticsearch
  daemonSet:
    podTemplate:
      spec:
        automountServiceAccountToken: true
        serviceAccountName: elastic-agent
        securityContext:
          runAsUser: 0
...
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRole
metadata:
  name: elastic-agent
rules:
- apiGroups: [""] # "" indicates the core API group
  resources:
  - namespaces
  - pods
  - nodes
  - nodes/metrics
  - nodes/proxy
  - nodes/stats
  - events
  verbs:
  - get
  - watch
  - list
- nonResourceURLs:
  - /metrics
  verbs:
  - get
  - watch
  - list
---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: elastic-agent
  namespace: default
---
apiVersion: rbac.authorization.k8s.io/v1
kind: ClusterRoleBinding
metadata:
  name: elastic-agent
subjects:
- kind: ServiceAccount
  name: elastic-agent
  namespace: default
roleRef:
  kind: ClusterRole
  name: elastic-agent
  apiGroup: rbac.authorization.k8s.io</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="k8s-elastic-agent-deploying-in-secured-clusters"></a>Deploying Elastic Agent in secured clusters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/cloud-on-k8s/edit/2.12/docs/orchestrating-elastic-stack-applications/agent-standalone.asciidoc">edit</a></h3>
</div></div></div>
<p>To deploy Elastic Agent in clusters with the Pod Security Policy admission controller enabled, or in <a class="xref" href="k8s-openshift-agent.html" title="Grant host access permission to Elastic Agent">OpenShift</a> clusters, you might need to grant additional permissions to the Service Account used by the Elastic Agent Pods. Those Service Accounts must be bound to a Role or ClusterRole that has <code class="literal">use</code> permission for the required Pod Security Policy or Security Context Constraints. Different Elastic Agent integrations might require different settings set in their PSP/<a href="k8s-openshift-agent.html" class="ulink" target="_top">SCC</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="k8s_running_as_a_non_root_user"></a>Running as a non-root user<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/cloud-on-k8s/edit/2.12/docs/orchestrating-elastic-stack-applications/agent-fleet.asciidoc">edit</a></h3>
</div></div></div>
<p>In order to run Elastic Agent as a non-root user you must choose how you want to persist data to the Agent&#8217;s volume.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Run Elastic Agent with an <code class="literal">emptyDir</code> volume. This has the downside of not persisting data between restarts of the Elastic Agent which can duplicate work done by the previous running Agent.
</li>
<li class="listitem">
Run Elastic Agent with a <code class="literal">hostPath</code> volume in addition to a <code class="literal">DaemonSet</code> running as <code class="literal">root</code> that sets up permissions for the <code class="literal">agent</code> user.
</li>
</ol>
</div>
<p>In addition to these decisions, if you are running Elastic Agent in Fleet mode as a non-root user, you must configure <code class="literal">certificate_authorities.ssl</code> in each <code class="literal">xpack.fleet.outputs</code> to trust the CA of the Elasticsearch Cluster.</p>
<p>To run Elastic Agent with an <code class="literal">emptyDir</code> volume.</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">apiVersion: agent.k8s.elastic.co/v1alpha1
kind: Agent
metadata:
  name: fleet-server
spec:
  deployment:
    podTemplate:
      spec:
        securityContext: <a id="CO18-1"></a><i class="conum" data-value="1"></i>
          fsGroup: 1000
        volumes:
        - name: agent-data
          emptyDir: {}
...</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO18-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Gid 1000 is the default group at which the Agent container runs. Adjust as necessary if <code class="literal">runAsGroup</code> has been modified.</p>
</td>
</tr>
</table>
</div>
<p>To run Elastic Agent with a <code class="literal">hostPath</code> volume and a <code class="literal">DaemonSet</code> to maintain permissions.</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">apiVersion: agent.k8s.elastic.co/v1alpha1
kind: Agent
metadata:
  name: fleet-server-sample
  namespace: elastic-apps
spec:
  mode: fleet
  fleetServerEnabled: true
  deployment: {}
...
---
apiVersion: agent.k8s.elastic.co/v1alpha1
kind: Agent
metadata:
  name: elastic-agent-sample
  namespace: elastic-apps
spec:
  daemonSet: {}
...
---
apiVersion: apps/v1
kind: DaemonSet
metadata:
  name: manage-agent-hostpath-permissions
  namespace: elastic-apps
spec:
  selector:
    matchLabels:
      name: manage-agent-hostpath-permissions
  template:
    metadata:
      labels:
        name: manage-agent-hostpath-permissions
    spec:
      # serviceAccountName: elastic-agent <a id="CO19-1"></a><i class="conum" data-value="1"></i>
      volumes:
        - hostPath:
            path: /var/lib/elastic-agent
            type: DirectoryOrCreate
          name: "agent-data"
      initContainers:
        - name: manage-agent-hostpath-permissions
          # image: registry.access.redhat.com/ubi9/ubi-minimal:latest <a id="CO19-2"></a><i class="conum" data-value="2"></i>
          image: docker.io/bash:5.2.15
          resources:
            limits:
              cpu: 100m
              memory: 32Mi
          securityContext:
            # privileged: true <a id="CO19-3"></a><i class="conum" data-value="3"></i>
            runAsUser: 0
          volumeMounts:
            - mountPath: /var/lib/elastic-agent
              name: agent-data
          command:
          - 'bash'
          - '-e'
          - '-c'
          - |-
            # Adjust this with /var/lib/elastic-agent/YOUR-NAMESPACE/YOUR-AGENT-NAME/state
            # Multiple directories are supported for the fleet-server + agent use case.
            dirs=(
              "/var/lib/elastic-agent/default/elastic-agent/state"
              "/var/lib/elastic-agent/default/fleet-server/state"
              )
            for dir in ${dirs[@]}; do
              mkdir -p "${dir}"
              # chcon is only required when running an an SELinux-enabled/OpenShift environment.
              # chcon -Rt svirt_sandbox_file_t "${dir}"
              chmod g+rw "${dir}"
              # Gid 1000 is the default group at which the Agent container runs. Adjust as necessary if `runAsGroup` has been modified.
              chgrp 1000 "${dir}"
              if [ -n "$(ls -A ${dir} 2&gt;/dev/null)" ]
              then
                # Gid 1000 is the default group at which the Agent container runs. Adjust as necessary if `runAsGroup` has been modified.
                chgrp 1000 "${dir}"/*
                chmod g+rw "${dir}"/*
              fi
            done
      containers:
        - name: sleep
          image: gcr.io/google-containers/pause-amd64:3.2</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO19-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>This is only required when running in an SElinux-enabled/OpenShift environment. Ensure this user has been added to the privileged security context constraints (SCC) in the correct namespace. <code class="literal">oc adm policy add-scc-to-user privileged -z elastic-agent -n elastic-apps</code></p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO19-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>UBI is only required when needing the <code class="literal">chcon</code> binary when running in an SELinux-enabled/OpenShift environment. If that is not required then the following smaller image can be used instead: <code class="literal">docker.io/bash:5.2.15</code></p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO19-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>Privileged is only required when running in an SElinux-enabled/OpenShift environment.</p>
</td>
</tr>
</table>
</div>
<p>When running Agent in fleet mode as a non-root user Kibana must be configured in order to properly accept the CA of the Elasticsearch cluster.</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">---
apiVersion: kibana.k8s.elastic.co/v1
kind: Kibana
metadata:
  name: kibana-sample
spec:
  config:
    # xpack.fleet.agents.elasticsearch.hosts: <a id="CO20-1"></a><i class="conum" data-value="1"></i>
    xpack.fleet.agents.fleet_server.hosts: ["https://fleet-server-sample-agent-http.default.svc:8220"]
    xpack.fleet.outputs:
    - id: eck-fleet-agent-output-elasticsearch
      is_default: true
      name: eck-elasticsearch
      type: elasticsearch
      hosts:
      - "https://elasticsearch-sample-es-http.default.svc:9200" <a id="CO20-2"></a><i class="conum" data-value="2"></i>
      ssl:
        certificate_authorities: ["/mnt/elastic-internal/elasticsearch-association/default/elasticsearch-sample/certs/ca.crt"] <a id="CO20-3"></a><i class="conum" data-value="3"></i></pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO20-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>This entry must not exist when running agent in fleet mode as a non-root user.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO20-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>Note that the correct URL for Elasticsearch is <code class="literal">https://ELASTICSEARCH_NAME-es-http.YOUR-NAMESPACE.svc:9200</code></p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO20-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>Note that the correct path for Elasticsearch <code class="literal">certificate_authorities</code> is <code class="literal">/mnt/elastic-internal/elasticsearch-association/YOUR-NAMESPACE/ELASTICSEARCH-NAME/certs/ca.crt</code></p>
</td>
</tr>
</table>
</div>
</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="k8s-elastic-agent-quickstart.html">« Quickstart</a>
</span>
<span class="next">
<a href="k8s-elastic-agent-configuration-examples.html">Configuration examples »</a>
</span>
</div>
</body>
</html>
