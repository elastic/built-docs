<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Advanced configuration | Elastic Cloud on Kubernetes [2.12] | Elastic</title>
<meta class="elastic" name="content" content="Advanced configuration | Elastic Cloud on Kubernetes [2.12]">

<link rel="home" href="index.html" title="Elastic Cloud on Kubernetes [2.12]"/>
<link rel="up" href="k8s-logstash.html" title="Run Logstash on ECK"/>
<link rel="prev" href="k8s-logstash-update-strategy.html" title="Update Strategy"/>
<link rel="next" href="k8s-logstash-custom-plugins.html" title="Working with custom plugins"/>
<meta class="elastic" name="product_version" content="2.12"/>
<meta class="elastic" name="product_name" content="ECK"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Kubernetes/Reference/2.12"/>
<meta name="DC.subject" content="ECK"/>
<meta name="DC.identifier" content="2.12"/>
</head>
<body>
<div class="page_header">
A newer version is available. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div class="navheader">
<span class="prev">
<a href="k8s-logstash-update-strategy.html">« Update Strategy</a>
</span>
<span class="next">
<a href="k8s-logstash-custom-plugins.html">Working with custom plugins »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Cloud on Kubernetes [2.12]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="k8s-orchestrating-elastic-stack-applications.html">Orchestrating Elastic Stack applications</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="k8s-logstash.html">Run Logstash on ECK</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Advanced configuration</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/cloud-on-k8s/edit/2.12/docs/orchestrating-elastic-stack-applications/logstash.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="k8s-logstash-advanced-configuration"></a>Advanced configuration<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/cloud-on-k8s/edit/2.12/docs/orchestrating-elastic-stack-applications/logstash.asciidoc">edit</a></h2>
</div></div></div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in technical preview and may be changed or removed in a future release. Elastic will work to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="k8s-logstash-jvm-options"></a>Setting JVM options<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/cloud-on-k8s/edit/2.12/docs/orchestrating-elastic-stack-applications/logstash.asciidoc">edit</a></h3>
</div></div></div>
<p>You can change JVM settings by using the <code class="literal">LS_JAVA_OPTS</code> environment variable to override default settings in <code class="literal">jvm.options</code>. This approach ensures that expected settings from <code class="literal">jvm.options</code> are set, and only options that explicitly need to be overridden are.</p>
<p>To do, this, set the  <code class="literal">LS_JAVA_OPTS</code> environment variable in the container definition of your Logstash resource:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">apiVersion: logstash.k8s.elastic.co/v1alpha1
kind: Logstash
metadata:
  name: quickstart
spec:
  podTemplate:
    spec:
      containers:
        - name: logstash
          env:
            - name: LS_JAVA_OPTS   <a id="CO33-1"></a><i class="conum" data-value="1"></i>
              value: "-Xmx2g -Xms2g"</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO33-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>This will change the maximum and minimum heap size of the JVM on each pod to 2GB</p>
</td>
</tr>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="k8s-logstash-keystore"></a>Setting keystore<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/cloud-on-k8s/edit/2.12/docs/orchestrating-elastic-stack-applications/logstash.asciidoc">edit</a></h3>
</div></div></div>
<p>You can specify sensitive settings with Kubernetes secrets. ECK automatically injects these settings into the keystore before it starts Logstash.
The ECK operator continues to watch the secrets for changes and will restart Logstash Pods when it detects a change.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>For the technical preview, the use of settings in the Logstash keystore may impact startup time for Logstash Pods. Startup time will increase linearly for each entry added to the keystore, and this could extend startup time significantly.</p>
</div>
</div>
<p>The Logstash Keystore can be password protected by setting an environment variable called <code class="literal">LOGSTASH_KEYSTORE_PASS</code>. Check out <a href="/guide/en/logstash/current/keystore.html#keystore-password" class="ulink" target="_top">Logstash Keystore</a> documentation for details.</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">apiVersion: v1
kind: Secret
metadata:
  name: logstash-keystore-pass
stringData:
  LOGSTASH_KEYSTORE_PASS: changed   <a id="CO34-1"></a><i class="conum" data-value="1"></i>
---
apiVersion: v1
kind: Secret
metadata:
  name: logstash-secure-settings
stringData:
  HELLO: Hallo
---
apiVersion: logstash.k8s.elastic.co/v1alpha1
kind: Logstash
metadata:
  name: logstash-sample
spec:
  version: 8.15.0
  count: 1
  pipelines:
    - pipeline.id: main
      config.string: |-
        input { exec { command =&gt; 'uptime' interval =&gt; 10 } }
        filter {
          if ("${HELLO:}" != "") {   <a id="CO34-2"></a><i class="conum" data-value="2"></i>
            mutate { add_tag =&gt; ["awesome"] }
          }
        }
  secureSettings:
    - secretName: logstash-secure-settings
  podTemplate:
    spec:
      containers:
        - name: logstash
          env:
            - name: LOGSTASH_KEYSTORE_PASS
              valueFrom:
                secretKeyRef:
                  name: logstash-keystore-pass
                  key: LOGSTASH_KEYSTORE_PASS</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO34-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Value of password to protect the Logstash keystore</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO34-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>The syntax for referencing keys is identical to the syntax for environment variables</p>
</td>
</tr>
</table>
</div>
</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="k8s-logstash-update-strategy.html">« Update Strategy</a>
</span>
<span class="next">
<a href="k8s-logstash-custom-plugins.html">Working with custom plugins »</a>
</span>
</div>
</body>
</html>
