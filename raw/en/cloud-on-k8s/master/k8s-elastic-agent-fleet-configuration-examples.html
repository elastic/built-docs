<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Configuration Examples | Elastic Cloud on Kubernetes [master] | Elastic</title>
<meta class="elastic" name="content" content="Configuration Examples | Elastic Cloud on Kubernetes [master]">

<link rel="home" href="index.html" title="Elastic Cloud on Kubernetes [master]"/>
<link rel="up" href="k8s-elastic-agent-fleet.html" title="Run Fleet-managed Elastic Agent on ECK"/>
<link rel="prev" href="k8s-elastic-agent-fleet-configuration.html" title="Configuration"/>
<link rel="next" href="k8s-elastic-agent-fleet-known-limitations.html" title="Known limitations"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="ECK"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Kubernetes/Reference/master"/>
<meta name="DC.subject" content="ECK"/>
<meta name="DC.identifier" content="master"/>
</head>
<body>
<div class="page_header">
This documentation contains work-in-progress information for future Elastic Stack and Cloud releases. Use the version selector to view supported release docs. It also contains some Elastic Cloud serverless information. Check out our <a href="https://www.elastic.co/docs/current/serverless">serverless docs</a> for more details.
</div>
<div class="navheader">
<span class="prev">
<a href="k8s-elastic-agent-fleet-configuration.html">« Configuration</a>
</span>
<span class="next">
<a href="k8s-elastic-agent-fleet-known-limitations.html">Known limitations »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Cloud on Kubernetes [master]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="k8s-orchestrating-elastic-stack-applications.html">Orchestrating Elastic Stack applications</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="k8s-elastic-agent-fleet.html">Run Fleet-managed Elastic Agent on ECK</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Configuration Examples</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/cloud-on-k8s/edit/main/docs/orchestrating-elastic-stack-applications/agent-fleet.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="k8s-elastic-agent-fleet-configuration-examples"></a>Configuration Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/cloud-on-k8s/edit/main/docs/orchestrating-elastic-stack-applications/agent-fleet.asciidoc">edit</a></h2>
</div></div></div>
<p>This section contains manifests that illustrate common use cases, and can be your starting point in exploring Elastic Agent deployed with ECK. These manifests are self-contained and work out-of-the-box on any non-secured Kubernetes cluster. They all contain a three-node Elasticsearch cluster, a single Kibana instance and a single Fleet Server instance.</p>
<div class="caution admon">
<div class="icon"></div>
<div class="admon_content">
<p>The examples in this section are for illustration purposes only and should not be considered to be production-ready. Some of these examples use the <code class="literal">node.store.allow_mmap: false</code> setting which has performance implications and should be tuned for production workloads, as described in <a class="xref" href="k8s-virtual-memory.html" title="Virtual memory">Virtual memory</a>.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="k8s_system_and_kubernetes_integrations"></a>System and Kubernetes integrations<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/cloud-on-k8s/edit/main/docs/orchestrating-elastic-stack-applications/agent-fleet.asciidoc">edit</a></h3>
</div></div></div>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">kubectl apply -f https://raw.githubusercontent.com/elastic/cloud-on-k8s/2.14/config/recipes/elastic-agent/fleet-kubernetes-integration.yaml</pre>
</div>
<p>Deploys Elastic Agent as a DaemonSet in Fleet mode with System and Kubernetes integrations enabled. System integration collects syslog logs, auth logs and system metrics (for CPU, I/O, filesystem, memory, network, process and others). Kubernetes integrations collects API server, Container, Event, Node, Pod, Volume and system metrics.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="k8s_system_and_kubernetes_integrations_running_as_non_root"></a>System and Kubernetes integrations running as non-root<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/cloud-on-k8s/edit/main/docs/orchestrating-elastic-stack-applications/agent-fleet.asciidoc">edit</a></h3>
</div></div></div>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">kubectl apply -f https://raw.githubusercontent.com/elastic/cloud-on-k8s/2.14/config/recipes/elastic-agent/fleet-kubernetes-integration-nonroot.yaml</pre>
</div>
<p>The provided example is functionally identical to the previous section but runs the Elastic Agent processes (both the Elastic Agent running as the Fleet server and the Elastic Agent connected to Fleet) as a non-root user by utilizing a DaemonSet to ensure directory and file permissions.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The DaemonSet itself must run as root to set up permissions and ECK &gt;= 2.10.0 is required.</p>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="k8s_custom_logs_integration_with_autodiscover"></a>Custom logs integration with autodiscover<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/cloud-on-k8s/edit/main/docs/orchestrating-elastic-stack-applications/agent-fleet.asciidoc">edit</a></h3>
</div></div></div>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">kubectl apply -f https://raw.githubusercontent.com/elastic/cloud-on-k8s/2.14/config/recipes/elastic-agent/fleet-custom-logs-integration.yaml</pre>
</div>
<p>Deploys Elastic Agent as a DaemonSet in Fleet mode with Custom Logs integration enabled. Collects logs from all Pods in the <code class="literal">default</code> namespace using autodiscover feature.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="k8s_apm_integration"></a>APM integration<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/cloud-on-k8s/edit/main/docs/orchestrating-elastic-stack-applications/agent-fleet.asciidoc">edit</a></h3>
</div></div></div>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">kubectl apply -f https://raw.githubusercontent.com/elastic/cloud-on-k8s/2.14/config/recipes/elastic-agent/fleet-apm-integration.yaml</pre>
</div>
<p>Deploys single instance Elastic Agent Deployment in Fleet mode with APM integration enabled.</p>
</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="k8s-elastic-agent-fleet-configuration.html">« Configuration</a>
</span>
<span class="next">
<a href="k8s-elastic-agent-fleet-known-limitations.html">Known limitations »</a>
</span>
</div>
</body>
</html>
