<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Advanced configuration | Elastic Cloud on Kubernetes [master] | Elastic</title>
<meta class="elastic" name="content" content="Advanced configuration | Elastic Cloud on Kubernetes [master]">

<link rel="home" href="index.html" title="Elastic Cloud on Kubernetes [master]"/>
<link rel="up" href="k8s-logstash.html" title="Run Logstash on ECK"/>
<link rel="prev" href="k8s-logstash-update-strategy.html" title="Update Strategy"/>
<link rel="next" href="k8s-stack-helm-chart.html" title="Elastic Stack Helm Chart"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="ECK"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Kubernetes/Reference/master"/>
<meta name="DC.subject" content="ECK"/>
<meta name="DC.identifier" content="master"/>
</head>
<body>
<div class="page_header">
This documentation contains work-in-progress information for future Elastic Stack and Cloud releases. Use the version selector to view supported release docs. It also contains some Elastic Cloud serverless information. Check out our <a href="https://www.elastic.co/docs/current/serverless">serverless docs</a> for more details.
</div>
<div class="navheader">
<span class="prev">
<a href="k8s-logstash-update-strategy.html">« Update Strategy</a>
</span>
<span class="next">
<a href="k8s-stack-helm-chart.html">Elastic Stack Helm Chart »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Cloud on Kubernetes [master]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="k8s-orchestrating-elastic-stack-applications.html">Orchestrating Elastic Stack applications</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="k8s-logstash.html">Run Logstash on ECK</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Advanced configuration</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/cloud-on-k8s/edit/main/docs/orchestrating-elastic-stack-applications/logstash.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="k8s-logstash-advanced-configuration"></a>Advanced configuration</h2><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/cloud-on-k8s/edit/main/docs/orchestrating-elastic-stack-applications/logstash.asciidoc">edit</a></div>
</div></div></div>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="k8s-logstash-jvm-options"></a>Setting JVM options</h3><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/cloud-on-k8s/edit/main/docs/orchestrating-elastic-stack-applications/logstash.asciidoc">edit</a></div>
</div></div></div>
<p>You can change JVM settings by using the <code class="literal">LS_JAVA_OPTS</code> environment variable to override default settings in <code class="literal">jvm.options</code>. This approach ensures that expected settings from <code class="literal">jvm.options</code> are set, and only options that explicitly need to be overridden are.</p>
<p>To do, this, set the  <code class="literal">LS_JAVA_OPTS</code> environment variable in the container definition of your Logstash resource:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">apiVersion: logstash.k8s.elastic.co/v1alpha1
kind: Logstash
metadata:
  name: quickstart
spec:
  podTemplate:
    spec:
      containers:
        - name: logstash
          env:
            - name: LS_JAVA_OPTS   <a id="CO45-1"></a><i class="conum" data-value="1"></i>
              value: "-Xmx2g -Xms2g"</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO45-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>This will change the maximum and minimum heap size of the JVM on each pod to 2GB</p>
</td>
</tr>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="k8s-logstash-keystore"></a>Setting keystore</h3><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/cloud-on-k8s/edit/main/docs/orchestrating-elastic-stack-applications/logstash.asciidoc">edit</a></div>
</div></div></div>
<p>You can specify sensitive settings with Kubernetes secrets. ECK automatically injects these settings into the keystore before it starts Logstash.
The ECK operator continues to watch the secrets for changes and will restart Logstash Pods when it detects a change.</p>
<p>The Logstash Keystore can be password protected by setting an environment variable called <code class="literal">LOGSTASH_KEYSTORE_PASS</code>. Check out <a href="/guide/en/logstash/current/keystore.html#keystore-password" class="ulink" target="_top">Logstash Keystore</a> documentation for details.</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">apiVersion: v1
kind: Secret
metadata:
  name: logstash-keystore-pass
stringData:
  LOGSTASH_KEYSTORE_PASS: changed   <a id="CO46-1"></a><i class="conum" data-value="1"></i>
---
apiVersion: v1
kind: Secret
metadata:
  name: logstash-secure-settings
stringData:
  HELLO: Hallo
---
apiVersion: logstash.k8s.elastic.co/v1alpha1
kind: Logstash
metadata:
  name: logstash-sample
spec:
  version: 8.15.1
  count: 1
  pipelines:
    - pipeline.id: main
      config.string: |-
        input { exec { command =&gt; 'uptime' interval =&gt; 10 } }
        filter {
          if ("${HELLO:}" != "") {   <a id="CO46-2"></a><i class="conum" data-value="2"></i>
            mutate { add_tag =&gt; ["awesome"] }
          }
        }
  secureSettings:
    - secretName: logstash-secure-settings
  podTemplate:
    spec:
      containers:
        - name: logstash
          env:
            - name: LOGSTASH_KEYSTORE_PASS
              valueFrom:
                secretKeyRef:
                  name: logstash-keystore-pass
                  key: LOGSTASH_KEYSTORE_PASS</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO46-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Value of password to protect the Logstash keystore</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO46-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>The syntax for referencing keys is identical to the syntax for environment variables</p>
</td>
</tr>
</table>
</div>
</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="k8s-logstash-update-strategy.html">« Update Strategy</a>
</span>
<span class="next">
<a href="k8s-stack-helm-chart.html">Elastic Stack Helm Chart »</a>
</span>
</div>
</body>
</html>
