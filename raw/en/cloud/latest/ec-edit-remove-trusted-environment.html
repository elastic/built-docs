<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Edit or remove a trusted environment | Elasticsearch Service Documentation | Elastic</title>
<meta class="elastic" name="content" content="Edit or remove a trusted environment | Elasticsearch Service Documentation">

<link rel="home" href="index.html" title="Elasticsearch Service Documentation"/>
<link rel="up" href="ec-enable-ccs.html" title="Enable cross-cluster search and cross-cluster replication"/>
<link rel="prev" href="ec-enable-ccs-for-eck.html" title="Enabling CCS/R between Elasticsearch Service and ECK"/>
<link rel="next" href="ec-migrate-ccs.html" title="Migrate the cross-cluster search deployment template"/>
<meta class="elastic" name="product_version" content="latest"/>
<meta class="elastic" name="product_name" content="Elastic Cloud"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Cloud/Reference"/>
<meta name="DC.subject" content="Elastic Cloud"/>
<meta name="DC.identifier" content="latest"/>
</head>
<body>
<div class="navheader">
<span class="prev">
<a href="ec-enable-ccs-for-eck.html">« Enabling CCS/R between Elasticsearch Service and ECK</a>
</span>
<span class="next">
<a href="ec-migrate-ccs.html">Migrate the cross-cluster search deployment template »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elasticsearch Service Documentation</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="ec-best-practices-data.html">Best practices for managing your data</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="ec-enable-ccs.html">Enable cross-cluster search and cross-cluster replication</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Edit or remove a trusted environment</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-111/docs/shared/ec-ce-edit-remove-trusted-environment.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="ec-edit-remove-trusted-environment"></a>Edit or remove a trusted environment</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-111/docs/shared/ec-ce-edit-remove-trusted-environment.asciidoc">edit</a></div>
</div></div></div>
<p>From a deployment&#8217;s <span class="strong strong"><strong>Security</strong></span> page, you can manage trusted environments that were created previously. This can happen when:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
You no longer need a trusted environment and want to remove it.
</li>
<li class="listitem">
You want to refresh the certificate, or add or remove trusted deployments of an existing trusted environment relying on certificates as a security model.
</li>
<li class="listitem">
You want to remove or update the access level granted by a cross-cluster API key.
</li>
</ul>
</div>
<div class="position-relative"><h4><a id="ec_remove_a_trusted_environment"></a>Remove a trusted environment</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-111/docs/shared/ec-ce-edit-remove-trusted-environment.asciidoc">edit</a></div>
<p>By removing a trusted environment, this deployment will no longer be able to establish remote connections using certificate trust to clusters of that environment. The remote environment will also no longer be able to connect to this deployment using certificate trust.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>With this method, you can only remove trusted environments relying exclusively on certificates. To remove remote connections that use API keys for authentication, refer to <a class="xref" href="ec-edit-remove-trusted-environment.html#ec-edit-remove-trusted-environment-api-key" title="Change a cross-cluster API key used for a remote connection">Update the access level of a remote cluster connection relying on a cross-cluster API key</a>.</p>
</div>
</div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Go to the deployment&#8217;s <span class="strong strong"><strong>Security</strong></span> page.
</li>
<li class="listitem">
In the list of trusted environments, locate the one you want to remove.
</li>
<li class="listitem">
<p>Remove it using the corresponding <code class="literal">delete</code> icon.</p>
<div class="imageblock">
<div class="content">
<img src="images/delete-trust-environment.png" alt="button for deleting a trusted environment">
</div>
</div>
</li>
<li class="listitem">
In Kibana, go to <span class="strong strong"><strong>Stack Management</strong></span> &gt; <span class="strong strong"><strong>Remote Clusters</strong></span>.
</li>
<li class="listitem">
In the list of existing remote clusters, delete the ones corresponding to the trusted environment you removed earlier.
</li>
</ol>
</div>
<div class="position-relative"><h4><a id="ec_update_a_certificate_based_trusted_environment"></a>Update a certificate-based trusted environment</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-111/docs/shared/ec-ce-edit-remove-trusted-environment.asciidoc">edit</a></div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Go to the deployment&#8217;s <span class="strong strong"><strong>Security</strong></span> page.
</li>
<li class="listitem">
In the list of trusted environments, locate the one you want to edit.
</li>
<li class="listitem">
<p>Open its details by selecting the <code class="literal">Edit</code> icon.</p>
<div class="imageblock">
<div class="content">
<img src="images/edit-trust-environment.png" alt="button for editing a trusted environment">
</div>
</div>
</li>
<li class="listitem">
<p>Edit the trust configuration for that environment:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
From the <span class="strong strong"><strong>Trust level</strong></span> tab, you can add or remove trusted deployments.
</li>
<li class="listitem">
From the <span class="strong strong"><strong>Environment settings</strong></span> tab, you can manage the certificates and the label of the environment.
</li>
</ul>
</div>
</li>
<li class="listitem">
Save your changes.
</li>
</ol>
</div>
<div class="position-relative"><h4><a id="ec-edit-remove-trusted-environment-api-key"></a>Change a cross-cluster API key used for a remote connection</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-111/docs/shared/ec-ce-edit-remove-trusted-environment.asciidoc">edit</a></div>
<p>This section describes the steps to change the API key used for an existing remote connection. For example, if the previous key expired and you need to rotate it with a new one.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>If you need to update the permissions granted by a cross-cluster API key for a remote connection, you only need to update the privileges granted by the API key directly in Kibana.</p>
</div>
</div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
On the deployment you will use as remote, use the
<a href="/guide/en/elasticsearch/reference/8.15/security-api-create-cross-cluster-api-key.html" class="ulink" target="_top">Elasticsearch API</a> or <a href="/guide/en/kibana/8.15/api-keys.html" class="ulink" target="_top">Kibana</a> to create a cross-cluster API key with the appropriate permissions. Configure it with access to the indices you want to use for cross-cluster search or cross-cluster replication.
</li>
<li class="listitem">
Copy the encoded key (<code class="literal">encoded</code> in the response) to a safe location. You will
need it in the next steps.
</li>
<li class="listitem">
Go to the <span class="strong strong"><strong>Security</strong></span> page of the local deployment and locate the <span class="strong strong"><strong>Remote connections</strong></span> section.
</li>
<li class="listitem">
Locate the API key currently used for connecting to the remote cluster, copy its current alias, and delete it.
</li>
<li class="listitem">
<p>Add the new API key by selecting <span class="strong strong"><strong>Add an API key</strong></span>.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>For the <span class="strong strong"><strong>Setting name</strong></span>, enter the same alias that was used for the previous key.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>If you use a different alias, you also need to re-create the remote cluster in Kibana with a <span class="strong strong"><strong>Name</strong></span> that matches the new alias.</p>
</div>
</div>
</li>
<li class="listitem">
<p>For the <span class="strong strong"><strong>Secret</strong></span>, paste the encoded cross-cluster API key.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Click <span class="strong strong"><strong>Add</strong></span> to save the API key to the keystore.
</li>
</ol>
</div>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Restart the local deployment to reload the keystore with its new setting. To do that, go to the deployment&#8217;s main page (named after your deployment&#8217;s name), locate the <span class="strong strong"><strong>Actions</strong></span> menu, and select <span class="strong strong"><strong>Restart Elasticsearch</strong></span>.<br></p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>If the local deployment runs on version 8.13 or greater, you no longer need to perform this step because the keystore is reloaded automatically with the new API keys.</p>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="ec-enable-ccs-for-eck.html">« Enabling CCS/R between Elasticsearch Service and ECK</a>
</span>
<span class="next">
<a href="ec-migrate-ccs.html">Migrate the cross-cluster search deployment template »</a>
</span>
</div>
</body>
</html>
