<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Register Elastic Cloud SAML in Microsoft Entra ID | Elasticsearch Service Documentation | Elastic</title>
<meta class="elastic" name="content" content="Register Elastic Cloud SAML in Microsoft Entra ID | Elasticsearch Service Documentation">

<link rel="home" href="index.html" title="Elasticsearch Service Documentation"/>
<link rel="up" href="ec-saml-sso.html" title="Configure Elastic Cloud SAML single sign-on"/>
<link rel="prev" href="ec-saml-sso-okta.html" title="Register Elastic Cloud SAML in Okta"/>
<link rel="next" href="ec-organizations-notifications-domain-allowlist.html" title="Notifications domain allowlist"/>
<meta class="elastic" name="product_version" content="latest"/>
<meta class="elastic" name="product_name" content="Elastic Cloud"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Cloud/Reference"/>
<meta name="DC.subject" content="Elastic Cloud"/>
<meta name="DC.identifier" content="latest"/>
</head>
<body>
<div class="navheader">
<span class="prev">
<a href="ec-saml-sso-okta.html">« Register Elastic Cloud SAML in Okta</a>
</span>
<span class="next">
<a href="ec-organizations-notifications-domain-allowlist.html">Notifications domain allowlist »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elasticsearch Service Documentation</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="ec-organizations.html">Managing your organization</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="ec-saml-sso.html">Configure Elastic Cloud SAML single sign-on</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Register Elastic Cloud SAML in Microsoft Entra ID</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-112/docs/saas/ec-organizations-saml-sso-entra.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="ec-saml-sso-entra"></a>Register Elastic Cloud SAML in Microsoft Entra ID</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/cloud/edit/ms-112/docs/saas/ec-organizations-saml-sso-entra.asciidoc">edit</a></div>
</div></div></div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in technical preview and may be changed or removed in a future release. Elastic will work to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.</p>
</div>
</div>
<p>To <a class="xref" href="ec-saml-sso.html" title="Configure Elastic Cloud SAML single sign-on">configure Elastic Cloud SAML SSO</a> with Microsoft Entra ID (formerly Azure AD) as the identity provider (IdP):</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Create a new Entra ID Enterprise application.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Choose to create a non-gallery application.
</li>
<li class="listitem">
Provide a name and basic information about the application.
</li>
<li class="listitem">
Select SAML as the single sign-on method.
</li>
<li class="listitem">
Initially use placeholder values for the entity ID, reply or assertion consumer service (ACS) URL, and sign on URL.
</li>
<li class="listitem">
<p>Configure an <code class="literal">email</code> attribute in the <span class="strong strong"><strong>Attributes &amp; Claims</strong></span> section.</p>
<p>Optionally set <code class="literal">firstName</code> to <code class="literal">user.givenname</code> and <code class="literal">lastName</code> to <code class="literal">user.surname</code>.
These values will be used to set the respective fields of the user&#8217;s Elastic Cloud account.
For example:</p>
<div class="imageblock">
<div class="content">
<img src="images/microsoft-entra-id-attributes.png" alt="The Attributes and Claims section of an Entra ID Enterprise Application">
</div>
</div>
</li>
</ol>
</div>
</li>
<li class="listitem">
<p>Collect information about the application from the Entra ID screen.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Get the "Login URL" for the SSO URL, which is the URL where users will be redirected at login.
</li>
<li class="listitem">
Get the "Microsoft Entra Identifier" for use as the issuer.
</li>
<li class="listitem">
Download the signing certificate.
</li>
</ol>
</div>
</li>
<li class="listitem">
<p><a class="xref" href="ec-saml-sso.html#ec-saml-sso-register-idp" title="Register a SAML IdP">Register the IdP with Elastic Cloud</a>.</p>
<p>For example:</p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">curl -XPUT \
-H 'Content-Type: application/json' \
-H "Authorization: ApiKey $EC_API_KEY" \
"https://api.elastic-cloud.com/api/v1/organizations/$ORGANIZATION_ID/idp" \
-d '
{
  "enabled": true,
  "login_identifier_prefix": "&lt;businessname&gt;", <a id="CO43-1"></a><i class="conum" data-value="1"></i>
  "name": "SSO with &lt;businessname&gt;",
  "saml_idp": {
    "public_certificate": [ <a id="CO43-2"></a><i class="conum" data-value="2"></i>
      "&lt;publiccert&gt;"
    ],
    "issuer": "&lt;issuer&gt;", <a id="CO43-3"></a><i class="conum" data-value="3"></i>
    "sso_url": "&lt;ssourl&gt;", <a id="CO43-4"></a><i class="conum" data-value="4"></i>
    "subject": {
      "format": "urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified" <a id="CO43-5"></a><i class="conum" data-value="5"></i>
    }
  }
}
'</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO43-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p><code class="literal">login_identifier_prefix</code> is a customizable piece of the Elastic Cloud SSO url that your organization members can use to authenticate. This could be the name of your business. You can use alphanumeric characters and hyphens in this value and you can change it later.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO43-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p><code class="literal">public_certificate</code> is the Base64-encoded DER-encoded certificate that you downloaded. You must remove newlines and any PEM markers (such as <code class="literal">-----BEGIN CERTIFICATE-----</code> or <code class="literal">-----END CERTIFICATE-----</code>) so that the certificate is a single-line Base64-encoded string.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO43-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p><code class="literal">issuer</code> is the "Microsoft Entra Identifier" obtained from the Entra ID screen.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO43-4"><i class="conum" data-value="4"></i></a></p>
</td>
<td align="left" valign="top">
<p><code class="literal">sso_url</code> is the "Login URL" obtained from the Entra ID screen.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO43-5"><i class="conum" data-value="5"></i></a></p>
</td>
<td align="left" valign="top">
<p><code class="literal">format</code> is the SAML name-id format to use.</p>
</td>
</tr>
</table>
</div>
<p>If successful, the API will return the details that will need to be provided to the IdP.
For example:</p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">{
	"login_identifier": "&lt;loginidentifier&gt;",
	"sso_login_url": "https://cloud.elastic.co/login/sso/&lt;loginidentifier&gt;", <a id="CO44-1"></a><i class="conum" data-value="1"></i>
	"metadata_url": "https://cloud.elastic.co/api/v1/organizations/&lt;orgid&gt;/idp/metadata.xml",
	"acs": "&lt;acs&gt;", <a id="CO44-2"></a><i class="conum" data-value="2"></i>
	"sp_entity_id": "https://cloud.elastic.co/organizations/&lt;orgid&gt;", <a id="CO44-3"></a><i class="conum" data-value="3"></i>
	"signing_certificate": [ <a id="CO44-4"></a><i class="conum" data-value="4"></i>
		"&lt;cert&gt;"
	]
}</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO44-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p><code class="literal">sso_login_url</code> is the URL you can provide to organization members to initiate SSO with your Elastic Cloud organization.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO44-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p><code class="literal">acs</code> is the SAML assertion consumer service that your SAML IdP should send SAML assertions.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO44-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p><code class="literal">sp_entity_id</code> is the SAML entity ID of the service provider that your SAML IdP should send in the SAML audience.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO44-4"><i class="conum" data-value="4"></i></a></p>
</td>
<td align="left" valign="top">
<p><code class="literal">signing_certificate</code> is the Base64-encoded DER-encoded certificate that SAML requests to your IdP will be signed with.</p>
</td>
</tr>
</table>
</div>
</li>
<li class="listitem">
<p>Update the <span class="strong strong"><strong>Basic SAML Configuration</strong></span> section of the Entra ID Enterprise application to use the values returned by the registration API.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Set the entity ID to the <code class="literal">sp_entity_id</code> value.
</li>
<li class="listitem">
Set the reply or ACS URL to the <code class="literal">acs</code> value.
</li>
<li class="listitem">
Set the sign on URL to the <code class="literal">sso_login_url</code> value.
</li>
</ol>
</div>
</li>
<li class="listitem">
Optionally update the <span class="strong strong"><strong>Verification certificates</strong></span> section of the Entra ID Enterprise application to add the certificate returned by the registration API and turn on certificate verification.
</li>
</ol>
</div>
<p>When these steps are complete, you should be able to test SSO as described in <a class="xref" href="ec-saml-sso.html" title="Configure Elastic Cloud SAML single sign-on"><em>Configure Elastic Cloud SAML SSO</em></a>.</p>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="ec-saml-sso-okta.html">« Register Elastic Cloud SAML in Okta</a>
</span>
<span class="next">
<a href="ec-organizations-notifications-domain-allowlist.html">Notifications domain allowlist »</a>
</span>
</div>
</body>
</html>
