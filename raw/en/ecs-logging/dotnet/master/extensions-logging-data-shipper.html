<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Elastic.Extensions.Logging | ECS Logging .NET Reference | Elastic</title>
<meta class="elastic" name="content" content="Elastic.Extensions.Logging | ECS Logging .NET Reference">

<link rel="home" href="index.html" title="ECS Logging .NET Reference"/>
<link rel="up" href="data-shippers.html" title="Data Shippers"/>
<link rel="prev" href="serilog-data-shipper.html" title="Elastic.Serilog.Sinks"/>
<link rel="next" href="benchmark-dotnet-data-shipper.html" title="BenchmarkDotnet Exporter"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="ECS Logging .NET Reference"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/ECS-logging/.NET/Guide"/>
<meta name="DC.subject" content="ECS Logging .NET Reference"/>
<meta name="DC.identifier" content="master"/>
</head>
<body>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link">
  <div id="related-products" class="dropdown">
    <div class="related-products-title">ECS Logging:</div>
    <div class="dropdown-anchor" tabindex="0">.NET Reference<span class="dropdown-icon"></span></div>
    <div class="dropdown-content">
      <ul>
        <li><a href="/guide/en/ecs-logging/overview/current/intro.html">Reference</a></li>
        <li><a href="/guide/en/ecs-logging/go-logrus/current/intro.html">Go (Logrus) Reference</a></li>
        <li><a href="/guide/en/ecs-logging/go-zap/current/intro.html">Go (zap) Reference</a></li>
        <li><a href="/guide/en/ecs-logging/java/current/intro.html">Java Reference</a></li>
        <li><a href="/guide/en/ecs-logging/dotnet/current/intro.html">.NET Reference</a></li>
        <li><a href="/guide/en/ecs-logging/nodejs/current/intro.html">Node.js Reference</a></li>
        <li><a href="/guide/en/ecs-logging/ruby/current/intro.html">Ruby Reference</a></li>
        <li><a href="/guide/en/ecs-logging/php/current/intro.html">PHP Reference</a></li>
        <li><a href="/guide/en/ecs-logging/python/current/intro.html">Python Reference</a></li>
      </ul>
    </div>
  </div>
</span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="data-shippers.html">Data Shippers</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="serilog-data-shipper.html">« Elastic.Serilog.Sinks</a>
</span>
<span class="next">
<a href="benchmark-dotnet-data-shipper.html">BenchmarkDotnet Exporter »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="extensions-logging-data-shipper"></a>Elastic.Extensions.Logging<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ecs-dotnet/edit/main/docs/data-shippers/extensions-logging.asciidoc">edit</a></h2>
</div></div></div>
<p>Elastic logger provider for Microsoft.Extensions.Logging.</p>
<p>Writes direct to Elasticsearch using the <a href="/guide/en/ecs/current/ecs-reference.html" class="ulink" target="_top">Elastic Common Schema (ECS)</a>,
with semantic logging of structured data from message and scope values. The results can be viewed and queried in the Kibana console.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_installation_7"></a>Installation<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ecs-dotnet/edit/main/docs/data-shippers/extensions-logging.asciidoc">edit</a></h3>
</div></div></div>
<p>Add a reference to the <code class="literal">Elastic.Extensions.Logging</code> package:</p>
<div class="pre_wrapper lang-xml">
<pre class="programlisting prettyprint lang-xml">&lt;PackageReference Include="Elastic.Extensions.Logging" Version="8.6.0" /&gt;</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_usage_7"></a>Usage<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ecs-dotnet/edit/main/docs/data-shippers/extensions-logging.asciidoc">edit</a></h3>
</div></div></div>
<p>Then, add the provider to the loggingBuilder during host construction, using the provided extension method.</p>
<div class="pre_wrapper lang-c#">
<pre class="programlisting prettyprint lang-c#">using Elasticsearch.Extensions.Logging;

// ...

    .ConfigureLogging((hostContext, loggingBuilder) =&gt;
    {
        loggingBuilder.AddElasticsearch();
    })</pre>
</div>
<p>The default configuration will write to a local Elasticsearch running at <a href="http://localhost:9200/" class="ulink" target="_top">http://localhost:9200/</a>.</p>
<p>Once you have sent some log event, open Kibana (e.g. <a href="http://localhost:5601/" class="ulink" target="_top">http://localhost:5601/</a>) and define an
index pattern for "dotnet-*" with the time filter "@timestamp".</p>
<p>You can then discover the log events for the index. Some useful columns to add
are <code class="literal">log.level</code>, <code class="literal">log.logger</code>, <code class="literal">event.code</code>, <code class="literal">message</code>, <code class="literal">tags</code>, and <code class="literal">process.thread.id</code>.</p>
<p>If you are running multiple applications or on multiple servers, you might want to
include <code class="literal">service.type</code>, <code class="literal">service.version</code>, and <code class="literal">host.hostname</code>.</p>
<p>Additional fields are defined below, and all individual message and scope values are logged
as <code class="literal">labels.*</code> custom key/value pairs, e.g. <code class="literal">labels.CustomerId</code>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_basic_configuration"></a>Basic configuration<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ecs-dotnet/edit/main/docs/data-shippers/extensions-logging.asciidoc">edit</a></h3>
</div></div></div>
<p>For deployment you will usually want to override the configuration with your actual server location(s).
The other useful value to configure is a tag for the environment, e.g. Development/Staging/Production.</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
  "Logging": {
    "Elasticsearch": {
      "NodeUris": [ "https://elastic-staging.example.com:9200" ],
      "Tags": [ "Staging" ]
    }
  }
}</pre>
</div>
<p><span class="strong strong"><strong>NOTE:</strong></span> You don&#8217;t need any configuration to just use a local Elasticsearch instance, as it defaults to <a href="http://localhost:9200/" class="ulink" target="_top">http://localhost:9200/</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_configuration_settings"></a>Configuration settings<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ecs-dotnet/edit/main/docs/data-shippers/extensions-logging.asciidoc">edit</a></h3>
</div></div></div>
<p>The logger provider will be automatically configured with any logging settings under the alias <code class="literal">Elasticsearch</code>.</p>
<p>The following default settings are used.</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
  "Logging": {
    "Elasticsearch": {
      "IncludeHost": true,
      "IncludeProcess": true,
      "IncludeScopes": true,
      "IncludeUser": true,
      "Index": "dotnet-{0:yyyy.MM.dd}",
      "IndexOffset": null,
      "IsEnabled": true,
      "ListSeparator": ", ",
      "MapCorrelationValues": true,
      "Tags": [],
      "ShipTo": {
        "NodePoolType": "SingleNode",
        "NodeUris": [ "http://localhost:9200" ]
      }
    }
  }
}</pre>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Setting</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>IncludeHost</p></td>
<td align="left" valign="top"><p>boolean</p></td>
<td align="left" valign="top"><p>Default <code class="literal">true</code>; set to <code class="literal">false</code> to disable logging host values.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>IncludeProcess</p></td>
<td align="left" valign="top"><p>boolean</p></td>
<td align="left" valign="top"><p>Default <code class="literal">true</code>; set to <code class="literal">false</code> to disable logging process values.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>IncludeScopes</p></td>
<td align="left" valign="top"><p>boolean</p></td>
<td align="left" valign="top"><p>Default <code class="literal">true</code>; set to <code class="literal">false</code> to disable logging scope values.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>IncludeUser</p></td>
<td align="left" valign="top"><p>boolean</p></td>
<td align="left" valign="top"><p>Default <code class="literal">true</code>; set to <code class="literal">false</code> to disable logging user details.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Index</p></td>
<td align="left" valign="top"><p>format</p></td>
<td align="left" valign="top"><p>Format string used to generate the Elasticsearch <code class="literal">index</code>, using the current timestamp. Default is <code class="literal">dotnet-{0:yyyy.MM.dd}</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>IndexOffset</p></td>
<td align="left" valign="top"><p>timespan</p></td>
<td align="left" valign="top"><p>Override to set the offset used to generate the <code class="literal">index</code>. Default value is <code class="literal">null</code>, which uses the system local offset; use <code class="literal">"00:00&amp;"</code> for UTC.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>IsEnabled</p></td>
<td align="left" valign="top"><p>boolean</p></td>
<td align="left" valign="top"><p>Default <code class="literal">true</code>; set to <code class="literal">false</code> to disable the logger.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>ListSeparator</p></td>
<td align="left" valign="top"><p>string</p></td>
<td align="left" valign="top"><p>Separator to use for <code class="literal">IEnumerable</code> in <code class="literal">labels.*</code> values. Default is <code class="literal">", "</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Tags</p></td>
<td align="left" valign="top"><p>array</p></td>
<td align="left" valign="top"><p>Additional tags to include in the message. Useful to specify the environment or other details, e.g. <code class="literal">[ "Staging", "Priority"]</code></p></td>
</tr>
</tbody>
</table>
</div>
<p>The ShipTo settings can have the following properties, depending on the type of connection pool.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Setting</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>ApiKey</p></td>
<td align="left" valign="top"><p>string</p></td>
<td align="left" valign="top"><p>API Key, where connection pool type is Cloud, and authenticating via API Key.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>CloudId</p></td>
<td align="left" valign="top"><p>string</p></td>
<td align="left" valign="top"><p>Cloud ID, where connection pool type is Cloud.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>NodePoolType</p></td>
<td align="left" valign="top"><p>enum</p></td>
<td align="left" valign="top"><p>Default is <code class="literal">Singlenode</code>, or <code class="literal">Sniffing</code> for multiple nodes, or <code class="literal">Cloud</code> if <code class="literal">CloudId</code> is provided. Other supported values are <code class="literal">Static</code> or <code class="literal">Sticky</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>NodeUris</p></td>
<td align="left" valign="top"><p>array</p></td>
<td align="left" valign="top"><p>URI(s) of the Elasticsearch nodes to connect to. Default is a single node <code class="literal">[ "http://localhost:9200" ]</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Password</p></td>
<td align="left" valign="top"><p>string</p></td>
<td align="left" valign="top"><p>Password, where connection pool type is Cloud, and authenticating via username/password.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Username</p></td>
<td align="left" valign="top"><p>string</p></td>
<td align="left" valign="top"><p>Username, where connection pool type is Cloud, and authenticating via username/password.</p></td>
</tr>
</tbody>
</table>
</div>
<p>If you want to configure from a different section, it can be configured manually:</p>
<div class="pre_wrapper lang-c#">
<pre class="programlisting prettyprint lang-c#">    .ConfigureLogging((hostContext, loggingBuilder) =&gt;
    {
        loggingBuilder.AddElasticsearch(options =&gt;
            hostContext.Configuration.Bind("Logging:CustomElasticsearch", options));
    })</pre>
</div>
<p>Configuration can, of course, also be done in code, e.g. to add the environment as a tag.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_elastic_cloud_configuration"></a>Elastic Cloud configuration<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ecs-dotnet/edit/main/docs/data-shippers/extensions-logging.asciidoc">edit</a></h3>
</div></div></div>
<p>If <code class="literal">CloudId</code> is provided, the <code class="literal">ConnectionPoolType</code> defaults to <code class="literal">Cloud</code>:</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
  "Logging": {
    "Elasticsearch": {
      "ShipTo": {
        "CloudId": "12345",
        "ApiKey": "abcdef"
      }
    }
  }
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_output_elastic_common_schema_ecs"></a>Output - Elastic Common Schema (ECS)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ecs-dotnet/edit/main/docs/data-shippers/extensions-logging.asciidoc">edit</a></h3>
</div></div></div>
<p>Log messages sent to Elasticsearch follow the <a href="/guide/en/ecs/current/ecs-reference.html" class="ulink" target="_top">Elastic Common Schema (ECS)</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_example_document"></a>Example document<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ecs-dotnet/edit/main/docs/data-shippers/extensions-logging.asciidoc">edit</a></h3>
</div></div></div>
<p>The <code class="literal">_source</code> field is the message sent from the LoggerProvider, along with the <code class="literal">_index</code> and <code class="literal">_id</code> (a GUID).</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
  "_index": "dotnet-2020.04.12",
  "_type": "_doc",
  "_id": "563503a8-9d10-46ff-a09f-c6ccbf124db9",
  "_version": 1,
  "_score": null,
  "_source": {
    "MessageTemplate": "Unexpected error processing customer {CustomerId}.",
    "Scopes": [
      "IP address 2001:db8:85a3::8a2e:370:7334",
      "PlainScope"
    ],
    "agent": {
      "version": "1.0.0+bd3ad6",
      "type": "Elasticsearch.Extensions.Logging.LoggerProvider"
    },
    "ecs": {
      "version": "1.5.0"
    },
    "error": {
      "message": "Calculation error",
      "type": "System.Exception",
      "stack_trace": "System.Exception: Calculation error\n ---&gt; System.DivideByZeroException: Attempted to divide by zero.\n   at HelloElasticsearch.Worker.ExecuteAsync(CancellationToken stoppingToken) in /home/sly/Code/essential-logging/examples/HelloElasticsearch/Worker.cs:line 80\n   --- End of inner exception stack trace ---\n   at HelloElasticsearch.Worker.ExecuteAsync(CancellationToken stoppingToken) in /home/sly/Code/essential-logging/examples/HelloElasticsearch/Worker.cs:line 84"
    },
    "event": {
      "code": "5000",
      "action": "ErrorProcessingCustomer",
      "severity": 3
    },
    "host": {
      "os": {
        "platform": "Unix",
        "full": "Linux 4.15.0-91-generic #92-Ubuntu SMP Fri Feb 28 11:09:48 UTC 2020",
        "version": "4.15.0.91"
      },
      "hostname": "VUB1804",
      "architecture": "X64"
    },
    "log": {
      "level": "Error",
      "logger": "HelloElasticsearch.Worker"
    },
    "process": {
      "thread": {
        "id": 10
      },
      "pid": 25982,
      "name": "HelloElasticsearch"
    },
    "service": {
      "type": "HelloElasticsearch",
      "version": "1.0.0"
    },
    "user": {
      "id": "sgryphon+es@live.com",
      "name": "sly",
      "domain": "VUB1804"
    },
    "@timestamp": "2020-04-13T21:25:22.3352989+10:00",
    "tags": [
      "Development"
    ],
    "labels": {
      "ip": "2001:db8:85a3::8a2e:370:7334",
      "CustomerId": "12345"
    },
    "message": "Unexpected error processing customer 12345.",
    "trace": {
      "id": "c20bde1071f7cf4e9a6f368c824e05f7"
    },
    "transaction": {
      "id": "92ba5ee64d963746"
    }
  },
  "fields": {
    "@timestamp": [
      "2020-04-13T11:25:22.335Z"
    ]
  },
  "sort": [
    1586777122335
  ]
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_standard_fields"></a>Standard Fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ecs-dotnet/edit/main/docs/data-shippers/extensions-logging.asciidoc">edit</a></h3>
</div></div></div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Field</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>@timestamp</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p><code class="literal">DateTimeOffset</code> when the message was logged, including local offset.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>message</p></td>
<td align="left" valign="top"><p>string</p></td>
<td align="left" valign="top"><p>The formatted log message and arguments.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>tags</p></td>
<td align="left" valign="top"><p>array</p></td>
<td align="left" valign="top"><p>Custom tags from configuration, e.g. <code class="literal">[ "Staging", "Priority" ]</code>. Can have multiple values.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>event.action</p></td>
<td align="left" valign="top"><p>string</p></td>
<td align="left" valign="top"><p>The name of the logged EventId, e.g. <code class="literal">ErrorProcessingCustomer</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>event.code</p></td>
<td align="left" valign="top"><p>string</p></td>
<td align="left" valign="top"><p>The numeric value (as a string) of the EventId, e.g. <code class="literal">5000</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>event.severity</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p>The syslog severity corresponding to the log level, 2 = critical, 3 = error, 4 = warning, 6 = information, 7 = debug and trace. (Also used in the Systemd format of ConsoleLoggerProvider)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>log.level</p></td>
<td align="left" valign="top"><p>string</p></td>
<td align="left" valign="top"><p>The log level: <code class="literal">Critical</code>, <code class="literal">Error</code>, <code class="literal">Warning</code>, <code class="literal">Information</code>, <code class="literal">Debug</code>, or <code class="literal">Trace</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>log.logger</p></td>
<td align="left" valign="top"><p>string</p></td>
<td align="left" valign="top"><p>The category name (namespace and class) of the logger, e.g. <code class="literal">HelloElasticsearch.Worker</code>.</p></td>
</tr>
</tbody>
</table>
</div>
<p>The <code class="literal">event.severity</code> field is numeric and can be used to order events by level, e.g. Kibana query <code class="literal">event.severity &amp;lt;= 4</code> will get all messages that have log level <code class="literal">Warning</code> or worse.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_error_fields"></a>Error fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ecs-dotnet/edit/main/docs/data-shippers/extensions-logging.asciidoc">edit</a></h3>
</div></div></div>
<p>If the log message includes an exception, the details are reported in the error fields.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Field</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>error.message</p></td>
<td align="left" valign="top"><p>string</p></td>
<td align="left" valign="top"><p>The <code class="literal">Message</code> property of any exception.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>error.stack_trace</p></td>
<td align="left" valign="top"><p>string</p></td>
<td align="left" valign="top"><p>Full details of the exception, <code class="literal">Exception.ToString()</code>, including the stack trace and the stack trace of any inner exceptions.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>error.type</p></td>
<td align="left" valign="top"><p>string</p></td>
<td align="left" valign="top"><p>The type of the error message, e.g. <code class="literal">System.DivideByZeroException</code></p></td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_custom_fields"></a>Custom fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ecs-dotnet/edit/main/docs/data-shippers/extensions-logging.asciidoc">edit</a></h3>
</div></div></div>
<p>Following the ECS conventions, these use alternative Title casing, to identify them as non-standard fields.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Field</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>MessageTemplate</p></td>
<td align="left" valign="top"><p>string</p></td>
<td align="left" valign="top"><p>The original message template, e.g. "Unexpected error processing customer {CustomerId}."</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Scopes</p></td>
<td align="left" valign="top"><p>array</p></td>
<td align="left" valign="top"><p>Array of string formatted scope values, in the order added.</p></td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_label_values"></a>Label values<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ecs-dotnet/edit/main/docs/data-shippers/extensions-logging.asciidoc">edit</a></h3>
</div></div></div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Field</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>labels.*</p></td>
<td align="left" valign="top"><p>string</p></td>
<td align="left" valign="top"><p>Custom key/value pairs of all named parameter values and named scope values. All values are strings (no nested objects).</p></td>
</tr>
</tbody>
</table>
</div>
<p>Label values can be accessed by their key, for example if the message, or scope, includes a parameter CustomerId, then the value will be logged as <code class="literal">labels.CustomerId</code> can be searched in Kibana using "labels.CustomerId: 12345".</p>
<p><span class="strong strong"><strong>Example:</strong></span></p>
<p>The following will generate two labels, <code class="literal">labels.EndTime</code> from the message and <code class="literal">labels.CustomerId</code> from the scope:</p>
<div class="pre_wrapper lang-c#">
<pre class="programlisting prettyprint lang-c#">using (_logger.BeginScope("{CustomerId}", customerId))
{
  _logger.LogWarning("End of processing reached at {EndTime}.", end);
}</pre>
</div>
<p>Labels are taken from the message (state) and any scope values (may be disabled via the configuration options). In Microsoft.Extensions.Logging an
internal FormattedLogValues is used in the ILogger overloads for log levels and scopes; it implements the <code class="literal">IEnumerable&amp;lt;KeyValuePair&amp;lt;string,object&amp;gt;&amp;gt;</code>
interface that is used to extract the individual parameter values.</p>
<p>The <code class="literal">labels</code> property in ECS should not contain nested objects, so values are converted to keyword strings. For most objects this is just calling ToString(),
with specific formats for some types, e.g. calling string on a list is usually not very useful, so the contents of the list is logged instead.</p>
<p><span class="strong strong"><strong>Labels value formatting</strong></span></p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Formatting</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>byte</p></td>
<td align="left" valign="top"><p>Hex, e.g. "9A"</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>byte[]</p></td>
<td align="left" valign="top"><p>Prefixed hex, e.g. "0x12789AF0"</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>DateTimeOffset</p></td>
<td align="left" valign="top"><p>ISO format, e.g. "2020-01-02T03:04:05.000000+06:00"</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>DateTime</p></td>
<td align="left" valign="top"><p>In most cases <code class="literal">DateTimeOffset</code> should be used instead (1). Where <code class="literal">DateTime</code> is used for date only (with no time component), it is formatted as a date, e.g. "2020-01-02". If it has a time component, the roundtrip ("o") format is used.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>IEnumerable</p></td>
<td align="left" valign="top"><p>Values separated by ", " (configurable)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>IDictionary&lt;string, object&gt;</p></td>
<td align="left" valign="top"><p>A string containing key value pairs, e.g. <code class="literal">token="0x12789AF0" count="5"</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><em>other values</em></p></td>
<td align="left" valign="top"><p>The result of <code class="literal">ToString()</code>, including scalar values, e.g. the number <code class="literal">5.3</code> is logged as the string "5.3"</p></td>
</tr>
</tbody>
</table>
</div>
<p><span class="strong strong"><strong>(1) See <a href="https://docs.microsoft.com/en-us/dotnet/standard/datetime/choosing-between-datetime" class="ulink" target="_top">https://docs.microsoft.com/en-us/dotnet/standard/datetime/choosing-between-datetime</a></strong></span></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_agent_fields"></a>Agent fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ecs-dotnet/edit/main/docs/data-shippers/extensions-logging.asciidoc">edit</a></h3>
</div></div></div>
<p>These identify the version of the logger provider being used.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Field</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>agent.type</p></td>
<td align="left" valign="top"><p>string</p></td>
<td align="left" valign="top"><p>Name of the logger provider assembly, <code class="literal">Elasticsearch.Extensions.Logging.LoggerProvider</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>agent.version</p></td>
<td align="left" valign="top"><p>string</p></td>
<td align="left" valign="top"><p>Informational version number of the logger assembly, e.g. <code class="literal">1.1.1+bd3ad63</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>ecs.version</p></td>
<td align="left" valign="top"><p>string</p></td>
<td align="left" valign="top"><p>Version of ECS standard used, currently <code class="literal">1.5</code>.</p></td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_service_fields"></a>Service fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ecs-dotnet/edit/main/docs/data-shippers/extensions-logging.asciidoc">edit</a></h3>
</div></div></div>
<p>This identifies the application/service that is running and generating the logs.</p>
<p>The values are pulled from the entry assemb, <code class="literal">Assembly.GetEntryAssembly()</code>, using the <code class="literal">Name</code>
and <code class="literal">AssemblyInformationalVersionAttribute</code> values (if informational version is not set
it falls back to assembly <code class="literal">Version</code>).</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Field</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>service.type</p></td>
<td align="left" valign="top"><p>string</p></td>
<td align="left" valign="top"><p>Name of the entry assembly, <code class="literal">HelloElasticsearch</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>service.version</p></td>
<td align="left" valign="top"><p>string</p></td>
<td align="left" valign="top"><p>Informational version number of the entry assembly, e.g. <code class="literal">1.2.0-beta.1+79d095a</code>.</p></td>
</tr>
</tbody>
</table>
</div>
<p><span class="strong strong"><strong>Note:</strong></span> You should be using a build process that sets the assembly informational version correctly.
e.g. If you have a dotnet project using git you can install the local tool <code class="literal">GitVersion.Tool</code>,
and use it to automatically generate semantic version numbers from the git branch information.</p>
<p>To install the tool:</p>
<div class="pre_wrapper lang-powershell">
<pre class="programlisting prettyprint lang-powershell">dotnet new tool-manifest
dotnet tool install GitVersion.Tool</pre>
</div>
<p>Then use the tool to create a semantic version number that can be used in your build process:</p>
<div class="pre_wrapper lang-powershell">
<pre class="programlisting prettyprint lang-powershell">dotnet tool restore
dotnet gitversion</pre>
</div>
<p>You are welcome to use the <a href="../../build.ps1" class="ulink" target="_top"><code class="literal">build.ps1</code></a> script in this repository as an example.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_tracing_fields"></a>Tracing fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ecs-dotnet/edit/main/docs/data-shippers/extensions-logging.asciidoc">edit</a></h3>
</div></div></div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Field</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>trace.id</p></td>
<td align="left" valign="top"><p>string</p></td>
<td align="left" valign="top"><p>Cross-service trace correlation identifier. From <code class="literal">Activity.Current.RootId</code> from <code class="literal">System.Diagnostics</code>, with a fallback to <code class="literal">CorrelationManager.ActivityId</code>. Can be overridden by a message or scope value <code class="literal">trace.id</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>transaction.id</p></td>
<td align="left" valign="top"><p>string</p></td>
<td align="left" valign="top"><p>Transaction for this service, e.g. individual request identifier. If in W3C format, parse out the SpanId from <code class="literal">Activity.Current.Id</code> from <code class="literal">System.Diagnostics</code>, otherwise just use the full <code class="literal">Activity.Current.Id</code> (e.g. if hierarchical). Can be overridden by message or scope value <code class="literal">transaction.id</code>.</p></td>
</tr>
</tbody>
</table>
</div>
<p>ASP.NET will automatically pass correlation identifiers between tiers; from 3.0 it also supports the W3C Trace Context standard (<a href="https://www.w3.org/TR/trace-context/" class="ulink" target="_top">https://www.w3.org/TR/trace-context/</a>).</p>
<p>The value of <code class="literal">Activity.Current.RootId</code> is used as the cross-service identifier (in W3C format this is the Trace ID),
if in W3C format the Span ID portion of <code class="literal">Activity.Current.Id</code> is used for the transaction, otherwise the full value is used (this is consistent with the way ASP.NET works).</p>
<p>It is recommended to turn on W3C format, for compatibility with other systems:</p>
<div class="pre_wrapper lang-c#">
<pre class="programlisting prettyprint lang-c#">Activity.DefaultIdFormat = ActivityIdFormat.W3C;</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_host_fields"></a>Host fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ecs-dotnet/edit/main/docs/data-shippers/extensions-logging.asciidoc">edit</a></h3>
</div></div></div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Can be disabled via configuration.</p>
</div>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Field</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>host.architecture</p></td>
<td align="left" valign="top"><p>string</p></td>
<td align="left" valign="top"><p>The processor architecture, e.g. X64. Value of <code class="literal">RuntimeInformation.OSArchitecture</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.hostname</p></td>
<td align="left" valign="top"><p>string</p></td>
<td align="left" valign="top"><p>The computer name. Value of <code class="literal">Environment.MachineName</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.full</p></td>
<td align="left" valign="top"><p>string</p></td>
<td align="left" valign="top"><p>Full description of the operation system. Value of <code class="literal">RuntimeInformation.OSDescription</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.platform</p></td>
<td align="left" valign="top"><p>string</p></td>
<td align="left" valign="top"><p>Operating system platform. Value of <code class="literal">Environment.OSVersion.Platform</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.version</p></td>
<td align="left" valign="top"><p>string</p></td>
<td align="left" valign="top"><p>Operating system version. Value of <code class="literal">Environment.OSVersion.Version</code>.</p></td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_process_fields"></a>Process fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ecs-dotnet/edit/main/docs/data-shippers/extensions-logging.asciidoc">edit</a></h3>
</div></div></div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Can be disabled via configuration.</p>
</div>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Field</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>process.name</p></td>
<td align="left" valign="top"><p>string</p></td>
<td align="left" valign="top"><p>The current process name. From <code class="literal">Process.GetCurrentProcess()</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>process.pid</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p>The current process ID. From <code class="literal">Process.GetCurrentProcess()</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>process.thread.id</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p>Current thread ID. Value of <code class="literal">Thread.CurrentThread.ManagedThreadId</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>process.thread.name</p></td>
<td align="left" valign="top"><p>string</p></td>
<td align="left" valign="top"><p>Name of the thread. From <code class="literal">Thread.CurrentThread.Name</code>.</p></td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_user_fields"></a>User fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ecs-dotnet/edit/main/docs/data-shippers/extensions-logging.asciidoc">edit</a></h3>
</div></div></div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Can be disabled via configuration.</p>
</div>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Field</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>user.domain</p></td>
<td align="left" valign="top"><p>string</p></td>
<td align="left" valign="top"><p>The current domain, either the machine name or a Windows domain. Value of <code class="literal">Environment.UserDomainName</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>user.id</p></td>
<td align="left" valign="top"><p>string</p></td>
<td align="left" valign="top"><p>Current user principal name, if set. Value of <code class="literal">Thread.CurrentPrincipal.Identity.Name</code>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>user.name</p></td>
<td align="left" valign="top"><p>string</p></td>
<td align="left" valign="top"><p>The current user. Value of <code class="literal">Environment.UserName</code>.</p></td>
</tr>
</tbody>
</table>
</div>
</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="serilog-data-shipper.html">« Elastic.Serilog.Sinks</a>
</span>
<span class="next">
<a href="benchmark-dotnet-data-shipper.html">BenchmarkDotnet Exporter »</a>
</span>
</div>
</div>
</body>
</html>
