<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Serilog formatter | ECS Logging .NET Reference | Elastic</title>
<meta class="elastic" name="content" content="Serilog formatter | ECS Logging .NET Reference">

<link rel="home" href="index.html" title="ECS Logging .NET Reference"/>
<link rel="up" href="_formatters.html" title="Formatters"/>
<link rel="prev" href="_formatters.html" title="Formatters"/>
<link rel="next" href="nlog-formatter.html" title="NLog Layout"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="ECS Logging .NET Reference"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/ECS-logging/.NET/Guide"/>
<meta name="DC.subject" content="ECS Logging .NET Reference"/>
<meta name="DC.identifier" content="master"/>
</head>
<body>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link">
  <div id="related-products" class="dropdown">
    <div class="related-products-title">ECS Logging:</div>
    <div class="dropdown-anchor" tabindex="0">.NET Reference<span class="dropdown-icon"></span></div>
    <div class="dropdown-content">
      <ul>
        <li><a href="/guide/en/ecs-logging/overview/current/intro.html">Reference</a></li>
        <li><a href="/guide/en/ecs-logging/go-logrus/current/intro.html">Go (Logrus) Reference</a></li>
        <li><a href="/guide/en/ecs-logging/go-zap/current/intro.html">Go (zap) Reference</a></li>
        <li><a href="/guide/en/ecs-logging/java/current/intro.html">Java Reference</a></li>
        <li><a href="/guide/en/ecs-logging/dotnet/current/intro.html">.NET Reference</a></li>
        <li><a href="/guide/en/ecs-logging/nodejs/current/intro.html">Node.js Reference</a></li>
        <li><a href="/guide/en/ecs-logging/ruby/current/intro.html">Ruby Reference</a></li>
        <li><a href="/guide/en/ecs-logging/php/current/intro.html">PHP Reference</a></li>
        <li><a href="/guide/en/ecs-logging/python/current/intro.html">Python Reference</a></li>
      </ul>
    </div>
  </div>
</span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="_formatters.html">Formatters</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="_formatters.html">« Formatters</a>
</span>
<span class="next">
<a href="nlog-formatter.html">NLog Layout »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="serilog-formatter"></a>Serilog formatter<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ecs-dotnet/edit/main/docs/formatters/serilog.asciidoc">edit</a></h2>
</div></div></div>
<p>This <code class="literal">ITextFormatter</code> implementation formats a Serilog event into a JSON representation that adheres to the Elastic Common Schema specification.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_installation_2"></a>Installation<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ecs-dotnet/edit/main/docs/formatters/serilog.asciidoc">edit</a></h3>
</div></div></div>
<p>Add a reference to the <a href="http://nuget.org/packages/Elastic.CommonSchema.Serilog" class="ulink" target="_top">Elastic.CommonSchema.Serilog</a> package:</p>
<div class="pre_wrapper lang-xml">
<pre class="programlisting prettyprint lang-xml">&lt;PackageReference Include="Elastic.CommonSchema.Serilog" Version="8.6.0" /&gt;</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_usage_2"></a>Usage<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ecs-dotnet/edit/main/docs/formatters/serilog.asciidoc">edit</a></h3>
</div></div></div>
<div class="pre_wrapper lang-csharp">
<pre class="programlisting prettyprint lang-csharp">var logger = new LoggerConfiguration()
    .WriteTo.Console(new EcsTextFormatter())
    .CreateLogger();</pre>
</div>
<p>In the code snippet above <code class="literal">new EcsTextFormatter()</code> enables the text formatter and instructs Serilog to format the event as JSON. The sample above uses the Console sink, but you are free to use any sink of your choice, perhaps consider using a filesystem sink and <a href="/downloads/beats/filebeat" class="ulink" target="_top">Elastic Filebeat</a> for durable and reliable ingestion.</p>
<p>In ASP.NET (core) applications</p>
<div class="pre_wrapper lang-csharp">
<pre class="programlisting prettyprint lang-csharp">.UseSerilog((ctx, config) =&gt;
{
	// Ensure HttpContextAccessor is accessible
	var httpAccessor = ctx.Configuration.Get&lt;HttpContextAccessor&gt;();

	config
		.ReadFrom.Configuration(ctx.Configuration)
		.Enrich.WithEcsHttpContext(httpAccessor)
		.WriteTo.Async(a =&gt; a.Console(new EcsTextFormatter()));
})</pre>
</div>
<p>The <code class="literal">WithEcsHttpContext</code> ensures logs will be enriched with <code class="literal">HttpContext</code> data.</p>
<p>An example of the output is given below:</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
  "@timestamp": "2019-11-22T14:59:02.5903135+11:00",
  "log.level": "Information",
  "message": "Log message",
  "ecs": {
    "version": "1.4.0"
  },
  "event": {
    "severity": 0,
    "timezone": "AUS Eastern Standard Time",
    "created": "2019-11-22T14:59:02.5903135+11:00"
  },
  "log": {
    "logger": "Elastic.CommonSchema.Serilog"
  },
  "process": {
    "thread": {
      "id": 1
    },
    "executable": "System.Threading.ExecutionContext"
  }
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_configuration"></a>Configuration<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ecs-dotnet/edit/main/docs/formatters/serilog.asciidoc">edit</a></h3>
</div></div></div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Option</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">MapCurrentThead</code></p></td>
<td align="left" valign="top"><p><code class="literal">true</code> map <code class="literal">ecs.process</code> by looking up the <code class="literal">Process</code> from the current thread</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">MapHttpAdapter</code></p></td>
<td align="left" valign="top"><p><code class="literal">null</code> a way to map <code class="literal">HttpContextAccessor</code> to ECS fields.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">LogEventsPropertiesToFilter</code></p></td>
<td align="left" valign="top"><p>A <code class="literal">Set&lt;string&gt;</code> of properties that should not be emitted as <code class="literal">labels.*</code> or <code class="literal">metadata.*</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">MapCustom</code></p></td>
<td align="left" valign="top"><p>A Func that allows you to mutate the EcsDocument before its fully converted.</p></td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_ecs_aware_message_templates_2"></a>ECS Aware Message Templates<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ecs-dotnet/edit/main/docs/formatters/serilog.asciidoc">edit</a></h3>
</div></div></div>
<p>This formatter also allows you to set ECS fields directly from the message template using properties that adhere to the
<a href="https://messagetemplates.org/" class="ulink" target="_top">https://messagetemplates.org/</a> format.</p>
<p>The available ECS message template properties are listed under <code class="literal">LogTemplateProperties.*</code> e.g <code class="literal">LogTemplateProperties.TraceId</code></p>
<div class="pre_wrapper lang-chsarp">
<pre class="programlisting prettyprint lang-chsarp">Log.Information("The time is {TraceId}", "my-trace-id");</pre>
</div>
<p>Will override <code class="literal">trace.id</code> on the resulting ECS json document.</p>
</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="_formatters.html">« Formatters</a>
</span>
<span class="next">
<a href="nlog-formatter.html">NLog Layout »</a>
</span>
</div>
</div>
</body>
</html>
