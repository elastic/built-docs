<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Network Fields | Elastic Common Schema (ECS) Reference [master] | Elastic</title>
<link rel="home" href="index.html" title="Elastic Common Schema (ECS) Reference [master]"/>
<link rel="up" href="ecs-field-reference.html" title="ECS Field Reference"/>
<link rel="prev" href="ecs-log.html" title="Log Fields"/>
<link rel="next" href="ecs-observer.html" title="Observer Fields"/>
<meta name="DC.type" content="Learn/Docs/Elastic Common Schema (ECS)/Reference/master"/>
<meta name="DC.subject" content="Elastic Common Schema (ECS)"/>
<meta name="DC.identifier" content="master"/>
</head>
<body><div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Elastic Common Schema (ECS) Reference [master]</a></span>
»
<span class="breadcrumb-link"><a href="ecs-field-reference.html">ECS Field Reference</a></span>
»
<span class="breadcrumb-node">Network Fields</span>
</div>
<div class="navheader">
<span class="prev">
<a href="ecs-log.html">« Log Fields</a>
</span>
<span class="next">
<a href="ecs-observer.html">Observer Fields »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="ecs-network"></a>Network Fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ecs/edit/master/docs/field-details.asciidoc">edit</a></h2>
</div></div></div>
<p>The network is defined as the communication path over which a host or network event happens.</p>
<p>The network.* fields should be populated with details about the network activity associated with an event.</p>
<h4><a id="_network_field_details"></a>Network Field Details<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ecs/edit/master/docs/field-details.asciidoc">edit</a></h4>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Field</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Level</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>network.application</p></td>
<td align="left" valign="top"><p>A name given to an application level protocol. This can be arbitrarily assigned for things like microservices, but also apply to things like skype, icq, facebook, twitter. This would be used in situations where the vendor or service can be decoded such as from the source/dest IP owners, ports, or wire format.</p>
<p>The field value must be normalized to lowercase for querying. See the documentation section "Implementing ECS".</p>
<p>type: keyword</p>
<p>example: <code class="literal">aim</code></p></td>
<td align="left" valign="top"><p>extended</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>network.bytes</p></td>
<td align="left" valign="top"><p>Total bytes transferred in both directions.</p>
<p>If <code class="literal">source.bytes</code> and <code class="literal">destination.bytes</code> are known, <code class="literal">network.bytes</code> is their sum.</p>
<p>type: long</p>
<p>example: <code class="literal">368</code></p></td>
<td align="left" valign="top"><p>core</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>network.community_id</p></td>
<td align="left" valign="top"><p>A hash of source and destination IPs and ports, as well as the protocol used in a communication. This is a tool-agnostic standard to identify flows.</p>
<p>Learn more at <a href="https://github.com/corelight/community-id-spec" class="ulink" target="_top">https://github.com/corelight/community-id-spec</a>.</p>
<p>type: keyword</p>
<p>example: <code class="literal">1:hO+sN4H+MG5MY/8hIrXPqc4ZQz0=</code></p></td>
<td align="left" valign="top"><p>extended</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>network.direction</p></td>
<td align="left" valign="top"><p>Direction of the network traffic.</p>
<p>Recommended values are:</p>
<p>  * inbound</p>
<p>  * outbound</p>
<p>  * internal</p>
<p>  * external</p>
<p>  * unknown</p>
<p>When mapping events from a host-based monitoring context, populate this field from the host&#8217;s point of view.</p>
<p>When mapping events from a network or perimeter-based monitoring context, populate this field from the point of view of your network perimeter.</p>
<p>type: keyword</p>
<p>example: <code class="literal">inbound</code></p></td>
<td align="left" valign="top"><p>core</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>network.forwarded_ip</p></td>
<td align="left" valign="top"><p>Host IP address when the source IP address is the proxy.</p>
<p>type: ip</p>
<p>example: <code class="literal">192.1.1.2</code></p></td>
<td align="left" valign="top"><p>core</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>network.iana_number</p></td>
<td align="left" valign="top"><p>IANA Protocol Number (<a href="https://www.iana.org/assignments/protocol-numbers/protocol-numbers.xhtml" class="ulink" target="_top">https://www.iana.org/assignments/protocol-numbers/protocol-numbers.xhtml</a>). Standardized list of protocols. This aligns well with NetFlow and sFlow related logs which use the IANA Protocol Number.</p>
<p>type: keyword</p>
<p>example: <code class="literal">6</code></p></td>
<td align="left" valign="top"><p>extended</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>network.inner</p></td>
<td align="left" valign="top"><p>Network.inner fields are added in addition to network.vlan fields to describe  the innermost VLAN when q-in-q VLAN tagging is present. Allowed fields include  vlan.id and vlan.name. Inner vlan fields are typically used when sending traffic with multiple 802.1q encapsulations to a network sensor (e.g. Zeek, Wireshark.)</p>
<p>type: object</p></td>
<td align="left" valign="top"><p>extended</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>network.name</p></td>
<td align="left" valign="top"><p>Name given by operators to sections of their network.</p>
<p>type: keyword</p>
<p>example: <code class="literal">Guest Wifi</code></p></td>
<td align="left" valign="top"><p>extended</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>network.packets</p></td>
<td align="left" valign="top"><p>Total packets transferred in both directions.</p>
<p>If <code class="literal">source.packets</code> and <code class="literal">destination.packets</code> are known, <code class="literal">network.packets</code> is their sum.</p>
<p>type: long</p>
<p>example: <code class="literal">24</code></p></td>
<td align="left" valign="top"><p>core</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>network.protocol</p></td>
<td align="left" valign="top"><p>L7 Network protocol name. ex. http, lumberjack, transport protocol.</p>
<p>The field value must be normalized to lowercase for querying. See the documentation section "Implementing ECS".</p>
<p>type: keyword</p>
<p>example: <code class="literal">http</code></p></td>
<td align="left" valign="top"><p>core</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>network.transport</p></td>
<td align="left" valign="top"><p>Same as network.iana_number, but instead using the Keyword name of the transport layer (udp, tcp, ipv6-icmp, etc.)</p>
<p>The field value must be normalized to lowercase for querying. See the documentation section "Implementing ECS".</p>
<p>type: keyword</p>
<p>example: <code class="literal">tcp</code></p></td>
<td align="left" valign="top"><p>core</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>network.type</p></td>
<td align="left" valign="top"><p>In the OSI Model this would be the Network Layer. ipv4, ipv6, ipsec, pim, etc</p>
<p>The field value must be normalized to lowercase for querying. See the documentation section "Implementing ECS".</p>
<p>type: keyword</p>
<p>example: <code class="literal">ipv4</code></p></td>
<td align="left" valign="top"><p>core</p></td>
</tr>
</tbody>
</table>
</div>
<h4><a id="_field_reuse_12"></a>Field Reuse<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ecs/edit/master/docs/field-details.asciidoc">edit</a></h4>
<h5><a id="ecs-network-nestings"></a>Field sets that can be nested under Network<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ecs/edit/master/docs/field-details.asciidoc">edit</a></h5>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Nested fields</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><a class="xref" href="ecs-vlan.html" title="VLAN Fields">network.inner.vlan.*</a></p></td>
<td align="left" valign="top"><p>Fields to describe observed VLAN information.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="ecs-vlan.html" title="VLAN Fields">network.vlan.*</a></p></td>
<td align="left" valign="top"><p>Fields to describe observed VLAN information.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="ecs-log.html">« Log Fields</a>
</span>
<span class="next">
<a href="ecs-observer.html">Observer Fields »</a>
</span>
</div>
</div>
</body>
</html>
