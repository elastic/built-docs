<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>ES|QL in the Go client | Elasticsearch Go Client [8.15] | Elastic</title>
<meta class="elastic" name="content" content="ES|QL in the Go client | Elasticsearch Go Client [8.15]">

<link rel="home" href="index.html" title="Elasticsearch Go Client [8.15]"/>
<link rel="up" href="typedapi.html" title="Typed API"/>
<link rel="prev" href="runningqueries.html" title="Running Queries"/>
<link rel="next" href="examples.html" title="Examples"/>
<meta class="elastic" name="product_version" content="8.15"/>
<meta class="elastic" name="product_name" content="Clients"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Clients/Go/8.15"/>
<meta name="DC.subject" content="Clients"/>
<meta name="DC.identifier" content="8.15"/>
</head>
<body>
<div class="navheader">
<span class="prev">
<a href="runningqueries.html">« Running Queries</a>
</span>
<span class="next">
<a href="examples.html">Examples »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elasticsearch Go Client [8.15]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="typedapi.html">Typed API</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>ES|QL in the Go client</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/go-elasticsearch/edit/8.15/.doc/typedapi/esql.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="esql"></a>ES|QL in the Go client<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/go-elasticsearch/edit/8.15/.doc/typedapi/esql.asciidoc">edit</a></h2>
</div></div></div>

<p>This page helps you understand and use <a href="/guide/en/elasticsearch/reference/8.15/esql.html" class="ulink" target="_top">ES|QL</a> in the
Go client.</p>
<p>There are two ways to use ES|QL in the Go client:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Use the Elasticsearch <a href="/guide/en/elasticsearch/reference/8.15/esql-apis.html" class="ulink" target="_top">ES|QL API</a> directly: This
is the most flexible approach, but it&#8217;s also the most complex because you must handle
results in their raw form. You can choose the precise format of results,
such as JSON, CSV, or text.
</li>
<li class="listitem">
Use ES|QL mapping helpers: These mappers take care of parsing the raw
response into something readily usable by the application. Helpers are
available for object mapping and iterative objects.
</li>
</ul>
</div>
<h4><a id="esql-how-to"></a>How to use the ES|QL API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/go-elasticsearch/edit/8.15/.doc/typedapi/esql.asciidoc">edit</a></h4>
<p>The <a href="/guide/en/elasticsearch/reference/8.15/esql-query-api.html" class="ulink" target="_top">ES|QL query API</a> allows you to specify how
results should be returned. You can choose a
<a href="/guide/en/elasticsearch/reference/8.15/esql-rest.html#esql-rest-format" class="ulink" target="_top">response format</a> such as CSV, text, or
JSON, then fine-tune it with parameters like column separators
and locale.</p>
<p>The following example gets ES|QL results as CSV and parses them:</p>
<div class="pre_wrapper lang-go">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-go">queryAuthor := `from library
    | where author == "Isaac Asimov"
    | sort release_date desc
    | limit 10`

response, err := client.Esql.Query().
    Query(queryAuthor).
    Format("csv").
    Do(context.Background())
if err != nil {
    log.Fatal(err)
}

reader := csv.NewReader(bytes.NewReader(response))
rows, err := reader.ReadAll()
for _, row := range rows {
    fmt.Println(row)
}</pre>
</div>
<h4><a id="esql-consume-results"></a>Consume ES|QL results<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/go-elasticsearch/edit/8.15/.doc/typedapi/esql.asciidoc">edit</a></h4>
<p>The previous example showed that although the raw ES|QL API offers maximum
flexibility, additional work is required in order to make use of the
result data.</p>
<p>To simplify things, try working with these two main representations of ES|QL
results (each with its own mapping helper):</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Objects</strong></span>, where each row in the results is mapped to an object from your
application domain. This is similar to what ORMs (object relational mappers)
commonly do.
</li>
</ul>
</div>
<div class="pre_wrapper lang-go">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-go">package main

import (
	"context"
	"fmt"
	"log"

	"github.com/elastic/go-elasticsearch/v8"
	"github.com/elastic/go-elasticsearch/v8/typedapi/esql/query"
)

type Book struct {
	Name        string `json:"name"`
	Author      string `json:"author"`
	ReleaseDate string `json:"release_date"`
	PageCount   int    `json:"page_count"`
}

func main() {
	client, err := elasticsearch.NewTypedClient(elasticsearch.Config{Addresses: []string{"ELASTICSEARCH_URL"}})
	if err != nil {
		log.Fatal(err)
	}

	queryAuthor := `from library
        | where author == "Isaac Asimov"
        | sort release_date desc
        | limit 10`

	qry := client.Esql.Query().Query(queryAuthor)
	books, err := query.Helper[Book](context.Background(), qry)
	if err != nil {
		log.Fatal(err)
	}

	for _, book := range books {
		fmt.Println(book)
	}
}</pre>
</div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Iterative Objects</strong></span>, where each row in the results is mapped to an object from your
application domain, one at a time.
</li>
</ul>
</div>
<div class="pre_wrapper lang-go">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-go">queryAuthor := `from library
    | where author == "Isaac Asimov"
    | sort release_date desc
    | limit 10`

qry := client.Esql.Query().Query(queryAuthor)
books, err := query.NewIteratorHelper[Book](context.Background(), qry)
if err != nil {
    log.Fatal(err)
}

for books.More() {
    book, err := books.Next()
    if err != nil {
        log.Fatal(err)
    }
    fmt.Println(book)
}</pre>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="runningqueries.html">« Running Queries</a>
</span>
<span class="next">
<a href="examples.html">Examples »</a>
</span>
</div>
</body>
</html>
