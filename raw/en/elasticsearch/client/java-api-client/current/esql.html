<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>ES|QL in the Java client | Elasticsearch Java API Client [8.15] | Elastic</title>
<meta class="elastic" name="content" content="ES|QL in the Java client | Elasticsearch Java API Client [8.15]">

<link rel="home" href="index.html" title="Elasticsearch Java API Client [8.15]"/>
<link rel="up" href="usage.html" title="Using the Java API Client"/>
<link rel="prev" href="usage.html" title="Using the Java API Client"/>
<link rel="next" href="indexing.html" title="Indexing single documents"/>
<meta class="elastic" name="product_version" content="8.15"/>
<meta class="elastic" name="product_name" content="Clients"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Clients/Java/8.15"/>
<meta name="DC.subject" content="Clients"/>
<meta name="DC.identifier" content="8.15"/>
</head>
<body>
<div class="navheader">
<span class="prev">
<a href="usage.html">« Using the Java API Client</a>
</span>
<span class="next">
<a href="indexing.html">Indexing single documents »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elasticsearch Java API Client [8.15]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="usage.html">Using the Java API Client</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>ES|QL in the Java client</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-java/edit/8.15/docs/usage/esql.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="esql"></a>ES|QL in the Java client<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-java/edit/8.15/docs/usage/esql.asciidoc">edit</a></h2>
</div></div></div>
<p>This page helps you understand and use <a href="/guide/en/elasticsearch/reference/8.15/esql.html" class="ulink" target="_top">ES|QL</a> in the
Java client.</p>
<p>There are two ways to use ES|QL in the Java API Client:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Use the Elasticsearch <a href="/guide/en/elasticsearch/reference/8.15/esql-apis.html" class="ulink" target="_top">ES|QL API</a> directly: This
is the most flexible approach, but it&#8217;s also the most complex because you must handle
results in their raw form. You can choose the precise format of results,
such as JSON, CSV, or text.
</li>
<li class="listitem">
Use ES|QL mapping helpers: These mappers take care of parsing the raw
response into something readily usable by the application. Several mappers are
available for different use cases, such as object mapping, cursor
traversal of results, and dataframes. You can also define your own mapper for specific
use cases.
</li>
</ul>
</div>
<h4><a id="esql-how-to"></a>How to use the ES|QL API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-java/edit/8.15/docs/usage/esql.asciidoc">edit</a></h4>
<p>The <a href="/guide/en/elasticsearch/reference/8.15/esql-query-api.html" class="ulink" target="_top">ES|QL query API</a> allows you to specify how
results should be returned. You can choose a
<a href="/guide/en/elasticsearch/reference/8.15/esql-rest.html#esql-rest-format" class="ulink" target="_top">response format</a> such as CSV, text, or
JSON, then fine-tune it with parameters like column separators
and locale.</p>
<p>Because the response varies widely depending on the format, the
Java API Client has a BinaryData object you can use according to the
format specified in the request.</p>
<p>The following example gets ES|QL results as CSV and parses them:</p>
<div class="pre_wrapper lang-java">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-java">String queryAuthor =
    """
        from books
        | where author == "Isaac Asimov"
        | sort year desc
        | limit 10
    """;

BinaryResponse response = client.esql().query(q -&gt; q
    .format("csv")
    .delimiter(",")
    .query(queryAuthor));

String result = new BufferedReader(new InputStreamReader(response.content()))
    .lines().collect(Collectors.joining("\n"));</pre>
</div>
<h4><a id="esql-consume-results"></a>Consume ES|QL results<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-java/edit/8.15/docs/usage/esql.asciidoc">edit</a></h4>
<p>The previous example showed that although the raw ES|QL API offers maximum
flexibility, additional work is required in order to make use of the
result data.</p>
<p>To simplify things, try working with these three main representations of ES|QL
results (each with its own mapping helper):</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p><span class="strong strong"><strong>Objects</strong></span>, where each row in the results is mapped to an object from your
application domain. This is similar to what ORMs (object relational mappers)
commonly do.</p>
<div class="pre_wrapper lang-java">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-java">List&lt;Book&gt; queryRes = (List&lt;Book&gt;) client.esql().query(ObjectsEsqlAdapter.of(Book.class), queryAuthor);</pre>
</div>
</li>
<li class="listitem">
<p><span class="strong strong"><strong>Cursors</strong></span>, where you scan the results row by row and access the data using
column names. This is similar to database access libraries.</p>
<div class="pre_wrapper lang-java">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-java">ResultSet resultSet = client.esql().query(ResultSetEsqlAdapter.INSTANCE, queryAuthor);</pre>
</div>
</li>
</ul>
</div>
<h4><a id="esql-custom-mapping"></a>Define your own mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-java/edit/8.15/docs/usage/esql.asciidoc">edit</a></h4>
<p>Although the mappers provided by the Java API Client cover many use cases, your
application might require a custom mapping.
You can write your own mapper and use it in a similar way as the
built-in ones.</p>
<p>Note that mappers are meant to provide a more usable representation of ES|QL
results—not to process the result data. Data processing should be based on
the output of a result mapper.</p>
<p>Here&#8217;s an example mapper that returns a simple column-oriented
representation of the data:</p>
<div class="pre_wrapper lang-java">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-java">public class CustomStringAdapter extends EsqlAdapterBase&lt;String&gt; {

    public static final CustomStringAdapter INSTANCE = new CustomStringAdapter();

    @Override
    public String format() {
        return "json";
    }

    @Override
    public boolean columnar() {
        return true;
    }

    @Override
    public String deserialize(ApiClient&lt;ElasticsearchTransport, ?&gt; client, QueryRequest request,
                              BinaryResponse response)
        throws IOException {
        return new BufferedReader(new InputStreamReader(response.content()))
            .lines().collect(Collectors.joining("\n"));
    }
}</pre>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="usage.html">« Using the Java API Client</a>
</span>
<span class="next">
<a href="indexing.html">Indexing single documents »</a>
</span>
</div>
</body>
</html>
