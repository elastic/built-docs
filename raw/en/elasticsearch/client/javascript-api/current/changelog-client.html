<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Changelog | Elasticsearch Node.js client [7.x] | Elastic</title>
<link rel="home" href="index.html" title="Elasticsearch Node.js client [7.x]"/>
<link rel="up" href="index.html" title="Elasticsearch Node.js client [7.x]"/>
<link rel="prev" href="installation.html" title="Installation"/>
<link rel="next" href="client-usage.html" title="Usage"/>
<meta name="DC.type" content="Learn/Docs/Clients/JavaScript/7.x"/>
<meta name="DC.subject" content="Clients"/>
<meta name="DC.identifier" content="7.x"/>
</head>
<body>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Elasticsearch Node.js client [7.x]</a></span>
»
<span class="breadcrumb-node">Changelog</span>
</div>
<div class="navheader">
<span class="prev">
<a href="installation.html">« Installation</a>
</span>
<span class="next">
<a href="client-usage.html">Usage »</a>
</span>
</div>
<div class="chapter">
<div class="titlepage"><div><div>
<h1 class="title"><a id="changelog-client"></a>Changelog<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h1>
</div></div></div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="_7_9_1"></a>7.9.1<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h2>
</div></div></div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_fixes"></a>Fixes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h3>
</div></div></div>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_improve_child_performances_1314"></a>Improve child performances <a href="https://github.com/elastic/elasticsearch-js/pull/1314" class="ulink" target="_top">#1314</a><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h4>
</div></div></div>
<p>The client code has been refactored to speed up the performances of the child method.
Before this pr, creating many children per second would have caused a high memory consumption and a spike in CPU usage.
This pr changes the way the client is created by refactoring the code generation, now the clients methods are no longer added to the instance with a for loop but via prototypal inheritance. Thus, the overall performances are way better, now creating a child is ~5 times faster, and it consumes ~70% less memory.</p>
<p>This change should not cause any breaking change unless you were mocking the client methods. In such case you should refactor it, or use <a href="https://github.com/elastic/elasticsearch-js-mock" class="ulink" target="_top">elasticsearch-js-mock</a>.</p>
<p>Finally, this change should also fix once and of all the bundlers support.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_throw_all_errors_asynchronously_1295"></a>Throw all errors asynchronously <a href="https://github.com/elastic/elasticsearch-js/pull/1295" class="ulink" target="_top">#1295</a><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h4>
</div></div></div>
<p>Some validation errors were thrown synchronously, causing the callback to be called in th same tick.
This issue is known as <em>"The release fo Zalgo"</em> (see <a href="https://blog.izs.me/2013/08/designing-apis-for-asynchrony" class="ulink" target="_top">here</a>).</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_fix_maxretries_request_option_handling_1296"></a>Fix <code class="literal">maxRetries</code> request option handling <a href="https://github.com/elastic/elasticsearch-js/pull/1296" class="ulink" target="_top">#1296</a><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h4>
</div></div></div>
<p>The <code class="literal">maxRetries</code> parameter can be configured on a per requets basis, if set to zero it was defaulting to the client default. Now the client is honoring the request specific configuration.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_fix_requestoptions_body_type_to_include_null_1300"></a>Fix RequestOptions.body type to include null <a href="https://github.com/elastic/elasticsearch-js/pull/1300" class="ulink" target="_top">#1300</a><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h4>
</div></div></div>
<p>The Connection requets option types were not accepting <code class="literal">null</code> as valid value.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_fixed_size_and_maxretries_parameters_in_helpers_1284"></a>Fixed <code class="literal">size</code> and <code class="literal">maxRetries</code> parameters in helpers <a href="https://github.com/elastic/elasticsearch-js/pull/1284" class="ulink" target="_top">#1284</a><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h4>
</div></div></div>
<p>The <code class="literal">size</code> parameter was being passed too the scroll request, which was causing an error.
<code class="literal">maxRetries</code> setted to 0 was resulting in no request at all.</p>
</div>

</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="_7_9_0"></a>7.9.0<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h2>
</div></div></div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_features_2"></a>Features<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h3>
</div></div></div>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_add_ability_to_disable_the_http_agent_1251"></a>Add ability to disable the http agent <a href="https://github.com/elastic/elasticsearch-js/pull/1251" class="ulink" target="_top">#1251</a><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h4>
</div></div></div>
<p>If needed, the http agent can be disabled by setting it to <code class="literal">false</code></p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">const { Client } = require('@elastic/elasticsearch')
const client = new Client({
  node: 'http://localhost:9200'.
  agent: false
})</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_add_support_for_a_global_context_option_1256"></a>Add support for a global context option <a href="https://github.com/elastic/elasticsearch-js/pull/1256" class="ulink" target="_top">#1256</a><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h4>
</div></div></div>
<p>Before this, you could set a <code class="literal">context</code> option in each request, but there was no way of setting it globally.
Now you can by configuring the <code class="literal">context</code> object in the global configuration, that will be merged with the local one.</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">const { Client } = require('@elastic/elasticsearch')
const client = new Client({
  node: 'http://localhost:9200'.
  context: { meta: 'data' }
})</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_esm_support_1235"></a>ESM support <a href="https://github.com/elastic/elasticsearch-js/pull/1235" class="ulink" target="_top">#1235</a><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h4>
</div></div></div>
<p>If you are using ES Modules, now you can easily import the client!</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">import { Client } from '@elastic/elasticsearch'</pre>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_fixes_2"></a>Fixes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h3>
</div></div></div>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_allow_the_client_name_to_be_a_symbol_1254"></a>Allow the client name to be a symbol <a href="https://github.com/elastic/elasticsearch-js/pull/1254" class="ulink" target="_top">#1254</a><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h4>
</div></div></div>
<p>It was possible in plain JavaScript, but not in TypeScript, now you can do it in TypeScript as well.</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">const { Client } = require('@elastic/elasticsearch')
const client = new Client({
  node: 'http://localhost:9200',
  name: Symbol('unique')
})</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_fixed_transport_request_querystring_type_1240"></a>Fixed transport.request querystring type <a href="https://github.com/elastic/elasticsearch-js/pull/1240" class="ulink" target="_top">#1240</a><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h4>
</div></div></div>
<p>Only <code class="literal">Record&lt;string, any&gt;</code> was allowed. Now <code class="literal">string</code> is allowed as well.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_fixed_type_definitions_1263"></a>Fixed type definitions <a href="https://github.com/elastic/elasticsearch-js/pull/1263" class="ulink" target="_top">#1263</a><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h4>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
The <code class="literal">transport.request</code> defintion was incorrect, it was returning a <code class="literal">Promise&lt;T&gt;</code> instead of <code class="literal">TransportRequestPromise&lt;T&gt;</code>.
</li>
<li class="listitem">
The <code class="literal">refresh</code> parameter of most APIs was declared as <code class="literal">'true' | 'false' | 'wait_for'</code>, which was clunky. Now is <code class="literal">'wait_for' | boolean</code>.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_generate_response_type_as_boolean_if_the_request_is_head_only_1275"></a>Generate response type as boolean if the request is HEAD only <a href="https://github.com/elastic/elasticsearch-js/pull/1275" class="ulink" target="_top">#1275</a><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h4>
</div></div></div>
<p>All HEAD request will have the body casted to a boolean value, <code class="literal">true</code> in case of a 200 response, <code class="literal">false</code> in case of
a 404 response. The type definitions were not reflecting this behavior.</p>
<div class="pre_wrapper lang-ts">
<pre class="programlisting prettyprint lang-ts">import { Client } from '@elastic/elasticsearch'
const client = new Client({
  node: 'http://localhost:9200'
})

const { body } = await client.exist({ index: 'my-index', id: 'my-id' })
console.log(body) // either `true` or `false`</pre>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_internals"></a>Internals<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h3>
</div></div></div>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_updated_default_http_agent_configuration_1242"></a>Updated default http agent configuration <a href="https://github.com/elastic/elasticsearch-js/pull/1242" class="ulink" target="_top">#1242</a><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h4>
</div></div></div>
<p>Added the scheduling: <em>lifo</em> option to the default HTTP agent configuration to avoid maximizing the open sockets
against Elasticsearch and lowering the risk of encountering socket timeouts.
This feature is only available from Node v14.5+, but it should be backported to v10 and v12. (<a href="https://github.com/nodejs/node/pull/33278" class="ulink" target="_top">nodejs/node#33278</a>)</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_improve_child_api_1245"></a>Improve child API <a href="https://github.com/elastic/elasticsearch-js/pull/1245" class="ulink" target="_top">#1245</a><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h4>
</div></div></div>
<p>This pr introduce two changes which should not impact the surface API:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Refactored the <code class="literal">client.child</code> API to allocate fewer objects, this change improves memory consumption over time
and improves the child creation performances by ~12%.
</li>
<li class="listitem">
The client no longer inherits from the EventEmitter class, but instead has an internal event emitter and exposes
only the API useful for the users, namely <code class="literal">emit, `on</code>, <code class="literal">once</code>, and <code class="literal">off</code>. The type definitions have been updated accordingly.
</li>
</ul>
</div>
</div>

</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="_7_8_0"></a>7.8.0<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h2>
</div></div></div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_features_3"></a>Features<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h3>
</div></div></div>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_support_for_elasticsearch_v7_8"></a>Support for Elasticsearch <code class="literal">v7.8</code>.<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h4>
</div></div></div>
<p>You can find all the API changes <a href="/guide/en/elasticsearch/reference/7.8/release-notes-7.8.0.html" class="ulink" target="_top">here</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_added_multi_search_helper_1186"></a>Added multi search helper <a href="https://github.com/elastic/elasticsearch-js/pull/1186" class="ulink" target="_top">#1186</a><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h4>
</div></div></div>
<p>If you are sending search request at a high rate, this helper might be useful for you.
It will use the mutli search API under the hood to batch the requests and improve the overall performances of your application.<br>
The <code class="literal">result</code> exposes a <code class="literal">documents</code> property as well, which allows you to access directly the hits sources.</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">const { Client } = require('@elastic/elasticsearch')

const client = new Client({ node: 'http://localhost:9200' })
const m = client.helpers.msearch()

// promise style API
m.search(
    { index: 'stackoverflow' },
    { query: { match: { title: 'javascript' } } }
  )
  .then(result =&gt; console.log(result.body)) // or result.documents
  .catch(err =&gt; console.error(err))

// callback style API
m.search(
  { index: 'stackoverflow' },
  { query: { match: { title: 'ruby' } } },
  (err, result) =&gt; {
    if (err) console.error(err)
    console.log(result.body)) // or result.documents
  }
)</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_added_timeout_support_in_bulk_and_msearch_helpers_1206"></a>Added timeout support in bulk and msearch helpers <a href="https://github.com/elastic/elasticsearch-js/pull/1206" class="ulink" target="_top">#1206</a><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h4>
</div></div></div>
<p>If there is a slow producer, the bulk helper might send data with a very large period of time, and if the process crashes for any reason, the data would be lost.
This pr introduces a <code class="literal">flushInterval</code> option in the bulk helper to avoid this issue. By default, the bulk helper will flush the data automatically every 30 seconds, unless the threshold has been reached before.</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">const b = client.helpers.bulk({
  flushInterval: 30000
})</pre>
</div>
<p>The same problem might happen with the multi search helper, where the user is not sending search requests fast enough. A <code class="literal">flushInterval</code> options has been added as well, with a default value of 500 milliseconds.</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">const m = client.helpers.msearch({
  flushInterval: 500
})</pre>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_internals_2"></a>Internals<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h3>
</div></div></div>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_use_filter_path_for_improving_the_search_helpers_performances_1199"></a>Use filter_path for improving the search helpers performances <a href="https://github.com/elastic/elasticsearch-js/pull/1199" class="ulink" target="_top">#1199</a><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h4>
</div></div></div>
<p>From now on, all he search helpers will use the <code class="literal">filter_path</code> option automatically when needed to retrieve only the hits source. This change will result in less netwprk traffic and improved deserialization performances.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_search_helpers_documents_getter_1186"></a>Search helpers documents getter <a href="https://github.com/elastic/elasticsearch-js/pull/1186" class="ulink" target="_top">#1186</a><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h4>
</div></div></div>
<p>Before this, the <code class="literal">documents</code> key that you can access in any search helper was computed as soon as we got the search result from Elasticsearch. With this change the <code class="literal">documents</code> key is now a getter, which makes this procees lazy, resulting in better performances and lower memory impact.</p>
</div>

</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="_7_7_1"></a>7.7.1<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h2>
</div></div></div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_fixes_3"></a>Fixes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h3>
</div></div></div>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_disable_client_helpers_in_node_js_10_1194"></a>Disable client Helpers in Node.js &lt; 10 - <a href="https://github.com/elastic/elasticsearch-js/pull/1194" class="ulink" target="_top">#1194</a><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h4>
</div></div></div>
<p>The client helpers can&#8217;t be used in Node.js &lt; 10 because it needs a custom flag to be able to use them.
Given that not every provider allows the user to specify cuatom Node.js flags, the Helpers has been disabled completely in Node.js &lt; 10.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_force_lowercase_in_all_headers_1187"></a>Force lowercase in all headers - <a href="https://github.com/elastic/elasticsearch-js/pull/1187" class="ulink" target="_top">#1187</a><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h4>
</div></div></div>
<p>Now all the user-provided headers names will be lowercased by default, so there will be no conflicts in case of the same header with different casing.</p>
</div>

</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="_7_7_0"></a>7.7.0<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h2>
</div></div></div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_features_4"></a>Features<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h3>
</div></div></div>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_support_for_elasticsearch_v7_7"></a>Support for Elasticsearch <code class="literal">v7.7</code>.<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h4>
</div></div></div>
<p>You can find all the API changes <a href="/guide/en/elasticsearch/reference/7.7/release-notes-7.7.0.html" class="ulink" target="_top">here</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_introduced_client_helpers_1107"></a>Introduced client helpers - <a href="https://github.com/elastic/elasticsearch-js/pull/1107" class="ulink" target="_top">#1107</a><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h4>
</div></div></div>
<p>From now on, the client comes with an handy collection of helpers to give you a more comfortable experience with some APIs.</p>
<div class="caution admon">
<div class="icon"></div>
<div class="admon_content">
<p>The client helpers are experimental, and the API may change in the next minor releases.</p>
</div>
</div>
<p>The following helpers has been introduced:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">client.helpers.bulk</code>
</li>
<li class="listitem">
<code class="literal">client.helpers.search</code>
</li>
<li class="listitem">
<code class="literal">client.helpers.scrollSearch</code>
</li>
<li class="listitem">
<code class="literal">client.helpers.scrollDocuments</code>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_the_connectionpool_getconnection_now_always_returns_a_connection_1127"></a>The <code class="literal">ConnectionPool.getConnection</code> now always returns a <code class="literal">Connection</code> - <a href="https://github.com/elastic/elasticsearch-js/pull/1127" class="ulink" target="_top">#1127</a><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h4>
</div></div></div>
<p>What does this mean? It means that you will see less <code class="literal">NoLivingConnectionError</code>, which now can only be caused if you set a selector/filter too strict.
For improving the debugging experience, the <code class="literal">NoLivingConnectionsError</code> error message has been updated.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_abortable_promises_1141"></a>Abortable promises - <a href="https://github.com/elastic/elasticsearch-js/pull/1141" class="ulink" target="_top">#1141</a><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h4>
</div></div></div>
<p>From now on, it will be possible to abort a request generated with the promise-styl API. If you abort a request generated from a promise, the promise will be rejected with a <code class="literal">RequestAbortedError</code>.</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">const promise = client.search({
  body: {
    query: { match_all: {} }
  }
})

promise
  .then(console.log)
  .catch(console.log)

promise.abort()</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_major_refactor_of_the_type_definitions_1119_1130_1132"></a>Major refactor of the Type Definitions - <a href="https://github.com/elastic/elasticsearch-js/pull/1119" class="ulink" target="_top">#1119</a> <a href="https://github.com/elastic/elasticsearch-js/issues/1130" class="ulink" target="_top">#1130</a> <a href="https://github.com/elastic/elasticsearch-js/pull/1132" class="ulink" target="_top">#1132</a><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h4>
</div></div></div>
<p>Now every API makes better use of the generics and overloading, so you can (or not, by default request/response bodies are <code class="literal">Record&lt;string, any&gt;</code>) define the request/response bodies in the generics.</p>
<div class="pre_wrapper lang-ts">
<pre class="programlisting prettyprint lang-ts">// request and response bodies are generics
client.search(...)
// response body is `SearchResponse` and request body is generic
client.search&lt;SearchResponse&gt;(...)
// request body is `SearchBody` and response body is `SearchResponse`
client.search&lt;SearchResponse, SearchBody&gt;(...)</pre>
</div>
<p>This <span class="strong strong"><strong>should</strong></span> not be a breaking change, as every generics defaults to <code class="literal">any</code>. It might happen to some users that the code breaks, but our test didn&#8217;t detect any of it, probably because they were not robust enough. However, given the gigantic improvement in the developer experience, we have decided to release this change in the 7.x line.</p>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_fixes_4"></a>Fixes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h3>
</div></div></div>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_the_connectionpool_update_method_now_cleans_the_dead_list_1122_1127"></a>The <code class="literal">ConnectionPool.update</code> method now cleans the <code class="literal">dead</code> list - <a href="https://github.com/elastic/elasticsearch-js/issues/1122" class="ulink" target="_top">#1122</a> <a href="https://github.com/elastic/elasticsearch-js/pull/1127" class="ulink" target="_top">#1127</a><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h4>
</div></div></div>
<p>It can happen in a situation where we are updating the connections list and running sniff, leaving the <code class="literal">dead</code> list in a dirty state. Now the <code class="literal">ConnectionPool.update</code> cleans up the <code class="literal">dead</code> list every time, which makes way more sense given that all the new connections are alive.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_connectionpoolmarkdead_should_ignore_connections_that_no_longer_exists_1159"></a><code class="literal">ConnectionPoolmarkDead</code> should ignore connections that no longer exists - <a href="https://github.com/elastic/elasticsearch-js/pull/1159" class="ulink" target="_top">#1159</a><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h4>
</div></div></div>
<p>It might happen that markDead is called just after a pool update, and in such case, the clint was adding the dead list a node that no longer exists, causing unhandled exceptions later.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_do_not_retry_a_request_if_the_body_is_a_stream_1143"></a>Do not retry a request if the body is a stream - <a href="https://github.com/elastic/elasticsearch-js/pull/1143" class="ulink" target="_top">#1143</a><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h4>
</div></div></div>
<p>The client should not retry if it&#8217;s sending a stream body, because it should store in memory a copy of the stream to be able to send it again, but since it doesn&#8217;t know in advance the size of the stream, it risks to take too much memory.
Furthermore, copying everytime the stream is very an expensive operation.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_return_an_error_if_the_request_has_been_aborted_1141"></a>Return an error if the request has been aborted - <a href="https://github.com/elastic/elasticsearch-js/pull/1141" class="ulink" target="_top">#1141</a><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h4>
</div></div></div>
<p>Until now, aborting a request was blocking the HTTP request, but never calling the callback or resolving the promise to notify the user. This is a bug because it could lead to dangerous memory leaks. From now on if the user calls the <code class="literal">request.abort()</code> method, the callback style API will be called with a <code class="literal">RequestAbortedError</code>, the promise will be rejected with <code class="literal">RequestAbortedError</code> as well.</p>
</div>

</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="_7_6_1"></a>7.6.1<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h2>
</div></div></div>
<p><span class="strong strong"><strong>Fixes:</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Secure json parsing - <a href="https://github.com/elastic/elasticsearch-js/pull/1110" class="ulink" target="_top">#1110</a>
</li>
<li class="listitem">
ApiKey should take precedence over basic auth - <a href="https://github.com/elastic/elasticsearch-js/pull/1115" class="ulink" target="_top">#1115</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Documentation:</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Fix typo in api reference - <a href="https://github.com/elastic/elasticsearch-js/pull/1109" class="ulink" target="_top">#1109</a>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="_7_6_0"></a>7.6.0<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h2>
</div></div></div>
<p>Support for Elasticsearch <code class="literal">v7.6</code>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="_7_5_1"></a>7.5.1<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h2>
</div></div></div>
<p><span class="strong strong"><strong>Fixes:</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Skip compression in case of empty string body - <a href="https://github.com/elastic/elasticsearch-js/pull/1080" class="ulink" target="_top">#1080</a>
</li>
<li class="listitem">
Fix typo in NoLivingConnectionsError - <a href="https://github.com/elastic/elasticsearch-js/pull/1045" class="ulink" target="_top">#1045</a>
</li>
<li class="listitem">
Change TransportRequestOptions.ignore to number[] - <a href="https://github.com/elastic/elasticsearch-js/pull/1053" class="ulink" target="_top">#1053</a>
</li>
<li class="listitem">
ClientOptions["cloud"] should have optional auth fields - <a href="https://github.com/elastic/elasticsearch-js/pull/1032" class="ulink" target="_top">#1032</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Documentation:</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Docs: Return super in example Transport subclass - <a href="https://github.com/elastic/elasticsearch-js/pull/980" class="ulink" target="_top">#980</a>
</li>
<li class="listitem">
Add examples to reference - <a href="https://github.com/elastic/elasticsearch-js/pull/1076" class="ulink" target="_top">#1076</a>
</li>
<li class="listitem">
Added new examples - <a href="https://github.com/elastic/elasticsearch-js/pull/1031" class="ulink" target="_top">#1031</a>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="_7_5_0"></a>7.5.0<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h2>
</div></div></div>
<p>Support for Elasticsearch <code class="literal">v7.5</code>.</p>
<p><span class="strong strong"><strong>Features</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
X-Opaque-Id support <a href="https://github.com/elastic/elasticsearch-js/pull/997" class="ulink" target="_top">#997</a>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="_7_4_0"></a>7.4.0<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h2>
</div></div></div>
<p>Support for Elasticsearch <code class="literal">v7.4</code>.</p>
<p><span class="strong strong"><strong>Fixes:</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Fix issue; node roles are defaulting to true when undefined is breaking usage of nodeFilter option - <a href="https://github.com/elastic/elasticsearch-js/pull/967" class="ulink" target="_top">#967</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Documentation:</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Updated API reference doc - <a href="https://github.com/elastic/elasticsearch-js/pull/945" class="ulink" target="_top">#945</a> <a href="https://github.com/elastic/elasticsearch-js/pull/969" class="ulink" target="_top">#969</a>
</li>
<li class="listitem">
Fix inaccurate description sniffEndpoint - <a href="https://github.com/elastic/elasticsearch-js/pull/959" class="ulink" target="_top">#959</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Internals:</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Update code generation <a href="https://github.com/elastic/elasticsearch-js/pull/969" class="ulink" target="_top">#969</a>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="_7_3_0"></a>7.3.0<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h2>
</div></div></div>
<p>Support for Elasticsearch <code class="literal">v7.3</code>.</p>
<p><span class="strong strong"><strong>Features:</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Added <code class="literal">auth</code> option - <a href="https://github.com/elastic/elasticsearch-js/pull/908" class="ulink" target="_top">#908</a>
</li>
<li class="listitem">
Added support for <code class="literal">ApiKey</code> authentication - <a href="https://github.com/elastic/elasticsearch-js/pull/908" class="ulink" target="_top">#908</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Fixes:</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
fix(Typings): sniffInterval can also be boolean - <a href="https://github.com/elastic/elasticsearch-js/pull/914" class="ulink" target="_top">#914</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Internals:</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Refactored connection pool - <a href="https://github.com/elastic/elasticsearch-js/pull/913" class="ulink" target="_top">#913</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Documentation:</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Better reference code examples - <a href="https://github.com/elastic/elasticsearch-js/pull/920" class="ulink" target="_top">#920</a>
</li>
<li class="listitem">
Improve README - <a href="https://github.com/elastic/elasticsearch-js/pull/909" class="ulink" target="_top">#909</a>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="_7_2_0"></a>7.2.0<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h2>
</div></div></div>
<p>Support for Elasticsearch <code class="literal">v7.2</code></p>
<p><span class="strong strong"><strong>Fixes:</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Remove auth data from inspect and toJSON in connection class - <a href="https://github.com/elastic/elasticsearch-js/pull/887" class="ulink" target="_top">#887</a>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="_7_1_0"></a>7.1.0<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h2>
</div></div></div>
<p>Support for Elasticsearch <code class="literal">v7.1</code></p>
<p><span class="strong strong"><strong>Fixes:</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Support for non-friendly chars in url username and password - <a href="https://github.com/elastic/elasticsearch-js/pull/858" class="ulink" target="_top">#858</a>
</li>
<li class="listitem">
Patch deprecated parameters - <a href="https://github.com/elastic/elasticsearch-js/pull/851" class="ulink" target="_top">#851</a>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="_7_0_1"></a>7.0.1<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h2>
</div></div></div>
<p><span class="strong strong"><strong>Fixes:</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Fix TypeScript export <span class="strong strong"><strong>(issue <a href="https://github.com/elastic/elasticsearch-js/pull/841" class="ulink" target="_top">#841</a>)</strong></span> - <a href="https://github.com/elastic/elasticsearch-js/pull/842" class="ulink" target="_top">#842</a>
</li>
<li class="listitem">
Fix http and https port handling <span class="strong strong"><strong>(issue <a href="https://github.com/elastic/elasticsearch-js/pull/843" class="ulink" target="_top">#843</a>)</strong></span> - <a href="https://github.com/elastic/elasticsearch-js/pull/845" class="ulink" target="_top">#845</a>
</li>
<li class="listitem">
Fix TypeScript definiton <span class="strong strong"><strong>(issue <a href="https://github.com/elastic/elasticsearch-js/pull/803" class="ulink" target="_top">#803</a>)</strong></span> - <a href="https://github.com/elastic/elasticsearch-js/pull/846" class="ulink" target="_top">#846</a>
</li>
<li class="listitem">
Added toJSON method to Connection class <span class="strong strong"><strong>(issue <a href="https://github.com/elastic/elasticsearch-js/pull/848" class="ulink" target="_top">#848</a>)</strong></span> - <a href="https://github.com/elastic/elasticsearch-js/pull/849" class="ulink" target="_top">#849</a>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="_7_0_0"></a>7.0.0<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch-js/edit/7.x/docs/changelog.asciidoc">edit</a></h2>
</div></div></div>
<p>Support for Elasticsearch <code class="literal">v7.0</code></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Stable release.
</li>
</ul>
</div>
</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="installation.html">« Installation</a>
</span>
<span class="next">
<a href="client-usage.html">Usage »</a>
</span>
</div>
</div>
</body>
</html>
