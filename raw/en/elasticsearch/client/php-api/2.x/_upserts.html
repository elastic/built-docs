<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Upserts | Elasticsearch-PHP [2.x] | Elastic</title>
<meta class="elastic" name="content" content="Upserts | Elasticsearch-PHP [2.x]">

<link rel="home" href="index.html" title="Elasticsearch-PHP [2.x]"/>
<link rel="up" href="_updating_documents.html" title="Updating Documents"/>
<link rel="prev" href="_scripted_document_update.html" title="Scripted document update"/>
<link rel="next" href="_deleting_documents.html" title="Deleting documents"/>
<meta class="elastic" name="product_version" content="2.x"/>
<meta class="elastic" name="product_name" content="Clients"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Clients/PHP/2.x"/>
<meta name="DC.subject" content="Clients"/>
<meta name="DC.identifier" content="2.x"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body><div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elasticsearch-PHP [2.x]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="_updating_documents.html">Updating Documents</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="_scripted_document_update.html">« Scripted document update</a>
</span>
<span class="next">
<a href="_deleting_documents.html">Deleting documents »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="_upserts"></a>Upserts<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch-php/edit/2.x/docs/crud.asciidoc">edit</a></h2>
</div></div></div>
<p>Upserts are "Update or Insert" operations.  This means an upsert will attempt to run your update script, but if the document
does not exist (or the field you are trying to update doesn&#8217;t exist), default values will be inserted instead.</p>
<div class="pre_wrapper lang-php">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-php">$params = [
    'index' =&gt; 'my_index',
    'type' =&gt; 'my_type',
    'id' =&gt; 'my_id',
    'body' =&gt; [
        'script' =&gt; 'ctx._source.counter += count',
        'params' =&gt; [
            'count' =&gt; 4
        ],
        'upsert' =&gt; [
            'counter' =&gt; 1
        ]
    ]
];

$response = $client-&gt;update($params);</pre>
</div>
<p>&#8203;<br></p>
</div>
<div class="navfooter">
<span class="prev">
<a href="_scripted_document_update.html">« Scripted document update</a>
</span>
<span class="next">
<a href="_deleting_documents.html">Deleting documents »</a>
</span>
</div>
</div>
</body>
</html>
