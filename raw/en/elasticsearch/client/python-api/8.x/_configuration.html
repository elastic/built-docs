<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Configuration | Elasticsearch Python Client [8.x] | Elastic</title>
<meta class="elastic" name="content" content="Configuration | Elasticsearch Python Client [8.x]">

<link rel="home" href="index.html" title="Elasticsearch Python Client [8.x]"/>
<link rel="up" href="elasticsearch-dsl.html" title="Elasticsearch Python DSL"/>
<link rel="prev" href="elasticsearch-dsl.html" title="Elasticsearch Python DSL"/>
<link rel="next" href="_tutorials.html" title="Tutorials"/>
<meta class="elastic" name="product_version" content="8.x"/>
<meta class="elastic" name="product_name" content="Clients"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Clients/Python/8.x"/>
<meta name="DC.subject" content="Clients"/>
<meta name="DC.identifier" content="8.x"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
This documentation contains work-in-progress information for future Elastic Stack and Cloud releases. Use the version selector to view supported release docs. It also contains some Elastic Cloud serverless information. Check out our <a href="https://www.elastic.co/docs/current/serverless">serverless docs</a> for more details.
</div>
<div class="navheader">
<span class="prev">
<a href="elasticsearch-dsl.html">« Elasticsearch Python DSL</a>
</span>
<span class="next">
<a href="_tutorials.html">Tutorials »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elasticsearch Python Client [8.x]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="elasticsearch-dsl.html">Elasticsearch Python DSL</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Configuration</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch-py/edit/8.x/docs/guide/dsl/configuration.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="_configuration"></a>Configuration</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch-py/edit/8.x/docs/guide/dsl/configuration.asciidoc">edit</a></div>
</div></div></div>
<p>There are several ways to configure connections for the library. The
easiest and most useful approach is to define one default connection
that can be used every time an API call is made without explicitly
passing in other connections.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Unless you want to access multiple clusters from your application, it is
highly recommended that you use the <code class="literal">create_connection</code> method and
all operations will use that connection automatically.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_default_connection"></a>Default connection</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch-py/edit/8.x/docs/guide/dsl/configuration.asciidoc">edit</a></div>
</div></div></div>
<p>To define a default connection that can be used globally, use the
<code class="literal">connections</code> module and the <code class="literal">create_connection</code> method like this:</p>
<div class="pre_wrapper lang-python">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-python">from elasticsearch.dsl import connections

connections.create_connection(hosts=['localhost'], timeout=20)</pre>
</div>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h4 class="title"><a id="_single_connection_with_an_alias"></a>Single connection with an alias</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch-py/edit/8.x/docs/guide/dsl/configuration.asciidoc">edit</a></div>
</div></div></div>
<p>You can define the <code class="literal">alias</code> or name of a connection so you can easily
refer to it later. The default value for <code class="literal">alias</code> is <code class="literal">default</code>.</p>
<div class="pre_wrapper lang-python">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-python">from elasticsearch.dsl import connections

connections.create_connection(alias='my_new_connection', hosts=['localhost'], timeout=60)</pre>
</div>
<p>Additional keyword arguments (<code class="literal">hosts</code> and <code class="literal">timeout</code> in our example) will
be passed to the <code class="literal">Elasticsearch</code> class from <code class="literal">elasticsearch-py</code>.</p>
<p>To see all possible configuration options refer to the
<a href="https://elasticsearch-py.readthedocs.io/en/latest/api/elasticsearch.html" class="ulink" target="_top">documentation</a>.</p>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_multiple_clusters"></a>Multiple clusters</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch-py/edit/8.x/docs/guide/dsl/configuration.asciidoc">edit</a></div>
</div></div></div>
<p>You can define multiple connections to multiple clusters at the same
time using the <code class="literal">configure</code> method:</p>
<div class="pre_wrapper lang-python">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-python">from elasticsearch.dsl import connections

connections.configure(
    default={'hosts': 'localhost'},
    dev={
        'hosts': ['esdev1.example.com:9200'],
        'sniff_on_start': True
    }
)</pre>
</div>
<p>Such connections will be constructed lazily when requested for the first
time.</p>
<p>You can alternatively define multiple connections by adding them one by
one as shown in the following example:</p>
<div class="pre_wrapper lang-python">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-python"># if you have configuration options to be passed to Elasticsearch.__init__
# this also shows creating a connection with the alias 'qa'
connections.create_connection('qa', hosts=['esqa1.example.com'], sniff_on_start=True)

# if you already have an Elasticsearch instance ready
connections.add_connection('another_qa', my_client)</pre>
</div>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h4 class="title"><a id="_using_aliases"></a>Using aliases</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch-py/edit/8.x/docs/guide/dsl/configuration.asciidoc">edit</a></div>
</div></div></div>
<p>When using multiple connections, you can refer to them using the string
alias specified when you created the connection.</p>
<p>This example shows how to use an alias to a connection:</p>
<div class="pre_wrapper lang-python">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-python">s = Search(using='qa')</pre>
</div>
<p>A <code class="literal">KeyError</code> will be raised if there is no connection registered with
that alias.</p>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_manual"></a>Manual</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch-py/edit/8.x/docs/guide/dsl/configuration.asciidoc">edit</a></div>
</div></div></div>
<p>If you don&#8217;t want to supply a global configuration, you can always pass
in your own connection as an instance of <code class="literal">elasticsearch.Elasticsearch</code>
with the parameter <code class="literal">using</code> wherever it is accepted like this:</p>
<div class="pre_wrapper lang-python">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-python">s = Search(using=Elasticsearch('localhost'))</pre>
</div>
<p>You can even use this approach to override any connection the object
might be already associated with:</p>
<div class="pre_wrapper lang-python">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-python">s = s.using(Elasticsearch('otherhost:9200'))</pre>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>When using the <code class="literal">dsl</code> module, it is highly recommended that you
use the built-in serializer
(<code class="literal">elasticsearch.dsl.serializer.serializer</code>) to ensure your objects
are correctly serialized into <code class="literal">JSON</code> every time. The
<code class="literal">create_connection</code> method that is described here (and that the
<code class="literal">configure</code> method uses under the hood) will do that automatically for
you, unless you explicitly specify your own serializer. The built-in
serializer also allows you to serialize your own objects - just define a
<code class="literal">to_dict()</code> method on your objects and that method will be
automatically called when serializing your custom objects to <code class="literal">JSON</code>.</p>
</div>
</div>
</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="elasticsearch-dsl.html">« Elasticsearch Python DSL</a>
</span>
<span class="next">
<a href="_tutorials.html">Tutorials »</a>
</span>
</div>
</body>
</html>
