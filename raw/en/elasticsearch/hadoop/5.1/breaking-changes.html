<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="description" content="Reference documentation of elasticsearch-hadoop">
<title>Appendix C: Breaking Changes | Elasticsearch for Apache Hadoop [5.1] | Elastic</title>
<link rel="home" href="index.html" title="Elasticsearch for Apache Hadoop [5.1]"/>
<link rel="up" href="index.html" title="Elasticsearch for Apache Hadoop [5.1]"/>
<link rel="prev" href="license.html" title="Appendix B: License"/>
<link rel="next" href="release-notes.html" title="Release Notes"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Apache Hadoop/5.1"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="5.1"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body><div class="page_header">
<p>
  <strong>WARNING</strong>: Version 5.1 has passed its 
  <a href="https://www.elastic.co/support/eol">EOL date</a>. 
</p>  
<p>
  This documentation is no longer being maintained and may be removed. 
  If you are running this version, we strongly advise you to upgrade. 
  For the latest information, see the 
  <a href="../current/index.html">current release documentation</a>. 
</p>
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Elasticsearch for Apache Hadoop [5.1]</a></span>
»
<span class="breadcrumb-node">Breaking Changes</span>
</div>
<div class="navheader">
<span class="prev">
<a href="license.html">« Appendix B: License</a>
</span>
<span class="next">
<a href="release-notes.html">Release Notes »</a>
</span>
</div>
<div class="appendix">
<div class="titlepage"><div><div>
<h1 class="title"><a id="breaking-changes"></a>Appendix C: Breaking Changes<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch-hadoop/edit/5.1/docs/src/reference/asciidoc/appendix/breaking.adoc">edit</a></h1>
</div></div></div>
<p>Generally, we strive to maintain backwards compatibility between minor
versions (e.g. 5.x to 5.7) so that upgrades can be done without any code
or configuration changes, but breaking changes do manifest between major
versions (e.g. 5.x to 6.y).</p>
<p>For clarity, we always list any breaking changes at the top of the
<a class="xref" href="release-notes.html" title="Release Notes">release notes</a> for each version.</p>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="breaking-changes-5.0"></a>Breaking Changes in 5.0<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch-hadoop/edit/5.1/docs/src/reference/asciidoc/appendix/breaking.adoc">edit</a></h2>
</div></div></div>
<p>This section discusses the changes that you should be aware of if you
upgrade ES-Hadoop from version 2.x to 5.x.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_supported_hadoop_versions"></a>Supported Hadoop Versions<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch-hadoop/edit/5.1/docs/src/reference/asciidoc/appendix/breaking.adoc">edit</a></h3>
</div></div></div>
<p>ES-Hadoop 5.0 has added support for new versions of software from the Hadoop
ecosystem. Support for older versions is normally dropped during these cycles
for the purposes of stability and to allow for cleanup of older code. Please
note the following version compatibility changes in 5.0:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Support for Hive 0.13 and 0.14 has been removed. These versions of Hive are
known to have serious issues that have since been repaired in 1.0. Hive 1.0 has
been released for a while and a majority of distributions have already
switched to it. Hive 1.0 will continue to be supported by ES-Hadoop 5.0.
</li>
<li class="listitem">
With the addition of support for Storm 1.x, support for Storm 0.9 has been removed due to backwards compatibility issues.
</li>
<li class="listitem">
Support for SparkSQL 1.0-1.2 has been removed. SparkSQL was originally
released in Spark 1.0-1.2 as an alpha, but has since become stable in Spark
1.3 with a drastically changed API. Additionally, we have added support for
Spark 2.0, which is binary-incompatible with previous versions of Spark.
Instead of supporting three different version compatibilities of Spark at the
same time we have decided to drop support for Spark SQL 1.0-1.2.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_names_of_included_spark_jars_in_es_hadoop"></a>Names of Included Spark Jars in ES-Hadoop<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch-hadoop/edit/5.1/docs/src/reference/asciidoc/appendix/breaking.adoc">edit</a></h3>
</div></div></div>
<p>With the removal of support for Spark 1.0-1.2 and the addition of support for
Spark 2.0, the names of all the Spark artifacts included in ES-Hadoop 5.0
have changed. All Spark artifacts in this release now have both of their
Spark and Scala versions explicitly demarcated in their names (instead of
just Scala and <em>sometimes</em> Spark).</p>
<div class="table">
<p class="title"><strong>Table 11. Spark Jar Name Changes from 2.x to 5.x</strong></p>
<div class="table-contents">
<table border="1" cellpadding="4px" summary="Spark Jar Name Changes from 2.x to 5.x">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Spark Version</th>
<th align="left" valign="top">Scala Version</th>
<th align="left" valign="top">ES-Hadoop 2.x name</th>
<th align="left" valign="top">ES-Hadoop 5.x Name</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>1.0 - 1.2</p></td>
<td align="left" valign="top"><p>2.10</p></td>
<td align="left" valign="top"><p>elasticsearch-spark-1.2_2.10-2.4.0.jar</p></td>
<td align="left" valign="top"><p>&lt;removed&gt;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>1.0 - 1.2</p></td>
<td align="left" valign="top"><p>2.11</p></td>
<td align="left" valign="top"><p>elasticsearch-spark-1.2_2.11-2.4.0.jar</p></td>
<td align="left" valign="top"><p>&lt;removed&gt;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>1.3 - 1.6</p></td>
<td align="left" valign="top"><p>2.10</p></td>
<td align="left" valign="top"><p>elasticsearch-spark_2.10-2.4.0.jar</p></td>
<td align="left" valign="top"><p>elasticsearch-spark-13_2.10-5.0.0.jar</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>1.3 - 1.6</p></td>
<td align="left" valign="top"><p>2.11</p></td>
<td align="left" valign="top"><p>elasticsearch-spark_2.11-2.4.0.jar</p></td>
<td align="left" valign="top"><p>elasticsearch-spark-13_2.11-5.0.0.jar</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>2.0+</p></td>
<td align="left" valign="top"><p>2.10</p></td>
<td align="left" valign="top"><p>&lt;N/A&gt;</p></td>
<td align="left" valign="top"><p>elasticsearch-spark-20_2.10-5.0.0.jar</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>2.0+</p></td>
<td align="left" valign="top"><p>2.11</p></td>
<td align="left" valign="top"><p>&lt;N/A&gt;</p></td>
<td align="left" valign="top"><p>elasticsearch-spark-20_2.11-5.0.0.jar</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_hdfs_repository"></a>HDFS Repository<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch-hadoop/edit/5.1/docs/src/reference/asciidoc/appendix/breaking.adoc">edit</a></h3>
</div></div></div>
<p>In 5.0, the HDFS Repository plugin has been all but re-built from the ground up to allow for compatibility with the changes to security policies in Elasticsearch&#8217;s plugin framework.</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_code_has_moved"></a>Code has Moved<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch-hadoop/edit/5.1/docs/src/reference/asciidoc/appendix/breaking.adoc">edit</a></h4>
</div></div></div>
<p>In 5.0, the Repository HDFS plugin <a href="https://github.com/elastic/elasticsearch/tree/master/plugins/repository-hdfs" class="ulink" target="_top">has been moved</a>
to the <a href="https://github.com/elastic/elasticsearch" class="ulink" target="_top">main Elasticsearch project</a>.
The documentation page in the elasticsearch-hadoop repository has been
updated with a header signaling this move.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_security_2"></a>Security<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch-hadoop/edit/5.1/docs/src/reference/asciidoc/appendix/breaking.adoc">edit</a></h4>
</div></div></div>
<p>Disabling the Java SecurityManager in Elasticsearch is no longer required for the HDFS Repository plugin to function. Elasticsearch 5.0 requires all plugins to operate properly with the configured SecurityManager. The plugin was heavily modified to allow for compatibility with this new constraint. This should allow you to maintain a secured Elasticsearch instance while still using HDFS as a location for storing snapshots.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_changes_in_configurations"></a>Changes in Configurations<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch-hadoop/edit/5.1/docs/src/reference/asciidoc/appendix/breaking.adoc">edit</a></h4>
</div></div></div>
<p>Due to constraints in the underlying security system as well as changes to
the way the plugin functions, the following configurations have been removed
in 5.0 with no replacement options:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">concurrent_streams</code>
</li>
<li class="listitem">
<code class="literal">user_keytab</code>
</li>
<li class="listitem">
<code class="literal">user_principal</code>
</li>
<li class="listitem">
<code class="literal">user_principal_hostname</code>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_supported_versions"></a>Supported Versions<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch-hadoop/edit/5.1/docs/src/reference/asciidoc/appendix/breaking.adoc">edit</a></h4>
</div></div></div>
<p>Previously, the HDFS Repository supported both Apache Hadoop 1.x (default)
and Apache Hadoop 2.x through two distributions. In 5.0, there is now only
one distribution which is built against the latest Apache Hadoop 2.x (at this
time 2.7.1). The distribution for Apache Hadoop 1.x has been removed.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_version_light_removed"></a>Version <code class="literal">light</code> removed<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch-hadoop/edit/5.1/docs/src/reference/asciidoc/appendix/breaking.adoc">edit</a></h4>
</div></div></div>
<p>Even if Hadoop is already installed on the Elasticsearch nodes, for security
reasons, the required libraries need to be placed under the plugin folder.
Because of this, the <code class="literal">light</code> distribution of the repository plugin which
contained no Hadoop client dependencies is no longer available in 5.0.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_strict_query_parsing"></a>Strict Query Parsing<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch-hadoop/edit/5.1/docs/src/reference/asciidoc/appendix/breaking.adoc">edit</a></h4>
</div></div></div>
<p>In previous versions, users were able to specify options that modify search
properties in Query DSL strings provided to the client. In some cases these
properties would conflict with how the framework executed searches during
read operations. In 5.0, when specifying a Query DSL string, if a <code class="literal">query</code> field
is present, its contents are extracted and all other contents are discarded
(such as <code class="literal">source</code> or <code class="literal">size</code>). If there is no <code class="literal">query</code> field, the entire text
is nested inside of the <code class="literal">query</code> field during execution.</p>
</div>

</div>

</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="license.html">« Appendix B: License</a>
</span>
<span class="next">
<a href="release-notes.html">Release Notes »</a>
</span>
</div>
</div>
</body>
</html>
