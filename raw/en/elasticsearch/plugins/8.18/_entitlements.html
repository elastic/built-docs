<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Entitlements | Elasticsearch Plugins and Integrations [8.18] | Elastic</title>
<meta class="elastic" name="content" content="Entitlements | Elasticsearch Plugins and Integrations [8.18]">

<link rel="home" href="index.html" title="Elasticsearch Plugins and Integrations [8.18]"/>
<link rel="up" href="creating-classic-plugins.html" title="Creating classic plugins"/>
<link rel="prev" href="creating-classic-plugins.html" title="Creating classic plugins"/>
<link rel="next" href="plugin-descriptor-file-classic.html" title="The plugin descriptor file for classic plugins"/>
<meta class="elastic" name="product_version" content="8.18"/>
<meta class="elastic" name="product_name" content="Elasticsearch"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Plugins/8.18"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="8.18"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
This documentation contains work-in-progress information for future Elastic Stack and Cloud releases. Use the version selector to view supported release docs. It also contains some Elastic Cloud serverless information. Check out our <a href="https://www.elastic.co/docs/current/serverless">serverless docs</a> for more details.
</div>
<div class="navheader">
<span class="prev">
<a href="creating-classic-plugins.html">« Creating classic plugins</a>
</span>
<span class="next">
<a href="plugin-descriptor-file-classic.html">The plugin descriptor file for classic plugins »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elasticsearch Plugins and Integrations [8.18]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="plugin-authors.html">Creating an Elasticsearch plugin</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="creating-classic-plugins.html">Creating classic plugins</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Entitlements</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.18/docs/plugins/development/creating-classic-plugins.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_entitlements"></a>Entitlements</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.18/docs/plugins/development/creating-classic-plugins.asciidoc">edit</a></div>
</div></div></div>
<p>The entitlements currently implemented and enforced in Elasticsearch that are available to plugins are the following ones:</p>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h4 class="title"><a id="_manage_threads"></a><code class="literal">manage_threads</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.18/docs/plugins/development/creating-classic-plugins.asciidoc">edit</a></div>
</div></div></div>
<p>Allows code to call methods that create or modify properties on Java Threads, for example <code class="literal">Thread#start</code> or <code class="literal">ThreadGroup#setMaxPriority</code>. In general, setting the name, priority, daemon state and context class loader are things no plugins should do when executing on
Elasticsearch threadpools; however, many 3rd party libraries that support async operations (e.g. Apache HTTP client) need to manage their own threads. In this case it is justifiable to request this entitlement.</p>
<p>Example:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">org.example.module: # or 'ALL-UNNAMED' if the plugin is non-modular
  - manage_threads</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h4 class="title"><a id="_outbound_network"></a><code class="literal">outbound_network</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.18/docs/plugins/development/creating-classic-plugins.asciidoc">edit</a></div>
</div></div></div>
<p>Allows code to call methods to make a network connection. Elasticsearch does not grant any network access by default; each plugin that needs to directly connect to an external resource (e.g. to upload or download data) must request this entitlement.</p>
<p>Example:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">org.example.module: # or 'ALL-UNNAMED' if the plugin is non-modular
  - outbound_network</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h4 class="title"><a id="_set_https_connection_properties"></a><code class="literal">set_https_connection_properties</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.18/docs/plugins/development/creating-classic-plugins.asciidoc">edit</a></div>
</div></div></div>
<p>Allows code to call methods to change properties on an established HTTPS connection. While this is generally innocuous (e.g. the google API client uses it to modify the HTTPS connections they just created), these methods can allow code to change arbitrary connections.</p>
<p>Example:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">org.example.module: # or 'ALL-UNNAMED' if the plugin is non-modular
  - set_https_connection_properties</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h4 class="title"><a id="_inbound_network_deprecated"></a><code class="literal">inbound_network</code> (deprecated)</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.18/docs/plugins/development/creating-classic-plugins.asciidoc">edit</a></div>
</div></div></div>
<p>Allows code to call methods to listen for incoming connections, so external resources can connect directly to your plugin. This entitlement should only be used when absolutely necessary (e.g. if a library you depend on requires it for authentication). Granting it makes the Elasticsearch node more vulnerable to attacks. This entitlement is deprecated, and can be removed in a future version of Elasticsearch.</p>
<p>Example:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">org.example.module: # or 'ALL-UNNAMED' if the plugin is non-modular
  - inbound_network</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h4 class="title"><a id="_load_native_libraries"></a><code class="literal">load_native_libraries</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.18/docs/plugins/development/creating-classic-plugins.asciidoc">edit</a></div>
</div></div></div>
<p>Allows code to load native libraries and call <a href="https://docs.oracle.com/en/java/javase/24/core/restricted-methods.html" class="ulink" target="_top">restricted methods</a>. This entitlement also enables native access for modules it is granted to. Native code may alter the JVM or circumvent access checks such as file or network restrictions.</p>
<p>Example:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">org.example.module: # or 'ALL-UNNAMED' if the plugin is non-modular
  - load_native_libraries</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h4 class="title"><a id="_files"></a><code class="literal">files</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.18/docs/plugins/development/creating-classic-plugins.asciidoc">edit</a></div>
</div></div></div>
<p>Allows code to access the filesystem, to read or write paths as specified by the entitlement&#8217;s fields. The filesystem of the OS hosting Elasticsearch may contain sensitive files, for example credentials. Some files are meant to be always accessible to Elasticsearch, but plugins can not access them directly: Elasticsearch enforces that certain files can only be read by its core code, while some other files can not be read or written at all. A plugin is always granted <code class="literal">read</code> access to the Elasticsearch config directory and <code class="literal">read_write</code> access to the temp directory; if the plugin requires to read, write or access additional files or directories, it must specify them via this entitlement.</p>
<p>It is possible to specify 3 different types of file entitlement:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">path</code> to specify an absolute path
</li>
<li class="listitem">
<code class="literal">relative_path</code> to specify a relative path. The path will be resolved via the <code class="literal">relative_to</code> field, which is used to qualify the relative path. It can be a specific Elasticsearch directory (<code class="literal">config</code> or <code class="literal">data</code>), or to the user home directory (<code class="literal">home</code>) (the home of the user running Elasticsearch)
</li>
<li class="listitem">
<p><code class="literal">relative_path</code> to specify a path resolved via the <code class="literal">relative_to</code> field, which can have the following values:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">config</code>: the Elasticsearch <a href="/guide/en/elasticsearch/reference/current/settings.html#config-files-location" class="ulink" target="_top">config directory</a>
</li>
<li class="listitem">
<code class="literal">data</code>: the Elasticsearch <a href="/guide/en/elasticsearch/reference/current/path-settings-overview.html" class="ulink" target="_top">data directory</a>
</li>
<li class="listitem">
<code class="literal">home</code>: the home directory of the user running Elasticsearch
</li>
<li class="listitem">
<code class="literal">path_setting</code> to specify a path defined via an Elasticsearch setting. The path can be absolute or relative; in the latter case, the path will be resolved using the <code class="literal">basedir_if_relative</code> path (which can assume the same values as <code class="literal">relative_to</code>)
</li>
</ul>
</div>
</li>
</ul>
</div>
<p>Each of the 3 types has some additional fields:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">mode</code> (required): can be either <code class="literal">read</code> or <code class="literal">read_write</code>
</li>
<li class="listitem">
<code class="literal">platform</code> (optional): indicates this item applies only to one platform, which can be one of <code class="literal">linux</code>, <code class="literal">macos</code> or <code class="literal">windows</code>. On other platforms, the item is ignored. If this field is not specified, the item applies to all platforms.
</li>
<li class="listitem">
<code class="literal">exclusive</code>: access to this path is exclusive for this plugin; this means that other plugins will not be able to access to it, not even if they have an entitlement that would normally grant access to that path.
</li>
</ul>
</div>
<p>Example:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">org.example.module: # or 'ALL-UNNAMED' if the plugin is non-modular
  - files:
    - path: "/absolute/path"
      mode: read
    - relative_path: "relative/file.txt"
      relative_to: data
      mode: read_write
    - path_setting: setting.name
      basedir_if_relative: data
      mode: read</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h4 class="title"><a id="_write_system_properties"></a><code class="literal">write_system_properties</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.18/docs/plugins/development/creating-classic-plugins.asciidoc">edit</a></div>
</div></div></div>
<p>Allows code to set one or more system properties (e.g. by calling <code class="literal">System#setProperty</code>). The code to which this entitlement is granted can change the properties listed in the <code class="literal">properties</code> field. In general, it&#8217;s best to avoid changing a system property dynamically as this can have effects on code which later reads the property. The global nature of system properties means one plugin could then affect another, depending on load order.</p>
<p>Example:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">org.example.module: # or 'ALL-UNNAMED' if the plugin is non-modular
  - write_system_properties:
      properties:
        - property.one
        - property.two</pre>
</div>
<p>Check the Entitlements <a href="https://github.com/elastic/elasticsearch/tree/main/libs/entitlement/README.md" class="ulink" target="_top">README in the elasticsearch repository</a> for more information.</p>
</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="creating-classic-plugins.html">« Creating classic plugins</a>
</span>
<span class="next">
<a href="plugin-descriptor-file-classic.html">The plugin descriptor file for classic plugins »</a>
</span>
</div>
</body>
</html>
