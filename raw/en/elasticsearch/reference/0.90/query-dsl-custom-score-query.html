<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Custom Score Query | Reference [0.90] | Elastic</title>
<meta class="elastic" name="content" content="Custom Score Query | Reference [0.90]">

<link rel="home" href="index.html" title="Reference [0.90]"/>
<link rel="up" href="query-dsl-queries.html" title="Queries"/>
<link rel="prev" href="query-dsl-custom-filters-score-query.html" title="Custom Filters Score Query"/>
<link rel="next" href="query-dsl-custom-boost-factor-query.html" title="Custom Boost Factor Query"/>
<meta class="elastic" name="product_version" content="0.90"/>
<meta class="elastic" name="product_name" content="Elasticsearch"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/0.90"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="0.90"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
<p>
  <strong>WARNING</strong>: Version 0.90 of Elasticsearch has passed its 
  <a href="https://www.elastic.co/support/eol">EOL date</a>. 
</p>  
<p>
  This documentation is no longer being maintained and may be removed. 
  If you are running this version, we strongly advise you to upgrade. 
  For the latest information, see the 
  <a href="../current/index.html">current release documentation</a>. 
</p>
</div>
<div class="navheader">
<span class="prev">
<a href="query-dsl-custom-filters-score-query.html">« Custom Filters Score Query</a>
</span>
<span class="next">
<a href="query-dsl-custom-boost-factor-query.html">Custom Boost Factor Query »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Reference [0.90]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="query-dsl.html">Query DSL</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="query-dsl-queries.html">Queries</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Custom Score Query</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/0.90/docs/reference/query-dsl/queries/custom-score-query.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="query-dsl-custom-score-query"></a>Custom Score Query</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/0.90/docs/reference/query-dsl/queries/custom-score-query.asciidoc">edit</a></div>
</div></div></div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<h3>Deprecated in 0.90.4.</h3>
<p>Replaced by <a class="xref" href="query-dsl-function-score-query.html" title="Function Score Query">Function Score Query</a></p>
</div>
</div>
<p><code class="literal">custom_score</code> query allows to wrap another query and customize the
scoring of it optionally with a computation derived from other field
values in the doc (numeric ones) using
<a class="xref" href="modules-scripting.html" title="Scripting">script expression</a>. Here is
a simple sample:</p>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">"custom_score" : {
    "query" : {
        ....
    },
    "script" : "_score * doc['my_numeric_field'].value"
}</pre>
</div>
<p>On top of the different scripting field values and expression, the
<code class="literal">_score</code> script parameter can be used to retrieve the score based on the
wrapped query.</p>
<div class="position-relative"><h4><a id="_script_parameters"></a>Script Parameters</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/0.90/docs/reference/query-dsl/queries/custom-score-query.asciidoc">edit</a></div>
<p>Scripts are cached for faster execution. If the script has parameters
that it needs to take into account, it is preferable to use the same
script, and provide parameters to it:</p>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">"custom_score" : {
    "query" : {
        ....
    },
    "params" : {
        "param1" : 2,
        "param2" : 3.1
    },
    "script" : "_score * doc['my_numeric_field'].value / pow(param1, param2)"
}</pre>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="query-dsl-custom-filters-score-query.html">« Custom Filters Score Query</a>
</span>
<span class="next">
<a href="query-dsl-custom-boost-factor-query.html">Custom Boost Factor Query »</a>
</span>
</div>
</body>
</html>
