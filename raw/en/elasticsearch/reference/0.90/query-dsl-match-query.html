<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Match Query | Reference [0.90] | Elastic</title>
<meta class="elastic" name="content" content="Match Query | Reference [0.90]">

<link rel="home" href="index.html" title="Reference [0.90]"/>
<link rel="up" href="query-dsl-queries.html" title="Queries"/>
<link rel="prev" href="query-dsl-queries.html" title="Queries"/>
<link rel="next" href="query-dsl-multi-match-query.html" title="Multi Match Query"/>
<meta class="elastic" name="product_version" content="0.90"/>
<meta class="elastic" name="product_name" content="Elasticsearch"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/0.90"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="0.90"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
<p>
  <strong>WARNING</strong>: Version 0.90 of Elasticsearch has passed its 
  <a href="https://www.elastic.co/support/eol">EOL date</a>. 
</p>  
<p>
  This documentation is no longer being maintained and may be removed. 
  If you are running this version, we strongly advise you to upgrade. 
  For the latest information, see the 
  <a href="../current/index.html">current release documentation</a>. 
</p>
</div>
<div class="navheader">
<span class="prev">
<a href="query-dsl-queries.html">« Queries</a>
</span>
<span class="next">
<a href="query-dsl-multi-match-query.html">Multi Match Query »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Reference [0.90]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="query-dsl.html">Query DSL</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="query-dsl-queries.html">Queries</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Match Query</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/0.90/docs/reference/query-dsl/queries/match-query.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div id="url-to-v3" class="version-warning">
    <strong>IMPORTANT</strong>: This documentation is no longer updated. Refer to <a href="https://www.elastic.co/support/eol">Elastic's version policy</a> and the <a href="https://www.elastic.co/docs/reference/query-languages/query-dsl/query-dsl-match-query">latest documentation</a>.
</div>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="query-dsl-match-query"></a>Match Query</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/0.90/docs/reference/query-dsl/queries/match-query.asciidoc">edit</a></div>
</div></div></div>
<p>A family of <code class="literal">match</code> queries that accept text/numerics/dates, analyzes
it, and constructs a query out of it. For example:</p>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">{
    "match" : {
        "message" : "this is a test"
    }
}</pre>
</div>
<p>Note, <code class="literal">message</code> is the name of a field, you can substitute the name of
any field (including <code class="literal">_all</code>) instead.</p>
<div class="position-relative"><h4><a id="_types_of_match_queries"></a>Types of Match Queries</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/0.90/docs/reference/query-dsl/queries/match-query.asciidoc">edit</a></div>
<div class="position-relative"><h5><a id="_boolean"></a>boolean</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/0.90/docs/reference/query-dsl/queries/match-query.asciidoc">edit</a></div>
<p>The default <code class="literal">match</code> query is of type <code class="literal">boolean</code>. It means that the text
provided is analyzed and the analysis process constructs a boolean query
from the provided text. The <code class="literal">operator</code> flag can be set to <code class="literal">or</code> or <code class="literal">and</code>
to control the boolean clauses (defaults to <code class="literal">or</code>). The minimum number of
should clauses to match can be set using the
<a class="xref" href="query-dsl-minimum-should-match.html" title="Minimum Should Match"><code class="literal">minimum_should_match</code></a>
parameter.</p>
<p>The <code class="literal">analyzer</code> can be set to control which analyzer will perform the
analysis process on the text. It default to the field explicit mapping
definition, or the default search analyzer.</p>
<p><code class="literal">fuzziness</code> can be set to a value (depending on the relevant type, for
string types it should be a value between <code class="literal">0.0</code> and <code class="literal">1.0</code>) to constructs
fuzzy queries for each term analyzed. The <code class="literal">prefix_length</code> and
<code class="literal">max_expansions</code> can be set in this case to control the fuzzy process.
If the fuzzy option is set the query will use <code class="literal">constant_score_rewrite</code>
as its <a class="xref" href="query-dsl-multi-term-rewrite.html" title="Multi Term Query Rewrite">rewrite
method</a> the <code class="literal">rewrite</code> parameter allows to control how the query will get
rewritten.</p>
<p>Here is an example when providing additional parameters (note the slight
change in structure, <code class="literal">message</code> is the field name):</p>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">{
    "match" : {
        "message" : {
            "query" : "this is a test",
            "operator" : "and"
        }
    }
}</pre>
</div>
<p>zero_terms_query</p>
<p>If the analyzer used removes all tokens in a query like a <code class="literal">stop</code> filter
does, the default behavior is to match no documents at all. In order to
change that the <code class="literal">zero_terms_query</code> option can be used, which accepts
<code class="literal">none</code> (default) and <code class="literal">all</code> which corresponds to a <code class="literal">match_all</code> query.</p>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">{
    "match" : {
        "message" : {
            "query" : "to be or not to be",
            "operator" : "and",
            "zero_terms_query": "all"
        }
    }
}</pre>
</div>
<p>cutoff_frequency</p>
<p>Since <code class="literal">0.90.0</code> match query supports a <code class="literal">cutoff_frequency</code> that allows
specifying an absolute or relative document frequency where high
frequent terms are moved into an optional subquery and are only scored
if one of the low frequent (below the cutoff) terms in the case of an
<code class="literal">or</code> operator or all of the low frequent terms in the case of an <code class="literal">and</code>
operator match.</p>
<p>This query allows handling <code class="literal">stopwords</code> dynamically at runtime, is domain
independent and doesn&#8217;t require on a stopword file. It prevent scoring /
iterating high frequent terms and only takes the terms into account if a
more significant / lower frequent terms match a document. Yet, if all of
the query terms are above the given <code class="literal">cutoff_frequency</code> the query is
automatically transformed into a pure conjunction (<code class="literal">and</code>) query to
ensure fast execution.</p>
<p>The <code class="literal">cutoff_frequency</code> can either be relative to the number of documents
in the index if in the range <code class="literal">[0..1)</code> or absolute if greater or equal to
<code class="literal">1.0</code>.</p>
<p>Note: If the <code class="literal">cutoff_frequency</code> is used and the operator is <code class="literal">and</code>
<em>stacked tokens</em> (tokens that are on the same position like <code class="literal">synonym</code> filter emits)
are not handled gracefully as they are in a pure <code class="literal">and</code> query. For instance the query
<code class="literal">fast fox</code> is analyzed into 3 terms <code class="literal">[fast, quick, fox]</code> where <code class="literal">quick</code> is a synonym
for <code class="literal">fast</code> on the same token positions the query might require <code class="literal">fast</code> and <code class="literal">quick</code> to
match if the operator is <code class="literal">and</code>.</p>
<p>Here is an example showing a query composed of stopwords exclusivly:</p>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">{
    "match" : {
        "message" : {
            "query" : "to be or not to be",
            "cutoff_frequency" : 0.001
        }
    }
}</pre>
</div>
<div class="position-relative"><h5><a id="_phrase"></a>phrase</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/0.90/docs/reference/query-dsl/queries/match-query.asciidoc">edit</a></div>
<p>The <code class="literal">match_phrase</code> query analyzes the text and creates a <code class="literal">phrase</code> query
out of the analyzed text. For example:</p>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">{
    "match_phrase" : {
        "message" : "this is a test"
    }
}</pre>
</div>
<p>Since <code class="literal">match_phrase</code> is only a <code class="literal">type</code> of a <code class="literal">match</code> query, it can also be
used in the following manner:</p>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">{
    "match" : {
        "message" : {
            "query" : "this is a test",
            "type" : "phrase"
        }
    }
}</pre>
</div>
<p>A phrase query matches terms up to a configurable <code class="literal">slop</code>
(which defaults to 0) in any order. Transposed terms have a slop of 2.</p>
<p>The <code class="literal">analyzer</code> can be set to control which analyzer will perform the
analysis process on the text. It default to the field explicit mapping
definition, or the default search analyzer, for example:</p>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">{
    "match_phrase" : {
        "message" : {
            "query" : "this is a test",
            "analyzer" : "my_analyzer"
        }
    }
}</pre>
</div>
<div class="position-relative"><h5><a id="_match_phrase_prefix"></a>match_phrase_prefix</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/0.90/docs/reference/query-dsl/queries/match-query.asciidoc">edit</a></div>
<p>The <code class="literal">match_phrase_prefix</code> is the same as <code class="literal">match_phrase</code>, except that it
allows for prefix matches on the last term in the text. For example:</p>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">{
    "match_phrase_prefix" : {
        "message" : "this is a test"
    }
}</pre>
</div>
<p>Or:</p>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">{
    "match" : {
        "message" : {
            "query" : "this is a test",
            "type" : "phrase_prefix"
        }
    }
}</pre>
</div>
<p>It accepts the same parameters as the phrase type. In addition, it also
accepts a <code class="literal">max_expansions</code> parameter that can control to how many
prefixes the last term will be expanded. It is highly recommended to set
it to an acceptable value to control the execution time of the query.
For example:</p>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">{
    "match_phrase_prefix" : {
        "message" : {
            "query" : "this is a test",
            "max_expansions" : 10
        }
    }
}</pre>
</div>
<div class="position-relative"><h4><a id="_comparison_to_query_string_field"></a>Comparison to query_string / field</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/0.90/docs/reference/query-dsl/queries/match-query.asciidoc">edit</a></div>
<p>The match family of queries does not go through a "query parsing"
process. It does not support field name prefixes, wildcard characters,
or other "advance" features. For this reason, chances of it failing are
very small / non existent, and it provides an excellent behavior when it
comes to just analyze and run that text as a query behavior (which is
usually what a text search box does). Also, the <code class="literal">phrase_prefix</code> type can
provide a great "as you type" behavior to automatically load search
results.</p>
<div class="position-relative"><h4><a id="_other_options_2"></a>Other options</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/0.90/docs/reference/query-dsl/queries/match-query.asciidoc">edit</a></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">lenient</code> - If set to true will cause format based failures (like
providing text to a numeric field) to be ignored. Defaults to false.
</li>
</ul>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="query-dsl-queries.html">« Queries</a>
</span>
<span class="next">
<a href="query-dsl-multi-match-query.html">Multi Match Query »</a>
</span>
</div>
</body>
</html>
