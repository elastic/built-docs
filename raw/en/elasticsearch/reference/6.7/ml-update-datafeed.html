<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Update datafeeds API | Elasticsearch Reference [6.7] | Elastic</title>
<link rel="home" href="index.html" title="Elasticsearch Reference [6.7]"/>
<link rel="up" href="ml-apis.html" title="Machine learning APIs"/>
<link rel="prev" href="ml-stop-datafeed.html" title="Stop datafeeds API"/>
<link rel="next" href="ml-update-filter.html" title="Update filter API"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/6.7"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="6.7"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body><div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Elasticsearch Reference [6.7]</a></span>
»
<span class="breadcrumb-link"><a href="xpack-api.html">X-Pack APIs</a></span>
»
<span class="breadcrumb-link"><a href="ml-apis.html">Machine learning APIs</a></span>
»
<span class="breadcrumb-node">Update datafeeds API</span>
</div>
<div class="navheader">
<span class="prev">
<a href="ml-stop-datafeed.html">« Stop datafeeds API</a>
</span>
<span class="next">
<a href="ml-update-filter.html">Update filter API »</a>
</span>
</div>
<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="ml-update-datafeed"></a>Update datafeeds API<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.7/docs/reference/ml/apis/update-datafeed.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>Updates certain properties of a datafeed.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_request_72"></a>Request<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.7/docs/reference/ml/apis/update-datafeed.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">POST _xpack/ml/datafeeds/&lt;feed_id&gt;/_update</code></p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_description_72"></a>Description<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.7/docs/reference/ml/apis/update-datafeed.asciidoc">edit</a></h4>
</div></div></div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>If you update the <code class="literal">delayed_data_check_config</code> property, you must stop and
start the datafeed for the change to be applied.</p>
</div>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_path_parameters_56"></a>Path Parameters<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.7/docs/reference/ml/apis/update-datafeed.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">feed_id</code> (required)
</span>
</dt>
<dd>
(string) Identifier for the datafeed
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_request_body_27"></a>Request Body<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.7/docs/reference/ml/apis/update-datafeed.asciidoc">edit</a></h3>
</div></div></div>
<p>The following properties can be updated after the datafeed is created:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">aggregations</code>
</span>
</dt>
<dd>
(object) If set, the datafeed performs aggregation searches.
For more information, see <a class="xref" href="ml-datafeed-resource.html" title="Datafeed resources">Datafeed resources</a>.
</dd>
<dt>
<span class="term">
<code class="literal">chunking_config</code>
</span>
</dt>
<dd>
(object) Specifies how data searches are split into time chunks.
See <a class="xref" href="ml-datafeed-resource.html#ml-datafeed-chunking-config" title="Chunking configuration objects">Chunking configuration objects</a>.
</dd>
<dt>
<span class="term">
<code class="literal">delayed_data_check_config</code>
</span>
</dt>
<dd>
(object) Specifies whether the data feed checks for missing data and
the size of the window. See <a class="xref" href="ml-datafeed-resource.html#ml-datafeed-delayed-data-check-config" title="Delayed data check configuration objects">Delayed data check configuration objects</a>.
</dd>
<dt>
<span class="term">
<code class="literal">frequency</code>
</span>
</dt>
<dd>
(time units) The interval at which scheduled queries are made while the
datafeed runs in real time. The default value is either the bucket span for short
bucket spans, or, for longer bucket spans, a sensible fraction of the bucket
span. For example: <code class="literal">150s</code>.
</dd>
<dt>
<span class="term">
<code class="literal">indices</code>
</span>
</dt>
<dd>
(array) An array of index names. Wildcards are supported. For example:
<code class="literal">["it_ops_metrics", "server*"]</code>.
</dd>
<dt>
<span class="term">
<code class="literal">job_id</code>
</span>
</dt>
<dd>
(string) A numerical character string that uniquely identifies the job.
</dd>
<dt>
<span class="term">
<code class="literal">query</code>
</span>
</dt>
<dd>
(object) The Elasticsearch query domain-specific language (DSL). This value
corresponds to the query object in an Elasticsearch search POST body. All the
options that are supported by Elasticsearch can be used, as this object is
passed verbatim to Elasticsearch. By default, this property has the following
value: <code class="literal">{"match_all": {"boost": 1}}</code>.
</dd>
<dt>
<span class="term">
<code class="literal">query_delay</code>
</span>
</dt>
<dd>
(time units) The number of seconds behind real-time that data is queried. For
example, if data from 10:04 a.m. might not be searchable in Elasticsearch until
10:06 a.m., set this property to 120 seconds. The default value is <code class="literal">60s</code>.
</dd>
<dt>
<span class="term">
<code class="literal">script_fields</code>
</span>
</dt>
<dd>
(object) Specifies scripts that evaluate custom expressions and returns
script fields to the datafeed.
The <a class="xref" href="ml-job-resource.html#ml-detectorconfig" title="Detector Configuration Objects">detector configuration objects</a> in a job can contain
functions that use these script fields.
For more information,
see <a href="/guide/en/elasticsearch/reference/6.7/search-request-script-fields.html" class="ulink" target="_top">Script Fields</a>.
</dd>
<dt>
<span class="term">
<code class="literal">scroll_size</code>
</span>
</dt>
<dd>
(unsigned integer) The <code class="literal">size</code> parameter that is used in Elasticsearch searches.
The default value is <code class="literal">1000</code>.
</dd>
<dt>
<span class="term">
<code class="literal">types</code>
</span>
</dt>
<dd>
(array) A list of types to search for within the specified indices.
For example: <code class="literal">[]</code>. This property is provided for backwards compatibility with
releases earlier than 6.0.0. For more information, see <a class="xref" href="removal-of-types.html" title="Removal of mapping types"><em>Removal of mapping types</em></a>.
</dd>
</dl>
</div>
<p>For more information about these properties,
see <a class="xref" href="ml-datafeed-resource.html" title="Datafeed resources">Datafeed resources</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_authorization_66"></a>Authorization<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.7/docs/reference/ml/apis/update-datafeed.asciidoc">edit</a></h3>
</div></div></div>
<p>If Elasticsearch security features are enabled, you must have <code class="literal">manage_ml</code>, or <code class="literal">manage</code>
cluster privileges to use this API. For more information, see
<a class="xref" href="security-privileges.html" title="Security privileges">Security privileges</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_security_integration_5"></a>Security Integration<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.7/docs/reference/ml/apis/update-datafeed.asciidoc">edit</a></h3>
</div></div></div>
<p>When Elasticsearch security features are enabled, your datafeed remembers which roles the
user who updated it had at the time of update and runs the query using those
same roles.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_examples_73"></a>Examples<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/6.7/docs/reference/ml/apis/update-datafeed.asciidoc">edit</a></h3>
</div></div></div>
<p>The following example updates the query for the <code class="literal">datafeed-total-requests</code>
datafeed so that only log entries of error level are analyzed:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST _xpack/ml/datafeeds/datafeed-total-requests/_update
{
  "query": {
    "term": {
      "level": "error"
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/1668.console"></div>
<p>When the datafeed is updated, you receive the full datafeed configuration with
with the updated values:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "datafeed_id": "datafeed-total-requests",
  "job_id": "total-requests",
  "query_delay": "83474ms",
  "indices": ["server-metrics"],
  "types": [],
  "query": {
    "term": {
      "level": {
        "value": "error",
        "boost": 1.0
      }
    }
  },
  "scroll_size": 1000,
  "chunking_config": {
    "mode": "auto"
  }
}</pre>
</div>
</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="ml-stop-datafeed.html">« Stop datafeeds API</a>
</span>
<span class="next">
<a href="ml-update-filter.html">Update filter API »</a>
</span>
</div>
</div>
</body>
</html>
