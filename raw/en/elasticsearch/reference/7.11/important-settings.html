<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Important Elasticsearch configuration | Elasticsearch Reference [7.11] | Elastic</title>
<link rel="home" href="index.html" title="Elasticsearch Reference [7.11]"/>
<link rel="up" href="setup.html" title="Set up Elasticsearch"/>
<link rel="prev" href="advanced-configuration.html" title="Advanced configuration settings"/>
<link rel="next" href="system-config.html" title="Important System Configuration"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/7.11"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="7.11"/>
</head>
<body><div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Elasticsearch Reference [7.11]</a></span>
»
<span class="breadcrumb-link"><a href="setup.html">Set up Elasticsearch</a></span>
»
<span class="breadcrumb-node">Important Elasticsearch configuration</span>
</div>
<div class="navheader">
<span class="prev">
<a href="advanced-configuration.html">« Advanced configuration settings</a>
</span>
<span class="next">
<a href="system-config.html">Important System Configuration »</a>
</span>
</div>
<div class="chapter">
<div class="titlepage"><div><div>
<h2 class="title"><a id="important-settings"></a>Important Elasticsearch configuration<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.11/docs/reference/setup/important-settings.asciidoc">edit</a></h2>
</div></div></div>
<p>Elasticsearch requires very little configuration to get started, but there are a number
of items which <span class="strong strong"><strong>must</strong></span> be considered before using your cluster in production:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="important-settings.html#path-settings" title="Path settings">Path settings</a>
</li>
<li class="listitem">
<a class="xref" href="important-settings.html#cluster-name" title="Cluster name setting">Cluster name setting</a>
</li>
<li class="listitem">
<a class="xref" href="important-settings.html#node-name" title="Node name setting">Node name setting</a>
</li>
<li class="listitem">
<a class="xref" href="important-settings.html#network.host" title="Network host setting">Network host settings</a>
</li>
<li class="listitem">
<a class="xref" href="important-settings.html#discovery-settings" title="Discovery and cluster formation settings">Discovery settings</a>
</li>
<li class="listitem">
<a class="xref" href="important-settings.html#heap-size-settings" title="Heap size settings">Heap size settings</a>
</li>
<li class="listitem">
<a class="xref" href="important-settings.html#heap-dump-path" title="JVM heap dump path setting">JVM heap dump path setting</a>
</li>
<li class="listitem">
<a class="xref" href="important-settings.html#gc-logging" title="GC logging settings">GC logging settings</a>
</li>
<li class="listitem">
<a class="xref" href="important-settings.html#es-tmpdir" title="Temporary directory settings">Temporary directory settings</a>
</li>
<li class="listitem">
<a class="xref" href="important-settings.html#error-file-path" title="JVM fatal error log setting">JVM fatal error log setting</a>
</li>
<li class="listitem">
<a class="xref" href="important-settings.html#important-settings-backups" title="Cluster backups">Cluster backups</a>
</li>
</ul>
</div>
<p>Our <a href="/cloud/elasticsearch-service/signup?baymax=docs-body&amp;elektra=docs" class="ulink" target="_top">Elastic Cloud</a> service configures these items automatically, making
your cluster production-ready by default.</p>
<h3><a id="path-settings"></a>Path settings<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.11/docs/reference/setup/important-settings/path-settings.asciidoc">edit</a></h3>
<p>For <a class="xref" href="targz.html" title="Install Elasticsearch from archive on Linux or MacOS">macOS <code class="literal">.tar.gz</code></a>, <a class="xref" href="targz.html" title="Install Elasticsearch from archive on Linux or MacOS">Linux <code class="literal">.tar.gz</code></a>, and
<a class="xref" href="zip-windows.html" title="Install Elasticsearch with .zip on Windows">Windows <code class="literal">.zip</code></a> installations, Elasticsearch writes data and logs to the
respective <code class="literal">data</code> and <code class="literal">logs</code> subdirectories of <code class="literal">$ES_HOME</code> by default.
However, files in <code class="literal">$ES_HOME</code> risk deletion during an upgrade.</p>
<p>In production, we strongly recommend you set the <code class="literal">path.data</code> and <code class="literal">path.logs</code> in
<code class="literal">elasticsearch.yml</code> to locations outside of <code class="literal">$ES_HOME</code>.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p><a class="xref" href="docker.html" title="Install Elasticsearch with Docker">Docker</a>, <a class="xref" href="deb.html" title="Install Elasticsearch with Debian Package">Debian</a>, <a class="xref" href="rpm.html" title="Install Elasticsearch with RPM">RPM</a>, <a class="xref" href="brew.html" title="Install Elasticsearch on macOS with Homebrew">macOS Homebrew</a>,
and <a class="xref" href="windows.html" title="Install Elasticsearch with Windows MSI Installer">Windows <code class="literal">.msi</code></a> installations write data and log to locations
outside of <code class="literal">$ES_HOME</code> by default.</p>
</div>
</div>
<p>Supported <code class="literal">path.data</code> and <code class="literal">path.logs</code> values vary by platform:</p>
<style>
.tabs {
  width: 100%;
}
[role="tablist"] {
  margin: 0 0 -0.1em;
  overflow: visible;
}
[role="tab"] {
  position: relative;
  padding: 0.3em 0.5em 0.4em;
  border: 1px solid hsl(219, 1%, 72%);
  border-radius: 0.2em 0.2em 0 0;
  overflow: visible;
  font-family: inherit;
  font-size: inherit;
  background: hsl(220, 20%, 94%);
}
[role="tab"]:hover::before,
[role="tab"]:focus::before,
[role="tab"][aria-selected="true"]::before {
  position: absolute;
  bottom: 100%;
  right: -1px;
  left: -1px;
  border-radius: 0.2em 0.2em 0 0;
  border-top: 3px solid hsl(219, 1%, 72%);
  content: '';
}
[role="tab"][aria-selected="true"] {
  border-radius: 0;
  background: hsl(220, 43%, 99%);
  outline: 0;
}
[role="tab"][aria-selected="true"]:not(:focus):not(:hover)::before {
  border-top: 5px solid hsl(218, 96%, 48%);
}
[role="tab"][aria-selected="true"]::after {
  position: absolute;
  z-index: 3;
  bottom: -1px;
  right: 0;
  left: 0;
  height: 0.3em;
  background: hsl(220, 43%, 99%);
  box-shadow: none;
  content: '';
}
[role="tab"]:hover,
[role="tab"]:focus,
[role="tab"]:active {
  outline: 0;
  border-radius: 0;
  color: inherit;
}
[role="tab"]:hover::before,
[role="tab"]:focus::before {
  border-color: hsl(218, 96%, 48%);
}
[role="tabpanel"] {
  position: relative;
  z-index: 2;
  padding: 1em;
  border: 1px solid hsl(219, 1%, 72%);
  border-radius: 0 0.2em 0.2em 0.2em;
  box-shadow: 0 0 0.2em hsl(219, 1%, 72%);
  background: hsl(220, 43%, 99%);
  margin-bottom: 1em;
}
[role="tabpanel"] p {
  margin: 0;
}
[role="tabpanel"] * + p {
  margin-top: 1em;
}
</style>
<script>
window.addEventListener("DOMContentLoaded", () => {
  const tabs = document.querySelectorAll('[role="tab"]');
  const tabList = document.querySelector('[role="tablist"]');
  // Add a click event handler to each tab
  tabs.forEach(tab => {
    tab.addEventListener("click", changeTabs);
  });
  // Enable arrow navigation between tabs in the tab list
  let tabFocus = 0;
  tabList.addEventListener("keydown", e => {
    // Move right
    if (e.keyCode === 39 || e.keyCode === 37) {
      tabs[tabFocus].setAttribute("tabindex", -1);
      if (e.keyCode === 39) {
        tabFocus++;
        // If we're at the end, go to the start
        if (tabFocus >= tabs.length) {
          tabFocus = 0;
        }
        // Move left
      } else if (e.keyCode === 37) {
        tabFocus--;
        // If we're at the start, move to the end
        if (tabFocus < 0) {
          tabFocus = tabs.length - 1;
        }
      }
      tabs[tabFocus].setAttribute("tabindex", 0);
      tabs[tabFocus].focus();
    }
  });
});
function setActiveTab(target) {
  const parent = target.parentNode;
  const grandparent = parent.parentNode;
  // console.log(grandparent);
  // Remove all current selected tabs
  parent
    .querySelectorAll('[aria-selected="true"]')
    .forEach(t => t.setAttribute("aria-selected", false));
  // Set this tab as selected
  target.setAttribute("aria-selected", true);
  // Hide all tab panels
  grandparent
    .querySelectorAll('[role="tabpanel"]')
    .forEach(p => p.setAttribute("hidden", true));
  // Show the selected panel
  grandparent.parentNode
    .querySelector(`#${target.getAttribute("aria-controls")}`)
    .removeAttribute("hidden");
}
function changeTabs(e) {
  // get the containing list of the tab that was just clicked
  const tabList = e.target.parentNode;

  // get all of the sibling tabs
  const buttons = Array.apply(null, tabList.querySelectorAll('button'));

  // loop over the siblings to discover which index thje clicked one was
  const { index } = buttons.reduce(({ found, index }, button) => {
    if (!found && buttons[index] === e.target) {
      return { found: true, index };
    } else if (!found) {
      return { found, index: index + 1 };
    } else {
      return { found, index };
    }
  }, { found: false, index: 0 });

  // get the tab container
  const container = tabList.parentNode;
  // read the data-tab-group value from the container, e.g. "os"
  const { tabGroup } = container.dataset;
  // get a list of all the tab groups that match this value on the page
  const groups = document.querySelectorAll('[data-tab-group=' + tabGroup + ']');

  // for each of the found tab groups, find the tab button at the previously discovered index and select it for each group
  groups.forEach((group) => {
    const target = group.querySelectorAll('button')[index];
    setActiveTab(target);
  });
}
</script>
<div class="tabs" data-tab-group="os">
  <div role="tablist" aria-label="data-log-path">
    <button role="tab"
            aria-selected="true"
            aria-controls="unix-tab-data-log-path"
            id="unix-data-log-path">
      Unix-like systems
    </button>
    <button role="tab"
            aria-selected="false"
            aria-controls="win-tab-data-log-path"
            id="win-data-log-path">
      Windows
    </button>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="unix-tab-data-log-path"
       aria-labelledby="unix-data-log-path">
<p>Linux and macOS installations support Unix-style paths:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">path:
  data: /var/data/elasticsearch
  logs: /var/log/elasticsearch</pre>
</div>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="win-tab-data-log-path"
       aria-labelledby="win-data-log-path"
       hidden="">
<p>Windows installations support DOS paths with escaped backslashes:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">path:
  data: "C:\\Elastic\\Elasticsearch\\data"
  logs: "C:\\Elastic\\Elasticsearch\\logs"</pre>
</div>
  </div>
</div>
<p>If needed, you can specify multiple paths in <code class="literal">path.data</code>. Elasticsearch stores the node&#8217;s
data across all provided paths but keeps each shard&#8217;s data on the same path.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>Elasticsearch does not balance shards across a node&#8217;s data paths. High disk
usage in a single path can trigger a <a class="xref" href="modules-cluster.html#disk-based-shard-allocation" title="Disk-based shard allocation settings">high disk
usage watermark</a> for the entire node. If triggered, Elasticsearch will not add shards to
the node, even if the node’s other paths have available disk space. If you need
additional disk space, we recommend you add a new node rather than additional
data paths.</p>
</div>
</div>
<div class="tabs" data-tab-group="os">
  <div role="tablist" aria-label="multi-data-path">
    <button role="tab"
            aria-selected="true"
            aria-controls="unix-tab-multi-data-path"
            id="unix-multi-data-path">
      Unix-like systems
    </button>
    <button role="tab"
            aria-selected="false"
            aria-controls="win-tab-multi-data-path"
            id="win-multi-data-path">
      Windows
    </button>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="unix-tab-multi-data-path"
       aria-labelledby="unix-multi-data-path">
<p>Linux and macOS installations support multiple Unix-style paths in <code class="literal">path.data</code>:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">path:
  data:
    - /mnt/elasticsearch_1
    - /mnt/elasticsearch_2
    - /mnt/elasticsearch_3</pre>
</div>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="win-tab-multi-data-path"
       aria-labelledby="win-multi-data-path"
       hidden="">
<p>Windows installations support multiple DOS paths in <code class="literal">path.data</code>:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">path:
  data:
    - "C:\\Elastic\\Elasticsearch_1"
    - "E:\\Elastic\\Elasticsearch_1"
    - "F:\\Elastic\\Elasticsearch_3"</pre>
</div>
  </div>
</div>
<h3><a id="cluster-name"></a>Cluster name setting<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.11/docs/reference/setup/important-settings/cluster-name.asciidoc">edit</a></h3>
<p>A node can only join a cluster when it shares its <code class="literal">cluster.name</code> with all the
other nodes in the cluster. The default name is <code class="literal">elasticsearch</code>, but you should
change it to an appropriate name that describes the purpose of the cluster.</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">cluster.name: logging-prod</pre>
</div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Do not reuse the same cluster names in different environments.
Otherwise, nodes might join the wrong cluster.</p>
</div>
</div>
<h3><a id="node-name"></a>Node name setting<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.11/docs/reference/setup/important-settings/node-name.asciidoc">edit</a></h3>
<p>Elasticsearch uses <code class="literal">node.name</code> as a human-readable identifier for a
particular instance of Elasticsearch. This name is included in the response
of many APIs. The node name defaults to the hostname of the machine when
Elasticsearch starts, but can be configured explicitly in
<code class="literal">elasticsearch.yml</code>:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">node.name: prod-data-2</pre>
</div>
<h3><a id="network.host"></a>Network host setting<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.11/docs/reference/setup/important-settings/network-host.asciidoc">edit</a></h3>
<p>By default, Elasticsearch binds to loopback addresses only such as <code class="literal">127.0.0.1</code>
and <code class="literal">[::1]</code>. This binding is sufficient to run a single development node on a
server.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>more than one node can be started from the same <code class="literal">$ES_HOME</code>
location on a single node. This setup can be useful for testing Elasticsearch&#8217;s
ability to form clusters, but it is not a configuration recommended for
production.</p>
</div>
</div>
<p>To form a cluster with nodes on other servers, your
node will need to bind to a non-loopback address. While there are many
<a class="xref" href="modules-network.html" title="Network settings">network settings</a>, usually all you need to configure is
<code class="literal">network.host</code>:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">network.host: 192.168.1.10</pre>
</div>
<p>The <code class="literal">network.host</code> setting also understands some special values such as
<code class="literal">_local_</code>, <code class="literal">_site_</code>, <code class="literal">_global_</code> and modifiers like <code class="literal">:ip4</code> and <code class="literal">:ip6</code>. See
<a class="xref" href="modules-network.html#network-interface-values" title="Special values for network.host">Special values for <code class="literal">network.host</code></a>.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>When you provide a custom setting for <code class="literal">network.host</code>,
Elasticsearch assumes that you are moving from development mode to production
mode, and upgrades a number of system startup checks from warnings to
exceptions. See the differences between <a class="xref" href="system-config.html#dev-vs-prod" title="Development mode vs production mode">development and production modes</a>.</p>
</div>
</div>
<h3><a id="discovery-settings"></a>Discovery and cluster formation settings<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.11/docs/reference/setup/important-settings/discovery-settings.asciidoc">edit</a></h3>
<p>Configure two important discovery and cluster formation settings before going
to production so that nodes in the cluster can discover each other and elect a
master node.</p>
<h4><a id="unicast.hosts"></a><code class="literal">discovery.seed_hosts</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.11/docs/reference/setup/important-settings/discovery-settings.asciidoc">edit</a></h4>
<p>Out of the box, without any network configuration, Elasticsearch will bind to
the available loopback addresses and scan local ports <code class="literal">9300</code> to <code class="literal">9305</code> to
connect with other nodes running on the same server. This behavior provides an
auto-clustering experience without having to do any configuration.</p>
<p>When you want to form a cluster with nodes on other hosts, use the
<a class="xref" href="settings.html#static-cluster-setting">static</a> <code class="literal">discovery.seed_hosts</code> setting. This setting
provides a list of other nodes in the cluster
that are master-eligible and likely to be live and contactable to seed
the <a class="xref" href="modules-discovery-hosts-providers.html" title="Discovery">discovery process</a>. This setting
accepts a YAML sequence or array of the addresses of all the master-eligible
nodes in the cluster. Each address can be either an IP address or a hostname
that resolves to one or more IP addresses via DNS.</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">discovery.seed_hosts:
   - 192.168.1.10:9300
   - 192.168.1.11 <a id="CO12-1"></a><i class="conum" data-value="1"></i>
   - seeds.mydomain.com <a id="CO12-2"></a><i class="conum" data-value="2"></i>
   - [0:0:0:0:0:ffff:c0a8:10c]:9301 <a id="CO12-3"></a><i class="conum" data-value="3"></i></pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO12-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>The port is optional and defaults to <code class="literal">9300</code>, but can
be <a class="xref" href="modules-discovery-hosts-providers.html#built-in-hosts-providers" title="Seed hosts providers">overridden</a>.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO12-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>If a hostname resolves to multiple IP addresses, the node will attempt to
discover other nodes at all resolved addresses.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO12-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>IPv6 addresses must be enclosed in square brackets.</p>
</td>
</tr>
</table>
</div>
<p>If your master-eligible nodes do not have fixed names or addresses, use an
<a class="xref" href="modules-discovery-hosts-providers.html#built-in-hosts-providers" title="Seed hosts providers">alternative hosts provider</a> to find their addresses
dynamically.</p>
<h4><a id="initial_master_nodes"></a><code class="literal">cluster.initial_master_nodes</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.11/docs/reference/setup/important-settings/discovery-settings.asciidoc">edit</a></h4>
<p>When you start an Elasticsearch cluster for the first time, a
<a class="xref" href="modules-discovery-bootstrap-cluster.html" title="Bootstrapping a cluster">cluster bootstrapping</a> step
determines the set of master-eligible nodes whose votes are counted in the
first election. In <a class="xref" href="bootstrap-checks.html#dev-vs-prod-mode" title="Development vs. production mode">development mode</a>, with no discovery
settings configured, this step is performed automatically by the nodes
themselves.</p>
<p>Because auto-bootstrapping is <a class="xref" href="modules-discovery-quorums.html" title="Quorum-based decision making">inherently
unsafe</a>, when starting a new cluster in production
mode, you must explicitly list the master-eligible nodes whose votes should be
counted in the very first election. You set this list using the
<code class="literal">cluster.initial_master_nodes</code> setting.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>After the cluster forms successfully for the first time, remove the <code class="literal">cluster.initial_master_nodes</code> setting from each nodes'
configuration. Do not use this setting when
restarting a cluster or adding a new node to an existing cluster.</p>
</div>
</div>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">discovery.seed_hosts:
   - 192.168.1.10:9300
   - 192.168.1.11
   - seeds.mydomain.com
   - [0:0:0:0:0:ffff:c0a8:10c]:9301
cluster.initial_master_nodes: <a id="CO13-1"></a><i class="conum" data-value="1"></i>
   - master-node-a
   - master-node-b
   - master-node-c</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO13-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Identify the initial master nodes by their <a class="xref" href="important-settings.html#node-name" title="Node name setting"><code class="literal">node.name</code></a>, which
defaults to their hostname. Ensure that the value in
<code class="literal">cluster.initial_master_nodes</code> matches the <code class="literal">node.name</code> exactly. If you use a
fully-qualified domain name (FQDN) such as <code class="literal">master-node-a.example.com</code> for your
node names, then you must use the FQDN in this list. Conversely, if <code class="literal">node.name</code>
is a bare hostname without any trailing qualifiers, you must also omit the
trailing qualifiers in <code class="literal">cluster.initial_master_nodes</code>.</p>
</td>
</tr>
</table>
</div>
<p>See <a class="xref" href="modules-discovery-bootstrap-cluster.html" title="Bootstrapping a cluster">bootstrapping a cluster</a> and
<a class="xref" href="modules-discovery-settings.html" title="Discovery and cluster formation settings">discovery and cluster formation settings</a>.</p>
<h3><a id="heap-size-settings"></a>Heap size settings<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.11/docs/reference/setup/important-settings/heap-size.asciidoc">edit</a></h3>
<p>By default, Elasticsearch automatically sizes JVM heap based on a node&#8217;s
<a class="xref" href="modules-node.html#node-roles" title="Node roles">roles</a> and total memory. We recommend this default sizing for most
production environments. If needed, you can override default sizing by manually
<a class="xref" href="advanced-configuration.html#setting-jvm-heap-size" title="Setting JVM heap size">setting JVM heap size</a>.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Automatic heap sizing requires the <a class="xref" href="setup.html#jvm-version" title="Java (JVM) Version">bundled JDK</a> or, if using
a custom JRE location, a Java 14 or later JRE.</p>
</div>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>When running in a container, such as <a class="xref" href="docker.html" title="Install Elasticsearch with Docker">Docker</a>, total memory is
defined as the amount of memory visible to the container, not the total system
memory on the host.</p>
</div>
</div>
<h3><a id="heap-dump-path"></a>JVM heap dump path setting<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.11/docs/reference/setup/important-settings/heap-dump-path.asciidoc">edit</a></h3>
<p>By default, Elasticsearch configures the JVM to dump the heap on out of
memory exceptions to the default data directory. On <a class="xref" href="rpm.html" title="Install Elasticsearch with RPM">RPM</a> and
<a class="xref" href="deb.html" title="Install Elasticsearch with Debian Package">Debian</a> packages, the data directory is <code class="literal">/var/lib/elasticsearch</code>. On
<a class="xref" href="targz.html" title="Install Elasticsearch from archive on Linux or MacOS">Linux and MacOS</a> and <a class="xref" href="zip-windows.html" title="Install Elasticsearch with .zip on Windows">Windows</a> distributions,
the <code class="literal">data</code> directory is located under the root of the Elasticsearch installation.</p>
<p>If this path is not suitable for receiving heap dumps, modify the
<code class="literal">-XX:HeapDumpPath=...</code> entry in <a class="xref" href="jvm-options.html" title="Setting JVM options"><code class="literal">jvm.options</code></a>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If you specify a directory, the JVM will generate a filename for the heap
dump based on the PID of the running instance.
</li>
<li class="listitem">
If you specify a fixed filename instead of a directory, the file must
not exist when the JVM needs to perform a heap dump on an out of memory
exception. Otherwise, the heap dump will fail.
</li>
</ul>
</div>
<h3><a id="gc-logging"></a>GC logging settings<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.11/docs/reference/setup/important-settings/gc-logging.asciidoc">edit</a></h3>
<p>By default, Elasticsearch enables garbage collection (GC) logs. These are configured in
<a class="xref" href="jvm-options.html" title="Setting JVM options"><code class="literal">jvm.options</code></a> and output to the same default location as
the Elasticsearch logs. The default configuration rotates the logs every 64 MB and
can consume up to 2 GB of disk space.</p>
<p>You can reconfigure JVM logging using the command line options described in
<a href="https://openjdk.java.net/jeps/158" class="ulink" target="_top">JEP 158: Unified JVM Logging</a>. Unless you
change the default <code class="literal">jvm.options</code> file directly, the Elasticsearch default
configuration is applied in addition to your own settings. To disable the
default configuration, first disable logging by supplying the
<code class="literal">-Xlog:disable</code> option, then supply your own command line options. This
disables <em>all</em> JVM logging, so be sure to review the available options
and enable everything that you require.</p>
<p>To see further options not contained in the original JEP, see
<a href="https://docs.oracle.com/en/java/javase/13/docs/specs/man/java.html#enable-logging-with-the-jvm-unified-logging-framework" class="ulink" target="_top">Enable
Logging with the JVM Unified Logging Framework</a>.</p>
<h4><a id="gc-logging-examples"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.11/docs/reference/setup/important-settings/gc-logging.asciidoc">edit</a></h4>
<p>Change the default GC log output location to <code class="literal">/opt/my-app/gc.log</code> by
  creating <code class="literal">$ES_HOME/config/jvm.options.d/gc.options</code> with some sample
  options:</p>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell"># Turn off all previous logging configuratons
-Xlog:disable

# Default settings from JEP 158, but with `utctime` instead of `uptime` to match the next line
-Xlog:all=warning:stderr:utctime,level,tags

# Enable GC logging to a custom location with a variety of options
-Xlog:gc*,gc+age=trace,safepoint:file=/opt/my-app/gc.log:utctime,pid,tags:filecount=32,filesize=64m</pre>
</div>
<p>Configure an Elasticsearch <a class="xref" href="docker.html" title="Install Elasticsearch with Docker">Docker container</a> to send GC debug logs to
  standard error (<code class="literal">stderr</code>). This lets the container orchestrator
  handle the output. If using the <code class="literal">ES_JAVA_OPTS</code> environment variable,
  specify:</p>
<div class="pre_wrapper lang-sh">
<pre class="programlisting prettyprint lang-sh">MY_OPTS="-Xlog:disable -Xlog:all=warning:stderr:utctime,level,tags -Xlog:gc=debug:stderr:utctime"
docker run -e ES_JAVA_OPTS="$MY_OPTS" # etc</pre>
</div>
<h3><a id="es-tmpdir"></a>Temporary directory settings<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.11/docs/reference/setup/important-settings/es-tmpdir.asciidoc">edit</a></h3>
<p>By default, Elasticsearch uses a private temporary directory that the startup
script creates immediately below the system temporary directory.</p>
<p>On some Linux distributions, a system utility will clean files and directories
from <code class="literal">/tmp</code> if they have not been recently accessed. This behavior can lead to
the private temporary directory being removed while Elasticsearch is running if
features that require the temporary directory are not used for a long time.
Removing the private temporary directory causes problems if a feature that
requires this directory is subsequently used.</p>
<p>If you install Elasticsearch using the <code class="literal">.deb</code> or <code class="literal">.rpm</code> packages and run it
under <code class="literal">systemd</code>, the private temporary directory that Elasticsearch uses
is excluded from periodic cleanup.</p>
<p>If you intend to run the <code class="literal">.tar.gz</code> distribution on Linux or MacOS for
an extended period, consider creating a dedicated temporary
directory for Elasticsearch that is not under a path that will have old files
and directories cleaned from it. This directory should have permissions set
so that only the user that Elasticsearch runs as can access it. Then, set the
<code class="literal">$ES_TMPDIR</code> environment variable to point to this directory before starting
Elasticsearch.</p>
<h3><a id="error-file-path"></a>JVM fatal error log setting<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.11/docs/reference/setup/important-settings/error-file.asciidoc">edit</a></h3>
<p>By default, Elasticsearch configures the JVM to write fatal error logs
to the default logging directory. On <a class="xref" href="rpm.html" title="Install Elasticsearch with RPM">RPM</a> and <a class="xref" href="deb.html" title="Install Elasticsearch with Debian Package">Debian</a> packages,
this directory is <code class="literal">/var/log/elasticsearch</code>. On <a class="xref" href="targz.html" title="Install Elasticsearch from archive on Linux or MacOS">Linux and MacOS</a> and <a class="xref" href="zip-windows.html" title="Install Elasticsearch with .zip on Windows">Windows</a> distributions, the <code class="literal">logs</code>
directory is located under the root of the Elasticsearch installation.</p>
<p>These are logs produced by the JVM when it encounters a fatal error, such as a
segmentation fault. If this path is not suitable for receiving logs,
modify the <code class="literal">-XX:ErrorFile=...</code> entry in <a class="xref" href="jvm-options.html" title="Setting JVM options"><code class="literal">jvm.options</code></a>.</p>
<h3><a id="important-settings-backups"></a>Cluster backups<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.11/docs/reference/setup/important-settings/snapshot.asciidoc">edit</a></h3>
<p>In a disaster, <a class="xref" href="snapshot-restore.html" title="Snapshot and restore">snapshots</a> can prevent permanent data loss.
<a class="xref" href="snapshot-lifecycle-management.html" title="SLM: Manage the snapshot lifecycle">Snapshot lifecycle management</a> is the easiest way to take regular
backups of your cluster. For more information, see <a class="xref" href="backup-cluster.html" title="Back up a cluster"><em>Back up a cluster</em></a>.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>You cannot back up an Elasticsearch cluster by simply copying
the data directories of all of its nodes. Elasticsearch may be making changes to
the contents of its data directories while it is running; copying its data
directories cannot be expected to capture a consistent picture of their contents.
If you try to restore a cluster from such a backup, it may fail and report
corruption and/or missing files. Alternatively, it may appear to have succeeded
though it silently lost some of its data. The only reliable way to back up a
cluster is by using the snapshot and restore functionality.</p>
</div>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="advanced-configuration.html">« Advanced configuration settings</a>
</span>
<span class="next">
<a href="system-config.html">Important System Configuration »</a>
</span>
</div>
</div>
</body>
</html>
