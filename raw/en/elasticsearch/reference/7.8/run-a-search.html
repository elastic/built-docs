<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Run a search | Elasticsearch Reference [7.8] | Elastic</title>
<link rel="home" href="index.html" title="Elasticsearch Reference [7.8]"/>
<link rel="up" href="search-your-data.html" title="Search your data"/>
<link rel="prev" href="search-your-data.html" title="Search your data"/>
<link rel="next" href="async-search-intro.html" title="Long-running searches"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/7.8"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="7.8"/>
</head>
<body><div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Elasticsearch Reference [7.8]</a></span>
»
<span class="breadcrumb-link"><a href="search-your-data.html">Search your data</a></span>
»
<span class="breadcrumb-node">Run a search</span>
</div>
<div class="navheader">
<span class="prev">
<a href="search-your-data.html">« Search your data</a>
</span>
<span class="next">
<a href="async-search-intro.html">Long-running searches »</a>
</span>
</div>
<div class="chapter">
<div class="titlepage"><div><div>
<h2 class="title"><a id="run-a-search"></a>Run a search<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.8/docs/reference/search/run-a-search.asciidoc">edit</a></h2>
</div></div></div>
<p>You can use the <a class="xref" href="search-search.html" title="Search API">search API</a> to search data stored in
one or more Elasticsearch indices.</p>
<p>The API can runs two types of searches, depending on how you provide
<a class="xref" href="search-your-data.html#search-query">queries</a>:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<a class="xref" href="run-a-search.html#run-uri-search" title="Run a URI search">URI searches</a>
</span>
</dt>
<dd>
Queries are provided through a query parameter. URI searches tend to be
simpler and best suited for testing.
</dd>
<dt>
<span class="term">
<a class="xref" href="run-a-search.html#run-request-body-search" title="Run a request body search">Request body searches</a>
</span>
</dt>
<dd>
Queries are provided through the JSON body of the API request. These queries
are written in <a class="xref" href="query-dsl.html" title="Query DSL">Query DSL</a>. We recommend using request body
searches in most production use cases.
</dd>
</dl>
</div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>If you specify a query in both the URI and request body, the search API request
runs only the URI query.</p>
</div>
</div>
<h3><a id="run-uri-search"></a>Run a URI search<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.8/docs/reference/search/run-a-search.asciidoc">edit</a></h3>
<p>You can use the search API&#8217;s <a class="xref" href="search-search.html#search-api-query-params-q"><code class="literal">q</code> query string
parameter</a> to run a search in the request&#8217;s URI. The <code class="literal">q</code> parameter only accepts
queries written in Lucene&#8217;s <a class="xref" href="query-dsl-query-string-query.html#query-string-syntax" title="Query string syntax">query string syntax</a>.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Example</strong></span></summary>
<div class="content">
<p>To get started, ingest or add some data to an Elasticsearch index.</p>
<p>The following <a class="xref" href="docs-bulk.html" title="Bulk API">bulk API</a> request adds some example user log data to
the <code class="literal">user_logs_000001</code> index.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT /user_logs_000001/_bulk?refresh
{"index":{"_index" : "user_logs_000001", "_id" : "1"}}
{ "@timestamp": "2020-12-06T11:04:05.000Z", "user": { "id": "vlb44hny" }, "message": "Login attempt failed" }
{"index":{"_index" : "user_logs_000001", "_id" : "2"}}
{ "@timestamp": "2020-12-07T11:06:07.000Z", "user": { "id": "8a4f500d" }, "message": "Login successful" }
{"index":{"_index" : "user_logs_000001", "_id" : "3"}}
{ "@timestamp": "2020-12-07T11:07:08.000Z", "user": { "id": "l7gk7f82" }, "message": "Logout successful" }</pre>
</div>
<div class="console_widget" data-snippet="snippets/76.console"></div>
<p>You can now use the search API to run a URI search on this index.</p>
<p>The following URI search matches documents with a <code class="literal">user.id</code> value of <code class="literal">l7gk7f82</code>.
Note the query is specified using the <code class="literal">q</code> query string parameter.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /user_logs_000001/_search?q=user.id:8a4f500d</pre>
</div>
<div class="console_widget" data-snippet="snippets/77.console"></div>
<p>The API returns the following response. Note the <code class="literal">hits.hits</code> property contains
the document that matched the query.</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "took": 2,
  "timed_out": false,
  "_shards": {
    "total": 1,
    "successful": 1,
    "skipped": 0,
    "failed": 0
  },
  "hits": {
    "total": {
      "value": 1,
      "relation": "eq"
    },
    "max_score": 0.9808291,
    "hits": [
      {
        "_index": "user_logs_000001",
        "_type": "_doc",
        "_id": "2",
        "_score": 0.9808291,
        "_source": {
          "@timestamp": "2020-12-07T11:06:07.000Z",
          "user": {
            "id": "8a4f500d"
          },
          "message": "Login successful"
        }
      }
    ]
  }
}</pre>
</div>
</div>
</details>
<h3><a id="run-request-body-search"></a>Run a request body search<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.8/docs/reference/search/run-a-search.asciidoc">edit</a></h3>
<p>You can use the search API&#8217;s <a class="xref" href="search-search.html#request-body-search-query"><code class="literal">query</code> request
body parameter</a> to provide a query as a JSON object, written in
<a class="xref" href="query-dsl.html" title="Query DSL">Query DSL</a>.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Example</strong></span></summary>
<div class="content">
<p>The following request body search uses the <a class="xref" href="query-dsl-match-query.html" title="Match query"><code class="literal">match</code></a>
query to match documents with a <code class="literal">message</code> value of <code class="literal">login successful</code>. Note the
<code class="literal">match</code> query is specified as a JSON object in the <code class="literal">query</code> parameter.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /user_logs_000001/_search
{
  "query": {
    "match": {
      "message": "login successful"
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/78.console"></div>
<p>The API returns the following response.</p>
<p>The <code class="literal">hits.hits</code> property contains matching documents. By default, the response
sorts these matching documents by <code class="literal">_score</code>, a <a class="xref" href="query-filter-context.html#relevance-scores" title="Relevance scores">relevance
score</a> that measures how well each document matches the query.</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "took": 1,
  "timed_out": false,
  "_shards": {
    "total": 1,
    "successful": 1,
    "skipped": 0,
    "failed": 0
  },
  "hits": {
    "total": {
      "value": 3,
      "relation": "eq"
    },
    "max_score": 0.9983525,
    "hits": [
      {
        "_index": "user_logs_000001",
        "_type": "_doc",
        "_id": "2",
        "_score": 0.9983525,
        "_source": {
          "@timestamp": "2020-12-07T11:06:07.000Z",
          "user": {
            "id": "8a4f500d"
          },
          "message": "Login successful"
        }
      },
      {
        "_index": "user_logs_000001",
        "_type": "_doc",
        "_id": "3",
        "_score": 0.49917626,
        "_source": {
          "@timestamp": "2020-12-07T11:07:08.000Z",
          "user": {
            "id": "l7gk7f82"
          },
          "message": "Logout successful"
        }
      },
      {
        "_index": "user_logs_000001",
        "_type": "_doc",
        "_id": "1",
        "_score": 0.42081726,
        "_source": {
          "@timestamp": "2020-12-06T11:04:05.000Z",
          "user": {
            "id": "vlb44hny"
          },
          "message": "Login attempt failed"
        }
      }
    ]
  }
}</pre>
</div>
</div>
</details>
<h3><a id="search-multiple-indices"></a>Search multiple indices<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.8/docs/reference/search/run-a-search.asciidoc">edit</a></h3>
<p>To search multiple indices, add them as comma-separated values in the search API
request path.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Example</strong></span></summary>
<div class="content">
<p>The following request searches the <code class="literal">user_logs_000001</code> and <code class="literal">user_logs_000002</code>
indices.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /user_logs_000001,user_logs_000002/_search
{
  "query": {
    "match": {
      "message": "login successful"
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/79.console"></div>
</div>
</details>
<p>You can also search multiple indices using an index pattern.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Example</strong></span></summary>
<div class="content">
<p>The following request uses the index pattern <code class="literal">user_logs*</code> in place of the index
name. The request searches any indices in the cluster that start with
<code class="literal">user_logs</code>.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /user_logs*/_search
{
  "query": {
    "match": {
      "message": "login successful"
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/80.console"></div>
</div>
</details>
<p>To search all indices in a cluster, omit the index name from the request path.
Alternatively, you can use <code class="literal">_all</code> or <code class="literal">*</code> in place of the index name.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Example</strong></span></summary>
<div class="content">
<p>The following requests are equivalent and search all indices in the cluster.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /_search
{
  "query": {
    "match": {
      "message": "login successful"
    }
  }
}

GET /_all/_search
{
  "query": {
    "match": {
      "message": "login successful"
    }
  }
}

GET /*/_search
{
    "query" : {
        "match" : { "message" : "login" }
    }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/81.console"></div>
</div>
</details>
<h3><a id="paginate-search-results"></a>Paginate search results<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.8/docs/reference/search/request/from-size.asciidoc">edit</a></h3>
<p>By default, the search API returns the top 10 matching documents.</p>
<p>To paginate through a larger set of results, you can use the search API&#8217;s <code class="literal">size</code>
and <code class="literal">from</code> parameters. The <code class="literal">size</code> parameter is the number of matching documents
to return. The <code class="literal">from</code> parameter is a zero-indexed offset from the beginning of
the complete result set that indicates the document you want to start with.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Example</strong></span></summary>
<div class="content">
<p>The following search API request sets the <code class="literal">from</code> offset to <code class="literal">5</code>, meaning the
request offsets, or skips, the first five matching documents.</p>
<p>The <code class="literal">size</code> parameter is <code class="literal">20</code>, meaning the request can return up to 20 documents,
starting at the offset.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /_search
{
  "from": 5,
  "size": 20,
  "query": {
    "term": { "user": "kimchy" }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/82.console"></div>
</div>
</details>
<p>By default, you cannot page through more than 10,000 documents using the <code class="literal">from</code>
and <code class="literal">size</code> parameters. This limit is set using the
<a class="xref" href="index-modules.html#index-max-result-window"><code class="literal">index.max_result_window</code></a> index setting.</p>
<p>Deep paging or requesting many results at once can result in slow searches.
Results are sorted before being returned. Because search requests usually span
multiple shards, each shard must generate its own sorted results. These separate
results must then be combined and sorted to ensure that the overall sort order
is correct.</p>
<p>As an alternative to deep paging, we recommend using
<a class="xref" href="search-request-body.html#request-body-search-scroll" title="Scroll">scroll</a> or the
<a class="xref" href="search-request-body.html#request-body-search-search-after" title="Search After"><code class="literal">search_after</code></a> parameter.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>Elasticsearch uses Lucene&#8217;s internal doc IDs as tie-breakers. These internal
doc IDs can be completely different across replicas of the same
data. When paginating, you might occasionally see that documents with the same
sort values are not ordered consistently.</p>
</div>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="search-your-data.html">« Search your data</a>
</span>
<span class="next">
<a href="async-search-intro.html">Long-running searches »</a>
</span>
</div>
</div>
</body>
</html>
