<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Put index template API | Elasticsearch Guide [7.9] | Elastic</title>
<meta class="elastic" name="content" content="Put index template API | Elasticsearch Guide [7.9]">

<link rel="home" href="index.html" title="Elasticsearch Guide [7.9]"/>
<link rel="up" href="indices.html" title="Index APIs"/>
<link rel="prev" href="indices-open-close.html" title="Open index API"/>
<link rel="next" href="indices-templates-v1.html" title="Put index template API"/>
<meta class="elastic" name="product_version" content="7.9"/>
<meta class="elastic" name="product_name" content="Elasticsearch"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/7.9"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="7.9"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div class="navheader">
<span class="prev">
<a href="indices-open-close.html">« Open index API</a>
</span>
<span class="next">
<a href="indices-templates-v1.html">Put index template API »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elasticsearch Guide [7.9]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="rest-apis.html">REST APIs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="indices.html">Index APIs</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Put index template API</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/7.9/docs/reference/indices/put-index-template.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="indices-put-template"></a>Put index template API<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/7.9/docs/reference/indices/put-index-template.asciidoc">edit</a></h2>
</div></div></div>

<p>Creates or updates an index template.
Index templates define <a class="xref" href="index-modules.html#index-modules-settings" title="Index Settings">settings</a>, <a class="xref" href="mapping.html" title="Mapping">mappings</a>,
and <a class="xref" href="indices-aliases.html" title="Update index alias API">aliases</a> that can be applied automatically to new indices.</p>
<div class="pre_wrapper lang-console">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console">PUT /_index_template/template_1
{
  "index_patterns" : ["te*"],
  "priority" : 1,
  "template": {
    "settings" : {
      "number_of_shards" : 2
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/1887.console"></div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="put-index-template-api-request"></a>Request<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/7.9/docs/reference/indices/put-index-template.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">PUT /_index_template/&lt;index-template&gt;</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="put-index-template-api-desc"></a>Description<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/7.9/docs/reference/indices/put-index-template.asciidoc">edit</a></h3>
</div></div></div>
<p>Elasticsearch applies templates to new indices based on an
wildcard pattern that matches the index name.</p>
<p>Index templates are applied during data stream or index creation.
For data streams, these settings and mappings are applied when the stream&#8217;s backing indices are created.</p>
<p>Settings and mappings specified in a <a class="xref" href="indices-create-index.html" title="Create index API">create index</a>
request override any settings or mappings specified in an index template.</p>
<p>Changes to index templates do not affect
existing indices, including the existing backing indices of a data stream.</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_comments_in_index_templates"></a>Comments in index templates<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/7.9/docs/reference/indices/put-index-template.asciidoc">edit</a></h4>
</div></div></div>
<p>You can use C-style /* */ block comments in index templates. You can include comments anywhere in
the request body, except before the opening curly bracket.</p>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="put-index-template-api-path-params"></a>Path parameters<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/7.9/docs/reference/indices/put-index-template.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;index-template&gt;</code>
</span>
</dt>
<dd>
(Required, string)
Name of the index template to create.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="put-index-template-api-query-params"></a>Query parameters<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/7.9/docs/reference/indices/put-index-template.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">create</code>
</span>
</dt>
<dd>
(Optional, Boolean)
If <code class="literal">true</code>, this request cannot replace or update existing index templates. Defaults to <code class="literal">false</code>.
</dd>
<dt>
<span class="term">
<code class="literal">master_timeout</code>
</span>
</dt>
<dd>
(Optional, <a class="xref" href="common-options.html#time-units" title="Time units">time units</a>) Specifies the period of time to wait for
a connection to the master node. If no response is received before the timeout
expires, the request fails and returns an error. Defaults to <code class="literal">30s</code>.
</dd>
</dl>
</div>
</div>

<div class="section child_attributes">
<div class="titlepage"><div><div>
<h3 class="title"><a id="put-index-template-api-request-body"></a>Request body<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/7.9/docs/reference/indices/put-index-template.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">index_patterns</code>
</span>
</dt>
<dd>
<p>
(Required, array of strings)
Array of wildcard (<code class="literal">*</code>) expressions
used to match the names of data streams and indices during creation.
</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Elasticsearch has built-in index templates for the <code class="literal">metrics-*-*</code> and <code class="literal">logs-*-*</code> index
patterns, each with a priority of <code class="literal">100</code>.
<a href="/guide/en/fleet/7.9/ingest-management-overview.html" class="ulink" target="_top">Elastic Agent</a> uses these templates to
create data streams. If you use Elastic Agent, assign your index templates a priority
lower than <code class="literal">100</code> to avoid an overriding the built-in templates.</p>
<p>Otherwise, to avoid accidentally applying the built-in templates, use a
non-overlapping index pattern or assign templates with an overlapping pattern a
<code class="literal">priority</code> higher than <code class="literal">100</code>.</p>
<p>For example, if you don&#8217;t use Elastic Agent and want to create a template for the
<code class="literal">logs-*</code> index pattern, assign your template a priority of <code class="literal">200</code>. This ensures
your template is applied instead of the built-in template for <code class="literal">logs-*-*</code>.</p>
</div>
</div>
</dd>
<dt>
<span class="term">
<span class="xpack"><code class="literal">data_stream</code></span><a class="xpack_tag" href="/subscriptions"></a>
</span>
</dt>
<dd>
<p>
(Optional, object)
Indicates whether the template is used to create data streams and their backing
indices. If so, use an empty object as the argument:<br>
<code class="literal">data_stream: { }</code>.
</p>
<p>Data streams require a matching index template with a <code class="literal">data_stream</code> object.
See <a class="xref" href="set-up-a-data-stream.html#create-a-data-stream-template" title="Create an index template">Create an index template</a>.</p>
</dd>
<dt>
<span class="term">
<code class="literal">template</code>
</span>
</dt>
<dd>
<p>
(Optional, object)
Template to be applied. It may optionally include an <code class="literal">aliases</code>, <code class="literal">mappings</code>, or
<code class="literal">settings</code> configuration.
</p>
<details open>
<summary class="title">Properties of <code class="literal">template</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">aliases</code>
</span>
</dt>
<dd>
<p>
(Optional, <a class="xref" href="indices-aliases.html" title="Update index alias API">alias object</a>) Index aliases which include the
index. See <a class="xref" href="indices-aliases.html" title="Update index alias API">Update index alias</a>.
</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>You cannot add data streams to an index alias.</p>
</div>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">mappings</code>
</span>
</dt>
<dd>
<p>(Optional, <a class="xref" href="mapping.html" title="Mapping">mapping object</a>) Mapping for fields in the index. If
specified, this mapping can include:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Field names
</li>
<li class="listitem">
<a class="xref" href="mapping-types.html" title="Field data types">Field data types</a>
</li>
<li class="listitem">
<a class="xref" href="mapping-params.html" title="Mapping parameters">Mapping parameters</a>
</li>
</ul>
</div>
<p>See <a class="xref" href="mapping.html" title="Mapping">Mapping</a>.</p>
</dd>
<dt>
<span class="term">
<code class="literal">settings</code>
</span>
</dt>
<dd>
(Optional, <a class="xref" href="index-modules.html#index-modules-settings" title="Index Settings">index setting object</a>) Configuration
options for the index. See <a class="xref" href="index-modules.html#index-modules-settings" title="Index Settings">Index Settings</a>.
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">composed_of</code>
</span>
</dt>
<dd>
(Optional, array of strings)
An ordered list of component template names. Component templates are merged in the order
specified, meaning that the last component template specified has the highest precedence. See
<a class="xref" href="indices-put-template.html#multiple-component-templates" title="Composing aliases, mappings, and settings">Composing multiple component templates</a> for an example.
</dd>
<dt>
<span class="term">
<code class="literal">priority</code>
</span>
</dt>
<dd>
(Optional, integer)
Priority to determine index template precedence when a new data stream or index is created. The index template with
the highest priority is chosen. If no priority is specified the template is treated as though it is
of priority 0 (lowest priority).
This number is not automatically generated by Elasticsearch.
</dd>
<dt>
<span class="term">
<code class="literal">version</code>
</span>
</dt>
<dd>
(Optional, integer)
Version number used to manage index templates externally.
This number is not automatically generated by Elasticsearch.
</dd>
<dt>
<span class="term">
<code class="literal">_meta</code>
</span>
</dt>
<dd>
(Optional, object)
Optional user metadata about the index template. May have any contents.
This map is not automatically generated by Elasticsearch.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="put-index-template-api-example"></a>Examples<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/7.9/docs/reference/indices/put-index-template.asciidoc">edit</a></h3>
</div></div></div>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_index_template_with_index_aliases"></a>Index template with index aliases<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/7.9/docs/reference/indices/put-index-template.asciidoc">edit</a></h4>
</div></div></div>
<p>You can include <a class="xref" href="indices-aliases.html" title="Update index alias API">index aliases</a> in an index template.</p>
<div class="pre_wrapper lang-console">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console">PUT _index_template/template_1
{
  "index_patterns" : ["te*"],
  "template": {
    "settings" : {
        "number_of_shards" : 1
    },
    "aliases" : {
        "alias1" : {},
        "alias2" : {
            "filter" : {
                "term" : {"user.id" : "kimchy" }
            },
            "routing" : "shard-1"
        },
        "{index}-alias" : {} <a id="CO609-1"></a><i class="conum" data-value="1"></i>
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/1888.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO609-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>the <code class="literal">{index}</code> placeholder in the alias name will be replaced with the
actual index name that the template gets applied to, during index creation.</p>
</td>
</tr>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="multiple-templates"></a>Multiple matching templates<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/7.9/docs/reference/indices/put-index-template.asciidoc">edit</a></h4>
</div></div></div>
<p>If multiple index templates match the name of a new index or data stream,
the template with the highest priority is used. For example:</p>
<div class="pre_wrapper lang-console">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console">PUT /_index_template/template_1
{
  "index_patterns" : ["t*"],
  "priority" : 0,
  "template": {
    "settings" : {
      "number_of_shards" : 1,
      "number_of_replicas": 0
    },
    "mappings" : {
      "_source" : { "enabled" : false }
    }
  }
}

PUT /_index_template/template_2
{
  "index_patterns" : ["te*"],
  "priority" : 1,
  "template": {
    "settings" : {
      "number_of_shards" : 2
    },
    "mappings" : {
      "_source" : { "enabled" : true }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/1889.console"></div>
<p>For indices that start with <code class="literal">te*</code>, <code class="literal">_source</code> will enabled, and the index will have two primary
shards and one replica, because only <code class="literal">template_2</code> will be applied.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Multiple templates with overlapping index patterns at the same priority are not allowed, and
an error will be thrown when attempting to create a template matching an existing index template at
identical priorities.</p>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="versioning-templates"></a>Template versioning<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/7.9/docs/reference/indices/put-index-template.asciidoc">edit</a></h4>
</div></div></div>
<p>You can use the <code class="literal">version</code> parameter to add a version number to an index template.
External systems can use these version numbers to simplify template management.</p>
<p>The <code class="literal">version</code> parameter is optional and not automatically generated or used by Elasticsearch.</p>
<p>To unset a <code class="literal">version</code>, replace the template without specifying one.</p>
<div class="pre_wrapper lang-console">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console">PUT /_index_template/template_1
{
  "index_patterns" : ["foo", "bar"],
  "priority" : 0,
  "template": {
    "settings" : {
        "number_of_shards" : 1
    }
  },
  "version": 123
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/1890.console"></div>
<p>To check the <code class="literal">version</code>, you can use the <a class="xref" href="indices-get-template.html" title="Get index template API">get index template</a> API.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="template-metadata"></a>Template metadata<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/7.9/docs/reference/indices/put-index-template.asciidoc">edit</a></h4>
</div></div></div>
<p>You can use the <code class="literal">_meta</code> parameter to add arbitrary metadata to an index template.
This user-defined object is stored in the cluster state,
so keeping it short is preferrable.</p>
<p>The <code class="literal">_meta</code> parameter is optional and not automatically generated or used by Elasticsearch.</p>
<p>To unset <code class="literal">_meta</code>, replace the template without specifying one.</p>
<div class="pre_wrapper lang-console">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console">PUT /_index_template/template_1
{
  "index_patterns": ["foo", "bar"],
  "template": {
    "settings" : {
        "number_of_shards" : 3
    }
  },
  "_meta": {
    "description": "set number of shards to three",
    "serialization": {
      "class": "MyIndexTemplate",
      "id": 17
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/1891.console"></div>
<p>To check the <code class="literal">_meta</code>, you can use the <a class="xref" href="indices-get-template.html" title="Get index template API">get index template</a> API.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="data-stream-definition"></a>Data stream definition<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/7.9/docs/reference/indices/put-index-template.asciidoc">edit</a></h4>
</div></div></div>
<p>To use an index template for a data stream, the template must include an empty <code class="literal">data_stream</code> object.
Data stream templates are only used for a stream&#8217;s backing indices,
they are not applied to regular indices.
See <a class="xref" href="set-up-a-data-stream.html#create-a-data-stream-template" title="Create an index template">Create an index template</a>.</p>
<div class="pre_wrapper lang-console">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console">PUT /_index_template/template_1
{
  "index_patterns": ["logs-*"],
  "data_stream": { }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/1892.console"></div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="multiple-component-templates"></a>Composing aliases, mappings, and settings<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/7.9/docs/reference/indices/put-index-template.asciidoc">edit</a></h4>
</div></div></div>
<p>When multiple component templates are specified in the <code class="literal">composed_of</code> field for an index template,
they are merged in the order specified, meaning that later component templates override earlier
component templates. Any mappings, settings, or aliases from the parent index template are merged
in next. Finally, any configuration on the index request itself is merged.</p>
<p>In this example, the order of the two component templates changes the number of shards for an
index:</p>
<div class="pre_wrapper lang-console">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console">PUT /_component_template/template_with_2_shards
{
  "template": {
    "settings": {
      "index.number_of_shards": 2
    }
  }
}

PUT /_component_template/template_with_3_shards
{
  "template": {
    "settings": {
      "index.number_of_shards": 3
    }
  }
}

PUT /_index_template/template_1
{
  "index_patterns": ["t*"],
  "composed_of": ["template_with_2_shards", "template_with_3_shards"]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/1893.console"></div>
<p>In this case, an index matching <code class="literal">t*</code> will have three primary shards. If the order of composed
templates were reversed, the index would have two primary shards.</p>
<p>Mapping definitions are merged recursively, which means that later mapping components can
introduce new field mappings and update the mapping configuration. If a field mapping is
already contained in an earlier component, its definition will be completely overwritten
by the later one.</p>
<p>This recursive merging strategy applies not only to field mappings, but also root options like
<code class="literal">dynamic_templates</code> and <code class="literal">meta</code>. If an earlier component contains a <code class="literal">dynamic_templates</code> block,
then by default new <code class="literal">dynamic_templates</code> entries are appended onto the end. If an entry already
exists with the same key, then it is overwritten by the new definition.</p>
</div>

</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="indices-open-close.html">« Open index API</a>
</span>
<span class="next">
<a href="indices-templates-v1.html">Put index template API »</a>
</span>
</div>
</body>
</html>
