<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>EQL function reference | Elasticsearch Reference [7.x] | Elastic</title>
<link rel="home" href="index.html" title="Elasticsearch Reference [7.x]"/>
<link rel="up" href="eql.html" title="EQL search"/>
<link rel="prev" href="eql-syntax.html" title="EQL syntax reference"/>
<link rel="next" href="eql-pipe-ref.html" title="EQL pipe reference"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/7.x"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="7.x"/>
</head>
<body><div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Elasticsearch Reference [7.x]</a></span>
»
<span class="breadcrumb-link"><a href="eql.html">EQL search</a></span>
»
<span class="breadcrumb-node">EQL function reference</span>
</div>
<div class="navheader">
<span class="prev">
<a href="eql-syntax.html">« EQL syntax reference</a>
</span>
<span class="next">
<a href="eql-pipe-ref.html">EQL pipe reference »</a>
</span>
</div>
<div class="chapter xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="eql-function-ref"></a>EQL function reference<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/functions.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in beta and is subject to change. The design and code is less mature than official GA features and is being provided as-is with no warranties. Beta features are not subject to the support SLA of official GA features.</p>
</div>
</div>
<p>Elasticsearch supports the following <a class="xref" href="eql-syntax.html#eql-functions" title="Functions">EQL functions</a>. Most EQL functions
are case-sensitive by default.</p>
<h3><a id="eql-fn-add"></a><code class="literal">add</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/functions.asciidoc">edit</a></h3>
<p>Returns the sum of two provided addends.</p>
<p><span class="strong strong"><strong>Example</strong></span></p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">add(4, 5)                                           // returns 9
add(4, 0.5)                                         // returns 4.5
add(0.5, 0.25)                                      // returns 0.75
add(4, -2)                                          // returns 2
add(-2, -2)                                         // returns -4

// process.args_count = 4
add(process.args_count, 5)                          // returns 9
add(process.args_count, 0.5)                        // returns 4.5

// process.parent.args_count = 2
add(process.args_count, process.parent.args_count)  // returns 6

// null handling
add(null, 4)                                        // returns null
add(4. null)                                        // returns null
add(null, process.args_count)                       // returns null
add(process.args_count null)                        // returns null</pre>
</div>
<p><span class="strong strong"><strong>Syntax</strong></span></p>
<div class="pre_wrapper lang-txt">
<pre class="programlisting prettyprint lang-txt">add(&lt;addend&gt;, &lt;addend&gt;)</pre>
</div>
<p><span class="strong strong"><strong>Parameters:</strong></span></p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;addend&gt;</code>
</span>
</dt>
<dd>
<p>
(Required, integer or float or <code class="literal">null</code>)
Addend to add. If <code class="literal">null</code>, the function returns <code class="literal">null</code>.
</p>
<p>Two addends are required. No more than two addends can be provided.</p>
<p>If using a field as the argument, this parameter supports only
<a class="xref" href="number.html" title="Numeric field types"><code class="literal">numeric</code></a> field data types.</p>
</dd>
</dl>
</div>
<p><span class="strong strong"><strong>Returns:</strong></span> integer, float, or <code class="literal">null</code></p>
<h3><a id="eql-fn-between"></a><code class="literal">between</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/functions.asciidoc">edit</a></h3>
<p>Extracts a substring that&#8217;s between a provided <code class="literal">left</code> and <code class="literal">right</code> text in a
source string. Matching is case-sensitive.</p>
<p><span class="strong strong"><strong>Example</strong></span></p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">// file.path = "C:\\Windows\\System32\\cmd.exe"
between(file.path, "system32\\\\", ".exe")                // returns "cmd"
between(file.path, "workspace\\\\", ".exe")               // returns ""

// Greedy matching defaults to false.
between(file.path, "\\\\", "\\\\", false)                 // returns "Windows"

// Sets greedy matching to true
between(file.path, "\\\\", "\\\\", true)                  // returns "Windows\\System32"

// empty source string
between("", "system32\\\\", ".exe")                       // returns ""
between("", "", "")                                       // returns ""

// null handling
between(null, "system32\\\\", ".exe")                     // returns null</pre>
</div>
<p><span class="strong strong"><strong>Syntax</strong></span></p>
<div class="pre_wrapper lang-txt">
<pre class="programlisting prettyprint lang-txt">between(&lt;source&gt;, &lt;left&gt;, &lt;right&gt;[, &lt;greedy_matching&gt;])</pre>
</div>
<p><span class="strong strong"><strong>Parameters</strong></span></p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;source&gt;</code>
</span>
</dt>
<dd>
<p>(Required, string or <code class="literal">null</code>)
Source string. Empty strings return an empty string (<code class="literal">""</code>), regardless of the
<code class="literal">&lt;left&gt;</code> or <code class="literal">&lt;right&gt;</code> parameters. If <code class="literal">null</code>, the function returns <code class="literal">null</code>.</p>
<p>If using a field as the argument, this parameter supports only the following
field data types:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
A type in the <a class="xref" href="keyword.html" title="Keyword type family"><code class="literal">keyword</code></a> family
</li>
<li class="listitem">
<a class="xref" href="text.html" title="Text field type"><code class="literal">text</code></a> field with a <a class="xref" href="keyword.html" title="Keyword type family"><code class="literal">keyword</code></a> sub-field
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">&lt;left&gt;</code>
</span>
</dt>
<dd>
<p>(Required, string)
Text to the left of the substring to extract. This text should include
whitespace.</p>
<p>If using a field as the argument, this parameter supports only the following
field data types:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
A type in the <a class="xref" href="keyword.html" title="Keyword type family"><code class="literal">keyword</code></a> family
</li>
<li class="listitem">
<a class="xref" href="text.html" title="Text field type"><code class="literal">text</code></a> field with a <a class="xref" href="keyword.html" title="Keyword type family"><code class="literal">keyword</code></a> sub-field
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">&lt;right&gt;</code>
</span>
</dt>
<dd>
<p>(Required, string)
Text to the right of the substring to extract. This text should include
whitespace.</p>
<p>If using a field as the argument, this parameter supports only the following
field data types:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
A type in the <a class="xref" href="keyword.html" title="Keyword type family"><code class="literal">keyword</code></a> family
</li>
<li class="listitem">
<a class="xref" href="text.html" title="Text field type"><code class="literal">text</code></a> field with a <a class="xref" href="keyword.html" title="Keyword type family"><code class="literal">keyword</code></a> sub-field
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">&lt;greedy_matching&gt;</code>
</span>
</dt>
<dd>
(Optional, boolean)
If <code class="literal">true</code>, match the longest possible substring, similar to <code class="literal">.*</code> in regular
expressions. If <code class="literal">false</code>, match the shortest possible substring, similar to <code class="literal">.*?</code>
in regular expressions. Defaults to <code class="literal">false</code>.
</dd>
</dl>
</div>
<p><span class="strong strong"><strong>Returns:</strong></span> string or <code class="literal">null</code></p>
<h3><a id="eql-fn-cidrmatch"></a><code class="literal">cidrMatch</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/functions.asciidoc">edit</a></h3>
<p>Returns <code class="literal">true</code> if an IP address is contained in one or more provided
<a href="https://en.wikipedia.org/wiki/Classless_Inter-Domain_Routing" class="ulink" target="_top">CIDR</a> blocks.</p>
<p><span class="strong strong"><strong>Example</strong></span></p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">// source.address = "192.168.152.12"
cidrMatch(source.address, "192.168.0.0/16")               // returns true
cidrMatch(source.address, "192.168.0.0/16", "10.0.0.0/8") // returns true
cidrMatch(source.address, "10.0.0.0/8")                   // returns false
cidrMatch(source.address, "10.0.0.0/8", "10.128.0.0/9")   // returns false

// null handling
cidrMatch(null, "10.0.0.0/8")                             // returns null
cidrMatch(source.address, null)                           // returns null</pre>
</div>
<p><span class="strong strong"><strong>Syntax</strong></span></p>
<div class="pre_wrapper lang-txt">
<pre class="programlisting prettyprint lang-txt">`cidrMatch(&lt;ip_address&gt;, &lt;cidr_block&gt;[, ...])`</pre>
</div>
<p><span class="strong strong"><strong>Parameters</strong></span></p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;ip_address&gt;</code>
</span>
</dt>
<dd>
<p>
(Required, string or <code class="literal">null</code>)
IP address. Supports
<a href="https://en.wikipedia.org/wiki/IPv4" class="ulink" target="_top">IPv4</a> and
<a href="https://en.wikipedia.org/wiki/IPv6" class="ulink" target="_top">IPv6</a> addresses. If <code class="literal">null</code>, the function
returns <code class="literal">null</code>.
</p>
<p>If using a field as the argument, this parameter supports only the <a class="xref" href="ip.html" title="IP field type"><code class="literal">ip</code></a>
field data type.</p>
</dd>
<dt>
<span class="term">
<code class="literal">&lt;cidr_block&gt;</code>
</span>
</dt>
<dd>
(Required†<sup class="footnote" id="_footnote_multi-arg">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup>, string or <code class="literal">null</code>)
CIDR block you wish to search. If <code class="literal">null</code>, the function returns <code class="literal">null</code>.
</dd>
</dl>
</div>
<p><span class="strong strong"><strong>Returns:</strong></span> boolean or <code class="literal">null</code></p>
<h3><a id="eql-fn-concat"></a><code class="literal">concat</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/functions.asciidoc">edit</a></h3>
<p>Returns a concatenated string of provided values.</p>
<p><span class="strong strong"><strong>Example</strong></span></p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">concat("process is ", "regsvr32.exe")         // returns "process is regsvr32.exe"
concat("regsvr32.exe", " ", 42)               // returns "regsvr32.exe 42"
concat("regsvr32.exe", " ", 42.5)             // returns "regsvr32.exe 42.5"
concat("regsvr32.exe", " ", true)             // returns "regsvr32.exe true"
concat("regsvr32.exe")                        // returns "regsvr32.exe"

// process.name = "regsvr32.exe"
concat(process.name, " ", 42)                 // returns "regsvr32.exe 42"
concat(process.name, " ", 42.5)               // returns "regsvr32.exe 42.5"
concat("process is ", process.name)           // returns "process is regsvr32.exe"
concat(process.name, " ", true)               // returns "regsvr32.exe true"
concat(process.name)                          // returns "regsvr32.exe"

// process.arg_count = 4
concat(process.name, " ", process.arg_count)  // returns "regsvr32.exe 4"

// null handling
concat(null, "regsvr32.exe")                  // returns null
concat(process.name, null)                    // returns null
concat(null)                                  // returns null</pre>
</div>
<p><span class="strong strong"><strong>Syntax</strong></span></p>
<div class="pre_wrapper lang-txt">
<pre class="programlisting prettyprint lang-txt">concat(&lt;value&gt;[, &lt;value&gt;])</pre>
</div>
<p><span class="strong strong"><strong>Parameters</strong></span></p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;value&gt;</code>
</span>
</dt>
<dd>
<p>
(Required†<sup class="footnoteref">[<a class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup>)
Value to concatenate. If any of the arguments are <code class="literal">null</code>, the function returns <code class="literal">null</code>.
</p>
<p>If using a field as the argument, this parameter does not support the
<a class="xref" href="text.html" title="Text field type"><code class="literal">text</code></a> field data type.</p>
</dd>
</dl>
</div>
<p><span class="strong strong"><strong>Returns:</strong></span> string or <code class="literal">null</code></p>
<h3><a id="eql-fn-divide"></a><code class="literal">divide</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/functions.asciidoc">edit</a></h3>
<p>Returns the quotient of a provided dividend and divisor.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<a id="eql-divide-fn-float-rounding"></a>
<p>If both the dividend and divisor are integers, the <code class="literal">divide</code> function <em>rounds
down</em> any returned floating point numbers to the nearest integer.</p>
<p>EQL queries in Elasticsearch should account for this rounding. To avoid rounding, convert
either the dividend or divisor to a float.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Example</strong></span></summary>
<div class="content">
<p>The <code class="literal">process.args_count</code> field is a <a class="xref" href="number.html" title="Numeric field types"><code class="literal">long</code></a> integer field containing a
count of process arguments.</p>
<p>A user might expect the following EQL query to only match events with a
<code class="literal">process.args_count</code> value of <code class="literal">4</code>.</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">process where divide(4, process.args_count) == 1</pre>
</div>
<p>However, the EQL query matches events with a <code class="literal">process.args_count</code> value of <code class="literal">3</code>
or <code class="literal">4</code>.</p>
<p>For events with a <code class="literal">process.args_count</code> value of <code class="literal">3</code>, the <code class="literal">divide</code> function
returns a floating point number of <code class="literal">1.333...</code>, which is rounded down to <code class="literal">1</code>.</p>
<p>To match only events with a <code class="literal">process.args_count</code> value of <code class="literal">4</code>, convert
either the dividend or divisor to a float.</p>
<p>The following EQL query changes the integer <code class="literal">4</code> to the equivalent float <code class="literal">4.0</code>.</p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">process where divide(4.0, process.args_count) == 1</pre>
</div>
</div>
</details>
</div>
</div>
<p><span class="strong strong"><strong>Example</strong></span></p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">divide(4, 2)                                            // returns 2
divide(4, 3)                                            // returns 1
divide(4, 3.0)                                          // returns 1.333...
divide(4, 0.5)                                          // returns 8
divide(0.5, 4)                                          // returns 0.125
divide(0.5, 0.25)                                       // returns 2.0
divide(4, -2)                                           // returns -2
divide(-4, -2)                                          // returns 2

// process.args_count = 4
divide(process.args_count, 2)                           // returns 2
divide(process.args_count, 3)                           // returns 1
divide(process.args_count, 3.0)                         // returns 1.333...
divide(12, process.args_count)                          // returns 3
divide(process.args_count, 0.5)                         // returns 8
divide(0.5, process.args_count)                         // returns 0.125

// process.parent.args_count = 2
divide(process.args_count, process.parent.args_count)   // returns 2

// null handling
divide(null, 4)                                         // returns null
divide(4, null)                                         // returns null
divide(null, process.args_count)                        // returns null
divide(process.args_count, null)                        // returns null</pre>
</div>
<p><span class="strong strong"><strong>Syntax</strong></span></p>
<div class="pre_wrapper lang-txt">
<pre class="programlisting prettyprint lang-txt">divide(&lt;dividend&gt;, &lt;divisor&gt;)</pre>
</div>
<p><span class="strong strong"><strong>Parameters</strong></span></p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;dividend&gt;</code>
</span>
</dt>
<dd>
<p>
(Required, integer or float or <code class="literal">null</code>)
Dividend to divide. If <code class="literal">null</code>, the function returns <code class="literal">null</code>.
</p>
<p>If using a field as the argument, this parameter supports only
<a class="xref" href="number.html" title="Numeric field types"><code class="literal">numeric</code></a> field data types.</p>
</dd>
<dt>
<span class="term">
<code class="literal">&lt;divisor&gt;</code>
</span>
</dt>
<dd>
<p>
(Required, integer or float or <code class="literal">null</code>)
Divisor to divide by. If <code class="literal">null</code>, the function returns <code class="literal">null</code>. This value cannot
be zero (<code class="literal">0</code>).
</p>
<p>If using a field as the argument, this parameter supports only
<a class="xref" href="number.html" title="Numeric field types"><code class="literal">numeric</code></a> field data types.</p>
</dd>
</dl>
</div>
<p><span class="strong strong"><strong>Returns:</strong></span> integer, float, or null</p>
<h3><a id="eql-fn-endswith"></a><code class="literal">endsWith</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/functions.asciidoc">edit</a></h3>
<p>Returns <code class="literal">true</code> if a source string ends with a provided substring. Matching is
case-sensitive.</p>
<p><span class="strong strong"><strong>Example</strong></span></p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">endsWith("regsvr32.exe", ".exe")          // returns true
endsWith("regsvr32.exe", ".dll")          // returns false
endsWith("", "")                          // returns true

// file.name = "regsvr32.exe"
endsWith(file.name, ".exe")               // returns true
endsWith(file.name, ".dll")               // returns false

// file.extension = ".exe"
endsWith("regsvr32.exe", file.extension)  // returns true
endsWith("ntdll.dll", file.name)          // returns false

// null handling
endsWith("regsvr32.exe", null)            // returns null
endsWith("", null)                        // returns null
endsWith(null, ".exe")                    // returns null
endsWith(null, null)                      // returns null</pre>
</div>
<p><span class="strong strong"><strong>Syntax</strong></span></p>
<div class="pre_wrapper lang-txt">
<pre class="programlisting prettyprint lang-txt">endsWith(&lt;source&gt;, &lt;substring&gt;)</pre>
</div>
<p><span class="strong strong"><strong>Parameters</strong></span></p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;source&gt;</code>
</span>
</dt>
<dd>
<p>(Required, string or <code class="literal">null</code>)
Source string. If <code class="literal">null</code>, the function returns <code class="literal">null</code>.</p>
<p>If using a field as the argument, this parameter supports only the following
field data types:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
A type in the <a class="xref" href="keyword.html" title="Keyword type family"><code class="literal">keyword</code></a> family
</li>
<li class="listitem">
<a class="xref" href="text.html" title="Text field type"><code class="literal">text</code></a> field with a <a class="xref" href="keyword.html" title="Keyword type family"><code class="literal">keyword</code></a> sub-field
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">&lt;substring&gt;</code>
</span>
</dt>
<dd>
<p>(Required, string or <code class="literal">null</code>)
Substring to search for. If <code class="literal">null</code>, the function returns <code class="literal">null</code>.</p>
<p>If using a field as the argument, this parameter supports only the following
field data types:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
A type in the <a class="xref" href="keyword.html" title="Keyword type family"><code class="literal">keyword</code></a> family
</li>
<li class="listitem">
<a class="xref" href="text.html" title="Text field type"><code class="literal">text</code></a> field with a <a class="xref" href="keyword.html" title="Keyword type family"><code class="literal">keyword</code></a> sub-field
</li>
</ul>
</div>
</dd>
</dl>
</div>
<p><span class="strong strong"><strong>Returns:</strong></span> boolean or <code class="literal">null</code></p>
<h3><a id="eql-fn-indexof"></a><code class="literal">indexOf</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/functions.asciidoc">edit</a></h3>
<p>Returns the first position of a provided substring in a source string. Matching
is case-sensitive.</p>
<p>If an optional start position is provided, this function returns the first
occurrence of the substring at or after the start position.</p>
<p><span class="strong strong"><strong>Example</strong></span></p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">// url.domain = "subdomain.example.com"
indexOf(url.domain, ".")        // returns 9
indexOf(url.domain, ".", 9)     // returns 9
indexOf(url.domain, ".", 10)    // returns 17
indexOf(url.domain, ".", -6)    // returns 9

// empty strings
indexOf("", "")                 // returns 0
indexOf(url.domain, "")         // returns 0
indexOf(url.domain, "", 9)      // returns 9
indexOf(url.domain, "", 10)     // returns 10
indexOf(url.domain, "", -6)     // returns 0

// missing substrings
indexOf(url.domain, "z")        // returns null
indexOf(url.domain, "z", 9)     // returns null

// start position is higher than string length
indexOf(url.domain, ".", 30)    // returns null

// null handling
indexOf(null, ".", 9)           // returns null
indexOf(url.domain, null, 9)    // returns null
indexOf(url.domain, ".", null)  // returns null</pre>
</div>
<p><span class="strong strong"><strong>Syntax</strong></span></p>
<div class="pre_wrapper lang-txt">
<pre class="programlisting prettyprint lang-txt">indexOf(&lt;source&gt;, &lt;substring&gt;[, &lt;start_pos&gt;])</pre>
</div>
<p><span class="strong strong"><strong>Parameters</strong></span></p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;source&gt;</code>
</span>
</dt>
<dd>
<p>(Required, string or <code class="literal">null</code>)
Source string. If <code class="literal">null</code>, the function returns <code class="literal">null</code>.</p>
<p>If using a field as the argument, this parameter supports only the following
field data types:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
A type in the <a class="xref" href="keyword.html" title="Keyword type family"><code class="literal">keyword</code></a> family
</li>
<li class="listitem">
<a class="xref" href="text.html" title="Text field type"><code class="literal">text</code></a> field with a <a class="xref" href="keyword.html" title="Keyword type family"><code class="literal">keyword</code></a> sub-field
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">&lt;substring&gt;</code>
</span>
</dt>
<dd>
<p>(Required, string or <code class="literal">null</code>)
Substring to search for.</p>
<p>If this argument is <code class="literal">null</code> or the <code class="literal">&lt;source&gt;</code> string does not contain this
substring, the function returns <code class="literal">null</code>.</p>
<p>If the <code class="literal">&lt;start_pos&gt;</code> is positive, empty strings (<code class="literal">""</code>) return the <code class="literal">&lt;start_pos&gt;</code>.
Otherwise, empty strings return <code class="literal">0</code>.</p>
<p>If using a field as the argument, this parameter supports only the following
field data types:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
A type in the <a class="xref" href="keyword.html" title="Keyword type family"><code class="literal">keyword</code></a> family
</li>
<li class="listitem">
<a class="xref" href="text.html" title="Text field type"><code class="literal">text</code></a> field with a <a class="xref" href="keyword.html" title="Keyword type family"><code class="literal">keyword</code></a> sub-field
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">&lt;start_pos&gt;</code>
</span>
</dt>
<dd>
<p>(Optional, integer or <code class="literal">null</code>)
Starting position for matching. The function will not return positions before
this one. Defaults to <code class="literal">0</code>.</p>
<p>Positions are zero-indexed. Negative offsets are treated as <code class="literal">0</code>.</p>
<p>If this argument is <code class="literal">null</code> or higher than the length of the <code class="literal">&lt;source&gt;</code> string,
the function returns <code class="literal">null</code>.</p>
<p>If using a field as the argument, this parameter supports only the following
<a class="xref" href="number.html" title="Numeric field types">numeric</a> field data types:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">long</code>
</li>
<li class="listitem">
<code class="literal">integer</code>
</li>
<li class="listitem">
<code class="literal">short</code>
</li>
<li class="listitem">
<code class="literal">byte</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<p><span class="strong strong"><strong>Returns:</strong></span> integer or <code class="literal">null</code></p>
<h3><a id="eql-fn-length"></a><code class="literal">length</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/functions.asciidoc">edit</a></h3>
<p>Returns the character length of a provided string, including whitespace and
punctuation.</p>
<p><span class="strong strong"><strong>Example</strong></span></p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">length("explorer.exe")         // returns 12
length("start explorer.exe")   // returns 18
length("")                     // returns 0
length(null)                   // returns null

// process.name = "regsvr32.exe"
length(process.name)           // returns 12</pre>
</div>
<p><span class="strong strong"><strong>Syntax</strong></span></p>
<div class="pre_wrapper lang-txt">
<pre class="programlisting prettyprint lang-txt">length(&lt;string&gt;)</pre>
</div>
<p><span class="strong strong"><strong>Parameters</strong></span></p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;string&gt;</code>
</span>
</dt>
<dd>
<p>(Required, string or <code class="literal">null</code>)
String for which to return the character length. If <code class="literal">null</code>, the function returns
<code class="literal">null</code>. Empty strings return <code class="literal">0</code>.</p>
<p>If using a field as the argument, this parameter supports only the following
field data types:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
A type in the <a class="xref" href="keyword.html" title="Keyword type family"><code class="literal">keyword</code></a> family
</li>
<li class="listitem">
<a class="xref" href="text.html" title="Text field type"><code class="literal">text</code></a> field with a <a class="xref" href="keyword.html" title="Keyword type family"><code class="literal">keyword</code></a> sub-field
</li>
</ul>
</div>
</dd>
</dl>
</div>
<p><span class="strong strong"><strong>Returns:</strong></span> integer or <code class="literal">null</code></p>
<h3><a id="eql-fn-match"></a><code class="literal">match</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/functions.asciidoc">edit</a></h3>
<p>Returns <code class="literal">true</code> if a source string matches one or more provided regular
expressions. Matching is case-sensitive.</p>
<p><span class="strong strong"><strong>Example</strong></span></p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">match("explorer.exe", "[a-z]*?.exe")           // returns true
match("explorer.exe", "[a-z]*?.exe", "[1-9]")  // returns true
match("explorer.exe", "[1-9]")                 // returns false
match("explorer.exe", "")                      // returns false

// process.name = "explorer.exe"
match(process.name, "[a-z]*?.exe")             // returns true
match(process.name, "[a-z]*?.exe", "[1-9]")    // returns true
match(process.name, "[1-9]")                   // returns false
match(process.name, "")                        // returns false

// null handling
match(null, "[a-z]*?.exe")                     // returns null</pre>
</div>
<p><span class="strong strong"><strong>Syntax</strong></span></p>
<div class="pre_wrapper lang-txt">
<pre class="programlisting prettyprint lang-txt">match(&lt;source&gt;, &lt;reg_exp&gt;[, ...])</pre>
</div>
<p><span class="strong strong"><strong>Parameters</strong></span></p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;source&gt;</code>
</span>
</dt>
<dd>
<p>(Required, string or <code class="literal">null</code>)
Source string. If <code class="literal">null</code>, the function returns <code class="literal">null</code>.</p>
<p>If using a field as the argument, this parameter supports only the following
field data types:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
A type in the <a class="xref" href="keyword.html" title="Keyword type family"><code class="literal">keyword</code></a> family
</li>
<li class="listitem">
<a class="xref" href="text.html" title="Text field type"><code class="literal">text</code></a> field with a <a class="xref" href="keyword.html" title="Keyword type family"><code class="literal">keyword</code></a> sub-field
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">&lt;reg_exp&gt;</code>
</span>
</dt>
<dd>
<p>(Required†<sup class="footnoteref">[<a class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup>, string)
Regular expression used to match the source string. For supported syntax, see
<a class="xref" href="regexp-syntax.html" title="Regular expression syntax"><em>Regular expression syntax</em></a>.
<a href="https://docs.oracle.com/javase/tutorial/essential/regex/pre_char_classes.html" class="ulink" target="_top">Predefined
character classes</a> are not supported.</p>
<p>Fields are not supported as arguments.</p>
</dd>
</dl>
</div>
<p><span class="strong strong"><strong>Returns:</strong></span> boolean or <code class="literal">null</code></p>
<h3><a id="eql-fn-modulo"></a><code class="literal">modulo</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/functions.asciidoc">edit</a></h3>
<p>Returns the remainder of the division of a provided dividend and divisor.</p>
<p><span class="strong strong"><strong>Example</strong></span></p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">modulo(10, 6)                                       // returns 4
modulo(10, 5)                                       // returns 0
modulo(10, 0.5)                                     // returns 0
modulo(10, -6)                                      // returns 4
modulo(-10, -6)                                     // returns -4

// process.args_count = 10
modulo(process.args_count, 6)                       // returns 4
modulo(process.args_count, 5)                       // returns 0
modulo(106, process.args_count)                     // returns 6
modulo(process.args_count, -6)                      // returns 4
modulo(process.args_count, 0.5)                     // returns 0

// process.parent.args_count = 6
add(process.args_count, process.parent.args_count)  // returns 4

// null handling
modulo(null, 5)                                     // returns null
modulo(7, null)                                     // returns null
modulo(null, process.args_count)                    // returns null
modulo(process.args_count, null)                    // returns null</pre>
</div>
<p><span class="strong strong"><strong>Syntax</strong></span></p>
<div class="pre_wrapper lang-txt">
<pre class="programlisting prettyprint lang-txt">modulo(&lt;dividend&gt;, &lt;divisor&gt;)</pre>
</div>
<p><span class="strong strong"><strong>Parameters</strong></span></p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;dividend&gt;</code>
</span>
</dt>
<dd>
<p>
(Required, integer or float or <code class="literal">null</code>)
Dividend to divide. If <code class="literal">null</code>, the function returns <code class="literal">null</code>. Floating point
numbers return <code class="literal">0</code>.
</p>
<p>If using a field as the argument, this parameter supports only
<a class="xref" href="number.html" title="Numeric field types"><code class="literal">numeric</code></a> field data types.</p>
</dd>
<dt>
<span class="term">
<code class="literal">&lt;divisor&gt;</code>
</span>
</dt>
<dd>
<p>
(Required, integer or float or <code class="literal">null</code>)
Divisor to divide by. If <code class="literal">null</code>, the function returns <code class="literal">null</code>. Floating point
numbers return <code class="literal">0</code>. This value cannot be zero (<code class="literal">0</code>).
</p>
<p>If using a field as the argument, this parameter supports only
<a class="xref" href="number.html" title="Numeric field types"><code class="literal">numeric</code></a> field data types.</p>
</dd>
</dl>
</div>
<p><span class="strong strong"><strong>Returns:</strong></span> integer, float, or <code class="literal">null</code></p>
<h3><a id="eql-fn-multiply"></a><code class="literal">multiply</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/functions.asciidoc">edit</a></h3>
<p>Returns the product of two provided factors.</p>
<p><span class="strong strong"><strong>Example</strong></span></p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">multiply(2, 2)                                           // returns 4
multiply(0.5, 2)                                         // returns 1
multiply(0.25, 2)                                        // returns 0.5
multiply(-2, 2)                                          // returns -4
multiply(-2, -2)                                         // returns 4

// process.args_count = 2
multiply(process.args_count, 2)                          // returns 4
multiply(0.5, process.args_count)                        // returns 1
multiply(0.25, process.args_count)                       // returns 0.5

// process.parent.args_count = 3
multiply(process.args_count, process.parent.args_count)  // returns 6

// null handling
multiply(null, 2)                                        // returns null
multiply(2, null)                                        // returns null</pre>
</div>
<p><span class="strong strong"><strong>Syntax</strong></span></p>
<div class="pre_wrapper lang-txt">
<pre class="programlisting prettyprint lang-txt">multiply(&lt;factor, &lt;factor&gt;)</pre>
</div>
<p><span class="strong strong"><strong>Parameters</strong></span></p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;factor&gt;</code>
</span>
</dt>
<dd>
<p>(Required, integer or float or <code class="literal">null</code>)
Factor to multiply.  If <code class="literal">null</code>, the function returns <code class="literal">null</code>.</p>
<p>Two factors are required. No more than two factors can be provided.</p>
<p>If using a field as the argument, this parameter supports only
<a class="xref" href="number.html" title="Numeric field types"><code class="literal">numeric</code></a> field data types.</p>
</dd>
</dl>
</div>
<p><span class="strong strong"><strong>Returns:</strong></span> integer, float, or <code class="literal">null</code></p>
<h3><a id="eql-fn-number"></a><code class="literal">number</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/functions.asciidoc">edit</a></h3>
<p>Converts a string to the corresponding integer or float.</p>
<p><span class="strong strong"><strong>Example</strong></span></p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">number("1337")              // returns 1337
number("42.5")              // returns 42.5
number("deadbeef", 16)      // returns 3735928559

// integer literals beginning with "0x" are auto-detected as hexadecimal
number("0xdeadbeef")        // returns 3735928559
number("0xdeadbeef", 16)    // returns 3735928559

// "+" and "-" are supported
number("+1337")             // returns 1337
number("-1337")             // returns -1337

// surrounding whitespace is ignored
number("  1337  ")          // returns 1337

// process.pid = "1337"
number(process.pid)         // returns 1337

// null handling
number(null)                // returns null
number(null, 16)            // returns null

// strings beginning with "0x" are treated as hexadecimal (base 16),
// even if the &lt;base_num&gt; is explicitly null.
number("0xdeadbeef", null) // returns 3735928559

// otherwise, strings are treated as decimal (base 10)
// if the &lt;base_num&gt; is explicitly null.
number("1337", null)        // returns 1337</pre>
</div>
<p><span class="strong strong"><strong>Syntax</strong></span></p>
<div class="pre_wrapper lang-txt">
<pre class="programlisting prettyprint lang-txt">number(&lt;string&gt;[, &lt;base_num&gt;])</pre>
</div>
<p><span class="strong strong"><strong>Parameters</strong></span></p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;string&gt;</code>
</span>
</dt>
<dd>
<p>(Required, string or <code class="literal">null</code>)
String to convert to an integer or float. If this value is a string, it must be
one of the following:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
A string representation of an integer (e.g., <code class="literal">"42"</code>)
</li>
<li class="listitem">
A string representation of a float (e.g., <code class="literal">"9.5"</code>)
</li>
<li class="listitem">
If the <code class="literal">&lt;base_num&gt;</code> parameter is specified, a string containing an integer
literal in the base notation (e.g., <code class="literal">"0xDECAFBAD"</code> in hexadecimal or base
<code class="literal">16</code>)
</li>
</ul>
</div>
<p>Strings that begin with <code class="literal">0x</code> are auto-detected as hexadecimal and use a default
<code class="literal">&lt;base_num&gt;</code> of <code class="literal">16</code>.</p>
<p><code class="literal">-</code> and <code class="literal">+</code> are supported with no space between. Surrounding whitespace is
ignored. Empty strings (<code class="literal">""</code>) are not supported.</p>
<p>If using a field as the argument, this parameter supports only the following
field data types:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
A type in the <a class="xref" href="keyword.html" title="Keyword type family"><code class="literal">keyword</code></a> family
</li>
<li class="listitem">
<a class="xref" href="text.html" title="Text field type"><code class="literal">text</code></a> field with a <a class="xref" href="keyword.html" title="Keyword type family"><code class="literal">keyword</code></a> sub-field
</li>
</ul>
</div>
<p>If this argument is <code class="literal">null</code>, the function returns <code class="literal">null</code>.</p>
</dd>
<dt>
<span class="term">
<code class="literal">&lt;base_num&gt;</code>
</span>
</dt>
<dd>
<p>(Optional, integer or <code class="literal">null</code>)
Radix or base used to convert the string. If the <code class="literal">&lt;string&gt;</code> begins with <code class="literal">0x</code>,
this parameter defaults to <code class="literal">16</code> (hexadecimal). Otherwise, it defaults to base
<code class="literal">10</code>.</p>
<p>If this argument is explicitly <code class="literal">null</code>, the default value is used.</p>
<p>Fields are not supported as arguments.</p>
</dd>
</dl>
</div>
<p><span class="strong strong"><strong>Returns:</strong></span> integer or float or <code class="literal">null</code></p>
<h3><a id="eql-fn-startswith"></a><code class="literal">startsWith</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/functions.asciidoc">edit</a></h3>
<p>Returns <code class="literal">true</code> if a source string begins with a provided substring. Matching is
case-sensitive.</p>
<p><span class="strong strong"><strong>Example</strong></span></p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">startsWith("regsvr32.exe", "regsvr32")  // returns true
startsWith("regsvr32.exe", "explorer")  // returns false
startsWith("", "")                      // returns true

// process.name = "regsvr32.exe"
startsWith(process.name, "regsvr32")    // returns true
startsWith(process.name, "explorer")    // returns false

// process.name = "regsvr32"
startsWith("regsvr32.exe", process.name) // returns true
startsWith("explorer.exe", process.name) // returns false

// null handling
startsWith("regsvr32.exe", null)        // returns null
startsWith("", null)                    // returns null
startsWith(null, "regsvr32")            // returns null
startsWith(null, null)                  // returns null</pre>
</div>
<p><span class="strong strong"><strong>Syntax</strong></span></p>
<div class="pre_wrapper lang-txt">
<pre class="programlisting prettyprint lang-txt">startsWith(&lt;source&gt;, &lt;substring&gt;)</pre>
</div>
<p><span class="strong strong"><strong>Parameters</strong></span></p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;source&gt;</code>
</span>
</dt>
<dd>
<p>(Required, string or <code class="literal">null</code>)
Source string. If <code class="literal">null</code>, the function returns <code class="literal">null</code>.</p>
<p>If using a field as the argument, this parameter supports only the following
field data types:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
A type in the <a class="xref" href="keyword.html" title="Keyword type family"><code class="literal">keyword</code></a> family
</li>
<li class="listitem">
<a class="xref" href="text.html" title="Text field type"><code class="literal">text</code></a> field with a <a class="xref" href="keyword.html" title="Keyword type family"><code class="literal">keyword</code></a> sub-field
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">&lt;substring&gt;</code>
</span>
</dt>
<dd>
<p>(Required, string or <code class="literal">null</code>)
Substring to search for. If <code class="literal">null</code>, the function returns <code class="literal">null</code>.</p>
<p>If using a field as the argument, this parameter supports only the following
field data types:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
A type in the <a class="xref" href="keyword.html" title="Keyword type family"><code class="literal">keyword</code></a> family
</li>
<li class="listitem">
<a class="xref" href="text.html" title="Text field type"><code class="literal">text</code></a> field with a <a class="xref" href="keyword.html" title="Keyword type family"><code class="literal">keyword</code></a> sub-field
</li>
</ul>
</div>
</dd>
</dl>
</div>
<p><span class="strong strong"><strong>Returns:</strong></span> boolean or <code class="literal">null</code></p>
<h3><a id="eql-fn-string"></a><code class="literal">string</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/functions.asciidoc">edit</a></h3>
<p>Converts a value to a string.</p>
<p><span class="strong strong"><strong>Example</strong></span></p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">string(42)               // returns "42"
string(42.5)             // returns "42.5"
string("regsvr32.exe")   // returns "regsvr32.exe"
string(true)             // returns "true"

// null handling
string(null)             // returns null</pre>
</div>
<p><span class="strong strong"><strong>Syntax</strong></span></p>
<div class="pre_wrapper lang-txt">
<pre class="programlisting prettyprint lang-txt">string(&lt;value&gt;)</pre>
</div>
<p><span class="strong strong"><strong>Parameters</strong></span></p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;value&gt;</code>
</span>
</dt>
<dd>
<p>
(Required)
Value to convert to a string. If <code class="literal">null</code>, the function returns <code class="literal">null</code>.
</p>
<p>If using a field as the argument, this parameter does not support the
<a class="xref" href="text.html" title="Text field type"><code class="literal">text</code></a> field data type.</p>
</dd>
</dl>
</div>
<p><span class="strong strong"><strong>Returns:</strong></span> string or <code class="literal">null</code></p>
<h3><a id="eql-fn-stringcontains"></a><code class="literal">stringContains</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/functions.asciidoc">edit</a></h3>
<p>Returns <code class="literal">true</code> if a source string contains a provided substring. Matching is
case-sensitive.</p>
<p><span class="strong strong"><strong>Example</strong></span></p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">// process.command_line = "start regsvr32.exe"
stringContains(process.command_line, "regsvr32")  // returns true
stringContains(process.command_line, "start ")    // returns true
stringContains(process.command_line, "explorer")  // returns false

// process.name = "regsvr32.exe"
stringContains(command_line, process.name)        // returns true

// empty strings
stringContains("", "")                            // returns false
stringContains(process.command_line, "")          // returns false

// null handling
stringContains(null, "regsvr32")                  // returns null
stringContains(process.command_line, null)        // returns null</pre>
</div>
<p><span class="strong strong"><strong>Syntax</strong></span></p>
<div class="pre_wrapper lang-txt">
<pre class="programlisting prettyprint lang-txt">stringContains(&lt;source&gt;, &lt;substring&gt;)</pre>
</div>
<p><span class="strong strong"><strong>Parameters</strong></span></p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;source&gt;</code>
</span>
</dt>
<dd>
(Required, string or <code class="literal">null</code>)
Source string to search. If <code class="literal">null</code>, the function returns <code class="literal">null</code>.
</dd>
</dl>
</div>
<p>If using a field as the argument, this parameter supports only the following
field data types:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
A type in the <a class="xref" href="keyword.html" title="Keyword type family"><code class="literal">keyword</code></a> family
</li>
<li class="listitem">
<p><a class="xref" href="text.html" title="Text field type"><code class="literal">text</code></a> field with a <a class="xref" href="keyword.html" title="Keyword type family"><code class="literal">keyword</code></a> sub-field</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;substring&gt;</code>
</span>
</dt>
<dd>
(Required, string or <code class="literal">null</code>)
Substring to search for. If <code class="literal">null</code>, the function returns <code class="literal">null</code>.
</dd>
</dl>
</div>
</li>
</ul>
</div>
<p>If using a field as the argument, this parameter supports only the following
field data types:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
A type in the <a class="xref" href="keyword.html" title="Keyword type family"><code class="literal">keyword</code></a> family
</li>
<li class="listitem">
<a class="xref" href="text.html" title="Text field type"><code class="literal">text</code></a> field with a <a class="xref" href="keyword.html" title="Keyword type family"><code class="literal">keyword</code></a> sub-field
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Returns:</strong></span> boolean or <code class="literal">null</code></p>
<h3><a id="eql-fn-substring"></a><code class="literal">substring</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/functions.asciidoc">edit</a></h3>
<p>Extracts a substring from a source string at provided start and end positions.</p>
<p>If no end position is provided, the function extracts the remaining string.</p>
<p><span class="strong strong"><strong>Example</strong></span></p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">substring("start regsvr32.exe", 6)        // returns "regsvr32.exe"
substring("start regsvr32.exe", 0, 5)     // returns "start"
substring("start regsvr32.exe", 6, 14)    // returns "regsvr32"
substring("start regsvr32.exe", -4)       // returns ".exe"
substring("start regsvr32.exe", -4, -1)   // returns ".ex"</pre>
</div>
<p><span class="strong strong"><strong>Syntax</strong></span></p>
<div class="pre_wrapper lang-txt">
<pre class="programlisting prettyprint lang-txt">substring(&lt;source&gt;, &lt;start_pos&gt;[, &lt;end_pos&gt;])</pre>
</div>
<p><span class="strong strong"><strong>Parameters</strong></span></p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;source&gt;</code>
</span>
</dt>
<dd>
(Required, string)
Source string.
</dd>
<dt>
<span class="term">
<code class="literal">&lt;start_pos&gt;</code>
</span>
</dt>
<dd>
<p>(Required, integer)
Starting position for extraction.</p>
<p>If this position is higher than the <code class="literal">&lt;end_pos&gt;</code> position or the length of the
<code class="literal">&lt;source&gt;</code> string, the function returns an empty string.</p>
<p>Positions are zero-indexed. Negative offsets are supported.</p>
</dd>
<dt>
<span class="term">
<code class="literal">&lt;end_pos&gt;</code>
</span>
</dt>
<dd>
<p>
(Optional, integer)
Exclusive end position for extraction. If this position is not provided, the
function returns the remaining string.
</p>
<p>Positions are zero-indexed. Negative offsets are supported.</p>
</dd>
</dl>
</div>
<p><span class="strong strong"><strong>Returns:</strong></span> string</p>
<h3><a id="eql-fn-subtract"></a><code class="literal">subtract</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/functions.asciidoc">edit</a></h3>
<p>Returns the difference between a provided minuend and subtrahend.</p>
<p><span class="strong strong"><strong>Example</strong></span></p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">subtract(10, 2)                                          // returns 8
subtract(10.5, 0.5)                                      // returns 10
subtract(1, 0.2)                                         // returns 0.8
subtract(-2, 4)                                          // returns -8
subtract(-2, -4)                                         // returns 8

// process.args_count = 10
subtract(process.args_count, 6)                          // returns 4
subtract(process.args_count, 5)                          // returns 5
subtract(15, process.args_count)                         // returns 5
subtract(process.args_count, 0.5)                        // returns 9.5

// process.parent.args_count = 6
subtract(process.args_count, process.parent.args_count)  // returns 4

// null handling
subtract(null, 2)                                        // returns null
subtract(2, null)                                        // returns null</pre>
</div>
<p><span class="strong strong"><strong>Syntax</strong></span></p>
<div class="pre_wrapper lang-txt">
<pre class="programlisting prettyprint lang-txt">subtract(&lt;minuend&gt;, &lt;subtrahend&gt;)</pre>
</div>
<p><span class="strong strong"><strong>Parameters</strong></span></p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;minuend&gt;</code>
</span>
</dt>
<dd>
<p>
(Required, integer or float or <code class="literal">null</code>)
Minuend to subtract from.
</p>
<p>If using a field as the argument, this parameter supports only
<a class="xref" href="number.html" title="Numeric field types"><code class="literal">numeric</code></a> field data types.</p>
</dd>
<dt>
<span class="term">
<code class="literal">&lt;subtrahend&gt;</code>
</span>
</dt>
<dd>
<p>
(Optional, integer or float or <code class="literal">null</code>)
Subtrahend to subtract. If <code class="literal">null</code>, the function returns <code class="literal">null</code>.
</p>
<p>If using a field as the argument, this parameter supports only
<a class="xref" href="number.html" title="Numeric field types"><code class="literal">numeric</code></a> field data types.</p>
</dd>
</dl>
</div>
<p><span class="strong strong"><strong>Returns:</strong></span> integer, float, or <code class="literal">null</code></p>
<h3><a id="eql-fn-wildcard"></a><code class="literal">wildcard</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/functions.asciidoc">edit</a></h3>
<p>Returns <code class="literal">true</code> if a source string matches one or more provided wildcard
expressions. Matching is case-sensitive.</p>
<p><span class="strong strong"><strong>Example</strong></span></p>
<div class="pre_wrapper lang-eql">
<pre class="programlisting prettyprint lang-eql">// The two following expressions are equivalent.
process.name == "*regsvr32*" or process.name == "*explorer*"
wildcard(process.name, "*regsvr32*", "*explorer*")

// process.name = "regsvr32.exe"
wildcard(process.name, "*regsvr32*")                // returns true
wildcard(process.name, "*regsvr32*", "*explorer*")  // returns true
wildcard(process.name, "*explorer*")                // returns false
wildcard(process.name, "*explorer*", "*scrobj*")    // returns false

// empty strings
wildcard("", "*start*")                             // returns false
wildcard("", "*")                                   // returns true
wildcard("", "")                                    // returns true

// null handling
wildcard(null, "*regsvr32*")                        // returns null
wildcard(process.name, null)                        // returns null</pre>
</div>
<p><span class="strong strong"><strong>Syntax</strong></span></p>
<div class="pre_wrapper lang-txt">
<pre class="programlisting prettyprint lang-txt">wildcard(&lt;source&gt;, &lt;wildcard_exp&gt;[, ...])</pre>
</div>
<p><span class="strong strong"><strong>Parameters</strong></span></p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;source&gt;</code>
</span>
</dt>
<dd>
<p>(Required, string)
Source string. If <code class="literal">null</code>, the function returns <code class="literal">null</code>.</p>
<p>If using a field as the argument, this parameter supports only the following
field data types:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
A type in the <a class="xref" href="keyword.html" title="Keyword type family"><code class="literal">keyword</code></a> family
</li>
<li class="listitem">
<a class="xref" href="text.html" title="Text field type"><code class="literal">text</code></a> field with a <a class="xref" href="keyword.html" title="Keyword type family"><code class="literal">keyword</code></a> sub-field
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">&lt;wildcard_exp&gt;</code>
</span>
</dt>
<dd>
<p>(Required†<sup class="footnoteref">[<a class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup>, string)
Wildcard expression used to match the source string. If <code class="literal">null</code>, the function
returns <code class="literal">null</code>. Fields are not supported as arguments.</p>
</dd>
</dl>
</div>
<p><span class="strong strong"><strong>Returns:</strong></span> boolean</p>
</div>
<div id="footnotes">
<div class="footnote" id="_footnotedef_1">
<sup>[<a href="#_footnoteref_1">1</a>]</sup> This parameter accepts multiple arguments.
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="eql-syntax.html">« EQL syntax reference</a>
</span>
<span class="next">
<a href="eql-pipe-ref.html">EQL pipe reference »</a>
</span>
</div>
</div>
</body>
</html>
