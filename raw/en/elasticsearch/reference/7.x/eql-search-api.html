<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>EQL search API | Elasticsearch Reference [7.x] | Elastic</title>
<link rel="home" href="index.html" title="Elasticsearch Reference [7.x]"/>
<link rel="up" href="search.html" title="Search APIs"/>
<link rel="prev" href="search-multi-search.html" title="Multi search API"/>
<link rel="next" href="get-async-eql-search-api.html" title="Get async EQL search API"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/7.x"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="7.x"/>
</head>
<body><div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Elasticsearch Reference [7.x]</a></span>
»
<span class="breadcrumb-link"><a href="rest-apis.html">REST APIs</a></span>
»
<span class="breadcrumb-link"><a href="search.html">Search APIs</a></span>
»
<span class="breadcrumb-node">EQL search API</span>
</div>
<div class="navheader">
<span class="prev">
<a href="search-multi-search.html">« Multi search API</a>
</span>
<span class="next">
<a href="get-async-eql-search-api.html">Get async EQL search API »</a>
</span>
</div>
<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="eql-search-api"></a>EQL search API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/eql-search-api.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is experimental and may be changed or removed completely in a future release. Elastic will take a best effort approach to fix any issues, but experimental features are not subject to the support SLA of official GA features.</p>
</div>
</div>
<p>Returns search results for an <a class="xref" href="eql.html" title="EQL search">Event Query Language (EQL)</a> query.</p>
<p>In Elasticsearch, EQL assumes each document in a data stream or index corresponds to an
event.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /my-index-000001/_eql/search
{
  "query": """
    process where process.name == "regsvr32.exe"
  """
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2186.console"></div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="eql-search-api-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/eql-search-api.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">GET /&lt;target&gt;/_eql/search</code></p>
<p><code class="literal">POST /&lt;target&gt;/_eql/search</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="eql-search-api-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/eql-search-api.asciidoc">edit</a></h3>
</div></div></div>
<p>See <a class="xref" href="eql.html#eql-required-fields" title="Required fields">Required fields</a>.</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="eql-search-api-limitations"></a>Limitations<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/eql-search-api.asciidoc">edit</a></h4>
</div></div></div>
<p>See <a class="xref" href="eql-syntax.html#eql-syntax-limitations" title="Limitations">EQL limitations</a>.</p>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="eql-search-api-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/eql-search-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;target&gt;</code>
</span>
</dt>
<dd>
<p>
(Required, string)
Comma-separated list of data streams, indices, or <a class="xref" href="indices-aliases.html" title="Update index alias API">index
aliases</a> used to limit the request. Accepts wildcard (<code class="literal">*</code>) expressions.
</p>
<p>To search all data streams and indices in a cluster, use
<code class="literal">_all</code> or <code class="literal">*</code>.</p>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="eql-search-api-query-params"></a>Query parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/eql-search-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">allow_no_indices</code>
</span>
</dt>
<dd>
<p>
(Optional, boolean) If <code class="literal">true</code>,
the request does <span class="strong strong"><strong>not</strong></span> return an error
if a wildcard expression
or <code class="literal">_all</code> value retrieves only missing or closed indices.
</p>
<p>This parameter also applies to <a class="xref" href="indices-aliases.html" title="Update index alias API">index aliases</a>
that point to a missing or closed index.</p>
<p>Defaults to <code class="literal">false</code>.</p>
</dd>
<dt>
<span class="term">
<code class="literal">expand_wildcards</code>
</span>
</dt>
<dd>
<p>(Optional, string) Controls what kind of indices that wildcard expressions can
expand to. Multiple values are accepted when separated by a comma, as in
<code class="literal">open,hidden</code>. Valid values are:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">all</code>
</span>
</dt>
<dd>
Expand to open and closed indices, including <a class="xref" href="index-modules.html#index-hidden">hidden indices</a>.
</dd>
<dt>
<span class="term">
<code class="literal">open</code>
</span>
</dt>
<dd>
Expand only to open indices.
</dd>
<dt>
<span class="term">
<code class="literal">closed</code>
</span>
</dt>
<dd>
Expand only to closed indices.
</dd>
<dt>
<span class="term">
<code class="literal">hidden</code>
</span>
</dt>
<dd>
Expansion of wildcards will include <a class="xref" href="index-modules.html#index-hidden">hidden indices</a>.
Must be combined with <code class="literal">open</code>, <code class="literal">closed</code>, or both.
</dd>
<dt>
<span class="term">
<code class="literal">none</code>
</span>
</dt>
<dd>
Wildcard expressions are not accepted.
</dd>
</dl>
</div>
<p>Defaults to <code class="literal">open</code>.</p>
</dd>
<dt>
<span class="term">
<code class="literal">ignore_unavailable</code>
</span>
</dt>
<dd>
(Optional, boolean) If <code class="literal">true</code>, missing or closed indices are not included in the
response. Defaults to <code class="literal">false</code>.
</dd>
<dt>
<span class="term">
<code class="literal">keep_alive</code>
</span>
</dt>
<dd>
<p>(Optional, <a class="xref" href="common-options.html#time-units" title="Time units">time value</a>)
Period for which the search and its results are stored on the cluster. Defaults
to <code class="literal">5d</code> (five days).</p>
<p>When this period expires, the search and its results are deleted, even if the
search is still ongoing.</p>
<p>If the <a class="xref" href="eql-search-api.html#eql-search-api-keep-on-completion"><code class="literal">keep_on_completion</code></a> parameter is
<code class="literal">false</code>, Elasticsearch only stores <a class="xref" href="eql.html#eql-search-async" title="Run an async EQL search">async searches</a> that do not
complete within the period set by the
<a class="xref" href="eql-search-api.html#eql-search-api-wait-for-completion-timeout"><code class="literal">wait_for_completion_timeout</code></a>
parameter, regardless of this value.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>You can also specify this value using the <code class="literal">keep_alive</code> request body parameter.
If both parameters are specified, only the query parameter is used.</p>
</div>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">keep_on_completion</code>
</span>
</dt>
<dd>
<p>(Optional, boolean)
If <code class="literal">true</code>, the search and its results are stored on the cluster.</p>
<p>If <code class="literal">false</code>, the search and its results are stored on the cluster only if the
request does not complete during the period set by the
<a class="xref" href="eql-search-api.html#eql-search-api-wait-for-completion-timeout"><code class="literal">wait_for_completion_timeout</code></a>
parameter. Defaults to <code class="literal">false</code>.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>You can also specify this value using the <code class="literal">keep_on_completion</code> request body
parameter. If both parameters are specified, only the query parameter is used.</p>
</div>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">wait_for_completion_timeout</code>
</span>
</dt>
<dd>
<p>(Optional, <a class="xref" href="common-options.html#time-units" title="Time units">time value</a>)
Timeout duration to wait for the request to finish. Defaults to no
timeout, meaning the request waits for complete search results.</p>
<p>If this parameter is specified and the request completes during this period,
complete search results are returned.</p>
<p>If the request does not complete during this period, the search becomes an
<a class="xref" href="eql.html#eql-search-async" title="Run an async EQL search">async search</a>.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>You can also specify this value using the <code class="literal">wait_for_completion_timeout</code> request
body parameter. If both parameters are specified, only the query parameter is
used.</p>
</div>
</div>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="eql-search-api-request-body"></a>Request body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/eql-search-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">case_sensitive</code>
</span>
</dt>
<dd>
(Optional, boolean)
If <code class="literal">true</code>, matching for the <a class="xref" href="eql-search-api.html#eql-search-api-request-query-param">EQL query</a> is
case sensitive. Defaults to <code class="literal">false</code>.
</dd>
<dt>
<span class="term">
<code class="literal">event_category_field</code>
</span>
</dt>
<dd>
<p>
(Required*, string)
Field containing the event classification, such as <code class="literal">process</code>, <code class="literal">file</code>, or
<code class="literal">network</code>.
</p>
<p>Defaults to <code class="literal">event.category</code>, as defined in the <a href="/guide/en/ecs/1.6/ecs-event.html" class="ulink" target="_top">Elastic
Common Schema (ECS)</a>. If a data stream or index does not contain the
<code class="literal">event.category</code> field, this value is required.</p>
<p>The event category field is typically mapped as a field type in the
<a class="xref" href="keyword.html" title="Keyword type family"><code class="literal">keyword</code></a> family.</p>
</dd>
<dt>
<span class="term">
<code class="literal">fetch_size</code>
</span>
</dt>
<dd>
<p>
(Optional, integer)
Maximum number of events to search at a time for sequence queries. Defaults to
<code class="literal">1000</code>.
</p>
<p>This value must be greater than <code class="literal">2</code> but cannot exceed the value of the
<a class="xref" href="index-modules.html#index-max-result-window"><code class="literal">index.max_result_window</code></a> setting, which defaults to
<code class="literal">10000</code>.</p>
<p>Internally, a sequence query fetches and paginates sets of events to search for
matches. This parameter controls the size of those sets. This parameter does not
limit the total number of events searched or the number of matching events
returned.</p>
<p>A greater <code class="literal">fetch_size</code> value often increases search speed but uses more memory.</p>
</dd>
<dt>
<span class="term">
<code class="literal">filter</code>
</span>
</dt>
<dd>
(Optional, <a class="xref" href="query-dsl.html" title="Query DSL">query DSL object</a>)
Query, written in query DSL, used to filter the events on which the EQL query
runs.
</dd>
<dt>
<span class="term">
<code class="literal">keep_alive</code>
</span>
</dt>
<dd>
<p>(Optional, <a class="xref" href="common-options.html#time-units" title="Time units">time value</a>)
Period for which the search and its results are stored on the cluster. Defaults
to <code class="literal">5d</code> (five days).</p>
<p>When this period expires, the search and its results are deleted, even if the
search is still ongoing.</p>
<p>If the <a class="xref" href="eql-search-api.html#eql-search-api-keep-on-completion"><code class="literal">keep_on_completion</code></a> parameter is
<code class="literal">false</code>, Elasticsearch only stores <a class="xref" href="eql.html#eql-search-async" title="Run an async EQL search">async searches</a> that do not
complete within the period set by the
<a class="xref" href="eql-search-api.html#eql-search-api-wait-for-completion-timeout"><code class="literal">wait_for_completion_timeout</code></a>
parameter, regardless of this value.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>You can also specify this value using the <code class="literal">keep_alive</code> query parameter.
If both parameters are specified, only the query parameter is used.</p>
</div>
</div>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="eql-search-api-keep-on-completion"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">keep_on_completion</code>
</span>
</dt>
<dd>
<p>(Optional, boolean)
If <code class="literal">true</code>, the search and its results are stored on the cluster.</p>
<p>If <code class="literal">false</code>, the search and its results are stored on the cluster only if the
request does not complete during the period set by the
<a class="xref" href="eql-search-api.html#eql-search-api-wait-for-completion-timeout"><code class="literal">wait_for_completion_timeout</code></a>
parameter. Defaults to <code class="literal">false</code>.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>You can also specify this value using the <code class="literal">keep_on_completion</code> query parameter.
If both parameters are specified, only the query parameter is used.</p>
</div>
</div>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="eql-search-api-request-query-param"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">query</code>
</span>
</dt>
<dd>
<p>
(Required, string)
<a class="xref" href="eql-syntax.html" title="EQL syntax reference">EQL</a> query you wish to run.
</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>This parameter supports a subset of EQL syntax. See
<a class="xref" href="eql-syntax.html#eql-unsupported-syntax" title="Unsupported syntax">Unsupported syntax</a>.</p>
</div>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">size</code>
</span>
</dt>
<dd>
<p>
(Optional, integer or float)
For <a class="xref" href="eql-syntax.html#eql-basic-syntax" title="Basic syntax">basic queries</a>, the maximum number of matching events to
return.
</p>
<p>For <a class="xref" href="eql-syntax.html#eql-sequences" title="Sequences">sequence queries</a>, the maximum number of matching sequences
to return.</p>
<p>Defaults to <code class="literal">10</code>. This value must be greater than <code class="literal">0</code>.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>You cannot use <a class="xref" href="eql-pipe-ref.html" title="EQL pipe reference">pipes</a>, such as <code class="literal">head</code> or <code class="literal">tail</code>, to exceed
this value.</p>
</div>
</div>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="eql-search-api-tiebreaker-field"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">tiebreaker_field</code>
</span>
</dt>
<dd>
<p>
(Optional, string)
Field used to sort events with the same
<a class="xref" href="eql-search-api.html#eql-search-api-timestamp-field">timestamp field</a> value. Defaults to
<code class="literal">event.sequence</code>, as defined in the <a href="/guide/en/ecs/1.6/ecs-event.html" class="ulink" target="_top">Elastic Common
Schema (ECS)</a>.
</p>
<p>By default, matching events in the search response are sorted by timestamp,
converted to milliseconds since the <a href="https://en.wikipedia.org/wiki/Unix_time" class="ulink" target="_top">Unix
epoch</a>, in ascending order. If two or more events share the same timestamp, this
field is used to sort the events in ascending, lexicographic order.</p>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="eql-search-api-timestamp-field"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">timestamp_field</code>
</span>
</dt>
<dd>
<p>(Required*, string)
Field containing event timestamp.</p>
<p>Defaults to <code class="literal">@timestamp</code>, as defined in the
<a href="/guide/en/ecs/1.6/ecs-event.html" class="ulink" target="_top">Elastic Common Schema (ECS)</a>. If a data stream or index
does not contain the <code class="literal">@timestamp</code> field, this value is required.</p>
<p>Events in the API response are sorted by this field&#8217;s value, converted to
milliseconds since the <a href="https://en.wikipedia.org/wiki/Unix_time" class="ulink" target="_top">Unix epoch</a>, in
ascending order.</p>
<p>The timestamp field is typically mapped as a <a class="xref" href="date.html" title="Date field type"><code class="literal">date</code></a> or
<a class="xref" href="date_nanos.html" title="Date nanoseconds field type"><code class="literal">date_nanos</code></a> field.</p>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="eql-search-api-wait-for-completion-timeout"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">wait_for_completion_timeout</code>
</span>
</dt>
<dd>
<p>(Optional, <a class="xref" href="common-options.html#time-units" title="Time units">time value</a>)
Timeout duration to wait for the request to finish. Defaults to no
timeout, meaning the request waits for complete search results.</p>
<p>If this parameter is specified and the request completes during this period,
complete search results are returned.</p>
<p>If the request does not complete during this period, the search becomes an
<a class="xref" href="eql.html#eql-search-async" title="Run an async EQL search">async search</a>.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>You can also specify this value using the <code class="literal">wait_for_completion_timeout</code> query
parameter. If both parameters are specified, only the query parameter is used.</p>
</div>
</div>
</dd>
</dl>
</div>
</div>

<div class="section child_attributes">
<div class="titlepage"><div><div>
<h3 class="title"><a id="eql-search-api-response-body"></a>Response body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/eql-search-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<a id="eql-search-api-response-body-search-id"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">id</code>
</span>
</dt>
<dd>
<p>(string)
Identifier for the search.</p>
<p>This search ID is only provided if one of the following conditions is met:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
A search request does not return complete results during the
<a class="xref" href="eql-search-api.html#eql-search-api-wait-for-completion-timeout"><code class="literal">wait_for_completion_timeout</code></a>
parameter&#8217;s timeout period, becoming an <a class="xref" href="eql.html#eql-search-async" title="Run an async EQL search">async search</a>.
</li>
<li class="listitem">
The search request&#8217;s <a class="xref" href="eql-search-api.html#eql-search-api-keep-on-completion"><code class="literal">keep_on_completion</code></a>
parameter is <code class="literal">true</code>.
</li>
</ul>
</div>
<p>You can use this ID with the <a class="xref" href="get-async-eql-search-api.html" title="Get async EQL search API">get async EQL search
API</a> to get the current status and available results for the search.</p>
</dd>
<dt>
<span class="term">
<code class="literal">is_partial</code>
</span>
</dt>
<dd>
(boolean)
If <code class="literal">true</code>, the response does not contain complete search results.
</dd>
<dt>
<span class="term">
<code class="literal">is_running</code>
</span>
</dt>
<dd>
<p>(boolean)
If <code class="literal">true</code>, the search request is still executing.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>If this parameter and the <code class="literal">is_partial</code> parameter are <code class="literal">true</code>, the search is an
<a class="xref" href="eql.html#eql-search-async" title="Run an async EQL search">ongoing async search</a>. If the <code class="literal">keep_alive</code> period does not
pass, the complete search results will be available when the search completes.</p>
<p>If <code class="literal">is_partial</code> is <code class="literal">true</code> but <code class="literal">is_running</code> is <code class="literal">false</code>, the search returned
partial results due to a failure. Only some shards returned results or the node
coordinating the search failed.</p>
</div>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">took</code>
</span>
</dt>
<dd>
<p>(integer)
Milliseconds it took Elasticsearch to execute the request.</p>
<p>This value is calculated by measuring the time elapsed
between receipt of a request on the coordinating node
and the time at which the coordinating node is ready to send the response.</p>
<p>Took time includes:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Communication time between the coordinating node and data nodes
</li>
<li class="listitem">
Time the request spends in the <code class="literal">search</code> <a class="xref" href="modules-threadpool.html" title="Thread pools">thread pool</a>,
queued for execution
</li>
<li class="listitem">
Actual execution time
</li>
</ul>
</div>
<p>Took time does <span class="strong strong"><strong>not</strong></span> include:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Time needed to send the request to Elasticsearch
</li>
<li class="listitem">
Time needed to serialize the JSON response
</li>
<li class="listitem">
Time needed to send the response to a client
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">timed_out</code>
</span>
</dt>
<dd>
(boolean)
If <code class="literal">true</code>, the request timed out before completion.
</dd>
<dt>
<span class="term">
<code class="literal">hits</code>
</span>
</dt>
<dd>
<p>
(object)
Contains matching events and sequences. Also contains related metadata.
</p>
<details open>
<summary class="title">Properties of <code class="literal">hits</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">total</code>
</span>
</dt>
<dd>
<p>
(object)
Metadata about the number of matching events or sequences.
</p>
<details open>
<summary class="title">Properties of <code class="literal">total</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">value</code>
</span>
</dt>
<dd>
<p>
(integer)
For <a class="xref" href="eql-syntax.html#eql-basic-syntax" title="Basic syntax">basic queries</a>, the total number of matching events.
</p>
<p>For <a class="xref" href="eql-syntax.html#eql-sequences" title="Sequences">sequence queries</a>, the total number of matching sequences.</p>
</dd>
<dt>
<span class="term">
<code class="literal">relation</code>
</span>
</dt>
<dd>
<p>(string)
Indicates whether the number of events or sequences returned is accurate or a
lower bound.</p>
<p>Returned values are:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">eq</code>
</span>
</dt>
<dd>
Accurate
</dd>
<dt>
<span class="term">
<code class="literal">gte</code>
</span>
</dt>
<dd>
Lower bound, including returned events or sequences
</dd>
</dl>
</div>
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">sequences</code>
</span>
</dt>
<dd>
<p>
(array of objects)
Contains event sequences matching the query. Each object represents a
matching sequence. This parameter is only returned for EQL queries containing
a <a class="xref" href="eql-syntax.html#eql-sequences" title="Sequences">sequence</a>.
</p>
<details open>
<summary class="title">Properties of <code class="literal">sequences</code> objects</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">join_keys</code>
</span>
</dt>
<dd>
(array of values)
Shared field values used to constrain matches in the sequence. These are defined
using the <a class="xref" href="eql-syntax.html#eql-sequences" title="Sequences"><code class="literal">by</code> keyword</a> in the EQL query syntax.
</dd>
<dt>
<span class="term">
<code class="literal">events</code>
</span>
</dt>
<dd>
<p>
(array of objects)
Contains events matching the query. Each object represents a
matching event.
</p>
<details open>
<summary class="title">Properties of <code class="literal">events</code> objects</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">_index</code>
</span>
</dt>
<dd>
(string)
Name of the index containing the event.
</dd>
<dt>
<span class="term">
<code class="literal">_id</code>
</span>
</dt>
<dd>
(string)
Unique identifier for the event.
This ID is only unique within the index.
</dd>
<dt>
<span class="term">
<code class="literal">_source</code>
</span>
</dt>
<dd>
(object)
Original JSON body passed for the event at index time.
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="eql-search-api-response-events"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">events</code>
</span>
</dt>
<dd>
<p>
(array of objects)
Contains events matching the query. Each object represents a
matching event.
</p>
<details open>
<summary class="title">Properties of <code class="literal">events</code> objects</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">_index</code>
</span>
</dt>
<dd>
(string)
Name of the index containing the event.
</dd>
<dt>
<span class="term">
<code class="literal">_id</code>
</span>
</dt>
<dd>
(string)
(string)
Unique identifier for the event.
This ID is only unique within the index.
</dd>
<dt>
<span class="term">
<code class="literal">_source</code>
</span>
</dt>
<dd>
(object)
Original JSON body passed for the event at index time.
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="eql-search-api-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/eql-search-api.asciidoc">edit</a></h3>
</div></div></div>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="eql-search-api-basic-query-ex"></a>Basic query example<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/eql-search-api.asciidoc">edit</a></h4>
</div></div></div>
<p>The following EQL search request searches for events with an <code class="literal">event.category</code> of
<code class="literal">process</code> that meet the following conditions:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
A <code class="literal">process.name</code> of <code class="literal">cmd.exe</code>
</li>
<li class="listitem">
An <code class="literal">process.pid</code> other than <code class="literal">2013</code>
</li>
</ul>
</div>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /my-index-000001/_eql/search
{
  "query": """
    process where (process.name == "cmd.exe" and process.pid != 2013)
  """
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2187.console"></div>
<p>The API returns the following response. Matching events in the <code class="literal">hits.events</code>
property are sorted by <a class="xref" href="eql-search-api.html#eql-search-api-timestamp-field">timestamp</a>, converted
to milliseconds since the <a href="https://en.wikipedia.org/wiki/Unix_time" class="ulink" target="_top">Unix epoch</a>,
in ascending order.</p>
<p>If two or more events share the same timestamp, the
<a class="xref" href="eql-search-api.html#eql-search-api-tiebreaker-field"><code class="literal">tiebreaker_field</code></a> field is used to sort
the events in ascending, lexicographic order.</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "is_partial": false,
  "is_running": false,
  "took": 6,
  "timed_out": false,
  "hits": {
    "total": {
      "value": 2,
      "relation": "eq"
    },
    "events": [
      {
        "_index": "my-index-000001",
        "_id": "babI3XMBI9IjHuIqU0S_",
        "_source": {
          "@timestamp": "2099-12-06T11:04:05.000Z",
          "event": {
            "category": "process",
            "id": "edwCRnyD",
            "sequence": 1
          },
          "process": {
            "pid": 2012,
            "name": "cmd.exe",
            "executable": "C:\\Windows\\System32\\cmd.exe"
          }
        }
      },
      {
        "_index": "my-index-000001",
        "_id": "b6bI3XMBI9IjHuIqU0S_",
        "_source": {
          "@timestamp": "2099-12-07T11:06:07.000Z",
          "event": {
            "category": "process",
            "id": "cMyt5SZ2",
            "sequence": 3
          },
          "process": {
            "pid": 2012,
            "name": "cmd.exe",
            "executable": "C:\\Windows\\System32\\cmd.exe"
          }
        }
      }
    ]
  }
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="eql-search-api-sequence-ex"></a>Sequence query example<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/7.x/docs/reference/eql/eql-search-api.asciidoc">edit</a></h4>
</div></div></div>
<p>The following EQL search request matches a <a class="xref" href="eql-syntax.html#eql-sequences" title="Sequences">sequence</a> of events
that:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Start with an event with:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
An <code class="literal">event.category</code> of <code class="literal">file</code>
</li>
<li class="listitem">
A <code class="literal">file.name</code> of <code class="literal">cmd.exe</code>
</li>
<li class="listitem">
An <code class="literal">process.pid</code> other than <code class="literal">2013</code>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Followed by an event with:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
An <code class="literal">event.category</code> of <code class="literal">process</code>
</li>
<li class="listitem">
A <code class="literal">process.executable</code> that contains the substring <code class="literal">regsvr32</code>
</li>
</ul>
</div>
</li>
</ol>
</div>
<p>These events must also share the same <code class="literal">process.pid</code> value.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /my-index-000001/_eql/search
{
  "query": """
    sequence by process.pid
      [ file where file.name == "cmd.exe" and process.pid != 2013 ]
      [ process where stringContains(process.executable, "regsvr32") ]
  """
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2188.console"></div>
<p>The API returns the following response. Matching sequences are included in the
<code class="literal">hits.sequences</code> property. The <code class="literal">hits.sequences.join_keys</code> property contains the
shared <code class="literal">process.pid</code> value for each matching event.</p>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "is_partial": false,
  "is_running": false,
  "took": 6,
  "timed_out": false,
  "hits": {
    "total": {
      "value": 1,
      "relation": "eq"
    },
    "sequences": [
      {
        "join_keys": [
          2012
        ],
        "events": [
          {
            "_index": "my-index-000001",
            "_id": "AtOJ4UjUBAAx3XR5kcCM",
            "_source": {
              "@timestamp": "2099-12-06T11:04:07.000Z",
              "event": {
                "category": "file",
                "id": "dGCHwoeS",
                "sequence": 2
              },
              "file": {
                "accessed": "2099-12-07T11:07:08.000Z",
                "name": "cmd.exe",
                "path": "C:\\Windows\\System32\\cmd.exe",
                "type": "file",
                "size": 16384
              },
              "process": {
                "pid": 2012,
                "name": "cmd.exe",
                "executable": "C:\\Windows\\System32\\cmd.exe"
              }
            }
          },
          {
            "_index": "my-index-000001",
            "_id": "OQmfCaduce8zoHT93o4H",
            "_source": {
              "@timestamp": "2099-12-07T11:07:09.000Z",
              "event": {
                "category": "process",
                "id": "aR3NWVOs",
                "sequence": 4
              },
              "process": {
                "pid": 2012,
                "name": "regsvr32.exe",
                "command_line": "regsvr32.exe  /s /u /i:https://...RegSvr32.sct scrobj.dll",
                "executable": "C:\\Windows\\System32\\regsvr32.exe"
              }
            }
          }
        ]
      }
    ]
  }
}</pre>
</div>
</div>

</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="search-multi-search.html">« Multi search API</a>
</span>
<span class="next">
<a href="get-async-eql-search-api.html">Get async EQL search API »</a>
</span>
</div>
</div>
</body>
</html>
