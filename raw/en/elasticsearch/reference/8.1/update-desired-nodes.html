<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Create or update desired nodes API | Elasticsearch Guide [8.1] | Elastic</title>
<meta class="elastic" name="content" content="Create or update desired nodes API | Elasticsearch Guide [8.1]">

<link rel="home" href="index.html" title="Elasticsearch Guide [8.1]"/>
<link rel="up" href="cluster.html" title="Cluster APIs"/>
<link rel="prev" href="voting-config-exclusions.html" title="Voting configuration exclusions API"/>
<link rel="next" href="get-desired-nodes.html" title="Get desired nodes API"/>
<meta class="elastic" name="product_version" content="8.1"/>
<meta class="elastic" name="product_name" content="Elasticsearch"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/8.1"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="8.1"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body><div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elasticsearch Guide [8.1]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="rest-apis.html">REST APIs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="cluster.html">Cluster APIs</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="voting-config-exclusions.html">« Voting configuration exclusions API</a>
</span>
<span class="next">
<a href="get-desired-nodes.html">Get desired nodes API »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="update-desired-nodes"></a>Create or update desired nodes API<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.1/docs/reference/cluster/update-desired-nodes.asciidoc">edit</a></h2>
</div></div></div>

<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This feature is designed for indirect use by <a href="/cloud/elasticsearch-service/signup?page=docs&amp;placement=docs-body" class="ulink" target="_top">Elasticsearch Service</a>, <a href="/guide/en/cloud-enterprise/current" class="ulink" target="_top">Elastic Cloud Enterprise</a>, and <a href="/guide/en/cloud-on-k8s/current" class="ulink" target="_top">Elastic Cloud on Kubernetes</a>. Direct use is not supported.</p>
</div>
</div>
<p>Creates or updates the desired nodes.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="update-desired-nodes-request"></a>Request<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.1/docs/reference/cluster/update-desired-nodes.asciidoc">edit</a></h3>
</div></div></div>
<a id="5b1c0b2d10cbc0065e1cd927e11a3fa7"></a>
<div class="pre_wrapper lang-console">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console">PUT /_internal/desired_nodes/&lt;history_id&gt;/&lt;version&gt;
{
    "nodes" : [
        {
            "settings" : {
                 "node.name" : "instance-000187",
                 "node.external_id": "instance-000187",
                 "node.roles" : ["data_hot", "master"],
                 "node.attr.data" : "hot",
                 "node.attr.logical_availability_zone" : "zone-0"
            },
            "processors" : 8,
            "memory" : "58gb",
            "storage" : "1700gb",
            "node_version" : "{version}"
        }
    ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/1875.console"></div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="update-desired-nodes-query-params"></a>Query parameters<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.1/docs/reference/cluster/update-desired-nodes.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">master_timeout</code>
</span>
</dt>
<dd>
(Optional, <a class="xref" href="api-conventions.html#time-units" title="Time units">time units</a>)
Period to wait for a connection to the master node. If no response is received
before the timeout expires, the request fails and returns an error. Defaults to
<code class="literal">30s</code>.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="update-desired-nodes-desc"></a>Description<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.1/docs/reference/cluster/update-desired-nodes.asciidoc">edit</a></h3>
</div></div></div>
<p>This API creates or update the desired nodes. External orchestrators can use
this API to let Elasticsearch know about the cluster topology, including future
changes such as adding or removing nodes. Using this information, the system is
able to take better decisions.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="update-desired-nodes-examples"></a>Examples<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.1/docs/reference/cluster/update-desired-nodes.asciidoc">edit</a></h3>
</div></div></div>
<p>In this example, a new version for the desired nodes with history <code class="literal">Ywkh3INLQcuPT49f6kcppA</code> is created.
This API only accepts monotonically increasing versions.</p>
<a id="862d76bb1b298ef335c9cfb395bd3ac0"></a>
<div class="pre_wrapper lang-console">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console">PUT /_internal/desired_nodes/Ywkh3INLQcuPT49f6kcppA/100
{
    "nodes" : [
        {
            "settings" : {
                 "node.name" : "instance-000187",
                 "node.external_id": "instance-000187",
                 "node.roles" : ["data_hot", "master"],
                 "node.attr.data" : "hot",
                 "node.attr.logical_availability_zone" : "zone-0"
            },
            "processors" : 8,
            "memory" : "58gb",
            "storage" : "1700gb",
            "node_version" : "{version}"
        }
    ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/1876.console"></div>
<p>The API returns the following result:</p>
<a id="d3c4f815512c836c04745ef5c532ccd0"></a>
<div class="pre_wrapper lang-console-result">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console-result">{
  "replaced_existing_history_id": false
}</pre>
</div>
</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="voting-config-exclusions.html">« Voting configuration exclusions API</a>
</span>
<span class="next">
<a href="get-desired-nodes.html">Get desired nodes API »</a>
</span>
</div>
</div>
</body>
</html>
