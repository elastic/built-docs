<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="keywords" content="Elasticsearch diagnostic, diagnostics">
<title>Create or update synonyms set | Elasticsearch Guide [8.14] | Elastic</title>
<meta class="elastic" name="content" content="Create or update synonyms set | Elasticsearch Guide [8.14]">

<link rel="home" href="index.html" title="Elasticsearch Guide [8.14]"/>
<link rel="up" href="synonyms-apis.html" title="Synonyms APIs"/>
<link rel="prev" href="synonyms-apis.html" title="Synonyms APIs"/>
<link rel="next" href="get-synonyms-set.html" title="Get synonyms set"/>
<meta class="elastic" name="product_version" content="8.14"/>
<meta class="elastic" name="product_name" content="Elasticsearch"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/8.14"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="8.14"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div class="navheader">
<span class="prev">
<a href="synonyms-apis.html">« Synonyms APIs</a>
</span>
<span class="next">
<a href="get-synonyms-set.html">Get synonyms set »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elasticsearch Guide [8.14]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="rest-apis.html">REST APIs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="synonyms-apis.html">Synonyms APIs</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Create or update synonyms set</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.14/docs/reference/synonyms/apis/put-synonyms-set.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="put-synonyms-set"></a>Create or update synonyms set<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.14/docs/reference/synonyms/apis/put-synonyms-set.asciidoc">edit</a></h2>
</div></div></div>

<p>Creates or updates a synonyms set.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Synonyms sets are limited to a maximum of 10,000 synonym rules per set.
Synonym sets with more than 10,000 synonym rules will provide inconsistent search results.
If you need to manage more synonym rules, you can create multiple synonyms sets.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="put-synonyms-set-request"></a>Request<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.14/docs/reference/synonyms/apis/put-synonyms-set.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">PUT _synonyms/&lt;synonyms_set&gt;</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="put-synonyms-set-prereqs"></a>Prerequisites<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.14/docs/reference/synonyms/apis/put-synonyms-set.asciidoc">edit</a></h3>
</div></div></div>
<p>Requires the <code class="literal">manage_search_synonyms</code> cluster privilege.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="put-synonyms-set-path-params"></a>Path parameters<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.14/docs/reference/synonyms/apis/put-synonyms-set.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;synonyms_set&gt;</code>
</span>
</dt>
<dd>
(Required, string)
Synonyms set identifier to create.
This identifier will be used by other <a class="xref" href="synonyms-apis.html" title="Synonyms APIs"><em>Synonyms APIs</em></a> to manage the synonyms set.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="put-synonyms-set-api-request-body"></a>Request body<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.14/docs/reference/synonyms/apis/put-synonyms-set.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">synonyms_set</code>
</span>
</dt>
<dd>
(Required, array of synonym rules objects)
The synonym rules definitions for the synonyms set.
</dd>
</dl>
</div>
<details open>
<summary class="title">Properties of <code class="literal">synonyms_set</code> objects</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">id</code>
</span>
</dt>
<dd>
(Optional, string)
The identifier associated to the synonym rule, that can be used to manage individual synonym rules via <a class="xref" href="synonyms-apis.html#synonym-rules-apis" title="Synonym rules APIs">synonym rules APIs</a>.
In case a synonym rule id is not specified, an identifier will be created automatically by Elasticsearch.
</dd>
<dt>
<span class="term">
<code class="literal">synonyms</code>
</span>
</dt>
<dd>
<p>
(Required, string)
The synonym rule. This needs to be in <a class="xref" href="analysis-synonym-graph-tokenfilter.html#analysis-synonym-graph-define-synonyms" title="Define synonyms sets">Solr format</a>. Some examples are:
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
"i-pod, i pod &#8658; ipod",
</li>
<li class="listitem">
"universe, cosmos"
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>
</details>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="put-synonyms-set-example"></a>Examples<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.14/docs/reference/synonyms/apis/put-synonyms-set.asciidoc">edit</a></h3>
</div></div></div>
<p>The following example creates a new synonyms set called <code class="literal">my-synonyms-set</code>:</p>
<div class="pre_wrapper lang-ruby alternative">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ruby alternative">response = client.synonyms.put_synonym(
  id: 'my-synonyms-set',
  body: {
    synonyms_set: [
      {
        id: 'test-1',
        synonyms: 'hello, hi'
      },
      {
        synonyms: 'bye, goodbye'
      },
      {
        id: 'test-2',
        synonyms: 'test =&gt; check'
      }
    ]
  }
)
puts response</pre>
</div>
<a id="9e563b8d5a7845f644db8d5bbf453eb6"></a>
<div class="pre_wrapper lang-console default has-ruby">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console default has-ruby">PUT _synonyms/my-synonyms-set
{
  "synonyms_set": [
    {
      "id": "test-1",
      "synonyms": "hello, hi"
    },
    {
      "synonyms": "bye, goodbye"
    },
    {
      "id": "test-2",
      "synonyms": "test =&gt; check"
    }
  ]
}</pre>
</div>
<div class="console_widget has-ruby" data-snippet="snippets/3251.console"></div>
<p>If any of the synonym rules included is not valid, the API will return an error.</p>
<a id="3608e4fcd17dd8d5f88ec9a3db2f5d89"></a>
<div class="pre_wrapper lang-console">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console">PUT _synonyms/my-synonyms-set
{
  "synonyms_set": [
    {
      "synonyms": "hello =&gt; hi =&gt; howdy"
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/3252.console"></div>
<a id="288511aab7eee87764e66b9564a6a54c"></a>
<div class="pre_wrapper lang-console-result">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console-result">{
  "error": {
    "root_cause": [
      {
        "type": "action_request_validation_exception",
        "reason": "Validation Failed: 1: More than one explicit mapping specified in the same synonyms rule: [hello =&gt; hi =&gt; howdy];",
        "stack_trace": ...
      }
    ],
    "type": "action_request_validation_exception",
    "reason": "Validation Failed: 1: More than one explicit mapping specified in the same synonyms rule: [hello =&gt; hi =&gt; howdy];",
    "stack_trace": ...
  },
  "status": 400
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="synonyms-set-analyzer-reloading"></a>Analyzer reloading<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.14/docs/reference/synonyms/apis/put-synonyms-set.asciidoc">edit</a></h3>
</div></div></div>
<p>When an existing synonyms set is updated, the <a class="xref" href="search-analyzer.html" title="search_analyzer">search analyzers</a> that use the synonyms set are reloaded automatically for all indices.
This would be equivalent to invoking <a class="xref" href="indices-reload-analyzers.html" title="Reload search analyzers API"><em>Reload search analyzers API</em></a> for all indices that use the synonyms set.</p>
<p>For example, creating an index with a synonyms set and updating it:</p>
<div class="pre_wrapper lang-ruby alternative">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ruby alternative">response = client.synonyms.put_synonym(
  id: 'my-synonyms-set',
  body: {
    synonyms_set: [
      {
        id: 'test-1',
        synonyms: 'hello, hi'
      }
    ]
  }
)
puts response

response = client.indices.create(
  index: 'test-index',
  body: {
    settings: {
      analysis: {
        filter: {
          synonyms_filter: {
            type: 'synonym_graph',
            synonyms_set: 'my-synonyms-set',
            updateable: true
          }
        },
        analyzer: {
          my_index_analyzer: {
            type: 'custom',
            tokenizer: 'standard',
            filter: [
              'lowercase'
            ]
          },
          my_search_analyzer: {
            type: 'custom',
            tokenizer: 'standard',
            filter: [
              'lowercase',
              'synonyms_filter'
            ]
          }
        }
      }
    },
    mappings: {
      properties: {
        title: {
          type: 'text',
          analyzer: 'my_index_analyzer',
          search_analyzer: 'my_search_analyzer'
        }
      }
    }
  }
)
puts response

response = client.synonyms.put_synonym(
  id: 'my-synonyms-set',
  body: {
    synonyms_set: [
      {
        id: 'test-1',
        synonyms: 'hello, hi, howdy'
      }
    ]
  }
)
puts response</pre>
</div>
<a id="4cdcc3fde5cea165a3a7567962b9bd61"></a>
<div class="pre_wrapper lang-console default has-ruby">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console default has-ruby">PUT _synonyms/my-synonyms-set
{
    "synonyms_set": [
        {
            "id": "test-1",
            "synonyms": "hello, hi"
        }
    ]
}

PUT /test-index
{
  "settings": {
    "analysis": {
      "filter": {
        "synonyms_filter": {
          "type": "synonym_graph",
          "synonyms_set": "my-synonyms-set",
          "updateable": true
        }
      },
      "analyzer": {
        "my_index_analyzer": {
          "type": "custom",
          "tokenizer": "standard",
          "filter": ["lowercase"]
        },
        "my_search_analyzer": {
          "type": "custom",
          "tokenizer": "standard",
          "filter": ["lowercase", "synonyms_filter"]
        }
      }
    }
  },
  "mappings": {
    "properties": {
      "title": {
        "type": "text",
        "analyzer": "my_index_analyzer",
        "search_analyzer": "my_search_analyzer"
      }
    }
  }
}

PUT _synonyms/my-synonyms-set
{
    "synonyms_set": [
        {
            "id": "test-1",
            "synonyms": "hello, hi, howdy"
        }
    ]
}</pre>
</div>
<div class="console_widget has-ruby" data-snippet="snippets/3253.console"></div>
<p>The reloading result is included as part of the response:</p>
<a id="8604e87f5467d88ae38a00f0518a456f"></a>
<div class="pre_wrapper lang-console-result">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console-result">{
  "result": "updated",
  "reload_analyzers_details": {
    "_shards": {
      "total": 2,
      "successful": 1,
      "failed": 0
    },
    "reload_details": [
      {
        "index": "test-index",
        "reloaded_analyzers": [
          "my_search_analyzer"
        ],
        "reloaded_node_ids": [
          "1wYFZzq8Sxeu_Jvt9mlbkg"
        ]
      }
    ]
  }
}</pre>
</div>
</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="synonyms-apis.html">« Synonyms APIs</a>
</span>
<span class="next">
<a href="get-synonyms-set.html">Get synonyms set »</a>
</span>
</div>
</body>
</html>
