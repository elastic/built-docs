<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Add remote clusters using TLS certificate authentication | Elasticsearch Guide [8.14] | Elastic</title>
<meta class="elastic" name="content" content="Add remote clusters using TLS certificate authentication | Elasticsearch Guide [8.14]">

<link rel="home" href="index.html" title="Elasticsearch Guide [8.14]"/>
<link rel="up" href="remote-clusters.html" title="Remote clusters"/>
<link rel="prev" href="remote-clusters-api-key.html" title="Add remote clusters using API key authentication"/>
<link rel="next" href="remote-clusters-migrate.html" title="Migrate remote clusters from certificate to API key authentication"/>
<meta class="elastic" name="product_version" content="8.14"/>
<meta class="elastic" name="product_name" content="Elasticsearch"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/8.14"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="8.14"/>
</head>
<body>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elasticsearch Guide [8.14]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="setup.html">Set up Elasticsearch</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="remote-clusters.html">Remote clusters</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="remote-clusters-api-key.html">« Add remote clusters using API key authentication</a>
</span>
<span class="next">
<a href="remote-clusters-migrate.html">Migrate remote clusters from certificate to API key authentication »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="remote-clusters-cert"></a>Add remote clusters using TLS certificate authentication<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.14/docs/reference/modules/cluster/remote-clusters-cert.asciidoc">edit</a></h2>
</div></div></div>
<p>To add a remote cluster using TLS certificate authentication:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<a class="xref" href="remote-clusters-cert.html#remote-clusters-prerequisites-cert" title="Prerequisites">Review the prerequisites</a>
</li>
<li class="listitem">
<a class="xref" href="remote-clusters-cert.html#remote-clusters-security-cert" title="Establish trust with a remote cluster">Establish trust with a remote cluster</a>
</li>
<li class="listitem">
<a class="xref" href="remote-clusters-cert.html#remote-clusters-connect-cert" title="Connect to a remote cluster">Connect to a remote cluster</a>
</li>
<li class="listitem">
<a class="xref" href="remote-clusters-cert.html#remote-clusters-privileges-cert" title="Configure roles and users for remote clusters">Configure roles and users for remote clusters</a>
</li>
</ol>
</div>
<p>If you run into any issues, refer to <a class="xref" href="remote-clusters-troubleshooting.html" title="Troubleshooting remote clusters">Troubleshooting</a>.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="remote-clusters-prerequisites-cert"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.14/docs/reference/modules/cluster/remote-clusters-cert.asciidoc">edit</a></h3>
</div></div></div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
The Elasticsearch security features need to be enabled on both clusters, on every node.
Security is enabled by default. If it&#8217;s disabled, set <code class="literal">xpack.security.enabled</code>
to <code class="literal">true</code> in <code class="literal">elasticsearch.yml</code>. Refer to <a class="xref" href="security-settings.html#general-security-settings" title="General security settings">General security settings</a>.
</li>
<li class="listitem">
<p>The local and remote clusters versions must be compatible.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Any node can communicate with another node on the same
major version. For example, 7.0 can talk to any 7.x node.
</li>
<li class="listitem">
Only nodes on the last minor version of a certain major version can
communicate with nodes on the following major version. In the 6.x series, 6.8
can communicate with any 7.x node, while 6.7 can only communicate with 7.0.
</li>
<li class="listitem">
<p>Version compatibility is
symmetric, meaning that if 6.7 can communicate with 7.0, 7.0 can also
communicate with 6.7. The following table depicts version compatibility between
local and remote nodes.</p>
<details open>
<summary class="title">Version compatibility table</summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
<col class="col_5"/>
<col class="col_6"/>
<col class="col_7"/>
<col class="col_8"/>
<col class="col_9"/>
<col class="col_10"/>
</colgroup>
<tbody>
<tr>
<td align="center" valign="top"><p></p></td>
<td align="center" colspan="9" valign="top"><p><span class="strong strong"><strong>Local cluster</strong></span></p></td>
</tr>
<tr>
<td align="center" valign="top"><p><span class="strong strong"><strong>Remote cluster</strong></span></p></td>
<td align="center" valign="top"><p>5.0–5.5</p></td>
<td align="center" valign="top"><p>5.6</p></td>
<td align="center" valign="top"><p>6.0–6.6</p></td>
<td align="center" valign="top"><p>6.7</p></td>
<td align="center" valign="top"><p>6.8</p></td>
<td align="center" valign="top"><p>7.0</p></td>
<td align="center" valign="top"><p>7.1–7.16</p></td>
<td align="center" valign="top"><p>7.17</p></td>
<td align="center" valign="top"><p>8.0–8.14</p></td>
</tr>
<tr>
<td align="center" valign="top"><p>5.0–5.5</p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
</tr>
<tr>
<td align="center" valign="top"><p>5.6</p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
</tr>
<tr>
<td align="center" valign="top"><p>6.0–6.6</p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
</tr>
<tr>
<td align="center" valign="top"><p>6.7</p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
</tr>
<tr>
<td align="center" valign="top"><p>6.8</p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
</tr>
<tr>
<td align="center" valign="top"><p>7.0</p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
</tr>
<tr>
<td align="center" valign="top"><p>7.1–7.16</p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
</tr>
<tr>
<td align="center" valign="top"><p>7.17</p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
</tr>
<tr>
<td align="center" valign="top"><p>8.0–8.14</p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-no.png" alt="No" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
<td align="center" valign="top"><p><span class="image"><img src="https://doc-icons.s3.us-east-2.amazonaws.com/icon-yes.png" alt="Yes" width="20" height="15"></span></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Elastic only supports cross-cluster search on a subset of these configurations. See
<a class="xref" href="modules-cross-cluster-search.html#ccs-supported-configurations" title="Supported cross-cluster search configurations">Supported cross-cluster search configurations</a>.</p>
</div>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="remote-clusters-security-cert"></a>Establish trust with a remote cluster<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.14/docs/reference/modules/cluster/remote-clusters-cert.asciidoc">edit</a></h3>
</div></div></div>
<p>To use cross-cluster replication or cross-cluster search safely with remote clusters, enable security on all
connected clusters and configure Transport Layer Security (TLS) on every node.
Configuring TLS security on the transport interface is minimally required for
remote clusters. For additional security, configure TLS on the
<a class="xref" href="security-basic-setup-https.html" title="Set up basic security for the Elastic Stack plus secured HTTPS traffic">HTTP interface</a> as well.</p>
<p>All connected clusters must trust one another and be mutually authenticated
with TLS on the transport interface. This means that the local cluster
trusts the certificate  authority (CA) of the remote cluster, and the remote
cluster trusts the CA of the local cluster. When establishing a connection, all
nodes will verify certificates from nodes on the other side. This mutual trust
is required to securely connect a remote cluster, because all connected nodes
effectively form a single security domain.</p>
<p>User authentication is performed on the local cluster and the user and user’s
roles names are passed to the remote clusters. A remote cluster checks the
user’s role names against its local role definitions to determine which indices
the user is allowed to access.</p>
<p>Before using cross-cluster replication or cross-cluster search with secured Elasticsearch clusters, complete the following
configuration task:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Configure Transport Layer Security (TLS) on every node to encrypt internode
traffic and authenticate nodes in the local cluster with nodes in all remote
clusters. Refer to
<a class="xref" href="security-basic-setup.html" title="Set up basic security for the Elastic Stack">set up basic security for the Elastic Stack</a> for the required
steps to configure security.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This procedure uses the same CA to generate certificates for all nodes.
Alternatively, you can add the certificates from the local cluster as a
trusted CA in each remote cluster. You must also add the certificates from
remote clusters as a trusted CA on the local cluster. Using the same CA to
generate certificates for all nodes simplifies this task.</p>
</div>
</div>
</li>
</ol>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="remote-clusters-connect-cert"></a>Connect to a remote cluster<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.14/docs/reference/modules/cluster/remote-clusters-cert.asciidoc">edit</a></h3>
</div></div></div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>You must have the <code class="literal">manage</code> cluster privilege to connect remote clusters.</p>
</div>
</div>
<p>The local cluster uses the <a class="xref" href="modules-network.html" title="Networking">transport interface</a> to
establish communication with remote clusters. The coordinating nodes in the
local cluster establish <a class="xref" href="modules-network.html#long-lived-connections" title="Long-lived idle connections">long-lived</a> TCP connections
with specific nodes in the remote cluster. Elasticsearch requires these connections to
remain open, even if the connections are idle for an extended period.</p>
<p>To add a remote cluster from Stack Management in Kibana:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Select <span class="strong strong"><strong>Remote Clusters</strong></span> from the side navigation.
</li>
<li class="listitem">
Enter a name (<em>cluster alias</em>) for the remote cluster.
</li>
<li class="listitem">
Specify the Elasticsearch endpoint URL, or the IP address or host name of the remote
cluster followed by the transport port (defaults to
<code class="literal">9300</code>). For example,
<code class="literal">cluster.es.eastus2.staging.azure.foundit.no:9300</code> or
<code class="literal">192.168.1.1:9300</code>.
</li>
</ol>
</div>
<p>Alternatively, use the <a class="xref" href="cluster-update-settings.html" title="Cluster update settings API">cluster update settings API</a>
to add a remote cluster. You can also use this API to dynamically configure
remote clusters for <em>every</em> node in the local cluster. To configure remote
clusters on individual nodes in the local cluster, define static settings in
<code class="literal">elasticsearch.yml</code> for each node.</p>
<p>The following request adds a remote cluster with an alias of <code class="literal">cluster_one</code>. This
<em>cluster alias</em> is a unique identifier that represents the connection to the
remote cluster and is used to distinguish between local and remote indices.</p>
<a id="0b1c5486f96bfa5db8db854c0178dbe5"></a>
<div class="pre_wrapper lang-console">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console">PUT /_cluster/settings
{
  "persistent" : {
    "cluster" : {
      "remote" : {
        "cluster_one" : {    <a id="CO25-1"></a><i class="conum" data-value="1"></i>
          "seeds" : [
            "127.0.0.1:9300" <a id="CO25-2"></a><i class="conum" data-value="2"></i>
          ]
        }
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/59.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO25-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>The cluster alias of this remote cluster is <code class="literal">cluster_one</code>.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO25-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>Specifies the hostname and transport port of a seed node in the
remote cluster.</p>
</td>
</tr>
</table>
</div>
<p>You can use the <a class="xref" href="cluster-remote-info.html" title="Remote cluster info API">remote cluster info API</a> to verify that
the local cluster is successfully connected to the remote cluster:</p>
<div class="pre_wrapper lang-python alternative">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-python alternative">resp = client.cluster.remote_info()
print(resp)</pre>
</div>
<div class="pre_wrapper lang-ruby alternative">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ruby alternative">response = client.cluster.remote_info
puts response</pre>
</div>
<a id="cc0cca5556ec6224c7134c233734beed"></a>
<div class="pre_wrapper lang-console default has-python has-ruby">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console default has-python has-ruby">GET /_remote/info</pre>
</div>
<div class="console_widget has-python has-ruby" data-snippet="snippets/60.console"></div>
<p>The API response indicates that the local cluster is connected to the remote
cluster with the cluster alias <code class="literal">cluster_one</code>:</p>
<a id="ddefd65116c3c0653a64c5d44f09ec62"></a>
<div class="pre_wrapper lang-console-result">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console-result">{
  "cluster_one" : {
    "seeds" : [
      "127.0.0.1:9300"
    ],
    "connected" : true,
    "num_nodes_connected" : 1,  <a id="CO26-1"></a><i class="conum" data-value="1"></i>
    "max_connections_per_cluster" : 3,
    "initial_connect_timeout" : "30s",
    "skip_unavailable" : false, <a id="CO26-2"></a><i class="conum" data-value="2"></i>
    "mode" : "sniff"
  }
}</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO26-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>The number of nodes in the remote cluster the local cluster is
connected to.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO26-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>Indicates whether to skip the remote cluster if searched through cross-cluster search but
no nodes are available.</p>
</td>
</tr>
</table>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_dynamically_configure_remote_clusters_2"></a>Dynamically configure remote clusters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.14/docs/reference/modules/cluster/remote-clusters-connect.asciidoc">edit</a></h4>
</div></div></div>
<p>Use the <a class="xref" href="cluster-update-settings.html" title="Cluster update settings API">cluster update settings API</a> to dynamically
configure remote settings on every node in the cluster. The following request
adds three remote clusters: <code class="literal">cluster_one</code>, <code class="literal">cluster_two</code>, and <code class="literal">cluster_three</code>.</p>
<p>The <code class="literal">seeds</code> parameter specifies the hostname and
<a class="xref" href="modules-network.html" title="Networking">transport port</a> (default
<code class="literal">9300</code>) of a seed node in the remote cluster.</p>
<p>The <code class="literal">mode</code> parameter determines the configured connection mode, which defaults
to <a class="xref" href="remote-clusters.html#sniff-mode"><code class="literal">sniff</code></a>. Because <code class="literal">cluster_one</code> doesn&#8217;t specify a <code class="literal">mode</code>, it
uses the default. Both <code class="literal">cluster_two</code> and <code class="literal">cluster_three</code> explicitly use
different modes.</p>
<a id="b4f4c9ad3301c97fb3c38d108a3bc453"></a>
<div class="pre_wrapper lang-console">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console">PUT _cluster/settings
{
  "persistent": {
    "cluster": {
      "remote": {
        "cluster_one": {
          "seeds": [
            "127.0.0.1:9300"
          ]
        },
        "cluster_two": {
          "mode": "sniff",
          "seeds": [
            "127.0.0.1:9301"
          ],
          "transport.compress": true,
          "skip_unavailable": true
        },
        "cluster_three": {
          "mode": "proxy",
          "proxy_address": "127.0.0.1:9302"
        }
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/61.console"></div>
<p>You can dynamically update settings for a remote cluster after the initial
configuration. The following request updates the compression settings for
<code class="literal">cluster_two</code>, and the compression and ping schedule settings for
<code class="literal">cluster_three</code>.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>When the compression or ping schedule settings change, all existing
node connections must close and re-open, which can cause in-flight requests to
fail.</p>
</div>
</div>
<div class="pre_wrapper lang-ruby alternative">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ruby alternative">response = client.cluster.put_settings(
  body: {
    persistent: {
      cluster: {
        remote: {
          cluster_two: {
            'transport.compress' =&gt; false
          },
          cluster_three: {
            'transport.compress' =&gt; true,
            'transport.ping_schedule' =&gt; '60s'
          }
        }
      }
    }
  }
)
puts response</pre>
</div>
<a id="b1f7cb4157b13368373383abd7d2b8cb"></a>
<div class="pre_wrapper lang-console default has-ruby">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console default has-ruby">PUT _cluster/settings
{
  "persistent": {
    "cluster": {
      "remote": {
        "cluster_two": {
          "transport.compress": false
        },
        "cluster_three": {
          "transport.compress": true,
          "transport.ping_schedule": "60s"
        }
      }
    }
  }
}</pre>
</div>
<div class="console_widget has-ruby" data-snippet="snippets/62.console"></div>
<p>You can delete a remote cluster from the cluster settings by passing <code class="literal">null</code>
values for each remote cluster setting. The following request removes
<code class="literal">cluster_two</code> from the cluster settings, leaving <code class="literal">cluster_one</code> and
<code class="literal">cluster_three</code> intact:</p>
<div class="pre_wrapper lang-ruby alternative">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ruby alternative">response = client.cluster.put_settings(
  body: {
    persistent: {
      cluster: {
        remote: {
          cluster_two: {
            mode: nil,
            seeds: nil,
            skip_unavailable: nil,
            'transport.compress' =&gt; nil
          }
        }
      }
    }
  }
)
puts response</pre>
</div>
<a id="7456ef459d510d66ba4492cc9fbdc6c6"></a>
<div class="pre_wrapper lang-console default has-ruby">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console default has-ruby">PUT _cluster/settings
{
  "persistent": {
    "cluster": {
      "remote": {
        "cluster_two": {
          "mode": null,
          "seeds": null,
          "skip_unavailable": null,
          "transport.compress": null
        }
      }
    }
  }
}</pre>
</div>
<div class="console_widget has-ruby" data-snippet="snippets/63.console"></div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_statically_configure_remote_clusters_2"></a>Statically configure remote clusters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.14/docs/reference/modules/cluster/remote-clusters-connect.asciidoc">edit</a></h4>
</div></div></div>
<p>If you specify settings in <code class="literal">elasticsearch.yml</code>, only the nodes with
those settings can connect to the remote cluster and serve remote cluster
requests.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Remote cluster settings that are specified using the
<a class="xref" href="cluster-update-settings.html" title="Cluster update settings API">cluster update settings API</a> take precedence over
settings that you specify in <code class="literal">elasticsearch.yml</code> for individual nodes.</p>
</div>
</div>
<p>In the following example, <code class="literal">cluster_one</code>, <code class="literal">cluster_two</code>, and <code class="literal">cluster_three</code> are
arbitrary cluster aliases representing the connection to each cluster. These
names are subsequently used to distinguish between local and remote indices.</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">cluster:
    remote:
        cluster_one:
            seeds: 127.0.0.1:9300
        cluster_two:
            mode: sniff
            seeds: 127.0.0.1:9301
            transport.compress: true      <a id="CO27-1"></a><i class="conum" data-value="1"></i>
            skip_unavailable: true        <a id="CO27-2"></a><i class="conum" data-value="2"></i>
        cluster_three:
            mode: proxy
            proxy_address: 127.0.0.1:9302 <a id="CO27-3"></a><i class="conum" data-value="3"></i></pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO27-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Compression is explicitly enabled for requests to <code class="literal">cluster_two</code>.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO27-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>Disconnected remote clusters are optional for <code class="literal">cluster_two</code>.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO27-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>The address for the proxy endpoint used to connect to <code class="literal">cluster_three</code>.</p>
</td>
</tr>
</table>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="remote-clusters-privileges-cert"></a>Configure roles and users for remote clusters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.14/docs/reference/security/authentication/remote-clusters-privileges-cert.asciidoc">edit</a></h3>
</div></div></div>
<p>After <a class="xref" href="remote-clusters-connect.html" title="Remote clusters">connecting remote clusters</a>, you create a
user role on both the local and remote clusters and assign necessary privileges.
These roles are required to use cross-cluster replication and cross-cluster search.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>You must use the same role names on both the local
and remote clusters. For example, the following configuration for cross-cluster replication uses the
<code class="literal">remote-replication</code> role name on both the local and remote clusters. However,
you can specify different role definitions on each cluster.</p>
</div>
</div>
<p>You can manage users and roles from Stack Management in Kibana by selecting
<span class="strong strong"><strong>Security &gt; Roles</strong></span> from the side navigation. You can also use the
<a class="xref" href="security-api.html#security-role-mapping-apis" title="Role mappings">role management APIs</a> to add, update, remove, and
retrieve roles dynamically. When you use the APIs to manage roles in the
<code class="literal">native</code> realm, the roles are stored in an internal Elasticsearch index.</p>
<p>The following requests use the
<a class="xref" href="security-api-put-role.html" title="Create or update roles API">create or update roles API</a>. You must have at least the
<code class="literal">manage_security</code> cluster privilege to use this API.</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="remote-clusters-privileges-ccr"></a>Configure privileges for cross-cluster replication<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.14/docs/reference/security/authentication/remote-clusters-privileges-cert.asciidoc">edit</a></h4>
</div></div></div>
<p>The cross-cluster replication user requires different cluster and index privileges on the remote
cluster and local cluster. Use the following requests to create separate roles
on the local and remote clusters, and then create a user with the required
roles.</p>
<h6><a id="_remote_cluster"></a>Remote cluster<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.14/docs/reference/security/authentication/remote-clusters-privileges-cert.asciidoc">edit</a></h6>
<p>On the remote cluster that contains the leader index, the cross-cluster replication role requires
the <code class="literal">read_ccr</code> cluster privilege, and <code class="literal">monitor</code> and <code class="literal">read</code> privileges on the
leader index.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>If requests are authenticated with an <a class="xref" href="security-api-create-api-key.html" title="Create API key API">API key</a>, the API key
requires the above privileges on the <span class="strong strong"><strong>local</strong></span> cluster, instead of the remote.</p>
</div>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>If requests are issued <a class="xref" href="run-as-privilege.html" title="Submitting requests on behalf of other users">on behalf of other users</a>,
then the authenticating user must have the <code class="literal">run_as</code> privilege on the remote
cluster.</p>
</div>
</div>
<p>The following request creates a <code class="literal">remote-replication</code> role on the remote cluster:</p>
<a id="b2dec193082462c775169db438308bc3"></a>
<div class="pre_wrapper lang-console">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console">POST /_security/role/remote-replication
{
  "cluster": [
    "read_ccr"
  ],
  "indices": [
    {
      "names": [
        "leader-index-name"
      ],
      "privileges": [
        "monitor",
        "read"
      ]
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/64.console"></div>
<h6><a id="_local_cluster"></a>Local cluster<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.14/docs/reference/security/authentication/remote-clusters-privileges-cert.asciidoc">edit</a></h6>
<p>On the local cluster that contains the follower index, the <code class="literal">remote-replication</code>
role requires the <code class="literal">manage_ccr</code> cluster privilege, and <code class="literal">monitor</code>, <code class="literal">read</code>, <code class="literal">write</code>,
and <code class="literal">manage_follow_index</code> privileges on the follower index.</p>
<p>The following request creates a <code class="literal">remote-replication</code> role on the local cluster:</p>
<a id="cf9f51d719a2e90ffe36ed6fe56a4a69"></a>
<div class="pre_wrapper lang-console">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console">POST /_security/role/remote-replication
{
  "cluster": [
    "manage_ccr"
  ],
  "indices": [
    {
      "names": [
        "follower-index-name"
      ],
      "privileges": [
        "monitor",
        "read",
        "write",
        "manage_follow_index"
      ]
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/65.console"></div>
<p>After creating the <code class="literal">remote-replication</code> role on each cluster, use the
<a class="xref" href="security-api-put-user.html" title="Create or update users API">create or update users API</a> to create a user on
the local cluster cluster and assign the <code class="literal">remote-replication</code> role. For
example, the following request assigns the <code class="literal">remote-replication</code> role to a user
named <code class="literal">cross-cluster-user</code>:</p>
<a id="9d5855075e7008270459cc88c189043d"></a>
<div class="pre_wrapper lang-console">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console">POST /_security/user/cross-cluster-user
{
  "password" : "l0ng-r4nd0m-p@ssw0rd",
  "roles" : [ "remote-replication" ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/66.console"></div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>You only need to create this user on the <span class="strong strong"><strong>local</strong></span> cluster.</p>
</div>
</div>
<p>You can then <a class="xref" href="ccr-getting-started-tutorial.html" title="Tutorial: Set up cross-cluster replication">configure cross-cluster replication</a> to replicate your
data across datacenters.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="remote-clusters-privileges-ccs"></a>Configure privileges for cross-cluster search<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.14/docs/reference/security/authentication/remote-clusters-privileges-cert.asciidoc">edit</a></h4>
</div></div></div>
<p>The cross-cluster search user requires different cluster and index privileges on the remote
cluster and local cluster. The following requests create separate roles on the
local and remote clusters, and then create a user with the required roles.</p>
<h6><a id="_remote_cluster_2"></a>Remote cluster<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.14/docs/reference/security/authentication/remote-clusters-privileges-cert.asciidoc">edit</a></h6>
<p>On the remote cluster, the cross-cluster search role requires the <code class="literal">read</code> and
<code class="literal">read_cross_cluster</code> privileges for the target indices.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>If requests are authenticated with an <a class="xref" href="security-api-create-api-key.html" title="Create API key API">API key</a>, the API key
requires the above privileges on the <span class="strong strong"><strong>local</strong></span> cluster, instead of the remote.</p>
</div>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>If requests are issued <a class="xref" href="run-as-privilege.html" title="Submitting requests on behalf of other users">on behalf of other users</a>,
then the authenticating user must have the <code class="literal">run_as</code> privilege on the remote
cluster.</p>
</div>
</div>
<p>The following request creates a <code class="literal">remote-search</code> role on the remote cluster:</p>
<a id="a322c8c73d6f2f5e1e375588ed20b636"></a>
<div class="pre_wrapper lang-console">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console">POST /_security/role/remote-search
{
  "indices": [
    {
      "names": [
        "target-indices"
      ],
      "privileges": [
        "read",
        "read_cross_cluster"
      ]
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/67.console"></div>
<h6><a id="_local_cluster_2"></a>Local cluster<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.14/docs/reference/security/authentication/remote-clusters-privileges-cert.asciidoc">edit</a></h6>
<p>On the local cluster, which is the cluster used to initiate cross cluster
search, a user only needs the <code class="literal">remote-search</code> role. The role privileges can be
empty.</p>
<p>The following request creates a <code class="literal">remote-search</code> role on the local cluster:</p>
<a id="8d4ca17349e7e82c329cdd854cc670a1"></a>
<div class="pre_wrapper lang-console">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console">POST /_security/role/remote-search
{}</pre>
</div>
<div class="console_widget" data-snippet="snippets/68.console"></div>
<p>After creating the <code class="literal">remote-search</code> role on each cluster, use the
<a class="xref" href="security-api-put-user.html" title="Create or update users API">create or update users API</a> to create a user on the
local cluster and assign the <code class="literal">remote-search</code> role. For example, the following
request assigns the <code class="literal">remote-search</code> role to a user named <code class="literal">cross-search-user</code>:</p>
<a id="f187ac2dc35425cb0ef48f328cc7e435"></a>
<div class="pre_wrapper lang-console">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console">POST /_security/user/cross-search-user
{
  "password" : "l0ng-r4nd0m-p@ssw0rd",
  "roles" : [ "remote-search" ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/69.console"></div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>You only need to create this user on the <span class="strong strong"><strong>local</strong></span> cluster.</p>
</div>
</div>
<p>Users with the <code class="literal">remote-search</code> role can then
<a class="xref" href="modules-cross-cluster-search.html" title="Search across clusters">search across clusters</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="clusters-privileges-ccs-kibana-cert"></a>Configure privileges for cross-cluster search and Kibana<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.14/docs/reference/security/authentication/remote-clusters-privileges-cert.asciidoc">edit</a></h4>
</div></div></div>
<p>When using Kibana to search across multiple clusters, a two-step authorization
process determines whether or not the user can access data streams and indices
on a remote cluster:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
First, the local cluster determines if the user is authorized to access remote
clusters. The local cluster is the cluster that Kibana is connected to.
</li>
<li class="listitem">
If the user is authorized, the remote cluster then determines if the user has
access to the specified data streams and indices.
</li>
</ul>
</div>
<p>To grant Kibana users access to remote clusters, assign them a local role
with read privileges to indices on the remote clusters. You specify data streams
and indices in a remote cluster as <code class="literal">&lt;remote_cluster_name&gt;:&lt;target&gt;</code>.</p>
<p>To grant users read access on the remote data streams and indices, you must
create a matching role on the remote clusters that grants the
<code class="literal">read_cross_cluster</code> privilege with access to the appropriate data streams and
indices.</p>
<p>For example, you might be actively indexing Logstash data on a local cluster and
and periodically offload older time-based indices to an archive on your remote
cluster. You want to search across both clusters, so you must enable Kibana
users on both clusters.</p>
<h6><a id="_local_cluster_3"></a>Local cluster<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.14/docs/reference/security/authentication/remote-clusters-privileges-cert.asciidoc">edit</a></h6>
<p>On the local cluster, create a <code class="literal">logstash-reader</code> role that grants
<code class="literal">read</code> and <code class="literal">view_index_metadata</code> privileges on the local <code class="literal">logstash-*</code> indices.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>If you configure the local cluster as another remote in Elasticsearch, the
<code class="literal">logstash-reader</code> role on your local cluster also needs to grant the
<code class="literal">read_cross_cluster</code> privilege.</p>
</div>
</div>
<a id="8c2060b0272556457f4871c5d7a589fd"></a>
<div class="pre_wrapper lang-console">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console">POST /_security/role/logstash-reader
{
  "indices": [
    {
      "names": [
        "logstash-*"
        ],
        "privileges": [
          "read",
          "view_index_metadata"
          ]
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/70.console"></div>
<p>Assign your Kibana users a role that grants
<a href="/guide/en/kibana/8.14/xpack-security-authorization.html" class="ulink" target="_top">access to Kibana</a>, as well as your
<code class="literal">logstash_reader</code> role. For example, the following request creates the
<code class="literal">cross-cluster-kibana</code> user and assigns the <code class="literal">kibana-access</code> and
<code class="literal">logstash-reader</code> roles.</p>
<a id="8a617dbfe5887f8ecc8815de132b6eb0"></a>
<div class="pre_wrapper lang-console">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console">PUT /_security/user/cross-cluster-kibana
{
  "password" : "l0ng-r4nd0m-p@ssw0rd",
  "roles" : [
    "logstash-reader",
    "kibana-access"
    ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/71.console"></div>
<h6><a id="_remote_cluster_3"></a>Remote cluster<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.14/docs/reference/security/authentication/remote-clusters-privileges-cert.asciidoc">edit</a></h6>
<p>On the remote cluster, create a <code class="literal">logstash-reader</code> role that grants the
<code class="literal">read_cross_cluster</code> privilege and <code class="literal">read</code> and <code class="literal">view_index_metadata</code> privileges
for the <code class="literal">logstash-*</code> indices.</p>
<a id="5a6bb9ac6830668ecc00550c1aa8f2f1"></a>
<div class="pre_wrapper lang-console">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console">POST /_security/role/logstash-reader
{
  "indices": [
    {
      "names": [
        "logstash-*"
        ],
        "privileges": [
          "read_cross_cluster",
          "read",
          "view_index_metadata"
          ]
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/72.console"></div>
</div>

</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="remote-clusters-api-key.html">« Add remote clusters using API key authentication</a>
</span>
<span class="next">
<a href="remote-clusters-migrate.html">Migrate remote clusters from certificate to API key authentication »</a>
</span>
</div>
</div>
</body>
</html>
