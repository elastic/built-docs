<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Using ES|QL in Kibana | Elasticsearch Guide [8.15] | Elastic</title>
<meta class="elastic" name="content" content="Using ES|QL in Kibana | Elasticsearch Guide [8.15]">

<link rel="home" href="index.html" title="Elasticsearch Guide [8.15]"/>
<link rel="up" href="esql-using.html" title="Using ES|QL"/>
<link rel="prev" href="esql-rest.html" title="ES|QL REST API"/>
<link rel="next" href="esql-elastic-security.html" title="Using ES|QL in Elastic Security"/>
<meta class="elastic" name="product_version" content="8.15"/>
<meta class="elastic" name="product_name" content="Elasticsearch"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/8.15"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="8.15"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div class="navheader">
<span class="prev">
<a href="esql-rest.html">« ES|QL REST API</a>
</span>
<span class="next">
<a href="esql-elastic-security.html">Using ES|QL in Elastic Security »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elasticsearch Guide [8.15]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="esql.html">ES|QL</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="esql-using.html">Using ES|QL</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Using ES|QL in Kibana</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/esql/esql-kibana.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="esql-kibana"></a>Using ES|QL in Kibana<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/esql/esql-kibana.asciidoc">edit</a></h2>
</div></div></div>

<p>You can use ES|QL in Kibana to query and aggregate your data, create
visualizations, and set up alerts.</p>
<p>This guide shows you how to use ES|QL in Kibana. To follow along with the
queries, load the "Sample web logs" sample data set by clicking <span class="strong strong"><strong>Try sample
data</strong></span> from the Kibana Home, selecting <span class="strong strong"><strong>Other sample data sets</strong></span>, and clicking <span class="strong strong"><strong>Add
data</strong></span> on the <span class="strong strong"><strong>Sample web logs</strong></span> card.</p>
<h3><a id="esql-kibana-enable"></a>Enable or disable ES|QL<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/esql/esql-kibana.asciidoc">edit</a></h3>
<p>ES|QL is enabled by default in Kibana. It can be
disabled using the <code class="literal">enableESQL</code> setting from the
<a href="/guide/en/kibana/8.15/advanced-options.html" class="ulink" target="_top">Advanced Settings</a>.</p>
<p>This will hide the ES|QL user interface from various applications.
However, users will be able to access existing ES|QL artifacts like saved searches and visualizations.</p>
<h3><a id="esql-kibana-get-started"></a>Get started with ES|QL<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/esql/esql-kibana.asciidoc">edit</a></h3>
<p>To get started with ES|QL in Discover, open the main menu and select
<span class="strong strong"><strong>Discover</strong></span>. Next, from the Data views menu, select <span class="strong strong"><strong>Language: ES|QL</strong></span>.</p>
<div class="imageblock text-center">
<div class="content">
<img src="images/esql/esql-data-view-menu.png" alt="esql data view menu" width="33%">
</div>
</div>
<h3><a id="esql-kibana-query-bar"></a>The query bar<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/esql/esql-kibana.asciidoc">edit</a></h3>
<p>After switching to ES|QL mode, the query bar shows a sample query. For example:</p>
<div class="pre_wrapper lang-esql">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-esql">from kibana_sample_data_logs | limit 10</pre>
</div>
<p>Every query starts with a <a class="xref" href="esql-commands.html" title="ES|QL commands">source command</a>. In this query, the
source command is <a class="xref" href="esql-commands.html#esql-from" title="FROM"><code class="literal">FROM</code></a>. <code class="literal">FROM</code> retrieves data from data streams, indices, or
aliases. In this example, the data is retrieved from <code class="literal">kibana_sample_data_logs</code>.</p>
<p>A source command can be followed by one or more <a class="xref" href="esql-commands.html" title="ES|QL commands">processing
commands</a>. In this query, the processing command is <a class="xref" href="esql-commands.html#esql-limit" title="LIMIT"><code class="literal">LIMIT</code></a>. <code class="literal">LIMIT</code>
limits the number of rows that are retrieved.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>Click the help icon (<span class="image"><img src="images/esql/esql-icon-help.svg" alt="Static" width="20"></span>) to open the
in-product reference documentation for all commands and functions.</p>
</div>
</div>
<p>To make it easier to write queries, auto-complete offers suggestions with
possible commands and functions:</p>
<div class="imageblock text-center">
<div class="content">
<img src="images/esql/esql-kibana-auto-complete.png" alt="esql kibana auto complete">
</div>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>ES|QL keywords are case-insensitive. The following query is identical to the
previous one:</p>
<div class="pre_wrapper lang-esql">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-esql">FROM kibana_sample_data_logs | LIMIT 10</pre>
</div>
</div>
</div>
<h4><a id="_expand_the_query_bar"></a>Expand the query bar<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/esql/esql-kibana.asciidoc">edit</a></h4>
<p>For readability, you can put each processing command on a new line. The
following query is identical to the previous one:</p>
<div class="pre_wrapper lang-esql">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-esql">FROM kibana_sample_data_logs
| LIMIT 10</pre>
</div>
<p>To make it easier to write multi-line queries, click the double-headed arrow
button (<span class="image"><img src="images/esql/esql-icon-expand-query-bar.svg" alt="esql icon expand query bar"></span>) to expand the query
bar:</p>
<div class="imageblock text-center">
<div class="content">
<img src="images/esql/esql-expanded-query-bar.png" alt="esql expanded query bar">
</div>
</div>
<p>To return to a compact query bar, click the minimize editor button
(<span class="image"><img src="images/esql/esql-icon-minimize-query-bar.svg" alt="esql icon minimize query bar"></span>).</p>
<h4><a id="_warnings"></a>Warnings<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/esql/esql-kibana.asciidoc">edit</a></h4>
<p>A query may result in warnings, for example when querying an unsupported field
type. When that happens, a warning symbol is shown in the query bar. To see the
detailed warning, expand the query bar, and click <span class="strong strong"><strong>warnings</strong></span>.</p>
<h4><a id="esql-kibana-query-history"></a>Query history<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/esql/esql-kibana.asciidoc">edit</a></h4>
<p>You can reuse your recent ES|QL queries in the query bar.
In the query bar click <span class="strong strong"><strong>Show recent queries</strong></span>:</p>
<div class="imageblock text-center">
<div class="content">
<img src="images/esql/esql-discover-show-recent-query.png" alt="esql discover show recent query">
</div>
</div>
<p>You can then scroll through your recent queries:</p>
<div class="imageblock text-center">
<div class="content">
<img src="images/esql/esql-discover-query-history.png" alt="esql discover query history">
</div>
</div>
<h3><a id="esql-kibana-results-table"></a>The results table<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/esql/esql-kibana.asciidoc">edit</a></h3>
<p>For the example query, the results table shows 10 rows. Omitting the <code class="literal">LIMIT</code>
command, the results table defaults to up to 1000 rows. Using <code class="literal">LIMIT</code>, you can
increase the limit to up to 10,000 rows.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>the 10,000 row limit only applies to the number of rows that are retrieved
by the query and displayed in Discover. Any query or aggregation runs on the
full data set.</p>
</div>
</div>
<p>Each row shows two columns for the example query: a column with the <code class="literal">@timestamp</code>
field and a column with the full document. To display specific fields from the
documents, use the <a class="xref" href="esql-commands.html#esql-keep" title="KEEP"><code class="literal">KEEP</code></a> command:</p>
<div class="pre_wrapper lang-esql">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-esql">FROM kibana_sample_data_logs
| KEEP @timestamp, bytes, geo.dest</pre>
</div>
<p>To display all fields as separate columns, use <code class="literal">KEEP *</code>:</p>
<div class="pre_wrapper lang-esql">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-esql">FROM kibana_sample_data_logs
| KEEP *</pre>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The maximum number of columns in Discover is 50. If a query returns more
than 50 columns, Discover only shows the first 50.</p>
</div>
</div>
<h4><a id="_sorting"></a>Sorting<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/esql/esql-kibana.asciidoc">edit</a></h4>
<p>To sort on one of the columns, click the column name you want to sort on and
select the sort order. Note that this performs client-side sorting. It only
sorts the rows that were retrieved by the query, which may not be the full
dataset because of the (implicit) limit. To sort the full data set, use the
<a class="xref" href="esql-commands.html#esql-sort" title="SORT"><code class="literal">SORT</code></a> command:</p>
<div class="pre_wrapper lang-esql">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-esql">FROM kibana_sample_data_logs
| KEEP @timestamp, bytes, geo.dest
| SORT bytes DESC</pre>
</div>
<h3><a id="esql-kibana-time-filter"></a>Time filtering<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/esql/esql-kibana.asciidoc">edit</a></h3>
<p>To display data within a specified time range, use the
<a href="/guide/en/kibana/8.15/set-time-filter.html" class="ulink" target="_top">time filter</a>. The time filter is only enabled
when the indices you&#8217;re querying have a field called <code class="literal">@timestamp</code>.</p>
<p>If your indices do not have a timestamp field called <code class="literal">@timestamp</code>, you can limit
the time range using the <a class="xref" href="esql-commands.html#esql-where" title="WHERE"><code class="literal">WHERE</code></a> command and the <a class="xref" href="esql-functions-operators.html#esql-now" title="NOW"><code class="literal">NOW</code></a> function.
For example, if the timestamp field is called <code class="literal">timestamp</code>, to query the last 15
minutes of data:</p>
<div class="pre_wrapper lang-esql">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-esql">FROM kibana_sample_data_logs
| WHERE timestamp &gt; NOW() - 15minutes</pre>
</div>
<h3><a id="esql-kibana-visualizations"></a>Analyze and visualize data<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/esql/esql-kibana.asciidoc">edit</a></h3>
<p>Between the query bar and the results table, Discover shows a date histogram
visualization. If the indices you&#8217;re querying do not contain a <code class="literal">@timestamp</code>
field, the histogram is not shown.</p>
<p>The visualization adapts to the query. A query&#8217;s nature determines the type of
visualization. For example, this query aggregates the total number of bytes per
destination country:</p>
<div class="pre_wrapper lang-esql">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-esql">FROM kibana_sample_data_logs
| STATS total_bytes = SUM(bytes) BY geo.dest
| SORT total_bytes DESC
| LIMIT 3</pre>
</div>
<p>The resulting visualization is a bar chart showing the top 3 countries:</p>
<div class="imageblock text-center">
<div class="content">
<img src="images/esql/esql-kibana-bar-chart.png" alt="esql kibana bar chart">
</div>
</div>
<p>To make changes to the visualization, like changing the visualization type, axes and colors, click the
pencil button (<span class="image"><img src="images/esql/esql-icon-edit-visualization.svg" alt="esql icon edit visualization"></span>). This opens
an in-line editor:</p>
<div class="imageblock text-center">
<div class="content">
<img src="images/esql/esql-kibana-in-line-editor.png" alt="esql kibana in line editor" width="66%">
</div>
</div>
<p>You can save the visualization to a new or existing dashboard by clicking the
save button (<span class="image"><img src="images/esql/esql-icon-save-visualization.svg" alt="esql icon save visualization"></span>). Once saved
to a dashboard, you&#8217;ll be taken to the Dashboards page. You can continue to
make changes to the visualization. Click the
options button in the top-right (<span class="image"><img src="images/esql/esql-icon-options.svg" alt="esql icon options"></span>) and
select <span class="strong strong"><strong>Edit ESQL visualization</strong></span> to open the in-line editor:</p>
<div class="imageblock text-center">
<div class="content">
<img src="images/esql/esql-kibana-edit-on-dashboard.png" alt="esql kibana edit on dashboard" width="66%">
</div>
</div>
<h4><a id="esql-kibana-dashboard-panel"></a>Add a panel to a dashboard<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/esql/esql-kibana.asciidoc">edit</a></h4>
<p>You can use ES|QL queries to create panels on your dashboards.
To add a panel to a dashboard, under <span class="strong strong"><strong>Dashboards</strong></span>, click the <span class="strong strong"><strong>Add panel</strong></span> button and select ES|QL.</p>
<div class="imageblock text-center">
<div class="content">
<img src="images/esql/esql-dashboard-panel.png" alt="esql dashboard panel" width="50%">
</div>
</div>
<p>Check the ES|QL query by clicking the Panel filters button (<span class="image"><img src="images/esql/dashboard_panel_filter_button.png" alt="Panel filters button on panel header"></span>):</p>
<div class="imageblock text-center">
<div class="content">
<img src="images/esql/esql-dashboard-panel-query.png" alt="esql dashboard panel query" width="50%">
</div>
</div>
<p>You can also edit the ES|QL visualization from here.
Click the options button in the top-right (<span class="image"><img src="images/esql/esql-icon-options.svg" alt="esql icon options"></span>) and
select <span class="strong strong"><strong>Edit ESQL visualization</strong></span> to open the in-line editor.</p>
<div class="imageblock text-center">
<div class="content">
<img src="images/esql/esql-dashboard-panel-edit-visualization.png" alt="esql dashboard panel edit visualization" width="50%">
</div>
</div>
<h3><a id="esql-kibana-enrich"></a>Create an enrich policy<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/esql/esql-kibana.asciidoc">edit</a></h3>
<p>The ES|QL <a class="xref" href="esql-commands.html#esql-enrich" title="ENRICH"><code class="literal">ENRICH</code></a> command enables you to <a class="xref" href="esql-enrich-data.html" title="Data enrichment">enrich</a>
your query dataset with fields from another dataset. Before you can use
<code class="literal">ENRICH</code>, you need to <a class="xref" href="esql-enrich-data.html#esql-set-up-enrich-policy" title="Set up an enrich policy">create and execute an enrich
policy</a>. If a policy exists, it will be suggested by auto-complete. If not,
click <span class="strong strong"><strong>Click to create</strong></span> to create one.</p>
<div class="imageblock text-center">
<div class="content">
<img src="images/esql/esql-kibana-enrich-autocomplete.png" alt="esql kibana enrich autocomplete">
</div>
</div>
<p>Next, you can enter a policy name, the policy type, source indices, and
optionally a query:</p>
<div class="imageblock text-center">
<div class="content">
<img src="images/esql/esql-kibana-enrich-step-1.png" alt="esql kibana enrich step 1" width="50%">
</div>
</div>
<p>Click <span class="strong strong"><strong>Next</strong></span> to select the match field and enrich fields:</p>
<div class="imageblock text-center">
<div class="content">
<img src="images/esql/esql-kibana-enrich-step-2.png" alt="esql kibana enrich step 2" width="50%">
</div>
</div>
<p>Finally, click <span class="strong strong"><strong>Create and execute</strong></span>.</p>
<p>Now, you can use the enrich policy in an ES|QL query:</p>
<div class="pre_wrapper lang-esql">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-esql">FROM kibana_sample_data_logs
| STATS total_bytes = SUM(bytes) BY geo.dest
| SORT total_bytes DESC
| LIMIT 3
| ENRICH countries</pre>
</div>
<h3><a id="esql-kibana-alerting-rule"></a>Create an alerting rule<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/esql/esql-kibana.asciidoc">edit</a></h3>
<p>You can use ES|QL queries to create alerts. From Discover, click <span class="strong strong"><strong>Alerts</strong></span> and
select <span class="strong strong"><strong>Create search threshold rule</strong></span>. This opens a panel that enables you to
create a rule using an ES|QL query. Next, you can test the query, add a
connector, and save the rule.</p>
<div class="imageblock text-center">
<div class="content">
<img src="images/esql/esql-kibana-create-rule.png" alt="esql kibana create rule" width="50%">
</div>
</div>
<h3><a id="esql-kibana-limitations"></a>Limitations<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/esql/esql-kibana.asciidoc">edit</a></h3>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
The user interface to filter data is not enabled when Discover is in ES|QL
mode. To filter data, write a query that uses the <a class="xref" href="esql-commands.html#esql-where" title="WHERE"><code class="literal">WHERE</code></a> command
instead.
</li>
<li class="listitem">
Discover shows no more than 10,000 rows. This limit only applies to the number
of rows that are retrieved by the query and displayed in Discover. Queries and
aggregations run on the full data set.
</li>
<li class="listitem">
Discover shows no more than 50 columns. If a query returns
more than 50 columns, Discover only shows the first 50.
</li>
<li class="listitem">
CSV export from Discover shows no more than 10,000 rows. This limit only applies to the number
of rows that are retrieved by the query and displayed in Discover. Queries and
aggregations run on the full data set.
</li>
<li class="listitem">
Querying many indices at once without any filters can cause an error in
kibana which looks like <code class="literal">[esql] &gt; Unexpected error from Elasticsearch: The
content length (536885793) is bigger than the maximum allowed string
(536870888)</code>. The response from ES|QL is too long. Use <a class="xref" href="esql-commands.html#esql-drop" title="DROP"><code class="literal">DROP</code></a> or
<a class="xref" href="esql-commands.html#esql-keep" title="KEEP"><code class="literal">KEEP</code></a> to limit the number of fields returned.
</li>
</ul>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="esql-rest.html">« ES|QL REST API</a>
</span>
<span class="next">
<a href="esql-elastic-security.html">Using ES|QL in Elastic Security »</a>
</span>
</div>
</body>
</html>
