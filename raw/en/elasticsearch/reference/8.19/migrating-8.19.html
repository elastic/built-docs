<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="keywords" content="Elasticsearch diagnostic, diagnostics">
<title>Migrating to 8.19 | Elasticsearch Guide [8.19] | Elastic</title>
<meta class="elastic" name="content" content="Migrating to 8.19 | Elasticsearch Guide [8.19]">

<link rel="home" href="index.html" title="Elasticsearch Guide [8.19]"/>
<link rel="up" href="breaking-changes.html" title="Migration guide"/>
<link rel="prev" href="breaking-changes.html" title="Migration guide"/>
<link rel="next" href="migrating-8.18.html" title="Migrating to 8.18"/>
<meta class="elastic" name="product_version" content="8.19"/>
<meta class="elastic" name="product_name" content="Elasticsearch"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/8.19"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="8.19"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
This documentation contains work-in-progress information for future Elastic Stack and Cloud releases. Use the version selector to view supported release docs. It also contains some Elastic Cloud serverless information. Check out our <a href="https://www.elastic.co/docs/current/serverless">serverless docs</a> for more details.
</div>
<div class="navheader">
<span class="prev">
<a href="breaking-changes.html">« Migration guide</a>
</span>
<span class="next">
<a href="migrating-8.18.html">Migrating to 8.18 »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elasticsearch Guide [8.19]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="breaking-changes.html">Migration guide</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Migrating to 8.19</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.19/docs/reference/migration/migrate_8_19.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div id="url-to-v3" class="version-warning">
    <strong>IMPORTANT</strong>: This documentation is no longer updated. Refer to <a href="https://www.elastic.co/support/eol">Elastic's version policy</a> and the <a href="https://www.elastic.co/docs">latest documentation</a>.
</div>
<div class="chapter">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="migrating-8.19"></a>Migrating to 8.19</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.19/docs/reference/migration/migrate_8_19.asciidoc">edit</a></div>
</div></div></div>

<p>This section discusses the changes that you need to be aware of when migrating
your application to Elasticsearch 8.19.</p>
<p>See also <a class="xref" href="release-highlights.html" title="What&#8217;s new in 8.19"><em>What&#8217;s new in 8.19</em></a> and <a class="xref" href="es-release-notes.html" title="Release notes">Release notes</a>.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Coming in 8.19.0.</p>
</div>
</div>
<div class="position-relative"><h3><a id="breaking-changes-8.19"></a>Breaking changes</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.19/docs/reference/migration/migrate_8_19.asciidoc">edit</a></div>
<p>The following changes in Elasticsearch 8.19 might affect your applications
and prevent them from operating normally.
Before upgrading to 8.19, review these changes and take the described steps
to mitigate the impact.</p>
<div class="position-relative"><h4><a id="breaking_819_cluster_and_node_setting_changes"></a>Cluster and node setting changes</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.19/docs/reference/migration/migrate_8_19.asciidoc">edit</a></div>
<details id="upgrade_discovery_ec2_to_aws_sdk_v2">
<summary class="title">Upgrade <code class="literal">discovery-ec2</code> to AWS SDK v2</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
In earlier versions of Elasticsearch the <code class="literal">discovery-ec2</code> plugin was based on the AWS SDK v1. AWS will withdraw support for this SDK before the end of the life of Elasticsearch 8.19 so we must migrate to the newer AWS SDK v2.
Unfortunately there are several differences between the two AWS SDK versions which may require you to adjust your system configuration when upgrading to Elasticsearch 8.19 or later. These differences include, but may not be limited to, the following items.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
AWS SDK v2 does not support the EC2 IMDSv1 protocol.
</li>
<li class="listitem">
AWS SDK v2 does not support the <code class="literal">aws.secretKey</code> or
<code class="literal">com.amazonaws.sdk.ec2MetadataServiceEndpointOverride</code> system properties.
</li>
<li class="listitem">
AWS SDK v2 does not permit specifying a choice between HTTP and HTTPS so
the <code class="literal">discovery.ec2.protocol</code> setting is no longer effective.
</li>
<li class="listitem">
AWS SDK v2 does not accept an access key without a secret key or vice
versa.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Impact</strong></span><br>
If you use the <code class="literal">discovery-ec2</code> plugin, test your upgrade thoroughly before upgrading any production workloads.
Adapt your configuration to the new SDK functionality. This includes, but may not be limited to, the following items.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If you use IMDS to determine the availability zone of a node or to obtain
credentials for accessing the EC2 API, ensure that it supports the IMDSv2
protocol.
</li>
<li class="listitem">
If applicable, discontinue use of the <code class="literal">aws.secretKey</code> and
<code class="literal">com.amazonaws.sdk.ec2MetadataServiceEndpointOverride</code> system properties.
</li>
<li class="listitem">
If applicable, specify that you wish to use the insecure HTTP protocol to
access the EC2 API by setting <code class="literal">discovery.ec2.endpoint</code> to a URL which
starts with <code class="literal">http://</code>.
</li>
<li class="listitem">
Either supply both an access key and a secret key using the keystore
settings <code class="literal">discovery.ec2.access_key</code> and <code class="literal">discovery.ec2.secret_key</code>, or
configure neither of these settings.
</li>
</ul>
</div>
</div>
</details>
<details id="upgrade_repository_s3_to_aws_sdk">
<summary class="title">Upgrade <code class="literal">repository-s3</code> to AWS SDK v2</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
In earlier versions of Elasticsearch the <code class="literal">repository-s3</code> plugin was based on the AWS SDK v1. AWS will withdraw support for this SDK before the end of the life of Elasticsearch 8.19 so we must migrate to the newer AWS SDK v2.
Unfortunately there are several differences between the two AWS SDK versions which may require you to adjust your system configuration when upgrading to Elasticsearch 8.19 or later. These differences include, but may not be limited to, the following items.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
AWS SDK v2 requires users to specify the region to use for signing
requests, or else to run in an environment in which it can determine the
correct region automatically. The older SDK would try to determine the
region based on the endpoint URL as specified with the
<code class="literal">s3.client.${CLIENT_NAME}.endpoint</code> setting, together with other data
drawn from the operating environment, and would ultimately fall back to
<code class="literal">us-east-1</code> if no better value could be found.
</li>
<li class="listitem">
AWS SDK v2 does not support the EC2 IMDSv1 protocol.
</li>
<li class="listitem">
AWS SDK v2 does not support the
<code class="literal">com.amazonaws.sdk.ec2MetadataServiceEndpointOverride</code> system property.
</li>
<li class="listitem">
AWS SDK v2 does not permit specifying a choice between HTTP and HTTPS so
the <code class="literal">s3.client.${CLIENT_NAME}.protocol</code> setting is deprecated.
</li>
<li class="listitem">
AWS SDK v2 does not permit control over throttling for retries, so the
the <code class="literal">s3.client.${CLIENT_NAME}.use_throttle_retries</code> setting is deprecated
and no longer has any effect.
</li>
<li class="listitem">
AWS SDK v2 requires the use of the V4 signature algorithm, so the
<code class="literal">s3.client.${CLIENT_NAME}.signer_override</code> setting is deprecated and no
longer has any effect.
</li>
<li class="listitem">
AWS SDK v2 does not support the <code class="literal">log-delivery-write</code> canned ACL.
</li>
<li class="listitem">
AWS SDK v2 counts 4xx responses differently in its metrics reporting.
</li>
<li class="listitem">
AWS SDK v2 always uses the regional STS endpoint, whereas AWS SDK v2
could use either a regional endpoint or the global
<code class="literal">https://sts.amazonaws.com</code> one.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Impact</strong></span><br>
If you use the <code class="literal">repository-s3</code> module, test your upgrade thoroughly before upgrading any production workloads.
Adapt your configuration to the new SDK functionality. This includes, but may not be limited to, the following items.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Specify the correct signing region using the
<code class="literal">s3.client.${CLIENT_NAME}.region</code> setting on each node. Elasticsearch will try and
determine the correct region based on the endpoint URL and other data
drawn from the operating environment but cannot guarantee to do so
correctly in all cases.
</li>
<li class="listitem">
If you use IMDS to determine the availability zone of a node or to obtain
credentials for accessing the EC2 API, ensure that it supports the IMDSv2
protocol.
</li>
<li class="listitem">
If applicable, discontinue use of the
<code class="literal">com.amazonaws.sdk.ec2MetadataServiceEndpointOverride</code> system property.
</li>
<li class="listitem">
If applicable, specify the protocol to use to access the S3 API by
setting <code class="literal">s3.client.${CLIENT_NAME}.endpoint</code> to a URL which starts with
<code class="literal">http://</code> or <code class="literal">https://</code>.
</li>
<li class="listitem">
If applicable, discontinue use of the <code class="literal">log-delivery-write</code> canned ACL.
</li>
</ul>
</div>
</div>
</details>
<div class="position-relative"><h4><a id="breaking_819_es_ql_changes"></a>ES|QL changes</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.19/docs/reference/migration/migrate_8_19.asciidoc">edit</a></div>
<details id="allow_partial_results_by_default_in_es_ql">
<summary class="title">Allow partial results by default in ES|QL</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
In earlier versions of Elasticsearch, ES|QL would fail the entire query if it encountered any error. ES|QL now returns partial results instead of failing when encountering errors.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
Callers should check the <code class="literal">is_partial</code> flag returned in the response to determine if the result is partial or complete. If returning partial results is not desired, this option can be overridden per request via an <code class="literal">allow_partial_results</code> parameter in the query URL or globally via the cluster setting <code class="literal">esql.query.allow_partial_results</code>.</p>
</div>
</details>
<details id="cluster_setting_skip_unavailable_catches_all_runtime_errors">
<summary class="title">Cluster setting "skip_unavailable" catches all runtime errors</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
If <code class="literal">skip_unavailable</code> is set to <code class="literal">true</code>, the runtime errors from this cluster do not lead to a failure of the query. Instead, the cluster is set to <code class="literal">skipped</code> or <code class="literal">partial</code> status, and the query execution continues. This is a breaking change from previous versions, where <code class="literal">skip_unavailable</code> only applied to errors related to a cluster being unavailable.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
The errors on remote clusters, e.g. missing indices, will not lead to a failure of the query. Instead, the cluster is set to <code class="literal">skipped</code> or <code class="literal">partial</code> status in the response metadata.</p>
</div>
</details>
<details id="disallow_mixed_quoted_unquoted_patterns_in_from">
<summary class="title">Disallow mixed quoted/unquoted patterns in FROM</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
Previously, the ES|QL grammar allowed users to individually quote constituent strings in index patterns such as "remote_cluster":"index_name". This would allow users to write complex malformed index patterns that often slip through grammar and the subsequent validation. This could result in runtime errors that can be misleading. This change simplifies the grammar to early reject such malformed index patterns at the parsing stage, allowing users to write simpler queries and see more relevant and meaningful errors.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
Users can write queries with simpler index patterns and see more meaningful and relevant errors.</p>
</div>
</details>
<details id="unquoted_index_patterns_do_not_allow_characters">
<summary class="title">Unquoted index patterns do not allow <code class="literal">(</code> and <code class="literal">)</code> characters</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
Previously, ES|QL accepted unquoted index patterns containing brackets, such as <code class="literal">FROM index(1) | ENRICH policy(2)</code>.
This query syntax is no longer valid because it could conflict with subquery syntax, where brackets are used as delimiters.
Brackets are now only allowed in quoted index patterns. For example: <code class="literal">FROM "index(1)" | ENRICH "policy(2)"</code>.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
This affects existing queries containing brackets in index or policy names, i.e. in FROM, ENRICH, and LOOKUP JOIN commands.</p>
</div>
</details>
<div class="position-relative"><h3><a id="deprecated-8.19"></a>Deprecations</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.19/docs/reference/migration/migrate_8_19.asciidoc">edit</a></div>
<p>The following functionality has been deprecated in Elasticsearch 8.19
and will be removed in a future version.
While this won&#8217;t have an immediate impact on your applications,
we strongly encourage you to take the described steps to update your code
after upgrading to 8.19.</p>
<p>To find out if you are using any deprecated functionality,
enable <a class="xref" href="logging.html#deprecation-logging" title="Deprecation logging">deprecation logging</a>.</p>
<div class="position-relative"><h4><a id="deprecations_819_ingest"></a>Ingest deprecations</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.19/docs/reference/migration/migrate_8_19.asciidoc">edit</a></div>
<details id="deprecate_indices_merge_scheduler_use_thread_pool_setting">
<summary class="title">Deprecate <code class="literal">indices.merge.scheduler.use_thread_pool</code> setting</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
This deprecates the <code class="literal">indices.merge.scheduler.use_thread_pool</code> node setting that was introduced in</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
There should be no impact to users since the setting was not released before its deprecation here (and is not documented).</p>
</div>
</details>
<div class="position-relative"><h4><a id="deprecations_819_rest_api"></a>REST API deprecations</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.19/docs/reference/migration/migrate_8_19.asciidoc">edit</a></div>
<details id="deprecate_ability_to_connect_to_nodes_of_versions_8_18_earlier">
<summary class="title">Deprecate ability to connect to nodes of versions 8.18 and earlier</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
Versions 9.1.0 and later of Elasticsearch will not support communication with nodes of versions earlier than 8.19.0, so the ability to connect to nodes of earlier versions is deprecated in this version. This applies both to communication within a cluster and communication across clusters (e.g. for <a class="xref" href="modules-cross-cluster-search.html" title="Search across clusters">cross-cluster search</a> or <a class="xref" href="xpack-ccr.html" title="Cross-cluster replication">cross-cluster replication</a>).
Elasticsearch will report in its <a class="xref" href="logging.html#deprecation-logging" title="Deprecation logging">deprecation logging</a> each time it opens a connection to a node that will not be supported from version 9.1.0 onwards. You must upgrade all your clusters to version 8.19.0 or later before upgrading any of your clusters to 9.1.0 or later.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
Upgrade all of your clusters to at least 8.19.0 before upgrading any of them to 9.1.0 or later.</p>
</div>
</details>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="breaking-changes.html">« Migration guide</a>
</span>
<span class="next">
<a href="migrating-8.18.html">Migrating to 8.18 »</a>
</span>
</div>
</body>
</html>
