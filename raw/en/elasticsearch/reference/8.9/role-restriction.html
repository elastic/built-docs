<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Role restriction | Elasticsearch Guide [8.9] | Elastic</title>
<meta class="elastic" name="content" content="Role restriction | Elasticsearch Guide [8.9]">

<link rel="home" href="index.html" title="Elasticsearch Guide [8.9]"/>
<link rel="up" href="authorization.html" title="User authorization"/>
<link rel="prev" href="defining-roles.html" title="Defining roles"/>
<link rel="next" href="security-privileges.html" title="Security privileges"/>
<meta class="elastic" name="product_version" content="8.9"/>
<meta class="elastic" name="product_name" content="Elasticsearch"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/8.9"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="8.9"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body><div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elasticsearch Guide [8.9]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="secure-cluster.html">Secure the Elastic Stack</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="authorization.html">User authorization</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="defining-roles.html">« Defining roles</a>
</span>
<span class="next">
<a href="security-privileges.html">Security privileges »</a>
</span>
</div>
<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="role-restriction"></a>Role restriction<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.9/x-pack/docs/en/security/authorization/role-restriction.asciidoc">edit</a></h2>
</div></div></div>
<p>Role restriction can be used to specify conditions under which a role should be effective.
When conditions are not met, the role will be disabled, which will result in access being denied.
Not specifying restriction means the role is not restricted and thus always effective.
This is the default behaviour.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Currently, the role restriction is only supported for <a class="xref" href="security-api-create-api-key.html" title="Create API key API">API keys</a>,
with limitation that the API key can only have a single role descriptor.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="workflows-restriction"></a>Workflows<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.9/x-pack/docs/en/security/authorization/role-restriction.asciidoc">edit</a></h3>
</div></div></div>
<p>Workflows allow to restrict the role to be effective exclusively when calling certain REST APIs.
Calling a REST API that is not allowed by a workflow, will result in the role being disabled.
The below section lists workflows that you can restrict the role to:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">search_application_query</code>
</span>
</dt>
<dd>
This workflow restricts the role to the <a class="xref" href="search-application-search.html" title="Search Application Search">Search Application Search API</a> only.
</dd>
</dl>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Workflow names are case-sensitive.</p>
</div>
</div>
<h4><a id="_examples_3"></a>Examples<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.9/x-pack/docs/en/security/authorization/role-restriction.asciidoc">edit</a></h4>
<p>The following example creates an API key with a <a class="xref" href="role-restriction.html" title="Role restriction">restriction</a> to the <code class="literal">search_application_query</code> workflow,
which allows to call only <a class="xref" href="search-application-search.html" title="Search Application Search">Search Application Search API</a>:</p>
<a id="1b076ceb1ead9f6897c2f351f0e45f74"></a>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_security/api_key
{
  "name": "my-restricted-api-key",
  "role_descriptors": {
    "my-restricted-role-descriptor": {
      "indices": [
        {
          "names": ["my-search-app"],
          "privileges": ["read"]
        }
      ],
      "restriction":  {
        "workflows": ["search_application_query"]
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/1805.console"></div>
</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="defining-roles.html">« Defining roles</a>
</span>
<span class="next">
<a href="security-privileges.html">Security privileges »</a>
</span>
</div>
</div>
</body>
</html>
