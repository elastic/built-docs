<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Create index from source API | Elasticsearch Guide [8.x] | Elastic</title>
<meta class="elastic" name="content" content="Create index from source API | Elasticsearch Guide [8.x]">

<link rel="home" href="index.html" title="Elasticsearch Guide [8.x]"/>
<link rel="up" href="migration-api.html" title="Migration APIs"/>
<link rel="prev" href="data-stream-reindex-cancel-api.html" title="Reindex data stream cancel API"/>
<link rel="next" href="node-lifecycle-api.html" title="Node lifecycle APIs"/>
<meta class="elastic" name="product_version" content="8.x"/>
<meta class="elastic" name="product_name" content="Elasticsearch"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/8.x"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="8.x"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
This documentation contains work-in-progress information for future Elastic Stack and Cloud releases. Use the version selector to view supported release docs. It also contains some Elastic Cloud serverless information. Check out our <a href="https://www.elastic.co/docs/current/serverless">serverless docs</a> for more details.
</div>
<div class="navheader">
<span class="prev">
<a href="data-stream-reindex-cancel-api.html">« Reindex data stream cancel API</a>
</span>
<span class="next">
<a href="node-lifecycle-api.html">Node lifecycle APIs »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elasticsearch Guide [8.x]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="rest-apis.html">REST APIs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="migration-api.html">Migration APIs</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Create index from source API</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.x/docs/reference/migration/apis/create-index-from-source.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div id="url-to-v3" class="version-warning">
    <strong>IMPORTANT</strong>: This documentation is no longer updated. Refer to <a href="https://www.elastic.co/support/eol">Elastic's version policy</a> and the <a href="https://www.elastic.co/docs">latest documentation</a>.
</div>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="indices-create-index-from-source"></a>Create index from source API</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.x/docs/reference/migration/apis/create-index-from-source.asciidoc">edit</a></div>
</div></div></div>

<div class="sidebar">
<div class="titlepage"><div><div>
<p class="title"><strong>New API reference</strong></p>
</div></div></div>
<p>For the most up-to-date API details, refer to <a href="/docs/api/doc/elasticsearch/v8/group/endpoint-indices" class="ulink" target="_top">Index APIs</a>.</p>
</div>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="indices-create-index-from-source-api-request"></a>Request</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.x/docs/reference/migration/apis/create-index-from-source.asciidoc">edit</a></div>
</div></div></div>
<p><code class="literal">PUT /_create_from/&lt;source&gt;/&lt;dest&gt;</code></p>
<p><code class="literal">POST/_create_from/&lt;source&gt;/&lt;dest&gt;</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="indices-create-index-from-source-api-prereqs"></a>Prerequisites</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.x/docs/reference/migration/apis/create-index-from-source.asciidoc">edit</a></div>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If the Elasticsearch security features are enabled, you must have the <code class="literal">manage</code>
<a class="xref" href="security-privileges.html#privileges-list-indices" title="Indices privileges">index privilege</a> for the index.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="indices-create-index-from-source-api-desc"></a>Description</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.x/docs/reference/migration/apis/create-index-from-source.asciidoc">edit</a></div>
</div></div></div>
<p>This api allows you to add a new index to an Elasticsearch cluster, using an existing source index as a basis for the new index.
The settings and mappings from the source index will copied over to the destination index.  You can also provide
override settings and mappings which will be combined with the source settings and mappings when creating the
destination index.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="indices-create-index-from-source-api-path-params"></a>Path parameters</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.x/docs/reference/migration/apis/create-index-from-source.asciidoc">edit</a></div>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;source&gt;</code>
</span>
</dt>
<dd>
(Required, string) Name of the existing source index which will be used as a basis.
</dd>
<dt>
<span class="term">
<code class="literal">&lt;dest&gt;</code>
</span>
</dt>
<dd>
(Required, string) Name of the destination index which will be created.
</dd>
</dl>
</div>
</div>

<div class="section child_attributes">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="indices-create-index-from-source-api-request-body"></a>Request body</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.x/docs/reference/migration/apis/create-index-from-source.asciidoc">edit</a></div>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">settings_override</code>
</span>
</dt>
<dd>
(Optional, <a class="xref" href="index-modules.html#index-modules-settings" title="Index settings">index setting object</a>) Settings which override the source settings.
</dd>
<dt>
<span class="term">
<code class="literal">mappings_override</code>
</span>
</dt>
<dd>
(Optional, <a class="xref" href="mapping.html" title="Mapping">mapping object</a>) Mappings which override the source mappings.
</dd>
<dt>
<span class="term">
<code class="literal">remove_index_blocks</code>
</span>
</dt>
<dd>
(Optional, boolean) Filter out any index blocks from the source index when creating the destination index.
Defaults to <code class="literal">true</code>.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="indices-create-index-from-source-api-example"></a>Examples</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.x/docs/reference/migration/apis/create-index-from-source.asciidoc">edit</a></div>
</div></div></div>
<p>Start by creating a source index that we&#8217;ll copy using this API.</p>
<div class="pre_wrapper lang-python alternative">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-python alternative">resp = client.indices.create(
    index="my-index",
    settings={
        "index": {
            "number_of_shards": 3,
            "blocks.write": True
        }
    },
    mappings={
        "properties": {
            "field1": {
                "type": "text"
            }
        }
    },
)
print(resp)</pre>
</div>
<div class="pre_wrapper lang-js alternative">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js alternative">const response = await client.indices.create({
  index: "my-index",
  settings: {
    index: {
      number_of_shards: 3,
      "blocks.write": true,
    },
  },
  mappings: {
    properties: {
      field1: {
        type: "text",
      },
    },
  },
});
console.log(response);</pre>
</div>
<a id="3722dad876023e0757138dd5a6d3240e"></a>
<div class="pre_wrapper lang-console default has-python has-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console default has-python has-js">PUT /my-index
{
  "settings": {
    "index": {
      "number_of_shards": 3,
      "blocks.write": true
    }
  },
  "mappings": {
    "properties": {
        "field1": { "type": "text" }
    }
  }
}</pre>
</div>
<div class="console_widget has-python has-js" data-snippet="snippets/3134.console"></div>
<p>Now we create a destination index from the source index. This new index will have the same mappings and settings
as the source index.</p>
<div class="pre_wrapper lang-python alternative">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-python alternative">resp = client.indices.create_from(
    source="my-index",
    dest="my-new-index",
    create_from=None,
)
print(resp)</pre>
</div>
<div class="pre_wrapper lang-js alternative">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js alternative">const response = await client.indices.createFrom({
  source: "my-index",
  dest: "my-new-index",
  create_from: null,
});
console.log(response);</pre>
</div>
<a id="66915e95b723ee2f6e5164a94b8f98c1"></a>
<div class="pre_wrapper lang-console default has-python has-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console default has-python has-js">POST _create_from/my-index/my-new-index</pre>
</div>
<div class="console_widget has-python has-js" data-snippet="snippets/3135.console"></div>
<p>Alternatively, we could override some of the source&#8217;s settings and mappings. This will use the source settings
and mappings as a basis and combine these with the overrides to create the destination settings and mappings.</p>
<div class="pre_wrapper lang-python alternative">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-python alternative">resp = client.indices.create_from(
    source="my-index",
    dest="my-new-index",
    create_from={
        "settings_override": {
            "index": {
                "number_of_shards": 5
            }
        },
        "mappings_override": {
            "properties": {
                "field2": {
                    "type": "boolean"
                }
            }
        }
    },
)
print(resp)</pre>
</div>
<div class="pre_wrapper lang-js alternative">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js alternative">const response = await client.indices.createFrom({
  source: "my-index",
  dest: "my-new-index",
  create_from: {
    settings_override: {
      index: {
        number_of_shards: 5,
      },
    },
    mappings_override: {
      properties: {
        field2: {
          type: "boolean",
        },
      },
    },
  },
});
console.log(response);</pre>
</div>
<a id="13d91782399ba1f291e103c18b5338cc"></a>
<div class="pre_wrapper lang-console default has-python has-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console default has-python has-js">POST _create_from/my-index/my-new-index
{
  "settings_override": {
    "index": {
      "number_of_shards": 5
    }
  },
  "mappings_override": {
    "properties": {
        "field2": { "type": "boolean" }
    }
  }
}</pre>
</div>
<div class="console_widget has-python has-js" data-snippet="snippets/3136.console"></div>
<p>Since the destination index is empty, we very likely will want to write into the index after creation.
This would not be possible if the source index contains an <a class="xref" href="index-modules-blocks.html#index-block-settings" title="Index block settings">index write block</a> which is copied over to the destination index.
One way to handle this is to remove the index write block using a settings override. For example, the following
settings override removes all index blocks.</p>
<div class="pre_wrapper lang-python alternative">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-python alternative">resp = client.indices.create_from(
    source="my-index",
    dest="my-new-index",
    create_from={
        "settings_override": {
            "index": {
                "blocks.write": None,
                "blocks.read": None,
                "blocks.read_only": None,
                "blocks.read_only_allow_delete": None,
                "blocks.metadata": None
            }
        }
    },
)
print(resp)</pre>
</div>
<div class="pre_wrapper lang-js alternative">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js alternative">const response = await client.indices.createFrom({
  source: "my-index",
  dest: "my-new-index",
  create_from: {
    settings_override: {
      index: {
        "blocks.write": null,
        "blocks.read": null,
        "blocks.read_only": null,
        "blocks.read_only_allow_delete": null,
        "blocks.metadata": null,
      },
    },
  },
});
console.log(response);</pre>
</div>
<a id="2f9ee29fe49f7d206a41212aa5945296"></a>
<div class="pre_wrapper lang-console default has-python has-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console default has-python has-js">POST _create_from/my-index/my-new-index
{
  "settings_override": {
    "index": {
      "blocks.write": null,
      "blocks.read": null,
      "blocks.read_only": null,
      "blocks.read_only_allow_delete": null,
      "blocks.metadata": null
    }
  }
}</pre>
</div>
<div class="console_widget has-python has-js" data-snippet="snippets/3137.console"></div>
<p>Since this is a common scenario, index blocks are actually removed by default. This is controlled with the parameter
<code class="literal">remove_index_blocks</code>, which defaults to <code class="literal">true</code>. If we want the destination index to contains the index blocks from
the source index, we can do the following:</p>
<div class="pre_wrapper lang-python alternative">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-python alternative">resp = client.indices.create_from(
    source="my-index",
    dest="my-new-index",
    create_from={
        "remove_index_blocks": False
    },
)
print(resp)</pre>
</div>
<div class="pre_wrapper lang-js alternative">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js alternative">const response = await client.indices.createFrom({
  source: "my-index",
  dest: "my-new-index",
  create_from: {
    remove_index_blocks: false,
  },
});
console.log(response);</pre>
</div>
<a id="dde92fdf3469349ffe2c81764333543a"></a>
<div class="pre_wrapper lang-console default has-python has-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console default has-python has-js">POST _create_from/my-index/my-new-index
{
  "remove_index_blocks": false
}</pre>
</div>
<div class="console_widget has-python has-js" data-snippet="snippets/3138.console"></div>
</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="data-stream-reindex-cancel-api.html">« Reindex data stream cancel API</a>
</span>
<span class="next">
<a href="node-lifecycle-api.html">Node lifecycle APIs »</a>
</span>
</div>
</body>
</html>
