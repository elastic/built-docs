<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="keywords" content="Elasticsearch diagnostic, diagnostics">
<title>Migrating to 8.16 | Elasticsearch Guide [8.x] | Elastic</title>
<meta class="elastic" name="content" content="Migrating to 8.16 | Elasticsearch Guide [8.x]">

<link rel="home" href="index.html" title="Elasticsearch Guide [8.x]"/>
<link rel="up" href="breaking-changes.html" title="Migration guide"/>
<link rel="prev" href="migrating-8.17.html" title="Migrating to 8.17"/>
<link rel="next" href="migrating-8.15.html" title="Migrating to 8.15"/>
<meta class="elastic" name="product_version" content="8.x"/>
<meta class="elastic" name="product_name" content="Elasticsearch"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/8.x"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="8.x"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
This documentation contains work-in-progress information for future Elastic Stack and Cloud releases. Use the version selector to view supported release docs. It also contains some Elastic Cloud serverless information. Check out our <a href="https://www.elastic.co/docs/current/serverless">serverless docs</a> for more details.
</div>
<div class="navheader">
<span class="prev">
<a href="migrating-8.17.html">« Migrating to 8.17</a>
</span>
<span class="next">
<a href="migrating-8.15.html">Migrating to 8.15 »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elasticsearch Guide [8.x]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="breaking-changes.html">Migration guide</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Migrating to 8.16</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.x/docs/reference/migration/migrate_8_16.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="chapter">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="migrating-8.16"></a>Migrating to 8.16</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.x/docs/reference/migration/migrate_8_16.asciidoc">edit</a></div>
</div></div></div>

<p>This section discusses the changes that you need to be aware of when migrating
your application to Elasticsearch 8.16.</p>
<p>See also <a class="xref" href="release-highlights.html" title="What&#8217;s new in 8.17"><em>What&#8217;s new in 8.17</em></a> and <a class="xref" href="es-release-notes.html" title="Release notes">Release notes</a>.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Coming in 8.16.0.</p>
</div>
</div>
<div class="position-relative"><h3><a id="breaking-changes-8.16"></a>Breaking changes</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.x/docs/reference/migration/migrate_8_16.asciidoc">edit</a></div>
<p>The following changes in Elasticsearch 8.16 might affect your applications
and prevent them from operating normally.
Before upgrading to 8.16, review these changes and take the described steps
to mitigate the impact.</p>
<div class="position-relative"><h4><a id="breaking_816_analysis_changes"></a>Analysis changes</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.x/docs/reference/migration/migrate_8_16.asciidoc">edit</a></div>
<details id="set_lenient_to_true_by_default_when_using_updateable_synonyms">
<summary class="title">Set lenient to true by default when using updateable synonyms</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
When a <code class="literal">synonym</code> or <code class="literal">synonym_graph</code> token filter is configured with <code class="literal">updateable: true</code>, the default <code class="literal">lenient</code>
value will now be <code class="literal">true</code>.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
<code class="literal">synonym</code> or <code class="literal">synonym_graph</code> token filters configured with <code class="literal">updateable: true</code> will ignore invalid synonyms by
default. This prevents shard initialization errors on invalid synonyms.</p>
</div>
</details>
<div class="position-relative"><h4><a id="breaking_816_mapping_changes"></a>Mapping changes</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.x/docs/reference/migration/migrate_8_16.asciidoc">edit</a></div>
<details id="jdk_locale_database_change">
<summary class="title">JDK locale database change</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
Elasticsearch 8.16 changes the version of the JDK that is included from version 22 to version 23. This changes the locale database that is used by Elasticsearch from the COMPAT database to the CLDR database. This change can cause significant differences to the textual date formats accepted by Elasticsearch, and to calculated week-dates.</p>
<p>If you run Elasticsearch 8.16 on JDK version 22 or below, it will use the COMPAT locale database to match the behavior of 8.15. However, starting with Elasticsearch 9.0, Elasticsearch will use the CLDR database regardless of JDK version it is run on.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
This affects you if you use custom date formats using textual or week-date field specifiers. If you use date fields or calculated week-dates that change between the COMPAT and CLDR databases, then this change will cause Elasticsearch to reject previously valid date fields as invalid data. You might need to modify your ingest or output integration code to account for the differences between these two JDK versions.</p>
<p>Starting in version 8.15.2, Elasticsearch will log deprecation warnings if you are using date format specifiers that might change on upgrading to JDK 23. These warnings are visible in Kibana.</p>
<p>For detailed guidance, refer to <a class="xref" href="mapping-date-format.html#custom-date-format-locales" title="Differences in locale information between JDK versions">Differences in locale information between JDK versions</a> and the <a href="https://ela.st/jdk-23-locales" class="ulink" target="_top">Elastic blog</a>.</p>
</div>
</details>
<div class="position-relative"><h4><a id="breaking_816_es_ql_changes"></a>ES|QL changes</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.x/docs/reference/migration/migrate_8_16.asciidoc">edit</a></div>
<details id="esql_entirely_remove_meta_functions">
<summary class="title">ESQL: Entirely remove META FUNCTIONS</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
Removes an undocumented syntax from ESQL: META FUNCTION. This was never
reliable or really useful. Consult the documentation instead.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
Removes an undocumented syntax from ESQL: META FUNCTION</p>
</div>
</details>
<div class="position-relative"><h4><a id="breaking_816_rest_api_changes"></a>REST API changes</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.x/docs/reference/migration/migrate_8_16.asciidoc">edit</a></div>
<details id="reworking_rrf_retriever_to_be_evaluated_during_rewrite_phase">
<summary class="title">Reworking RRF retriever to be evaluated during rewrite phase</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
In this release (8.16), we have introduced major changes to the retrievers framework
and how they can be evaluated, focusing mainly on compound retrievers
like <code class="literal">rrf</code> and <code class="literal">text_similarity_reranker</code>, which allowed us to support full
composability (i.e. any retriever can be nested under any compound retriever),
as well as supporting additional search features like collapsing, explaining,
aggregations, and highlighting.</p>
<p>To ensure consistency, and given that this rework is not available until 8.16,
<code class="literal">rrf</code> and <code class="literal">text_similarity_reranker</code>  retriever queries would now
throw an exception in a mixed cluster scenario, where there are nodes
both in current or later (i.e. &gt;= 8.16) and previous ( &#8656; 8.15) versions.</p>
<p>As part of the rework, we have also removed the <code class="literal">_rank</code> property from
the responses of an <code class="literal">rrf</code> retriever.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
- Users will not be able to use the <code class="literal">rrf</code> and <code class="literal">text_similarity_reranker</code> retrievers in a mixed cluster scenario
with previous releases (i.e. prior to 8.16), and the request will throw an <code class="literal">IllegalArgumentException</code>.
- <code class="literal">_rank</code> has now been removed from the output of the <code class="literal">rrf</code> retrievers so trying to directly parse the field
will throw an exception</p>
</div>
</details>
<details id="update_data_stream_lifecycle_telemetry_to_track_global_retention">
<summary class="title">Update data stream lifecycle telemetry to track global retention</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
In this release we introduced global retention settings that fulfil the following criteria:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
a data stream managed by the data stream lifecycle,
</li>
<li class="listitem">
a data stream that is not an internal data stream.
</li>
</ul>
</div>
<p>As a result, we defined different types of retention:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>data retention</strong></span>: the retention configured on data stream level by the data stream user or owner
</li>
<li class="listitem">
<span class="strong strong"><strong>default global retention:</strong></span> the retention configured by an admin on a cluster level and applied to any
data stream that doesn&#8217;t have data retention and fulfils the criteria.
</li>
<li class="listitem">
<span class="strong strong"><strong>max global retention:</strong></span> the retention configured by an admin to guard against having long retention periods.
Any data stream that fulfills the criteria will adhere to the data retention unless it exceeds the max retention,
in which case the max global retention applies.
</li>
<li class="listitem">
<span class="strong strong"><strong>effective retention:</strong></span> the retention that applies on the data stream that fulfill the criteria at a given moment
in time. It takes into consideration all the retention above and resolves it to the retention that will take effect.
</li>
</ul>
</div>
<p>Considering the above changes, having a field named <code class="literal">retention</code> in the usage API was confusing. For this reason, we
renamed it to <code class="literal">data_retention</code> and added telemetry about the other configurations too.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
Users that use the field <code class="literal">data_lifecycle.retention</code> should use the <code class="literal">data_lifecycle.data_retention</code></p>
</div>
</details>
<div class="position-relative"><h3><a id="deprecated-8.16"></a>Deprecations</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.x/docs/reference/migration/migrate_8_16.asciidoc">edit</a></div>
<p>The following functionality has been deprecated in Elasticsearch 8.16
and will be removed in a future version.
While this won&#8217;t have an immediate impact on your applications,
we strongly encourage you to take the described steps to update your code
after upgrading to 8.16.</p>
<p>To find out if you are using any deprecated functionality,
enable <a class="xref" href="logging.html#deprecation-logging" title="Deprecation logging">deprecation logging</a>.</p>
<div class="position-relative"><h4><a id="deprecations_816_analysis"></a>Analysis deprecations</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.x/docs/reference/migration/migrate_8_16.asciidoc">edit</a></div>
<details id="deprecate_dutch_kp_lovins_stemmer_as_they_are_removed_in_lucene_10">
<summary class="title">Deprecate dutch_kp and lovins stemmer as they are removed in Lucene 10</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
kp, dutch_kp, dutchKp and lovins stemmers are deprecated and will be removed.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
These stemmers will be removed and will be no longer supported.</p>
</div>
</details>
<details id="deprecate_edge_ngram_side_parameter">
<summary class="title">deprecate <code class="literal">edge_ngram</code> side parameter</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
edge_ngram will no longer accept the side parameter.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
Users will need to update any usage of edge_ngram token filter that utilizes <code class="literal">side</code>. If the <code class="literal">back</code> value was used, they can achieve the same behavior by using the <code class="literal">reverse</code> token filter.</p>
</div>
</details>
<div class="position-relative"><h4><a id="deprecations_816_crud"></a>CRUD deprecations</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.x/docs/reference/migration/migrate_8_16.asciidoc">edit</a></div>
<details id="deprecate_dot_prefixed_indices_composable_template_index_patterns">
<summary class="title">Deprecate dot-prefixed indices and composable template index patterns</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
Indices beginning with a dot <em>.</em> are reserved for system and internal indices, and should not be used by and end-user. Additionally, composable index templates that contain patterns for dot-prefixed indices should also be avoided, as these patterns are meant for internal use only. In a future Elasticsearch version, creation of these dot-prefixed indices will no longer be allowed.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
Requests performing an action that would create an index beginning with a dot (indexing a document, manual creation, reindex), or creating an index template with index patterns beginning with a dot, will contain a deprecation header warning about dot-prefixed indices in the response.</p>
</div>
</details>
<div class="position-relative"><h4><a id="deprecations_816_rest_api"></a>REST API deprecations</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/8.x/docs/reference/migration/migrate_8_16.asciidoc">edit</a></div>
<details id="adding_deprecation_warnings_for_rrf_using_rank_sub_searches">
<summary class="title">Adding deprecation warnings for rrf using rank and <code class="literal">sub_searches</code></summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
Search API parameter <code class="literal">sub_searches</code> will no longer be a supported and will be removed in future releases. Similarly, <code class="literal">rrf</code> can only be used through the specified <code class="literal">retriever</code> and no longer though the <code class="literal">rank</code> parameter</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
Requests specifying rrf through <code class="literal">rank</code> and/or <code class="literal">sub_searches</code> elements will be disallowed in a future version. Users should instead utilize the new <code class="literal">retriever</code> parameter.</p>
</div>
</details>
<details id="deprecate_legacy_params_from_range_query">
<summary class="title">Deprecate legacy params from range query</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
Range query will not longer accept <code class="literal">to</code>, <code class="literal">from</code>, <code class="literal">include_lower</code>, and <code class="literal">include_upper</code> parameters.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
Instead use <code class="literal">gt</code>, <code class="literal">gte</code>, <code class="literal">lt</code> and <code class="literal">lte</code> parameters.</p>
</div>
</details>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="migrating-8.17.html">« Migrating to 8.17</a>
</span>
<span class="next">
<a href="migrating-8.15.html">Migrating to 8.15 »</a>
</span>
</div>
</body>
</html>
