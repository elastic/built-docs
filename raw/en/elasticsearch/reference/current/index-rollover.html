<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Rollover | Elasticsearch Guide [8.15] | Elastic</title>
<meta class="elastic" name="content" content="Rollover | Elasticsearch Guide [8.15]">

<link rel="home" href="index.html" title="Elasticsearch Guide [8.15]"/>
<link rel="up" href="ilm-concepts.html" title="ILM concepts"/>
<link rel="prev" href="ilm-index-lifecycle.html" title="Index lifecycle"/>
<link rel="next" href="update-lifecycle-policy.html" title="Lifecycle policy updates"/>
<meta class="elastic" name="product_version" content="8.15"/>
<meta class="elastic" name="product_name" content="Elasticsearch"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/8.15"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="8.15"/>
</head>
<body>
<div class="navheader">
<span class="prev">
<a href="ilm-index-lifecycle.html">« Index lifecycle</a>
</span>
<span class="next">
<a href="update-lifecycle-policy.html">Lifecycle policy updates »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elasticsearch Guide [8.15]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="data-management.html">Data management</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="ilm-concepts.html">ILM concepts</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Rollover</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/ilm/index-rollover.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="index-rollover"></a>Rollover<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/ilm/index-rollover.asciidoc">edit</a></h2>
</div></div></div>
<p>When indexing time series data like logs or metrics, you can&#8217;t write to a single index indefinitely.
To meet your indexing and search performance requirements and manage resource usage,
you write to an index until some threshold is met and then create a new index and start writing to it instead.
Using rolling indices enables you to:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Optimize the active index for high ingest rates on high-performance <em>hot</em> nodes.
</li>
<li class="listitem">
Optimize for search performance on <em>warm</em> nodes.
</li>
<li class="listitem">
Shift older, less frequently accessed data to less expensive <em>cold</em> nodes,
</li>
<li class="listitem">
Delete data according to your retention policies by removing entire indices.
</li>
</ul>
</div>
<p>We recommend using <a class="xref" href="indices-create-data-stream.html" title="Create data stream API">data streams</a> to manage time series
data. Data streams automatically track the write index while keeping configuration to a minimum.</p>
<p>Each data stream requires an <a class="xref" href="index-templates.html" title="Index templates">index template</a> that contains:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
A name or wildcard (<code class="literal">*</code>) pattern for the data stream.
</li>
<li class="listitem">
The data stream&#8217;s timestamp field. This field must be mapped as a
<a class="xref" href="date.html" title="Date field type"><code class="literal">date</code></a> or <a class="xref" href="date_nanos.html" title="Date nanoseconds field type"><code class="literal">date_nanos</code></a> field data type and must be
included in every document indexed to the data stream.
</li>
<li class="listitem">
The mappings and settings applied to each backing index when it&#8217;s created.
</li>
</ul>
</div>
<p>Data streams are designed for append-only data, where the data stream name
can be used as the operations (read, write, rollover, shrink etc.) target.
If your use case requires data to be updated in place, you can instead manage
your time series data using <a class="xref" href="aliases.html" title="Aliases">index aliases</a>. However, there are a few
more configuration steps and concepts:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
An <em>index template</em> that specifies the settings for each new index in the series.
You optimize this configuration for ingestion, typically using as many shards as you have hot nodes.
</li>
<li class="listitem">
An <em>index alias</em> that references the entire set of indices.
</li>
<li class="listitem">
A single index designated as the <em>write index</em>.
This is the active index that handles all write requests.
On each rollover, the new index becomes the write index.
</li>
</ul>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>When an index is rolled over, the previous index&#8217;s age is updated to reflect the rollover time.
This date, rather than the index&#8217;s <code class="literal">creation_date</code>, is used in index lifecycle management
<code class="literal">min_age</code> phase calculations. <a class="xref" href="index-lifecycle-error-handling.html#min-age-calculation" title="How min_age is calculated">Learn more</a>.</p>
</div>
</div>
<h3><a id="ilm-automatic-rollover"></a>Automatic rollover<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.15/docs/reference/ilm/index-rollover.asciidoc">edit</a></h3>
<p>ILM and the data stream lifecycle (in <span class="Admonishment Admonishment--preview">
[<span class="Admonishment-title u-mono">preview</span>]
<span class="Admonishment-detail">
This functionality is in technical preview and may be changed or removed in a future release. Elastic will work to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.
</span>
</span>]) enable you to automatically roll over to a new index based
on conditions like the index size, document count, or age. When a rollover is triggered, a new
index is created, the write alias is updated to point to the new index, and all
subsequent updates are written to the new index.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>Rolling over to a new index based on size, document count, or age is preferable
to time-based rollovers. Rolling over at an arbitrary time often results in
many small indices, which can have a negative impact on performance and
resource usage.</p>
</div>
</div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Empty indices will not be rolled over, even if they have an associated <code class="literal">max_age</code> that
would otherwise result in a roll over occurring. A policy can override this behavior, and explicitly
opt in to rolling over empty indices, by adding a <code class="literal">"min_docs": 0</code> condition. This can also be
disabled on a cluster-wide basis by setting <code class="literal">indices.lifecycle.rollover.only_if_has_documents</code> to
<code class="literal">false</code>.</p>
</div>
</div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>The rollover action implicitly always rolls over a data stream or alias if one or more shards contain
200000000 or more documents. Normally a shard will reach 50GB long before it reaches 200M documents,
but this isn&#8217;t the case for space efficient data sets. Search performance will very likely suffer
if a shard contains more than 200M documents. This is the reason of the builtin limit.</p>
</div>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="ilm-index-lifecycle.html">« Index lifecycle</a>
</span>
<span class="next">
<a href="update-lifecycle-policy.html">Lifecycle policy updates »</a>
</span>
</div>
</body>
</html>
