<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="keywords" content="Elasticsearch diagnostic, diagnostics">
<title>Resolve cluster API | Elasticsearch Guide [8.14] | Elastic</title>
<meta class="elastic" name="content" content="Resolve cluster API | Elasticsearch Guide [8.14]">

<link rel="home" href="index.html" title="Elasticsearch Guide [8.14]"/>
<link rel="up" href="indices.html" title="Index APIs"/>
<link rel="prev" href="indices-resolve-index-api.html" title="Resolve index API"/>
<link rel="next" href="indices-rollover-index.html" title="Rollover API"/>
<meta class="elastic" name="product_version" content="8.14"/>
<meta class="elastic" name="product_name" content="Elasticsearch"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/8.14"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="8.14"/>
</head>
<body>
<div class="navheader">
<span class="prev">
<a href="indices-resolve-index-api.html">« Resolve index API</a>
</span>
<span class="next">
<a href="indices-rollover-index.html">Rollover API »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elasticsearch Guide [8.14]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="rest-apis.html">REST APIs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="indices.html">Index APIs</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Resolve cluster API</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.14/docs/reference/indices/resolve-cluster.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="indices-resolve-cluster-api"></a>Resolve cluster API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.14/docs/reference/indices/resolve-cluster.asciidoc">edit</a></h2>
</div></div></div>

<p>Resolves the specified index expressions to return information about
each cluster, including the local cluster, if included.</p>
<p>This endpoint is useful before doing a <a class="xref" href="modules-cross-cluster-search.html" title="Search across clusters">cross-cluster search</a> in
order to determine which remote clusters should be included in a search.</p>
<p>You use the same index expression with this endpoint as you would for cross-cluster
search. Index and <a class="xref" href="modules-cross-cluster-search.html#exclude-problematic-clusters" title="Excluding clusters or indices from a cross-cluster search">cluster exclusions</a> are also supported
with this endpoint.</p>
<p>For each cluster in the index expression, information is returned about:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
whether the querying ("local") cluster is currently connected to each remote cluster
in the index expression scope
</li>
<li class="listitem">
whether each remote cluster is configured with <code class="literal">skip_unavailable</code> as <code class="literal">true</code> or <code class="literal">false</code>
</li>
<li class="listitem">
whether there are any indices, aliases or data streams on that cluster that match
the index expression
</li>
<li class="listitem">
whether the search is likely to have errors returned when you do the cross-cluster search (including any
authorization errors if your user does not have permission to query the index)
</li>
<li class="listitem">
cluster version information, including the Elasticsearch server version
</li>
</ol>
</div>
<a id="43e86fbaeed068dcc981214338559b5a"></a>
<div class="pre_wrapper lang-console">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console">GET /_resolve/cluster/my-index-*,cluster*:my-index-*</pre>
</div>
<div class="console_widget" data-snippet="snippets/2718.console"></div>
<p>This will return information about the local cluster and all remotely configured
clusters that start with the alias <code class="literal">cluster*</code>. Each cluster will return information
about whether it has any indices, aliases or data streams that match <code class="literal">my-index-*</code>.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="resolve-cluster-api-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.14/docs/reference/indices/resolve-cluster.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">GET /_resolve/cluster/&lt;index_expression&gt;</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="resolve-cluster-api-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.14/docs/reference/indices/resolve-cluster.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If the Elasticsearch security features are enabled, you must have the
<code class="literal">view_index_metadata</code>, <code class="literal">read</code>, or <code class="literal">manage</code> <a class="xref" href="security-privileges.html#privileges-list-indices" title="Indices privileges">index
privilege</a> for the target data stream, index, or alias.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="resolve-cluster-api-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.14/docs/reference/indices/resolve-cluster.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;index_expression&gt;</code>
</span>
</dt>
<dd>
<p>(Required, string) Comma-separated name(s) or index pattern(s) of the
indices, aliases, and data streams to resolve, using <a class="xref" href="api-conventions.html#api-multi-index" title="Multi-target syntax">Multi-target syntax</a>.
Resources on <a class="xref" href="remote-clusters.html" title="Remote clusters">remote clusters</a> can be specified using the
<code class="literal">&lt;cluster&gt;:&lt;name&gt;</code> syntax.</p>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="resolve-cluster-api-query-params"></a>Query parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.14/docs/reference/indices/resolve-cluster.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">expand_wildcards</code>
</span>
</dt>
<dd>
<p>(Optional, string)
Type of index that wildcard patterns can match. If the request can target data
streams, this argument determines whether wildcard expressions match hidden data
streams. Supports comma-separated values, such as <code class="literal">open,hidden</code>. Valid values
are:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">all</code>
</span>
</dt>
<dd>
Match any data stream or index, including <a class="xref" href="api-conventions.html#multi-hidden" title="Hidden data streams and indices">hidden</a> ones.
</dd>
<dt>
<span class="term">
<code class="literal">open</code>
</span>
</dt>
<dd>
Match open, non-hidden indices. Also matches any non-hidden data stream.
</dd>
<dt>
<span class="term">
<code class="literal">closed</code>
</span>
</dt>
<dd>
Match closed, non-hidden indices. Also matches any non-hidden data stream. Data
streams cannot be closed.
</dd>
<dt>
<span class="term">
<code class="literal">hidden</code>
</span>
</dt>
<dd>
Match hidden data streams and hidden indices. Must be combined with <code class="literal">open</code>,
<code class="literal">closed</code>, or both.
</dd>
<dt>
<span class="term">
<code class="literal">none</code>
</span>
</dt>
<dd>
Wildcard patterns are not accepted.
</dd>
</dl>
</div>
<p>Defaults to <code class="literal">open</code>.</p>
</dd>
<dt>
<span class="term">
<code class="literal">ignore_unavailable</code>
</span>
</dt>
<dd>
<p>
(Optional, Boolean) If <code class="literal">false</code>, the request returns an error if it targets a
missing or closed index. Defaults to <code class="literal">false</code>.
</p>
<p>Defaults to <code class="literal">false</code>.</p>
</dd>
<dt>
<span class="term">
<code class="literal">allow_no_indices</code>
</span>
</dt>
<dd>
<p>
(Optional, Boolean)
If <code class="literal">false</code>, the request returns an error if any wildcard expression,
<a class="xref" href="aliases.html" title="Aliases">index alias</a>, or <code class="literal">_all</code> value targets only missing or closed indices.
This behavior applies even if the request targets other open indices. For
example, a request targeting <code class="literal">foo*,bar*</code> returns an error if an index starts
with <code class="literal">foo</code> but no index starts with <code class="literal">bar</code>.
</p>
<p>Defaults to <code class="literal">true</code>.</p>
</dd>
<dt>
<span class="term">
<code class="literal">ignore_throttled</code>
</span>
</dt>
<dd>
<p>
(Optional, Boolean) If <code class="literal">true</code>, concrete, expanded or aliased indices are
ignored when frozen. Defaults to <code class="literal">false</code>.
</p>
<p><span class="Admonishment Admonishment--change">
[<span class="Admonishment-version u-mono u-strikethrough">7.16.0</span>]
<span class="Admonishment-detail">
Deprecated in 7.16.0.
</span>
</span></p>
</dd>
</dl>
</div>
<h3><a id="usecases-for-resolve-cluster"></a>Advantages of using this endpoint before a cross-cluster search<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.14/docs/reference/indices/resolve-cluster.asciidoc">edit</a></h3>
<p>You may want to exclude a cluster or index from a search when:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
A remote cluster is not currently connected and is configured with <code class="literal">skip_unavailable</code>=<code class="literal">false</code>.
Executing a cross-cluster search under those conditions will cause
<a class="xref" href="modules-cross-cluster-search.html#cross-cluster-search-failures" title="Cross-cluster search failures">the entire search to fail</a>.
</li>
<li class="listitem">
A cluster has no matching indices, aliases or data streams for the index expression
(or your user does not have permissions to search them). For example, suppose your
index expression is <code class="literal">logs*,remote1:logs*</code> and the <code class="literal">remote1</code> cluster has no indices, aliases or data
streams that match <code class="literal">logs*</code>. In that case, that cluster will return no results from that cluster if
you include it in a cross-cluster search.
</li>
<li class="listitem">
The index expression (combined with any query parameters you specify) will likely cause an exception
to be thrown when you do the search. In these cases, the "error" field in the <code class="literal">_resolve/cluster</code> response
will be present. (This is also where security/permission errors will be shown.)
</li>
<li class="listitem">
A remote cluster is an older version that does not support the feature you want to
use in your search.
</li>
</ol>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="resolve-cluster-api-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.14/docs/reference/indices/resolve-cluster.asciidoc">edit</a></h3>
</div></div></div>
<a id="2b7687e3d7c06824950e00618c297864"></a>
<div class="pre_wrapper lang-console">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console">GET /_resolve/cluster/my-index*,clust*:my-index*</pre>
</div>
<div class="console_widget" data-snippet="snippets/2719.console"></div>
<p>The API returns the following response:</p>
<a id="2fc4e59ba2027eed14b9d470ab1ef0d5"></a>
<div class="pre_wrapper lang-console-result">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console-result">{
  "(local)": {          <a id="CO759-1"></a><i class="conum" data-value="1"></i>
    "connected": true,
    "skip_unavailable": false,
    "matching_indices": true,
    "version": {
      "number": "8.13.0",
      "build_flavor": "default",
      "minimum_wire_compatibility_version": "7.17.0",
      "minimum_index_compatibility_version": "7.0.0"
    }
  },
  "cluster_one": {
    "connected": true,         <a id="CO759-2"></a><i class="conum" data-value="2"></i>
    "skip_unavailable": true,  <a id="CO759-3"></a><i class="conum" data-value="3"></i>
    "matching_indices": true,  <a id="CO759-4"></a><i class="conum" data-value="4"></i>
    "version": {
      "number": "8.13.0",      <a id="CO759-5"></a><i class="conum" data-value="5"></i>
      "build_flavor": "default",
      "minimum_wire_compatibility_version": "7.17.0",
      "minimum_index_compatibility_version": "7.0.0"
    }
  },
  "cluster_two": {
    "connected": true,
    "skip_unavailable": false,
    "matching_indices": true,
    "version": {
      "number": "8.13.0",
      "build_flavor": "default",
      "minimum_wire_compatibility_version": "7.17.0",
      "minimum_index_compatibility_version": "7.0.0"
    }
  }
}</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO759-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Each cluster has its own response section. The cluster you sent the request to is labelled as "(local)".</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO759-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>The querying cluster attempts to make a request to each remote cluster. If successful, <code class="literal">connected</code>=<code class="literal">true</code>.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO759-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>The <code class="literal">skip_unavailable</code> setting for each remote cluster, as configured on the local cluster.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO759-4"><i class="conum" data-value="4"></i></a></p>
</td>
<td align="left" valign="top">
<p>Indicates whether any index, alias or data stream matches the index expression specified for that cluster.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO759-5"><i class="conum" data-value="5"></i></a></p>
</td>
<td align="left" valign="top">
<p>The Elasticsearch server version.</p>
</td>
</tr>
</table>
</div>
<h4><a id="resolve-cluster-api-error-example"></a>Identifying potential problems with your cross-cluster search<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/8.14/docs/reference/indices/resolve-cluster.asciidoc">edit</a></h4>
<p>The following request shows several examples of how modifying your query can
prevent search failures.</p>
<a id="357edc9d10e98ed776401c7a439a1a55"></a>
<div class="pre_wrapper lang-console">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console">GET /_resolve/cluster/not-present,clust*:my-index*,oldcluster:*?ignore_unavailable=false</pre>
</div>
<div class="console_widget" data-snippet="snippets/2720.console"></div>
<a id="7219b3216dcd5f6e75df01ac86219c1a"></a>
<div class="pre_wrapper lang-console-result">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console-result">{
  "(local)": {
    "connected": true,
    "skip_unavailable": false,
    "error": "no such index [not_present]"  <a id="CO760-1"></a><i class="conum" data-value="1"></i>
  },
  "cluster_one": {
    "connected": true,
    "skip_unavailable": true,
    "matching_indices": false,    <a id="CO760-2"></a><i class="conum" data-value="2"></i>
    "version": {
      "number": "8.13.0",
      "build_flavor": "default",
      "minimum_wire_compatibility_version": "7.17.0",
      "minimum_index_compatibility_version": "7.0.0"
    }
  },
  "cluster_two": {
    "connected": false,           <a id="CO760-3"></a><i class="conum" data-value="3"></i>
    "skip_unavailable": false,
    "matching_indices": true,
    "version": {
      "number": "8.13.0",
      "build_flavor": "default",
      "minimum_wire_compatibility_version": "7.17.0",
      "minimum_index_compatibility_version": "7.0.0"
    }
  },
  "oldcluster": {         <a id="CO760-4"></a><i class="conum" data-value="4"></i>
    "connected": true,
    "skip_unavailable": false,
    "matching_indices": true
  }
}</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO760-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>The local cluster has no index called <code class="literal">not_present</code>. Searching against it
using the specified <code class="literal">ignore_unavailable=false</code> param will return a "no such
index" error. Other types of errors can show up here as well, such as security
permission errors when the user does not have authorization to search the
specified index.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO760-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>The <code class="literal">cluster_one</code> remote cluster has no indices that match the pattern
<code class="literal">my-index*</code>. There may be no indices that match the pattern or the index
could be closed. (You can check this by using the
<a class="xref" href="indices-resolve-index-api.html" title="Resolve index API">resolve index</a> API.)</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO760-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>The <code class="literal">cluster_two</code> remote cluster is not connected (the attempt to connect
failed). Since this cluster is marked as <code class="literal">skip_unavailable=false</code>, you should
probably exclude this cluster from the search by adding <code class="literal">-cluster_two:*</code> to the
search index expression.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO760-4"><i class="conum" data-value="4"></i></a></p>
</td>
<td align="left" valign="top">
<p>The <code class="literal">oldcluster</code> remote cluster shows that it has matching indices, but no
version information is included. This indicates that the cluster version predates
the introduction of the <code class="literal">_resolve/cluster</code> API in 8.13.0., so you may want to
exclude it from your cross-cluster search. (Note: the endpoint was able to tell there were
matching indices because it fell back to using the <a class="xref" href="indices-resolve-index-api.html" title="Resolve index API">resolve index</a> API.)</p>
</td>
</tr>
</table>
</div>
</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="indices-resolve-index-api.html">« Resolve index API</a>
</span>
<span class="next">
<a href="indices-rollover-index.html">Rollover API »</a>
</span>
</div>
</body>
</html>
