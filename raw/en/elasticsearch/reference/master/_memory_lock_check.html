<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Memory lock check | Elasticsearch Guide [master] | Elastic</title>
<meta class="elastic" name="content" content="Memory lock check | Elasticsearch Guide [master]">

<link rel="home" href="index.html" title="Elasticsearch Guide [master]"/>
<link rel="up" href="bootstrap-checks.html" title="Bootstrap Checks"/>
<link rel="prev" href="_file_descriptor_check.html" title="File descriptor check"/>
<link rel="next" href="max-number-threads-check.html" title="Maximum number of threads check"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="Elasticsearch"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/master"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="master"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
This documentation contains work-in-progress information for future Elastic Stack and Cloud releases. Use the version selector to view supported release docs. It also contains some Elastic Cloud serverless information. Check out our <a href="https://www.elastic.co/docs/current/serverless">serverless docs</a> for more details.
</div>
<div class="navheader">
<span class="prev">
<a href="_file_descriptor_check.html">« File descriptor check</a>
</span>
<span class="next">
<a href="max-number-threads-check.html">Maximum number of threads check »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elasticsearch Guide [master]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="setup.html">Set up Elasticsearch</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="bootstrap-checks.html">Bootstrap Checks</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Memory lock check</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/setup/bootstrap-checks.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="_memory_lock_check"></a>Memory lock check<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/setup/bootstrap-checks.asciidoc">edit</a></h2>
</div></div></div>
<p>When the JVM does a major garbage collection it touches every page of
the heap. If any of those pages are swapped out to disk they will have
to be swapped back in to memory. That causes lots of disk thrashing that
Elasticsearch would much rather use to service requests. There are
several ways to configure a system to disallow swapping. One way is by
requesting the JVM to lock the heap in memory through <code class="literal">mlockall</code> (Unix)
or virtual lock (Windows). This is done via the Elasticsearch setting
<a class="xref" href="setup-configuration-memory.html#bootstrap-memory_lock" title="Enable bootstrap.memory_lock"><code class="literal">bootstrap.memory_lock</code></a>. However, there are
cases where this setting can be passed to Elasticsearch but
Elasticsearch is not able to lock the heap (e.g., if the <code class="literal">elasticsearch</code>
user does not have <code class="literal">memlock unlimited</code>). The memory lock check verifies
that <span class="strong strong"><strong>if</strong></span> the <code class="literal">bootstrap.memory_lock</code> setting is enabled, that the JVM
was successfully able to lock the heap. To pass the memory lock check,
you might have to configure <a class="xref" href="setup-configuration-memory.html#bootstrap-memory_lock" title="Enable bootstrap.memory_lock"><code class="literal">bootstrap.memory_lock</code></a>.</p>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="_file_descriptor_check.html">« File descriptor check</a>
</span>
<span class="next">
<a href="max-number-threads-check.html">Maximum number of threads check »</a>
</span>
</div>
</body>
</html>
