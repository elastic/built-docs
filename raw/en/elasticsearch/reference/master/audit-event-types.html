<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Audit events | Elasticsearch Guide [master] | Elastic</title>
<meta class="elastic" name="content" content="Audit events | Elasticsearch Guide [master]">

<link rel="home" href="index.html" title="Elasticsearch Guide [master]"/>
<link rel="up" href="enable-audit-logging.html" title="Enable audit logging"/>
<link rel="prev" href="enable-audit-logging.html" title="Enable audit logging"/>
<link rel="next" href="audit-log-output.html" title="Logfile audit output"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="Elasticsearch"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/master"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="master"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
This documentation contains work-in-progress information for future Elastic Stack and Cloud releases. Use the version selector to view supported release docs. It also contains some Elastic Cloud serverless information. Check out our <a href="https://www.elastic.co/docs/current/serverless">serverless docs</a> for more details.
</div>
<div class="navheader">
<span class="prev">
<a href="enable-audit-logging.html">« Enable audit logging</a>
</span>
<span class="next">
<a href="audit-log-output.html">Logfile audit output »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elasticsearch Guide [master]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="secure-cluster.html">Secure the Elastic Stack</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="enable-audit-logging.html">Enable audit logging</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Audit events</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/security/auditing/event-types.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="audit-event-types"></a>Audit events<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/security/auditing/event-types.asciidoc">edit</a></h2>
</div></div></div>
<p>When you are <a class="xref" href="enable-audit-logging.html" title="Enable audit logging">auditing security events</a>, a single client
request might generate multiple audit events, across multiple cluster nodes.
The common <code class="literal">request.id</code> attribute can be used to correlate the associated events.</p>
<p>Use the <a class="xref" href="auditing-settings.html#xpack-sa-lf-events-include"><code class="literal">xpack.security.audit.logfile.events.include</code></a>
setting in <code class="literal">elasticsearch.yml</code> to specify the kind of events you want to include
in the auditing output.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Certain audit events require the <code class="literal">security_config_change</code> event type to
audit the related event action. The description of impacted audit events
indicate whether that event type is required.</p>
</div>
</div>
<div class="variablelist">
<a id="event-access-denied"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">access_denied</code>
</span>
</dt>
<dd>
<p>
Logged when an authenticated user attempts to execute an action they do not
have the necessary <a class="xref" href="security-privileges.html" title="Security privileges">privilege</a> to perform.
</p>
<details open>
<summary class="title">Example</summary>
<div class="content">
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">{"type":"audit", "timestamp":"2020-12-30T22:30:06,949+0200", "node.id":
"0RMNyghkQYCc_gVd1G6tZQ", "event.type":"transport", "event.action":
"access_denied", "authentication.type":"REALM", "user.name":"user1",
"user.realm":"default_native", "user.roles":["test_role"], "origin.type":
"rest", "origin.address":"[::1]:52434", "request.id":"yKOgWn2CRQCKYgZRz3phJw",
"action":"indices:admin/auto_create", "request.name":"CreateIndexRequest",
"indices":["&lt;index-{now/d+1d}&gt;"]}</pre>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="event-access-granted"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">access_granted</code>
</span>
</dt>
<dd>
<p>
Logged when an authenticated user attempts to execute an action they have the
necessary privilege to perform. These events will be logged only for non-system
users.
</p>
<p>If you want to include <code class="literal">access_granted</code> events for all users (including
internal users such as <code class="literal">_xpack</code>), add
<a class="xref" href="audit-event-types.html#event-system-granted"><code class="literal">system_access_granted</code></a> to the list of
event types in addition to <code class="literal">access_granted</code>. The <code class="literal">system_access_granted</code>
privilege is not included by default to avoid cluttering the logs.</p>
<details open>
<summary class="title">Example</summary>
<div class="content">
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">{"type":"audit", "timestamp":"2020-12-30T22:30:06,947+0200", "node.id":
"0RMNyghkQYCc_gVd1G6tZQ", "event.type":"transport", "event.action":
"access_granted", "authentication.type":"REALM", "user.name":"user1", "user
realm":"default_native", "user.roles":["test_role"], "origin.type":"rest",
"origin.address":"[::1]:52434", "request.id":"yKOgWn2CRQCKYgZRz3phJw",
"action":"indices:data/write/bulk", "request.name":"BulkRequest"}</pre>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="event-anonymous-access-denied"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">anonymous_access_denied</code>
</span>
</dt>
<dd>
<p>
Logged when a request is denied due to missing authentication credentials.
</p>
<details open>
<summary class="title">Example</summary>
<div class="content">
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">{"type":"audit", "timestamp":"2020-12-30T21:56:43,608+0200", "node.id":
"0RMNyghkQYCc_gVd1G6tZQ", "event.type":"rest", "event.action":
"anonymous_access_denied", "origin.type":"rest", "origin.address":
"[::1]:50543", "url.path":"/twitter/_async_search", "url.query":"pretty",
"request.method":"POST", "request.id":"TqA9OisyQ8WTl1ivJUV1AA"}</pre>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="event-authentication-failed"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">authentication_failed</code>
</span>
</dt>
<dd>
<p>
Logged when the authentication credentials cannot be matched to a known user.
</p>
<details open>
<summary class="title">Example</summary>
<div class="content">
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">{"type":"audit", "timestamp":"2020-12-30T22:10:15,510+0200", "node.id":
"0RMNyghkQYCc_gVd1G6tZQ", "event.type":"rest", "event.action":
"authentication_failed", "user.name":"elastic", "origin.type":"rest",
"origin.address":"[::1]:51504", "url.path":"/_security/user/user1",
"url.query":"pretty", "request.method":"POST",
"request.id":"POv8p_qeTl2tb5xoFl0HIg"}</pre>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="event-authentication-success"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">authentication_success</code>
</span>
</dt>
<dd>
<p>
Logged when a user successfully authenticates.
</p>
<details open>
<summary class="title">Example</summary>
<div class="content">
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">{"type":"audit", "timestamp":"2020-12-30T22:03:35,018+0200", "node.id":
"0RMNyghkQYCc_gVd1G6tZQ", "event.type":"rest", "event.action":
"authentication_success", "authentication.type":"REALM", "user.name":
"elastic", "user.realm":"reserved", "origin.type":"rest", "origin.address":
"[::1]:51014", "realm":"reserved", "url.path":"/twitter/_search",
"url.query":"pretty", "request.method":"POST",
"request.id":"nHV3UMOoSiu-TaSPWCfxGg"}</pre>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="event-change-disable-user"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">change_disable_user</code>
</span>
</dt>
<dd>
<p>
Logged when the <a class="xref" href="security-api-enable-user.html" title="Enable users API">enable user API</a> is invoked to
disable a native or a built-in user.
</p>
<p>You must include the <code class="literal">security_config_change</code> event type to
audit the related event action.</p>
<details open>
<summary class="title">Example</summary>
<div class="content">
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">{"type":"audit", "timestamp":"2020-12-30T23:17:28,308+0200", "node.id":
"0RMNyghkQYCc_gVd1G6tZQ", "event.type":"security_config_change", "event.
action":"change_disable_user", "request.id":"qvLIgw_eTvyK3cgV-GaLVg",
"change":{"disable":{"user":{"name":"user1"}}}}</pre>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="event-change-enable-user"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">change_enable_user</code>
</span>
</dt>
<dd>
<p>
Logged when the <a class="xref" href="security-api-enable-user.html" title="Enable users API">enable user API</a> is invoked to
enable a native or a built-in user.
</p>
<p>You must include the <code class="literal">security_config_change</code> event type to audit the related
event action.</p>
<details open>
<summary class="title">Example</summary>
<div class="content">
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">{"type":"audit", "timestamp":"2020-12-30T23:17:34,843+0200", "node.id":
"0RMNyghkQYCc_gVd1G6tZQ", "event.type":"security_config_change", "event.
action":"change_enable_user", "request.id":"BO3QU3qeTb-Ei0G0rUOalQ",
"change":{"enable":{"user":{"name":"user1"}}}}</pre>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="event-change-password"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">change_password</code>
</span>
</dt>
<dd>
<p>
Logged when the <a class="xref" href="security-api-change-password.html" title="Change passwords API">change password API</a> is
invoked to change the password of a native or built-in user.
</p>
<p>You must include the <code class="literal">security_config_change</code> event type to audit the related
event action.</p>
<details open>
<summary class="title">Example</summary>
<div class="content">
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">{"type":"audit", "timestamp":"2019-12-30T22:19:41,345+0200", "node.id":
"0RMNyghkQYCc_gVd1G6tZQ", "event.type":"security_config_change", "event.
action":"change_password", "request.id":"bz5a1Cc3RrebDMitMGGNCw",
"change":{"password":{"user":{"name":"user1"}}}}</pre>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="event-create-service-token"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">create_service_token</code>
</span>
</dt>
<dd>
<p>
Logged when the <a class="xref" href="security-api-create-service-token.html" title="Create service account token API">create service account token API</a> is
invoked to create a new index-based token for a service account.
</p>
<p>You must include the <code class="literal">security_config_change</code> event type to audit the related
event action.</p>
<details open>
<summary class="title">Example</summary>
<div class="content">
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">{"type":"audit", "timestamp":"2021-04-30T23:17:42,952+0200", "node.id":
"0RMNyghkQYCc_gVd1G6tZQ", "event.type":"security_config_change", "event.
action":"create_service_token", "request.id":"az9a1Db5QrebDMacQ8yGKc",
"create":{"service_token":{"namespace":"elastic","service":"fleet-server","name":"token1"}}}`</pre>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="event-connection-denied"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">connection_denied</code>
</span>
</dt>
<dd>
<p>
Logged when an incoming TCP connection does not pass the
<a class="xref" href="ip-filtering.html" title="Restricting connections with IP filtering">IP filter</a> for a specific profile.
</p>
<details open>
<summary class="title">Example</summary>
<div class="content">
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">{"type":"audit", "timestamp":"2020-12-30T21:47:31,526+0200", "node.id":
"0RMNyghkQYCc_gVd1G6tZQ", "event.type":"ip_filter", "event.action":
"connection_denied", "origin.type":"rest", "origin.address":"10.10.0.20:52314",
"transport.profile":".http", "rule":"deny 10.10.0.0/16"}</pre>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="event-connection-granted"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">connection_granted</code>
</span>
</dt>
<dd>
<p>
Logged when an incoming TCP connection passes the <a class="xref" href="ip-filtering.html" title="Restricting connections with IP filtering">IP filter</a>
for a specific profile.
</p>
<details open>
<summary class="title">Example</summary>
<div class="content">
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">{"type":"audit", "timestamp":"2020-12-30T21:47:31,526+0200", "node.id":
"0RMNyghkQYCc_gVd1G6tZQ", "event.type":"ip_filter", "event.action":
"connection_granted", "origin.type":"rest", "origin.address":"[::1]:52314",
"transport.profile":".http", "rule":"allow ::1,127.0.0.1"}</pre>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="event-create-apikey"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">create_apikey</code>
</span>
</dt>
<dd>
<p>
Logged when the <a class="xref" href="security-api-create-api-key.html" title="Create API key API">create API key</a> or the
<a class="xref" href="security-api-grant-api-key.html" title="Grant API key API">grant API key</a> APIs are invoked to create a new
API key.
</p>
<p>You must include the <code class="literal">security_config_change</code> event type to audit the related
event action.</p>
<details open>
<summary class="title">Example</summary>
<div class="content">
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">{"type":"audit", "timestamp":"2020-12-31T00:33:52,521+0200", "node.id":
"9clhpgjJRR-iKzOw20xBNQ", "event.type":"security_config_change", "event.action":
"create_apikey", "request.id":"9FteCmovTzWHVI-9Gpa_vQ", "create":{"apikey":
{"name":"test-api-key-1","expiration":"10d","role_descriptors":[{"cluster":
["monitor","manage_ilm"],"indices":[{"names":["index-a*"],"privileges":
["read","maintenance"]},{"names":["in*","alias*"],"privileges":["read"],
"field_security":{"grant":["field1*","@timestamp"],"except":["field11"]}}],
"applications":[],"run_as":[]},{"cluster":["all"],"indices":[{"names":
["index-b*"],"privileges":["all"]}],"applications":[],"run_as":[]}],
"metadata":{"application":"my-application","environment":{"level": 1,
"tags":["dev","staging"]}}}}}</pre>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="event-change-apikey"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">change_apikey</code>
</span>
</dt>
<dd>
<p>
Logged when the <a class="xref" href="security-api-update-api-key.html" title="Update API key API">update API key</a> API is
invoked to update the attributes of an existing API key.
</p>
<p>You must include the <code class="literal">security_config_change</code> event type to audit the related
event action.</p>
<details open>
<summary class="title">Example</summary>
<div class="content">
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">{"type":"audit", "timestamp":"2020-12-31T00:33:52,521+0200", "node.id":
"9clhpgjJRR-iKzOw20xBNQ", "event.type":"security_config_change", "event.action":
"change_apikey", "request.id":"9FteCmovTzWHVI-9Gpa_vQ", "change":{"apikey":
{"id":"zcwN3YEBBmnjw-K-hW5_","role_descriptors":[{"cluster":
["monitor","manage_ilm"],"indices":[{"names":["index-a*"],"privileges":
["read","maintenance"]},{"names":["in*","alias*"],"privileges":["read"],
"field_security":{"grant":["field1*","@timestamp"],"except":["field11"]}}],
"applications":[],"run_as":[]},{"cluster":["all"],"indices":[{"names":
["index-b*"],"privileges":["all"]}],"applications":[],"run_as":[]}],
"metadata":{"application":"my-application","environment":{"level": 1,
"tags":["dev","staging"]}},"expiration":"10d"}}}</pre>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="event-change-apikeys"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">change_apikeys</code>
</span>
</dt>
<dd>
<p>
Logged when the <a class="xref" href="security-api-bulk-update-api-keys.html" title="Bulk update API keys API">bulk update API keys</a> API is
invoked to update the attributes of multiple existing API keys.
</p>
<p>You must include the <code class="literal">security_config_change</code> event type to audit the related
event action.</p>
<details open>
<summary class="title">Example</summary>
<div class="content">
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">{"type":"audit","timestamp":"2020-12-31T00:33:52,521+0200","node.id":
"9clhpgjJRR-iKzOw20xBNQ","event.type":"security_config_change",
"event.action":"change_apikeys","request.id":"9FteCmovTzWHVI-9Gpa_vQ",
"change":{"apikeys":
{"ids":["zcwN3YEBBmnjw-K-hW5_","j7c0WYIBqecB5CbVR6Oq"],"role_descriptors":
[{"cluster":["monitor","manage_ilm"],"indices":[{"names":["index-a*"],"privileges":
["read","maintenance"]},{"names":["in*","alias*"],"privileges":["read"],
"field_security":{"grant":["field1*","@timestamp"],"except":["field11"]}}],
"applications":[],"run_as":[]},{"cluster":["all"],"indices":[{"names":
["index-b*"],"privileges":["all"]}],"applications":[],"run_as":[]}],
"metadata":{"application":"my-application","environment":{"level":1,
"tags":["dev","staging"]}},"expiration":"10d"}}}</pre>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="event-delete-privileges"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">delete_privileges</code>
</span>
</dt>
<dd>
<p>
Logged when the
<a class="xref" href="security-api-delete-privilege.html" title="Delete application privileges API">delete application privileges API</a> is invoked
to remove one or more application privileges.
</p>
<p>You must include the <code class="literal">security_config_change</code> event type to audit the related
event action.</p>
<details open>
<summary class="title">Example</summary>
<div class="content">
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">{"type":"audit", "timestamp":"2020-12-31T00:39:30,246+0200", "node.id":
"9clhpgjJRR-iKzOw20xBNQ", "event.type":"security_config_change", "event.
action":"delete_privileges", "request.id":"7wRWVxxqTzCKEspeSP7J8g",
"delete":{"privileges":{"application":"myapp","privileges":["read"]}}}</pre>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="event-delete-role"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">delete_role</code>
</span>
</dt>
<dd>
<p>
Logged when the <a class="xref" href="security-api-delete-role.html" title="Delete roles API">delete role API</a> is invoked to
delete a role.
</p>
<p>You must include the <code class="literal">security_config_change</code> event type to audit the related
event action.</p>
<details open>
<summary class="title">Example</summary>
<div class="content">
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">{"type":"audit", "timestamp":"2020-12-31T00:08:11,678+0200", "node.id":
"0RMNyghkQYCc_gVd1G6tZQ", "event.type":"security_config_change", "event.action":
"delete_role", "request.id":"155IKq3zQdWq-12dgKZRnw",
"delete":{"role":{"name":"my_admin_role"}}}</pre>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="event-delete-role-mapping"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">delete_role_mapping</code>
</span>
</dt>
<dd>
<p>
Logged when the <a class="xref" href="security-api-delete-role-mapping.html" title="Delete role mappings API">delete role mapping API</a>
is invoked to delete a role mapping.
</p>
<p>You must include the <code class="literal">security_config_change</code> event type to audit the related
event action.</p>
<details open>
<summary class="title">Example</summary>
<div class="content">
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">{"type":"audit", "timestamp":"2020-12-31T00:12:09,349+0200", "node.id":
"0RMNyghkQYCc_gVd1G6tZQ", "event.type":"security_config_change", "event.
action":"delete_role_mapping", "request.id":"Stim-DuoSTCWom0S_xhf8g",
"delete":{"role_mapping":{"name":"mapping1"}}}</pre>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="event-delete-service-token"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">delete_service_token</code>
</span>
</dt>
<dd>
<p>
Logged when the <a class="xref" href="security-api-delete-service-token.html" title="Delete service account tokens API">delete service account token API</a> is
invoked to delete an index-based token for a service account.
</p>
<p>You must include the <code class="literal">security_config_change</code> event type to audit the related
event action.</p>
<details open>
<summary class="title">Example</summary>
<div class="content">
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">{"type":"audit", "timestamp":"2021-04-30T23:17:42,952+0200", "node.id":
"0RMNyghkQYCc_gVd1G6tZQ", "event.type":"security_config_change", "event.
action":"delete_service_token", "request.id":"az9a1Db5QrebDMacQ8yGKc",
"delete":{"service_token":{"namespace":"elastic","service":"fleet-server","name":"token1"}}}</pre>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="event-delete-user"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">delete_user</code>
</span>
</dt>
<dd>
<p>
Logged when the <a class="xref" href="security-api-delete-user.html" title="Delete users API">delete user API</a> is invoked to
delete a specific native user.
</p>
<p>You must include the <code class="literal">security_config_change</code> event type to audit the related
event action.</p>
<details open>
<summary class="title">Example</summary>
<div class="content">
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">{"type":"audit", "timestamp":"2020-12-30T22:19:41,345+0200", "node.id":
"0RMNyghkQYCc_gVd1G6tZQ", "event.type":"security_config_change",
"event.action":"delete_user", "request.id":"au5a1Cc3RrebDMitMGGNCw",
"delete":{"user":{"name":"jacknich"}}}</pre>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="event-invalidate-apikeys"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">invalidate_apikeys</code>
</span>
</dt>
<dd>
<p>
Logged when the <a class="xref" href="security-api-invalidate-api-key.html" title="Invalidate API key API">invalidate API key API</a> is
invoked to invalidate one or more API keys.
</p>
<p>You must include the <code class="literal">security_config_change</code> event type to audit the related
event action.</p>
<details open>
<summary class="title">Example</summary>
<div class="content">
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">{"type":"audit", "timestamp":"2020-12-31T00:36:30,247+0200", "node.id":
"9clhpgjJRR-iKzOw20xBNQ", "event.type":"security_config_change", "event.
action":"invalidate_apikeys", "request.id":"7lyIQU9QTFqSrTxD0CqnTQ",
"invalidate":{"apikeys":{"owned_by_authenticated_user":false,
"user":{"name":"myuser","realm":"native1"}}}}</pre>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="event-put-privileges"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">put_privileges</code>
</span>
</dt>
<dd>
<p>
Logged when the <a class="xref" href="security-api-put-privileges.html" title="Create or update application privileges API">create or update privileges API</a> is invoked
to add or update one or more application privileges.
</p>
<p>You must include the <code class="literal">security_config_change</code> event type to audit the related
event action.</p>
<details open>
<summary class="title">Example</summary>
<div class="content">
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">{"type":"audit", "timestamp":"2020-12-31T00:39:07,779+0200", "node.id":
"9clhpgjJRR-iKzOw20xBNQ", "event.type":"security_config_change",
"event.action":"put_privileges", "request.id":"1X2VVtNgRYO7FmE0nR_BGA",
"put":{"privileges":[{"application":"myapp","name":"read","actions":
["data:read/*","action:login"],"metadata":{"description":"Read access to myapp"}}]}}</pre>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="event-put-role"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">put_role</code>
</span>
</dt>
<dd>
<p>
Logged when the <a class="xref" href="security-api-put-role.html" title="Create or update roles API">create or update role API</a> is invoked to create or
update a role.
</p>
<p>You must include the <code class="literal">security_config_change</code> event type to audit the related
event action.</p>
<details open>
<summary class="title">Example</summary>
<div class="content">
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">{"type":"audit", "timestamp":"2020-12-30T22:27:01,978+0200", "node.id":
"0RMNyghkQYCc_gVd1G6tZQ", "event.type":"security_config_change",
"event.action":"put_role", "request.id":"tDYQhv5CRMWM4Sc5Zkk2cQ",
"put":{"role":{"name":"test_role","role_descriptor":{"cluster":["all"],
"indices":[{"names":["apm*"],"privileges":["all"],"field_security":
{"grant":["granted"]},"query":"{\"term\": {\"service.name\": \"bar\"}}"},
{"names":["apm-all*"],"privileges":["all"],"query":"{\"term\":
{\"service.name\": \"bar2\"}}"}],"applications":[],"run_as":[]}}}}</pre>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="event-put-role-mapping"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">put_role_mapping</code>
</span>
</dt>
<dd>
<p>
Logged when the <a class="xref" href="security-api-put-role-mapping.html" title="Create or update role mappings API">create or update role mapping API</a> is
invoked to create or update a role mapping.
</p>
<p>You must include the <code class="literal">security_config_change</code> event type to audit the related
event action.</p>
<details open>
<summary class="title">Example</summary>
<div class="content">
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">{"type":"audit", "timestamp":"2020-12-31T00:11:13,932+0200", "node.id":
"0RMNyghkQYCc_gVd1G6tZQ", "event.type":"security_config_change", "event.
action":"put_role_mapping", "request.id":"kg4h1l_kTDegnLC-0A-XxA",
"put":{"role_mapping":{"name":"mapping1","roles":["user"],"rules":
{"field":{"username":"*"}},"enabled":true,"metadata":{"version":1}}}}</pre>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="event-put-user"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">put_user</code>
</span>
</dt>
<dd>
<p>
Logged when the <a class="xref" href="security-api-put-user.html" title="Create or update users API">create or update user API</a> is invoked to create or
update a native user. Note that user updates can also change the
user&#8217;s password.
</p>
<p>You must include the <code class="literal">security_config_change</code> event type to audit the related
event action.</p>
<details open>
<summary class="title">Example</summary>
<div class="content">
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">{"type":"audit", "timestamp":"2020-12-30T22:10:09,749+0200", "node.id":
"0RMNyghkQYCc_gVd1G6tZQ", "event.type":"security_config_change",
"event.action":"put_user", "request.id":"VIiSvhp4Riim_tpkQCVSQA",
"put":{"user":{"name":"user1","enabled":false,"roles":["admin","other_role1"],
"full_name":"Jack Sparrow","email":"jack@blackpearl.com",
"has_password":true,"metadata":{"cunning":10}}}}</pre>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="event-realm-auth-failed"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">realm_authentication_failed</code>
</span>
</dt>
<dd>
<p>
Logged for every realm that fails to present a valid authentication token.
</p>
<details open>
<summary class="title">Example</summary>
<div class="content">
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">{"type":"audit", "timestamp":"2020-12-30T22:10:15,510+0200", "node.id":
"0RMNyghkQYCc_gVd1G6tZQ", "event.type":"rest", "event.action":
"realm_authentication_failed", "user.name":"elastic", "origin.type":"rest",
"origin.address":"[::1]:51504", "realm":"myTestRealm1", "url.path":
"/_security/user/user1", "url.query":"pretty", "request.method":"POST",
"request.id":"POv8p_qeTl2tb5xoFl0HIg"}</pre>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="event-runas-denied"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">run_as_denied</code>
</span>
</dt>
<dd>
<p>
Logged when an authenticated user attempts to <a class="xref" href="run-as-privilege.html" title="Submitting requests on behalf of other users">run as</a>
another user that they do not have the necessary
<a class="xref" href="security-privileges.html" title="Security privileges">privileges</a> to do so.
</p>
<details open>
<summary class="title">Example</summary>
<div class="content">
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">{"type":"audit", "timestamp":"2020-12-30T22:49:34,859+0200", "node.id":
"0RMNyghkQYCc_gVd1G6tZQ", "event.type":"transport", "event.action":
"run_as_denied", "user.name":"user1", "user.run_as.name":"user1",
"user.realm":"default_native", "user.run_as.realm":"default_native",
"user.roles":["test_role"], "origin.type":"rest", "origin.address":
"[::1]:52662", "request.id":"RcaSt872RG-R_WJBEGfYXA",
"action":"indices:data/read/search", "request.name":"SearchRequest", "indices":["alias1"]}</pre>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="event-runas-granted"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">run_as_granted</code>
</span>
</dt>
<dd>
<p>
Logged when an authenticated user attempts to <a class="xref" href="run-as-privilege.html" title="Submitting requests on behalf of other users">run as</a>
another user that they have the necessary privileges to do so.
</p>
<details open>
<summary class="title">Example</summary>
<div class="content">
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">{"type":"audit", "timestamp":"2020-12-30T22:44:42,068+0200", "node.id":
"0RMNyghkQYCc_gVd1G6tZQ", "event.type":"transport", "event.action":
"run_as_granted", "user.name":"elastic", "user.run_as.name":"user1",
"user.realm":"reserved", "user.run_as.realm":"default_native",
"user.roles":["superuser"], "origin.type":"rest", "origin.address":
"[::1]:52623", "request.id":"dGqPTdEQSX2TAPS3cvc1qA", "action":
"indices:data/read/search", "request.name":"SearchRequest", "indices":["alias1"]}</pre>
</div>
</div>
</details>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="event-system-granted"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">system_access_granted</code>
</span>
</dt>
<dd>
<p>
Logs <a class="xref" href="audit-event-types.html#event-access-granted"><code class="literal">access_granted</code></a> events only for
<a class="xref" href="internal-users.html" title="Internal users">internal users</a>, such as <code class="literal">_xpack</code>. If you include this setting
in addition to <code class="literal">access_granted</code>, then <code class="literal">access_granted</code> events are
logged for <em>all</em> users.
</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This event type is disabled by default to avoid cluttering the logs.</p>
</div>
</div>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="event-tampered-request"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">tampered_request</code>
</span>
</dt>
<dd>
<p>
Logged when the security features detect that the request has been tampered
with. Typically relates to <code class="literal">search/scroll</code> requests when the scroll ID is
believed to have been tampered with.
</p>
<details open>
<summary class="title">Example</summary>
<div class="content">
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">{"type":"audit", "timestamp":"2019-11-27T22:00:00,947+0200", "node.id":
"0RMNyghkQYCc_gVd1G6tZQ", "event.type": "rest", "event.action":
"tampered_request", "origin.address":"[::1]:50543", "url.path":
"/twitter/_async_search", "url.query":"pretty", "request.method":"POST",
"request.id":"TqA9OisyQ8WTl1ivJUV1AA"}</pre>
</div>
</div>
</details>
</dd>
</dl>
</div>
<h3><a id="audit-event-attributes"></a>Audit event attributes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/security/auditing/event-types.asciidoc">edit</a></h3>
<p>The audit events are formatted as JSON documents, and each event is printed on a separate
line in the audit log. The entries themselves do not contain an end-of-line delimiter.
For more details, see <a class="xref" href="audit-log-output.html#audit-log-entry-format" title="Log entry format">Log entry format</a>.</p>
<p>The following list shows attributes that are common to all audit event types:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">@timestamp</code>
</span>
</dt>
<dd>
The time, in ISO9601 format, when the event occurred.
</dd>
<dt>
<span class="term">
<code class="literal">node.name</code>
</span>
</dt>
<dd>
The name of the node. This can be changed
in the <code class="literal">elasticsearch.yml</code> config file.
</dd>
<dt>
<span class="term">
<code class="literal">node.id</code>
</span>
</dt>
<dd>
The node id. This is automatically generated and is
persistent across full cluster restarts.
</dd>
<dt>
<span class="term">
<code class="literal">host.ip</code>
</span>
</dt>
<dd>
The bound IP address of the node, with which the node
can be communicated with.
</dd>
<dt>
<span class="term">
<code class="literal">host.name</code>
</span>
</dt>
<dd>
The unresolved node&#8217;s hostname.
</dd>
<dt>
<span class="term">
<code class="literal">event.type</code>
</span>
</dt>
<dd>
The internal processing layer that generated the event:
<code class="literal">rest</code>, <code class="literal">transport</code>, <code class="literal">ip_filter</code> or <code class="literal">security_config_change</code>.
This is different from <code class="literal">origin.type</code> because a request
originating from the REST API is translated to a number
of transport messages, generating audit events with
<code class="literal">origin.type: rest</code> and <code class="literal">event.type: transport</code>.
</dd>
<dt>
<span class="term">
<code class="literal">event.action</code>
</span>
</dt>
<dd>
<p>
The type of event that occurred: <code class="literal">anonymous_access_denied</code>,
<code class="literal">authentication_failed</code>, <code class="literal">authentication_success</code>,
<code class="literal">realm_authentication_failed</code>, <code class="literal">access_denied</code>, <code class="literal">access_granted</code>,
<code class="literal">connection_denied</code>, <code class="literal">connection_granted</code>, <code class="literal">tampered_request</code>,
<code class="literal">run_as_denied</code>, or <code class="literal">run_as_granted</code>.
</p>
<p>In addition, if <code class="literal">event.type</code> equals <a class="xref" href="audit-event-types.html#security-config-change" title="Audit event attributes of the security_config_change event type"><code class="literal">security_config_change</code></a>,
the <code class="literal">event.action</code> attribute takes one of the following values:
<code class="literal">put_user</code>, <code class="literal">change_password</code>, <code class="literal">put_role</code>, <code class="literal">put_role_mapping</code>,
<code class="literal">change_enable_user</code>, <code class="literal">change_disable_user</code>, <code class="literal">put_privileges</code>, <code class="literal">create_apikey</code>,
<code class="literal">delete_user</code>, <code class="literal">delete_role</code>, <code class="literal">delete_role_mapping</code>, <code class="literal">invalidate_apikeys</code>,
<code class="literal">delete_privileges</code>, <code class="literal">change_apikey</code>, or <code class="literal">change_apikeys</code>.</p>
</dd>
<dt>
<span class="term">
<code class="literal">request.id</code>
</span>
</dt>
<dd>
A synthetic identifier that can be used to correlate the events
associated with a particular REST request.
</dd>
</dl>
</div>
<p>In addition, all the events of types <code class="literal">rest</code>, <code class="literal">transport</code> and <code class="literal">ip_filter</code> (but not
<code class="literal">security_config_change</code>) have the following extra attributes, which
show more details about the requesting client:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">origin.address</code>
</span>
</dt>
<dd>
The source IP address of the request associated with
this event. This could be the address of the remote client,
the address of another cluster node, or the local node&#8217;s
bound address, if the request originated locally. Unless
the remote client connects directly to the cluster, the
<em>client address</em> will actually be the address of the first
OSI layer 3 proxy in front of the cluster.
</dd>
<dt>
<span class="term">
<code class="literal">origin.type</code>
</span>
</dt>
<dd>
The origin type of the request associated with this event:
<code class="literal">rest</code> (request originated from a REST API request),
<code class="literal">transport</code> (request was received on the transport channel),
or <code class="literal">local_node</code> (the local node issued the request).
</dd>
<dt>
<span class="term">
<code class="literal">opaque_id</code>
</span>
</dt>
<dd>
The value of the <code class="literal">X-Opaque-Id</code> HTTP header (if present) of
the request associated with this event.
See more: <a class="xref" href="api-conventions.html#x-opaque-id" title="X-Opaque-Id HTTP header"><code class="literal">X-Opaque-Id</code> HTTP header - API conventions</a>
</dd>
<dt>
<span class="term">
<code class="literal">trace_id</code>
</span>
</dt>
<dd>
The identifier extracted from the <code class="literal">traceparent</code> HTTP header
(if present) of the request associated with this event.
It allows to surface audit logs into the Trace Logs feature
of Elastic APM.
</dd>
<dt>
<span class="term">
<code class="literal">x_forwarded_for</code>
</span>
</dt>
<dd>
The verbatim value of the <code class="literal">X-Forwarded-For</code> HTTP request
header (if present) of the request associated with the
audit event. This header is commonly added by proxies
when they forward requests and the value is the address
of the proxied client. When a request crosses multiple
proxies the header is a comma delimited list with the
last value being the address of the second to last
proxy server (the address of the last proxy server is
designated by the <code class="literal">origin.address</code> field).
</dd>
</dl>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_audit_event_attributes_of_the_rest_event_type"></a>Audit event attributes of the <code class="literal">rest</code> event type<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/security/auditing/event-types.asciidoc">edit</a></h3>
</div></div></div>
<p>The events with <code class="literal">event.type</code> equal to <code class="literal">rest</code> have one of the following <code class="literal">event.action</code>
attribute values: <code class="literal">authentication_success</code>, <code class="literal">anonymous_access_denied</code>, <code class="literal">authentication_failed</code>,
<code class="literal">realm_authentication_failed</code>, <code class="literal">tampered_request</code> or <code class="literal">run_as_denied</code>.
These events also have the following extra attributes (in addition to the
common ones):</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">url.path</code>
</span>
</dt>
<dd>
The path part of the URL (between the port and the query
string) of the REST request associated with this event.
This is URL encoded.
</dd>
<dt>
<span class="term">
<code class="literal">url.query</code>
</span>
</dt>
<dd>
The query part of the URL (after "?", if present) of the
REST request associated with this event. This is URL encoded.
</dd>
<dt>
<span class="term">
<code class="literal">request.method</code>
</span>
</dt>
<dd>
The HTTP method of the REST request associated with this
event. It is one of GET, POST, PUT, DELETE, OPTIONS,
HEAD, PATCH, TRACE and CONNECT.
</dd>
<dt>
<span class="term">
<code class="literal">request.body</code>
</span>
</dt>
<dd>
The full content of the REST request associated with this
event, if enabled. This contains the HTTP request body.
The body is escaped as a string value according to the JSON RFC 4627.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_audit_event_attributes_of_the_transport_event_type"></a>Audit event attributes of the <code class="literal">transport</code> event type<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/security/auditing/event-types.asciidoc">edit</a></h3>
</div></div></div>
<p>The events with <code class="literal">event.type</code> equal to <code class="literal">transport</code> have one of the following <code class="literal">event.action</code>
attribute values: <code class="literal">authentication_success</code>, <code class="literal">anonymous_access_denied</code>, <code class="literal">authentication_failed</code>,
<code class="literal">realm_authentication_failed</code>, <code class="literal">access_granted</code>, <code class="literal">access_denied</code>, <code class="literal">run_as_granted</code>,
<code class="literal">run_as_denied</code>, or <code class="literal">tampered_request</code>.
These events also have the following extra attributes (in addition to the common
ones):</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">action</code>
</span>
</dt>
<dd>
The name of the transport action that was executed.
This is like the URL for a REST request.
</dd>
<dt>
<span class="term">
<code class="literal">indices</code>
</span>
</dt>
<dd>
The indices names array that the request associated
with this event pertains to (when applicable).
</dd>
<dt>
<span class="term">
<code class="literal">request.name</code>
</span>
</dt>
<dd>
The name of the request handler that was executed.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_audit_event_attributes_of_the_ip_filter_event_type"></a>Audit event attributes of the <code class="literal">ip_filter</code> event type<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/security/auditing/event-types.asciidoc">edit</a></h3>
</div></div></div>
<p>The events with <code class="literal">event.type</code> equal to <code class="literal">ip_filter</code> have one of the following <code class="literal">event.action</code>
attribute values: <code class="literal">connection_granted</code> or <code class="literal">connection_denied</code>.
These events also have the following extra attributes (in addition to the common
ones):</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">transport_profile</code>
</span>
</dt>
<dd>
The transport profile the request targeted.
</dd>
<dt>
<span class="term">
<code class="literal">rule</code>
</span>
</dt>
<dd>
The <a class="xref" href="ip-filtering.html" title="Restricting connections with IP filtering">IP filtering</a> rule that denied
the request.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-config-change"></a>Audit event attributes of the <code class="literal">security_config_change</code> event type<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/security/auditing/event-types.asciidoc">edit</a></h3>
</div></div></div>
<p>The events with the <code class="literal">event.type</code> attribute equal to <code class="literal">security_config_change</code> have one of the following
<code class="literal">event.action</code> attribute values: <code class="literal">put_user</code>, <code class="literal">change_password</code>, <code class="literal">put_role</code>, <code class="literal">put_role_mapping</code>,
<code class="literal">change_enable_user</code>, <code class="literal">change_disable_user</code>, <code class="literal">put_privileges</code>, <code class="literal">create_apikey</code>, <code class="literal">delete_user</code>,
<code class="literal">delete_role</code>, <code class="literal">delete_role_mapping</code>, <code class="literal">invalidate_apikeys</code>, <code class="literal">delete_privileges</code>, <code class="literal">change_apikey</code>,
or <code class="literal">change_apikeys</code>.</p>
<p>These events also have <span class="strong strong"><strong>one</strong></span> of the following extra attributes (in addition to the common
ones), which is specific to the <code class="literal">event.type</code> attribute. The attribute&#8217;s value is a nested JSON object:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">put</code>
</span>
</dt>
<dd>
The object representation of the security config that
is being created, or the overwrite of an existing config.
It contains the config for a <code class="literal">user</code>, <code class="literal">role</code>, <code class="literal">role_mapping</code>, or
for application <code class="literal">privileges</code>.
</dd>
<dt>
<span class="term">
<code class="literal">delete</code>
</span>
</dt>
<dd>
The object representation of the security config that
is being deleted. It can be the config for a <code class="literal">user</code>, <code class="literal">role</code>,
<code class="literal">role_mapping</code> or for application <code class="literal">privileges</code>.
</dd>
<dt>
<span class="term">
<code class="literal">change</code>
</span>
</dt>
<dd>
The object representation of the security config that
is being changed. It can be the <code class="literal">password</code>, <code class="literal">enable</code> or <code class="literal">disable</code>,
config object for native or built-in users. If an API key is updated,
the config object will be an <code class="literal">apikey</code>.
</dd>
<dt>
<span class="term">
<code class="literal">create</code>
</span>
</dt>
<dd>
The object representation of the new security config that is being
created. This is currently only used for API keys auditing.
If the API key is created using the
<a class="xref" href="security-api-create-api-key.html" title="Create API key API">create API key API</a> it only contains
an <code class="literal">apikey</code> config object. If the API key is created using the
<a class="xref" href="security-api-grant-api-key.html" title="Grant API key API">grant API key API</a> it also contains
a <code class="literal">grant</code> config object.
</dd>
<dt>
<span class="term">
<code class="literal">invalidate</code>
</span>
</dt>
<dd>
The object representation of the security configuration that is being invalidated.
The only config that currently supports invalidation is <code class="literal">apikeys</code>, through
the <a class="xref" href="security-api-invalidate-api-key.html" title="Invalidate API key API">invalidate API key API</a>.
</dd>
</dl>
</div>
<p>The schemas of the security config objects mentioned above are as follows. They are very similar to the
request bodies of the corresponding security APIs.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">user</code>
</span>
</dt>
<dd>
<p>
An object like:
</p>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">`{"name": &lt;string&gt;, "enabled": &lt;boolean&gt;, "roles": &lt;string_list&gt;,
"full_name": &lt;string&gt;, "email": &lt;string&gt;, "has_password": &lt;boolean&gt;,
"metadata": &lt;object&gt;}`.</pre>
</div>
<p>The <code class="literal">full_name</code>, <code class="literal">email</code> and <code class="literal">metadata</code> fields are omitted if empty.</p>
</dd>
<dt>
<span class="term">
<code class="literal">role</code>
</span>
</dt>
<dd>
<p>
An object like:
</p>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">`{"name": &lt;string&gt;, "role_descriptor": {"cluster": &lt;string_list&gt;, "global":
{"application":{"manage":{&lt;string&gt;:&lt;string_list&gt;}}}, "indices": [                             {"names": &lt;string_list&gt;, "privileges": &lt;string_list&gt;, "field_security":
{"grant": &lt;string_list&gt;, "except": &lt;string_list&gt;}, "query": &lt;string&gt;,
"allow_restricted_indices": &lt;boolean&gt;}], "applications":[{"application": &lt;string&gt;,
"privileges": &lt;string_list&gt;, "resources": &lt;string_list&gt;}], "run_as": &lt;string_list&gt;,
"metadata": &lt;object&gt;}}`.</pre>
</div>
<p>The <code class="literal">global</code>, <code class="literal">field_security</code>, <code class="literal">except</code>, <code class="literal">query</code>,
<code class="literal">allow_restricted_indices</code> and <code class="literal">metadata</code> fields are omitted if empty.</p>
</dd>
<dt>
<span class="term">
<code class="literal">role_mapping</code>
</span>
</dt>
<dd>
<p>
An object like:
</p>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">`{"name": &lt;string&gt;, "roles": &lt;string_list&gt;, "role_templates": [{"template": &lt;string&gt;,
"format": &lt;string&gt;}], "rules": &lt;object&gt;, "enabled": &lt;boolean&gt;, "metadata": &lt;object&gt;}`.</pre>
</div>
<p>The <code class="literal">roles</code> and <code class="literal">role_templates</code> fields are omitted if empty.
The <code class="literal">rules</code> object has a recursively nested schema, identical to what is passed in
the <a class="xref" href="mapping-roles.html" title="Mapping users and groups to roles">API request for mapping roles</a>.</p>
</dd>
<dt>
<span class="term">
<code class="literal">privileges</code>
</span>
</dt>
<dd>
<p>
An array of objects like:
</p>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">`{"application": &lt;string&gt;, "name": &lt;string&gt;, "actions": &lt;string_list&gt;,
"metadata": &lt;object&gt;}`.</pre>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">password</code>
</span>
</dt>
<dd>
<p>
A simple object like:
</p>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">`{"user":{"name": &lt;string&gt;}}`</pre>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">enable</code>
</span>
</dt>
<dd>
<p>
A simple object like:
</p>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">`{"user":{"name": &lt;string&gt;}}`</pre>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">disable</code>
</span>
</dt>
<dd>
<p>
A simple object like:
</p>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">`{"user":{"name": &lt;string&gt;}}`</pre>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">apikey</code>
</span>
</dt>
<dd>
<p>
An object like:
</p>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">`{"id": &lt;string&gt;, "name": &lt;string&gt;, "expiration": &lt;string&gt;, "role_descriptors": [&lt;object&gt;],
"metadata": [&lt;object&gt;]}`</pre>
</div>
<p>The <code class="literal">role_descriptors</code> objects have the same schema as the <code class="literal">role_descriptor</code>
object that is part of the above <code class="literal">role</code> config object.</p>
</dd>
</dl>
</div>
<p>The object for an API key update will differ in that it will not include
a <code class="literal">name</code>.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">grant</code>
</span>
</dt>
<dd>
<p>
An object like:
</p>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">`{"type": &lt;string&gt;, "user": {"name": &lt;string&gt;, "has_password": &lt;boolean&gt;},
"has_access_token": &lt;boolean&gt;}`</pre>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">apikeys</code>
</span>
</dt>
<dd>
<p>
An object like:
</p>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">`{"ids": &lt;string_list&gt;, "name": &lt;string&gt;, "owned_by_authenticated_user":
&lt;boolean&gt;, "user":{"name": &lt;string&gt;, "realm": &lt;string&gt;}}`</pre>
</div>
<p>The object for a bulk API key update will differ in that it will not
include <code class="literal">name</code>, <code class="literal">owned_by_authenticated_user</code>, or <code class="literal">user</code>. Instead, it
may include <code class="literal">metadata</code> and <code class="literal">role_descriptors</code>, which have the same
schemas as the fields in the <code class="literal">apikey</code> config object above.</p>
</dd>
<dt>
<span class="term">
<code class="literal">service_token</code>
</span>
</dt>
<dd>
<p>
An object like:
</p>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">`{"namespace":&lt;string&gt;,"service":&lt;string&gt;,"name":&lt;string&gt;}`</pre>
</div>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_extra_audit_event_attributes_for_specific_events"></a>Extra audit event attributes for specific events<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/security/auditing/event-types.asciidoc">edit</a></h3>
</div></div></div>
<p>There are a few events that have some more attributes in addition to those
that have been previously described:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p><code class="literal">authentication_success</code>:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">realm</code>
</span>
</dt>
<dd>
The name of the realm that successfully authenticated the user.
If authenticated using an API key, this is the special value of
<code class="literal">_es_api_key</code>. This is a shorthand attribute
for the same information that is described by the <code class="literal">user.realm</code>,
<code class="literal">user.run_by.realm</code> and <code class="literal">authentication.type</code> attributes.
</dd>
<dt>
<span class="term">
<code class="literal">user.name</code>
</span>
</dt>
<dd>
The name of the <em>effective</em> user. This is usually the
same as the <em>authenticated</em> user, but if using the
<a class="xref" href="run-as-privilege.html" title="Submitting requests on behalf of other users">run as authorization functionality</a>
this instead denotes the name of the <em>impersonated</em> user.
If authenticated using an API key, this is
the name of the API key owner.
If authenticated using a service account token, this is the
service account principal, i.e. <code class="literal">namespace/service_name</code>.
</dd>
<dt>
<span class="term">
<code class="literal">user.realm</code>
</span>
</dt>
<dd>
Name of the realm to which the <em>effective</em> user
belongs. If authenticated using an API key, this is
the name of the realm to which the API key owner belongs.
</dd>
<dt>
<span class="term">
<code class="literal">user.run_by.name</code>
</span>
</dt>
<dd>
This attribute is present only if the request is
using the <a class="xref" href="run-as-privilege.html" title="Submitting requests on behalf of other users">run as authorization functionality</a>
and denotes the name of the <em>authenticated</em> user,
which is also known as the <em>impersonator</em>.
</dd>
<dt>
<span class="term">
<code class="literal">user.run_by.realm</code>
</span>
</dt>
<dd>
Name of the realm to which the <em>authenticated</em>
(<em>impersonator</em>) user belongs.
This attribute is provided only if the request
uses the <a class="xref" href="run-as-privilege.html" title="Submitting requests on behalf of other users">run as authorization functionality</a>.
</dd>
<dt>
<span class="term">
<code class="literal">authentication.type</code>
</span>
</dt>
<dd>
Method used to authenticate the user.
Possible values are <code class="literal">REALM</code>, <code class="literal">API_KEY</code>, <code class="literal">TOKEN</code>, <code class="literal">ANONYMOUS</code> or <code class="literal">INTERNAL</code>.
</dd>
<dt>
<span class="term">
<code class="literal">apikey.id</code>
</span>
</dt>
<dd>
API key ID returned by the <a class="xref" href="security-api-create-api-key.html" title="Create API key API">create API key</a> request.
This attribute is only provided for authentication using an API key.
</dd>
<dt>
<span class="term">
<code class="literal">apikey.name</code>
</span>
</dt>
<dd>
API key name provided in the <a class="xref" href="security-api-create-api-key.html" title="Create API key API">create API key</a> request.
This attribute is only provided for authentication using an API key.
</dd>
<dt>
<span class="term">
<code class="literal">authentication.token.name</code>
</span>
</dt>
<dd>
Name of the <a class="xref" href="service-accounts.html" title="Service accounts">service account</a> token.
This attribute is only provided for authentication using a service account token.
</dd>
<dt>
<span class="term">
<code class="literal">authentication.token.type</code>
</span>
</dt>
<dd>
Type of the <a class="xref" href="service-accounts.html" title="Service accounts">service account</a> token.
This attribute is only provided for authentication using a service account token.
</dd>
</dl>
</div>
</li>
<li class="listitem">
<p><code class="literal">authentication_failed</code>:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">user.name</code>
</span>
</dt>
<dd>
The name of the user that failed authentication.
If the request authentication token is invalid or
unparsable, this information might be missing.
</dd>
<dt>
<span class="term">
<code class="literal">authentication.token.name</code>
</span>
</dt>
<dd>
Name of the <a class="xref" href="service-accounts.html" title="Service accounts">service account</a> token.
This attribute is only provided for authentication using a service account token.
If the request authentication token is invalid or unparsable,
this information might be missing.
</dd>
<dt>
<span class="term">
<code class="literal">authentication.token.type</code>
</span>
</dt>
<dd>
Type of the <a class="xref" href="service-accounts.html" title="Service accounts">service account</a> token.
This attribute is only provided for authentication using a service account token.
If the request authentication token is invalid or unparsable,
this information might be missing.
</dd>
</dl>
</div>
</li>
<li class="listitem">
<p><code class="literal">realm_authentication_failed</code>:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">user.name</code>
</span>
</dt>
<dd>
The name of the user that failed authentication.
</dd>
<dt>
<span class="term">
<code class="literal">realm</code>
</span>
</dt>
<dd>
The name of the realm that rejected this authentication.
<span class="strong strong"><strong>This event is generated for each consulted realm
in the chain.</strong></span>
</dd>
</dl>
</div>
</li>
<li class="listitem">
<p><code class="literal">run_as_denied</code> and <code class="literal">run_as_granted</code>:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">user.roles</code>
</span>
</dt>
<dd>
The role names as an array of the <em>authenticated</em> user which is being
granted or denied the <em>impersonation</em> action.
If authenticated as a <a class="xref" href="service-accounts.html" title="Service accounts">service account</a>,
this is always an empty array.
</dd>
<dt>
<span class="term">
<code class="literal">user.name</code>
</span>
</dt>
<dd>
The name of the <em>authenticated</em> user which is being
granted or denied the <em>impersonation</em> action.
</dd>
<dt>
<span class="term">
<code class="literal">user.realm</code>
</span>
</dt>
<dd>
The realm name that the <em>authenticated</em> user belongs to.
</dd>
<dt>
<span class="term">
<code class="literal">user.run_as.name</code>
</span>
</dt>
<dd>
The name of the user as which the <em>impersonation</em>
action is granted or denied.
</dd>
<dt>
<span class="term">
<code class="literal">user.run_as.realm</code>
</span>
</dt>
<dd>
The realm name of that the <em>impersonated</em> user belongs to.
</dd>
</dl>
</div>
</li>
<li class="listitem">
<p><code class="literal">access_granted</code> and <code class="literal">access_denied</code>:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">user.roles</code>
</span>
</dt>
<dd>
The role names of the user as an array. If authenticated
using an API key, this contains the
role names of the API key owner.
If authenticated as a <a class="xref" href="service-accounts.html" title="Service accounts">service account</a>,
this is always an empty array.
</dd>
<dt>
<span class="term">
<code class="literal">user.name</code>
</span>
</dt>
<dd>
The name of the <em>effective</em> user. This is usually the
same as the <em>authenticated</em> user, but if using the
<a class="xref" href="run-as-privilege.html" title="Submitting requests on behalf of other users">run as authorization functionality</a>
this instead denotes the name of the <em>impersonated</em> user.
If authenticated using an API key, this is
the name of the API key owner.
</dd>
<dt>
<span class="term">
<code class="literal">user.realm</code>
</span>
</dt>
<dd>
Name of the realm to which the <em>effective</em> user
belongs. If authenticated using an API key, this is
the name of the realm to which the API key owner belongs.
</dd>
<dt>
<span class="term">
<code class="literal">user.run_by.name</code>
</span>
</dt>
<dd>
This attribute is present only if the request is
using the <a class="xref" href="run-as-privilege.html" title="Submitting requests on behalf of other users">run as authorization functionality</a>
and denoted the name of the <em>authenticated</em> user,
which is also known as the <em>impersonator</em>.
</dd>
<dt>
<span class="term">
<code class="literal">user.run_by.realm</code>
</span>
</dt>
<dd>
This attribute is present only if the request is
using the <a class="xref" href="run-as-privilege.html" title="Submitting requests on behalf of other users">run as authorization functionality</a>
and denotes the name of the realm that the <em>authenticated</em>
(<em>impersonator</em>) user belongs to.
</dd>
<dt>
<span class="term">
<code class="literal">authentication.type</code>
</span>
</dt>
<dd>
Method used to authenticate the user.
Possible values are <code class="literal">REALM</code>, <code class="literal">API_KEY</code>, <code class="literal">TOKEN</code>, <code class="literal">ANONYMOUS</code> or <code class="literal">INTERNAL</code>.
</dd>
<dt>
<span class="term">
<code class="literal">apikey.id</code>
</span>
</dt>
<dd>
API key ID returned by the <a class="xref" href="security-api-create-api-key.html" title="Create API key API">create API key</a> request.
This attribute is only provided for authentication using an API key.
</dd>
<dt>
<span class="term">
<code class="literal">apikey.name</code>
</span>
</dt>
<dd>
API key name provided in the <a class="xref" href="security-api-create-api-key.html" title="Create API key API">create API key</a> request.
This attribute is only provided for authentication using an API key.
</dd>
<dt>
<span class="term">
<code class="literal">authentication.token.name</code>
</span>
</dt>
<dd>
Name of the <a class="xref" href="service-accounts.html" title="Service accounts">service account</a> token.
This attribute is only provided for authentication using a service account token.
</dd>
<dt>
<span class="term">
<code class="literal">authentication.token.type</code>
</span>
</dt>
<dd>
Type of the <a class="xref" href="service-accounts.html" title="Service accounts">service account</a> token.
This attribute is only provided for authentication using a service account token.
</dd>
</dl>
</div>
</li>
</ul>
</div>
</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="enable-audit-logging.html">« Enable audit logging</a>
</span>
<span class="next">
<a href="audit-log-output.html">Logfile audit output »</a>
</span>
</div>
</body>
</html>
