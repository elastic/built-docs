<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="keywords" content="Elasticsearch diagnostic, diagnostics">
<title>Move to lifecycle step API | Elasticsearch Guide [master] | Elastic</title>
<meta class="elastic" name="content" content="Move to lifecycle step API | Elasticsearch Guide [master]">

<link rel="home" href="index.html" title="Elasticsearch Guide [master]"/>
<link rel="up" href="index-lifecycle-management-api.html" title="Index lifecycle management APIs"/>
<link rel="prev" href="ilm-delete-lifecycle.html" title="Delete lifecycle policy API"/>
<link rel="next" href="ilm-remove-policy.html" title="Remove policy from index API"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="Elasticsearch"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/master"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="master"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
This documentation contains work-in-progress information for future Elastic Stack and Cloud releases. Use the version selector to view supported release docs. It also contains some Elastic Cloud serverless information. Check out our <a href="https://www.elastic.co/docs/current/serverless">serverless docs</a> for more details.
</div>
<div class="navheader">
<span class="prev">
<a href="ilm-delete-lifecycle.html">« Delete lifecycle policy API</a>
</span>
<span class="next">
<a href="ilm-remove-policy.html">Remove policy from index API »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elasticsearch Guide [master]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="rest-apis.html">REST APIs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index-lifecycle-management-api.html">Index lifecycle management APIs</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Move to lifecycle step API</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/ilm/apis/move-to-step.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="ilm-move-to-step"></a>Move to lifecycle step API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/ilm/apis/move-to-step.asciidoc">edit</a></h2>
</div></div></div>

<p>Triggers execution of a specific step in the lifecycle policy.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ilm-move-to-step-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/ilm/apis/move-to-step.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">POST _ilm/move/&lt;index&gt;</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ilm-move-to-step-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/ilm/apis/move-to-step.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If the Elasticsearch security features are enabled, you must have the <code class="literal">manage_ilm</code>
privileges on the indices being managed to use this API. For more information,
see <a class="xref" href="security-privileges.html" title="Security privileges">Security privileges</a>.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ilm-move-to-step-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/ilm/apis/move-to-step.asciidoc">edit</a></h3>
</div></div></div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This operation can result in the loss of data. Manually moving an index
into a specific step executes that step even if it has already been performed.
This is a potentially destructive action and this should be considered an expert
level API.</p>
</div>
</div>
<p>Manually moves an index into the specified step and executes that step.
You must specify both the current step and the step to be executed in the
body of the request.</p>
<p>The request will fail if the current step does not match the step currently
being executed for the index. This is to prevent the index from being moved from
an unexpected step into the next step.</p>
<p>When specifying the target (<code class="literal">next_step</code>) to which the index will be moved, either the <code class="literal">name</code> or both
the <code class="literal">action</code> and <code class="literal">name</code> fields are optional. If only the phase is specified, the index will move to
the first step of the first action in the target phase. If the phase and action are specified, the index will move to
the first step of the specified action in the specified phase. Only actions specified in the ILM
policy are considered valid, an index cannot move to a step that is not part of its policy.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ilm-move-to-step-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/ilm/apis/move-to-step.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;index&gt;</code>
</span>
</dt>
<dd>
(Required, string) Identifier for the index.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ilm-move-to-step-query-params"></a>Query parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/ilm/apis/move-to-step.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">master_timeout</code>
</span>
</dt>
<dd>
(Optional, <a class="xref" href="api-conventions.html#time-units" title="Time units">time units</a>)
Period to wait for the master node. If the master node is not available before
the timeout expires, the request fails and returns an error. Defaults to <code class="literal">30s</code>.
Can also be set to <code class="literal">-1</code> to indicate that the request should never timeout.
</dd>
<dt>
<span class="term">
<code class="literal">timeout</code>
</span>
</dt>
<dd>
(Optional, <a class="xref" href="api-conventions.html#time-units" title="Time units">time units</a>) Period to wait for a response from all relevant nodes in the cluster after updating the cluster metadata.
If no response is received before the timeout expires, the cluster metadata update still applies but the response will indicate that it was not completely acknowledged.
Defaults to <code class="literal">30s</code>.
Can also be set to <code class="literal">-1</code> to indicate that the request should never timeout.
</dd>
</dl>
</div>
</div>

<div class="section child_attributes">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ilm-move-to-step-request-body"></a>Request body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/ilm/apis/move-to-step.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">current_step</code>
</span>
</dt>
<dd>
<p>
(Required, object)
</p>
<details open>
<summary class="title">Properties of <code class="literal">current_step</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">phase</code>
</span>
</dt>
<dd>
(Required, string)
The name of the current phase.
Must match the phase as returned by the <a class="xref" href="ilm-explain-lifecycle.html" title="Explain lifecycle API">explain</a> API.
</dd>
<dt>
<span class="term">
<code class="literal">action</code>
</span>
</dt>
<dd>
(Required, string)
The name of the current action.
Must match the action as returned by the <a class="xref" href="ilm-explain-lifecycle.html" title="Explain lifecycle API">explain</a> API.
</dd>
<dt>
<span class="term">
<code class="literal">name</code>
</span>
</dt>
<dd>
(Required, string)
The name of the current step.
Must match the step as returned by the <a class="xref" href="ilm-explain-lifecycle.html" title="Explain lifecycle API">explain</a> API.
If ILM encounters a problem while performing an action,
it halts execution of the policy and transitions to the <code class="literal">ERROR</code> step.
If you are trying to advance a policy after troubleshooting a failure,
you specify this <code class="literal">ERROR</code> step as the current step.
For more information, see <a class="xref" href="index-lifecycle-error-handling.html" title="Troubleshooting index lifecycle management errors">ILM error handling</a>.
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">next_step</code>
</span>
</dt>
<dd>
<p>
(Required, object)
</p>
<details open>
<summary class="title">Properties of <code class="literal">next_step</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">phase</code>
</span>
</dt>
<dd>
(Required, string)
The name of the phase that contains the action you want to perform or resume.
</dd>
<dt>
<span class="term">
<code class="literal">action</code>
</span>
</dt>
<dd>
(Optional, string)
The name action you want to perform or resume. Required if <code class="literal">name</code> used.
</dd>
<dt>
<span class="term">
<code class="literal">name</code>
</span>
</dt>
<dd>
(Optional, string)
The name of the step to move to and execute. Required if <code class="literal">action</code> used.
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ilm-move-to-step-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/ilm/apis/move-to-step.asciidoc">edit</a></h3>
</div></div></div>
<p>The following example moves <code class="literal">my-index-000001</code> from the initial step to the
<code class="literal">forcemerge</code> step:</p>
<div class="pre_wrapper lang-js alternative">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js alternative">const response = await client.ilm.moveToStep({
  index: "my-index-000001",
  current_step: {
    phase: "new",
    action: "complete",
    name: "complete",
  },
  next_step: {
    phase: "warm",
    action: "forcemerge",
    name: "forcemerge",
  },
});
console.log(response);</pre>
</div>
<a id="a45605347d6438e7aecdf3b37198616d"></a>
<div class="pre_wrapper lang-console default has-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console default has-js">POST _ilm/move/my-index-000001
{
  "current_step": { <a id="CO791-1"></a><i class="conum" data-value="1"></i>
    "phase": "new",
    "action": "complete",
    "name": "complete"
  },
  "next_step": { <a id="CO791-2"></a><i class="conum" data-value="2"></i>
    "phase": "warm",
    "action": "forcemerge", <a id="CO791-3"></a><i class="conum" data-value="3"></i>
    "name": "forcemerge" <a id="CO791-4"></a><i class="conum" data-value="4"></i>
  }
}</pre>
</div>
<div class="console_widget has-js" data-snippet="snippets/2840.console"></div>
<div class="calloutlist default has-js lang-console">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO791-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>The step that the index is expected to be in</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO791-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>The step that you want to execute</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO791-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>The optional action to which the index will be moved</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO791-4"><i class="conum" data-value="4"></i></a></p>
</td>
<td align="left" valign="top">
<p>The optional step name to which the index will be moved</p>
</td>
</tr>
</table>
</div>
<p>If the request succeeds, you receive the following result:</p>
<a id="bc5fcc40c29087a0df7b5405bb70de5c"></a>
<div class="pre_wrapper lang-console-result">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console-result">{
  "acknowledged": true
}</pre>
</div>
<p>The request will fail if the index is not in the <code class="literal">new</code> phase as specified
by the <code class="literal">current_step</code>.</p>
<p>The following example pushes <code class="literal">my-index-000001</code> from the end of hot phase into
the start of warm:</p>
<div class="pre_wrapper lang-js alternative">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js alternative">const response = await client.ilm.moveToStep({
  index: "my-index-000001",
  current_step: {
    phase: "hot",
    action: "complete",
    name: "complete",
  },
  next_step: {
    phase: "warm",
  },
});
console.log(response);</pre>
</div>
<a id="46064e81620162a23e75002a7eeb8b10"></a>
<div class="pre_wrapper lang-console default has-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console default has-js">POST _ilm/move/my-index-000001
{
  "current_step": {
    "phase": "hot",
    "action": "complete",
    "name": "complete"
  },
  "next_step": {
    "phase": "warm"
  }
}</pre>
</div>
<div class="console_widget has-js" data-snippet="snippets/2841.console"></div>
</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="ilm-delete-lifecycle.html">« Delete lifecycle policy API</a>
</span>
<span class="next">
<a href="ilm-remove-policy.html">Remove policy from index API »</a>
</span>
</div>
</body>
</html>
