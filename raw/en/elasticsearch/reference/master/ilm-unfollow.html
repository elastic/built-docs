<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Unfollow | Elasticsearch Guide [master] | Elastic</title>
<meta class="elastic" name="content" content="Unfollow | Elasticsearch Guide [master]">

<link rel="home" href="index.html" title="Elasticsearch Guide [master]"/>
<link rel="up" href="ilm-actions.html" title="Index lifecycle actions"/>
<link rel="prev" href="ilm-shrink.html" title="Shrink"/>
<link rel="next" href="ilm-wait-for-snapshot.html" title="Wait for snapshot"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="Elasticsearch"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/master"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="master"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
This documentation contains work-in-progress information for future Elastic Stack and Cloud releases. Use the version selector to view supported release docs. It also contains some Elastic Cloud serverless information. Check out our <a href="https://www.elastic.co/docs/current/serverless">serverless docs</a> for more details.
</div>
<div class="navheader">
<span class="prev">
<a href="ilm-shrink.html">« Shrink</a>
</span>
<span class="next">
<a href="ilm-wait-for-snapshot.html">Wait for snapshot »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elasticsearch Guide [master]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="data-management.html">Data management</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="ilm-actions.html">Index lifecycle actions</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Unfollow</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/ilm/actions/ilm-unfollow.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="ilm-unfollow"></a>Unfollow<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/ilm/actions/ilm-unfollow.asciidoc">edit</a></h2>
</div></div></div>
<p>Phases allowed: hot, warm, cold, frozen.</p>
<p>Converts a <a href="/guide/en/elasticsearch/reference/master/ccr-apis.html" class="ulink" target="_top">CCR</a> follower index into a regular index.
This enables the shrink, rollover, and searchable snapshot actions
to be performed safely on follower indices.
You can also use unfollow directly when moving follower indices through the lifecycle.
Has no effect on indices that are not followers, phase execution just moves to the next action.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This action is triggered automatically by the <a class="xref" href="ilm-rollover.html" title="Rollover">rollover</a>,
<a class="xref" href="ilm-shrink.html" title="Shrink">shrink</a>, and
<a class="xref" href="ilm-searchable-snapshot.html" title="Searchable snapshot">searchable snapshot</a> actions when they are
applied to follower indices.</p>
</div>
</div>
<p>This action waits until is it safe to convert a follower index into a regular index.
The following conditions must be met:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
The leader index must have <code class="literal">index.lifecycle.indexing_complete</code> set to <code class="literal">true</code>.
This happens automatically if the leader index is rolled over using the
<a class="xref" href="ilm-rollover.html" title="Rollover">rollover</a> action, and can be set manually using
the <a class="xref" href="indices-update-settings.html" title="Update index settings API">index settings</a> API.
</li>
<li class="listitem">
All operations performed on the leader index have been replicated to the follower index.
This ensures that no operations are lost when the index is converted.
</li>
</ul>
</div>
<p>Once these conditions are met, unfollow performs the following operations:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Pauses indexing following for the follower index.
</li>
<li class="listitem">
Closes the follower index.
</li>
<li class="listitem">
Unfollows the leader index.
</li>
<li class="listitem">
Opens the follower index (which is at this point is a regular index).
</li>
</ul>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ilm-unfollow-options"></a>Options<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/ilm/actions/ilm-unfollow.asciidoc">edit</a></h3>
</div></div></div>
<p>None.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ilm-unfollow-ex"></a>Example<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/ilm/actions/ilm-unfollow.asciidoc">edit</a></h3>
</div></div></div>
<div class="pre_wrapper lang-ruby alternative">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ruby alternative">response = client.ilm.put_lifecycle(
  policy: 'my_policy',
  body: {
    policy: {
      phases: {
        hot: {
          actions: {
            unfollow: {}
          }
        }
      }
    }
  }
)
puts response</pre>
</div>
<div class="pre_wrapper lang-js alternative">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js alternative">const response = await client.ilm.putLifecycle({
  name: "my_policy",
  policy: {
    phases: {
      hot: {
        actions: {
          unfollow: {},
        },
      },
    },
  },
});
console.log(response);</pre>
</div>
<a id="a5a58e8ad66afe831bc295500e3e8739"></a>
<div class="pre_wrapper lang-console default has-ruby has-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console default has-ruby has-js">PUT _ilm/policy/my_policy
{
  "policy": {
    "phases": {
      "hot": {
        "actions": {
          "unfollow" : {}
        }
      }
    }
  }
}</pre>
</div>
<div class="console_widget has-ruby has-js" data-snippet="snippets/1848.console"></div>
</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="ilm-shrink.html">« Shrink</a>
</span>
<span class="next">
<a href="ilm-wait-for-snapshot.html">Wait for snapshot »</a>
</span>
</div>
</body>
</html>
