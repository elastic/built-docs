<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Important Elasticsearch configuration | Elasticsearch Guide [master] | Elastic</title>
<meta class="elastic" name="content" content="Important Elasticsearch configuration | Elasticsearch Guide [master]">

<link rel="home" href="index.html" title="Elasticsearch Guide [master]"/>
<link rel="up" href="settings.html" title="Configuring Elasticsearch"/>
<link rel="prev" href="settings.html" title="Configuring Elasticsearch"/>
<link rel="next" href="secure-settings.html" title="Secure settings"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="Elasticsearch"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/master"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="master"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
This documentation contains work-in-progress information for future Elastic Stack and Cloud releases. Use the version selector to view supported release docs. It also contains some Elastic Cloud serverless information. Check out our <a href="https://www.elastic.co/docs/current/serverless">serverless docs</a> for more details.
</div>
<div class="navheader">
<span class="prev">
<a href="settings.html">« Configuring Elasticsearch</a>
</span>
<span class="next">
<a href="secure-settings.html">Secure settings »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elasticsearch Guide [master]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="setup.html">Set up Elasticsearch</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="settings.html">Configuring Elasticsearch</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Important Elasticsearch configuration</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/setup/important-settings.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="important-settings"></a>Important Elasticsearch configuration<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/setup/important-settings.asciidoc">edit</a></h2>
</div></div></div>
<p>Elasticsearch requires very little configuration to get started, but there are a number
of items which <span class="strong strong"><strong>must</strong></span> be considered before using your cluster in production:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="important-settings.html#path-settings" title="Path settings">Path settings</a>
</li>
<li class="listitem">
<a class="xref" href="important-settings.html#cluster-name" title="Cluster name setting">Cluster name setting</a>
</li>
<li class="listitem">
<a class="xref" href="important-settings.html#node-name" title="Node name setting">Node name setting</a>
</li>
<li class="listitem">
<a class="xref" href="important-settings.html#network.host" title="Network host setting">Network host settings</a>
</li>
<li class="listitem">
<a class="xref" href="important-settings.html#discovery-settings" title="Discovery and cluster formation settings">Discovery settings</a>
</li>
<li class="listitem">
<a class="xref" href="important-settings.html#heap-size-settings" title="Heap size settings">Heap size settings</a>
</li>
<li class="listitem">
<a class="xref" href="important-settings.html#heap-dump-path" title="JVM heap dump path setting">JVM heap dump path setting</a>
</li>
<li class="listitem">
<a class="xref" href="important-settings.html#gc-logging" title="GC logging settings">GC logging settings</a>
</li>
<li class="listitem">
<a class="xref" href="important-settings.html#es-tmpdir" title="Temporary directory settings">Temporary directory settings</a>
</li>
<li class="listitem">
<a class="xref" href="important-settings.html#error-file-path" title="JVM fatal error log setting">JVM fatal error log setting</a>
</li>
<li class="listitem">
<a class="xref" href="important-settings.html#important-settings-backups" title="Cluster backups">Cluster backups</a>
</li>
</ul>
</div>
<p>Our <a href="/cloud/elasticsearch-service/signup?page=docs&amp;placement=docs-body" class="ulink" target="_top">Elastic Cloud</a> service configures these items automatically, making
your cluster production-ready by default.</p>
<h4><a id="path-settings"></a>Path settings<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/setup/important-settings/path-settings.asciidoc">edit</a></h4>
<p>Elasticsearch writes the data you index to indices and data streams to a <code class="literal">data</code>
directory. Elasticsearch writes its own application logs, which contain information about
cluster health and operations, to a <code class="literal">logs</code> directory.</p>
<p>For <a class="xref" href="targz.html" title="Install Elasticsearch from archive on Linux or MacOS">macOS <code class="literal">.tar.gz</code></a>, <a class="xref" href="targz.html" title="Install Elasticsearch from archive on Linux or MacOS">Linux <code class="literal">.tar.gz</code></a>, and
<a class="xref" href="zip-windows.html" title="Install Elasticsearch with .zip on Windows">Windows <code class="literal">.zip</code></a> installations, <code class="literal">data</code> and <code class="literal">logs</code> are
subdirectories of <code class="literal">$ES_HOME</code> by default. However, files in <code class="literal">$ES_HOME</code> risk
deletion during an upgrade.</p>
<p>In production, we strongly recommend you set the <code class="literal">path.data</code> and <code class="literal">path.logs</code> in
<code class="literal">elasticsearch.yml</code> to locations outside of <code class="literal">$ES_HOME</code>. <a class="xref" href="docker.html" title="Install Elasticsearch with Docker">Docker</a>,
<a class="xref" href="deb.html" title="Install Elasticsearch with Debian Package">Debian</a>, and <a class="xref" href="rpm.html" title="Install Elasticsearch with RPM">RPM</a> installations write
data and log to locations outside of <code class="literal">$ES_HOME</code> by default.</p>
<p>Supported <code class="literal">path.data</code> and <code class="literal">path.logs</code> values vary by platform:</p>
<div class="tabs" data-tab-group="os">
  <div role="tablist" aria-label="data-log-path">
    <button role="tab"
            aria-selected="true"
            aria-controls="unix-tab-data-log-path"
            id="unix-data-log-path">
      Unix-like systems
    </button>
    <button role="tab"
            aria-selected="false"
            aria-controls="win-tab-data-log-path"
            id="win-data-log-path">
      Windows
    </button>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="unix-tab-data-log-path"
       aria-labelledby="unix-data-log-path">
<p>Linux and macOS installations support Unix-style paths:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">path:
  data: /var/data/elasticsearch
  logs: /var/log/elasticsearch</pre>
</div>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="win-tab-data-log-path"
       aria-labelledby="win-data-log-path"
       hidden="">
<p>Windows installations support DOS paths with escaped backslashes:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">path:
  data: "C:\\Elastic\\Elasticsearch\\data"
  logs: "C:\\Elastic\\Elasticsearch\\logs"</pre>
</div>
  </div>
</div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>Don&#8217;t modify anything within the data directory or run processes that
might interfere with its contents. If something other than Elasticsearch modifies the
contents of the data directory, then Elasticsearch may fail, reporting corruption or
other data inconsistencies, or may appear to work correctly having silently
lost some of your data. Don&#8217;t attempt to take filesystem backups of the data
directory; there is no supported way to restore such a backup. Instead, use
<a class="xref" href="snapshot-restore.html" title="Snapshot and restore">Snapshot and restore</a> to take backups safely. Don&#8217;t run virus scanners on the
data directory. A virus scanner can prevent Elasticsearch from working correctly and may
modify the contents of the data directory. The data directory contains no
executables so a virus scan will only find false positives.</p>
</div>
</div>
<h4><a id="_multiple_data_paths"></a>Multiple data paths<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/setup/important-settings/path-settings.asciidoc">edit</a></h4>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>Deprecated in 7.13.0.</p>
</div>
</div>
<p>If needed, you can specify multiple paths in <code class="literal">path.data</code>. Elasticsearch stores the node&#8217;s
data across all provided paths but keeps each shard&#8217;s data on the same path.</p>
<p>Elasticsearch does not balance shards across a node&#8217;s data paths. High disk
usage in a single path can trigger a <a class="xref" href="modules-cluster.html#disk-based-shard-allocation" title="Disk-based shard allocation settings">high disk
usage watermark</a> for the entire node. If triggered, Elasticsearch will not add shards to
the node, even if the node’s other paths have available disk space. If you need
additional disk space, we recommend you add a new node rather than additional
data paths.</p>
<div class="tabs" data-tab-group="os">
  <div role="tablist" aria-label="multi-data-path">
    <button role="tab"
            aria-selected="true"
            aria-controls="unix-tab-multi-data-path"
            id="unix-multi-data-path">
      Unix-like systems
    </button>
    <button role="tab"
            aria-selected="false"
            aria-controls="win-tab-multi-data-path"
            id="win-multi-data-path">
      Windows
    </button>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="unix-tab-multi-data-path"
       aria-labelledby="unix-multi-data-path">
<p>Linux and macOS installations support multiple Unix-style paths in <code class="literal">path.data</code>:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">path:
  data:
    - /mnt/elasticsearch_1
    - /mnt/elasticsearch_2
    - /mnt/elasticsearch_3</pre>
</div>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="win-tab-multi-data-path"
       aria-labelledby="win-multi-data-path"
       hidden="">
<p>Windows installations support multiple DOS paths in <code class="literal">path.data</code>:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">path:
  data:
    - "C:\\Elastic\\Elasticsearch_1"
    - "E:\\Elastic\\Elasticsearch_1"
    - "F:\\Elastic\\Elasticsearch_3"</pre>
</div>
  </div>
</div>
<h4><a id="mdp-migrate"></a>Migrate from multiple data paths<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/setup/important-settings/path-settings.asciidoc">edit</a></h4>
<p>Support for multiple data paths was deprecated in 7.13 and will be removed
in a future release.</p>
<p>As an alternative to multiple data paths, you can create a filesystem which
spans multiple disks with a hardware virtualisation layer such as RAID, or a
software virtualisation layer such as Logical Volume Manager (LVM) on Linux or
Storage Spaces on Windows. If you wish to use multiple data paths on a single
machine then you must run one node for each data path.</p>
<p>If you currently use multiple data paths in a
<a href="/guide/en/elasticsearch/reference/master/high-availability-cluster-design.html" class="ulink" target="_top">highly available cluster</a> then you
can migrate to a setup that uses a single path for each node without downtime
using a process similar to a
<a href="/guide/en/elasticsearch/reference/master/restart-cluster.html#restart-cluster-rolling" class="ulink" target="_top">rolling restart</a>: shut each
node down in turn and replace it with one or more nodes each configured to use
a single data path. In more detail, for each node that currently has multiple
data paths you should follow the following process. In principle you can
perform this migration during a rolling upgrade to 8.0, but we recommend
migrating to a single-data-path setup before starting to upgrade.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Take a snapshot to protect your data in case of disaster.
</li>
<li class="listitem">
<p>Optionally, migrate the data away from the target node by using an
<a href="/guide/en/elasticsearch/reference/master/modules-cluster.html#cluster-shard-allocation-filtering" class="ulink" target="_top">allocation filter</a>:</p>
<div class="pre_wrapper lang-ruby alternative">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ruby alternative">response = client.cluster.put_settings(
  body: {
    persistent: {
      'cluster.routing.allocation.exclude._name' =&gt; 'target-node-name'
    }
  }
)
puts response</pre>
</div>
<a id="3da35090e093c2d83c3b7d0d83bcb4ae"></a>
<div class="pre_wrapper lang-console default has-ruby">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console default has-ruby">PUT _cluster/settings
{
  "persistent": {
    "cluster.routing.allocation.exclude._name": "target-node-name"
  }
}</pre>
</div>
<div class="console_widget has-ruby" data-snippet="snippets/7.console"></div>
<p>You can use the <a href="/guide/en/elasticsearch/reference/master/cat-allocation.html" class="ulink" target="_top">cat allocation API</a> to track progress
of this data migration. If some shards do not migrate then the
<a href="/guide/en/elasticsearch/reference/master/cluster-allocation-explain.html" class="ulink" target="_top">cluster allocation explain API</a> will help
you to determine why.</p>
</li>
<li class="listitem">
Follow the steps in the
<a href="/guide/en/elasticsearch/reference/master/restart-cluster.html#restart-cluster-rolling" class="ulink" target="_top">rolling restart process</a>
up to and including shutting the target node down.
</li>
<li class="listitem">
Ensure your cluster health is <code class="literal">yellow</code> or <code class="literal">green</code>, so that there is a copy
of every shard assigned to at least one of the other nodes in your cluster.
</li>
<li class="listitem">
<p>If applicable, remove the allocation filter applied in the earlier step.</p>
<div class="pre_wrapper lang-ruby alternative">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ruby alternative">response = client.cluster.put_settings(
  body: {
    persistent: {
      'cluster.routing.allocation.exclude._name' =&gt; nil
    }
  }
)
puts response</pre>
</div>
<a id="daae2e6acebc84e537764f4ba07f2e6e"></a>
<div class="pre_wrapper lang-console default has-ruby">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console default has-ruby">PUT _cluster/settings
{
  "persistent": {
    "cluster.routing.allocation.exclude._name": null
  }
}</pre>
</div>
<div class="console_widget has-ruby" data-snippet="snippets/8.console"></div>
</li>
<li class="listitem">
Discard the data held by the stopped node by deleting the contents of its
data paths.
</li>
<li class="listitem">
Reconfigure your storage. For instance, combine your disks into a single
filesystem using LVM or Storage Spaces. Ensure that your reconfigured storage
has sufficient space for the data that it will hold.
</li>
<li class="listitem">
Reconfigure your node by adjusting the <code class="literal">path.data</code> setting in its
<code class="literal">elasticsearch.yml</code> file. If needed, install more nodes each with their own
<code class="literal">path.data</code> setting pointing at a separate data path.
</li>
<li class="listitem">
Start the new nodes and follow the rest of the
<a href="/guide/en/elasticsearch/reference/master/restart-cluster.html#restart-cluster-rolling" class="ulink" target="_top">rolling restart process</a> for
them.
</li>
<li class="listitem">
Ensure your cluster health is <code class="literal">green</code>, so that every shard has been
assigned.
</li>
</ol>
</div>
<p>You can alternatively add some number of single-data-path nodes to your
cluster, migrate all your data over to these new nodes using
<a href="/guide/en/elasticsearch/reference/master/modules-cluster.html#cluster-shard-allocation-filtering" class="ulink" target="_top">allocation filters</a>,
and then remove the old nodes from the cluster. This approach will temporarily
double the size of your cluster so it will only work if you have the capacity to
expand your cluster like this.</p>
<p>If you currently use multiple data paths but your cluster is not highly
available then you can migrate to a non-deprecated configuration by taking
a snapshot, creating a new cluster with the desired configuration and restoring
the snapshot into it.</p>
<h4><a id="cluster-name"></a>Cluster name setting<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/setup/important-settings/cluster-name.asciidoc">edit</a></h4>
<p>A node can only join a cluster when it shares its <code class="literal">cluster.name</code> with all the
other nodes in the cluster. The default name is <code class="literal">elasticsearch</code>, but you should
change it to an appropriate name that describes the purpose of the cluster.</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">cluster.name: logging-prod</pre>
</div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Do not reuse the same cluster names in different environments.
Otherwise, nodes might join the wrong cluster.</p>
</div>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Changing the name of a cluster requires a <a class="xref" href="restart-cluster.html#restart-cluster-full" title="Full-cluster restart">full
cluster restart</a>.</p>
</div>
</div>
<h4><a id="node-name"></a>Node name setting<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/setup/important-settings/node-name.asciidoc">edit</a></h4>
<p>Elasticsearch uses <code class="literal">node.name</code> as a human-readable identifier for a
particular instance of Elasticsearch. This name is included in the response
of many APIs. The node name defaults to the hostname of the machine when
Elasticsearch starts, but can be configured explicitly in
<code class="literal">elasticsearch.yml</code>:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">node.name: prod-data-2</pre>
</div>
<h4><a id="network.host"></a>Network host setting<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/setup/important-settings/network-host.asciidoc">edit</a></h4>
<p>By default, Elasticsearch only binds to loopback addresses such as <code class="literal">127.0.0.1</code> and
<code class="literal">[::1]</code>. This is sufficient to run a cluster of one or more nodes on a single
server for development and testing, but a
<a class="xref" href="high-availability-cluster-design.html" title="Designing for resilience">resilient production cluster</a> must involve
nodes on other servers. There are many <a class="xref" href="modules-network.html" title="Networking">network settings</a> but
usually all you need to configure is <code class="literal">network.host</code>:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">network.host: 192.168.1.10</pre>
</div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>When you provide a value for <code class="literal">network.host</code>, Elasticsearch assumes that you
are moving from development mode to production mode, and upgrades a number of
system startup checks from warnings to exceptions. See the differences between
<a class="xref" href="system-config.html#dev-vs-prod" title="Development mode vs production mode">development and production modes</a>.</p>
</div>
</div>
<h4><a id="discovery-settings"></a>Discovery and cluster formation settings<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/setup/important-settings/discovery-settings.asciidoc">edit</a></h4>
<p>Configure two important discovery and cluster formation settings before going
to production so that nodes in the cluster can discover each other and elect a
master node.</p>
<h5><a id="unicast.hosts"></a><code class="literal">discovery.seed_hosts</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/setup/important-settings/discovery-settings.asciidoc">edit</a></h5>
<p>Out of the box, without any network configuration, Elasticsearch will bind to
the available loopback addresses and scan local ports <code class="literal">9300</code> to <code class="literal">9305</code> to
connect with other nodes running on the same server. This behavior provides an
auto-clustering experience without having to do any configuration.</p>
<p>When you want to form a cluster with nodes on other hosts, use the
<a class="xref" href="settings.html#static-cluster-setting">static</a> <code class="literal">discovery.seed_hosts</code> setting. This setting
provides a list of other nodes in the cluster
that are master-eligible and likely to be live and contactable to seed
the <a class="xref" href="discovery-hosts-providers.html" title="Discovery">discovery process</a>. This setting
accepts a YAML sequence or array of the addresses of all the master-eligible
nodes in the cluster. Each address can be either an IP address or a hostname
that resolves to one or more IP addresses via DNS.</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">discovery.seed_hosts:
   - 192.168.1.10:9300
   - 192.168.1.11 <a id="CO9-1"></a><i class="conum" data-value="1"></i>
   - seeds.mydomain.com <a id="CO9-2"></a><i class="conum" data-value="2"></i>
   - [0:0:0:0:0:ffff:c0a8:10c]:9301 <a id="CO9-3"></a><i class="conum" data-value="3"></i></pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO9-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>The port is optional and defaults to <code class="literal">9300</code>, but can
be <a class="xref" href="discovery-hosts-providers.html#built-in-hosts-providers" title="Seed hosts providers">overridden</a>.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO9-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>If a hostname resolves to multiple IP addresses, the node will attempt to
discover other nodes at all resolved addresses.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO9-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>IPv6 addresses must be enclosed in square brackets.</p>
</td>
</tr>
</table>
</div>
<p>If your master-eligible nodes do not have fixed names or addresses, use an
<a class="xref" href="discovery-hosts-providers.html#built-in-hosts-providers" title="Seed hosts providers">alternative hosts provider</a> to find their addresses
dynamically.</p>
<h5><a id="initial_master_nodes"></a><code class="literal">cluster.initial_master_nodes</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/setup/important-settings/discovery-settings.asciidoc">edit</a></h5>
<p>When you start an Elasticsearch cluster for the first time, a
<a class="xref" href="modules-discovery-bootstrap-cluster.html" title="Bootstrapping a cluster">cluster bootstrapping</a> step
determines the set of master-eligible nodes whose votes are counted in the
first election. In <a class="xref" href="bootstrap-checks.html#dev-vs-prod-mode" title="Development vs. production mode">development mode</a>, with no discovery
settings configured, this step is performed automatically by the nodes
themselves.</p>
<p>Because auto-bootstrapping is <a class="xref" href="modules-discovery-quorums.html" title="Quorum-based decision making">inherently
unsafe</a>, when starting a new cluster in production
mode, you must explicitly list the master-eligible nodes whose votes should be
counted in the very first election. You set this list using the
<code class="literal">cluster.initial_master_nodes</code> setting.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>After the cluster forms successfully for the first time, remove the
<code class="literal">cluster.initial_master_nodes</code> setting from each node&#8217;s configuration. Do not
use this setting when restarting a cluster or adding a new node to an existing
cluster.</p>
</div>
</div>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">discovery.seed_hosts:
   - 192.168.1.10:9300
   - 192.168.1.11
   - seeds.mydomain.com
   - [0:0:0:0:0:ffff:c0a8:10c]:9301
cluster.initial_master_nodes: <a id="CO10-1"></a><i class="conum" data-value="1"></i>
   - master-node-a
   - master-node-b
   - master-node-c</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO10-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Identify the initial master nodes by their <a class="xref" href="important-settings.html#node-name" title="Node name setting"><code class="literal">node.name</code></a>, which
defaults to their hostname. Ensure that the value in
<code class="literal">cluster.initial_master_nodes</code> matches the <code class="literal">node.name</code> exactly. If you use a
fully-qualified domain name (FQDN) such as <code class="literal">master-node-a.example.com</code> for your
node names, then you must use the FQDN in this list. Conversely, if <code class="literal">node.name</code>
is a bare hostname without any trailing qualifiers, you must also omit the
trailing qualifiers in <code class="literal">cluster.initial_master_nodes</code>.</p>
</td>
</tr>
</table>
</div>
<p>See <a class="xref" href="modules-discovery-bootstrap-cluster.html" title="Bootstrapping a cluster">bootstrapping a cluster</a> and
<a class="xref" href="modules-discovery-settings.html" title="Discovery and cluster formation settings">discovery and cluster formation settings</a>.</p>
<h4><a id="heap-size-settings"></a>Heap size settings<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/setup/important-settings/heap-size.asciidoc">edit</a></h4>
<p>By default, Elasticsearch automatically sets the JVM heap size based on a node&#8217;s
<a class="xref" href="modules-node.html#node-roles" title="Node roles">roles</a> and total memory.
We recommend the default sizing for most production environments.</p>
<p>If needed, you can override the default sizing by manually
<a class="xref" href="advanced-configuration.html#set-jvm-heap-size" title="Set the JVM heap size">setting the JVM heap size</a>.</p>
<h4><a id="heap-dump-path"></a>JVM heap dump path setting<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/setup/important-settings/heap-dump-path.asciidoc">edit</a></h4>
<p>By default, Elasticsearch configures the JVM to dump the heap on out of
memory exceptions to the default data directory. On <a class="xref" href="rpm.html" title="Install Elasticsearch with RPM">RPM</a> and
<a class="xref" href="deb.html" title="Install Elasticsearch with Debian Package">Debian</a> packages, the data directory is <code class="literal">/var/lib/elasticsearch</code>. On
<a class="xref" href="targz.html" title="Install Elasticsearch from archive on Linux or MacOS">Linux and MacOS</a> and <a class="xref" href="zip-windows.html" title="Install Elasticsearch with .zip on Windows">Windows</a> distributions,
the <code class="literal">data</code> directory is located under the root of the Elasticsearch installation.</p>
<p>If this path is not suitable for receiving heap dumps, modify the
<code class="literal">-XX:HeapDumpPath=...</code> entry in <a class="xref" href="advanced-configuration.html#set-jvm-options" title="Set JVM options"><code class="literal">jvm.options</code></a>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If you specify a directory, the JVM will generate a filename for the heap
dump based on the PID of the running instance.
</li>
<li class="listitem">
If you specify a fixed filename instead of a directory, the file must
not exist when the JVM needs to perform a heap dump on an out of memory
exception. Otherwise, the heap dump will fail.
</li>
</ul>
</div>
<h4><a id="gc-logging"></a>GC logging settings<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/setup/important-settings/gc-logging.asciidoc">edit</a></h4>
<p>By default, Elasticsearch enables garbage collection (GC) logs. These are configured in
<a class="xref" href="advanced-configuration.html#set-jvm-options" title="Set JVM options"><code class="literal">jvm.options</code></a> and output to the same default location as
the Elasticsearch logs. The default configuration rotates the logs every 64 MB and
can consume up to 2 GB of disk space.</p>
<p>You can reconfigure JVM logging using the command line options described in
<a href="https://openjdk.java.net/jeps/158" class="ulink" target="_top">JEP 158: Unified JVM Logging</a>. Unless you
change the default <code class="literal">jvm.options</code> file directly, the Elasticsearch default
configuration is applied in addition to your own settings. To disable the
default configuration, first disable logging by supplying the
<code class="literal">-Xlog:disable</code> option, then supply your own command line options. This
disables <em>all</em> JVM logging, so be sure to review the available options
and enable everything that you require.</p>
<p>To see further options not contained in the original JEP, see
<a href="https://docs.oracle.com/en/java/javase/13/docs/specs/man/java.html#enable-logging-with-the-jvm-unified-logging-framework" class="ulink" target="_top">Enable
Logging with the JVM Unified Logging Framework</a>.</p>
<h4><a id="gc-logging-examples"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/setup/important-settings/gc-logging.asciidoc">edit</a></h4>
<p>Change the default GC log output location to <code class="literal">/opt/my-app/gc.log</code> by
  creating <code class="literal">$ES_HOME/config/jvm.options.d/gc.options</code> with some sample
  options:</p>
<div class="pre_wrapper lang-shell">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-shell"># Turn off all previous logging configuratons
-Xlog:disable

# Default settings from JEP 158, but with `utctime` instead of `uptime` to match the next line
-Xlog:all=warning:stderr:utctime,level,tags

# Enable GC logging to a custom location with a variety of options
-Xlog:gc*,gc+age=trace,safepoint:file=/opt/my-app/gc.log:utctime,level,pid,tags:filecount=32,filesize=64m</pre>
</div>
<p>Configure an Elasticsearch <a class="xref" href="docker.html" title="Install Elasticsearch with Docker">Docker container</a> to send GC debug logs to
  standard error (<code class="literal">stderr</code>). This lets the container orchestrator
  handle the output. If using the <code class="literal">ES_JAVA_OPTS</code> environment variable,
  specify:</p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">MY_OPTS="-Xlog:disable -Xlog:all=warning:stderr:utctime,level,tags -Xlog:gc=debug:stderr:utctime"
docker run -e ES_JAVA_OPTS="$MY_OPTS" # etc</pre>
</div>
<h4><a id="es-tmpdir"></a>Temporary directory settings<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/setup/important-settings/es-tmpdir.asciidoc">edit</a></h4>
<p>By default, Elasticsearch uses a private temporary directory that the startup
script creates immediately below the system temporary directory.</p>
<p>On some Linux distributions, a system utility will clean files and directories
from <code class="literal">/tmp</code> if they have not been recently accessed. This behavior can lead to
the private temporary directory being removed while Elasticsearch is running if
features that require the temporary directory are not used for a long time.
Removing the private temporary directory causes problems if a feature that
requires this directory is subsequently used.</p>
<p>If you install Elasticsearch using the <code class="literal">.deb</code> or <code class="literal">.rpm</code> packages and run it
under <code class="literal">systemd</code>, the private temporary directory that Elasticsearch uses
is excluded from periodic cleanup.</p>
<p>If you intend to run the <code class="literal">.tar.gz</code> distribution on Linux or MacOS for
an extended period, consider creating a dedicated temporary
directory for Elasticsearch that is not under a path that will have old files
and directories cleaned from it. This directory should have permissions set
so that only the user that Elasticsearch runs as can access it. Then, set the
<code class="literal">$ES_TMPDIR</code> environment variable to point to this directory before starting
Elasticsearch.</p>
<h4><a id="error-file-path"></a>JVM fatal error log setting<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/setup/important-settings/error-file.asciidoc">edit</a></h4>
<p>By default, Elasticsearch configures the JVM to write fatal error logs
to the default logging directory. On <a class="xref" href="rpm.html" title="Install Elasticsearch with RPM">RPM</a> and <a class="xref" href="deb.html" title="Install Elasticsearch with Debian Package">Debian</a> packages,
this directory is <code class="literal">/var/log/elasticsearch</code>. On <a class="xref" href="targz.html" title="Install Elasticsearch from archive on Linux or MacOS">Linux and MacOS</a> and <a class="xref" href="zip-windows.html" title="Install Elasticsearch with .zip on Windows">Windows</a> distributions, the <code class="literal">logs</code>
directory is located under the root of the Elasticsearch installation.</p>
<p>These are logs produced by the JVM when it encounters a fatal error, such as a
segmentation fault. If this path is not suitable for receiving logs,
modify the <code class="literal">-XX:ErrorFile=...</code> entry in <a class="xref" href="advanced-configuration.html#set-jvm-options" title="Set JVM options"><code class="literal">jvm.options</code></a>.</p>
<h4><a id="important-settings-backups"></a>Cluster backups<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/setup/important-settings/snapshot.asciidoc">edit</a></h4>
<p>In a disaster, <a class="xref" href="snapshot-restore.html" title="Snapshot and restore">snapshots</a> can prevent permanent data loss.
<a class="xref" href="snapshots-take-snapshot.html#automate-snapshots-slm" title="Automate snapshots with SLM">Snapshot lifecycle management</a> is the easiest way to take regular
backups of your cluster. For more information, see <a class="xref" href="snapshots-take-snapshot.html" title="Create a snapshot"><em>Create a snapshot</em></a>.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p><span class="strong strong"><strong>Taking a snapshot is the only reliable and supported way to back up a
cluster.</strong></span> You cannot back up an Elasticsearch cluster by making copies of the data
directories of its nodes. There are no supported methods to restore any data
from a filesystem-level backup. If you try to restore a cluster from such a
backup, it may fail with reports of corruption or missing files or other data
inconsistencies, or it may appear to have succeeded having silently lost some of
your data.</p>
</div>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="settings.html">« Configuring Elasticsearch</a>
</span>
<span class="next">
<a href="secure-settings.html">Secure settings »</a>
</span>
</div>
</body>
</html>
