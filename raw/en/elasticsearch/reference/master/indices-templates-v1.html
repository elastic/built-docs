<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="keywords" content="Elasticsearch diagnostic, diagnostics">
<title>Create or update index template API | Elasticsearch Guide [master] | Elastic</title>
<meta class="elastic" name="content" content="Create or update index template API | Elasticsearch Guide [master]">

<link rel="home" href="index.html" title="Elasticsearch Guide [master]"/>
<link rel="up" href="indices.html" title="Index APIs"/>
<link rel="prev" href="indices-put-template.html" title="Create or update index template API"/>
<link rel="next" href="indices-delete-component-template.html" title="Delete component template API"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="Elasticsearch"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/master"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="master"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
This documentation contains work-in-progress information for future Elastic Stack and Cloud releases. Use the version selector to view supported release docs. It also contains some Elastic Cloud serverless information. Check out our <a href="https://www.elastic.co/docs/current/serverless">serverless docs</a> for more details.
</div>
<div class="navheader">
<span class="prev">
<a href="indices-put-template.html">« Create or update index template API</a>
</span>
<span class="next">
<a href="indices-delete-component-template.html">Delete component template API »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elasticsearch Guide [master]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="rest-apis.html">REST APIs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="indices.html">Index APIs</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Create or update index template API</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/indices/put-index-template-v1.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="indices-templates-v1"></a>Create or update index template API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/indices/put-index-template-v1.asciidoc">edit</a></h2>
</div></div></div>

<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>This documentation is about legacy index templates,
which are deprecated and will be replaced by the composable templates introduced in Elasticsearch 7.8.
For information about composable templates, see <a class="xref" href="index-templates.html" title="Index templates">Index templates</a>.</p>
</div>
</div>
<p>Creates or updates an index template.</p>
<div class="pre_wrapper lang-php alternative">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-php alternative">$params = [
    'name' =&gt; 'template_1',
    'body' =&gt; [
        'index_patterns' =&gt; [
            'te*',
            'bar*',
        ],
        'settings' =&gt; [
            'number_of_shards' =&gt; 1,
        ],
        'mappings' =&gt; [
            '_source' =&gt; [
                'enabled' =&gt; false,
            ],
            'properties' =&gt; [
                'host_name' =&gt; [
                    'type' =&gt; 'keyword',
                ],
                'created_at' =&gt; [
                    'type' =&gt; 'date',
                    'format' =&gt; 'EEE MMM dd HH:mm:ss Z yyyy',
                ],
            ],
        ],
    ],
];
$response = $client-&gt;indices()-&gt;putTemplate($params);</pre>
</div>
<div class="pre_wrapper lang-js alternative">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js alternative">const response = await client.indices.putTemplate({
  name: "template_1",
  index_patterns: ["te*", "bar*"],
  settings: {
    number_of_shards: 1,
  },
  mappings: {
    _source: {
      enabled: false,
    },
    properties: {
      host_name: {
        type: "keyword",
      },
      created_at: {
        type: "date",
        format: "EEE MMM dd HH:mm:ss Z yyyy",
      },
    },
  },
});
console.log(response);</pre>
</div>
<a id="e5f50b31f165462d883ecbff45f74985"></a>
<div class="pre_wrapper lang-console default has-php has-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console default has-php has-js">PUT _template/template_1
{
  "index_patterns": ["te*", "bar*"],
  "settings": {
    "number_of_shards": 1
  },
  "mappings": {
    "_source": {
      "enabled": false
    },
    "properties": {
      "host_name": {
        "type": "keyword"
      },
      "created_at": {
        "type": "date",
        "format": "EEE MMM dd HH:mm:ss Z yyyy"
      }
    }
  }
}</pre>
</div>
<div class="console_widget has-php has-js" data-snippet="snippets/2708.console"></div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="put-index-template-v1-api-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/indices/put-index-template-v1.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">PUT /_template/&lt;index-template&gt;</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="put-index-template-v1-api-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/indices/put-index-template-v1.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If the Elasticsearch security features are enabled, you must have the
<code class="literal">manage_index_templates</code> or <code class="literal">manage</code> <a class="xref" href="security-privileges.html#privileges-list-cluster" title="Cluster privileges">cluster
privilege</a> to use this API.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="put-index-template-v1-api-desc"></a>Description<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/indices/put-index-template-v1.asciidoc">edit</a></h3>
</div></div></div>
<p>Index templates define <a class="xref" href="index-modules.html#index-modules-settings" title="Index settings">settings</a> and <a class="xref" href="mapping.html" title="Mapping">mappings</a>
that you can automatically apply when creating new indices.
Elasticsearch applies templates to new indices
based on an index pattern that matches the index name.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Composable templates always take precedence over legacy templates.
If no composable template matches a new index,
matching legacy templates are applied according to their order.</p>
</div>
</div>
<p>Index templates are only applied during index creation.
Changes to index templates do not affect existing indices.
Settings and mappings specified in <a class="xref" href="indices-create-index.html" title="Create index API">create index</a> API requests
override any settings or mappings specified in an index template.</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_comments_in_index_templates_2"></a>Comments in index templates<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/indices/put-index-template-v1.asciidoc">edit</a></h4>
</div></div></div>
<p>You can use C-style /* */ block comments in index templates.
You can include comments anywhere in the request body,
except before the opening curly bracket.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="getting-v1"></a>Getting templates<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/indices/put-index-template-v1.asciidoc">edit</a></h4>
</div></div></div>
<p>See <a class="xref" href="indices-get-template-v1.html" title="Get index template API">Get index template (legacy)</a>.</p>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="put-index-template-v1-api-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/indices/put-index-template-v1.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;index-template&gt;</code>
</span>
</dt>
<dd>
(Required, string)
Name of the index template to create.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="put-index-template-v1-api-query-params"></a>Query parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/indices/put-index-template-v1.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">create</code>
</span>
</dt>
<dd>
(Optional, Boolean)
If <code class="literal">true</code>, this request cannot replace or update existing index templates.
Defaults to <code class="literal">false</code>.
</dd>
<dt>
<span class="term">
<code class="literal">order</code>
</span>
</dt>
<dd>
<p>
(Optional,integer)
Order in which Elasticsearch applies this template
if index matches multiple templates.
</p>
<p>Templates with lower <code class="literal">order</code> values are merged first.
Templates with higher <code class="literal">order</code> values are merged later,
overriding templates with lower values.</p>
</dd>
<dt>
<span class="term">
<code class="literal">master_timeout</code>
</span>
</dt>
<dd>
(Optional, <a class="xref" href="api-conventions.html#time-units" title="Time units">time units</a>)
Period to wait for the master node. If the master node is not available before
the timeout expires, the request fails and returns an error. Defaults to <code class="literal">30s</code>.
Can also be set to <code class="literal">-1</code> to indicate that the request should never timeout.
</dd>
</dl>
</div>
</div>

<div class="section child_attributes">
<div class="titlepage"><div><div>
<h3 class="title"><a id="put-index-template-v1-api-request-body"></a>Request body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/indices/put-index-template-v1.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">index_patterns</code>
</span>
</dt>
<dd>
(Required, array of strings)
Array of wildcard expressions
used to match the names of indices during creation.
</dd>
<dt>
<span class="term">
<code class="literal">aliases</code>
</span>
</dt>
<dd>
<p>
(Optional, object of objects) Aliases for the index.
</p>
<details open>
<summary class="title">Properties of <code class="literal">aliases</code> objects</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;alias&gt;</code>
</span>
</dt>
<dd>
<p>
(Required, object) The key is the alias name. Index alias names support
<a class="xref" href="api-conventions.html#api-date-math-index-names" title="Date math support in index and index alias names">date math</a>.
</p>
<p>The object body contains options for the alias. Supports an empty object.</p>
<details open>
<summary class="title">Properties of <code class="literal">&lt;alias&gt;</code></summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">filter</code>
</span>
</dt>
<dd>
(Optional, <a class="xref" href="query-dsl.html" title="Query DSL">Query DSL object</a>) Query used to limit documents the
alias can access.
</dd>
<dt>
<span class="term">
<code class="literal">index_routing</code>
</span>
</dt>
<dd>
(Optional, string) Value used to route indexing operations to a specific shard.
If specified, this overwrites the <code class="literal">routing</code> value for indexing operations.
</dd>
<dt>
<span class="term">
<code class="literal">is_hidden</code>
</span>
</dt>
<dd>
(Optional, Boolean) If <code class="literal">true</code>, the alias is <a class="xref" href="api-conventions.html#multi-hidden" title="Hidden data streams and indices">hidden</a>. Defaults to
<code class="literal">false</code>. All indices for the alias must have the same <code class="literal">is_hidden</code> value.
</dd>
<dt>
<span class="term">
<code class="literal">is_write_index</code>
</span>
</dt>
<dd>
(Optional, Boolean) If <code class="literal">true</code>, the index is the <a class="xref" href="aliases.html#write-index" title="Write index">write index</a> for
the alias. Defaults to <code class="literal">false</code>.
</dd>
<dt>
<span class="term">
<code class="literal">routing</code>
</span>
</dt>
<dd>
(Optional, string) Value used to route indexing and search operations to a
specific shard.
</dd>
<dt>
<span class="term">
<code class="literal">search_routing</code>
</span>
</dt>
<dd>
(Optional, string) Value used to route search operations to a specific shard. If
specified, this overwrites the <code class="literal">routing</code> value for search operations.
</dd>
</dl>
</div>
</div>
</details>
</dd>
</dl>
</div>
</div>
</details>
</dd>
<dt>
<span class="term">
<code class="literal">mappings</code>
</span>
</dt>
<dd>
<p>(Optional, <a class="xref" href="mapping.html" title="Mapping">mapping object</a>) Mapping for fields in the index. If
specified, this mapping can include:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Field names
</li>
<li class="listitem">
<a class="xref" href="mapping-types.html" title="Field data types">Field data types</a>
</li>
<li class="listitem">
<a class="xref" href="mapping-params.html" title="Mapping parameters">Mapping parameters</a>
</li>
</ul>
</div>
<p>See <a class="xref" href="mapping.html" title="Mapping">Mapping</a>.</p>
</dd>
<dt>
<span class="term">
<code class="literal">settings</code>
</span>
</dt>
<dd>
(Optional, <a class="xref" href="index-modules.html#index-modules-settings" title="Index settings">index setting object</a>) Configuration
options for the index. See <a class="xref" href="index-modules.html#index-modules-settings" title="Index settings">Index settings</a>.
</dd>
<dt>
<span class="term">
<code class="literal">version</code>
</span>
</dt>
<dd>
(Optional, integer)
Version number used to manage index templates externally.
This number is not automatically generated by Elasticsearch.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="put-index-template-v1-api-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/indices/put-index-template-v1.asciidoc">edit</a></h3>
</div></div></div>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_index_template_with_index_aliases_2"></a>Index template with index aliases<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/indices/put-index-template-v1.asciidoc">edit</a></h4>
</div></div></div>
<p>You can include <a class="xref" href="aliases.html" title="Aliases">index aliases</a> in an index template.</p>
<div class="pre_wrapper lang-js alternative">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js alternative">const response = await client.indices.putTemplate({
  name: "template_1",
  index_patterns: ["te*"],
  settings: {
    number_of_shards: 1,
  },
  aliases: {
    alias1: {},
    alias2: {
      filter: {
        term: {
          "user.id": "kimchy",
        },
      },
      routing: "shard-1",
    },
    "{index}-alias": {},
  },
});
console.log(response);</pre>
</div>
<a id="0fc4b589df5388da784c6d981e769e31"></a>
<div class="pre_wrapper lang-console default has-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console default has-js">PUT _template/template_1
{
  "index_patterns" : ["te*"],
  "settings" : {
    "number_of_shards" : 1
  },
  "aliases" : {
    "alias1" : {},
    "alias2" : {
      "filter" : {
        "term" : {"user.id" : "kimchy" }
      },
      "routing" : "shard-1"
    },
    "{index}-alias" : {} <a id="CO777-1"></a><i class="conum" data-value="1"></i>
  }
}</pre>
</div>
<div class="console_widget has-js" data-snippet="snippets/2709.console"></div>
<div class="calloutlist default has-js lang-console">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO777-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>the <code class="literal">{index}</code> placeholder in the alias name will be replaced with the
actual index name that the template gets applied to, during index creation.</p>
</td>
</tr>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="multiple-templates-v1"></a>Indices matching multiple templates<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/indices/put-index-template-v1.asciidoc">edit</a></h4>
</div></div></div>
<p>Multiple index templates can potentially match an index, in this case,
both the settings and mappings are merged into the final configuration
of the index. The order of the merging can be controlled using the
<code class="literal">order</code> parameter, with lower order being applied first, and higher
orders overriding them. For example:</p>
<div class="pre_wrapper lang-js alternative">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js alternative">const response = await client.indices.putTemplate({
  name: "template_1",
  index_patterns: ["te*"],
  order: 0,
  settings: {
    number_of_shards: 1,
  },
  mappings: {
    _source: {
      enabled: false,
    },
  },
});
console.log(response);

const response1 = await client.indices.putTemplate({
  name: "template_2",
  index_patterns: ["tes*"],
  order: 1,
  settings: {
    number_of_shards: 1,
  },
  mappings: {
    _source: {
      enabled: true,
    },
  },
});
console.log(response1);</pre>
</div>
<a id="6ba332596f5eb29660c90ab2d480e7dc"></a>
<div class="pre_wrapper lang-console default has-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console default has-js">PUT /_template/template_1
{
  "index_patterns" : ["te*"],
  "order" : 0,
  "settings" : {
    "number_of_shards" : 1
  },
  "mappings" : {
    "_source" : { "enabled" : false }
  }
}

PUT /_template/template_2
{
  "index_patterns" : ["tes*"],
  "order" : 1,
  "settings" : {
    "number_of_shards" : 1
  },
  "mappings" : {
    "_source" : { "enabled" : true }
  }
}</pre>
</div>
<div class="console_widget has-js" data-snippet="snippets/2710.console"></div>
<p>The above will disable storing the <code class="literal">_source</code>, but
for indices that start with <code class="literal">tes*</code>, <code class="literal">_source</code> will still be enabled.
Note, for mappings, the merging is "deep", meaning that specific
object/property based mappings can easily be added/overridden on higher
order templates, with lower order templates providing the basis.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Multiple matching templates with the same order value will
result in a non-deterministic merging order.</p>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="versioning-templates-v1"></a>Template versioning<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/indices/put-index-template-v1.asciidoc">edit</a></h4>
</div></div></div>
<p>You can use the <code class="literal">version</code> parameter
to add an optional version number to an index template.
External systems can use these version numbers
to simplify template management.</p>
<p>The <code class="literal">version</code>	parameter is completely optional
and not automatically generated by Elasticsearch.</p>
<p>To unset a <code class="literal">version</code>,
replace the template without specifying	one.</p>
<div class="pre_wrapper lang-ruby alternative">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ruby alternative">response = client.indices.put_template(
  name: 'template_1',
  body: {
    index_patterns: [
      'my-index-*'
    ],
    order: 0,
    settings: {
      number_of_shards: 1
    },
    version: 123
  }
)
puts response</pre>
</div>
<div class="pre_wrapper lang-js alternative">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js alternative">const response = await client.indices.putTemplate({
  name: "template_1",
  index_patterns: ["my-index-*"],
  order: 0,
  settings: {
    number_of_shards: 1,
  },
  version: 123,
});
console.log(response);</pre>
</div>
<a id="488f6df1df71972392b670ce557f7ff3"></a>
<div class="pre_wrapper lang-console default has-ruby has-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console default has-ruby has-js">PUT /_template/template_1
{
  "index_patterns" : ["my-index-*"],
  "order" : 0,
  "settings" : {
    "number_of_shards" : 1
  },
  "version": 123
}</pre>
</div>
<div class="console_widget has-ruby has-js" data-snippet="snippets/2711.console"></div>
<p>To check the <code class="literal">version</code>,
you can	use the <a class="xref" href="indices-get-template.html" title="Get index template API">get index template</a> API
with the <a class="xref" href="common-options.html#common-options-response-filtering" title="Response Filtering"><code class="literal">filter_path</code></a> query parameter
to return only the version number:</p>
<div class="pre_wrapper lang-php alternative">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-php alternative">$params = [
    'name' =&gt; 'template_1',
];
$response = $client-&gt;indices()-&gt;getTemplate($params);</pre>
</div>
<div class="pre_wrapper lang-ruby alternative">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ruby alternative">response = client.indices.get_template(
  name: 'template_1',
  filter_path: '*.version'
)
puts response</pre>
</div>
<div class="pre_wrapper lang-js alternative">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js alternative">const response = await client.indices.getTemplate({
  name: "template_1",
  filter_path: "*.version",
});
console.log(response);</pre>
</div>
<a id="46658f00edc4865dfe472a392374cd0f"></a>
<div class="pre_wrapper lang-console default has-php has-ruby has-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console default has-php has-ruby has-js">GET /_template/template_1?filter_path=*.version</pre>
</div>
<div class="console_widget has-php has-ruby has-js" data-snippet="snippets/2712.console"></div>
<p>The API returns the following response:</p>
<a id="a2e618c0a7ef9368e0b39e7ece15e27e"></a>
<div class="pre_wrapper lang-console-result">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console-result">{
  "template_1" : {
    "version" : 123
  }
}</pre>
</div>
</div>

</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="indices-put-template.html">« Create or update index template API</a>
</span>
<span class="next">
<a href="indices-delete-component-template.html">Delete component template API »</a>
</span>
</div>
</body>
</html>
