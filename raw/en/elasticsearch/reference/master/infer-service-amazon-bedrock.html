<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="keywords" content="Elasticsearch diagnostic, diagnostics">
<title>Amazon Bedrock inference service | Elasticsearch Guide [master] | Elastic</title>
<meta class="elastic" name="content" content="Amazon Bedrock inference service | Elasticsearch Guide [master]">

<link rel="home" href="index.html" title="Elasticsearch Guide [master]"/>
<link rel="up" href="inference-apis.html" title="Inference APIs"/>
<link rel="prev" href="put-inference-api.html" title="Create inference API"/>
<link rel="next" href="infer-service-azure-ai-studio.html" title="Azure AI studio inference service"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="Elasticsearch"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/master"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="master"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
This documentation contains work-in-progress information for future Elastic Stack and Cloud releases. Use the version selector to view supported release docs. It also contains some Elastic Cloud serverless information. Check out our <a href="https://www.elastic.co/docs/current/serverless">serverless docs</a> for more details.
</div>
<div class="navheader">
<span class="prev">
<a href="put-inference-api.html">« Create inference API</a>
</span>
<span class="next">
<a href="infer-service-azure-ai-studio.html">Azure AI studio inference service »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elasticsearch Guide [master]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="rest-apis.html">REST APIs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="inference-apis.html">Inference APIs</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Amazon Bedrock inference service</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/inference/service-amazon-bedrock.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="infer-service-amazon-bedrock"></a>Amazon Bedrock inference service<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/inference/service-amazon-bedrock.asciidoc">edit</a></h2>
</div></div></div>
<p>Creates an inference endpoint to perform an inference task with the <code class="literal">amazonbedrock</code> service.</p>
<h4><a id="infer-service-amazon-bedrock-api-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/inference/service-amazon-bedrock.asciidoc">edit</a></h4>
<p><code class="literal">PUT /_inference/&lt;task_type&gt;/&lt;inference_id&gt;</code></p>
<h4><a id="infer-service-amazon-bedrock-api-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/inference/service-amazon-bedrock.asciidoc">edit</a></h4>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;inference_id&gt;</code>
</span>
</dt>
<dd>
(Required, string)
The unique identifier of the inference endpoint.
</dd>
<dt>
<span class="term">
<code class="literal">&lt;task_type&gt;</code>
</span>
</dt>
<dd>
<p>
(Required, string)
The type of the inference task that the model will perform.
</p>
<p>Available task types:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">completion</code>,
</li>
<li class="listitem">
<code class="literal">text_embedding</code>.
</li>
</ul>
</div>
</dd>
</dl>
</div>
<h4><a id="infer-service-amazon-bedrock-api-request-body"></a>Request body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/inference/service-amazon-bedrock.asciidoc">edit</a></h4>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">service</code>
</span>
</dt>
<dd>
(Required, string) The type of service supported for the specified task type.
In this case,
<code class="literal">amazonbedrock</code>.
</dd>
<dt>
<span class="term">
<code class="literal">service_settings</code>
</span>
</dt>
<dd>
<p>
(Required, object)
Settings used to install the inference model.
</p>
<p>These settings are specific to the <code class="literal">amazonbedrock</code> service.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">access_key</code>
</span>
</dt>
<dd>
(Required, string)
A valid AWS access key that has permissions to use Amazon Bedrock and access to models for inference requests.
</dd>
<dt>
<span class="term">
<code class="literal">secret_key</code>
</span>
</dt>
<dd>
(Required, string)
A valid AWS secret key that is paired with the <code class="literal">access_key</code>.
To create or manage access and secret keys, see <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_access-keys.html" class="ulink" target="_top">Managing access keys for IAM users</a> in the AWS documentation.
</dd>
</dl>
</div>
</dd>
</dl>
</div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>You need to provide the access and secret keys only once, during the inference model creation.
The <a class="xref" href="get-inference-api.html" title="Get inference API">Get inference API</a> does not retrieve your access or secret keys.
After creating the inference model, you cannot change the associated key pairs.
If you want to use a different access and secret key pair, delete the inference model and recreate it with the same name and the updated keys.</p>
</div>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">provider</code>
</span>
</dt>
<dd>
<p>
(Required, string)
The model provider for your deployment.
Note that some providers may support only certain task types.
Supported providers include:
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">amazontitan</code> - available for <code class="literal">text_embedding</code> and <code class="literal">completion</code> task types
</li>
<li class="listitem">
<code class="literal">anthropic</code> - available for <code class="literal">completion</code> task type only
</li>
<li class="listitem">
<code class="literal">ai21labs</code> - available for <code class="literal">completion</code> task type only
</li>
<li class="listitem">
<code class="literal">cohere</code> - available for <code class="literal">text_embedding</code> and <code class="literal">completion</code> task types
</li>
<li class="listitem">
<code class="literal">meta</code> - available for <code class="literal">completion</code> task type only
</li>
<li class="listitem">
<code class="literal">mistral</code> - available for <code class="literal">completion</code> task type only
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">model</code>
</span>
</dt>
<dd>
(Required, string)
The base model ID or an ARN to a custom model based on a foundational model.
The base model IDs can be found in the <a href="https://docs.aws.amazon.com/bedrock/latest/userguide/model-ids.html" class="ulink" target="_top">Amazon Bedrock model IDs</a> documentation.
Note that the model ID must be available for the provider chosen, and your IAM user must have access to the model.
</dd>
<dt>
<span class="term">
<code class="literal">region</code>
</span>
</dt>
<dd>
(Required, string)
The region that your model or ARN is deployed in.
The list of available regions per model can be found in the <a href="https://docs.aws.amazon.com/bedrock/latest/userguide/models-regions.html" class="ulink" target="_top">Model support by AWS region</a> documentation.
</dd>
<dt>
<span class="term">
<code class="literal">rate_limit</code>
</span>
</dt>
<dd>
<p>
(Optional, object)
By default, the <code class="literal">amazonbedrock</code> service sets the number of requests allowed per minute to <code class="literal">240</code>.
This helps to minimize the number of rate limit errors returned from Amazon Bedrock.
To modify this, set the <code class="literal">requests_per_minute</code> setting of this object in your service settings:
</p>
<div class="pre_wrapper lang-text">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-text">"rate_limit": {
    "requests_per_minute": &lt;&lt;number_of_requests&gt;&gt;
}</pre>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">task_settings</code>
</span>
</dt>
<dd>
(Optional, object)
Settings to configure the inference task.
These settings are specific to the <code class="literal">&lt;task_type&gt;</code> you specified.
</dd>
</dl>
</div>
<details>
<summary class="title"><code class="literal">task_settings</code> for the <code class="literal">completion</code> task type</summary>
<div class="content">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">max_new_tokens</code>
</span>
</dt>
<dd>
(Optional, integer)
Sets the maximum number for the output tokens to be generated.
Defaults to 64.
</dd>
<dt>
<span class="term">
<code class="literal">temperature</code>
</span>
</dt>
<dd>
(Optional, float)
A number between 0.0 and 1.0 that controls the apparent creativity of the results. At temperature 0.0 the model is most deterministic, at temperature 1.0 most random.
Should not be used if <code class="literal">top_p</code> or <code class="literal">top_k</code> is specified.
</dd>
<dt>
<span class="term">
<code class="literal">top_p</code>
</span>
</dt>
<dd>
(Optional, float)
Alternative to <code class="literal">temperature</code>. A number in the range of 0.0 to 1.0, to eliminate low-probability tokens. Top-p uses nucleus sampling to select top tokens whose sum of likelihoods does not exceed a certain value, ensuring both variety and coherence.
Should not be used if <code class="literal">temperature</code> is specified.
</dd>
<dt>
<span class="term">
<code class="literal">top_k</code>
</span>
</dt>
<dd>
(Optional, float)
Only available for <code class="literal">anthropic</code>, <code class="literal">cohere</code>, and <code class="literal">mistral</code> providers.
Alternative to <code class="literal">temperature</code>. Limits samples to the top-K most likely words, balancing coherence and variability.
Should not be used if <code class="literal">temperature</code> is specified.
</dd>
</dl>
</div>
</div>
</details>
<p>+
.<code class="literal">task_settings</code> for the <code class="literal">text_embedding</code> task type</p>
<details>
<summary class="title">Details</summary>
<div class="content">
<p>There are no <code class="literal">task_settings</code> available for the <code class="literal">text_embedding</code> task type.</p>
</div>
</details>
</dd>
</dl>
</div>
<h4><a id="inference-example-amazonbedrock"></a>Amazon Bedrock service example<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/inference/service-amazon-bedrock.asciidoc">edit</a></h4>
<p>The following example shows how to create an inference endpoint called <code class="literal">amazon_bedrock_embeddings</code> to perform a <code class="literal">text_embedding</code> task type.</p>
<p>Choose chat completion and embeddings models that you have access to from the <a href="https://docs.aws.amazon.com/bedrock/latest/userguide/model-ids.html" class="ulink" target="_top">Amazon Bedrock base models</a>.</p>
<a id="0ad8edd10542ec2c4d5d8700d7e2ba97"></a>
<div class="pre_wrapper lang-console">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console">PUT _inference/text_embedding/amazon_bedrock_embeddings
{
    "service": "amazonbedrock",
    "service_settings": {
        "access_key": "&lt;aws_access_key&gt;",
        "secret_key": "&lt;aws_secret_key&gt;",
        "region": "us-east-1",
        "provider": "amazontitan",
        "model": "amazon.titan-embed-text-v2:0"
    }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2849.console"></div>
<p>The next example shows how to create an inference endpoint called <code class="literal">amazon_bedrock_completion</code> to perform a <code class="literal">completion</code> task type.</p>
<a id="82844ef45e11c0eece100d3109db3182"></a>
<div class="pre_wrapper lang-console">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console">PUT _inference/completion/amazon_bedrock_completion
{
    "service": "amazonbedrock",
    "service_settings": {
        "access_key": "&lt;aws_access_key&gt;",
        "secret_key": "&lt;aws_secret_key&gt;",
        "region": "us-east-1",
        "provider": "amazontitan",
        "model": "amazon.titan-text-premier-v1:0"
    }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2850.console"></div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="put-inference-api.html">« Create inference API</a>
</span>
<span class="next">
<a href="infer-service-azure-ai-studio.html">Azure AI studio inference service »</a>
</span>
</div>
</body>
</html>
