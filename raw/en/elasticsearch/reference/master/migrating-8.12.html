<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="keywords" content="Elasticsearch diagnostic, diagnostics">
<title>Migrating to 8.12 | Elasticsearch Guide [master] | Elastic</title>
<meta class="elastic" name="content" content="Migrating to 8.12 | Elasticsearch Guide [master]">

<link rel="home" href="index.html" title="Elasticsearch Guide [master]"/>
<link rel="up" href="breaking-changes.html" title="Migration guide"/>
<link rel="prev" href="migrating-8.13.html" title="Migrating to 8.13"/>
<link rel="next" href="migrating-8.11.html" title="Migrating to 8.11"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="Elasticsearch"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/master"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="master"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body><div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elasticsearch Guide [master]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="breaking-changes.html">Migration guide</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="migrating-8.13.html">« Migrating to 8.13</a>
</span>
<span class="next">
<a href="migrating-8.11.html">Migrating to 8.11 »</a>
</span>
</div>
<div class="chapter">
<div class="titlepage"><div><div>
<h2 class="title"><a id="migrating-8.12"></a>Migrating to 8.12<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/migration/migrate_8_12.asciidoc">edit</a></h2>
</div></div></div>

<p>This section discusses the changes that you need to be aware of when migrating
your application to Elasticsearch 8.12.</p>
<p>See also <a class="xref" href="release-highlights.html" title="What&#8217;s new in 8.15"><em>What&#8217;s new in 8.15</em></a> and <a class="xref" href="es-release-notes.html" title="Release notes">Release notes</a>.</p>
<h3><a id="breaking-changes-8.12"></a>Breaking changes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/migration/migrate_8_12.asciidoc">edit</a></h3>
<p>There are no breaking changes in 8.12</p>
<h3><a id="notable-changes-8.12"></a>Notable changes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/migration/migrate_8_12.asciidoc">edit</a></h3>
<p>There are notable changes in 8.12 that you need to be aware of, items that we may consider as notable changes are</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Changes to features that are in Technical Preview.
</li>
<li class="listitem">
Changes to log formats.
</li>
<li class="listitem">
Changes to non public APIs.
</li>
<li class="listitem">
Behaviour changes that repair critical bugs.
</li>
</ul>
</div>
<h4><a id="breaking_812_authorization_changes"></a>Authorization changes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/migration/migrate_8_12.asciidoc">edit</a></h4>
<details id="fixed_jwt_principal_from_claims">
<summary class="title">Fixed JWT principal from claims</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
This changes the format of a JWT&#8217;s principal before the JWT is actually validated by any JWT realm. The JWT&#8217;s principal is a convenient way to refer to a JWT that has not yet been verified by a JWT realm. The JWT&#8217;s principal is printed in the audit and regular logs (notably for auditing authn failures) as well as the smart realm chain reordering optimization. The JWT principal is NOT required to be identical to the JWT-authenticated user&#8217;s principal, but in general, they should be similar. Previously, the JWT&#8217;s principal was built by individual realms in the same way the realms built the authenticated user&#8217;s principal. This had the advantage that, in simpler JWT realms configurations (e.g. a single JWT realm in the chain), the JWT principal and the authenticated user&#8217;s principal are very similar. However the drawback is that, in general, the JWT principal and the user principal can be very different (i.e. in the case where one JWT realm builds the JWT principal and a different one builds the user principal). Another downside is that the (unauthenticated) JWT principal depended on realm ordering, which makes identifying the JWT from its principal dependent on the ES authn realm configuration. This PR implements a consistent fixed logic to build the JWT principal, which only depends on the JWT&#8217;s claims and no ES configuration.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
Users will observe changed format and values for the <code class="literal">user.name</code> attribute of <code class="literal">authentication_failed</code> audit log events, in the JWT (failed) authn case.</p>
</div>
</details>
<h4><a id="breaking_812_java_api_changes"></a>Java API changes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/migration/migrate_8_12.asciidoc">edit</a></h4>
<details id="plugin_createcomponents_method_has_been_refactored_to_take_single_pluginservices_object">
<summary class="title">Plugin.createComponents method has been refactored to take a single PluginServices object</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
Plugin.createComponents currently takes several different service arguments. The signature of this method changes every time a new service is added. The method has now been modified to take a single interface object that new services are added to. This will reduce API incompatibility issues when a new service is introduced in the future.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
Plugins that override createComponents will need to be refactored to override the new method on ES 8.12+</p>
</div>
</details>
<h4><a id="breaking_812_rest_api_changes"></a>REST API changes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/migration/migrate_8_12.asciidoc">edit</a></h4>
<details id="es_ql_pow_function_always_returns_double">
<summary class="title">[ES|QL] pow function always returns double</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
This corrects an earlier mistake in the ES|QL language design. Initially we had thought to have pow return the same type as its inputs, but in practice even for integer inputs this quickly grows out of the representable range, and we returned null much of the time. This also created a lot of edge cases around casting to/from doubles (which the underlying java function uses). The version in this PR follows the java spec, by always casting its inputs to doubles, and returning a double. Doing it this way also allows for a rather significant reduction in lines of code.</p>
<p><span class="strong strong"><strong>Impact</strong></span><br>
low. Most queries should continue to function with the change.</p>
</div>
</details>
</div>
<div class="navfooter">
<span class="prev">
<a href="migrating-8.13.html">« Migrating to 8.13</a>
</span>
<span class="next">
<a href="migrating-8.11.html">Migrating to 8.11 »</a>
</span>
</div>
</div>
</body>
</html>
