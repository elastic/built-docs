<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="keywords" content="Elasticsearch diagnostic, diagnostics">
<title>Create or update pipeline API | Elasticsearch Guide [master] | Elastic</title>
<meta class="elastic" name="content" content="Create or update pipeline API | Elasticsearch Guide [master]">

<link rel="home" href="index.html" title="Elasticsearch Guide [master]"/>
<link rel="up" href="ingest-apis.html" title="Ingest APIs"/>
<link rel="prev" href="ingest-apis.html" title="Ingest APIs"/>
<link rel="next" href="delete-pipeline-api.html" title="Delete pipeline API"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="Elasticsearch"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/master"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="master"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
This documentation contains work-in-progress information for future Elastic Stack and Cloud releases. Use the version selector to view supported release docs. It also contains some Elastic Cloud serverless information. Check out our <a href="https://www.elastic.co/docs/current/serverless">serverless docs</a> for more details.
</div>
<div class="navheader">
<span class="prev">
<a href="ingest-apis.html">« Ingest APIs</a>
</span>
<span class="next">
<a href="delete-pipeline-api.html">Delete pipeline API »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elasticsearch Guide [master]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="rest-apis.html">REST APIs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="ingest-apis.html">Ingest APIs</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Create or update pipeline API</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/ingest/apis/put-pipeline.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="put-pipeline-api"></a>Create or update pipeline API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/ingest/apis/put-pipeline.asciidoc">edit</a></h2>
</div></div></div>

<p>Creates or updates an <a class="xref" href="ingest.html" title="Ingest pipelines">ingest pipeline</a>. Changes made using this API
take effect immediately.</p>
<div class="pre_wrapper lang-ruby alternative">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ruby alternative">response = client.ingest.put_pipeline(
  id: 'my-pipeline-id',
  body: {
    description: 'My optional pipeline description',
    processors: [
      {
        set: {
          description: 'My optional processor description',
          field: 'my-keyword-field',
          value: 'foo'
        }
      }
    ]
  }
)
puts response</pre>
</div>
<a id="6689aa213884196b47a6f482d4993749"></a>
<div class="pre_wrapper lang-console default has-ruby">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console default has-ruby">PUT _ingest/pipeline/my-pipeline-id
{
  "description" : "My optional pipeline description",
  "processors" : [
    {
      "set" : {
        "description" : "My optional processor description",
        "field": "my-keyword-field",
        "value": "foo"
      }
    }
  ]
}</pre>
</div>
<div class="console_widget has-ruby" data-snippet="snippets/2870.console"></div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="put-pipeline-api-request"></a>Request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/ingest/apis/put-pipeline.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">PUT /_ingest/pipeline/&lt;pipeline&gt;</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="put-pipeline-api-prereqs"></a>Prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/ingest/apis/put-pipeline.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If the Elasticsearch security features are enabled, you must have the
<code class="literal">manage_pipeline</code>, <code class="literal">manage_ingest_pipelines</code>, or <code class="literal">manage</code>
<a class="xref" href="security-privileges.html#privileges-list-cluster" title="Cluster privileges">cluster privilege</a> to use this API.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="put-pipeline-api-path-params"></a>Path parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/ingest/apis/put-pipeline.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">&lt;pipeline&gt;</code>
</span>
</dt>
<dd>
<p>
(Required, string) ID of the ingest pipeline to create or update.
</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>To avoid naming collisions with built-in and Fleet-managed ingest pipelines, avoid using <code class="literal">@</code> as part of your own ingest pipelines names.
The exception of that rule are the <code class="literal">*@custom</code> ingest pipelines that let you safely add a custom pipeline to managed pipelines.
See also <a class="xref" href="ingest.html#pipelines-for-fleet-elastic-agent" title="Pipelines for Fleet and Elastic Agent">Pipelines for Fleet and Elastic Agent</a>.</p>
</div>
</div>
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="put-pipeline-api-query-params"></a>Query parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/ingest/apis/put-pipeline.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">if_version</code>
</span>
</dt>
<dd>
(Optional, integer) Perform the operation only if the pipeline has this
version. If specified and the update is successful, the pipeline&#8217;s
version is incremented.
</dd>
<dt>
<span class="term">
<code class="literal">master_timeout</code>
</span>
</dt>
<dd>
(Optional, <a class="xref" href="api-conventions.html#time-units" title="Time units">time units</a>)
Period to wait for the master node. If the master node is not available before
the timeout expires, the request fails and returns an error. Defaults to <code class="literal">30s</code>.
Can also be set to <code class="literal">-1</code> to indicate that the request should never timeout.
</dd>
<dt>
<span class="term">
<code class="literal">timeout</code>
</span>
</dt>
<dd>
(Optional, <a class="xref" href="api-conventions.html#time-units" title="Time units">time units</a>) Period to wait for a response from all relevant nodes in the cluster after updating the cluster metadata.
If no response is received before the timeout expires, the cluster metadata update still applies but the response will indicate that it was not completely acknowledged.
Defaults to <code class="literal">30s</code>.
Can also be set to <code class="literal">-1</code> to indicate that the request should never timeout.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="put-pipeline-api-request-body"></a>Request body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/ingest/apis/put-pipeline.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">description</code>
</span>
</dt>
<dd>
(Optional, string)
Description of the ingest pipeline.
</dd>
<dt>
<span class="term">
<code class="literal">on_failure</code>
</span>
</dt>
<dd>
<p>
(Optional, array of <a class="xref" href="processors.html" title="Ingest processor reference">processor</a> objects)
Processors to run immediately after a processor failure.
</p>
<p>Each processor supports a processor-level <code class="literal">on_failure</code> value. If a processor
without an <code class="literal">on_failure</code> value fails, Elasticsearch uses this pipeline-level parameter as
a fallback. The processors in this parameter run sequentially in the order
specified. Elasticsearch will not attempt to run the pipeline&#8217;s remaining processors.</p>
</dd>
<dt>
<span class="term">
<code class="literal">processors</code>
</span>
</dt>
<dd>
(Required, array of <a class="xref" href="processors.html" title="Ingest processor reference">processor</a> objects)
Processors used to perform transformations on documents before indexing.
Processors run sequentially in the order specified.
</dd>
<dt>
<span class="term">
<code class="literal">version</code>
</span>
</dt>
<dd>
<p>
(Optional, integer)
Version number used by external systems to track ingest pipelines.
</p>
<p>See the <a class="xref" href="put-pipeline-api.html#put-pipeline-api-query-params" title="Query parameters"><code class="literal">if_version</code></a> parameter above for
how the version attribute is used.</p>
</dd>
<dt>
<span class="term">
<code class="literal">_meta</code>
</span>
</dt>
<dd>
(Optional, object)
Optional metadata about the ingest pipeline. May have any contents. This
map is not automatically generated by Elasticsearch.
</dd>
<dt>
<span class="term">
<code class="literal">deprecated</code>
</span>
</dt>
<dd>
(Optional, boolean)
Marks this ingest pipeline as deprecated.
When a deprecated ingest pipeline is referenced as the default or final pipeline when creating or updating a non-deprecated index template,
Elasticsearch will emit a deprecation warning.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="put-pipeline-api-example"></a>Examples<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/ingest/apis/put-pipeline.asciidoc">edit</a></h3>
</div></div></div>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="pipeline-metadata"></a>Pipeline metadata<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/ingest/apis/put-pipeline.asciidoc">edit</a></h4>
</div></div></div>
<p>You can use the <code class="literal">_meta</code> parameter to add arbitrary metadata to a pipeline.
This user-defined object is stored in the cluster state,
so keeping it short is preferable.</p>
<p>The <code class="literal">_meta</code> parameter is optional and not automatically generated or used by Elasticsearch.</p>
<p>To unset <code class="literal">_meta</code>, replace the pipeline without specifying one.</p>
<div class="pre_wrapper lang-ruby alternative">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ruby alternative">response = client.ingest.put_pipeline(
  id: 'my-pipeline-id',
  body: {
    description: 'My optional pipeline description',
    processors: [
      {
        set: {
          description: 'My optional processor description',
          field: 'my-keyword-field',
          value: 'foo'
        }
      }
    ],
    _meta: {
      reason: 'set my-keyword-field to foo',
      serialization: {
        class: 'MyPipeline',
        id: 10
      }
    }
  }
)
puts response</pre>
</div>
<a id="04d6ce0c903bd468afbecd3aa1c4a78a"></a>
<div class="pre_wrapper lang-console default has-ruby">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console default has-ruby">PUT /_ingest/pipeline/my-pipeline-id
{
  "description" : "My optional pipeline description",
  "processors" : [
    {
      "set" : {
        "description" : "My optional processor description",
        "field": "my-keyword-field",
        "value": "foo"
      }
    }
  ],
  "_meta": {
    "reason": "set my-keyword-field to foo",
    "serialization": {
      "class": "MyPipeline",
      "id": 10
    }
  }
}</pre>
</div>
<div class="console_widget has-ruby" data-snippet="snippets/2871.console"></div>
<p>To check the <code class="literal">_meta</code>, use the <a class="xref" href="get-pipeline-api.html" title="Get pipeline API">get pipeline</a> API.</p>
</div>

</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="ingest-apis.html">« Ingest APIs</a>
</span>
<span class="next">
<a href="delete-pipeline-api.html">Delete pipeline API »</a>
</span>
</div>
</body>
</html>
