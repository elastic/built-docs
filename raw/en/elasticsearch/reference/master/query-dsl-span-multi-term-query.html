<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Span multi-term query | Elasticsearch Reference [master] | Elastic</title>
<link rel="home" href="index.html" title="Elasticsearch Reference [master]"/>
<link rel="up" href="span-queries.html" title="Span queries"/>
<link rel="prev" href="query-dsl-span-first-query.html" title="Span first query"/>
<link rel="next" href="query-dsl-span-near-query.html" title="Span near query"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/master"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="master"/>
</head>
<body><div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Elasticsearch Reference [master]</a></span>
»
<span class="breadcrumb-link"><a href="query-dsl.html">Query DSL</a></span>
»
<span class="breadcrumb-link"><a href="span-queries.html">Span queries</a></span>
»
<span class="breadcrumb-node">Span multi-term query</span>
</div>
<div class="navheader">
<span class="prev">
<a href="query-dsl-span-first-query.html">« Span first query</a>
</span>
<span class="next">
<a href="query-dsl-span-near-query.html">Span near query »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="query-dsl-span-multi-term-query"></a>Span multi-term query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/master/docs/reference/query-dsl/span-multi-term-query.asciidoc">edit</a></h2>
</div></div></div>

<p>The <code class="literal">span_multi</code> query allows you to wrap a <code class="literal">multi term query</code> (one of wildcard,
fuzzy, prefix, range or regexp query) as a <code class="literal">span query</code>, so
it can be nested. Example:</p>
<a id="f98687271e1bec031cc34d05d8f4b60b"></a>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /_search
{
  "query": {
    "span_multi": {
      "match": {
        "prefix": { "user.id": { "value": "ki" } }
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/877.console"></div>
<p>A boost can also be associated with the query:</p>
<a id="b4d1fc887e40885cdf6ac2d01487cb76"></a>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /_search
{
  "query": {
    "span_multi": {
      "match": {
        "prefix": { "user.id": { "value": "ki", "boost": 1.08 } }
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/878.console"></div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p><code class="literal">span_multi</code> queries will hit too many clauses failure if the number of terms that match the query exceeds the
boolean query limit (defaults to 1024).To avoid an unbounded expansion you can set the <a class="xref" href="query-dsl-multi-term-rewrite.html" title="rewrite parameter">rewrite method</a> of the multi term query to <code class="literal">top_terms_*</code> rewrite. Or, if you use <code class="literal">span_multi</code> on <code class="literal">prefix</code> query only,
you can activate the <a class="xref" href="index-prefixes.html" title="index_prefixes"><code class="literal">index_prefixes</code></a> field option of the <code class="literal">text</code> field instead. This will
rewrite any prefix query on the field to a single term query that matches the indexed prefix.</p>
</div>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="query-dsl-span-first-query.html">« Span first query</a>
</span>
<span class="next">
<a href="query-dsl-span-near-query.html">Span near query »</a>
</span>
</div>
</div>
</body>
</html>
