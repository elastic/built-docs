<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Search with synonyms | Elasticsearch Guide [master] | Elastic</title>
<meta class="elastic" name="content" content="Search with synonyms | Elasticsearch Guide [master]">

<link rel="home" href="index.html" title="Elasticsearch Guide [master]"/>
<link rel="up" href="search-with-elasticsearch.html" title="Search your data"/>
<link rel="prev" href="modules-cross-cluster-search.html" title="Search across clusters"/>
<link rel="next" href="search-application-overview.html" title="Elastic Search Applications"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="Elasticsearch"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/master"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="master"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
This documentation contains work-in-progress information for future Elastic Stack and Cloud releases. Use the version selector to view supported release docs. It also contains some Elastic Cloud serverless information. Check out our <a href="https://www.elastic.co/docs/current/serverless">serverless docs</a> for more details.
</div>
<div class="navheader">
<span class="prev">
<a href="modules-cross-cluster-search.html">« Search across clusters</a>
</span>
<span class="next">
<a href="search-application-overview.html">Elastic Search Applications »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elasticsearch Guide [master]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="search-with-elasticsearch.html">Search your data</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Search with synonyms</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/search/search-your-data/search-with-synonyms.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="chapter">
<div class="titlepage"><div><div>
<h2 class="title"><a id="search-with-synonyms"></a>Search with synonyms<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/search/search-your-data/search-with-synonyms.asciidoc">edit</a></h2>
</div></div></div>
<p>Synonyms are words or phrases that have the same or similar meaning.
They are an important aspect of search, as they can improve the search experience and increase the scope of search results.</p>
<p>Synonyms allow you to:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Improve search relevance</strong></span> by finding relevant documents that use different terms to express the same concept.
</li>
<li class="listitem">
Make <span class="strong strong"><strong>domain-specific vocabulary</strong></span> more user-friendly, allowing users to use search terms they are more familiar with.
</li>
<li class="listitem">
<span class="strong strong"><strong>Define common misspellings and typos</strong></span> to transparently handle common mistakes.
</li>
</ul>
</div>
<p>Synonyms are grouped together using <span class="strong strong"><strong>synonyms sets</strong></span>.
You can have as many synonyms sets as you need.</p>
<p>In order to use synonyms sets in Elasticsearch, you need to:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="search-with-synonyms.html#synonyms-store-synonyms" title="Store your synonyms set">Store your synonyms set</a>
</li>
<li class="listitem">
<a class="xref" href="search-with-synonyms.html#synonyms-synonym-token-filters" title="Configure synonyms token filters and analyzers">Configure synonyms token filters and analyzers</a>
</li>
</ul>
</div>
<h3><a id="synonyms-store-synonyms"></a>Store your synonyms set<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/search/search-your-data/search-with-synonyms.asciidoc">edit</a></h3>
<p>Your synonyms sets need to be stored in Elasticsearch so your analyzers can refer to them.
There are three ways to store your synonyms sets:</p>
<h4><a id="synonyms-store-synonyms-api"></a>Synonyms API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/search/search-your-data/search-with-synonyms.asciidoc">edit</a></h4>
<p>You can use the <a class="xref" href="synonyms-apis.html" title="Synonyms APIs">synonyms APIs</a> to manage synonyms sets.
This is the most flexible approach, as it allows to dynamically define and modify synonyms sets.</p>
<p>Changes in your synonyms sets will automatically reload the associated analyzers.</p>
<h4><a id="synonyms-store-synonyms-file"></a>Synonyms File<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/search/search-your-data/search-with-synonyms.asciidoc">edit</a></h4>
<p>You can store your synonyms set in a file.</p>
<p>A synonyms set file needs to be uploaded to all your cluster nodes, and be located in the configuration directory for your Elasticsearch distribution.
If you&#8217;re using Elasticsearch Service, you can upload synonyms files using <a href="/guide/en/cloud/current/ec-custom-bundles.html" class="ulink" target="_top">custom bundles</a>.</p>
<p>An example synonyms file:</p>
<div class="pre_wrapper lang-synonyms">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-synonyms"># Blank lines and lines starting with pound are comments.

# Explicit mappings match any token sequence on the left hand side of "=&gt;"
# and replace with all alternatives on the right hand side.
# These types of mappings ignore the expand parameter in the schema.
# Examples:
i-pod, i pod =&gt; ipod
sea biscuit, sea biscit =&gt; seabiscuit

# Equivalent synonyms may be separated with commas and give
# no explicit mapping.  In this case the mapping behavior will
# be taken from the expand parameter in the token filter configuration.
# This allows the same synonym file to be used in different synonym handling strategies.
# Examples:
ipod, i-pod, i pod
foozball , foosball
universe , cosmos
lol, laughing out loud

# If expand==true in the synonym token filter configuration,
# "ipod, i-pod, i pod" is equivalent to the explicit mapping:
ipod, i-pod, i pod =&gt; ipod, i-pod, i pod
# If expand==false, "ipod, i-pod, i pod" is equivalent
# to the explicit mapping:
ipod, i-pod, i pod =&gt; ipod

# Multiple synonym mapping entries are merged.
foo =&gt; foo bar
foo =&gt; baz
# is equivalent to
foo =&gt; foo bar, baz</pre>
</div>
<p>To update an existing synonyms set, upload new files to your cluster.
Synonyms set files must be kept in sync on every cluster node.</p>
<p>When a synonyms set is updated, search analyzers that use it need to be refreshed using the <a class="xref" href="indices-reload-analyzers.html" title="Reload search analyzers API">reload search analyzers API</a></p>
<p>This manual syncing and reloading makes this approach less flexible than using the <a class="xref" href="search-with-synonyms.html#synonyms-store-synonyms-api" title="Synonyms API">synonyms API</a>.</p>
<h4><a id="synonyms-store-synonyms-inline"></a>Inline<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/search/search-your-data/search-with-synonyms.asciidoc">edit</a></h4>
<p>You can test your synonyms by adding them directly inline in your token filter definition.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>Inline synonyms are not recommended for production usage.
A large number of inline synonyms increases cluster size unnecessarily and can lead to performance issues.</p>
</div>
</div>
<h4><a id="synonyms-synonym-token-filters"></a>Configure synonyms token filters and analyzers<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/search/search-your-data/search-with-synonyms.asciidoc">edit</a></h4>
<p>Once your synonyms sets are created, you can start configuring your token filters and analyzers to use them.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>Synonyms sets must exist before they can be added to indices.
If an index is created referencing a nonexistent synonyms set, the index will remain in a partially created and inoperable state.
The only way to recover from this scenario is to ensure the synonyms set exists then either delete and re-create the index, or close and re-open the index.</p>
</div>
</div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>Invalid synonym rules can cause errors when applying analyzer changes.
For reloadable analyzers, this prevents reloading and applying changes.
You must correct errors in the synonym rules and reload the analyzer.</p>
<p>An index with invalid synonym rules cannot be reopened, making it inoperable when:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
A node containing the index starts
</li>
<li class="listitem">
The index is opened from a closed state
</li>
<li class="listitem">
A node restart occurs (which reopens the node assigned shards)
</li>
</ul>
</div>
</div>
</div>
<p>Elasticsearch uses synonyms as part of the <a class="xref" href="analysis-overview.html" title="Text analysis overview">analysis process</a>.
You can use two types of <a class="xref" href="analysis-tokenfilters.html" title="Token filter reference">token filter</a> to include synonyms:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="analysis-synonym-graph-tokenfilter.html" title="Synonym graph token filter">Synonym graph</a>: It is recommended to use it, as it can correctly handle multi-word synonyms ("hurriedly", "in a hurry").
</li>
<li class="listitem">
<a class="xref" href="analysis-synonym-tokenfilter.html" title="Synonym token filter">Synonym</a>: Not recommended if you need to use multi-word synonyms.
</li>
</ul>
</div>
<p>Check each synonym token filter documentation for configuration details and instructions on adding it to an analyzer.</p>
<h4><a id="synonyms-test-analyzer"></a>Test your analyzer<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/search/search-your-data/search-with-synonyms.asciidoc">edit</a></h4>
<p>You can test an analyzer configuration without modifying your index settings.
Use the <a class="xref" href="indices-analyze.html" title="Analyze API">analyze API</a> to test your analyzer chain:</p>
<div class="pre_wrapper lang-ruby alternative">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ruby alternative">response = client.indices.analyze(
  body: {
    tokenizer: 'standard',
    filter: [
      'lowercase',
      {
        type: 'synonym_graph',
        synonyms: [
          'pc =&gt; personal computer',
          'computer, pc, laptop'
        ]
      }
    ],
    text: 'Check how PC synonyms work'
  }
)
puts response</pre>
</div>
<div class="pre_wrapper lang-js alternative">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js alternative">const response = await client.indices.analyze({
  tokenizer: "standard",
  filter: [
    "lowercase",
    {
      type: "synonym_graph",
      synonyms: ["pc =&gt; personal computer", "computer, pc, laptop"],
    },
  ],
  text: "Check how PC synonyms work",
});
console.log(response);</pre>
</div>
<a id="6edfc35a66afd9b884431fccf48fdbf5"></a>
<div class="pre_wrapper lang-console default has-ruby has-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console default has-ruby has-js">GET /_analyze
{
  "tokenizer": "standard",
  "filter" : [
    "lowercase",
    {
      "type": "synonym_graph",
      "synonyms": ["pc =&gt; personal computer", "computer, pc, laptop"]
    }
  ],
  "text" : "Check how PC synonyms work"
}</pre>
</div>
<div class="console_widget has-ruby has-js" data-snippet="snippets/1086.console"></div>
<h4><a id="synonyms-apply-synonyms"></a>Apply synonyms at index or search time<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/elasticsearch/edit/main/docs/reference/search/search-your-data/search-with-synonyms.asciidoc">edit</a></h4>
<p>Analyzers can be applied at <a class="xref" href="analysis-index-search-time.html" title="Index and search analysis">index time or search time</a>.</p>
<p>You need to decide when to apply your synonyms:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Index time: Synonyms are applied when the documents are indexed into Elasticsearch. This is a less flexible alternative, as changes to your synonyms require <a class="xref" href="docs-reindex.html" title="Reindex API">reindexing</a>.
</li>
<li class="listitem">
Search time: Synonyms are applied when a search is executed. This is a more flexible approach, which doesn&#8217;t require reindexing. If token filters are configured with <code class="literal">"updateable": true</code>, search analyzers can be <a class="xref" href="indices-reload-analyzers.html" title="Reload search analyzers API">reloaded</a> when you make changes to your synonyms.
</li>
</ul>
</div>
<p>Synonyms sets created using the <a class="xref" href="search-with-synonyms.html#synonyms-store-synonyms-api" title="Synonyms API">synonyms API</a> can only be used at search time.</p>
<p>You can specify the analyzer that contains your synonyms set as a <a class="xref" href="specify-analyzer.html#specify-search-analyzer" title="How Elasticsearch determines the search analyzer">search time analyzer</a> or as an <a class="xref" href="specify-analyzer.html#specify-index-time-analyzer" title="How Elasticsearch determines the index analyzer">index time analyzer</a>.</p>
<p>The following example adds <code class="literal">my_analyzer</code> as a search analyzer to the <code class="literal">title</code> field in an index mapping:</p>
<div class="pre_wrapper lang-JSON">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-JSON">  "mappings": {
    "properties": {
      "title": {
        "type": "text",
        "search_analyzer": "my_analyzer",
        "updateable": true
      }
    }
  }</pre>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="modules-cross-cluster-search.html">« Search across clusters</a>
</span>
<span class="next">
<a href="search-application-overview.html">Elastic Search Applications »</a>
</span>
</div>
</body>
</html>
