<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="keywords" content="hot-spotting, hotspot, hot-spot, hot spot, hotspots, hotspotting">
<title>Update Cross-Cluster API key API | Elasticsearch Guide [master] | Elastic</title>
<meta class="elastic" name="content" content="Update Cross-Cluster API key API | Elasticsearch Guide [master]">

<link rel="home" href="index.html" title="Elasticsearch Guide [master]"/>
<link rel="up" href="security-api.html" title="Security APIs"/>
<link rel="prev" href="security-api-create-cross-cluster-api-key.html" title="Create Cross-Cluster API key API"/>
<link rel="next" href="snapshot-restore-apis.html" title="Snapshot and restore APIs"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="Elasticsearch"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Elasticsearch/Reference/master"/>
<meta name="DC.subject" content="Elasticsearch"/>
<meta name="DC.identifier" content="master"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body><div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elasticsearch Guide [master]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="rest-apis.html">REST APIs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="security-api.html">Security APIs</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="security-api-create-cross-cluster-api-key.html">« Create Cross-Cluster API key API</a>
</span>
<span class="next">
<a href="snapshot-restore-apis.html">Snapshot and restore APIs »</a>
</span>
</div>
<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="security-api-update-cross-cluster-api-key"></a>Update Cross-Cluster API key API<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/main/x-pack/docs/en/rest-api/security/update-cross-cluster-api-key.asciidoc">edit</a></h2>
</div></div></div>

<p>Update an existing cross-cluster API Key.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-update-cross-cluster-api-key-request"></a>Request<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/main/x-pack/docs/en/rest-api/security/update-cross-cluster-api-key.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">PUT /_security/cross_cluster/api_key/&lt;id&gt;</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-update-cross-cluster-api-key-prereqs"></a>Prerequisites<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/main/x-pack/docs/en/rest-api/security/update-cross-cluster-api-key.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
To use this API, you must have at least the <code class="literal">manage_security</code> cluster privilege.
Users can only update API keys that they created.
To update another user&#8217;s API key, use the <a class="xref" href="run-as-privilege.html" title="Submitting requests on behalf of other users"><code class="literal">run_as</code> feature</a>
to submit a request on behalf of another user.
</li>
</ul>
</div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>It&#8217;s not possible to use an API key as the authentication credential for this API.
To update an API key, the owner user&#8217;s credentials are required.</p>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-update-cross-cluster-api-key-desc"></a>Description<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/main/x-pack/docs/en/rest-api/security/update-cross-cluster-api-key.asciidoc">edit</a></h3>
</div></div></div>
<p>Use this API to update cross-cluster API keys created by the <a class="xref" href="security-api-create-cross-cluster-api-key.html" title="Create Cross-Cluster API key API">Create Cross-Cluster API key API</a>.
It&#8217;s not possible to update expired API keys, or API keys that have been invalidated by
<a class="xref" href="security-api-invalidate-api-key.html" title="Invalidate API key API">invalidate API Key</a>.</p>
<p>This API supports updates to an API key&#8217;s access scope and metadata.
The owner user&#8217;s information, e.g. <code class="literal">username</code>, <code class="literal">realm</code>, is also updated automatically on every call.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This API cannot update <a class="xref" href="security-api-create-api-key.html" title="Create API key API">REST API keys</a>, which should be updated by
either <a class="xref" href="security-api-update-api-key.html" title="Update API key API">Update API key</a> or <a class="xref" href="security-api-bulk-update-api-keys.html" title="Bulk update API keys API">Bulk update API keys</a> API.</p>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-update-cross-cluster-api-key-path-params"></a>Path parameters<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/main/x-pack/docs/en/rest-api/security/update-cross-cluster-api-key.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">id</code>
</span>
</dt>
<dd>
(Required, string) The ID of the API key to update.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-update-cross-cluster-api-key-request-body"></a>Request body<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/main/x-pack/docs/en/rest-api/security/update-cross-cluster-api-key.asciidoc">edit</a></h3>
</div></div></div>
<p>You can specify the following parameters in the request body. The parameters are optional. But they cannot all be absent.</p>
<div class="variablelist">
<a id="security-api-update-cross-cluster-api-key-api-key-role-descriptors"></a>
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">access</code>
</span>
</dt>
<dd>
(Optional, object) The access to be granted to this API key. The access is
composed of permissions for cross cluster search and cross cluster replication.
At least one of them must be specified.
When specified, the new access assignment fully replaces the previously assigned access.
Refer to the <a class="xref" href="security-api-create-cross-cluster-api-key.html#cross-cluster-api-key-access">parameter of the same of the Create Cross-Cluster API key API</a>
for the field&#8217;s structure.
</dd>
<dt>
<span class="term">
<code class="literal">metadata</code>
</span>
</dt>
<dd>
(Optional, object) Arbitrary metadata that you want to associate with the API key.
It supports nested data structure.
Within the <code class="literal">metadata</code> object, top-level keys beginning with <code class="literal">_</code> are reserved for system usage.
When specified, this fully replaces metadata previously associated with the API key.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-update-cross-cluster-api-key-response-body"></a>Response body<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/main/x-pack/docs/en/rest-api/security/update-cross-cluster-api-key.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">updated</code>
</span>
</dt>
<dd>
(boolean) If <code class="literal">true</code>, the API key was updated.
If <code class="literal">false</code>, the API key didn&#8217;t change because no change was detected.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="security-api-update-cross-cluster-api-key-example"></a>Examples<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/elasticsearch/edit/main/x-pack/docs/en/rest-api/security/update-cross-cluster-api-key.asciidoc">edit</a></h3>
</div></div></div>
<p>If you create a cross-cluster API key as follows:</p>
<a id="839710129a165cf93c6e329abedf9089"></a>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_security/cross_cluster/api_key
{
  "name": "my-cross-cluster-api-key",
  "access": {
    "search": [
      {
        "names": ["logs*"]
      }
    ]
  },
  "metadata": {
    "application": "search"
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2961.console"></div>
<p>A successful call returns a JSON structure that provides API key information.
For example:</p>
<a id="433b60cec9f001cefb7d1c0eae9fd92c"></a>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "id": "VuaCfGcBCdbkQm-e5aOx",
  "name": "my-cross-cluster-api-key",
  "api_key": "ui2lp2axTNmsyakw9tvNnw",
  "encoded": "VnVhQ2ZHY0JDZGJrUW0tZTVhT3g6dWkybHAyYXhUTm1zeWFrdzl0dk5udw=="
}</pre>
</div>
<p>Information of the API key, including its exact role descriptor can be inspected with
the <a class="xref" href="security-api-get-api-key.html" title="Get API key information API">Get API key API</a></p>
<a id="701f1fffc65e9e51c96aa60261e2eae3"></a>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">GET /_security/api_key?id=VuaCfGcBCdbkQm-e5aOx</pre>
</div>
<div class="console_widget" data-snippet="snippets/2962.console"></div>
<p>A successful call returns a JSON structure that contains the information of the API key:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "api_keys": [
    {
      "id": "VuaCfGcBCdbkQm-e5aOx",
      "name": "my-cross-cluster-api-key",
      "type": "cross_cluster",
      "creation": 1548550550158,
      "expiration": null,
      "invalidated": false,
      "username": "myuser",
      "realm": "native1",
      "metadata": {
        "application": "search"
      },
      "role_descriptors": {
        "cross_cluster": {  <a id="CO804-1"></a><i class="conum" data-value="1"></i>
          "cluster": [
              "cross_cluster_search"
          ],
          "indices": [
            {
              "names": [
                "logs*"
              ],
              "privileges": [
                "read", "read_cross_cluster", "view_index_metadata"
              ],
              "allow_restricted_indices": false
            }
          ],
          "applications": [ ],
          "run_as": [ ],
          "metadata": { },
          "transient_metadata": {
            "enabled": true
          }
        }
      }
    }
  ]
}</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO804-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Role descriptor corresponding to the specified <code class="literal">access</code> scope at creation time.
In this example, it grants cross cluster search permission for the <code class="literal">logs*</code> index pattern.</p>
</td>
</tr>
</table>
</div>
<p>The following example updates the API key created above, assigning it new access scope and metadata:</p>
<a id="3b64821fe9db73eb03860c60d775d7ff"></a>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">PUT /_security/cross_cluster/api_key/VuaCfGcBCdbkQm-e5aOx
{
  "access": {
    "replication": [
      {
        "names": ["archive"]
      }
    ]
  },
  "metadata": {
    "application": "replication"
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2963.console"></div>
<p>A successful call returns a JSON structure indicating that the API key was updated:</p>
<a id="95e65c9325e827594b2135ac85b26c4a"></a>
<div class="pre_wrapper lang-console-result">
<pre class="programlisting prettyprint lang-console-result">{
  "updated": true
}</pre>
</div>
<p>The API key&#8217;s permissions after the update can be inspected again with the <a class="xref" href="security-api-get-api-key.html" title="Get API key information API">Get API key API</a>
and it will be:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "api_keys": [
    {
      "id": "VuaCfGcBCdbkQm-e5aOx",
      "name": "my-cross-cluster-api-key",
      "type": "cross_cluster",
      "creation": 1548550550158,
      "expiration": null,
      "invalidated": false,
      "username": "myuser",
      "realm": "native1",
      "metadata": {
        "application": "replication"
      },
      "role_descriptors": {
        "cross_cluster": {  <a id="CO805-1"></a><i class="conum" data-value="1"></i>
          "cluster": [
              "cross_cluster_replication"
          ],
          "indices": [
            {
              "names": [
                "archive*"
              ],
              "privileges": [
                "cross_cluster_replication", "cross_cluster_replication_internal"
              ],
              "allow_restricted_indices": false
            }
          ],
          "applications": [ ],
          "run_as": [ ],
          "metadata": { },
          "transient_metadata": {
            "enabled": true
          }
        }
      }
    }
  ]
}</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO805-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Role descriptor is updated to be the <code class="literal">access</code> scope specified at update time.
In this example, it is updated to grant the cross cluster replication permission
for the <code class="literal">archive*</code> index pattern.</p>
</td>
</tr>
</table>
</div>
</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="security-api-create-cross-cluster-api-key.html">« Create Cross-Cluster API key API</a>
</span>
<span class="next">
<a href="snapshot-restore-apis.html">Snapshot and restore APIs »</a>
</span>
</div>
</div>
</body>
</html>
