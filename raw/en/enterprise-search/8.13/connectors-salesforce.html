<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Elastic Salesforce connector reference | Enterprise Search documentation [8.13] | Elastic</title>
<meta class="elastic" name="content" content="Elastic Salesforce connector reference | Enterprise Search documentation [8.13]">

<link rel="home" href="index.html" title="Enterprise Search documentation [8.13]"/>
<link rel="up" href="connectors-references.html" title="Connectors references"/>
<link rel="prev" href="connectors-s3.html" title="Elastic S3 connector reference"/>
<link rel="next" href="connectors-servicenow.html" title="Elastic ServiceNow connector reference"/>
<meta class="elastic" name="product_version" content="8.13"/>
<meta class="elastic" name="product_name" content="Enterprise Search"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Enterprise Search/Guide/8.13"/>
<meta name="DC.subject" content="Enterprise Search"/>
<meta name="DC.identifier" content="8.13"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div class="navheader">
<span class="prev">
<a href="connectors-s3.html">« Elastic S3 connector reference</a>
</span>
<span class="next">
<a href="connectors-servicenow.html">Elastic ServiceNow connector reference »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link">
<div id="related-products" class="dropdown">
<div class="related-products-title"></div>
<div class="dropdown-anchor" tabindex="0">Enterprise Search<span class="dropdown-icon"></span></div>
<div class="dropdown-content">
<ul>
<li class="dropdown-category">Enterprise Search guides</li>
<ul>
<li><a href="/guide/en/enterprise-search/current/index.html" target="_blank">Enterprise Search</a></li>
<li><a href="/guide/en/app-search/current/index.html" target="_blank">App Search</a></li>
<li><a href="/guide/en/workplace-search/current/index.html" target="_blank">Workplace Search</a></li>
</ul>
<li class="dropdown-category">Programming language clients</li>
<ul>
<li><a href="https://www.elastic.co/guide/en/enterprise-search-clients/enterprise-search-node/current/index.html" target="_blank">Node.js client</a></li>
<li><a href="https://www.elastic.co/guide/en/enterprise-search-clients/php/current/index.html" target="_blank">PHP client</a></li>
<li><a href="https://www.elastic.co/guide/en/enterprise-search-clients/python/current/index.html" target="_blank">Python client</a></li>
<li><a href="https://www.elastic.co/guide/en/enterprise-search-clients/ruby/current/index.html" target="_blank">Ruby client</a></li>
</ul>
</ul>
</div>
</div>
</span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="connectors-references.html">Connectors references</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Elastic Salesforce connector reference</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="chapter">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="connectors-salesforce"></a>Elastic Salesforce connector reference</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
</div></div></div>

<p>The <em>Elastic Salesforce connector</em> is a <a class="xref" href="connectors.html" title="Elastic connectors">connector</a> for <a href="https://www.salesforce.com/" class="ulink" target="_blank" rel="noopener">Salesforce</a> data sources.</p>
<div class="position-relative"><h3><a id="connectors-salesforce-native-connector-reference"></a><span class="strong strong"><strong>Native connector reference (managed service)</strong></span></h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<details>
<summary class="title">View reference for the <span class="strong strong"><strong>native connector reference (managed service)</strong></span>.</summary>
<div class="content">
<div class="position-relative"><h4><a id="connectors-salesforce-availability-prerequisites"></a>Availability and prerequisites</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<p>This connector is available as a <span class="strong strong"><strong>native connector</strong></span> in Elastic Cloud since <span class="strong strong"><strong>8.12.0</strong></span>.
To use this connector, satisfy all <a class="xref" href="build-connector.html" title="Connector clients (self-managed)">connector client requirements</a>.</p>
<div class="position-relative"><h4><a id="connectors-salesforce-compatability"></a>Compatibility</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<p>This connector is compatible with the following:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Salesforce
</li>
<li class="listitem">
Salesforce Sandbox
</li>
</ul>
</div>
<div class="position-relative"><h4><a id="connectors-salesforce-create-native-connector"></a>Create a Salesforce connector</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<div class="position-relative"><h5><a id="connectors-salesforce-create-use-the-ui"></a>Use the UI</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<p>To create a new Salesforce connector:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Navigate to the <span class="strong strong"><strong>Search &#8594; Connectors</strong></span> page in the Kibana UI.
</li>
<li class="listitem">
Follow the instructions to create a new native  <span class="strong strong"><strong>Salesforce</strong></span> connector.
</li>
</ol>
</div>
<p>For additional operations, see <a class="xref" href="connectors-usage.html" title="Using connectors"><em>Using connectors</em></a>.</p>
<div class="position-relative"><h5><a id="connectors-salesforce-create-use-the-api"></a>Use the API</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<p>You can use the Elasticsearch <a href="/guide/en/elasticsearch/reference/8.13/connector-apis.html" class="ulink" target="_top">Create connector API</a> to create a new native Salesforce connector.</p>
<p>For example:</p>
<div class="pre_wrapper lang-console">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console">PUT _connector/&lt;my-salesforce-connector&gt;
{
  "index_name": "&lt;my-elasticsearch-index&gt;",
  "name": "Content synced from Salesforce",
  "service_type": "salesforce",
  "is_native": "true"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/101.console"></div>
<details>
<summary class="title">You&#8217;ll also need to <span class="strong strong"><strong>create an API key</strong></span> for the connector to use.</summary>
<div class="content">
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The user needs the cluster privileges <code class="literal">manage_api_key</code> and <code class="literal">write_connector_secrets</code> to generate API keys programmatically.</p>
</div>
</div>
<p>To create an API key for the connector:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Run the following command, replacing values where indicated.
Note the <code class="literal">id</code> and <code class="literal">encoded</code> return values from the response:</p>
<div class="pre_wrapper lang-console">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console">POST /_security/api_key
{
  "name": "&lt;connector_name&gt;-connector-api-key",
  "role_descriptors": {
    "&lt;connector_name&gt;-connector-role": {
      "cluster": [
        "monitor"
      ],
      "indices": [
        {
          "names": [
            "&lt;index_name&gt;",
            ".search-acl-filter-&lt;index_name&gt;",
            ".elastic-connectors*"
          ],
          "privileges": [
            "all"
          ],
          "allow_restricted_indices": false
        }
      ]
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/102.console"></div>
</li>
<li class="listitem">
<p>Use the <code class="literal">encoded</code> value to store a connector secret, and note the <code class="literal">id</code> return value from this response:</p>
<div class="pre_wrapper lang-console">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console">POST _connector/_secret
{
  "value": &lt;encoded_api_key&gt;
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/103.console"></div>
</li>
<li class="listitem">
<p>Use the API key <code class="literal">id</code> and the connector secret <code class="literal">id</code> to update the connector:</p>
<div class="pre_wrapper lang-console">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console">PUT /_connector/&lt;connector_id&gt;/_api_key_id
{
  "api_key_id": "&lt;API key id&gt;",
  "api_key_secret_id": "&lt;secret id&gt;"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/104.console"></div>
</li>
</ol>
</div>
</div>
</details>
<p>Refer to the <a href="/guide/en/elasticsearch/reference/8.13/connector-apis.html" class="ulink" target="_top">Elasticsearch API documentation</a> for details of all available Connector APIs.</p>
<div class="position-relative"><h4><a id="connectors-salesforce-usage"></a>Usage</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<p>To use this connector as a <span class="strong strong"><strong>connector client</strong></span>, use the <span class="strong strong"><strong>Connector</strong></span> workflow in the Kibana UI.</p>
<p>For additional operations, see <a class="xref" href="connectors-usage.html" title="Using connectors">connectors usage</a>.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>You need to create an Salesforce connected app with OAuth2.0 enabled to authenticate with Salesforce.</p>
</div>
</div>
<div class="position-relative"><h5><a id="connectors-salesforce-connected-app"></a>Create a Salesforce connected app</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<p>The Salesforce connector authenticates with Salesforce through a <span class="strong strong"><strong>connected app</strong></span>.
Follow the official Salesforce documentation for <a href="https://help.salesforce.com/s/articleView?id=sf.connected_app_client_credentials_setup.htm" class="ulink" target="_blank" rel="noopener">Configuring a Connected App for the OAuth 2.0 Client Credentials Flow</a>.</p>
<p>When creating the connected app, in the section titled <span class="strong strong"><strong>API (Enable OAuth Settings)</strong></span> ensure the following settings are <em>enabled</em>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Enable OAuth Settings</strong></span>
</li>
<li class="listitem">
<p><span class="strong strong"><strong>Enable for Device Flow</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Callback URL</strong></span> should be the Salesforce dummy callback URL, <code class="literal">https://test.salesforce.com/services/oauth2/success</code>
</li>
</ul>
</div>
</li>
<li class="listitem">
<span class="strong strong"><strong>Require Secret for Web Server Flow</strong></span>
</li>
<li class="listitem">
<span class="strong strong"><strong>Require Secret for Refresh Token Flow</strong></span>
</li>
<li class="listitem">
<span class="strong strong"><strong>Enable Client Credentials Flow</strong></span>
</li>
</ul>
</div>
<p>All other options should be disabled.
Finally, in the section <span class="strong strong"><strong>Selected OAuth Scopes</strong></span>, include the following OAuth scopes:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Manage user data via APIs (api)</strong></span>
</li>
<li class="listitem">
<span class="strong strong"><strong>Perform requests at any time (refresh_token, offline_access)</strong></span>
</li>
</ul>
</div>
<div class="position-relative"><h4><a id="connectors-salesforce-admin-prerequisites"></a>Salesforce admin requirements</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<p>By default, the Salesforce connector requires global administrator permissions to access Salesforce data.
Expand the section below to learn how to create a custom Salesforce user with minimal permissions.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Create a custom Salesforce user with minimal permissions</strong></span></summary>
<div class="content">
<p>By creating a custom profile with sufficient permissions from the Setup menu, you can remove the system administrator role requirement for fetching data from Salesforce.</p>
<p>To create a new profile:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
From the Salesforce Setup menu, go to <span class="strong strong"><strong>Administration &#8658; Users &#8658; Profiles</strong></span>.
</li>
<li class="listitem">
Create a new profile.
</li>
<li class="listitem">
<p>Choose <code class="literal">Read Only</code> or <code class="literal">Standard User</code> from the <span class="strong strong"><strong>Existing Profile</strong></span> dropdown. Name the profile and save it.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>By default, <code class="literal">Read Only</code> or <code class="literal">Standard User</code> users have read permission to access all standard objects.</p>
</div>
</div>
</li>
<li class="listitem">
Edit the newly created profile. Under <span class="strong strong"><strong>Object Permissions</strong></span>, assign at least <code class="literal">Read</code> access to the standard objects and custom objects you want to ingest into Elasticsearch.
</li>
<li class="listitem">
<p>Make sure the newly created profile has at least <code class="literal">Read</code> access for the following standard objects:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Account
</li>
<li class="listitem">
Campaign
</li>
<li class="listitem">
Case
</li>
<li class="listitem">
Contact
</li>
<li class="listitem">
EmailMessage
</li>
<li class="listitem">
Lead
</li>
<li class="listitem">
Opportunity
</li>
<li class="listitem">
<p>User</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>If using <a class="xref" href="sync-rules.html#sync-rules-advanced" title="Advanced sync rules">advanced sync rules</a> you&#8217;ll need to assign <code class="literal">Read</code> access for that specific object in the profile.</p>
</div>
</div>
</li>
</ul>
</div>
</li>
<li class="listitem">
Go to <span class="strong strong"><strong>Users &#8658; Profiles</strong></span> and assign the newly created profile to the user.
</li>
<li class="listitem">
<p>Go to <span class="strong strong"><strong>Connected apps</strong></span>, select your app and then select <span class="strong strong"><strong>Edit policies</strong></span>.
Assign the client credentials flow to the user with the custom profile in Salesforce.</p>
<p>Now, the connector can be configured for this user profile to fetch all object records, without needing the system administration role.</p>
</li>
</ol>
</div>
</div>
</details>
<div class="position-relative"><h4><a id="connectors-salesforce-configuration"></a>Configuration</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<p>The following settings are required to set up this connector:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Domain (required)
</span>
</dt>
<dd>
The domain for your Salesforce account.
This is the subdomain that appears in your Salesforce URL.
For example, if your Salesforce URL is <code class="literal">foo.my.salesforce.com</code>, then your domain would be <code class="literal">foo</code>.
If you are using Salesforce Sandbox, your URL will contain an extra subdomain and will look similar to <code class="literal">foo.sandbox.my.salesforce.com</code>.
In this case, your domain would be <code class="literal">foo.sandbox</code>.
</dd>
<dt>
<span class="term">
Client ID (required)
</span>
</dt>
<dd>
The Client ID generated by your connected app.
The Salesforce documentation will sometimes also call this a <span class="strong strong"><strong>Consumer Key</strong></span>
</dd>
<dt>
<span class="term">
Client Secret (required)
</span>
</dt>
<dd>
The Client Secret generated by your connected app.
The Salesforce documentation will sometimes also call this a <span class="strong strong"><strong>Consumer Secret</strong></span>.
</dd>
<dt>
<span class="term">
Enable document level security
</span>
</dt>
</dl>
</div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>Due to a bug this configuration option is not available in the UI and needs to be manually updated.
Refer to <a class="xref" href="connectors-salesforce.html#connectors-salesforce-known-issues" title="Known issues">Known issues</a> for details.</p>
</div>
</div>
<p>Toggle to enable document level security (DLS).
Optional, disabled by default.
Refer to the <a class="xref" href="connectors-salesforce.html#connectors-salesforce-client-dls" title="Document level security (DLS)">DLS section</a> for more information, including how to set various Salesforce permission types.</p>
<p>+
When enabled:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Full syncs will fetch access control lists for each document and store them in the <code class="literal">_allow_access_control</code> field.
</li>
<li class="listitem">
Access control syncs will fetch users' access control lists and store them in a separate index.
</li>
</ul>
</div>
<div class="position-relative"><h5><a id="connectors-salesforce-configuration-credentials"></a>Finding the Client ID and Client Secret</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<p>The Client ID and Client Secret are not automatically shown to you after you create a connected app.
You can find them by taking the following steps:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Navigate to <span class="strong strong"><strong>Setup</strong></span>
</li>
<li class="listitem">
Go to <span class="strong strong"><strong>Platform Tools &gt; Apps &gt; App Manager</strong></span>
</li>
<li class="listitem">
Click on the triangle next to your app and select <span class="strong strong"><strong>View</strong></span>
</li>
<li class="listitem">
After the page loads, click on <span class="strong strong"><strong>Manage Consumer Details</strong></span>
</li>
</ul>
</div>
<p>Your Client ID and Client Secret should now be visible at the top of the page.</p>
<div class="position-relative"><h4><a id="connectors-salesforce-dls"></a>Document level security (DLS)</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<p><a class="xref" href="dls.html" title="Document level security">Document level security (DLS)</a> enables you to restrict access to documents based on a user'­s permissions.
This feature is available by default for the Salesforce connector and supports both <span class="strong strong"><strong>standard and custom objects</strong></span>.</p>
<p>Salesforce allows users to set permissions in the following ways:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Profiles</strong></span>
</li>
<li class="listitem">
<span class="strong strong"><strong>Permission sets</strong></span>
</li>
<li class="listitem">
<span class="strong strong"><strong>Permission set Groups</strong></span>
</li>
</ul>
</div>
<p>For guidance, refer to these <a href="https://howtovideos.hubs.vidyard.com/watch/B1bQnMFg2VyZq7V6zXQjPg#:~:text=This%20is%20a%20must%20watch,records%20in%20your%20Salesforce%20organization" class="ulink" target="_top">video tutorials</a> about setting Salesforce permissions.</p>
<p>To ingest any standard or custom objects, users must ensure that at least <code class="literal">Read</code> permission is granted to that object.
This can be granted using any of the following methods for setting permissions.</p>
<div class="position-relative"><h5><a id="connectors-salesforce-dls-profiles"></a>Set Permissions using Profiles</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<p>Refer to the <a href="https://help.salesforce.com/s/articleView?id=sf.admin_userprofiles.htm&amp;type=5" class="ulink" target="_top">Salesforce documentation</a> for setting permissions via Profiles.</p>
<div class="position-relative"><h5><a id="connectors-salesforce-dls-permission-sets"></a>Set Permissions using Permissions Set</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<p>Refer to the <a href="https://help.salesforce.com/s/articleView?id=sf.perm_sets_overview.htm&amp;language=en_US&amp;type=5" class="ulink" target="_top">Salesforce documentation</a> for setting permissions via Permissions Sets.</p>
<div class="position-relative"><h5><a id="connectors-salesforce-dls-permission-set-groups"></a>Set Permissions using Permissions Set group</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<p>Refer to the <a href="https://help.salesforce.com/s/articleView?id=sf.perm_set_groups.htm&amp;type=5" class="ulink" target="_top">Salesforce documentation</a> for setting permissions via Permissions Set Groups.</p>
<div class="position-relative"><h5><a id="connectors-salesforce-dls-assign-permissions"></a>Assign Profiles, Permission Set and Permission Set Groups to the User</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<p>Once the permissions are set, assign the Profiles, Permission Set or Permission Set Groups to the user.
Follow these steps in Salesforce:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Navigate to <code class="literal">Administration</code> under the <code class="literal">Users</code> section.
</li>
<li class="listitem">
Select <code class="literal">Users</code> and choose the user to set the permissions to.
</li>
<li class="listitem">
Set the <code class="literal">Profile</code>, <code class="literal">Permission Set</code> or <code class="literal">Permission Set Groups</code> created in the earlier steps.
</li>
</ol>
</div>
<div class="position-relative"><h4><a id="connectors-salesforce-sync-rules"></a>Sync rules</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<p><em>Basic</em> sync rules are identical for all connectors and are available by default.
For more information read <a class="xref" href="sync-rules.html#sync-rules-types" title="Types of sync rule">Types of sync rule</a>.</p>
<div class="position-relative"><h5><a id="connectors-salesforce-sync-rules-advanced"></a>Advanced sync rules</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>A <a class="xref" href="connectors-sync-types.html#connectors-sync-types-full" title="Full syncs">full sync</a> is required for advanced sync rules to take effect.</p>
</div>
</div>
<p>The following section describes <span class="strong strong"><strong>advanced sync rules</strong></span> for this connector.
Advanced sync rules enable filtering of data in Salesforce <em>before</em> indexing into Elasticsearch.</p>
<p>They take the following parameters:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<code class="literal">query</code> : Salesforce query to filter the documents.
</li>
<li class="listitem">
<code class="literal">language</code> : Salesforce query language.
Allowed values are <span class="strong strong"><strong>SOQL</strong></span> and <span class="strong strong"><strong>SOSL</strong></span>.
</li>
</ol>
</div>
<div class="position-relative"><h6><a id="connectors-salesforce-sync-rules-advanced-fetch-query-language"></a>Fetch documents based on the query and language specified</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<p><span class="strong strong"><strong>Example</strong></span>: Fetch documents using SOQL query</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">[
  {
    "query": "SELECT Id, Name FROM Account",
    "language": "SOQL"
  }
]</pre>
</div>
<p><span class="strong strong"><strong>Example</strong></span>: Fetch documents using SOSL query.</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">[
  {
    "query": "FIND {Salesforce} IN ALL FIELDS",
    "language": "SOSL"
  }
]</pre>
</div>
<div class="position-relative"><h6><a id="connectors-salesforce-sync-rules-advanced-fetch-objects"></a>Fetch standard and custom objects using SOQL and SOSL queries</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<p><span class="strong strong"><strong>Example</strong></span>: Fetch documents for standard objects via SOQL and SOSL query.</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">[
  {
    "query": "SELECT Account_Id, Address, Contact_Number FROM Account",
    "language": "SOQL"
  },
  {
    "query": "FIND {Alex Wilber} IN ALL FIELDS RETURNING Contact(LastModifiedDate, Name, Address)",
    "language": "SOSL"
  }
]</pre>
</div>
<p><span class="strong strong"><strong>Example</strong></span>: Fetch documents for custom objects via SOQL and SOSL query.</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">[
  {
    "query": "SELECT Connector_Name, Version FROM Connector__c",
    "language": "SOQL"
  },
  {
    "query": "FIND {Salesforce} IN ALL FIELDS RETURNING Connectors__c(Id, Connector_Name, Connector_Version)",
    "language": "SOSL"
  }
]</pre>
</div>
<div class="position-relative"><h6><a id="connectors-salesforce-sync-rules-advanced-fetch-standard-custom-fields"></a>Fetch documents with standard and custom fields</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<p><span class="strong strong"><strong>Example</strong></span>: Fetch documents with all standard and custom fields for Account object.</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">[
  {
    "query": "SELECT FIELDS(ALL) FROM Account",
    "language": "SOQL"
  }
]</pre>
</div>
<p><span class="strong strong"><strong>Example</strong></span>: Fetch documents with all custom fields for Connector object.</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">[
  {
    "query": "SELECT FIELDS(CUSTOM) FROM Connector__c",
    "language": "SOQL"
  }
]</pre>
</div>
<p><span class="strong strong"><strong>Example</strong></span>: Fetch documents with all standard fields for Account object.</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">[
  {
    "query": "SELECT FIELDS(STANDARD) FROM Account",
    "language": "SOQL"
  }
]</pre>
</div>
<div class="position-relative"><h4><a id="connectors-salesforce-documents-syncs"></a>Documents and syncs</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<p>The connector syncs the following Salesforce objects:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Accounts</strong></span>
</li>
<li class="listitem">
<span class="strong strong"><strong>Campaigns</strong></span>
</li>
<li class="listitem">
<span class="strong strong"><strong>Cases</strong></span>
</li>
<li class="listitem">
<span class="strong strong"><strong>Contacts</strong></span>
</li>
<li class="listitem">
<span class="strong strong"><strong>Content Documents</strong></span> (files uploaded to Salesforce)
</li>
<li class="listitem">
<span class="strong strong"><strong>Leads</strong></span>
</li>
<li class="listitem">
<span class="strong strong"><strong>Opportunities</strong></span>
</li>
</ul>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The connector will not ingest any objects that it does not have permissions to query.</p>
</div>
</div>
<div class="position-relative"><h5><a id="connectors-salesforce-sync-types"></a>Sync types</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<p><a class="xref" href="connectors-sync-types.html#connectors-sync-types-full" title="Full syncs">Full syncs</a> are supported by default for all connectors.</p>
<p>This connector also supports <a class="xref" href="connectors-sync-types.html#connectors-sync-types-incremental" title="Incremental syncs">incremental syncs</a>, but this feature is currently disabled by default.
Refer to the linked documentation for enabling incremental syncs.</p>
<div class="position-relative"><h4><a id="connectors-salesforce-content-extraction"></a>Content Extraction</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<p>The connector will retrieve Content Documents from your Salesforce source if they meet the following criteria:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Are attached to one or more objects that are synced
</li>
<li class="listitem">
Are of a file type that can be extracted
</li>
</ul>
</div>
<p>This means that the connector will not ingest any Content Documents you have that are <em>not</em> attached to a supported Salesforce object.
See <a class="xref" href="connectors-salesforce.html#connectors-salesforce-documents-syncs" title="Documents and syncs">documents and syncs</a> for a list of supported object types.</p>
<p>If a single Content Document is attached to multiple supported objects, only one Elastic document will be created for it.
This document will retain links to every object that it was connected to in the <code class="literal">related_ids</code> field.</p>
<p>See <a class="xref" href="connectors-content-extraction.html" title="Content extraction">content extraction</a> for more specifics on content extraction.</p>
<div class="position-relative"><h4><a id="connectors-salesforce-known-issues"></a>Known issues</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p><span class="strong strong"><strong>DLS configuration option missing from UI</strong></span></p>
<p>Due to a bug, the DLS configuration option is not available in the UI.
This will throw a <code class="literal">MalformedConfigurationError</code> and block syncs.
This is due to the native Salesforce connector definition missing the <code class="literal">use_document_level_security</code> configuration.</p>
<p>Use the following workaround:</p>
</li>
<li class="listitem">
Find the connector&#8217;s ID.
</li>
<li class="listitem">
<p>Run the following Elasticsearch API call:</p>
<div class="pre_wrapper lang-console">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console">POST .elastic-connectors/_update/&lt;connector-ID&gt;
{
  "doc":{
    "configuration":{
      "use_document_level_security": {
        "depends_on": [],
        "display": "toggle",
        "tooltip": "Document level security ensures identities and permissions set in Salesforce are maintained in Elasticsearch. This enables you to restrict and personalize read-access users and groups have to documents in this index. Access control syncs ensure this metadata is kept up to date in your Elasticsearch documents.",
        "default_value": null,
        "label": "Enable document level security",
        "sensitive": false,
        "type": "bool",
        "required": true,
        "options": [],
        "validations": [],
        "value": false,
        "order": 5,
        "ui_restrictions": []
      }
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/105.console"></div>
</li>
</ul>
</div>
<p>Refer to <a class="xref" href="connectors-known-issues.html" title="Connector known issues">connector known issues</a> for a list of known issues for all connectors.</p>
<div class="position-relative"><h4><a id="connectors-salesforce-security"></a>Security</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<p>See <a class="xref" href="connectors-security.html" title="Connectors security">connectors security</a>.</p>
<div class="position-relative"><h4><a id="connectors-salesforce-source"></a>Framework and source</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<p>This connector is built with the <a href="https://github.com/elastic/connectors/tree/8.13" class="ulink" target="_blank" rel="noopener">Elastic connector framework</a>.</p>
<p>View the <a href="https://github.com/elastic/connectors/tree/8.13/connectors/sources/salesforce.py" class="ulink" target="_blank" rel="noopener">source code for this connector</a> (branch <em>8.13</em>, compatible with Elastic <em>8.13</em>).</p>
</div>
</details>
<div class="position-relative"><h3><a id="connectors-salesforce-connector-client-reference"></a><span class="strong strong"><strong>Connector client reference (self-managed)</strong></span></h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<details>
<summary class="title">View reference for the <span class="strong strong"><strong>connector client reference (self-managed)</strong></span>.</summary>
<div class="content">
<div class="position-relative"><h4><a id="connectors-salesforce-client-availability-prerequisites"></a>Availability and prerequisites</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<p>This connector is available as a self-managed <span class="strong strong"><strong>connector client</strong></span>.
This connector client is compatible with Elastic versions <span class="strong strong"><strong>8.10.0+</strong></span>.
To use this connector, satisfy all <a class="xref" href="build-connector.html" title="Connector clients (self-managed)">connector client requirements</a>.</p>
<div class="position-relative"><h4><a id="connectors-salesforce-client-compatability"></a>Compatibility</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<p>This connector is compatible with the following:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Salesforce
</li>
<li class="listitem">
Salesforce Sandbox
</li>
</ul>
</div>
<div class="position-relative"><h4><a id="connectors-salesforce-create-connector-client"></a>Create a Salesforce connector</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<div class="position-relative"><h5><a id="connectors-salesforce-client-create-use-the-ui"></a>Use the UI</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<p>To create a new Salesforce connector:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Navigate to the <span class="strong strong"><strong>Search &#8594; Connectors</strong></span> page in the Kibana UI.
</li>
<li class="listitem">
Follow the instructions to create a new  <span class="strong strong"><strong>Salesforce</strong></span> connector client.
</li>
</ol>
</div>
<p>For additional operations, see <a class="xref" href="connectors-usage.html" title="Using connectors"><em>Using connectors</em></a>.</p>
<div class="position-relative"><h5><a id="connectors-salesforce-client-create-use-the-api"></a>Use the API</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<p>You can use the Elasticsearch <a href="/guide/en/elasticsearch/reference/8.13/connector-apis.html" class="ulink" target="_top">Create connector API</a> to create a new self-managed Salesforce connector client.</p>
<p>For example:</p>
<div class="pre_wrapper lang-console">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console">PUT _connector/my-salesforce-connector
{
  "index_name": "my-elasticsearch-index",
  "name": "Content synced from Salesforce",
  "service_type": "salesforce"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/106.console"></div>
<details>
<summary class="title">You&#8217;ll also need to <span class="strong strong"><strong>create an API key</strong></span> for the connector to use.</summary>
<div class="content">
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The user needs the cluster privileges <code class="literal">manage_api_key</code> and <code class="literal">write_connector_secrets</code> to generate API keys programmatically.</p>
</div>
</div>
<p>To create an API key for the connector:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Run the following command, replacing values where indicated.
Note the <code class="literal">encoded</code> return values from the response:</p>
<div class="pre_wrapper lang-console">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console">POST /_security/api_key
{
  "name": "&lt;connector_name&gt;-connector-api-key",
  "role_descriptors": {
    "&lt;connector_name&gt;-connector-role": {
      "cluster": [
        "monitor"
      ],
      "indices": [
        {
          "names": [
            "&lt;index_name&gt;",
            ".search-acl-filter-&lt;index_name&gt;",
            ".elastic-connectors*"
          ],
          "privileges": [
            "all"
          ],
          "allow_restricted_indices": false
        }
      ]
    }
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/107.console"></div>
</li>
<li class="listitem">
Update your <code class="literal">config.yml</code> file with the API key <code class="literal">encoded</code> value.
</li>
</ol>
</div>
</div>
</details>
<p>Refer to the <a href="/guide/en/elasticsearch/reference/8.13/connector-apis.html" class="ulink" target="_top">Elasticsearch API documentation</a> for details of all available Connector APIs.</p>
<div class="position-relative"><h4><a id="connectors-salesforce-client-usage"></a>Usage</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<p>To use this connector as a <span class="strong strong"><strong>connector client</strong></span>, use the <span class="strong strong"><strong>Connector</strong></span> workflow in the Kibana UI.</p>
<p>For additional operations, see <a class="xref" href="connectors-usage.html" title="Using connectors">connectors usage</a>.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>You need to create an Salesforce connected app with OAuth2.0 enabled to authenticate with Salesforce.</p>
</div>
</div>
<div class="position-relative"><h5><a id="connectors-salesforce-client-connected-app"></a>Create a Salesforce connected app</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<p>The Salesforce connector authenticates with Salesforce through a <span class="strong strong"><strong>connected app</strong></span>.
Follow the official Salesforce documentation for <a href="https://help.salesforce.com/s/articleView?id=sf.connected_app_client_credentials_setup.htm" class="ulink" target="_blank" rel="noopener">Configuring a Connected App for the OAuth 2.0 Client Credentials Flow</a>.</p>
<p>When creating the connected app, in the section titled <span class="strong strong"><strong>API (Enable OAuth Settings)</strong></span> ensure the following settings are <em>enabled</em>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Enable OAuth Settings</strong></span>
</li>
<li class="listitem">
<p><span class="strong strong"><strong>Enable for Device Flow</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Callback URL</strong></span> should be the Salesforce dummy callback URL, <code class="literal">https://test.salesforce.com/services/oauth2/success</code>
</li>
</ul>
</div>
</li>
<li class="listitem">
<span class="strong strong"><strong>Require Secret for Web Server Flow</strong></span>
</li>
<li class="listitem">
<span class="strong strong"><strong>Require Secret for Refresh Token Flow</strong></span>
</li>
<li class="listitem">
<span class="strong strong"><strong>Enable Client Credentials Flow</strong></span>
</li>
</ul>
</div>
<p>All other options should be disabled.
Finally, in the section <span class="strong strong"><strong>Selected OAuth Scopes</strong></span>, include the following OAuth scopes:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Manage user data via APIs (api)</strong></span>
</li>
<li class="listitem">
<span class="strong strong"><strong>Perform requests at any time (refresh_token, offline_access)</strong></span>
</li>
</ul>
</div>
<div class="position-relative"><h4><a id="connectors-client-salesforce-admin-prerequisites"></a>Salesforce admin requirements</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<p>By default, the Salesforce connector requires global administrator permissions to access Salesforce data.
Expand the section below to learn how to create a custom Salesforce user with minimal permissions.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Create a custom Salesforce user with minimal permissions</strong></span></summary>
<div class="content">
<p>By creating a custom profile with sufficient permissions from the Setup menu, you can remove the system administrator role requirement for fetching data from Salesforce.</p>
<p>To create a new profile:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
From the Salesforce Setup menu, go to <span class="strong strong"><strong>Administration &#8658; Users &#8658; Profiles</strong></span>.
</li>
<li class="listitem">
Create a new profile.
</li>
<li class="listitem">
<p>Choose <code class="literal">Read Only</code> or <code class="literal">Standard User</code> from the <span class="strong strong"><strong>Existing Profile</strong></span> dropdown. Name the profile and save it.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>By default, <code class="literal">Read Only</code> or <code class="literal">Standard User</code> users have read permission to access all standard objects.</p>
</div>
</div>
</li>
<li class="listitem">
Edit the newly created profile. Under <span class="strong strong"><strong>Object Permissions</strong></span>, assign at least <code class="literal">Read</code> access to the standard objects and custom objects you want to ingest into Elasticsearch.
</li>
<li class="listitem">
<p>Make sure the newly created profile has at least <code class="literal">Read</code> access for the following standard objects:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Account
</li>
<li class="listitem">
Campaign
</li>
<li class="listitem">
Case
</li>
<li class="listitem">
Contact
</li>
<li class="listitem">
EmailMessage
</li>
<li class="listitem">
Lead
</li>
<li class="listitem">
Opportunity
</li>
<li class="listitem">
<p>User</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>If using <a class="xref" href="sync-rules.html#sync-rules-advanced" title="Advanced sync rules">advanced sync rules</a> you&#8217;ll need to assign <code class="literal">Read</code> access for that specific object in the profile.</p>
</div>
</div>
</li>
</ul>
</div>
</li>
<li class="listitem">
Go to <span class="strong strong"><strong>Users &#8658; Profiles</strong></span> and assign the newly created profile to the user.
</li>
<li class="listitem">
<p>Go to <span class="strong strong"><strong>Connected apps</strong></span>, select your app and then select <span class="strong strong"><strong>Edit policies</strong></span>.
Assign the client credentials flow to the user with the custom profile in Salesforce.</p>
<p>Now, the connector can be configured for this user profile to fetch all object records, without needing the system administration role.</p>
</li>
</ol>
</div>
</div>
</details>
<div class="position-relative"><h4><a id="connectors-salesforce-client-docker"></a>Deployment using Docker</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<p>Connector clients are run on your own infrastructure.</p>
<p>You can deploy the Salesforce connector as a self-managed connector client using Docker.
Follow these instructions.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Step 1: Download sample configuration file</strong></span></summary>
<div class="content">
<p>Download the sample configuration file.
You can either download it manually or run the following command:</p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">curl https://raw.githubusercontent.com/elastic/connectors/main/config.yml.example --output ~/connectors-config/config.yml</pre>
</div>
<p>Remember to update the <code class="literal">--output</code> argument value if your directory name is different, or you want to use a different config file name.</p>
</div>
</details>
<details>
<summary class="title"><span class="strong strong"><strong>Step 2: Update the configuration file for your self-managed connector</strong></span></summary>
<div class="content">
<p>Update the configuration file with the following settings to match your environment:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">elasticsearch.host</code>
</li>
<li class="listitem">
<code class="literal">elasticsearch.api_key</code>
</li>
<li class="listitem">
<code class="literal">connectors</code>
</li>
</ul>
</div>
<p>If you&#8217;re running the connector service against a Dockerized version of Elasticsearch and Kibana, your config file will look like this:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml"># When connecting to your cloud deployment you should edit the host value
elasticsearch.host: http://host.docker.internal:9200
elasticsearch.api_key: &lt;ELASTICSEARCH_API_KEY&gt;

connectors:
  -
    connector_id: &lt;CONNECTOR_ID_FROM_KIBANA&gt;
    service_type: salesforce
    api_key: &lt;CONNECTOR_API_KEY_FROM_KIBANA&gt; # Optional. If not provided, the connector will use the elasticsearch.api_key instead</pre>
</div>
<p>Using the <code class="literal">elasticsearch.api_key</code> is the recommended authentication method. However, you can also use <code class="literal">elasticsearch.username</code> and <code class="literal">elasticsearch.password</code> to authenticate with your Elasticsearch instance.</p>
<p>Note: You can change other default configurations by simply uncommenting specific settings in the configuration file and modifying their values.</p>
</div>
</details>
<details>
<summary class="title"><span class="strong strong"><strong>Step 3: Run the Docker image</strong></span></summary>
<div class="content">
<p>Run the Docker image with the Connector Service using the following command:</p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">docker run \
-v ~/connectors-config:/config \
--network "elastic" \
--tty \
--rm \
docker.elastic.co/enterprise-search/elastic-connectors:8.13.4.0 \
/app/bin/elastic-ingest \
-c /config/config.yml</pre>
</div>
</div>
</details>
<p>Refer to <a href="https://github.com/elastic/connectors/tree/8.13/docs/DOCKER.md" class="ulink" target="_blank" rel="noopener"><code class="literal">DOCKER.md</code></a> in the <code class="literal">elastic/connectors</code> repo for more details.</p>
<p>Find all available Docker images in the <a href="https://www.docker.elastic.co/r/enterprise-search/elastic-connectors" class="ulink" target="_top">official registry</a>.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>We also have a quickstart self-managed option using Docker Compose, so you can spin up all required services at once: Elasticsearch, Kibana, and the connectors service.
Refer to this <a href="https://github.com/elastic/connectors/tree/main/scripts/stack#readme" class="ulink" target="_top">README</a> in the <code class="literal">elastic/connectors</code> repo for more information.</p>
</div>
</div>
<div class="position-relative"><h4><a id="connectors-salesforce-client-configuration"></a>Configuration</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<p>The following settings are required to set up this connector:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">domain</code>(required)
</span>
</dt>
<dd>
The domain for your Salesforce account.
This is the subdomain that appears in your Salesforce URL.
For example, if your Salesforce URL is <code class="literal">foo.my.salesforce.com</code>, then your domain would be <code class="literal">foo</code>.
If you are using Salesforce Sandbox, your URL will contain an extra subdomain and will look similar to <code class="literal">foo.sandbox.my.salesforce.com</code>.
In this case, your domain would be <code class="literal">foo.sandbox</code>.
</dd>
<dt>
<span class="term">
<code class="literal">client_id</code>(required)
</span>
</dt>
<dd>
The Client ID generated by your connected app.
The Salesforce documentation will sometimes also call this a <span class="strong strong"><strong>Consumer Key</strong></span>
</dd>
<dt>
<span class="term">
<code class="literal">client_secret</code>(required)
</span>
</dt>
<dd>
The Client Secret generated by your connected app.
The Salesforce documentation will sometimes also call this a <span class="strong strong"><strong>Consumer Secret</strong></span>.
</dd>
<dt>
<span class="term">
<code class="literal">use_document_level_security</code>
</span>
</dt>
<dd>
<p>
Toggle to enable document level security (DLS).
Optional, disabled by default.
Refer to the <a class="xref" href="connectors-salesforce.html#connectors-salesforce-dls" title="Document level security (DLS)">DLS section</a> for more information, including how to set various Salesforce permission types.
</p>
<p>When enabled:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Full syncs will fetch access control lists for each document and store them in the <code class="literal">_allow_access_control</code> field.
</li>
<li class="listitem">
Access control syncs will fetch users' access control lists and store them in a separate index.
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="position-relative"><h5><a id="connectors-salesforce-client-configuration-credentials"></a>Finding the Client ID and Client Secret</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<p>The Client ID and Client Secret are not automatically shown to you after you create a connected app.
You can find them by taking the following steps:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Navigate to <span class="strong strong"><strong>Setup</strong></span>
</li>
<li class="listitem">
Go to <span class="strong strong"><strong>Platform Tools &gt; Apps &gt; App Manager</strong></span>
</li>
<li class="listitem">
Click on the triangle next to your app and select <span class="strong strong"><strong>View</strong></span>
</li>
<li class="listitem">
After the page loads, click on <span class="strong strong"><strong>Manage Consumer Details</strong></span>
</li>
</ul>
</div>
<p>Your Client ID and Client Secret should now be visible at the top of the page.</p>
<div class="position-relative"><h4><a id="connectors-salesforce-client-dls"></a>Document level security (DLS)</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<p><a class="xref" href="dls.html" title="Document level security">Document level security (DLS)</a> enables you to restrict access to documents based on a user'­s permissions.
This feature is available by default for the Salesforce connector and supports both <span class="strong strong"><strong>standard and custom objects</strong></span>.</p>
<p>Salesforce allows users to set permissions in the following ways:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Profiles</strong></span>
</li>
<li class="listitem">
<span class="strong strong"><strong>Permission sets</strong></span>
</li>
<li class="listitem">
<span class="strong strong"><strong>Permission set Groups</strong></span>
</li>
</ul>
</div>
<p>For guidance, refer to these <a href="https://howtovideos.hubs.vidyard.com/watch/B1bQnMFg2VyZq7V6zXQjPg#:~:text=This%20is%20a%20must%20watch,records%20in%20your%20Salesforce%20organization" class="ulink" target="_top">video tutorials</a> about setting Salesforce permissions.</p>
<p>To ingest any standard or custom objects, users must ensure that at least <code class="literal">Read</code> permission is granted to that object.
This can be granted using any of the following methods for setting permissions.</p>
<div class="position-relative"><h5><a id="connectors-salesforce-client-dls-profiles"></a>Set Permissions using Profiles</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<p>Refer to the <a href="https://help.salesforce.com/s/articleView?id=sf.admin_userprofiles.htm&amp;type=5" class="ulink" target="_top">Salesforce documentation</a> for setting permissions via Profiles.</p>
<div class="position-relative"><h5><a id="connectors-salesforce-client-dls-permission-sets"></a>Set Permissions using Permissions Set</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<p>Refer to the <a href="https://help.salesforce.com/s/articleView?id=sf.perm_sets_overview.htm&amp;language=en_US&amp;type=5" class="ulink" target="_top">Salesforce documentation</a> for setting permissions via Permissions Sets.</p>
<div class="position-relative"><h5><a id="connectors-salesforce-client-dls-permission-set-groups"></a>Set Permissions using Permissions Set group</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<p>Refer to the <a href="https://help.salesforce.com/s/articleView?id=sf.perm_set_groups.htm&amp;type=5" class="ulink" target="_top">Salesforce documentation</a> for setting permissions via Permissions Set Groups.</p>
<div class="position-relative"><h5><a id="connectors-salesforce-client-dls-assign-permissions"></a>Assign Profiles, Permission Set and Permission Set Groups to the User</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<p>Once the permissions are set, assign the Profiles, Permission Set or Permission Set Groups to the user.
Follow these steps in Salesforce:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Navigate to <code class="literal">Administration</code> under the <code class="literal">Users</code> section.
</li>
<li class="listitem">
Select <code class="literal">Users</code> and choose the user to set the permissions to.
</li>
<li class="listitem">
Set the <code class="literal">Profile</code>, <code class="literal">Permission Set</code> or <code class="literal">Permission Set Groups</code> created in the earlier steps.
</li>
</ol>
</div>
<div class="position-relative"><h4><a id="connectors-salesforce-client-sync-rules"></a>Sync rules</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<p><em>Basic</em> sync rules are identical for all connectors and are available by default.</p>
<p>For more information read <a class="xref" href="sync-rules.html#sync-rules-types" title="Types of sync rule">sync rules</a>.</p>
<div class="position-relative"><h5><a id="connectors-salesforce-client-sync-rules-advanced"></a>Advanced sync rules</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>A <a class="xref" href="connectors-sync-types.html#connectors-sync-types-full" title="Full syncs">full sync</a> is required for advanced sync rules to take effect.</p>
</div>
</div>
<p>The following section describes <span class="strong strong"><strong>advanced sync rules</strong></span> for this connector.
Advanced sync rules enable filtering of data in Salesforce <em>before</em> indexing into Elasticsearch.</p>
<p>They take the following parameters:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<code class="literal">query</code> : Salesforce query to filter the documents.
</li>
<li class="listitem">
<code class="literal">language</code> : Salesforce query language.
Allowed values are <span class="strong strong"><strong>SOQL</strong></span> and <span class="strong strong"><strong>SOSL</strong></span>.
</li>
</ol>
</div>
<div class="position-relative"><h6><a id="connectors-salesforce-client-sync-rules-advanced-fetch-query-language"></a>Fetch documents based on the query and language specified</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<p><span class="strong strong"><strong>Example</strong></span>: Fetch documents using SOQL query</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">[
  {
    "query": "SELECT Id, Name FROM Account",
    "language": "SOQL"
  }
]</pre>
</div>
<p><span class="strong strong"><strong>Example</strong></span>: Fetch documents using SOSL query.</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">[
  {
    "query": "FIND {Salesforce} IN ALL FIELDS",
    "language": "SOSL"
  }
]</pre>
</div>
<div class="position-relative"><h6><a id="connectors-salesforce-client-sync-rules-advanced-fetch-objects"></a>Fetch standard and custom objects using SOQL and SOSL queries</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<p><span class="strong strong"><strong>Example</strong></span>: Fetch documents for standard objects via SOQL and SOSL query.</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">[
  {
    "query": "SELECT Account_Id, Address, Contact_Number FROM Account",
    "language": "SOQL"
  },
  {
    "query": "FIND {Alex Wilber} IN ALL FIELDS RETURNING Contact(LastModifiedDate, Name, Address)",
    "language": "SOSL"
  }
]</pre>
</div>
<p><span class="strong strong"><strong>Example</strong></span>: Fetch documents for custom objects via SOQL and SOSL query.</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">[
  {
    "query": "SELECT Connector_Name, Version FROM Connector__c",
    "language": "SOQL"
  },
  {
    "query": "FIND {Salesforce} IN ALL FIELDS RETURNING Connectors__c(Id, Connector_Name, Connector_Version)",
    "language": "SOSL"
  }
]</pre>
</div>
<div class="position-relative"><h6><a id="connectors-salesforce-client-sync-rules-advanced-fetch-standard-custom-fields"></a>Fetch documents with standard and custom fields</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<p><span class="strong strong"><strong>Example</strong></span>: Fetch documents with all standard and custom fields for Account object.</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">[
  {
    "query": "SELECT FIELDS(ALL) FROM Account",
    "language": "SOQL"
  }
]</pre>
</div>
<p><span class="strong strong"><strong>Example</strong></span>: Fetch documents with all custom fields for Connector object.</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">[
  {
    "query": "SELECT FIELDS(CUSTOM) FROM Connector__c",
    "language": "SOQL"
  }
]</pre>
</div>
<p><span class="strong strong"><strong>Example</strong></span>: Fetch documents with all standard fields for Account object.</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">[
  {
    "query": "SELECT FIELDS(STANDARD) FROM Account",
    "language": "SOQL"
  }
]</pre>
</div>
<div class="position-relative"><h4><a id="connectors-salesforce-client-documents-syncs"></a>Documents and syncs</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<p>The connector syncs the following Salesforce objects:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Accounts</strong></span>
</li>
<li class="listitem">
<span class="strong strong"><strong>Campaigns</strong></span>
</li>
<li class="listitem">
<span class="strong strong"><strong>Cases</strong></span>
</li>
<li class="listitem">
<span class="strong strong"><strong>Contacts</strong></span>
</li>
<li class="listitem">
<span class="strong strong"><strong>Content Documents</strong></span> (files uploaded to Salesforce)
</li>
<li class="listitem">
<span class="strong strong"><strong>Leads</strong></span>
</li>
<li class="listitem">
<span class="strong strong"><strong>Opportunities</strong></span>
</li>
</ul>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The connector will not ingest any objects that it does not have permissions to query.</p>
</div>
</div>
<div class="position-relative"><h5><a id="connectors-salesforce-client-sync-types"></a>Sync types</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<p><a class="xref" href="connectors-sync-types.html#connectors-sync-types-full" title="Full syncs">Full syncs</a> are supported by default for all connectors.</p>
<p>This connector also supports <a class="xref" href="connectors-sync-types.html#connectors-sync-types-incremental" title="Incremental syncs">incremental syncs</a>, but this feature is currently disabled by default.
Refer to the linked documentation for enabling incremental syncs.</p>
<div class="position-relative"><h4><a id="connectors-salesforce-client-content-extraction"></a>Content Extraction</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<p>The connector will retrieve Content Documents from your Salesforce source if they meet the following criteria:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Are attached to one or more objects that are synced
</li>
<li class="listitem">
Are of a file type that can be extracted
</li>
</ul>
</div>
<p>This means that the connector will not ingest any Content Documents you have that are <em>not</em> attached to a supported Salesforce object.
See <a class="xref" href="connectors-salesforce.html#connectors-salesforce-client-documents-syncs" title="Documents and syncs">documents and syncs</a> for a list of supported object types.</p>
<p>If a single Content Document is attached to multiple supported objects, only one Elastic document will be created for it.
This document will retain links to every object that it was connected to in the <code class="literal">related_ids</code> field.</p>
<p>See <a class="xref" href="connectors-content-extraction.html" title="Content extraction">content extraction</a> for more specifics on content extraction.</p>
<div class="position-relative"><h4><a id="connectors-salesforce-client-known-issues"></a>Known issues</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<p>There are currently no known issues for this connector.
Refer to <a class="xref" href="connectors-known-issues.html" title="Connector known issues">connector known issues</a> for a list of known issues for all connectors.</p>
<div class="position-relative"><h4><a id="connectors-salesforce-client-security"></a>Security</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<p>See <a class="xref" href="connectors-security.html" title="Connectors security">connectors security</a>.</p>
<div class="position-relative"><h4><a id="connectors-salesforce-client-source"></a>Framework and source</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/8.13/enterprise-search-docs/connectors-salesforce.asciidoc">edit</a></div>
<p>This connector is built with the <a href="https://github.com/elastic/connectors/tree/8.13" class="ulink" target="_blank" rel="noopener">Elastic connector framework</a>.</p>
<p>View the <a href="https://github.com/elastic/connectors/tree/8.13/connectors/sources/salesforce.py" class="ulink" target="_blank" rel="noopener">source code for this connector</a> (branch <em>8.13</em>, compatible with Elastic <em>8.13</em>).</p>
</div>
</details>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="connectors-s3.html">« Elastic S3 connector reference</a>
</span>
<span class="next">
<a href="connectors-servicenow.html">Elastic ServiceNow connector reference »</a>
</span>
</div>
</body>
</html>
