<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Command reference | Fleet and Elastic Agent Guide [7.15] | Elastic</title>
<meta class="elastic" name="content" content="Command reference | Fleet and Elastic Agent Guide [7.15]">

<link rel="home" href="index.html" title="Fleet and Elastic Agent Guide [7.15]"/>
<link rel="up" href="index.html" title="Fleet and Elastic Agent Guide [7.15]"/>
<link rel="prev" href="data-streams.html" title="Data streams"/>
<link rel="next" href="fleet-troubleshooting.html" title="Troubleshoot common problems"/>
<meta class="elastic" name="product_version" content="7.15"/>
<meta class="elastic" name="product_name" content="Fleet and Elastic Agent"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Fleet/Guide/Elastic Agent/7.15"/>
<meta name="DC.subject" content="Fleet and Elastic Agent"/>
<meta name="DC.identifier" content="7.15"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body><div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Fleet and Elastic Agent Guide [7.15]</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="data-streams.html">« Data streams</a>
</span>
<span class="next">
<a href="fleet-troubleshooting.html">Troubleshoot common problems »</a>
</span>
</div>
<div class="chapter xpack">
<div class="titlepage"><div><div>
<h1 class="title"><a id="elastic-agent-cmd-options"></a>Command reference<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/ingest-docs/edit/7.15/docs/en/ingest-management/commands.asciidoc">edit</a></h1>
</div></div></div>
<p>Elastic Agent provides commands for running Elastic Agent, managing Fleet Server, and
doing common tasks:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="elastic-agent-cmd-options.html#elastic-agent-enroll-command" title="elastic-agent enroll">enroll</a>
</li>
<li class="listitem">
<a class="xref" href="elastic-agent-cmd-options.html#elastic-agent-help-command" title="elastic-agent help">help</a>
</li>
<li class="listitem">
<a class="xref" href="elastic-agent-cmd-options.html#elastic-agent-inspect-command" title="elastic-agent inspect">inspect</a>
</li>
<li class="listitem">
<a class="xref" href="elastic-agent-cmd-options.html#elastic-agent-install-command" title="elastic-agent install">install</a>
</li>
<li class="listitem">
<a class="xref" href="elastic-agent-cmd-options.html#elastic-agent-restart-command" title="elastic-agent restart">restart</a>
</li>
<li class="listitem">
<a class="xref" href="elastic-agent-cmd-options.html#elastic-agent-run-command" title="elastic-agent run">run</a>
</li>
<li class="listitem">
<a class="xref" href="elastic-agent-cmd-options.html#elastic-agent-uninstall-command" title="elastic-agent uninstall">uninstall</a>
</li>
<li class="listitem">
<a class="xref" href="elastic-agent-cmd-options.html#elastic-agent-upgrade-command" title="elastic-agent upgrade">upgrade</a>
</li>
<li class="listitem">
<a class="xref" href="elastic-agent-cmd-options.html#elastic-agent-version-command" title="elastic-agent version">version</a>
</li>
</ul>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>You might need to log in as a root user (or Administrator on Windows) to
run these commands.</p>
</div>
</div>
<hr>
<h3><a id="elastic-agent-enroll-command"></a>elastic-agent enroll<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/ingest-docs/edit/7.15/docs/en/ingest-management/commands.asciidoc">edit</a></h3>
<p>Enroll the Elastic Agent in Fleet.</p>
<p>Use this command to enroll the Elastic Agent in Fleet without installing the
agent as a service. You will need to do this if you installed
the Elastic Agent from a DEB or RPM package and plan to use systemd commands to
start and manage the service. This command is also useful for testing
Elastic Agent prior to installing it.</p>
<p>If you&#8217;ve already installed Elastic Agent, use this command to modify the settings that Elastic Agent runs with.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>To enroll an Elastic Agent <em>and</em> install it as a service, use the
<a class="xref" href="elastic-agent-cmd-options.html#elastic-agent-install-command" title="elastic-agent install"><code class="literal">install</code> command</a> instead. Installing as a service is the most common scenario.</p>
</div>
</div>
<p>We recommend that you run the <code class="literal">enroll</code> (or <code class="literal">install</code>) command as the root user because some
integrations require root privileges to collect sensitive data. This command
overwrites the <code class="literal">elastic-agent.yml</code> file in the agent directory.</p>
<p>This command includes optional flags to set up <a class="xref" href="fleet-server.html" title="Fleet Server">Fleet Server</a>.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>This command enrolls the Elastic Agent in Fleet; it does not start the
agent. To start the agent, either <a class="xref" href="start-elastic-agent.html" title="Start Elastic Agent">start the service</a>, if
one exists, or use the <a class="xref" href="elastic-agent-cmd-options.html#elastic-agent-run-command" title="elastic-agent run"><code class="literal">run</code> command</a> to start the
agent from a terminal.</p>
</div>
</div>
<h4><a id="_synopsis"></a>Synopsis<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/ingest-docs/edit/7.15/docs/en/ingest-management/commands.asciidoc">edit</a></h4>
<p>To enroll the Elastic Agent in Fleet:</p>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">elastic-agent enroll --url &lt;string&gt;
                     --enrollment-token &lt;string&gt;
                     [--ca-sha256 &lt;string&gt;]
                     [--certificate-authorities &lt;string&gt;]
                     [--force]
                     [--help]
                     [--insecure ]
                     [global-flags]</pre>
</div>
<p>To enroll the Elastic Agent in Fleet and set up Fleet Server:</p>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">elastic-agent enroll --fleet-server-es &lt;string&gt;
                     --fleet-server-service-token &lt;string&gt;
                     [--ca-sha256 &lt;string&gt;]
                     [--certificate-authorities &lt;string&gt;]
                     [--fleet-server-cert &lt;string&gt;] <a id="CO22-1"></a><i class="conum" data-value="1"></i>
                     [--fleet-server-cert-key &lt;string&gt;]
                     [--fleet-server-es-ca &lt;string&gt;]
                     [--fleet-server-host &lt;string&gt;]
                     [--fleet-server-insecure-http]
                     [--fleet-server-policy &lt;string&gt;]
                     [--fleet-server-port &lt;uint16&gt;]
                     [--force]
                     [--help]
                     [--url &lt;string&gt;] <a id="CO22-2"></a><i class="conum" data-value="2"></i>
                     [global-flags]</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO22-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>If no <code class="literal">fleet-server-cert*</code> flags are specified, Elastic Agent auto-generates a
self-signed certificate with the hostname of the machine. Remote Elastic Agents
enrolling into a Fleet Server with self-signed certificates must specify
the <code class="literal">--insecure</code> flag.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO22-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>Required when enrolling in a Fleet Server with custom certificates. The
URL must match the DNS name used to generate the certificate specified by
<code class="literal">--fleet-server-cert</code>.</p>
</td>
</tr>
</table>
</div>
<p>For more information about custom certificates, refer to <a class="xref" href="secure-connections.html" title="Encrypt traffic in clusters with a self-managed Fleet Server"><em>Encrypt traffic in clusters with a self-managed Fleet Server</em></a>.</p>
<h4><a id="_options"></a>Options<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/ingest-docs/edit/7.15/docs/en/ingest-management/commands.asciidoc">edit</a></h4>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">--ca-sha256 &lt;string&gt;</code>
</span>
</dt>
<dd>
Comma-separated list of certificate authority hash pins used for certificate
verification.
</dd>
<dt>
<span class="term">
<code class="literal">--certificate-authorities &lt;string&gt;</code>
</span>
</dt>
<dd>
Comma-separated list of root certificates used for server verification.
</dd>
<dt>
<span class="term">
<code class="literal">--enrollment-token &lt;string&gt;</code>
</span>
</dt>
<dd>
Enrollment token to use to enroll Elastic Agent into Fleet. You can use
the same enrollment token for multiple agents.
</dd>
<dt>
<span class="term">
<code class="literal">--fleet-server-cert &lt;string&gt;</code>
</span>
</dt>
<dd>
Certificate to use for exposed Fleet Server HTTPS endpoint.
</dd>
<dt>
<span class="term">
<code class="literal">--fleet-server-cert-key &lt;string&gt;</code>
</span>
</dt>
<dd>
Private key to use for exposed Fleet Server HTTPS endpoint.
</dd>
<dt>
<span class="term">
<code class="literal">--fleet-server-es &lt;string&gt;</code>
</span>
</dt>
<dd>
Start a Fleet Server process when Elastic Agent is started, and connect to the
specified Elasticsearch URL.
</dd>
<dt>
<span class="term">
<code class="literal">--fleet-server-es-ca &lt;string&gt;</code>
</span>
</dt>
<dd>
Path to certificate authority to use to communicate with Elasticsearch.
</dd>
<dt>
<span class="term">
<code class="literal">--fleet-server-host &lt;string&gt;</code>
</span>
</dt>
<dd>
Fleet Server HTTP binding host (overrides the policy).
</dd>
<dt>
<span class="term">
<code class="literal">--fleet-server-insecure-http</code>
</span>
</dt>
<dd>
Expose Fleet Server over HTTP. This option is not recommended because it&#8217;s
insecure. It&#8217;s useful during development and testing, but should not be used in
production. When using this option, you should bind Fleet Server to the
local host (this is the default).
</dd>
<dt>
<span class="term">
<code class="literal">--fleet-server-policy &lt;string&gt;</code>
</span>
</dt>
<dd>
Used when starting a self-managed Fleet Server to allow a specific policy to be used,
instead of the Default Fleet Server policy.
</dd>
<dt>
<span class="term">
<code class="literal">--fleet-server-port &lt;uint16&gt;</code>
</span>
</dt>
<dd>
Fleet Server HTTP binding port (overrides the policy).
</dd>
<dt>
<span class="term">
<code class="literal">--fleet-server-service-token &lt;string&gt;</code>
</span>
</dt>
<dd>
Service token to use for communication with Elasticsearch.
</dd>
<dt>
<span class="term">
<code class="literal">--force</code>
</span>
</dt>
<dd>
Force overwrite of current configuration without prompting for confirmation.
This flag is helpful when using automation software or scripted deployments.
</dd>
<dt>
<span class="term">
<code class="literal">--help</code>
</span>
</dt>
<dd>
Show help for the <code class="literal">enroll</code> command.
</dd>
<dt>
<span class="term">
<code class="literal">--insecure</code>
</span>
</dt>
<dd>
<p>
Allow the Elastic Agent to connect to Fleet Server over insecure connections. This
setting is required in the following situations:
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
When connecting to an HTTP server. The API keys are sent in clear text.
</li>
<li class="listitem">
When connecting to an HTTPs server and the certificate chain cannot be
verified. The content is encrypted, but the certificate is not verified.
</li>
<li class="listitem">
When using self-signed certificates generated by Elastic Agent.
</li>
</ul>
</div>
<p>We strongly recommend that you use a secure connection.</p>
</dd>
<dt>
<span class="term">
<code class="literal">--url &lt;string&gt;</code>
</span>
</dt>
<dd>
Fleet Server URL to use to enroll the Elastic Agent into Fleet.
</dd>
</dl>
</div>
<p>For more flags, see <a class="xref" href="elastic-agent-cmd-options.html#elastic-agent-global-flags" title="Global flags">Global flags</a>.</p>
<h4><a id="_examples"></a>Examples<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/ingest-docs/edit/7.15/docs/en/ingest-management/commands.asciidoc">edit</a></h4>
<p>Enroll the Elastic Agent in Fleet:</p>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">elastic-agent enroll -f \
  --url=https://cedd4e0e21e240b4s2bbbebdf1d6d52f.fleet.eu-west-1.aws.cld.elstc.co:443 \
  --enrollment-token=NEFmVllaa0JLRXhKebVKVTR5TTI6N2JaVlJpSGpScmV0ZUVnZVlRUExFQQ==</pre>
</div>
<p>Enroll the Elastic Agent in Fleet and set up Fleet Server:</p>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">elastic-agent enroll -f --fleet-server-es=http://elasticsearch:9200 \
  --fleet-server-service-token=AbEAAdesYXN1abMvZmxlZXQtc2VldmVyL3Rva2VuLTE2MTkxMzg3MzIzMTg7dzEta0JDTmZUcGlDTjlwRmNVTjNVQQ \
  --fleet-server-policy=a35fd520-26f5-11ec-8bd9-3374690g57b6</pre>
</div>
<p>Start Elastic Agent with Fleet Server (running on a custom CA). This example
assumes you&#8217;ve generated the certificates with the following names:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">ca.crt</code>: Root CA certificate
</li>
<li class="listitem">
<code class="literal">fleet-server.crt</code>: Fleet Server certificate
</li>
<li class="listitem">
<code class="literal">fleet-server.key</code>: Fleet Server private key
</li>
<li class="listitem">
<code class="literal">elasticsearch-ca.crt</code>: CA certificate to use to connect to Elasticsearch
</li>
</ul>
</div>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">elastic-agent enroll -f \
  --url=https://fleet-server:8220 \
  --fleet-server-es=https://elasticsearch:9200 \
  --fleet-server-service-token=AAEBAWVsYXm0aWMvZmxlZXQtc2XydmVyL3Rva2VuLTE2MjM4OTAztDU1OTQ6dllfVW1mYnFTVjJwTC2ZQ0EtVnVZQQ \
  --fleet-server-policy=a35fd520-26f5-11ec-8bd9-3374690g57b6 \
  --certificate-authorities=/path/to/ca.crt \
  --fleet-server-es-ca=/path/to/elasticsearch-ca.crt \
  --fleet-server-cert=/path/to/fleet-server.crt \
  --fleet-server-cert-key=/path/to/fleet-server.key</pre>
</div>
<p>Then enroll another Elastic Agent into the Fleet Server started in the previous
example:</p>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">elastic-agent enroll -f --url=https://fleet-server:8220 \
  --enrollment-token=NEFmVllaa0JLRXhKebVKVTR5TTI6N2JaVlJpSGpScmV0ZUVnZVlRUExFQQ== \
  --certificate-authorities=/path/to/ca.crt</pre>
</div>
<hr>
<h3><a id="elastic-agent-help-command"></a>elastic-agent help<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/ingest-docs/edit/7.15/docs/en/ingest-management/commands.asciidoc">edit</a></h3>
<p>Show help for a specific command.</p>
<h4><a id="_synopsis_2"></a>Synopsis<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/ingest-docs/edit/7.15/docs/en/ingest-management/commands.asciidoc">edit</a></h4>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">elastic-agent help &lt;command&gt; [--help] [global-flags]</pre>
</div>
<h4><a id="_options_2"></a>Options<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/ingest-docs/edit/7.15/docs/en/ingest-management/commands.asciidoc">edit</a></h4>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">command</code>
</span>
</dt>
<dd>
The name of the command.
</dd>
<dt>
<span class="term">
<code class="literal">--help</code>
</span>
</dt>
<dd>
Show help for the <code class="literal">help</code> command.
</dd>
</dl>
</div>
<p>For more flags, see <a class="xref" href="elastic-agent-cmd-options.html#elastic-agent-global-flags" title="Global flags">Global flags</a>.</p>
<h4><a id="_example"></a>Example<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/ingest-docs/edit/7.15/docs/en/ingest-management/commands.asciidoc">edit</a></h4>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">elastic-agent help enroll</pre>
</div>
<hr>
<h3><a id="elastic-agent-inspect-command"></a>elastic-agent inspect<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/ingest-docs/edit/7.15/docs/en/ingest-management/commands.asciidoc">edit</a></h3>
<p>Show the current Elastic Agent configuration.</p>
<p>If no parameters are specified, shows the full Elastic Agent configuration.</p>
<h4><a id="_synopsis_3"></a>Synopsis<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/ingest-docs/edit/7.15/docs/en/ingest-management/commands.asciidoc">edit</a></h4>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">elastic-agent inspect [--help] [global-flags]
elastic-agent inspect output [--output &lt;string&gt;]
                             [--program &lt;string&gt;]
                             [--help]
                             [global-flags]</pre>
</div>
<h4><a id="_options_3"></a>Options<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/ingest-docs/edit/7.15/docs/en/ingest-management/commands.asciidoc">edit</a></h4>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">output</code>
</span>
</dt>
<dd>
<p>
Display the current configuration for the output. This command
accepts additional flags:
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">--output &lt;string&gt;</code>
</span>
</dt>
<dd>
The name of the output to inspect.
</dd>
<dt>
<span class="term">
<code class="literal">--program &lt;string&gt;</code>
</span>
</dt>
<dd>
The type of program to inspect. For example, <code class="literal">filebeat</code>. This option must be
combined with <code class="literal">--output</code>.
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">--help</code>
</span>
</dt>
<dd>
Show help for the <code class="literal">inspect</code> command.
</dd>
</dl>
</div>
<p>For more flags, see <a class="xref" href="elastic-agent-cmd-options.html#elastic-agent-global-flags" title="Global flags">Global flags</a>.</p>
<h4><a id="_examples_2"></a>Examples<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/ingest-docs/edit/7.15/docs/en/ingest-management/commands.asciidoc">edit</a></h4>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">elastic-agent inspect
elastic-agent inspect output --output default
elastic-agent inspect output --output default --program filebeat</pre>
</div>
<hr>
<h3><a id="elastic-agent-install-command"></a>elastic-agent install<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/ingest-docs/edit/7.15/docs/en/ingest-management/commands.asciidoc">edit</a></h3>
<p>Install Elastic Agent permanently on the system and manage it by using the system&#8217;s
service manager. The agent will start automatically after installation is
complete. On Linux (tar package), this command requires a system and service
manager like systemd.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>If you installed Elastic Agent from a DEB or RPM package, use the
<a class="xref" href="elastic-agent-cmd-options.html#elastic-agent-enroll-command" title="elastic-agent enroll"><code class="literal">enroll</code> command</a> instead of <code class="literal">install</code>. The DEB
and RPM packages include a service unit for Linux systems with systemd.</p>
</div>
</div>
<p>You must run this command as the root user (or Administrator on Windows)
to write files to the correct locations. This command overwrites the
<code class="literal">elastic-agent.yml</code> file in the agent directory.</p>
<h4><a id="_synopsis_4"></a>Synopsis<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/ingest-docs/edit/7.15/docs/en/ingest-management/commands.asciidoc">edit</a></h4>
<p>To install the Elastic Agent as a service, enroll it in Fleet, and start the
<code class="literal">elastic-agent</code> service:</p>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">elastic-agent install --url &lt;string&gt;
                      --enrollment-token &lt;string&gt;
                      [--ca-sha256 &lt;string&gt;]
                      [--certificate-authorities &lt;string&gt;]
                      [--force]
                      [--help]
                      [--insecure ]
                      [global-flags]</pre>
</div>
<p>To install the Elastic Agent as a service, enroll it in Fleet, and start
a <code class="literal">fleet-server</code> process alongside the <code class="literal">elastic-agent</code> service:</p>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">elastic-agent install --fleet-server-es &lt;string&gt;
                      --fleet-server-service-token &lt;string&gt;
                      [--ca-sha256 &lt;string&gt;]
                      [--certificate-authorities &lt;string&gt;]
                      [--fleet-server-cert &lt;string&gt;] <a id="CO23-1"></a><i class="conum" data-value="1"></i>
                      [--fleet-server-cert-key &lt;string&gt;]
                      [--fleet-server-es-ca &lt;string&gt;]
                      [--fleet-server-host &lt;string&gt;]
                      [--fleet-server-insecure-http]
                      [--fleet-server-policy &lt;string&gt;]
                      [--fleet-server-port &lt;uint16&gt;]
                      [--force]
                      [--help]
                      [--url &lt;string&gt;] <a id="CO23-2"></a><i class="conum" data-value="2"></i>
                      [global-flags]</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO23-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>If no <code class="literal">fleet-server-cert*</code> flags are specified, Elastic Agent auto-generates a
self-signed certificate with the hostname of the machine. Remote Elastic Agents
enrolling into a Fleet Server with self-signed certificates must specify
the <code class="literal">--insecure</code> flag.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO23-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>Required when enrolling in a Fleet Server with custom certificates. The
URL must match the DNS name used to generate the certificate specified by
<code class="literal">--fleet-server-cert</code>.</p>
</td>
</tr>
</table>
</div>
<p>For more information about custom certificates, refer to <a class="xref" href="secure-connections.html" title="Encrypt traffic in clusters with a self-managed Fleet Server"><em>Encrypt traffic in clusters with a self-managed Fleet Server</em></a>.</p>
<h4><a id="_options_4"></a>Options<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/ingest-docs/edit/7.15/docs/en/ingest-management/commands.asciidoc">edit</a></h4>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">--ca-sha256 &lt;string&gt;</code>
</span>
</dt>
<dd>
Comma-separated list of certificate authority hash pins used for certificate
verification.
</dd>
<dt>
<span class="term">
<code class="literal">--certificate-authorities &lt;string&gt;</code>
</span>
</dt>
<dd>
Comma-separated list of root certificates used for server verification.
</dd>
<dt>
<span class="term">
<code class="literal">--enrollment-token &lt;string&gt;</code>
</span>
</dt>
<dd>
Enrollment token to use to enroll Elastic Agent into Fleet. You can use
the same enrollment token for multiple agents.
</dd>
<dt>
<span class="term">
<code class="literal">--fleet-server-cert &lt;string&gt;</code>
</span>
</dt>
<dd>
Certificate to use for exposed Fleet Server HTTPS endpoint.
</dd>
<dt>
<span class="term">
<code class="literal">--fleet-server-cert-key &lt;string&gt;</code>
</span>
</dt>
<dd>
Private key to use for exposed Fleet Server HTTPS endpoint.
</dd>
<dt>
<span class="term">
<code class="literal">--fleet-server-es &lt;string&gt;</code>
</span>
</dt>
<dd>
Start a Fleet Server process when Elastic Agent is started, and connect to the
specified Elasticsearch URL.
</dd>
<dt>
<span class="term">
<code class="literal">--fleet-server-es-ca &lt;string&gt;</code>
</span>
</dt>
<dd>
Path to certificate authority to use to communicate with Elasticsearch.
</dd>
<dt>
<span class="term">
<code class="literal">--fleet-server-host &lt;string&gt;</code>
</span>
</dt>
<dd>
Fleet Server HTTP binding host (overrides the policy).
</dd>
<dt>
<span class="term">
<code class="literal">--fleet-server-insecure-http</code>
</span>
</dt>
<dd>
Expose Fleet Server over HTTP. This option is not recommended because it&#8217;s
insecure. It&#8217;s useful during development and testing, but should not be used in
production. When using this option, you should bind Fleet Server to the
local host (this is the default).
</dd>
<dt>
<span class="term">
<code class="literal">--fleet-server-policy &lt;string&gt;</code>
</span>
</dt>
<dd>
Used when starting a self-managed Fleet Server to allow a specific policy to be used,
instead of the Default Fleet Server policy.
</dd>
<dt>
<span class="term">
<code class="literal">--fleet-server-port &lt;uint16&gt;</code>
</span>
</dt>
<dd>
Fleet Server HTTP binding port (overrides the policy).
</dd>
<dt>
<span class="term">
<code class="literal">--fleet-server-service-token &lt;string&gt;</code>
</span>
</dt>
<dd>
Service token to use for communication with Elasticsearch.
</dd>
<dt>
<span class="term">
<code class="literal">--force</code>
</span>
</dt>
<dd>
Force overwrite of current configuration without prompting for confirmation.
This flag is helpful when using automation software or scripted deployments.
</dd>
<dt>
<span class="term">
<code class="literal">--help</code>
</span>
</dt>
<dd>
Show help for the <code class="literal">enroll</code> command.
</dd>
<dt>
<span class="term">
<code class="literal">--insecure</code>
</span>
</dt>
<dd>
<p>
Allow the Elastic Agent to connect to Fleet Server over insecure connections. This
setting is required in the following situations:
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
When connecting to an HTTP server. The API keys are sent in clear text.
</li>
<li class="listitem">
When connecting to an HTTPs server and the certificate chain cannot be
verified. The content is encrypted, but the certificate is not verified.
</li>
<li class="listitem">
When using self-signed certificates generated by Elastic Agent.
</li>
</ul>
</div>
<p>We strongly recommend that you use a secure connection.</p>
</dd>
<dt>
<span class="term">
<code class="literal">--url &lt;string&gt;</code>
</span>
</dt>
<dd>
Fleet Server URL to use to enroll the Elastic Agent into Fleet.
</dd>
</dl>
</div>
<p>For more flags, see <a class="xref" href="elastic-agent-cmd-options.html#elastic-agent-global-flags" title="Global flags">Global flags</a>.</p>
<h4><a id="_examples_3"></a>Examples<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/ingest-docs/edit/7.15/docs/en/ingest-management/commands.asciidoc">edit</a></h4>
<p>Install the Elastic Agent as a service, enroll it in Fleet, and start the
<code class="literal">elastic-agent</code> service:</p>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">elastic-agent install -f \
  --url=https://cedd4e0e21e240b4s2bbbebdf1d6d52f.fleet.eu-west-1.aws.cld.elstc.co:443 \
  --enrollment-token=NEFmVllaa0JLRXhKebVKVTR5TTI6N2JaVlJpSGpScmV0ZUVnZVlRUExFQQ==</pre>
</div>
<p>Install the Elastic Agent as a service, enroll it in Fleet, and start
a <code class="literal">fleet-server</code> process alongside the <code class="literal">elastic-agent</code> service:</p>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">elastic-agent install -f --fleet-server-es=http://elasticsearch:9200 \
  --fleet-server-service-token=AbEAAdesYXN1abMvZmxlZXQtc2VldmVyL3Rva2VuLTE2MTkxMzg3MzIzMTg7dzEta0JDTmZUcGlDTjlwRmNVTjNVQQ \
  --fleet-server-policy=a35fd620-26f6-11ec-8bd9-3374690f57b6</pre>
</div>
<p>Start Elastic Agent with Fleet Server (running on a custom CA). This example
assumes you&#8217;ve generated the certificates with the following names:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">ca.crt</code>: Root CA certificate
</li>
<li class="listitem">
<code class="literal">fleet-server.crt</code>: Fleet Server certificate
</li>
<li class="listitem">
<code class="literal">fleet-server.key</code>: Fleet Server private key
</li>
<li class="listitem">
<code class="literal">elasticsearch-ca.crt</code>: CA certificate to use to connect to Elasticsearch
</li>
</ul>
</div>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">elastic-agent install -f \
  --url=https://fleet-server:8220 \
  --fleet-server-es=https://elasticsearch:9200 \
  --fleet-server-service-token=AAEBAWVsYXm0aWMvZmxlZXQtc2XydmVyL3Rva2VuLTE2MjM4OTAztDU1OTQ6dllfVW1mYnFTVjJwTC2ZQ0EtVnVZQQ \
  --fleet-server-policy=a35fd520-26f5-11ec-8bd9-3374690g57b6 \
  --certificate-authorities=/path/to/ca.crt \
  --fleet-server-es-ca=/path/to/elasticsearch-ca.crt \
  --fleet-server-cert=/path/to/fleet-server.crt \
  --fleet-server-cert-key=/path/to/fleet-server.key</pre>
</div>
<p>Then install another Elastic Agent and enroll it into the Fleet Server started in
the previous example:</p>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">elastic-agent install -f --url=https://fleet-server:8220 \
  --enrollment-token=NEFmVllaa0JLRXhKebVKVTR5TTI6N2JaVlJpSGpScmV0ZUVnZVlRUExFQQ== \
  --certificate-authorities=/path/to/ca.crt</pre>
</div>
<hr>
<h3><a id="elastic-agent-restart-command"></a>elastic-agent restart<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/ingest-docs/edit/7.15/docs/en/ingest-management/commands.asciidoc">edit</a></h3>
<p>Restart the currently running Elastic Agent daemon.</p>
<h4><a id="_synopsis_5"></a>Synopsis<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/ingest-docs/edit/7.15/docs/en/ingest-management/commands.asciidoc">edit</a></h4>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">elastic-agent restart [--help] [global-flags]</pre>
</div>
<h4><a id="_options_5"></a>Options<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/ingest-docs/edit/7.15/docs/en/ingest-management/commands.asciidoc">edit</a></h4>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">--help</code>
</span>
</dt>
<dd>
Show help for the <code class="literal">restart</code> command.
</dd>
</dl>
</div>
<p>For more flags, see <a class="xref" href="elastic-agent-cmd-options.html#elastic-agent-global-flags" title="Global flags">Global flags</a>.</p>
<h4><a id="_examples_4"></a>Examples<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/ingest-docs/edit/7.15/docs/en/ingest-management/commands.asciidoc">edit</a></h4>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">elastic-agent restart</pre>
</div>
<hr>
<h3><a id="elastic-agent-run-command"></a>elastic-agent run<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/ingest-docs/edit/7.15/docs/en/ingest-management/commands.asciidoc">edit</a></h3>
<p>Start the <code class="literal">elastic-agent</code> process.</p>
<h4><a id="_synopsis_6"></a>Synopsis<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/ingest-docs/edit/7.15/docs/en/ingest-management/commands.asciidoc">edit</a></h4>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">elastic-agent run [global-flags]</pre>
</div>
<h4><a id="elastic-agent-global-flags"></a>Global flags<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/ingest-docs/edit/7.15/docs/en/ingest-management/commands.asciidoc">edit</a></h4>
<p>These flags are valid whenever you run <code class="literal">elastic-agent</code> on the command line.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">-c &lt;string&gt;</code>
</span>
</dt>
<dd>
The configuration file to use. If not specified, Elastic Agent uses
<code class="literal">{path.config}/elastic-agent.yml</code>.
</dd>
<dt>
<span class="term">
<code class="literal">--e</code>
</span>
</dt>
<dd>
Log to stderr and disable syslog/file output.
</dd>
<dt>
<span class="term">
<code class="literal">--environment &lt;environmentVar&gt;</code>
</span>
</dt>
<dd>
The environment in which the agent will run.
</dd>
<dt>
<span class="term">
<code class="literal">--path.config &lt;string&gt;</code>
</span>
</dt>
<dd>
The directory where Elastic Agent looks for its configuration file. The default
varies by platform.
</dd>
<dt>
<span class="term">
<code class="literal">--path.home &lt;string&gt;</code>
</span>
</dt>
<dd>
<p>
The root directory of Elastic Agent. <code class="literal">path.home</code> determines the location of the
configuration files and data directory.
</p>
<p>If not specified, Elastic Agent uses the current working directory.</p>
</dd>
<dt>
<span class="term">
<code class="literal">--path.logs &lt;string&gt;</code>
</span>
</dt>
<dd>
Path to the log output for Elastic Agent. The default varies by platform.
</dd>
<dt>
<span class="term">
<code class="literal">--v</code>
</span>
</dt>
<dd>
Set log level to INFO.
</dd>
</dl>
</div>
<h4><a id="_example_2"></a>Example<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/ingest-docs/edit/7.15/docs/en/ingest-management/commands.asciidoc">edit</a></h4>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">elastic-agent run -c myagentconfig.yml</pre>
</div>
<hr>
<h3><a id="elastic-agent-uninstall-command"></a>elastic-agent uninstall<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/ingest-docs/edit/7.15/docs/en/ingest-management/commands.asciidoc">edit</a></h3>
<p>Permanently uninstall Elastic Agent from the system.</p>
<p>You must run this command as the root user (or Administrator on Windows)
to remove files.</p>
<h4><a id="_synopsis_7"></a>Synopsis<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/ingest-docs/edit/7.15/docs/en/ingest-management/commands.asciidoc">edit</a></h4>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">elastic-agent uninstall [--force] [--help] [global-flags]</pre>
</div>
<h4><a id="_options_6"></a>Options<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/ingest-docs/edit/7.15/docs/en/ingest-management/commands.asciidoc">edit</a></h4>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">--force</code>
</span>
</dt>
<dd>
Uninstall Elastic Agent and do not prompt for confirmation. This flag is helpful
when using automation software or scripted deployments.
</dd>
<dt>
<span class="term">
<code class="literal">--help</code>
</span>
</dt>
<dd>
Show help for the <code class="literal">uninstall</code> command.
</dd>
</dl>
</div>
<p>For more flags, see <a class="xref" href="elastic-agent-cmd-options.html#elastic-agent-global-flags" title="Global flags">Global flags</a>.</p>
<h4><a id="_examples_5"></a>Examples<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/ingest-docs/edit/7.15/docs/en/ingest-management/commands.asciidoc">edit</a></h4>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">elastic-agent uninstall</pre>
</div>
<hr>
<h3><a id="elastic-agent-upgrade-command"></a>elastic-agent upgrade<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/ingest-docs/edit/7.15/docs/en/ingest-management/commands.asciidoc">edit</a></h3>
<p>Upgrade the currently running Elastic Agent to the specified version. This should only
be used with agents running in standalone mode. Agents enrolled in Fleet
should be upgraded through Fleet.</p>
<h4><a id="_synopsis_8"></a>Synopsis<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/ingest-docs/edit/7.15/docs/en/ingest-management/commands.asciidoc">edit</a></h4>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">elastic-agent upgrade &lt;version&gt; [--source-uri &lt;string&gt;] [--help] [flags]</pre>
</div>
<h4><a id="_options_7"></a>Options<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/ingest-docs/edit/7.15/docs/en/ingest-management/commands.asciidoc">edit</a></h4>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">version</code>
</span>
</dt>
<dd>
The version of Elastic Agent to upgrade to.
</dd>
<dt>
<span class="term">
<code class="literal">--source-uri &lt;string&gt;</code>
</span>
</dt>
<dd>
The source URI to download the new version from. By default, Elastic Agent uses the
Elastic Artifacts URL.
</dd>
<dt>
<span class="term">
<code class="literal">--help</code>
</span>
</dt>
<dd>
Show help for the <code class="literal">upgrade</code> command.
</dd>
</dl>
</div>
<p>For more flags, see <a class="xref" href="elastic-agent-cmd-options.html#elastic-agent-global-flags" title="Global flags">Global flags</a>.</p>
<h4><a id="_examples_6"></a>Examples<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/ingest-docs/edit/7.15/docs/en/ingest-management/commands.asciidoc">edit</a></h4>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">elastic-agent upgrade 7.10.1</pre>
</div>
<hr>
<h3><a id="elastic-agent-version-command"></a>elastic-agent version<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/ingest-docs/edit/7.15/docs/en/ingest-management/commands.asciidoc">edit</a></h3>
<p>Show the version of Elastic Agent.</p>
<h4><a id="_synopsis_9"></a>Synopsis<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/ingest-docs/edit/7.15/docs/en/ingest-management/commands.asciidoc">edit</a></h4>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">elastic-agent version [--help] [global-flags]</pre>
</div>
<h4><a id="_options_8"></a>Options<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/ingest-docs/edit/7.15/docs/en/ingest-management/commands.asciidoc">edit</a></h4>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">--help</code>
</span>
</dt>
<dd>
Show help for the <code class="literal">version</code> command.
</dd>
</dl>
</div>
<p>For more flags, see <a class="xref" href="elastic-agent-cmd-options.html#elastic-agent-global-flags" title="Global flags">Global flags</a>.</p>
<h4><a id="_example_3"></a>Example<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/ingest-docs/edit/7.15/docs/en/ingest-management/commands.asciidoc">edit</a></h4>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">elastic-agent version</pre>
</div>
<hr>
</div>
<div class="navfooter">
<span class="prev">
<a href="data-streams.html">« Data streams</a>
</span>
<span class="next">
<a href="fleet-troubleshooting.html">Troubleshoot common problems »</a>
</span>
</div>
</div>
</body>
</html>
