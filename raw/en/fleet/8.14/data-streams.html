<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Data streams | Fleet and Elastic Agent Guide [8.14] | Elastic</title>
<meta class="elastic" name="content" content="Data streams | Fleet and Elastic Agent Guide [8.14]">

<link rel="home" href="index.html" title="Fleet and Elastic Agent Guide [8.14]"/>
<link rel="up" href="integrations.html" title="Manage Elastic Agent integrations"/>
<link rel="prev" href="integrations-assets-best-practices.html" title="Best practices for integrations assets"/>
<link rel="next" href="data-streams-ilm-tutorial.html" title="Tutorial: Customize data retention policies"/>
<meta class="elastic" name="product_version" content="8.14"/>
<meta class="elastic" name="product_name" content="Fleet and Elastic Agent"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Fleet/Guide/Elastic Agent/8.14"/>
<meta name="DC.subject" content="Fleet and Elastic Agent"/>
<meta name="DC.identifier" content="8.14"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div class="navheader">
<span class="prev">
<a href="integrations-assets-best-practices.html">« Best practices for integrations assets</a>
</span>
<span class="next">
<a href="data-streams-ilm-tutorial.html">Tutorial: Customize data retention policies »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Fleet and Elastic Agent Guide [8.14]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="integrations.html">Manage Elastic Agent integrations</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Data streams</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/ingest-docs/edit/8.14/docs/en/ingest-management/data-streams.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="data-streams"></a>Data streams<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/ingest-docs/edit/8.14/docs/en/ingest-management/data-streams.asciidoc">edit</a></h2>
</div></div></div>
<p>Elastic Agent uses data streams to store time series data across multiple indices
while giving you a single named resource for requests.
Data streams are well-suited for logs, metrics, traces, and other continuously generated data.
They offer a host of benefits over other indexing strategies:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Reduced number of fields per index</strong></span>: Indices only need to store a specific subset of your
data–meaning no more indices with hundreds of thousands of fields.
This leads to better space efficiency and faster queries.
As an added bonus, only relevant fields are shown in Discover.
</li>
<li class="listitem">
<span class="strong strong"><strong>More granular data control</strong></span>: For example, file system, load, CPU, network, and process metrics are sent
to different indices–each potentially with its own rollover, retention, and security permissions.
</li>
<li class="listitem">
<span class="strong strong"><strong>Flexible</strong></span>: Use the custom namespace component to divide and organize data in a way that
makes sense to your use case or company.
</li>
<li class="listitem">
<span class="strong strong"><strong>Fewer ingest permissions required</strong></span>: Data ingestion only requires permissions to append data.
</li>
</ul>
</div>
<h3><a id="data-streams-naming-scheme"></a>Data stream naming scheme<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/ingest-docs/edit/8.14/docs/en/ingest-management/data-streams.asciidoc">edit</a></h3>
<p>Elastic Agent uses the Elastic data stream naming scheme to name data streams.
The naming scheme splits data into different streams based on the following components:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">type</code>
</span>
</dt>
<dd>
A generic <code class="literal">type</code> describing the data, such as <code class="literal">logs</code>, <code class="literal">metrics</code>, <code class="literal">traces</code>, or <code class="literal">synthetics</code>.
</dd>
<dt>
<span class="term">
<code class="literal">dataset</code>
</span>
</dt>
<dd>
The <code class="literal">dataset</code> is defined by the integration and describes the ingested data and its structure for each index.
For example, you might have a dataset for process metrics with a field describing whether the process is running or not,
and another dataset for disk I/O metrics with a field describing the number of bytes read.
</dd>
<dt>
<span class="term">
<code class="literal">namespace</code>
</span>
</dt>
<dd>
<p>
A user-configurable arbitrary grouping, such as an environment (<code class="literal">dev</code>, <code class="literal">prod</code>, or <code class="literal">qa</code>),
a team, or a strategic business unit.
A <code class="literal">namespace</code> can be up to 100 bytes in length (multibyte characters will count toward this limit faster).
Using a namespace makes it easier to search data from a given source by using a matching pattern.
You can also use matching patterns to give users access to data when creating user roles.
</p>
<p>By default the namespace defined for an Elastic Agent policy is propagated to all integrations in that policy. if you&#8217;d like to define a more granular namespace for a policy:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
In Kibana, go to <span class="strong strong"><strong>Integrations</strong></span>.
</li>
<li class="listitem">
On the <span class="strong strong"><strong>Installed integrations</strong></span> tab, select the integration that you&#8217;d like to update.
</li>
<li class="listitem">
Open the <span class="strong strong"><strong>Integration policies</strong></span> tab.
</li>
<li class="listitem">
From the <span class="strong strong"><strong>Actions</strong></span> menu next to the integration, select <span class="strong strong"><strong>Edit integration</strong></span>.
</li>
<li class="listitem">
Open the advanced options and update the <span class="strong strong"><strong>Namespace</strong></span> field. Data streams from the integration will now use the specified namespace rather than the default namespace inherited from the Elastic Agent policy.
</li>
</ol>
</div>
</dd>
</dl>
</div>
<p>The naming scheme separates each components with a <code class="literal">-</code> character:</p>
<div class="pre_wrapper lang-text">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-text">&lt;type&gt;-&lt;dataset&gt;-&lt;namespace&gt;</pre>
</div>
<p>For example, if you&#8217;ve set up the Nginx integration with a namespace of <code class="literal">prod</code>,
Elastic Agent uses the <code class="literal">logs</code> type, <code class="literal">nginx.access</code> dataset, and <code class="literal">prod</code> namespace to store data in the following data stream:</p>
<div class="pre_wrapper lang-text">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-text">logs-nginx.access-prod</pre>
</div>
<p>Alternatively, if you use the APM integration with a namespace of <code class="literal">dev</code>,
Elastic Agent stores data in the following data stream:</p>
<div class="pre_wrapper lang-text">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-text">traces-apm-dev</pre>
</div>
<p>All data streams, and the pre-built dashboards that they ship with,
are viewable on the Fleet Data Streams page:</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/kibana-fleet-datastreams.png" alt="Data streams page">
</div>
</div>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>If you&#8217;re familiar with the concept of indices, you can think of each data stream as a separate index in Elasticsearch.
Under the hood though, things are a bit more complex.
All of the juicy details are available in <a href="/guide/en/elasticsearch/reference/8.14/data-streams.html" class="ulink" target="_top">Elasticsearch Data streams</a>.</p>
</div>
</div>
<h3><a id="data-streams-data-view"></a>Data views<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/ingest-docs/edit/8.14/docs/en/ingest-management/data-streams.asciidoc">edit</a></h3>
<p>When searching your data in Kibana, you can use a <a href="/guide/en/kibana/8.14/data-views.html" class="ulink" target="_top">data view</a>
to search across all or some of your data streams.</p>
<h3><a id="data-streams-index-templates"></a>Index templates<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/ingest-docs/edit/8.14/docs/en/ingest-management/data-streams.asciidoc">edit</a></h3>
<p>An index template is a way to tell Elasticsearch how to configure an index when it is created.
For data streams, the index template configures the stream&#8217;s backing indices as they are created.</p>
<p>Elasticsearch provides the following built-in, ECS based templates: <code class="literal">logs-*-*</code>, <code class="literal">metrics-*-*</code>, and <code class="literal">synthetics-*-*</code>.
Elastic Agent integrations can also provide dataset-specific index templates, like <code class="literal">logs-nginx.access-*</code>.
These templates are loaded when the integration is installed, and are used to configure the integration&#8217;s data streams.</p>
<h4><a id="_edit_the_elasticsearch_index_template"></a>Edit the Elasticsearch index template<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/ingest-docs/edit/8.14/docs/en/ingest-management/data-streams.asciidoc">edit</a></h4>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>Custom index mappings may conflict with the mappings defined by the integration
and may break the integration in Kibana. Do not change or customize any default mappings.</p>
</div>
</div>
<p>When you install an integration, Fleet creates a default <code class="literal">@custom</code> component template for each data stream. The Custom component templates are named following the pattern: <code class="literal">&lt;name_of_data_stream&gt;@custom</code>.</p>
<p>You can edit a <code class="literal">@custom</code> component template to customize your Elasticsearch indices:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Open Kibana and navigate to to <span class="strong strong"><strong>Stack Management</strong></span> &gt; <span class="strong strong"><strong>Index Management</strong></span> &gt; <span class="strong strong"><strong>Data Streams</strong></span>.
</li>
<li class="listitem">
Find and click the name of the integration data stream, such as <code class="literal">logs-cisco_ise.log-default</code>.
</li>
<li class="listitem">
Click the index template link for the data stream to see the list of associated component templates.
</li>
<li class="listitem">
Navigate to <span class="strong strong"><strong>Stack Management</strong></span> &gt; <span class="strong strong"><strong>Index Management</strong></span> &gt; <span class="strong strong"><strong>Component Templates</strong></span>.
</li>
<li class="listitem">
Search for the name of the data stream&#8217;s custom component template and click the edit icon.
</li>
<li class="listitem">
<p>Add any custom index settings, metadata, or mappings.
For example, you may want to:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Customize the index lifecycle policy applied to a data stream.
See <a href="/guide/en/apm/guide/8.14/ilm-how-to.html#data-streams-custom-policy" class="ulink" target="_top">Configure a custom index lifecycle policy</a> in the APM Guide for a walk-through.</p>
<p>Specify lifecycle name in the <span class="strong strong"><strong>index settings</strong></span>:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
  "index": {
    "lifecycle": {
       "name": "my_policy"
     }
  }
}</pre>
</div>
</li>
<li class="listitem">
<p>Change the number of <a href="/guide/en/elasticsearch/reference/8.14/docs-replication.html" class="ulink" target="_top">replicas</a> per index.
Specify the number of replica shards in the <span class="strong strong"><strong>index settings</strong></span>:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
  "index": {
    "number_of_replicas": "2"
  }
}</pre>
</div>
</li>
</ul>
</div>
</li>
</ol>
</div>
<p>Changes to component templates are not applied retroactively to existing indices.
For changes to take effect, you must create a new write index for the data stream.
You can do this with the Elasticsearch <a href="/guide/en/elasticsearch/reference/8.14/indices-rollover-index.html" class="ulink" target="_top">Rollover API</a>.</p>
<h3><a id="data-streams-ilm"></a>Index lifecycle management (ILM)<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/ingest-docs/edit/8.14/docs/en/ingest-management/data-streams.asciidoc">edit</a></h3>
<p>Use the <a href="/guide/en/elasticsearch/reference/8.14/index-lifecycle-management.html" class="ulink" target="_top">index lifecycle
management</a> (ILM) feature in Elasticsearch to manage your Elastic Agent data stream indices as they age.
For example, create a new index after a certain period of time,
or delete stale indices to enforce data retention standards.</p>
<p>Installed integrations may have one or many associated data streams&#8212;&#8203;each with an associated ILM policy.
By default, these data streams use an ILM policy that matches their data type.
For example, the data stream <code class="literal">metrics-system.logs-*</code>,
uses the metrics ILM policy as defined in the <code class="literal">metrics-system.logs</code> index template.</p>
<p>Want to customize your index lifecycle management? See <a class="xref" href="data-streams-ilm-tutorial.html" title="Tutorial: Customize data retention policies">Tutorial: Customize data retention policies</a>.</p>
<h3><a id="data-streams-pipelines"></a>Ingest pipelines<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/ingest-docs/edit/8.14/docs/en/ingest-management/data-streams.asciidoc">edit</a></h3>
<p>Elastic Agent integration data streams ship with a default <a href="/guide/en/elasticsearch/reference/8.14/ingest.html" class="ulink" target="_top">ingest pipeline</a>
that preprocesses and enriches data before indexing.
The default pipeline should not be directly edited as changes can easily break the functionality of the integration.</p>
<p>Starting in version 8.4, all default ingest pipelines call a non-existent and non-versioned "<code class="literal">@custom</code>" ingest pipeline.
If left uncreated, this pipeline has no effect on your data. However, if added to a data stream and customized,
this pipeline can be used for custom data processing, adding fields, sanitizing data, and more.</p>
<p>Starting in version 8.12, ingest pipelines can be configured to process events at various levels of customization.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">global@custom</code>
</span>
</dt>
<dd>
<p>
Apply processing to all events
</p>
<p>For example, the following <a href="/guide/en/elasticsearch/reference/8.14/put-pipeline-api.html" class="ulink" target="_top">pipeline API</a> request adds a new field <code class="literal">my-global-field</code> for all events:</p>
<div class="pre_wrapper lang-console">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console">PUT _ingest/pipeline/global@custom
{
  "processors": [
    {
      "set": {
        "description": "Process all events",
        "field": "my-global-field",
        "value": "foo"
      }
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/1.console"></div>
</dd>
<dt>
<span class="term">
<code class="literal">${type}</code>
</span>
</dt>
<dd>
<p>
Apply processing to all events of a given data type.
</p>
<p>For example, the following request adds a new field <code class="literal">my-logs-field</code> for all log events:</p>
<div class="pre_wrapper lang-console">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console">PUT _ingest/pipeline/logs@custom
{
  "processors": [
    {
      "set": {
        "description": "Process all log events",
        "field": "my-logs-field",
        "value": "foo"
      }
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2.console"></div>
</dd>
<dt>
<span class="term">
<code class="literal">${type}-${package}.integration</code>
</span>
</dt>
<dd>
<p>
Apply processing to all events of a given type in an integration
</p>
<p>For example, the following request creates a <code class="literal">logs-nginx.integration@custom</code> pipeline that adds a new field <code class="literal">my-nginx-field</code> for all log events in the Nginx integration:</p>
<div class="pre_wrapper lang-console">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console">PUT _ingest/pipeline/logs-nginx.integration@custom
{
  "processors": [
    {
      "set": {
        "description": "Process all nginx events",
        "field": "my-nginx-field",
        "value": "foo"
      }
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/3.console"></div>
<p>Note that <code class="literal">.integration</code> is included in the pipeline pattern to avoid possible collision with existing dataset pipelines.</p>
</dd>
<dt>
<span class="term">
<code class="literal">${type}-${dataset}</code>
</span>
</dt>
<dd>
<p>
Apply processing to a specific dataset.
</p>
<p>For example, the following request creates a <code class="literal">metrics-system.cpu@custom</code> pipeline that adds a new field <code class="literal">my-system.cpu-field</code> for all CPU metrics events in the System integration:</p>
<div class="pre_wrapper lang-console">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console">PUT _ingest/pipeline/metrics-system.cpu@custom
{
  "processors": [
    {
      "set": {
        "description": "Process all events in the system.cpu dataset",
        "field": "my-system.cpu-field",
        "value": "foo"
      }
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/4.console"></div>
</dd>
</dl>
</div>
<p>Custom pipelines can directly contain processors or you can use the pipeline processor to call other pipelines that can be shared across multiple data streams or integrations.
These pipelines will persist across all version upgrades.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<a id="data-streams-pipelines-warning"></a>
<p>If you have a custom pipeline defined that matches the naming scheme used for any Fleet custom ingest pipelines, this can produce unintended results. For example, if you have a pipeline named like one of the following:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">global@custom</code>
</li>
<li class="listitem">
<code class="literal">traces@custom</code>
</li>
<li class="listitem">
<code class="literal">traces-apm@custom</code>
</li>
</ul>
</div>
<p>The pipeline may be unexpectedly called for other data streams in other integrations. To avoid this problem, avoid the naming schemes defined above when naming your custom pipelines.</p>
<p>Refer to the breaking change in the 8.12.0 Release Notes for more detail and workaround options.</p>
</div>
</div>
<p>See <a class="xref" href="data-streams-pipeline-tutorial.html" title="Tutorial: Transform data with custom ingest pipelines">Tutorial: Transform data with custom ingest pipelines</a> to get started.</p>



</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="integrations-assets-best-practices.html">« Best practices for integrations assets</a>
</span>
<span class="next">
<a href="data-streams-ilm-tutorial.html">Tutorial: Customize data retention policies »</a>
</span>
</div>
</body>
</html>
