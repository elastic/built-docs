<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Logstash output settings | Fleet and Elastic Agent Guide [8.14] | Elastic</title>
<meta class="elastic" name="content" content="Logstash output settings | Fleet and Elastic Agent Guide [8.14]">

<link rel="home" href="index.html" title="Fleet and Elastic Agent Guide [8.14]"/>
<link rel="up" href="fleet-settings.html" title="Fleet settings"/>
<link rel="prev" href="es-output-settings.html" title="Elasticsearch output settings"/>
<link rel="next" href="kafka-output-settings.html" title="Kafka output settings"/>
<meta class="elastic" name="product_version" content="8.14"/>
<meta class="elastic" name="product_name" content="Fleet and Elastic Agent"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Fleet/Guide/Elastic Agent/8.14"/>
<meta name="DC.subject" content="Fleet and Elastic Agent"/>
<meta name="DC.identifier" content="8.14"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div class="navheader">
<span class="prev">
<a href="es-output-settings.html">« Elasticsearch output settings</a>
</span>
<span class="next">
<a href="kafka-output-settings.html">Kafka output settings »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Fleet and Elastic Agent Guide [8.14]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="manage-agents-in-fleet.html">Centrally manage Elastic Agents in Fleet</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="fleet-settings.html">Fleet settings</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Logstash output settings</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/ingest-docs/edit/8.14/docs/en/ingest-management/fleet/fleet-settings-output-logstash.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="ls-output-settings"></a>Logstash output settings<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/ingest-docs/edit/8.14/docs/en/ingest-management/fleet/fleet-settings-output-logstash.asciidoc">edit</a></h3>
</div></div></div>
<p>Specify these settings to send data over a secure connection to Logstash. You must
also configure a Logstash pipeline that reads encrypted data from Elastic Agents and sends
the data to Elasticsearch. Follow the in-product steps to configure the Logstash pipeline.</p>
<p>In the Fleet <a class="xref" href="fleet-settings.html#output-settings" title="Output settings">Output settings</a>, make sure that the Logstash output type is selected.</p>
<p>Before using the Logstash output, you need to make sure that for any integrations that have been <a class="xref" href="add-integration-to-policy.html" title="Add an Elastic Agent integration to a policy">added to your Elastic Agent policy</a>, the integration assets have been installed on the destination cluster. Refer to <a class="xref" href="install-uninstall-integration-assets.html" title="Install and uninstall Elastic Agent integration assets">Install and uninstall Elastic Agent integration assets</a> for the steps to add integration assets.</p>
<p>To learn how to generate certificates, refer to <a class="xref" href="secure-logstash-connections.html" title="Configure SSL/TLS for the Logstash output">Configure SSL/TLS for the Logstash output</a>.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<tbody>
<tr>
<td align="left" valign="top">
<p><a id="ls-logstash-hosts"></a><span class="strong strong"><strong>Logstash hosts</strong></span></p>
</td>
<td align="left" valign="top">
<p>The addresses your Elastic Agents will use to connect to Logstash. Use the format
<code class="literal">host:port</code>. Click <span class="strong strong"><strong>add</strong></span> row to specify additional Logstash addresses.</p>
<p><span class="strong strong"><strong>Examples:</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">192.0.2.0:5044</code>
</li>
<li class="listitem">
<code class="literal">mylogstashhost:5044</code>
</li>
</ul>
</div>
<p>Refer to the <a class="xref" href="fleet-server.html" title="What is Fleet Server?">Fleet Server</a> documentation for default ports and other configuration details.</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="ls-server-ssl-certificate-authorities-setting"></a><span class="strong strong"><strong>Server SSL certificate authorities</strong></span></p>
</td>
<td align="left" valign="top">
<p>The CA certificate to use to connect to Logstash. This is the CA used to generate
the certificate and key for Logstash. Copy and paste in the full contents for the CA
certificate.</p>
<p>This setting is optional.</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="ls-client-ssl-certificate-setting"></a><span class="strong strong"><strong>Client SSL certificate</strong></span></p>
</td>
<td align="left" valign="top">
<p>The certificate generated for the client. Copy and paste in the full contents
of the certificate. This is the certificate that all the agents will use to connect to Logstash.</p>
<p>In cases where each client has a unique certificate, the local path to that certificate can be
placed here. The agents will pick the certificate in that location when establishing a connection to
Logstash.</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="ls-client-ssl-certificate-key-setting"></a><span class="strong strong"><strong>Client SSL certificate key</strong></span></p>
</td>
<td align="left" valign="top">
<p>The private key generated for the client. This must be in PKCS 8 key.
Copy and paste in the full contents of the certificate key. This is the certificate key that all the agents will use to connect to Logstash.</p>
<p>In cases where each client has a unique certificate key, the local path to that certificate key can be placed here.
The agents will pick the certificate key in that location when establishing a connection to Logstash.</p>
<p>To prevent unauthorized access the certificate key is stored as a secret value. While secret storage is recommended, you can choose to override this setting and store the key as plain text in the agent policy definition. Secret storage requires Fleet Server version 8.12 or higher.</p>
<p>Note that this setting can also be stored as a secret value or as plain text for preconfigured outputs. See <a href="/guide/en/kibana/8.14/fleet-settings-kb.html#_preconfiguration_settings_for_advanced_use_cases" class="ulink" target="_top">Preconfiguration settings</a> in the Kibana Guide to learn more.</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="ls-agent-proxy-output"></a><span class="strong strong"><strong>Proxy</strong></span></p>
</td>
<td align="left" valign="top">
<p>Select a proxy URL for Elastic Agent to connect to Logstash.
To learn about proxy configuration, refer to <a class="xref" href="fleet-agent-proxy-support.html" title="Using a proxy server with Elastic Agent and Fleet">Using a proxy server with Elastic Agent and Fleet</a>.</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="ls-output-advanced-yaml-setting"></a><span class="strong strong"><strong>Advanced YAML configuration</strong></span></p>
</td>
<td align="left" valign="top">
<p>YAML settings that will be added to the Logstash output section of each policy
that uses this output. Make sure you specify valid YAML. The UI does not
currently provide validation.</p>
<p>See <a class="xref" href="ls-output-settings.html#ls-output-settings-yaml-config" title="Advanced YAML configuration">Advanced YAML configuration</a> for descriptions of the available settings.</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="ls-agent-integrations-output"></a><span class="strong strong"><strong>Make this output the default for agent integrations</strong></span></p>
</td>
<td align="left" valign="top">
<p>When this setting is on, Elastic Agents use this output to send data if no other
output is set in the <a class="xref" href="agent-policy.html" title="Elastic Agent policies">agent policy</a>.</p>
<p>Output to Logstash is not supported for agent integrations in a policy used by Fleet Server or APM.</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="ls-agent-monitoring-output"></a><span class="strong strong"><strong>Make this output the default for agent monitoring</strong></span></p>
</td>
<td align="left" valign="top">
<p>When this setting is on, Elastic Agents use this output to send <a class="xref" href="monitor-elastic-agent.html" title="Monitor Elastic Agents">agent monitoring data</a> if no other output is set in the <a class="xref" href="agent-policy.html" title="Elastic Agent policies">agent policy</a>.</p>
<p>Output to Logstash is not supported for agent monitoring in a policy used by Fleet Server or APM.</p>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="ls-output-settings-yaml-config"></a>Advanced YAML configuration<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/ingest-docs/edit/8.14/docs/en/ingest-management/fleet/fleet-settings-output-logstash.asciidoc">edit</a></h4>
</div></div></div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">
Setting
</th>
<th align="left" valign="top">
Description
</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top">
<p><a id="output-logstash-fleet-settings-backoff.init-setting"></a><code class="literal">backoff.init</code></p>
</td>
<td align="left" valign="top">
<p>(string) The number of seconds to wait before trying to reconnect to Logstash
after a network error. After waiting <code class="literal">backoff.init</code> seconds, Elastic Agent tries to
reconnect. If the attempt fails, the backoff timer is increased exponentially up
to <code class="literal">backoff.max</code>. After a successful connection, the backoff timer is reset.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">1s</code></p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="output-logstash-fleet-settings-backoff.max-setting"></a><code class="literal">backoff.max</code></p>
</td>
<td align="left" valign="top">
<p>(string) The maximum number of seconds to wait before attempting to connect to
Elasticsearch after a network error.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">60s</code></p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="output-logstash-fleet-settings-bulk_max_size-setting"></a><code class="literal">bulk_max_size</code></p>
</td>
<td align="left" valign="top">
<p>(int) The maximum number of events to bulk in a single Logstash request.</p>
<p>Events can be collected into batches. Elastic Agent will split batches larger than
<code class="literal">bulk_max_size</code> into multiple batches.</p>
<p>Specifying a larger batch size can improve performance by lowering the overhead
of sending events. However big batch sizes can also increase processing times,
which might result in API errors, killed connections, timed-out publishing
requests, and, ultimately, lower throughput.</p>
<p>Set this value to <code class="literal">0</code> to turn off the splitting of batches. When splitting is
turned off, the queue determines the number of events to be contained in a
batch.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">2048</code></p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="output-logstash-fleet-settings-compression_level-setting"></a><code class="literal">compression_level</code></p>
</td>
<td align="left" valign="top">
<p>(int) The gzip compression level. Set this value to <code class="literal">0</code> to disable compression.
The compression level must be in the range of <code class="literal">1</code> (best speed) to <code class="literal">9</code> (best
compression).</p>
<p>Increasing the compression level reduces network usage but increases CPU usage.</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="output-logstash-fleet-settings-escape_html-setting"></a><code class="literal">escape_html</code></p>
</td>
<td align="left" valign="top">
<p>(boolean) Configures escaping of HTML in strings. Set to <code class="literal">true</code> to enable
escaping.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">false</code></p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="output-logstash-fleet-settings-index-setting"></a><code class="literal">index</code></p>
</td>
<td align="left" valign="top">
<p>(string) The index root name to write events to.</p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="output-logstash-fleet-settings-loadbalance-setting"></a><code class="literal">loadbalance</code></p>
</td>
<td align="left" valign="top">
<p>If <code class="literal">true</code> and multiple Logstash hosts are configured, the output plugin
load balances published events onto all Logstash hosts. If <code class="literal">false</code>,
the output plugin sends all events to one host (determined at random) and
switches to another host if the selected one becomes unresponsive.</p>
<p>With <code class="literal">loadbalance</code> enabled:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic Agent reads batches of events and sends each batch to one Logstash worker dynamically, based on a work-queue shared between the outputs.
</li>
<li class="listitem">
If a connection drops, Elastic Agent takes the disconnected Logstash worker out of its pool.
</li>
<li class="listitem">
Elastic Agent tries to reconnect. If it succeeds, it re-adds the Logstash worker to the pool.
</li>
<li class="listitem">
If one of the Logstash nodes is slow but "healthy", it sends a keep-alive signal until the full batch of data is processed. This prevents Elastic Agent from sending further data until it receives an acknowledgement signal back from Logstash. Elastic Agent keeps all events in memory until after that acknowledgement occurs.
</li>
</ul>
</div>
<p>Without <code class="literal">loadbalance</code> enabled:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic Agent picks a random Logstash host and sends batches of events to it. Due to the random algorithm, the load on the Logstash nodes should be roughly equal.
</li>
<li class="listitem">
In case of any errors, Elastic Agent picks another Logstash node, also at random. If a connection to a host fails, the host is retried only if there are errors on the new connection.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">false</code></p>
<p>Example:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">outputs:
  default:
    type: logstash
    hosts: ["localhost:5044", "localhost:5045"]
    loadbalance: true</pre>
</div>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="output-logstash-fleet-settings-max_retries-setting"></a><code class="literal">max_retries</code></p>
</td>
<td align="left" valign="top">
<p>(int) The number of times to retry publishing an event after a publishing
failure. After the specified number of retries, the events are typically
dropped.</p>
<p>Set <code class="literal">max_retries</code> to a value less than 0 to retry until all events are published.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">3</code></p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="output-logstash-fleet-settings-pipelining-setting"></a><code class="literal">pipelining</code></p>
</td>
<td align="left" valign="top">
<p>(int) The number of batches to send asynchronously to Logstash while waiting
for an ACK from Logstash. The output becomes blocking after the specified number of
batches are written. Specify <code class="literal">0</code> to turn off pipelining.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">2</code></p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="output-logstash-fleet-settings-proxy_use_local_resolver-setting"></a><code class="literal">proxy_use_</code>
<code class="literal">local_resolver</code></p>
</td>
<td align="left" valign="top">
<p>(boolean) Determines whether Logstash hostnames are resolved locally when using a
proxy. If <code class="literal">false</code> and a proxy is used, name resolution occurs on the proxy
server.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">false</code></p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="output-logstash-fleet-settings-queue.mem.events-setting"></a><code class="literal">queue.mem.events</code></p>
</td>
<td align="left" valign="top">
<p>The number of events the queue can store. This value should be evenly divisible by the smaller of <code class="literal">queue.mem.flush.min_events</code> or <code class="literal">bulk_max_size</code> to avoid sending partial batches to the output.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">3200 events</code></p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="output-logstash-fleet-settings-queue.mem.flush.min_events-setting"></a><code class="literal">queue.mem.flush.min_events</code></p>
</td>
<td align="left" valign="top">
<p><code class="literal">flush.min_events</code> is a legacy parameter, and new configurations should prefer to control batch size with <code class="literal">bulk_max_size</code>. As of 8.13, there is never a performance advantage to limiting batch size with <code class="literal">flush.min_events</code> instead of <code class="literal">bulk_max_size</code></p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">1600 events</code></p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="output-logstash-fleet-settings-queue.mem.flush.timeout-setting"></a><code class="literal">queue.mem.flush.timeout</code></p>
</td>
<td align="left" valign="top">
<p>(int) The maximum wait time for <code class="literal">queue.mem.flush.min_events</code> to be fulfilled. If set to 0s, events are available to the output immediately.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">10s</code></p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="output-logstash-fleet-settings-slow_start-setting"></a><code class="literal">slow_start</code></p>
</td>
<td align="left" valign="top">
<p>(boolean) If <code class="literal">true</code>, only a subset of events in a batch of events is transferred
per transaction. The number of events to be sent increases up to
<code class="literal">bulk_max_size</code> if no error is encountered. On error, the number of events per
transaction is reduced again.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">false</code></p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="output-logstash-fleet-settings-timeout-setting"></a><code class="literal">timeout</code></p>
</td>
<td align="left" valign="top">
<p>(string) The number of seconds to wait for responses from the Logstash server
before timing out.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">30s</code></p>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="output-logstash-fleet-settings-ttl-setting"></a><code class="literal">ttl</code></p>
</td>
<td align="left" valign="top">
<p>(string) Time to live for a connection to Logstash after which the connection will be
reestablished. This setting is useful when Logstash hosts represent load balancers.
Because connections to Logstash hosts are sticky, operating behind load balancers
can lead to uneven load distribution across instances. Specify a TTL on the
connection to achieve equal connection distribution across instances.</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">0</code> (turns off the feature)</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The <code class="literal">ttl</code> option is not yet supported on an asynchronous Logstash client (one with
the <code class="literal">pipelining</code> option set).</p>
</div>
</div>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p><a id="output-logstash-fleet-settings-worker-setting"></a><code class="literal">worker</code></p>
</td>
<td align="left" valign="top">
<p>(int) The number of workers per configured host publishing events. Example: If
you have two hosts and three workers, in total six workers are started (three
for each host).</p>
<p><span class="strong strong"><strong>Default:</strong></span> <code class="literal">1</code></p>
</td>
</tr>
</tbody>
</table>
</div>
</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="es-output-settings.html">« Elasticsearch output settings</a>
</span>
<span class="next">
<a href="kafka-output-settings.html">Kafka output settings »</a>
</span>
</div>
</body>
</html>
