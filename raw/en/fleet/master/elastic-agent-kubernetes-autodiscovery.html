<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Kubernetes autodiscovery with Elastic Agent | Fleet and Elastic Agent Guide [master] | Elastic</title>
<meta class="elastic" name="content" content="Kubernetes autodiscovery with Elastic Agent | Fleet and Elastic Agent Guide [master]">

<link rel="home" href="index.html" title="Fleet and Elastic Agent Guide [master]"/>
<link rel="up" href="elastic-agent-configuration.html" title="Configure standalone Elastic Agents"/>
<link rel="prev" href="debug-standalone-agents.html" title="Debug standalone Elastic Agents"/>
<link rel="next" href="conditions-based-autodiscover.html" title="Conditions based autodiscover"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="Fleet and Elastic Agent"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Fleet/Guide/Elastic Agent/master"/>
<meta name="DC.subject" content="Fleet and Elastic Agent"/>
<meta name="DC.identifier" content="master"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
This documentation contains work-in-progress information for future Elastic Stack and Cloud releases. Use the version selector to view supported release docs. It also contains some Elastic Cloud serverless information. Check out our <a href="https://www.elastic.co/docs/current/serverless">serverless docs</a> for more details.
</div>
<div class="navheader">
<span class="prev">
<a href="debug-standalone-agents.html">« Debug standalone Elastic Agents</a>
</span>
<span class="next">
<a href="conditions-based-autodiscover.html">Conditions based autodiscover »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Fleet and Elastic Agent Guide [master]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="elastic-agent-configuration.html">Configure standalone Elastic Agents</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Kubernetes autodiscovery with Elastic Agent</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/main/docs/en/ingest-management/elastic-agent/configuration/autodiscovery/elastic-agent-kubernetes-autodiscovery.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="elastic-agent-kubernetes-autodiscovery"></a>Kubernetes autodiscovery with Elastic Agent<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/main/docs/en/ingest-management/elastic-agent/configuration/autodiscovery/elastic-agent-kubernetes-autodiscovery.asciidoc">edit</a></h2>
</div></div></div>
<p>When you run applications on containers, they become moving targets to the monitoring system. Autodiscover allows you to track them and adapt settings as changes happen. By defining configuration templates, the autodiscover subsystem can monitor services as they start running.</p>
<p>To use autodiscovery, you will need to modify the manifest file of the Elastic Agent. Refer to <a class="xref" href="running-on-kubernetes-standalone.html" title="Run Elastic Agent Standalone on Kubernetes">Run Elastic Agent Standalone on Kubernetes</a> to learn how to retrieve and configure it.</p>
<p>There are two different ways to use autodiscovery:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="conditions-based-autodiscover.html" title="Conditions based autodiscover">Conditions based autodiscover</a>
</li>
<li class="listitem">
<a class="xref" href="hints-annotations-autodiscovery.html" title="Hints annotations based autodiscover">Hints annotations based autodiscover</a>
</li>
</ul>
</div>
<h4><a id="_how_to_configure_autodiscovery"></a>How to configure autodiscovery<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/main/docs/en/ingest-management/elastic-agent/configuration/autodiscovery/elastic-agent-kubernetes-autodiscovery.asciidoc">edit</a></h4>
<p><code class="literal">Conditions Based Autodiscovery</code> is more suitable for scenarios when users know the different group of containers they want to monitor in advance. It is advisable to choose conditions-based configuration when administrators can configure specific conditions that match their needs. Conditions are supported in both Managed and Standalone Elastic Agent.</p>
<p><code class="literal">Hints Based Autodiscovry</code> is suitable for more generic scenarios, especially when users don&#8217;t know the exact configuration of the system to monitor and can not create in advance conditions. Additionally a big advantage of Hints Autodiscovery is the ability to offer dynamic configuration of inputs based on annotations from Pods/Containers. If dynamic configuration is needed, then Hints should be enabled. Hints are supported only in Standalone Elastic Agent mode.</p>
<p><span class="strong strong"><strong>Best Practises when you configure autodiscovery:</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Always define alternatives and default values to your variables that are used in conditions or [hint templates](eg. See <code class="literal">auth.basic</code> set as <code class="literal">auth.basic.user: ${kubernetes.hints.nginx.access.username|kubernetes.hints.nginx.username|''}`</code> in [nginx.yml](<a href="https://github.com/elastic/elastic-agent/blob/main/deploy/kubernetes/elastic-agent-standalone/templates.d/nginx.yml#L8)" class="ulink" target="_top">https://github.com/elastic/elastic-agent/blob/main/deploy/kubernetes/elastic-agent-standalone/templates.d/nginx.yml#L8)</a>)
</li>
</ul>
</div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>When an input uses a variable substitution that is not present in the current key/value mappings being evaluated, the input is removed in the result. (See more information in <a class="xref" href="dynamic-input-configuration.html" title="Variables and conditions in input configurations">Variables and conditions in input configurations</a>)</p>
</div>
</div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
To debug configurations that include variable substitution and conditions, use the inspect command of Elastic Agent. (See more information in <a class="xref" href="dynamic-input-configuration.html" title="Variables and conditions in input configurations">Variables and conditions in input configurations</a> in <span class="strong strong"><strong>Debugging</strong></span> Section)
</li>
<li class="listitem">
In Condition Based autodiscovery is advisable to define a generic last condition that will act as your default condition and will be validated when all others fail or don&#8217;t apply. If applicable, such conditions might help to identify processing and troubleshoot possible problems.
</li>
</ul>
</div>


</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="debug-standalone-agents.html">« Debug standalone Elastic Agents</a>
</span>
<span class="next">
<a href="conditions-based-autodiscover.html">Conditions based autodiscover »</a>
</span>
</div>
</body>
</html>
