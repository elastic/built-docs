<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Install Elastic Agent from an MSI package | Fleet and Elastic Agent Guide [master] | Elastic</title>
<meta class="elastic" name="content" content="Install Elastic Agent from an MSI package | Fleet and Elastic Agent Guide [master]">

<link rel="home" href="index.html" title="Fleet and Elastic Agent Guide [master]"/>
<link rel="up" href="elastic-agent-installation.html" title="Install Elastic Agents"/>
<link rel="prev" href="elastic-agent-unprivileged.html" title="Run Elastic Agent without administrative privileges"/>
<link rel="next" href="installation-layout.html" title="Installation layout"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="Fleet and Elastic Agent"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Fleet/Guide/Elastic Agent/master"/>
<meta name="DC.subject" content="Fleet and Elastic Agent"/>
<meta name="DC.identifier" content="master"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div class="navheader">
<span class="prev">
<a href="elastic-agent-unprivileged.html">« Run Elastic Agent without administrative privileges</a>
</span>
<span class="next">
<a href="installation-layout.html">Installation layout »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Fleet and Elastic Agent Guide [master]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="elastic-agent-installation.html">Install Elastic Agents</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Install Elastic Agent from an MSI package</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/main/docs/en/ingest-management/elastic-agent/install-agent-msi.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="install-agent-msi"></a>Install Elastic Agent from an MSI package<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/main/docs/en/ingest-management/elastic-agent/install-agent-msi.asciidoc">edit</a></h2>
</div></div></div>
<p>MSI is the file format and command line utility for the <a href="https://en.wikipedia.org/wiki/Windows_Installer" class="ulink" target="_top">Windows Installer</a>. Windows Installer (previously known as Microsoft Installer) is an interface for Microsoft Windows that’s used to install and manage software on Windows systems. This section covers installing Elastic Agent through the MSI package repository.</p>
<p>The MSI package installer must be run by an administrator account. The installer won&#8217;t start without Windows admin permissions.</p>
<h4><a id="_install_elastic_agent"></a>Install Elastic Agent<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/main/docs/en/ingest-management/elastic-agent/install-agent-msi.asciidoc">edit</a></h4>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Download the latest Elastic Agent MSI binary from the <a href="/downloads/elastic-agent" class="ulink" target="_top">Elastic Agent download page</a>.
</li>
<li class="listitem">
<p>Run the installer:</p>
<div class="pre_wrapper lang-shell">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-shell">elastic-agent-&lt;VERSION&gt;-windows-x86_64.msi INSTALLARGS="--url=&lt;URL&gt; --enrollment-token=&lt;TOKEN&gt;"</pre>
</div>
<p>Where:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">VERSION</code> is the Elastic Stack version you&#8217;re installing, indicated in the MSI package name. For example, <code class="literal">8.13.2</code>.
</li>
<li class="listitem">
<code class="literal">URL</code> is the Fleet Server URL used to enroll the Elastic Agent into Fleet. You can find this on the Fleet <span class="strong strong"><strong>Settings</strong></span> tab in Kibana.
</li>
<li class="listitem">
<code class="literal">TOKEN</code> is the authentication token used to enroll the Elastic Agent into Fleet. You can find this on the Fleet <span class="strong strong"><strong>Enrollment tokens</strong></span> tab.
</li>
</ul>
</div>
<p>When you run the command, the value set for <code class="literal">INSTALLARGS</code> will be passed to the <a class="xref" href="elastic-agent-cmd-options.html#elastic-agent-install-command" title="elastic-agent install"><code class="literal">elastic-agent install</code></a> command verbatim.</p>
</li>
<li class="listitem">
<p>If you need to troubleshoot, you can install using <code class="literal">msiexec</code> with the <code class="literal">-L*V "log.txt"</code> option to create installation logs:</p>
<div class="pre_wrapper lang-shell">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-shell">msiexec -i elastic-agent-&lt;VERSION&gt;-windows-x86_64.msi INSTALLARGS="--url=&lt;URL&gt; --enrollment-token=&lt;TOKEN&gt;"  -L*V "log.txt"</pre>
</div>
</li>
</ol>
</div>
<h4><a id="_installation_notes"></a>Installation notes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/main/docs/en/ingest-management/elastic-agent/install-agent-msi.asciidoc">edit</a></h4>
<p>Installing using an MSI package has the following behaviors:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If <code class="literal">INSTALLARGS</code> are not provided, the MSI will copy the files to a temporary folder and finish.
</li>
<li class="listitem">
If <code class="literal">INSTALLARGS</code> are provided, the MSI will copy the files to a temporary folder and then run the <a class="xref" href="elastic-agent-cmd-options.html#elastic-agent-install-command" title="elastic-agent install"><code class="literal">elastic-agent install</code></a> command with the provided parameters. If the install flow is successful, the temporary folder is deleted.
</li>
<li class="listitem">
If <code class="literal">INSTALLARGS</code> are provided but the <code class="literal">elastic-agent install</code> command fails, the top-level folder is NOT deleted, in order to allow for further troubleshooting.
</li>
<li class="listitem">
If the <code class="literal">elastic-agent install</code> command fails for any reason, the MSI will rollback all changes.
</li>
<li class="listitem">
If the Elastic Agent enrollment fails, the install will fail as well. To avoid this behavior you can add the <a class="xref" href="elastic-agent-cmd-options.html#elastic-agent-install-command" title="elastic-agent install"><code class="literal">--delay-enroll</code></a> option to the install command.
</li>
</ul>
</div>
<h4><a id="_upgrading"></a>Upgrading<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/main/docs/en/ingest-management/elastic-agent/install-agent-msi.asciidoc">edit</a></h4>
<p>Upgrades are not supported and are prevented by the MSI itself. Instead, all of your Elastic Agent upgrades can be managed in Fleet.</p>
<h4><a id="_installing_in_a_custom_location"></a>Installing in a custom location<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/main/docs/en/ingest-management/elastic-agent/install-agent-msi.asciidoc">edit</a></h4>
<p>Starting in version 8.13, it&#8217;s also possible to override the default installation folder by running the MSI from the command line, as shown:</p>
<div class="pre_wrapper lang-shell">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-shell">elastic-agent-&lt;VERSION&gt;-windows-x86_64.msi INSTALLARGS="--url=&lt;URL&gt; --enrollment-token=&lt;TOKEN&gt;" INSTALLDIR="&lt;path of custom folder&gt;"</pre>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="elastic-agent-unprivileged.html">« Run Elastic Agent without administrative privileges</a>
</span>
<span class="next">
<a href="installation-layout.html">Installation layout »</a>
</span>
</div>
</body>
</html>
