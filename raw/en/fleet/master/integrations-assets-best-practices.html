<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Best practices for integration assets | Fleet and Elastic Agent Guide [master] | Elastic</title>
<meta class="elastic" name="content" content="Best practices for integration assets | Fleet and Elastic Agent Guide [master]">

<link rel="home" href="index.html" title="Fleet and Elastic Agent Guide [master]"/>
<link rel="up" href="integrations.html" title="Manage Elastic Agent integrations"/>
<link rel="prev" href="managed-integrations-content.html" title="Managed integrations content"/>
<link rel="next" href="data-streams.html" title="Data streams"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="Fleet and Elastic Agent"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Fleet/Guide/Elastic Agent/master"/>
<meta name="DC.subject" content="Fleet and Elastic Agent"/>
<meta name="DC.identifier" content="master"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
This documentation contains work-in-progress information for future Elastic Stack and Cloud releases. Use the version selector to view supported release docs. It also contains some Elastic Cloud serverless information. Check out our <a href="https://www.elastic.co/docs/current/serverless">serverless docs</a> for more details.
</div>
<div class="navheader">
<span class="prev">
<a href="managed-integrations-content.html">« Managed integrations content</a>
</span>
<span class="next">
<a href="data-streams.html">Data streams »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Fleet and Elastic Agent Guide [master]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="integrations.html">Manage Elastic Agent integrations</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Best practices for integration assets</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/main/docs/en/ingest-management/integrations/integrations-assets-best-practices.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="integrations-assets-best-practices"></a>Best practices for integration assets</h2><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/main/docs/en/ingest-management/integrations/integrations-assets-best-practices.asciidoc">edit</a></div>
</div></div></div>
<p>When you use integrations with Fleet and Elastic Agent there are some restrictions to be aware of.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="integrations-assets-best-practices.html#assets-restrictions-standalone" title="Using integration assets with standalone Elastic Agent">Using integration assets with standalone Elastic Agent</a>
</li>
<li class="listitem">
<a class="xref" href="integrations-assets-best-practices.html#assets-restrictions-without-agent" title="Using integration assets without Elastic Agent">Using integration assets without Elastic Agent</a>
</li>
<li class="listitem">
<a class="xref" href="integrations-assets-best-practices.html#assets-restrictions-custom-integrations" title="Using Fleet and Elastic Agent integration assets in custom integrations">Using Fleet and Elastic Agent integration assets in custom integrations</a>
</li>
<li class="listitem">
<a class="xref" href="integrations-assets-best-practices.html#assets-restrictions-copying" title="Copying Fleet and Elastic Agent integration assets">Copying Fleet and Elastic Agent integration assets</a>
</li>
<li class="listitem">
<a class="xref" href="integrations-assets-best-practices.html#assets-restrictions-editing-assets" title="Editing assets managed by Fleet">Editing assets managed by Fleet</a>
</li>
<li class="listitem">
<a class="xref" href="integrations-assets-best-practices.html#assets-restrictions-custom-component-templates" title="Creating custom component templates">Creating custom component templates</a>
</li>
<li class="listitem">
<a class="xref" href="integrations-assets-best-practices.html#assets-restrictions-custom-ingest-pipeline" title="Creating a custom ingest pipeline">Creating a custom ingest pipeline</a>
</li>
<li class="listitem">
<a class="xref" href="integrations-assets-best-practices.html#assets-restrictions-cloning-index-template" title="Cloning the index template of an integration package">Cloning the index template of an integration package</a>
</li>
</ul>
</div>
<div class="position-relative"><h4><a id="assets-restrictions-standalone"></a>Using integration assets with standalone Elastic Agent</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/main/docs/en/ingest-management/integrations/integrations-assets-best-practices.asciidoc">edit</a></div>
<p>When you use standalone Elastic Agent with integrations, the integration assets added to the Elastic Agent policy must be installed on the destination Elasticsearch cluster.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If Kibana is available, the integration assets can be <a class="xref" href="install-uninstall-integration-assets.html" title="Install and uninstall Elastic Agent integration assets">installed through Fleet</a>.
</li>
<li class="listitem">
If Kibana is not available (for instance if you have a remote cluster without a Kibana instance), then the integration assets need to be installed manually.
</li>
</ul>
</div>
<div class="position-relative"><h4><a id="assets-restrictions-without-agent"></a>Using integration assets without Elastic Agent</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/main/docs/en/ingest-management/integrations/integrations-assets-best-practices.asciidoc">edit</a></div>
<p>Fleet integration assets are meant to work only with Elastic Agent.</p>
<p>The Fleet integration assets are not supposed to work when sending arbitrary logs or metrics collected with other products such as Filebeat, Metricbeat or Logstash.</p>
<div class="position-relative"><h4><a id="assets-restrictions-custom-integrations"></a>Using Fleet and Elastic Agent integration assets in custom integrations</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/main/docs/en/ingest-management/integrations/integrations-assets-best-practices.asciidoc">edit</a></div>
<p>While it&#8217;s possible to include Fleet and Elastic Agent integration assets in a custom integration, this is not recommended nor supported. Assets from another integration should not be referenced directly from a custom integration.</p>
<p>As an example scenario, one may want to ingest Redis logs from Kafka. This can be done using the <a href="https://docs.elastic.co/en/integrations/redis-intro" class="ulink" target="_top">Redis integration</a>, but only certain files and paths are allowed. It&#8217;s technically possible to use the <a href="https://docs.elastic.co/en/integrations/kafka_log" class="ulink" target="_top">Custom Kafka Logs integration</a> with a custom ingest pipeline, referencing the ingest pipeline of the Redis integration to ingest logs into the index templates of the Custom Kafka Logs integration data streams.</p>
<p>However, referencing assets of an integration from another custom integration is not recommended nor supported. A configuration as described above can break when the integration is upgraded, as can happen automatically.</p>
<div class="position-relative"><h4><a id="assets-restrictions-copying"></a>Copying Fleet and Elastic Agent integration assets</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/main/docs/en/ingest-management/integrations/integrations-assets-best-practices.asciidoc">edit</a></div>
<p>As an alternative to referencing assets from another integration from within a custom integration, assets such as index templates and ingest pipelines can be copied so that they become standalone.</p>
<p>This way, because the assets are not managed by another integration, there is less risk of a configuration breaking or of an integration asset being deleted when the other integration is upgraded.</p>
<p>Note, however, that creating standalone integration assets based off of Fleet and Elastic Agent integrations is considered a custom configuration that is not tested nor supported. Whenever possible it&#8217;s recommended to use standard integrations.</p>
<div class="position-relative"><h4><a id="assets-restrictions-editing-assets"></a>Editing assets managed by Fleet</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/main/docs/en/ingest-management/integrations/integrations-assets-best-practices.asciidoc">edit</a></div>
<p>Fleet-managed integration assets should not be edited. Examples of these assets include an integration index template, the <code class="literal">@package</code> component templates, and ingest pipelines that are bundled with integrations. Any changes made to these assets will be overwritten when the integration is upgraded.</p>
<div class="position-relative"><h4><a id="assets-restrictions-custom-component-templates"></a>Creating custom component templates</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/main/docs/en/ingest-management/integrations/integrations-assets-best-practices.asciidoc">edit</a></div>
<p>While creating a <code class="literal">@custom</code> component template for a package integration is supported, it involves risks which can prevent data from being ingested correctly. This practice can lead to broken indexing, data loss, and breaking of integration package upgrades.</p>
<p>For example:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If the <code class="literal">@package</code> component template of an integration is changed from a "normal" datastream to <code class="literal">TSDB</code> or <code class="literal">LogsDB</code>, some of the custom settings or mappings introduced may not be compatible with these indexing modes.
</li>
<li class="listitem">
If the type of an ECS field is overridden from, for example, <code class="literal">keyword</code> to <code class="literal">text</code>, aggregations based on that field may be prevented for built-in dashboards.
</li>
</ul>
</div>
<p>A similar caution against custom index mappings is noted in <a class="xref" href="data-streams.html#data-streams-index-templates-edit" title="Edit the Elasticsearch index template">Edit the Elasticsearch index template</a>.</p>
<div class="position-relative"><h4><a id="assets-restrictions-custom-ingest-pipeline"></a>Creating a custom ingest pipeline</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/main/docs/en/ingest-management/integrations/integrations-assets-best-practices.asciidoc">edit</a></div>
<p>If you create a custom index pipeline (as documented in the <a class="xref" href="data-streams-pipeline-tutorial.html" title="Tutorial: Transform data with custom ingest pipelines">Transform data with custom ingest pipelines</a> tutorial), Elastic is not responsible for ensuring that it indexes and behaves as expected. Creating a custom pipeline involves custom processing of the incoming data, which should be done with caution and tested carefully.</p>
<p>Refer to <a class="xref" href="data-streams.html#data-streams-pipelines" title="Ingest pipelines">Ingest pipelines</a> to learn more.</p>
<div class="position-relative"><h4><a id="assets-restrictions-cloning-index-template"></a>Cloning the index template of an integration package</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/main/docs/en/ingest-management/integrations/integrations-assets-best-practices.asciidoc">edit</a></div>
<p>When you clone the index template of an integration package, this involves risk as any changes made to the original index template when it is upgraded will not be propagated to the cloned version. That is, the structure of the new index template is effectively frozen at the moment that it is cloned. Cloning an index template of an integration package can therefore lead to broken indexing, data loss, and breaking of integration package upgrades.</p>
<p>Additionally, cloning index templates to add or inject additional component templates cannot be tested by Elastic, so we cannot guarantee that the template will work in future releases.</p>
<p>If you want to change the ILM Policy, the number of shards, or other settings for the datastreams of one or more integrations, but the changes do not need to be specific to a given namespace, it&#8217;s highly  recommended to use the <code class="literal">package@custom</code> component templates, as described in <a class="xref" href="data-streams-scenario1.html" title="Scenario 1: Apply an ILM policy to all data streams generated from Fleet integrations across all namespaces">Scenario 1</a> and <a class="xref" href="data-streams-scenario2.html" title="Scenario 2: Apply an ILM policy to specific data streams generated from Fleet integrations across all namespaces">Scenario 2</a> of the Customize data retention policies tutorial, so as to avoid the problems mentioned above.</p>
<p>If you want to change these settings for the data streams in one or more integrations and the changes <span class="strong strong"><strong>need to be namespace specific</strong></span>, then you can do so following the steps in <a class="xref" href="data-streams-scenario3.html" title="Scenario 3: Apply an ILM policy with integrations using multiple namespaces">Scenario 3</a> of the Customize data retention policies tutorial, but be aware of the restrictions mentioned above.</p>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="managed-integrations-content.html">« Managed integrations content</a>
</span>
<span class="next">
<a href="data-streams.html">Data streams »</a>
</span>
</div>
</body>
</html>
