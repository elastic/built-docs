<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Upgrade an Elastic Agent integration | Fleet and Elastic Agent Guide [master] | Elastic</title>
<meta class="elastic" name="content" content="Upgrade an Elastic Agent integration | Fleet and Elastic Agent Guide [master]">

<link rel="home" href="index.html" title="Fleet and Elastic Agent Guide [master]"/>
<link rel="up" href="integrations.html" title="Manage Elastic Agent integrations"/>
<link rel="prev" href="integration-level-outputs.html" title="Set integration-level outputs"/>
<link rel="next" href="managed-integrations-content.html" title="Managed integrations content"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="Fleet and Elastic Agent"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Fleet/Guide/Elastic Agent/master"/>
<meta name="DC.subject" content="Fleet and Elastic Agent"/>
<meta name="DC.identifier" content="master"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
This documentation contains work-in-progress information for future Elastic Stack and Cloud releases. Use the version selector to view supported release docs. It also contains some Elastic Cloud serverless information. Check out our <a href="https://www.elastic.co/docs/current/serverless">serverless docs</a> for more details.
</div>
<div class="navheader">
<span class="prev">
<a href="integration-level-outputs.html">« Set integration-level outputs</a>
</span>
<span class="next">
<a href="managed-integrations-content.html">Managed integrations content »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Fleet and Elastic Agent Guide [master]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="integrations.html">Manage Elastic Agent integrations</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Upgrade an Elastic Agent integration</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/main/docs/en/ingest-management/integrations/upgrade-integration.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="upgrade-integration"></a>Upgrade an Elastic Agent integration<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/main/docs/en/ingest-management/integrations/upgrade-integration.asciidoc">edit</a></h2>
</div></div></div>

<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>By default, Kibana requires an internet connection to download
integration packages from the Elastic Package Registry. Make sure the Kibana
server can connect to <code class="literal">https://epr.elastic.co</code> on port <code class="literal">443</code>. If network
restrictions prevent Kibana from reaching the public Elastic Package Registry,
you can use a proxy server or host your own Elastic Package Registry. To learn
more, refer to <a class="xref" href="air-gapped.html" title="Air-gapped environments">Air-gapped environments</a>.</p>
</div>
</div>
<p>Elastic releases Elastic Agent integration updates periodically. To use new features
and capabilities, upgrade the installed integration to the latest version and
optionally upgrade integration policies to use the new version.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>In larger deployments, you should test integration upgrades on a sample
Elastic Agent before rolling out a larger upgrade initiative.</p>
</div>
</div>
<h4><a id="upgrade-integration-to-latest-version"></a>Upgrade an integration to the latest version<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/main/docs/en/ingest-management/integrations/upgrade-integration.asciidoc">edit</a></h4>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
In Kibana, go to the <span class="strong strong"><strong>Integrations</strong></span> page and open the <span class="strong strong"><strong>Installed integrations</strong></span> tab. Search
for and select the integration you want to upgrade. Notice there is a warning
icon next to the version number to indicate a new version is available.
</li>
<li class="listitem">
<p>Click the <span class="strong strong"><strong>Settings</strong></span> tab and notice the message about the new version.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/upgrade-integration.png" alt="Settings tab under Integrations shows how to upgrade the integration">
</div>
</div>
</li>
<li class="listitem">
<p>Before upgrading the integration, decide whether to upgrade integration
policies to the latest version, too. To use new features and capabilities,
you&#8217;ll need to upgrade existing integration policies. However, the upgrade may
introduce changes, such as field changes, that require you to resolve conflicts.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Select <span class="strong strong"><strong>Upgrade integration policies</strong></span> to upgrade any eligible integration
policies when the integration is upgraded.
</li>
<li class="listitem">
To continue using the older package version, deselect
<span class="strong strong"><strong>Upgrade integration policies</strong></span>. You can still choose to
<a class="xref" href="upgrade-integration.html#upgrade-integration-policies-manually" title="Upgrade integration policies manually">upgrade integration policies manually</a>
later on.
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Click <span class="strong strong"><strong>Upgrade to latest version</strong></span>.</p>
<p>If you selected <span class="strong strong"><strong>Upgrade integration policies</strong></span> and there are conflicts,
<a class="xref" href="upgrade-integration.html#upgrade-integration-policies-manually" title="Upgrade integration policies manually">upgrade integration policies manually</a>
and resolve the conflicts in the policy editor.</p>
</li>
<li class="listitem">
After the upgrade is complete, verify that the installed version and latest
version match.
</li>
</ol>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>You must upgrade standalone agents separately. If you used Kibana to create
and download your standalone agent policy, see <a class="xref" href="create-standalone-agent-policy.html#update-standalone-policies" title="Upgrade standalone agent policies after upgrading an integration">Upgrade standalone agent policies after upgrading an integration</a>.</p>
</div>
</div>
<h4><a id="upgrade-integration-policies-automatically"></a>Keep integration policies up to date automatically<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/main/docs/en/ingest-management/integrations/upgrade-integration.asciidoc">edit</a></h4>
<p>Some integration packages, like System, are installed by default during Fleet
setup. These integrations are upgraded automatically when Fleet detects that a
new version is available. These integrations have an option to upgrade
integration policies automatically, too. When this option is selected (the
default), Fleet automatically upgrades your policies behind the scenes when a
new version of the integration is available. If there are conflicts during the
upgrade, your integration policies will not be upgraded, and you&#8217;ll need to
<a class="xref" href="upgrade-integration.html#upgrade-integration-policies-manually" title="Upgrade integration policies manually">upgrade integration policies manually</a>.</p>
<p>To keep integration policies up to data automatically:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
In Kibana, go to the <span class="strong strong"><strong>Integrations</strong></span> page and open the <span class="strong strong"><strong>Installed integrations</strong></span> tab. Search for
and select the integration you want to configure.
</li>
<li class="listitem">
<p>Click <span class="strong strong"><strong>Settings</strong></span> and make sure
<span class="strong strong"><strong>Keep integration policies up to data automatically</strong></span> is selected.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/upgrade-integration-policies-automatically.png" alt="Settings tab under Integrations shows how to keep integration policies up to date automatically">
</div>
</div>
<p>If this option isn&#8217;t available on the <span class="strong strong"><strong>Settings</strong></span> tab, this feature is not
available for the integration you&#8217;re viewing.</p>
</li>
</ol>
</div>
<h4><a id="upgrade-integration-policies-manually"></a>Upgrade integration policies manually<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/main/docs/en/ingest-management/integrations/upgrade-integration.asciidoc">edit</a></h4>
<p>If you can&#8217;t upgrade integration policies when you upgrade the integration,
upgrade them manually.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Click the <span class="strong strong"><strong>Policies</strong></span> tab and find the integration policies you want to
upgrade.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/upgrade-package-policy.png" alt="Policies tab under Integrations shows how to upgrade the package policy">
</div>
</div>
</li>
<li class="listitem">
<p>Click <span class="strong strong"><strong>Upgrade</strong></span> to begin the upgrade process.</p>
<p>The upgrade will open in the policy editor.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/upgrade-policy-editor.png" alt="Upgrade integration example in the policy editor">
</div>
</div>
</li>
<li class="listitem">
Make any required configuration changes and, if necessary, resolve conflicts.
For more information, refer to <a class="xref" href="upgrade-integration.html#resolve-conflicts" title="Resolve conflicts">Resolve conflicts</a>.
</li>
<li class="listitem">
Repeat this process for each policy with an out-of-date integration.
</li>
</ol>
</div>
<p>Too many conflicts to resolve? Refer to the
<a class="xref" href="fleet-troubleshooting.html#upgrading-integration-too-many-conflicts" title="Integration policy upgrade has too many conflicts">troubleshooting docs</a> for manual
steps.</p>
<h4><a id="resolve-conflicts"></a>Resolve conflicts<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/main/docs/en/ingest-management/integrations/upgrade-integration.asciidoc">edit</a></h4>
<p>When attempting to upgrade an integration policy, it&#8217;s possible that
breaking changes or conflicts exist between versions of an integration. For
example, if a new version of an integration has a required field and doesn&#8217;t
specify a default value, Fleet cannot perform the upgrade without user input.
Conflicts are also likely if an experimental package greatly restructures its
fields and configuration settings between releases.</p>
<p>If Fleet detects a conflict while automatically upgrading an integration
policy, it will not attempt to upgrade it. You&#8217;ll need to:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<a class="xref" href="upgrade-integration.html#upgrade-integration-policies-manually" title="Upgrade integration policies manually">Upgrade the integration policy manually</a>.
</li>
<li class="listitem">
<p>Use the policy editor to fix any conflicts or errors.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/upgrade-resolve-conflicts.png" alt="Resolve field conflicts in the policy editor">
</div>
</div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Under <span class="strong strong"><strong>Review field conflicts</strong></span>, notice that you can click
<span class="strong strong"><strong>previous configuration</strong></span>  to view the raw JSON representation of the old
integration policy and compare values. This feature is useful when fields have
been deprecated or removed between releases.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/upgrade-view-previous-config.png" alt="View previous configuration to resolve conflicts">
</div>
</div>
</li>
<li class="listitem">
In the policy editor, fix any errors and click <span class="strong strong"><strong>Upgrade integration</strong></span>.
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="integration-level-outputs.html">« Set integration-level outputs</a>
</span>
<span class="next">
<a href="managed-integrations-content.html">Managed integrations content »</a>
</span>
</div>
</body>
</html>
