<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Upgrade standalone Elastic Agents | Fleet and Elastic Agent Guide [master] | Elastic</title>
<meta class="elastic" name="content" content="Upgrade standalone Elastic Agents | Fleet and Elastic Agent Guide [master]">

<link rel="home" href="index.html" title="Fleet and Elastic Agent Guide [master]"/>
<link rel="up" href="install-standalone-elastic-agent.html" title="Install standalone Elastic Agents"/>
<link rel="prev" href="install-standalone-elastic-agent.html" title="Install standalone Elastic Agents"/>
<link rel="next" href="install-elastic-agents-in-containers.html" title="Install Elastic Agents in a containerized environment"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="Fleet and Elastic Agent"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Fleet/Guide/Elastic Agent/master"/>
<meta name="DC.subject" content="Fleet and Elastic Agent"/>
<meta name="DC.identifier" content="master"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
This documentation contains work-in-progress information for future Elastic Stack and Cloud releases. Use the version selector to view supported release docs. It also contains some Elastic Cloud serverless information. Check out our <a href="https://www.elastic.co/docs/current/serverless">serverless docs</a> for more details.
</div>
<div class="navheader">
<span class="prev">
<a href="install-standalone-elastic-agent.html">« Install standalone Elastic Agents</a>
</span>
<span class="next">
<a href="install-elastic-agents-in-containers.html">Install Elastic Agents in a containerized environment »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Fleet and Elastic Agent Guide [master]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="elastic-agent-installation.html">Install Elastic Agents</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="install-standalone-elastic-agent.html">Install standalone Elastic Agents</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Upgrade standalone Elastic Agents</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/main/docs/en/ingest-management/elastic-agent/upgrade-standalone-elastic-agent.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="upgrade-standalone"></a>Upgrade standalone Elastic Agents<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/main/docs/en/ingest-management/elastic-agent/upgrade-standalone-elastic-agent.asciidoc">edit</a></h3>
</div></div></div>
<p>To upgrade a standalone agent running on an edge node:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Make sure the <code class="literal">elastic-agent</code> service is running.
</li>
<li class="listitem">
<p>From the directory where Elastic Agent is installed, run the <code class="literal">upgrade</code> command to
upgrade to a new version. Not sure where the agent is
installed? Refer to <a class="xref" href="installation-layout.html" title="Installation layout">Installation layout</a>.</p>
<p>For example, on macOS, to upgrade the agent from version 8.8.0 to 8.8.1, you
would run:</p>
<div class="pre_wrapper lang-shell">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-shell">cd /Library/Elastic/Agent/
sudo elastic-agent upgrade 8.8.1</pre>
</div>
</li>
</ol>
</div>
<p>This command upgrades the binary. Your agent policy should continue to work,
but you might need to upgrade it to use new features and capabilities.</p>
<p>For more command-line options, see the help for the
<a class="xref" href="elastic-agent-cmd-options.html#elastic-agent-upgrade-command" title="elastic-agent upgrade"><code class="literal">upgrade</code></a> command.</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="upgrade-standalone-air-gapped"></a>Upgrading standalone Elastic Agent in an air-gapped environmment<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/main/docs/en/ingest-management/elastic-agent/upgrade-standalone-elastic-agent.asciidoc">edit</a></h4>
</div></div></div>
<p>The basic upgrade scenario should work for most use cases. However, in an air-gapped environment Elastic Agent is not able to access the Elastic Artifact Registry at <code class="literal">artifacts.elastic.co</code> directly.</p>
<p>As an alterative, you can do one of the following:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="fleet-agent-proxy-support.html" title="Using a proxy server with Elastic Agent and Fleet">Configure a proxy server</a> for standalone Elastic Agent to access the Elastic Artifact Registry.
</li>
<li class="listitem">
<a class="xref" href="air-gapped.html#host-artifact-registry" title="Host your own artifact registry for binary downloads">Host your own artifact registry</a> for standalone Elastic Agent to access binary downloads.
</li>
</ul>
</div>
<p>Refer to <a class="xref" href="air-gapped.html" title="Air-gapped environments">Air-gapped environments</a> for more details.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="upgrade-standalone-verify-package"></a>Verifying Elastic Agent package signatures<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/ingest-docs/edit/main/docs/en/ingest-management/elastic-agent/upgrade-standalone-elastic-agent.asciidoc">edit</a></h4>
</div></div></div>
<p>Standalone Elastic Agent verifies each package that it downloads using publically available SHA hash and .asc PGP signature files. The SHA file is used to verify that the package has not been modified, and the .asc file is used to verify that the package was released by Elastic. For this purpose, the Elastic public GPG key is embedded in Elastic Agent itself.</p>
<p>At times, the Elastic private GPG key may need to be rotated, either due to the key expiry or due to the private key having been exposed. In this case, standalone Elastic Agent upgrades can fail because the embedded public key no longer works.</p>
<p>In the event of a private GPG key rotation, you can use the following options with the <a class="xref" href="elastic-agent-cmd-options.html#elastic-agent-upgrade-command" title="elastic-agent upgrade"><code class="literal">upgrade</code></a> command to either skip the verification process (not recommended) or force Elastic Agent to use a new public key for verification:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">--skip-verify</code>
</span>
</dt>
<dd>
<p>
Skip the package verification process. This option is not recommended as it is insecure.
</p>
<p>Example:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">./elastic-agent upgrade 8.8.0 --skip-verify</pre>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">--pgp-path &lt;string&gt;</code>
</span>
</dt>
<dd>
<p>
Use a locally stored copy of the PGP key to verify the upgrade package.
</p>
<p>Example:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">./elastic-agent upgrade 8.8.0 --pgp-path /home/elastic-agent/GPG-KEY-elasticsearch</pre>
</div>
</dd>
<dt>
<span class="term">
<code class="literal">--pgp-uri &lt;string&gt;</code>
</span>
</dt>
<dd>
<p>
Use the specified online PGP key to verify the upgrade package.
</p>
<p>Example:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">./elastic-agent upgrade 8.7.0-SNAPSHOT --pgp-uri "https://artifacts.elastic.co/GPG-KEY-elasticsearch"</pre>
</div>
</dd>
</dl>
</div>
<p>Under the basic upgrade scenario standalone Elastic Agent will automatically fetch the most current public key, however in an air-gapped environment or in the event that the Elastic Artifact Registry is otherwise inaccessible, these commands can be used instead.</p>
</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="install-standalone-elastic-agent.html">« Install standalone Elastic Agents</a>
</span>
<span class="next">
<a href="install-elastic-agents-in-containers.html">Install Elastic Agents in a containerized environment »</a>
</span>
</div>
</body>
</html>
