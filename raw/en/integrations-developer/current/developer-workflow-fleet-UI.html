<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Development process for Fleet UI | Integrations Developer Guide | Elastic</title>
<meta class="elastic" name="content" content="Development process for Fleet UI | Integrations Developer Guide">

<link rel="home" href="index.html" title="Integrations Developer Guide"/>
<link rel="up" href="developer-workflows.html" title="Developer workflows"/>
<link rel="prev" href="developer-workflows.html" title="Developer workflows"/>
<link rel="next" href="developer-workflow-support-old-package.html" title="Release a bug fix for supporting older package version"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="Integrations"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Integrations/Developer"/>
<meta name="DC.subject" content="Integrations"/>
<meta name="DC.identifier" content="master"/>
</head>
<body>
<div class="navheader">
<span class="prev">
<a href="developer-workflows.html">« Developer workflows</a>
</span>
<span class="next">
<a href="developer-workflow-support-old-package.html">Release a bug fix for supporting older package version »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Integrations Developer Guide</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="developer-workflows.html">Developer workflows</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Development process for Fleet UI</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/integrations/developer-workflow-fleet.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="developer-workflow-fleet-UI"></a>Development process for Fleet UI</h2><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/integrations/developer-workflow-fleet.asciidoc">edit</a></div>
</div></div></div>
<p>See the Kibana docs for <a href="https://github.com/elastic/kibana/blob/main/CONTRIBUTING.md#setting-up-your-development-environment" class="ulink" target="_top">how to set up your dev environment</a>, <a href="https://github.com/elastic/kibana/blob/main/CONTRIBUTING.md#running-elasticsearch" class="ulink" target="_top">run Elasticsearch</a>, and <a href="https://github.com/elastic/kibana/blob/main/CONTRIBUTING.md#running-kibana" class="ulink" target="_top">start Kibana</a>.</p>
<p>One common development workflow is:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Clone Kibana repo</p>
<div class="pre_wrapper lang-terminal">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-terminal">git clone https://github.com/[YOUR_USERNAME]/kibana.git kibana
cd kibana</pre>
</div>
</li>
<li class="listitem">
<p>Install Dependencies</p>
<div class="pre_wrapper lang-terminal">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-terminal">nvm use
npm install -g yarn</pre>
</div>
</li>
<li class="listitem">
<p>Bootstrap Kibana</p>
<div class="pre_wrapper lang-terminal">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-terminal">yarn kbn bootstrap</pre>
</div>
</li>
<li class="listitem">
<p>Start Elasticsearch in one shell</p>
<div class="pre_wrapper lang-terminal">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-terminal">yarn es snapshot -E xpack.security.authc.api_key.enabled=true</pre>
</div>
</li>
<li class="listitem">
<p>Start Kibana in another shell</p>
<div class="pre_wrapper lang-terminal">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-terminal">yarn start --xpack.fleet.enabled=true --no-base-path</pre>
</div>
</li>
<li class="listitem">
Download fleet-server package from <a href="/downloads/past-releases/#elastic-agent" class="ulink" target="_top">https://www.elastic.co/downloads/past-releases/#elastic-agent</a>
</li>
<li class="listitem">
Untar fleet server tarball and <code class="literal">cd</code> to the directory
</li>
<li class="listitem">
<p>Install fleet-server (See also the alternative solution)</p>
<div class="pre_wrapper lang-terminal">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-terminal">sudo ./elastic-agent install  -f \
--fleet-server-es=http://elastic:changeme@localhost:9200 \
--fleet-server-policy=&lt;default policy id&gt;</pre>
</div>
<p>The <code class="literal">default policy id</code> can be retrieved by fleet ui instructions in Kibana before any fleet server is installed.
  Fleet Server will start in <code class="literal">+https://users_machine_ip:8220+</code></p>
</li>
<li class="listitem">
Update Fleet settings on the top right corner of Fleet UI to set the correct Fleet Server hosts (ip from previous step).
</li>
<li class="listitem">
After that user can enroll as many agents as they want
</li>
<li class="listitem">
Any code update in Kibana fleet plugin should be picked up automatically and either cause the server to restart, or be served to the browser on the next page refresh.
</li>
</ol>
</div>
<div class="position-relative"><h4><a id="_alternative_solution_for_fleet_server"></a>Alternative solution for fleet server</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/integrations/developer-workflow-fleet.asciidoc">edit</a></div>
<p>Instead of download fleet server package and running it as a local process you can run Fleet Server Locally in a Container.</p>
<p>It can be useful to run Fleet Server in a container on your local machine in order to free up your actual "bare metal" machine to run Elastic Agent for testing purposes. Otherwise, you&#8217;ll only be able to a single instance of Elastic Agent dedicated to Fleet Server on your local machine, and this can make testing integrations and policies difficult.</p>
<p><em>The following is adapted from the Fleet Server <a href="https://github.com/elastic/fleet-server#running-elastic-agent-with-fleet-server-in-container" class="ulink" target="_top">README</a></em></p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Add the following configuration to your <code class="literal">config/kibana.yml</code></p>
<div class="pre_wrapper lang-yml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yml">server.host: 0.0.0.0</pre>
</div>
</li>
<li class="listitem">
<p>Append the following option to the command you use to start Elasticsearch</p>
<div class="pre_wrapper lang-yml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yml">-E http.host=0.0.0.0</pre>
</div>
<p>This command should look something like this:</p>
<div class="pre_wrapper lang-terminal">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-terminal">yarn es snapshot --license trial -E xpack.security.authc.api_key.enabled=true -E path.data=/tmp/es-data -E http.host=0.0.0.0</pre>
</div>
</li>
<li class="listitem">
<p>Run the Fleet Server Docker container. Make sure you include a <code class="literal">BASE-PATH</code> value if your local Kibana instance is using one. <code class="literal">YOUR-IP</code> should correspond to the IP address used by your Docker network to represent the host. For Windows and Mac machines, this should be <code class="literal">192.168.65.2</code>. If you&#8217;re not sure what this IP should be, run the following to look it up:</p>
<div class="pre_wrapper lang-terminal">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-terminal">docker run -it --rm alpine nslookup host.docker.internal</pre>
</div>
<p>To run the Fleet Server Docker container:</p>
<div class="pre_wrapper lang-terminal">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-terminal">docker run -e KIBANA_HOST=http://{YOUR-IP}:5601/{BASE-PATH} -e KIBANA_USERNAME=elastic -e KIBANA_PASSWORD=changeme -e ELASTICSEARCH_HOST=http://{YOUR-IP}:9200 -e ELASTICSEARCH_USERNAME=elastic -e ELASTICSEARCH_PASSWORD=changeme -e KIBANA_FLEET_SETUP=1 -e FLEET_SERVER_ENABLE=1 -e FLEET_SERVER_INSECURE_HTTP=1 -p 8220:8220 docker.elastic.co/elastic-agent/elastic-agent:{VERSION}</pre>
</div>
<p>Ensure you provide the <code class="literal">-p 8220:8220</code> port mapping to map the Fleet Server container&#8217;s port <code class="literal">8220</code> to your local machine&#8217;s port <code class="literal">8220</code> in order for Fleet to communicate with Fleet Server.</p>
<p>For the latest version, use <code class="literal">8.0.0-SNAPSHOT</code>. Otherwise, you can explore the available versions at <a href="https://www.docker.elastic.co/r/beats/elastic-agent" class="ulink" target="_top">https://www.docker.elastic.co/r/beats/elastic-agent</a>.</p>
<p>Once the Fleet Server container is running, you should be able to treat it as if it were a local process running on <code class="literal">+http://localhost:8220+</code> when configuring Fleet via the UI. You can then run <code class="literal">elastic-agent</code> on your local machine directly for testing purposes.</p>
</li>
</ol>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="developer-workflows.html">« Developer workflows</a>
</span>
<span class="next">
<a href="developer-workflow-support-old-package.html">Release a bug fix for supporting older package version »</a>
</span>
</div>
</body>
</html>
