<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>General guidelines | Integrations Developer Guide | Elastic</title>
<meta class="elastic" name="content" content="General guidelines | Integrations Developer Guide">

<link rel="home" href="index.html" title="Integrations Developer Guide"/>
<link rel="up" href="integrations-guidelines.html" title="Integrations guidelines"/>
<link rel="prev" href="integrations-guidelines.html" title="Integrations guidelines"/>
<link rel="next" href="dashboard-guidelines.html" title="Dashboard guidelines"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="Integrations"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Integrations/Developer"/>
<meta name="DC.subject" content="Integrations"/>
<meta name="DC.identifier" content="master"/>
</head>
<body>
<div class="navheader">
<span class="prev">
<a href="integrations-guidelines.html">« Integrations guidelines</a>
</span>
<span class="next">
<a href="dashboard-guidelines.html">Dashboard guidelines »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Integrations Developer Guide</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="integrations-guidelines.html">Integrations guidelines</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>General guidelines</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/integrations/integrations-guidelines.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="general-guidelines"></a>General guidelines</h2><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/integrations/integrations-guidelines.asciidoc">edit</a></div>
</div></div></div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>The following guidelines capture general aspects of the integrations that can be improved and should not be treated as a mandatory list of requirements every package should adhere to. Some guidelines that are applicable to one integration can be completely irrelevant to another. Treat them as best effort.</p>
</div>
</div>
<p>While the guidelines focus on metrics, they are equally applicable to logs.</p>
<div class="position-relative"><h4><a id="_data_types"></a>Data types</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/integrations/integrations-guidelines.asciidoc">edit</a></div>
<p>Given that all packages are basic, developers should use Basic types (for example <code class="literal">histogram</code>. <code class="literal">wildcard</code>, etc.) when applicable. Of course, for ECS (see below) we should use the type specified by ECS.</p>
<div class="position-relative"><h4><a id="_ecs_compliance"></a>ECS compliance</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/integrations/integrations-guidelines.asciidoc">edit</a></div>
<p>An integration package should be compliant with the most recent version of ECS. This implies an increased amount of relevant ECS fields populated by an integration.</p>
<p>Starting with ECS 1.6, ECS is going to start using Basic types for some fields. Integration fields should be upgraded to the new types as part of the process.</p>
<div class="position-relative"><h4><a id="_document_all_fields"></a>Document all fields</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/integrations/integrations-guidelines.asciidoc">edit</a></div>
<p>All fields produced by an integration must be mapped by <code class="literal">fields.yml</code>. This guarantees that their index mapping is correct, and Kibana has enough information to deal with all fields.</p>
<div class="position-relative"><h5><a id="_field_limits"></a>Field limits</h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/integrations/integrations-guidelines.asciidoc">edit</a></div>
<p>By default, data streams will have a <code class="literal">total_fields.limit</code> setting of 1000. Besides defined custom fields, this also includes dynamically generated ECS fields. If your data stream is expected to eventually house more than 1000 fields, set an explicit limit in the <code class="literal">manifest.yml</code> of the data stream:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">elasticsearch:
  index_template:
    settings:
      index:
        mapping:
          total_fields:
            limit: 5000</pre>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>For backwards compatibility, the limit is automatically bumped to 10000 fields if there are more than 500 fields explicitly defined for a data stream, however newly created integrations should not rely on this behavior but instead assume a fixed limit of 1000 fields.</p>
</div>
</div>
<div class="position-relative"><h5><a id="_specify_metric_types_and_units"></a>Specify metric types and units</h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/integrations/integrations-guidelines.asciidoc">edit</a></div>
<p>As part of the field definition, there are two settings that add metadata which will help Kibana graphing it:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">unit</code> applies to all data types, defines the units of the field. Examples of units are <code class="literal">byte</code> and <code class="literal">ms</code>. When using <code class="literal">percent</code> for percentages, the convention is to use 1 for 100%. You can find the full list of supported units in the <a href="https://github.com/elastic/package-spec/blob/ff8286d0c40ad76bb082e9c8ea78f4551c2519c1/spec/integration/data_stream/fields/fields.spec.yml#L103" class="ulink" target="_top">package spec</a>.
</li>
<li class="listitem">
<code class="literal">metric_type</code> applies to metric events only, to be added to metric fields. It defines their metric type. It can be of type <code class="literal">gauge</code> or <code class="literal">counter</code>. Counters are used for metrics that always increase over time, such as number of page visits. Gauges are used for amounts that can increase or decrease over time, such as the amount of memory being used.
</li>
</ul>
</div>
<p>The Elasticsearch documentation details the <a href="/guide/en/elasticsearch/reference/master/mapping-field-meta.html" class="ulink" target="_top">expected values for these two fields</a>.</p>
<p>Other applications, including Kibana, can use the information provided by this metadata when accessing these fields. The <code class="literal">unit</code> is used when formatting the values of the field, and the <code class="literal">metric_type</code> can be used to provide better defaults when quering the data.</p>
<div class="position-relative"><h5><a id="_specify_dimensions"></a>Specify dimensions</h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/integrations/integrations-guidelines.asciidoc">edit</a></div>
<p>A set of fields of a data stream can be defined as dimensions. A set of dimensions
with the same values identify a single time series.</p>
<p>It is important to choose the set of fields carefully. They should be the minimal set
of dimensions required to properly identify any time series included in the data stream. Too few dimensions can mix data of multiple time series into a single one, while too many dimensions can impact performance.</p>
<p>A field can be configured as a dimension by setting <code class="literal">dimension: true</code> in its
definition.</p>
<p>Only fields of certain data types can be defined as dimensions. These data types
include keywords, IPs and numeric types.</p>
<p>Some guidelines to take into account when chosing dimensions:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
They can affect ingestion performance, it is recommended to have as few dimensions as possible. When selecting dimensions, try to avoid redundant ones, such as unique identifiers and names that refer to the same object.
</li>
<li class="listitem">
Also be careful with having too few dimensions. There can be only one document with the same timestamp for a given set of dimensions. This can lead to data loss if different objects produce the same dimensions.
</li>
<li class="listitem">
Changing dimensions can be a breaking change. A different set of dimensions produces a different time series, even if they select the same data.
</li>
</ul>
</div>
<p>Declaring dimensions is a requisite to use TSDB indexes. These indexes are
optimized for time series use cases, bringing disk storage savings and additional
queries and aggregations.</p>
<p>TSDB indexes can be enabled in data streams by setting <code class="literal">elasticsearch.index_mode: time_series</code> in their manifests.</p>
<div class="position-relative"><h4><a id="_logs_and_metrics_ui_compatibility"></a>Logs and Metrics UI compatibility</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/integrations/integrations-guidelines.asciidoc">edit</a></div>
<p>When applicable an integrataion package should provide the relevant fields for the Logs and Metrics Apps. This is especially relevant for integrations that are focused on compute-resources (VMs, containers, etc.).</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Keep the <a href="/guide/en/observability/master/logs-app-fields.html" class="ulink" target="_top">Logs app fields</a> reference up to date.
</li>
<li class="listitem">
Keep the <a href="/guide/en/observability/master/metrics-app-fields.html" class="ulink" target="_top">Infrastructure app fields</a> reference up to date.
</li>
</ul>
</div>
<div class="position-relative"><h4><a id="_subtracting_metrics"></a>Subtracting metrics</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/integrations/integrations-guidelines.asciidoc">edit</a></div>
<p>An integration package should collect a reasonable amount of metrics for any target system. In some cases this may mean removing some metrics that Filebeat and Metricbeat are collecting today. Collecting too many metrics has implications on metric storage as well as relevance of the data provided to the user.</p>
<p>Potential candidates to remove:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
low-level garbage collector metrics
</li>
<li class="listitem">
internal metrics showing code flow (for example, <code class="literal">Got100Continue</code>, <code class="literal">Wait100Continue</code>)
</li>
<li class="listitem">
redundant metrics (for example, metric collection for MQ topics doesn&#8217;t require collection of summary metrics)
</li>
</ul>
</div>
<div class="position-relative"><h4><a id="_relevant_metrics"></a>Relevant metrics</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/integrations/integrations-guidelines.asciidoc">edit</a></div>
<p>This is probably the most important and hardest one of the guidelinesto satisfy, as it requires knowledge of every target system. Identifying relevant metrics should be considered case by case.</p>
<p>There are no well defined guidelines for this exercise. It can be as simple as finding everything in one place (for example the <a href="https://www.rabbitmq.com/monitoring.html" class="ulink" target="_top">RabbitMQ documentation</a>) or as difficult as reviewing multiple sources including documentation, blog posts, and other integrations, and consolidating the discovered information in one place for revision. A recommendation is to only collect the metrics that are needed for dashboards and visualizations in general.</p>
<div class="position-relative"><h4><a id="_keep_the_original_message_field"></a>Keep the original message field</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/integrations/integrations-guidelines.asciidoc">edit</a></div>
<p>Log integrations should keep the original message field (recommended name: <code class="literal">event.original</code>) so that it shows up in the Logs UI. It will also be useful when users want to reindex the data after changing a pipeline. In addition, the message field can be used as source for the some future Runtime fields.</p>
<p>The original field should be user-configurable with the Kibana UI for better cost and storage management, and also consistency with other integrations.</p>
<div class="position-relative"><h4><a id="_document_storage_efficiency"></a>Document storage efficiency</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/integrations/integrations-guidelines.asciidoc">edit</a></div>
<p>Every integration should strive to store collected data as efficiently as possible, which implies optimizing the way each integration generates documents.</p>
<div class="position-relative"><h4><a id="_default_datasets"></a>Default datasets</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/integrations/integrations-guidelines.asciidoc">edit</a></div>
<p>When applicable, an integration package should provide a default dataset that aggregates a subset of the most relevant metrics across other data streams. Think of these as the metrics that are visualized on overview dashboards or are used for alerting. A guideline for creating a separate default dataset could be when the number of datasets in a package is more than three.</p>
<div class="position-relative"><h4><a id="_updated_versions"></a>Updated versions</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/integrations/integrations-guidelines.asciidoc">edit</a></div>
<p>An integration package should support the most relevant versions of a target system. Some of our integrations support older versions of a target service/system, which were relevant at the time of implementation. Over time they can become outdated and require a revision, which can be as simple as testing the integration against the latest version and updating the compatibility section in the documentation, or it can mean refactoring the code to work with the latest version. For example, the Ceph module has recently been updated to support the latest version which had an entirely different way of collecting metrics. In order to accommodate both older and new versions in the module, metricsets were created in the module specifically for newer versions and it was noted in the documentation which metricsets to use.</p>
<div class="position-relative"><h4><a id="_updated_configuration_defaults"></a>Updated configuration defaults</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/integrations/integrations-guidelines.asciidoc">edit</a></div>
<p>An integration package should provide meaningful defaults, such as collection intervals (periods), enabled metricsets, and any other integration specific configuration parameters.
In the majority of cases users opt to use defaults. Hence, providing the relevant default values is crucial for the integration to be useful. In addition, integrations should strive to provide a one-click experience by providing the defaults that can cover 80% of use cases.</p>
<div class="position-relative"><h4><a id="_updated_docs"></a>Updated docs</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/integrations/integrations-guidelines.asciidoc">edit</a></div>
<p>Integration packages should provide consistent and comprehensive documentation.
For more details, refer to the <a class="xref" href="documentation-guidelines.html" title="Documentation guidelines">documentation guidelines</a>.</p>
<div class="position-relative"><h4><a id="_updated_integration_content"></a>Updated integration content</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/integrations/integrations-guidelines.asciidoc">edit</a></div>
<p>Integration packages should provide out-of-the-box dashboards.
For more details, refer to the <a class="xref" href="dashboard-guidelines.html" title="Dashboard guidelines">dashboard guidelines</a>.</p>
<div class="position-relative"><h4><a id="_content_for_elastic_cointegrations"></a>Content for elastic.co/integrations</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/integrations/integrations-guidelines.asciidoc">edit</a></div>
<p>Each integration will be listed on the public website <code class="literal">elastic.co/integrations</code> and the package registry will serve as the source of truth. As a result, documentation and screenshots should be high quality to showcase the integration. Please ensure to use <code class="literal">svg</code> for the logo and <code class="literal">png</code> for all other images. Any additional branding material should be reviewed carefully, for example:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
logo format and quality
</li>
<li class="listitem">
permission to use logos and trademarks
</li>
</ul>
</div>
<div class="position-relative"><h4><a id="_curated_user_experiences"></a>Curated user experiences</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/integrations/integrations-guidelines.asciidoc">edit</a></div>
<p>It&#8217;s advised to set integration policies in Fleet. Every integration and agent should be visible in Fleet and users should be able to add the integration directly from the integration list. This leads to better cohesion since it provides a consistent experience across integrations, allow users to add several integrations at once, and avoids sending them back and forth between multiple apps. It also allows users to discover new integrations in the list.</p>
<p>Elastic products will also have the option to provide a curated UI for settings that are difficult to put in Fleet. It&#8217;s up to the product to decide how much flexibility they want to provide in changing the configuration directly from Fleet. This will depend on the use case and if it makes sense. Some level of configuration is recommended though.</p>
<div class="position-relative"><h4><a id="_asset_tagging_and_metadata"></a>Asset tagging and metadata</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/integrations/integrations-guidelines.asciidoc">edit</a></div>
<p>When assets are installed through Fleet some metadata is added by default.</p>
<p>For Elasticsearch assets such as index templates and ingest pipelines, a <code class="literal">_meta</code> property is added to the asset as follows:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
  "managed_by": "fleet",
  "managed": true,
  "package": {
    "name": "&lt;package name&gt;"
  }
}</pre>
</div>
<p>For Kibana assets, <a href="/guide/en/kibana/master/managing-tags.html" class="ulink" target="_top">tags</a> are generated in addition to the <code class="literal">_meta</code> property:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
One tag with a <code class="literal">name</code> matching the package&#8217;s <code class="literal">title</code> property
</li>
<li class="listitem">
The <code class="literal">managed</code> tag, which Kibana uses to recognize "system" assets, or those that are installed by Kibana itself instead of generated by an end user
</li>
</ul>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="integrations-guidelines.html">« Integrations guidelines</a>
</span>
<span class="next">
<a href="dashboard-guidelines.html">Dashboard guidelines »</a>
</span>
</div>
</body>
</html>
