<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>CISA KEV integration | Elastic integrations | Elastic</title>
<meta class="elastic" name="content" content="CISA KEV integration | Elastic integrations">

<link rel="home" href="index.html" title="Elastic integrations"/>
<link rel="up" href="index.html" title="Elastic integrations"/>
<link rel="prev" href="cilium_tetragon.html" title="Cilium Tetragon"/>
<link rel="next" href="cisco-intro.html" title="Cisco"/>
<meta class="elastic" name="product_version" content="main"/>
<meta class="elastic" name="product_name" content="Integrations"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Integrations/Reference"/>
<meta name="DC.subject" content="Integrations"/>
<meta name="DC.identifier" content="main"/>
</head>
<body>
<div class="navheader">
<span class="prev">
<a href="cilium_tetragon.html">« Cilium Tetragon</a>
</span>
<span class="next">
<a href="cisco-intro.html">Cisco »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic integrations</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>CISA KEV integration</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/cisa_kevs/index.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="chapter">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="cisa_kevs"></a>CISA KEV integration</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/cisa_kevs/index.asciidoc">edit</a></div>
</div></div></div>

<div class="condensed-table">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<tbody>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Version</strong></span></p></td>
<td align="left" valign="top"><p>1.4.1 (<a class="xref" href="cisa_kevs.html#cisa_kevs-changelog" title="Changelog">View all</a>)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Compatible Kibana version(s)</strong></span></p></td>
<td align="left" valign="top"><p>8.13.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Supported Serverless project types</strong></span><br>
 <a class="xref" href="serverless-support.html" title="Supported Serverless project types"><span class="small">What&#8217;s this?</span></a></p></td>
<td align="left" valign="top"><p>Security<br>
Observability</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Subscription level</strong></span><br>
<a href="/subscriptions" class="ulink" target="_top"><span class="small">What&#8217;s this?</span></a></p></td>
<td align="left" valign="top"><p>Basic</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Level of support</strong></span><br>
<a class="xref" href="support.html" title="Level of support"><span class="small">What&#8217;s this?</span></a></p></td>
<td align="left" valign="top"><p>Community</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>This integration is for <a href="https://www.cisa.gov/known-exploited-vulnerabilities-catalog" class="ulink" target="_top">CISA KEV</a> logs. This data can be useful for current awareness of Known Exploited Vulnerabilities according to CISA and also for enriching other vulnerability scan data in the Elastic stack. The integration periodically checks for the latest CISA KEV list. It includes the following datasets for retrieving logs from the CISA KEV website:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">vulnerability</code> dataset: Supports vulnerabilities classified as known exploited from CISA.
</li>
</ul>
</div>
<div class="position-relative"><h4><a id="cisa_kevs-example-enrich-policy-and-esorql-correlation-query"></a>Example Enrich Policy and ES|QL Correlation Query</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/cisa_kevs/index.asciidoc">edit</a></div>
<p>An enrich policy can be created to have other vulnerability information be enriched based on the CVE number.</p>
<p>The following requests can be used to create and execute the enrich policy after the integration has been installed:</p>
<div class="pre_wrapper lang-txt">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-txt">PUT /_enrich/policy/enrich_cve_with_context_cisa_kev
{
  "match": {
    "indices": ".ds-logs-cisa_kevs.vulnerability-*",
    "match_field": "vulnerability.id",
    "enrich_fields": ["cisa_kev.vulnerability.date_added", "cisa_kev.vulnerability.due_date", "cisa_kev.vulnerability.known_ransomware_campaign_use", "cisa_kev.vulnerability.name", "cisa_kev.vulnerability.notes","cisa_kev.vulnerability.product","cisa_kev.vulnerability.required_action","cisa_kev.vulnerability.vendor_project"]
  }
}

PUT /_enrich/policy/enrich_cve_with_context_cisa_kev/_execute</pre>
</div>
<p>Here is an example ES|QL query that uses the index pattern of logs-nessus.vulnerability* to enrich the data source with CISA KEV information and keeping the top 10 results. Note, the enrich policy (shown above) must be created first:</p>
<div class="pre_wrapper lang-txt">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-txt">from logs-nessus.vulnerability*
| where vulnerability.id IS NOT NULL
| keep vulnerability.*, nessus.plugin.name, host.name
| enrich enrich_cve_with_context_cisa_kev with cisa_kev.vulnerability.due_date, cisa_kev.vulnerability.known_ransomware_campaign_use, cisa_kev.vulnerability.name, cisa_kev.vulnerability.notes, cisa_kev.vulnerability.product, cisa_kev.vulnerability.required_action, cisa_kev.vulnerability.vendor_project, cisa_kev.vulnerability.date_added
| where cisa_kev.vulnerability.name IS NOT NULL
| stats count = COUNT(host.name) BY nessus.plugin.name, vulnerability.severity, cisa_kev.vulnerability.date_added, cisa_kev.vulnerability.product
| sort count desc
| keep nessus.plugin.name, vulnerability.severity, cisa_kev.vulnerability.product, cisa_kev.vulnerability.date_added, count
| limit 10</pre>
</div>
<div class="position-relative"><h3><a id="cisa_kevs-logs"></a>Logs</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/cisa_kevs/index.asciidoc">edit</a></div>
<div class="position-relative"><h4><a id="cisa_kevs-vulnerabilities"></a>Vulnerabilities</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/cisa_kevs/index.asciidoc">edit</a></div>
<p>The CISA KEV data_stream retrieves vulnerability information from the endpoint <code class="literal">https://www.cisa.gov/sites/default/files/feeds/known_exploited_vulnerabilities.json</code>.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Example</strong></span></summary>
<div class="content">
<p>An example event for <code class="literal">vulnerability</code> looks as following:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
    "@timestamp": "2024-02-15T00:00:00.000Z",
    "agent": {
        "ephemeral_id": "39957f93-aff4-4e3f-84f0-66d18441ccd6",
        "id": "7edf8be5-ad5d-4c57-a6bd-b86bddc66601",
        "name": "docker-fleet-agent",
        "type": "filebeat",
        "version": "8.12.2"
    },
    "cisa_kev": {
        "vulnerability": {
            "date_added": "2024-02-15",
            "due_date": "2024-03-07",
            "known_ransomware_campaign_use": "Known",
            "name": "Cisco ASA and FTD Information Disclosure Vulnerability",
            "notes": "https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-asaftd-info-disclose-9eJtycMB",
            "product": "Adaptive Security Appliance (ASA) and Firepower Threat Defense (FTD)",
            "required_action": "Apply mitigations per vendor instructions or discontinue use of the product if mitigations are unavailable.",
            "vendor_project": "Cisco"
        }
    },
    "data_stream": {
        "dataset": "cisa_kevs.vulnerability",
        "namespace": "ep",
        "type": "logs"
    },
    "ecs": {
        "version": "8.11.0"
    },
    "elastic_agent": {
        "id": "7edf8be5-ad5d-4c57-a6bd-b86bddc66601",
        "snapshot": false,
        "version": "8.12.2"
    },
    "event": {
        "agent_id_status": "verified",
        "category": [
            "vulnerability"
        ],
        "created": "2024-03-13T01:01:09.893Z",
        "dataset": "cisa_kevs.vulnerability",
        "ingested": "2024-03-13T01:01:21Z",
        "kind": "enrichment",
        "original": "{\"cveID\":\"CVE-2020-3259\",\"dateAdded\":\"2024-02-15\",\"dueDate\":\"2024-03-07\",\"knownRansomwareCampaignUse\":\"Known\",\"notes\":\"https://tools.cisco.com/security/center/content/CiscoSecurityAdvisory/cisco-sa-asaftd-info-disclose-9eJtycMB\",\"product\":\"Adaptive Security Appliance (ASA) and Firepower Threat Defense (FTD)\",\"requiredAction\":\"Apply mitigations per vendor instructions or discontinue use of the product if mitigations are unavailable.\",\"shortDescription\":\"Cisco Adaptive Security Appliance (ASA) and Firepower Threat Defense (FTD) contain an information disclosure vulnerability. An attacker could retrieve memory contents on an affected device, which could lead to the disclosure of confidential information due to a buffer tracking issue when the software parses invalid URLs that are requested from the web services interface. This vulnerability affects only specific AnyConnect and WebVPN configurations.\",\"vendorProject\":\"Cisco\",\"vulnerabilityName\":\"Cisco ASA and FTD Information Disclosure Vulnerability\"}",
        "type": [
            "info"
        ]
    },
    "input": {
        "type": "httpjson"
    },
    "tags": [
        "preserve_original_event",
        "forwarded",
        "cisa-kev"
    ],
    "vulnerability": {
        "description": "Cisco Adaptive Security Appliance (ASA) and Firepower Threat Defense (FTD) contain an information disclosure vulnerability. An attacker could retrieve memory contents on an affected device, which could lead to the disclosure of confidential information due to a buffer tracking issue when the software parses invalid URLs that are requested from the web services interface. This vulnerability affects only specific AnyConnect and WebVPN configurations.",
        "id": "CVE-2020-3259"
    }
}</pre>
</div>
</div>
</details>
<details>
<summary class="title"><span class="strong strong"><strong>Exported fields</strong></span></summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Field</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>@timestamp</p></td>
<td align="left" valign="top"><p>Event timestamp.</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cisa_kev.vulnerability.date_added</p></td>
<td align="left" valign="top"><p>The date the vulnerability was added to the catalog in the format YYYY-MM-DD</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cisa_kev.vulnerability.due_date</p></td>
<td align="left" valign="top"><p>The date the required action is due in the format YYYY-MM-DD</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cisa_kev.vulnerability.known_ransomware_campaign_use</p></td>
<td align="left" valign="top"><p><em>Known</em> if this vulnerability is known to have been leveraged as part of a ransomware campaign; <em>Unknown</em> if CISA lacks confirmation that the vulnerability has been utilized for ransomware</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cisa_kev.vulnerability.name</p></td>
<td align="left" valign="top"><p>The name of the vulnerability</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cisa_kev.vulnerability.notes</p></td>
<td align="left" valign="top"><p>Any additional notes about the vulnerability</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cisa_kev.vulnerability.product</p></td>
<td align="left" valign="top"><p>The vulnerability product</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cisa_kev.vulnerability.required_action</p></td>
<td align="left" valign="top"><p>The required action to address the vulnerability</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cisa_kev.vulnerability.vendor_project</p></td>
<td align="left" valign="top"><p>The vendor or project name for the vulnerability</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.dataset</p></td>
<td align="left" valign="top"><p>Data stream dataset.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.namespace</p></td>
<td align="left" valign="top"><p>Data stream namespace.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.type</p></td>
<td align="left" valign="top"><p>Data stream type.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>input.type</p></td>
<td align="left" valign="top"><p>Type of Filebeat input.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
<div class="position-relative"><h3><a id="cisa_kevs-changelog"></a>Changelog</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/cisa_kevs/index.asciidoc">edit</a></div>
<details>
<summary class="title"><span class="strong strong"><strong>Changelog</strong></span></summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Version</th>
<th align="left" valign="top">Details</th>
<th align="left" valign="top">Kibana version(s)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.4.1</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-bug"></span> <span class="strong strong"><strong>Bug fix</strong></span> (<a href="https://github.com/elastic/integrations/pull/12697" class="ulink" target="_top">View pull request</a>)<br>
Updated SSL description to be uniform and to include links to documentation.</p>
</td>
<td align="left" valign="top"><p>8.13.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.4.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/12046" class="ulink" target="_top">View pull request</a>)<br>
Add "preserve_original_event" tag to documents with <code class="literal">event.kind</code> set to "pipeline_error".</p>
</td>
<td align="left" valign="top"><p>8.13.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.3.1</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-bug"></span> <span class="strong strong"><strong>Bug fix</strong></span> (<a href="https://github.com/elastic/integrations/pull/11314" class="ulink" target="_top">View pull request</a>)<br>
Use triple-brace Mustache templating when referencing variables in ingest pipelines.</p>
</td>
<td align="left" valign="top"><p>8.13.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.3.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/10897" class="ulink" target="_top">View pull request</a>)<br>
Allow @custom pipeline access to event.original without setting preserve_original_event.</p>
</td>
<td align="left" valign="top"><p>8.13.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.2.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/10135" class="ulink" target="_top">View pull request</a>)<br>
Update the kibana constraint to ^8.13.0. Modified the field definitions to remove ECS fields made redundant by the ecs@mappings component template.</p>
</td>
<td align="left" valign="top"><p>8.13.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.1.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/9974" class="ulink" target="_top">View pull request</a>)<br>
Improve handling of empty responses.</p>
</td>
<td align="left" valign="top"><p>8.11.4 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.0.1</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-bug"></span> <span class="strong strong"><strong>Bug fix</strong></span> (<a href="https://github.com/elastic/integrations/pull/9631" class="ulink" target="_top">View pull request</a>)<br>
Update logo to align w/ Elastic Integrations page, fix description wording</p>
</td>
<td align="left" valign="top"><p>8.11.4 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.0.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/9492" class="ulink" target="_top">View pull request</a>)<br>
Add Enrich/ES|QL Samples to Readme, make GA.</p>
</td>
<td align="left" valign="top"><p>8.11.4 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.1.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/9240" class="ulink" target="_top">View pull request</a>)<br>
Initial draft of the package</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="cilium_tetragon.html">« Cilium Tetragon</a>
</span>
<span class="next">
<a href="cisco-intro.html">Cisco »</a>
</span>
</div>
</body>
</html>
