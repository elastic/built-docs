<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Rapid7 Threat Command Integration | Elastic integrations | Elastic</title>
<meta class="elastic" name="content" content="Rapid7 Threat Command Integration | Elastic integrations">

<link rel="home" href="index.html" title="Elastic integrations"/>
<link rel="up" href="rapid7-intro.html" title="Rapid7"/>
<link rel="prev" href="rapid7_insightvm.html" title="Rapid7 InsightVM"/>
<link rel="next" href="redis-intro.html" title="Redis"/>
<meta class="elastic" name="product_version" content="main"/>
<meta class="elastic" name="product_name" content="Integrations"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Integrations/Reference"/>
<meta name="DC.subject" content="Integrations"/>
<meta name="DC.identifier" content="main"/>
</head>
<body>
<div class="navheader">
<span class="prev">
<a href="rapid7_insightvm.html">« Rapid7 InsightVM</a>
</span>
<span class="next">
<a href="redis-intro.html">Redis »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic integrations</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="rapid7-intro.html">Rapid7</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Rapid7 Threat Command Integration</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/ti_rapid7_threat_command/index.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="ti_rapid7_threat_command"></a>Rapid7 Threat Command Integration</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/ti_rapid7_threat_command/index.asciidoc">edit</a></div>
</div></div></div>

<div class="condensed-table">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<tbody>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Version</strong></span></p></td>
<td align="left" valign="top"><p>2.0.3 (<a class="xref" href="ti_rapid7_threat_command.html#ti_rapid7_threat_command-changelog" title="Changelog">View all</a>)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Compatible Kibana version(s)</strong></span></p></td>
<td align="left" valign="top"><p>8.13.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Supported Serverless project types</strong></span><br>
 <a class="xref" href="serverless-support.html" title="Supported Serverless project types"><span class="small">What&#8217;s this?</span></a></p></td>
<td align="left" valign="top"><p>Security</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Subscription level</strong></span><br>
<a href="/subscriptions" class="ulink" target="_top"><span class="small">What&#8217;s this?</span></a></p></td>
<td align="left" valign="top"><p>Basic</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Level of support</strong></span><br>
<a class="xref" href="support.html" title="Level of support"><span class="small">What&#8217;s this?</span></a></p></td>
<td align="left" valign="top"><p>Partner</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="position-relative"><h4><a id="ti_rapid7_threat_command-overview"></a>Overview</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/ti_rapid7_threat_command/index.asciidoc">edit</a></div>
<p>The <a href="https://www.rapid7.com/" class="ulink" target="_top">Rapid7 Threat Command</a> integration allows users to retrieve IOCs (Indicator of Compromises), organization-specific Threat Command alerts, and CVEs (Common Vulnerabilities and Exposures). Furthermore, the correlation between data collected from the Rapid7 Threat Command platform (IOCs and CVEs) and the user&#8217;s environment helps to identify threats. Rapid7 Threat Command platform gives protectors the tools and clarity they need to assess their attack surface, detect suspicious behavior, and respond and remediate quickly with intelligent automation.</p>
<div class="position-relative"><h4><a id="ti_rapid7_threat_command-data-streams"></a>Data streams</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/ti_rapid7_threat_command/index.asciidoc">edit</a></div>
<p>The Rapid7 Threat Command integration collects three types of data: ioc, alert, and vulnerability.</p>
<p><span class="strong strong"><strong>IOC</strong></span> uses the REST API to retrieve indicators from the Rapid7 Threat Command platform.</p>
<p><span class="strong strong"><strong>Alert</strong></span> uses the REST API to retrieve alerts from the Rapid7 Threat Command platform.</p>
<p><span class="strong strong"><strong>Vulnerability</strong></span> uses the REST API to retrieve CVEs from the Rapid7 Threat Command platform.</p>
<div class="position-relative"><h4><a id="ti_rapid7_threat_command-compatibility"></a>Compatibility</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/ti_rapid7_threat_command/index.asciidoc">edit</a></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
This integration has been tested against Rapid7 Threat Command <code class="literal">IOC API v2</code>, <code class="literal">Alert API v1</code>, and <code class="literal">Vulnerability API v1</code>.
</li>
<li class="listitem">
Rapid7 Threat Command integration is compatible with Elastic stack <code class="literal">v8.12.0</code> and newer.
</li>
</ul>
</div>
<div class="position-relative"><h4><a id="ti_rapid7_threat_command-requirements"></a>Requirements</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/ti_rapid7_threat_command/index.asciidoc">edit</a></div>
<div class="position-relative"><h5><a id="ti_rapid7_threat_command-elasticsearch"></a>Elasticsearch</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/ti_rapid7_threat_command/index.asciidoc">edit</a></div>
<p>You need Elasticsearch for storing and searching your data and Kibana for visualizing and managing it. You can use our hosted Elasticsearch Service on Elastic Cloud, which is recommended, or self-manage the Elastic Stack on your own hardware.</p>
<div class="position-relative"><h5><a id="ti_rapid7_threat_command-elastic-agent"></a>Elastic Agent</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/ti_rapid7_threat_command/index.asciidoc">edit</a></div>
<p>Elastic Agent must be installed. For more information, refer to the link <a href="/guide/en/fleet/current/elastic-agent-installation.html" class="ulink" target="_top">here</a>.</p>
<p>You have a few options for installing and managing an Elastic Agent:</p>
<div class="position-relative"><h6><a id="ti_rapid7_threat_command-install-a-fleet-managed-elastic-agent-recommended"></a>Install a Fleet-managed Elastic Agent (recommended):</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/ti_rapid7_threat_command/index.asciidoc">edit</a></div>
<p>With this approach, you install Elastic Agent and use Fleet in Kibana to define, configure, and manage your agents in a central location. We recommend using Fleet management because it makes the management and upgrade of your agents considerably easier.</p>
<div class="position-relative"><h6><a id="ti_rapid7_threat_command-install-elastic-agent-in-standalone-mode-advanced-users"></a>Install Elastic Agent in standalone mode (advanced users):</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/ti_rapid7_threat_command/index.asciidoc">edit</a></div>
<p>With this approach, you install Elastic Agent and manually configure the agent locally on the system where it’s installed. You are responsible for managing and upgrading the agents. This approach is reserved for advanced users only.</p>
<div class="position-relative"><h6><a id="ti_rapid7_threat_command-install-elastic-agent-in-a-containerized-environment"></a>Install Elastic Agent in a containerized environment:</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/ti_rapid7_threat_command/index.asciidoc">edit</a></div>
<p>You can run Elastic Agent inside a container, either with Fleet Server or standalone. Docker images for all versions of Elastic Agent are available from the Elastic Docker registry, and we provide deployment manifests for running on Kubernetes.</p>
<p>There are some minimum requirements for running Elastic Agent and for more information, refer to the link <a href="/guide/en/fleet/current/elastic-agent-installation.html" class="ulink" target="_top">here</a>.</p>
<div class="position-relative"><h5><a id="ti_rapid7_threat_command-other-prerequisites"></a>Other prerequisites</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/ti_rapid7_threat_command/index.asciidoc">edit</a></div>
<p>The minimum <span class="strong strong"><strong>kibana.version</strong></span> required is <span class="strong strong"><strong>8.12.0</strong></span>.</p>
<p>Check the prerequisites for <a href="/guide/en/elasticsearch/reference/current/transform-setup.html#transform-setup" class="ulink" target="_top">Transforms</a>.</p>
<p>Check the prerequisites for <a href="/docs/api/doc/kibana/v8/group/endpoint-connectors" class="ulink" target="_top">Actions and Connectors</a>.</p>
<div class="position-relative"><h4><a id="ti_rapid7_threat_command-setup"></a>Setup</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/ti_rapid7_threat_command/index.asciidoc">edit</a></div>
<div class="position-relative"><h5><a id="ti_rapid7_threat_command-integration-settings"></a>Integration settings</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/ti_rapid7_threat_command/index.asciidoc">edit</a></div>
<div class="position-relative"><h6><a id="ti_rapid7_threat_command-ioc-expiration-duration"></a>IOC Expiration Duration</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/ti_rapid7_threat_command/index.asciidoc">edit</a></div>
<p>This setting enforces all active Indicators of Compromise (IOCs) to expire after this duration since their last seen time indicated in the feed. Use <a href="/guide/en/elasticsearch/reference/current/api-conventions.html#time-units" class="ulink" target="_top">Elasticsearch time units</a> in days, hours, or minutes (e.g <code class="literal">10d</code>). If invalid units are provided, default value <code class="literal">90d</code> i.e., 90 days is used to expire the indicators. More details on indicator expiration, read <a href="/docs/current/integrations/ti_rapid7_threat_command#expiration-of-indicators-of-compromise-(iocs)" class="ulink" target="_top">Expiration of Indicators of Compromise (IOCs)</a> section.</p>
<div class="position-relative"><h6><a id="ti_rapid7_threat_command-filtering-iocs"></a>Filtering IOCs</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/ti_rapid7_threat_command/index.asciidoc">edit</a></div>
<p>In order to filter the results based on severity and type, one can make use of <span class="strong strong"><strong>IOC Severities</strong></span> and <span class="strong strong"><strong>IOC Types</strong></span> parameters:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Allowed values for IOC Severities: High, Medium, Low, PendingEnrichment.
</li>
<li class="listitem">
Allowed values for IOC Types: IpAddresses, Urls, Domains, Hashes, Emails.
</li>
</ul>
</div>
<div class="position-relative"><h6><a id="ti_rapid7_threat_command-filtering-alerts"></a>Filtering Alerts</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/ti_rapid7_threat_command/index.asciidoc">edit</a></div>
<p>In order to filter the results based on severity, type, and status, one can make use of <span class="strong strong"><strong>Alert Severities</strong></span>, <span class="strong strong"><strong>Alert Types</strong></span>, <span class="strong strong"><strong>Fetch Closed Alerts</strong></span> parameters:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Allowed values for Alert Severities: High, Medium, Low.
</li>
<li class="listitem">
Allowed values for Alert Types: AttackIndication, DataLeakage, Phishing, BrandSecurity, ExploitableData, vip.
</li>
</ul>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Individual policies need to be configured to retrieve both <span class="strong strong"><strong>Closed</strong></span> and <span class="strong strong"><strong>Open</strong></span> alerts.</p>
</div>
</div>
<div class="position-relative"><h6><a id="ti_rapid7_threat_command-filtering-vulnerabilities"></a>Filtering Vulnerabilities</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/ti_rapid7_threat_command/index.asciidoc">edit</a></div>
<p>In order to filter the results based on severity, one can make use of the <span class="strong strong"><strong>Vulnerability Severities</strong></span> parameter:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Allowed values for Vulnerability Severities: Critical, High, Medium, Low.
</li>
</ul>
</div>
<p>Click on <span class="strong strong"><strong>Add row</strong></span> to filter out data using multiple values of the parameter.</p>
<div class="position-relative"><h5><a id="ti_rapid7_threat_command-major-changes-after-integration-version-1160"></a>Major changes after integration version <code class="literal">1.16.0</code></h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/ti_rapid7_threat_command/index.asciidoc">edit</a></div>
<p><span class="strong strong"><strong>If the integration is being upgraded from version &#8656;1.16.0 to &gt;=2.0.0, one or more actions in below sections are required for the integration to work.</strong></span></p>
<div class="position-relative"><h6><a id="ti_rapid7_threat_command-removal-of-custom-rules"></a>Removal of custom rules</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/ti_rapid7_threat_command/index.asciidoc">edit</a></div>
<p>The integration versions until <code class="literal">1.16.0</code> added custom security detection rules for storing matching indicators and CVEs from user indices to those ingested from Rapid7 Threat Command integration. These rules are now replaced by one or more of <a href="/guide/en/security/current/prebuilt-rules.html" class="ulink" target="_top">Elastic prebuilt detection rules</a>. Following are the changes:</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Rule in <code class="literal">&lt;= v1.16.0</code></th>
<th align="left" valign="top">Replaced by Rule in <code class="literal">v2.0.0</code></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">Rapid7 Threat Command IOCs Correlation</code></p></td>
<td align="left" valign="top"><p><code class="literal">Threat Intel Hash Indicator Match</code>, <code class="literal">Threat Intel IP Address Indicator Match</code>, <code class="literal">Threat Intel URL Indicator Match</code>, <code class="literal">Threat Intel Windows Registry Indicator Match</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">Rapid7 Threat Command CVEs Correlation</code></p></td>
<td align="left" valign="top"><p><code class="literal">Rapid7 Threat Command CVEs Correlation</code></p></td>
</tr>
</tbody>
</table>
</div>
<p>After upgrading to <code class="literal">2.0.0</code>, users are advised to disable and delete old rules to avoid duplicate <a href="/guide/en/security/current/alerts-ui-manage.html" class="ulink" target="_top">Security Alerts</a>. Users must also install and enable new rules in their place as documented <a class="xref" href="ti_rapid7_threat_command.html#ti_rapid7_threat_command-install-and-enable-detection-rule-in-elasticsearch" title="Install and Enable Detection Rule in Elasticsearch">here</a>.</p>
<div class="position-relative"><h6><a id="ti_rapid7_threat_command-removal-of-custom-views-and-dashboards"></a>Removal of custom views and dashboards</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/ti_rapid7_threat_command/index.asciidoc">edit</a></div>
<p>The integration until version <code class="literal">1.16.0</code> adds custom indices and <a href="/guide/en/kibana/current/data-views.html" class="ulink" target="_top">Data Views</a> namely <code class="literal">rapid7-tc-ioc-correlations</code> and <code class="literal">rapid7-tc-cve-correlations</code> to store matching indicators and CVEs from user indices with the help of <a class="xref" href="ti_rapid7_threat_command.html#ti_rapid7_threat_command-removal-of-custom-rules" title="Removal of custom rules">custom rules</a>. Since the custom rules are replaced with Elastic prebuilt rules, these custom views are deleted. Users can view the same matching indicators and CVEs by navigating to <code class="literal">Security</code> &#8594; <code class="literal">Alerts</code> page. Read <a href="/guide/en/security/current/view-alert-details.html" class="ulink" target="_top">View Detection Alert</a> for more details.</p>
<p>Some dashboards that depended on above custom views were also removed. These dashboards include <code class="literal">IOC Correlation</code>, <code class="literal">IOC Correlation Details</code>, <code class="literal">Vulnerability Correlation</code>, and <code class="literal">Vulnerability Correlation Details</code>. Users can view these correlations by navigating to the same <code class="literal">Security</code> &#8594; <code class="literal">Alerts</code> page.</p>
<div class="position-relative"><h6><a id="ti_rapid7_threat_command-removal-of-custom-transforms"></a>Removal of custom transforms</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/ti_rapid7_threat_command/index.asciidoc">edit</a></div>
<p>This integration versions until <code class="literal">1.16.0</code> guided users to create custom transforms on datasets <code class="literal">IOC</code>, <code class="literal">Alert</code>, and <code class="literal">Vulnerability</code> with the commands to execute from Kibana Dev Tools. Starting <code class="literal">2.0.0</code>, the integration replaces them with fleet-managed transforms, which are automatically installed and started after upgrade. Following are the changes:</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Transform Name <code class="literal">&lt;= v1.16.0</code></th>
<th align="left" valign="top">Transform Name <code class="literal">v2.0.0</code></th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">ti_rapid7_threat_command_unique_ioc_transform</code></p></td>
<td align="left" valign="top"><p><code class="literal">logs-ti_rapid7_threat_command.latest_ioc-default-*</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ti_rapid7_threat_command_ioc_rule_transform</code></p></td>
<td align="left" valign="top"><p><code class="literal">N/A</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ti_rapid7_threat_command_unique_alert_transform</code></p></td>
<td align="left" valign="top"><p><code class="literal">logs-ti_rapid7_threat_command.latest_alert-default-*</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ti_rapid7_threat_command_unique_cve_transform</code></p></td>
<td align="left" valign="top"><p><code class="literal">logs-ti_rapid7_threat_command.latest_vulnerability-default-*</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ti_rapid7_threat_command_cve_rule_transform</code></p></td>
<td align="left" valign="top"><p><code class="literal">N/A</code></p></td>
</tr>
</tbody>
</table>
</div>
<p>In versions <code class="literal">&lt;= v1.16.0</code>, the transforms <code class="literal">ti_rapid7_threat_command_ioc_rule_transform</code> and <code class="literal">ti_rapid7_threat_command_cve_rule_transform</code> were used to index the security alerts generated from the <a class="xref" href="ti_rapid7_threat_command.html#ti_rapid7_threat_command-removal-of-custom-rules" title="Removal of custom rules">custom rules</a> into <a class="xref" href="ti_rapid7_threat_command.html#ti_rapid7_threat_command-removal-of-custom-views-and-dashboards" title="Removal of custom views and dashboards">custom views</a>. Since both custom rules and custom views are deleted, these transforms are no longer required.</p>
<p>If users are upgrading to any version after <code class="literal">1.16.0</code>, it is advised to stop and delete all of the transforms used in older versions to avoid duplicate data and <a href="/guide/en/security/current/alerts-ui-manage.html" class="ulink" target="_top">Security Alerts</a>.</p>
<div class="position-relative"><h6><a id="ti_rapid7_threat_command-expiration-of-indicators-of-compromise-iocs"></a>Expiration of Indicators of Compromise (IOCs)</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/ti_rapid7_threat_command/index.asciidoc">edit</a></div>
<p>The threat landscape is always evolving and therefore the IOCs need to update to reflect the current state or expired when the indicators are no longer relevant.</p>
<p>The ingested indicators from the integration are expired after the duration configured by <code class="literal">IOC Expiration Duration</code> integration setting. This setting is <code class="literal">required</code> property and must be set by the users. Refer <a class="xref" href="ti_rapid7_threat_command.html#ti_rapid7_threat_command-ioc-expiration-duration" title="IOC Expiration Duration">IOC Expiration Duration</a> section for more details.</p>
<p>The <a href="/guide/en/elasticsearch/reference/current/transforms.html" class="ulink" target="_top">Elastic Transform</a> named <code class="literal">logs-ti_rapid7_threat_command.latest_ioc-default-*</code> is created to faciliate only active IOCs be available to the end users. This transform creates destination indices named <code class="literal">logs-ti_rapid7_threat_command_latest.dest_ioc-*</code> which only contains active and unexpired IOCs. This latest destination index also has an alias named <code class="literal">logs-ti_rapid7_threat_command_latest.ioc</code>. When querying for active indicators or setting up indicator match rules, only use the latest destination indices or the alias to avoid false positives from expired IOCs.</p>
<p>Dashboards are also pointing to the latest destination indices containing only active indicators.</p>
<p>An <a class="xref" href="ti_rapid7_threat_command.html#ti_rapid7_threat_command-ilm-policy" title="ILM Policy">ILM Policy</a> is added to avoid unbounded growth on source datastream <code class="literal">.ds-logs-ti_rapid7_threat_command.ioc-*</code> indices.</p>
<div class="position-relative"><h6><a id="ti_rapid7_threat_command-ilm-policy"></a>ILM Policy</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/ti_rapid7_threat_command/index.asciidoc">edit</a></div>
<p>Due to the addition of <a class="xref" href="ti_rapid7_threat_command.html#ti_rapid7_threat_command-removal-of-custom-transforms" title="Removal of custom transforms">fleet-managed transforms</a>, ILM policy is also added to <code class="literal">IOC</code>, <code class="literal">Alert</code>, and <code class="literal">Vulnerability</code> datasets so that source datastream-backed indices <code class="literal">.ds-logs-ti_rapid7_threat_command.ioc-*</code>, <code class="literal">.ds-logs-ti_rapid7_threat_command.alert-*</code>, <code class="literal">.ds-logs-ti_rapid7_threat_command.vulnerability-*</code> doesn&#8217;t lead to unbounded growth. This means data in these source indices will be deleted based on the ILM policy, which defaults to <code class="literal">5 days</code> from ingested date.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Source datastream-backed indices</th>
<th align="left" valign="top">Policy Name</th>
<th align="left" valign="top">Default Retention</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">.ds-logs-ti_rapid7_threat_command.ioc-*</code></p></td>
<td align="left" valign="top"><p>logs-ti_rapid7_threat_command.ioc-default_policy</p></td>
<td align="left" valign="top"><p>5 days</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">.ds-logs-ti_rapid7_threat_command.alert-*</code></p></td>
<td align="left" valign="top"><p>logs-ti_rapid7_threat_command.alert-default_policy</p></td>
<td align="left" valign="top"><p>5 days</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">.ds-logs-ti_rapid7_threat_command.vulnerability-*</code></p></td>
<td align="left" valign="top"><p>logs-ti_rapid7_threat_command.vulnerability-default_policy</p></td>
<td align="left" valign="top"><p>5 days</p></td>
</tr>
</tbody>
</table>
</div>
<p>The ILM policies can be modified as per user needs.</p>
<div class="position-relative"><h5><a id="ti_rapid7_threat_command-detection-rules"></a>Detection Rules</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/ti_rapid7_threat_command/index.asciidoc">edit</a></div>
<p>As noted in above sections, there are 5 prebuilt detection rules that are available and need to be added by the users. 4 rules are for matching indicators, while 1 rule is for matching vulnerabilities. Following are the rules:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Threat Intel Hash Indicator Match.
</li>
<li class="listitem">
Threat Intel IP Address Indicator Match.
</li>
<li class="listitem">
Threat Intel URL Indicator Match.
</li>
<li class="listitem">
Threat Intel Windows Registry Indicator Match.
</li>
<li class="listitem">
Rapid7 Threat Command CVEs Correlation.
</li>
</ul>
</div>
<div class="position-relative"><h6><a id="ti_rapid7_threat_command-install-and-enable-detection-rule-in-elasticsearch"></a>Install and Enable Detection Rule in Elasticsearch</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/ti_rapid7_threat_command/index.asciidoc">edit</a></div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
In Kibana, go to <span class="strong strong"><strong>Security &gt; Rules &gt; Detection rules (SIEM)</strong></span>.
</li>
<li class="listitem">
Click on <span class="strong strong"><strong>Add Elastic Rules</strong></span>.
</li>
<li class="listitem">
In the integrations search bar, type and search for each of the 5 rules from above.
</li>
<li class="listitem">
Click on <span class="strong strong"><strong>Install rule</strong></span> to install the rule.
</li>
<li class="listitem">
To enable a detection rule, switch on the rule’s <span class="strong strong"><strong>Enabled</strong></span> toggle.
</li>
</ol>
</div>
<div class="position-relative"><h5><a id="ti_rapid7_threat_command-add-connectors-for-rules"></a>Add Connectors for rules</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/ti_rapid7_threat_command/index.asciidoc">edit</a></div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
In Kibana, go to <span class="strong strong"><strong>Security &gt; Rules &gt; Detection rules (SIEM)</strong></span>.
</li>
<li class="listitem">
Under <span class="strong strong"><strong>Installed Rules</strong></span>, click on each of the 5 rules from above.
</li>
<li class="listitem">
Click on <code class="literal">Edit rule settings</code>.
</li>
<li class="listitem">
Under <span class="strong strong"><strong>Actions</strong></span> tab, choose a connector from the list <code class="literal">Select a connector type</code>.
</li>
<li class="listitem">
<a href="/guide/en/kibana/current/action-types.html" class="ulink" target="_top">Configure the connector</a>.
</li>
</ol>
</div>
<p>For more details on Rule Actions, read <a href="/guide/en/kibana/current/create-and-manage-rules.html#defining-rules-actions-details" class="ulink" target="_top">Rule Actions</a>. For adding Webhook Connector to Rule Actions, read <a href="/guide/en/kibana/current/cases-webhook-action-type.html" class="ulink" target="_top">Webhook - Case Management</a>.</p>
<div class="position-relative"><h4><a id="ti_rapid7_threat_command-limitations"></a>Limitations</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/ti_rapid7_threat_command/index.asciidoc">edit</a></div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
IOC API fetches IOCs within the past six months. Hence, indicators from the most recent six months can be collected.
</li>
<li class="listitem">
For prebuilt Elastic rules, you can not modify most settings. Create a duplicate rule to change any parameter.
</li>
</ol>
</div>
<div class="position-relative"><h4><a id="ti_rapid7_threat_command-troubleshooting"></a>Troubleshooting</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/ti_rapid7_threat_command/index.asciidoc">edit</a></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>If you don&#8217;t see any data for IOCs, Alerts, or CVEs, check the Agent logs to see if there are errors.</p>
<p><span class="strong strong"><strong>Common errors</strong></span>:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Module is not included in the ETP Suite subscription. Verify the system modules of your account using below CURL request.</p>
<div class="pre_wrapper lang-txt">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-txt">curl -u "&lt;account_id&gt;:&lt;api_key&gt;" https://api.intsights.com/public/v1/account/system-modules</pre>
</div>
</li>
<li class="listitem">
<p>Misconfigured settings, like <code class="literal">Account ID</code>, <code class="literal">Access Key</code> or <code class="literal">filter parameters</code>. Verify credentials using below CURL request.</p>
<div class="pre_wrapper lang-txt">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-txt">curl -u "&lt;account_id&gt;:&lt;api_key&gt;" --head https://api.intsights.com/public/v1/test-credentials</pre>
</div>
<p>If it gives <span class="strong strong"><strong>Non-200 response</strong></span> then regenerate the API key from the IntSights ETP Suite UI from the <em>Subscription</em> page.</p>
</li>
</ol>
</div>
</li>
<li class="listitem">
<p>If you don&#8217;t see any correlation for IOCs or CVEs,</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Check whether transforms are running without any errors. If you face any issues in transforms please refer to <a href="/guide/en/elasticsearch/reference/current/transform-troubleshooting.html" class="ulink" target="_top">Troubleshooting transforms</a>.
</li>
<li class="listitem">
Check whether source indices fields (e.g. <code class="literal">source.ip</code>, <code class="literal">url.full</code>, <code class="literal">vulnerability.id</code> etc.) are mapped according to the <a href="/guide/en/ecs/current/ecs-field-reference.html" class="ulink" target="_top">ECS schema</a>.
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="position-relative"><h4><a id="ti_rapid7_threat_command-logs-reference"></a>Logs reference</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/ti_rapid7_threat_command/index.asciidoc">edit</a></div>
<div class="position-relative"><h5><a id="ti_rapid7_threat_command-ioc"></a>IOC</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/ti_rapid7_threat_command/index.asciidoc">edit</a></div>
<p>Retrieves all the related IOCs (Indicator of Compromises) over time.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Example</strong></span></summary>
<div class="content">
<p>An example event for <code class="literal">ioc</code> looks as following:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
    "@timestamp": "2022-06-16T10:39:07.851Z",
    "agent": {
        "ephemeral_id": "f8dfeb31-2b56-4f8e-bb91-d4b94b8086da",
        "id": "8299ae35-ee0e-4107-9acb-1b6acfdda1fb",
        "name": "docker-fleet-agent",
        "type": "filebeat",
        "version": "8.13.0"
    },
    "data_stream": {
        "dataset": "ti_rapid7_threat_command.ioc",
        "namespace": "98425",
        "type": "logs"
    },
    "ecs": {
        "version": "8.11.0"
    },
    "elastic_agent": {
        "id": "8299ae35-ee0e-4107-9acb-1b6acfdda1fb",
        "snapshot": false,
        "version": "8.13.0"
    },
    "event": {
        "agent_id_status": "verified",
        "category": [
            "threat"
        ],
        "created": "2024-08-02T06:09:57.917Z",
        "dataset": "ti_rapid7_threat_command.ioc",
        "ingested": "2024-08-02T06:10:07Z",
        "kind": "enrichment",
        "module": "ti_rapid7_threat_command",
        "original": "{\"firstSeen\":\"2022-05-04T20:11:04.000Z\",\"lastSeen\":\"2022-06-15T20:11:04.000Z\",\"lastUpdateDate\":\"2022-06-16T10:39:07.851Z\",\"relatedCampaigns\":[],\"relatedMalware\":[\"remcos\"],\"relatedThreatActors\":[],\"reportedFeeds\":[{\"confidenceLevel\":2,\"id\":\"5b68306df84f7c8696047fdd\",\"name\":\"Test Feed\"}],\"score\":13.26086956521739,\"severity\":\"Low\",\"status\":\"Active\",\"tags\":[\"Test\"],\"type\":\"IpAddresses\",\"value\":\"89.160.20.112\",\"whitelisted\":false}",
        "risk_score": 13.26087,
        "type": [
            "indicator"
        ]
    },
    "input": {
        "type": "httpjson"
    },
    "rapid7": {
        "tc": {
            "ioc": {
                "deleted_at": "2022-08-05T10:39:07.851Z",
                "expiration_duration": "50d",
                "first_seen": "2022-05-04T20:11:04.000Z",
                "last_seen": "2022-06-15T20:11:04.000Z",
                "last_update_date": "2022-06-16T10:39:07.851Z",
                "related": {
                    "malware": [
                        "remcos"
                    ]
                },
                "reported_feeds": [
                    {
                        "confidence": 2,
                        "id": "5b68306df84f7c8696047fdd",
                        "name": "Test Feed"
                    }
                ],
                "score": 13.26086956521739,
                "severity": "Low",
                "status": "Active",
                "tags": [
                    "Test"
                ],
                "type": "IpAddresses",
                "value": "89.160.20.112",
                "whitelisted": "false"
            }
        }
    },
    "related": {
        "ip": [
            "89.160.20.112"
        ]
    },
    "tags": [
        "preserve_original_event",
        "forwarded",
        "rapid7-threat-command-ioc",
        "Test"
    ],
    "threat": {
        "indicator": {
            "as": {
                "number": 29518,
                "organization": {
                    "name": "Bredband2 AB"
                }
            },
            "confidence": "Low",
            "first_seen": "2022-05-04T20:11:04.000Z",
            "geo": {
                "city_name": "Linköping",
                "continent_name": "Europe",
                "country_iso_code": "SE",
                "country_name": "Sweden",
                "location": {
                    "lat": 58.4167,
                    "lon": 15.6167
                },
                "region_iso_code": "SE-E",
                "region_name": "Östergötland County"
            },
            "ip": "89.160.20.112",
            "last_seen": "2022-06-15T20:11:04.000Z",
            "modified_at": "2022-06-16T10:39:07.851Z",
            "name": "89.160.20.112",
            "provider": [
                "Test Feed"
            ],
            "type": "ipv4-addr"
        }
    }
}</pre>
</div>
</div>
</details>
<details>
<summary class="title"><span class="strong strong"><strong>Exported fields</strong></span></summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Field</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>@timestamp</p></td>
<td align="left" valign="top"><p>Event timestamp.</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cloud.image.id</p></td>
<td align="left" valign="top"><p>Image ID for the cloud instance.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.dataset</p></td>
<td align="left" valign="top"><p>Data stream dataset.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.namespace</p></td>
<td align="left" valign="top"><p>Data stream namespace.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.type</p></td>
<td align="left" valign="top"><p>Data stream type.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.containerized</p></td>
<td align="left" valign="top"><p>If the host is a container.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.build</p></td>
<td align="left" valign="top"><p>OS build information.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.codename</p></td>
<td align="left" valign="top"><p>OS codename, if any.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>input.type</p></td>
<td align="left" valign="top"><p>Input type</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>labels.is_ioc_transform_source</p></td>
<td align="left" valign="top"><p>Indicates whether an IOC is in the raw source data stream, or the in latest destination index.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>log.offset</p></td>
<td align="left" valign="top"><p>Log offset</p></td>
<td align="left" valign="top"><p>long</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.ioc.deleted_at</p></td>
<td align="left" valign="top"><p>The timestamp when indicator is (or will be) expired.</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.ioc.expiration_duration</p></td>
<td align="left" valign="top"><p>The configured expiration duration.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.ioc.first_seen</p></td>
<td align="left" valign="top"><p>IOC first seen date in Unix Millisecond Timestamp.</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.ioc.geolocation</p></td>
<td align="left" valign="top"><p>Geographical location of an IP address.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.ioc.last_seen</p></td>
<td align="left" valign="top"><p>IOC last seen date in Unix Millisecond Timestamp.</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.ioc.last_update_date</p></td>
<td align="left" valign="top"><p>IOC last update date in Unix Millisecond Timestamp.</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.ioc.provider</p></td>
<td align="left" valign="top"><p>List of the indicator providers.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.ioc.related.campaigns</p></td>
<td align="left" valign="top"><p>List of IOC related campaigns.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.ioc.related.malware</p></td>
<td align="left" valign="top"><p>List of IOC related malware families.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.ioc.related.threat_actors</p></td>
<td align="left" valign="top"><p>List of IOC related threat actors.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.ioc.reported_feeds.confidence</p></td>
<td align="left" valign="top"><p>Confidence level of the reported feed.</p></td>
<td align="left" valign="top"><p>double</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.ioc.reported_feeds.id</p></td>
<td align="left" valign="top"><p>ID of the reported feed.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.ioc.reported_feeds.name</p></td>
<td align="left" valign="top"><p>Name of the reported feed.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.ioc.score</p></td>
<td align="left" valign="top"><p>IOC score between 0 - 100.</p></td>
<td align="left" valign="top"><p>double</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.ioc.severity</p></td>
<td align="left" valign="top"><p>IOC severity. Allowed values: <em>High</em>, <em>Medium</em>, <em>Low</em>, <em>PendingEnrichment</em>.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.ioc.status</p></td>
<td align="left" valign="top"><p>State of the IOC. Allowed values: <em>Active</em>, <em>Retired</em>.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.ioc.tags</p></td>
<td align="left" valign="top"><p>List of IOC tags.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.ioc.type</p></td>
<td align="left" valign="top"><p>IOC type.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.ioc.value</p></td>
<td align="left" valign="top"><p>IOC value.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.ioc.whitelisted</p></td>
<td align="left" valign="top"><p>An indicator which states if the IOC was checked and found as whitelisted or not.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>threat.indicator.first_seen</p></td>
<td align="left" valign="top"><p>The date and time when intelligence source first reported sighting this indicator.</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>threat.indicator.last_seen</p></td>
<td align="left" valign="top"><p>The date and time when intelligence source last reported sighting this indicator.</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>threat.indicator.modified_at</p></td>
<td align="left" valign="top"><p>The date and time when intelligence source last modified information for this indicator.</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
<div class="position-relative"><h5><a id="ti_rapid7_threat_command-alert"></a>Alert</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/ti_rapid7_threat_command/index.asciidoc">edit</a></div>
<p>Retrieves organization-specific Threat Command alerts over time.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Example</strong></span></summary>
<div class="content">
<p>An example event for <code class="literal">alert</code> looks as following:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
    "@timestamp": "2022-11-02T10:12:46.260Z",
    "agent": {
        "ephemeral_id": "0a1f430f-ec76-4046-9683-49dd5ebaeab2",
        "id": "34592ccf-10ae-4d24-a28c-97be832bde99",
        "name": "docker-fleet-agent",
        "type": "filebeat",
        "version": "8.13.0"
    },
    "data_stream": {
        "dataset": "ti_rapid7_threat_command.alert",
        "namespace": "ep",
        "type": "logs"
    },
    "ecs": {
        "version": "8.11.0"
    },
    "elastic_agent": {
        "id": "34592ccf-10ae-4d24-a28c-97be832bde99",
        "snapshot": false,
        "version": "8.13.0"
    },
    "event": {
        "agent_id_status": "verified",
        "created": "2024-06-26T07:01:05.859Z",
        "dataset": "ti_rapid7_threat_command.alert",
        "id": "123456789zxcvbnmas8a8q60",
        "ingested": "2024-06-26T07:01:15Z",
        "kind": "alert",
        "module": "ti_rapid7_threat_command",
        "original": "{\"Assets\":[{\"Type\":\"Domains\",\"Value\":\"example.com\"}],\"Assignees\":[],\"Closed\":{\"IsClosed\":true},\"Details\":{\"Description\":\"A suspicious subdomain 'example.com' was found to have characteristics indicating it may be used to carry out phishing attacks. | Recommendations:  It is recommended to block the domain in your URL filtering and mail systems. This can prevent phishing emails being received by your employees and access to websites attempting to steal sensitive information. Click “Remediate” in order to initiate the takedown process for this domain.\",\"Images\":[],\"Severity\":\"Low\",\"Source\":{\"NetworkType\":\"ClearWeb\",\"Type\":\"WHOIS servers\",\"URL\":\"http://example.com\"},\"SubType\":\"RegisteredSuspiciousDomain\",\"Tags\":[{\"CreatedBy\":\"ProfilingRule\",\"Name\":\"Phishing Domain - Default Detection Rule\",\"_id\":\"1al3p6789z6c2b7m9s8a8q60\"}],\"Title\":\"Suspected Phishing Domain - 'example.com'\",\"Type\":\"Phishing\"},\"FoundDate\":\"2022-11-02T10:12:46.260Z\",\"IsFlagged\":false,\"RelatedIocs\":[\"example.com\"],\"RelatedThreatIDs\":[\"6a4e7t9a111bd0003bcc2a55\"],\"TakedownStatus\":\"NotSent\",\"UpdateDate\":\"2022-11-02T10:12:46.260Z\",\"_id\":\"123456789zxcvbnmas8a8q60\"}",
        "reference": "https://dashboard.ti.insight.rapid7.com/#/threat-command/alerts/?search=123456789zxcvbnmas8a8q60"
    },
    "input": {
        "type": "httpjson"
    },
    "rapid7": {
        "tc": {
            "alert": {
                "assets": [
                    {
                        "type": "Domains",
                        "value": "example.com"
                    }
                ],
                "details": {
                    "description": "A suspicious subdomain 'example.com' was found to have characteristics indicating it may be used to carry out phishing attacks. | Recommendations:  It is recommended to block the domain in your URL filtering and mail systems. This can prevent phishing emails being received by your employees and access to websites attempting to steal sensitive information. Click “Remediate” in order to initiate the takedown process for this domain.",
                    "severity": "Low",
                    "source": {
                        "network_type": "ClearWeb",
                        "type": "WHOIS servers",
                        "url": "http://example.com"
                    },
                    "subtype": "RegisteredSuspiciousDomain",
                    "tags": [
                        {
                            "created_by": "ProfilingRule",
                            "id": "1al3p6789z6c2b7m9s8a8q60",
                            "name": "Phishing Domain - Default Detection Rule"
                        }
                    ],
                    "title": "Suspected Phishing Domain - 'example.com'",
                    "type": "Phishing"
                },
                "found_date": "2022-11-02T10:12:46.260Z",
                "id": "123456789zxcvbnmas8a8q60",
                "is_closed": true,
                "is_flagged": false,
                "related_iocs": [
                    "example.com"
                ],
                "related_threat_ids": [
                    "6a4e7t9a111bd0003bcc2a55"
                ],
                "takedown_status": "NotSent",
                "update_date": "2022-11-02T10:12:46.260Z"
            }
        }
    },
    "tags": [
        "preserve_original_event",
        "forwarded",
        "rapid7-threat-command-alert",
        "Phishing Domain - Default Detection Rule"
    ]
}</pre>
</div>
</div>
</details>
<details>
<summary class="title"><span class="strong strong"><strong>Exported fields</strong></span></summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Field</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>@timestamp</p></td>
<td align="left" valign="top"><p>Event timestamp.</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cloud.image.id</p></td>
<td align="left" valign="top"><p>Image ID for the cloud instance.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.dataset</p></td>
<td align="left" valign="top"><p>Data stream dataset.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.namespace</p></td>
<td align="left" valign="top"><p>Data stream namespace.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.type</p></td>
<td align="left" valign="top"><p>Data stream type.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.containerized</p></td>
<td align="left" valign="top"><p>If the host is a container.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.build</p></td>
<td align="left" valign="top"><p>OS build information.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.codename</p></td>
<td align="left" valign="top"><p>OS codename, if any.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>input.type</p></td>
<td align="left" valign="top"><p>Input type</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>log.offset</p></td>
<td align="left" valign="top"><p>Log offset</p></td>
<td align="left" valign="top"><p>long</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.alert.assets.type</p></td>
<td align="left" valign="top"><p>Type of an asset.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.alert.assets.value</p></td>
<td align="left" valign="top"><p>Value of an asset.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.alert.assignees</p></td>
<td align="left" valign="top"><p>List of assignees.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.alert.details.description</p></td>
<td align="left" valign="top"><p>Description of an alert.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.alert.details.images</p></td>
<td align="left" valign="top"><p>List of alert images.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.alert.details.severity</p></td>
<td align="left" valign="top"><p>Alert severity. Allowed values: <em>High</em>, <em>Medium</em>, <em>Low</em>.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.alert.details.source.date</p></td>
<td align="left" valign="top"><p>Source date of an alert in Unix Millisecond Timestamp.</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.alert.details.source.email</p></td>
<td align="left" valign="top"><p>Source email.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.alert.details.source.leak_name</p></td>
<td align="left" valign="top"><p>Name of the leak DBs in data leakage alerts.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.alert.details.source.network_type</p></td>
<td align="left" valign="top"><p>Source network type. Allowed values: <em>ClearWeb</em>, <em>DarkWeb</em>.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.alert.details.source.type</p></td>
<td align="left" valign="top"><p>Alert&#8217;s source type. Allowed values: <em>ApplicationStores</em>, <em>BlackMarkets</em>, <em>HackingForums</em>, <em>SocialMedia</em>, <em>PasteSites</em>, <em>Others</em>.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.alert.details.source.url</p></td>
<td align="left" valign="top"><p>Source url.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.alert.details.subtype</p></td>
<td align="left" valign="top"><p>Subtype of an alert.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.alert.details.tags.created_by</p></td>
<td align="left" valign="top"><p>Name of the person who created the tag.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.alert.details.tags.id</p></td>
<td align="left" valign="top"><p>Unique ID of the tag.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.alert.details.tags.name</p></td>
<td align="left" valign="top"><p>Value of tag.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.alert.details.title</p></td>
<td align="left" valign="top"><p>Title of an alert.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.alert.details.type</p></td>
<td align="left" valign="top"><p>Type of an alert. Allowed values: <em>AttackIndication</em>, <em>DataLeakage</em>, <em>Phishing</em>, <em>BrandSecurity</em>, <em>ExploitableData</em>, <em>vip</em>.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.alert.found_date</p></td>
<td align="left" valign="top"><p>Found date of an alert in Unix Millisecond Timestamp.</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.alert.id</p></td>
<td align="left" valign="top"><p>Unique ID of an alert.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.alert.is_closed</p></td>
<td align="left" valign="top"><p>If true, the alert is closed.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.alert.is_flagged</p></td>
<td align="left" valign="top"><p>If true, the alert is flagged.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.alert.related_iocs</p></td>
<td align="left" valign="top"><p>List of related IOCs.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.alert.related_threat_ids</p></td>
<td align="left" valign="top"><p>List of related threat IDs.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.alert.takedown_status</p></td>
<td align="left" valign="top"><p>Alert remediation status.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.alert.update_date</p></td>
<td align="left" valign="top"><p>Last update date of an alert in Unix Millisecond Timestamp.</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
<div class="position-relative"><h5><a id="ti_rapid7_threat_command-vulnerability"></a>Vulnerability</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/ti_rapid7_threat_command/index.asciidoc">edit</a></div>
<p>Retrieves CVEs (Common Vulnerabilities and Exposures) over time.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Example</strong></span></summary>
<div class="content">
<p>An example event for <code class="literal">vulnerability</code> looks as following:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
    "@timestamp": "2020-08-24T21:46:48.619Z",
    "agent": {
        "ephemeral_id": "98178c63-7de1-4041-877c-bf829b4fc0d3",
        "id": "34592ccf-10ae-4d24-a28c-97be832bde99",
        "name": "docker-fleet-agent",
        "type": "filebeat",
        "version": "8.13.0"
    },
    "data_stream": {
        "dataset": "ti_rapid7_threat_command.vulnerability",
        "namespace": "ep",
        "type": "logs"
    },
    "ecs": {
        "version": "8.11.0"
    },
    "elastic_agent": {
        "id": "34592ccf-10ae-4d24-a28c-97be832bde99",
        "snapshot": false,
        "version": "8.13.0"
    },
    "event": {
        "agent_id_status": "verified",
        "category": [
            "threat",
            "vulnerability"
        ],
        "created": "2024-06-26T07:02:37.947Z",
        "dataset": "ti_rapid7_threat_command.vulnerability",
        "ingested": "2024-06-26T07:02:49Z",
        "kind": "event",
        "module": "ti_rapid7_threat_command",
        "original": "{\"cpe\":[{\"Range\":{\"VersionEndExcluding\":\"\",\"VersionEndIncluding\":\"4.0.0\",\"VersionStartExcluding\":\"\",\"VersionStartIncluding\":\"1.0.0\"},\"Title\":\"Php\",\"Value\":\"cpe:2.3:a:php:php:*:*:*:*:*:*:*:*\",\"VendorProduct\":\"php php\"}],\"cveId\":\"CVE-2020-7064\",\"cvssScore\":5.4,\"exploitAvailability\":false,\"firstMentionDate\":\"N/A\",\"intsightsScore\":16,\"lastMentionDate\":\"2020-04-01T04:15:00.000Z\",\"mentionsAmount\":0,\"mentionsPerSource\":{\"ClearWebCyberBlogs\":0,\"CodeRepositories\":0,\"DarkWeb\":0,\"Exploit\":0,\"HackingForum\":0,\"InstantMessage\":0,\"PasteSite\":0,\"SocialMedia\":0},\"publishedDate\":\"2020-04-01T04:15:00.000Z\",\"relatedCampaigns\":[\"SolarWinds\"],\"relatedMalware\":[\"doppeldridex\",\"dridex\"],\"relatedThreatActors\":[\"doppelspider\"],\"severity\":\"Low\",\"updateDate\":\"2020-08-24T21:46:48.619Z\",\"vulnerabilityOrigin\":[\"Qualys\"]}",
        "type": [
            "indicator"
        ]
    },
    "input": {
        "type": "httpjson"
    },
    "rapid7": {
        "tc": {
            "vulnerability": {
                "cpe": [
                    {
                        "range": {
                            "version": {
                                "end": {
                                    "including": "4.0.0"
                                },
                                "start": {
                                    "including": "1.0.0"
                                }
                            }
                        },
                        "title": "Php",
                        "value": "cpe:2.3:a:php:php:*:*:*:*:*:*:*:*",
                        "vendor_product": "php php"
                    }
                ],
                "cvss_score": 5.4,
                "exploit_availability": false,
                "id": "CVE-2020-7064",
                "intsights_score": 16,
                "mention": {
                    "first_date": "N/A",
                    "last_date": "2020-04-01T04:15:00.000Z"
                },
                "mentions": {
                    "source": {
                        "clear_web_cyber_blogs": 0,
                        "code_repositories": 0,
                        "dark_web": 0,
                        "exploit": 0,
                        "hacking_forum": 0,
                        "instant_message": 0,
                        "paste_site": 0,
                        "social_media": 0
                    },
                    "total": 0
                },
                "origin": [
                    "Qualys"
                ],
                "published_date": "2020-04-01T04:15:00.000Z",
                "related": {
                    "campaigns": [
                        "SolarWinds"
                    ],
                    "malware": [
                        "doppeldridex",
                        "dridex"
                    ],
                    "threat_actors": [
                        "doppelspider"
                    ]
                },
                "severity": "Low",
                "update_date": "2020-08-24T21:46:48.619Z"
            }
        }
    },
    "tags": [
        "preserve_original_event",
        "forwarded",
        "rapid7-threat-command-vulnerability"
    ],
    "vulnerability": {
        "classification": "CVSS",
        "enumeration": "CVE",
        "id": "CVE-2020-7064",
        "reference": "https://dashboard.ti.insight.rapid7.com/#/risk-analyzer/vulnerabilities?search=CVE-2020-7064",
        "scanner": {
            "vendor": "Rapid7"
        },
        "score": {
            "base": 5.4
        },
        "severity": "Low"
    }
}</pre>
</div>
</div>
</details>
<details>
<summary class="title"><span class="strong strong"><strong>Exported fields</strong></span></summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Field</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>@timestamp</p></td>
<td align="left" valign="top"><p>Event timestamp.</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cloud.image.id</p></td>
<td align="left" valign="top"><p>Image ID for the cloud instance.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.dataset</p></td>
<td align="left" valign="top"><p>Data stream dataset.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.namespace</p></td>
<td align="left" valign="top"><p>Data stream namespace.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.type</p></td>
<td align="left" valign="top"><p>Data stream type.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.containerized</p></td>
<td align="left" valign="top"><p>If the host is a container.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.build</p></td>
<td align="left" valign="top"><p>OS build information.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.codename</p></td>
<td align="left" valign="top"><p>OS codename, if any.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>input.type</p></td>
<td align="left" valign="top"><p>Input type</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>log.offset</p></td>
<td align="left" valign="top"><p>Log offset</p></td>
<td align="left" valign="top"><p>long</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.vulnerability.cpe.range.version.end.excluding</p></td>
<td align="left" valign="top"><p>The CPE version end range.</p></td>
<td align="left" valign="top"><p>version</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.vulnerability.cpe.range.version.end.including</p></td>
<td align="left" valign="top"><p>The CPE version end range.</p></td>
<td align="left" valign="top"><p>version</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.vulnerability.cpe.range.version.start.excluding</p></td>
<td align="left" valign="top"><p>The CPE version start range.</p></td>
<td align="left" valign="top"><p>version</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.vulnerability.cpe.range.version.start.including</p></td>
<td align="left" valign="top"><p>The CPE version start range.</p></td>
<td align="left" valign="top"><p>version</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.vulnerability.cpe.title</p></td>
<td align="left" valign="top"><p>Title of CPE.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.vulnerability.cpe.value</p></td>
<td align="left" valign="top"><p>Value of CPE.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.vulnerability.cpe.vendor_product</p></td>
<td align="left" valign="top"><p>Vendor and Product of CPE.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.vulnerability.cvss_score</p></td>
<td align="left" valign="top"><p>The severity score from NVD.</p></td>
<td align="left" valign="top"><p>double</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.vulnerability.exploit_availability</p></td>
<td align="left" valign="top"><p>If true, exploit is available for this CVE.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.vulnerability.id</p></td>
<td align="left" valign="top"><p>Unique ID of a CVE.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.vulnerability.intsights_score</p></td>
<td align="left" valign="top"><p>The severity score from Rapid7 Threat Command.</p></td>
<td align="left" valign="top"><p>double</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.vulnerability.mention.first_date</p></td>
<td align="left" valign="top"><p>CVE&#8217;s first mention date.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.vulnerability.mention.last_date</p></td>
<td align="left" valign="top"><p>CVE&#8217;s last mention date.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.vulnerability.mentions.source.clear_web_cyber_blogs</p></td>
<td align="left" valign="top"><p>The number of times a CVE is mentioned by ClearWebCyberBlogs.</p></td>
<td align="left" valign="top"><p>long</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.vulnerability.mentions.source.code_repositories</p></td>
<td align="left" valign="top"><p>The number of times a CVE is mentioned by CodeRepositories.</p></td>
<td align="left" valign="top"><p>long</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.vulnerability.mentions.source.dark_web</p></td>
<td align="left" valign="top"><p>The number of times a CVE is mentioned by DarkWeb.</p></td>
<td align="left" valign="top"><p>long</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.vulnerability.mentions.source.exploit</p></td>
<td align="left" valign="top"><p>The number of times a CVE is mentioned by Exploit.</p></td>
<td align="left" valign="top"><p>long</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.vulnerability.mentions.source.hacking_forum</p></td>
<td align="left" valign="top"><p>The number of times a CVE is mentioned by HackingForum.</p></td>
<td align="left" valign="top"><p>long</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.vulnerability.mentions.source.instant_message</p></td>
<td align="left" valign="top"><p>The number of times a CVE is mentioned by InstantMessage.</p></td>
<td align="left" valign="top"><p>long</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.vulnerability.mentions.source.paste_site</p></td>
<td align="left" valign="top"><p>The number of times a CVE is mentioned by PasteSite.</p></td>
<td align="left" valign="top"><p>long</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.vulnerability.mentions.source.social_media</p></td>
<td align="left" valign="top"><p>The number of times a CVE is mentioned by SocialMedia.</p></td>
<td align="left" valign="top"><p>long</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.vulnerability.mentions.total</p></td>
<td align="left" valign="top"><p>The number of times a CVE is mentioned across all sources.</p></td>
<td align="left" valign="top"><p>long</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.vulnerability.origin</p></td>
<td align="left" valign="top"><p>The origin of vulnerability.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.vulnerability.published_date</p></td>
<td align="left" valign="top"><p>CVE&#8217;s publish date in ISO 8601 format.</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.vulnerability.related.campaigns</p></td>
<td align="left" valign="top"><p>List of related threat campaigns.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.vulnerability.related.malware</p></td>
<td align="left" valign="top"><p>List of related malware.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.vulnerability.related.threat_actors</p></td>
<td align="left" valign="top"><p>List of related threat actors.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.vulnerability.severity</p></td>
<td align="left" valign="top"><p>CVE severity. Allowed values: <em>Critical</em>, <em>High</em>, <em>Medium</em>, <em>Low</em>.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>rapid7.tc.vulnerability.update_date</p></td>
<td align="left" valign="top"><p>CVE&#8217;s update date in ISO 8601 format.</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
<div class="position-relative"><h4><a id="ti_rapid7_threat_command-changelog"></a>Changelog</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/ti_rapid7_threat_command/index.asciidoc">edit</a></div>
<details>
<summary class="title"><span class="strong strong"><strong>Changelog</strong></span></summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Version</th>
<th align="left" valign="top">Details</th>
<th align="left" valign="top">Kibana version(s)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>2.0.3</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-bug"></span> <span class="strong strong"><strong>Bug fix</strong></span> (<a href="https://github.com/elastic/integrations/pull/11231" class="ulink" target="_top">View pull request</a>)<br>
Fix labels.is_ioc_transform_source values</p>
</td>
<td align="left" valign="top"><p>8.13.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>2.0.2</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-bug"></span> <span class="strong strong"><strong>Bug fix</strong></span> (<a href="https://github.com/elastic/integrations/pull/11008" class="ulink" target="_top">View pull request</a>)<br>
Add missing fields in transform</p>
</td>
<td align="left" valign="top"><p>8.13.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>2.0.1</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-bug"></span> <span class="strong strong"><strong>Bug fix</strong></span> (<a href="https://github.com/elastic/integrations/pull/10674" class="ulink" target="_top">View pull request</a>)<br>
Fix ECS date mapping on threat fields.</p>
</td>
<td align="left" valign="top"><p>8.13.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>2.0.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/9925" class="ulink" target="_top">View pull request</a>)<br>
Add support for IOC expiration</p>
</td>
<td align="left" valign="top"><p>8.13.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.17.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/10135" class="ulink" target="_top">View pull request</a>)<br>
Update the kibana constraint to ^8.13.0. Modified the field definitions to remove ECS fields made redundant by the ecs@mappings component template.</p>
</td>
<td align="left" valign="top"><p>8.13.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.16.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/9974" class="ulink" target="_top">View pull request</a>)<br>
Improve handling of empty responses.</p>
</td>
<td align="left" valign="top"><p>8.12.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.15.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/9129" class="ulink" target="_top">View pull request</a>)<br>
Set sensitive values as secret.</p>
</td>
<td align="left" valign="top"><p>8.12.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.14.1</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/8943" class="ulink" target="_top">View pull request</a>)<br>
Changed owners</p>
</td>
<td align="left" valign="top"><p>8.7.1 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.14.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/8489" class="ulink" target="_top">View pull request</a>)<br>
Limit request tracer log count to five.</p>
</td>
<td align="left" valign="top"><p>8.7.1 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.13.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/8436" class="ulink" target="_top">View pull request</a>)<br>
ECS version updated to 8.11.0.</p>
</td>
<td align="left" valign="top"><p>8.7.1 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.12.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/8269" class="ulink" target="_top">View pull request</a>)<br>
Improve <em>event.original</em> check to avoid errors if set.</p>
</td>
<td align="left" valign="top"><p>8.7.1 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.11.1</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-bug"></span> <span class="strong strong"><strong>Bug fix</strong></span> (<a href="https://github.com/elastic/integrations/pull/8268" class="ulink" target="_top">View pull request</a>)<br>
Fix required stack capabilities</p>
</td>
<td align="left" valign="top"><p>8.7.1 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.11.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/8035" class="ulink" target="_top">View pull request</a>)<br>
Set <em>partner</em> owner type.</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.10.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/7910" class="ulink" target="_top">View pull request</a>)<br>
Update format version to 3.0.0. Add owner.type to package manifest.</p>
<p><span class="eui-icon icon-bug"></span> <span class="strong strong"><strong>Bug fix</strong></span> (<a href="https://github.com/elastic/integrations/pull/7910" class="ulink" target="_top">View pull request</a>)<br>
Change the ECS event.type value from <em>info</em> to <em>indicator</em> for the vulnerability data stream.</p>
<p><span class="eui-icon icon-bug"></span> <span class="strong strong"><strong>Bug fix</strong></span> (<a href="https://github.com/elastic/integrations/pull/7910" class="ulink" target="_top">View pull request</a>)<br>
Update indicator rules with predefined indices instead of all</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.9.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/7949" class="ulink" target="_top">View pull request</a>)<br>
Update package to ECS 8.10.0 and align ECS categorization fields.</p>
</td>
<td align="left" valign="top"><p>8.7.1 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.8.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/7789" class="ulink" target="_top">View pull request</a>)<br>
Add tags.yml file so that integration&#8217;s dashboards and saved searches are tagged with "Security Solution" and displayed in the Security Solution UI.</p>
</td>
<td align="left" valign="top"><p>8.7.1 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.7.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/7575" class="ulink" target="_top">View pull request</a>)<br>
Update package-spec to 2.10.0.</p>
</td>
<td align="left" valign="top"><p>8.7.1 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.6.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/7111" class="ulink" target="_top">View pull request</a>)<br>
Update package to ECS 8.9.0.</p>
</td>
<td align="left" valign="top"><p>8.7.1 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.5.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/6885" class="ulink" target="_top">View pull request</a>)<br>
Convert visualizations to lens.</p>
</td>
<td align="left" valign="top"><p>8.7.1 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.4.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/6635" class="ulink" target="_top">View pull request</a>)<br>
Ensure event.kind is correctly set for pipeline errors.</p>
</td>
<td align="left" valign="top"><p>8.7.1 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.3.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/6328" class="ulink" target="_top">View pull request</a>)<br>
Update package to ECS 8.8.0.</p>
</td>
<td align="left" valign="top"><p>8.7.1 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.2.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/6115" class="ulink" target="_top">View pull request</a>)<br>
Add a new flag to enable request tracing</p>
</td>
<td align="left" valign="top"><p>8.7.1 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.1.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/5765" class="ulink" target="_top">View pull request</a>)<br>
Update package to ECS 8.7.0.</p>
</td>
<td align="left" valign="top"><p>8.4.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>1.0.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/5677" class="ulink" target="_top">View pull request</a>)<br>
Release Rapid7 Threat Command as GA.</p>
</td>
<td align="left" valign="top"><p>8.4.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.1.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/4904" class="ulink" target="_top">View pull request</a>)<br>
Initial draft for Rapid7 Threat Command integration along with "IOC", "Alert" and "Vulnerability" data stream and detection rule to correlate IOCs and Vulnerabilities against the user data.</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="rapid7_insightvm.html">« Rapid7 InsightVM</a>
</span>
<span class="next">
<a href="redis-intro.html">Redis »</a>
</span>
</div>
</body>
</html>
