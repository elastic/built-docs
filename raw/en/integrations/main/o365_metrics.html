<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Microsoft Office 365 Metrics Integration | Elastic integrations | Elastic</title>
<meta class="elastic" name="content" content="Microsoft Office 365 Metrics Integration | Elastic integrations">

<link rel="home" href="index.html" title="Elastic integrations"/>
<link rel="up" href="microsoft-intro.html" title="Microsoft"/>
<link rel="prev" href="m365_defender.html" title="M365 Defender integration"/>
<link rel="next" href="microsoft_sentinel.html" title="Microsoft Sentinel"/>
<meta class="elastic" name="product_version" content="main"/>
<meta class="elastic" name="product_name" content="Integrations"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Integrations/Reference"/>
<meta name="DC.subject" content="Integrations"/>
<meta name="DC.identifier" content="main"/>
</head>
<body>
<div class="navheader">
<span class="prev">
<a href="m365_defender.html">« M365 Defender integration</a>
</span>
<span class="next">
<a href="microsoft_sentinel.html">Microsoft Sentinel »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic integrations</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="microsoft-intro.html">Microsoft</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Microsoft Office 365 Metrics Integration</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/o365_metrics/index.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="o365_metrics"></a>Microsoft Office 365 Metrics Integration</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/o365_metrics/index.asciidoc">edit</a></div>
</div></div></div>

<div class="condensed-table">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<tbody>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Version</strong></span></p></td>
<td align="left" valign="top"><p>0.1.0 <span class="Admonishment Admonishment--beta">
[<span class="Admonishment-title u-mono">beta</span>]
<span class="Admonishment-detail">
This functionality is in beta and is subject to change. The design and code is less mature than official GA features and is being provided as-is with no warranties. Beta features are not subject to the support SLA of official GA features.
</span>
</span> (<a class="xref" href="o365_metrics.html#o365_metrics-changelog" title="Changelog">View all</a>)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Compatible Kibana version(s)</strong></span></p></td>
<td align="left" valign="top"><p>8.16.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Supported Serverless project types</strong></span><br>
 <a class="xref" href="serverless-support.html" title="Supported Serverless project types"><span class="small">What&#8217;s this?</span></a></p></td>
<td align="left" valign="top"><p>Security<br>
Observability</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Subscription level</strong></span><br>
<a href="/subscriptions" class="ulink" target="_top"><span class="small">What&#8217;s this?</span></a></p></td>
<td align="left" valign="top"><p>Basic</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Level of support</strong></span><br>
<a class="xref" href="support.html" title="Level of support"><span class="small">What&#8217;s this?</span></a></p></td>
<td align="left" valign="top"><p>Elastic</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>This integration uses the <a href="https://learn.microsoft.com/en-us/graph/overview" class="ulink" target="_top">Microsoft Graph API</a> to collect essential metrics from Microsoft Office 365, offering detailed insights into user activity, application usage, and overall system performance.</p>
<div class="position-relative"><h4><a id="o365_metrics-setup"></a>Setup</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/o365_metrics/index.asciidoc">edit</a></div>
<p>To use this package you need to enable datastreams you want to collect metrics for and register an application in <a href="https://www.microsoft.com/en-us/security/business/identity-access/microsoft-entra-id" class="ulink" target="_top">Microsoft Entra ID (formerly known as Azure Active Directory)</a>.</p>
<p>Once the application is registered, configure and/or note the following to setup O365 metrics Elastic integration:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Note <code class="literal">Application (client) ID</code> and the <code class="literal">Directory (tenant) ID</code> in the registered application&#8217;s <code class="literal">Overview</code> page.
</li>
<li class="listitem">
<p>Create a new secret to configure the authentication of your application.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Navigate to <code class="literal">Certificates &amp; Secrets</code> section.
</li>
<li class="listitem">
Click <code class="literal">New client secret</code> and provide some description to create new secret.
</li>
<li class="listitem">
Note the <code class="literal">Value</code> which is required for the integration setup.
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Add permissions to your registered application. Please check <a href="https://learn.microsoft.com/en-us/graph/reportroot-authorization" class="ulink" target="_top">O365 Graph API permissions</a> for more details.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Navigate to <code class="literal">API permissions</code> page and click <code class="literal">Add a permission</code>
</li>
<li class="listitem">
Select <code class="literal">Office 365 Management APIs</code> tile from the listed tiles.
</li>
<li class="listitem">
Click <code class="literal">Application permissions</code>.
</li>
<li class="listitem">
If <code class="literal">User.Read</code> permission under <code class="literal">Microsoft.Graph</code> tile is not added by default, add this permission.
</li>
<li class="listitem">
After the permissions are added, the admin has to grant consent for these permissions.
</li>
</ul>
</div>
</li>
</ol>
</div>
<p>Once the secret is created and permissions are granted by admin, setup Elastic Agent&#8217;s Microsoft O365 integration:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Click <code class="literal">Add Microsoft Office 365</code>.
</li>
<li class="listitem">
Enable <code class="literal">Collect Office 365 metrics via Graph API using CEL Input</code>.
</li>
<li class="listitem">
Add <code class="literal">Directory (tenant) ID</code> noted in Step 1 into <code class="literal">Directory (tenant) ID</code> parameter. This is required field.
</li>
<li class="listitem">
Add <code class="literal">Application (client) ID</code> noted in Step 1 into <code class="literal">Application (client) ID</code> parameter. This is required field.
</li>
<li class="listitem">
Add the secret <code class="literal">Value</code> noted in Step 2 into <code class="literal">Client Secret</code> parameter. This is required field.
</li>
<li class="listitem">
Oauth2 Token URL can be added to generate the tokens during the oauth2 flow. If not provided, above <code class="literal">Directory (tenant) ID</code> will be used for oauth2 token generation.
</li>
<li class="listitem">
Modify any other parameters as necessary.
</li>
</ul>
</div>
<div class="position-relative"><h4><a id="o365_metrics-compatibility"></a>Compatibility</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/o365_metrics/index.asciidoc">edit</a></div>
<div class="position-relative"><h4><a id="o365_metrics-metrics"></a>Metrics</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/o365_metrics/index.asciidoc">edit</a></div>
<div class="position-relative"><h5><a id="o365_metrics-outlookactivity"></a>OutlookActivity</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/o365_metrics/index.asciidoc">edit</a></div>
<p>Uses the Office 365 Management Graph API to retrieve metrics from Office 365.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Exported fields</strong></span></summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Field</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>@timestamp</p></td>
<td align="left" valign="top"><p>Event timestamp.</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cloud.image.id</p></td>
<td align="left" valign="top"><p>Image ID for the cloud instance.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.dataset</p></td>
<td align="left" valign="top"><p>Data stream dataset.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.namespace</p></td>
<td align="left" valign="top"><p>Data stream namespace.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.type</p></td>
<td align="left" valign="top"><p>Data stream type.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.containerized</p></td>
<td align="left" valign="top"><p>If the host is a container.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.build</p></td>
<td align="left" valign="top"><p>OS build information.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.codename</p></td>
<td align="left" valign="top"><p>OS codename, if any.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.outlook.activity.emails_read.count</p></td>
<td align="left" valign="top"><p>The count of email messages read by users during the reporting period.</p></td>
<td align="left" valign="top"><p>integer</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.outlook.activity.emails_received.count</p></td>
<td align="left" valign="top"><p>The count of email messages received by users during the reporting period.</p></td>
<td align="left" valign="top"><p>integer</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.outlook.activity.emails_sent.count</p></td>
<td align="left" valign="top"><p>The count of email messages sent by users during the reporting period.</p></td>
<td align="left" valign="top"><p>integer</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.outlook.activity.meeting_created.count</p></td>
<td align="left" valign="top"><p>The count of calendar meetings created by users during the reporting period.</p></td>
<td align="left" valign="top"><p>integer</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.outlook.activity.meeting_interacted.count</p></td>
<td align="left" valign="top"><p>The count of meetings where users interacted (e.g., accepted, declined, or modified) during the reporting period.</p></td>
<td align="left" valign="top"><p>integer</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.outlook.activity.report_date</p></td>
<td align="left" valign="top"><p>The specific date for which the report data applies.</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.outlook.activity.report_period</p></td>
<td align="left" valign="top"><p>The duration (e.g., 7 days) over which the quota status data is aggregated.</p></td>
<td align="left" valign="top"><p>integer</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.outlook.activity.report_refresh_date</p></td>
<td align="left" valign="top"><p>The date when the report data was last updated.</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
<div class="position-relative"><h4><a id="o365_metrics-changelog"></a>Changelog</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/o365_metrics/index.asciidoc">edit</a></div>
<details>
<summary class="title"><span class="strong strong"><strong>Changelog</strong></span></summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Version</th>
<th align="left" valign="top">Details</th>
<th align="left" valign="top">Kibana version(s)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.1.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/11937" class="ulink" target="_top">View pull request</a>)<br>
Initial draft of the o365_metrics package with the <code class="literal">outlook_activity</code> data stream.</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="m365_defender.html">« M365 Defender integration</a>
</span>
<span class="next">
<a href="microsoft_sentinel.html">Microsoft Sentinel »</a>
</span>
</div>
</body>
</html>
