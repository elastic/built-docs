<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Microsoft Office 365 Metrics Integration | Elastic integrations | Elastic</title>
<meta class="elastic" name="content" content="Microsoft Office 365 Metrics Integration | Elastic integrations">

<link rel="home" href="index.html" title="Elastic integrations"/>
<link rel="up" href="microsoft-intro.html" title="Microsoft"/>
<link rel="prev" href="m365_defender.html" title="M365 Defender integration"/>
<link rel="next" href="microsoft_sentinel.html" title="Microsoft Sentinel"/>
<meta class="elastic" name="product_version" content="main"/>
<meta class="elastic" name="product_name" content="Integrations"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Integrations/Reference"/>
<meta name="DC.subject" content="Integrations"/>
<meta name="DC.identifier" content="main"/>
</head>
<body>
<div class="navheader">
<span class="prev">
<a href="m365_defender.html">« M365 Defender integration</a>
</span>
<span class="next">
<a href="microsoft_sentinel.html">Microsoft Sentinel »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic integrations</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="microsoft-intro.html">Microsoft</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Microsoft Office 365 Metrics Integration</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/o365_metrics/index.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="o365_metrics"></a>Microsoft Office 365 Metrics Integration</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/o365_metrics/index.asciidoc">edit</a></div>
</div></div></div>

<div class="condensed-table">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<tbody>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Version</strong></span></p></td>
<td align="left" valign="top"><p>0.11.0 <span class="Admonishment Admonishment--beta">
[<span class="Admonishment-title u-mono">beta</span>]
<span class="Admonishment-detail">
This functionality is in beta and is subject to change. The design and code is less mature than official GA features and is being provided as-is with no warranties. Beta features are not subject to the support SLA of official GA features.
</span>
</span> (<a class="xref" href="o365_metrics.html#o365_metrics-changelog" title="Changelog">View all</a>)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Compatible Kibana version(s)</strong></span></p></td>
<td align="left" valign="top"><p>8.16.0 or higher<br>
9.0.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Supported Serverless project types</strong></span><br>
 <a class="xref" href="serverless-support.html" title="Supported Serverless project types"><span class="small">What&#8217;s this?</span></a></p></td>
<td align="left" valign="top"><p>Security<br>
Observability</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Subscription level</strong></span><br>
<a href="/subscriptions" class="ulink" target="_top"><span class="small">What&#8217;s this?</span></a></p></td>
<td align="left" valign="top"><p>Basic</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Level of support</strong></span><br>
<a class="xref" href="support.html" title="Level of support"><span class="small">What&#8217;s this?</span></a></p></td>
<td align="left" valign="top"><p>Elastic</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>This integration uses the <a href="https://learn.microsoft.com/en-us/graph/overview" class="ulink" target="_top">Microsoft Graph API</a> to collect essential metrics from Microsoft Office 365, offering detailed insights into user activity, application usage, and overall system performance.</p>
<div class="position-relative"><h4><a id="o365_metrics-data-streams"></a>Data streams</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/o365_metrics/index.asciidoc">edit</a></div>
<p>Following Microsoft 365 Graph Reports can be collected by Microsoft Office 365 Metrics integration.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
<col class="col_5"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Report</th>
<th align="left" valign="top">API</th>
<th align="left" valign="top">Data-stream Name</th>
<th align="left" valign="top">Aggregation Level</th>
<th align="left" valign="top">Required permissions</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><a href="https://learn.microsoft.com/en-us/microsoft-365/admin/activity-reports/active-users-ww?view=o365-worldwide" class="ulink" target="_top">Microsoft 365 Active Users Service User Counts</a></p></td>
<td align="left" valign="top"><p><a href="https://learn.microsoft.com/en-us/graph/api/reportroot-getoffice365servicesusercounts?view=graph-rest-1.0&amp;tabs=http" class="ulink" target="_top">reportRoot: getOffice365ServicesUserCounts</a></p></td>
<td align="left" valign="top"><p>Microsoft 365 Active Users metrics</p></td>
<td align="left" valign="top"><p><code class="literal">Period</code>-based</p></td>
<td align="left" valign="top"><p>Reports.Read.All</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a href="https://learn.microsoft.com/en-us/microsoft-365/admin/activity-reports/office-365-groups-ww?view=o365-worldwide" class="ulink" target="_top">Microsoft 365 Groups Activity Group Detail</a></p></td>
<td align="left" valign="top"><p><a href="https://learn.microsoft.com/en-us/graph/api/reportroot-getoffice365groupsactivitydetail?view=graph-rest-1.0&amp;tabs=http" class="ulink" target="_top">reportRoot: getOffice365GroupsActivityDetail</a></p></td>
<td align="left" valign="top"><p>Microsoft 365 Groups Activity Group Detail</p></td>
<td align="left" valign="top"><p><code class="literal">Day</code>-based</p></td>
<td align="left" valign="top"><p>Reports.Read.All</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a href="https://learn.microsoft.com/en-us/microsoft-365/admin/activity-reports/onedrive-for-business-usage-ww?view=o365-worldwide" class="ulink" target="_top">OneDrive Usage Account Detail</a></p></td>
<td align="left" valign="top"><p><a href="https://learn.microsoft.com/en-us/graph/api/reportroot-getonedriveusageaccountdetail?view=graph-rest-1.0&amp;tabs=http" class="ulink" target="_top">reportRoot: getOneDriveUsageAccountDetail</a></p></td>
<td align="left" valign="top"><p>Microsoft 365 OneDrive Usage Account Detail</p></td>
<td align="left" valign="top"><p><code class="literal">Day</code>-based</p></td>
<td align="left" valign="top"><p>Reports.Read.All</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a href="https://learn.microsoft.com/en-us/microsoft-365/admin/activity-reports/onedrive-for-business-usage-ww?view=o365-worldwide" class="ulink" target="_top">OneDrive Usage Account Counts</a></p></td>
<td align="left" valign="top"><p><a href="https://learn.microsoft.com/en-us/graph/api/reportroot-getonedriveusageaccountcounts?view=graph-rest-1.0&amp;tabs=http" class="ulink" target="_top">reportRoot: getOneDriveUsageAccountCounts</a></p></td>
<td align="left" valign="top"><p>Microsoft 365 One Drive Usage metrics</p></td>
<td align="left" valign="top"><p><code class="literal">Period</code>-based</p></td>
<td align="left" valign="top"><p>Reports.Read.All</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a href="https://learn.microsoft.com/en-us/microsoft-365/admin/activity-reports/onedrive-for-business-usage-ww?view=o365-worldwide" class="ulink" target="_top">OneDrive Usage File Counts</a></p></td>
<td align="left" valign="top"><p><a href="https://learn.microsoft.com/en-us/graph/api/reportroot-getonedriveusagefilecounts?view=graph-rest-1.0&amp;tabs=http" class="ulink" target="_top">reportRoot: getOneDriveUsageFileCounts</a></p></td>
<td align="left" valign="top"><p>Microsoft 365 One Drive Usage metrics</p></td>
<td align="left" valign="top"><p><code class="literal">Period</code>-based</p></td>
<td align="left" valign="top"><p>Reports.Read.All</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a href="https://learn.microsoft.com/en-us/microsoft-365/admin/activity-reports/onedrive-for-business-usage-ww?view=o365-worldwide" class="ulink" target="_top">OneDrive Usage Storage</a></p></td>
<td align="left" valign="top"><p><a href="https://learn.microsoft.com/en-us/graph/api/reportroot-getonedriveusagestorage?view=graph-rest-1.0&amp;tabs=http" class="ulink" target="_top">reportRoot: getOneDriveUsageStorage</a></p></td>
<td align="left" valign="top"><p>Microsoft 365 One Drive Usage metrics</p></td>
<td align="left" valign="top"><p><code class="literal">Period</code>-based</p></td>
<td align="left" valign="top"><p>Reports.Read.All</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a href="https://learn.microsoft.com/en-us/microsoft-365/admin/activity-reports/email-activity-ww?view=o365-worldwide" class="ulink" target="_top">Outlook Activity Counts</a></p></td>
<td align="left" valign="top"><p><a href="https://learn.microsoft.com/en-us/graph/api/reportroot-getemailactivitycounts?view=graph-rest-1.0&amp;tabs=http" class="ulink" target="_top">reportRoot: getEmailActivityCounts</a></p></td>
<td align="left" valign="top"><p>Microsoft 365 Outlook Activity metrics</p></td>
<td align="left" valign="top"><p><code class="literal">Period</code>-based</p></td>
<td align="left" valign="top"><p>Reports.Read.All</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a href="https://learn.microsoft.com/en-us/microsoft-365/admin/activity-reports/email-apps-usage-ww?view=o365-worldwide" class="ulink" target="_top">Outlook App Usage Version Counts</a></p></td>
<td align="left" valign="top"><p><a href="https://learn.microsoft.com/en-us/graph/api/reportroot-getemailappusageversionsusercounts?view=graph-rest-1.0&amp;tabs=http" class="ulink" target="_top">reportRoot: getEmailAppUsageVersionsUserCounts</a></p></td>
<td align="left" valign="top"><p>Microsoft 365 Outlook App Usage Version Counts metrics</p></td>
<td align="left" valign="top"><p><code class="literal">Period</code>-based</p></td>
<td align="left" valign="top"><p>Reports.Read.All</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a href="https://learn.microsoft.com/en-us/microsoft-365/admin/activity-reports/mailbox-usage?view=o365-worldwide" class="ulink" target="_top">Outlook Mailbox Usage Quota Status Mailbox Counts</a></p></td>
<td align="left" valign="top"><p><a href="https://learn.microsoft.com/en-us/graph/api/reportroot-getmailboxusagequotastatusmailboxcounts?view=graph-rest-1.0&amp;tabs=http" class="ulink" target="_top">reportRoot: getMailboxUsageQuotaStatusMailboxCounts</a></p></td>
<td align="left" valign="top"><p>Microsoft 365 mailbox usage quota status metrics</p></td>
<td align="left" valign="top"><p><code class="literal">Period</code>-based</p></td>
<td align="left" valign="top"><p>Reports.Read.All</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a href="https://learn.microsoft.com/en-us/microsoft-365/admin/activity-reports/mailbox-usage?view=o365-worldwide" class="ulink" target="_top">Outlook Mailbox Usage Detail</a></p></td>
<td align="left" valign="top"><p><a href="https://learn.microsoft.com/en-us/graph/api/reportroot-getmailboxusagedetail?view=graph-rest-1.0&amp;tabs=http" class="ulink" target="_top">reportRoot: getMailboxUsageDetail</a></p></td>
<td align="left" valign="top"><p>Microsoft 365 mailbox usage detail metrics</p></td>
<td align="left" valign="top"><p><code class="literal">Period</code>-based</p></td>
<td align="left" valign="top"><p>Reports.Read.All</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a href="https://learn.microsoft.com/en-us/microsoft-365/admin/activity-reports/sharepoint-site-usage-ww?view=o365-worldwide" class="ulink" target="_top">SharePoint Site Usage Storage</a></p></td>
<td align="left" valign="top"><p><a href="https://learn.microsoft.com/en-us/graph/api/reportroot-getsharepointsiteusagestorage?view=graph-rest-1.0&amp;tabs=http" class="ulink" target="_top">reportRoot: getSharePointSiteUsageStorage</a></p></td>
<td align="left" valign="top"><p>Microsoft 365 Sharepoint Site Usage metrics</p></td>
<td align="left" valign="top"><p><code class="literal">Period</code>-based</p></td>
<td align="left" valign="top"><p>Reports.Read.All</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a href="https://learn.microsoft.com/en-us/microsoft-365/admin/activity-reports/sharepoint-site-usage-ww?view=o365-worldwide" class="ulink" target="_top">SharePoint Site Usage Detail</a></p></td>
<td align="left" valign="top"><p><a href="https://learn.microsoft.com/en-us/graph/api/reportroot-getsharepointsiteusagedetail?view=graph-rest-1.0&amp;tabs=http" class="ulink" target="_top">reportRoot: getSharePointSiteUsageDetail</a></p></td>
<td align="left" valign="top"><p>Microsoft 365 Sharepoint Site Usage metrics</p></td>
<td align="left" valign="top"><p><code class="literal">Period</code>-based</p></td>
<td align="left" valign="top"><p>Reports.Read.All</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a href="https://learn.microsoft.com/en-us/microsoft-365/admin/activity-reports/microsoft-teams-device-usage-preview?view=o365-worldwide" class="ulink" target="_top">Teams Device Usage User Counts</a></p></td>
<td align="left" valign="top"><p><a href="https://learn.microsoft.com/en-us/graph/api/reportroot-getteamsdeviceusageusercounts?view=graph-rest-1.0&amp;tabs=http" class="ulink" target="_top">reportRoot: getTeamsDeviceUsageUserCounts</a></p></td>
<td align="left" valign="top"><p>Microsoft 365 Teams Device Usage User Counts metrics</p></td>
<td align="left" valign="top"><p><code class="literal">Period</code>-based</p></td>
<td align="left" valign="top"><p>Reports.Read.All</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a href="https://learn.microsoft.com/en-us/microsoft-365/admin/activity-reports/microsoft-teams-user-activity-preview?view=o365-worldwide" class="ulink" target="_top">Teams User Activity User Counts</a></p></td>
<td align="left" valign="top"><p><a href="https://learn.microsoft.com/en-us/graph/api/reportroot-getteamsuseractivityusercounts?view=graph-rest-1.0&amp;tabs=http" class="ulink" target="_top">reportRoot: getTeamsUserActivityUserCounts</a></p></td>
<td align="left" valign="top"><p>Microsoft 365 Teams User Activity User Counts metrics</p></td>
<td align="left" valign="top"><p><code class="literal">Period</code>-based</p></td>
<td align="left" valign="top"><p>Reports.Read.All</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a href="https://learn.microsoft.com/en-us/microsoft-365/admin/activity-reports/microsoft-teams-user-activity-preview?view=o365-worldwide" class="ulink" target="_top">Teams User Activity User Detail</a></p></td>
<td align="left" valign="top"><p><a href="https://learn.microsoft.com/en-us/graph/api/reportroot-getteamsuseractivityuserdetail?view=graph-rest-1.0&amp;tabs=http" class="ulink" target="_top">reportRoot: getTeamsUserActivityUserDetail</a></p></td>
<td align="left" valign="top"><p>Microsoft 365 Teams User Activity User Detail</p></td>
<td align="left" valign="top"><p><code class="literal">Day</code>-based</p></td>
<td align="left" valign="top"><p>Reports.Read.All</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a href="https://learn.microsoft.com/en-us/microsoft-365/admin/activity-reports/viva-engage-groups-activity-report-ww?view=o365-worldwide" class="ulink" target="_top">Viva Engage Groups Activity Group Detail</a></p></td>
<td align="left" valign="top"><p><a href="https://learn.microsoft.com/en-us/graph/api/reportroot-getyammergroupsactivitydetail?view=graph-rest-1.0&amp;tabs=http" class="ulink" target="_top">reportRoot: getYammerGroupsActivityDetail</a></p></td>
<td align="left" valign="top"><p>Microsoft 365 Viva Engage Groups Activity</p></td>
<td align="left" valign="top"><p><code class="literal">Day</code>-based</p></td>
<td align="left" valign="top"><p>Reports.Read.All</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a href="https://learn.microsoft.com/en-us/microsoft-365/admin/activity-reports/viva-engage-device-usage-report-ww?view=o365-worldwide" class="ulink" target="_top">Viva Engage Device Usage User Counts</a></p></td>
<td align="left" valign="top"><p><a href="https://learn.microsoft.com/en-us/graph/api/reportroot-getyammerdeviceusageusercounts?view=graph-rest-1.0&amp;tabs=http" class="ulink" target="_top">reportRoot: getYammerDeviceUsageUserCounts</a></p></td>
<td align="left" valign="top"><p>Microsoft 365 Viva Engage Device Usage User Counts metrics</p></td>
<td align="left" valign="top"><p><code class="literal">Period</code>-based</p></td>
<td align="left" valign="top"><p>Reports.Read.All</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a href="https://learn.microsoft.com/en-us/graph/service-communications-concept-overview?view=o365-worldwide" class="ulink" target="_top">Service Health</a></p></td>
<td align="left" valign="top"><p><a href="https://learn.microsoft.com/en-us/graph/api/servicehealth-get?view=graph-rest-1.0&amp;tabs=http" class="ulink" target="_top">reportRoot: getServiceHealth</a></p></td>
<td align="left" valign="top"><p>Microsoft 365 Service Health metrics</p></td>
<td align="left" valign="top"><p>No aggregation</p></td>
<td align="left" valign="top"><p>ServiceHealth.Read.All</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a href="https://learn.microsoft.com/en-us/graph/api/resources/subscribedsku?view=graph-rest-1.0?view=o365-worldwide" class="ulink" target="_top">Subscriptions</a></p></td>
<td align="left" valign="top"><p><a href="https://learn.microsoft.com/en-us/graph/api/resources/subscribedsku?view=graph-rest-1.0" class="ulink" target="_top">subscribedSkus</a>, <a href="https://learn.microsoft.com/en-us/graph/api/resources/companysubscription?view=graph-rest-1.0" class="ulink" target="_top">subscriptions</a></p></td>
<td align="left" valign="top"><p>Microsoft 365 Subscriptions metrics</p></td>
<td align="left" valign="top"><p>No aggregation</p></td>
<td align="left" valign="top"><p>LicenseAssignment.Read.All</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a href="https://learn.microsoft.com/en-us/graph/api/resources/communications-api-overview?view=graph-rest-1.0?view=o365-worldwide" class="ulink" target="_top">Teamms Call Quality</a></p></td>
<td align="left" valign="top"><p><a href="https://learn.microsoft.com/en-us/graph/api/callrecords-callrecord-list-sessions?view=graph-rest-1.0&amp;tabs=http" class="ulink" target="_top">reportRoot: callRecords</a></p></td>
<td align="left" valign="top"><p>Microsoft 365 Teams Call Quality metrics</p></td>
<td align="left" valign="top"><p>No aggregation</p></td>
<td align="left" valign="top"><p>CallRecords.Read.All</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Tenant Settings</p></td>
<td align="left" valign="top"><p><a href="https://learn.microsoft.com/en-us/graph/api/resources/organization?view=graph-rest-1.0" class="ulink" target="_top">organization</a>, <a href="https://learn.microsoft.com/en-us/graph/api/resources/adminreportsettings?view=graph-rest-1.0" class="ulink" target="_top">adminReportSettings</a></p></td>
<td align="left" valign="top"><p>Microsoft 365 Tenant Settings</p></td>
<td align="left" valign="top"><p>No aggregation</p></td>
<td align="left" valign="top"><p>Organization.Read.All, ReportSettings.Read.All, Directory.Read.All</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a href="https://learn.microsoft.com/en-us/graph/api/resources/application?view=graph-rest-1.0" class="ulink" target="_top">App Registrations</a></p></td>
<td align="left" valign="top"><p><a href="https://learn.microsoft.com/en-us/graph/api/application-list?view=graph-rest-1.0&amp;tabs=http" class="ulink" target="_top">List Applications</a></p></td>
<td align="left" valign="top"><p>Microsoft 365 App Registrations</p></td>
<td align="left" valign="top"><p>No aggregation</p></td>
<td align="left" valign="top"><p>Application.Read.All, User.Read(delegated)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a href="https://learn.microsoft.com/en-us/graph/api/organization-list?view=graph-rest-1.0&amp;tabs=http" class="ulink" target="_top">Entra Features</a></p></td>
<td align="left" valign="top"><p><a href="https://learn.microsoft.com/en-us/graph/api/organization-list?view=graph-rest-1.0&amp;tabs=http" class="ulink" target="_top">Organization</a>, <a href="https://graph.microsoft.com/v1.0/directory/onPremisesSynchronization" class="ulink" target="_top">PremisesSync</a></p></td>
<td align="left" valign="top"><p>Microsoft 365 Entra Connect</p></td>
<td align="left" valign="top"><p>No aggregation</p></td>
<td align="left" valign="top"><p>Organization.Read.All, User.Read(delegated)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Entra ID users</p></td>
<td align="left" valign="top"><p><a href="https://learn.microsoft.com/en-us/graph/api/resources/user?view=graph-rest-1.0" class="ulink" target="_top">user</a>, <a href="https://learn.microsoft.com/en-us/graph/api/resources/riskdetection?view=graph-rest-1.0" class="ulink" target="_top">riskDetection</a></p></td>
<td align="left" valign="top"><p>Microsoft 365 Entra Connect User metrics</p></td>
<td align="left" valign="top"><p>No aggregation</p></td>
<td align="left" valign="top"><p>User.Read.All, IdentityRiskEvent.Read.All</p></td>
</tr>
</tbody>
</table>
</div>
<div class="position-relative"><h4><a id="o365_metrics-setup"></a>Setup</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/o365_metrics/index.asciidoc">edit</a></div>
<p>To use this package you need to enable datastreams you want to collect metrics for and register an application in <a href="https://www.microsoft.com/en-us/security/business/identity-access/microsoft-entra-id" class="ulink" target="_top">Microsoft Entra ID (formerly known as Azure Active Directory)</a>.</p>
<p>Once the application is registered, configure and/or note the following to setup O365 metrics Elastic integration:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Note <code class="literal">Application (client) ID</code> and the <code class="literal">Directory (tenant) ID</code> in the registered application&#8217;s <code class="literal">Overview</code> page.
</li>
<li class="listitem">
<p>Create a new secret to configure the authentication of your application.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Navigate to <code class="literal">Certificates &amp; Secrets</code> section.
</li>
<li class="listitem">
Click <code class="literal">New client secret</code> and provide some description to create new secret.
</li>
<li class="listitem">
Note the <code class="literal">Value</code> which is required for the integration setup.
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Add permissions to your registered application.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Select and add the appropriate permissions from the available tiles.
</li>
<li class="listitem">
For this package, we primarily use Graph APIs, so you can choose <code class="literal">Microsoft Graph</code>, which will display the Delegated and Application permission sections.
</li>
<li class="listitem">
Refer to the <code class="literal">Required Permissions</code> column in the table under <a class="xref" href="o365_metrics.html#o365_metrics-data-streams" title="Data streams">Data streams</a> section to identify the permissions required for each data stream and select accordingly. You can also refer to the Permissions section in the API documentation for each data stream to determine the necessary permissions.
</li>
<li class="listitem">
Ensure Reports.Read.All from Microsoft Graph is added, as most APIs are report-based.
</li>
<li class="listitem">
After the permissions are added, the admin will need to grant consent for a few permissions.
</li>
</ul>
</div>
</li>
</ol>
</div>
<p>Once the secret is created and permissions are granted by admin, setup Elastic Agent&#8217;s Microsoft O365 integration:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Click <code class="literal">Add Microsoft Office 365</code>.
</li>
<li class="listitem">
Enable <code class="literal">Collect Office 365 metrics via Graph API using CEL Input</code>.
</li>
<li class="listitem">
Add <code class="literal">Directory (tenant) ID</code> noted in Step 1 into <code class="literal">Directory (tenant) ID</code> parameter. This is required field.
</li>
<li class="listitem">
Add <code class="literal">Application (client) ID</code> noted in Step 1 into <code class="literal">Application (client) ID</code> parameter. This is required field.
</li>
<li class="listitem">
Add the secret <code class="literal">Value</code> noted in Step 2 into <code class="literal">Client Secret</code> parameter. This is required field.
</li>
<li class="listitem">
Oauth2 Token URL can be added to generate the tokens during the oauth2 flow. If not provided, above <code class="literal">Directory (tenant) ID</code> will be used for oauth2 token generation.
</li>
<li class="listitem">
Modify any other parameters as necessary.
</li>
</ul>
</div>
<div class="position-relative"><h5><a id="o365_metrics-period-based-vs-day-based-data-streams"></a>Period-based vs Day-based data-streams</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/o365_metrics/index.asciidoc">edit</a></div>
<p>Some data-streams listed earlier ingest data aggregated by a <code class="literal">period</code>, while other data-streams ingest data aggregated by <code class="literal">day</code> i.e., aggregated daily.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
When configuring <code class="literal">Period-based</code> data-streams, the configuration option <code class="literal">Period</code> must be used during setup. The supported values are: D7, D30, D90, and D180.
</li>
<li class="listitem">
As <code class="literal">Day-based</code> data-streams ingest aggregated data per day, the configuration option <code class="literal">Initial Interval</code> must be set which indicates how far back (in number of days) to fetch the data. Values between 1-28 are allowed.
</li>
</ul>
</div>
<div class="position-relative"><h5><a id="o365_metrics-additional-information-on-day-based-data-streams"></a>Additional Information on Day-based data-streams</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/o365_metrics/index.asciidoc">edit</a></div>
<p>Microsoft 365 reports are typically available within <a href="https://learn.microsoft.com/en-us/microsoft-365/admin/activity-reports/activity-reports?view=o365-worldwide" class="ulink" target="_top">48 hours</a>, but may sometimes take several days. As per their <a href="https://learn.microsoft.com/en-us/microsoft-365/admin/activity-reports/microsoft-teams-user-activity-preview?view=o365-worldwide#interpret-the-microsoft-teams-user-activity-report" class="ulink" target="_top">documentation</a>, data quality is ensured by performing daily validation checks to fill any gaps in data. During this process, users may notice differences in historical data in Microsoft 365 Reports in admin center.</p>
<p>To ensure these filled gaps and historical data-accuracy is also ingested into Elastic, the Microsoft Office 365 Metrics integration enables you to adjust <code class="literal">Sync Days in the past</code> parameter for <code class="literal">Day-based</code> data-streams. You can use this parameter to re-fetch the Microsoft 365 reports starting from <em>N</em> days in the past. Default value for this paramater is <code class="literal">3</code>. You can gradually increase this value if you see any discrepancies between Microsoft Reports and Elastic data (maximum value allowed is <code class="literal">28</code>).</p>
<p>Due to this re-fetching of data on same dates and the way Elastic data-streams work in <a href="/guide/en/elasticsearch/reference/current/data-streams.html" class="ulink" target="_top">append-only</a> design, the ingested data may have duplicates. For example, you may see duplicate documents in Elastic on the source data-stream backed indices per resource (user/group/site) per report date. To maintain only the latest copy of document, the Microsoft Office 365 Metrics integration installs <a href="/guide/en/elasticsearch/reference/current/transform-overview.html#latest-transform-overview" class="ulink" target="_top">Latest Transforms</a>, one per report. These latest transform periodically pulls the data from source data-stream backed indices into a destination non-data-stream backed index. Hence the destination indices only contains single (latest) document per resource (user/group/site) per report date. Inside the reports dataset, you can distinguish between source and destination indices using the field <code class="literal">labels.is_transform_source</code>. This is set to <code class="literal">true</code> for source data-stream backed indices and <code class="literal">false</code> for destination (latest) indices.</p>
<p>Thus when searching for data, you should use a filter <code class="literal">labels.is_transform_source: false</code> to avoid seeing any duplicates. The Microsoft Office 365 Metrics integration dashboards also has this filter to only show the latest datapoints.</p>
<p>As the latest data is available in destination indices, the source data-stream backed indices are purged based on ILM policy <code class="literal">metrics-o365_metrics.&lt;data_stream&gt;-default_policy</code>.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
<col class="col_5"/>
<col class="col_6"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">o365.metrics.report.name</th>
<th align="left" valign="top">Source filter</th>
<th align="left" valign="top">Source indices</th>
<th align="left" valign="top">Destination filter</th>
<th align="left" valign="top">Destination indices</th>
<th align="left" valign="top">Destination alias</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>Microsoft 365 Groups Activity Group Detail</p></td>
<td align="left" valign="top"><p><code class="literal">labels.is_transform_source: true</code></p></td>
<td align="left" valign="top"><p><code class="literal">metrics-o365_metrics.groups_activity_group_detail-*</code></p></td>
<td align="left" valign="top"><p><code class="literal">labels.is_transform_source: false</code></p></td>
<td align="left" valign="top"><p><code class="literal">metrics-o365_metrics.groups_activity_group_detail_latest-*</code></p></td>
<td align="left" valign="top"><p><code class="literal">metrics-o365_metrics.groups_activity_group_detail_latest</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>OneDrive Usage Account Detail</p></td>
<td align="left" valign="top"><p><code class="literal">labels.is_transform_source: true</code></p></td>
<td align="left" valign="top"><p><code class="literal">metrics-o365_metrics.onedrive_usage_account_detail-*</code></p></td>
<td align="left" valign="top"><p><code class="literal">labels.is_transform_source: false</code></p></td>
<td align="left" valign="top"><p><code class="literal">metrics-o365_metrics.onedrive_usage_account_detail_latest-*</code></p></td>
<td align="left" valign="top"><p><code class="literal">metrics-o365_metrics.onedrive_usage_account_detail_latest</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Teams User Activity User Detail</p></td>
<td align="left" valign="top"><p><code class="literal">labels.is_transform_source: true</code></p></td>
<td align="left" valign="top"><p><code class="literal">metrics-o365_metrics.teams_user_activity_user_detail-*</code></p></td>
<td align="left" valign="top"><p><code class="literal">labels.is_transform_source: false</code></p></td>
<td align="left" valign="top"><p><code class="literal">metrics-o365_metrics.teams_user_activity_user_detail_latest-*</code></p></td>
<td align="left" valign="top"><p><code class="literal">metrics-o365_metrics.teams_user_activity_user_detail_latest</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Viva Engage Groups Activity Group Detail</p></td>
<td align="left" valign="top"><p><code class="literal">labels.is_transform_source: true</code></p></td>
<td align="left" valign="top"><p><code class="literal">metrics-o365_metrics.viva_engage_groups_activity_group_detail-*</code></p></td>
<td align="left" valign="top"><p><code class="literal">labels.is_transform_source: false</code></p></td>
<td align="left" valign="top"><p><code class="literal">metrics-o365_metrics.viva_engage_groups_activity_group_detail_latest-*</code></p></td>
<td align="left" valign="top"><p><code class="literal">metrics-o365_metrics.viva_engage_groups_activity_group_detail_latest</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p><code class="literal">Sync Days in the past</code> and <code class="literal">Latest Transforms</code> are only used in <code class="literal">Day</code>-based data-streams, i.e., for data-streams aggregated per day.</p>
</div>
</div>
<div class="position-relative"><h5><a id="o365_metrics-data-anonymization"></a>Data Anonymization</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/o365_metrics/index.asciidoc">edit</a></div>
<p>By default for all Microsoft 365 usage reports, the user names, emails, group, or site information are anonymized by Microsoft using MD5 hashes. You can revert this change for a tenant and show identifiable user, group, and site information if your organization&#8217;s privacy practices allow it. To do this, follow below steps:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Login to <a href="https://admin.microsoft.com/" class="ulink" target="_top">Microsoft 365 admin center</a>
</li>
<li class="listitem">
Navigate to <code class="literal">Settings</code> -&#8594; <code class="literal">Org Settings</code> -&#8594; <code class="literal">Services</code> page.
</li>
<li class="listitem">
Select <code class="literal">Reports</code>
</li>
<li class="listitem">
Uncheck the statement <code class="literal">Display concealed user, group, and site names in all reports</code>, and then save your changes.
</li>
</ol>
</div>
<div class="position-relative"><h4><a id="o365_metrics-metrics"></a>Metrics</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/o365_metrics/index.asciidoc">edit</a></div>
<p>Uses the Microsoft 365 Graph API to retrieve metrics from Microsoft 365.</p>
<div class="position-relative"><h5><a id="o365_metrics-active-users-services-user-count"></a>Active Users Services User Count</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/o365_metrics/index.asciidoc">edit</a></div>
<p>Get details about Active Users Services User Count from <a href="https://learn.microsoft.com/en-us/graph/api/reportroot-getoffice365servicesusercounts?view=graph-rest-1.0&amp;tabs=http" class="ulink" target="_top">Microsoft Graph API</a>.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Example</strong></span></summary>
<div class="content">
<p>An example event for <code class="literal">active_users_services_user_counts</code> looks as following:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
    "o365": {
        "metrics": {
            "active": {
                "users": {
                    "services": {
                        "user": {
                            "counts": {
                                "exchange": {
                                    "active": {
                                        "count": "0"
                                    },
                                    "inactive": {
                                        "count": "22"
                                    }
                                },
                                "office365": {
                                    "active": {
                                        "count": "0"
                                    },
                                    "inactive": {
                                        "count": "25"
                                    }
                                },
                                "onedrive": {
                                    "active": {
                                        "count": "0"
                                    },
                                    "inactive": {
                                        "count": "20"
                                    }
                                },
                                "report": {
                                    "period": {
                                        "day": "7"
                                    },
                                    "refresh_date": "2024-11-29"
                                },
                                "sharepoint": {
                                    "active": {
                                        "count": "0"
                                    },
                                    "inactive": {
                                        "count": "20"
                                    }
                                },
                                "teams": {
                                    "active": {
                                        "count": "0"
                                    },
                                    "inactive": {
                                        "count": "20"
                                    }
                                },
                                "yammer": {
                                    "active": {
                                        "count": "0"
                                    },
                                    "inactive": {
                                        "count": "25"
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    },
    "agent": {
        "name": "docker-fleet-agent",
        "id": "1bd16076-38b3-44b9-980b-eab55ebe95b9",
        "ephemeral_id": "b21b52df-710e-4014-bb1c-d9e60091e1e7",
        "type": "filebeat",
        "version": "8.16.0"
    },
    "@timestamp": "2024-12-24T10:36:47.702Z",
    "ecs": {
        "version": "8.16.0"
    },
    "data_stream": {
        "namespace": "default",
        "type": "metrics",
        "dataset": "o365_metrics.active_users_services_user_counts"
    },
    "elastic_agent": {
        "id": "1bd16076-38b3-44b9-980b-eab55ebe95b9",
        "version": "8.16.0",
        "snapshot": false
    },
    "host": {
        "hostname": "docker-fleet-agent",
        "os": {
            "kernel": "5.15.153.1-microsoft-standard-WSL2",
            "codename": "noble",
            "name": "Ubuntu",
            "type": "linux",
            "family": "debian",
            "version": "24.04.1 LTS (Noble Numbat)",
            "platform": "ubuntu"
        },
        "containerized": true,
        "ip": [
            "172.18.0.7"
        ],
        "name": "docker-fleet-agent",
        "mac": [
            "02-42-AC-12-00-07"
        ],
        "architecture": "x86_64"
    },
    "event": {
        "agent_id_status": "verified",
        "ingested": "2024-12-24T10:36:57Z",
        "dataset": "o365_metrics.active_users_services_user_counts"
    },
    "tags": [
        "o365.metrics.active.users.services.user.counts",
        "preserve_original_event"
    ]
}</pre>
</div>
</div>
</details>
<p><span class="strong strong"><strong>ECS Field Reference</strong></span></p>
<p>Please refer to the following <a href="/guide/en/ecs/current/ecs-field-reference.html" class="ulink" target="_top">document</a> for detailed information on ECS fields.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Exported fields</strong></span></summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
<col class="col_5"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Field</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Unit</th>
<th align="left" valign="top">Metric Type</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>@timestamp</p></td>
<td align="left" valign="top"><p>Event timestamp.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cloud.image.id</p></td>
<td align="left" valign="top"><p>Image ID for the cloud instance.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.dataset</p></td>
<td align="left" valign="top"><p>Data stream dataset.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.namespace</p></td>
<td align="left" valign="top"><p>Data stream namespace.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.type</p></td>
<td align="left" valign="top"><p>Data stream type.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.containerized</p></td>
<td align="left" valign="top"><p>If the host is a container.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.build</p></td>
<td align="left" valign="top"><p>OS build information.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.codename</p></td>
<td align="left" valign="top"><p>OS codename, if any.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.active.users.services.user.counts.exchange.active.count</p></td>
<td align="left" valign="top"><p>Number of Exchange active users.</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.active.users.services.user.counts.exchange.inactive.count</p></td>
<td align="left" valign="top"><p>Number of Exchange inactive users.</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.active.users.services.user.counts.office365.active.count</p></td>
<td align="left" valign="top"><p>Number of Office 365 active users.</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.active.users.services.user.counts.office365.inactive.count</p></td>
<td align="left" valign="top"><p>Number of Office 365 inactive users.</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.active.users.services.user.counts.onedrive.active.count</p></td>
<td align="left" valign="top"><p>Number of OneDrive active users.</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.active.users.services.user.counts.onedrive.inactive.count</p></td>
<td align="left" valign="top"><p>Number of OneDrive inactive users.</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.active.users.services.user.counts.report.period.day</p></td>
<td align="left" valign="top"><p>The reporting period over which the data is aggregated (in days).</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p>d</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.active.users.services.user.counts.report.refresh_date</p></td>
<td align="left" valign="top"><p>The date when the report data was last updated.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.active.users.services.user.counts.sharepoint.active.count</p></td>
<td align="left" valign="top"><p>Number of SharePoint active users.</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.active.users.services.user.counts.sharepoint.inactive.count</p></td>
<td align="left" valign="top"><p>Number of SharePoint inactive users.</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.active.users.services.user.counts.teams.active.count</p></td>
<td align="left" valign="top"><p>Number of Teams active users.</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.active.users.services.user.counts.teams.inactive.count</p></td>
<td align="left" valign="top"><p>Number of Teams inactive users.</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.active.users.services.user.counts.yammer.active.count</p></td>
<td align="left" valign="top"><p>Number of Yammer active users.</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.active.users.services.user.counts.yammer.inactive.count</p></td>
<td align="left" valign="top"><p>Number of Yammer inactive users.</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
<div class="position-relative"><h5><a id="o365_metrics-entra-id-users"></a>Entra ID users</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/o365_metrics/index.asciidoc">edit</a></div>
<p>Get details about users in Microsoft Entra ID.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Example</strong></span></summary>
<div class="content">
<p>An example event for <code class="literal">entra_id_users</code> looks as following:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
    "o365": {
        "metrics": {
            "entra_id_users": {
                "on_premises_sync_enabled": true,
                "on_premises_provisioning_errors": [
                    {
                        "occurred_date_time": "2025-03-25T14:33:19Z",
                        "category": "PropertyConflict",
                        "property_causing_error": "UserPrincipalName",
                        "value": "alex@contoso.com"
                    }
                ],
                "risk": {
                    "event_type": "passwordSpray",
                    "level": "high",
                    "detail": "userPerformedSecuredPasswordReset",
                    "state": "remediated"
                },
                "user": {
                    "upn": "AlexW@M365x214355.onmicrosoft.com",
                    "id": "4782e723-f4f4-4af3-a76e-25e3bab0d896",
                    "type": "Member"
                }
            }
        }
    },
    "input": {
        "type": "cel"
    },
    "agent": {
        "name": "elastic-agent-74940",
        "id": "4dba66ec-f72a-41f6-bdac-69c44c9323d8",
        "ephemeral_id": "a41ad417-aa53-441c-a549-da581020df08",
        "type": "filebeat",
        "version": "8.17.3"
    },
    "@timestamp": "2025-03-26T09:41:36.166Z",
    "ecs": {
        "version": "8.17.0"
    },
    "data_stream": {
        "namespace": "72200",
        "type": "metrics",
        "dataset": "o365_metrics.entra_id_users"
    },
    "host": {
        "hostname": "elastic-agent-74940",
        "os": {
            "kernel": "6.12.5-linuxkit",
            "name": "Wolfi",
            "type": "linux",
            "family": "",
            "version": "20230201",
            "platform": "wolfi"
        },
        "containerized": false,
        "ip": [
            "172.29.0.2",
            "172.18.0.9"
        ],
        "name": "elastic-agent-74940",
        "mac": [
            "02-42-AC-12-00-09",
            "02-42-AC-1D-00-02"
        ],
        "architecture": "aarch64"
    },
    "elastic_agent": {
        "id": "4dba66ec-f72a-41f6-bdac-69c44c9323d8",
        "version": "8.17.3",
        "snapshot": false
    },
    "event": {
        "agent_id_status": "verified",
        "ingested": "2025-03-26T09:41:37Z",
        "dataset": "o365_metrics.entra_id_users"
    },
    "tags": [
        "o365.metrics.entra_id_users"
    ]
}</pre>
</div>
</div>
</details>
<details>
<summary class="title"><span class="strong strong"><strong>Exported fields</strong></span></summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Field</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>@timestamp</p></td>
<td align="left" valign="top"><p>Event timestamp.</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.dataset</p></td>
<td align="left" valign="top"><p>Data stream dataset.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.namespace</p></td>
<td align="left" valign="top"><p>Data stream namespace.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.type</p></td>
<td align="left" valign="top"><p>Data stream type.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>input.type</p></td>
<td align="left" valign="top"><p>Input type.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.entra_id_users.on_premises_provisioning_errors.category</p></td>
<td align="left" valign="top"><p>Category of the provisioning error.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.entra_id_users.on_premises_provisioning_errors.occurred_date_time</p></td>
<td align="left" valign="top"><p>The date and time at which the error occurred.</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.entra_id_users.on_premises_provisioning_errors.property_causing_error</p></td>
<td align="left" valign="top"><p>Name of the directory property causing the error.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.entra_id_users.on_premises_provisioning_errors.value</p></td>
<td align="left" valign="top"><p>Value of the property causing the error.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.entra_id_users.on_premises_sync_enabled</p></td>
<td align="left" valign="top"><p>true if this user object is currently being synced from an on-premises Active Directory (AD); otherwise the user isn&#8217;t being synced and can be managed in Microsoft Entra ID.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.entra_id_users.risk.detail</p></td>
<td align="left" valign="top"><p>The possible values are none, adminGeneratedTemporaryPassword, userPerformedSecuredPasswordChange, userPerformedSecuredPasswordReset, adminConfirmedSigninSafe, aiConfirmedSigninSafe, userPassedMFADrivenByRiskBasedPolicy, adminDismissedAllRiskForUser, adminConfirmedSigninCompromised, hidden, adminConfirmedUserCompromised, unknownFutureValue, adminConfirmedServicePrincipalCompromised, adminDismissedAllRiskForServicePrincipal, m365DAdminDismissedDetection, userChangedPasswordOnPremises, adminDismissedRiskForSignIn, adminConfirmedAccountSafe.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.entra_id_users.risk.error</p></td>
<td align="left" valign="top"><p>An error if the risk data is unavailable for this user.</p></td>
<td align="left" valign="top"><p>text</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.entra_id_users.risk.event_type</p></td>
<td align="left" valign="top"><p>The type of risk event detected. The possible values are adminConfirmedUserCompromised, anomalousToken, anomalousUserActivity, anonymizedIPAddress, generic, impossibleTravel, investigationsThreatIntelligence, suspiciousSendingPatterns, leakedCredentials, maliciousIPAddress,malwareInfectedIPAddress, mcasSuspiciousInboxManipulationRules, newCountry, passwordSpray,riskyIPAddress, suspiciousAPITraffic, suspiciousBrowser,suspiciousInboxForwarding, suspiciousIPAddress, tokenIssuerAnomaly, unfamiliarFeatures, unlikelyTravel. If the risk detection is a premium detection, will show generic.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.entra_id_users.risk.level</p></td>
<td align="left" valign="top"><p>Level of the detected risky user. Possible values are: low, medium, high, hidden, none, unknownFutureValue.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.entra_id_users.risk.state</p></td>
<td align="left" valign="top"><p>State of the user&#8217;s risk. Possible values are: none, confirmedSafe, remediated, dismissed, atRisk, confirmedCompromised, unknownFutureValue.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.entra_id_users.user.id</p></td>
<td align="left" valign="top"><p>The unique identifier for the user. Should be treated as an opaque identifier.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.entra_id_users.user.type</p></td>
<td align="left" valign="top"><p>A string value that can be used to classify user types in your directory. The possible values are Member and Guest.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.entra_id_users.user.upn</p></td>
<td align="left" valign="top"><p>The user principal name (UPN) of the user. The UPN is an Internet-style sign-in name for the user based on the Internet standard RFC 822. By convention, this value should map to the user&#8217;s email name. The general format is alias@domain, where the domain must be present in the tenant&#8217;s collection of verified domains.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
<div class="position-relative"><h5><a id="o365_metrics-mailbox-usage-quota-status"></a>Mailbox Usage Quota Status</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/o365_metrics/index.asciidoc">edit</a></div>
<p>Get details about Mailbox Usage Quota Status from <a href="https://learn.microsoft.com/en-us/graph/api/reportroot-getmailboxusagequotastatusmailboxcounts?view=graph-rest-1.0&amp;tabs=http" class="ulink" target="_top">Microsoft Graph API</a>.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Example</strong></span></summary>
<div class="content">
<p>An example event for <code class="literal">mailbox_usage_quota_status</code> looks as following:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
    "o365": {
        "metrics": {
            "mailbox": {
                "usage": {
                    "quota": {
                        "status": {
                            "send_receive_prohibited": {
                                "count": 9
                            },
                            "indeterminate": {
                                "count": 3
                            },
                            "under_limit": {
                                "count": 20
                            },
                            "warning_issued": {
                                "count": 1
                            },
                            "report": {
                                "date": "2025-01-26",
                                "period": {
                                    "day": "7"
                                },
                                "refresh_date": "2025-01-26"
                            },
                            "send_prohibited": {
                                "count": 6
                            }
                        }
                    }
                }
            }
        }
    },
    "agent": {
        "name": "docker-fleet-agent",
        "id": "0af64850-a098-46f3-a3c6-98b706017b44",
        "type": "filebeat",
        "ephemeral_id": "3c0f3a0f-f3dd-4793-affb-f9441816b674",
        "version": "8.16.0"
    },
    "@timestamp": "2025-01-26",
    "ecs": {
        "version": "8.16.0"
    },
    "data_stream": {
        "namespace": "default",
        "type": "metrics",
        "dataset": "o365_metrics.mailbox_usage_quota_status"
    },
    "host": {
        "hostname": "docker-fleet-agent",
        "os": {
            "kernel": "5.10.104-linuxkit",
            "name": "Wolfi",
            "family": "",
            "type": "linux",
            "version": "20230201",
            "platform": "wolfi"
        },
        "containerized": false,
        "ip": [
            "192.168.32.7"
        ],
        "name": "docker-fleet-agent",
        "mac": [
            "02-42-C0-A8-20-07"
        ],
        "architecture": "aarch64"
    },
    "elastic_agent": {
        "id": "0af64850-a098-46f3-a3c6-98b706017b44",
        "version": "8.16.0",
        "snapshot": false
    },
    "event": {
        "agent_id_status": "verified",
        "ingested": "2025-01-28T12:46:50Z",
        "dataset": "o365_metrics.mailbox_usage_quota_status"
    },
    "tags": [
        "o365.metrics.mailbox.usage"
    ]
}</pre>
</div>
</div>
</details>
<p><span class="strong strong"><strong>ECS Field Reference</strong></span></p>
<p>Please refer to the following <a href="/guide/en/ecs/current/ecs-field-reference.html" class="ulink" target="_top">document</a> for detailed information on ECS fields.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Exported fields</strong></span></summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
<col class="col_5"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Field</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Unit</th>
<th align="left" valign="top">Metric Type</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>@timestamp</p></td>
<td align="left" valign="top"><p>Event timestamp.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cloud.image.id</p></td>
<td align="left" valign="top"><p>Image ID for the cloud instance.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.dataset</p></td>
<td align="left" valign="top"><p>Data stream dataset.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.namespace</p></td>
<td align="left" valign="top"><p>Data stream namespace.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.type</p></td>
<td align="left" valign="top"><p>Data stream type.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.containerized</p></td>
<td align="left" valign="top"><p>If the host is a container.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.build</p></td>
<td align="left" valign="top"><p>OS build information.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.codename</p></td>
<td align="left" valign="top"><p>OS codename, if any.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.mailbox.usage.quota.status.indeterminate.count</p></td>
<td align="left" valign="top"><p>The number of mailboxes where the quota status could not be determined.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.mailbox.usage.quota.status.report.date</p></td>
<td align="left" valign="top"><p>The specific date for which the report data applies.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.mailbox.usage.quota.status.report.period.day</p></td>
<td align="left" valign="top"><p>The duration (e.g., 7 days) over which the quota status data is aggregated.</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p>d</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.mailbox.usage.quota.status.report.refresh_date</p></td>
<td align="left" valign="top"><p>The date when the report data was last updated.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.mailbox.usage.quota.status.send_prohibited.count</p></td>
<td align="left" valign="top"><p>The number of mailboxes restricted from sending emails due to exceeding their send quota during the reporting period.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.mailbox.usage.quota.status.send_receive_prohibited.count</p></td>
<td align="left" valign="top"><p>The number of mailboxes restricted from both sending and receiving emails due to exceeding their total quota during the reporting period.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.mailbox.usage.quota.status.under_limit.count</p></td>
<td align="left" valign="top"><p>The number of mailboxes operating within their assigned quota limits during the reporting period.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.mailbox.usage.quota.status.warning_issued.count</p></td>
<td align="left" valign="top"><p>The number of mailboxes that have exceeded their warning threshold quota during the reporting period.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
<div class="position-relative"><h5><a id="o365_metrics-mailbox-usage-detail"></a>Mailbox Usage Detail</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/o365_metrics/index.asciidoc">edit</a></div>
<p>Get details about Mailbox Usage Detail from <a href="https://learn.microsoft.com/en-us/graph/api/reportroot-getmailboxusagedetail?view=graph-rest-1.0&amp;tabs=http" class="ulink" target="_top">Microsoft Graph API</a>.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Example</strong></span></summary>
<div class="content">
<p>An example event for <code class="literal">mailbox_usage_detail</code> looks as following:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
    "o365": {
        "metrics": {
            "mailbox": {
                "usage": {
                    "detail": {
                        "item": {
                            "count": 181
                        },
                        "deleted_item_size": {
                            "byte": 440815
                        },
                        "prohibit_send_quota": {
                            "byte": 106300440576
                        },
                        "deleted_item_quota": {
                            "byte": 32212254720
                        },
                        "last_activity_date": "2024-10-11",
                        "display_name": "Dgo Sky",
                        "has_archive": true,
                        "issue_warning_quota": {
                            "byte": 105226698752
                        },
                        "deleted_item": {
                            "count": 66
                        },
                        "user_principal_name": "DgoS@OnMicrosoft.com",
                        "is_deleted": false,
                        "report": {
                            "period": {
                                "day": "7"
                            },
                            "refresh_date": "2025-01-22"
                        },
                        "prohibit_send_receive_quota": {
                            "byte": 107374182400
                        },
                        "created_date": "2024-10-11",
                        "storage_used": {
                            "byte": 6399001
                        }
                    }
                }
            }
        }
    },
    "agent": {
        "name": "docker-fleet-agent",
        "id": "e6f906c1-7164-4902-843f-78493e2b68a4",
        "ephemeral_id": "d04fab8b-d48e-4df3-83f1-aa2022d19736",
        "type": "filebeat",
        "version": "8.16.0"
    },
    "@timestamp": "2025-01-22",
    "ecs": {
        "version": "8.16.0"
    },
    "data_stream": {
        "namespace": "default",
        "type": "metrics",
        "dataset": "o365_metrics.mailbox_usage_detail"
    },
    "host": {
        "hostname": "docker-fleet-agent",
        "os": {
            "kernel": "5.10.104-linuxkit",
            "name": "Wolfi",
            "type": "linux",
            "version": "20230201",
            "platform": "wolfi"
        },
        "ip": [
            "172.24.0.7"
        ],
        "containerized": false,
        "name": "docker-fleet-agent",
        "mac": [
            "02-42-AC-18-00-07"
        ],
        "architecture": "aarch64"
    },
    "elastic_agent": {
        "id": "e6f906c1-7164-4902-843f-78493e2b68a4",
        "version": "8.16.0",
        "snapshot": false
    },
    "event": {
        "agent_id_status": "verified",
        "ingested": "2025-01-24T09:32:25Z",
        "dataset": "o365_metrics.mailbox_usage_detail"
    },
    "tags": [
        "o365.metrics.mailbox.usage"
    ]
}</pre>
</div>
</div>
</details>
<p><span class="strong strong"><strong>ECS Field Reference</strong></span></p>
<p>Please refer to the following <a href="/guide/en/ecs/current/ecs-field-reference.html" class="ulink" target="_top">document</a> for detailed information on ECS fields.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Exported fields</strong></span></summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
<col class="col_5"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Field</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Unit</th>
<th align="left" valign="top">Metric Type</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>@timestamp</p></td>
<td align="left" valign="top"><p>Event timestamp.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cloud.image.id</p></td>
<td align="left" valign="top"><p>Image ID for the cloud instance.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.dataset</p></td>
<td align="left" valign="top"><p>Data stream dataset.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.namespace</p></td>
<td align="left" valign="top"><p>Data stream namespace.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.type</p></td>
<td align="left" valign="top"><p>Data stream type.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.containerized</p></td>
<td align="left" valign="top"><p>If the host is a container.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.build</p></td>
<td align="left" valign="top"><p>OS build information.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.codename</p></td>
<td align="left" valign="top"><p>OS codename, if any.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.mailbox.usage.detail.created_date</p></td>
<td align="left" valign="top"><p>The date the mailbox was created.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.mailbox.usage.detail.deleted_date</p></td>
<td align="left" valign="top"><p>The date the mailbox was deleted.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.mailbox.usage.detail.deleted_item.count</p></td>
<td align="left" valign="top"><p>The number of items in the deleted items folder.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.mailbox.usage.detail.deleted_item_quota.byte</p></td>
<td align="left" valign="top"><p>The quota limit for the deleted items folder (in bytes).</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p>byte</p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.mailbox.usage.detail.deleted_item_size.byte</p></td>
<td align="left" valign="top"><p>The total size of items in the deleted items folder (in bytes).</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p>byte</p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.mailbox.usage.detail.display_name</p></td>
<td align="left" valign="top"><p>The full name of the user.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.mailbox.usage.detail.has_archive</p></td>
<td align="left" valign="top"><p>Indicates if the user has an archive mailbox.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.mailbox.usage.detail.is_deleted</p></td>
<td align="left" valign="top"><p>Indicates if the mailbox is deleted.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.mailbox.usage.detail.issue_warning_quota.byte</p></td>
<td align="left" valign="top"><p>The mailbox size limit at which a warning is issued (in bytes).</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p>byte</p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.mailbox.usage.detail.item.count</p></td>
<td align="left" valign="top"><p>The total number of items in the mailbox.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.mailbox.usage.detail.last_activity_date</p></td>
<td align="left" valign="top"><p>The most recent activity date for the mailbox.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.mailbox.usage.detail.prohibit_send_quota.byte</p></td>
<td align="left" valign="top"><p>The mailbox size limit at which sending messages is prohibited (in bytes).</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p>byte</p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.mailbox.usage.detail.prohibit_send_receive_quota.byte</p></td>
<td align="left" valign="top"><p>The mailbox size limit at which sending and receiving messages is prohibited (in bytes).</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p>byte</p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.mailbox.usage.detail.report.period.day</p></td>
<td align="left" valign="top"><p>The reporting period over which the data is aggregated (in days).</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p>d</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.mailbox.usage.detail.report.refresh_date</p></td>
<td align="left" valign="top"><p>The date when the report data was last updated.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.mailbox.usage.detail.storage_used.byte</p></td>
<td align="left" valign="top"><p>The total storage used in the mailbox (in bytes).</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p>byte</p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.mailbox.usage.detail.user_principal_name</p></td>
<td align="left" valign="top"><p>The email or principal username of the user.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
<div class="position-relative"><h5><a id="o365_metrics-microsoft-365-groups-activity-group-detail"></a>Microsoft 365 Groups Activity Group Detail</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/o365_metrics/index.asciidoc">edit</a></div>
<p>Get details about Microsoft 365 groups activity by group from <a href="https://learn.microsoft.com/en-us/graph/api/reportroot-getoffice365groupsactivitydetail?view=graph-rest-1.0&amp;tabs=http" class="ulink" target="_top">Microsoft Graph API</a>.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Example</strong></span></summary>
<div class="content">
<p>An example event for <code class="literal">groups_activity_group_detail</code> looks as following:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
    "@timestamp": "2024-12-24",
    "ecs": {
        "version": "8.16.0"
    },
    "event": {
        "original": "{\"Exchange Mailbox Storage Used (Byte)\":\"698640\",\"Exchange Mailbox Total Item Count\":\"9\",\"Exchange Received Email Count\":\"\",\"External Member Count\":\"0\",\"Group Display Name\":\"delete-1\",\"Group Id\":\"faa1ff4a-4677-4d4c-842a-dc63eb8b2ae3\",\"Group Type\":\"Private\",\"Is Deleted\":\"False\",\"Last Activity Date\":\"\",\"Member Count\":\"2\",\"Owner Principal Name\":\"AV@abc.onmicrosoft.com\",\"Report Period\":\"1\",\"SharePoint Active File Count\":\"\",\"SharePoint Site Storage Used (Byte)\":\"2029128\",\"SharePoint Total File Count\":\"6\",\"Yammer Liked Message Count\":\"\",\"Yammer Posted Message Count\":\"\",\"Yammer Read Message Count\":\"\",\"report\":{\"api_path\":\"/reports/getOffice365GroupsActivityDetail\",\"name\":\"Microsoft 365 Groups Activity Group Detail\"},\"﻿Report Refresh Date\":\"2024-12-24\"}"
    },
    "group": {
        "id": "faa1ff4a-4677-4d4c-842a-dc63eb8b2ae3",
        "name": "delete-1"
    },
    "o365": {
        "metrics": {
            "groups": {
                "activity": {
                    "group": {
                        "detail": {
                            "exchange_mailbox_storage_used": {
                                "byte": 698640
                            },
                            "exchange_mailbox_total_item": {
                                "count": 9
                            },
                            "external_member": {
                                "count": 0
                            },
                            "group_display_name": "delete-1",
                            "group_id": "faa1ff4a-4677-4d4c-842a-dc63eb8b2ae3",
                            "group_type": "Private",
                            "is_deleted": false,
                            "member": {
                                "count": 2
                            },
                            "owner_principal_name": "AV@abc.onmicrosoft.com",
                            "report": {
                                "period": {
                                    "day": "1"
                                },
                                "refresh_date": "2024-12-24"
                            },
                            "sharepoint_site_storage_used": {
                                "byte": 2029128
                            },
                            "sharepoint_total_file": {
                                "count": 6
                            }
                        }
                    }
                }
            },
            "report": {
                "api_path": "/reports/getOffice365GroupsActivityDetail",
                "name": "Microsoft 365 Groups Activity Group Detail"
            }
        }
    },
    "related": {
        "user": [
            "AV@abc.onmicrosoft.com"
        ]
    },
    "tags": [
        "preserve_duplicate_custom_fields",
        "preserve_original_event"
    ],
    "user": {
        "group": {
            "id": "faa1ff4a-4677-4d4c-842a-dc63eb8b2ae3",
            "name": "delete-1"
        },
        "name": "AV@abc.onmicrosoft.com"
    }
}</pre>
</div>
</div>
</details>
<p><span class="strong strong"><strong>ECS Field Reference</strong></span></p>
<p>Please refer to the following <a href="/guide/en/ecs/current/ecs-field-reference.html" class="ulink" target="_top">document</a> for detailed information on ECS fields.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Exported fields</strong></span></summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
<col class="col_5"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Field</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Unit</th>
<th align="left" valign="top">Metric Type</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>@timestamp</p></td>
<td align="left" valign="top"><p>Date/time when the event originated. This is the date/time extracted from the event, typically representing when the event was generated by the source. If the event source has no original timestamp, this value is typically populated by the first time the event was received by the pipeline. Required field for all events.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.dataset</p></td>
<td align="left" valign="top"><p>The field can contain anything that makes sense to signify the source of the data. Examples include <code class="literal">nginx.access</code>, <code class="literal">prometheus</code>, <code class="literal">endpoint</code> etc. For data streams that otherwise fit, but that do not have dataset set we use the value "generic" for the dataset value. <code class="literal">event.dataset</code> should have the same value as <code class="literal">data_stream.dataset</code>. Beyond the Elasticsearch data stream naming criteria noted above, the <code class="literal">dataset</code> value has additional restrictions:   * Must not contain <code class="literal">-</code>   * No longer than 100 characters</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.namespace</p></td>
<td align="left" valign="top"><p>A user defined namespace. Namespaces are useful to allow grouping of data. Many users already organize their indices this way, and the data stream naming scheme now provides this best practice as a default. Many users will populate this field with <code class="literal">default</code>. If no value is used, it falls back to <code class="literal">default</code>. Beyond the Elasticsearch index naming criteria noted above, <code class="literal">namespace</code> value has the additional restrictions:   * Must not contain <code class="literal">-</code>   * No longer than 100 characters</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.type</p></td>
<td align="left" valign="top"><p>An overarching type for the data stream. Currently allowed values are "logs" and "metrics". We expect to also add "traces" and "synthetics" in the near future.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>event.dataset</p></td>
<td align="left" valign="top"><p>Name of the dataset. If an event source publishes more than one type of log or events (e.g. access log, error log), the dataset is used to specify which one the event comes from. It&#8217;s recommended but not required to start the dataset name with the module name, followed by a dot, then the dataset name.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>event.module</p></td>
<td align="left" valign="top"><p>Name of the module this data is coming from. If your monitoring agent supports the concept of modules or plugins to process events of a given source (e.g. Apache logs), <code class="literal">event.module</code> should contain the name of this module.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>labels.is_transform_source</p></td>
<td align="left" valign="top"><p>Distinguishes between documents that are a source for a transform and documents that are an output of a transform, to facilitate easier filtering.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.groups.activity.group.detail.exchange_mailbox_storage_used.byte</p></td>
<td align="left" valign="top"><p>The storage used by the group&#8217;s mailbox.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.groups.activity.group.detail.exchange_mailbox_total_item.count</p></td>
<td align="left" valign="top"><p>The total number of items in the group&#8217;s mailbox.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.groups.activity.group.detail.exchange_received_email.count</p></td>
<td align="left" valign="top"><p>The number of messages received by the group.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.groups.activity.group.detail.external_member.count</p></td>
<td align="left" valign="top"><p>The number of external users in the group.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.groups.activity.group.detail.group_display_name</p></td>
<td align="left" valign="top"><p>The name of the group.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.groups.activity.group.detail.group_id</p></td>
<td align="left" valign="top"><p>The id of the group.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.groups.activity.group.detail.group_type</p></td>
<td align="left" valign="top"><p>The type of group. This can be private or public group.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.groups.activity.group.detail.is_deleted</p></td>
<td align="left" valign="top"><p>If the group is deleted, but had activity in the reporting period it will show up in the grid with this flag set to true.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.groups.activity.group.detail.last_activity_date</p></td>
<td align="left" valign="top"><p>The latest date a message was received by the group. This is the latest date an activity happened in an email conversation, Viva Engage, or the Site.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.groups.activity.group.detail.member.count</p></td>
<td align="left" valign="top"><p>The number of members in the group.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.groups.activity.group.detail.owner_principal_name</p></td>
<td align="left" valign="top"><p>The name of the group owner.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.groups.activity.group.detail.report.period.day</p></td>
<td align="left" valign="top"><p>The reporting period over which the data is aggregated (in days).</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p>d</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.groups.activity.group.detail.report.refresh_date</p></td>
<td align="left" valign="top"><p>The date when the report data was last updated.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.groups.activity.group.detail.sharepoint_active_file.count</p></td>
<td align="left" valign="top"><p>The number of files in the SharePoint group site that were acted on (viewed or modified, synched, shared internally or externally) during the reporting period.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.groups.activity.group.detail.sharepoint_site_storage_used.byte</p></td>
<td align="left" valign="top"><p>The amount of storage in MB used during the reporting period.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.groups.activity.group.detail.sharepoint_total_file.count</p></td>
<td align="left" valign="top"><p>The number of files stored in SharePoint group sites.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.groups.activity.group.detail.yammer_liked_message.count</p></td>
<td align="left" valign="top"><p>The number of messages liked in the Viva Engage group over the reporting period.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.groups.activity.group.detail.yammer_posted_message.count</p></td>
<td align="left" valign="top"><p>The number of messages posted in the Viva Engage group over the reporting period.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.groups.activity.group.detail.yammer_read_message.count</p></td>
<td align="left" valign="top"><p>The number of conversations read in the Viva Engage group over the reporting period.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.report.api_path</p></td>
<td align="left" valign="top"><p>Microsoft Graph API path used to pull the report.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.report.name</p></td>
<td align="left" valign="top"><p>Name of the report.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
<div class="position-relative"><h5><a id="o365_metrics-onedrive-usage-account-detail"></a>OneDrive Usage Account Detail</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/o365_metrics/index.asciidoc">edit</a></div>
<p>Get details about OneDrive usage by account from <a href="https://learn.microsoft.com/en-us/graph/api/reportroot-getonedriveusageaccountdetail?view=graph-rest-1.0&amp;tabs=http" class="ulink" target="_top">Microsoft Graph API</a>.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Example</strong></span></summary>
<div class="content">
<p>An example event for <code class="literal">onedrive_usage_account_detail</code> looks as following:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
    "@timestamp": "2024-12-23",
    "ecs": {
        "version": "8.16.0"
    },
    "event": {
        "original": "{\"Active File Count\":\"1\",\"File Count\":\"7\",\"Is Deleted\":\"False\",\"Last Activity Date\":\"2024-12-23\",\"Owner Display Name\":\"ABC\",\"Owner Principal Name\":\"KR@abc.onmicrosoft.com\",\"Report Period\":\"1\",\"Site Id\":\"e1f0f31e-ba42-46a1-9f41-ef4849978cd8\",\"Site URL\":\"\",\"Storage Allocated (Byte)\":\"1099511627776\",\"Storage Used (Byte)\":\"1305970\",\"report\":{\"api_path\":\"/reports/getOneDriveUsageAccountDetail\",\"name\":\"OneDrive Usage Account Detail\"},\"﻿Report Refresh Date\":\"2024-12-23\"}"
    },
    "o365": {
        "metrics": {
            "onedrive": {
                "usage": {
                    "account": {
                        "detail": {
                            "active_file": {
                                "count": 1
                            },
                            "file": {
                                "count": 7
                            },
                            "is_deleted": false,
                            "last_activity_date": "2024-12-23T00:00:00.000Z",
                            "owner_display_name": "ABC",
                            "owner_principal_name": "KR@abc.onmicrosoft.com",
                            "report": {
                                "period": {
                                    "day": "1"
                                },
                                "refresh_date": "2024-12-23"
                            },
                            "site_id": "e1f0f31e-ba42-46a1-9f41-ef4849978cd8",
                            "storage_allocated": {
                                "byte": 1099511627776
                            },
                            "storage_used": {
                                "byte": 1305970
                            }
                        }
                    }
                }
            },
            "report": {
                "api_path": "/reports/getOneDriveUsageAccountDetail",
                "name": "OneDrive Usage Account Detail"
            }
        }
    },
    "related": {
        "user": [
            "KR@abc.onmicrosoft.com"
        ]
    },
    "tags": [
        "preserve_duplicate_custom_fields",
        "preserve_original_event"
    ],
    "user": {
        "email": "KR@abc.onmicrosoft.com",
        "name": "KR@abc.onmicrosoft.com"
    }
}</pre>
</div>
</div>
</details>
<p><span class="strong strong"><strong>ECS Field Reference</strong></span></p>
<p>Please refer to the following <a href="/guide/en/ecs/current/ecs-field-reference.html" class="ulink" target="_top">document</a> for detailed information on ECS fields.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Exported fields</strong></span></summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
<col class="col_5"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Field</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Unit</th>
<th align="left" valign="top">Metric Type</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>@timestamp</p></td>
<td align="left" valign="top"><p>Date/time when the event originated. This is the date/time extracted from the event, typically representing when the event was generated by the source. If the event source has no original timestamp, this value is typically populated by the first time the event was received by the pipeline. Required field for all events.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.dataset</p></td>
<td align="left" valign="top"><p>The field can contain anything that makes sense to signify the source of the data. Examples include <code class="literal">nginx.access</code>, <code class="literal">prometheus</code>, <code class="literal">endpoint</code> etc. For data streams that otherwise fit, but that do not have dataset set we use the value "generic" for the dataset value. <code class="literal">event.dataset</code> should have the same value as <code class="literal">data_stream.dataset</code>. Beyond the Elasticsearch data stream naming criteria noted above, the <code class="literal">dataset</code> value has additional restrictions:   * Must not contain <code class="literal">-</code>   * No longer than 100 characters</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.namespace</p></td>
<td align="left" valign="top"><p>A user defined namespace. Namespaces are useful to allow grouping of data. Many users already organize their indices this way, and the data stream naming scheme now provides this best practice as a default. Many users will populate this field with <code class="literal">default</code>. If no value is used, it falls back to <code class="literal">default</code>. Beyond the Elasticsearch index naming criteria noted above, <code class="literal">namespace</code> value has the additional restrictions:   * Must not contain <code class="literal">-</code>   * No longer than 100 characters</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.type</p></td>
<td align="left" valign="top"><p>An overarching type for the data stream. Currently allowed values are "logs" and "metrics". We expect to also add "traces" and "synthetics" in the near future.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>event.dataset</p></td>
<td align="left" valign="top"><p>Name of the dataset. If an event source publishes more than one type of log or events (e.g. access log, error log), the dataset is used to specify which one the event comes from. It&#8217;s recommended but not required to start the dataset name with the module name, followed by a dot, then the dataset name.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>event.module</p></td>
<td align="left" valign="top"><p>Name of the module this data is coming from. If your monitoring agent supports the concept of modules or plugins to process events of a given source (e.g. Apache logs), <code class="literal">event.module</code> should contain the name of this module.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>labels.is_transform_source</p></td>
<td align="left" valign="top"><p>Distinguishes between documents that are a source for a transform and documents that are an output of a transform, to facilitate easier filtering.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.onedrive.usage.account.detail.active_file.count</p></td>
<td align="left" valign="top"><p>The number of active files within the time period.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.onedrive.usage.account.detail.file.count</p></td>
<td align="left" valign="top"><p>The number of files in the OneDrive.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.onedrive.usage.account.detail.is_deleted</p></td>
<td align="left" valign="top"><p>The deletion status of the OneDrive. It takes at least seven days for accounts to be marked as deleted.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.onedrive.usage.account.detail.last_activity_date</p></td>
<td align="left" valign="top"><p>The latest date a file activity was performed in the OneDrive. If the OneDrive has had no file activity, the value will be blank.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.onedrive.usage.account.detail.owner_display_name</p></td>
<td align="left" valign="top"><p>The username of the primary administrator of the OneDrive.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.onedrive.usage.account.detail.owner_principal_name</p></td>
<td align="left" valign="top"><p>The email address of the owner of the OneDrive.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.onedrive.usage.account.detail.report.period.day</p></td>
<td align="left" valign="top"><p>The reporting period over which the data is aggregated (in days).</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p>d</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.onedrive.usage.account.detail.report.refresh_date</p></td>
<td align="left" valign="top"><p>The date when the report data was last updated.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.onedrive.usage.account.detail.site_id</p></td>
<td align="left" valign="top"><p>The site ID of the site.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.onedrive.usage.account.detail.site_url</p></td>
<td align="left" valign="top"><p>The web address for the user&#8217;s OneDrive. Note: URL will be empty temporarily.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.onedrive.usage.account.detail.storage_allocated.byte</p></td>
<td align="left" valign="top"><p>The amount of storage the OneDrive is allocated.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.onedrive.usage.account.detail.storage_used.byte</p></td>
<td align="left" valign="top"><p>The amount of storage the OneDrive uses.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.report.api_path</p></td>
<td align="left" valign="top"><p>Microsoft Graph API path used to pull the report.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.report.name</p></td>
<td align="left" valign="top"><p>Name of the report.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
<div class="position-relative"><h5><a id="o365_metrics-onedrive-usage-account-counts"></a>OneDrive Usage Account Counts</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/o365_metrics/index.asciidoc">edit</a></div>
<p>Get details about OneDrive usage by account counts from <a href="https://learn.microsoft.com/en-us/graph/api/reportroot-getonedriveusageaccountcounts?view=graph-rest-1.0&amp;tabs=http" class="ulink" target="_top">Microsoft Graph API</a>.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Example</strong></span></summary>
<div class="content">
<p>An example event for <code class="literal">onedrive_usage_account_counts</code> looks as following:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
    "@timestamp": "2024-12-24T09:33:50.076Z",
    "agent": {
        "name": "docker-fleet-agent",
        "id": "abf38fab-f7b6-4e1c-a3b3-a70a64f9e5db",
        "ephemeral_id": "08417a8d-9698-4c62-b7dc-e1b048647626",
        "type": "filebeat",
        "version": "8.16.0"
    },
    "data_stream": {
        "namespace": "default",
        "type": "metrics",
        "dataset": "o365_metrics.onedrive_usage_account_counts"
    },
    "ecs": {
        "version": "8.16.0"
    },
    "elastic_agent": {
        "id": "abf38fab-f7b6-4e1c-a3b3-a70a64f9e5db",
        "version": "8.16.0",
        "snapshot": false
    },
    "event": {
        "agent_id_status": "verified",
        "ingested": "2024-12-24T09:33:51Z",
        "dataset": "o365_metrics.onedrive_usage_account_counts",
        "original": "{\"Active\":\"16\",\"Report Date\":\"2024-11-23\",\"Report Period\":\"7\",\"Site Type\":\"All\",\"Total\":\"18\",\"Report Refresh Date\":\"2024-11-29\"}"
    },
    "host": {
        "hostname": "docker-fleet-agent",
        "os": {
            "kernel": "5.10.104-linuxkit",
            "name": "Wolfi",
            "type": "linux",
            "family": "",
            "version": "20230201",
            "platform": "wolfi"
        },
        "containerized": false,
        "ip": [
            "192.168.48.7"
        ],
        "name": "docker-fleet-agent",
        "mac": [
            "02-42-C0-A8-30-07"
        ],
        "architecture": "aarch64"
    },
    "o365": {
        "metrics": {
            "onedrive": {
                "usage": {
                    "account": {
                        "counts": {
                            "active": {
                                "count": 14
                            },
                            "report": {
                                "date": "2024-11-23",
                                "period": {
                                    "day": "1"
                                },
                                "refresh_date": "2024-11-29"
                            },
                            "total": {
                                "count": 18
                            }
                        }
                    }
                }
            }
        }
    },
    "tags": [
        "o365.metrics.onedrive_usage_account_counts",
        "preserve_original_event"
    ]
}</pre>
</div>
</div>
</details>
<p><span class="strong strong"><strong>ECS Field Reference</strong></span></p>
<p>Please refer to the following <a href="/guide/en/ecs/current/ecs-field-reference.html" class="ulink" target="_top">document</a> for detailed information on ECS fields.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Exported fields</strong></span></summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
<col class="col_5"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Field</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Unit</th>
<th align="left" valign="top">Metric Type</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>@timestamp</p></td>
<td align="left" valign="top"><p>Event timestamp.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cloud.image.id</p></td>
<td align="left" valign="top"><p>Image ID for the cloud instance.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.dataset</p></td>
<td align="left" valign="top"><p>Data stream dataset.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.namespace</p></td>
<td align="left" valign="top"><p>Data stream namespace.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.type</p></td>
<td align="left" valign="top"><p>Data stream type.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.containerized</p></td>
<td align="left" valign="top"><p>If the host is a container.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.build</p></td>
<td align="left" valign="top"><p>OS build information.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.codename</p></td>
<td align="left" valign="top"><p>OS codename, if any.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.onedrive.usage.account.counts.active.count</p></td>
<td align="left" valign="top"><p>The number of OneDrive accounts that were active during the reporting period.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.onedrive.usage.account.counts.report.date</p></td>
<td align="left" valign="top"><p>The date the report was generated.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.onedrive.usage.account.counts.report.period.day</p></td>
<td align="left" valign="top"><p>The reporting period over which the data is aggregated (in days).</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p>d</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.onedrive.usage.account.counts.report.refresh_date</p></td>
<td align="left" valign="top"><p>The date when the report data was last updated.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.onedrive.usage.account.counts.total.count</p></td>
<td align="left" valign="top"><p>The total number of OneDrive accounts evaluated in the report.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
<div class="position-relative"><h5><a id="o365_metrics-onedrive-usage-file-counts"></a>OneDrive Usage File Counts</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/o365_metrics/index.asciidoc">edit</a></div>
<p>Get details about OneDrive usage by file counts from <a href="https://learn.microsoft.com/en-us/graph/api/reportroot-getonedriveusagefilecounts?view=graph-rest-1.0&amp;tabs=http" class="ulink" target="_top">Microsoft Graph API</a>.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Example</strong></span></summary>
<div class="content">
<p>An example event for <code class="literal">onedrive_usage_file_counts</code> looks as following:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
    "@timestamp": "2024-12-24T09:33:50.076Z",
    "agent": {
        "name": "docker-fleet-agent",
        "id": "abf38fab-f7b6-4e1c-a3b3-a70a64f9e5db",
        "ephemeral_id": "08417a8d-9698-4c62-b7dc-e1b048647626",
        "type": "filebeat",
        "version": "8.16.0"
    },
    "data_stream": {
        "namespace": "default",
        "type": "metrics",
        "dataset": "o365_metrics.onedrive_usage_file_counts"
    },
    "ecs": {
        "version": "8.16.0"
    },
    "elastic_agent": {
        "id": "abf38fab-f7b6-4e1c-a3b3-a70a64f9e5db",
        "version": "8.16.0",
        "snapshot": false
    },
    "event": {
        "agent_id_status": "verified",
        "ingested": "2024-12-24T09:33:51Z",
        "dataset": "o365_metrics.onedrive_usage_file_counts",
        "original": "{\"Active\":\"16\",\"Report Date\":\"2024-11-23\",\"Report Period\":\"7\",\"Site Type\":\"All\",\"Total\":\"164\",\"Report Refresh Date\":\"2024-11-29\"}"
    },
    "host": {
        "hostname": "docker-fleet-agent",
        "os": {
            "kernel": "5.10.104-linuxkit",
            "name": "Wolfi",
            "type": "linux",
            "family": "",
            "version": "20230201",
            "platform": "wolfi"
        },
        "containerized": false,
        "ip": [
            "192.168.48.7"
        ],
        "name": "docker-fleet-agent",
        "mac": [
            "02-42-C0-A8-30-07"
        ],
        "architecture": "aarch64"
    },
    "o365": {
        "metrics": {
            "onedrive": {
                "usage": {
                    "file": {
                        "counts": {
                            "active": {
                                "count": 14
                            },
                            "report": {
                                "date": "2024-11-23",
                                "period": {
                                    "day": "7"
                                },
                                "refresh_date": "2024-11-29"
                            },
                            "total": {
                                "count": 164
                            }
                        }
                    }
                }
            }
        }
    },
    "tags": [
        "o365.metrics.onedrive_usage_file_counts",
        "preserve_original_event"
    ]
}</pre>
</div>
</div>
</details>
<p><span class="strong strong"><strong>ECS Field Reference</strong></span></p>
<p>Please refer to the following <a href="/guide/en/ecs/current/ecs-field-reference.html" class="ulink" target="_top">document</a> for detailed information on ECS fields.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Exported fields</strong></span></summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
<col class="col_5"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Field</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Unit</th>
<th align="left" valign="top">Metric Type</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>@timestamp</p></td>
<td align="left" valign="top"><p>Event timestamp.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cloud.image.id</p></td>
<td align="left" valign="top"><p>Image ID for the cloud instance.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.dataset</p></td>
<td align="left" valign="top"><p>Data stream dataset.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.namespace</p></td>
<td align="left" valign="top"><p>Data stream namespace.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.type</p></td>
<td align="left" valign="top"><p>Data stream type.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.containerized</p></td>
<td align="left" valign="top"><p>If the host is a container.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.build</p></td>
<td align="left" valign="top"><p>OS build information.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.codename</p></td>
<td align="left" valign="top"><p>OS codename, if any.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.onedrive.usage.file.counts.active.count</p></td>
<td align="left" valign="top"><p>The number of OneDrive accounts with active file usage during the reporting period.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.onedrive.usage.file.counts.report.date</p></td>
<td align="left" valign="top"><p>The date the report was generated.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.onedrive.usage.file.counts.report.period.day</p></td>
<td align="left" valign="top"><p>The reporting period over which the data is aggregated (in days).</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p>d</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.onedrive.usage.file.counts.report.refresh_date</p></td>
<td align="left" valign="top"><p>The date when the report data was last updated.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.onedrive.usage.file.counts.total.count</p></td>
<td align="left" valign="top"><p>The total number of OneDrive accounts evaluated in the report.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
<div class="position-relative"><h5><a id="o365_metrics-onedrive-usage-storage"></a>OneDrive Usage Storage</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/o365_metrics/index.asciidoc">edit</a></div>
<p>Get details about OneDrive usage by storage from <a href="https://learn.microsoft.com/en-us/graph/api/reportroot-getonedriveusagestorage?view=graph-rest-1.0&amp;tabs=http" class="ulink" target="_top">Microsoft Graph API</a>.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Example</strong></span></summary>
<div class="content">
<p>An example event for <code class="literal">onedrive_usage_storage</code> looks as following:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
    "@timestamp": "2024-12-24T09:33:50.076Z",
    "agent": {
        "name": "docker-fleet-agent",
        "id": "abf38fab-f7b6-4e1c-a3b3-a70a64f9e5db",
        "ephemeral_id": "08417a8d-9698-4c62-b7dc-e1b048647626",
        "type": "filebeat",
        "version": "8.16.0"
    },
    "data_stream": {
        "namespace": "default",
        "type": "metrics",
        "dataset": "o365_metrics.onedrive_usage_storage"
    },
    "ecs": {
        "version": "8.16.0"
    },
    "elastic_agent": {
        "id": "abf38fab-f7b6-4e1c-a3b3-a70a64f9e5db",
        "version": "8.16.0",
        "snapshot": false
    },
    "event": {
        "agent_id_status": "verified",
        "ingested": "2024-12-24T09:33:51Z",
        "dataset": "o365_metrics.onedrive_usage_storage",
        "original": "{\"Report Date\":\"2024-11-23\",\"Report Period\":\"7\",\"Site Type\":\"All\",\"Storage Used (Byte)\":\"91659303\",\"Report Refresh Date\":\"2024-11-29\"}"
    },
    "host": {
        "hostname": "docker-fleet-agent",
        "os": {
            "kernel": "5.10.104-linuxkit",
            "name": "Wolfi",
            "type": "linux",
            "family": "",
            "version": "20230201",
            "platform": "wolfi"
        },
        "containerized": false,
        "ip": [
            "192.168.48.7"
        ],
        "name": "docker-fleet-agent",
        "mac": [
            "02-42-C0-A8-30-07"
        ],
        "architecture": "aarch64"
    },
    "o365": {
        "metrics": {
            "onedrive": {
                "usage": {
                    "storage": {
                        "report": {
                            "date": "2024-12-16",
                            "period": {
                                "day": "7"
                            },
                            "refresh_date": "2024-12-22"
                        },
                        "used": {
                            "byte": 91659303
                        }
                    }
                }
            }
        }
    },
    "tags": [
        "preserve_original_event",
        "o365.metrics.onedrive_usage_storage"
    ]
}</pre>
</div>
</div>
</details>
<p><span class="strong strong"><strong>ECS Field Reference</strong></span></p>
<p>Please refer to the following <a href="/guide/en/ecs/current/ecs-field-reference.html" class="ulink" target="_top">document</a> for detailed information on ECS fields.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Exported fields</strong></span></summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
<col class="col_5"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Field</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Unit</th>
<th align="left" valign="top">Metric Type</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>@timestamp</p></td>
<td align="left" valign="top"><p>Event timestamp.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cloud.image.id</p></td>
<td align="left" valign="top"><p>Image ID for the cloud instance.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.dataset</p></td>
<td align="left" valign="top"><p>Data stream dataset.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.namespace</p></td>
<td align="left" valign="top"><p>Data stream namespace.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.type</p></td>
<td align="left" valign="top"><p>Data stream type.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.containerized</p></td>
<td align="left" valign="top"><p>If the host is a container.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.build</p></td>
<td align="left" valign="top"><p>OS build information.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.codename</p></td>
<td align="left" valign="top"><p>OS codename, if any.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.onedrive.usage.storage.report.date</p></td>
<td align="left" valign="top"><p>The date the report was generated.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.onedrive.usage.storage.report.period.day</p></td>
<td align="left" valign="top"><p>The reporting period over which the data is aggregated (in days).</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p>d</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.onedrive.usage.storage.report.refresh_date</p></td>
<td align="left" valign="top"><p>The date when the report data was last updated.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.onedrive.usage.storage.used.byte</p></td>
<td align="left" valign="top"><p>The total storage used across OneDrive accounts during the reporting period, in bytes.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p>byte</p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
<div class="position-relative"><h5><a id="o365_metrics-outlook-activity"></a>Outlook Activity</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/o365_metrics/index.asciidoc">edit</a></div>
<p>Get details about Outlook Activity from <a href="https://learn.microsoft.com/en-us/graph/api/reportroot-getemailactivitycounts?view=graph-rest-1.0&amp;tabs=http" class="ulink" target="_top">Microsoft Graph API</a>.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Example</strong></span></summary>
<div class="content">
<p>An example event for <code class="literal">outlook_activity</code> looks as following:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
    "o365": {
        "metrics": {
            "outlook": {
                "activity": {
                    "meeting_interacted": {
                        "count": 6
                    },
                    "meeting_created": {
                        "count": 0
                    },
                    "emails_received": {
                        "count": 11
                    },
                    "emails_sent": {
                        "count": 1
                    },
                    "report": {
                        "date": "2025-01-21",
                        "period": {
                            "day": "7"
                        },
                        "refresh_date": "2025-01-26"
                    },
                    "emails_read": {
                        "count": 6
                    }
                }
            }
        }
    },
    "agent": {
        "name": "docker-fleet-agent",
        "id": "e416de39-a342-4f53-86e7-e36d8846b4b7",
        "ephemeral_id": "d9e690ae-7a58-4c59-b143-1408bbb93a4f",
        "type": "filebeat",
        "version": "8.16.0"
    },
    "@timestamp": "2025-01-21",
    "ecs": {
        "version": "8.16.0"
    },
    "data_stream": {
        "namespace": "default",
        "type": "metrics",
        "dataset": "o365_metrics.outlook_activity"
    },
    "host": {
        "hostname": "docker-fleet-agent",
        "os": {
            "kernel": "5.10.104-linuxkit",
            "name": "Wolfi",
            "type": "linux",
            "family": "",
            "version": "20230201",
            "platform": "wolfi"
        },
        "containerized": false,
        "ip": [
            "192.168.0.7"
        ],
        "name": "docker-fleet-agent",
        "mac": [
            "02-42-C0-A8-00-07"
        ],
        "architecture": "aarch64"
    },
    "elastic_agent": {
        "id": "e416de39-a342-4f53-86e7-e36d8846b4b7",
        "version": "8.16.0",
        "snapshot": false
    },
    "event": {
        "agent_id_status": "verified",
        "ingested": "2025-01-28T08:13:54Z",
        "dataset": "o365_metrics.outlook_activity"
    },
    "tags": [
        "o365.metrics.outlook.activity"
    ]
}</pre>
</div>
</div>
</details>
<p><span class="strong strong"><strong>ECS Field Reference</strong></span></p>
<p>Please refer to the following <a href="/guide/en/ecs/current/ecs-field-reference.html" class="ulink" target="_top">document</a> for detailed information on ECS fields.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Exported fields</strong></span></summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
<col class="col_5"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Field</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Unit</th>
<th align="left" valign="top">Metric Type</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>@timestamp</p></td>
<td align="left" valign="top"><p>Event timestamp.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cloud.image.id</p></td>
<td align="left" valign="top"><p>Image ID for the cloud instance.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.dataset</p></td>
<td align="left" valign="top"><p>Data stream dataset.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.namespace</p></td>
<td align="left" valign="top"><p>Data stream namespace.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.type</p></td>
<td align="left" valign="top"><p>Data stream type.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.containerized</p></td>
<td align="left" valign="top"><p>If the host is a container.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.build</p></td>
<td align="left" valign="top"><p>OS build information.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.codename</p></td>
<td align="left" valign="top"><p>OS codename, if any.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.outlook.activity.emails_read.count</p></td>
<td align="left" valign="top"><p>The count of email messages read by users during the reporting period.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.outlook.activity.emails_received.count</p></td>
<td align="left" valign="top"><p>The count of email messages received by users during the reporting period.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.outlook.activity.emails_sent.count</p></td>
<td align="left" valign="top"><p>The count of email messages sent by users during the reporting period.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.outlook.activity.meeting_created.count</p></td>
<td align="left" valign="top"><p>The count of calendar meetings created by users during the reporting period.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.outlook.activity.meeting_interacted.count</p></td>
<td align="left" valign="top"><p>The count of meetings where users interacted (e.g., accepted, declined, or modified) during the reporting period.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.outlook.activity.report.date</p></td>
<td align="left" valign="top"><p>The specific date for which the report data applies.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.outlook.activity.report.period.day</p></td>
<td align="left" valign="top"><p>The duration (e.g., 7 days) over which the report data is aggregated.</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p>d</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.outlook.activity.report.refresh_date</p></td>
<td align="left" valign="top"><p>The date when the report data was last updated.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
<div class="position-relative"><h5><a id="o365_metrics-outlook-app-usage-version-counts"></a>Outlook App Usage Version Counts</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/o365_metrics/index.asciidoc">edit</a></div>
<p>Get details about Microsoft Outlook App Usage Version Counts from <a href="https://learn.microsoft.com/en-us/graph/api/reportroot-getemailappusageversionsusercounts?view=graph-rest-1.0&amp;tabs=http" class="ulink" target="_top">Microsoft Graph API</a>.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Example</strong></span></summary>
<div class="content">
<p>An example event for <code class="literal">outlook_app_usage_version_counts</code> looks as following:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
    "o365": {
        "metrics": {
            "outlook": {
                "app": {
                    "usage": {
                        "version": {
                            "counts": {
                                "outlook_2013": {
                                    "count": 1
                                },
                                "outlook_2016": {
                                    "count": 7
                                },
                                "outlook_2007": {
                                    "count": 6
                                },
                                "undetermined": {
                                    "count": 3
                                },
                                "report": {
                                    "period": {
                                        "day": "7"
                                    },
                                    "refresh_date": "2025-01-26"
                                },
                                "outlook_2019": {
                                    "count": 2
                                },
                                "outlook_m365": {
                                    "count": 10
                                },
                                "outlook_2010": {
                                    "count": 1
                                }
                            }
                        }
                    }
                }
            }
        }
    },
    "agent": {
        "name": "docker-fleet-agent",
        "id": "e6840d3f-0681-4dde-b0e6-f0e767ba296c",
        "ephemeral_id": "5180e26c-bab3-433c-9dce-fd0be1cabfd0",
        "type": "filebeat",
        "version": "8.16.0"
    },
    "@timestamp": "2025-01-26",
    "ecs": {
        "version": "8.16.0"
    },
    "data_stream": {
        "namespace": "default",
        "type": "metrics",
        "dataset": "o365_metrics.outlook_app_usage_version_counts"
    },
    "elastic_agent": {
        "id": "e6840d3f-0681-4dde-b0e6-f0e767ba296c",
        "version": "8.16.0",
        "snapshot": false
    },
    "host": {
        "hostname": "docker-fleet-agent",
        "os": {
            "kernel": "5.10.104-linuxkit",
            "name": "Wolfi",
            "type": "linux",
            "family": "",
            "version": "20230201",
            "platform": "wolfi"
        },
        "ip": [
            "172.31.0.7"
        ],
        "containerized": false,
        "name": "docker-fleet-agent",
        "mac": [
            "02-42-AC-1F-00-07"
        ],
        "architecture": "aarch64"
    },
    "event": {
        "agent_id_status": "verified",
        "ingested": "2025-01-28T07:05:32Z",
        "dataset": "o365_metrics.outlook_app_usage_version_counts"
    },
    "tags": [
        "o365metrics-outlook_app_usage_version_counts"
    ]
}</pre>
</div>
</div>
</details>
<p><span class="strong strong"><strong>ECS Field Reference</strong></span></p>
<p>Please refer to the following <a href="/guide/en/ecs/current/ecs-field-reference.html" class="ulink" target="_top">document</a> for detailed information on ECS fields.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Exported fields</strong></span></summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
<col class="col_5"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Field</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Unit</th>
<th align="left" valign="top">Metric Type</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>@timestamp</p></td>
<td align="left" valign="top"><p>Event timestamp.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cloud.image.id</p></td>
<td align="left" valign="top"><p>Image ID for the cloud instance.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.dataset</p></td>
<td align="left" valign="top"><p>Data stream dataset.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.namespace</p></td>
<td align="left" valign="top"><p>Data stream namespace.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.type</p></td>
<td align="left" valign="top"><p>Data stream type.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.containerized</p></td>
<td align="left" valign="top"><p>If the host is a container.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.build</p></td>
<td align="left" valign="top"><p>OS build information.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.codename</p></td>
<td align="left" valign="top"><p>OS codename, if any.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.outlook.app.usage.version.counts.outlook_2007.count</p></td>
<td align="left" valign="top"><p>The count of unique users using Outlook 2007 during the reporting period.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.outlook.app.usage.version.counts.outlook_2010.count</p></td>
<td align="left" valign="top"><p>The count of unique users using Outlook 2010 during the reporting period.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.outlook.app.usage.version.counts.outlook_2013.count</p></td>
<td align="left" valign="top"><p>The count of unique users using Outlook 2013 during the reporting period.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.outlook.app.usage.version.counts.outlook_2016.count</p></td>
<td align="left" valign="top"><p>The count of unique users using Outlook 2016 during the reporting period.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.outlook.app.usage.version.counts.outlook_2019.count</p></td>
<td align="left" valign="top"><p>The count of unique users using Outlook 2019 during the reporting period.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.outlook.app.usage.version.counts.outlook_m365.count</p></td>
<td align="left" valign="top"><p>The count of unique users using the Outlook Microsoft 365 version during the reporting period.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.outlook.app.usage.version.counts.report.period.day</p></td>
<td align="left" valign="top"><p>The duration (e.g., 7 days) over which the report data is aggregated.</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p>d</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.outlook.app.usage.version.counts.report.refresh_date</p></td>
<td align="left" valign="top"><p>The date when the report data was last updated.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.outlook.app.usage.version.counts.undetermined.count</p></td>
<td align="left" valign="top"><p>The count of unique users whose Outlook version could not be identified.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
<div class="position-relative"><h5><a id="o365_metrics-sharepoint-site-usage-detail"></a>SharePoint Site Usage Detail</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/o365_metrics/index.asciidoc">edit</a></div>
<p>Get details about SharePoint Site Usage Detail from <a href="https://learn.microsoft.com/en-us/graph/api/reportroot-getsharepointsiteusagedetail?view=graph-rest-1.0&amp;tabs=http" class="ulink" target="_top">Microsoft Graph API</a>.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Example</strong></span></summary>
<div class="content">
<p>An example event for <code class="literal">sharepoint_site_usage_detail</code> looks as following:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
    "o365": {
        "metrics": {
            "sharepoint": {
                "site": {
                    "usage": {
                        "detail": {
                            "active_file": {
                                "count": 16
                            },
                            "file": {
                                "count": 14
                            },
                            "is_deleted": "False",
                            "owner_display_name": "82D28824CBDAF3EA9AD693254DE8CC08",
                            "page_view": {
                                "count": 12
                            },
                            "report": {
                                "period": {
                                    "day": "7"
                                },
                                "refresh_date": "2024-12-22"
                            },
                            "root_web_template": "Team Site",
                            "site_id": "00000000-0000-0000-0000-000000000000",
                            "storage_allocated": {
                                "byte": 27487790694400
                            },
                            "storage_used": {
                                "byte": 1586077
                            },
                            "visited_page": {
                                "count": 14
                            }
                        }
                    }
                }
            }
        }
    },
    "agent": {
        "name": "docker-fleet-agent",
        "id": "027b7b81-b3c6-49b9-8f61-1a5e892e7bfe",
        "ephemeral_id": "f4133cae-978e-44e1-83e0-cab27e682a99",
        "type": "filebeat",
        "version": "8.16.0"
    },
    "@timestamp": "2024-12-26T23:18:42.620Z",
    "ecs": {
        "version": "8.16.0"
    },
    "data_stream": {
        "namespace": "default",
        "type": "metrics",
        "dataset": "o365_metrics.sharepoint_site_usage_detail"
    },
    "host": {
        "hostname": "docker-fleet-agent",
        "os": {
            "kernel": "5.15.153.1-microsoft-standard-WSL2",
            "codename": "noble",
            "name": "Ubuntu",
            "type": "linux",
            "family": "debian",
            "version": "24.04.1 LTS (Noble Numbat)",
            "platform": "ubuntu"
        },
        "containerized": true,
        "ip": [
            "172.18.0.7"
        ],
        "name": "docker-fleet-agent",
        "mac": [
            "02-42-AC-12-00-07"
        ],
        "architecture": "x86_64"
    },
    "elastic_agent": {
        "id": "027b7b81-b3c6-49b9-8f61-1a5e892e7bfe",
        "version": "8.16.0",
        "snapshot": false
    },
    "event": {
        "agent_id_status": "verified",
        "ingested": "2024-12-26T23:18:52Z",
        "dataset": "o365_metrics.sharepoint_site_usage_detail",
        "original": "{\"IsDeleted\":\"False\",\"SiteId\":\"00000000-0000-0000-0000-000000000000\",\"FileCount\":\"14\",\"StorageAllocated(Byte)\":\"27487790694400\",\"ReportRefreshDate\":\"2024-12-22\",\"ReportPeriod\":\"7\",\"ActiveFileCount\":\"16\",\"OwnerPrincipalName\":\"\",\"VisitedPageCount\":\"14\",\"OwnerDisplayName\":\"82D28824CBDAF3EA9AD693254DE8CC08\",\"SiteURL\":\"\",\"StorageUsedByte\":\"1586077\",\"RootWebTemplate\":\"Team Site\",\"LastActivityDate\":\"\",\"PageViewCount\":\"12\"}"
    },
    "tags": [
        "o365.metrics.sharepoint_site_usage_detail",
        "preserve_original_event"
    ]
}</pre>
</div>
</div>
</details>
<p><span class="strong strong"><strong>ECS Field Reference</strong></span></p>
<p>Please refer to the following <a href="/guide/en/ecs/current/ecs-field-reference.html" class="ulink" target="_top">document</a> for detailed information on ECS fields.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Exported fields</strong></span></summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
<col class="col_5"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Field</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Unit</th>
<th align="left" valign="top">Metric Type</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>@timestamp</p></td>
<td align="left" valign="top"><p>Event timestamp.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cloud.image.id</p></td>
<td align="left" valign="top"><p>Image ID for the cloud instance.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.dataset</p></td>
<td align="left" valign="top"><p>Data stream dataset.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.namespace</p></td>
<td align="left" valign="top"><p>Data stream namespace.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.type</p></td>
<td align="left" valign="top"><p>Data stream type.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.containerized</p></td>
<td align="left" valign="top"><p>If the host is a container.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.build</p></td>
<td align="left" valign="top"><p>OS build information.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.codename</p></td>
<td align="left" valign="top"><p>OS codename, if any.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.sharepoint.site.usage.detail.active_file.count</p></td>
<td align="left" valign="top"><p>The number of active files in the SharePoint site during the reporting period.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.sharepoint.site.usage.detail.file.count</p></td>
<td align="left" valign="top"><p>The total number of files in the SharePoint site.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.sharepoint.site.usage.detail.is_deleted</p></td>
<td align="left" valign="top"><p>Indicates whether the SharePoint site is deleted.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.sharepoint.site.usage.detail.last_activity_date</p></td>
<td align="left" valign="top"><p>The last date of activity in the SharePoint site.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.sharepoint.site.usage.detail.owner_display_name</p></td>
<td align="left" valign="top"><p>The display name of the SharePoint site owner.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.sharepoint.site.usage.detail.owner_principal_name</p></td>
<td align="left" valign="top"><p>The principal name of the SharePoint site owner.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.sharepoint.site.usage.detail.page_view.count</p></td>
<td align="left" valign="top"><p>The number of page views in the SharePoint site during the reporting period.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.sharepoint.site.usage.detail.report.period.day</p></td>
<td align="left" valign="top"><p>The reporting period over which the data is aggregated (in days).</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p>d</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.sharepoint.site.usage.detail.report.refresh_date</p></td>
<td align="left" valign="top"><p>The date when the report data was last updated.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.sharepoint.site.usage.detail.root_web_template</p></td>
<td align="left" valign="top"><p>The template used for the root web of the SharePoint site.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.sharepoint.site.usage.detail.site_id</p></td>
<td align="left" valign="top"><p>The unique identifier of the SharePoint site.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.sharepoint.site.usage.detail.site_url</p></td>
<td align="left" valign="top"><p>The URL of the SharePoint site.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.sharepoint.site.usage.detail.storage_allocated.byte</p></td>
<td align="left" valign="top"><p>The amount of storage allocated to the SharePoint site, in bytes.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p>byte</p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.sharepoint.site.usage.detail.storage_used.byte</p></td>
<td align="left" valign="top"><p>The amount of storage used in the SharePoint site, in bytes.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p>byte</p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.sharepoint.site.usage.detail.visited_page.count</p></td>
<td align="left" valign="top"><p>The number of visited pages in the SharePoint site during the reporting period.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
<div class="position-relative"><h5><a id="o365_metrics-sharepoint-site-usage-storage"></a>SharePoint Site Usage Storage</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/o365_metrics/index.asciidoc">edit</a></div>
<p>Get details about SharePoint Site Usage Storage from <a href="https://learn.microsoft.com/en-us/graph/api/reportroot-getsharepointsiteusagestorage?view=graph-rest-1.0&amp;tabs=http" class="ulink" target="_top">Microsoft Graph API</a>.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Example</strong></span></summary>
<div class="content">
<p>An example event for <code class="literal">sharepoint_site_usage_storage</code> looks as following:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
    "o365": {
        "metrics": {
            "sharepoint": {
                "site": {
                    "usage": {
                        "storage": {
                            "report": {
                                "date": "2024-11-23",
                                "period": {
                                    "day": "7"
                                },
                                "refresh_date": "2024-11-29"
                            },
                            "storage_used": {
                                "byte": 1933176386
                            }
                        }
                    }
                }
            }
        }
    },
    "agent": {
        "name": "docker-fleet-agent",
        "id": "027b7b81-b3c6-49b9-8f61-1a5e892e7bfe",
        "ephemeral_id": "f4133cae-978e-44e1-83e0-cab27e682a99",
        "type": "filebeat",
        "version": "8.16.0"
    },
    "@timestamp": "2024-12-26T23:18:42.620Z",
    "ecs": {
        "version": "8.16.0"
    },
    "data_stream": {
        "namespace": "default",
        "type": "metrics",
        "dataset": "o365_metrics.sharepoint_site_usage_storage"
    },
    "host": {
        "hostname": "docker-fleet-agent",
        "os": {
            "kernel": "5.15.153.1-microsoft-standard-WSL2",
            "codename": "noble",
            "name": "Ubuntu",
            "type": "linux",
            "family": "debian",
            "version": "24.04.1 LTS (Noble Numbat)",
            "platform": "ubuntu"
        },
        "containerized": true,
        "ip": [
            "172.18.0.7"
        ],
        "name": "docker-fleet-agent",
        "mac": [
            "02-42-AC-12-00-07"
        ],
        "architecture": "x86_64"
    },
    "elastic_agent": {
        "id": "027b7b81-b3c6-49b9-8f61-1a5e892e7bfe",
        "version": "8.16.0",
        "snapshot": false
    },
    "event": {
        "agent_id_status": "verified",
        "ingested": "2024-12-26T23:18:52Z",
        "dataset": "o365_metrics.sharepoint_site_usage_storage",
        "original": "{\"Report Date\":\"2024-11-23\",\"Report Period\":\"7\",\"Site Type\":\"All\",\"Storage Used (Byte)\":\"1933176386\",\"Report Refresh Date\":\"2024-11-29\"}"
    },
    "tags": [
        "o365.metrics.sharepoint_site_usage_storage",
        "preserve_original_event"
    ]
}</pre>
</div>
</div>
</details>
<p><span class="strong strong"><strong>ECS Field Reference</strong></span></p>
<p>Please refer to the following <a href="/guide/en/ecs/current/ecs-field-reference.html" class="ulink" target="_top">document</a> for detailed information on ECS fields.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Exported fields</strong></span></summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
<col class="col_5"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Field</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Unit</th>
<th align="left" valign="top">Metric Type</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>@timestamp</p></td>
<td align="left" valign="top"><p>Event timestamp.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cloud.image.id</p></td>
<td align="left" valign="top"><p>Image ID for the cloud instance.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.dataset</p></td>
<td align="left" valign="top"><p>Data stream dataset.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.namespace</p></td>
<td align="left" valign="top"><p>Data stream namespace.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.type</p></td>
<td align="left" valign="top"><p>Data stream type.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.containerized</p></td>
<td align="left" valign="top"><p>If the host is a container.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.build</p></td>
<td align="left" valign="top"><p>OS build information.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.codename</p></td>
<td align="left" valign="top"><p>OS codename, if any.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.sharepoint.site.usage.storage.report.date</p></td>
<td align="left" valign="top"><p>The date the report was generated.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.sharepoint.site.usage.storage.report.period.day</p></td>
<td align="left" valign="top"><p>The reporting period over which the data is aggregated (in days).</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p>d</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.sharepoint.site.usage.storage.report.refresh_date</p></td>
<td align="left" valign="top"><p>The date when the report data was last updated.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.sharepoint.site.usage.storage.storage_used.byte</p></td>
<td align="left" valign="top"><p>The total storage used across SharePoint sites during the reporting period, in bytes.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p>byte</p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
<div class="position-relative"><h5><a id="o365_metrics-teams-user-activity-user-counts"></a>Teams User Activity User Counts</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/o365_metrics/index.asciidoc">edit</a></div>
<p>Get details about Teams User Activity User Counts from <a href="https://learn.microsoft.com/en-us/graph/api/reportroot-getteamsuseractivityusercounts?view=graph-rest-1.0&amp;tabs=http" class="ulink" target="_top">Microsoft Graph API</a>.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Example</strong></span></summary>
<div class="content">
<p>An example event for <code class="literal">teams_user_activity_user_counts</code> looks as following:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
    "o365": {
        "metrics": {
            "teams": {
                "user": {
                    "activity": {
                        "user": {
                            "counts": {
                                "other_actions": {
                                    "count": 0
                                },
                                "calls": {
                                    "count": 0
                                },
                                "private_chat_messages": {
                                    "count": 0
                                },
                                "report": {
                                    "date": "2025-01-13",
                                    "period": {
                                        "day": "7"
                                    },
                                    "refresh_date": "2025-01-19"
                                },
                                "meetings": {
                                    "count": 0
                                },
                                "team_chat_messages": {
                                    "count": 0
                                }
                            }
                        }
                    }
                }
            }
        }
    },
    "agent": {
        "name": "docker-fleet-agent",
        "id": "584e4497-cd3a-4e6f-b4b7-91889923e4e2",
        "type": "filebeat",
        "ephemeral_id": "9beddad6-b97a-43a4-8bd0-ac371e54deb9",
        "version": "8.16.0"
    },
    "@timestamp": "2025-01-13",
    "ecs": {
        "version": "8.16.0"
    },
    "data_stream": {
        "namespace": "default",
        "type": "metrics",
        "dataset": "o365_metrics.teams_user_activity_user_counts"
    },
    "elastic_agent": {
        "id": "584e4497-cd3a-4e6f-b4b7-91889923e4e2",
        "version": "8.16.0",
        "snapshot": false
    },
    "host": {
        "hostname": "docker-fleet-agent",
        "os": {
            "kernel": "5.10.104-linuxkit",
            "name": "Wolfi",
            "family": "",
            "type": "linux",
            "version": "20230201",
            "platform": "wolfi"
        },
        "containerized": false,
        "ip": [
            "172.27.0.7"
        ],
        "name": "docker-fleet-agent",
        "mac": [
            "02-42-AC-1B-00-07"
        ],
        "architecture": "aarch64"
    },
    "event": {
        "agent_id_status": "verified",
        "ingested": "2025-01-21T12:25:43Z",
        "dataset": "o365_metrics.teams_user_activity_user_counts"
    },
    "tags": [
        "o365.metrics.teams.user.activity.user.counts"
    ]
}</pre>
</div>
</div>
</details>
<p><span class="strong strong"><strong>ECS Field Reference</strong></span></p>
<p>Please refer to the following <a href="/guide/en/ecs/current/ecs-field-reference.html" class="ulink" target="_top">document</a> for detailed information on ECS fields.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Exported fields</strong></span></summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
<col class="col_5"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Field</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Unit</th>
<th align="left" valign="top">Metric Type</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>@timestamp</p></td>
<td align="left" valign="top"><p>Event timestamp.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cloud.image.id</p></td>
<td align="left" valign="top"><p>Image ID for the cloud instance.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.dataset</p></td>
<td align="left" valign="top"><p>Data stream dataset.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.namespace</p></td>
<td align="left" valign="top"><p>Data stream namespace.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.type</p></td>
<td align="left" valign="top"><p>Data stream type.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.containerized</p></td>
<td align="left" valign="top"><p>If the host is a container.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.build</p></td>
<td align="left" valign="top"><p>OS build information.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.codename</p></td>
<td align="left" valign="top"><p>OS codename, if any.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.user.activity.user.counts.calls.count</p></td>
<td align="left" valign="top"><p>The number of calls made by Teams users.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.user.activity.user.counts.meetings.count</p></td>
<td align="left" valign="top"><p>The number of meetings attended or organized by Teams users.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.user.activity.user.counts.other_actions.count</p></td>
<td align="left" valign="top"><p>The count of other user actions within Teams.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.user.activity.user.counts.private_chat_messages.count</p></td>
<td align="left" valign="top"><p>The number of messages sent in private 1:1 or group chats.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.user.activity.user.counts.report.date</p></td>
<td align="left" valign="top"><p>The specific date for which the report data applies.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.user.activity.user.counts.report.period.day</p></td>
<td align="left" valign="top"><p>The duration (e.g., 7 days) over which the report data is aggregated.</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p>d</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.user.activity.user.counts.report.refresh_date</p></td>
<td align="left" valign="top"><p>The date when the report data was last updated.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.user.activity.user.counts.team_chat_messages.count</p></td>
<td align="left" valign="top"><p>The number of messages sent in Teams channels.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
<div class="position-relative"><h5><a id="o365_metrics-teams-user-activity-user-detail"></a>Teams User Activity User Detail</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/o365_metrics/index.asciidoc">edit</a></div>
<p>Get details about Teams User Activity User Detail from <a href="https://learn.microsoft.com/en-us/graph/api/reportroot-getteamsuseractivityuserdetail?view=graph-rest-1.0&amp;tabs=http" class="ulink" target="_top">Microsoft Graph API</a>.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Example</strong></span></summary>
<div class="content">
<p>An example event for <code class="literal">teams_user_activity_user_detail</code> looks as following:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
    "@timestamp": "2024-12-15",
    "ecs": {
        "version": "8.16.0"
    },
    "event": {
        "original": "{\"Ad Hoc Meetings Attended Count\":\"1\",\"Ad Hoc Meetings Organized Count\":\"2\",\"Assigned Products\":\"MICROSOFT 365 E5 DEVELOPER (WITHOUT WINDOWS AND AUDIO CONFERENCING)\",\"Audio Duration\":\"PT10S\",\"Audio Duration In Seconds\":\"10\",\"Call Count\":\"10\",\"Deleted Date\":\"\",\"Has Other Action\":\"No\",\"Is Deleted\":\"False\",\"Is Licensed\":\"Yes\",\"Last Activity Date\":\"\",\"Meeting Count\":\"10\",\"Meetings Attended Count\":\"1\",\"Meetings Organized Count\":\"2\",\"Post Messages\":\"100\",\"Private Chat Message Count\":\"1000\",\"Reply Messages\":\"123\",\"Report Period\":\"7\",\"Scheduled One-time Meetings Attended Count\":\"0\",\"Scheduled One-time Meetings Organized Count\":\"2\",\"Scheduled Recurring Meetings Attended Count\":\"3\",\"Scheduled Recurring Meetings Organized Count\":\"1\",\"Screen Share Duration\":\"PT5S\",\"Screen Share Duration In Seconds\":\"5\",\"Shared Channel Tenant Display Names\":\"Channel1\",\"Team Chat Message Count\":\"10\",\"Tenant Display Name\":\"MSFT\",\"Urgent Messages\":\"10\",\"User Id\":\"1345424e-c619-41d3-ab66-948ed302c504\",\"User Principal Name\":\"LH@abc.onmicrosoft.com\",\"Video Duration\":\"PT10S\",\"Video Duration In Seconds\":\"10\",\"Report Refresh Date\":\"2024-12-15\",\"report\": {\"api_path\":\"/reports/getTeamsUserActivityUserDetail\",\"name\":\"Microsoft Teams User Activity User Detail\"}}"
    },
    "o365": {
        "metrics": {
            "report": {
                "api_path": "/reports/getTeamsUserActivityUserDetail",
                "name": "Microsoft Teams User Activity User Detail"
            },
            "teams": {
                "user": {
                    "activity": {
                        "user": {
                            "detail": {
                                "ad_hoc_meetings_attended": {
                                    "count": 1
                                },
                                "ad_hoc_meetings_organized": {
                                    "count": 2
                                },
                                "assigned_products": "MICROSOFT 365 E5 DEVELOPER (WITHOUT WINDOWS AND AUDIO CONFERENCING)",
                                "audio_duration": {
                                    "formatted": "PT10S",
                                    "seconds": 10
                                },
                                "call": {
                                    "count": 10
                                },
                                "has_other_action": "No",
                                "is_deleted": false,
                                "is_licensed": true,
                                "meeting": {
                                    "count": 10
                                },
                                "meetings_attended": {
                                    "count": 1
                                },
                                "meetings_organized": {
                                    "count": 2
                                },
                                "post_messages": {
                                    "count": 100
                                },
                                "private_chat_message": {
                                    "count": 1000
                                },
                                "reply_messages": {
                                    "count": 123
                                },
                                "report": {
                                    "period": {
                                        "day": "7"
                                    },
                                    "refresh_date": "2024-12-15"
                                },
                                "scheduled_one_time_meetings_attended": {
                                    "count": 0
                                },
                                "scheduled_one_time_meetings_organized": {
                                    "count": 2
                                },
                                "scheduled_recurring_meetings_attended": {
                                    "count": 3
                                },
                                "scheduled_recurring_meetings_organized": {
                                    "count": 1
                                },
                                "screen_share_duration": {
                                    "formatted": "PT5S",
                                    "seconds": 5
                                },
                                "shared_channel_tenant_display_names": "Channel1",
                                "team_chat_message": {
                                    "count": 10
                                },
                                "tenant_display_name": "MSFT",
                                "urgent_messages": {
                                    "count": 10
                                },
                                "user_id": "1345424e-c619-41d3-ab66-948ed302c504",
                                "user_principal_name": "LH@abc.onmicrosoft.com",
                                "video_duration": {
                                    "formatted": "PT10S",
                                    "seconds": 10
                                }
                            }
                        }
                    }
                }
            }
        }
    },
    "related": {
        "user": [
            "1345424e-c619-41d3-ab66-948ed302c504",
            "LH@abc.onmicrosoft.com"
        ]
    },
    "tags": [
        "preserve_duplicate_custom_fields",
        "preserve_original_event"
    ],
    "user": {
        "email": "LH@abc.onmicrosoft.com",
        "id": "1345424e-c619-41d3-ab66-948ed302c504",
        "name": "LH@abc.onmicrosoft.com"
    }
}</pre>
</div>
</div>
</details>
<p><span class="strong strong"><strong>ECS Field Reference</strong></span></p>
<p>Please refer to the following <a href="/guide/en/ecs/current/ecs-field-reference.html" class="ulink" target="_top">document</a> for detailed information on ECS fields.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Exported fields</strong></span></summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
<col class="col_5"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Field</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Unit</th>
<th align="left" valign="top">Metric Type</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>@timestamp</p></td>
<td align="left" valign="top"><p>Date/time when the event originated. This is the date/time extracted from the event, typically representing when the event was generated by the source. If the event source has no original timestamp, this value is typically populated by the first time the event was received by the pipeline. Required field for all events.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.dataset</p></td>
<td align="left" valign="top"><p>The field can contain anything that makes sense to signify the source of the data. Examples include <code class="literal">nginx.access</code>, <code class="literal">prometheus</code>, <code class="literal">endpoint</code> etc. For data streams that otherwise fit, but that do not have dataset set we use the value "generic" for the dataset value. <code class="literal">event.dataset</code> should have the same value as <code class="literal">data_stream.dataset</code>. Beyond the Elasticsearch data stream naming criteria noted above, the <code class="literal">dataset</code> value has additional restrictions:   * Must not contain <code class="literal">-</code>   * No longer than 100 characters</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.namespace</p></td>
<td align="left" valign="top"><p>A user defined namespace. Namespaces are useful to allow grouping of data. Many users already organize their indices this way, and the data stream naming scheme now provides this best practice as a default. Many users will populate this field with <code class="literal">default</code>. If no value is used, it falls back to <code class="literal">default</code>. Beyond the Elasticsearch index naming criteria noted above, <code class="literal">namespace</code> value has the additional restrictions:   * Must not contain <code class="literal">-</code>   * No longer than 100 characters</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.type</p></td>
<td align="left" valign="top"><p>An overarching type for the data stream. Currently allowed values are "logs" and "metrics". We expect to also add "traces" and "synthetics" in the near future.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>event.dataset</p></td>
<td align="left" valign="top"><p>Name of the dataset. If an event source publishes more than one type of log or events (e.g. access log, error log), the dataset is used to specify which one the event comes from. It&#8217;s recommended but not required to start the dataset name with the module name, followed by a dot, then the dataset name.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>event.module</p></td>
<td align="left" valign="top"><p>Name of the module this data is coming from. If your monitoring agent supports the concept of modules or plugins to process events of a given source (e.g. Apache logs), <code class="literal">event.module</code> should contain the name of this module.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>labels.is_transform_source</p></td>
<td align="left" valign="top"><p>Distinguishes between documents that are a source for a transform and documents that are an output of a transform, to facilitate easier filtering.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.report.api_path</p></td>
<td align="left" valign="top"><p>Microsoft Graph API path used to pull the report.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.report.name</p></td>
<td align="left" valign="top"><p>Name of the report.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.user.activity.user.detail.ad_hoc_meetings_attended.count</p></td>
<td align="left" valign="top"><p>The number of ad hoc meetings a user participated in during the specified time period.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.user.activity.user.detail.ad_hoc_meetings_organized.count</p></td>
<td align="left" valign="top"><p>The number of ad hoc meetings a user organized during the specified time period.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.user.activity.user.detail.assigned_products</p></td>
<td align="left" valign="top"><p>Microsoft products the user is assigned to.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.user.activity.user.detail.audio_duration.formatted</p></td>
<td align="left" valign="top"><p>The sum of the audio duration of a user used during the specified time period and formatted by ISO 8601.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.user.activity.user.detail.audio_duration.seconds</p></td>
<td align="left" valign="top"><p>The sum of the audio duration of a user used during the specified time period.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.user.activity.user.detail.call.count</p></td>
<td align="left" valign="top"><p>The number of 1:1 calls that the user participated in during the specified time period.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.user.activity.user.detail.deleted_date</p></td>
<td align="left" valign="top"><p>The deleted date of the user.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.user.activity.user.detail.has_other_action</p></td>
<td align="left" valign="top"><p>The User is active but has performed other activities than exposed action types offered in the report.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.user.activity.user.detail.is_deleted</p></td>
<td align="left" valign="top"><p>The deletion status of the user.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.user.activity.user.detail.is_licensed</p></td>
<td align="left" valign="top"><p>Selected if the user is licensed to use Teams.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.user.activity.user.detail.last_activity_date</p></td>
<td align="left" valign="top"><p>The last date that the user participated in a Microsoft Teams activity.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.user.activity.user.detail.meeting.count</p></td>
<td align="left" valign="top"><p>Refer to the <em>meetings_attended.count</em> metric as defined below, as the current metric and <em>meetings_attended.count</em> share the same definition. Microsoft intends to gradually phase out the current metric with <em>meetings_attended.count</em>.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.user.activity.user.detail.meetings_attended.count</p></td>
<td align="left" valign="top"><p>The sum of the one-time scheduled, recurring, ad hoc and unclassified meetings a user participated in during the specified time period.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.user.activity.user.detail.meetings_organized.count</p></td>
<td align="left" valign="top"><p>The sum of one-time scheduled, Recurring, ad hoc and unclassified meetings a user organized during the specified time period.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.user.activity.user.detail.post_messages.count</p></td>
<td align="left" valign="top"><p>The number of post messages in all channels during the specified time period. A post is the original message in a teams chat.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.user.activity.user.detail.private_chat_message.count</p></td>
<td align="left" valign="top"><p>The number of unique messages that the user posted in a private chat during the specified time period.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.user.activity.user.detail.reply_messages.count</p></td>
<td align="left" valign="top"><p>The number of replied messages in all channels during the specified time period.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.user.activity.user.detail.report.period.day</p></td>
<td align="left" valign="top"><p>The reporting period over which the data is aggregated (in days).</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p>d</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.user.activity.user.detail.report.refresh_date</p></td>
<td align="left" valign="top"><p>The date when the report data was last updated.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.user.activity.user.detail.scheduled_one_time_meetings_attended.count</p></td>
<td align="left" valign="top"><p>The number of the one-time scheduled meetings a user participated in during the specified time period.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.user.activity.user.detail.scheduled_one_time_meetings_organized.count</p></td>
<td align="left" valign="top"><p>The number of one-time scheduled meetings a user organized during the specified time period.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.user.activity.user.detail.scheduled_recurring_meetings_attended.count</p></td>
<td align="left" valign="top"><p>The number of the recurring meetings a user participated in during the specified time period.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.user.activity.user.detail.scheduled_recurring_meetings_organized.count</p></td>
<td align="left" valign="top"><p>The number of recurring meetings a user organized during the specified time period.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.user.activity.user.detail.screen_share_duration.formatted</p></td>
<td align="left" valign="top"><p>The sum of the screen share duration of a user used during the specified time period and formatted by ISO 8601.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.user.activity.user.detail.screen_share_duration.seconds</p></td>
<td align="left" valign="top"><p>The sum of the screen share duration of a user used during the specified time period.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.user.activity.user.detail.shared_channel_tenant_display_names</p></td>
<td align="left" valign="top"><p>The names of internal or external tenants of shared channels where the user participated.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.user.activity.user.detail.team_chat_message.count</p></td>
<td align="left" valign="top"><p>The number of unique messages that the user posted in a team chat during the specified time period. This includes original posts and replies.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.user.activity.user.detail.tenant_display_name</p></td>
<td align="left" valign="top"><p>The name of an internal or external tenant where a user belongs.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.user.activity.user.detail.urgent_messages.count</p></td>
<td align="left" valign="top"><p>The number of urgent messages during the specified time period.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.user.activity.user.detail.user_id</p></td>
<td align="left" valign="top"><p>The ID of the user.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.user.activity.user.detail.user_principal_name</p></td>
<td align="left" valign="top"><p>The email address of the user. You can display the actual email address or make this field anonymous. See <a href="https://learn.microsoft.com/en-us/microsoft-365/admin/activity-reports/microsoft-teams-user-activity-preview?view=o365-worldwide#make-the-user-specific-data-anonymous" class="ulink" target="_top">https://learn.microsoft.com/en-us/microsoft-365/admin/activity-reports/microsoft-teams-user-activity-preview?view=o365-worldwide#make-the-user-specific-data-anonymous</a> for more details.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.user.activity.user.detail.video_duration.formatted</p></td>
<td align="left" valign="top"><p>The sum of the video duration of a user used during the specified time period and formatted by ISO 8601.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.user.activity.user.detail.video_duration.seconds</p></td>
<td align="left" valign="top"><p>The sum of the video duration of a user used during the specified time period.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
<div class="position-relative"><h5><a id="o365_metrics-viva-engage-groups-activity-group-detail"></a>Viva Engage Groups Activity Group Detail</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/o365_metrics/index.asciidoc">edit</a></div>
<p>Get details about Yammer Groups Activity Group Detail by group from <a href="https://learn.microsoft.com/en-us/graph/api/reportroot-getyammergroupsactivitydetail?view=graph-rest-1.0&amp;tabs=http" class="ulink" target="_top">Microsoft Graph API</a>.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Example</strong></span></summary>
<div class="content">
<p>An example event for <code class="literal">viva_engage_groups_activity_group_detail</code> looks as following:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
    "@timestamp": "2024-12-23",
    "ecs": {
        "version": "8.16.0"
    },
    "event": {
        "original": "{\"Group Display Name\":\"All Company\",\"Group Type\":\"public\",\"Is Deleted\":\"False\",\"Last Activity Date\":\"2024-12-23\",\"Liked Count\":\"1\",\"Member Count\":\"2\",\"Office 365 Connected\":\"Yes\",\"Owner Principal Name\":\"\",\"Posted Count\":\"\",\"Read Count\":\"\",\"Report Period\":\"1\",\"report\":{\"api_path\":\"/reports/getYammerGroupsActivityDetail\",\"name\":\"Viva Engage Groups Activity Group Detail\"},\"﻿Report Refresh Date\":\"2024-12-23\"}"
    },
    "group": {
        "name": "All Company"
    },
    "o365": {
        "metrics": {
            "report": {
                "api_path": "/reports/getYammerGroupsActivityDetail",
                "name": "Viva Engage Groups Activity Group Detail"
            },
            "viva_engage": {
                "groups": {
                    "activity": {
                        "group": {
                            "detail": {
                                "group_display_name": "All Company",
                                "group_type": "public",
                                "is_deleted": false,
                                "last_activity_date": "2024-12-23T00:00:00.000Z",
                                "liked": {
                                    "count": 1
                                },
                                "member": {
                                    "count": 2
                                },
                                "office_365_connected": true,
                                "report": {
                                    "period": {
                                        "day": "1"
                                    },
                                    "refresh_date": "2024-12-23"
                                }
                            }
                        }
                    }
                }
            }
        }
    },
    "tags": [
        "preserve_duplicate_custom_fields",
        "preserve_original_event"
    ],
    "user": {
        "group": {
            "name": "All Company"
        }
    }
}</pre>
</div>
</div>
</details>
<p><span class="strong strong"><strong>ECS Field Reference</strong></span></p>
<p>Please refer to the following <a href="/guide/en/ecs/current/ecs-field-reference.html" class="ulink" target="_top">document</a> for detailed information on ECS fields.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Exported fields</strong></span></summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
<col class="col_5"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Field</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Unit</th>
<th align="left" valign="top">Metric Type</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>@timestamp</p></td>
<td align="left" valign="top"><p>Date/time when the event originated. This is the date/time extracted from the event, typically representing when the event was generated by the source. If the event source has no original timestamp, this value is typically populated by the first time the event was received by the pipeline. Required field for all events.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.dataset</p></td>
<td align="left" valign="top"><p>The field can contain anything that makes sense to signify the source of the data. Examples include <code class="literal">nginx.access</code>, <code class="literal">prometheus</code>, <code class="literal">endpoint</code> etc. For data streams that otherwise fit, but that do not have dataset set we use the value "generic" for the dataset value. <code class="literal">event.dataset</code> should have the same value as <code class="literal">data_stream.dataset</code>. Beyond the Elasticsearch data stream naming criteria noted above, the <code class="literal">dataset</code> value has additional restrictions:   * Must not contain <code class="literal">-</code>   * No longer than 100 characters</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.namespace</p></td>
<td align="left" valign="top"><p>A user defined namespace. Namespaces are useful to allow grouping of data. Many users already organize their indices this way, and the data stream naming scheme now provides this best practice as a default. Many users will populate this field with <code class="literal">default</code>. If no value is used, it falls back to <code class="literal">default</code>. Beyond the Elasticsearch index naming criteria noted above, <code class="literal">namespace</code> value has the additional restrictions:   * Must not contain <code class="literal">-</code>   * No longer than 100 characters</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.type</p></td>
<td align="left" valign="top"><p>An overarching type for the data stream. Currently allowed values are "logs" and "metrics". We expect to also add "traces" and "synthetics" in the near future.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>event.dataset</p></td>
<td align="left" valign="top"><p>Name of the dataset. If an event source publishes more than one type of log or events (e.g. access log, error log), the dataset is used to specify which one the event comes from. It&#8217;s recommended but not required to start the dataset name with the module name, followed by a dot, then the dataset name.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>event.module</p></td>
<td align="left" valign="top"><p>Name of the module this data is coming from. If your monitoring agent supports the concept of modules or plugins to process events of a given source (e.g. Apache logs), <code class="literal">event.module</code> should contain the name of this module.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>labels.is_transform_source</p></td>
<td align="left" valign="top"><p>Distinguishes between documents that are a source for a transform and documents that are an output of a transform, to facilitate easier filtering.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.report.api_path</p></td>
<td align="left" valign="top"><p>Microsoft Graph API path used to pull the report.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.report.name</p></td>
<td align="left" valign="top"><p>Name of the report.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.viva_engage.groups.activity.group.detail.group_display_name</p></td>
<td align="left" valign="top"><p>The name of the group.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.viva_engage.groups.activity.group.detail.group_type</p></td>
<td align="left" valign="top"><p>The type of group, public or private.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.viva_engage.groups.activity.group.detail.is_deleted</p></td>
<td align="left" valign="top"><p>If the group is deleted, but had activity in the reporting period it will show up in the grid with this flag set to true.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.viva_engage.groups.activity.group.detail.last_activity_date</p></td>
<td align="left" valign="top"><p>The latest date a message was read, posted or liked by the group.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.viva_engage.groups.activity.group.detail.liked.count</p></td>
<td align="left" valign="top"><p>The number of messages liked in the Viva Engage group over the reporting period.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.viva_engage.groups.activity.group.detail.member.count</p></td>
<td align="left" valign="top"><p>The number of members in the group.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.viva_engage.groups.activity.group.detail.office_365_connected</p></td>
<td align="left" valign="top"><p>Indicates whether the Viva Engage group is also a Microsoft 365 group.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.viva_engage.groups.activity.group.detail.owner_principal_name</p></td>
<td align="left" valign="top"><p>The name of the group administrator, or owner.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.viva_engage.groups.activity.group.detail.posted.count</p></td>
<td align="left" valign="top"><p>The number of messages posted in the Viva Engage group over the reporting period.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.viva_engage.groups.activity.group.detail.read.count</p></td>
<td align="left" valign="top"><p>The number of conversations read in the Viva Engage group over the reporting period.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.viva_engage.groups.activity.group.detail.report.period.day</p></td>
<td align="left" valign="top"><p>The reporting period over which the data is aggregated (in days).</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p>d</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.viva_engage.groups.activity.group.detail.report.refresh_date</p></td>
<td align="left" valign="top"><p>The date when the report data was last updated.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
<div class="position-relative"><h5><a id="o365_metrics-viva-engage-device-usage-user-counts"></a>Viva Engage Device Usage User Counts</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/o365_metrics/index.asciidoc">edit</a></div>
<p>Get details about Yammer Device Usage User Counts from <a href="https://learn.microsoft.com/en-us/graph/api/reportroot-getyammerdeviceusageusercounts?view=graph-rest-1.0&amp;tabs=http" class="ulink" target="_top">Microsoft Graph API</a>.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Example</strong></span></summary>
<div class="content">
<p>An example event for <code class="literal">viva_engage_device_usage_user_counts</code> looks as following:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
    "o365": {
        "metrics": {
            "viva": {
                "engage": {
                    "device": {
                        "usage": {
                            "user": {
                                "counts": {
                                    "other": {
                                        "count": 2
                                    },
                                    "windows_phone": {
                                        "count": 12
                                    },
                                    "web": {
                                        "count": 3
                                    },
                                    "report": {
                                        "date": "2025-01-25",
                                        "period": {
                                            "day": "7"
                                        },
                                        "refresh_date": "2025-01-26"
                                    },
                                    "ipad": {
                                        "count": 1
                                    },
                                    "android_phone": {
                                        "count": 6
                                    },
                                    "iphone": {
                                        "count": 4
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    },
    "agent": {
        "name": "docker-fleet-agent",
        "id": "1017792f-50f9-430c-8888-042d046c690b",
        "ephemeral_id": "9d29bf05-61fe-429a-9179-aa2eaf0a42bc",
        "type": "filebeat",
        "version": "8.16.0"
    },
    "@timestamp": "2025-01-25",
    "ecs": {
        "version": "8.16.0"
    },
    "data_stream": {
        "namespace": "default",
        "type": "metrics",
        "dataset": "o365_metrics.viva_engage_device_usage_user_counts"
    },
    "elastic_agent": {
        "id": "1017792f-50f9-430c-8888-042d046c690b",
        "version": "8.16.0",
        "snapshot": false
    },
    "host": {
        "hostname": "docker-fleet-agent",
        "os": {
            "kernel": "5.10.104-linuxkit",
            "name": "Wolfi",
            "type": "linux",
            "family": "",
            "version": "20230201",
            "platform": "wolfi"
        },
        "containerized": false,
        "ip": [
            "192.168.16.7"
        ],
        "name": "docker-fleet-agent",
        "mac": [
            "02-42-C0-A8-10-07"
        ],
        "architecture": "aarch64"
    },
    "event": {
        "agent_id_status": "verified",
        "ingested": "2025-01-28T12:11:16Z",
        "dataset": "o365_metrics.viva_engage_device_usage_user_counts"
    },
    "tags": [
        "o365metrics-viva_engage_device_usage_user_counts"
    ]
}</pre>
</div>
</div>
</details>
<p><span class="strong strong"><strong>ECS Field Reference</strong></span></p>
<p>Please refer to the following <a href="/guide/en/ecs/current/ecs-field-reference.html" class="ulink" target="_top">document</a> for detailed information on ECS fields.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Exported fields</strong></span></summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
<col class="col_5"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Field</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Unit</th>
<th align="left" valign="top">Metric Type</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>@timestamp</p></td>
<td align="left" valign="top"><p>Event timestamp.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cloud.image.id</p></td>
<td align="left" valign="top"><p>Image ID for the cloud instance.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.dataset</p></td>
<td align="left" valign="top"><p>Data stream dataset.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.namespace</p></td>
<td align="left" valign="top"><p>Data stream namespace.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.type</p></td>
<td align="left" valign="top"><p>Data stream type.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.containerized</p></td>
<td align="left" valign="top"><p>If the host is a container.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.build</p></td>
<td align="left" valign="top"><p>OS build information.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.codename</p></td>
<td align="left" valign="top"><p>OS codename, if any.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.viva.engage.device.usage.user.counts.android_phone.count</p></td>
<td align="left" valign="top"><p>The count of users accessing Yammer on Android phones.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.viva.engage.device.usage.user.counts.ipad.count</p></td>
<td align="left" valign="top"><p>The count of users accessing Yammer on iPads.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.viva.engage.device.usage.user.counts.iphone.count</p></td>
<td align="left" valign="top"><p>The count of users accessing Yammer on iPhones.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.viva.engage.device.usage.user.counts.other.count</p></td>
<td align="left" valign="top"><p>The count of users accessing Yammer on devices not listed.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.viva.engage.device.usage.user.counts.report.date</p></td>
<td align="left" valign="top"><p>The specific date for which the report data applies.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.viva.engage.device.usage.user.counts.report.period.day</p></td>
<td align="left" valign="top"><p>The duration (e.g., 7 days) over which the quota status data is aggregated.</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p>d</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.viva.engage.device.usage.user.counts.report.refresh_date</p></td>
<td align="left" valign="top"><p>The date when the report data was last updated.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.viva.engage.device.usage.user.counts.web.count</p></td>
<td align="left" valign="top"><p>The count of users accessing Yammer via web browsers.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.viva.engage.device.usage.user.counts.windows_phone.count</p></td>
<td align="left" valign="top"><p>The count of users accessing Yammer on Windows Phone devices.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
<div class="position-relative"><h5><a id="o365_metrics-teams-device-usage-user-counts"></a>Teams Device Usage User Counts</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/o365_metrics/index.asciidoc">edit</a></div>
<p>Get details about Teams Device Usage User Counts from <a href="https://learn.microsoft.com/en-us/graph/api/reportroot-getteamsdeviceusageusercounts?view=graph-rest-1.0&amp;tabs=http" class="ulink" target="_top">Microsoft Graph API</a>.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Example</strong></span></summary>
<div class="content">
<p>An example event for <code class="literal">teams_device_usage_user_counts</code> looks as following:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
    "o365": {
        "metrics": {
            "teams": {
                "device": {
                    "usage": {
                        "user": {
                            "counts": {
                                "windows_phone": {
                                    "count": 2
                                },
                                "web": {
                                    "count": 1
                                },
                                "linux": {
                                    "count": 10
                                },
                                "report": {
                                    "date": "2025-01-21",
                                    "period": {
                                        "day": "7"
                                    },
                                    "refresh_date": "2025-01-21"
                                },
                                "chrome_os": {
                                    "count": 20
                                },
                                "ios": {
                                    "count": 7
                                },
                                "windows": {
                                    "count": 9
                                },
                                "android_phone": {
                                    "count": 5
                                },
                                "mac": {
                                    "count": 2
                                }
                            }
                        }
                    }
                }
            }
        }
    },
    "agent": {
        "name": "docker-fleet-agent",
        "id": "dd15c14a-87a8-447a-9664-47ede1fae11a",
        "ephemeral_id": "cee4f8bf-01b4-425c-8ecb-a2fa49a97348",
        "type": "filebeat",
        "version": "8.16.0"
    },
    "@timestamp": "2025-01-21",
    "ecs": {
        "version": "8.16.0"
    },
    "data_stream": {
        "namespace": "default",
        "type": "metrics",
        "dataset": "o365_metrics.teams_device_usage_user_counts"
    },
    "elastic_agent": {
        "id": "dd15c14a-87a8-447a-9664-47ede1fae11a",
        "version": "8.16.0",
        "snapshot": false
    },
    "host": {
        "hostname": "docker-fleet-agent",
        "os": {
            "kernel": "5.10.104-linuxkit",
            "name": "Wolfi",
            "type": "linux",
            "family": "",
            "version": "20230201",
            "platform": "wolfi"
        },
        "ip": [
            "172.19.0.7"
        ],
        "containerized": false,
        "name": "docker-fleet-agent",
        "mac": [
            "02-42-AC-13-00-07"
        ],
        "architecture": "aarch64"
    },
    "event": {
        "agent_id_status": "verified",
        "ingested": "2025-01-23T07:00:30Z",
        "dataset": "o365_metrics.teams_device_usage_user_counts"
    },
    "tags": [
        "o365.metrics.teams.device.usage.user.counts"
    ]
}</pre>
</div>
</div>
</details>
<p><span class="strong strong"><strong>ECS Field Reference</strong></span></p>
<p>Please refer to the following <a href="/guide/en/ecs/current/ecs-field-reference.html" class="ulink" target="_top">document</a> for detailed information on ECS fields.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Exported fields</strong></span></summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
<col class="col_5"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Field</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Unit</th>
<th align="left" valign="top">Metric Type</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>@timestamp</p></td>
<td align="left" valign="top"><p>Event timestamp.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cloud.image.id</p></td>
<td align="left" valign="top"><p>Image ID for the cloud instance.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.dataset</p></td>
<td align="left" valign="top"><p>Data stream dataset.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.namespace</p></td>
<td align="left" valign="top"><p>Data stream namespace.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.type</p></td>
<td align="left" valign="top"><p>Data stream type.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.containerized</p></td>
<td align="left" valign="top"><p>If the host is a container.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.build</p></td>
<td align="left" valign="top"><p>OS build information.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.codename</p></td>
<td align="left" valign="top"><p>OS codename, if any.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.device.usage.user.counts.android_phone.count</p></td>
<td align="left" valign="top"><p>The number of active Teams users on Android devices.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.device.usage.user.counts.chrome_os.count</p></td>
<td align="left" valign="top"><p>The number of active Teams users on Chrome OS devices.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.device.usage.user.counts.ios.count</p></td>
<td align="left" valign="top"><p>The number of active Teams users on iOS devices (iPhone and iPad).</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.device.usage.user.counts.linux.count</p></td>
<td align="left" valign="top"><p>The number of active Teams users on Linux devices.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.device.usage.user.counts.mac.count</p></td>
<td align="left" valign="top"><p>The number of active Teams users on macOS devices.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.device.usage.user.counts.report.date</p></td>
<td align="left" valign="top"><p>The specific date for which the report data applies.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.device.usage.user.counts.report.period.day</p></td>
<td align="left" valign="top"><p>The duration (e.g., 7 days) over which the report data is aggregated.</p></td>
<td align="left" valign="top"><p>integer</p></td>
<td align="left" valign="top"><p>d</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.device.usage.user.counts.report.refresh_date</p></td>
<td align="left" valign="top"><p>The date when the report data was last updated.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.device.usage.user.counts.web.count</p></td>
<td align="left" valign="top"><p>The number of active Teams users accessing via web browsers.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.device.usage.user.counts.windows.count</p></td>
<td align="left" valign="top"><p>The number of active Teams users on Windows devices.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.device.usage.user.counts.windows_phone.count</p></td>
<td align="left" valign="top"><p>The number of active Teams users on Windows Phone devices.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
<div class="position-relative"><h5><a id="o365_metrics-service-health"></a>Service Health</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/o365_metrics/index.asciidoc">edit</a></div>
<p>Get details about Service Health from <a href="https://learn.microsoft.com/en-us/graph/api/servicehealth-get?view=graph-rest-1.0&amp;tabs=http" class="ulink" target="_top">Microsoft Graph API</a>.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Example</strong></span></summary>
<div class="content">
<p>An example event for <code class="literal">service_health</code> looks as following:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
    "o365": {
        "metrics": {
            "service": {
                "health": {
                    "status": "serviceOperational",
                    "id": "OSDPPlatform",
                    "service": "Microsoft 365 suite"
                }
            }
        }
    },
    "agent": {
        "name": "docker-fleet-agent",
        "id": "1bd16076-38b3-44b9-980b-eab55ebe95b9",
        "ephemeral_id": "b21b52df-710e-4014-bb1c-d9e60091e1e7",
        "type": "filebeat",
        "version": "8.16.0"
    },
    "@timestamp": "2025-01-07T10:36:47.702Z",
    "ecs": {
        "version": "8.16.0"
    },
    "data_stream": {
        "namespace": "default",
        "type": "metrics",
        "dataset": "o365_metrics.service_health"
    },
    "elastic_agent": {
        "id": "1bd16076-38b3-44b9-980b-eab55ebe95b9",
        "version": "8.16.0",
        "snapshot": false
    },
    "host": {
        "hostname": "docker-fleet-agent",
        "os": {
            "kernel": "5.15.153.1-microsoft-standard-WSL2",
            "codename": "noble",
            "name": "Ubuntu",
            "type": "linux",
            "family": "debian",
            "version": "24.04.1 LTS (Noble Numbat)",
            "platform": "ubuntu"
        },
        "containerized": true,
        "ip": [
            "172.18.0.7"
        ],
        "name": "docker-fleet-agent",
        "mac": [
            "02-42-AC-12-00-07"
        ],
        "architecture": "x86_64"
    },
    "event": {
        "agent_id_status": "verified",
        "ingested": "2025-01-07T10:36:57Z",
        "dataset": "o365_metrics.service_health",
        "original": "{\"service\":\"Microsoft 365 suite\",\"status\":\"serviceOperational\",\"id\":\"OSDPPlatform\"}"
    },
    "tags": [
        "o365.metrics.service.health"
    ]
}</pre>
</div>
</div>
</details>
<p><span class="strong strong"><strong>ECS Field Reference</strong></span></p>
<p>Please refer to the following <a href="/guide/en/ecs/current/ecs-field-reference.html" class="ulink" target="_top">document</a> for detailed information on ECS fields.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Exported fields</strong></span></summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Field</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>@timestamp</p></td>
<td align="left" valign="top"><p>Event timestamp.</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cloud.image.id</p></td>
<td align="left" valign="top"><p>Image ID for the cloud instance.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.dataset</p></td>
<td align="left" valign="top"><p>Data stream dataset.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.namespace</p></td>
<td align="left" valign="top"><p>Data stream namespace.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.type</p></td>
<td align="left" valign="top"><p>Data stream type.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.containerized</p></td>
<td align="left" valign="top"><p>If the host is a container.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.build</p></td>
<td align="left" valign="top"><p>OS build information.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.codename</p></td>
<td align="left" valign="top"><p>OS codename, if any.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.service.health.id</p></td>
<td align="left" valign="top"><p>The service id.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.service.health.service</p></td>
<td align="left" valign="top"><p>The service name.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.service.health.status</p></td>
<td align="left" valign="top"><p>Show the overall service health status (Eg. serviceOperational, serviceOperational etc.).</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
<div class="position-relative"><h5><a id="o365_metrics-subscriptions"></a>Subscriptions</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/o365_metrics/index.asciidoc">edit</a></div>
<p>Get details about Subscriptions from <a href="https://learn.microsoft.com/en-us/graph/api/subscribedsku-list?view=graph-rest-1.0&amp;tabs=http" class="ulink" target="_top">Microsoft Graph API</a>.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Example</strong></span></summary>
<div class="content">
<p>An example event for <code class="literal">subscriptions</code> looks as following:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
    "@timestamp": "2025-04-08T05:48:01.432Z",
    "agent": {
        "ephemeral_id": "f4b88049-f56b-47e7-8ab6-35c3aca09766",
        "id": "3dfd1b6b-ee1c-45ea-93a7-e4da0436f40f",
        "name": "elastic-agent-93924",
        "type": "filebeat",
        "version": "8.16.0"
    },
    "data_stream": {
        "dataset": "o365_metrics.subscriptions",
        "namespace": "90845",
        "type": "metrics"
    },
    "ecs": {
        "version": "8.17.0"
    },
    "elastic_agent": {
        "id": "3dfd1b6b-ee1c-45ea-93a7-e4da0436f40f",
        "snapshot": false,
        "version": "8.16.0"
    },
    "event": {
        "agent_id_status": "verified",
        "dataset": "o365_metrics.subscriptions",
        "ingested": "2025-04-08T05:48:04Z"
    },
    "host": {
        "architecture": "aarch64",
        "containerized": false,
        "hostname": "elastic-agent-93924",
        "ip": [
            "172.31.0.2",
            "172.26.0.4"
        ],
        "mac": [
            "02-42-AC-1A-00-04",
            "02-42-AC-1F-00-02"
        ],
        "name": "elastic-agent-93924",
        "os": {
            "family": "",
            "kernel": "5.10.104-linuxkit",
            "name": "Wolfi",
            "platform": "wolfi",
            "type": "linux",
            "version": "20230201"
        }
    },
    "input": {
        "type": "cel"
    },
    "o365": {
        "metrics": {
            "subscriptions": {
                "account_id": "3f2c-bce5-42b7-8a68-1438af",
                "account_name": "M365x00716596",
                "applies_to": "User",
                "capability_status": "Enabled",
                "consumed_units": {
                    "count": 1
                },
                "id": "3f2c-bce5-42b7-8a68-1438af_f392-07e9-47e9-837c-803d",
                "prepaid_units": {
                    "enabled": {
                        "count": 10000
                    },
                    "locked_out": {
                        "count": 0
                    },
                    "suspended": {
                        "count": 0
                    },
                    "warning": {
                        "count": 0
                    }
                },
                "service_plans": [
                    {
                        "applies_to": "Company",
                        "provisioning_status": "Success",
                        "service_plan_id": "113feb6c-3fe4-4440-bddc-54d774bf0318",
                        "service_plan_name": "EXCHANGE_S_FOUNDATION"
                    },
                    {
                        "applies_to": "User",
                        "provisioning_status": "Success",
                        "service_plan_id": "17ab22cd-a0b3-4536-910a-cb6eb12696c0",
                        "service_plan_name": "DYN365_CDS_VIRAL"
                    },
                    {
                        "applies_to": "User",
                        "provisioning_status": "Success",
                        "service_plan_id": "50e68c76-46c6-4674-81f9-75456511b170",
                        "service_plan_name": "FLOW_P2_VIRAL"
                    }
                ],
                "sku_id": "f392-07e9-47e9-837c-803d",
                "sku_part_number": "Microsoft_Teams_Enterprise_New",
                "subscription_details": [
                    {
                        "created_date_time": "2025-03-16T00:00:00Z",
                        "id": "81209dcb-3bc7-475a-93c0-12b6db4e1429",
                        "is_trial": false,
                        "owner_tenant_id": "xyz",
                        "status": "Enabled",
                        "total_licenses": 10000
                    },
                    {
                        "created_date_time": "2025-03-17T00:00:00Z",
                        "id": "6a5cbbfd-b725-43f8-aae5-7999abf275d1",
                        "is_trial": true,
                        "next_lifecycle_date_time": "2025-07-17T00:00:00Z",
                        "owner_tenant_id": "abc",
                        "status": "Enabled",
                        "total_licenses": 20
                    }
                ],
                "subscription_ids": [
                    "81209dcb-3bc7-475a-93c0-12b6db4e1429",
                    "6a5cbbfd-b725-43f8-aae5-7999abf275d1"
                ],
                "surplus_units": {
                    "count": 9999
                }
            }
        }
    },
    "tags": [
        "o365.metrics.subscriptions"
    ]
}</pre>
</div>
</div>
</details>
<p><span class="strong strong"><strong>ECS Field Reference</strong></span></p>
<p>Please refer to the following <a href="/guide/en/ecs/current/ecs-field-reference.html" class="ulink" target="_top">document</a> for detailed information on ECS fields.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Exported fields</strong></span></summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Field</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Metric Type</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>@timestamp</p></td>
<td align="left" valign="top"><p>Event timestamp.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cloud.image.id</p></td>
<td align="left" valign="top"><p>Image ID for the cloud instance.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.dataset</p></td>
<td align="left" valign="top"><p>Data stream dataset.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.namespace</p></td>
<td align="left" valign="top"><p>Data stream namespace.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.type</p></td>
<td align="left" valign="top"><p>Data stream type.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.containerized</p></td>
<td align="left" valign="top"><p>If the host is a container.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.build</p></td>
<td align="left" valign="top"><p>OS build information.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.codename</p></td>
<td align="left" valign="top"><p>OS codename, if any.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>input.type</p></td>
<td align="left" valign="top"><p>Input type.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.subscriptions.account_id</p></td>
<td align="left" valign="top"><p>The unique ID of the account this SKU belongs to.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.subscriptions.account_name</p></td>
<td align="left" valign="top"><p>The name of the account this SKU belongs to.</p></td>
<td align="left" valign="top"><p>text</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.subscriptions.applies_to</p></td>
<td align="left" valign="top"><p>The target class for this SKU. Only SKUs with target class User are assignable. Possible values are (User, Company).</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.subscriptions.capability_status</p></td>
<td align="left" valign="top"><p>Status of the capability (e.g. Enabled, Suspended).</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.subscriptions.consumed_units.count</p></td>
<td align="left" valign="top"><p>The number of licenses that have been assigned.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.subscriptions.id</p></td>
<td align="left" valign="top"><p>The unique identifier for the subscribed sku object.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.subscriptions.prepaid_units.enabled.count</p></td>
<td align="left" valign="top"><p>The number of units that are enabled for the active subscription of the service SKU.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.subscriptions.prepaid_units.locked_out.count</p></td>
<td align="left" valign="top"><p>The number of units that are locked out because the customer canceled their subscription of the service SKU.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.subscriptions.prepaid_units.suspended.count</p></td>
<td align="left" valign="top"><p>The number of units that are suspended because the subscription of the service SKU has been canceled. The units can&#8217;t be assigned but can still be reactivated before they&#8217;re deleted.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.subscriptions.prepaid_units.warning.count</p></td>
<td align="left" valign="top"><p>The number of units that are in warning status. When the subscription of the service SKU has expired, the customer has a grace period to renew their subscription before it&#8217;s canceled (moved to a suspended state).</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p>gauge</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.subscriptions.service_plans.applies_to</p></td>
<td align="left" valign="top"><p>The object the service plan can be assigned to.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.subscriptions.service_plans.provisioning_status</p></td>
<td align="left" valign="top"><p>The provisioning status of the service plan.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.subscriptions.service_plans.service_plan_id</p></td>
<td align="left" valign="top"><p>Unique identifier for the service plan.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.subscriptions.service_plans.service_plan_name</p></td>
<td align="left" valign="top"><p>Name of the service plan.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.subscriptions.sku_id</p></td>
<td align="left" valign="top"><p>Unique identifier for the SKU.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.subscriptions.sku_part_number</p></td>
<td align="left" valign="top"><p>The SKU part number; for example, AAD_PREMIUM or RMSBASIC.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.subscriptions.subscription_details.created_date_time</p></td>
<td align="left" valign="top"><p>The date and time when this subscription was created.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.subscriptions.subscription_details.id</p></td>
<td align="left" valign="top"><p>The unique ID for the subscription.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.subscriptions.subscription_details.is_trial</p></td>
<td align="left" valign="top"><p>Whether the subscription is a free trial or purchased.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.subscriptions.subscription_details.next_lifecycle_date_time</p></td>
<td align="left" valign="top"><p>The date and time when the subscription will move to the next state (as defined by the status property) if not renewed by the tenant.</p></td>
<td align="left" valign="top"><p>date</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.subscriptions.subscription_details.owner_tenant_id</p></td>
<td align="left" valign="top"><p>The unique identifier for the Microsoft partner tenant that created the subscription on a customer tenant.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.subscriptions.subscription_details.status</p></td>
<td align="left" valign="top"><p>The status of this subscription. Possible values are, Enabled, Deleted, Suspended, Warning, LockedOut.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.subscriptions.subscription_details.subscription_error</p></td>
<td align="left" valign="top"><p>An error if the subscription data is not available.</p></td>
<td align="left" valign="top"><p>text</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.subscriptions.subscription_details.total_licenses</p></td>
<td align="left" valign="top"><p>The number of licenses included in this subscription.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.subscriptions.subscription_ids</p></td>
<td align="left" valign="top"><p>A list of all subscription IDs associated with the SKU.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.subscriptions.surplus_units.count</p></td>
<td align="left" valign="top"><p>Number of unused units which indicates if you oversubscribed to any SKUs.</p></td>
<td align="left" valign="top"><p>long</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
<div class="position-relative"><h5><a id="o365_metrics-teams-call-quality"></a>Teams Call Quality</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/o365_metrics/index.asciidoc">edit</a></div>
<p>Get details about Teams Call Quality from <a href="https://learn.microsoft.com/en-us/graph/api/callrecords-callrecord-list-sessions?view=graph-rest-1.0&amp;tabs=http" class="ulink" target="_top">Microsoft Graph API</a>.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Example</strong></span></summary>
<div class="content">
<p>An example event for <code class="literal">teams_call_quality</code> looks as following:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
    "o365": {
        "metrics": {
            "teams": {
                "call": {
                    "quality": {
                        "callee": {
                            "cpu_cores": {
                                "count": 2
                            },
                            "cpu_name": "Intel(R) Xeon(R) Platinum 8272CL CPU @ 2.60GHz",
                            "cpu_processor_speed": {
                                "mhz": 2594
                            },
                            "feedback": {
                                "rating": "poor",
                                "tokens": {
                                    "distorted_sound": false,
                                    "echo": false,
                                    "interruptions": false,
                                    "low_volume": false,
                                    "no_sound": false,
                                    "noisy": true,
                                    "other_no_sound": false,
                                    "stopped": false
                                }
                            },
                            "identity": {
                                "user": {
                                    "display_name": "Owen Franklin",
                                    "id": "f69e2c00-0000-0000-0000-185e5f5f5d8a",
                                    "tenant_id": "dc368399-474c-4d40-900c-6265431fd81f"
                                }
                            },
                            "name": "machineName_2",
                            "user_agent": {
                                "header_value": "UCCAPI/16.0.12527.20122 OC/16.0.12527.20194 (Skype for Business)",
                                "platform": "windows",
                                "product_family": "skypeForBusiness"
                            }
                        },
                        "caller": {
                            "cpu_cores": {
                                "count": 8
                            },
                            "cpu_name": "AMD EPYC 7452 32-Core Processor",
                            "cpu_processor_speed": {
                                "mhz": 2346
                            },
                            "identity": {
                                "user": {
                                    "display_name": "Abbie Wilkins",
                                    "id": "821809f5-0000-0000-0000-3b5136c0e777",
                                    "tenant_id": "dc368399-474c-4d40-900c-6265431fd81f"
                                }
                            },
                            "name": "machineName_1",
                            "user_agent": {
                                "header_value": "RTCC/7.0.0.0 UCWA/7.0.0.0 AndroidLync/6.25.0.27 (SM-G930U Android 8.0.0)",
                                "platform": "android",
                                "product_family": "skypeForBusiness"
                            }
                        },
                        "end_date_time": "2020-02-25T18:52:46.7640013Z",
                        "id": "e523d2ed-2966-4b6b-925b-754a88034cc5",
                        "is_test": false,
                        "modalities": [
                            "audio"
                        ],
                        "segments": {
                            "callee": {
                                "cpu_cores_count": 2,
                                "cpu_name": "Intel(R) Xeon(R) Platinum 8272CL CPU @ 2.60GHz",
                                "identity": {
                                    "user": {
                                        "display_name": "Owen Franklin",
                                        "id": "f69e2c00-0000-0000-0000-185e5f5f5d8a",
                                        "tenant_id": "dc368399-474c-4d40-900c-6265431fd81f"
                                    }
                                },
                                "name": "machineName_2",
                                "user_agent": {
                                    "header_value": "UCCAPI/16.0.12527.20122 OC/16.0.12527.20194 (Skype for Business)",
                                    "platform": "windows",
                                    "product_family": "skypeForBusiness"
                                }
                            },
                            "caller": {
                                "cpu_cores_count": 8,
                                "cpu_name": "AMD EPYC 7452 32-Core Processor",
                                "cpu_processor_speed_in_mhz": 2346,
                                "identity": {
                                    "user": {
                                        "display_name": "Abbie Wilkins",
                                        "id": "821809f5-0000-0000-0000-3b5136c0e777",
                                        "tenant_id": "dc368399-474c-4d40-900c-6265431fd81f"
                                    }
                                },
                                "name": "machineName_1",
                                "user_agent": {
                                    "header_value": "RTCC/7.0.0.0 UCWA/7.0.0.0 AndroidLync/6.25.0.27 (SM-G930U Android 8.0.0)",
                                    "platform": "android",
                                    "product_family": "skypeForBusiness"
                                }
                            },
                            "end_date_time": "2020-02-25T18:52:46.7640013Z",
                            "id": "e523d2ed-2966-4b6b-925b-754a88034cc5",
                            "media": {
                                "callee_device": {
                                    "capture_device_driver": "Microsoft: 5.0.8638.1100",
                                    "capture_device_name": "Microphone (Microsoft Virtual Audio Device (Simple) (WDM))",
                                    "initial_signal_level_root_mean_square": 146.7885,
                                    "mic_glitch_rate": 143,
                                    "received_noise_level": -86,
                                    "received_signal_level": -14,
                                    "render_device_driver": "Microsoft: 5.0.8638.1100",
                                    "render_device_name": "Speakers (Microsoft Virtual Audio Device (Simple) (WDM))",
                                    "speaker_glitch_rate": 182
                                },
                                "callee_network": {
                                    "bandwidth_low_event_ratio": 0,
                                    "connection_type": "wired",
                                    "delay_event_ratio": 0,
                                    "ip_address": "10.139.0.12",
                                    "link_speed": 4294967295,
                                    "mac_address": "00-00-00-00-00-00-00-00",
                                    "port": 50011,
                                    "received_quality_event_ratio": 0,
                                    "reflexive_ip_address": "127.0.0.2",
                                    "relay_ip_address": "52.114.188.102",
                                    "relay_port": 52810,
                                    "sent_quality_event_ratio": 0.31,
                                    "subnet": "10.139.80.0"
                                },
                                "caller_device": {
                                    "capture_device_name": "Default input device",
                                    "initial_signal_level_root_mean_square": 60.25816,
                                    "mic_glitch_rate": 23,
                                    "received_noise_level": -68,
                                    "received_signal_level": -10,
                                    "render_device_name": "Default output device",
                                    "render_mute_event_ratio": 1,
                                    "render_zero_volume_event_ratio": 1,
                                    "speaker_glitch_rate": 3830
                                },
                                "caller_network": {
                                    "bandwidth_low_event_ratio": 0,
                                    "connection_type": "wifi",
                                    "delay_event_ratio": 0,
                                    "ip_address": "10.150.0.2",
                                    "link_speed": 54000000,
                                    "mac_address": "00-00-00-00-00-00",
                                    "port": 27288,
                                    "received_quality_event_ratio": 0.27,
                                    "reflexive_ip_address": "127.0.0.2",
                                    "relay_ip_address": "52.114.188.32",
                                    "relay_port": 53889,
                                    "sent_quality_event_ratio": 0,
                                    "subnet": "10.150.0.0"
                                },
                                "label": "main-audio",
                                "streams": [
                                    {
                                        "average_audio_network_jitter": "PT0.043S",
                                        "average_bandwidth_estimate": 9965083,
                                        "average_jitter": "PT0.016S",
                                        "average_packet_loss_rate": 0,
                                        "average_round_trip_time": "PT0.061S",
                                        "is_audio_forward_error_correction_used": true,
                                        "max_audio_network_jitter": "PT0.046S",
                                        "max_jitter": "PT0.021S",
                                        "max_packet_loss_rate": 0,
                                        "max_round_trip_time": "PT0.079S",
                                        "packet_utilization": 67,
                                        "stream_direction": "callerToCallee",
                                        "stream_id": "1504545584",
                                        "was_media_bypassed": false
                                    },
                                    {
                                        "average_audio_degradation": 1.160898,
                                        "average_audio_network_jitter": "PT0.266S",
                                        "average_bandwidth_estimate": 15644878,
                                        "average_jitter": "PT0.007S",
                                        "average_packet_loss_rate": 0.01381693,
                                        "average_ratio_of_concealed_samples": 0.06233422,
                                        "average_round_trip_time": "PT0.064S",
                                        "is_audio_forward_error_correction_used": false,
                                        "max_audio_network_jitter": "PT0.474S",
                                        "max_jitter": "PT0.012S",
                                        "max_packet_loss_rate": 0.03738318,
                                        "max_ratio_of_concealed_samples": 0.07192807,
                                        "max_round_trip_time": "PT0.106S",
                                        "packet_utilization": 709,
                                        "stream_direction": "calleeToCaller",
                                        "stream_id": "1785122252",
                                        "was_media_bypassed": false
                                    }
                                ]
                            },
                            "start_date_time": "2020-02-25T18:52:21.2169889Z"
                        },
                        "start_date_time": "2020-02-25T18:52:21.2169889Z"
                    }
                }
            }
        }
    },
    "agent": {
        "name": "docker-fleet-agent",
        "id": "abf38fab-f7b6-4e1c-a3b3-a70a64f9e5db",
        "ephemeral_id": "08417a8d-9698-4c62-b7dc-e1b048647626",
        "type": "filebeat",
        "version": "8.16.0"
    },
    "@timestamp": "2025-01-29T12:36:44.408Z",
    "ecs": {
        "version": "8.16.0"
    },
    "data_stream": {
        "namespace": "default",
        "type": "metrics",
        "dataset": "o365_metrics.teams_call_quality"
    },
    "host": {
        "hostname": "docker-fleet-agent",
        "os": {
            "kernel": "5.10.104-linuxkit",
            "name": "Wolfi",
            "family": "",
            "type": "linux",
            "version": "20230201",
            "platform": "wolfi"
        },
        "ip": [
            "192.168.48.7"
        ],
        "containerized": false,
        "name": "docker-fleet-agent",
        "mac": [
            "02-42-C0-A8-30-07"
        ],
        "architecture": "aarch64"
    },
    "elastic_agent": {
        "id": "abf38fab-f7b6-4e1c-a3b3-a70a64f9e5db",
        "version": "8.16.0",
        "snapshot": false
    },
    "event": {
        "agent_id_status": "verified",
        "ingested": "2025-01-29T12:35:44.48Z",
        "dataset": "o365_metrics.teams_call_quality",
        "original": "{ \"id\": \"e523d2ed-2966-4b6b-925b-754a88034cc5\", \"modalities\": [ \"audio\" ], \"startDateTime\": \"2020-02-25T18:52:21.2169889Z\", \"endDateTime\": \"2020-02-25T18:52:46.7640013Z\", \"isTest\": false, \"caller\": { \"@odata.type\": \"#microsoft.graph.callRecords.participantEndpoint\", \"name\": \"machineName_1\", \"cpuName\": \"AMD EPYC 7452 32-Core Processor\", \"cpuCoresCount\": 8, \"cpuProcessorSpeedInMhz\": 2346, \"userAgent\": { \"@odata.type\": \"#microsoft.graph.callRecords.clientUserAgent\", \"headerValue\": \"RTCC\/7.0.0.0 UCWA\/7.0.0.0 AndroidLync\/6.25.0.27 (SM-G930U Android 8.0.0)\", \"platform\": \"android\", \"productFamily\": \"skypeForBusiness\" }, \"identity\": { \"@odata.type\": \"#microsoft.graph.identitySet\", \"user\": { \"id\": \"821809f5-0000-0000-0000-3b5136c0e777\", \"displayName\": \"Abbie Wilkins\", \"tenantId\": \"dc368399-474c-4d40-900c-6265431fd81f\" } } }, \"callee\": { \"@odata.type\": \"#microsoft.graph.callRecords.participantEndpoint\", \"name\": \"machineName_2\", \"cpuName\": \"Intel(R) Xeon(R) Platinum 8272CL CPU @ 2.60GHz\", \"cpuCoresCount\": 2, \"cpuProcessorSpeedInMhz\": 2594, \"userAgent\": { \"@odata.type\": \"#microsoft.graph.callRecords.clientUserAgent\", \"headerValue\": \"UCCAPI\/16.0.12527.20122 OC\/16.0.12527.20194 (Skype for Business)\", \"platform\": \"windows\", \"productFamily\": \"skypeForBusiness\" }, \"identity\": { \"user\": { \"id\": \"f69e2c00-0000-0000-0000-185e5f5f5d8a\", \"displayName\": \"Owen Franklin\", \"tenantId\": \"dc368399-474c-4d40-900c-6265431fd81f\" } }, \"feedback\": { \"rating\": \"poor\", \"tokens\": { \"NoSound\": false, \"OtherNoSound\": false, \"Echo\": false, \"Noisy\": true, \"LowVolume\": false, \"Stopped\": false, \"DistortedSound\": false, \"Interruptions\": false } } }, \"segments\": [ { \"startDateTime\": \"2020-02-25T18:52:21.2169889Z\", \"endDateTime\": \"2020-02-25T18:52:46.7640013Z\", \"id\": \"e523d2ed-2966-4b6b-925b-754a88034cc5\", \"caller\": { \"@odata.type\": \"#microsoft.graph.callRecords.participantEndpoint\", \"name\": \"machineName_1\", \"cpuName\": \"AMD EPYC 7452 32-Core Processor\", \"cpuCoresCount\": 8, \"cpuProcessorSpeedInMhz\": 2346, \"userAgent\": { \"@odata.type\": \"#microsoft.graph.callRecords.clientUserAgent\", \"headerValue\": \"RTCC\/7.0.0.0 UCWA\/7.0.0.0 AndroidLync\/6.25.0.27 (SM-G930U Android 8.0.0)\", \"platform\": \"android\", \"productFamily\": \"skypeForBusiness\" }, \"identity\": { \"user\": { \"id\": \"821809f5-0000-0000-0000-3b5136c0e777\", \"displayName\": \"Abbie Wilkins\", \"tenantId\": \"dc368399-474c-4d40-900c-6265431fd81f\" } } }, \"callee\": { \"@odata.type\": \"#microsoft.graph.callRecords.participantEndpoint\", \"name\": \"machineName_2\", \"cpuName\": \"Intel(R) Xeon(R) Platinum 8272CL CPU @ 2.60GHz\", \"cpuCoresCount\": 2, \"userAgent\": { \"@odata.type\": \"#microsoft.graph.callRecords.clientUserAgent\", \"headerValue\": \"UCCAPI\/16.0.12527.20122 OC\/16.0.12527.20194 (Skype for Business)\", \"platform\": \"windows\", \"productFamily\": \"skypeForBusiness\" }, \"identity\": { \"user\": { \"id\": \"f69e2c00-0000-0000-0000-185e5f5f5d8a\", \"displayName\": \"Owen Franklin\", \"tenantId\": \"dc368399-474c-4d40-900c-6265431fd81f\" } } }, \"media\": [ { \"label\": \"main-audio\", \"callerNetwork\": { \"ipAddress\": \"10.150.0.2\", \"subnet\": \"10.150.0.0\", \"linkSpeed\": 54000000, \"connectionType\": \"wifi\", \"port\": 27288, \"reflexiveIPAddress\": \"127.0.0.2\", \"relayIPAddress\": \"52.114.188.32\", \"relayPort\": 53889, \"macAddress\": \"00-00-00-00-00-00\", \"dnsSuffix\": null, \"sentQualityEventRatio\": 0, \"receivedQualityEventRatio\": 0.27, \"delayEventRatio\": 0, \"bandwidthLowEventRatio\": 0 }, \"calleeNetwork\": { \"ipAddress\": \"10.139.0.12\", \"subnet\": \"10.139.80.0\", \"linkSpeed\": 4294967295, \"connectionType\": \"wired\", \"port\": 50011, \"reflexiveIPAddress\": \"127.0.0.2\", \"relayIPAddress\": \"52.114.188.102\", \"relayPort\": 52810, \"macAddress\": \"00-00-00-00-00-00-00-00\", \"dnsSuffix\": null, \"sentQualityEventRatio\": 0.31, \"receivedQualityEventRatio\": 0, \"delayEventRatio\": 0, \"bandwidthLowEventRatio\": 0 }, \"callerDevice\": { \"captureDeviceName\": \"Default input device\", \"renderDeviceName\": \"Default output device\", \"receivedSignalLevel\": -10, \"receivedNoiseLevel\": -68, \"initialSignalLevelRootMeanSquare\": 60.25816, \"renderZeroVolumeEventRatio\": 1, \"renderMuteEventRatio\": 1, \"micGlitchRate\": 23, \"speakerGlitchRate\": 3830 }, \"calleeDevice\": { \"captureDeviceName\": \"Microphone (Microsoft Virtual Audio Device (Simple) (WDM))\", \"captureDeviceDriver\": \"Microsoft: 5.0.8638.1100\", \"renderDeviceName\": \"Speakers (Microsoft Virtual Audio Device (Simple) (WDM))\", \"renderDeviceDriver\": \"Microsoft: 5.0.8638.1100\", \"receivedSignalLevel\": -14, \"receivedNoiseLevel\": -86, \"initialSignalLevelRootMeanSquare\": 146.7885, \"micGlitchRate\": 143, \"speakerGlitchRate\": 182 }, \"streams\": [ { \"streamId\": \"1504545584\", \"streamDirection\": \"callerToCallee\", \"averageAudioDegradation\": null, \"averageJitter\": \"PT0.016S\", \"maxJitter\": \"PT0.021S\", \"averagePacketLossRate\": 0, \"maxPacketLossRate\": 0, \"averageRatioOfConcealedSamples\": null, \"maxRatioOfConcealedSamples\": null, \"averageRoundTripTime\": \"PT0.061S\", \"maxRoundTripTime\": \"PT0.079S\", \"packetUtilization\": 67, \"averageBandwidthEstimate\": 9965083, \"wasMediaBypassed\": false, \"averageAudioNetworkJitter\": \"PT0.043S\", \"maxAudioNetworkJitter\": \"PT0.046S\", \"rmsFreezeDuration\": null, \"averageFreezeDuration\": null, \"isAudioForwardErrorCorrectionUsed\": true }, { \"streamId\": \"1785122252\", \"streamDirection\": \"calleeToCaller\", \"averageAudioDegradation\": 1.160898, \"averageJitter\": \"PT0.007S\", \"maxJitter\": \"PT0.012S\", \"averagePacketLossRate\": 0.01381693, \"maxPacketLossRate\": 0.03738318, \"averageRatioOfConcealedSamples\": 0.06233422, \"maxRatioOfConcealedSamples\": 0.07192807, \"averageRoundTripTime\": \"PT0.064S\", \"maxRoundTripTime\": \"PT0.106S\", \"packetUtilization\": 709, \"averageBandwidthEstimate\": 15644878, \"wasMediaBypassed\": false, \"averageAudioNetworkJitter\": \"PT0.266S\", \"maxAudioNetworkJitter\": \"PT0.474S\", \"rmsFreezeDuration\": null, \"averageFreezeDuration\": null, \"isAudioForwardErrorCorrectionUsed\": false } ] } ] } ] }"
    },
    "tags": [
        "o365metrics-teams.call.quality"
    ]
}</pre>
</div>
</div>
</details>
<p><span class="strong strong"><strong>ECS Field Reference</strong></span></p>
<p>Please refer to the following <a href="/guide/en/ecs/current/ecs-field-reference.html" class="ulink" target="_top">document</a> for detailed information on ECS fields.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Exported fields</strong></span></summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Field</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>@timestamp</p></td>
<td align="left" valign="top"><p>Event timestamp.</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>cloud.image.id</p></td>
<td align="left" valign="top"><p>Image ID for the cloud instance.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.dataset</p></td>
<td align="left" valign="top"><p>Data stream dataset.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.namespace</p></td>
<td align="left" valign="top"><p>Data stream namespace.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.type</p></td>
<td align="left" valign="top"><p>Data stream type.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.containerized</p></td>
<td align="left" valign="top"><p>If the host is a container.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.build</p></td>
<td align="left" valign="top"><p>OS build information.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>host.os.codename</p></td>
<td align="left" valign="top"><p>OS codename, if any.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>input.type</p></td>
<td align="left" valign="top"><p>Type of Filebeat input.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.callee.cpu_cores.count</p></td>
<td align="left" valign="top"><p>The number of CPU cores on the callee&#8217;s device</p></td>
<td align="left" valign="top"><p>long</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.callee.cpu_name</p></td>
<td align="left" valign="top"><p>The name of the CPU on the callee&#8217;s device</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.callee.cpu_processor_speed.mhz</p></td>
<td align="left" valign="top"><p>The processor speed in MHz on the callee&#8217;s CPU</p></td>
<td align="left" valign="top"><p>long</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.callee.feedback.rating</p></td>
<td align="left" valign="top"><p>The rating the callee gave for the call quality</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.callee.feedback.tokens.distorted_sound</p></td>
<td align="left" valign="top"><p>Whether distorted sound was reported by the callee</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.callee.feedback.tokens.echo</p></td>
<td align="left" valign="top"><p>Whether echo was reported by the callee</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.callee.feedback.tokens.interruptions</p></td>
<td align="left" valign="top"><p>Whether interruptions were reported by the callee</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.callee.feedback.tokens.low_volume</p></td>
<td align="left" valign="top"><p>Whether low volume was reported by the callee</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.callee.feedback.tokens.no_sound</p></td>
<td align="left" valign="top"><p>Whether no sound was reported by the callee</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.callee.feedback.tokens.noisy</p></td>
<td align="left" valign="top"><p>Whether background noise was reported by the callee</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.callee.feedback.tokens.other_no_sound</p></td>
<td align="left" valign="top"><p>Whether other no sound issues were reported by the callee</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.callee.feedback.tokens.stopped</p></td>
<td align="left" valign="top"><p>Whether the call was stopped prematurely by the callee</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.callee.identity.user.display_name</p></td>
<td align="left" valign="top"><p>The display name of the callee</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.callee.identity.user.id</p></td>
<td align="left" valign="top"><p>The unique user ID for the callee</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.callee.identity.user.tenant_id</p></td>
<td align="left" valign="top"><p>The tenant ID of the callee&#8217;s organization</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.callee.name</p></td>
<td align="left" valign="top"><p>The name of the callee</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.callee.user_agent.header_value</p></td>
<td align="left" valign="top"><p>The header value of the user agent</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.callee.user_agent.platform</p></td>
<td align="left" valign="top"><p>The platform of the callee (e.g., Windows, macOS)</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.callee.user_agent.product_family</p></td>
<td align="left" valign="top"><p>The product family of the callee (e.g., Teams, Skype)</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.caller.cpu_cores.count</p></td>
<td align="left" valign="top"><p>The number of CPU cores on the caller&#8217;s device</p></td>
<td align="left" valign="top"><p>long</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.caller.cpu_name</p></td>
<td align="left" valign="top"><p>The name of the CPU on the caller&#8217;s device</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.caller.cpu_processor_speed.mhz</p></td>
<td align="left" valign="top"><p>The processor speed in MHz on the caller&#8217;s CPU</p></td>
<td align="left" valign="top"><p>long</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.caller.identity.user.display_name</p></td>
<td align="left" valign="top"><p>The display name of the caller</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.caller.identity.user.id</p></td>
<td align="left" valign="top"><p>The unique user ID for the caller</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.caller.identity.user.tenant_id</p></td>
<td align="left" valign="top"><p>The tenant ID of the caller&#8217;s organization</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.caller.name</p></td>
<td align="left" valign="top"><p>The name of the caller</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.caller.user_agent.header_value</p></td>
<td align="left" valign="top"><p>The header value of the user agent</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.caller.user_agent.platform</p></td>
<td align="left" valign="top"><p>The platform of the caller (e.g., Windows, macOS)</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.caller.user_agent.product_family</p></td>
<td align="left" valign="top"><p>The product family of the caller (e.g., Teams, Skype)</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.end_date_time</p></td>
<td align="left" valign="top"><p>The end date and time of the call</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.id</p></td>
<td align="left" valign="top"><p>Unique identifier for the call quality record</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.is_test</p></td>
<td align="left" valign="top"><p>Indicates whether the call is a test call</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.modalities</p></td>
<td align="left" valign="top"><p>Types of communication used in the call (audio, video, etc.)</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.callee.cpu_cores_count</p></td>
<td align="left" valign="top"><p>The number of CPU cores on the callee&#8217;s device</p></td>
<td align="left" valign="top"><p>long</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.callee.cpu_name</p></td>
<td align="left" valign="top"><p>The name of the CPU on the callee&#8217;s device</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.callee.cpu_processor_speed_in_mhz</p></td>
<td align="left" valign="top"><p>The processor speed in MHz on the callee&#8217;s CPU</p></td>
<td align="left" valign="top"><p>long</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.callee.feedback.rating</p></td>
<td align="left" valign="top"><p>The rating the callee gave for the call quality</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.callee.feedback.tokens.distorted_sound</p></td>
<td align="left" valign="top"><p>Whether distorted sound was reported by the callee</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.callee.feedback.tokens.echo</p></td>
<td align="left" valign="top"><p>Whether echo was reported by the callee</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.callee.feedback.tokens.interruptions</p></td>
<td align="left" valign="top"><p>Whether interruptions were reported by the callee</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.callee.feedback.tokens.low_volume</p></td>
<td align="left" valign="top"><p>Whether low volume was reported by the callee</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.callee.feedback.tokens.no_sound</p></td>
<td align="left" valign="top"><p>Whether no sound was reported by the callee</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.callee.feedback.tokens.noisy</p></td>
<td align="left" valign="top"><p>Whether background noise was reported by the callee</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.callee.feedback.tokens.other_no_sound</p></td>
<td align="left" valign="top"><p>Whether other no sound issues were reported by the callee</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.callee.feedback.tokens.stopped</p></td>
<td align="left" valign="top"><p>Whether the call was stopped prematurely by the callee</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.callee.identity.user.display_name</p></td>
<td align="left" valign="top"><p>The display name of the callee</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.callee.identity.user.id</p></td>
<td align="left" valign="top"><p>The unique user ID for the callee</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.callee.identity.user.tenant_id</p></td>
<td align="left" valign="top"><p>The tenant ID of the callee&#8217;s organization</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.callee.name</p></td>
<td align="left" valign="top"><p>The name of the callee</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.callee.user_agent.header_value</p></td>
<td align="left" valign="top"><p>The header value of the user agent</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.callee.user_agent.platform</p></td>
<td align="left" valign="top"><p>The platform of the callee (e.g., Windows, macOS)</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.callee.user_agent.product_family</p></td>
<td align="left" valign="top"><p>The product family of the callee (e.g., Teams, Skype)</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.caller.cpu_cores_count</p></td>
<td align="left" valign="top"><p>The number of CPU cores on the caller&#8217;s device</p></td>
<td align="left" valign="top"><p>long</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.caller.cpu_name</p></td>
<td align="left" valign="top"><p>The name of the CPU on the caller&#8217;s device</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.caller.cpu_processor_speed_in_mhz</p></td>
<td align="left" valign="top"><p>The processor speed in MHz on the caller&#8217;s CPU</p></td>
<td align="left" valign="top"><p>long</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.caller.identity.user.display_name</p></td>
<td align="left" valign="top"><p>The display name of the caller</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.caller.identity.user.id</p></td>
<td align="left" valign="top"><p>The unique user ID for the caller</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.caller.identity.user.tenant_id</p></td>
<td align="left" valign="top"><p>The tenant ID of the caller&#8217;s organization</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.caller.name</p></td>
<td align="left" valign="top"><p>The name of the caller</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.caller.user_agent.header_value</p></td>
<td align="left" valign="top"><p>The header value of the user agent</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.caller.user_agent.platform</p></td>
<td align="left" valign="top"><p>The platform of the caller (e.g., Windows, macOS)</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.caller.user_agent.product_family</p></td>
<td align="left" valign="top"><p>The product family of the caller (e.g., Teams, Skype)</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.end_date_time</p></td>
<td align="left" valign="top"><p>End time of the segment</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.id</p></td>
<td align="left" valign="top"><p>Unique identifier for the segment</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.callee_device.capture_device_driver</p></td>
<td align="left" valign="top"><p>The name of the callee&#8217;s capture device driver</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.callee_device.capture_device_name</p></td>
<td align="left" valign="top"><p>The name of the callee&#8217;s capture device</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.callee_device.initial_signal_level_root_mean_square</p></td>
<td align="left" valign="top"><p>Initial RMS of the callee&#8217;s signal level</p></td>
<td align="left" valign="top"><p>float</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.callee_device.mic_glitch_rate</p></td>
<td align="left" valign="top"><p>The glitch rate for the callee&#8217;s microphone</p></td>
<td align="left" valign="top"><p>float</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.callee_device.received_noise_level</p></td>
<td align="left" valign="top"><p>The received noise level on the callee&#8217;s device</p></td>
<td align="left" valign="top"><p>float</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.callee_device.received_signal_level</p></td>
<td align="left" valign="top"><p>The received signal level on the callee&#8217;s device</p></td>
<td align="left" valign="top"><p>float</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.callee_device.render_device_driver</p></td>
<td align="left" valign="top"><p>The name of the callee&#8217;s render device driver</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.callee_device.render_device_name</p></td>
<td align="left" valign="top"><p>The name of the callee&#8217;s render device</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.callee_device.speaker_glitch_rate</p></td>
<td align="left" valign="top"><p>The glitch rate for the callee&#8217;s speaker</p></td>
<td align="left" valign="top"><p>float</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.callee_network.bandwidth_low_event_ratio</p></td>
<td align="left" valign="top"><p>The event ratio of low bandwidth for the callee&#8217;s network</p></td>
<td align="left" valign="top"><p>float</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.callee_network.connection_type</p></td>
<td align="left" valign="top"><p>Type of connection used (e.g., wifi, wired)</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.callee_network.delay_event_ratio</p></td>
<td align="left" valign="top"><p>The event ratio of delay in the callee&#8217;s network</p></td>
<td align="left" valign="top"><p>float</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.callee_network.dns_suffix</p></td>
<td align="left" valign="top"><p>DNS suffix for the callee&#8217;s network</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.callee_network.ip_address</p></td>
<td align="left" valign="top"><p>IP address of the callee&#8217;s network</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.callee_network.link_speed</p></td>
<td align="left" valign="top"><p>Link speed of the callee&#8217;s network connection</p></td>
<td align="left" valign="top"><p>long</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.callee_network.mac_address</p></td>
<td align="left" valign="top"><p>MAC address of the callee&#8217;s device</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.callee_network.port</p></td>
<td align="left" valign="top"><p>Port used for the connection</p></td>
<td align="left" valign="top"><p>long</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.callee_network.received_quality_event_ratio</p></td>
<td align="left" valign="top"><p>Quality event ratio related to the received network quality</p></td>
<td align="left" valign="top"><p>float</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.callee_network.reflexive_ip_address</p></td>
<td align="left" valign="top"><p>Reflexive IP address for the callee&#8217;s network</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.callee_network.relay_ip_address</p></td>
<td align="left" valign="top"><p>Relay IP address for the callee&#8217;s network</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.callee_network.relay_port</p></td>
<td align="left" valign="top"><p>Relay port</p></td>
<td align="left" valign="top"><p>long</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.callee_network.sent_quality_event_ratio</p></td>
<td align="left" valign="top"><p>Quality event ratio related to the callee&#8217;s network</p></td>
<td align="left" valign="top"><p>float</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.callee_network.subnet</p></td>
<td align="left" valign="top"><p>Subnet of the callee&#8217;s network</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.caller_device.capture_device_name</p></td>
<td align="left" valign="top"><p>The name of the caller&#8217;s capture device</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.caller_device.initial_signal_level_root_mean_square</p></td>
<td align="left" valign="top"><p>Initial RMS of the caller&#8217;s signal level</p></td>
<td align="left" valign="top"><p>float</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.caller_device.mic_glitch_rate</p></td>
<td align="left" valign="top"><p>The glitch rate for the caller&#8217;s microphone</p></td>
<td align="left" valign="top"><p>float</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.caller_device.received_noise_level</p></td>
<td align="left" valign="top"><p>The received noise level on the caller&#8217;s device</p></td>
<td align="left" valign="top"><p>float</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.caller_device.received_signal_level</p></td>
<td align="left" valign="top"><p>The received signal level on the caller&#8217;s device</p></td>
<td align="left" valign="top"><p>float</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.caller_device.render_device_name</p></td>
<td align="left" valign="top"><p>The name of the caller&#8217;s render device</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.caller_device.render_mute_event_ratio</p></td>
<td align="left" valign="top"><p>Ratio of mute events during rendering</p></td>
<td align="left" valign="top"><p>float</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.caller_device.render_zero_volume_event_ratio</p></td>
<td align="left" valign="top"><p>Ratio of zero volume events during rendering</p></td>
<td align="left" valign="top"><p>float</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.caller_device.speaker_glitch_rate</p></td>
<td align="left" valign="top"><p>The glitch rate for the caller&#8217;s speaker</p></td>
<td align="left" valign="top"><p>float</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.caller_network.bandwidth_low_event_ratio</p></td>
<td align="left" valign="top"><p>The event ratio of low bandwidth for the caller&#8217;s network</p></td>
<td align="left" valign="top"><p>float</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.caller_network.connection_type</p></td>
<td align="left" valign="top"><p>Type of connection used (e.g., wifi, wired)</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.caller_network.delay_event_ratio</p></td>
<td align="left" valign="top"><p>The event ratio of delay in the caller&#8217;s network</p></td>
<td align="left" valign="top"><p>float</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.caller_network.dns_suffix</p></td>
<td align="left" valign="top"><p>DNS suffix for the caller&#8217;s network</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.caller_network.ip_address</p></td>
<td align="left" valign="top"><p>IP address of the caller&#8217;s network</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.caller_network.link_speed</p></td>
<td align="left" valign="top"><p>Link speed of the caller&#8217;s network connection</p></td>
<td align="left" valign="top"><p>long</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.caller_network.mac_address</p></td>
<td align="left" valign="top"><p>MAC address of the caller&#8217;s device</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.caller_network.port</p></td>
<td align="left" valign="top"><p>Port used for the connection</p></td>
<td align="left" valign="top"><p>long</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.caller_network.received_quality_event_ratio</p></td>
<td align="left" valign="top"><p>Quality event ratio related to the received network quality</p></td>
<td align="left" valign="top"><p>float</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.caller_network.reflexive_ip_address</p></td>
<td align="left" valign="top"><p>Reflexive IP address for the caller&#8217;s network</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.caller_network.relay_ip_address</p></td>
<td align="left" valign="top"><p>Relay IP address for the caller&#8217;s network</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.caller_network.relay_port</p></td>
<td align="left" valign="top"><p>Relay port</p></td>
<td align="left" valign="top"><p>long</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.caller_network.sent_quality_event_ratio</p></td>
<td align="left" valign="top"><p>Quality event ratio related to the caller&#8217;s network</p></td>
<td align="left" valign="top"><p>float</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.caller_network.subnet</p></td>
<td align="left" valign="top"><p>Subnet of the caller&#8217;s network</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.label</p></td>
<td align="left" valign="top"><p>The label for the media stream (e.g., "main-audio")</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.streams.average_audio_degradation</p></td>
<td align="left" valign="top"><p>Average audio degradation metric</p></td>
<td align="left" valign="top"><p>float</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.streams.average_audio_network_jitter</p></td>
<td align="left" valign="top"><p>Average audio network jitter in milliseconds</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.streams.average_bandwidth_estimate</p></td>
<td align="left" valign="top"><p>Average bandwidth estimate in bits per second</p></td>
<td align="left" valign="top"><p>float</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.streams.average_jitter</p></td>
<td align="left" valign="top"><p>Average jitter in milliseconds</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.streams.average_packet_loss_rate</p></td>
<td align="left" valign="top"><p>Average rate of packet loss</p></td>
<td align="left" valign="top"><p>float</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.streams.average_ratio_of_concealed_samples</p></td>
<td align="left" valign="top"><p>Average ratio of concealed samples</p></td>
<td align="left" valign="top"><p>float</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.streams.average_round_trip_time</p></td>
<td align="left" valign="top"><p>Average round trip time in milliseconds</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.streams.is_audio_forward_error_correction_used</p></td>
<td align="left" valign="top"><p>Indicates if audio forward error correction was used</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.streams.max_audio_network_jitter</p></td>
<td align="left" valign="top"><p>Maximum audio network jitter in milliseconds</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.streams.max_jitter</p></td>
<td align="left" valign="top"><p>Maximum jitter in milliseconds</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.streams.max_packet_loss_rate</p></td>
<td align="left" valign="top"><p>Maximum rate of packet loss</p></td>
<td align="left" valign="top"><p>float</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.streams.max_ratio_of_concealed_samples</p></td>
<td align="left" valign="top"><p></p></td>
<td align="left" valign="top"><p>float</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.streams.max_round_trip_time</p></td>
<td align="left" valign="top"><p>Maximum round trip time in milliseconds</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.streams.packet_utilization</p></td>
<td align="left" valign="top"><p>Utilization rate of packets</p></td>
<td align="left" valign="top"><p>float</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.streams.stream_direction</p></td>
<td align="left" valign="top"><p>Direction of the media stream</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.streams.stream_id</p></td>
<td align="left" valign="top"><p>The stream ID</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.media.streams.was_media_bypassed</p></td>
<td align="left" valign="top"><p>Indicates if media was bypassed</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.quality_score</p></td>
<td align="left" valign="top"><p>Quality score of the call segment</p></td>
<td align="left" valign="top"><p>float</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.segments.start_date_time</p></td>
<td align="left" valign="top"><p>Start time of the segment</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.teams.call.quality.start_date_time</p></td>
<td align="left" valign="top"><p>The start date and time of the call</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
<div class="position-relative"><h5><a id="o365_metrics-tenant-settings"></a>Tenant Settings</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/o365_metrics/index.asciidoc">edit</a></div>
<p>Get details about tenant settings in Microsoft Entra ID.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Example</strong></span></summary>
<div class="content">
<p>An example event for <code class="literal">tenant_settings</code> looks as following:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
    "o365": {
        "metrics": {
            "tenant_settings": {
                "display_concealed_names": true,
                "tenant": {
                    "id": "f99cbd5a-95d6-4767-9372-0d41ca2ead9d",
                    "type": "AAD",
                    "display_name": "azure2"
                }
            }
        }
    },
    "input": {
        "type": "cel"
    },
    "agent": {
        "name": "elastic-agent-19515",
        "id": "37f1ae71-1a03-4d62-82e0-59e440f35824",
        "ephemeral_id": "b19c8d15-4089-4209-ad9e-fab4e4491827",
        "type": "filebeat",
        "version": "8.17.3"
    },
    "@timestamp": "2025-03-24T14:49:05.173Z",
    "ecs": {
        "version": "8.17.0"
    },
    "data_stream": {
        "namespace": "62584",
        "type": "metrics",
        "dataset": "o365_metrics.tenant_settings"
    },
    "elastic_agent": {
        "id": "37f1ae71-1a03-4d62-82e0-59e440f35824",
        "version": "8.17.3",
        "snapshot": false
    },
    "host": {
        "hostname": "elastic-agent-19515",
        "os": {
            "kernel": "6.12.5-linuxkit",
            "name": "Wolfi",
            "family": "",
            "type": "linux",
            "version": "20230201",
            "platform": "wolfi"
        },
        "containerized": false,
        "ip": [
            "172.20.0.2",
            "172.18.0.5"
        ],
        "name": "elastic-agent-19515",
        "mac": [
            "02-42-AC-12-00-05",
            "02-42-AC-14-00-02"
        ],
        "architecture": "aarch64"
    },
    "event": {
        "agent_id_status": "verified",
        "ingested": "2025-03-24T14:49:06Z",
        "dataset": "o365_metrics.tenant_settings"
    },
    "tags": [
        "o365.metrics.tenant_settings"
    ]
}</pre>
</div>
</div>
</details>
<p><span class="strong strong"><strong>ECS Field Reference</strong></span></p>
<p>Please refer to the following <a href="/guide/en/ecs/current/ecs-field-reference.html" class="ulink" target="_top">document</a> for detailed information on ECS fields.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Exported fields</strong></span></summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Field</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>@timestamp</p></td>
<td align="left" valign="top"><p>Event timestamp.</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.dataset</p></td>
<td align="left" valign="top"><p>Data stream dataset.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.namespace</p></td>
<td align="left" valign="top"><p>Data stream namespace.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.type</p></td>
<td align="left" valign="top"><p>Data stream type.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>input.type</p></td>
<td align="left" valign="top"><p>Input type.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.tenant_settings.display_concealed_names</p></td>
<td align="left" valign="top"><p>If set to true, all reports conceal user information such as usernames, groups, and sites. If false, all reports show identifiable information. This property represents a setting in the Microsoft 365 admin center.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.tenant_settings.tenant.display_name</p></td>
<td align="left" valign="top"><p>The display name for the tenant.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.tenant_settings.tenant.id</p></td>
<td align="left" valign="top"><p>The tenant ID, a unique identifier representing the organization (or tenant).</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.tenant_settings.tenant.type</p></td>
<td align="left" valign="top"><p>Can be one of the following types:  * AAD - An enterprise identity access management (IAM) service that serves business-to-employee and business-to-business (B2B) scenarios.  * AAD B2C An identity access management (IAM) service that serves business-to-consumer (B2C) scenarios.  * CIAM - A customer identity &amp; access management (CIAM) solution that provides an integrated platform to serve consumers, partners, and citizen scenarios.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
<div class="position-relative"><h5><a id="o365_metrics-app-registrations"></a>App Registrations</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/o365_metrics/index.asciidoc">edit</a></div>
<p>Get details about apps registered in Microsoft Entra ID. <a href="https://learn.microsoft.com/en-us/graph/api/application-list?view=graph-rest-1.0&amp;tabs=http" class="ulink" target="_top">Microsoft API</a>.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Example</strong></span></summary>
<div class="content">
<p>An example event for <code class="literal">app_registrations</code> looks as following:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
    "@timestamp": "2025-04-03T07:01:21.020Z",
    "agent": {
        "ephemeral_id": "a2de3e9c-7fd2-4cb1-8ce5-9bb66e5a4670",
        "id": "ee4e3654-ca4a-42f5-bd62-e493fc339455",
        "name": "elastic-agent-67281",
        "type": "filebeat",
        "version": "8.16.0"
    },
    "data_stream": {
        "dataset": "o365_metrics.app_registrations",
        "namespace": "75903",
        "type": "metrics"
    },
    "ecs": {
        "version": "8.17.0"
    },
    "elastic_agent": {
        "id": "ee4e3654-ca4a-42f5-bd62-e493fc339455",
        "snapshot": false,
        "version": "8.16.0"
    },
    "event": {
        "agent_id_status": "verified",
        "dataset": "o365_metrics.app_registrations",
        "ingested": "2025-04-03T07:01:24Z",
        "kind": "metric"
    },
    "host": {
        "architecture": "aarch64",
        "containerized": false,
        "hostname": "elastic-agent-67281",
        "ip": [
            "172.31.0.2",
            "172.26.0.4"
        ],
        "mac": [
            "02-42-AC-1A-00-04",
            "02-42-AC-1F-00-02"
        ],
        "name": "elastic-agent-67281",
        "os": {
            "family": "",
            "kernel": "5.10.104-linuxkit",
            "name": "Wolfi",
            "platform": "wolfi",
            "type": "linux",
            "version": "20230201"
        }
    },
    "input": {
        "type": "cel"
    },
    "o365": {
        "metrics": {
            "app_registrations": {
                "app_id": "166f-4179-44-aeb-801cf53a",
                "display_name": "App1",
                "key_credentials": [],
                "object_id": "7eaf2-b2f6-4fb0-b9f-f171aa69",
                "password_credentials": [
                    {
                        "display_name": "test token",
                        "end_date_time": "2025-08-08T16:46:54.729Z",
                        "key_id": "3468e-f34c-485f-9754-b47161a"
                    },
                    {
                        "display_name": "token",
                        "end_date_time": "2025-08-06T09:23:49.935Z",
                        "key_id": "7b1c7-4aea-421e-abd4-1c48188"
                    },
                    {
                        "display_name": "1234",
                        "end_date_time": "2025-07-30T05:10:48.334Z",
                        "key_id": "cb7b-ab9c-4aa2-9ad4-6fda517"
                    },
                    {
                        "display_name": "123",
                        "end_date_time": "2025-07-29T13:31:41.601Z",
                        "key_id": "d413b-c6db-4cb3-967e-793d1"
                    }
                ]
            }
        }
    },
    "tags": [
        "o365.metrics.app_registrations"
    ]
}</pre>
</div>
</div>
</details>
<p><span class="strong strong"><strong>ECS Field Reference</strong></span></p>
<p>Please refer to the following <a href="/guide/en/ecs/current/ecs-field-reference.html" class="ulink" target="_top">document</a> for detailed information on ECS fields.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Exported fields</strong></span></summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Field</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>@timestamp</p></td>
<td align="left" valign="top"><p>Event timestamp.</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.dataset</p></td>
<td align="left" valign="top"><p>Data stream dataset.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.namespace</p></td>
<td align="left" valign="top"><p>Data stream namespace.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.type</p></td>
<td align="left" valign="top"><p>Data stream type.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>input.type</p></td>
<td align="left" valign="top"><p>Input type.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.app_registrations.app_id</p></td>
<td align="left" valign="top"><p>The unique identifier for the application that is assigned to an application by Microsoft Entra ID.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.app_registrations.display_name</p></td>
<td align="left" valign="top"><p>The display name for the application.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.app_registrations.key_credentials.display_name</p></td>
<td align="left" valign="top"><p>The friendly name for the key.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.app_registrations.key_credentials.end_date_time</p></td>
<td align="left" valign="top"><p>The date and time at which the credential expires.</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.app_registrations.key_credentials.key_id</p></td>
<td align="left" valign="top"><p>The unique identifier for the key.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.app_registrations.key_credentials.type</p></td>
<td align="left" valign="top"><p>The type of key credential; for example, Symmetric, AsymmetricX509Cert.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.app_registrations.key_credentials.usage</p></td>
<td align="left" valign="top"><p>A string that describes the purpose for which the key can be used; for example, Verify.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.app_registrations.object_id</p></td>
<td align="left" valign="top"><p>Unique identifier for the application object.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.app_registrations.password_credentials.display_name</p></td>
<td align="left" valign="top"><p>Friendly name for the password.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.app_registrations.password_credentials.end_date_time</p></td>
<td align="left" valign="top"><p>The date and time at which the password expires.</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.app_registrations.password_credentials.key_id</p></td>
<td align="left" valign="top"><p>The unique identifier for the password.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
<div class="position-relative"><h5><a id="o365_metrics-entra-features"></a>Entra Features</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/o365_metrics/index.asciidoc">edit</a></div>
<p>Get details about Entra Features. <a href="https://learn.microsoft.com/en-us/graph/api/resources/organization?view=graph-rest-1.0" class="ulink" target="_top">Microsoft API</a>.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Example</strong></span></summary>
<div class="content">
<p>An example event for <code class="literal">entra_features</code> looks as following:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
    "@timestamp": "2025-04-10T10:40:03.447Z",
    "agent": {
        "ephemeral_id": "7852790c-2a34-413e-a94c-74c05f82e5f9",
        "id": "f3fc8c0f-bd46-481e-bf2c-764831ee324c",
        "name": "elastic-agent-67757",
        "type": "filebeat",
        "version": "8.16.0"
    },
    "data_stream": {
        "dataset": "o365_metrics.entra_features",
        "namespace": "21154",
        "type": "metrics"
    },
    "ecs": {
        "version": "8.17.0"
    },
    "elastic_agent": {
        "id": "f3fc8c0f-bd46-481e-bf2c-764831ee324c",
        "snapshot": false,
        "version": "8.16.0"
    },
    "event": {
        "agent_id_status": "verified",
        "dataset": "o365_metrics.entra_features",
        "ingested": "2025-04-10T10:40:06Z"
    },
    "host": {
        "architecture": "x86_64",
        "containerized": true,
        "hostname": "elastic-agent-67757",
        "ip": [
            "172.20.0.2",
            "172.18.0.7"
        ],
        "mac": [
            "02-42-AC-12-00-07",
            "02-42-AC-14-00-02"
        ],
        "name": "elastic-agent-67757",
        "os": {
            "family": "",
            "kernel": "5.15.153.1-microsoft-standard-WSL2",
            "name": "Wolfi",
            "platform": "wolfi",
            "type": "linux",
            "version": "20230201"
        }
    },
    "input": {
        "type": "cel"
    },
    "o365": {
        "metrics": {
            "entra": {
                "features": {
                    "block_cloud_object_takeover_through_hard_match_enabled": true,
                    "block_soft_match_enabled": true,
                    "bypass_dir_sync_overrides_enabled": true,
                    "cloud_password_policy_for_password_synced_users_enabled": true,
                    "concurrent_credential_update_enabled": true,
                    "concurrent_org_id_provisioning_enabled": true,
                    "device_writeback_enabled": true,
                    "directory_extensions_enabled": true,
                    "fope_conflict_resolution_enabled": true,
                    "group_write_back_enabled": true,
                    "on_premises_sync_enabled": true,
                    "password_sync_enabled": true,
                    "password_writeback_enabled": true,
                    "quarantine_upon_proxy_addresses_conflict_enabled": true,
                    "quarantine_upon_upn_conflict_enabled": true,
                    "soft_match_on_upn_enabled": true,
                    "synchronize_upn_for_managed_users_enabled": true,
                    "unified_group_writeback_enabled": true,
                    "user_force_password_change_on_logon_enabled": true,
                    "user_writeback_enabled": true
                }
            }
        }
    },
    "tags": [
        "o365.metrics.entra_features"
    ]
}</pre>
</div>
</div>
</details>
<p>Please refer to the following <a href="/guide/en/ecs/current/ecs-field-reference.html" class="ulink" target="_top">document</a> for detailed information on ECS fields.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Exported fields</strong></span></summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Field</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Type</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>@timestamp</p></td>
<td align="left" valign="top"><p>Event timestamp.</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.dataset</p></td>
<td align="left" valign="top"><p>Data stream dataset.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.namespace</p></td>
<td align="left" valign="top"><p>Data stream namespace.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>data_stream.type</p></td>
<td align="left" valign="top"><p>Data stream type.</p></td>
<td align="left" valign="top"><p>constant_keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>input.type</p></td>
<td align="left" valign="top"><p>Input type.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.entra.features.block_cloud_object_takeover_through_hard_match_enabled</p></td>
<td align="left" valign="top"><p>Indicates whether cloud object takeover through hard match is blocked.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.entra.features.block_soft_match_enabled</p></td>
<td align="left" valign="top"><p>Indicates whether soft match is blocked.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.entra.features.bypass_dir_sync_overrides_enabled</p></td>
<td align="left" valign="top"><p>Indicates whether directory sync overrides are bypassed.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.entra.features.cloud_password_policy_for_password_synced_users_enabled</p></td>
<td align="left" valign="top"><p>Indicates if cloud password policy is enabled for password-synced users.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.entra.features.concurrent_credential_update_enabled</p></td>
<td align="left" valign="top"><p>Indicates if concurrent credential updates are allowed.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.entra.features.concurrent_org_id_provisioning_enabled</p></td>
<td align="left" valign="top"><p>Indicates if concurrent Org ID provisioning is enabled.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.entra.features.device_writeback_enabled</p></td>
<td align="left" valign="top"><p>Indicates if device writeback is enabled.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.entra.features.directory_extensions_enabled</p></td>
<td align="left" valign="top"><p>Indicates if directory extensions are enabled.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.entra.features.fope_conflict_resolution_enabled</p></td>
<td align="left" valign="top"><p>Indicates if FOPE conflict resolution is enabled.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.entra.features.group_write_back_enabled</p></td>
<td align="left" valign="top"><p>Indicates if group write-back is enabled.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.entra.features.on_premises_last_sync_datetime</p></td>
<td align="left" valign="top"><p>Indicates the last on premises sync date.</p></td>
<td align="left" valign="top"><p>date</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.entra.features.on_premises_sync_enabled</p></td>
<td align="left" valign="top"><p>Indicates if the on premises sync is enabled.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.entra.features.password_sync_enabled</p></td>
<td align="left" valign="top"><p>Indicates if password sync is enabled.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.entra.features.password_writeback_enabled</p></td>
<td align="left" valign="top"><p>Indicates if password writeback is enabled.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.entra.features.quarantine_upon_proxy_addresses_conflict_enabled</p></td>
<td align="left" valign="top"><p>Indicates if quarantine is applied upon proxy address conflict.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.entra.features.quarantine_upon_upn_conflict_enabled</p></td>
<td align="left" valign="top"><p>Indicates if quarantine is applied upon UPN conflict.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.entra.features.soft_match_on_upn_enabled</p></td>
<td align="left" valign="top"><p>Indicates if soft match on UPN is enabled.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.entra.features.synchronize_upn_for_managed_users_enabled</p></td>
<td align="left" valign="top"><p>Indicates if UPN synchronization for managed users is enabled.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.entra.features.tenant_id</p></td>
<td align="left" valign="top"><p>The ID of the tenant.</p></td>
<td align="left" valign="top"><p>keyword</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.entra.features.unified_group_writeback_enabled</p></td>
<td align="left" valign="top"><p>Indicates if unified group write-back is enabled.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.entra.features.user_force_password_change_on_logon_enabled</p></td>
<td align="left" valign="top"><p>Indicates if users are forced to change passwords on logon.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>o365.metrics.entra.features.user_writeback_enabled</p></td>
<td align="left" valign="top"><p>Indicates if user writeback is enabled.</p></td>
<td align="left" valign="top"><p>boolean</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
<div class="position-relative"><h4><a id="o365_metrics-changelog"></a>Changelog</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/do-not-delete_legacy-docs/dist/o365_metrics/index.asciidoc">edit</a></div>
<details>
<summary class="title"><span class="strong strong"><strong>Changelog</strong></span></summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Version</th>
<th align="left" valign="top">Details</th>
<th align="left" valign="top">Kibana version(s)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.11.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/13254" class="ulink" target="_top">View pull request</a>)<br>
Add <code class="literal">entra_features</code> data stream.</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.10.1</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/13454" class="ulink" target="_top">View pull request</a>)<br>
Update documentation for <code class="literal">tenant_settings</code> data stream.</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.10.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/13441" class="ulink" target="_top">View pull request</a>)<br>
Update the <em>subscriptions</em> data stream to include both subscribed SKUs and subscription details.</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.9.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/13300" class="ulink" target="_top">View pull request</a>)<br>
Add <em>entra ID users</em> data stream.</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.8.2</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-bug"></span> <span class="strong strong"><strong>Bug fix</strong></span> (<a href="https://github.com/elastic/integrations/pull/13422" class="ulink" target="_top">View pull request</a>)<br>
Fix cel code for <code class="literal">tenant_settings</code> data stream.</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.8.1</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/13409" class="ulink" target="_top">View pull request</a>)<br>
Add <code class="literal">Required Permisions</code> Column</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.8.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/13299" class="ulink" target="_top">View pull request</a>)<br>
Add <em>app_registrations</em> data stream.</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.7.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/13170" class="ulink" target="_top">View pull request</a>)<br>
Add <em>tenant settings</em> data stream.</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.6.6</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/13138" class="ulink" target="_top">View pull request</a>)<br>
Add support for configuring resource parameters, such as rate_limit, retry, and others.</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.6.5</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/12949" class="ulink" target="_top">View pull request</a>)<br>
Convert nested fields to group for <code class="literal">teams_call quality</code> and <code class="literal">subscriptions</code> data streams.</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.6.4</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/12935" class="ulink" target="_top">View pull request</a>)<br>
Add metric types for all data streams.</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.6.3</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-bug"></span> <span class="strong strong"><strong>Bug fix</strong></span> (<a href="https://github.com/elastic/integrations/pull/12989" class="ulink" target="_top">View pull request</a>)<br>
Fix pipeline for <code class="literal">sharepoint_site_usage_detail</code> data stream.</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.6.2</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-bug"></span> <span class="strong strong"><strong>Bug fix</strong></span> (<a href="https://github.com/elastic/integrations/pull/12849" class="ulink" target="_top">View pull request</a>)<br>
Fix cel code for <code class="literal">onedrive_usage_storage</code> data stream.</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.6.1</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/12696" class="ulink" target="_top">View pull request</a>)<br>
Add cel failure check to all data streams.</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.6.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/12475" class="ulink" target="_top">View pull request</a>)<br>
Add support for Kibana <code class="literal">9.0.0</code>.</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.5.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/12490" class="ulink" target="_top">View pull request</a>)<br>
Add <code class="literal">subscriptions</code> data stream.</p>
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/12633" class="ulink" target="_top">View pull request</a>)<br>
Add <code class="literal">teams_call_quality</code> data stream.</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.4.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/12218" class="ulink" target="_top">View pull request</a>)<br>
Add <code class="literal">teams_device_usage_user_counts</code> data stream.</p>
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/12159" class="ulink" target="_top">View pull request</a>)<br>
Add <code class="literal">service_health</code> data stream.</p>
<p><span class="eui-icon icon-bug"></span> <span class="strong strong"><strong>Bug fix</strong></span> (<a href="https://github.com/elastic/integrations/pull/12456" class="ulink" target="_top">View pull request</a>)<br>
Split data stream <code class="literal">mailbox_usage</code> into <code class="literal">mailbox_usage_detail</code> and <code class="literal">mailbox_usage_quota_status_mailbox_counts</code>, and refactor other datastreams.</p>
<p><span class="eui-icon icon-bug"></span> <span class="strong strong"><strong>Bug fix</strong></span> (<a href="https://github.com/elastic/integrations/pull/12507" class="ulink" target="_top">View pull request</a>)<br>
Split <code class="literal">sharepoint_site_usage</code> and <code class="literal">onedrive_usage</code> by data stream and quality check.</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.3.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/12256" class="ulink" target="_top">View pull request</a>)<br>
Add <code class="literal">groups_activity_group_detail</code>, <code class="literal">onedrive_usage_account_detail</code>, <code class="literal">teams_user_activity_user_detail</code>, and <code class="literal">viva_engage_groups_activity_group_detail</code> data streams.</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.2.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/12219" class="ulink" target="_top">View pull request</a>)<br>
Add <code class="literal">teams_user_activity_user_counts</code> data stream.</p>
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/12201" class="ulink" target="_top">View pull request</a>)<br>
Add <code class="literal">yammer_device_usage</code> data stream.</p>
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/11934" class="ulink" target="_top">View pull request</a>)<br>
Add <code class="literal">active_users</code> data stream.</p>
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/11687" class="ulink" target="_top">View pull request</a>)<br>
Add <code class="literal">mailbox_quota_staus</code> and <code class="literal">outlook_app_usage</code> data streams.</p>
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/11935" class="ulink" target="_top">View pull request</a>)<br>
Add <code class="literal">sharepoint_site_usage</code> data stream.</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.1.2</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/11814" class="ulink" target="_top">View pull request</a>)<br>
Add <code class="literal">onedrive_usage</code> data stream.</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.1.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/11937" class="ulink" target="_top">View pull request</a>)<br>
Initial draft of the o365_metrics package with the <code class="literal">outlook_activity</code> data stream.</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="m365_defender.html">« M365 Defender integration</a>
</span>
<span class="next">
<a href="microsoft_sentinel.html">Microsoft Sentinel »</a>
</span>
</div>
</body>
</html>
