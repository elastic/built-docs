<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Prometheus Input Package | Elastic integrations | Elastic</title>
<meta class="elastic" name="content" content="Prometheus Input Package | Elastic integrations">

<link rel="home" href="index.html" title="Elastic integrations"/>
<link rel="up" href="prometheus-intro.html" title="Prometheus"/>
<link rel="prev" href="prometheus.html" title="Prometheus Integration"/>
<link rel="next" href="proofpoint_tap.html" title="Proofpoint TAP"/>
<meta class="elastic" name="product_version" content="main"/>
<meta class="elastic" name="product_name" content="Integrations"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Integrations/Reference"/>
<meta name="DC.subject" content="Integrations"/>
<meta name="DC.identifier" content="main"/>
</head>
<body>
<div class="navheader">
<span class="prev">
<a href="prometheus.html">« Prometheus Integration</a>
</span>
<span class="next">
<a href="proofpoint_tap.html">Proofpoint TAP »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic integrations</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="prometheus-intro.html">Prometheus</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Prometheus Input Package</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/prometheus_input/index.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="prometheus_input"></a>Prometheus Input Package</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/prometheus_input/index.asciidoc">edit</a></div>
</div></div></div>

<div class="condensed-table">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<tbody>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Version</strong></span></p></td>
<td align="left" valign="top"><p>0.7.0 <span class="Admonishment Admonishment--beta">
[<span class="Admonishment-title u-mono">beta</span>]
<span class="Admonishment-detail">
This functionality is in beta and is subject to change. The design and code is less mature than official GA features and is being provided as-is with no warranties. Beta features are not subject to the support SLA of official GA features.
</span>
</span> (<a class="xref" href="prometheus_input.html#prometheus_input-changelog" title="Changelog">View all</a>)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Compatible Kibana version(s)</strong></span></p></td>
<td align="left" valign="top"><p>8.13.0 or higher<br>
9.0.0 or higher</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Supported Serverless project types</strong></span><br>
 <a class="xref" href="serverless-support.html" title="Supported Serverless project types"><span class="small">What&#8217;s this?</span></a></p></td>
<td align="left" valign="top"><p>Security<br>
Observability</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Subscription level</strong></span><br>
<a href="/subscriptions" class="ulink" target="_top"><span class="small">What&#8217;s this?</span></a></p></td>
<td align="left" valign="top"><p>Basic</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>Level of support</strong></span><br>
<a class="xref" href="support.html" title="Level of support"><span class="small">What&#8217;s this?</span></a></p></td>
<td align="left" valign="top"><p>Elastic</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<p>This input package can collect metrics from <a href="https://prometheus.io/docs/instrumenting/exporters/" class="ulink" target="_top">Prometheus Exporters (Collectors)</a>. It gives users the flexibility to add custom mappings and ingest pipelines.</p>
<div class="position-relative"><h4><a id="prometheus_input-metrics"></a>Metrics</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/prometheus_input/index.asciidoc">edit</a></div>
<div class="position-relative"><h6><a id="prometheus_input-scraping-from-a-prometheus-exporter"></a>Scraping from a Prometheus exporter</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/prometheus_input/index.asciidoc">edit</a></div>
<p>To scrape metrics from a Prometheus exporter, configure the <code class="literal">hosts</code> setting to it. The path
to retrieve the metrics from (<code class="literal">/metrics</code> by default) is appended to the hostname as below:</p>
<p>Host Configuration Format: <code class="literal">http[s]://&lt;hostname&gt;:&lt;port&gt;/&lt;metrics_path&gt;</code>
Example Host Configuration: <code class="literal">http://localhost:9090/metrics</code></p>
<div class="position-relative"><h6><a id="prometheus_input-histograms-and-types"></a>Histograms and types</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/prometheus_input/index.asciidoc">edit</a></div>
<p><code class="literal">Use Types</code> parameter (default: <code class="literal">true</code>) enables a different layout for metrics storage, leveraging Elasticsearch
types, including <a href="/guide/en/elasticsearch/reference/current/histogram.html" class="ulink" target="_top">histograms</a></p>
<p><code class="literal">Rate Counters</code> parameter (default: <code class="literal">true</code>) enables calculating a rate out of Prometheus counters. When enabled, integration stores
the counter increment since the last collection. This metric provides better aggregation.
This parameter can only be enabled in combination with <code class="literal">Use Types</code>.</p>
<p>When <code class="literal">Use Types</code> and <code class="literal">Rate Counters</code> are enabled, metrics are stored like this:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
    "prometheus": {
        "labels": {
            "instance": "172.27.0.2:9090",
            "job": "prometheus"
        },
        "prometheus_target_interval_length_seconds_count": {
            "counter": 1,
            "rate": 0
        },
        "prometheus_target_interval_length_seconds_sum": {
            "counter": 15.000401344,
            "rate": 0
        },
        "prometheus_tsdb_compaction_chunk_range_seconds": {
            "histogram": {
                "values": [50, 300, 1000, 4000, 16000],
                "counts": [10, 2, 34, 7]
            }
        }
    },
}</pre>
</div>
<div class="position-relative"><h6><a id="prometheus_input-filtering-metrics"></a>Filtering metrics</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/prometheus_input/index.asciidoc">edit</a></div>
<p>In order to filter out/in metrics one can make use of <code class="literal">Metrics Filters Include</code>, <code class="literal">Metrics Filters Exclude</code> settings:</p>
<div class="pre_wrapper lang-yml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yml">Metrics Filters Include: ["node_filesystem_*"]
Metrics Filters Exclude: ["node_filesystem_device_*"]</pre>
</div>
<p>The configuration above will include only metrics that match <code class="literal">node_filesystem_*</code> pattern and do not match <code class="literal">node_filesystem_device_*</code>.</p>
<p>To keep only specific metrics, anchor the start and the end of the regexp of each metric:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
the caret ^ matches the beginning of a text
</li>
<li class="listitem">
the dollar $ matches the end of a text
</li>
</ul>
</div>
<div class="pre_wrapper lang-yml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yml">Metrics Filters Include: ["^node_network_net_dev_group$", "^node_network_up$"]</pre>
</div>
<div class="position-relative"><h5><a id="prometheus_input-datastream-dataset-name"></a>Datastream Dataset Name</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/prometheus_input/index.asciidoc">edit</a></div>
<p>The users of the Prometheus Input Package have the option of adding their own dataset name, to which the events get added. Prometheus Metrics from different services can be collected by adding multiple instances of Input package. The metrics can be filtered on the basis of dataset name.</p>
<div class="position-relative"><h4><a id="prometheus_input-changelog"></a>Changelog</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/integration-docs/edit/main/dist/prometheus_input/index.asciidoc">edit</a></div>
<details>
<summary class="title"><span class="strong strong"><strong>Changelog</strong></span></summary>
<div class="content">
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Version</th>
<th align="left" valign="top">Details</th>
<th align="left" valign="top">Kibana version(s)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.7.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/12475" class="ulink" target="_top">View pull request</a>)<br>
Add support for Kibana <code class="literal">9.0.0</code>.</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.6.1</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/12165" class="ulink" target="_top">View pull request</a>)<br>
Add observability category.</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.6.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/10411" class="ulink" target="_top">View pull request</a>)<br>
Add processor support for input data stream.</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.5.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/10162" class="ulink" target="_top">View pull request</a>)<br>
ECS version updated to 8.11.0. Update the kibana constraint to ^8.13.0. Modified the field definitions to remove ECS fields made redundant by the ecs@mappings component template.</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.4.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/9321" class="ulink" target="_top">View pull request</a>)<br>
Enable secrets for sensitive fields. For more details, refer <a href="/guide/en/fleet/current/agent-policy.html#agent-policy-secret-values" class="ulink" target="_top">https://www.elastic.co/guide/en/fleet/current/agent-policy.html#agent-policy-secret-values</a></p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.3.1</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-bug"></span> <span class="strong strong"><strong>Bug fix</strong></span> (<a href="https://github.com/elastic/integrations/pull/9279" class="ulink" target="_top">View pull request</a>)<br>
Disable secrets for older stack versions due to errors.</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.3.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/9009" class="ulink" target="_top">View pull request</a>)<br>
Enable <em>secret</em> for the sensitive fields, supported from 8.12.</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.2.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/8203" class="ulink" target="_top">View pull request</a>)<br>
Update the package format_version to 3.0.0.</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.1.4</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-bug"></span> <span class="strong strong"><strong>Bug fix</strong></span> (<a href="https://github.com/elastic/integrations/pull/8018" class="ulink" target="_top">View pull request</a>)<br>
Fix test failure by upgrading the docker image version to the latest.</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.1.3</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/6490" class="ulink" target="_top">View pull request</a>)<br>
Add system test cases</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.1.2</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-bug"></span> <span class="strong strong"><strong>Bug fix</strong></span> (<a href="https://github.com/elastic/integrations/pull/6399" class="ulink" target="_top">View pull request</a>)<br>
Fix the typos in package</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.1.1</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-bug"></span> <span class="strong strong"><strong>Bug fix</strong></span> (<a href="https://github.com/elastic/integrations/pull/6331" class="ulink" target="_top">View pull request</a>)<br>
Update the url&#8217;s in README</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.1.0</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/6298" class="ulink" target="_top">View pull request</a>)<br>
Rename ownership from obs-service-integrations to obs-infraobs-integrations</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.0.2</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/6212" class="ulink" target="_top">View pull request</a>)<br>
Add base fields mappings</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><span class="strong strong"><strong>0.0.1</strong></span></p></td>
<td align="left" valign="top">
<p><span class="eui-icon icon-checkInCircleFilled"></span> <span class="strong strong"><strong>Enhancement</strong></span> (<a href="https://github.com/elastic/integrations/pull/6170" class="ulink" target="_top">View pull request</a>)<br>
Initial draft of the Prometheus Input Package</p>
</td>
<td align="left" valign="top"><p>&mdash;</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</details>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="prometheus.html">« Prometheus Integration</a>
</span>
<span class="next">
<a href="proofpoint_tap.html">Proofpoint TAP »</a>
</span>
</div>
</body>
</html>
