<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Create a map with multiple layers and data sources | Kibana Guide [7.10] | Elastic</title>
<meta class="elastic" name="content" content="Create a map with multiple layers and data sources | Kibana Guide [7.10]">

<link rel="home" href="index.html" title="Kibana Guide [7.10]"/>
<link rel="up" href="maps.html" title="Maps"/>
<link rel="prev" href="maps.html" title="Maps"/>
<link rel="next" href="heatmap-layer.html" title="Heat map layer"/>
<meta class="elastic" name="product_version" content="7.10"/>
<meta class="elastic" name="product_name" content="Kibana"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Kibana/Reference/7.10"/>
<meta name="DC.subject" content="Kibana"/>
<meta name="DC.identifier" content="7.10"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body><div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Kibana Guide [7.10]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="maps.html">Maps</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="maps.html">« Maps</a>
</span>
<span class="next">
<a href="heatmap-layer.html">Heat map layer »</a>
</span>
</div>
<div class="chapter xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="maps-getting-started"></a>Create a map with multiple layers and data sources<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.10/docs/maps/maps-getting-started.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>If you are new to <span class="strong strong"><strong>Maps</strong></span>, this tutorial is a good place to start.
It guides you through the common steps for working with your location data.</p>
<p>You&#8217;ll learn to:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Create a map with multiple layers and data sources
</li>
<li class="listitem">
Use symbols, colors, and labels to style data values
</li>
<li class="listitem">
Embed a map in a dashboard
</li>
<li class="listitem">
Search across panels in your dashboard
</li>
</ul>
</div>
<p>When you complete this tutorial, you’ll have a map that looks like this:</p>
<div class="imageblock screenshot">
<div class="content">
<img src="maps/images/sample_data_web_logs.png" alt="sample data web logs">
</div>
</div>
<h3><a id="_prerequisites_2"></a>Prerequisites<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.10/docs/maps/maps-getting-started.asciidoc">edit</a></h3>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If you don’t already have Kibana, set it up with <a href="/cloud/elasticsearch-service/signup?baymax=docs-body&amp;elektra=docs" class="ulink" target="_top">our free trial</a>.
</li>
<li class="listitem">
This tutorial requires the <a class="xref" href="get-started.html" title="Quick start">web logs sample data set</a>. The sample data includes a [Logs] Total Requests and Bytes map, which you’ll re-create in this tutorial.
</li>
<li class="listitem">
You must have the correct privileges for creating a map.
If you don&#8217;t have sufficient privileges to create or save maps,
a read-only icon appears in the toolbar. For more information,
refer to <a class="xref" href="xpack-security-authorization.html" title="Granting access to Kibana">Granting access to Kibana</a>.
</li>
</ul>
</div>
<h3><a id="maps-create"></a>Step 1. Create a map<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.10/docs/maps/maps-getting-started.asciidoc">edit</a></h3>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Open the main menu, and then click <span class="strong strong"><strong>Dashboard</strong></span>.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Create dashboard</strong></span>.
</li>
<li class="listitem">
Set the time range to <span class="strong strong"><strong>Last 7 days</strong></span>.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Create new</strong></span>.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Maps</strong></span>.
</li>
</ol>
</div>
<h3><a id="maps-add-choropleth-layer"></a>Step 2. Add a choropleth layer<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.10/docs/maps/maps-getting-started.asciidoc">edit</a></h3>
<p>The first layer you&#8217;ll add is a choropleth layer to shade world countries
by web log traffic. Darker shades will symbolize countries with more web log traffic,
and lighter shades will symbolize countries with less traffic.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Click <span class="strong strong"><strong>Add layer</strong></span>, and then click <span class="strong strong"><strong>Choropleth</strong></span>.
</li>
<li class="listitem">
From the <span class="strong strong"><strong>Layer</strong></span> dropdown menu, select <span class="strong strong"><strong>World Countries</strong></span>.
</li>
<li class="listitem">
<p>In <span class="strong strong"><strong>Statistics source</strong></span>, set:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Index pattern</strong></span> to <span class="strong strong"><strong>kibana_sample_data_logs</strong></span>
</li>
<li class="listitem">
<span class="strong strong"><strong>Join field</strong></span> to <span class="strong strong"><strong>geo.src</strong></span>
</li>
</ul>
</div>
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Add layer</strong></span>.
</li>
<li class="listitem">
<p>In <span class="strong strong"><strong>Layer settings</strong></span>, set:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Name</strong></span> to <code class="literal">Total Requests by Country</code>
</li>
<li class="listitem">
<span class="strong strong"><strong>Opacity</strong></span> to 50%
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Add a Tooltip field:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Select <span class="strong strong"><strong>ISO 3166-1 alpha-2 code</strong></span> and <span class="strong strong"><strong>name</strong></span>.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Add</strong></span>.
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>In <span class="strong strong"><strong>Layer style</strong></span>, set:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Fill color</strong></span> to the grey color ramp
</li>
<li class="listitem">
<span class="strong strong"><strong>Border color</strong></span> to white
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Click <span class="strong strong"><strong>Save &amp; close</strong></span>.</p>
<p>Your map now looks like this:</p>
<div class="imageblock screenshot">
<div class="content">
<img src="maps/images/gs_add_cloropeth_layer.png" alt="gs add cloropeth layer">
</div>
</div>
</li>
</ol>
</div>
<h3><a id="maps-add-elasticsearch-layer"></a>Step 3. Add layers for the Elasticsearch data<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.10/docs/maps/maps-getting-started.asciidoc">edit</a></h3>
<p>To avoid overwhelming the user with too much data at once, you&#8217;ll add two layers
for the Elasticsearch data. The first layer will display individual documents
when users zoom in on the map. The second layer will
display aggregated data when users zoom the map out.</p>
<h4><a id="_add_a_layer_for_individual_documents"></a>Add a layer for individual documents<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.10/docs/maps/maps-getting-started.asciidoc">edit</a></h4>
<p>This layer displays web log documents as points.
The layer is only visible when users zoom in.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Click <span class="strong strong"><strong>Add layer</strong></span>, and then click <span class="strong strong"><strong>Documents</strong></span>.
</li>
<li class="listitem">
Set <span class="strong strong"><strong>Index pattern</strong></span> to <span class="strong strong"><strong>kibana_sample_data_logs</strong></span>.
</li>
<li class="listitem">
Set <span class="strong strong"><strong>Scaling</strong></span> to <span class="strong strong"><strong>Limits results to 10000.</strong></span>
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Add layer</strong></span>.
</li>
<li class="listitem">
<p>In <span class="strong strong"><strong>Layer settings</strong></span>, set:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Name</strong></span> to <code class="literal">Actual Requests</code>
</li>
<li class="listitem">
<span class="strong strong"><strong>Visibilty</strong></span> to the range [9, 24]
</li>
<li class="listitem">
<span class="strong strong"><strong>Opacity</strong></span> to 100%
</li>
</ul>
</div>
</li>
<li class="listitem">
Add a tooltip field and select <span class="strong strong"><strong>agent</strong></span>, <span class="strong strong"><strong>bytes</strong></span>, <span class="strong strong"><strong>clientip</strong></span>, <span class="strong strong"><strong>host</strong></span>,
<span class="strong strong"><strong>machine.os</strong></span>, <span class="strong strong"><strong>request</strong></span>, <span class="strong strong"><strong>response</strong></span>, and <span class="strong strong"><strong>timestamp</strong></span>.
</li>
<li class="listitem">
In <span class="strong strong"><strong>Layer style</strong></span>, set <span class="strong strong"><strong>Fill color</strong></span> to <span class="strong strong"><strong>#2200FF</strong></span>.
</li>
<li class="listitem">
<p>Click <span class="strong strong"><strong>Save &amp; close</strong></span>.</p>
<p>Your map will look like this from zoom level 9 to 24:</p>
<div class="imageblock screenshot">
<div class="content">
<img src="maps/images/gs_add_es_document_layer.png" alt="gs add es document layer">
</div>
</div>
</li>
</ol>
</div>
<h4><a id="_add_a_layer_for_aggregated_data"></a>Add a layer for aggregated data<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.10/docs/maps/maps-getting-started.asciidoc">edit</a></h4>
<p>You&#8217;ll create a layer for <a href="/guide/en/elasticsearch/reference/7.10/search-aggregations.html" class="ulink" target="_top">aggregated data</a> and make it visible only when the map
is zoomed out. Darker colors will symbolize grids
with more web log traffic, and lighter colors will symbolize grids with less
traffic. Larger circles will symbolize grids with
more total bytes transferred, and smaller circles will symbolize
grids with less bytes transferred.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Click <span class="strong strong"><strong>Add layer</strong></span>, and select <span class="strong strong"><strong>Clusters and grids</strong></span>.
</li>
<li class="listitem">
Set <span class="strong strong"><strong>Index pattern</strong></span> to <span class="strong strong"><strong>kibana_sample_data_logs</strong></span>.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Add layer</strong></span>.
</li>
<li class="listitem">
<p>In <span class="strong strong"><strong>Layer settings</strong></span>, set:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Name</strong></span> to <code class="literal">Total Requests and Bytes</code>
</li>
<li class="listitem">
<span class="strong strong"><strong>Visibility</strong></span> to the range [0, 9]
</li>
<li class="listitem">
<span class="strong strong"><strong>Opacity</strong></span> to 100%
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Add a metric with:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Aggregation</strong></span> set to <span class="strong strong"><strong>Sum</strong></span>
</li>
<li class="listitem">
<span class="strong strong"><strong>Field</strong></span> set to <span class="strong strong"><strong>bytes</strong></span>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>In <span class="strong strong"><strong>Layer style</strong></span>, change <span class="strong strong"><strong>Symbol size</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Set the field select to <span class="strong strong"><strong>sum bytes</strong></span>.
</li>
<li class="listitem">
Set the min size to 7 and the max size to 25 px.
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Click <span class="strong strong"><strong>Save &amp; close</strong></span> button.</p>
<p>Your map will look like this between zoom levels 0 and 9:</p>
<div class="imageblock screenshot">
<div class="content">
<img src="maps/images/sample_data_web_logs.png" alt="sample data web logs">
</div>
</div>
</li>
</ol>
</div>
<h3><a id="maps-save"></a>Step 4. Save the map<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.10/docs/maps/maps-getting-started.asciidoc">edit</a></h3>
<p>Now that your map is complete, save it and return to the dashboard.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
In the toolbar, click <span class="strong strong"><strong>Save</strong></span>.
</li>
<li class="listitem">
Enter <code class="literal">Tutorial web logs map</code> for the title.
</li>
<li class="listitem">
Ensure <span class="strong strong"><strong>Add to Dashboard after saving</strong></span> is enabled.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Save and return</strong></span>.
</li>
</ol>
</div>
<h3><a id="maps-embedding"></a>Step 5. Explore your data from the dashboard<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.10/docs/maps/maps-getting-started.asciidoc">edit</a></h3>
<p>View your geospatial data alongside a heat map and pie chart, and then filter the data.
When you apply a filter in one panel, it is applied to all panels on the dashboard.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
In the toolbar, click <span class="strong strong"><strong>Add</strong></span> to open a list of objects that you can add to the dashboard.
</li>
<li class="listitem">
Set the <span class="strong strong"><strong>Types</strong></span> select to <span class="strong strong"><strong>Visualization</strong></span>.
</li>
<li class="listitem">
<p>Add <span class="strong strong"><strong>[Logs] Heatmap</strong></span> and <span class="strong strong"><strong>[Logs] Visitors by OS</strong></span> to the dashboard.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="maps/images/gs_dashboard_with_map.png" alt="gs dashboard with map">
</div>
</div>
</li>
<li class="listitem">
To filter for documents where <span class="strong strong"><strong>machine.os.keyword</strong></span> is <span class="strong strong"><strong>osx</strong></span>, click
the <span class="strong strong"><strong>osx</strong></span> slice in the pie chart.
</li>
<li class="listitem">
Remove the filter by clicking <span class="strong strong"><strong>x</strong></span> next to its name in the filter bar.
</li>
<li class="listitem">
<p>Set a filter from the map:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Open a tooltip by clicking anywhere in the United States vector.
</li>
<li class="listitem">
<p>To show only documents where <span class="strong strong"><strong>geo.src</strong></span> is <span class="strong strong"><strong>US</strong></span>, click the filter icon in the row for <span class="strong strong"><strong>ISO 3066-1 alpha-2</strong></span>.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="maps/images/gs_dashboard_with_terms_filter.png" alt="gs dashboard with terms filter">
</div>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
<h3><a id="_whats_next_5"></a>What&#8217;s next?<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.10/docs/maps/maps-getting-started.asciidoc">edit</a></h3>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Check out <a class="xref" href="vector-layer.html" title="Vector layer">additional types of layers</a> that you can add to your map.
</li>
<li class="listitem">
Learn more ways <a class="xref" href="maps-vector-style-properties.html" title="Vector style properties">customize your map</a>.
</li>
<li class="listitem">
Learn more about <a class="xref" href="vector-tooltip.html" title="Vector tooltips">vector tooltips</a>.
</li>
</ul>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="maps.html">« Maps</a>
</span>
<span class="next">
<a href="heatmap-layer.html">Heat map layer »</a>
</span>
</div>
</div>
</body>
</html>
