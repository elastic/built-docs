<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Breaking changes in 7.6 | Kibana Guide [7.7] | Elastic</title>
<meta class="elastic" name="content" content="Breaking changes in 7.6 | Kibana Guide [7.7]">

<link rel="home" href="index.html" title="Kibana Guide [7.7]"/>
<link rel="up" href="breaking-changes.html" title="Breaking Changes"/>
<link rel="prev" href="breaking-changes-7.7.html" title="Breaking changes in 7.7"/>
<link rel="next" href="breaking-changes-7.5.html" title="Breaking changes in 7.5"/>
<meta class="elastic" name="product_version" content="7.7"/>
<meta class="elastic" name="product_name" content="Kibana"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Kibana/Reference/7.7"/>
<meta name="DC.subject" content="Kibana"/>
<meta name="DC.identifier" content="7.7"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div class="navheader">
<span class="prev">
<a href="breaking-changes-7.7.html">« Breaking changes in 7.7</a>
</span>
<span class="next">
<a href="breaking-changes-7.5.html">Breaking changes in 7.5 »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Kibana Guide [7.7]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="breaking-changes.html">Breaking Changes</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Breaking changes in 7.6</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div id="url-to-v3" class="version-warning">
    <strong>IMPORTANT</strong>: This documentation is no longer updated. Refer to <a href="https://www.elastic.co/support/eol">Elastic's version policy</a> and the <a href="https://www.elastic.co/docs">latest documentation</a>.
</div>
<div class="chapter">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="breaking-changes-7.6"></a>Breaking changes in 7.6</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
</div></div></div>

<p>This page discusses the breaking changes that you need to be aware of when migrating
your application to Kibana 7.6.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="breaking-changes-7.6.html#user-facing-changes" title="Breaking changes for users">Breaking changes for users</a>
</li>
<li class="listitem">
<a class="xref" href="breaking-changes-7.6.html#general-plugin-API-changes" title="Breaking changes for plugin developers">Breaking changes for plugin developers</a>
</li>
</ul>
</div>
<div class="position-relative"><h3><a id="user-facing-changes"></a>Breaking changes for users</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p>There are no user-facing breaking changes in 7.6.</p>
<div class="position-relative"><h3><a id="general-plugin-API-changes"></a>Breaking changes for plugin developers</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<div class="position-relative"><h4><a id="_kibana_no_longer_crashes_when_a_plugin_version_does_not_match_the_server"></a>Kibana no longer crashes when a plugin version does not match the server</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/54404" class="ulink" target="_top">#54404</a></p>
<p>Kibana no longer crashes when a plugin is used against an incompatible Kibana version.
A warning is now displayed in the console instead of throwing and crashing.</p>
<div class="position-relative"><h4><a id="_generate_legacy_vars_when_rendering_all_applications"></a>Generate legacy vars when rendering all applications</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/54768" class="ulink" target="_top">#54768</a></p>
<p>Rendering any type of application, even ones for the new platform,
should still generate legacy vars injected into the page metadata.
This ensures these vars are injected for HTTP route rendering as well.</p>
<div class="position-relative"><h4><a id="_uisettings_image_upload_field_config"></a><code class="literal">uiSettings</code> image upload field config</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/54522" class="ulink" target="_top">#54522</a></p>
<p>In <code class="literal">uiSettings</code>, the image upload field required specifying <code class="literal">maxSize</code>
via the <code class="literal">options</code> field. This was in conflict with the stated use and
type of <code class="literal">options</code>, which is a <code class="literal">string[]</code> used to populate select fields.
<code class="literal">uiOptions</code> has been provided instead, accepting <code class="literal">Record&lt;string, any&gt;</code> values.</p>
<div class="position-relative"><h4><a id="_replaced_map_manifestserviceurl_setting_in_kibana_yml_with_map_emstileapiurl_and_map_emsfileapiurl"></a>Replaced <code class="literal">map.manifestServiceUrl</code> setting in kibana.yml with <code class="literal">map.emsTileApiUrl</code> and <code class="literal">map.emsFileApiUrl</code></h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/54399" class="ulink" target="_top">#54399</a></p>
<p>The undocumented <code class="literal">map.manifestServiceUrl</code> setting in kibana.yml has been replaced
by <code class="literal">map.emsTileApiUrl</code> and <code class="literal">map.emsFileApiUrl</code>. These settings configure the
base URL for the tile basemap manifest and vector file manifests used in
Elastic Maps and the region map and coordinate map.visualizations.</p>
<div class="position-relative"><h4><a id="_dont_expose_elasticsearch_client_as_observable"></a>Don&#8217;t expose Elasticsearch client as Observable</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/53824" class="ulink" target="_top">#53824</a></p>
<p>Elasticsearch clients aren&#8217;t exposed via the Observable interface anymore.
Elasticsearch client provides a static API that handles all Elasticsearch config updates under the hood,
transparent to the end-user.</p>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">const client = core.elasticsearch.dataClient;

const data = await client.callAsInternalUser('endpoint');</pre>
</div>
<div class="position-relative"><h4><a id="_reduce_license_plugin_api"></a>Reduce license plugin API</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/53489" class="ulink" target="_top">#53489</a></p>
<p>License method <code class="literal">isOneOf</code> was superseded by <code class="literal">hasAtLeast</code>, which checks
the current license is not less than passes minimal required license.</p>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">//before

license.isOneOf(['platinum', 'enterprise', 'trial'])

// after

license.hasAtLeast('platinum')</pre>
</div>
<div class="position-relative"><h4><a id="_state_containers"></a>State containers</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/52384" class="ulink" target="_top">#52384</a></p>
<p>State containers have now been rewritten and to create state container you
use <code class="literal">createStateContainer</code> instead of previous <code class="literal">createStore</code>.
<a href="https://github.com/streamich/kibana/blob/state-containers/src/plugins/kibana_utils/docs/state_containers/README.md" class="ulink" target="_top">See full documentation</a>.</p>
<div class="pre_wrapper lang-ts">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ts">import { createStateContainer } from 'src/plugins/kibana_utils';

const container = createStateContainer(0, {

  increment: (cnt: number) =&gt; (by: number) =&gt; cnt + by,

  double: (cnt: number) =&gt; () =&gt; cnt * 2,

});

container.transitions.increment(5);

container.transitions.double();

console.log(container.get()); // 10</pre>
</div>
<div class="position-relative"><h4><a id="_add_pre_response_http_interceptor"></a>Add pre-response HTTP interceptor</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/52366" class="ulink" target="_top">#52366</a></p>
<p>HttpService provides <code class="literal">onPreResponse</code> interceptor. Interceptor supports extending a response with custom headers.</p>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js"> this.registerOnPreResponse((request, preResponseInfo, t) =&gt; {

   if(preResponseInfo.statusCode &lt; 300){

     return t.next({

       headers: {

         'x-foo-header': 'bar'

       }

   });

  }

  return t.next()

});</pre>
</div>
<div class="position-relative"><h4><a id="_add_server_rendering_service_to_enable_standalone_route_rendering"></a>Add server rendering service to enable standalone route rendering</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/52161" class="ulink" target="_top">#52161</a></p>
<p>Render a bootstrapped HTML page from a route handler using the <code class="literal">RenderingService</code> from your server plugin:</p>
<div class="pre_wrapper lang-ts">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ts">const router = createRouter();

router.get(

  { path: '/', validate: false },

  (context, request, response) =&gt;

    response.ok({

      headers: {

        'content-security-policy': context.core.http.csp.header,

      },

      body: await context.core.rendering.render(),

    })

);</pre>
</div>
<div class="position-relative"><h4><a id="_disabled_actions"></a>Disabled actions</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/51975" class="ulink" target="_top">#51975</a></p>
<p>Embeddable input now has <code class="literal">disabledActions</code> property. Actions with ID listed
in <code class="literal">disabledActions</code> will not be rendered by embeddable panel in drop down context menu and badge list.</p>
<div class="pre_wrapper lang-ts">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ts">const embeddable = await embeddableFactory.createFromState(

  state,

  {

    // ...

    disabledActions: ['CUSTOM_TIME_RANGE', 'CUSTOM_TIME_RANGE_BADGE'],

  },

  // ...

);</pre>
</div>
<div class="position-relative"><h4><a id="_allow_chromeless_applications_to_render_via_non_app_routes"></a>Allow chromeless applications to render via non-/app routes</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/51527" class="ulink" target="_top">#51527</a></p>
<p>Allow applications to routable from paths that do not start with <code class="literal">/app</code>.
This is first enabled via the <code class="literal">appRoute</code> flag during UI application registration.</p>
<div class="pre_wrapper lang-ts">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ts">export class MyPlugin implements Plugin {

  setup({ application }) {

    application.register({

      id: 'my-app',

      // App can be accessed via the /my-app route

      appRoute: '/my-app',

      async mount(context, params) {

        const { renderApp } = await import('./application');

        return renderApp(context, params);

      },

    });

  }

}</pre>
</div>
<div class="position-relative"><h4><a id="_add_compatibility_wrapper_for_boom_errors_thrown_from_route_handler"></a>Add compatibility wrapper for Boom errors thrown from route handler</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/51157" class="ulink" target="_top">#51157</a></p>
<p>Added a new <code class="literal">handleLegacyErrors</code> method to core <code class="literal">HttpService</code> router. The method wraps a <code class="literal">RequestHandler</code> to intercept any thrown <code class="literal">Boom</code> errors and converts them into proper NP error response.</p>
<div class="pre_wrapper lang-ts">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ts">// plugins/myplugin/server/plugin.ts

import { schema } from '@kbn/config-schema';

import { CoreSetup } from 'src/core/server';

export interface DemoPluginsSetup {};

class Plugin {

  public setup(core: CoreSetup, pluginSetup: DemoPluginSetup) {

    const router = core.http.createRouter();

    router.post(

      {

        path: '/api/myplugin/endpoint',

        validate: false,

      },

      router.wrapErrors((context, req, res) =&gt; {

        throw Boom.notFound('not there'); // will be converted into properly interpreted error

      })

    )

  }

}</pre>
</div>
<div class="position-relative"><h4><a id="_move_savedquery_to_new_platform"></a>Move SavedQuery to New Platform</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/51024" class="ulink" target="_top">#51024</a></p>
<p><span class="strong strong"><strong>Saved Query Service</strong></span></p>
<p>Saved query service is now available on the data plugin&#8217;s <code class="literal">query</code> start contract.</p>
<div class="pre_wrapper lang-ts">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ts">class MyPlugin {

    public start(core: CoreStart, { data }: MyPluginDependencies) {

        const allSavedQueries = data.query.savedQueries.getAllSavedQueries()

    }

}</pre>
</div>
<p><span class="strong strong"><strong>Saved Query UI Components</strong></span></p>
<p>The Saved Query management UI components can be imported from <code class="literal">data</code> plugin directly.</p>
<div class="pre_wrapper lang-ts">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ts">   import { SavedQueryManagementComponent, SaveQueryForm } from '../../plugins/data/public';</pre>
</div>
<p>Saved query Management component</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/breaking_changes_save_query_management.png" alt="Saved Query Management Component">
</div>
</div>
<p>Save query form</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/breaking_changes_save_query.png" alt="Save Query Form">
</div>
</div>
<div class="position-relative"><h4><a id="_kibana_app_migration_remove_old_apis"></a>Kibana app migration: Remove old APIs</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/50881" class="ulink" target="_top">#50881</a></p>
<p>The following undocumented APIs for scroll search and index document count have been removed:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">POST /api/kibana/legacy_scroll_continue</code>
</li>
<li class="listitem">
<code class="literal">POST /api/kibana/legacy_scroll_start</code>
</li>
<li class="listitem">
<code class="literal">POST /api/kibana/{id}/_count</code>
</li>
</ul>
</div>
<div class="position-relative"><h4><a id="_chromehelpextension"></a>ChromeHelpExtension</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/50736" class="ulink" target="_top">#50736</a></p>
<p>The <code class="literal">chrome.helpExtension</code> has been updated to where it no longer just accepts a function to spit out any content. Now, the extension looks like:</p>
<div class="pre_wrapper lang-tsx">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-tsx">export interface ChromeHelpExtension {

  appName: string;

  links?: HeaderHelpMenuUIExtraLink[];

  // You can still pass custom content via the `content` key

  content?: (element: HTMLDivElement) =&gt; () =&gt; void;

}</pre>
</div>
<div class="position-relative"><h4><a id="_allows_plugins_to_define_validation_schema_for_enabled_flag"></a>Allows plugins to define validation schema for "enabled" flag</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/50286" class="ulink" target="_top">#50286</a></p>
<p>If you want your plugin to be disabled by default you can specify it via config:</p>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">export const config = {

  schema: schema.object({ enabled: schema.boolean({ defaultValue: true }) })

}</pre>
</div>
<div class="position-relative"><h4><a id="_add_getstartservices_api"></a>Add getStartServices API</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/50231" class="ulink" target="_top">#50231</a></p>
<p>Context is being deprecated on the front-end and replaced by the <code class="literal">core.getStartServices()</code> API.</p>
<div class="pre_wrapper lang-ts">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ts">class Plugin {

  setup(core, plugins) {

    core.application.register({

      id: 'myApp',

      title: 'My App',

      // `mount` functions with just one argument will only receive `params`

      async mount(params) {

        const [coreStart, depsStart] = await core.getStartServices();

        const { renderApp } = await import('./application');

        return renderApp(coreStart, depsStart, params);

      }

    });

  }

}</pre>
</div>
<div class="position-relative"><h4><a id="_relocated_kbnes_query_package_to_data_plugin"></a>Relocated <code class="literal">@kbn/es-query</code> package to <code class="literal">data</code> plugin</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/50182" class="ulink" target="_top">#50182</a></p>
<p>The <code class="literal">@kbn/es-query</code> package has been moved to <code class="literal">src/plugins/data</code> and is available under the <code class="literal">esQuery</code> namespace on both the client and the server.</p>
<div class="pre_wrapper lang-ts">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ts">// old

import {

  buildEsQuery,

  EsQueryConfig,

  buildQueryFromFilters,

  luceneStringToDsl,

  decorateQuery,

  getEsQueryConfig,

} from '@kbn/es-query';

// new

import { esQuery } from 'src/plugins/data/public'; // or `src/plugins/data/server`

esQuery.buildEsQuery(...);</pre>
</div>
<div class="position-relative"><h4><a id="_migrate_share_registry"></a>Migrate share registry</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/50137" class="ulink" target="_top">#50137</a></p>
<p>The <code class="literal">ui/share</code> registry is removed in favor of the <code class="literal">share</code> plugin which exposes a <code class="literal">register</code> method in the setup contract. The interface of share menu providers does not change except for the removal of angular dependency injection. The function to render the menu also moves into a function exposed by the <code class="literal">share</code> plugin in the start phase instead of a function which has to be called with the menu item providers. The following items have also been renamed:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">ShowProps</code> &#8594; <code class="literal">ShowShareMenuOptions</code>
</li>
<li class="listitem">
<code class="literal">ShareMenuItemProps</code> &#8594; <code class="literal">ShareContext</code>
</li>
<li class="listitem">
<code class="literal">showShareContextMenu</code> &#8594; <code class="literal">toggleShareContextMenu</code>
</li>
</ul>
</div>
<div class="position-relative"><h4><a id="_ensure_chromeless_applications_hide_left_navbar_link"></a>Ensure chromeless applications hide left navbar link</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/50060" class="ulink" target="_top">#50060</a></p>
<p>Chromeless applications no longer display a navigation link in the left application menu.</p>
<div class="position-relative"><h4><a id="_allow_registered_applications_to_hide_kibana_chrome"></a>Allow registered applications to hide Kibana chrome</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/49795" class="ulink" target="_top">#49795</a></p>
<p>When registering an application, you can now use the <code class="literal">chromeless</code> option to hide the Kibana chrome UI when the application is mounted.</p>
<div class="pre_wrapper lang-ts">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ts">application.register({

  id: 'my-app',

  chromeless: true,

  async mount(context, params) {

    /* ... */

  },

});</pre>
</div>
<div class="position-relative"><h4><a id="_remove_react_references_from_core_notifications_apis"></a>Remove react references from core <code class="literal">Notifications</code> APIs</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/49573" class="ulink" target="_top">#49573</a></p>
<p>The core <code class="literal">NotificationService</code> and <code class="literal">ToastsApi</code> methods are now framework agnostic
and no longer accept react components as input. Please use <code class="literal">kibana_react</code>'s`toMountPoint`
utility to convert a react node to a mountPoint.</p>
<div class="position-relative"><h4><a id="_shim_dev_tools"></a>Shim dev tools</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/49349" class="ulink" target="_top">#49349</a></p>
<p>The <code class="literal">ui/registry/dev_tools</code> is removed in favor of the <code class="literal">DevTools</code> plugin,
which exposes a <code class="literal">register</code> method in the setup contract.
Registering app works mostly the same as registering apps in <code class="literal">core.application.register</code>.
Routing will be handled by the id of the dev tool - your dev tool will be mounted when the URL matches <code class="literal">/app/kibana#/dev_tools/&lt;YOUR ID&gt;</code>. This API doesn&#8217;t support angular, for registering angular dev tools, bootstrap a local module on mount into the given HTML element.</p>
<div class="position-relative"><h4><a id="_kibana_app_migration_shim_dashboard"></a>Kibana app migration: Shim dashboard</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/48913" class="ulink" target="_top">#48913</a></p>
<p>The route flag <code class="literal">requireDefaultIndex</code> making sure there are index patterns
and the <code class="literal">defaultIndex</code> advanced setting is set was removed.</p>
<p>The same functionality can be achieved by using the
helper function <code class="literal">ensureDefaultIndexPattern</code> from <code class="literal">ui/legacy_compat</code> within the <code class="literal">resolve</code> object of a route.</p>
<div class="position-relative"><h4><a id="_remove_react_references_from_core_overlayservice_apis"></a>Remove react references from core <code class="literal">OverlayService</code> apis</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/48431" class="ulink" target="_top">#48431</a></p>
<p>The core <code class="literal">OverlayService</code> methods are now framework agnostic and no longer accept react components as input.
Please use <code class="literal">kibana_react</code>'s`toMountPoint` utility to convert a react component to a mountPoint.</p>
<p>For exemple:</p>
<div class="pre_wrapper lang-typescript">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-typescript">core.overlays.openModal(&lt;MyComponent/&gt;)</pre>
</div>
<p>Becomes:</p>
<div class="pre_wrapper lang-typescript">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-typescript">core.overlays.openModal(toMountPoint(&lt;MyComponent/&gt;))</pre>
</div>
<div class="position-relative"><h4><a id="_supply_deprecated_req_and_res_properties_on_ihttpfetcherror_for_legacy_compatibility"></a>Supply deprecated req and res properties on IHttpFetchError for legacy compatibility</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/48430" class="ulink" target="_top">#48430</a></p>
<p>Expose deprecated <code class="literal">req: Request</code> and <code class="literal">res: Response</code> properties on `IHttpFetchError`s
to help plugins migrated faster by removing an additional migration burden.</p>
<div class="position-relative"><h4><a id="_timelion_server_api"></a>Timelion server API</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/47813" class="ulink" target="_top">#47813</a></p>
<p>The server side AOU of Timelion <code class="literal">/api/timelion/run</code> used to
accept datemath strings (like <code class="literal">now</code>) for the <code class="literal">time.from</code> and <code class="literal">time.to</code> properties.
This PR removes support for datemath, from now on only ISO8601 encoded strings are supported.</p>
<div class="position-relative"><h4><a id="_pass_along_request_object_to_all_http_interceptors"></a>Pass along request object to all HTTP interceptors</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/47258" class="ulink" target="_top">#47258</a></p>
<p>Make the <code class="literal">Request</code> instance available to all HTTP interceptors, which is now in a read-only state.
You may now also under-specify the object returned from HTTP response interceptors
to only overwrite specific properties.</p>
<div class="position-relative"><h4><a id="_expose_whitelisted_config_values_to_client_side_plugin"></a>Expose whitelisted config values to client-side plugin</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/50641" class="ulink" target="_top">#50641</a></p>
<p>New Platform plugins with both a server and client parts can now expose configuration properties to the client-side plugin.</p>
<p>The properties to expose must be whitelisted in the config declaration.</p>
<div class="pre_wrapper lang-typescript">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-typescript">// my_plugin/server/index.ts

const configSchema = schema.object({

  secret: schema.string({ defaultValue: 'Not really a secret :/' }),

  uiProp: schema.string({ defaultValue: 'Accessible from client' }),

});

type ConfigType = TypeOf&lt;typeof configSchema&gt;;

export const config: PluginConfigDescriptor&lt;ConfigType&gt; = {

  exposeToBrowser: {

    uiProp: true,

  },

  schema: configSchema,

};</pre>
</div>
<p>And can then be accessed in the client-side plugin using the <code class="literal">PluginInitializerContext</code>:</p>
<div class="pre_wrapper lang-typescript">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-typescript">// my_plugin/public/index.ts

interface ClientConfigType {

  uiProp: string;

}

export class Plugin implements Plugin&lt;PluginSetup, PluginStart&gt; {

  constructor(private readonly initializerContext: PluginInitializerContext) {}

  public async setup(core: CoreSetup, deps: {}) {

    const config = this.initializerContext.config.get&lt;ClientConfigType&gt;();

    // ...

  }</pre>
</div>
<div class="position-relative"><h4><a id="_allow_registering_per_app_navigation_items"></a>Allow registering per-app navigation items</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/53136" class="ulink" target="_top">#53136</a></p>
<p>Allow registering per-app TopNavMenuItems&mdash;have a plugin register menu items into another application.</p>
<p><span class="strong strong"><strong>New platform plugin</strong></span></p>
<div class="pre_wrapper lang-tsx">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-tsx">class MyPlugin {

   public setup(core: CoreSetup, { navigation }: MyPluginSetupDependencies) {

      const customDiscoverExtension = {

         id: 'registered-discover-prop',

         label: 'Registered Discover Button',

         description: 'Registered Discover Demo',

         run() {},

         testId: 'demoDiscoverRegisteredNewButton',

         appName: 'discover',

      };

      navigation.registerMenuItem(customDiscoverExtension);

   }

}</pre>
</div>
<p><span class="strong strong"><strong>Legacy plugin</strong></span></p>
<div class="pre_wrapper lang-tsx">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-tsx">const customDiscoverExtension = {

  id: 'registered-discover-prop',

  label: 'Registered Discover Button',

  description: 'Registered Discover Demo',

  run() {},

  testId: 'demoDiscoverRegisteredNewButton',

  appName: 'discover',

};

npSetup.plugins.navigation.registerMenuItem(customDiscoverExtension);</pre>
</div>
<div class="position-relative"><h4><a id="_management_api_for_kibana_platform"></a>Management API for Kibana Platform</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/52579" class="ulink" target="_top">#52579</a></p>
<p>Management API for Kibana Platform implemented.
Demonstration code available at <code class="literal">test/plugin_functional/plugins/management_test_plugin/public/plugin.tsx</code></p>
<div class="position-relative"><h4><a id="_new_platform_applications_can_now_prompt_user_with_a_message"></a>New platform applications can now prompt user with a message</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/54221" class="ulink" target="_top">#54221</a></p>
<p>New platform applications can now prompt a message when users are trying to
leave the app, allowing to notify them if some changes are unsaved.</p>
<div class="pre_wrapper lang-typescript">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-typescript">   core.application.register({

      id: 'my-app',

      title: 'MyApp',

      mount: (context, { appBasePath, element, onAppLeave }) =&gt; {

        onAppLeave(actions =&gt; {

          if(someUnsavedChanges) {

            return actions.confirm(

              'Some changes are unsaved and will be lost. Are you sure you want to leave MyApp?',

              'Leaving application'

            );

          }

          return actions.default();

        });

        const div = document.createElement('div');

        div.innerHTML = '.....';

        element.appendChild(div);

        return () =&gt; div.remove();

      },

    });</pre>
</div>
<div class="position-relative"><h4><a id="_np_add_lifecycle_timeout"></a>[NP] Add lifecycle timeout</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/54129" class="ulink" target="_top">#54129</a></p>
<p>Kibana platform deprecates async lifecycles by <code class="literal">v8</code> release.
Kibana supports async lifecycles for BWC, but limits their time duration to 30 sec.</p>
<div class="position-relative"><h4><a id="_migrate_config_deprecations_and_shielduser_functionality_to_the_new_platform"></a>Migrate config deprecations and <code class="literal">ShieldUser</code> functionality to the New Platform</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/53768" class="ulink" target="_top">#53768</a></p>
<p>In the Security Plugin, the
Legacy <code class="literal">ShieldUser</code> angular service has been removed and replaced with
the dedicated method on the Kibana platform plugin <code class="literal">setup</code> contract:</p>
<p><span class="strong strong"><strong>Before</strong></span>:</p>
<div class="pre_wrapper lang-typescript">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-typescript">const currentUser = await $injector.get('ShieldUser').getCurrent().$promise;</pre>
</div>
<p><span class="strong strong"><strong>Now</strong></span>:</p>
<p>Legacy plugin:</p>
<div class="pre_wrapper lang-typescript">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-typescript">import { npSetup } from 'ui/new_platform';

const currentUser = await npSetup.plugins.security.authc.getCurrentUser();</pre>
</div>
<p>Kibana platform plugin:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">// manifest.json

....

[optional]requiredPlugins: ["security"],

....</pre>
</div>
<div class="pre_wrapper lang-typescript">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-typescript">// my_plugin/public/plugin.ts

public setup(core: CoreSetup, { security }: PluginSetupDependencies) {

    const currentUser = await security.authc.getCurrentUser();

}</pre>
</div>
<div class="position-relative"><h4><a id="_np_migration_move_doc_views_registry_and_existing_doc_views_into_discover_plugin"></a>NP Migration: Move doc views registry and existing doc views into discover plugin</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/53465" class="ulink" target="_top">#53465</a></p>
<p>The <code class="literal">ui/registry/doc_views</code> registry is removed in favor of the same
functionality exposed through the setup contract of the <code class="literal">discover</code> plugin in <code class="literal">core_plugins/kibana</code>.</p>
<p>Old way of registering a doc view:</p>
<div class="pre_wrapper lang-ts">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ts">import { addDocView } from 'ui/registry/doc_views';

addDocView({

  title: '',

  order: 10,

  component: MyComponent,

});</pre>
</div>
<p>New way of registering a doc view:</p>
<div class="pre_wrapper lang-ts">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ts">import { setup } from '../src/legacy/core_plugins/kibana/public/discover';

setup.addDocView({

  title: '',

  order: 10,

  component: MyComponent,

});</pre>
</div>
<div class="position-relative"><h4><a id="_bfetch"></a>bfetch</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/52888" class="ulink" target="_top">#52888</a></p>
<p><code class="literal">ajax_stream</code> has been ported to the New Platform. Use <code class="literal">fetchStreaming()</code> method of <code class="literal">bfetch</code> plugin instead.</p>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">import { npStart } from 'ui/new_platform';

const { stream, promise } = npStart.plugins.bfetch.fetchStreaming({ url: 'http://elastic.co' });</pre>
</div>
<div class="position-relative"><h4><a id="_move_csp_options_to_new_platform"></a>Move CSP options to New Platform</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/52698" class="ulink" target="_top">#52698</a></p>
<p>The default options used for managing Kibana&#8217;s Content Security Policy have been moved into core for the new platform. Relevant items exposed from <code class="literal">src/core/server</code> include:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">CspConfig</code>: TypeScript class for generating CSP configuration. Will generate default configuration for any properties not specified in initialization.
</li>
<li class="listitem">
<code class="literal">CspConfig.DEFAULT</code>: Default CSP configuration.
</li>
<li class="listitem">
<code class="literal">ICspConfig</code>: Interface representing CSP configuration.
</li>
</ul>
</div>
<div class="position-relative"><h4><a id="_implements_config_deprecation_in_new_platform"></a>Implements config deprecation in New Platform</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/52251" class="ulink" target="_top">#52251</a></p>
<p>New platform plugin&#8217;s configuration now supports deprecation. Use the <code class="literal">deprecations</code> key of a plugin&#8217;s config descriptor to register them.</p>
<div class="pre_wrapper lang-typescript">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-typescript"> // my_plugin/server/index.ts

 import { schema, TypeOf } from '@kbn/config-schema';

 import { PluginConfigDescriptor } from 'kibana/server';



 const configSchema = schema.object({

   someNewKey: schema.string({ defaultValue: 'a string' }),

 });



 type ConfigType = TypeOf&lt;typeof configSchema&gt;;



 export const config: PluginConfigDescriptor&lt;ConfigType&gt; = {

   schema: configSchema,

   deprecations: ({ rename, unused }) =&gt; [

     rename('someOldKey', 'someNewKey'),

     unused('deprecatedProperty'),

   ],

 };</pre>
</div>
<div class="position-relative"><h4><a id="_telemetry_migrate_ui_metric_plugin_to_np_under_usagecollection"></a>[Telemetry] Migrate ui_metric plugin to NP under usageCollection</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/51972" class="ulink" target="_top">#51972</a></p>
<p>Migrates <code class="literal">ui_metrics</code> to NP under <code class="literal">usageCollection</code>.</p>
<div class="position-relative"><h4><a id="_np_licensing_plugin_improvements"></a>NP licensing plugin improvements</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/51818" class="ulink" target="_top">#51818</a></p>
<p>Licensing plugin retrieves license data from Elasticsearch and
becomes a source of license data for all Kibana plugins on server-side and client-side.</p>
<p><span class="strong strong"><strong>Server-side API</strong></span></p>
<p>The licensing plugin retrieves license data from Elasticsearch at regular configurable intervals.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">license$: Observable&lt;ILicense&gt;</code> Provides a steam of license data ILicense.
Plugin emits new value whenever it detects changes in license info.
If the plugin cannot retrieve a license from <span class="strong strong"><strong>Elasticsearch</strong></span>, it will emit <code class="literal">an empty license</code> object.
</li>
<li class="listitem">
<code class="literal">refresh: () =&gt; Promise&lt;ILicense&gt;</code> allows a plugin to enforce license retrieval.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Client-side API</strong></span></p>
<p>The licensing plugin retrieves license data from licensing Kibana plugin
and does not communicate with Elasticsearch directly.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">license$: Observable&lt;ILicense&gt;</code> Provides a steam of license data ILicense.
Plugin emits new value whenever it detects changes in license info. If the plugin cannot retrieve a
license from <span class="strong strong"><strong>Kibana</strong></span>, it will emit <code class="literal">an empty license</code> object.
</li>
<li class="listitem">
<code class="literal">refresh: () =&gt; Promise&lt;ILicense&gt;</code> allows a plugin to enforce license retrieval.
</li>
</ul>
</div>
<div class="position-relative"><h4><a id="_cloud_move_cloud_plugin_to_new_platform"></a>[Cloud] move cloud plugin to New Platform</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/51789" class="ulink" target="_top">#51789</a></p>
<p>Fully migrates <code class="literal">cloud</code> plugin over to NP. To use the NP contract exposed by
the cloud plugin (ex <code class="literal">cloudId</code> or <code class="literal">isCloudEnabled</code>) follow this quick guide below.
Note that all the plugins are already migrated to use the NP plugin in this very same PR.</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">// plugin/kibana.json

{

  "id": "...",

  "optionalPlugins": ["cloud"]

}</pre>
</div>
<p><span class="strong strong"><strong>Server side:</strong></span> Check for cloud plugin in the <code class="literal">setup</code> function.</p>
<div class="pre_wrapper lang-ts">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ts">// server/plugin.ts

import { get } from 'lodash';

class Plugin {

  setup(core, plugins) {

    const { cloud } = plugins;

    // use `lodash.get` as cloud might not be available if set as an optional plugin.

		const isCloudEnabled = get&lt;boolean&gt;(cloud, 'isCloudEnabled', false);

    // ...

  }

}</pre>
</div>
<p><span class="strong strong"><strong>Client side:</strong></span> Both <code class="literal">cloudId</code> and <code class="literal">isCloudEnabled</code> are exposed for the the plugins to consume
in the plugins. Until fully transitioned to new platform, your plugins can use <code class="literal">npSetup</code> to access the cloud plugin.</p>
<div class="pre_wrapper lang-ts">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ts">import { npSetup } from 'ui/new_platform';

import { get } from 'lodash';

// ...

const { cloud } = npSetup.plugins;

const isCloudEnabled = get&lt;boolean&gt;(cloud, 'isCloudEnabled', false);</pre>
</div>
<div class="position-relative"><h4><a id="_telemetry_migrate_usage_collector_set_to_the_new_kibana_platform"></a>[Telemetry] Migrate Usage Collector Set to the new Kibana Platform</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/51618" class="ulink" target="_top">#51618</a></p>
<p>Fully migrate (<code class="literal">server.usage.collectorSet</code>) to New Platform under (<code class="literal">UsageCollection</code>) plugin.
To use the <code class="literal">UsageCollector</code> plugin to collect server side stats with the NP follow the quick guide below (Note that all the plugins are already migrated to use this new plugin in this very same PR):</p>
<p>Make sure <code class="literal">usageCollection</code> is in your optional Plugins:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">// plugin/kibana.json

{

  "id": "...",

  "optionalPlugins": ["usageCollection"]

}</pre>
</div>
<p>Register Usage collector in the <code class="literal">setup</code> function:</p>
<div class="pre_wrapper lang-ts">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ts">// server/plugin.ts

class Plugin {

  setup(core, plugins) {

    registerMyPluginUsageCollector(plugins.usageCollection);

  }

}</pre>
</div>
<p>Create and register a Usage Collector. Ideally collectors would be defined in a separate directory <code class="literal">server/collectors/register.ts</code>.</p>
<div class="pre_wrapper lang-ts">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ts">// server/collectors/register.ts

import { UsageCollectionSetup } from 'src/plugins/usage_collection/server';

import { CallCluster } from 'src/legacy/core_plugins/elasticsearch';

export function registerMyPluginUsageCollector(usageCollection?: UsageCollectionSetup): void {

  // usageCollection is an optional dependency, so make sure to return if it is not registered.

  if (!usageCollection) {

    return;

  }

  // create usage collector

  const myCollector = usageCollection.makeUsageCollector({

    type: MY_USAGE_TYPE,

    fetch: async (callCluster: CallCluster) =&gt; {

    // query ES and get some data

    // summarize the data into a model

    // return the modeled object that includes whatever you want to track

      return {

        my_objects: {

          total: SOME_NUMBER

        }

      };

    },

  });

  // register usage collector

  usageCollection.registerCollector(myCollector);

}</pre>
</div>
<div class="position-relative"><h4><a id="_move_searchbar_to_np"></a>Move SearchBar to NP</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/51028" class="ulink" target="_top">#51028</a></p>
<p>The SearchBar component is now available by importing from the data plugin.</p>
<div class="pre_wrapper lang-tsx">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-tsx">import { SearchBar } from '../../../plugins/data/public';</pre>
</div>
<p>There is also a stateful version available, that requires much fewer dependencies</p>
<div class="pre_wrapper lang-tsx">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-tsx">export class MyPublicPlugin {

  public start(

    core: CoreStart,

    { data }: MyPublicPluginDependencies

  ) {

    const { SearchBar } = data.ui;

    ...

    return &lt;SearchBar

       ...

    &gt;&lt;/SearchBar&gt;

  }

}</pre>
</div>
<div class="position-relative"><h4><a id="_move_querybarinput_to_new_platform"></a>Move QueryBarInput to New Platform</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/51023" class="ulink" target="_top">#51023</a></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">QueryBarInput</code> was renamed to <code class="literal">QueryStringInput</code> and moved to <code class="literal">src/plugins/data/public</code>
</li>
<li class="listitem">
The <code class="literal">typeahead</code> UI component can now be used independently of <code class="literal">QueryStringInput</code>. It can be imported from <code class="literal">src/plugins/data/public</code>.
</li>
</ul>
</div>
<div class="pre_wrapper lang-ts">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ts">   import { QueryStringInput, SuggestionsComponent } from '../../plugins\data\public'</pre>
</div>
<div class="position-relative"><h4><a id="_move_applyfilterspopover_to_new_platform"></a>Move ApplyFiltersPopover to New Platform</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/51022" class="ulink" target="_top">#51022</a></p>
<p>The <code class="literal">ApplyFiltersPopover</code> component is no longer exported.</p>
<p>If you wish to open the filter selection popover,
use the Actions API from within an <code class="literal">embeddable</code>:</p>
<div class="pre_wrapper lang-ts">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ts"> await uiActions.executeTriggerActions(APPLY_FILTER_TRIGGER, {

    embeddable: this,

    filters,

 });</pre>
</div>
<div class="position-relative"><h4><a id="_deprecated_the_filter_bar_directive"></a>Deprecated the <code class="literal">filter-bar</code> directive</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/51020" class="ulink" target="_top">#51020</a></p>
<p>If you need to render a filter bar from <code class="literal">angular</code>,
use the <code class="literal">kbn-top-nav</code> directive with the following configuration:</p>
<div class="pre_wrapper lang-ts">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ts">&lt;kbn-top-nav

  app-name="'my-app'"

  show-search-bar="true"

  show-filter-bar="true"

  show-save-query="false"

  show-date-picker="false"

  filters="filters"

  on-filters-updated="updateFilters"

  index-patterns="[indexPattern]"

&gt;

&lt;/kbn-top-nav&gt;</pre>
</div>
<p><span class="strong strong"><strong>Move <code class="literal">FilterBar</code> React component to New Platform</strong></span></p>
<p>The <code class="literal">FilterBar</code> component is now available by importing from the <code class="literal">data</code> plugin.</p>
<div class="pre_wrapper lang-ts">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ts">import { FilterBar } from '../../../plugins/data/public';</pre>
</div>
<p><span class="strong strong"><strong>Move filter related utilities to New Platform</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">IDataPluginServices</code> ⇒ import from <code class="literal">data</code>
</li>
<li class="listitem">
<code class="literal">getDisplayValueFromFilter</code> ⇒ <code class="literal">data.utils</code>
</li>
<li class="listitem">
<code class="literal">buildCustomFilter</code> ⇒ <code class="literal">esFilters.buildCustomFilter</code>
</li>
<li class="listitem">
<code class="literal">buildFilter</code> ⇒ <code class="literal">esFilters.buildFilter</code>
</li>
<li class="listitem">
<code class="literal">getFilterParams</code> ⇒ <code class="literal">esFilters.getFilterParams</code>
</li>
<li class="listitem">
<code class="literal">getIndexPatternFromFilter</code> ⇒ <code class="literal">utils.getIndexPatternFromFilter</code>
</li>
<li class="listitem">
<code class="literal">getQueryDslFromFilter</code> ⇒ replaced with <code class="literal">esFilters.cleanFIlter</code>
</li>
<li class="listitem">
<code class="literal">isFilterable</code> ⇒ import from <code class="literal">data</code>
</li>
</ul>
</div>
<div class="position-relative"><h4><a id="_np_kibana_plugin_home_feature_catalogue"></a>NP Kibana plugin home feature catalogue</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/50838" class="ulink" target="_top">#50838</a></p>
<p>The <code class="literal">ui/registries/feature_catalogue</code> module has been deprecated for removal in 8.0.</p>
<p>Plugins wishing to migrate may remove their usage of <code class="literal">ui/registries/feature_catalogue</code> and rely on either:</p>
<div class="pre_wrapper lang-ts">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ts">// For legacy plugins

import { npSetup } from 'ui/new_platform';

npSetup.plugins.home.featureCatalogue.register(/* same details here */);

// For new plugins: first add 'home` to the list of `optionalPlugins`

// in your kibana.json file. Then access the plugin directly in `setup`:

class MyPlugin {

  setup(core, plugins) {

    if (plugins.home) {

      plugins.home.featureCatalogue.register(/* same details here. */);

    }

  }

}</pre>
</div>
<p>Note that the old module supported providing a Angular DI function to receive Angular dependencies. This is no longer supported as we migrate away from Angular.</p>
<div class="position-relative"><h4><a id="_np_kibana_migrations_kibana_plugin_home"></a>[NP Kibana Migrations ] Kibana plugin home</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/50444" class="ulink" target="_top">#50444</a></p>
<p>The API to register new tutorials was moved to the new platform. You are now able to add new tutorials by creating a plugin in the new platform, adding a dependency to <code class="literal">home</code> in its <code class="literal">kibana.json</code> and using the <code class="literal">tutorials.registerTutorial</code> method in the setup lifecycle:</p>
<div class="pre_wrapper lang-ts">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ts">class MyPlugin {

  setup(core: CoreSetup, plugins: { home: HomeServerPluginSetup }) {

    home.tutorials.registerTutorial(() =&gt; ({ /* tutorial definition */ }));

  }

}</pre>
</div>
<p>It is still possible to register tutorials from within the legacy platform by calling the same method exposed on the server object:</p>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">server.newPlatform.setup.plugins.home.tutorials.registerTutorial(() =&gt; ({ /* tutorial definition */ }));</pre>
</div>
<div class="position-relative"><h4><a id="_expressions_fully_migrated_to_the_new_platform"></a>Expressions fully migrated to the New Platform</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/50294" class="ulink" target="_top">#50294</a></p>
<p>The Expressions service has been moved to the New Platform. Moving forward, any expressions-related code should be consumed via the new plugin&#8217;s contracts (<code class="literal">src/plugins/expressions</code>).</p>
<p>Use it in your New Platform plugin:</p>
<div class="pre_wrapper lang-ts">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ts">class MyPlugin {

  setup (core, { expressions }) {

    expressions.registerFunction(myFunction);

    // ...

  }

  start (core, { expressions }) {

    expressions.execute(myExpression);

    // ...

  }

}</pre>
</div>
<p>Or, in your legacy platform plugin, consume it through the <code class="literal">ui/new_platform</code> module:</p>
<div class="pre_wrapper lang-ts">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ts">import { npSetup, npStart } from 'ui/new_platform';

npSetup.plugins.expressions.registerFunction(myFunction);

npStart.plugins.expressions.execute(myExpression);

// ...</pre>
</div>
<div class="position-relative"><h4><a id="_move_generatefilters_to_np"></a>Move generateFilters to NP</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/50118" class="ulink" target="_top">#50118</a></p>
<p>Filter generator is now available as a utility function in the <code class="literal">data</code> plugin.</p>
<div class="pre_wrapper lang-ts">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ts">import { generateFilters } from '../plugins/data/public';

const { filterManager } = plugins.data.query;

const filters = generateFilters(filterManager, field, values, negate, indexString);</pre>
</div>
<div class="position-relative"><h4><a id="_move_query_type_to_np"></a>Move Query type to NP</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/49636" class="ulink" target="_top">#49636</a></p>
<p>Moved the data <code class="literal">Query</code> type, used to represent a query string in a specific querying language  to <code class="literal">src/plugins/data</code>.</p>
<div class="pre_wrapper lang-ts">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ts">// previously

import { Query } from `src/legacy/core_plugins/data/public`;

// now

import { Query } from `src/plugins/data/public`;</pre>
</div>
<div class="position-relative"><h4><a id="_move_timefilter_service_to_np"></a>Move Timefilter service to NP</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/49491" class="ulink" target="_top">#49491</a></p>
<p>Moved the <code class="literal">timefilter</code> service to New Platform.</p>
<p><span class="strong strong"><strong>Usage in Old Platform</strong></span>:</p>
<div class="pre_wrapper lang-ts">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ts">import { TimeRange } from 'src/plugins/data/public';

import { npSetup, npStart } from 'ui/new_platform';

const { timefilter } = npStart.data.timefilter;

const timeRange: TimeRange = timefilter.getTime();

const refreshInterval: RefreshInterval = timefilter.getRefreshInterval()</pre>
</div>
<p><span class="strong strong"><strong>Usage in New Platform</strong></span>:</p>
<div class="pre_wrapper lang-ts">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ts">class MyPlugin {

   public setup(core: CoreSetup, { data }: MyPluginSetupDependencies) {

      const timeRange: TimeRange = data.timefilter.timefilter.getTime();

   }

   public start(core: CoreStart, { data }: MyPluginStartDependencies) {

      const newTimeRange = { from: getYesterday(), to: getNow() }

      data.timefilter.timefilter.setTime(newTimeRange);

   }

}</pre>
</div>
<div class="position-relative"><h4><a id="_move_storage_to_new_platform"></a>Move Storage to New Platform</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/49448" class="ulink" target="_top">#49448</a></p>
<p>Move <code class="literal">Storage</code> to <code class="literal">kibana_utils</code>.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Move <code class="literal">Storage</code> class to NP, and introduce the interface <code class="literal">IStorageWrapper</code> for when we only pass storage around.
</li>
<li class="listitem">
Rename places where <code class="literal">storage</code> was called <code class="literal">store</code>
</li>
<li class="listitem">
Load the Storage directives only where applicable (not in autoload)
</li>
</ul>
</div>
<div class="position-relative"><h4><a id="_licensing_plugin"></a>Licensing plugin</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/49345" class="ulink" target="_top">#49345</a></p>
<p>Add x-pack plugin for new platform public licensing information. This will eventually replace the licensing information consumed via <code class="literal">xpack_main</code>. Upon setup, this plugin exposes an observable API for inspecting and making checks against the license information.</p>
<div class="pre_wrapper lang-ts">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ts">license$.subscribe(license =&gt; {

   console.log(license.uid);

   console.log(license.isActive);

   console.log(license.type);

   const { state } = license.check('my-plugin', LICENSE_TYPE.gold);

   if (state !== LICENSE_STATUS.Valid) {

     disableSomething();

   }

});</pre>
</div>
<div class="position-relative"><h4><a id="_migrate_uiregistryfeature_catalogue_to_new_platform_plugin"></a>Migrate ui/registry/feature_catalogue to New Platform plugin</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/48818" class="ulink" target="_top">#48818</a></p>
<p>The <code class="literal">ui/registries/feature_catalogue</code> module has been deprecated for removal in 8.0.</p>
<p>Plugins wishing to migrate may remove their usage of <code class="literal">ui/registries/feature_catalogue</code> and rely on either:</p>
<div class="pre_wrapper lang-ts">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ts">// For legacy plugins

import { npSetup } from 'ui/new_platform';

npSetup.plugins.feature_catalogue.register(/* same details here */);

// For new plugins: first add 'feature_catalogue` to the list of `optionalPlugins`

// in your kibana.json file. Then access the plugin directly in `setup`:

class MyPlugin {

  setup(core, plugins) {

    if (plugins.feature_catalogue) {

      plugins.feature_catalogue.register(/* same details here. */);

    }

  }

}</pre>
</div>
<p>Note that the old module supported providing a Angular DI function to receive Angular dependencies. This is no longer supported as we migrate away from Angular.</p>
<div class="position-relative"><h4><a id="_migrate_necessary_uiautoload_functionality_to_np"></a>Migrate necessary ui/autoload functionality to NP</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/48689" class="ulink" target="_top">#48689</a></p>
<p>The <code class="literal">ui/autoload/styles</code> and <code class="literal">ui/autoload/settings</code> modules have been removed and are no longer necessary to import in your plugin code. Remove these imports starting in 7.6.</p>
<p>If you still require font awesome, you should import it manually from the npm module:</p>
<div class="pre_wrapper lang-ts">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ts">import 'font-awesome/less/font-awesome';</pre>
</div>
<div class="position-relative"><h4><a id="_provide_uisettings_service_in_np"></a>Provide uiSettings service in NP</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/48413" class="ulink" target="_top">#48413</a></p>
<p>New platform plugins can register custom uiSettings via the <code class="literal">uiSettings.register</code> method.</p>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">// src/plugins/my-plugin/server/plugin.ts

setup(core: CoreSetup){

  core.uiSettings.register({

    'my-plugin:my-setting': {

      name: 'just-work',

      value: true,

      description: 'make it work',

      category: ['my-category'],

    },

  })

}</pre>
</div>
<p><span class="strong strong"><strong>Access UiSettings client</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Via RequestHandlerContext on server-side:
</li>
</ul>
</div>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">(context, req, res) {

  const uiSettingsClient = context.core.uiSettings.client;

  const value = await uiSettings.get('myPlugin:key');

  // ...

}</pre>
</div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Via core interface in setup/start lifecycles on the client-side:
</li>
</ul>
</div>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">public start({ uiSettings }) {

  const value = uiSettings.get('myPlugin:key');</pre>
</div>
<div class="position-relative"><h4><a id="_move_filtermanager_to_new_platform"></a>Move FilterManager to New Platform</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/48391" class="ulink" target="_top">#48391</a></p>
<p>Moved Filter Manager to New Platform.</p>
<p><span class="strong strong"><strong>Usage in Old Platform</strong></span></p>
<div class="pre_wrapper lang-ts">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ts">import { npSetup, npStart } from 'ui/new_platform';

npStart.data.query.filterManager.getFilters()

...</pre>
</div>
<p><span class="strong strong"><strong>Usage in New platform</strong></span></p>
<div class="pre_wrapper lang-ts">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ts">class MyPlugin {

   public setup(core: CoreSetup, { data }: MyPluginSetupDependencies) {

      data.query.filterManager.getFilters();

   }

   public start(core: CoreStart, { data }: MyPluginStartDependencies) {

      data.query.filterManager.getFilters();

   }

}</pre>
</div>
<div class="position-relative"><h4><a id="_migrate_uidoc_title_to_new_platform"></a>Migrate ui/doc_title to New platform</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/48121" class="ulink" target="_top">#48121</a></p>
<p>Migrate <code class="literal">chrome.docTitle</code> to new platform. Plugins can now change the page title using this API.</p>
<div class="pre_wrapper lang-ts">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ts">coreStart.docTitle.change('My Title');</pre>
</div>
<div class="position-relative"><h4><a id="_use_np_registry_instead_of_uiregistryfield_formats"></a>Use NP registry instead of ui/registry/field_formats</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/48108" class="ulink" target="_top">#48108</a></p>
<p>The <code class="literal">FieldFormats</code> service has been moved to the <code class="literal">data</code> plugin in the New Platform.
If your plugin has any imports from <code class="literal">ui/registry/field_formats</code>, you&#8217;ll need to update your imports as follows:</p>
<p>Use it in your New Platform plugin:</p>
<div class="pre_wrapper lang-ts">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ts">class MyPlugin {

  setup (core, { data }) {

    data.fieldFormats.register(myFieldFormat);

    // ...

  }

  start (core, { data }) {

    data.fieldFormats.getType(myFieldFormatId);

    // ...

  }

}</pre>
</div>
<p>Or, in your legacy platform plugin, consume it through the <code class="literal">ui/new_platform</code> module:</p>
<div class="pre_wrapper lang-ts">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ts">import { npSetup, npStart } from 'ui/new_platform';

npSetup.plugins.data.fieldFormats.register(myFieldFormat);

npStart.plugins.data.fieldFormats.getType(myFieldFormatId);

// ...</pre>
</div>
<div class="position-relative"><h4><a id="_uimanagement_to_new_platform"></a>ui/management to New Platform</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/45747" class="ulink" target="_top">#45747</a></p>
<p>The following interfaces were previously available under <code class="literal">ui/management</code>
and are now available via <code class="literal">import { setup as managementSetup }`</code>
from <code class="literal">'${correct path to top dir}src/legacy/core_plugins/management/public/legacy';</code></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">ui/management/saved_objects_management</code>
</li>
<li class="listitem">
<code class="literal">ui/management/index_pattern_creation</code>
</li>
<li class="listitem">
<code class="literal">ui/management/index_pattern_list</code>
</li>
</ul>
</div>
<div class="position-relative"><h4><a id="_uipublic_cleanup_2"></a><code class="literal">ui/public</code> cleanup</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/43511" class="ulink" target="_top">#43511</a></p>
<p><span class="strong strong"><strong>Removed / moved modules</strong></span></p>
<p>In preparation for Kibana&#8217;s upcoming new platform, we are in the process
of migrating awayfrom the <code class="literal">ui/public</code> directory.
Over time, the contents of this directory will be either deprecated or
housed inside a parent plugin.</p>
<p>If your plugin imports the listed items from the following <code class="literal">ui/public</code> modules,
you will need to either update your import statements as indicated below,
so that you are pulling these modules from their new locations,
or copy the relevant code into your plugin.</p>
<p><span class="strong strong"><strong><code class="literal">ui/state_management</code></strong></span>
<a href="https://github.com/elastic/kibana/pull/51835" class="ulink" target="_top">#51835</a>
<a href="https://github.com/elastic/kibana/pull/52172" class="ulink" target="_top">#52172</a>
<a href="https://github.com/elastic/kibana/pull/52280" class="ulink" target="_top">#52280</a>
<a href="https://github.com/elastic/kibana/pull/53582" class="ulink" target="_top">#53582</a></p>
<p>The <code class="literal">hashUrl</code> and <code class="literal">unhashUrl</code> functions no longer rely on states being provided as an argument, therefore <code class="literal">getUnhashableStates</code>/<code class="literal">getUnhashableStatesProvider</code> have been removed.</p>
<div class="pre_wrapper lang-ts">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ts">// old

import {

  hashUrl,

  unhashUrl,

  getUnhashableStatesProvider, // deprecated

} from 'ui/state_management/state_hashing';

const getUnhashableStates = Private(getUnhashableStatesProvider);

unhashUrl(window.location.href, getUnhashableStates());

hashUrl([new AppState(), globalState], myRedirectUrl);

// new

import { hashUrl, unhashUrl } from '../../plugins/kibana_utils/public'

hashUrl(window.location.href);

unhashUrl(myRedirectUrl);</pre>
</div>
<p>HashedItemStore was also moved to the <code class="literal">kibana_utils</code> plugin.</p>
<div class="pre_wrapper lang-ts">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ts">// old

import { HashedItemStoreSingleton } from 'ui/state_management/state_storage'

// new

import { hashedItemStore } from '../../plugins/kibana_utils/public'</pre>
</div>
<p>Created new state syncing utilities for syncing state between state containers and different type of state storage (e.g. query params in URL or session storage).</p>
<p>Example app: <code class="literal">examples/state_containers_examples</code></p>
<p>This should become a replacement for <code class="literal">AppState</code> and <code class="literal">GlobalState</code> in NP.</p>
<p><span class="strong strong"><strong><code class="literal">ui/public/utils</code> cleanup</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">base_object</code> and <code class="literal">find_by_param</code> utilities have been removed <a href="https://github.com/elastic/kibana/pull/52500" class="ulink" target="_top">#52500</a>
</li>
<li class="listitem">
<code class="literal">decode_geo_hash</code> and <code class="literal">zoom_to_precision</code> utilities have been moved to <code class="literal">ui/vis/map</code>https://github.com/elastic/kibana/pull/52615[#52615]
</li>
<li class="listitem">
<code class="literal">range</code> utility has beed moved to <code class="literal">ui/vis/editors/default</code> <a href="https://github.com/elastic/kibana/pull/52615" class="ulink" target="_top">#52615</a>
</li>
<li class="listitem">
<code class="literal">cidr_mask</code>, <code class="literal">date_range</code>, <code class="literal">geo_utils</code>,  <code class="literal">ip_range</code>, <code class="literal">ordinal_suffix</code> utilities have been moved to <code class="literal">ui/agg_types</code> <a href="https://github.com/elastic/kibana/pull/52744" class="ulink" target="_top">#52744</a>
</li>
<li class="listitem">
<code class="literal">case_conversion</code> <a href="https://github.com/elastic/kibana/pull/53819" class="ulink" target="_top">#53819</a>
</li>
<li class="listitem">
<code class="literal">keysToSnakeCaseShallow</code> moved to <code class="literal">src/legacy/server/status/lib</code>
</li>
<li class="listitem">
<code class="literal">keysToCamelCaseShallow</code> moved to <code class="literal">src/legacy/core_plugins/kibana/public/management</code>
</li>
<li class="listitem">
<code class="literal">collection</code> <a href="https://github.com/elastic/kibana/pull/53819" class="ulink" target="_top">#53819</a>
</li>
<li class="listitem">
<code class="literal">organizeBy moved to `src/legacy/ui/public/indexed_array</code>
</li>
<li class="listitem">
<code class="literal">pushAll</code> was removed
</li>
<li class="listitem">
<code class="literal">diff_object moved to `ui/state_management</code> <a href="https://github.com/elastic/kibana/pull/53819" class="ulink" target="_top">#53819</a>
</li>
<li class="listitem">
<code class="literal">function</code> was removed <a href="https://github.com/elastic/kibana/pull/53819" class="ulink" target="_top">#53819</a>
</li>
<li class="listitem">
<code class="literal">key_map</code> moved to <code class="literal">ui/directives</code> <a href="https://github.com/elastic/kibana/pull/53819" class="ulink" target="_top">#53819</a>
</li>
<li class="listitem">
<code class="literal">math</code> moved to <code class="literal">ui/vis</code>  <a href="https://github.com/elastic/kibana/pull/53819" class="ulink" target="_top">#53819</a>
</li>
<li class="listitem">
<code class="literal">numeric</code> moved to <code class="literal">src/legacy/core_plugins/kibana/public/management</code> <a href="https://github.com/elastic/kibana/pull/53819" class="ulink" target="_top">#53819</a>
</li>
<li class="listitem">
<code class="literal">parse_interval</code> moved to`src/legacy/core_plugins/data/common` <a href="https://github.com/elastic/kibana/pull/53819" class="ulink" target="_top">#53819</a>
</li>
<li class="listitem">
<code class="literal">sort_prefix_first</code> moved to <code class="literal">x-pack/legacy/plugins/kuery_autocomplete</code> <a href="https://github.com/elastic/kibana/pull/53819" class="ulink" target="_top">#53819</a>
</li>
<li class="listitem">
<code class="literal">supports</code> moved to <code class="literal">src/legacy/core_plugins/tile_map/public</code> <a href="https://github.com/elastic/kibana/pull/53819" class="ulink" target="_top">#53819</a>
</li>
</ul>
</div>
<div class="position-relative"><h4><a id="_index_patterns_moved_to_new_platform"></a>Index Patterns moved to New Platform</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.7/docs/migration/migrate_7_6.asciidoc">edit</a></div>
<p><a href="https://github.com/elastic/kibana/pull/43438" class="ulink" target="_top">#43438</a></p>
<p>The <code class="literal">indexPatterns</code> service is now available from the data plugin.</p>
<div class="pre_wrapper lang-ts">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ts">class MyPlugin {

  start(core, data) {

    const indexPatterns = data.indexPatterns.get(indexPatternId);

    ...

  }

}</pre>
</div>
<p><span class="strong strong"><strong>Type Definitions</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
The <code class="literal">IndexPattern</code> type replaces the legacy <code class="literal">StaticIndexPattern</code> type
</li>
<li class="listitem">
<code class="literal">IndexPattern</code> was moved to the new plugin.
</li>
<li class="listitem">
<code class="literal">FieldList</code> was moved to the new plugin and the <code class="literal">IFieldList</code> type was added.
</li>
<li class="listitem">
<code class="literal">Field</code> was moved to the new plugin, along side the <code class="literal">IFieldType</code> type.
</li>
</ul>
</div>
<div class="pre_wrapper lang-ts">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ts">    import { IIndexPattern, IFieldType } from 'src/plugins/data/public';

    const indexPattern: IIndexPattern = data.indexPatterns.find(indexPatternId);

    const field: IFieldType[] = indexPattern.fields;</pre>
</div>
<p><span class="strong strong"><strong>Helper functions</strong></span></p>
<div class="pre_wrapper lang-ts">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ts">    import { indexPatterns as indexPatternsUtils } from 'src/plugins/data/public';

    const indexPattern: IIndexPattern = indexPatterns.getFromSavedObject(savedObject)

    const isValid = indexPatterns.validateIndexPattern(indexPatternString)</pre>
</div>
<p><span class="strong strong"><strong>Deletions</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">IndexPatternAlreadyExists</code>
</li>
<li class="listitem">
<code class="literal">NoDefaultIndexPattern</code>
</li>
<li class="listitem">
<code class="literal">NoDefinedIndexPatterns</code>
</li>
</ul>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="breaking-changes-7.7.html">« Breaking changes in 7.7</a>
</span>
<span class="next">
<a href="breaking-changes-7.5.html">Breaking changes in 7.5 »</a>
</span>
</div>
</body>
</html>
