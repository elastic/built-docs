<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Add layers for the Elasticsearch data | Kibana Guide [7.9] | Elastic</title>
<link rel="home" href="index.html" title="Kibana Guide [7.9]"/>
<link rel="up" href="maps-getting-started.html" title="Get started with Maps"/>
<link rel="prev" href="maps-add-choropleth-layer.html" title="Add a choropleth layer"/>
<link rel="next" href="maps-save.html" title="Save the map"/>
<meta name="DC.type" content="Learn/Docs/Kibana/Reference/7.9"/>
<meta name="DC.subject" content="Kibana"/>
<meta name="DC.identifier" content="7.9"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body><div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Kibana Guide [7.9]</a></span>
»
<span class="breadcrumb-link"><a href="maps.html">Maps</a></span>
»
<span class="breadcrumb-link"><a href="maps-getting-started.html">Get started with Maps</a></span>
»
<span class="breadcrumb-node">Add layers for the Elasticsearch data</span>
</div>
<div class="navheader">
<span class="prev">
<a href="maps-add-choropleth-layer.html">« Add a choropleth layer</a>
</span>
<span class="next">
<a href="maps-save.html">Save the map »</a>
</span>
</div>
<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="maps-add-elasticsearch-layer"></a>Add layers for the Elasticsearch data<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.9/docs/maps/maps-getting-started.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>
<p>To avoid overwhelming the user with too much data at once, you&#8217;ll add two layers for Elasticsearch data.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
The first layer will display individual documents.
The layer will appear when the user zooms in the map to show smaller regions.
</li>
<li class="listitem">
The second layer will display aggregated data that represents many documents.
The layer will appear when the user zooms out the map to show larger amounts of the globe.
</li>
</ul>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_add_a_vector_layer_to_display_individual_documents"></a>Add a vector layer to display individual documents<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.9/docs/maps/maps-getting-started.asciidoc">edit</a></h3>
</div></div></div>
<p>This layer displays web log documents as points.
The layer is only visible when users zoom in the map past zoom level 9.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Click <span class="strong strong"><strong>Add layer</strong></span>.
</li>
<li class="listitem">
Select <span class="strong strong"><strong>Documents</strong></span>.
</li>
<li class="listitem">
Set <span class="strong strong"><strong>Index pattern</strong></span> to <span class="strong strong"><strong>kibana_sample_data_logs</strong></span>.
</li>
<li class="listitem">
Click the <span class="strong strong"><strong>Add layer</strong></span> button.
</li>
<li class="listitem">
Set <span class="strong strong"><strong>Name</strong></span> to <code class="literal">Actual Requests</code>.
</li>
<li class="listitem">
Set <span class="strong strong"><strong>Visibilty</strong></span> to the range [9, 24].
</li>
<li class="listitem">
Set <span class="strong strong"><strong>Opacity</strong></span> to 100%.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Add</strong></span> under <span class="strong strong"><strong>Tooltip fields</strong></span>.
</li>
<li class="listitem">
In the popover, select <span class="strong strong"><strong>clientip</strong></span>, <span class="strong strong"><strong>timestamp</strong></span>, <span class="strong strong"><strong>host</strong></span>, <span class="strong strong"><strong>request</strong></span>, <span class="strong strong"><strong>response</strong></span>, <span class="strong strong"><strong>machine.os</strong></span>, <span class="strong strong"><strong>agent</strong></span>, and <span class="strong strong"><strong>bytes</strong></span> and click <span class="strong strong"><strong>Add</strong></span>.
</li>
<li class="listitem">
Set <span class="strong strong"><strong>Fill color</strong></span> to <span class="strong strong"><strong>#2200ff</strong></span>.
</li>
<li class="listitem">
<p>Click <span class="strong strong"><strong>Save &amp; close</strong></span>.</p>
<p>Your map now looks like this between zoom levels 9 and 24:</p>
<div class="imageblock screenshot">
<div class="content">
<img src="maps/images/gs_add_es_document_layer.png" alt="gs add es document layer">
</div>
</div>
</li>
</ol>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_add_a_vector_layer_to_display_aggregated_data"></a>Add a vector layer to display aggregated data<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.9/docs/maps/maps-getting-started.asciidoc">edit</a></h3>
</div></div></div>
<p>Aggregations group Elasticsearch documents into grids. You can calculate metrics
for each gridded cell.</p>
<p>You&#8217;ll create a layer for aggregated data and make it visible only when the map
is zoomed out past zoom level 9. Darker colors will symbolize grids
with more web log traffic, and lighter colors will symbolize grids with less
traffic. Larger circles will symbolize grids with
more total bytes transferred, and smaller circles will symbolize
grids with less bytes transferred.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="maps/images/grid_metrics_both.png" alt="grid metrics both">
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_add_the_layer"></a>Add the layer<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.9/docs/maps/maps-getting-started.asciidoc">edit</a></h4>
</div></div></div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Click <span class="strong strong"><strong>Add layer</strong></span>.
</li>
<li class="listitem">
Select <span class="strong strong"><strong>Clusters and grids</strong></span>.
</li>
<li class="listitem">
Set <span class="strong strong"><strong>Index pattern</strong></span> to <span class="strong strong"><strong>kibana_sample_data_logs</strong></span>.
</li>
<li class="listitem">
Click the <span class="strong strong"><strong>Add layer</strong></span> button.
</li>
<li class="listitem">
Set <span class="strong strong"><strong>Name</strong></span> to <code class="literal">Total Requests and Bytes</code>.
</li>
<li class="listitem">
Set <span class="strong strong"><strong>Visibility</strong></span> to the range [0, 9].
</li>
<li class="listitem">
Set <span class="strong strong"><strong>Opacity</strong></span> to 100%.
</li>
</ol>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_configure_the_aggregation_metrics"></a>Configure the aggregation metrics<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.9/docs/maps/maps-getting-started.asciidoc">edit</a></h4>
</div></div></div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Click <span class="strong strong"><strong>Add metric</strong></span> under of <span class="strong strong"><strong>Metrics</strong></span> label.
</li>
<li class="listitem">
Select <span class="strong strong"><strong>Sum</strong></span> in the aggregation select.
</li>
<li class="listitem">
Select <span class="strong strong"><strong>bytes</strong></span> in the field select.
</li>
</ol>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_set_the_layer_style"></a>Set the layer style<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/7.9/docs/maps/maps-getting-started.asciidoc">edit</a></h4>
</div></div></div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>In <span class="strong strong"><strong>Layer style</strong></span>, change <span class="strong strong"><strong>Symbol size</strong></span>:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Set <span class="strong strong"><strong>Min size</strong></span> to 7.
</li>
<li class="listitem">
Set <span class="strong strong"><strong>Max size</strong></span> to 25.
</li>
<li class="listitem">
Change the field select from <span class="strong strong"><strong>count</strong></span> to <span class="strong strong"><strong>sum of bytes</strong></span>.
</li>
</ol>
</div>
</li>
<li class="listitem">
<p>Click <span class="strong strong"><strong>Save &amp; close</strong></span> button.</p>
<p>Your map now looks like this between zoom levels 0 and 9:</p>
<div class="imageblock screenshot">
<div class="content">
<img src="maps/images/sample_data_web_logs.png" alt="sample data web logs">
</div>
</div>
</li>
</ol>
</div>
</div>

</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="maps-add-choropleth-layer.html">« Add a choropleth layer</a>
</span>
<span class="next">
<a href="maps-save.html">Save the map »</a>
</span>
</div>
</div>
</body>
</html>
