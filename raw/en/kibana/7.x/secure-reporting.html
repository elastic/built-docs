<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="description" content="A list of the supported authentication mechanisms in Kibana.">
<meta name="keywords" content="administrator, concept, security, authentication">
<title>Configure reporting in Kibana | Kibana Guide [7.x] | Elastic</title>
<link rel="home" href="index.html" title="Kibana Guide [7.x]"/>
<link rel="up" href="setup.html" title="Set up"/>
<link rel="prev" href="xpack-security-secure-saved-objects.html" title="Secure saved objects"/>
<link rel="next" href="configuring-monitoring.html" title="Configure monitoring in Kibana"/>
<meta name="DC.type" content="Learn/Docs/Kibana/Reference/7.x"/>
<meta name="DC.subject" content="Kibana"/>
<meta name="DC.identifier" content="7.x"/>
</head>
<body><div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Kibana Guide [7.x]</a></span>
»
<span class="breadcrumb-link"><a href="setup.html">Set up</a></span>
»
<span class="breadcrumb-node">Configure reporting in Kibana</span>
</div>
<div class="navheader">
<span class="prev">
<a href="xpack-security-secure-saved-objects.html">« Secure saved objects</a>
</span>
<span class="next">
<a href="configuring-monitoring.html">Configure monitoring in Kibana »</a>
</span>
</div>
<div class="chapter xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="secure-reporting"></a>Configure reporting in Kibana<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/7.x/docs/setup/configuring-reporting.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>

<p>To enable users to manually and automatically generate reports, install the reporting packages, grant users access to the reporting features, and secure the reporting endpoints.</p>
<h3><a id="install-reporting-packages"></a>Install the reporting packages<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/7.x/docs/setup/configuring-reporting.asciidoc">edit</a></h3>
<p>Make sure the Kibana server operating system has the appropriate packages installed for the distribution.</p>
<p>If you are using CentOS/RHEL systems, install the following packages:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">ipa-gothic-fonts</code>
</li>
<li class="listitem">
<code class="literal">xorg-x11-fonts-100dpi</code>
</li>
<li class="listitem">
<code class="literal">xorg-x11-fonts-75dpi</code>
</li>
<li class="listitem">
<code class="literal">xorg-x11-utils</code>
</li>
<li class="listitem">
<code class="literal">xorg-x11-fonts-cyrillic</code>
</li>
<li class="listitem">
<code class="literal">xorg-x11-fonts-Type1</code>
</li>
<li class="listitem">
<code class="literal">xorg-x11-fonts-misc</code>
</li>
<li class="listitem">
<code class="literal">fontconfig</code>
</li>
<li class="listitem">
<code class="literal">freetype</code>
</li>
</ul>
</div>
<p>If you are using Ubuntu/Debian systems, install the following packages:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">fonts-liberation</code>
</li>
<li class="listitem">
<code class="literal">libfontconfig1</code>
</li>
</ul>
</div>
<p>If the system is missing dependencies, <span class="strong strong"><strong>Reporting</strong></span> fails in a non-deterministic way. Kibana runs a self-test at server startup, and
if it encounters errors, logs them in the Console. The error message does not include
information about why Chromium failed to run. The most common error message is <code class="literal">Error: connect ECONNREFUSED</code>, which indicates
that Kibana could not connect to the Chromium process.</p>
<p>To troubleshoot the problem, start the Kibana server with environment variables that tell Chromium to print verbose logs. For more information, refer to <a class="xref" href="reporting-troubleshooting.html#reporting-troubleshooting-puppeteer-debug-logs" title="Puppeteer debug logs">Puppeteer debug logs</a>.</p>
<h3><a id="grant-user-access"></a>Grant users access to reporting<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/7.x/docs/setup/configuring-reporting.asciidoc">edit</a></h3>
<p>When security is enabled, access to the reporting features is controlled by roles and <a class="xref" href="kibana-privileges.html" title="Kibana privileges">privileges</a>. With privileges, you can define custom roles that grant <span class="strong strong"><strong>Reporting</strong></span> privileges as sub-features of Kibana applications. To grant users permission to generate reports and view their reports in <span class="strong strong"><strong>Reporting</strong></span>, create and assign the reporting role.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<a id="reporting-app-users"></a>
<p>In 7.12.0 and earlier, you grant access to the reporting features by assigning users the <code class="literal">reporting_user</code> role in Elasticsearch.</p>
</div>
</div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Create the reporting role.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Open the main menu, then click <span class="strong strong"><strong>Stack Management</strong></span>.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Roles &gt; Create role</strong></span>.
</li>
</ol>
</div>
</li>
<li class="listitem">
<p>Specify the role settings.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Enter the <span class="strong strong"><strong>Role name</strong></span>. For example, <code class="literal">custom_reporting_user</code>.
</li>
<li class="listitem">
<p>Specify the <span class="strong strong"><strong>Indices</strong></span> and <span class="strong strong"><strong>Privileges</strong></span>.</p>
<p>Access to data is an index-level privilege. For each index that contains the data you want to include in reports, add a line, then give each index <code class="literal">read</code> and <code class="literal">view_index_metadata</code> privileges.</p>
<p>For more information, refer to <a href="/guide/en/elasticsearch/reference/7.x/security-privileges.html" class="ulink" target="_top">Security privileges</a>.</p>
</li>
</ol>
</div>
</li>
<li class="listitem">
<p>Add the Kibana privileges.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Click <span class="strong strong"><strong>Add Kibana privilege</strong></span>.
</li>
<li class="listitem">
Select one or more <span class="strong strong"><strong>Spaces</strong></span>.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Customize</strong></span>, then click <span class="strong strong"><strong>Analytics</strong></span>.
</li>
<li class="listitem">
<p>Next to the applications you want to grant reporting privileges, click <span class="strong strong"><strong>All</strong></span>.</p>
<p>If the <span class="strong strong"><strong>Reporting</strong></span> option is unavailable, contact your administrator, or <a class="xref" href="reporting-settings-kb.html#reporting-advanced-settings" title="Security settings">enable the option in kibana.yml</a>.</p>
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Add Kibana privilege</strong></span>.
</li>
</ol>
</div>
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Create role</strong></span>.
</li>
<li class="listitem">
<p>Assign the reporting role to a user.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Open the main menu, then click <span class="strong strong"><strong>Stack Management</strong></span>.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Users</strong></span>, then click the user you want to assign the reporting role to.
</li>
<li class="listitem">
From the <span class="strong strong"><strong>Roles</strong></span> dropdown, select <span class="strong strong"><strong>custom_reporting_user</strong></span>.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Update user</strong></span>.
</li>
</ol>
</div>
</li>
</ol>
</div>
<h4><a id="reporting-roles-user-api"></a>Grant access with the role API<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/7.x/docs/setup/configuring-reporting.asciidoc">edit</a></h4>
<p>You can also use the <a href="/guide/en/elasticsearch/reference/7.x/security-api-put-role.html" class="ulink" target="_top">role API</a> to grant access to the reporting features. Grant the reporting role to users in combination with other roles that grant read access to the data in Elasticsearch, and at least read access in the applications where users can generate reports.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST /_security/role/custom_reporting_user
{
  metadata: {},
  elasticsearch: { cluster: [], indices: [], run_as: [] },
  kibana: [
    {
      base: [],
      feature: {
        dashboard: [
          'generate_report', <a id="CO6-1"></a><i class="conum" data-value="1"></i>
          'download_csv_report' <a id="CO6-2"></a><i class="conum" data-value="2"></i>
        ],
        discover: ['generate_report'], <a id="CO6-3"></a><i class="conum" data-value="3"></i>
        canvas: ['generate_report'], <a id="CO6-4"></a><i class="conum" data-value="4"></i>
        visualize: ['generate_report'], <a id="CO6-5"></a><i class="conum" data-value="5"></i>
      },
      spaces: ['*'],
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/2.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO6-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Grants access to generate PNG and PDF reports in <span class="strong strong"><strong>Dashboard</strong></span>.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO6-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>Grants access to download CSV files from saved search panels in <span class="strong strong"><strong>Dashboard</strong></span>.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO6-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>Grants access to generate CSV reports from saved searches in <span class="strong strong"><strong>Discover</strong></span>.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO6-4"><i class="conum" data-value="4"></i></a></p>
</td>
<td align="left" valign="top">
<p>Grants access to generate PDF reports in <span class="strong strong"><strong>Canvas</strong></span>.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO6-5"><i class="conum" data-value="5"></i></a></p>
</td>
<td align="left" valign="top">
<p>Grants access to generate PNG and PDF reports in <span class="strong strong"><strong>Visualize Library</strong></span>.</p>
</td>
</tr>
</table>
</div>
<h4><a id="_grant_access_using_an_external_provider"></a>Grant access using an external provider<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/7.x/docs/setup/configuring-reporting.asciidoc">edit</a></h4>
<p>If you are using an external identity provider, such as LDAP or Active Directory, you can assign roles to individual users or groups of users. Role mappings are configured in <a href="/guide/en/elasticsearch/reference/7.x/mapping-roles.html" class="ulink" target="_top"><code class="literal">config/role_mapping.yml</code></a>.</p>
<p>For example, assign the <code class="literal">kibana_admin</code> and <code class="literal">reporting_user</code> roles to the Bill Murray user:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">kibana_admin:
  - "cn=Bill Murray,dc=example,dc=com"
reporting_user:
  - "cn=Bill Murray,dc=example,dc=com"</pre>
</div>
<h4><a id="_grant_access_with_a_custom_index"></a>Grant access with a custom index<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/7.x/docs/setup/configuring-reporting.asciidoc">edit</a></h4>
<p>If you are using a custom index, the <code class="literal">xpack.reporting.index</code> setting must begin with <code class="literal">.reporting-*</code>. The default Kibana system user has <code class="literal">all</code> privileges against the <code class="literal">.reporting-*</code> pattern of indices.</p>
<p>If you use a different pattern for the <code class="literal">xpack.reporting.index</code> setting, you must create a custom <code class="literal">kibana_system</code> user with appropriate access to the index.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>In the next major version of Kibana, granting access with a custom index is unsupported.</p>
</div>
</div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Create the reporting role.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Open the main menu, then click <span class="strong strong"><strong>Stack Management</strong></span>.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Roles &gt; Create role</strong></span>.
</li>
</ol>
</div>
</li>
<li class="listitem">
<p>Specify the role settings.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Enter the <span class="strong strong"><strong>Role name</strong></span>. For example, <code class="literal">custom-reporting-user</code>.
</li>
<li class="listitem">
From the <span class="strong strong"><strong>Indices</strong></span> dropdown, select the custom index.
</li>
<li class="listitem">
From the <span class="strong strong"><strong>Privileges</strong></span> dropdown, select <span class="strong strong"><strong>all</strong></span>.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Add Kibana privilege</strong></span>.
</li>
<li class="listitem">
Select one or more <span class="strong strong"><strong>Spaces</strong></span> that you want to grant reporting privileges to.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Customize</strong></span>, then click <span class="strong strong"><strong>Analytics</strong></span>.
</li>
<li class="listitem">
Next to each application you want to grant reporting privileges to, click <span class="strong strong"><strong>All</strong></span>.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Add Kibana privilege</strong></span>, then click <span class="strong strong"><strong>Create role</strong></span>.
</li>
</ol>
</div>
</li>
<li class="listitem">
<p>Assign the reporting role to a user.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Open the main menu, then click <span class="strong strong"><strong>Stack Management</strong></span>.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Users</strong></span>, then click the user you want to assign the reporting role to.
</li>
<li class="listitem">
From the <span class="strong strong"><strong>Roles</strong></span> dropdown, select <span class="strong strong"><strong>kibana_system</strong></span> and <span class="strong strong"><strong>custom-reporting-user</strong></span>.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Update user</strong></span>.
</li>
</ol>
</div>
</li>
<li class="listitem">
<p>Configure Kibana to use the new account.</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">elasticsearch.username: 'custom_kibana_system'</pre>
</div>
</li>
</ol>
</div>
<h3><a id="securing-reporting"></a>Secure the reporting endpoints<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/7.x/docs/setup/configuring-reporting.asciidoc">edit</a></h3>
<p>To automatically generate reports with Watcher, you must configure Watcher to trust the Kibana server certificate.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Enable Elastic Stack security features on your Elasticsearch cluster. For more information, see <a href="/guide/en/elasticsearch/reference/7.x/security-getting-started.html" class="ulink" target="_top">Getting started with security</a>.
</li>
<li class="listitem">
Configure TLS/SSL encryption for the Kibana server. For more information, see <a class="xref" href="configuring-tls.html" title="Encrypt communications in Kibana">Encrypt communications</a>.
</li>
<li class="listitem">
<p>Specify the Kibana server CA certificate chain in <code class="literal">elasticsearch.yml</code>:</p>
<p>If you are using your own CA to sign the Kibana server certificate, then you need to specify the CA certificate chain in Elasticsearch to properly establish trust in TLS connections between Watcher and Kibana. If your CA certificate chain is contained in a PKCS #12 trust store, specify it like so:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">xpack.http.ssl.truststore.path: "/path/to/your/truststore.p12"
xpack.http.ssl.truststore.type: "PKCS12"
xpack.http.ssl.truststore.password: "optional decryption password"</pre>
</div>
<p>Otherwise, if your CA certificate chain is in PEM format, specify it like so:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">xpack.http.ssl.certificate_authorities: ["/path/to/your/cacert1.pem", "/path/to/your/cacert2.pem"]</pre>
</div>
<p>For more information, see <a href="/guide/en/elasticsearch/reference/7.x/notification-settings.html#ssl-notification-settings" class="ulink" target="_top">the Watcher HTTP TLS/SSL Settings</a>.</p>
</li>
<li class="listitem">
<p>Add one or more users who have access to the reporting features.</p>
<p>Once you&#8217;ve enabled SSL for Kibana, all requests to the reporting endpoints must include valid credentials.</p>
</li>
</ol>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="xpack-security-secure-saved-objects.html">« Secure saved objects</a>
</span>
<span class="next">
<a href="configuring-monitoring.html">Configure monitoring in Kibana »</a>
</span>
</div>
</div>
</body>
</html>
