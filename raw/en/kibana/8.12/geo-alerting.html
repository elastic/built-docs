<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Create a tracking containment rule | Kibana Guide [8.12] | Elastic</title>
<meta class="elastic" name="content" content="Create a tracking containment rule | Kibana Guide [8.12]">

<link rel="home" href="index.html" title="Kibana Guide [8.12]"/>
<link rel="up" href="rule-types.html" title="Rule types"/>
<link rel="prev" href="rule-type-es-query.html" title="Create an Elasticsearch query rule"/>
<link rel="next" href="rule-action-variables.html" title="Rule action variables"/>
<meta class="elastic" name="product_version" content="8.12"/>
<meta class="elastic" name="product_name" content="Kibana"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Kibana/Reference/8.12"/>
<meta name="DC.subject" content="Kibana"/>
<meta name="DC.identifier" content="8.12"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body><div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Kibana Guide [8.12]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="alerting-getting-started.html">Alerting</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="rule-types.html">Rule types</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="rule-type-es-query.html">« Create an Elasticsearch query rule</a>
</span>
<span class="next">
<a href="rule-action-variables.html">Rule action variables »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="geo-alerting"></a>Create a tracking containment rule<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.12/docs/user/alerting/rule-types/geo-rule-types.asciidoc">edit</a></h2>
</div></div></div>

<p>The tracking containment rule alerts when an entity is contained or no longer contained within a boundary.</p>
<h4><a id="_requirements_2"></a>Requirements<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.12/docs/user/alerting/rule-types/geo-rule-types.asciidoc">edit</a></h4>
<p>To create a tracking containment rule, the following requirements must be present:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Entities index</strong></span>: An index containing a <code class="literal">geo_point</code> or <code class="literal">geo_shape</code> field, <code class="literal">date</code> field, and entity identifier. An entity identifier is a <code class="literal">keyword</code>, <code class="literal">number</code>, or <code class="literal">ip</code> field that identifies the entity. Entity data is expected to be updating so that there are entity movements to alert upon.
</li>
<li class="listitem">
<span class="strong strong"><strong>Boundaries index</strong></span>: An index containing <code class="literal">geo_shape</code> data.
Boundaries data is expected to be static (not updating). Boundaries are collected once when the rule is created and anytime after when boundary configuration is modified.
</li>
</ul>
</div>
<p>Entity locations are queried to determine if they are contained within any monitored boundaries.
Entity data should be somewhat "real time", meaning the dates of new documents aren’t older
than the current time minus the amount of the interval. If data older than
<code class="literal">now - &lt;current interval&gt;</code> is ingested, it won&#8217;t trigger a rule.</p>
<h4><a id="_actions"></a>Actions<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.12/docs/user/alerting/rule-types/geo-rule-types.asciidoc">edit</a></h4>
<p>A rule can be triggered either when a containment condition is met or when an entity is no longer contained.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="user/alerting/images/alert-types-tracking-containment-action-options.png" alt="Action frequency options for an action" width="75%">
</div>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="rule-type-es-query.html">« Create an Elasticsearch query rule</a>
</span>
<span class="next">
<a href="rule-action-variables.html">Rule action variables »</a>
</span>
</div>
</div>
</body>
</html>
