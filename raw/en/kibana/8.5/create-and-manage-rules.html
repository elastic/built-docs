<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="description" content="Kibana provides you with several options to share *Discover* saved searches, dashboards, *Visualize Library* visualizations, and *Canvas* workpads with others, or on a website.">
<meta name="keywords" content="analyst, concept, task, reporting">
<title>Create and manage rules | Kibana Guide [8.5] | Elastic</title>
<meta class="elastic" name="content" content="Create and manage rules | Kibana Guide [8.5]">

<link rel="home" href="index.html" title="Kibana Guide [8.5]"/>
<link rel="up" href="alerting-getting-started.html" title="Alerting"/>
<link rel="prev" href="alerting-setup.html" title="Alerting set up"/>
<link rel="next" href="rule-types.html" title="Rule types"/>
<meta class="elastic" name="product_version" content="8.5"/>
<meta class="elastic" name="product_name" content="Kibana"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Kibana/Reference/8.5"/>
<meta name="DC.subject" content="Kibana"/>
<meta name="DC.identifier" content="8.5"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body><div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Kibana Guide [8.5]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="alerting-getting-started.html">Alerting</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="alerting-setup.html">« Alerting set up</a>
</span>
<span class="next">
<a href="rule-types.html">Rule types »</a>
</span>
</div>
<div class="chapter">
<div class="titlepage"><div><div>
<h2 class="title"><a id="create-and-manage-rules"></a>Create and manage rules<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.5/docs/user/alerting/create-and-manage-rules.asciidoc">edit</a></h2>
</div></div></div>
<p>The <span class="strong strong"><strong>Stack Management</strong></span> &gt; <span class="strong strong"><strong>Rules and Connectors</strong></span> UI provides a cross-app view of alerting.
Different Kibana apps like <a href="/guide/en/observability/8.5/create-alerts.html" class="ulink" target="_top"><span class="strong strong"><strong>Observability</strong></span></a>,
<a href="/guide/en/security/8.5/prebuilt-rules.html" class="ulink" target="_top"><span class="strong strong"><strong>Security</strong></span></a>, <a class="xref" href="geo-alerting.html" title="Tracking containment"><span class="strong strong"><strong>Maps</strong></span></a> and
<a class="xref" href="xpack-ml.html" title="Machine learning"><span class="strong strong"><strong>Machine Learning</strong></span></a> can offer their own rules. <span class="strong strong"><strong>Rules and Connectors</strong></span> provides a
central place to:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="create-and-manage-rules.html#create-edit-rules" title="Create and edit rules">Create and edit</a> rules
</li>
<li class="listitem">
<a class="xref" href="create-and-manage-rules.html#controlling-rules" title="Snooze and disable rules">Manage rules</a> including enabling/disabling, muting/unmuting, and deleting
</li>
<li class="listitem">
Drill down to <a class="xref" href="create-and-manage-rules.html#rule-details" title="Drill down to rule details">rule details</a>
</li>
</ul>
</div>
<p class="screenshot"><span class="image"><img src="images/rules-and-connectors-ui.png" alt="Example rule listing in Rules and Connectors"></span></p>
<p>For more information on alerting concepts and the types of rules and connectors
available, go to <a class="xref" href="alerting-getting-started.html" title="Alerting">Alerting</a>.</p>
<h3><a id="_required_permissions"></a>Required permissions<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.5/docs/user/alerting/create-and-manage-rules.asciidoc">edit</a></h3>
<p>Access to rules is granted based on your privileges to alerting features. For
more information, go to <a class="xref" href="alerting-setup.html#alerting-security" title="Security">Security</a>.</p>
<h3><a id="create-edit-rules"></a>Create and edit rules<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.5/docs/user/alerting/create-and-manage-rules.asciidoc">edit</a></h3>
<p>Many rules must be created within the context of a Kibana app like
<a class="xref" href="observability.html#metrics-app" title="Metrics">Metrics</a>, <a class="xref" href="xpack-apm.html" title="APM">APM</a>, or <a class="xref" href="observability.html#uptime-app" title="Uptime">Uptime</a>, but others
are generic. Generic rule types can be created in <span class="strong strong"><strong>Rules and Connectors</strong></span> by clicking the
<span class="strong strong"><strong>Create rule</strong></span> button. This will launch a flyout that guides you through selecting
a rule type and configuring its conditions and action type. For details on what
types of rules are available and how to configure them, refer to <a class="xref" href="rule-types.html#stack-rules" title="Stack rules">Stack rules</a>.</p>
<p>After a rule is created, you can open the action menu (…) and select <span class="strong strong"><strong>Edit rule</strong></span>
to re-open the flyout and change the rule properties.</p>
<h4><a id="defining-rules-general-details"></a>General rule details<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.5/docs/user/alerting/create-and-manage-rules.asciidoc">edit</a></h4>
<p>All rules share the following four properties:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Name
</span>
</dt>
<dd>
The name of the rule. While this name does not have to be unique, a
distinctive name can help you identify a rule.
</dd>
<dt>
<span class="term">
Tags
</span>
</dt>
<dd>
A list of tag names that can be applied to a rule. Tags can help you
organize and find rules.
</dd>
<dt>
<span class="term">
Check every
</span>
</dt>
<dd>
Defines how often to evaluate the rule condition. Checks are
queued; they run as close to the defined value as capacity allows. For more
details, go to <a class="xref" href="alerting-production-considerations.html" title="Alerting production considerations">Alerting production considerations</a>.
</dd>
<dt>
<span class="term">
Notify
</span>
</dt>
<dd>
<p>
Defines how often alerts generate actions. Options include running
actions at each check interval, only when the alert status changes, or at a
custom action interval.
</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<a id="alerting-concepts-suppressing-duplicate-notifications"></a>
<p>Since actions are triggered per alert, a rule can end up generating a large
number of actions. Take the following example where a rule is monitoring three
servers every minute for CPU usage &gt; 0.9, and the rule is set to notify
<code class="literal">On check intervals</code>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Minute 1: server X123 &gt; 0.9. <em>One email</em> is sent for server X123.
</li>
<li class="listitem">
Minute 2: X123 and Y456 &gt; 0.9. <em>Two emails</em> are sent, one for X123 and one for Y456.
</li>
<li class="listitem">
Minute 3: X123, Y456, Z789 &gt; 0.9. <em>Three emails</em> are sent, one for each of X123, Y456, Z789.
</li>
</ul>
</div>
<p>In this example, three emails are sent for server X123 in the span of 3 minutes
for the same rule. Often, it&#8217;s desirable to suppress these re-notifications. If
you set the rule notify setting to <code class="literal">On custom action intervals</code> with an interval
of 5 minutes, you reduce noise by getting emails only every 5 minutes for
servers that continue to exceed the threshold:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Minute 1: server X123 &gt; 0.9. <em>One email</em> is sent for server X123.
</li>
<li class="listitem">
Minute 2: X123 and Y456 &gt; 0.9. <em>One email</em> is sent for Y456.
</li>
<li class="listitem">
Minute 3: X123, Y456, Z789 &gt; 0.9. <em>One email</em> is sent for Z789.
</li>
</ul>
</div>
<p>To get notified only once when a server exceeds the threshold, you can set the
rule notify setting to <code class="literal">On status changes</code>.</p>
</div>
</div>
</dd>
</dl>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="images/rule-flyout-general-details.png" alt="All rules have name, tags, check every, and notify properties in common">
</div>
</div>
<h4><a id="defining-rules-type-conditions"></a>Rule type and conditions<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.5/docs/user/alerting/create-and-manage-rules.asciidoc">edit</a></h4>
<p>Depending upon the Kibana app and context, you might be prompted to choose the type of rule to create. Some apps will preselect the type of rule for you.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/rule-flyout-rule-type-selection.png" alt="Choosing the type of rule to create">
</div>
</div>
<p>Each rule type provides its own way of defining the conditions to detect, but an expression formed by a series of clauses is a common pattern. Each clause has a UI control that allows you to define the clause. For example, in an index threshold rule, the <code class="literal">WHEN</code> clause allows you to select an aggregation operation to apply to a numeric field.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/rule-flyout-rule-conditions.png" alt="UI for defining rule conditions on an index threshold rule">
</div>
</div>
<h4><a id="defining-rules-actions-details"></a>Action type and details<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.5/docs/user/alerting/create-and-manage-rules.asciidoc">edit</a></h4>
<p>To receive notifications when a rule meets the defined conditions, you must add one or more actions. Start by selecting a type of connector for your action:</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/rule-flyout-connector-type-selection.png" alt="UI for selecting an action type">
</div>
</div>
<p>Each action must specify a <a class="xref" href="alerting-getting-started.html#alerting-concepts-connectors" title="Connectors">connector</a> instance. If no connectors exist for the selected type, click <span class="strong strong"><strong>Add connector</strong></span> to create one.</p>
<p>After you have selected a connector, use the <span class="strong strong"><strong>Run When</strong></span> dropdown to choose the action group to associate with this action. When a rule meets the defined condition, it is marked as <span class="strong strong"><strong>Active</strong></span> and alerts are created and assigned to an action group. In addition to the action groups defined by the selected rule type, each rule also has a <span class="strong strong"><strong>Recovered</strong></span> action group that is assigned when a rule&#8217;s conditions are no longer detected.</p>
<p>Each action type exposes different properties. For example, an email action allows you to set the recipients, the subject, and a message body in markdown format. See <a class="xref" href="action-types.html" title="Connectors"><em>Connectors</em></a> for details on the types of actions provided by Kibana and their properties.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/rule-flyout-action-details.png" alt="UI for defining an email action">
</div>
</div>
<h5><a id="defining-rules-actions-variables"></a>Action variables<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.5/docs/user/alerting/create-and-manage-rules.asciidoc">edit</a></h5>
<p>Using the <a href="https://mustache.github.io/" class="ulink" target="_top">Mustache</a> template syntax <code class="literal">{{variable name}}</code>, you can pass rule values at the time a condition is detected to an action. You can access the list of available variables using the "add rule variable" button. Although available variables differ by rule type, all rule types pass the following variables:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">rule.id</code>
</span>
</dt>
<dd>
The ID of the rule.
</dd>
<dt>
<span class="term">
<code class="literal">rule.name</code>
</span>
</dt>
<dd>
The name of the rule.
</dd>
<dt>
<span class="term">
<code class="literal">rule.spaceId</code>
</span>
</dt>
<dd>
The ID of the space for the rule.
</dd>
<dt>
<span class="term">
<code class="literal">rule.tags</code>
</span>
</dt>
<dd>
The list of tags applied to the rule.
</dd>
<dt>
<span class="term">
<code class="literal">date</code>
</span>
</dt>
<dd>
The date the rule scheduled the action, in ISO format.
</dd>
<dt>
<span class="term">
<code class="literal">alert.id</code>
</span>
</dt>
<dd>
The ID of the alert that scheduled the action.
</dd>
<dt>
<span class="term">
<code class="literal">alert.actionGroup</code>
</span>
</dt>
<dd>
The ID of the action group of the alert that scheduled the action.
</dd>
<dt>
<span class="term">
<code class="literal">alert.actionSubgroup</code>
</span>
</dt>
<dd>
The action subgroup of the alert that scheduled the action.
</dd>
<dt>
<span class="term">
<code class="literal">alert.actionGroupName</code>
</span>
</dt>
<dd>
The name of the action group of the alert that scheduled the action.
</dd>
<dt>
<span class="term">
<code class="literal">kibanaBaseUrl</code>
</span>
</dt>
<dd>
The configured <a class="xref" href="settings.html#server-publicBaseUrl"><code class="literal">server.publicBaseUrl</code></a>. If not configured, this will be empty.
</dd>
</dl>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="images/rule-flyout-action-variables.png" alt="Passing rule values to an action">
</div>
</div>
<p>Some cases exist where the variable values will be "escaped", when used in a context where escaping is needed:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For the <a class="xref" href="email-action-type.html" title="Email connector and action">Email</a> connector, the <code class="literal">message</code> action configuration property escapes any characters that would be interpreted as Markdown.
</li>
<li class="listitem">
For the <a class="xref" href="slack-action-type.html" title="Slack connector and action">Slack</a> connector, the <code class="literal">message</code> action configuration property escapes any characters that would be interpreted as Slack Markdown.
</li>
<li class="listitem">
For the <a class="xref" href="webhook-action-type.html" title="Webhook connector and action">Webhook</a> connector, the <code class="literal">body</code> action configuration property escapes any characters that are invalid in JSON string values.
</li>
</ul>
</div>
<p>Mustache also supports "triple braces" of the form <code class="literal">{{{variable name}}}</code>, which indicates no escaping should be done at all.  Care should be used when using this form, as it could end up rendering the variable content in such a way as to make the resulting parameter invalid or formatted incorrectly.</p>
<p>Each rule type defines additional variables as properties of the variable <code class="literal">context</code>.  For example, if a rule type defines a variable <code class="literal">value</code>, it can be used in an action parameter as <code class="literal">{{context.value}}</code>.</p>
<p>For diagnostic or exploratory purposes, action variables whose values are objects, such as <code class="literal">context</code>, can be referenced directly as variables.  The resulting value will be a JSON representation of the object.  For example, if an action parameter includes <code class="literal">{{context}}</code>, it will expand to the JSON representation of all the variables and values provided by the rule type.</p>
<p>You can attach more than one action. Clicking the <span class="strong strong"><strong>Add action</strong></span> button will prompt you to select another rule type and repeat the above steps again.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Actions are not required on rules. You can run a rule without actions to
understand its behavior, then <a class="xref" href="alert-action-settings-kb.html#action-settings" title="Action settings">configure actions</a> later.</p>
</div>
</div>
<h3><a id="controlling-rules"></a>Snooze and disable rules<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.5/docs/user/alerting/create-and-manage-rules.asciidoc">edit</a></h3>
<p>The rule listing enables you to quickly snooze, disable, enable, or delete
individual rules. For example, you can change the state of a rule:</p>
<p class="screenshot"><span class="image"><img src="images/individual-enable-disable.png" alt="Use the rule status dropdown to enable or disable an individual rule"></span></p>
<p>When you snooze a rule, the rule checks continue to run on a schedule but the
alert will not trigger any actions. You can snooze for a specified period of
time, indefinitely, or schedule single or recurring downtimes:</p>
<p class="screenshot"><span class="image"><img src="images/snooze-panel.png" alt="Snooze notifications for a rule"></span></p>
<p>When a rule is in a <code class="literal">snoozed</code> state, you can cancel or change the duration of
this state.</p>
<h3><a id="_rule_status"></a>Rule status<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.5/docs/user/alerting/create-and-manage-rules.asciidoc">edit</a></h3>
<p>A rule can have one of the following statuses:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">active</code>
</span>
</dt>
<dd>
The conditions for the rule have been met, and the associated actions should be invoked.
</dd>
<dt>
<span class="term">
<code class="literal">ok</code>
</span>
</dt>
<dd>
The conditions for the rule have not been met, and the associated actions are not invoked.
</dd>
<dt>
<span class="term">
<code class="literal">error</code>
</span>
</dt>
<dd>
An error was encountered by the rule.
</dd>
<dt>
<span class="term">
<code class="literal">pending</code>
</span>
</dt>
<dd>
The rule has not yet run.  The rule was either just created, or enabled after being disabled.
</dd>
<dt>
<span class="term">
<code class="literal">unknown</code>
</span>
</dt>
<dd>
A problem occurred when calculating the status. Most likely, something went wrong with the alerting code.
</dd>
</dl>
</div>
<h3><a id="importing-and-exporting-rules"></a>Import and export rules<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.5/docs/user/alerting/create-and-manage-rules.asciidoc">edit</a></h3>
<p>To import and export rules, use <a class="xref" href="managing-saved-objects.html" title="Manage saved objects">Saved Objects</a>.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Some rule types cannot be exported through this interface:</p>
<p><span class="strong strong"><strong>Security rules</strong></span> can be imported and exported using the <a href="/guide/en/security/8.5/rules-ui-management.html#import-export-rules-ui" class="ulink" target="_top">Security UI</a>.</p>
<p><span class="strong strong"><strong>Stack monitoring rules</strong></span> are <a class="xref" href="kibana-alerts.html" title="Kibana alerts">automatically created</a> for you and therefore cannot be managed in <span class="strong strong"><strong>Saved Objects</strong></span>.</p>
</div>
</div>
<p>Rules are disabled on export. You are prompted to re-enable the rule on successful import.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/rules-imported-banner.png" alt="Rules import banner" width="50%">
</div>
</div>
<h3><a id="rule-details"></a>Drill down to rule details<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.5/docs/user/alerting/create-and-manage-rules.asciidoc">edit</a></h3>
<p>Select a rule name from the rule listing to access the <span class="strong strong"><strong>Rule details</strong></span> page, which tells you about the state of the rule and provides granular control over the actions it is taking.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/rule-details-alerts-active.png" alt="Rule details page with three alerts">
</div>
</div>
<p>In this example, the rule detects when a site serves more than a threshold number of bytes in a 24 hour period. Four sites are above the threshold. These are called alerts - occurrences of the condition being detected - and the alert name, status, time of detection, and duration of the condition are shown in this view. Alerts come and go from the list depending on whether the rule conditions are met.</p>
<p>When an alert is created, it generates actions. If the conditions that caused the alert persist, the actions run again according to the rule notification settings. There are two common alert statuses:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">active</code>
</span>
</dt>
<dd>
The conditions for the rule are met, and actions should be generated according to the notification settings.
</dd>
<dt>
<span class="term">
<code class="literal">recovered</code>
</span>
</dt>
<dd>
The conditions for the rule are no longer met, and recovery actions should be generated.
</dd>
</dl>
</div>
<p>You can suppress future actions for a specific alert by turning on the <span class="strong strong"><strong>Mute</strong></span> toggle. If a muted alert no longer meets the rule conditions, it stays in the list to avoid generating actions if the conditions recur. You can also disable a rule, which stops it from running checks and clears any alerts it was tracking. You may want to disable rules that are not currently needed to reduce the load on Kibana and Elasticsearch.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/rule-details-disabling.png" alt="Use the disable toggle to turn off rule checks and clear alerts tracked">
</div>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="alerting-setup.html">« Alerting set up</a>
</span>
<span class="next">
<a href="rule-types.html">Rule types »</a>
</span>
</div>
</div>
</body>
</html>
