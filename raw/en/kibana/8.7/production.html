<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="description" content="Consider the production components that are used to generate reports.">
<meta name="keywords" content="administrator, analyst, concept, setup, reporting">
<title>Use Kibana in a production environment | Kibana Guide [8.7] | Elastic</title>
<meta class="elastic" name="content" content="Use Kibana in a production environment | Kibana Guide [8.7]">

<link rel="home" href="index.html" title="Kibana Guide [8.7]"/>
<link rel="up" href="index.html" title="Kibana Guide [8.7]"/>
<link rel="prev" href="kibana-verification-code.html" title="kibana-verification-code"/>
<link rel="next" href="Security-production-considerations.html" title="Security production considerations"/>
<meta class="elastic" name="product_version" content="8.7"/>
<meta class="elastic" name="product_name" content="Kibana"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Kibana/Reference/8.7"/>
<meta name="DC.subject" content="Kibana"/>
<meta name="DC.identifier" content="8.7"/>
</head>
<body>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Kibana Guide [8.7]</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="kibana-verification-code.html">« kibana-verification-code</a>
</span>
<span class="next">
<a href="Security-production-considerations.html">Security production considerations »</a>
</span>
</div>
<div class="part">
<div class="titlepage"><div><div>
<h1 class="title"><a id="production"></a>Use Kibana in a production environment<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/8.7/docs/user/production-considerations/production.asciidoc">edit</a></h1>
</div></div></div>
<div class="openblock partintro">
<div class="content">

<p>How you deploy Kibana largely depends on your use case. If you are the only user,
you can run Kibana on your local machine and configure it to point to whatever
Elasticsearch instance you want to interact with. Conversely, if you have a large
number of heavy Kibana users, you might need to load balance across multiple
Kibana instances that are all connected to the same Elasticsearch instance.</p>
<p>While Kibana isn&#8217;t terribly resource intensive, we still recommend running Kibana
separate from  your Elasticsearch data or master nodes. To distribute Kibana
traffic across the nodes in your Elasticsearch cluster,
you can configure Kibana to use a list of Elasticsearch hosts.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>Kibana does not support rolling upgrades, and deploying mixed versions of Kibana can result in data loss or upgrade failures. Please shut down all instances of Kibana before performing an upgrade, and ensure all running Kibana instances have matching versions.</p>
</div>
</div>
<h3><a id="load-balancing-kibana"></a>Load balancing across multiple Kibana instances<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/8.7/docs/user/production-considerations/production.asciidoc">edit</a></h3>
<p>To serve multiple Kibana installations behind a load balancer, you must change the configuration.
See <a href="/guide/en/kibana/8.7/settings.html" class="ulink" target="_top">Configuring Kibana</a> for details on each setting.</p>
<p>These settings must be unique across each Kibana instance:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">server.uuid // if not provided, this is autogenerated
server.name
path.data
pid.file
server.port</pre>
</div>
<p>When using a file appender, the target file must also be unique:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">logging:
  appenders:
    default:
      type: file
      fileName: /unique/path/per/instance</pre>
</div>
<p>Settings that must be the same:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">xpack.security.encryptionKey //decrypting session information
xpack.security.authc.* // authentication configuration
xpack.security.session.* // session configuration
xpack.reporting.encryptionKey //decrypting reports
xpack.encryptedSavedObjects.encryptionKey // decrypting saved objects
xpack.encryptedSavedObjects.keyRotation.decryptionOnlyKeys // saved objects encryption key rotation, if any</pre>
</div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>If the authentication configuration does not match, sessions from unrecognized providers in each Kibana instance will be deleted during that instance&#8217;s regular session cleanup. Similarly, inconsistencies in session configuration can also lead to undesired session logouts. This also applies to any Kibana instances that are backed by the same Elasticsearch instance and share the same kibana.index, even if they are not behind the same load balancer.</p>
</div>
</div>
<p>Separate configuration files can be used from the command line by using the <code class="literal">-c</code> flag:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">bin/kibana -c config/instance1.yml
bin/kibana -c config/instance2.yml</pre>
</div>
<h3><a id="accessing-load-balanced-kibana"></a>Accessing multiple load-balanced Kibana clusters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/8.7/docs/user/production-considerations/production.asciidoc">edit</a></h3>
<p>To access multiple load-balanced Kibana clusters from the same browser,
explicitly set <code class="literal">xpack.security.cookieName</code> to the same value in the Kibana configuration
of each Kibana instance.</p>
<p>Each Kibana cluster must have a different value of <code class="literal">xpack.security.cookieName</code>.</p>
<p>This avoids conflicts between cookies from the different Kibana instances.</p>
<p>This will achieve seamless high availability and keep the session
active in case of failure from the currently used instance.</p>
<h3><a id="high-availability"></a>High availability across multiple Elasticsearch nodes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/8.7/docs/user/production-considerations/production.asciidoc">edit</a></h3>
<p>Kibana can be configured to connect to multiple Elasticsearch nodes in the same cluster.  In situations where a node becomes unavailable,
Kibana will transparently connect to an available node and continue operating.  Requests to available hosts will be routed in a round robin fashion.</p>
<p>In kibana.yml:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">elasticsearch.hosts:
  - http://elasticsearch1:9200
  - http://elasticsearch2:9200</pre>
</div>
<p>Related configurations include <code class="literal">elasticsearch.sniffInterval</code>, <code class="literal">elasticsearch.sniffOnStart</code>, and <code class="literal">elasticsearch.sniffOnConnectionFault</code>.
These can be used to automatically update the list of hosts as a cluster is resized.  Parameters can be found on the <a href="/guide/en/kibana/8.7/settings.html" class="ulink" target="_top">settings page</a>.</p>
<h3><a id="memory"></a>Memory<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/8.7/docs/user/production-considerations/production.asciidoc">edit</a></h3>
<p>Kibana has a default memory limit that scales based on total memory available.  In some scenarios, such as large reporting jobs,
it may make sense to tweak limits to meet more specific requirements.</p>
<p>A limit can be defined by setting <code class="literal">--max-old-space-size</code> in the <code class="literal">node.options</code> config file found inside the <code class="literal">kibana/config</code> folder or any other folder configured with the environment variable <code class="literal">KBN_PATH_CONF</code>. For example, in the Debian-based system, the folder is <code class="literal">/etc/kibana</code>.</p>
<p>The option accepts a limit in MB:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">--max-old-space-size=2048</pre>
</div>
</div>
</div>




</div>
<div class="navfooter">
<span class="prev">
<a href="kibana-verification-code.html">« kibana-verification-code</a>
</span>
<span class="next">
<a href="Security-production-considerations.html">Security production considerations »</a>
</span>
</div>
</div>
</body>
</html>
