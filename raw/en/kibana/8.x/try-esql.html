<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Using ES|QL | Kibana Guide [8.x] | Elastic</title>
<meta class="elastic" name="content" content="Using ES|QL | Kibana Guide [8.x]">

<link rel="home" href="index.html" title="Kibana Guide [8.x]"/>
<link rel="up" href="discover.html" title="Discover"/>
<link rel="prev" href="search-sessions.html" title="Run a search session in the background"/>
<link rel="next" href="dashboard.html" title="Dashboards"/>
<meta class="elastic" name="product_version" content="8.x"/>
<meta class="elastic" name="product_name" content="Kibana"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Kibana/Reference/8.x"/>
<meta name="DC.subject" content="Kibana"/>
<meta name="DC.identifier" content="8.x"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
This documentation contains work-in-progress information for future Elastic Stack and Cloud releases. Use the version selector to view supported release docs. It also contains some Elastic Cloud serverless information. Check out our <a href="https://www.elastic.co/docs/current/serverless">serverless docs</a> for more details.
</div>
<div class="navheader">
<span class="prev">
<a href="search-sessions.html">« Run a search session in the background</a>
</span>
<span class="next">
<a href="dashboard.html">Dashboards »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Kibana Guide [8.x]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="discover.html">Discover</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Using ES|QL</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.x/docs/discover/try-esql.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="chapter">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="try-esql"></a>Using ES|QL</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.x/docs/discover/try-esql.asciidoc">edit</a></div>
</div></div></div>
<p>The Elasticsearch Query Language, ES|QL, makes it easier to explore your data without leaving Discover.</p>
<p>In this tutorial we&#8217;ll use the Kibana sample web logs in Discover and Lens to explore the data and create visualizations.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>For the complete ES|QL documentation, including tutorials, examples and the full syntax reference, refer to the <a href="/guide/en/elasticsearch/reference/8.x/esql.html" class="ulink" target="_top">Elasticsearch documentation</a>.
For a more detailed overview of ES|QL in Kibana, refer to <a href="/guide/en/elasticsearch/reference/8.x/esql-kibana.html" class="ulink" target="_top">Use ES|QL in Kibana</a>.</p>
</div>
</div>
<div class="position-relative"><h3><a id="prerequisite"></a>Prerequisite</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.x/docs/discover/try-esql.asciidoc">edit</a></div>
<p>To view the ES|QL option in <span class="strong strong"><strong>Discover</strong></span>, the <code class="literal">enableESQL</code> setting must be enabled from Kibana&#8217;s <span class="strong strong"><strong>Advanced Settings</strong></span>. It is enabled by default.</p>
<div class="position-relative"><h3><a id="tutorial-try-esql"></a>Use ES|QL</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.x/docs/discover/try-esql.asciidoc">edit</a></div>
<p>To load the sample data:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
On the home page, click <span class="strong strong"><strong>Try sample data</strong></span>.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Other sample data sets</strong></span>.
</li>
<li class="listitem">
On the Sample web logs card, click <span class="strong strong"><strong>Add data</strong></span>.
</li>
<li class="listitem">
Open the main menu and select <span class="strong strong"><strong>Discover</strong></span>.
</li>
<li class="listitem">
Select <span class="strong strong"><strong>Try ES|QL</strong></span> from the application menu bar.
</li>
</ol>
</div>
<p>Let&#8217;s say we want to find out what operating system users have and how much RAM is on their machine.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Set the time range to <span class="strong strong"><strong>Last 7 days</strong></span>.
</li>
<li class="listitem">
<p>Copy the query below:</p>
<div class="pre_wrapper lang-esql">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-esql">FROM kibana_sample_data_logs <a id="CO25-1"></a><i class="conum" data-value="1"></i>
| KEEP machine.os, machine.ram <a id="CO25-2"></a><i class="conum" data-value="2"></i></pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO25-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>We&#8217;re specifically looking for data from the sample web logs we just installed.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO25-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>We&#8217;re only keeping the <code class="literal">machine.os</code> and <code class="literal">machine.ram</code> fields in the results table.</p>
</td>
</tr>
</table>
</div>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>Put each processing command on a new line for better readability.</p>
</div>
</div>
</li>
<li class="listitem">
<p>Click <span class="strong strong"><strong>▶Run</strong></span>.</p>
<p class="screenshot"><span class="image"><img src="images/esql-machine-os-ram.png" alt="An image of the query result"></span></p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>ES|QL keywords are not case sensitive.</p>
</div>
</div>
</li>
</ol>
</div>
<p>Let&#8217;s add <code class="literal">geo.dest</code> to our query, to find out the geographical destination of the visits, and limit the results.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Copy the query below:</p>
<div class="pre_wrapper lang-esql">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-esql">FROM kibana_sample_data_logs
| KEEP machine.os, machine.ram, geo.dest
| LIMIT 10</pre>
</div>
</li>
<li class="listitem">
<p>Click <span class="strong strong"><strong>▶Run</strong></span> again. You can notice that the table is now limited to 10 results. The visualization also updated automatically based on the query, and broke down the data for you.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>When you don&#8217;t specify any specific fields to retain using <code class="literal">KEEP</code>, the visualization isn&#8217;t broken down automatically. Instead, an additional option appears above the visualization and lets you select a field manually.</p>
</div>
</div>
<p class="screenshot"><span class="image"><img src="images/esql-limit.png" alt="An image of the extended query result"></span></p>
</li>
</ol>
</div>
<p>We will now take it a step further to sort the data by machine ram and filter out the <code class="literal">GB</code> destination.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Copy the query below:</p>
<div class="pre_wrapper lang-esql">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-esql">FROM kibana_sample_data_logs
| KEEP machine.os, machine.ram, geo.dest
| SORT machine.ram desc
| WHERE geo.dest != "GB"
| LIMIT 10</pre>
</div>
</li>
<li class="listitem">
<p>Click <span class="strong strong"><strong>▶Run</strong></span> again. The table and visualization no longer show results for which the <code class="literal">geo.dest</code> field value is "GB", and the results are now sorted in descending order in the table based on the <code class="literal">machine.ram</code> field.</p>
<p class="screenshot"><span class="image"><img src="images/esql-full-query.png" alt="An image of the full query result"></span></p>
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Save</strong></span> to save the query and visualization to a dashboard.
</li>
</ol>
</div>
<div class="position-relative"><h4><a id="_edit_the_esql_visualization"></a>Edit the ES|QL visualization</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.x/docs/discover/try-esql.asciidoc">edit</a></div>
<p>You can make changes to the visualization by clicking the pencil icon. This opens additional settings that let you adjust the chart type, axes, breakdown, colors, and information displayed to your liking. If you&#8217;re not sure which route to go, check one of the suggestions available in the visualization editor.</p>
<p>If you&#8217;d like to keep the visualization and add it to a dashboard, you can save it using the floppy disk icon.</p>
<div class="position-relative"><h4><a id="_esql_and_time_series_data"></a>ES|QL and time series data</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/kibana/edit/8.x/docs/discover/try-esql.asciidoc">edit</a></div>
<p>By default, ES|QL identifies time series data when an index contains a <code class="literal">@timestamp</code> field. This enables the time range selector and visualization options for your query.</p>
<p>If your index doesn&#8217;t have an explicit <code class="literal">@timestamp</code> field, but has a different time field, you can still enable the time range selector and visualization options by calling the <code class="literal">?_start</code> and <code class="literal">?_tend</code> parameters in your query.</p>
<p>For example, the eCommerce sample data set doesn&#8217;t have a <code class="literal">@timestamp</code> field, but has an <code class="literal">order_date</code> field.</p>
<p>By default, when querying this data set, time series capabilities aren&#8217;t active. No visualization is generated and the time picker is disabled.</p>
<div class="pre_wrapper lang-esql">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-esql">FROM kibana_sample_data_ecommerce
| KEEP customer_first_name, email, products._id.keyword</pre>
</div>
<div class="imageblock">
<div class="content">
<img src="images/esql-no-time-series.png" alt="ESQL query without time series capabilities enabled">
</div>
</div>
<p>While still querying the same data set, by adding the <code class="literal">?_start</code> and <code class="literal">?_tend</code> parameters based on the <code class="literal">order_date</code> field, <span class="strong strong"><strong>Discover</strong></span> enables times series capabilities.</p>
<div class="pre_wrapper lang-esql">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-esql">FROM kibana_sample_data_ecommerce
| WHERE order_date &gt;= ?_tstart and order_date &lt;= ?_tend</pre>
</div>
<div class="imageblock">
<div class="content">
<img src="images/esql-custom-time-series.png" alt="ESQL query with a custom time field enabled">
</div>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="search-sessions.html">« Run a search session in the background</a>
</span>
<span class="next">
<a href="dashboard.html">Dashboards »</a>
</span>
</div>
</body>
</html>
