<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Production considerations | Kibana Guide [master] | Elastic</title>
<link rel="home" href="index.html" title="Kibana Guide [master]"/>
<link rel="up" href="alerting-getting-started.html" title="Alerting and Actions"/>
<link rel="prev" href="geo-alerting.html" title="Geo alerting"/>
<link rel="next" href="api.html" title="REST API"/>
<meta name="DC.type" content="Learn/Docs/Kibana/Reference/master"/>
<meta name="DC.subject" content="Kibana"/>
<meta name="DC.identifier" content="master"/>
</head>
<body><div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Kibana Guide [master]</a></span>
»
<span class="breadcrumb-link"><a href="alerting-getting-started.html">Alerting and Actions</a></span>
»
<span class="breadcrumb-node">Production considerations</span>
</div>
<div class="navheader">
<span class="prev">
<a href="geo-alerting.html">« Geo alerting</a>
</span>
<span class="next">
<a href="api.html">REST API »</a>
</span>
</div>
<div class="chapter xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="alerting-production-considerations"></a>Production considerations<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/master/docs/user/alerting/alerting-production-considerations.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>
<p>Kibana alerting run both alert checks and actions as persistent background tasks managed by the Kibana Task Manager. This has two major benefits:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Persistence</strong></span>: all task state and scheduling is stored in Elasticsearch, so if Kibana is restarted, alerts and actions will pick up where they left off.  Task definitions for alerts and actions are stored in the index specified by <code class="literal">xpack.task_manager.index</code> (defaults to <code class="literal">.kibana_task_manager</code>).  It is important to have at least 1 replica of this index for production deployments, since if you lose this index all scheduled alerts and actions are also lost.
</li>
<li class="listitem">
<span class="strong strong"><strong>Scaling</strong></span>: multiple Kibana instances can read from and update the same task queue in Elasticsearch, allowing the alerting and action load to be distributed across instances. In cases where a Kibana instance no longer has capacity to run alert checks or actions, capacity can be increased by adding additional Kibana instances.
</li>
</ul>
</div>
<h3><a id="_running_background_alert_checks_and_actions"></a>Running background alert checks and actions<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/kibana/edit/master/docs/user/alerting/alerting-production-considerations.asciidoc">edit</a></h3>
<p>Kibana background tasks are managed by:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Polling an Elasticsearch task index for overdue tasks at 3 second intervals.  This interval can be changed using the <code class="literal">xpack.task_manager.poll_interval</code> setting.
</li>
<li class="listitem">
Tasks are then claiming them by updating them in the Elasticsearch index, using optimistic concurrency control to prevent conflicts. Each Kibana instance can run a maximum of 10 concurrent tasks, so a maximum of 10 tasks are claimed each interval.
</li>
<li class="listitem">
Tasks are run on the Kibana server.
</li>
<li class="listitem">
In the case of alerts which are recurring background checks, upon completion the task is scheduled again according to the <a class="xref" href="defining-alerts.html#defining-alerts-general-details" title="General alert details">check interval</a>.
</li>
</ul>
</div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Because by default tasks are polled at 3 second intervals and only 10 tasks can run concurrently per Kibana instance, it is possible for alert and action tasks to be run late. This can happen if:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Alerts use a small <span class="strong strong"><strong>check interval</strong></span>. The lowest interval possible is 3 seconds, though intervals of 30 seconds or higher are recommended.
</li>
<li class="listitem">
Many alerts or actions must be <span class="strong strong"><strong>run at once</strong></span>. In this case pending tasks will queue in Elasticsearch, and be pulled 10 at a time from the queue at 3 second intervals.
</li>
<li class="listitem">
<span class="strong strong"><strong>Long running tasks</strong></span> occupy slots for an extended time, leaving fewer slots for other tasks.
</li>
</ul>
</div>
<p>For details on the settings that can influence the performance and throughput of Task Manager, see {task-manager-settings}.</p>
</div>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="geo-alerting.html">« Geo alerting</a>
</span>
<span class="next">
<a href="api.html">REST API »</a>
</span>
</div>
</div>
</body>
</html>
