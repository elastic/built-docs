<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>protobuf | Logstash Reference [5.1] | Elastic</title>
<meta class="elastic" name="content" content="protobuf | Logstash Reference [5.1]">

<link rel="home" href="index.html" title="Logstash Reference [5.1]"/>
<link rel="up" href="codec-plugins.html" title="Codec plugins"/>
<link rel="prev" href="plugins-codecs-plain.html" title="plain"/>
<link rel="next" href="plugins-codecs-rubydebug.html" title="rubydebug"/>
<meta class="elastic" name="product_version" content="5.1"/>
<meta class="elastic" name="product_name" content="Logstash"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Logstash/Reference/5.1"/>
<meta name="DC.subject" content="Logstash"/>
<meta name="DC.identifier" content="5.1"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div class="navheader">
<span class="prev">
<a href="plugins-codecs-plain.html">« plain</a>
</span>
<span class="next">
<a href="plugins-codecs-rubydebug.html">rubydebug »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Logstash Reference [5.1]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="codec-plugins.html">Codec plugins</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>protobuf</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/logstash-plugins/logstash-codec-protobuf/edit/master/docs/index.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="plugins-codecs-protobuf"></a>protobuf<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/logstash-plugins/logstash-codec-protobuf/edit/master/docs/index.asciidoc">edit</a></h2>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Version: 1.0.0
</li>
<li class="listitem">
Released on: 2016-12-04
</li>
<li class="listitem">
<a href="https://github.com/logstash-plugins/logstash-codec-protobuf/blob/master/CHANGELOG.md#100" class="ulink" target="_top">Changelog</a>
</li>
<li class="listitem">
Compatible: 5.1.1.1, 5.0.0, 2.4.1, 2.4.0, 2.3.4
</li>
</ul>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This plugin does not ship with Logstash by default, but it is easy to install by running <code class="literal">bin/logstash-plugin install logstash-codec-protobuf</code>.</p>
</div>
</div>
<p>This codec converts protobuf encoded messages into logstash events and vice versa.</p>
<p>Requires the protobuf definitions as ruby files. You can create those using the [ruby-protoc compiler](<a href="https://github.com/codekitchen/ruby-protocol-buffers" class="ulink" target="_top">https://github.com/codekitchen/ruby-protocol-buffers</a>).</p>
<p>The following shows a usage example for decoding events from a kafka stream:</p>
<div class="pre_wrapper lang-ruby">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ruby">kafka
{
 zk_connect =&gt; "127.0.0.1"
 topic_id =&gt; "your_topic_goes_here"
 codec =&gt; protobuf
 {
   class_name =&gt; "Animal::Unicorn"
   include_path =&gt; ['/path/to/protobuf/definitions/UnicornProtobuf.pb.rb']
 }
}</pre>
</div>
<p>&nbsp;</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_synopsis_176"></a>Synopsis<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/logstash-plugins/logstash-codec-protobuf/edit/master/docs/index.asciidoc">edit</a></h3>
</div></div></div>
<p>This plugin supports the following configuration options:</p>
<p>Required configuration options:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">protobuf {
      class_name =&gt; ...
      include_path =&gt; ...
  }</pre>
</div>
<p>Available configuration options:</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Setting</th>
<th align="left" valign="top">Input type</th>
<th align="left" valign="top">Required</th>
<th align="left" valign="top">Default value</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><a class="xref" href="plugins-codecs-protobuf.html#plugins-codecs-protobuf-class_name" title="class_name"><code class="literal">class_name</code></a></p></td>
<td align="left" valign="top"><p><a class="xref" href="configuration-file-structure.html#string" title="String">string</a></p></td>
<td align="left" valign="top"><p>Yes</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="plugins-codecs-protobuf.html#plugins-codecs-protobuf-enable_metric" title="enable_metric"><code class="literal">enable_metric</code></a></p></td>
<td align="left" valign="top"><p><a class="xref" href="configuration-file-structure.html#boolean" title="Boolean">boolean</a></p></td>
<td align="left" valign="top"><p>No</p></td>
<td align="left" valign="top"><p><code class="literal"><code class="literal">true</code></code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="plugins-codecs-protobuf.html#plugins-codecs-protobuf-id" title="id"><code class="literal">id</code></a></p></td>
<td align="left" valign="top"><p><a class="xref" href="configuration-file-structure.html#string" title="String">string</a></p></td>
<td align="left" valign="top"><p>No</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="plugins-codecs-protobuf.html#plugins-codecs-protobuf-include_path" title="include_path"><code class="literal">include_path</code></a></p></td>
<td align="left" valign="top"><p><a class="xref" href="configuration-file-structure.html#array" title="Array">array</a></p></td>
<td align="left" valign="top"><p>Yes</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_details_176"></a>Details<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/logstash-plugins/logstash-codec-protobuf/edit/master/docs/index.asciidoc">edit</a></h3>
</div></div></div>
<p>&nbsp;</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="plugins-codecs-protobuf-class_name"></a><code class="literal">class_name</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/logstash-plugins/logstash-codec-protobuf/edit/master/docs/index.asciidoc">edit</a></h4>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
This is a required setting.
</li>
<li class="listitem">
Value type is <a class="xref" href="configuration-file-structure.html#string" title="String">string</a>
</li>
<li class="listitem">
There is no default value for this setting.
</li>
</ul>
</div>
<p>Name of the class to decode.
If your protobuf definition contains modules, prepend them to the class name with double colons like so:</p>
<div class="pre_wrapper lang-ruby">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ruby">class_name =&gt; "Foods::Dairy::Cheese"</pre>
</div>
<p>This corresponds to a protobuf definition starting as follows:</p>
<div class="pre_wrapper lang-ruby">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ruby">module Foods
   module Dairy
       class Cheese
           # here are your field definitions.</pre>
</div>
<p>If your class references other definitions: you only have to add the main class here.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="plugins-codecs-protobuf-enable_metric"></a><code class="literal">enable_metric</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/logstash-plugins/logstash-codec-protobuf/edit/master/docs/index.asciidoc">edit</a></h4>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Value type is <a class="xref" href="configuration-file-structure.html#boolean" title="Boolean">boolean</a>
</li>
<li class="listitem">
Default value is <code class="literal">true</code>
</li>
</ul>
</div>
<p>Disable or enable metric logging for this specific plugin instance
by default we record all the metrics we can, but you can disable metrics collection
for a specific plugin.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="plugins-codecs-protobuf-id"></a><code class="literal">id</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/logstash-plugins/logstash-codec-protobuf/edit/master/docs/index.asciidoc">edit</a></h4>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Value type is <a class="xref" href="configuration-file-structure.html#string" title="String">string</a>
</li>
<li class="listitem">
There is no default value for this setting.
</li>
</ul>
</div>
<p>Add a unique <code class="literal">ID</code> to the plugin instance, this <code class="literal">ID</code> is used for tracking
information for a specific configuration of the plugin.</p>
<pre class="screen">output {
 stdout {
   id =&gt; "ABC"
 }
}</pre>
<p>If you don&#8217;t explicitely set this variable Logstash will generate a unique name.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="plugins-codecs-protobuf-include_path"></a><code class="literal">include_path</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/logstash-plugins/logstash-codec-protobuf/edit/master/docs/index.asciidoc">edit</a></h4>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
This is a required setting.
</li>
<li class="listitem">
Value type is <a class="xref" href="configuration-file-structure.html#array" title="Array">array</a>
</li>
<li class="listitem">
There is no default value for this setting.
</li>
</ul>
</div>
<p>List of absolute pathes to files with protobuf definitions.
When using more than one file, make sure to arrange the files in reverse order of dependency so that each class is loaded before it is
refered to by another.</p>
<p>Example: a class <em>Cheese</em> referencing another protobuf class <em>Milk</em></p>
<div class="pre_wrapper lang-ruby">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ruby">module Foods
  module Dairy
        class Cheese
           set_fully_qualified_name "Foods.Dairy.Cheese"
           optional ::Foods::Cheese::Milk, :milk, 1
           optional :int64, :unique_id, 2
           # here be more field definitions</pre>
</div>
<p>would be configured as</p>
<div class="pre_wrapper lang-ruby">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ruby">include_path =&gt; ['/path/to/protobuf/definitions/Milk.pb.rb','/path/to/protobuf/definitions/Cheese.pb.rb']</pre>
</div>
<p>When using the codec in an output plugin:
* make sure to include all the desired fields in the protobuf definition, including timestamp.
  Remove fields that are not part of the protobuf definition from the event by using the mutate filter.
* the @ symbol is currently not supported in field names when loading the protobuf definitions for encoding. Make sure to call the timestamp field "timestamp"
  instead of "@timestamp" in the protobuf file. Logstash event fields will be stripped of the leading @ before conversion.</p>
</div>

</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="plugins-codecs-plain.html">« plain</a>
</span>
<span class="next">
<a href="plugins-codecs-rubydebug.html">rubydebug »</a>
</span>
</div>
</body>
</html>
