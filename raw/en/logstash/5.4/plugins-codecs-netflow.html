<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>netflow | Logstash Reference [5.4] | Elastic</title>
<link rel="home" href="index.html" title="Logstash Reference [5.4]"/>
<link rel="up" href="codec-plugins.html" title="Codec plugins"/>
<link rel="prev" href="plugins-codecs-multiline.html" title="multiline"/>
<link rel="next" href="plugins-codecs-nmap.html" title="nmap"/>
<meta name="DC.type" content="Learn/Docs/Logstash/Reference/5.4"/>
<meta name="DC.subject" content="Logstash"/>
<meta name="DC.identifier" content="5.4"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body><div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Logstash Reference [5.4]</a></span>
»
<span class="breadcrumb-link"><a href="codec-plugins.html">Codec plugins</a></span>
»
<span class="breadcrumb-node">netflow</span>
</div>
<div class="navheader">
<span class="prev">
<a href="plugins-codecs-multiline.html">« multiline</a>
</span>
<span class="next">
<a href="plugins-codecs-nmap.html">nmap »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="plugins-codecs-netflow"></a>netflow<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/logstash-plugins/logstash-codec-netflow/edit/master/docs/index.asciidoc">edit</a></h2>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Version: 3.3.0
</li>
<li class="listitem">
Released on: February 12, 2017
</li>
<li class="listitem">
<a href="https://github.com/logstash-plugins/logstash-codec-netflow/blob/master/CHANGELOG.md#330" class="ulink" target="_top">Changelog</a>
</li>
</ul>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_getting_help_95"></a>Getting Help<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/logstash-plugins/logstash-codec-netflow/edit/master/docs/index.asciidoc">edit</a></h3>
</div></div></div>
<p>For questions about the plugin, open a topic in the <a href="http://discuss.elastic.co" class="ulink" target="_top">Discuss</a> forums. For bugs or feature requests, open an issue in <a href="https://github.com/elastic/logstash" class="ulink" target="_top">Github</a>.
For the list of Elastic supported plugins, please consult the <a href="/support/matrix#show_logstash_plugins" class="ulink" target="_top">Elastic Support Matrix</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_description_95"></a>Description<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/logstash-plugins/logstash-codec-netflow/edit/master/docs/index.asciidoc">edit</a></h3>
</div></div></div>
<p>The "netflow" codec is used for decoding Netflow v5/v9/v10 (IPFIX) flows.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_supported_netflowipfix_exporters"></a>Supported Netflow/IPFIX exporters<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/logstash-plugins/logstash-codec-netflow/edit/master/docs/index.asciidoc">edit</a></h3>
</div></div></div>
<p>The following Netflow/IPFIX exporters are known to work with the most recent version of the netflow codec:</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
<col class="col_5"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Netflow exporter</th>
<th align="center" valign="top">v5</th>
<th align="center" valign="top">v9</th>
<th align="center" valign="top">IPFIX</th>
<th align="left" valign="top">Remarks</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>Softflowd</p></td>
<td align="center" valign="top"><p>y</p></td>
<td align="center" valign="top"><p>y</p></td>
<td align="center" valign="top"><p>y</p></td>
<td align="left" valign="top"><p>IPFIX supported in <a href="https://github.com/djmdjm/softflowd" class="ulink" target="_top">https://github.com/djmdjm/softflowd</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>nProbe</p></td>
<td align="center" valign="top"><p>y</p></td>
<td align="center" valign="top"><p>y</p></td>
<td align="center" valign="top"><p>y</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>ipt_NETFLOW</p></td>
<td align="center" valign="top"><p>y</p></td>
<td align="center" valign="top"><p>y</p></td>
<td align="center" valign="top"><p>y</p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Cisco ASA</p></td>
<td align="center" valign="top"><p></p></td>
<td align="center" valign="top"><p>y</p></td>
<td align="center" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Cisco IOS 12.x</p></td>
<td align="center" valign="top"><p></p></td>
<td align="center" valign="top"><p>y</p></td>
<td align="center" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>fprobe</p></td>
<td align="center" valign="top"><p>y</p></td>
<td align="center" valign="top"><p></p></td>
<td align="center" valign="top"><p></p></td>
<td align="left" valign="top"><p></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Juniper MX80</p></td>
<td align="center" valign="top"><p>y</p></td>
<td align="center" valign="top"><p></p></td>
<td align="center" valign="top"><p></p></td>
<td align="left" valign="top"><p>SW &gt; 12.3R8</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>OpenBSD pflow</p></td>
<td align="center" valign="top"><p>y</p></td>
<td align="center" valign="top"><p>n</p></td>
<td align="center" valign="top"><p>y</p></td>
<td align="left" valign="top"><p><a href="http://man.openbsd.org/OpenBSD-current/man4/pflow.4" class="ulink" target="_top">http://man.openbsd.org/OpenBSD-current/man4/pflow.4</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Mikrotik 6.35.4</p></td>
<td align="center" valign="top"><p>y</p></td>
<td align="center" valign="top"><p></p></td>
<td align="center" valign="top"><p>n</p></td>
<td align="left" valign="top"><p><a href="http://wiki.mikrotik.com/wiki/Manual:IP/Traffic_Flow" class="ulink" target="_top">http://wiki.mikrotik.com/wiki/Manual:IP/Traffic_Flow</a></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Ubiquiti Edgerouter X</p></td>
<td align="center" valign="top"><p></p></td>
<td align="center" valign="top"><p>y</p></td>
<td align="center" valign="top"><p></p></td>
<td align="left" valign="top"><p>With MPLS labels</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Citrix Netscaler</p></td>
<td align="center" valign="top"><p></p></td>
<td align="center" valign="top"><p></p></td>
<td align="center" valign="top"><p>y</p></td>
<td align="left" valign="top"><p>Still some unknown fields, labeled netscalerUnknown&lt;id&gt;</p></td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_usage_5"></a>Usage<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/logstash-plugins/logstash-codec-netflow/edit/master/docs/index.asciidoc">edit</a></h3>
</div></div></div>
<p>Example Logstash configuration:</p>
<div class="pre_wrapper lang-ruby">
<pre class="programlisting prettyprint lang-ruby">input {
  udp {
    host =&gt; localhost
    port =&gt; 2055
    codec =&gt; netflow {
      versions =&gt; [5, 9]
    }
    type =&gt; netflow
  }
  udp {
    host =&gt; localhost
    port =&gt; 4739
    codec =&gt; netflow {
      versions =&gt; [10]
      target =&gt; ipfix
   }
   type =&gt; ipfix
  }
  tcp {
    host =&gt; localhost
    port =&gt; 4739
    codec =&gt; netflow {
      versions =&gt; [10]
      target =&gt; ipfix
    }
    type =&gt; ipfix
  }
}</pre>
</div>
<p>&nbsp;</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_synopsis_176"></a>Synopsis<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/logstash-plugins/logstash-codec-netflow/edit/master/docs/index.asciidoc">edit</a></h3>
</div></div></div>
<p>This plugin supports the following configuration options:</p>
<p>Required configuration options:</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">netflow {
  }</pre>
</div>
<p>Available configuration options:</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Setting</th>
<th align="left" valign="top">Input type</th>
<th align="left" valign="top">Required</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><a class="xref" href="plugins-codecs-netflow.html#plugins-codecs-netflow-cache_save_path" title="cache_save_path"><code class="literal">cache_save_path</code></a></p></td>
<td align="left" valign="top"><p>a valid filesystem path</p></td>
<td align="left" valign="top"><p>No</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="plugins-codecs-netflow.html#plugins-codecs-netflow-cache_ttl" title="cache_ttl"><code class="literal">cache_ttl</code></a></p></td>
<td align="left" valign="top"><p><a class="xref" href="configuration-file-structure.html#number" title="Number">number</a></p></td>
<td align="left" valign="top"><p>No</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="plugins-codecs-netflow.html#plugins-codecs-netflow-enable_metric" title="enable_metric"><code class="literal">enable_metric</code></a></p></td>
<td align="left" valign="top"><p><a class="xref" href="configuration-file-structure.html#boolean" title="Boolean">boolean</a></p></td>
<td align="left" valign="top"><p>No</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="plugins-codecs-netflow.html#plugins-codecs-netflow-id" title="id"><code class="literal">id</code></a></p></td>
<td align="left" valign="top"><p><a class="xref" href="configuration-file-structure.html#string" title="String">string</a></p></td>
<td align="left" valign="top"><p>No</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="plugins-codecs-netflow.html#plugins-codecs-netflow-include_flowset_id" title="include_flowset_id"><code class="literal">include_flowset_id</code></a></p></td>
<td align="left" valign="top"><p><a class="xref" href="configuration-file-structure.html#boolean" title="Boolean">boolean</a></p></td>
<td align="left" valign="top"><p>No</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="plugins-codecs-netflow.html#plugins-codecs-netflow-ipfix_definitions" title="ipfix_definitions"><code class="literal">ipfix_definitions</code></a></p></td>
<td align="left" valign="top"><p>a valid filesystem path</p></td>
<td align="left" valign="top"><p>No</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="plugins-codecs-netflow.html#plugins-codecs-netflow-netflow_definitions" title="netflow_definitions"><code class="literal">netflow_definitions</code></a></p></td>
<td align="left" valign="top"><p>a valid filesystem path</p></td>
<td align="left" valign="top"><p>No</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="plugins-codecs-netflow.html#plugins-codecs-netflow-target" title="target"><code class="literal">target</code></a></p></td>
<td align="left" valign="top"><p><a class="xref" href="configuration-file-structure.html#string" title="String">string</a></p></td>
<td align="left" valign="top"><p>No</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="plugins-codecs-netflow.html#plugins-codecs-netflow-versions" title="versions"><code class="literal">versions</code></a></p></td>
<td align="left" valign="top"><p><a class="xref" href="configuration-file-structure.html#array" title="Array">array</a></p></td>
<td align="left" valign="top"><p>No</p></td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_details_177"></a>Details<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/logstash-plugins/logstash-codec-netflow/edit/master/docs/index.asciidoc">edit</a></h3>
</div></div></div>
<p>&nbsp;</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="plugins-codecs-netflow-cache_save_path"></a><code class="literal">cache_save_path</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/logstash-plugins/logstash-codec-netflow/edit/master/docs/index.asciidoc">edit</a></h4>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Value type is <a class="xref" href="configuration-file-structure.html#path" title="Path">path</a>
</li>
<li class="listitem">
There is no default value for this setting.
</li>
</ul>
</div>
<p>Where to save the template cache
This helps speed up processing when restarting logstash
(So you don&#8217;t have to await the arrival of templates)
cache will save as path/netflow_templates.cache and/or path/ipfix_templates.cache</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="plugins-codecs-netflow-cache_ttl"></a><code class="literal">cache_ttl</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/logstash-plugins/logstash-codec-netflow/edit/master/docs/index.asciidoc">edit</a></h4>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Value type is <a class="xref" href="configuration-file-structure.html#number" title="Number">number</a>
</li>
<li class="listitem">
Default value is <code class="literal">4000</code>
</li>
</ul>
</div>
<p>Netflow v9/v10 template cache TTL (minutes)</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="plugins-codecs-netflow-enable_metric"></a><code class="literal">enable_metric</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/logstash-plugins/logstash-codec-netflow/edit/master/docs/index.asciidoc">edit</a></h4>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Value type is <a class="xref" href="configuration-file-structure.html#boolean" title="Boolean">boolean</a>
</li>
<li class="listitem">
Default value is <code class="literal">true</code>
</li>
</ul>
</div>
<p>Disable or enable metric logging for this specific plugin instance
by default we record all the metrics we can, but you can disable metrics collection
for a specific plugin.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="plugins-codecs-netflow-id"></a><code class="literal">id</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/logstash-plugins/logstash-codec-netflow/edit/master/docs/index.asciidoc">edit</a></h4>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Value type is <a class="xref" href="configuration-file-structure.html#string" title="String">string</a>
</li>
<li class="listitem">
There is no default value for this setting.
</li>
</ul>
</div>
<p>Add a unique <code class="literal">ID</code> to the plugin configuration. If no ID is specified, Logstash will generate one.
It is strongly recommended to set this ID in your configuration. This is particularly useful
when you have two or more plugins of the same type, for example, if you have 2 grok filters.
Adding a named ID in this case will help in monitoring Logstash when using the monitoring APIs.</p>
<div class="pre_wrapper lang-ruby">
<pre class="programlisting prettyprint lang-ruby">output {
 stdout {
   id =&gt; "my_plugin_id"
 }
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="plugins-codecs-netflow-include_flowset_id"></a><code class="literal">include_flowset_id</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/logstash-plugins/logstash-codec-netflow/edit/master/docs/index.asciidoc">edit</a></h4>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Value type is <a class="xref" href="configuration-file-structure.html#boolean" title="Boolean">boolean</a>
</li>
<li class="listitem">
Default value is <code class="literal">false</code>
</li>
</ul>
</div>
<p>Only makes sense for ipfix, v9 already includes this
Setting to true will include the flowset_id in events
Allows you to work with sequences, for instance with the aggregate filter</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="plugins-codecs-netflow-ipfix_definitions"></a><code class="literal">ipfix_definitions</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/logstash-plugins/logstash-codec-netflow/edit/master/docs/index.asciidoc">edit</a></h4>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Value type is <a class="xref" href="configuration-file-structure.html#path" title="Path">path</a>
</li>
<li class="listitem">
There is no default value for this setting.
</li>
</ul>
</div>
<p>Override YAML file containing IPFIX field definitions</p>
<p>Very similar to the Netflow version except there is a top level Private
Enterprise Number (PEN) key added:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">pen:
id:
- :uintN or :ip4_addr or :ip6_addr or :mac_addr or :string
- :name
id:
- :skip</pre>
</div>
<p>There is an implicit PEN 0 for the standard fields.</p>
<p>See <a href="https://github.com/logstash-plugins/logstash-codec-netflow/blob/master/lib/logstash/codecs/netflow/ipfix.yaml" class="ulink" target="_top">https://github.com/logstash-plugins/logstash-codec-netflow/blob/master/lib/logstash/codecs/netflow/ipfix.yaml</a> for the base set.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="plugins-codecs-netflow-netflow_definitions"></a><code class="literal">netflow_definitions</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/logstash-plugins/logstash-codec-netflow/edit/master/docs/index.asciidoc">edit</a></h4>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Value type is <a class="xref" href="configuration-file-structure.html#path" title="Path">path</a>
</li>
<li class="listitem">
There is no default value for this setting.
</li>
</ul>
</div>
<p>Override YAML file containing Netflow field definitions</p>
<p>Each Netflow field is defined like so:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">id:
- default length in bytes
- :name
id:
- :uintN or :ip4_addr or :ip6_addr or :mac_addr or :string
- :name
id:
- :skip</pre>
</div>
<p>See <a href="https://github.com/logstash-plugins/logstash-codec-netflow/blob/master/lib/logstash/codecs/netflow/netflow.yaml" class="ulink" target="_top">https://github.com/logstash-plugins/logstash-codec-netflow/blob/master/lib/logstash/codecs/netflow/netflow.yaml</a> for the base set.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="plugins-codecs-netflow-target"></a><code class="literal">target</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/logstash-plugins/logstash-codec-netflow/edit/master/docs/index.asciidoc">edit</a></h4>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Value type is <a class="xref" href="configuration-file-structure.html#string" title="String">string</a>
</li>
<li class="listitem">
Default value is <code class="literal">"netflow"</code>
</li>
</ul>
</div>
<p>Specify into what field you want the Netflow data.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="plugins-codecs-netflow-versions"></a><code class="literal">versions</code><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/logstash-plugins/logstash-codec-netflow/edit/master/docs/index.asciidoc">edit</a></h4>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Value type is <a class="xref" href="configuration-file-structure.html#array" title="Array">array</a>
</li>
<li class="listitem">
Default value is <code class="literal">[5, 9, 10]</code>
</li>
</ul>
</div>
<p>Specify which Netflow versions you will accept.</p>
</div>

</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="plugins-codecs-multiline.html">« multiline</a>
</span>
<span class="next">
<a href="plugins-codecs-nmap.html">nmap »</a>
</span>
</div>
</div>
</body>
</html>
