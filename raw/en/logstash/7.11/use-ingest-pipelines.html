<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Use ingest pipelines for parsing | Logstash Reference [7.11] | Elastic</title>
<link rel="home" href="index.html" title="Logstash Reference [7.11]"/>
<link rel="up" href="filebeat-modules.html" title="Working with Filebeat Modules"/>
<link rel="prev" href="filebeat-modules.html" title="Working with Filebeat Modules"/>
<link rel="next" href="logstash-config-for-filebeat-modules.html" title="Use Logstash pipelines for parsing"/>
<meta name="DC.type" content="Learn/Docs/Logstash/Reference/7.11"/>
<meta name="DC.subject" content="Logstash"/>
<meta name="DC.identifier" content="7.11"/>
</head>
<body><div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Logstash Reference [7.11]</a></span>
»
<span class="breadcrumb-link"><a href="filebeat-modules.html">Working with Filebeat Modules</a></span>
»
<span class="breadcrumb-node">Use ingest pipelines for parsing</span>
</div>
<div class="navheader">
<span class="prev">
<a href="filebeat-modules.html">« Working with Filebeat Modules</a>
</span>
<span class="next">
<a href="logstash-config-for-filebeat-modules.html">Use Logstash pipelines for parsing »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="use-ingest-pipelines"></a>Use ingest pipelines for parsing<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/logstash/edit/7.11/docs/static/filebeat-modules.asciidoc">edit</a></h2>
</div></div></div>
<p>When you use Filebeat modules with Logstash, you can use the ingest pipelines
provided by Filebeat to parse the data. You need to load the pipelines
into Elasticsearch and configure Logstash to use them.</p>
<p><span class="strong strong"><strong>To load the ingest pipelines:</strong></span></p>
<p>On the system where Filebeat is installed, run the <code class="literal">setup</code> command with the
<code class="literal">--pipelines</code> option specified to load ingest pipelines for specific modules.
For example, the following command loads ingest pipelines for the system and
nginx modules:</p>
<div class="pre_wrapper lang-shell">
<pre class="programlisting prettyprint lang-shell">filebeat setup --pipelines --modules nginx,system</pre>
</div>
<p>A connection to Elasticsearch is required for this setup step because Filebeat needs to
load the ingest pipelines into Elasticsearch. If necessary, you can temporarily disable
your configured output and enable the Elasticsearch output before running the command.</p>
<p><span class="strong strong"><strong>To configure Logstash to use the pipelines:</strong></span></p>
<p>On the system where Logstash is installed, create a Logstash pipeline configuration
that reads from a Logstash input, such as Beats or Kafka, and sends events to an
Elasticsearch output. Set the <code class="literal">pipeline</code> option in the Elasticsearch output to
<code class="literal">%{[@metadata][pipeline]}</code> to use the ingest pipelines that you loaded
previously.</p>
<p>Here&#8217;s an example configuration that reads data from the Beats input and uses
Filebeat ingest pipelines to parse data collected by modules:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">input {
  beats {
    port =&gt; 5044
  }
}

output {
  if [@metadata][pipeline] {
    elasticsearch {
      hosts =&gt; "https://061ab24010a2482e9d64729fdb0fd93a.us-east-1.aws.found.io:9243"
      manage_template =&gt; false
      index =&gt; "%{[@metadata][beat]}-%{[@metadata][version]}-%{+YYYY.MM.dd}"
      pipeline =&gt; "%{[@metadata][pipeline]}" <a id="CO21-1"></a><i class="conum" data-value="1"></i>
      user =&gt; "elastic"
      password =&gt; "secret"
    }
  } else {
    elasticsearch {
      hosts =&gt; "https://061ab24010a2482e9d64729fdb0fd93a.us-east-1.aws.found.io:9243"
      manage_template =&gt; false
      index =&gt; "%{[@metadata][beat]}-%{[@metadata][version]}-%{+YYYY.MM.dd}"
      user =&gt; "elastic"
      password =&gt; "secret"
    }
  }
}</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO21-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Set the <code class="literal">pipeline</code> option to <code class="literal">%{[@metadata][pipeline]}</code>. This setting
configures Logstash to select the correct ingest pipeline based on metadata
passed in the event.</p>
</td>
</tr>
</table>
</div>
<p>See the Filebeat <a href="/guide/en/beats/filebeat/7.11/filebeat-modules-overview.html" class="ulink" target="_top">Modules</a>
documentation for more information about setting up and running modules.</p>
<p>For a full example, see <a class="xref" href="use-filebeat-modules-kafka.html" title="Example: Set up Filebeat modules to work with Kafka and Logstash">Example: Set up Filebeat modules to work with Kafka and Logstash</a>.</p>
</div>
<div class="navfooter">
<span class="prev">
<a href="filebeat-modules.html">« Working with Filebeat Modules</a>
</span>
<span class="next">
<a href="logstash-config-for-filebeat-modules.html">Use Logstash pipelines for parsing »</a>
</span>
</div>
</div>
</body>
</html>
