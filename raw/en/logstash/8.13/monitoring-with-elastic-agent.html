<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Collect Logstash monitoring data for stack monitoring | Logstash Reference [8.13] | Elastic</title>
<meta class="elastic" name="content" content="Collect Logstash monitoring data for stack monitoring | Logstash Reference [8.13]">

<link rel="home" href="index.html" title="Logstash Reference [8.13]"/>
<link rel="up" href="monitoring-with-ea.html" title="Monitoring Logstash with Elastic Agent"/>
<link rel="prev" href="serverless-monitoring-with-elastic-agent.html" title="Collect Logstash monitoring data for dashboards (serverless)"/>
<link rel="next" href="configuring-logstash.html" title="Monitoring Logstash (legacy)"/>
<meta class="elastic" name="product_version" content="8.13"/>
<meta class="elastic" name="product_name" content="Logstash"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Logstash/Reference/8.13"/>
<meta name="DC.subject" content="Logstash"/>
<meta name="DC.identifier" content="8.13"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body><div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Logstash Reference [8.13]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="monitoring-with-ea.html">Monitoring Logstash with Elastic Agent</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="serverless-monitoring-with-elastic-agent.html">« Collect Logstash monitoring data for dashboards (serverless)</a>
</span>
<span class="next">
<a href="configuring-logstash.html">Monitoring Logstash (legacy) »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="monitoring-with-elastic-agent"></a>Collect Logstash monitoring data for stack monitoring<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/logstash/edit/8.13/docs/static/monitoring/monitoring-ea.asciidoc">edit</a></h2>
</div></div></div>

<p>Elastic Agent collects monitoring data from your Logstash instance and sends it directly to your monitoring cluster.
With Elastic Agent collection the monitoring agent remains active even if the Logstash instance does not.</p>
<p>You can enroll Elastic Agent in <a href="/guide/en/fleet/8.13/install-fleet-managed-elastic-agent.html" class="ulink" target="_top">Fleet</a> for management
from a central location, or you can run <a href="/guide/en/fleet/8.13/install-standalone-elastic-agent.html" class="ulink" target="_top">Elastic Agent standalone</a>.</p>
<p><span class="strong strong"><strong>Prerequisites</strong></span></p>
<p>Complete these steps as you prepare to collect and ship monitoring data for stack monitoring:</p>
<details id="disable-default-include-ea">
<summary class="title">Disable default collection of Logstash monitoring metrics</summary>
<div class="content">
<p>The <code class="literal">monitoring</code> setting is in the Logstash configuration file (logstash.yml), but is
commented out:</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">monitoring.enabled: false</pre>
</div>
<p>Remove the <code class="literal">#</code> at the beginning of the line to enable the setting.</p>
</div>
</details>
<details id="define-cluster__uuid-ea">
<summary class="title">Specify the target cluster_uuid (optional)</summary>
<div class="content">
<p>To bind the metrics of Logstash to a specific cluster, optionally define the <code class="literal">monitoring.cluster_uuid</code>
in the configuration file (logstash.yml):</p>
<div class="pre_wrapper lang-yaml">
<pre class="programlisting prettyprint lang-yaml">monitoring.cluster_uuid: PRODUCTION_ES_CLUSTER_UUID</pre>
</div>
</div>
</details>
<details id="set-up-monitoring-ea">
<summary class="title">Set up Elasticsearch monitoring</summary>
<div class="content">
<p>Set up <a href="/guide/en/elasticsearch/reference/8.13/monitoring-overview.html" class="ulink" target="_top">Elasticsearch monitoring</a>.
If you would like to create a dedicated monitoring cluster (optional), check out <a href="/guide/en/elasticsearch/reference/8.13/monitoring-production.html" class="ulink" target="_top">Elasticsearch monitoring documentation</a>.</p>
</div>
</details>
<details id="create-user-ea">
<summary class="title">Create a monitoring user (standalone agent only)</summary>
<div class="content">
<p>Create a user on the production cluster that has the
<code class="literal">remote_monitoring_collector</code> <a href="/guide/en/elasticsearch/reference/8.13/built-in-roles.html" class="ulink" target="_top">built-in role</a>.</p>
</div>
</details>
<h3><a id="install-and-configure-mon"></a>Install and configure Elastic Agent<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/logstash/edit/8.13/docs/static/monitoring/monitoring-ea.asciidoc">edit</a></h3>
<p>When you have completed the prerequisites, install and configure Elastic Agent to monitor host logs and metrics.
We&#8217;ll walk you through the process in these steps:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="monitoring-with-elastic-agent.html#add-logstash-integration-ea" title="Add the Elastic Agent Logstash integration">Add the Elastic Agent Logstash integration</a>
</li>
<li class="listitem">
<a class="xref" href="monitoring-with-elastic-agent.html#add-agent-to-fleet-ea" title="Install and run an Elastic Agent on your machine">Install and run an Elastic Agent on your machine</a>
</li>
<li class="listitem">
<a class="xref" href="monitoring-with-elastic-agent.html#view-assets" title="View assets">View assets</a>
</li>
<li class="listitem">
<a class="xref" href="monitoring-with-elastic-agent.html#view-data-stack" title="Monitor Logstash logs and metrics (Stack Monitoring)">Monitor Logstash logs and metrics (Stack Monitoring)</a>
</li>
</ul>
</div>
<p>Check out <a href="/guide/en/fleet/8.13/elastic-agent-installation.html" class="ulink" target="_top">Installing Elastic Agent</a> in the <em>Fleet and Elastic Agent Guide</em> for more info.</p>
<h4><a id="add-logstash-integration-ea"></a>Add the Elastic Agent Logstash integration<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/logstash/edit/8.13/docs/static/monitoring/monitoring-ea.asciidoc">edit</a></h4>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Go to the Kibana home page, and click <span class="strong strong"><strong>Add integrations</strong></span>.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/kibana-home.png" alt="Kibana home page">
</div>
</div>
</li>
<li class="listitem">
In the query bar, search for <span class="strong strong"><strong>Logstash</strong></span> and select the integration to see more
details about it.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Add Logstash</strong></span>.
</li>
<li class="listitem">
Configure the integration name and optionally add a description.
</li>
<li class="listitem">
<p>Configure the integration to collect logs.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Make sure that <span class="strong strong"><strong>Logs</strong></span> is turned on if you want to collect logs from your Logstash instance, ensuring that the required settings are correctly configured:
</li>
<li class="listitem">
Under <span class="strong strong"><strong>Logs</strong></span>, modify the log paths
to match your Logstash environment.
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Configure the integration to collect metrics</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Make sure that <span class="strong strong"><strong>Metrics (Stack Monitoring)</strong></span> is turned on, and <span class="strong strong"><strong>Metrics (Technical Preview)</strong></span> is turned off, if you
want to collect metrics from your Logstash instance
</li>
<li class="listitem">
Under <span class="strong strong"><strong>Metrics (Stack Monitoring)</strong></span>, make sure the hosts setting
points to your Logstash host URLs. By default, the integration collects Logstash
monitoring metrics from <code class="literal">localhost:9600</code>. If that host and port number are not
correct, update the <code class="literal">hosts</code> setting. If you configured Logstash to use encrypted
communications, you must access it via HTTPS. For example, use a <code class="literal">hosts</code> setting
like
<code class="literal">https://localhost:9600</code>.
</li>
</ul>
</div>
</li>
<li class="listitem">
Choose where to add the integration policy.<br>
Click <span class="strong strong"><strong>New hosts</strong></span> to add it to new agent policy or <span class="strong strong"><strong>Existing hosts</strong></span> to add it to an existing agent policy.
</li>
<li class="listitem">
<p>In the popup, click <span class="strong strong"><strong>Add Elastic Agent to your hosts</strong></span> to open the <span class="strong strong"><strong>Add agent</strong></span>
flyout.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>If you accidentally close the popup, go to <span class="strong strong"><strong>Fleet &gt; Agents</strong></span>, then click
<span class="strong strong"><strong>Add agent</strong></span> to access the flyout.</p>
</div>
</div>
</li>
</ol>
</div>
<h4><a id="add-agent-to-fleet-ea"></a>Install and run an Elastic Agent on your machine<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/logstash/edit/8.13/docs/static/monitoring/monitoring-ea.asciidoc">edit</a></h4>
<p>The <span class="strong strong"><strong>Add agent</strong></span> flyout has two options: <span class="strong strong"><strong>Enroll in Fleet</strong></span> and
<span class="strong strong"><strong>Run standalone</strong></span>.
Enrolling agents in Fleet (default) provides a centralized management tool in Kibana,
reducing management overhead.</p>
<div class="tabs" data-tab-group="ts">
  <div role="tablist" aria-label="tls">
    <button role="tab"
            aria-selected="true"
            aria-controls="fm-tab-ts"
            id="fm-ts">
      Fleet-managed
    </button>
    <button role="tab"
            aria-selected="false"
            aria-controls="standalone-tab-ts"
            id="standalone-ts"
            tabindex="-1">
      Run standalone
    </button>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="fm-tab-ts"
       aria-labelledby="fm-ts">
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>When the <span class="strong strong"><strong>Add Agent flyout</strong></span> appears, stay on the <span class="strong strong"><strong>Enroll in fleet</strong></span> tab</p>
<div class="imageblock screenshot">
<div class="content">
<img src="../monitoring/images/integration-agent-add.png" alt="Add agent flyout in Kibana">
</div>
</div>
</li>
<li class="listitem">
<p>Skip the <span class="strong strong"><strong>Select enrollment token</strong></span> step. The enrollment token you need is
already selected.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The enrollment token is specific to the Elastic Agent policy that you just
created. When you run the command to enroll the agent in Fleet, you will pass
in the enrollment token.</p>
</div>
</div>
</li>
<li class="listitem">
Download, install, and enroll the Elastic Agent on your host by selecting
your host operating system and following the <span class="strong strong"><strong>Install Elastic Agent on your host</strong></span>
step.
</li>
</ol>
</div>
<p>It takes about a minute for Elastic Agent to enroll in Fleet, download the
configuration specified in the policy you just created, and start collecting
data.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="../monitoring/images/integration-agent-confirm.png" alt="Agent confirm data">
</div>
</div>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="standalone-tab-ts"
       aria-labelledby="standalone-ts"
       hidden="">
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>When the <span class="strong strong"><strong>Add Agent flyout</strong></span> appears, navigate to the <span class="strong strong"><strong>Run standalone</strong></span> tab</p>
<div class="imageblock screenshot">
<div class="content">
<img src="../monitoring/images/integration-agent-add-standalone.png" alt="Add agent flyout in Kibana">
</div>
</div>
</li>
<li class="listitem">
Configure the agent. Follow all the instructions in <span class="strong strong"><strong>Install Elastic Agent on your host</strong></span>
</li>
<li class="listitem">
After unpacking the binary, replace the <code class="literal">elastic-agent.yml</code> file with that supplied in the Add Agent flyout on the "Run standalone" tab, replacing the values of <code class="literal">ES_USERNAME</code> and <code class="literal">ES_PASSWORD</code> appropriately.
</li>
<li class="listitem">
Run <code class="literal">sudo ./elastic-agent install</code>
</li>
</ol>
</div>
  </div>
</div>
<h3><a id="view-assets"></a>View assets<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/logstash/edit/8.13/docs/static/monitoring/monitoring-ea.asciidoc">edit</a></h3>
<p>After you have confirmed enrollment and data is coming in,  click <span class="strong strong"><strong>View assets</strong></span> to access dashboards related to the Logstash integration.</p>
<p>For traditional Stack Monitoring UI, the dashboards marked <span class="strong strong"><strong>[Logs Logstash]</strong></span> are used to visualize the logs
produced by your Logstash instances, with those marked <span class="strong strong"><strong>[Metrics Logstash]</strong></span> for the technical preview metrics
dashboards.
These are populated with data only if you selected the <span class="strong strong"><strong>Metrics (Technical Preview)</strong></span> checkbox.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/integration-assets-dashboards.png" alt="Integration assets">
</div>
</div>
<p>A number of dashboards are included to view Logstash as a whole, and dashboards that allow you to drill-down
into how Logstash is performing on a node, pipeline and plugin basis.</p>
<h4><a id="view-data-stack"></a>Monitor Logstash logs and metrics (Stack Monitoring)<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/logstash/edit/8.13/docs/static/monitoring/monitoring-ea.asciidoc">edit</a></h4>
<p><a href="/guide/en/kibana/8.13/monitoring-data.html" class="ulink" target="_top">View the monitoring data in Kibana</a>, and navigate to the <a class="xref" href="logstash-monitoring-ui.html" title="Monitoring UI">monitoring UI</a>.</p>
</div>
<div class="navfooter">
<span class="prev">
<a href="serverless-monitoring-with-elastic-agent.html">« Collect Logstash monitoring data for dashboards (serverless)</a>
</span>
<span class="next">
<a href="configuring-logstash.html">Monitoring Logstash (legacy) »</a>
</span>
</div>
</div>
</body>
</html>
