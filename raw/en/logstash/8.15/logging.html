<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Logging | Logstash Reference [8.15] | Elastic</title>
<meta class="elastic" name="content" content="Logging | Logstash Reference [8.15]">

<link rel="home" href="index.html" title="Logstash Reference [8.15]"/>
<link rel="up" href="setup-logstash.html" title="Setting Up and Running Logstash"/>
<link rel="prev" href="running-logstash-windows.html" title="Running Logstash on Windows"/>
<link rel="next" href="shutdown.html" title="Shutting Down Logstash"/>
<meta class="elastic" name="product_version" content="8.15"/>
<meta class="elastic" name="product_name" content="Logstash"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Logstash/Reference/8.15"/>
<meta name="DC.subject" content="Logstash"/>
<meta name="DC.identifier" content="8.15"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
This documentation contains work-in-progress information for future Elastic Stack and Cloud releases. Use the version selector to view supported release docs. It also contains some Elastic Cloud serverless information. Check out our <a href="https://www.elastic.co/docs/current/serverless">serverless docs</a> for more details.
</div>
<div class="navheader">
<span class="prev">
<a href="running-logstash-windows.html">« Running Logstash on Windows</a>
</span>
<span class="next">
<a href="shutdown.html">Shutting Down Logstash »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Logstash Reference [8.15]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="setup-logstash.html">Setting Up and Running Logstash</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Logging</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/logstash/edit/8.15/docs/static/logging.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="logging"></a>Logging<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/logstash/edit/8.15/docs/static/logging.asciidoc">edit</a></h2>
</div></div></div>
<p>Logstash emits internal logs during its operation, which are placed in <code class="literal">LS_HOME/logs</code> (or <code class="literal">/var/log/logstash</code> for
DEB/RPM). The default logging level is <code class="literal">INFO</code>. Logstash&#8217;s logging framework is based on
<a href="http://logging.apache.org/log4j/2.x/" class="ulink" target="_top">Log4j 2 framework</a>, and much of its functionality is exposed directly to users.</p>
<p>You can configure logging for a particular subsystem, module, or plugin.</p>
<p>When you need to debug problems, particularly problems with plugins, consider
increasing the logging level to <code class="literal">DEBUG</code> to get more verbose messages. For
example, if you are debugging issues with Elasticsearch Output, you can increase
log levels just for that component. This approach reduces noise from
excessive logging and helps you focus on the problem area.</p>
<p>You can configure logging using the <code class="literal">log4j2.properties</code> file or the Logstash API.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong><code class="literal">log4j2.properties</code> file.</strong></span>  Changes made through the <code class="literal">log4j2.properties</code>
file require you to restart Logstash for the changes to take effect.  Changes <span class="strong strong"><strong>persist</strong></span>
through subsequent restarts.
</li>
<li class="listitem">
<span class="strong strong"><strong>Logging API.</strong></span> Changes made through the Logging API are effective immediately
without a restart. The changes <span class="strong strong"><strong>do not persist</strong></span> after Logstash
is restarted.
</li>
</ul>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="log4j2"></a>Log4j2 configuration<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/logstash/edit/8.15/docs/static/logging.asciidoc">edit</a></h3>
</div></div></div>
<p>Logstash ships with a <code class="literal">log4j2.properties</code> file with out-of-the-box settings, including logging to console. You
can modify this file to change the rotation policy, type, and other
<a href="https://logging.apache.org/log4j/2.x/manual/configuration.html#Loggers" class="ulink" target="_top">log4j2
configuration</a>.</p>
<p>You must restart Logstash to apply any changes that you make to
this file.
Changes to <code class="literal">log4j2.properties</code> persist after Logstash is restarted.</p>
<p>Here&#8217;s an example using <code class="literal">outputs.elasticsearch</code>:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">logger.elasticsearchoutput.name = logstash.outputs.elasticsearch
logger.elasticsearchoutput.level = debug</pre>
</div>
<p>The previous example defines a name and level for the logger <code class="literal">logstash.outputs.elasticsearch</code>.
The logger is usually identified by a Java class name, such as
<code class="literal">org.logstash.dissect.Dissector</code>, for example.  It can also be a partial package
path as in <code class="literal">org.logstash.dissect</code>.  For Ruby classes, like <code class="literal">LogStash::Outputs::Elasticsearch</code>,
the logger name is obtained by lowercasing the full class name and replacing double colons with a single dot.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Consider using the default log4j configuration that is shipped with Logstash, as it is configured to work well for most deployments.
The next section describes how the rolling strategy works in case you need to make adjustments.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="rollover"></a>Rollover settings<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/logstash/edit/8.15/docs/static/logging.asciidoc">edit</a></h4>
</div></div></div>
<p>The <code class="literal">log4j2.properties</code> file has three appenders for writing to log files:
one for plain text, one with json format, and one to split log lines on per pipeline basis when you set the <code class="literal">pipeline.separate_logs</code> value.</p>
<p>These appenders define:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>triggering policies</strong></span> that determine <em>if</em> a rollover should be performed, and
</li>
<li class="listitem">
<span class="strong strong"><strong>rollover strategy</strong></span>  to defines <em>how</em> the rollover should be done.
</li>
</ul>
</div>
<p>By default, two triggering policies are defined&#8212;&#8203;time and size.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
The <span class="strong strong"><strong>time</strong></span> policy creates one file per day.
</li>
<li class="listitem">
The <span class="strong strong"><strong>size</strong></span> policy forces the creation of a new file after the file size surpasses 100 MB.
</li>
</ul>
</div>
<p>The default strategy also performs file rollovers based on a <span class="strong strong"><strong>maximum number of files</strong></span>.
When the limit of 30 files has been reached, the first (oldest) file is removed to create space for the new file.
Subsequent files are renumbered accordingly.</p>
<p>Each file has a date, and files older than 7 days (default) are removed during rollover.</p>
<div class="pre_wrapper lang-text">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-text">appender.rolling.type = RollingFile <a id="CO3-1"></a><i class="conum" data-value="1"></i>
appender.rolling.name = plain_rolling
appender.rolling.fileName = ${sys:ls.logs}/logstash-plain.log <a id="CO3-2"></a><i class="conum" data-value="2"></i>
appender.rolling.filePattern = ${sys:ls.logs}/logstash-plain-%d{yyyy-MM-dd}-%i.log.gz <a id="CO3-3"></a><i class="conum" data-value="3"></i>
appender.rolling.policies.type = Policies
appender.rolling.policies.time.type = TimeBasedTriggeringPolicy <a id="CO3-4"></a><i class="conum" data-value="4"></i>
appender.rolling.policies.time.interval = 1
appender.rolling.policies.time.modulate = true
appender.rolling.layout.type = PatternLayout
appender.rolling.layout.pattern = [%d{ISO8601}][%-5p][%-25c]%notEmpty{[%X{pipeline.id}]}%notEmpty{[%X{plugin.id}]} %m%n
appender.rolling.policies.size.type = SizeBasedTriggeringPolicy <a id="CO3-5"></a><i class="conum" data-value="5"></i>
appender.rolling.policies.size.size = 100MB
appender.rolling.strategy.type = DefaultRolloverStrategy
appender.rolling.strategy.max = 30 <a id="CO3-6"></a><i class="conum" data-value="6"></i>
appender.rolling.strategy.action.type = Delete <a id="CO3-7"></a><i class="conum" data-value="7"></i>
appender.rolling.strategy.action.basepath = ${sys:ls.logs}
appender.rolling.strategy.action.condition.type = IfFileName
appender.rolling.strategy.action.condition.glob = logstash-plain-* <a id="CO3-8"></a><i class="conum" data-value="8"></i>
appender.rolling.strategy.action.condition.nested_condition.type = IfLastModified
appender.rolling.strategy.action.condition.nested_condition.age = 7D <a id="CO3-9"></a><i class="conum" data-value="9"></i></pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO3-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>The appender type, which rolls older log files.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO3-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>Name of the current log file.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO3-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>Name&#8217;s format definition of the rolled files, in this case a date followed by an incremental number, up to 30 (by default).</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO3-4"><i class="conum" data-value="4"></i></a></p>
</td>
<td align="left" valign="top">
<p>Time policy to trigger a rollover at the end of the day.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO3-5"><i class="conum" data-value="5"></i></a></p>
</td>
<td align="left" valign="top">
<p>Size policy to trigger a rollover once the plain text file reaches the size of 100 MB.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO3-6"><i class="conum" data-value="6"></i></a></p>
</td>
<td align="left" valign="top">
<p>Rollover strategy defines a maximum of 30 files.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO3-7"><i class="conum" data-value="7"></i></a></p>
</td>
<td align="left" valign="top">
<p>Action to execute during the rollover.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO3-8"><i class="conum" data-value="8"></i></a></p>
</td>
<td align="left" valign="top">
<p>The file set to consider by the action.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO3-9"><i class="conum" data-value="9"></i></a></p>
</td>
<td align="left" valign="top">
<p>Condition to execute the rollover action: older than 7 days.</p>
</td>
</tr>
</table>
</div>
<p>The rollover action can also enforce a disk usage limit, deleting older files to match
the requested condition, as an example:</p>
<div class="pre_wrapper lang-text">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-text">appender.rolling.type = RollingFile
...
appender.rolling.strategy.action.condition.glob = pipeline_${ctx:pipeline.id}.*.log.gz
appender.rolling.strategy.action.condition.nested_condition.type = IfAccumulatedFileSize
appender.rolling.strategy.action.condition.nested_condition.exceeds = 5MB <a id="CO4-1"></a><i class="conum" data-value="1"></i></pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO4-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Deletes files if total accumulated compressed file size is over 5MB.</p>
</td>
</tr>
</table>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_logging_apis"></a>Logging APIs<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/logstash/edit/8.15/docs/static/logging.asciidoc">edit</a></h3>
</div></div></div>
<p>For temporary logging changes, modifying the <code class="literal">log4j2.properties</code> file and restarting Logstash leads to unnecessary
downtime. Instead, you can dynamically update logging levels through the logging API. These settings are effective
immediately and do not need a restart.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>By default, the logging API attempts to bind to <code class="literal">tcp:9600</code>. If this port is already in use by another Logstash
instance, you need to launch Logstash with the <code class="literal">--api.http.port</code> flag specified to bind to a different port. See
<a class="xref" href="running-logstash-command-line.html#command-line-flags" title="Command-Line Flags">Command-Line Flags</a> for more information.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_retrieve_list_of_logging_configurations"></a>Retrieve list of logging configurations<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/logstash/edit/8.15/docs/static/logging.asciidoc">edit</a></h4>
</div></div></div>
<p>To retrieve a list of logging subsystems available at runtime, you can do a <code class="literal">GET</code> request to <code class="literal">_node/logging</code></p>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">curl -XGET 'localhost:9600/_node/logging?pretty'</pre>
</div>
<p>Example response:</p>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">{
...
  "loggers" : {
    "logstash.agent" : "INFO",
    "logstash.api.service" : "INFO",
    "logstash.basepipeline" : "INFO",
    "logstash.codecs.plain" : "INFO",
    "logstash.codecs.rubydebug" : "INFO",
    "logstash.filters.grok" : "INFO",
    "logstash.inputs.beats" : "INFO",
    "logstash.instrument.periodicpoller.jvm" : "INFO",
    "logstash.instrument.periodicpoller.os" : "INFO",
    "logstash.instrument.periodicpoller.persistentqueue" : "INFO",
    "logstash.outputs.stdout" : "INFO",
    "logstash.pipeline" : "INFO",
    "logstash.plugins.registry" : "INFO",
    "logstash.runner" : "INFO",
    "logstash.shutdownwatcher" : "INFO",
    "org.logstash.Event" : "INFO",
    "slowlog.logstash.codecs.plain" : "TRACE",
    "slowlog.logstash.codecs.rubydebug" : "TRACE",
    "slowlog.logstash.filters.grok" : "TRACE",
    "slowlog.logstash.inputs.beats" : "TRACE",
    "slowlog.logstash.outputs.stdout" : "TRACE"
  }
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_update_logging_levels"></a>Update logging levels<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/logstash/edit/8.15/docs/static/logging.asciidoc">edit</a></h4>
</div></div></div>
<p>Prepend the name of the subsystem, module, or plugin with <code class="literal">logger.</code>.</p>
<p>Here is an example using <code class="literal">outputs.elasticsearch</code>:</p>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">curl -XPUT 'localhost:9600/_node/logging?pretty' -H 'Content-Type: application/json' -d'
{
    "logger.logstash.outputs.elasticsearch" : "DEBUG"
}
'</pre>
</div>
<p>While this setting is in effect, Logstash emits DEBUG-level logs for <em>all</em> the Elasticsearch outputs
specified in your configuration. Please note this new setting is transient and will not survive a restart.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>If you want logging changes to persist after a restart, add them to <code class="literal">log4j2.properties</code> instead.</p>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_reset_dynamic_logging_levels"></a>Reset dynamic logging levels<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/logstash/edit/8.15/docs/static/logging.asciidoc">edit</a></h4>
</div></div></div>
<p>To reset any logging levels that may have been dynamically changed via the logging API, send a <code class="literal">PUT</code> request to
<code class="literal">_node/logging/reset</code>. All logging levels will revert to the values specified in the <code class="literal">log4j2.properties</code> file.</p>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">curl -XPUT 'localhost:9600/_node/logging/reset?pretty'</pre>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_log_file_location"></a>Log file location<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/logstash/edit/8.15/docs/static/logging.asciidoc">edit</a></h3>
</div></div></div>
<p>You can specify the log file location using <code class="literal">--path.logs</code> setting.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_slowlog"></a>Slowlog<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/logstash/edit/8.15/docs/static/logging.asciidoc">edit</a></h3>
</div></div></div>
<p>Slowlog for Logstash adds the ability to log when a specific event takes an abnormal amount of time to make its way
through the pipeline. Just like the normal application log, you can find slowlogs in your <code class="literal">--path.logs</code> directory.
Slowlog is configured in the <code class="literal">logstash.yml</code> settings file with the following options:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">slowlog.threshold.warn (default: -1)
slowlog.threshold.info (default: -1)
slowlog.threshold.debug (default: -1)
slowlog.threshold.trace (default: -1)</pre>
</div>
<p>Slowlog is disabled by default. The default threshold values are set to
<code class="literal">-1nanos</code> to represent an infinite threshold. No slowlog will be invoked.</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_enable_slowlog"></a>Enable slowlog<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/logstash/edit/8.15/docs/static/logging.asciidoc">edit</a></h4>
</div></div></div>
<p>The <code class="literal">slowlog.threshold</code> fields use a time-value format which enables a wide
range of trigger intervals. You can specify ranges using the following time
units: <code class="literal">nanos</code> (nanoseconds), <code class="literal">micros</code> (microseconds), <code class="literal">ms</code> (milliseconds), <code class="literal">s</code>
(second), <code class="literal">m</code> (minute), <code class="literal">h</code> (hour), <code class="literal">d</code> (day).</p>
<p>Slowlog becomes more sensitive and logs more events as you raise the log level.</p>
<p>Example:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">slowlog.threshold.warn: 2s
slowlog.threshold.info: 1s
slowlog.threshold.debug: 500ms
slowlog.threshold.trace: 100ms</pre>
</div>
<p>In this example:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If the log level is set to <code class="literal">warn</code>, the log shows events that took longer than 2s to process.
</li>
<li class="listitem">
If the log level is set to <code class="literal">info</code>, the log shows events that took longer than 1s to process.
</li>
<li class="listitem">
If the log level is set to <code class="literal">debug</code>, the log shows events that took longer than 500ms to process.
</li>
<li class="listitem">
If the log level is set to <code class="literal">trace</code>, the log shows events that took longer than 100ms to process.
</li>
</ul>
</div>
<p>The logs include the full event and filter configuration that are responsible
for the slowness.</p>
</div>

</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="running-logstash-windows.html">« Running Logstash on Windows</a>
</span>
<span class="next">
<a href="shutdown.html">Shutting Down Logstash »</a>
</span>
</div>
</body>
</html>
