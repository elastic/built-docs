<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="description" content="An introduction to machine learning anomaly detection, which analyzes time series data to identify and predict anomalous patterns in your data.">
<meta name="keywords" content="ML, Elastic Stack, anomaly detection, overview">
<title>Security anomaly detection configurations | Machine Learning in the Elastic Stack [7.17] | Elastic</title>
<meta class="elastic" name="content" content="Security anomaly detection configurations | Machine Learning in the Elastic Stack [7.17]">

<link rel="home" href="index.html" title="Machine Learning in the Elastic Stack [7.17]"/>
<link rel="up" href="ootb-ml-jobs.html" title="Supplied anomaly detection configurations"/>
<link rel="prev" href="ootb-ml-jobs-nginx.html" title="Nginx anomaly detection configurations"/>
<link rel="next" href="ootb-ml-jobs-uptime.html" title="Uptime anomaly detection configurations"/>
<meta class="elastic" name="product_version" content="7.17"/>
<meta class="elastic" name="product_name" content="Machine Learning"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Elastic Stack/Machine Learning/7.17"/>
<meta name="DC.subject" content="Machine Learning"/>
<meta name="DC.identifier" content="7.17"/>
</head>
<body><div class="page_header">
A newer version is available. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Machine Learning in the Elastic Stack [7.17]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="xpack-ml.html">Anomaly detection</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="ootb-ml-jobs.html">Supplied anomaly detection configurations</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="ootb-ml-jobs-nginx.html">« Nginx anomaly detection configurations</a>
</span>
<span class="next">
<a href="ootb-ml-jobs-uptime.html">Uptime anomaly detection configurations »</a>
</span>
</div>
<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="ootb-ml-jobs-siem"></a>Security anomaly detection configurations<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/7.17/docs/en/stack/ml/anomaly-detection/ootb-ml-jobs-siem.asciidoc">edit</a></h2>
</div></div></div>

<p>These anomaly detection jobs automatically detect file system and network anomalies on
your hosts. They appear in the <span class="strong strong"><strong>Anomaly Detection</strong></span> interface of the
<a href="/guide/en/security/7.17/machine-learning.html" class="ulink" target="_top">Elastic Security app</a> in Kibana when you have
data that matches their configuration. Each job lists the type of Elastic Agent
integration or Beat that collects the pertinent data. If you do not use the
Elastic Agent or Beats, you must map your data to the ECS fields that are listed
for each job.</p>
<p>For more details, see the
datafeed and job definitions in the <code class="literal">security_*</code> and <code class="literal">siem_*</code> folders in
<a href="https://github.com/elastic/kibana/tree/7.17/x-pack/plugins/ml/server/models/data_recognizer/modules" class="ulink" target="_top">GitHub</a>.</p>
<h4><a id="security-auditbeat-jobs"></a>Security: Auditbeat<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/7.17/docs/en/stack/ml/anomaly-detection/ootb-ml-jobs-siem.asciidoc">edit</a></h4>
<p>Detect suspicious network activity and unusual processes in Auditbeat data.</p>
<p>In the Machine Learning app, these configurations are available only when data exists
that matches the query specified in the
<a href="https://github.com/elastic/kibana/blob/7.17/x-pack/plugins/ml/server/models/data_recognizer/modules/siem_auditbeat/manifest.json#L8" class="ulink" target="_top">manifest file</a>.
In the Elastic Security app, it looks in the index pattern specified in the
<a href="/guide/en/kibana/7.17/advanced-options.html#securitysolution-defaultindex" class="ulink" target="_top"><code class="literal">securitySolution:defaultIndex</code> advanced setting</a>
for data that matches the query.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>In 7.11 or later versions, use the <a class="xref" href="ootb-ml-jobs-siem.html#security-linux-jobs" title="Security: Linux">Security: Linux</a> jobs
instead.<sup class="footnote" id="_footnote_duplicatelinuxjobs">[<a id="_footnoteref_1" class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup></p>
</div>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
linux_anomalous_network_activity_ecs
</span>
</dt>
<dd>
<p>
Identifies OS processes that do not usually use the network but have
unexpected network activity, which can indicate command-and-control, lateral
movement, persistence, or data exfiltration activity.
</p>
<p>A process with unusual network activity can denote process exploitation or
injection, where the process is used to run persistence mechanisms that allow a
malicious actor remote access or control of the host, data exfiltration, and
execution of unauthorized network applications.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes network activity logs where <code class="literal">agent.type</code> is <code class="literal">auditbeat</code>.
</li>
<li class="listitem">
Models the occurrences of processes that cause network activity.
</li>
<li class="listitem">
Detects network activity caused by processes that occur rarely compared to
other processes (using the <a href="/guide/en/machine-learning/7.17/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Auditbeat
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields when not using Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">destination.ip</code>
</li>
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">process.name</code>
</li>
<li class="listitem">
<code class="literal">user.name</code>
</li>
<li class="listitem">
<code class="literal">event.action</code>
</li>
<li class="listitem">
<code class="literal">agent.type</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
linux_anomalous_network_port_activity_ecs
</span>
</dt>
<dd>
<p>
Identifies unusual destination port activity that can indicate
command-and-control, persistence mechanism, or data exfiltration activity.
</p>
<p>Rarely used destination port activity is generally unusual in Linux fleets, and
can indicate unauthorized access or threat actor activity.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes network activity logs where <code class="literal">agent.type</code> is <code class="literal">auditbeat</code>.
</li>
<li class="listitem">
Models destination port activity.
</li>
<li class="listitem">
Detects destination port activity that occurs rarely compared to other port
activities (using the <a href="/guide/en/machine-learning/7.17/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Auditbeat (Linux)
</li>
</ul>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This job is available only when you use Auditbeat to ship data.
<sup class="footnote" id="_footnote_compatible">[<a id="_footnoteref_2" class="footnote" href="#_footnotedef_2" title="View footnote.">2</a>]</sup></p>
</div>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
linux_anomalous_network_service
</span>
</dt>
<dd>
<p>
Searches for unusual listening ports that can indicate execution of
unauthorized services, backdoors, or persistence mechanisms.
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes network activity logs where <code class="literal">agent.type</code> is <code class="literal">auditbeat</code>.
</li>
<li class="listitem">
Models listening port activity.
</li>
<li class="listitem">
Detects listening port activity that occurs rarely compared to
other port activities (using the <a href="/guide/en/machine-learning/7.17/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Auditbeat (Linux)
</li>
</ul>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This job is available only when you use Auditbeat to ship data.<sup class="footnoteref">[<a class="footnote" href="#_footnotedef_2" title="View footnote.">2</a>]</sup></p>
</div>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
linux_anomalous_network_url_activity_ecs
</span>
</dt>
<dd>
<p>
Searches for unusual web URL requests from hosts, which can indicate malware
delivery and execution.
</p>
<p>Wget and cURL are commonly used by Linux programs to download code and data.
Most of the time, their usage is entirely normal. Generally, because they use a
list of URLs, they repeatedly download from the same locations. However, Wget
and cURL are sometimes used to deliver Linux exploit payloads, and threat
actors use these tools to download additional software and code. For these
reasons, unusual URLs can indicate unauthorized downloads or threat activity.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes network activity logs where <code class="literal">agent.type</code> is <code class="literal">auditbeat</code>.
</li>
<li class="listitem">
Models the occurrences of URL requests.
</li>
<li class="listitem">
Detects a web URL request that is rare compared to other web URL
requests (using the <a href="/guide/en/machine-learning/7.17/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Auditbeat (Linux)
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields when not using Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">destination.ip</code>
</li>
<li class="listitem">
<code class="literal">destination.port</code>
</li>
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">process.name</code>
</li>
<li class="listitem">
<code class="literal">process.title</code>
</li>
<li class="listitem">
<code class="literal">agent.type</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
linux_anomalous_process_all_hosts_ecs
</span>
</dt>
<dd>
<p>
Searches for rare processes running on multiple hosts in an entire fleet or
network.
</p>
<p>This reduces the detection of false positives since automated maintenance
processes usually only run occasionally on a single machine but are common to
all or many hosts in a fleet.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes host activity logs where <code class="literal">agent.type</code> is <code class="literal">auditbeat</code>.
</li>
<li class="listitem">
Models the occurrences of processes on all hosts.
</li>
<li class="listitem">
Detects processes that occur rarely compared to other processes on all
hosts (using the <a href="/guide/en/machine-learning/7.17/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Auditbeat
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields when not using Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">process.name</code>
</li>
<li class="listitem">
<code class="literal">user.name</code>
</li>
<li class="listitem">
<code class="literal">process.executable</code>
</li>
<li class="listitem">
<code class="literal">event.action</code>
</li>
<li class="listitem">
<code class="literal">agent.type</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
linux_anomalous_user_name_ecs
</span>
</dt>
<dd>
<p>
Searches for activity from users who are not normally active, which can
indicate unauthorized changes, activity by unauthorized users, lateral
movement, and compromised credentials.
</p>
<p>In organizations, new usernames are not often created apart from specific types
of system activities, such as creating new accounts for new employees. These
user accounts quickly become active and routine.</p>
<p>Events from rarely used usernames can point to suspicious activity.
Additionally, automated Linux fleets tend to see activity from rarely used
usernames only when personnel log in to make authorized or unauthorized
changes, or threat actors have acquired credentials and log in for malicious
purposes. Unusual usernames can also indicate pivoting, where compromised
credentials are used to try and move laterally from one host to another.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes host activity logs where <code class="literal">agent.type</code> is <code class="literal">auditbeat</code>.
</li>
<li class="listitem">
Models user activity.
</li>
<li class="listitem">
Detects users that are rarely or unusually active compared to other users
(using the <a href="/guide/en/machine-learning/7.17/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Auditbeat
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields when not using Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">process.name</code>
</li>
<li class="listitem">
<code class="literal">user.name</code>
</li>
<li class="listitem">
<code class="literal">event.action</code>
</li>
<li class="listitem">
<code class="literal">agent.type</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
linux_network_configuration_discovery
</span>
</dt>
<dd>
<p>
Looks for commands related to system network configuration discovery from an
unusual user context. This can be due to uncommon troubleshooting activity or
due to a compromised account. A compromised account may be used by a threat
actor to engage in system network configuration discovery in order to increase
their understanding of connected networks and hosts. This information may be
used to shape follow-up behavior such as lateral movement or additional
discovery.
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes host activity logs where <code class="literal">agent.type</code> is <code class="literal">auditbeat</code> and
<code class="literal">process.name</code> is commands like <code class="literal">arp</code>, <code class="literal">echo</code>, or <code class="literal">ifconfig</code>, for example.
</li>
<li class="listitem">
Models user activity.
</li>
<li class="listitem">
Detects users that are rarely or unusually active compared to other users
(using the <a href="/guide/en/machine-learning/7.17/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Auditbeat
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields when not using Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">process.args</code>
</li>
<li class="listitem">
<code class="literal">process.name</code>
</li>
<li class="listitem">
<code class="literal">user.name</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
linux_network_connection_discovery
</span>
</dt>
<dd>
<p>
Looks for commands related to system network connection discovery from an
unusual user context. This can be due to uncommon troubleshooting activity or
due to a compromised account. A compromised account may be used by a threat
actor to engage in system network connection discovery in order to increase
their understanding of connected services and systems. This information may be
used to shape follow-up behaviors such as lateral movement or additional
discovery.
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes host activity logs where <code class="literal">agent.type</code> is <code class="literal">auditbeat</code> and
<code class="literal">process.name</code> is commands like <code class="literal">netstat</code>, <code class="literal">ss</code>, or <code class="literal">route</code>, for example.
</li>
<li class="listitem">
Models user activity.
</li>
<li class="listitem">
Detects users that are rarely or unusually active compared to other users
(using the <a href="/guide/en/machine-learning/7.17/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Auditbeat
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields when not using Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">process.args</code>
</li>
<li class="listitem">
<code class="literal">process.name</code>
</li>
<li class="listitem">
<code class="literal">user.name</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
linux_rare_kernel_module_arguments
</span>
</dt>
<dd>
<p>
Looks for unusual kernel modules which are often used for stealth.
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes host activity logs where <code class="literal">agent.type</code> is <code class="literal">auditbeat</code> and
<code class="literal">process.name</code> is commands like <code class="literal">insmod</code>, <code class="literal">kmod</code>, or <code class="literal">rmod</code>, for example.
</li>
<li class="listitem">
Models occurrences of process activity.
</li>
<li class="listitem">
Detects processes that are rarely or unusually active compared to other processes
(using the <a href="/guide/en/machine-learning/7.17/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Auditbeat
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields when not using Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">process.title</code>
</li>
<li class="listitem">
<code class="literal">process.working_directory</code>
</li>
<li class="listitem">
<code class="literal">user.name</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
linux_rare_metadata_process
</span>
</dt>
<dd>
<p>
Looks for anomalous access to the metadata service by an unusual process. The
metadata service may be targeted in order to harvest credentials or user data
scripts containing secrets.
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes host activity logs where <code class="literal">agent.type</code> is <code class="literal">auditbeat</code> and
<code class="literal">destination.ip</code> is the metadata service.
</li>
<li class="listitem">
Models process activity.
</li>
<li class="listitem">
Detects processes that are rarely or unusually active compared to other processes
(using the <a href="/guide/en/machine-learning/7.17/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Auditbeat
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields when not using Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">process.name</code>
</li>
<li class="listitem">
<code class="literal">user.name</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
linux_rare_metadata_user
</span>
</dt>
<dd>
<p>
Looks for anomalous access to the metadata service by an unusual user. The
metadata service may be targeted in order to harvest credentials or user data
scripts containing secrets.
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes host activity logs where <code class="literal">agent.type</code> is <code class="literal">auditbeat</code> and
<code class="literal">destination.ip</code> is the metadata service.
</li>
<li class="listitem">
Models user activity.
</li>
<li class="listitem">
Detects users that are rarely or unusually active compared to other users
(using the <a href="/guide/en/machine-learning/7.17/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Auditbeat
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields when not using Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">user.name</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
linux_rare_sudo_user
</span>
</dt>
<dd>
<p>
Looks for sudo activity from an unusual user context.
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes host activity logs where <code class="literal">agent.type</code> is <code class="literal">auditbeat</code>,
<code class="literal">process.name</code> is <code class="literal">sudo</code>, and <code class="literal">event.action</code> is <code class="literal">executed</code>.
</li>
<li class="listitem">
Models user activity.
</li>
<li class="listitem">
Detects users that are rarely or unusually active compared to other users
(using the <a href="/guide/en/machine-learning/7.17/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Auditbeat
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields when not using Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">process.args</code>
</li>
<li class="listitem">
<code class="literal">process.name</code>
</li>
<li class="listitem">
<code class="literal">user.name</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
linux_rare_user_compiler
</span>
</dt>
<dd>
<p>
Looks for compiler activity by a user context which does not normally run
compilers. This can be ad-hoc software changes or unauthorized software
deployment. This can also be due to local privilege elevation via locally run
exploits or malware activity.
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes host activity logs where <code class="literal">agent.type</code> is <code class="literal">auditbeat</code> and
<code class="literal">process.name</code> is commands like <code class="literal">compile</code>, <code class="literal">make</code>, or <code class="literal">gcc</code>, for example.
</li>
<li class="listitem">
Models user activity.
</li>
<li class="listitem">
Detects users that are rarely or unusually active compared to other users
(using the <a href="/guide/en/machine-learning/7.17/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Auditbeat
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields when not using Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">process.title</code>
</li>
<li class="listitem">
<code class="literal">process.working_directory</code>
</li>
<li class="listitem">
<code class="literal">user.name</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
linux_system_information_discovery
</span>
</dt>
<dd>
<p>
Looks for commands related to system information discovery from an unusual user
context. This can be due to uncommon troubleshooting activity or due to a
compromised account. A compromised account may be used to engage in system
information discovery in order to gather detailed information about system
configuration and software versions. This may be a precursor to selection of a
persistence mechanism or a method of privilege elevation.
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes host activity logs where <code class="literal">agent.type</code> is <code class="literal">auditbeat</code> and
<code class="literal">process.name</code> is commands like <code class="literal">cat</code>, <code class="literal">grep</code>, or <code class="literal">hostname</code>, for example.
</li>
<li class="listitem">
Models user activity.
</li>
<li class="listitem">
Detects users that are rarely or unusually active compared to other users
(using the <a href="/guide/en/machine-learning/7.17/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Auditbeat
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields when not using Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">process.args</code>
</li>
<li class="listitem">
<code class="literal">process.name</code>
</li>
<li class="listitem">
<code class="literal">user.name</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
linux_system_process_discovery
</span>
</dt>
<dd>
<p>
Looks for commands related to system process discovery from an unusual user
context. This can be due to uncommon troubleshooting activity or due to a
compromised account. A compromised account may be used to engage in system
process discovery in order to increase their understanding of software
applications running on a target host or network. This may be a precursor to
selection of a persistence mechanism or a method of privilege elevation.
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes host activity logs where <code class="literal">agent.type</code> is <code class="literal">auditbeat</code> and
<code class="literal">process.name</code> is commands like <code class="literal">ps</code> or <code class="literal">top</code>, for example.
</li>
<li class="listitem">
Models user activity.
</li>
<li class="listitem">
Detects users that are rarely or unusually active compared to other users
(using the <a href="/guide/en/machine-learning/7.17/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Auditbeat
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields when not using Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">process.args</code>
</li>
<li class="listitem">
<code class="literal">process.name</code>
</li>
<li class="listitem">
<code class="literal">user.name</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
linux_system_user_discovery
</span>
</dt>
<dd>
<p>
Looks for commands related to system user or owner discovery from an unusual
user context. This can be due to uncommon troubleshooting activity or due to a
compromised account. A compromised account may be used to engage in system owner
or user discovery in order to identify currently active or primary users of a
system. This may be a precursor to additional discovery, credential dumping or
privilege elevation activity.
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes host activity logs where <code class="literal">agent.type</code> is <code class="literal">auditbeat</code> and
<code class="literal">process.name</code> is commands like <code class="literal">users</code>, <code class="literal">whoami</code>, or <code class="literal">who</code>, for example.
</li>
<li class="listitem">
Models user activity.
</li>
<li class="listitem">
Detects users that are rarely or unusually active compared to other users
(using the <a href="/guide/en/machine-learning/7.17/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Auditbeat
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields when not using Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">process.args</code>
</li>
<li class="listitem">
<code class="literal">process.name</code>
</li>
<li class="listitem">
<code class="literal">user.name</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
rare_process_by_host_linux_ecs
</span>
</dt>
<dd>
<p>
Identifies rare processes that do not usually run on individual hosts, which
can indicate execution of unauthorized services, malware, or persistence
mechanisms.
</p>
<p>Processes are considered rare when they only run occasionally as compared with
other processes running on the host.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes host activity logs where <code class="literal">agent.type</code> is <code class="literal">auditbeat</code> (Linux).
</li>
<li class="listitem">
Models occurrences of process activities on the host.
</li>
<li class="listitem">
Detects unusually rare processes compared to other processes on the host (using the <a href="/guide/en/machine-learning/7.17/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Auditbeat
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields when not using Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">process.name</code>
</li>
<li class="listitem">
<code class="literal">user.name</code>
</li>
<li class="listitem">
<code class="literal">event.action</code>
</li>
<li class="listitem">
<code class="literal">agent.type</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
</dl>
</div>
<h4><a id="security-auditbeat-authentication-jobs"></a>Security: Auditbeat authentication<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/7.17/docs/en/stack/ml/anomaly-detection/ootb-ml-jobs-siem.asciidoc">edit</a></h4>
<p>Detect suspicious authentication events in Auditbeat data.</p>
<p>In the Machine Learning app, these configurations are available only when data exists
that matches the query specified in the
<a href="https://github.com/elastic/kibana/blob/7.17/x-pack/plugins/ml/server/models/data_recognizer/modules/siem_auditbeat_auth/manifest.json#L8" class="ulink" target="_top">manifest file</a>.
In the Elastic Security app, it looks in the index pattern specified in the
<a href="/guide/en/kibana/7.17/advanced-options.html#securitysolution-defaultindex" class="ulink" target="_top"><code class="literal">securitySolution:defaultIndex</code> advanced setting</a> for data that matches the query.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
suspicious_login_activity_ecs
</span>
</dt>
<dd>
<p>
Identifies an unusually high number of authentication attempts.
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes host activity logs where <code class="literal">agent.type</code> is <code class="literal">auditbeat</code>.
</li>
<li class="listitem">
Models occurrences of authentication attempts (<code class="literal">partition_field_name</code> is
<code class="literal">host.name</code>).
</li>
<li class="listitem">
Detects unusually high number of authentication attempts (using the
<a href="/guide/en/machine-learning/7.17/ml-count-functions.html#ml-nonzero-count" class="ulink" target="_top"><code class="literal">high_non_zero_count</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Auditbeat (Linux)
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields when not using Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">source.ip</code>
</li>
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">user.name</code>
</li>
<li class="listitem">
<code class="literal">event.category</code>
</li>
<li class="listitem">
<code class="literal">agent.type</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
</dl>
</div>
<h4><a id="security-authentication"></a>Security: Authentication<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/7.17/docs/en/stack/ml/anomaly-detection/ootb-ml-jobs-siem.asciidoc">edit</a></h4>
<p>Detect anomalous activity in your ECS-compatible authentication logs.</p>
<p>In the Machine Learning app, these configurations are available only when data exists
that matches the query specified in the
<a href="https://github.com/elastic/kibana/blob/7.17/x-pack/plugins/ml/server/models/data_recognizer/modules/security_auth/manifest.json#L8" class="ulink" target="_top">manifest file</a>.
In the Elastic Security app, it looks in the index pattern specified in the
<a href="/guide/en/kibana/7.17/advanced-options.html#securitysolution-defaultindex" class="ulink" target="_top"><code class="literal">securitySolution:defaultIndex</code> advanced setting</a>
for data that matches the query.</p>
<p>By default, when you create these job in the Elastic Security app, it uses an index
pattern that applies to multiple indices. To get the same results if you use the
Machine Learning app, create a similar
<a href="https://github.com/elastic/kibana/blob/7.17/x-pack/plugins/ml/server/models/data_recognizer/modules/security_auth/manifest.json#L7" class="ulink" target="_top">index pattern</a>
then select it in the job wizard.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
auth_high_count_logon_events
</span>
</dt>
<dd>
<p>
Looks for an unusually large spike in successful authentication events. This can
be due to password spraying, user enumeration or brute force activity.
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Detects anomalies where the number of events is unusually high and ignores
cases where the count is zero (using the
<a href="/guide/en/machine-learning/7.17/ml-count-functions.html#ml-nonzero-count" class="ulink" target="_top"><code class="literal">high_non_zero_count</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic Endpoint integration
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">event.category</code>
</li>
<li class="listitem">
<code class="literal">event.outcome</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
auth_high_count_logon_events_for_a_source_ip
</span>
</dt>
<dd>
<p>
Looks for an unusually large spike in successful authentication events from a
particular source IP address. This can be due to password spraying, user
enumeration or brute force activity.
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Detects anomalies where the number of events by source IP is unusually high
and ignores cases where the count is zero (using the
<a href="/guide/en/machine-learning/7.17/ml-count-functions.html#ml-nonzero-count" class="ulink" target="_top"><code class="literal">high_non_zero_count</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic Endpoint integration
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">event.category</code>
</li>
<li class="listitem">
<code class="literal">event.outcome</code>
</li>
<li class="listitem">
<code class="literal">source.ip</code>
</li>
<li class="listitem">
<code class="literal">user.name</code>
</li>
<li class="listitem">
<code class="literal">winlog.event_data.LogonType</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
auth_high_count_logon_fails
</span>
</dt>
<dd>
<p>
Looks for an unusually large spike in authentication failure events. This can be
due to password spraying, user enumeration or brute force activity and may be a
precursor to account takeover or credentialed access.
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Detects anomalies where the number of events is unusually high and ignores
cases where the count is zero (using the
<a href="/guide/en/machine-learning/7.17/ml-count-functions.html#ml-nonzero-count" class="ulink" target="_top"><code class="literal">high_non_zero_count</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic Endpoint integration
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">event.category</code>
</li>
<li class="listitem">
<code class="literal">event.outcome</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
auth_rare_hour_for_a_user
</span>
</dt>
<dd>
<p>
Looks for a user logging in at a time of day that is unusual for the user. This
can be due to credentialed access via a compromised account when the user and
the threat actor are in different time zones. In addition, unauthorized user
activity often takes place during non-business hours.
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Detects anomalies where events happen at unusual times for a user (using the
<a href="/guide/en/machine-learning/7.17/ml-time-functions.html#ml-time-of-day" class="ulink" target="_top"><code class="literal">time_of_day</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic Endpoint integration
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">event.category</code>
</li>
<li class="listitem">
<code class="literal">event.outcome</code>
</li>
<li class="listitem">
<code class="literal">source.ip</code>
</li>
<li class="listitem">
<code class="literal">user.name</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
auth_rare_source_ip_for_a_user
</span>
</dt>
<dd>
<p>
Looks for a user logging in from an IP address that is unusual for the user.
This can be due to credentialed access via a compromised account when the user
and the threat actor are in different locations. An unusual source IP address
for a username could also be due to lateral movement when a compromised account
is used to pivot between hosts.
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For each user, detects rare <code class="literal">source.ip</code> values (using the
<a href="/guide/en/machine-learning/7.17/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic Endpoint integration
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">event.category</code>
</li>
<li class="listitem">
<code class="literal">event.outcome</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
auth_rare_user
</span>
</dt>
<dd>
<p>
Looks for an unusual user name in the authentication logs. An unusual user name
is one way of detecting credentialed access by means of a new or dormant user
account. A user account that is normally inactive, because the user has left the
organization, which becomes active, may be due to credentialed access using a
compromised account password. Threat actors will sometimes also create new users
as a means of persisting in a compromised web application.
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Detects unusually rare <code class="literal">user.name</code> values (using the
<a href="/guide/en/machine-learning/7.17/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic Endpoint integration
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">event.category</code>
</li>
<li class="listitem">
<code class="literal">event.outcome</code>
</li>
<li class="listitem">
<code class="literal">source.ip</code>
</li>
<li class="listitem">
<code class="literal">user.name</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
</dl>
</div>
<h4><a id="security-cloudtrail-jobs"></a>Security: CloudTrail<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/7.17/docs/en/stack/ml/anomaly-detection/ootb-ml-jobs-siem.asciidoc">edit</a></h4>
<p>Detect suspicious activity recorded in your CloudTrail logs.</p>
<p>In the Machine Learning app, these configurations are available only when data exists
that matches the query specified in the
<a href="https://github.com/elastic/kibana/blob/7.17/x-pack/plugins/ml/server/models/data_recognizer/modules/siem_cloudtrail/manifest.json#L8" class="ulink" target="_top">manifest file</a>.
In the Elastic Security app, it looks in the index pattern specified in the
<a href="/guide/en/kibana/7.17/advanced-options.html#securitysolution-defaultindex" class="ulink" target="_top"><code class="literal">securitySolution:defaultIndex</code> advanced setting</a>
for data that matches the query.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
high_distinct_count_error_message
</span>
</dt>
<dd>
<p>
Looks for a spike in the rate of an error message. These spikes might simply
indicate an impending service failure but they can also be byproducts of
attempted or successful persistence, privilege escalation, defense evasion,
discovery, lateral movement, or collection activity by a threat actor.
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Detects anomalies where the number of distinct values in
the <code class="literal">aws.cloudtrail.error_message</code> field is unusual
(using the <a href="/guide/en/machine-learning/7.17/ml-count-functions.html#ml-distinct-count" class="ulink" target="_top"><code class="literal">high_distinct_count</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Filebeat
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields when not using Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">source.geo.city_name</code>
</li>
<li class="listitem">
<code class="literal">source.ip</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
rare_error_code
</span>
</dt>
<dd>
<p>
Looks for unusual errors. Rare and unusual errors might simply indicate an
impending service failure but they can also be byproducts of attempted or
successful persistence, privilege escalation, defence evasion, discovery,
lateral movement, or collection activity by a threat actor.
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Detects <code class="literal">aws.cloudtrail.error_code</code> values that have never or rarely occurred
before (using the <a href="/guide/en/machine-learning/7.17/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Filebeat
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields when not using Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">source.geo.city_name</code>
</li>
<li class="listitem">
<code class="literal">source.ip</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
rare_method_for_a_city
</span>
</dt>
<dd>
<p>
Looks for AWS API calls that&#8212;&#8203;while not inherently suspicious or abnormal&#8212;&#8203;are
sourcing from a geolocation (city) that is unusual. These calls can be the
result of compromised credentials or keys.
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For each city, detects rare <code class="literal">event.action</code> values (using the
<a href="/guide/en/machine-learning/7.17/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Filebeat
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields when not using Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">event.action</code>
</li>
<li class="listitem">
<code class="literal">source.geo.city_name</code>
</li>
<li class="listitem">
<code class="literal">source.ip</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
rare_method_for_a_country
</span>
</dt>
<dd>
<p>
Looks for AWS API calls that&#8212;&#8203;while not inherently suspicious or abnormal&#8212;&#8203;are
sourcing from a geolocation (country) that is unusual. These calls can be the
result of compromised credentials or keys.
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For each country, detects rare <code class="literal">event.action</code> values (using the
<a href="/guide/en/machine-learning/7.17/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Filebeat
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields when not using Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">event.action</code>
</li>
<li class="listitem">
<code class="literal">source.geo.country_iso_code</code>
</li>
<li class="listitem">
<code class="literal">source.ip</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
rare_method_for_a_username
</span>
</dt>
<dd>
<p>
Looks for AWS API calls that&#8212;&#8203;while not inherently suspicious or abnormal&#8212;&#8203;are
sourcing from a user context that does not normally call the method. These calls
can be the result of compromised credentials or keys as someone uses a valid
account to persist, move laterally, or exfil data.
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For each user, detects rare <code class="literal">event.action</code> values (using the
<a href="/guide/en/machine-learning/7.17/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Filebeat
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields when not using Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">event.action</code>
</li>
<li class="listitem">
<code class="literal">source.geo.city_name</code>
</li>
<li class="listitem">
<code class="literal">source.ip</code>
</li>
<li class="listitem">
<code class="literal">user.name</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
</dl>
</div>
<h4><a id="security-linux-jobs"></a>Security: Linux<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/7.17/docs/en/stack/ml/anomaly-detection/ootb-ml-jobs-siem.asciidoc">edit</a></h4>
<p>Detect suspicious activity using ECS Linux events.</p>
<p>In the Machine Learning app, these configurations are available only when data exists
that matches the query specified in the
<a href="https://github.com/elastic/kibana/blob/7.17/x-pack/plugins/ml/server/models/data_recognizer/modules/security_linux/manifest.json#L8" class="ulink" target="_top">manifest file</a>.
In the Elastic Security app, it looks in the index pattern specified in the
<a href="/guide/en/kibana/7.17/advanced-options.html#securitysolution-defaultindex" class="ulink" target="_top"><code class="literal">securitySolution:defaultIndex</code> advanced setting</a>
for data that matches the query.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>In 7.11 or later versions, use these jobs instead of the <a class="xref" href="ootb-ml-jobs-siem.html#security-auditbeat-jobs" title="Security: Auditbeat">Security: Auditbeat</a> jobs.<sup class="footnoteref">[<a class="footnote" href="#_footnotedef_1" title="View footnote.">1</a>]</sup></p>
</div>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
v2_linux_anomalous_network_port_activity_ecs
</span>
</dt>
<dd>
<p>
Identifies unusual destination port activity that can indicate
command-and-control, persistence mechanism, or data exfiltration activity.
</p>
<p>Rarely used destination port activity is generally unusual in Linux fleets, and
can indicate unauthorized access or threat actor activity.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Models destination port activity.
</li>
<li class="listitem">
Detects destination port activity that occurs rarely compared to other port
activities (using the <a href="/guide/en/machine-learning/7.17/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
<li class="listitem">
Works on ECS compatible events across multiple indices.
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic Endpoint integration
</li>
<li class="listitem">
Auditbeat
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">destination.ip</code>
</li>
<li class="listitem">
<code class="literal">destination.port</code>
</li>
<li class="listitem">
<code class="literal">event.category</code>
</li>
<li class="listitem">
<code class="literal">event.type</code>
</li>
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">host.os.family</code>
</li>
<li class="listitem">
<code class="literal">host.os.type</code>
</li>
<li class="listitem">
<code class="literal">process.name</code>
</li>
<li class="listitem">
<code class="literal">user.name</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
v2_linux_anomalous_process_all_hosts_ecs
</span>
</dt>
<dd>
<p>
Looks for processes that are unusual to all Linux hosts. Such unusual processes may indicate unauthorized services, malware, or persistence mechanisms.
</p>
<p>This reduces the detection of false positives since automated maintenance
processes usually only run occasionally on a single machine but are common to
all or many hosts in a fleet.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Models the occurrences of processes on all Linux hosts.
</li>
<li class="listitem">
Detects processes that occur rarely compared to other processes on all Linux
hosts (using the <a href="/guide/en/machine-learning/7.17/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
<li class="listitem">
Works on ECS compatible events across multiple indices.
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic Endpoint integration
</li>
<li class="listitem">
Auditbeat
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">event.category</code>
</li>
<li class="listitem">
<code class="literal">event.type</code>
</li>
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">host.os.family</code>
</li>
<li class="listitem">
<code class="literal">host.os.type</code>
</li>
<li class="listitem">
<code class="literal">process.name</code>
</li>
<li class="listitem">
<code class="literal">user.name</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
v2_linux_anomalous_user_name_ecs
</span>
</dt>
<dd>
<p>
Searches for activity from users who are not normally active, which can
indicate unauthorized changes, activity by unauthorized users, lateral
movement, and compromised credentials.
</p>
<p>In organizations, new usernames are not often created apart from specific types
of system activities, such as creating new accounts for new employees. These
user accounts quickly become active and routine.</p>
<p>Events from rarely used usernames can point to suspicious activity.
Additionally, automated Linux fleets tend to see activity from rarely used
usernames only when personnel log in to make authorized or unauthorized
changes, or threat actors have acquired credentials and log in for malicious
purposes. Unusual usernames can also indicate pivoting, where compromised
credentials are used to try and move laterally from one host to another.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Models user activity.
</li>
<li class="listitem">
Detects users that are rarely or unusually active compared to other users
(using the <a href="/guide/en/machine-learning/7.17/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
<li class="listitem">
Works on ECS compatible events across multiple indices.
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic Endpoint integration
</li>
<li class="listitem">
Auditbeat
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">event.category</code>
</li>
<li class="listitem">
<code class="literal">event.type</code>
</li>
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">host.os.family</code>
</li>
<li class="listitem">
<code class="literal">host.os.type</code>
</li>
<li class="listitem">
<code class="literal">process.name</code>
</li>
<li class="listitem">
<code class="literal">user.name</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
v2_linux_rare_metadata_process
</span>
</dt>
<dd>
<p>
Looks for anomalous access to the metadata service by an unusual process. The
metadata service may be targeted in order to harvest credentials or user data
scripts containing secrets.
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes host activity logs where <code class="literal">destination.ip</code> is the metadata service
</li>
<li class="listitem">
Models process activity.
</li>
<li class="listitem">
Detects processes that are rarely or unusually active compared to other
processes (using the
<a href="/guide/en/machine-learning/7.17/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
<li class="listitem">
Works on ECS compatible events across multiple indices.
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic Endpoint integration
</li>
<li class="listitem">
Auditbeat
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">destination.ip</code>
</li>
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">host.os.family</code>
</li>
<li class="listitem">
<code class="literal">host.os.type</code>
</li>
<li class="listitem">
<code class="literal">process.name</code>
</li>
<li class="listitem">
<code class="literal">user.name</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
v2_linux_rare_metadata_user
</span>
</dt>
<dd>
<p>
Looks for anomalous access to the metadata service by an unusual user. The
metadata service may be targeted in order to harvest credentials or user data
scripts containing secrets.
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes host activity logs where <code class="literal">destination.ip</code> is the metadata service
</li>
<li class="listitem">
Models user activity.
</li>
<li class="listitem">
Detects users that are rarely or unusually active compared to other users
(using the <a href="/guide/en/machine-learning/7.17/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
<li class="listitem">
Works on ECS compatible events across multiple indices.
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic Endpoint integration
</li>
<li class="listitem">
Auditbeat
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">destination.ip</code>
</li>
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">host.os.family</code>
</li>
<li class="listitem">
<code class="literal">host.os.type</code>
</li>
<li class="listitem">
<code class="literal">user.name</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
v2_rare_process_by_host_linux_ecs
</span>
</dt>
<dd>
<p>
Looks for processes that are unusual to a particular Linux host. Such unusual
processes might indicate unauthorized services, malware, or persistence
mechanisms.
</p>
<p>Processes are considered rare when they only run occasionally as compared with
other processes running on the host.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Models occurrences of process activities on the host.
</li>
<li class="listitem">
Detects unusually rare processes compared to other processes on the host
(using the <a href="/guide/en/machine-learning/7.17/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
<li class="listitem">
Works on ECS compatible events across multiple indices.
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic Endpoint integration
</li>
<li class="listitem">
Auditbeat
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">event.category</code>
</li>
<li class="listitem">
<code class="literal">event.type</code>
</li>
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">host.os.family</code>
</li>
<li class="listitem">
<code class="literal">host.os.type</code>
</li>
<li class="listitem">
<code class="literal">process.name</code>
</li>
<li class="listitem">
<code class="literal">user.name</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
</dl>
</div>
<h4><a id="security-network-jobs"></a>Security: Network<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/7.17/docs/en/stack/ml/anomaly-detection/ootb-ml-jobs-siem.asciidoc">edit</a></h4>
<p>Detect anomalous network activity in your ECS-compatible network logs.</p>
<p>In the Machine Learning app, these configurations are available only when data exists
that matches the query specified in the
<a href="https://github.com/elastic/kibana/blob/7.17/x-pack/plugins/ml/server/models/data_recognizer/modules/security_network/manifest.json" class="ulink" target="_top">manifest file</a>.
In the Elastic Security app, it looks in the index pattern specified in the
<a href="/guide/en/kibana/7.17/advanced-options.html#securitysolution-defaultindex" class="ulink" target="_top"><code class="literal">securitySolution:defaultIndex</code> advanced setting</a>
for data that matches the query.</p>
<p>By default, when you create these jobs in the Elastic Security app, it uses an index
pattern that applies to multiple indices. To get the same results if you use the
Machine Learning app, create a similar
<a href="https://github.com/elastic/kibana/blob/7.17/x-pack/plugins/ml/server/models/data_recognizer/modules/security_network/manifest.json#L7" class="ulink" target="_top">index pattern</a>
then select it in the job wizard.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
high_count_by_destination_country
</span>
</dt>
<dd>
<p>
Looks for an unusually large spike in network activity to one destination
country in the network logs. This could be due to unusually large amounts of
reconnaissance or enumeration traffic. Data exfiltration activity may also
produce such a surge in traffic to a destination country which does not normally
appear in network traffic or business work-flows. Malware instances and
persistence mechanisms may communicate with command-and-control (C2)
infrastructure in their country of origin, which may be an unusual destination
country for the source network.
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes network activity logs where <code class="literal">event.category</code> is <code class="literal">network</code>.
</li>
<li class="listitem">
Detects unusually high number of events by country (using the
<a href="/guide/en/machine-learning/7.17/ml-count-functions.html#ml-nonzero-count" class="ulink" target="_top"><code class="literal">high_non_zero</code> function</a>).
</li>
<li class="listitem">
Works on ECS compatible events across multiple indices.
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic Endpoint integration
</li>
<li class="listitem">
Filebeat
</li>
<li class="listitem">
Packetbeat
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">destination.as.organization.name</code>
</li>
<li class="listitem">
<code class="literal">destination.geo.country_name</code>
</li>
<li class="listitem">
<code class="literal">destination.ip</code>
</li>
<li class="listitem">
<code class="literal">event.category</code>
</li>
<li class="listitem">
<code class="literal">source.ip</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
high_count_network_denies
</span>
</dt>
<dd>
<p>
Looks for an unusually large spike in network traffic that was denied by network
access control lists (ACL) or firewall rules. Such a burst of denied traffic is
usually either a misconfigured application or firewall, or suspicious or
malicious activity. Unsuccessful attempts at network transit, in order to
connect to command-and-control (C2), or engage in data exfiltration, may produce
a burst of failed connections. This could also be due to unusually large amounts
of reconnaissance or enumeration traffic. Denial-of-service attacks or traffic
floods may also produce such a surge in traffic.
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes network activity logs where <code class="literal">event.category</code> is <code class="literal">network</code> and
<code class="literal">event.outcome</code> is <code class="literal">deny</code>.
</li>
<li class="listitem">
Detects unusually high numbers of events (using the
<a href="/guide/en/machine-learning/7.17/ml-count-functions.html#ml-count" class="ulink" target="_top"><code class="literal">high_count</code> function</a>).
</li>
<li class="listitem">
Works on ECS compatible events across multiple indices.
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic Endpoint integration
</li>
<li class="listitem">
Filebeat
</li>
<li class="listitem">
Packetbeat
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">destination.as.organization.name</code>
</li>
<li class="listitem">
<code class="literal">destination.geo.country_name</code>
</li>
<li class="listitem">
<code class="literal">destination.port</code>
</li>
<li class="listitem">
<code class="literal">event.category</code>
</li>
<li class="listitem">
<code class="literal">event.outcome</code>
</li>
<li class="listitem">
<code class="literal">source.ip</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
high_count_network_events
</span>
</dt>
<dd>
<p>
Looks for an unusually large spike in network traffic. Such a burst of traffic,
if not caused by a surge in business activity, can be due to suspicious or
malicious activity. Large-scale data exfiltration may produce a burst of network
traffic; this could also be due to unusually large amounts of reconnaissance or
enumeration traffic. Denial-of-service attacks or traffic floods may also
produce such a surge in traffic.
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes network activity logs where <code class="literal">event.category</code> is <code class="literal">network</code>.
</li>
<li class="listitem">
Detects unusually high numbers of events (using the
<a href="/guide/en/machine-learning/7.17/ml-count-functions.html#ml-count" class="ulink" target="_top"><code class="literal">high_count</code> function</a>).
</li>
<li class="listitem">
Works on ECS compatible events across multiple indices.
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic Endpoint integration
</li>
<li class="listitem">
Filebeat
</li>
<li class="listitem">
Packetbeat
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">destination.as.organization.name</code>
</li>
<li class="listitem">
<code class="literal">destination.geo.country_name</code>
</li>
<li class="listitem">
<code class="literal">destination.port</code>
</li>
<li class="listitem">
<code class="literal">event.category</code>
</li>
<li class="listitem">
<code class="literal">source.ip</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
rare_destination_country
</span>
</dt>
<dd>
<p>
Looks for an unusual destination country name in the network logs. This can be
due to initial access, persistence, command-and-control, or exfiltration
activity. For example, when a user clicks on a link in a phishing email or opens
a malicious document, a request may be sent to download and run a payload from a
server in a country which does not normally appear in network traffic or
business work-flows. Malware instances and persistence mechanisms may
communicate with command-and-control (C2) infrastructure in their country of
origin, which may be an unusual destination country for the source network.
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes network activity logs where <code class="literal">event.category</code> is <code class="literal">network</code>.
</li>
<li class="listitem">
Detects activity that is rare by country name (using the
<a href="/guide/en/machine-learning/7.17/ml-rare-functions.html" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
<li class="listitem">
Works on ECS compatible events across multiple indices.
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic Endpoint integration
</li>
<li class="listitem">
Filebeat
</li>
<li class="listitem">
Packetbeat
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">destination.as.organization.name</code>
</li>
<li class="listitem">
<code class="literal">destination.geo.country_name</code>
</li>
<li class="listitem">
<code class="literal">destination.ip</code>
</li>
<li class="listitem">
<code class="literal">event.category</code>
</li>
<li class="listitem">
<code class="literal">source.ip</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
</dl>
</div>
<h4><a id="security-packetbeat-jobs"></a>Security: Packetbeat<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/7.17/docs/en/stack/ml/anomaly-detection/ootb-ml-jobs-siem.asciidoc">edit</a></h4>
<p>Detect suspicious network activity in Packetbeat data.</p>
<p>In the Machine Learning app, these configurations are available only when data exists
that matches the query specified in the
<a href="https://github.com/elastic/kibana/blob/7.17/x-pack/plugins/ml/server/models/data_recognizer/modules/siem_packetbeat/manifest.json#L8" class="ulink" target="_top">manifest file</a>.
In the Elastic Security app, it looks in the index pattern specified in the
<a href="/guide/en/kibana/7.17/advanced-options.html#securitysolution-defaultindex" class="ulink" target="_top"><code class="literal">securitySolution:defaultIndex</code> advanced setting</a>
for data that matches the query.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
packetbeat_dns_tunneling
</span>
</dt>
<dd>
<p>
Searches for unusually large numbers of DNS queries
for a single top-level DNS domain, which is often used for DNS tunneling.
</p>
<p>DNS tunneling can be used for command-and-control, persistence, or data
exfiltration activity. For example, <code class="literal">dnscat</code> tends to generate many DNS
questions for a top-level domain as it uses the DNS protocol to tunnel data.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes network activity logs where <code class="literal">agent.type</code> is <code class="literal">packetbeat</code>.
</li>
<li class="listitem">
Models occurrences of DNS activity.
</li>
<li class="listitem">
Detects unusual DNS activity (using the
<a href="/guide/en/machine-learning/7.17/ml-info-functions.html#ml-info-content" class="ulink" target="_top"><code class="literal">high_info_content</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Packetbeat (Windows and Linux)
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields when not using Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">destination.ip</code>
</li>
<li class="listitem">
<code class="literal">dns.question.registered_domain</code>
</li>
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">dns.question.name</code>
</li>
<li class="listitem">
<code class="literal">event.dataset</code>
</li>
<li class="listitem">
<code class="literal">agent.type</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This job uses the Packetbeat
<a href="/guide/en/beats/packetbeat/7.17/exported-fields-dns.html" class="ulink" target="_top"><code class="literal">dns.question.etld_plus_one</code></a> field,
which is not defined in ECS. Instead, map your network data to the
<a href="/guide/en/ecs/1.12/ecs-dns.html" class="ulink" target="_top"><code class="literal">dns.question.registered_domain</code></a> ECS field.</p>
</div>
</div>
</dd>
<dt>
<span class="term">
packetbeat_rare_dns_question
</span>
</dt>
<dd>
<p>
Searches for rare and unusual DNS queries that indicate network activity with
unusual domains is about to occur. This can be due to initial access,
persistence, command-and-control, or exfiltration activity.
</p>
<p>For example, when a user clicks on a link in a phishing email or opens a
malicious document, a request may be sent to download and run a payload from an
uncommon domain. When malware is already running, it may send requests to an
uncommon DNS domain the malware uses for command-and-control communication.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes network activity logs where <code class="literal">agent.type</code> is <code class="literal">packetbeat</code>.
</li>
<li class="listitem">
Models occurrences of DNS activity.
</li>
<li class="listitem">
Detects DNS activity that is rare compared to other DNS activities (using the
<a href="/guide/en/machine-learning/7.17/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Packetbeat (Windows and Linux)
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields when not using Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">dns.question.name</code>
</li>
<li class="listitem">
<code class="literal">dns.question.type</code>
</li>
<li class="listitem">
<code class="literal">event.dataset</code>
</li>
<li class="listitem">
<code class="literal">agent.type</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
packetbeat_rare_server_domain
</span>
</dt>
<dd>
<p>
Searches for rare and unusual DNS queries that indicate network activity with
unusual domains is about to occur. This can be due to initial access,
persistence, command-and-control, or exfiltration activity.
</p>
<p>For example, when a user clicks on a link in a phishing email or opens a
malicious document, a request may be sent to download and run a payload from an
uncommon HTTP or TLS server. When malware is already running, it may send
requests to an uncommon DNS domain the malware uses for command-and-control
communication.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes network activity logs where <code class="literal">agent.type</code> is <code class="literal">packetbeat</code>.
</li>
<li class="listitem">
Models HTTP or TLS domain activity.
</li>
<li class="listitem">
Detects HTTP or TLS domain activity that is rare compared to other
activities (using the <a href="/guide/en/machine-learning/7.17/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Packetbeat (Windows and Linux)
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields when not using Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">destination.ip</code>
</li>
<li class="listitem">
<code class="literal">source.ip</code>
</li>
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">server.domain</code>
</li>
<li class="listitem">
<code class="literal">agent.type</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
packetbeat_rare_urls
</span>
</dt>
<dd>
<p>
Searches for rare and unusual URLs that indicate unusual
web browsing activity. This can be due to initial access, persistence,
command-and-control, or exfiltration activity.
</p>
<p>For example, in a strategic web compromise or watering hole attack, when a
trusted website is compromised to target a particular sector or organization,
targeted users may receive emails with uncommon URLs for trusted websites. These
URLs can be used to download and run a payload. When malware is already running,
it may send requests to uncommon URLs on trusted websites the malware uses for
command-and-control communication. When rare URLs are observed being requested
for a local web server by a remote source, these can be due to web scanning,
enumeration or attack traffic, or they can be due to bots and web scrapers which
are part of common Internet background traffic.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes network activity logs where <code class="literal">agent.type</code> is <code class="literal">packetbeat</code>.
</li>
<li class="listitem">
Models occurrences of web browsing URL activity.
</li>
<li class="listitem">
Detects URL activity that rarely occurs compared to other URL activities
(using the <a href="/guide/en/machine-learning/7.17/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Packetbeat (Windows and Linux)
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields when not using Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">destination.ip</code>
</li>
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">url.full</code>
</li>
<li class="listitem">
<code class="literal">agent.type</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
packetbeat_rare_user_agent
</span>
</dt>
<dd>
<p>
Searches for rare and unusual user agents that indicate web browsing activity
by an unusual process other than a web browser. This can be due to persistence,
command-and-control, or exfiltration activity. Uncommon user agents coming from
remote sources to local destinations are often the result of scanners, bots,
and web scrapers, which are part of common internet background traffic.
</p>
<p>Much of this is noise, but more targeted attacks on websites using tools like
Burp or SQLmap can sometimes be discovered by spotting uncommon user agents.
Uncommon user agents in traffic from local sources to remote destinations can
be any number of things, including harmless programs like weather monitoring or
stock-trading programs. However, uncommon user agents from local sources can
also be due to malware or scanning activity.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes network activity logs where <code class="literal">agent.type</code> is <code class="literal">packetbeat</code>.
</li>
<li class="listitem">
Models occurrences of HTTP user agent activity.
</li>
<li class="listitem">
Detects HTTP user agent activity that occurs rarely compared to other HTTP
user agent activities (using the <a href="/guide/en/machine-learning/7.17/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Packetbeat (Windows and Linux)
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields when not using Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">destination.ip</code>
</li>
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">event.dataset</code>
</li>
<li class="listitem">
<code class="literal">user_agent.original</code>
</li>
<li class="listitem">
<code class="literal">agent.type</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
</dl>
</div>
<h4><a id="security-windows-jobs"></a>Security: Windows<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/7.17/docs/en/stack/ml/anomaly-detection/ootb-ml-jobs-siem.asciidoc">edit</a></h4>
<p>Detects suspicious activity using ECS Windows events.</p>
<p>In the Machine Learning app, these configurations are available only when data exists
that matches the query specified in the
<a href="https://github.com/elastic/kibana/blob/7.17/x-pack/plugins/ml/server/models/data_recognizer/modules/security_windows/manifest.json#L8" class="ulink" target="_top">manifest file</a>.
In the Elastic Security app, it looks in the index pattern specified in the
<a href="/guide/en/kibana/7.17/advanced-options.html#securitysolution-defaultindex" class="ulink" target="_top"><code class="literal">securitySolution:defaultIndex</code> advanced setting</a>
for data that matches the query.</p>
<p>If there are additional requirements such as installing the Windows System
Monitor (Sysmon) or auditing process creation in the Windows security event log,
they are listed for each job.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>In 7.11 or later versions, use these jobs instead of the
<a class="xref" href="ootb-ml-jobs-siem.html#security-winlogbeat-jobs" title="Security: Winlogbeat">Security: Winlogbeat</a> jobs.<sup class="footnote" id="_footnote_duplicatewindowsjobs">[<a id="_footnoteref_3" class="footnote" href="#_footnotedef_3" title="View footnote.">3</a>]</sup></p>
</div>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
v2_rare_process_by_host_windows_ecs
</span>
</dt>
<dd>
<p>
Detects unusually rare processes on Windows hosts, which can indicate execution
of unauthorized services, malware, or persistence mechanisms.
</p>
<p>Processes are considered rare when they only run occasionally as compared with
other processes running on the host.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Models occurrences of process activities on the host.
</li>
<li class="listitem">
Detects unusually rare processes compared to other processes on the host
(using the
<a href="/guide/en/machine-learning/7.17/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
<li class="listitem">
Works on ECS compatible events across multiple indices.
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic Endpoint integration
</li>
<li class="listitem">
<p>Winlogbeat, colecting data from the Windows System Monitor (Sysmon) or the
Windows security event log</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>If you collect data from the Windows security event log and you configure
it to audit process creation, this job can analyze the 4688 events that occur
every time a new process starts.<sup class="footnote" id="_footnote_auditing">[<a id="_footnoteref_4" class="footnote" href="#_footnotedef_4" title="View footnote.">4</a>]</sup></p>
</div>
</div>
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">event.category</code>
</li>
<li class="listitem">
<code class="literal">event.type</code>
</li>
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">host.os.family</code>
</li>
<li class="listitem">
<code class="literal">host.os.type</code>
</li>
<li class="listitem">
<code class="literal">process.name</code>
</li>
<li class="listitem">
<code class="literal">user.name</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
v2_windows_anomalous_network_activity_ecs
</span>
</dt>
<dd>
<p>
Looks for unusual processes using the network which could indicate command-and-
control, lateral movement, persistence, or data exfiltration activity.
</p>
<p>A process with unusual network activity can denote process exploitation or
injection, where the process is used to run persistence mechanisms that allow a
malicious actor remote access or control of the host, data exfiltration, and
execution of unauthorized network applications.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Models the occurrences of processes that cause network activity.
</li>
<li class="listitem">
Detects network activity caused by processes that occur rarely compared to
other processes (using the
<a href="/guide/en/machine-learning/7.17/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
<li class="listitem">
Works on ECS compatible events across multiple indices.
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic Endpoint integration
</li>
<li class="listitem">
Winlogbeat, collecting data from Windows System Monitor (Sysmon)
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">destination.ip</code>
</li>
<li class="listitem">
<code class="literal">event.category</code>
</li>
<li class="listitem">
<code class="literal">event.type</code>
</li>
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">host.os.family</code>
</li>
<li class="listitem">
<code class="literal">host.os.type</code>
</li>
<li class="listitem">
<code class="literal">process.name</code>
</li>
<li class="listitem">
<code class="literal">user.name</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
v2_windows_anomalous_path_activity_ecs
</span>
</dt>
<dd>
<p>
Looks for activity in unusual paths, which might indicate execution of malware
or persistence mechanisms.
</p>
<p>Windows payloads often execute from user profile paths. In corporate Windows
environments, software installation is centrally managed and it is unusual for
programs to be executed from user or temporary directories. Processes executed
from these locations can denote that a user downloaded software directly from
the internet or a malicious script/macro executed malware.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Models occurrences of processes in paths.
</li>
<li class="listitem">
Detects activity in unusual paths (using the
<a href="/guide/en/machine-learning/7.17/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
<li class="listitem">
Works on ECS compatible events across multiple indices.
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Winlogbeat, collecting data from the Windows System Monitor (Sysmon)
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">event.category</code>
</li>
<li class="listitem">
<code class="literal">event.type</code>
</li>
<li class="listitem">
<code class="literal">host.os.family</code>
</li>
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">host.os.type</code>
</li>
<li class="listitem">
<code class="literal">process.name</code>
</li>
<li class="listitem">
<code class="literal">process.working_directory</code>
</li>
<li class="listitem">
<code class="literal">user.name</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
v2_windows_anomalous_process_all_hosts_ecs
</span>
</dt>
<dd>
<p>
Looks for processes that are unusual to all Windows hosts. Such unusual
processes may indicate execution of unauthorized services, malware, or
persistence mechanisms.
</p>
<p>This reduces the detection of false positives since automated maintenance
processes usually only run occasionally on a single machine but are common to
all or many hosts in a fleet.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Models the occurrences of processes on all hosts.
</li>
<li class="listitem">
Detects processes that occur rarely compared to other processes on all hosts
(using the <a href="/guide/en/machine-learning/7.17/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
<li class="listitem">
Works on ECS compatible events across multiple indices.
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic Endpoint integration
</li>
<li class="listitem">
<p>Winlogbeat, colecting data from the Windows System Monitor (Sysmon) or from the Windows security event log with process creation auditing enabled.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>If you collect data from the Windows security event log and you configure
it to audit process creation, this job can analyze the 4688 events that occur
every time a new process starts.<sup class="footnoteref">[<a class="footnote" href="#_footnotedef_4" title="View footnote.">4</a>]</sup></p>
</div>
</div>
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">event.category</code>
</li>
<li class="listitem">
<code class="literal">event.type</code>
</li>
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">host.os.family</code>
</li>
<li class="listitem">
<code class="literal">process.executable</code>
</li>
<li class="listitem">
<code class="literal">process.name</code>
</li>
<li class="listitem">
<code class="literal">user.name</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
v2_windows_anomalous_process_creation
</span>
</dt>
<dd>
<p>
Identifies unusual process relationships that can indicate malware execution or
persistence mechanisms.
</p>
<p>Malicious scripts often call on other applications and processes as part of
their exploit payload. For example, when a malicious Office document runs
scripts as part of an exploit payload, Excel or Word may start a script
interpreter process, which, in turn, runs a script that downloads and executes
malware. Another common scenario is Outlook running an unusual process when
malware is downloaded in an email.</p>
<p>Monitoring and identifying anomalous process relationships is an excellent way
of detecting new and emerging malware that is not yet recognized by anti-virus
scanners.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Models occurrences of process creation activities (<code class="literal">partition_field_name</code> is
<code class="literal">process.parent.name</code>).
</li>
<li class="listitem">
Detects process relationships that are rare compared to other process
relationships (using the
<a href="/guide/en/machine-learning/7.17/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
<li class="listitem">
Works on ECS compatible events across multiple indices.
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic Endpoint integration
</li>
<li class="listitem">
<p>Winlogbeat, collecting data from the Windows System Monitor (Sysmon) or the
Windows security event log</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>If you collect data from the Windows security event log and you configure
it to audit process creation, this job can analyze the 4688 events that occur
every time a new process starts.<sup class="footnoteref">[<a class="footnote" href="#_footnotedef_4" title="View footnote.">4</a>]</sup></p>
</div>
</div>
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">event.category</code>
</li>
<li class="listitem">
<code class="literal">event.type</code>
</li>
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">host.os.family</code>
</li>
<li class="listitem">
<code class="literal">host.os.type</code>
</li>
<li class="listitem">
<code class="literal">process.name</code>
</li>
<li class="listitem">
<code class="literal">process.parent.name</code>
</li>
<li class="listitem">
<code class="literal">user.name</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
v2_windows_anomalous_user_name_ecs
</span>
</dt>
<dd>
<p>
Searches for activity from users who are not normally active, which can
indicate unauthorized changes, activity by unauthorized users, lateral
movement, and compromised credentials.
</p>
<p>In organizations, new usernames are not often created apart from specific types
of system activities, such as creating new accounts for new employees. These
user accounts quickly become active and routine.</p>
<p>Events from rarely used usernames can point to suspicious activity.
Additionally, automated Linux fleets tend to see activity from rarely used
usernames only when personnel log in to make authorized or unauthorized
changes, or threat actors have acquired credentials and log in for malicious
purposes. Unusual usernames can also indicate pivoting, where compromised
credentials are used to try and move laterally from one host to another.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Models user activity.
</li>
<li class="listitem">
Detects users that are rarely or unusually active compared to other users
(using the <a href="/guide/en/machine-learning/7.17/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
<li class="listitem">
Works on ECS compatible events across multiple indices
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic Endpoint integration
</li>
<li class="listitem">
<p>Winlogbeat, collecting data from the Windows System Monitor (Sysmon) or the
Windows security event log</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>If you collect data from the Windows security event log and you configure
it to audit process creation, this job can analyze the 4688 events that occur
every time a new process starts.<sup class="footnoteref">[<a class="footnote" href="#_footnotedef_4" title="View footnote.">4</a>]</sup></p>
</div>
</div>
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">event.category</code>
</li>
<li class="listitem">
<code class="literal">event.type</code>
</li>
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">host.os.family</code>
</li>
<li class="listitem">
<code class="literal">host.os.type</code>
</li>
<li class="listitem">
<code class="literal">process.name</code>
</li>
<li class="listitem">
<code class="literal">user.name</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
v2_windows_rare_metadata_process
</span>
</dt>
<dd>
<p>
Looks for anomalous access to the metadata service by an unusual process. The
metadata service may be targeted in order to harvest credentials or user data
scripts containing secrets.
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes host activity logs where <code class="literal">destination.ip</code> is the metadata service.
</li>
<li class="listitem">
Models process activity.
</li>
<li class="listitem">
Detects processes that are rarely or unusually active compared to other
processes (using the
<a href="/guide/en/machine-learning/7.17/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
<li class="listitem">
Works on ECS compatible events across multiple indices.
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic Endpoint integration
</li>
<li class="listitem">
Winlogbeat, collecting data from the Windows System Monitor (Sysmon)
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">destination.ip</code>
</li>
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">host.os.family</code>
</li>
<li class="listitem">
<code class="literal">process.name</code>
</li>
<li class="listitem">
<code class="literal">user.name</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
v2_windows_rare_metadata_user
</span>
</dt>
<dd>
<p>
Looks for anomalous access to the metadata service by an unusual user. The
metadata service may be targeted in order to harvest credentials or user data
scripts containing secrets.
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes host activity logs where <code class="literal">destination.ip</code> is the metadata service.
</li>
<li class="listitem">
Models user activity.
</li>
<li class="listitem">
Detects users that are rarely or unusually active compared to other users
(using the <a href="/guide/en/machine-learning/7.17/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic Endpoint integration
</li>
<li class="listitem">
Winlogbeat, collecting data from the Windows System Monitor (Sysmon)
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">destination.ip</code>
</li>
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">host.os.family</code>
</li>
<li class="listitem">
<code class="literal">user.name</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
</dl>
</div>
<h4><a id="security-winlogbeat-jobs"></a>Security: Winlogbeat<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/7.17/docs/en/stack/ml/anomaly-detection/ootb-ml-jobs-siem.asciidoc">edit</a></h4>
<p>Detect unusual processes and network activity in Winlogbeat data.</p>
<p>In the Machine Learning app, these configurations are available only when data exists
that matches the query specified in the
<a href="https://github.com/elastic/kibana/blob/7.17/x-pack/plugins/ml/server/models/data_recognizer/modules/siem_winlogbeat/manifest.json#L8" class="ulink" target="_top">manifest file</a>.
In the Elastic Security app, it looks in the index pattern specified in the
<a href="/guide/en/kibana/7.17/advanced-options.html#securitysolution-defaultindex" class="ulink" target="_top"><code class="literal">securitySolution:defaultIndex</code> advanced setting</a>
for data that matches the query.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>In 7.11 or later versions, use the <a class="xref" href="ootb-ml-jobs-siem.html#security-windows-jobs" title="Security: Windows">Security: Windows</a> jobs instead.<sup class="footnoteref">[<a class="footnote" href="#_footnotedef_3" title="View footnote.">3</a>]</sup></p>
</div>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
rare_process_by_host_windows_ecs
</span>
</dt>
<dd>
<p>
Identifies rare processes that do not usually run on individual hosts, which
can indicate execution of unauthorized services, malware, or persistence
mechanisms.
</p>
<p>Processes are considered rare when they only run occasionally as compared with
other processes running on the host.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes host activity logs where <code class="literal">agent.type</code> is <code class="literal">winlogbeat</code>.
</li>
<li class="listitem">
Models occurrences of process activities on the host.
</li>
<li class="listitem">
Detects unusually rare processes compared to other processes on the host (using the <a href="/guide/en/machine-learning/7.17/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Winlogbeat
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields when not using Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">process.name</code>
</li>
<li class="listitem">
<code class="literal">user.name</code>
</li>
<li class="listitem">
<code class="literal">event.action</code>
</li>
<li class="listitem">
<code class="literal">agent.type</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
windows_anomalous_network_activity_ecs
</span>
</dt>
<dd>
<p>
Identifies OS processes that do not usually use the network but have
unexpected network activity, which can indicate command-and-control, lateral
movement, persistence, or data exfiltration activity.
</p>
<p>A process with unusual network activity can denote process exploitation or
injection, where the process is used to run persistence mechanisms that allow a
malicious actor remote access or control of the host, data exfiltration, and
execution of unauthorized network applications.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes network activity logs where <code class="literal">agent.type</code> is <code class="literal">winlogbeat</code>.
</li>
<li class="listitem">
Models the occurrences of processes that cause network activity.
</li>
<li class="listitem">
Detects network activity caused by processes that occur rarely compared to
other processes (using the <a href="/guide/en/machine-learning/7.17/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Winlogbeat
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields when not using Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">destination.ip</code>
</li>
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">process.name</code>
</li>
<li class="listitem">
<code class="literal">user.name</code>
</li>
<li class="listitem">
<code class="literal">event.action</code>
</li>
<li class="listitem">
<code class="literal">agent.type</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
windows_anomalous_path_activity_ecs
</span>
</dt>
<dd>
<p>
Identifies processes started from atypical folders in the file system, which
might indicate malware execution or persistence mechanisms.
</p>
<p>In corporate Windows environments, software installation is centrally managed
and it is unusual for programs to be executed from user or temporary
directories. Processes executed from these locations can denote that a user
downloaded software directly from the internet or a malicious script/macro
executed malware.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes host activity logs where <code class="literal">agent.type</code> is <code class="literal">winlogbeat</code>.
</li>
<li class="listitem">
Models occurrences of processes in paths.
</li>
<li class="listitem">
Detects activity in unusual paths (using the <a href="/guide/en/machine-learning/7.17/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Winlogbeat (Windows)
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields when not using Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">process.name</code>
</li>
<li class="listitem">
<code class="literal">user.name</code>
</li>
<li class="listitem">
<code class="literal">process.working_directory</code>
</li>
<li class="listitem">
<code class="literal">event.action</code>
</li>
<li class="listitem">
<code class="literal">agent.type</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
windows_anomalous_process_all_hosts_ecs
</span>
</dt>
<dd>
<p>
Searches for rare processes running on multiple hosts in an entire fleet or
network.
</p>
<p>This reduces the detection of false positives since automated maintenance
processes usually only run occasionally on a single machine but are common to
all or many hosts in a fleet.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes host activity logs where <code class="literal">agent.type</code> is <code class="literal">winlogbeat</code> (Windows).
</li>
<li class="listitem">
Models the occurrences of processes on all hosts.
</li>
<li class="listitem">
Detects processes that occur rarely compared to other processes on all
hosts (using the <a href="/guide/en/machine-learning/7.17/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Winlogbeat
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields when not using Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">process.name</code>
</li>
<li class="listitem">
<code class="literal">user.name</code>
</li>
<li class="listitem">
<code class="literal">process.executable</code>
</li>
<li class="listitem">
<code class="literal">event.action</code>
</li>
<li class="listitem">
<code class="literal">agent.type</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
windows_anomalous_process_creation
</span>
</dt>
<dd>
<p>
Identifies unusual parent-child process relationships that can indicate
malware execution or persistence mechanisms.
</p>
<p>Malicious scripts often call on other applications and processes as part of
their exploit payload. For example, when a malicious Office document runs
scripts as part of an exploit payload, Excel or Word may start a script
interpreter process, which, in turn, runs a script that downloads and executes
malware. Another common scenario is Outlook running an unusual process when
malware is downloaded in an email.</p>
<p>Monitoring and identifying anomalous process relationships is an excellent way
of detecting new and emerging malware that is not yet recognized by anti-virus
scanners.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes host activity logs where <code class="literal">agent.type</code> is <code class="literal">winlogbeat</code>.
</li>
<li class="listitem">
Models occurrences of process creation activities (<code class="literal">partition_field_name</code> is
<code class="literal">process.parent.name</code>).
</li>
<li class="listitem">
Detects process relationships that are rare compared to other process
relationships (using the <a href="/guide/en/machine-learning/7.17/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Winlogbeat (Windows)
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields when not using Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">process.name</code>
</li>
<li class="listitem">
<code class="literal">user.name</code>
</li>
<li class="listitem">
<code class="literal">process.parent.name</code>
</li>
<li class="listitem">
<code class="literal">event.action</code>
</li>
<li class="listitem">
<code class="literal">agent.type</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
windows_anomalous_script
</span>
</dt>
<dd>
<p>
Searches for PowerShell scripts with unusual data characteristics, such as
obfuscation, that may be a characteristic of malicious PowerShell script text
blocks.
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes host activity logs where <code class="literal">agent.type</code> is <code class="literal">winlogbeat</code>.
</li>
<li class="listitem">
Models occurrences of PowerShell script activities.
</li>
<li class="listitem">
Detects unusual PowerShell script execution compared to other PowerShell
script activities (using the
<a href="/guide/en/machine-learning/7.17/ml-info-functions.html#ml-info-content" class="ulink" target="_top"><code class="literal">high_info_content</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Winlogbeat (Windows)
</li>
</ul>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This job is available only when you use Winlogbeat to ship data.<sup class="footnoteref">[<a class="footnote" href="#_footnotedef_2" title="View footnote.">2</a>]</sup></p>
</div>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
windows_anomalous_service
</span>
</dt>
<dd>
<p>
Searches for unusual Windows services that can indicate execution of
unauthorized services, malware, or persistence mechanisms.
</p>
<p>In corporate Windows environments, hosts do not generally run many rare or
unique services. This job helps detect malware and persistence mechanisms that
have been installed and run as a service.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes host activity logs where <code class="literal">agent.type</code> is <code class="literal">winlogbeat</code>.
</li>
<li class="listitem">
Models occurrences of Windows service activities.
</li>
<li class="listitem">
Detects Windows service activities that occur rarely compared to other Windows service activities (using the <a href="/guide/en/machine-learning/7.17/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Winlogbeat (Windows)
</li>
</ul>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This job is available only when you use Winlogbeat to ship data.<sup class="footnoteref">[<a class="footnote" href="#_footnotedef_2" title="View footnote.">2</a>]</sup></p>
</div>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
windows_anomalous_user_name_ecs
</span>
</dt>
<dd>
<p>
Searches for activity from users who are not normally active, which can
indicate unauthorized changes, activity by unauthorized users, lateral
movement, and compromised credentials.
</p>
<p>In organizations, new usernames are not often created apart from specific types
of system activities, such as creating new accounts for new employees. These
user accounts quickly become active and routine.</p>
<p>Events from rarely used usernames can point to suspicious activity.
Additionally, automated Linux fleets tend to see activity from rarely used
usernames only when personnel log in to make authorized or unauthorized
changes, or threat actors have acquired credentials and log in for malicious
purposes. Unusual usernames can also indicate pivoting, where compromised
credentials are used to try and move laterally from one host to another.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes host activity logs where <code class="literal">agent.type</code> is <code class="literal">winlogbeat</code> (Windows).
</li>
<li class="listitem">
Models user activity.
</li>
<li class="listitem">
Detects users that are rarely or unusually active compared to other users
(using the <a href="/guide/en/machine-learning/7.17/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Winlogbeat
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields when not using Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">process.name</code>
</li>
<li class="listitem">
<code class="literal">user.name</code>
</li>
<li class="listitem">
<code class="literal">event.action</code>
</li>
<li class="listitem">
<code class="literal">agent.type</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
windows_rare_metadata_process
</span>
</dt>
<dd>
<p>
Looks for anomalous access to the metadata service by an unusual process. The
metadata service may be targeted in order to harvest credentials or user data
scripts containing secrets.
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes host activity logs where <code class="literal">agent.type</code> is <code class="literal">winlogbeat</code> (Windows) and
<code class="literal">destination.ip</code> is the metadata service.
</li>
<li class="listitem">
Models process activity.
</li>
<li class="listitem">
Detects processes that are rarely or unusually active compared to other processes
(using the <a href="/guide/en/machine-learning/7.17/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Winlogbeat (Windows)
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields when not using Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">process.name</code>
</li>
<li class="listitem">
<code class="literal">user.name</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
windows_rare_metadata_user
</span>
</dt>
<dd>
<p>
Looks for anomalous access to the metadata service by an unusual user. The
metadata service may be targeted in order to harvest credentials or user data
scripts containing secrets.
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes host activity logs where <code class="literal">agent.type</code> is <code class="literal">winlogbeat</code> (Windows) and
<code class="literal">destination.ip</code> is the metadata service.
</li>
<li class="listitem">
Models user activity.
</li>
<li class="listitem">
Detects users that are rarely or unusually active compared to other users
(using the <a href="/guide/en/machine-learning/7.17/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Winlogbeat (Windows)
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields when not using Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">user.name</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
<dt>
<span class="term">
windows_rare_user_runas_event
</span>
</dt>
<dd>
<p>
Searches for unusual user context switches using the <code class="literal">runas</code> command or similar
techniques, which can indicate account takeover or privilege escalation using
compromised accounts. Privilege elevation using tools like <code class="literal">runas</code> is more
common for domain and network administrators than professionals who are not
members of the technology department.
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes host activity logs where <code class="literal">agent.type</code> is <code class="literal">winlogbeat</code>.
</li>
<li class="listitem">
Models occurrences of user context switches.
</li>
<li class="listitem">
Detects user context switches that occur rarely compared to other user context switches (using the <a href="/guide/en/machine-learning/7.17/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Winlogbeat (Windows)
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required ECS fields when not using Beats
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">process.name</code>
</li>
<li class="listitem">
<code class="literal">host.name</code>
</li>
<li class="listitem">
<code class="literal">user.name</code>
</li>
<li class="listitem">
<code class="literal">event.code</code>
</li>
<li class="listitem">
<code class="literal">agent.type</code>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</dd>
</dl>
</div>
<h4><a id="security-winlogbeat-authentication-jobs"></a>Security: Winlogbeat authentication<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/7.17/docs/en/stack/ml/anomaly-detection/ootb-ml-jobs-siem.asciidoc">edit</a></h4>
<p>Detect suspicious authentication events in Winlogbeat data.</p>
<p>In the Machine Learning app, these configurations are available only when data exists
that matches the query specified in the
<a href="https://github.com/elastic/kibana/blob/7.17/x-pack/plugins/ml/server/models/data_recognizer/modules/siem_winlogbeat_auth/manifest.json#L8" class="ulink" target="_top">manifest file</a>.
In the Elastic Security app, it looks in the index pattern specified in the
<a href="/guide/en/kibana/7.17/advanced-options.html#securitysolution-defaultindex" class="ulink" target="_top"><code class="literal">securitySolution:defaultIndex</code> advanced setting</a>
for data that matches the query.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
windows_rare_user_type10_remote_login
</span>
</dt>
<dd>
<p>
Searches for unusual remote desktop protocol (RDP) logins, which can indicate
account takeover or credentialed persistence using compromised accounts. RDP
attacks, such as BlueKeep, also tend to use unusual usernames.
</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Job details
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyzes host activity logs where <code class="literal">agent.type</code> is <code class="literal">winlogbeat</code>.
</li>
<li class="listitem">
Models occurrences of user remote login activities.
</li>
<li class="listitem">
Detects user remote login activities that occur rarely compared to other
user remote login activities (using the <a href="/guide/en/machine-learning/7.17/ml-rare-functions.html#ml-rare" class="ulink" target="_top"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Required Beats or Elastic Agent integrations
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Winlogbeat (Windows)
</li>
</ul>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This job is available only when you use Winlogbeat to ship data.<sup class="footnoteref">[<a class="footnote" href="#_footnotedef_2" title="View footnote.">2</a>]</sup></p>
</div>
</div>
</dd>
</dl>
</div>
</dd>
</dl>
</div>
</div>
<div id="footnotes">
<div class="footnote" id="_footnotedef_1">
<sup>[<a href="#_footnoteref_1">1</a>]</sup> If you cannot upgrade all your Beats to version 7.11 or later and you have both <a class="xref" href="ootb-ml-jobs-siem.html#security-linux-jobs" title="Security: Linux">Security: Linux</a> and <a class="xref" href="ootb-ml-jobs-siem.html#security-auditbeat-jobs" title="Security: Auditbeat">Security: Auditbeat</a> jobs running, you can avoid duplication by stopping the following jobs: <code class="literal">linux_anomalous_network_activity_ecs</code>, <code class="literal">linux_anomalous_network_port_activity_ecs</code>, <code class="literal">linux_anomalous_process_all_hosts_ecs</code>, <code class="literal">linux_anomalous_user_name_ecs</code>, <code class="literal">linux_rare_metadata_process</code>, <code class="literal">linux_rare_metadata_user</code>, <code class="literal">rare_process_by_host_linux_ecs</code>.
</div>
<div class="footnote" id="_footnotedef_2">
<sup>[<a href="#_footnoteref_2">2</a>]</sup> Some jobs use fields that are not ECS-compliant. These jobs are available only when you use Beats or the Elastic Agent to ship data.
</div>
<div class="footnote" id="_footnotedef_3">
<sup>[<a href="#_footnoteref_3">3</a>]</sup> If you cannot upgrade all your Beats to version 7.11 or later and you have both <a class="xref" href="ootb-ml-jobs-siem.html#security-windows-jobs" title="Security: Windows">Security:Windows jobs</a> and <a class="xref" href="ootb-ml-jobs-siem.html#security-winlogbeat-jobs" title="Security: Winlogbeat">Security:Winlogbeat jobs</a> running, you can avoid duplication by stopping the following jobs: <code class="literal">rare_process_by_host_windows_ecs</code>, <code class="literal">windows_anomalous_network_activity_ecs</code>, <code class="literal">windows_anomalous_path_activity_ecs</code>, <code class="literal">windows_anomalous_process_all_hosts_ecs</code>, <code class="literal">windows_anomalous_process_creation</code>, <code class="literal">windows_anomalous_user_name_ecs</code>, <code class="literal">windows_rare_metadata_process</code>, <code class="literal">windows_rare_metadata_user</code>
</div>
<div class="footnote" id="_footnotedef_4">
<sup>[<a href="#_footnoteref_4">4</a>]</sup> The Windows security 4688 events have <code class="literal">event.category: process</code>, <code class="literal">event.type: start</code>, and <code class="literal">event.provider: Microsoft-Windows-Security-Auditing</code>. The following jobs can use these events: <code class="literal">v2_rare_process_by_host_windows_ecs</code>, <code class="literal">v2_windows_anomalous_user_name_ecs</code>, <code class="literal">v2_windows_anomalous_process_all_hosts_ecs</code>, and <code class="literal">v2_windows_anomalous_process_creation</code>. The Windows security event log cannot be used as a data source for jobs that pertain to network events since it does not contain that type of information. Network events can be collected by the Elastic Endpoint integration, by Winlogbeat from the Windows System Monitor, or by another ECS-compatible Windows agent.
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="ootb-ml-jobs-nginx.html">« Nginx anomaly detection configurations</a>
</span>
<span class="next">
<a href="ootb-ml-jobs-uptime.html">Uptime anomaly detection configurations »</a>
</span>
</div>
</div>
</body>
</html>
