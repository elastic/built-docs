<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>SIEM | Machine Learning in the Elastic Stack [7.5] | Elastic</title>
<link rel="home" href="index.html" title="Machine Learning in the Elastic Stack [7.5]"/>
<link rel="up" href="ootb-ml-jobs.html" title="Supplied anomaly detection configurations"/>
<link rel="prev" href="ootb-ml-jobs-nginx.html" title="Nginx"/>
<link rel="next" href="ml-functions.html" title="Function reference"/>
<meta name="DC.type" content="Learn/Docs/Elastic Stack/Machine learning/7.5"/>
<meta name="DC.subject" content="Machine learning"/>
<meta name="DC.identifier" content="7.5"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body><div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Machine Learning in the Elastic Stack [7.5]</a></span>
»
<span class="breadcrumb-link"><a href="xpack-ml.html">Anomaly detection</a></span>
»
<span class="breadcrumb-link"><a href="ootb-ml-jobs.html">Supplied anomaly detection configurations</a></span>
»
<span class="breadcrumb-node">SIEM</span>
</div>
<div class="navheader">
<span class="prev">
<a href="ootb-ml-jobs-nginx.html">« Nginx</a>
</span>
<span class="next">
<a href="ml-functions.html">Function reference »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="ootb-ml-jobs-siem"></a>SIEM<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/stack-docs/edit/7.5/docs/en/stack/ml/anomaly-detection/ootb-ml-jobs.asciidoc">edit</a></h2>
</div></div></div>
<p>These anomaly detection jobs appear by default in the Anomaly Detection interface of the
<a href="/guide/en/siem/guide/7.5/machine-learning.html" class="ulink" target="_top">SIEM app</a> in Kibana. They help you
automatically detect file system and network anomalies on your hosts. The list
below contains the jobs organized by <code class="literal">agent.type</code> (Auditbeat, Packetbeat, and
Winlogbeat).</p>
<h4><a id="ootb-ml-jobs-siem-audit"></a>SIEM - Auditbeat<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/stack-docs/edit/7.5/docs/en/stack/ml/anomaly-detection/ootb-ml-jobs.asciidoc">edit</a></h4>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
linux_anomalous_network_activity_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For network activity logs where <code class="literal">agent.type</code> is <code class="literal">auditbeat</code>.
</li>
<li class="listitem">
Models the occurrences of processes that cause network activity.
</li>
<li class="listitem">
Detects network activity caused by processes that occur rarely compared to
other processes (using the <a class="xref" href="ml-rare-functions.html#ml-rare" title="Rare"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<p>Looks for unusual processes using the network which could indicate
command-and-control, lateral movement, persistence, or data exfiltration
activity.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
linux_anomalous_network_port_activity_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For network activity logs where <code class="literal">agent.type</code> is <code class="literal">auditbeat</code>.
</li>
<li class="listitem">
Models destination port activity.
</li>
<li class="listitem">
Detects destination port activity that occurs rarely compared to other port
activities (using the <a class="xref" href="ml-rare-functions.html#ml-rare" title="Rare"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<p>Looks for unusual destination port activity that could indicate
command-and-control, persistence mechanism, or data exfiltration activity.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
linux_anomalous_network_service
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For network activity logs where <code class="literal">agent.type</code> is <code class="literal">auditbeat</code>.
</li>
<li class="listitem">
Models listening port activity.
</li>
<li class="listitem">
Detects unusual listening port activity that occurs rarely compared to
other port activities (using the <a class="xref" href="ml-rare-functions.html#ml-rare" title="Rare"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<p>Looks for unusual listening ports that could indicate execution of unauthorized
services, backdoors, or persistence mechanisms.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
linux_anomalous_network_url_activity_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For network activity logs where <code class="literal">agent.type</code> is <code class="literal">auditbeat</code>.
</li>
<li class="listitem">
Models the occurrences of URL requests.
</li>
<li class="listitem">
Detects unusual web URL request that is rare compared to other web URL
requests (using the <a class="xref" href="ml-rare-functions.html#ml-rare" title="Rare"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<p>Looks for an unusual web URL request from a Linux instance. Curl and wget web
request activity is very common but unusual web requests from a Linux server can
sometimes be malware delivery or execution.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
linux_anomalous_process_all_hosts_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For host activity logs where <code class="literal">agent.type</code> is <code class="literal">auditbeat</code>.
</li>
<li class="listitem">
Models the occurrences of processes on all hosts.
</li>
<li class="listitem">
Detects processes that occur rarely compared to other processes to all
Linux/Windows hosts (using the <a class="xref" href="ml-rare-functions.html#ml-rare" title="Rare"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<p>Looks for processes that are unusual to all Linux hosts. Such unusual processes
may indicate unauthorized services, malware, or persistence mechanisms.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
linux_anomalous_user_name_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For host activity logs where <code class="literal">agent.type</code> is <code class="literal">auditbeat</code>.
</li>
<li class="listitem">
Models user activity.
</li>
<li class="listitem">
Detects users that are rarely or unusually active compared to other users
(using the <a class="xref" href="ml-rare-functions.html#ml-rare" title="Rare"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<p>Rare and unusual users that are not normally active may indicate unauthorized
changes or activity by an unauthorized user which may be credentialed access or
lateral movement.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
rare_process_by_host_linux_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For host activity logs where <code class="literal">agent.type</code> is <code class="literal">auditbeat</code>.
</li>
<li class="listitem">
Models occurrences of process activities on the host.
</li>
<li class="listitem">
Detect unusually rare processes compared to other processes on Linux (using
the <a class="xref" href="ml-rare-functions.html#ml-rare" title="Rare"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
suspicious_login_activity_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For host activity logs where <code class="literal">agent.type</code> is <code class="literal">auditbeat</code>.
</li>
<li class="listitem">
Models occurrences of authentication attempts (<code class="literal">partition_field_name</code> is
<code class="literal">host.name</code>).
</li>
<li class="listitem">
Detects unusually high number of authentication attempts (using the
<a class="xref" href="ml-count-functions.html#ml-nonzero-count" title="Non_zero_count, high_non_zero_count, low_non_zero_count"><code class="literal">high_non_zero_count</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<h4><a id="ootb-ml-jobs-siem-packet"></a>SIEM - Packetbeat<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/stack-docs/edit/7.5/docs/en/stack/ml/anomaly-detection/ootb-ml-jobs.asciidoc">edit</a></h4>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
packetbeat_dns_tunneling
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For network activity logs where <code class="literal">agent.type</code> is <code class="literal">packetbeat</code>.
</li>
<li class="listitem">
Models occurrances of DNS activity.
</li>
<li class="listitem">
Detects unusual DNS activity (using the
<a class="xref" href="ml-info-functions.html#ml-info-content" title="Info_content, High_info_content, Low_info_content"><code class="literal">high_info_content</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<p>Looks for unusual DNS activity that could indicate command-and-control or data
exfiltration activity.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
packetbeat_rare_dns_question
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For network activity logs where <code class="literal">agent.type</code> is <code class="literal">packetbeat</code>.
</li>
<li class="listitem">
Models occurrences of DNS activity.
</li>
<li class="listitem">
Detects DNS activity that is rare compared to other DNS activities (using the
<a class="xref" href="ml-rare-functions.html#ml-rare" title="Rare"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<p>Looks for unusual DNS activity that could indicate command-and-control activity.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
packetbeat_rare_server_domain
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For network activity logs where <code class="literal">agent.type</code> is <code class="literal">packetbeat</code>.
</li>
<li class="listitem">
Models HTTP or TLS domain activity.
</li>
<li class="listitem">
Detects HTTP or TLS domain activity that is rarely occurs compared to other
activities (using the <a class="xref" href="ml-rare-functions.html#ml-rare" title="Rare"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<p>Looks for unusual HTTP or TLS destination domain activity that could indicate
execution, persistence, command-and-control or data exfiltration activity.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
packetbeat_rare_urls
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For network activity logs where <code class="literal">agent.type</code> is <code class="literal">packetbeat</code>.
</li>
<li class="listitem">
Models occurrences of web browsing URL activity.
</li>
<li class="listitem">
Detects URL activity that rarely occurs compared to other URL activities
(using the <a class="xref" href="ml-rare-functions.html#ml-rare" title="Rare"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<p>Looks for unusual web browsing URL activity that could indicate execution,
persistence, command-and-control or data exfiltration activity.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
packetbeat_rare_user_agent
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For network activity logs where <code class="literal">agent.type</code> is <code class="literal">packetbeat</code>.
</li>
<li class="listitem">
Models occurrences of HTTP user agent activity.
</li>
<li class="listitem">
Detects HTTP user agent activity that occurs rarely compared to other HTTP
user agent activities (using the <a class="xref" href="ml-rare-functions.html#ml-rare" title="Rare"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<p>Looks for unusual HTTP user agent activity that could indicate execution,
persistence, command-and-control or data exfiltration activity.</p>
<h4><a id="ootb-ml-jobs-siem-winlog"></a>SIEM - Winlogbeat<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/stack-docs/edit/7.5/docs/en/stack/ml/anomaly-detection/ootb-ml-jobs.asciidoc">edit</a></h4>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
windows_anomalous_network_activity_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For network activity logs where <code class="literal">agent.type</code> is <code class="literal">winlogbeat</code>.
</li>
<li class="listitem">
Models the occurrences of processes that cause network activity.
</li>
<li class="listitem">
Detects network activity caused by processes that occur rarely compared to
other processes (using the <a class="xref" href="ml-rare-functions.html#ml-rare" title="Rare"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<p>Looks for unusual processes using the network which could indicate
command-and-control, lateral movement, persistence, or data exfiltration
activity.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
windows_anomalous_process_all_hosts_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For host activity logs where <code class="literal">agent.type</code> is <code class="literal">winlogbeat</code>.
</li>
<li class="listitem">
Models the occurrences of processes on all hosts.
</li>
<li class="listitem">
Detects processes that occur rarely compared to other processes to all
Linux/Windows hosts (using the <a class="xref" href="ml-rare-functions.html#ml-rare" title="Rare"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<p>Looks for processes that are unusual to all Windows hosts. Such unusual
processes may indicate unauthorized services, malware, or persistence
mechanisms.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
windows_anomalous_user_name_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For host activity logs where <code class="literal">agent.type</code> is <code class="literal">winlogbeat</code>.
</li>
<li class="listitem">
Models user activity.
</li>
<li class="listitem">
Detects users that are rarely or unusually active compared to other users
(using the <a class="xref" href="ml-rare-functions.html#ml-rare" title="Rare"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<p>Rare and unusual users that are not normally active may indicate unauthorized
changes or activity by an unauthorized user which may be credentialed access or
lateral movement.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
rare_process_by_host_windows_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For host activity logs where <code class="literal">agent.type</code> is <code class="literal">winlogbeat</code>.
</li>
<li class="listitem">
Models occurrences of process activities on the host.
</li>
<li class="listitem">
Detect unusually rare processes compared to other processes on Windows (using
the <a class="xref" href="ml-rare-functions.html#ml-rare" title="Rare"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
windows_anomalous_path_activity_ecs
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For host activity logs where <code class="literal">agent.type</code> is <code class="literal">winlogbeat</code>.
</li>
<li class="listitem">
Models occurrences of processes in paths.
</li>
<li class="listitem">
Detects activity in unusual paths (using the <a class="xref" href="ml-rare-functions.html#ml-rare" title="Rare"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<p>Activities in unusual paths may indicate execution of malware or persistence
mechanisms. Windows payloads often execute from user profile paths.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
windows_anomalous_process_creation
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For host activity logs where <code class="literal">agent.type</code> is <code class="literal">winlogbeat</code>.
</li>
<li class="listitem">
Models occurrences of process creation activities (<code class="literal">partition_field_name</code> is
<code class="literal">process.parent.name</code>).
</li>
<li class="listitem">
Detects process relationships that are rare compared to other process
relationships (using the <a class="xref" href="ml-rare-functions.html#ml-rare" title="Rare"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<p>Looks for unusual process relationships which may indicate execution of malware
or persistence mechanisms.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
windows_anomalous_script
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For host activity logs where <code class="literal">agent.type</code> is <code class="literal">winlogbeat</code>.
</li>
<li class="listitem">
Models occurrences of powershell script activities.
</li>
<li class="listitem">
Detects unusual powershell script execution compared to other powershell
script activities (using the
<a class="xref" href="ml-info-functions.html#ml-info-content" title="Info_content, High_info_content, Low_info_content"><code class="literal">high_info_content</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<p>Looks for unusual powershell scripts that may indicate execution of malware, or
persistence mechanisms.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
windows_anomalous_service
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For host activity logs where <code class="literal">agent.type</code> is <code class="literal">winlogbeat</code>.
</li>
<li class="listitem">
Models occurrences of Windows service activities.
</li>
<li class="listitem">
Detects Windows service activities that occur rarely compared to other Windows
service activities (using the <a class="xref" href="ml-rare-functions.html#ml-rare" title="Rare"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<p>Looks for rare and unusual Windows services which may indicate execution of
unauthorized services, malware, or persistence mechanisms.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
windows_rare_user_runas_event
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For host activity logs where <code class="literal">agent.type</code> is <code class="literal">winlogbeat</code>.
</li>
<li class="listitem">
Models occurrences of user context switches.
</li>
<li class="listitem">
Detects user context switches that occur rarely compared to other user context
switches (using the <a class="xref" href="ml-rare-functions.html#ml-rare" title="Rare"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<p>Unusual user context switches can be due to privilege escalation.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
windows_rare_user_type10_remote_login
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
For host activity logs where <code class="literal">agent.type</code> is <code class="literal">winlogbeat</code>.
</li>
<li class="listitem">
Models occurrences of user remote login activities.
</li>
<li class="listitem">
Detects user remote login activities that occur rarely compared to other
user remote login activities (using the <a class="xref" href="ml-rare-functions.html#ml-rare" title="Rare"><code class="literal">rare</code> function</a>).
</li>
</ul>
</div>
</dd>
</dl>
</div>
<p>Looks for unusual user remote logins. Unusual RDP (remote desktop protocol)
user logins can indicate account takeover or credentialed access.</p>
</div>
<div class="navfooter">
<span class="prev">
<a href="ootb-ml-jobs-nginx.html">« Nginx</a>
</span>
<span class="next">
<a href="ml-functions.html">Function reference »</a>
</span>
</div>
</div>
</body>
</html>
