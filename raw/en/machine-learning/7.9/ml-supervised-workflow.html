<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Introduction to supervised learning | Machine Learning in the Elastic Stack [7.9] | Elastic</title>
<link rel="home" href="index.html" title="Machine Learning in the Elastic Stack [7.9]"/>
<link rel="up" href="ml-dfa-overview.html" title="Overview"/>
<link rel="prev" href="ml-dfa-overview.html" title="Overview"/>
<link rel="next" href="ml-dfa-phases.html" title="How a data frame analytics job works"/>
<meta name="DC.type" content="Learn/Docs/Elastic Stack/Machine Learning/7.9"/>
<meta name="DC.subject" content="Machine Learning"/>
<meta name="DC.identifier" content="7.9"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body><div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Machine Learning in the Elastic Stack [7.9]</a></span>
»
<span class="breadcrumb-link"><a href="ml-dfanalytics.html">Data frame analytics</a></span>
»
<span class="breadcrumb-link"><a href="ml-dfa-overview.html">Overview</a></span>
»
<span class="breadcrumb-node">Introduction to supervised learning</span>
</div>
<div class="navheader">
<span class="prev">
<a href="ml-dfa-overview.html">« Overview</a>
</span>
<span class="next">
<a href="ml-dfa-phases.html">How a data frame analytics job works »</a>
</span>
</div>
<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="ml-supervised-workflow"></a>Introduction to supervised learning<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/stack-docs/edit/7.9/docs/en/stack/ml/df-analytics/ml-supervised-workflow.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h2>
</div></div></div>
<p>Elastic supervised learning enables you to train a machine learning model based on training
examples that you provide. You can then use your model to make predictions on
new data. This page summarizes the end-to-end workflow for training, evaluating
and deploying a model. It gives a high-level overview of the steps required to
identify and implement a solution using supervised learning.</p>
<p>The workflow for supervised learning consists of the following stages:</p>
<div class="imageblock">
<div class="content">
<img src="images/ml-dfa-lifecycle-diagram.png" alt="Supervised learning workflow">
</div>
</div>
<p>These are iterative stages, meaning that after evaluating each step, you might
need to make adjustments before you move further.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="define-problem"></a>Define the problem<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/stack-docs/edit/7.9/docs/en/stack/ml/df-analytics/ml-supervised-workflow.asciidoc">edit</a></h3>
</div></div></div>
<p>It’s important to take a moment and think about where machine learning can be most
impactful. Consider what type of data you have available and what value it
holds. The better you know the data, the quicker you will be able to create machine learning
models that generate useful insights. What kinds of patterns do you want to
discover in your data? What type of value do you want to predict: a category, or
a numerical value? The answers help you choose the type of analysis that fits
your use case.</p>
<p>After you identify the problem, consider which of the machine learning features are most
likely to help you solve it. Supervised learning requires a data set that
contains known values that the model can be trained on. Unsupervised learning –
like anomaly detection or outlier detection – does not have this requirement.</p>
<p>Elastic Stack provides the following types of supervised learning:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
regression: predicts <span class="strong strong"><strong>continuous, numerical values</strong></span> like the response time
of a web request.
</li>
<li class="listitem">
classification: predicts <span class="strong strong"><strong>discrete, categorical values</strong></span> like whether a
<a href="/blog/machine-learning-in-cybersecurity-training-supervised-models-to-detect-dga-activity" class="ulink" target="_top">DNS request originates from a malicious or benign domain</a>.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="prepare-transform-data"></a>Prepare and transform data<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/stack-docs/edit/7.9/docs/en/stack/ml/df-analytics/ml-supervised-workflow.asciidoc">edit</a></h3>
</div></div></div>
<p>You have defined the problem and selected an appropriate type of analysis. The
next step is to produce a high-quality data set in Elasticsearch with a clear
relationship to your training objectives. If your data is not already in Elasticsearch,
this is the stage where you develop your data pipeline. If you want to learn
more about how to ingest data into Elasticsearch, refer to the
<a href="/guide/en/elasticsearch/reference/7.9/ingest.html" class="ulink" target="_top">Ingest node documentation</a>.</p>
<p>Regression and classification are supervised machine learning techniques, therefore
you must supply a labelled data set for training. This is often called the
"ground truth". The training process uses this information to identify
relationships among the various characteristics of the data and the predicted
value. It also plays a critical role in model evaluation.</p>
<p>An important requirement is a data set that is large enough to train a model.
For example, if you would like to train a classification model that decides
whether an email is a spam or not, you need a labelled data set that contains
enough data points from each possible category to train the model. What counts
as "enough" depends on various factors like the complexity of the problem or
the machine learning solution you have chosen. There is no exact number that fits every
use case; deciding how much data is acceptable is rather a heuristic process
that might involve iterative trials.</p>
<p>Before you train the model, consider preprocessing the data. In practice, the
type of preprocessing depends on the nature of the data set. Preprocessing can
include, but is not limited to, mitigating redundancy, reducing biases, applying
standards and/or conventions, data normalization, and so on.</p>
<p>Regression and classification require specifically structured source
data: a two dimensional tabular data structure. For this reason, you might need
to <a href="/guide/en/elasticsearch/reference/7.9/transforms.html" class="ulink" target="_top">transform</a> your data to create a data frame which
can be used as the source for these types of data frame analytics.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="train-test-iterate"></a>Train, test, iterate<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/stack-docs/edit/7.9/docs/en/stack/ml/df-analytics/ml-supervised-workflow.asciidoc">edit</a></h3>
</div></div></div>
<p>After your data is prepared and transformed into the right format, it is time to
train the model. Training is an iterative process — every iteration is followed
by an evaluation to see how the model performs.</p>
<p>The first step is defining the features – the relevant fields in the data set –
that will be used for training the model. By default, all the fields with
supported types are included in regression and classification automatically.
However, you can optionally exclude irrelevant fields from the process. Doing so
makes a large data set more manageable, reducing the computing resources and
time required for training.</p>
<p>Next you must define how to split your data into a training and a test set. The
test set won’t be used to train the model; it is used to evaluate how the model
performs. There is no optimal percentage that fits all use cases, it depends on
the amount of data and the time you have to train. For large data sets, you may
want to start with a low training percent to complete an end-to-end iteration in
a short time.</p>
<p>During the training process, the training data is fed through the learning
algorithm. The model predicts the value and compares it to the ground truth then
the model is fine-tuned to make the predictions more accurate.</p>
<p>Once the model is trained, you can evaluate how well it predicts previously
unseen data with the model generalization error. There are further
<a class="xref" href="ml-dfanalytics-evaluate.html" title="Evaluating data frame analytics">evaluation types</a> for both regression and
classification analysis which provide metrics about training performance.
When you are satisfied with the results, you are ready to deploy the model.
Otherwise, you may want to adjust the training configuration or consider
alternative ways to preprocess and represent your data.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="deploy-model"></a>Deploy model<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/stack-docs/edit/7.9/docs/en/stack/ml/df-analytics/ml-supervised-workflow.asciidoc">edit</a></h3>
</div></div></div>
<p>You have trained the model and are satisfied with the performance. The last step
is to deploy your trained model and start using it on new data.</p>
<p>The Elastic machine learning feature called inference enables you to make predictions for new
data either by using it as a processor in an ingest pipeline, in a continuous
transform or as an aggregation at search time. When new data comes into your
ingest pipeline or you run a search on your data with an inference aggregation,
the model is used to infer against the data and make predictions on it.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="next-steps"></a>Next steps<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/stack-docs/edit/7.9/docs/en/stack/ml/df-analytics/ml-supervised-workflow.asciidoc">edit</a></h3>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Read more about how to <a href="/guide/en/elasticsearch/reference/7.9/transforms.html" class="ulink" target="_top">transform you data</a> into an
entity-centric index.
</li>
<li class="listitem">
Consult the documentation to learn more about <a class="xref" href="dfa-regression.html" title="Regression">regression</a>
and <a class="xref" href="dfa-classification.html" title="Classification">classification</a>.
</li>
<li class="listitem">
Learn how to <a class="xref" href="ml-dfanalytics-evaluate.html" title="Evaluating data frame analytics">evaluate</a> regression and
classification models.
</li>
<li class="listitem">
Find out how to deploy your model by using <a class="xref" href="ml-inference.html" title="Inference">inference</a>.
</li>
</ul>
</div>
</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="ml-dfa-overview.html">« Overview</a>
</span>
<span class="next">
<a href="ml-dfa-phases.html">How a data frame analytics job works »</a>
</span>
</div>
</div>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { equationNumbers: { autoNumber: "none" } }
})
MathJax.Hub.Register.StartupHook("AsciiMath Jax Ready", function () {
  MathJax.InputJax.AsciiMath.postfilterHooks.Add(function (data, node) {
    if ((node = data.script.parentNode) && (node = node.parentNode) && node.classList.contains('stemblock')) {
      data.math.root.display = "block"
    }
    return data
  })
})
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>
</body>
</html>
