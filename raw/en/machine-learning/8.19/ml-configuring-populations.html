<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="keywords" content="ML, Elastic Stack, anomaly detection">
<title>Performing population analysis | Machine Learning in the Elastic Stack [8.19] | Elastic</title>
<meta class="elastic" name="content" content="Performing population analysis | Machine Learning in the Elastic Stack [8.19]">

<link rel="home" href="index.html" title="Machine Learning in the Elastic Stack [8.19]"/>
<link rel="up" href="anomaly-how-tos.html" title="How-to guides"/>
<link rel="prev" href="ml-configuring-categories.html" title="Detecting anomalous categories of data"/>
<link rel="next" href="ml-reverting-model-snapshot.html" title="Reverting to a model snapshot"/>
<meta class="elastic" name="product_version" content="8.19"/>
<meta class="elastic" name="product_name" content="Machine Learning"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Elastic Stack/Machine Learning/8.19"/>
<meta name="DC.subject" content="Machine Learning"/>
<meta name="DC.identifier" content="8.19"/>
</head>
<body>
<div class="navheader">
<span class="prev">
<a href="ml-configuring-categories.html">« Detecting anomalous categories of data</a>
</span>
<span class="next">
<a href="ml-reverting-model-snapshot.html">Reverting to a model snapshot »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Machine Learning in the Elastic Stack [8.19]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="ml-ad-overview.html">Anomaly detection</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="anomaly-how-tos.html">How-to guides</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Performing population analysis</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/8.19/docs/en/stack/ml/anomaly-detection/ml-population-analysis.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div id="url-to-v3" class="version-warning">
    <strong>IMPORTANT</strong>: This documentation is no longer updated. Refer to <a href="https://www.elastic.co/support/eol">Elastic's version policy</a> and the <a href="https://www.elastic.co/docs/explore-analyze/machine-learning/anomaly-detection/ml-anomaly-detection-job-types">latest documentation</a>.
</div>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="ml-configuring-populations"></a>Performing population analysis</h2><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/8.19/docs/en/stack/ml/anomaly-detection/ml-population-analysis.asciidoc">edit</a></div>
</div></div></div>
<p>Population analysis is a method of detecting anomalies by comparing the behavior of entities or events within a specified population.
In this approach, machine learning analytics create a profile of what is considered "typical" behavior for users, machines, or other entities over a specified time period.
An entity is considered as anomalous when its behavior deviates from that of the population, indicating abnormal activity compared to the rest of the population.</p>
<p>This type of analysis is most effective when the behavior within a group is generally homogeneous, allowing for the identification of unusual patterns.
However, it is less useful when members of the population show vastly different behaviors.
In such cases, you can segment your data into groups with similar behaviors and run separate jobs for each.
This can be done by using a query filter in the datafeed or by applying the <code class="literal">partition_field_name</code> to split the analysis across different groups.</p>
<p>Population analysis is resource-efficient and scales well, enabling the analysis of populations consisting of hundreds of thousands or even millions of entities with a lower resource footprint than analyzing each series individually.</p>
<div class="position-relative"><h4><a id="population-recommendations"></a>Recommendations</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/8.19/docs/en/stack/ml/anomaly-detection/ml-population-analysis.asciidoc">edit</a></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Use population analysis when the behavior within a group is mostly homogeneous, as it helps identify anomalous patterns effectively.
</li>
<li class="listitem">
Leverage population analysis when dealing with large-scale datasets.
</li>
<li class="listitem">
Avoid using population analysis when members of the population exhibit vastly different behaviors, as it may not be effective.
</li>
</ul>
</div>
<div class="position-relative"><h4><a id="creating-population-jobs"></a>Creating population jobs</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/8.19/docs/en/stack/ml/anomaly-detection/ml-population-analysis.asciidoc">edit</a></div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
In Kibana, navigate to <span class="strong strong"><strong>Jobs</strong></span>. To open <span class="strong strong"><strong>Jobs</strong></span>, find <span class="strong strong"><strong>Machine Learning &gt; Anomaly Detection</strong></span> in the main menu, or use the <a href="/guide/en/kibana/8.19/kibana-concepts-analysts.html#_finding_your_apps_and_objects" class="ulink" target="_top">global search field</a>.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Create job</strong></span>, select the data view you want to analyze.
</li>
<li class="listitem">
Select the <span class="strong strong"><strong>Population</strong></span> wizard from the list.
</li>
<li class="listitem">
<p>Choose a population field - it&#8217;s the <code class="literal">clientip</code> field in this example - and the metric you want to use for the analysis - <code class="literal">Mean(bytes)</code> in this example.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/ml-population-wizard.png" alt="Creating a population job in Kibana">
</div>
</div>
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Next</strong></span>.
</li>
<li class="listitem">
Provide a job ID and click <span class="strong strong"><strong>Next</strong></span>.
</li>
<li class="listitem">
If the validation is successful, click <span class="strong strong"><strong>Next</strong></span> to review the summary of the job creation.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Create job</strong></span>.
</li>
</ol>
</div>
<details>
<summary class="title">API example</summary>
<div class="content">
<p>To specify the population, use the <code class="literal">over_field_name</code> property. For example:</p>
<div class="pre_wrapper lang-console">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console">PUT _ml/anomaly_detectors/population
{
  "description" : "Population analysis",
  "analysis_config" : {
    "bucket_span":"15m",
    "influencers": [
      "clientip"
    ],
    "detectors": [
      {
        "function": "mean",
        "field_name": "bytes",
        "over_field_name": "clientip" <a id="CO14-1"></a><i class="conum" data-value="1"></i>
      }
    ]
  },
  "data_description" : {
    "time_field":"timestamp",
    "time_format": "epoch_ms"
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/26.console"></div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO14-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>This <code class="literal">over_field_name</code> property indicates that the metrics for each client (as identified by their IP address) are analyzed relative to other clients in each bucket.</p>
</td>
</tr>
</table>
</div>
</div>
</details>
<div class="position-relative"><h5><a id="population-job-results"></a>Viewing the job results</h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/8.19/docs/en/stack/ml/anomaly-detection/ml-population-analysis.asciidoc">edit</a></div>
<p>Use the <span class="strong strong"><strong>Anomaly Explorer</strong></span> in Kibana to view the analysis results:</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/ml-population-anomalies.png" alt="Population results in the Anomaly Explorer">
</div>
</div>
<p>The results are often quite sparse.
There might be just a few data points for the selected time period.
Population analysis is particularly useful when you have many entities and the data for specific entitles is sporadic or sparse.
If you click on a section in the timeline or swim lanes, you can see more details about the anomalies:</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/ml-population-anomaly.png" alt="Anomaly details for a specific user">
</div>
</div>
<p>In this example, the client IP address <code class="literal">167.145.234.154</code> received a high volume of bytes on the date and time shown.
This event is anomalous because the mean is four times higher than the expected behavior of the population.</p>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="ml-configuring-categories.html">« Detecting anomalous categories of data</a>
</span>
<span class="next">
<a href="ml-reverting-model-snapshot.html">Reverting to a model snapshot »</a>
</span>
</div>
</body>
</html>
