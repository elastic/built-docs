<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="keywords" content="ML, Elastic Stack, natural language processing, inference">
<title>Compatible third party NLP models | Machine Learning in the Elastic Stack [8.2] | Elastic</title>
<meta class="elastic" name="content" content="Compatible third party NLP models | Machine Learning in the Elastic Stack [8.2]">

<link rel="home" href="index.html" title="Machine Learning in the Elastic Stack [8.2]"/>
<link rel="up" href="ml-nlp.html" title="Natural language processing"/>
<link rel="prev" href="ml-nlp-apis.html" title="API quick reference"/>
<link rel="next" href="redirects.html" title="Appendix Q: Deleted pages"/>
<meta class="elastic" name="product_version" content="8.2"/>
<meta class="elastic" name="product_name" content="Machine Learning"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Elastic Stack/Machine Learning/8.2"/>
<meta name="DC.subject" content="Machine Learning"/>
<meta name="DC.identifier" content="8.2"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body><div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Machine Learning in the Elastic Stack [8.2]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="ml-nlp.html">Natural language processing</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="ml-nlp-apis.html">« API quick reference</a>
</span>
<span class="next">
<a href="redirects.html">Appendix Q: Deleted pages »</a>
</span>
</div>
<div class="chapter">
<div class="titlepage"><div><div>
<h2 class="title"><a id="ml-nlp-model-ref"></a>Compatible third party NLP models<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/stack-docs/edit/8.2/docs/en/stack/ml/nlp/ml-nlp-model-ref.asciidoc">edit</a></h2>
</div></div></div>

<p>The Elastic Stack machine learning features support transformer models that conform to the standard
BERT model interface and use the WordPiece tokenization algorithm.</p>
<p>The current list of supported architectures is:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
BERT
</li>
<li class="listitem">
BART
</li>
<li class="listitem">
DPR bi-encoders
</li>
<li class="listitem">
DistilBERT
</li>
<li class="listitem">
ELECTRA
</li>
<li class="listitem">
MobileBERT
</li>
<li class="listitem">
RoBERTa
</li>
<li class="listitem">
RetriBERT
</li>
<li class="listitem">
MPNet
</li>
<li class="listitem">
SentenceTransformers bi-encoders with the above transformer architectures
</li>
</ul>
</div>
<p>In general, any trained model that has a supported architecture is deployable in
Elasticsearch by using eland. However, it is not possible to test every third party
model. The following lists are therefore provided for informational purposes
only and may not be current. Elastic makes no warranty or assurance that the
machine learning features will continue to interoperate with these third party models in the
way described, or at all.</p>
<p>These models are listed by NLP task; for more information about those tasks,
refer to <a class="xref" href="ml-nlp-overview.html" title="Overview"><em>Overview</em></a>.</p>
<h3><a id="ml-nlp-model-ref-mask"></a>Third party fill-mask models<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/stack-docs/edit/8.2/docs/en/stack/ml/nlp/ml-nlp-model-ref.asciidoc">edit</a></h3>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://huggingface.co/bert-base-uncased" class="ulink" target="_top">https://huggingface.co/bert-base-uncased</a>
</li>
<li class="listitem">
<a href="https://huggingface.co/distilroberta-base" class="ulink" target="_top">https://huggingface.co/distilroberta-base</a>
</li>
<li class="listitem">
<a href="https://huggingface.co/roberta-large" class="ulink" target="_top">https://huggingface.co/roberta-large</a>
</li>
<li class="listitem">
<a href="https://huggingface.co/microsoft/mpnet-base" class="ulink" target="_top">https://huggingface.co/microsoft/mpnet-base</a>
</li>
</ul>
</div>
<h3><a id="ml-nlp-model-ref-ner"></a>Third party named entity recognition models<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/stack-docs/edit/8.2/docs/en/stack/ml/nlp/ml-nlp-model-ref.asciidoc">edit</a></h3>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://huggingface.co/dslim/bert-base-NER" class="ulink" target="_top">https://huggingface.co/dslim/bert-base-NER</a>
</li>
<li class="listitem">
<a href="https://huggingface.co/elastic/distilbert-base-uncased-finetuned-conll03-english" class="ulink" target="_top">https://huggingface.co/elastic/distilbert-base-uncased-finetuned-conll03-english</a>
</li>
<li class="listitem">
<a href="https://huggingface.co/elastic/distilbert-base-cased-finetuned-conll03-english" class="ulink" target="_top">https://huggingface.co/elastic/distilbert-base-cased-finetuned-conll03-english</a>
</li>
<li class="listitem">
<a href="https://huggingface.co/philschmid/distilroberta-base-ner-conll2003" class="ulink" target="_top">https://huggingface.co/philschmid/distilroberta-base-ner-conll2003</a>
</li>
</ul>
</div>
<h3><a id="ml-nlp-model-ref-text-embedding"></a>Third party text embedding models<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/stack-docs/edit/8.2/docs/en/stack/ml/nlp/ml-nlp-model-ref.asciidoc">edit</a></h3>
<p>Using <code class="literal">SentenceTransformerWrapper</code>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://huggingface.co/sentence-transformers/all-MiniLM-L12-v2" class="ulink" target="_top">https://huggingface.co/sentence-transformers/all-MiniLM-L12-v2</a>
</li>
<li class="listitem">
<a href="https://huggingface.co/sentence-transformers/all-mpnet-base-v2" class="ulink" target="_top">https://huggingface.co/sentence-transformers/all-mpnet-base-v2</a>
</li>
<li class="listitem">
<a href="https://huggingface.co/sentence-transformers/LaBSE" class="ulink" target="_top">https://huggingface.co/sentence-transformers/LaBSE</a>
</li>
<li class="listitem">
<a href="https://huggingface.co/sentence-transformers/msmarco-distilbert-base-tas-b" class="ulink" target="_top">https://huggingface.co/sentence-transformers/msmarco-distilbert-base-tas-b</a>
</li>
<li class="listitem">
<a href="https://huggingface.co/sentence-transformers/msmarco-MiniLM-L-12-v3" class="ulink" target="_top">https://huggingface.co/sentence-transformers/msmarco-MiniLM-L-12-v3</a>
</li>
<li class="listitem">
<a href="https://huggingface.co/sentence-transformers/nli-bert-base-cls-pooling" class="ulink" target="_top">https://huggingface.co/sentence-transformers/nli-bert-base-cls-pooling</a>
</li>
<li class="listitem">
<a href="https://huggingface.co/sentence-transformers/bert-base-nli-cls-token" class="ulink" target="_top">https://huggingface.co/sentence-transformers/bert-base-nli-cls-token</a>
</li>
<li class="listitem">
<a href="https://huggingface.co/sentence-transformers/facebook-dpr-ctx_encoder-multiset-base" class="ulink" target="_top">https://huggingface.co/sentence-transformers/facebook-dpr-ctx_encoder-multiset-base</a>
</li>
<li class="listitem">
<a href="https://huggingface.co/sentence-transformers/facebook-dpr-question_encoder-single-nq-base" class="ulink" target="_top">https://huggingface.co/sentence-transformers/facebook-dpr-question_encoder-single-nq-base</a>
</li>
<li class="listitem">
<a href="https://huggingface.co/sentence-transformers/paraphrase-mpnet-base-v2" class="ulink" target="_top">https://huggingface.co/sentence-transformers/paraphrase-mpnet-base-v2</a>
</li>
<li class="listitem">
<a href="https://huggingface.co/sentence-transformers/all-distilroberta-v1" class="ulink" target="_top">https://huggingface.co/sentence-transformers/all-distilroberta-v1</a>
</li>
</ul>
</div>
<p>Using <code class="literal">DPREncoderWrapper</code>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://huggingface.co/facebook/dpr-ctx_encoder-single-nq-base" class="ulink" target="_top">https://huggingface.co/facebook/dpr-ctx_encoder-single-nq-base</a>
</li>
<li class="listitem">
<a href="https://huggingface.co/facebook/dpr-question_encoder-single-nq-base" class="ulink" target="_top">https://huggingface.co/facebook/dpr-question_encoder-single-nq-base</a>
</li>
<li class="listitem">
<a href="https://huggingface.co/facebook/dpr-ctx_encoder-multiset-base" class="ulink" target="_top">https://huggingface.co/facebook/dpr-ctx_encoder-multiset-base</a>
</li>
<li class="listitem">
<a href="https://huggingface.co/facebook/dpr-question_encoder-multiset-base" class="ulink" target="_top">https://huggingface.co/facebook/dpr-question_encoder-multiset-base</a>
</li>
<li class="listitem">
<a href="https://huggingface.co/castorini/ance-dpr-context-multi" class="ulink" target="_top">https://huggingface.co/castorini/ance-dpr-context-multi</a>
</li>
<li class="listitem">
<a href="https://huggingface.co/castorini/ance-dpr-question-multi" class="ulink" target="_top">https://huggingface.co/castorini/ance-dpr-question-multi</a>
</li>
<li class="listitem">
<a href="https://huggingface.co/castorini/bpr-nq-ctx-encoder" class="ulink" target="_top">https://huggingface.co/castorini/bpr-nq-ctx-encoder</a>
</li>
<li class="listitem">
<a href="https://huggingface.co/castorini/bpr-nq-question-encoder" class="ulink" target="_top">https://huggingface.co/castorini/bpr-nq-question-encoder</a>
</li>
</ul>
</div>
<h4><a id="ml-nlp-model-ref-text-classification"></a>Third party text classification models<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/stack-docs/edit/8.2/docs/en/stack/ml/nlp/ml-nlp-model-ref.asciidoc">edit</a></h4>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://huggingface.co/distilbert-base-uncased-finetuned-sst-2-english" class="ulink" target="_top">https://huggingface.co/distilbert-base-uncased-finetuned-sst-2-english</a>
</li>
<li class="listitem">
<a href="https://huggingface.co/bhadresh-savani/distilbert-base-uncased-emotion" class="ulink" target="_top">https://huggingface.co/bhadresh-savani/distilbert-base-uncased-emotion</a>
</li>
<li class="listitem">
<a href="https://huggingface.co/Hate-speech-CNERG/dehatebert-mono-english" class="ulink" target="_top">https://huggingface.co/Hate-speech-CNERG/dehatebert-mono-english</a>
</li>
<li class="listitem">
<a href="https://huggingface.co/ProsusAI/finbert" class="ulink" target="_top">https://huggingface.co/ProsusAI/finbert</a>
</li>
<li class="listitem">
<a href="https://huggingface.co/nateraw/bert-base-uncased-emotion" class="ulink" target="_top">https://huggingface.co/nateraw/bert-base-uncased-emotion</a>
</li>
<li class="listitem">
<a href="https://huggingface.co/cardiffnlp/twitter-roberta-base-sentiment" class="ulink" target="_top">https://huggingface.co/cardiffnlp/twitter-roberta-base-sentiment</a>
</li>
</ul>
</div>
<h3><a id="ml-nlp-model-ref-zero-shot"></a>Third party zero-shot text classification models<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/stack-docs/edit/8.2/docs/en/stack/ml/nlp/ml-nlp-model-ref.asciidoc">edit</a></h3>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://huggingface.co/typeform/distilbert-base-uncased-mnli" class="ulink" target="_top">https://huggingface.co/typeform/distilbert-base-uncased-mnli</a>
</li>
<li class="listitem">
<a href="https://huggingface.co/typeform/mobilebert-uncased-mnli" class="ulink" target="_top">https://huggingface.co/typeform/mobilebert-uncased-mnli</a>
</li>
<li class="listitem">
<a href="https://huggingface.co/typeform/squeezebert-mnli" class="ulink" target="_top">https://huggingface.co/typeform/squeezebert-mnli</a>
</li>
<li class="listitem">
<a href="https://huggingface.co/facebook/bart-large-mnli" class="ulink" target="_top">https://huggingface.co/facebook/bart-large-mnli</a>
</li>
<li class="listitem">
<a href="https://huggingface.co/valhalla/distilbart-mnli-12-6" class="ulink" target="_top">https://huggingface.co/valhalla/distilbart-mnli-12-6</a>
</li>
<li class="listitem">
<a href="https://huggingface.co/cross-encoder/nli-distilroberta-base" class="ulink" target="_top">https://huggingface.co/cross-encoder/nli-distilroberta-base</a>
</li>
<li class="listitem">
<a href="https://huggingface.co/cross-encoder/nli-roberta-base" class="ulink" target="_top">https://huggingface.co/cross-encoder/nli-roberta-base</a>
</li>
</ul>
</div>
<h3><a id="_expected_model_output"></a>Expected model output<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/stack-docs/edit/8.2/docs/en/stack/ml/nlp/ml-nlp-model-ref.asciidoc">edit</a></h3>
<p>Models used for each NLP task type must output tensors of a specific format to be used in the Elasticsearch NLP pipelines.</p>
<p>Here are the expected outputs for each task type.</p>
<h4><a id="_fill_mask_expected_model_output"></a>Fill mask expected model output<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/stack-docs/edit/8.2/docs/en/stack/ml/nlp/ml-nlp-model-ref.asciidoc">edit</a></h4>
<p>Fill mask is a specific kind of token classification; it is the base training task of many transformer models.</p>
<p>For the Elastic stack&#8217;s fill mask NLP task to understand the model output, it must have a specific format. It needs to
be a float tensor with <code class="literal">shape(&lt;number of sequences&gt;, &lt;number of tokens&gt;, &lt;vocab size&gt;)</code>.</p>
<p>Here is an example with a single sequence <code class="literal">"The capital of [MASK] is Paris"</code> and with vocabulary
<code class="literal">["The", "capital", "of", "is", "Paris", "France", "[MASK]"]</code>.</p>
<p>Should output:</p>
<pre class="screen"> [
   [
     [ 0, 0, 0, 0, 0, 0, 0 ], // The
     [ 0, 0, 0, 0, 0, 0, 0 ], // capital
     [ 0, 0, 0, 0, 0, 0, 0 ], // of
     [ 0.01, 0.01, 0.3, 0.01, 0.2, 1.2, 0.1 ], // [MASK]
     [ 0, 0, 0, 0, 0, 0, 0 ], // is
     [ 0, 0, 0, 0, 0, 0, 0 ] // Paris
   ]
]</pre>
<p>The predicted value here for <code class="literal">[MASK]</code> is <code class="literal">"France"</code> with a score of 1.2.</p>
<h4><a id="_named_entity_recognition_expected_model_output"></a>Named entity recognition expected model output<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/stack-docs/edit/8.2/docs/en/stack/ml/nlp/ml-nlp-model-ref.asciidoc">edit</a></h4>
<p>Named entity recognition is a specific token classification task. Each token in the sequence is scored related to
a specific set of classification labels. For the Elastic Stack, we use Inside-Outside-Beginning (IOB) tagging. Additionally,
only the following classification labels are supported: "O", "B_MISC", "I_MISC", "B_PER", "I_PER", "B_ORG", "I_ORG", "B_LOC", "I_LOC".</p>
<p>The <code class="literal">"O"</code> entity label indicates that the current token is outside any entity.
<code class="literal">"I"</code> indicates that the token is inside an entity.
<code class="literal">"B"</code> indicates the beginning of an entity.
<code class="literal">"MISC"</code> is a miscellaneous entity.
<code class="literal">"LOC"</code> is a location.
<code class="literal">"PER"</code> is a person.
<code class="literal">"ORG"</code> is an organization.</p>
<p>The response format must be a float tensor with <code class="literal">shape(&lt;number of sequences&gt;, &lt;number of tokens&gt;, &lt;number of classification labels&gt;)</code>.</p>
<p>Here is an example with a single sequence <code class="literal">"Waldo is in Paris"</code>:</p>
<pre class="screen"> [
   [
//    "O", "B_MISC", "I_MISC", "B_PER", "I_PER", "B_ORG", "I_ORG", "B_LOC", "I_LOC"
     [ 0,  0,         0,       0.4,     0.5,     0,       0.1,     0,       0 ], // Waldo
     [ 1,  0,         0,       0,       0,       0,       0,       0,       0 ], // is
     [ 1,  0,         0,       0,       0,       0,       0,       0,       0 ], // in
     [ 0,  0,         0,       0,       0,       0,       0,       0,       1.0 ] // Paris
   ]
]</pre>
<h4><a id="_text_embedding_expected_model_output"></a>Text embedding expected model output<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/stack-docs/edit/8.2/docs/en/stack/ml/nlp/ml-nlp-model-ref.asciidoc">edit</a></h4>
<p>Text embedding allows for semantic embedding of text for dense information retrieval.
The output of the model must be the specific embedding directly without any additional pooling.</p>
<p>Eland does this wrapping for the aforementioned models. But if supplying your own, the model must output the embedding for
each inferred sequence.</p>
<h4><a id="_text_classification_expected_model_output"></a>Text classification expected model output<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/stack-docs/edit/8.2/docs/en/stack/ml/nlp/ml-nlp-model-ref.asciidoc">edit</a></h4>
<p>With text classification (for example, in tasks like sentiment analysis), the entire sequence is classified. The output of
the model must be a float tensor with <code class="literal">shape(&lt;number of sequences&gt;, &lt;number of classification labels&gt;)</code>.</p>
<p>Here is an example with two sequences for a binary classification model of "happy" and "sad":</p>
<pre class="screen"> [
   [
//     happy, sad
     [ 0,     1], // first sequence
     [ 1,     0] // second sequence
   ]
]</pre>
<h4><a id="_zero_shot_text_classification_expected_model_output"></a>Zero-shot text classification expected model output<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/stack-docs/edit/8.2/docs/en/stack/ml/nlp/ml-nlp-model-ref.asciidoc">edit</a></h4>
<p>Zero-shot text classification allows text to be classified for arbitrary labels not necessarily part of the original
training. Each sequence is combined with the label given some hypothesis template. The model then scores each of these
combinations according to <code class="literal">[entailment, neutral, contradiction]</code>. The output of the model must be a float tensor
with <code class="literal">shape(&lt;number of sequences&gt;, &lt;number of labels&gt;, 3)</code>.</p>
<p>Here is an example with a single sequence classified against 4 labels:</p>
<pre class="screen"> [
   [
//     entailment, neutral, contradiction
     [ 0.5,        0.1,     0.4], // first label
     [ 0,          0,       1], // second label
     [ 1,          0,       0], // third label
     [ 0.7,        0.2,     0.1] // fourth label
   ]
]</pre>
</div>
<div class="navfooter">
<span class="prev">
<a href="ml-nlp-apis.html">« API quick reference</a>
</span>
<span class="next">
<a href="redirects.html">Appendix Q: Deleted pages »</a>
</span>
</div>
</div>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { equationNumbers: { autoNumber: "none" } }
})
MathJax.Hub.Register.StartupHook("AsciiMath Jax Ready", function () {
  MathJax.InputJax.AsciiMath.postfilterHooks.Add(function (data, node) {
    if ((node = data.script.parentNode) && (node = node.parentNode) && node.classList.contains('stemblock')) {
      data.math.root.display = "block"
    }
    return data
  })
})
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>
</body>
</html>
