<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="keywords" content="ML, Elastic Stack, natural language processing, text embedding">
<title>Deploy the model in your cluster | Machine Learning in the Elastic Stack [8.x] | Elastic</title>
<meta class="elastic" name="content" content="Deploy the model in your cluster | Machine Learning in the Elastic Stack [8.x]">

<link rel="home" href="index.html" title="Machine Learning in the Elastic Stack [8.x]"/>
<link rel="up" href="ml-nlp-deploy-models.html" title="Deploy trained models"/>
<link rel="prev" href="ml-nlp-import-model.html" title="Import the trained model and vocabulary"/>
<link rel="next" href="ml-nlp-test-inference.html" title="Try it out"/>
<meta class="elastic" name="product_version" content="8.x"/>
<meta class="elastic" name="product_name" content="Machine Learning"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Elastic Stack/Machine Learning/8.x"/>
<meta name="DC.subject" content="Machine Learning"/>
<meta name="DC.identifier" content="8.x"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
This documentation contains work-in-progress information for future Elastic Stack and Cloud releases. Use the version selector to view supported release docs. It also contains some Elastic Cloud serverless information. Check out our <a href="https://www.elastic.co/docs/current/serverless">serverless docs</a> for more details.
</div>
<div class="navheader">
<span class="prev">
<a href="ml-nlp-import-model.html">« Import the trained model and vocabulary</a>
</span>
<span class="next">
<a href="ml-nlp-test-inference.html">Try it out »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Machine Learning in the Elastic Stack [8.x]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="ml-nlp.html">Natural language processing</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="ml-nlp-deploy-models.html">Deploy trained models</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Deploy the model in your cluster</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/stack-docs/edit/8.x/docs/en/stack/ml/nlp/ml-nlp-deploy-models.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="ml-nlp-deploy-model"></a>Deploy the model in your cluster</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/stack-docs/edit/8.x/docs/en/stack/ml/nlp/ml-nlp-deploy-models.asciidoc">edit</a></div>
</div></div></div>
<p>After you import the model and vocabulary, you can use Kibana to view and manage
their deployment across your cluster under <span class="strong strong"><strong>Machine Learning</strong></span> &gt; <span class="strong strong"><strong>Model Management</strong></span>.
Alternatively, you can use the
<a href="/guide/en/elasticsearch/reference/8.x/start-trained-model-deployment.html" class="ulink" target="_top">start trained model deployment API</a>.</p>
<p>You can deploy a model multiple times by assigning a unique deployment ID when starting the deployment.</p>
<p>You can optimize your deplyoment for typical use cases, such as search and ingest.
When you optimize for ingest, the throughput will be higher, which increases the number of inference requests that can be performed in parallel.
When you optimize for search, the latency will be lower during search processes.
When you have dedicated deployments for different purposes, you ensure that the search speed remains unaffected by ingest workloads, and vice versa.
Having separate deployments for search and ingest mitigates performance issues resulting from interactions between the two, which can be hard to diagnose.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/ml-nlp-deployment-id-elser-v2.png" alt="Model deployment on the Trained Models UI." width="640">
</div>
</div>
<p>Each deployment will be fine-tuned automatically based on its specific purpose you choose.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Since eland uses APIs to deploy the models, you cannot see the models in Kibana until the saved objects are synchronized.
You can follow the prompts in Kibana, wait for automatic synchronization, or use the <a href="/guide/en/kibana/8.x/machine-learning-api-sync.html" class="ulink" target="_top">sync machine learning saved objects API</a>.</p>
</div>
</div>
<p>You can define the resource usage level of the NLP model during model deployment.
The resource usage levels behave differently depending on <a class="xref" href="ml-nlp-auto-scale.html#nlp-model-adaptive-resources" title="Enabling autoscaling in Kibana - adaptive resources">adaptive resources</a> being enabled or disabled.
When adaptive resources are disabled but machine learning autoscaling is enabled, vCPU usage of Cloud deployments derived from the Cloud console and functions as follows:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Low: This level limits resources to two vCPUs, which may be suitable for development, testing, and demos depending on your parameters.
It is not recommended for production use
</li>
<li class="listitem">
Medium: This level limits resources to 32 vCPUs, which may be suitable for development, testing, and demos depending on your parameters.
It is not recommended for production use.
</li>
<li class="listitem">
High: This level may use the maximum number of vCPUs available for this deployment from the Cloud console.
If the maximum is 2 vCPUs or fewer, this level is equivalent to the medium or low level.
</li>
</ul>
</div>
<p>For the resource levels when adaptive resources are enabled, refer to &lt;<a class="xref" href="ml-nlp-auto-scale.html" title="Trained model autoscaling"><em>Trained model autoscaling</em></a>.</p>
<div class="position-relative"><h4><a id="infer-request-queues"></a>Request queues and search priority</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/stack-docs/edit/8.x/docs/en/stack/ml/nlp/ml-nlp-deploy-models.asciidoc">edit</a></div>
<p>Each allocation of a model deployment has a dedicated queue to buffer inference
requests. The size of this queue is determined by the <code class="literal">queue_capacity</code> parameter
in the
<a href="/guide/en/elasticsearch/reference/8.x/start-trained-model-deployment.html" class="ulink" target="_top">start trained model deployment API</a>.
When the queue reaches its maximum capacity, new requests are declined until
some of the queued requests are processed, creating available capacity once
again. When multiple ingest pipelines reference the same deployment, the queue
can fill up, resulting in rejected requests. Consider using dedicated
deployments to prevent this situation.</p>
<p>Inference requests originating from search, such as the
<a href="/guide/en/elasticsearch/reference/8.x/query-dsl-text-expansion-query.html" class="ulink" target="_top"><code class="literal">text_expansion</code> query</a>, have a higher
priority compared to non-search requests. The inference ingest processor generates
normal priority requests. If both a search query and an ingest processor use the
same deployment, the search requests with higher priority skip ahead in the
queue for processing before the lower priority ingest requests. This
prioritization accelerates search responses while potentially slowing down
ingest where response time is less critical.</p>
</div>
</div>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  messageStyle: "none",
  tex2jax: {
    inlineMath: [["\\(", "\\)"]],
    displayMath: [["\\[", "\\]"]],
    ignoreClass: "nostem|nolatexmath"
  },
  asciimath2jax: {
    delimiters: [["\\$", "\\$"]],
    ignoreClass: "nostem|noasciimath"
  },
  TeX: { equationNumbers: { autoNumber: "none" } }
})
MathJax.Hub.Register.StartupHook("AsciiMath Jax Ready", function () {
  MathJax.InputJax.AsciiMath.postfilterHooks.Add(function (data, node) {
    if ((node = data.script.parentNode) && (node = node.parentNode) && node.classList.contains('stemblock')) {
      data.math.root.display = "block"
    }
    return data
  })
})
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_HTMLorMML"></script>
</div><div class="navfooter">
<span class="prev">
<a href="ml-nlp-import-model.html">« Import the trained model and vocabulary</a>
</span>
<span class="next">
<a href="ml-nlp-test-inference.html">Try it out »</a>
</span>
</div>
</body>
</html>
