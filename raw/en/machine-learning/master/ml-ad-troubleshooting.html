<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="keywords" content="ML, Elastic Stack, anomaly detection, data frame analytics">
<title>Troubleshooting machine learning anomaly detection | Machine Learning in the Elastic Stack [master] | Elastic</title>
<meta class="elastic" name="content" content="Troubleshooting machine learning anomaly detection | Machine Learning in the Elastic Stack [master]">

<link rel="home" href="index.html" title="Machine Learning in the Elastic Stack [master]"/>
<link rel="up" href="ml-ad-resources.html" title="Resources"/>
<link rel="prev" href="ootb-ml-jobs.html" title="Supplied anomaly detection configurations"/>
<link rel="next" href="ootb-ml-jobs-apache.html" title="Appendix A: Apache anomaly detection configurations"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="Machine Learning"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Elastic Stack/Machine Learning/master"/>
<meta name="DC.subject" content="Machine Learning"/>
<meta name="DC.identifier" content="master"/>
</head>
<body><div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Machine Learning in the Elastic Stack [master]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="ml-ad-overview.html">Anomaly detection</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="ml-ad-resources.html">Resources</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="ootb-ml-jobs.html">« Supplied anomaly detection configurations</a>
</span>
<span class="next">
<a href="ootb-ml-jobs-apache.html">Appendix A: Apache anomaly detection configurations »</a>
</span>
</div>
<div class="section xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="ml-ad-troubleshooting"></a>Troubleshooting machine learning anomaly detection<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/main/docs/en/stack/ml/anomaly-detection/ml-ad-troubleshooting.asciidoc">edit</a></h2>
</div></div></div>

<p>Use the information in this section to troubleshoot common problems and find
answers for frequently asked questions.</p>
<h4><a id="ml-ad-restart-failed-jobs"></a>Restart failed anomaly detection jobs<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/stack-docs/edit/main/docs/en/stack/ml/anomaly-detection/ml-ad-troubleshooting.asciidoc">edit</a></h4>
<p>If an anomaly detection job fails, try to restart the job by following the procedure
described below. If the restarted job runs as expected, then the problem that
caused the job to fail was transient and no further investigation is needed. If
the job quickly fails after the restart, then the problem is persistent and
needs further investigation. In this case, find out which node the failed job
was running on by checking the job stats on the <span class="strong strong"><strong>Job management</strong></span> pane in
Kibana. Then get the logs for that node and look for exceptions and errors where
the ID of the anomaly detection job is in the message to have a better understanding of
the issue.</p>
<p>If an anomaly detection job has failed, do the following to recover from <code class="literal">failed</code> state:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p><em>Force</em> stop the corresponding datafeed by using the
<a href="/guide/en/elasticsearch/reference/master/ml-stop-datafeed.html" class="ulink" target="_top">Stop datafeed API</a> with the <code class="literal">force</code> parameter being
<code class="literal">true</code>. For example, the following request force stops the <code class="literal">my_datafeed</code>
datafeed.</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST _ml/datafeeds/my_datafeed/_stop
{
  "force": "true"
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/27.console"></div>
</li>
<li class="listitem">
<p><em>Force</em> close the anomaly detection job by using the
<a href="/guide/en/elasticsearch/reference/master/ml-close-job.html" class="ulink" target="_top">Close anomaly detection job API</a> with the <code class="literal">force</code> parameter
being <code class="literal">true</code>. For example, the following request force closes the <code class="literal">my_job</code>
anomaly detection job:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST _ml/anomaly_detectors/my_job/_close?force=true</pre>
</div>
<div class="console_widget" data-snippet="snippets/28.console"></div>
</li>
<li class="listitem">
Restart the anomaly detection job on the <span class="strong strong"><strong>Job management</strong></span> pane in Kibana.
</li>
</ol>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="ootb-ml-jobs.html">« Supplied anomaly detection configurations</a>
</span>
<span class="next">
<a href="ootb-ml-jobs-apache.html">Appendix A: Apache anomaly detection configurations »</a>
</span>
</div>
</div>
</body>
</html>
