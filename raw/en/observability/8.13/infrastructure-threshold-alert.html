<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Create an inventory threshold rule | Elastic Observability [8.13] | Elastic</title>
<meta class="elastic" name="content" content="Create an inventory threshold rule | Elastic Observability [8.13]">

<link rel="home" href="index.html" title="Elastic Observability [8.13]"/>
<link rel="up" href="create-alerts-rules.html" title="Create and manage rules"/>
<link rel="prev" href="logs-threshold-alert.html" title="Create a log threshold rule"/>
<link rel="next" href="metrics-threshold-alert.html" title="Create a metric threshold rule"/>
<meta class="elastic" name="product_version" content="8.13"/>
<meta class="elastic" name="product_name" content="Observability"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Observability/Guide/8.13"/>
<meta name="DC.subject" content="Observability"/>
<meta name="DC.identifier" content="8.13"/>
</head>
<body>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Observability [8.13]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="create-alerts.html">Alerting</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="create-alerts-rules.html">Create and manage rules</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="logs-threshold-alert.html">« Create a log threshold rule</a>
</span>
<span class="next">
<a href="metrics-threshold-alert.html">Create a metric threshold rule »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="infrastructure-threshold-alert"></a>Create an inventory threshold rule<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/8.13/docs/en/observability/inventory-threshold-alert.asciidoc">edit</a></h3>
</div></div></div>

<p>Based on the resources listed on the <span class="strong strong"><strong>Inventory</strong></span> page within the Infrastructure app,
you can create a threshold rule to notify you when a metric has reached or exceeded a value for a specific
resource or a group of resources within your infrastructure.</p>
<p>Additionally, each rule can be defined using multiple
conditions that combine metrics and thresholds to create precise notifications and reduce false positives.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
To access this page, go to <span class="strong strong"><strong>Observability</strong></span> &#8594; <span class="strong strong"><strong>Infrastructure</strong></span>.
</li>
<li class="listitem">
On the <span class="strong strong"><strong>Inventory</strong></span> page or the <span class="strong strong"><strong>Metrics Explorer</strong></span> page, click <span class="strong strong"><strong>Alerts and rules</strong></span> &#8594; <span class="strong strong"><strong>Infrastructure</strong></span>.
</li>
<li class="listitem">
Select <span class="strong strong"><strong>Create inventory rule</strong></span>.
</li>
</ol>
</div>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>When you select <span class="strong strong"><strong>Create inventory alert</strong></span>, the parameters you configured on the <span class="strong strong"><strong>Inventory</strong></span> page will automatically
populate the rule. You can use the Inventory first to view which nodes in your infrastructure you&#8217;d
like to be notified about and then quickly create a rule in just a few clicks.</p>
</div>
</div>
<h5><a id="inventory-conditions"></a>Inventory conditions<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/8.13/docs/en/observability/inventory-threshold-alert.asciidoc">edit</a></h5>
<p>Conditions for each rule can be applied to specific metrics relating to the inventory type you select.
You can choose the aggregation type, the metric, and by including a warning threshold value, you can be
alerted on multiple threshold values based on severity scores. When creating the rule, you can still get
notified if no data is returned for the specific metric or if the rule fails to query Elasticsearch.
You can also set advanced options such as the number of consecutive runs that must meet the rule conditions before an alert occurs.</p>
<p>In this example, Kubernetes Pods is the selected inventory type. The conditions state that you will receive
a critical alert for any pods within the <code class="literal">ingress-nginx</code> namespace with a memory usage of 95% or above
and a warning alert if memory usage is 90% or above.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/inventory-alert.png" alt="Inventory rule">
</div>
</div>
<p>Before creating a rule, you can preview whether the conditions would have triggered the alert in the last
hour, day, week, or month.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/alert-preview.png" alt="Preview rules">
</div>
</div>
<h5><a id="action-types-infrastructure"></a>Action types<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/8.13/docs/en/observability/inventory-threshold-alert.asciidoc">edit</a></h5>
<p>Extend your rules by connecting them to actions that use the following supported built-in integrations.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="/guide/en/kibana/8.13/d3security-action-type.html" class="ulink" target="_top">D3 Security</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.13/email-action-type.html" class="ulink" target="_top">Email</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.13/resilient-action-type.html" class="ulink" target="_top">IBM Resilient</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.13/index-action-type.html" class="ulink" target="_top">Index</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.13/jira-action-type.html" class="ulink" target="_top">Jira</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.13/teams-action-type.html" class="ulink" target="_top">Microsoft Teams</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.13/opsgenie-action-type.html" class="ulink" target="_top">Opsgenie</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.13/pagerduty-action-type.html" class="ulink" target="_top">PagerDuty</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.13/server-log-action-type.html" class="ulink" target="_top">Server log</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.13/servicenow-itom-action-type.html" class="ulink" target="_top">ServiceNow ITOM</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.13/servicenow-action-type.html" class="ulink" target="_top">ServiceNow ITSM</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.13/servicenow-sir-action-type.html" class="ulink" target="_top">ServiceNow SecOps</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.13/slack-action-type.html" class="ulink" target="_top">Slack</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.13/swimlane-action-type.html" class="ulink" target="_top">Swimlane</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.13/torq-action-type.html" class="ulink" target="_top">Torq</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.13/webhook-action-type.html" class="ulink" target="_top">Webhook</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.13/xmatters-action-type.html" class="ulink" target="_top">xMatters</a>
</li>
</ul>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Some connector types are paid commercial features, while others are free.
For a comparison of the Elastic subscription levels, go to
<a href="/subscriptions" class="ulink" target="_top">the subscription page</a>.</p>
</div>
</div>
<p>After you select a connector, you must set the action frequency. You can choose to create a summary of alerts on each check interval or on a custom interval. For example, send email notifications that summarize the new, ongoing, and recovered alerts each hour:</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/action-alert-summary.png" alt="Action types">
</div>
</div>
<p>Alternatively, you can set the action frequency such that you choose how often the action runs (for example, at each check interval, only when the alert status changes, or at a custom action interval). In this case, you define precisely when the alert is triggered by selecting a specific
threshold condition: <code class="literal">Alert</code>, <code class="literal">Warning</code>, or <code class="literal">Recovered</code> (a value that was once above a threshold has now dropped below it).</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/infrastructure-threshold-run-when-selection.png" alt="Configure when an alert is triggered">
</div>
</div>
<p>You can also further refine the conditions under which actions run by specifying that actions only run they match a KQL query or when an alert occurs within a specific time frame:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>If alert matches query</strong></span>: Enter a KQL query that defines field-value pairs or query conditions that must be met for notifications to send. The query only searches alert documents in the indices specified for the rule.
</li>
<li class="listitem">
<span class="strong strong"><strong>If alert is generated during timeframe</strong></span>: Set timeframe details. Notifications are only sent if alerts are generated within the timeframe you define.
</li>
</ul>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="images/conditional-alerts.png" alt="Configure a conditional alert">
</div>
</div>
<h5><a id="_action_variables_2"></a>Action variables<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/8.13/docs/en/observability/inventory-threshold-alert.asciidoc">edit</a></h5>
<p>Use the default notification message or customize it.
You can add more context to the message by clicking the icon above the message text box
and selecting from a list of available variables.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/infrastructure-threshold-alert-default-message.png" alt="Default notification message for infrastructure threshold rules with open &quot;Add variable&quot; popup listing available action variables" width="600">
</div>
</div>
<p>The following variables are specific to this rule type.
You an also specify <a href="/guide/en/kibana/8.13/rule-action-variables.html" class="ulink" target="_top">variables common to all rules</a>.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">context.alertDetailsUrl</code>
</span>
</dt>
<dd>
Link to the alert troubleshooting view for further context and details. This will be an empty string if the <code class="literal">server.publicBaseUrl</code> is not configured.
</dd>
<dt>
<span class="term">
<code class="literal">context.alertState</code>
</span>
</dt>
<dd>
Current state of the alert.
</dd>
<dt>
<span class="term">
<code class="literal">context.cloud</code>
</span>
</dt>
<dd>
The cloud object defined by ECS if available in the source.
</dd>
<dt>
<span class="term">
<code class="literal">context.container</code>
</span>
</dt>
<dd>
The container object defined by ECS if available in the source.
</dd>
<dt>
<span class="term">
<code class="literal">context.group</code>
</span>
</dt>
<dd>
Name of the group reporting data.
</dd>
<dt>
<span class="term">
<code class="literal">context.host</code>
</span>
</dt>
<dd>
The host object defined by ECS if available in the source.
</dd>
<dt>
<span class="term">
<code class="literal">context.labels</code>
</span>
</dt>
<dd>
List of labels associated with the entity where this alert triggered.
</dd>
<dt>
<span class="term">
<code class="literal">context.metric</code>
</span>
</dt>
<dd>
The metric name in the specified condition. Usage: (<code class="literal">ctx.metric.condition0</code>, <code class="literal">ctx.metric.condition1</code>, and so on).
</dd>
<dt>
<span class="term">
<code class="literal">context.orchestrator</code>
</span>
</dt>
<dd>
The orchestrator object defined by ECS if available in the source.
</dd>
<dt>
<span class="term">
<code class="literal">context.originalAlertState</code>
</span>
</dt>
<dd>
The state of the alert before it recovered. This is only available in the recovery context.
</dd>
<dt>
<span class="term">
<code class="literal">context.originalAlertStateWasALERT</code>
</span>
</dt>
<dd>
Boolean value of the state of the alert before it recovered. This can be used for template conditions. This is only available in the recovery context.
</dd>
<dt>
<span class="term">
<code class="literal">context.originalAlertStateWasWARNING</code>
</span>
</dt>
<dd>
Boolean value of the state of the alert before it recovered. This can be used for template conditions. This is only available in the recovery context.
</dd>
<dt>
<span class="term">
<code class="literal">context.reason</code>
</span>
</dt>
<dd>
A concise description of the reason for the alert.
</dd>
<dt>
<span class="term">
<code class="literal">context.tags</code>
</span>
</dt>
<dd>
List of tags associated with the entity where this alert triggered.
</dd>
<dt>
<span class="term">
<code class="literal">context.threshold</code>
</span>
</dt>
<dd>
The threshold value of the metric for the specified condition. Usage: (<code class="literal">ctx.threshold.condition0</code>, <code class="literal">ctx.threshold.condition1</code>, and so on)
</dd>
<dt>
<span class="term">
<code class="literal">context.timestamp</code>
</span>
</dt>
<dd>
A timestamp of when the alert was detected.
</dd>
<dt>
<span class="term">
<code class="literal">context.value</code>
</span>
</dt>
<dd>
The value of the metric in the specified condition. Usage: (<code class="literal">ctx.value.condition0</code>, <code class="literal">ctx.value.condition1</code>, and so on)
</dd>
<dt>
<span class="term">
<code class="literal">context.viewInAppUrl</code>
</span>
</dt>
<dd>
Link to the alert source.
</dd>
</dl>
</div>
<h5><a id="infra-alert-settings"></a>Settings<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/8.13/docs/en/observability/inventory-threshold-alert.asciidoc">edit</a></h5>
<p>With infrastructure threshold rules, it&#8217;s not possible to set an explicit index pattern as part of the configuration. The index pattern
is instead inferred from <span class="strong strong"><strong>Metrics indices</strong></span> on the <a class="xref" href="configure-settings.html" title="Configure settings">Settings</a> page of the Infrastructure app.</p>
<p>With each execution of the rule check, the <span class="strong strong"><strong>Metrics indices</strong></span> setting is checked, but it is not stored when the rule is created.</p>
<p>The <span class="strong strong"><strong>Timestamp</strong></span> field that is set under <span class="strong strong"><strong>Settings</strong></span> determines which field is used for timestamps in queries.</p>
</div>
<div class="navfooter">
<span class="prev">
<a href="logs-threshold-alert.html">« Create a log threshold rule</a>
</span>
<span class="next">
<a href="metrics-threshold-alert.html">Create a metric threshold rule »</a>
</span>
</div>
</div>
</body>
</html>
