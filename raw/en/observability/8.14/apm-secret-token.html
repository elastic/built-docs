<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Secret token | Elastic Observability [8.14] | Elastic</title>
<meta class="elastic" name="content" content="Secret token | Elastic Observability [8.14]">

<link rel="home" href="index.html" title="Elastic Observability [8.14]"/>
<link rel="up" href="apm-secure-agent-communication.html" title="Secure communication with APM agents"/>
<link rel="prev" href="apm-api-key.html" title="API keys"/>
<link rel="next" href="apm-anonymous-auth.html" title="Anonymous authentication"/>
<meta class="elastic" name="product_version" content="8.14"/>
<meta class="elastic" name="product_name" content="Observability"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Observability/Guide/8.14"/>
<meta name="DC.subject" content="Observability"/>
<meta name="DC.identifier" content="8.14"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div class="navheader">
<span class="prev">
<a href="apm-api-key.html">« API keys</a>
</span>
<span class="next">
<a href="apm-anonymous-auth.html">Anonymous authentication »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Observability [8.14]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="apm.html">Application performance monitoring (APM)</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="apm-securing-apm-server.html">Secure communication with the Elastic Stack</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="apm-secure-agent-communication.html">Secure communication with APM agents</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Secret token</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.14/docs/en/observability/apm/secret-token.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="apm-secret-token"></a>Secret token<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.14/docs/en/observability/apm/secret-token.asciidoc">edit</a></h4>
</div></div></div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Secret tokens are sent as plain-text,
so they only provide security when used in combination with <a class="xref" href="apm-agent-tls.html" title="APM agent TLS communication">TLS</a>.</p>
</div>
</div>
<p>When defined, secret tokens are used to authorize requests to the APM Server.
Both the APM agent and APM Server must be configured with the same secret token for the request to be accepted.</p>
<p>To secure the communication between APM agents and the APM Server with a secret token:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Make sure <a class="xref" href="apm-agent-tls.html" title="APM agent TLS communication">TLS</a> is enabled
</li>
<li class="listitem">
<a class="xref" href="apm-secret-token.html#apm-create-secret-token" title="Create a secret token">Create a secret token</a>
</li>
<li class="listitem">
<a class="xref" href="apm-secret-token.html#apm-configure-secret-token" title="Configure the secret token in your APM agents">Configure the secret token in your APM agents</a>
</li>
</ol>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Secret tokens are not applicable for the RUM Agent,
as there is no way to prevent them from being publicly exposed.</p>
</div>
</div>
<h5><a id="apm-create-secret-token"></a>Create a secret token<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.14/docs/en/observability/apm/secret-token.asciidoc">edit</a></h5>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Elasticsearch Service and Elastic Cloud Enterprise deployments provision a secret token when the deployment is created.
The secret token can be found and reset in the Elastic Cloud console under <span class="strong strong"><strong>Deployments</strong></span>&#8201;&#8212;&#8201;<span class="strong strong"><strong>APM &amp; Fleet</strong></span>.</p>
</div>
</div>
<div class="tabs" data-tab-group="ts">
  <div role="tablist" aria-label="tls">
    <button role="tab"
            aria-selected="true"
            aria-controls="fm-tab-ts"
            id="fm-ts">
      Fleet-managed
    </button>
    <button role="tab"
            aria-selected="false"
            aria-controls="binary-tab-ts"
            id="binary-ts"
            tabindex="-1">
      APM Server binary
    </button>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="fm-tab-ts"
       aria-labelledby="fm-ts">
<p>Create or update a secret token in Fleet.</p>
<p>Configure and customize Fleet-managed APM settings directly in Kibana:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Open Kibana and navigate to <span class="strong strong"><strong>Fleet</strong></span>.
</li>
<li class="listitem">
Under the <span class="strong strong"><strong>Agent policies</strong></span> tab, select the policy you would like to configure.
</li>
<li class="listitem">
Find the Elastic APM integration and select <span class="strong strong"><strong>Actions</strong></span> &gt; <span class="strong strong"><strong>Edit integration</strong></span>.
</li>
<li class="listitem">
Navigate to <span class="strong strong"><strong>Agent authorization</strong></span> &gt; <span class="strong strong"><strong>Secret token</strong></span> and set the value of your token.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Save integration</strong></span>. The APM Server will restart before the change takes effect.
</li>
</ol>
</div>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="binary-tab-ts"
       aria-labelledby="binary-ts"
       hidden="">
<p>Set the secret token in <code class="literal">apm-server.yaml</code>:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">apm-server.auth.secret_token: &lt;secret-token&gt;</pre>
</div>
  </div>
</div>
<h5><a id="apm-configure-secret-token"></a>Configure the secret token in your APM agents<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.14/docs/en/observability/apm/secret-token.asciidoc">edit</a></h5>
<p>Each Elastic APM agent has a configuration option to set the value of the secret token:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Android agent</strong></span>: <a href="/guide/en/apm/agent/android/current/configuration.html" class="ulink" target="_top"><code class="literal">secretToken</code></a>
</li>
<li class="listitem">
<span class="strong strong"><strong>Go agent</strong></span>: <a href="/guide/en/apm/agent/go/current/configuration.html#config-secret-token" class="ulink" target="_top"><code class="literal">ELASTIC_APM_SECRET_TOKEN</code></a>
</li>
<li class="listitem">
<span class="strong strong"><strong>iOS agent</strong></span>: <a href="/guide/en/apm/agent/swift/1.x/configuration.html#secretToken" class="ulink" target="_top"><code class="literal">secretToken</code></a>
</li>
<li class="listitem">
<span class="strong strong"><strong>Java agent</strong></span>: <a href="/guide/en/apm/agent/java/current/config-reporter.html#config-secret-token" class="ulink" target="_top"><code class="literal">secret_token</code></a>
</li>
<li class="listitem">
<span class="strong strong"><strong>.NET agent</strong></span>: <a href="/guide/en/apm/agent/dotnet/current/config-reporter.html#config-secret-token" class="ulink" target="_top"><code class="literal">ELASTIC_APM_SECRET_TOKEN</code></a>
</li>
<li class="listitem">
<span class="strong strong"><strong>Node.js agent</strong></span>: <a href="/guide/en/apm/agent/nodejs/current/configuration.html#secret-token" class="ulink" target="_top"><code class="literal">Secret Token</code></a>
</li>
<li class="listitem">
<span class="strong strong"><strong>PHP agent</strong></span>: <a href="/guide/en/apm/agent/php/1.x/configuration-reference.html#config-secret-token" class="ulink" target="_top"><code class="literal">secret_token</code></a>
</li>
<li class="listitem">
<span class="strong strong"><strong>Python agent</strong></span>: <a href="/guide/en/apm/agent/python/current/configuration.html#config-secret-token" class="ulink" target="_top"><code class="literal">secret_token</code></a>
</li>
<li class="listitem">
<span class="strong strong"><strong>Ruby agent</strong></span>: <a href="/guide/en/apm/agent/ruby/current/configuration.html#config-secret-token" class="ulink" target="_top"><code class="literal">secret_token</code></a>
</li>
</ul>
</div>
<p>In addition to setting the secret token, ensure the configured server URL uses <code class="literal">HTTPS</code> instead of <code class="literal">HTTP</code>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Go agent</strong></span>: <a href="/guide/en/apm/agent/go/current/configuration.html#config-server-url" class="ulink" target="_top"><code class="literal">ELASTIC_APM_SERVER_URL</code></a>
</li>
<li class="listitem">
<span class="strong strong"><strong>Java agent</strong></span>: <a href="/guide/en/apm/agent/java/current/config-reporter.html#config-server-urls" class="ulink" target="_top"><code class="literal">server_urls</code></a>
</li>
<li class="listitem">
<span class="strong strong"><strong>.NET agent</strong></span>: <a href="/guide/en/apm/agent/dotnet/current/config-reporter.html#config-server-url" class="ulink" target="_top"><code class="literal">ServerUrl</code></a>
</li>
<li class="listitem">
<span class="strong strong"><strong>Node.js agent</strong></span>: <a href="/guide/en/apm/agent/nodejs/current/configuration.html#server-url" class="ulink" target="_top"><code class="literal">serverUrl</code></a>
</li>
<li class="listitem">
<span class="strong strong"><strong>PHP agent</strong></span>: <a href="/guide/en/apm/agent/php/1.x/configuration-reference.html#config-server-url" class="ulink" target="_top"><code class="literal">server_url</code></a>
</li>
<li class="listitem">
<span class="strong strong"><strong>Python agent</strong></span>: <a href="/guide/en/apm/agent/python/current/" class="ulink" target="_top"><code class="literal">server_url</code></a>
</li>
<li class="listitem">
<span class="strong strong"><strong>Ruby agent</strong></span>: <a href="/guide/en/apm/agent/ruby/current/configuration.html#config-server-url" class="ulink" target="_top"><code class="literal">server_url</code></a>
</li>
</ul>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="apm-api-key.html">« API keys</a>
</span>
<span class="next">
<a href="apm-anonymous-auth.html">Anonymous authentication »</a>
</span>
</div>
</body>
</html>
