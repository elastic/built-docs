<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Monitor nginx: Observe the logs and metrics of your nginx instances | Elastic Observability [8.14] | Elastic</title>
<meta class="elastic" name="content" content="Monitor nginx: Observe the logs and metrics of your nginx instances | Elastic Observability [8.14]">

<link rel="home" href="index.html" title="Elastic Observability [8.14]"/>
<link rel="up" href="observability-tutorials.html" title="Tutorials"/>
<link rel="prev" href="monitor-kubernetes.html" title="Monitor Kubernetes: Observe the health and performance of your Kubernetes deployments"/>
<link rel="next" href="monitor-azure-elastic-agent.html" title="Monitor Microsoft Azure with Elastic Agent"/>
<meta class="elastic" name="product_version" content="8.14"/>
<meta class="elastic" name="product_name" content="Observability"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Observability/Guide/8.14"/>
<meta name="DC.subject" content="Observability"/>
<meta name="DC.identifier" content="8.14"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body><div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Observability [8.14]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="observability-tutorials.html">Tutorials</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="monitor-kubernetes.html">« Monitor Kubernetes: Observe the health and performance of your Kubernetes deployments</a>
</span>
<span class="next">
<a href="monitor-azure-elastic-agent.html">Monitor Microsoft Azure with Elastic Agent »</a>
</span>
</div>
<div class="chapter">
<div class="titlepage"><div><div>
<h2 class="title"><a id="monitor-nginx"></a>Monitor nginx: Observe the logs and metrics of your nginx instances<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.14/docs/en/observability/monitor-nginx.asciidoc">edit</a></h2>
</div></div></div>

<div class="sidebar">
<div class="titlepage"></div>
<p><span class="strong strong"><strong>New to Elastic?</strong></span> Follow the steps in our <a href="/guide/en/starting-with-the-elasticsearch-platform-and-its-solutions/8.14/getting-started-observability.html" class="ulink" target="_top">getting started guide</a> instead of the steps described here.
Return to this tutorial after you&#8217;ve learned the basics.</p>
</div>
<p>Use the <a href="https://docs.elastic.co/integrations/nginx" class="ulink" target="_top">Nginx Elastic integration</a> and the Elastic Agent to collect valuable metrics and logs from your nginx instances. Then, use built-in dashboards and tools like Logs Explorer in Kibana allow you to visualize and monitor your nginx data from one place. This data provides valuable insight into your nginx instances—for example:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
A spike in error logs for a certain resource may mean you have a deleted resource that is still needed.
</li>
<li class="listitem">
Access logs can show when a service&#8217;s peak times are, and, from this, when it might be best to perform things like maintenance.
</li>
<li class="listitem">
A sudden spike in client requests may point to something malicious, like a DDoS attack.
</li>
</ul>
</div>
<h3><a id="monitor-nginx-what-youll-learn"></a>What you&#8217;ll learn<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.14/docs/en/observability/monitor-nginx.asciidoc">edit</a></h3>
<p>This guide walks you through using Elastic Observability to monitor your nginx instances, including:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Collecting logs and metrics from nginx instances using an Elastic Agent and the nginx integration.
</li>
<li class="listitem">
Centralizing the data in the Elastic Stack.
</li>
<li class="listitem">
Exploring the data in real time using tailored dashboards and Observability UIs.
</li>
</ul>
</div>
<h3><a id="monitor-nginx-data-types"></a>Data types<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.14/docs/en/observability/monitor-nginx.asciidoc">edit</a></h3>
<p>The nginx integration collects both logs and metrics.</p>
<div class="informaltable">
<table border="0" cellpadding="4px">
<colgroup>
<col/>
<col/>
</colgroup>
<tbody valign="top">
<tr>
<td valign="top">
<p>
<span class="strong strong"><strong>Logs</strong></span>
</p>
</td>
<td valign="top">
<p>
<p>
Collect logs to keep a record of events that happen in your nginx instances like when client requests and errors occur.
</p>
<p><span class="strong strong"><strong>Access logs</strong></span> provide information about each request processed by the nginx server. Use these logs for troubleshooting, monitoring performance, and analyzing user behavior.</p>
<p><span class="strong strong"><strong>Error logs</strong></span> provide diagnostic information about errors that occur when the nginx server is handling requests. Use these logs to understand why errors occur, assess error impact, and debug issues.</p>
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<span class="strong strong"><strong>Metrics</strong></span>
</p>
</td>
<td valign="top">
<p>
Collect metrics for insight into the state of your nginx instances.
This includes information like the total number of active client connections by status, the total number of client requests, and more.
Use these metrics to monitor server load, detect bottlenecks, understand client behavior, and plan for capacity.
</p>
</td>
</tr>
</tbody>
</table>
</div>
<h3><a id="monitor-nginx-prereqs"></a>Before you begin<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.14/docs/en/observability/monitor-nginx.asciidoc">edit</a></h3>
<p>Before you can monitor nginx, you need the following:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elasticsearch for storing and searching your observability data
</li>
<li class="listitem">
Kibana for visualizing and managing it.
</li>
<li class="listitem">
If you want to collect metrics, make sure your nginx instance is <a href="https://docs.nginx.com/nginx-amplify/nginx-amplify-agent/configuring-metric-collection/" class="ulink" target="_top">configured for metric collection</a>.
</li>
</ul>
</div>
<h3><a id="monitor-nginx-add-integration"></a>Step 1: Add the nginx integration<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.14/docs/en/observability/monitor-nginx.asciidoc">edit</a></h3>
<p>Follow these steps to add the nginx integration to your deployment:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Select <span class="strong strong"><strong>Add integrations</strong></span> from your deployment&#8217;s homepage.
</li>
<li class="listitem">
Enter "nginx" in the search bar, and select the <span class="strong strong"><strong>Nginx</strong></span> integration.
</li>
<li class="listitem">
Select <span class="strong strong"><strong>Add Nginx</strong></span> at the top of the integration page.
</li>
<li class="listitem">
Select <span class="strong strong"><strong>Add integration only (skip agent installation)</strong></span> at the bottom of the page.
</li>
</ol>
</div>
<h3><a id="monitor-nginx-configure-integration"></a>Step 2: Configure the nginx integration<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.14/docs/en/observability/monitor-nginx.asciidoc">edit</a></h3>
<p>The nginx integration can fetch different logs and metrics from your nginx instances.
From the <span class="strong strong"><strong>Add Nginx integration</strong></span> page, configure which logs and metrics you want the integration to collect.
Refer to the following sections for more information on configuring the integration.</p>
<h4><a id="monitor-nginx-collect-logs"></a>Collect logs<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.14/docs/en/observability/monitor-nginx.asciidoc">edit</a></h4>
<p>The nginx integration can collect access logs and error logs.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Access logs:</strong></span> Turn this option on to collect logs about client requests.
</li>
<li class="listitem">
<span class="strong strong"><strong>Error logs:</strong></span> Turn this option on to collect logs about issues nginx encounters with varying severity levels.
</li>
</ul>
</div>
<p>Configure the following for both access logs and error logs:</p>
<div class="informaltable">
<table border="0" cellpadding="4px">
<colgroup>
<col/>
<col/>
</colgroup>
<tbody valign="top">
<tr>
<td valign="top">
<p>
<span class="strong strong"><strong>Paths</strong></span>
</p>
</td>
<td valign="top">
<p>
The location of your logs.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<span class="strong strong"><strong>Preserve original event</strong></span>
</p>
</td>
<td valign="top">
<p>
Turn on to add a raw copy of the original event to the <code class="literal">event.original</code> field.
</p>
</td>
</tr>
</tbody>
</table>
</div>
<h4><a id="monitor-nginx-collect-metrics"></a>Collect metrics<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.14/docs/en/observability/monitor-nginx.asciidoc">edit</a></h4>
<p>The nginx integration collects <code class="literal">stub_status</code> metrics from your instances.
Make sure your nginx instance is <a href="https://docs.nginx.com/nginx-amplify/nginx-amplify-agent/configuring-metric-collection/" class="ulink" target="_top">configured for metric collection</a>.
Configure the following to collect metrics:</p>
<div class="informaltable">
<table border="0" cellpadding="4px">
<colgroup>
<col/>
<col/>
</colgroup>
<tbody valign="top">
<tr>
<td valign="top">
<p>
<span class="strong strong"><strong>Hosts</strong></span>
</p>
</td>
<td valign="top">
<p>
The address of the server that Elastic will connect to for collecting metrics.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<span class="strong strong"><strong>Period</strong></span>
</p>
</td>
<td valign="top">
<p>
How frequently to poll for metrics. The default is every 10 seconds.
</p>
</td>
</tr>
</tbody>
</table>
</div>
<h3><a id="monitor-nginx-add-agent"></a>Step 3: Add Elastic Agent<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.14/docs/en/observability/monitor-nginx.asciidoc">edit</a></h3>
<p>After you&#8217;ve configured your integration, you need to add an Elastic Agent to your host to collect data and send it to the Elastic Stack.
You have two options for adding the Elastic Agent, <span class="strong strong"><strong>enroll in Fleet</strong></span> or <span class="strong strong"><strong>run standalone</strong></span>.</p>
<div class="informaltable">
<table border="0" cellpadding="4px">
<colgroup>
<col/>
<col/>
</colgroup>
<tbody valign="top">
<tr>
<td valign="top">
<p>
<a class="xref" href="monitor-nginx.html#monitor-nginx-enroll-in-fleet" title="Enroll in Fleet"><span class="strong strong"><strong>Fleet</strong></span></a>
</p>
</td>
<td valign="top">
<p>
Enrolling in Fleet lets you automatically deploy updates and centrally manage the agent.
</p>
</td>
</tr>
<tr>
<td valign="top">
<p>
<a class="xref" href="monitor-nginx.html#monitor-nginx-run-standalone" title="Run standalone Elastic Agent"><span class="strong strong"><strong>Standalone</strong></span></a>
</p>
</td>
<td valign="top">
<p>
Standalone agents need to be manually updated on the host where the agent is installed.
</p>
</td>
</tr>
</tbody>
</table>
</div>
<p>For more on</p>
<h4><a id="monitor-nginx-enroll-in-fleet"></a>Enroll in Fleet<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.14/docs/en/observability/monitor-nginx.asciidoc">edit</a></h4>
<p>Follow the instructions from the <span class="strong strong"><strong>Add agent</strong></span> screen to install the Elastic Agent on your host:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Under <span class="strong strong"><strong>Enroll in Fleet?</strong></span>, make sure <span class="strong strong"><strong>Enroll in Fleet</strong></span> is selected.
</li>
<li class="listitem">
Under <span class="strong strong"><strong>Install Elastic Agent on your host</strong></span>, copy the command for your system and run it on your host. You can reuse the command on multiple hosts.
</li>
<li class="listitem">
After the agent starts on your host, you&#8217;ll see confirmation that the agent was enrolled in Fleet.
</li>
</ol>
</div>
<h4><a id="monitor-nginx-run-standalone"></a>Run standalone Elastic Agent<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.14/docs/en/observability/monitor-nginx.asciidoc">edit</a></h4>
<p>Before installing and running the standalone Elastic Agent, you need to create an API key.
To create an Elastic Cloud API key:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
From the Kibana menu, go to <span class="strong strong"><strong>Stack Management</strong></span> → <span class="strong strong"><strong>API keys</strong></span>.
</li>
<li class="listitem">
Select <span class="strong strong"><strong>Create API key</strong></span>.
</li>
<li class="listitem">
Give the key a name. For example, <code class="literal">nginx API key</code>.
</li>
<li class="listitem">
Leave the other default options and select <span class="strong strong"><strong>Create API key</strong></span>.
</li>
<li class="listitem">
In the <span class="strong strong"><strong>Create API key</strong></span> confirmation dialog, change the dropdown menu setting from <code class="literal">Encoded</code> to <code class="literal">Beats</code>.
This sets the API key format for communication between Elastic Agent (which is based on Beats) and Elasticsearch.
</li>
<li class="listitem">
Copy the generated API key and store it in a safe place.
</li>
</ol>
</div>
<p>After creating your API key, follow the instructions from the <span class="strong strong"><strong>Add agent</strong></span> screen to install the Elastic Agent on your host:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Under <span class="strong strong"><strong>Enroll in Fleet?</strong></span>, select <span class="strong strong"><strong>Run standalone</strong></span>.
</li>
<li class="listitem">
Under <span class="strong strong"><strong>Configure the agent</strong></span>, select <span class="strong strong"><strong>Download Policy</strong></span>. Save the <code class="literal">elastic-agent.yml</code> file to a directory on the host where you&#8217;ll install nginx for monitoring.
</li>
<li class="listitem">
<p>Open the policy file and notice that it contains all of the input, output, and other settings for the nginx and System integrations.</p>
<p>Replace:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">    username: '${ES_USERNAME}'
    password: '${ES_PASSWORD}'</pre>
</div>
<p>with:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">    api_key: '&lt;your-api-key&gt;'</pre>
</div>
<p>Where <code class="literal">your-api-key</code> is the key you created previously in this section.</p>
<p>If you already have a standalone agent installed on a host with an existing Elastic Agent policy, add the settings from the <span class="strong strong"><strong>Configure the agent</strong></span> step to your existing <code class="literal">elastic-agent.yml</code> file.</p>
</li>
<li class="listitem">
Under <span class="strong strong"><strong>Install Elastic Agent on your host</strong></span>, select the tab for your host operating system and run the commands on your host.
</li>
<li class="listitem">
<p>If you&#8217;re prompted with <code class="literal">Elastic Agent will be installed at {installation location} and will run as a service. Do you want to continue?</code> answer <code class="literal">Yes</code>.</p>
<p>If you&#8217;re prompted with <code class="literal">Do you want to enroll this Agent into Fleet?</code> answer <code class="literal">no</code>.</p>
</li>
<li class="listitem">
<p>Run the <code class="literal">status</code> command to confirm that Elastic Agent is running.</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">elastic-agent status

┌─ fleet
│  └─ status: (STOPPED) Not enrolled into Fleet
└─ elastic-agent
   └─ status: (HEALTHY) Running</pre>
</div>
</li>
</ol>
</div>
<h3><a id="monitor-nginx-explore-logs-and-metrics"></a>Step 4: Explore your logs and metrics<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.14/docs/en/observability/monitor-nginx.asciidoc">edit</a></h3>
<p>Use Kibana to view the metric and log data collected by Elastic Agent.
Refer to the following sections for more information on viewing your data:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="monitor-nginx.html#monitor-nginx-explore-metrics" title="View metrics">View metrics</a>
</li>
<li class="listitem">
<a class="xref" href="monitor-nginx.html#monitor-nginx-explore-logs" title="View logs">View logs</a>
</li>
</ul>
</div>
<h4><a id="monitor-nginx-explore-metrics"></a>View metrics<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.14/docs/en/observability/monitor-nginx.asciidoc">edit</a></h4>
<p>The nginx integration has a built-in dashboard that shows the full picture of your nginx metrics in one place.
To open the nginx dashboard:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Open the Kibana menu and go to <span class="strong strong"><strong>Management</strong></span> → <span class="strong strong"><strong>Integrations</strong></span> → <span class="strong strong"><strong>Installed integrations</strong></span>.
</li>
<li class="listitem">
Select the <span class="strong strong"><strong>Nginx</strong></span> card and open the <span class="strong strong"><strong>Assets</strong></span> tab.
</li>
<li class="listitem">
Select either the <code class="literal">[Metrics Nginx] Overview</code> dashboard.
</li>
</ol>
</div>
<p>The <span class="strong strong"><strong>Metrics Nginx overview</strong></span> shows visual representations of total requests, processed requests, heartbeat/up, active connections, reading/writing/waiting rates, request rate, accepts and handled rates, and drops rate.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/nginx-metrics-dashboard.png" alt="Nginx metrics dashboard" width="75%">
</div>
</div>
<h4><a id="monitor-nginx-explore-logs"></a>View logs<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.14/docs/en/observability/monitor-nginx.asciidoc">edit</a></h4>
<p>After your nginx logs are ingested, view and explore your logs using <a class="xref" href="monitor-nginx.html#monitor-nginx-logs-explorer" title="Logs Explorer">Logs Explorer</a> or the <a class="xref" href="monitor-nginx.html#monitor-nginx-logs-dashboard" title="Nginx logs dashboards">Nginx logs dashboards</a>.</p>
<h5><a id="monitor-nginx-logs-explorer"></a>Logs Explorer<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.14/docs/en/observability/monitor-nginx.asciidoc">edit</a></h5>
<p>With Logs Explorer, you can quickly search and filter your log data, get information about the structure of log fields, and display your findings in a visualization.
To view nginx logs, open Kibana and go to <span class="strong strong"><strong>Observability</strong></span> → <span class="strong strong"><strong>Logs Explorer</strong></span>.</p>
<p>Filter your results to see logs from the nginx integration from the data selector:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Under <span class="strong strong"><strong>Integrations</strong></span>, select <span class="strong strong"><strong>Nginx</strong></span>.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/nginx-data-selector.png" alt="nginx integration in the data selector" width="50%">
</div>
</div>
</li>
<li class="listitem">
Select either <span class="strong strong"><strong>access</strong></span> logs or <span class="strong strong"><strong>error</strong></span> logs to view the logs you&#8217;re looking for.
</li>
</ol>
</div>
<p>The <span class="strong strong"><strong>Documents</strong></span> table now shows your nginx logs:</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/nginx-logs-explorer.png" alt="Logs Explorer showing nginx error logs">
</div>
</div>
<h5><a id="monitor-nginx-logs-dashboard"></a>Nginx logs dashboards<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.14/docs/en/observability/monitor-nginx.asciidoc">edit</a></h5>
<p>The nginx integration has built-in dashboards that show the full picture of your nginx logs in one place.
To open the nginx dashboards:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Open the Kibana menu and go to <span class="strong strong"><strong>Management</strong></span> → <span class="strong strong"><strong>Integrations</strong></span> → <span class="strong strong"><strong>Installed integrations</strong></span>.
</li>
<li class="listitem">
Select the <span class="strong strong"><strong>Nginx</strong></span> card and open the <span class="strong strong"><strong>Assets</strong></span> tab.
</li>
<li class="listitem">
Select either the <code class="literal">[Logs Nginx] Overview</code> dashboard or the <code class="literal">[Logs Nginx] Access and error logs</code> dashboard.
</li>
</ol>
</div>
<p>The <span class="strong strong"><strong>Nginx logs overview</strong></span> dashboard shows visual representations of geographical log details, response codes over time, errors over time, the top pages sending logs, data volume, a breakdown of which operating systems are sending logs, and a breakdown of which browsers are sending logs.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/nginx-logs-overview-dashboard.png" alt="nginx logs overview dashboard" width="75%">
</div>
</div>
<p>The <span class="strong strong"><strong>Nginx access and error logs</strong></span> dashboard shows your access logs over time, and lists your access and error logs.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/nginx-logs-access-error-dashboard.png" alt="nginx access and error logs dashboard" width="75%">
</div>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="monitor-kubernetes.html">« Monitor Kubernetes: Observe the health and performance of your Kubernetes deployments</a>
</span>
<span class="next">
<a href="monitor-azure-elastic-agent.html">Monitor Microsoft Azure with Elastic Agent »</a>
</span>
</div>
</div>
</body>
</html>
