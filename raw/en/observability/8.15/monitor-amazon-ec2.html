<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Monitor Amazon Cloud Compute (EC2) | Elastic Observability [8.15] | Elastic</title>
<meta class="elastic" name="content" content="Monitor Amazon Cloud Compute (EC2) | Elastic Observability [8.15]">

<link rel="home" href="index.html" title="Elastic Observability [8.15]"/>
<link rel="up" href="monitor-aws-elastic-agent.html" title="Monitor Amazon Web Services (AWS) with Elastic Agent"/>
<link rel="prev" href="monitor-aws-elastic-agent.html" title="Monitor Amazon Web Services (AWS) with Elastic Agent"/>
<link rel="next" href="monitor-amazon-kinesis.html" title="Monitor Amazon Kinesis data streams"/>
<meta class="elastic" name="product_version" content="8.15"/>
<meta class="elastic" name="product_name" content="Observability"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Observability/Guide/8.15"/>
<meta name="DC.subject" content="Observability"/>
<meta name="DC.identifier" content="8.15"/>
</head>
<body>
<div class="navheader">
<span class="prev">
<a href="monitor-aws-elastic-agent.html">« Monitor Amazon Web Services (AWS) with Elastic Agent</a>
</span>
<span class="next">
<a href="monitor-amazon-kinesis.html">Monitor Amazon Kinesis data streams »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Observability [8.15]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="monitor-amazon-web-services.html">Amazon Web Services (AWS) monitoring</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="monitor-aws-elastic-agent.html">Monitor Amazon Web Services (AWS) with Elastic Agent</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Monitor Amazon Cloud Compute (EC2)</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/8.15/docs/en/observability/cloud-monitoring/aws/monitor-amazon-ec2.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="monitor-amazon-ec2"></a>Monitor Amazon Cloud Compute (EC2)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/8.15/docs/en/observability/cloud-monitoring/aws/monitor-amazon-ec2.asciidoc">edit</a></h3>
</div></div></div>

<p><a href="https://aws.amazon.com/ec2" class="ulink" target="_top">Elastic Compute Cloud (Amazon EC2)</a> enables
you to provision compute
resources, on demand, in the form of virtual servers called instances. A range
of instance types are available with different CPU, memory, storage, and
networking capacity. Popular preconfigured Amazon Machine Images (AMIs) are
available with Microsoft Windows and Linux distributions like Ubuntu, Red Hat
Enterprise Linux, CentOS, SUSE, Debian, and Amazon Linux. Amazon offers Amazon
Elastic Block Store (EBS) volumes to EC2 instances for persistent block-level
storage. EC2 can also be used with other AWS services like Auto Scaling.</p>
<p>Amazon EC2 instances can be run in various locations. The location is composed
of AWS Regions and Availability Zones (AZ). AZs are distinct locations that are
insulated from failures to other AZs, but provide lower latency network
connectivity. Each region is geographically dispersed and can consist of one or
more AZs.</p>
<p>Like most AWS services, Amazon EC2 sends its metrics to Amazon CloudWatch. The
Elastic <a href="https://docs.elastic.co/en/integrations/aws/ec2" class="ulink" target="_top">Amazon EC2 integration</a> collects metrics
from Amazon CloudWatch using Elastic Agent.</p>
<p>CloudWatch, by default, uses basic monitoring that publishes metrics at
five-minute intervals. You can enable detailed monitoring to increase that
resolution to one-minute, at an additional cost. To learn how to enable detailed
monitoring, refer to the
<a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-cloudwatch-new.html" class="ulink" target="_top">Amazon EC2 documentation</a>.</p>
<p>CloudWatch does not expose metrics related to EC2 instance memory. You can
install Elastic Agent on the EC2 instances to collect detailed system metrics.</p>
<h5><a id="get-started-ec2"></a>Get started<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/8.15/docs/en/observability/cloud-monitoring/aws/monitor-amazon-ec2.asciidoc">edit</a></h5>
<p>To collect EC2 metrics, you typically need to install the Elastic
<a href="https://docs.elastic.co/en/integrations/aws/ec2" class="ulink" target="_top">Amazon EC2 integration</a> and deploy an Elastic Agent.</p>
<p>Expand the <span class="strong strong"><strong>quick guide</strong></span> to learn how, or skip to the next section if your
data is already in Elasticsearch.</p>
<details>
<summary class="title"><span class="strong strong"><strong>Quick guide: Add data</strong></span></summary>
<div class="content">
<div class="sidebar">
<div class="titlepage"></div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Go to the Observability UI and click <span class="strong strong"><strong>Add integrations</strong></span>.
</li>
<li class="listitem">
In the query bar, search for and select the <span class="strong strong"><strong>Amazon EC2</strong></span>
integration.
</li>
<li class="listitem">
Read the overview to make sure you understand integration requirements and
other considerations.
</li>
<li class="listitem">
<p>Click <span class="strong strong"><strong>Add Amazon EC2</strong></span>.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>If you&#8217;re installing an integration for the first time, you may be prompted
to install Elastic Agent. If you see this page, click
<span class="strong strong"><strong>Add integration only (skip agent installation)</strong></span>.</p>
</div>
</div>
</li>
<li class="listitem">
Configure the integration name and optionally add a description. Make sure you
configure all required settings.
</li>
<li class="listitem">
<p>Choose where to add the integration policy.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If Elastic Agent is not already deployed locally or on an EC2 instance, click
<span class="strong strong"><strong>New hosts</strong></span> and enter a name for the new agent policy.
</li>
<li class="listitem">
Otherwise, click <span class="strong strong"><strong>Existing hosts</strong></span> and select an existing agent policy.
</li>
</ul>
</div>
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Save and continue</strong></span>. This step takes a minute or two to complete. When
it&#8217;s done, you&#8217;ll have an agent policy that contains an integration policy
for the configuration you just specified. If an Elastic Agent is already assigned to
the policy, you&#8217;re done. Otherwise, you need to deploy an Elastic Agent.
</li>
<li class="listitem">
<p>To deploy an Elastic Agent:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
In the popup, click <span class="strong strong"><strong>Add Elastic Agent to your hosts</strong></span> to open the <span class="strong strong"><strong>Add agent</strong></span>
flyout. If you accidentally close the popup or the flyout doesn&#8217;t open, go to
<span class="strong strong"><strong>Fleet &#8594; Agents</strong></span>, then click <span class="strong strong"><strong>Add agent</strong></span> to access the flyout.
</li>
<li class="listitem">
Follow the steps in the <span class="strong strong"><strong>Add agent</strong></span> flyout to download, install,
and enroll the Elastic Agent.
</li>
</ol>
</div>
</li>
<li class="listitem">
When incoming data is confirmed&#8212;&#8203;after a minute or two&#8212;&#8203;click <span class="strong strong"><strong>View assets</strong></span>
to access the dashboards.
</li>
</ol>
</div>
<p>For more information Elastic Agent and integrations, refer to the
<a href="/guide/en/fleet/8.15/index.html" class="ulink" target="_top">Fleet and Elastic Agent documentation</a>.</p>
</div>
</div>
</details>
<p>Elastic Agent is currently the preferred way to add EC2 metrics. For other
ways, refer to <a href="/guide/en/cloud/current/ec-cloud-ingest-data.html" class="ulink" target="_top">Adding data to Elasticsearch</a>.</p>
<h5><a id="dashboard-ec2"></a>Dashboards<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/8.15/docs/en/observability/cloud-monitoring/aws/monitor-amazon-ec2.asciidoc">edit</a></h5>
<p>{kibana-desc}
For example, to see an overview of your EC2 instance metrics in Kibana, go to
the <span class="strong strong"><strong>Dashboard</strong></span> app and navigate to the <span class="strong strong"><strong>[Metrics AWS] EC2 Overview</strong></span>
dashboard.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/ec2-overview-dashboard.png" alt="Screenshot showing the EC2 overview dashboard">
</div>
</div>
<h5><a id="_metrics_to_watch"></a>Metrics to watch<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/8.15/docs/en/observability/cloud-monitoring/aws/monitor-amazon-ec2.asciidoc">edit</a></h5>
<p>Amazon EC2 provides a large selection of instance types. Monitoring key metrics
about your instances is a cost-effective way to determine whether to upgrade,
change, or downsize your instances.</p>
<p>This section lists the key metrics that you should watch, organized by
category. For a full description of exported fields, refer to the
<a href="https://docs.elastic.co/en/integrations/aws/ec2" class="ulink" target="_top">Amazon EC2 integration docs</a>.</p>
<h6><a id="_cpu_utilization"></a>CPU utilization<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/8.15/docs/en/observability/cloud-monitoring/aws/monitor-amazon-ec2.asciidoc">edit</a></h6>
<p>Here are the key CPU utilization metrics you should monitor and what to look
for in these metrics:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">aws.ec2.metrics.CPUUtilization.avg</code>
</span>
</dt>
<dd>
<p>
This measures the percentage of allocated EC2 compute units that are currently
in use on the instance. Tracking this metric helps ensure that the instance is
sized appropriately for your workload. If you see degraded application
performance alongside continuously high levels of CPU usage (without any
accompanying constraints on network, disk I/O, or memory), CPU may be a resource
bottleneck. You can review application-level data using Application Performance
Monitoring and/or potentially switch to using an instance type with more vCPU.
</p>
<p>Very low usage of CPU utilization across your EC2 instances (for example, less
than 5% for multiple weeks) can also help you determine if your instances are
underutilized for your workload and potentially can be replaced with a smaller
instance type to save cost.</p>
</dd>
<dt>
<span class="term">
<code class="literal">aws.ec2.metrics.CPUCreditBalance.avg</code> &amp; <code class="literal">aws.ec2.metrics.CPUCreditUsage.avg</code>
</span>
</dt>
<dd>
<p>
The T instance family provides a baseline CPU performance with the ability to
burst above the baseline. These instances are ideal for applications that are
not generally CPU intensive but may benefit from higher CPU capacity for brief
intervals. Credits are earned any time the instance is running below its
baseline CPU performance level.
</p>
<p>Amazon EC2 CPU credit metrics help keep track of your available balance and
usage so that you are aware of possible charges as a result of extended
bursting. Monitoring your instances’ credit usage can help you identify if you
might need to switch to an instance type that is optimized for CPU-intensive
workloads.</p>
</dd>
<dt>
<span class="term">
<code class="literal">aws.ec2.metrics.CPUSurplusCreditBalance.avg</code> &amp; <code class="literal">aws.ec2.metrics.CPUSurplusCreditsCharged.avg</code>
</span>
</dt>
<dd>
<p>
A burstable performance instance configured as unlimited can sustain high CPU
utilization for any period of time whenever required. T4g, T3a, and T3 instances
launch as unlimited by default. If the average CPU usage over a 24-hour period
exceeds the baseline, you incur charges for surplus credits.
</p>
<p>The CPU surplus credit balance metric tracks the accumulated balance. The CPU
surplus credit charged measures extra credits that will result in additional
charges.</p>
</dd>
</dl>
</div>
<h6><a id="_disk_io"></a>Disk I/O<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/8.15/docs/en/observability/cloud-monitoring/aws/monitor-amazon-ec2.asciidoc">edit</a></h6>
<p>Amazon EC2 provides multiple data storage options for your instances including
Amazon EC2 instance store and Amazon Elastic Block Store (Amazon EBS).</p>
<p>An instance store provides temporary block-level storage for your instance and
is usually used for temporary storage of information such as buffers, caches,
scratch data, and other temporary content. The data in an instance store
persists only during the lifetime of its associated instance. When you stop,
hibernate, or terminate an instance, every block of storage in the instance
store is reset.</p>
<p>For valuable, long-term data, use more durable data storage, such as Amazon EBS.
EBS volumes attached to an instance are exposed as storage volumes that persist
independently from the life of the instance. EBS volumes are suited for use as
the primary storage for file systems or databases.</p>
<p>CloudWatch EC2 disk I/O metrics only collect data from instance store volumes.</p>
<p>CloudWatch EC2 namespace does offer a set of Amazon EBS disk I/O metrics, but
these are only available for instances built on the Nitro System. For all other
instance types, disk I/O for EBS volumes must be monitored via the Elastic
<a href="https://docs.elastic.co/en/integrations/aws/ebs" class="ulink" target="_top">Amazon EBS integration</a>.</p>
<p>Here are the key disk I/O metrics you should monitor and what to look for:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">aws.ec2.metrics.DiskReadBytes.sum</code> &amp; <code class="literal">aws.ec2.metrics.DiskWriteBytes.sum</code>
</span>
</dt>
<dt>
<span class="term">
<code class="literal">aws.ec2.metrics.DiskReadBytes.rate</code> &amp; <code class="literal">aws.ec2.metrics.DiskWriteBytes.rate</code>
</span>
</dt>
<dd>
<p>
Disk read and disk write bytes measure the number of bytes read from and written
to the instance store volumes attached to the EC2 instance. Monitoring these
metrics can help you understand application-level issues. Too much consistent
reading of data from disk may indicate that your application could benefit from
a caching layer. Lots of disk write for a long term could mean request queuing
and potential application slowdowns if the disk speed is not fast enough to
match the use case.
</p>
<p>Disk read bytes per second and disk write bytes per second provide the average
read/write data size for the specified period of time.</p>
</dd>
<dt>
<span class="term">
<code class="literal">aws.ec2.metrics.DiskReadOps.sum</code> &amp; <code class="literal">aws.ec2.metrics.DiskWriteOps.sum</code>
</span>
</dt>
<dt>
<span class="term">
<code class="literal">aws.ec2.metrics.DiskReadOps.rate</code> &amp; <code class="literal">aws.ec2.metrics.DiskWriteOps.rate</code>
</span>
</dt>
<dd>
<p>
Disk read/write operations count gives you insight into the average number of
read/write operations, which can help you determine if degraded performance is
the result of consistently high I/O operations per second (IOPS) causing
bottlenecks as disk requests become queued. If your instance volumes are HDD,
you can consider a move to faster SSD disks.
</p>
<p>Disk read/write operations count per second provides the average read/write IOPS
for the specified period of time.</p>
</dd>
</dl>
</div>
<h6><a id="_network"></a>Network<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/8.15/docs/en/observability/cloud-monitoring/aws/monitor-amazon-ec2.asciidoc">edit</a></h6>
<p>Network bandwidth is a key resource in cloud services. The available network
bandwidth of an EC2 instance depends on the number of vCPUs that the instance
has. It also depends upon the destination of the traffic, wherein full network
bandwidth is available to the instance within the region but only 50% to other
regions, based on use cases. The bandwidth can range from 5 to 25 Gbps. There is
also a limit on maximum transmission unit (MTU), or the largest amount of data
that can be sent in a single packet can range from 1,300 to 1,500 bytes. The
current generation instance types however do support jumbo frames with up to
9001 MTU thus increasing the payload size per packet and potentially reducing
overhead for applications that transmit large amounts of data.</p>
<p>AWS provides various configuration options like placement groups and enhanced
networking to optimize network performance.</p>
<p>Here are the key network metrics you should monitor and what to look for:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">aws.ec2.metrics.NetworkIn.sum</code> &amp; <code class="literal">aws.ec2.metrics.NetworkOut.sum</code>
</span>
</dt>
<dt>
<span class="term">
<code class="literal">aws.ec2.metrics.NetworkIn.rate</code> &amp; <code class="literal">aws.ec2.metrics.NetworkOut.rate</code>
</span>
</dt>
<dd>
<p>
These metrics report network throughput, in bytes, of your EC2 instance. Any
network drops or fluctuations can potentially be correlated to the application
metrics to find the root cause of possible issues. Any throughput limit may
indicate that the instance type may be mismatched with the application needs,
especially for data intensive applications.
</p>
<p>When looking at a set of EC2 instance data, if you see a considerable difference
in network traffic load, you may require a load balancer to distribute the load
more evenly across the related instances and be able to achieve better
performance.</p>
</dd>
</dl>
</div>
<h6><a id="_status_check"></a>Status check<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/8.15/docs/en/observability/cloud-monitoring/aws/monitor-amazon-ec2.asciidoc">edit</a></h6>
<p>Here are the key status check metrics you should monitor and what to look for:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">aws.ec2.metrics.StatusCheckFailed.avg</code>
</span>
</dt>
<dd>
<p>
This check reports whether the instance has passed both the instance status
check and the system status check. This check returns 0 (passed) if an instance
passes the system status check or 1 (failed) if it fails.
</p>
<p>The Elastic Amazon EC2 integration also collects important cloud metadata like
instance name (<code class="literal">cloud.instance.name=elastic-package-test-33138</code>), instance id
(<code class="literal">cloud.instance.id=i-0de58890d94dda2e3</code>), account name
(<code class="literal">cloud.account.name=elastic-beats</code>), account id
(<code class="literal">cloud.account.id=428152502467</code>), provider (<code class="literal">cloud.provider=aws</code>), region
(<code class="literal">cloud.region=us-east-1</code>), availability zone
(<code class="literal">cloud.availability_zone=us-east-1c</code>), and instance type
(<code class="literal">cloud.machine.type=t1.micro</code>). This metadata helps in grouping and filtering
collected data and helps drive various usage and performance trends across a set
of related EC2 instances.</p>
<p>The Elastic EC2 integration comes with a default dashboard that shows key
metrics like status check, CPU utilization, Disk I/O, and network throughput. It
also provides filtering for region, availability zone, and machine type.</p>
</dd>
<dt>
<span class="term">
<code class="literal">aws.ec2.metrics.StatusCheckFailed_Instance.avg</code>
</span>
</dt>
<dd>
<p>
This check monitors the software and network configuration of the instance.
Problems that can cause instance status checks to fail may include: incorrect
networking or startup configuration, exhausted memory, corrupted file system,
incompatible kernel, and so on. When an instance status check fails, you
typically must address the problem yourself. You may need to reboot the instance
or make instance configuration changes. To troubleshoot instances with failed
status checks, refer to the
<a href="https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/TroubleshootingInstances.html" class="ulink" target="_top">Amazon EC2 documentation</a>.
</p>
<p>This check returns 0 (passed) if an instance passes the system status check or 1
(failed) if it fails.</p>
</dd>
<dt>
<span class="term">
<code class="literal">aws.ec2.metrics.StatusCheckFailed_System.avg</code>
</span>
</dt>
<dd>
<p>
This status check detects underlying problems with your instance that require
AWS involvement to repair. Problems that can cause system status checks to fail
include: loss of network connectivity, loss of system power, and
hardware/software issues on the physical host. For instances backed by Amazon
EBS, you can stop and start the instance yourself, which in most cases results
in the instance being migrated to a new host. For instances backed by an
instance store, you can terminate and replace the instance. Note that instance
store volumes are ephemeral, and all data is lost when the instance is stopped.
</p>
<p>This check returns 0 (passed) if an instance passes the system status check or 1
(failed) if it fails.</p>
</dd>
</dl>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="monitor-aws-elastic-agent.html">« Monitor Amazon Web Services (AWS) with Elastic Agent</a>
</span>
<span class="next">
<a href="monitor-amazon-kinesis.html">Monitor Amazon Kinesis data streams »</a>
</span>
</div>
</body>
</html>
