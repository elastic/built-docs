<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Step 3: Install APM agents | Elastic Observability [8.16] | Elastic</title>
<meta class="elastic" name="content" content="Step 3: Install APM agents | Elastic Observability [8.16]">

<link rel="home" href="index.html" title="Elastic Observability [8.16]"/>
<link rel="up" href="get-started-with-fleet-apm-server.html" title="Fleet-managed APM Server"/>
<link rel="prev" href="add-apm-integration.html" title="Step 2: Add and configure the APM integration"/>
<link rel="next" href="_step_4_view_your_data.html" title="Step 4: View your data"/>
<meta class="elastic" name="product_version" content="8.16"/>
<meta class="elastic" name="product_name" content="Observability"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Observability/Guide/8.16"/>
<meta name="DC.subject" content="Observability"/>
<meta name="DC.identifier" content="8.16"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
This documentation contains work-in-progress information for future Elastic Stack and Cloud releases. Use the version selector to view supported release docs. It also contains some Elastic Cloud serverless information. Check out our <a href="https://www.elastic.co/docs/current/serverless">serverless docs</a> for more details.
</div>
<div class="navheader">
<span class="prev">
<a href="add-apm-integration.html">« Step 2: Add and configure the APM integration</a>
</span>
<span class="next">
<a href="_step_4_view_your_data.html">Step 4: View your data »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Observability [8.16]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="application-and-service-monitoring.html">Application and service monitoring</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="apm.html">Application performance monitoring (APM)</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="apm-getting-started-apm-server.html">Self manage APM Server</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="get-started-with-fleet-apm-server.html">Fleet-managed APM Server</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Step 3: Install APM agents</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.x/docs/en/observability/apm/getting-started-apm-server.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h5 class="title"><a id="_step_3_install_apm_agents"></a>Step 3: Install APM agents</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.x/docs/en/observability/apm/getting-started-apm-server.asciidoc">edit</a></div>
</div></div></div>
<p>APM agents are written in the same language as your service.
To monitor a new service, you must install the agent and configure it with a service name,
APM Server host, and Secret token.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Service name</strong></span>: The APM integration maps an instrumented service&#8217;s name–defined in each APM agent&#8217;s configuration–
to the index that its data is stored in Elasticsearch.
Service names are case-insensitive and must be unique.
For example, you cannot have a service named <code class="literal">Foo</code> and another named <code class="literal">foo</code>.
Special characters will be removed from service names and replaced with underscores (<code class="literal">_</code>).
</li>
<li class="listitem">
<span class="strong strong"><strong>APM Server URL</strong></span>: The host and port that APM Server listens for events on.
This should match the host and port defined when setting up the APM integration.
</li>
<li class="listitem">
<span class="strong strong"><strong>Secret token</strong></span>: Authentication method for APM agent and APM Server communication.
This should match the secret token defined when setting up the APM integration.
</li>
</ul>
</div>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>You can edit your APM integration settings if you need to change the APM Server URL
or secret token to match your APM agents.</p>
</div>
</div>
<div class="tabs" data-tab-group="apm-agent">
  <div role="tablist" aria-label="Install">
    <button role="tab"
            aria-selected="false"
            aria-controls="android-tab-install"
            id="android-install">
      Android
    </button>
    <button role="tab"
            aria-selected="false"
            aria-controls="go-tab-install"
            id="go-install"
            tabindex="-1">
      Go
    </button>
    <button role="tab"
            aria-selected="false"
            aria-controls="ios-tab-install"
            id="ios-install"
            tabindex="-1">
      iOS
    </button>
    <button role="tab"
            aria-selected="true"
            aria-controls="java-tab-install"
            id="java-install"
            tabindex="-1">
      Java
    </button>
    <button role="tab"
            aria-selected="false"
            aria-controls="net-tab-install"
            id="net-install"
            tabindex="-1">
      .NET
    </button>
    <button role="tab"
            aria-selected="false"
            aria-controls="node-tab-install"
            id="node-install"
            tabindex="-1">
      Node.js
    </button>
    <button role="tab"
            aria-selected="false"
            aria-controls="php-tab-install"
            id="php-install"
            tabindex="-1">
      PHP
    </button>
    <button role="tab"
            aria-selected="false"
            aria-controls="python-tab-install"
            id="python-install"
            tabindex="-1">
      Python
    </button>
    <button role="tab"
            aria-selected="false"
            aria-controls="ruby-tab-install"
            id="ruby-install"
            tabindex="-1">
      Ruby
    </button>
    <button role="tab"
        aria-selected="false"
        aria-controls="rum-tab-install"
        id="rum-install"
        tabindex="-1">
      RUM
    </button>
    <button role="tab"
        aria-selected="false"
        aria-controls="otel-tab-install"
        id="otel-install"
        tabindex="-1">
      OpenTelemetry
    </button>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="android-tab-install"
       aria-labelledby="android-install"
       hidden="">
<p><span class="strong strong"><strong>1. Add the agent to your project</strong></span></p>
<p>First, add the <a href="https://plugins.gradle.org/plugin/co.elastic.apm.android" class="ulink" target="_top">Elastic APM agent plugin</a> to your application&#8217;s <code class="literal">build.gradle</code> file as shown below:</p>
<div class="pre_wrapper lang-groovy">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-groovy">// Android app's build.gradle file
plugins {
    id "com.android.application"
    id "co.elastic.apm.android" version "[latest_version]" <a id="CO4-1"></a><i class="conum" data-value="1"></i>
}</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO4-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>The Elastic plugin declaration must be added below the Android app plugin declaration (<code class="literal">com.android.application</code>) and below the Kotlin plugin declaration (if used).</p>
</td>
</tr>
</table>
</div>
<p><span class="strong strong"><strong>2. Configure the agent</strong></span></p>
<p>After adding the agent plugin, configure it.
A minimal configuration sets the Elastic APM integration endpoint as shown below:</p>
<div class="pre_wrapper lang-groovy">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-groovy">// Android app's build.gradle file
plugins {
    //...
    id "co.elastic.apm.android" version "[latest_version]" <a id="CO5-1"></a><i class="conum" data-value="1"></i>
}

elasticApm {
    // Minimal configuration
    serverUrl = "https://your.elastic.server"

    // Optional
    serviceName = "your app name" <a id="CO5-2"></a><i class="conum" data-value="2"></i>
    serviceVersion = "0.0.0" <a id="CO5-3"></a><i class="conum" data-value="3"></i>
    apiKey = "your server api key" <a id="CO5-4"></a><i class="conum" data-value="4"></i>
    secretToken = "your server auth token" <a id="CO5-5"></a><i class="conum" data-value="5"></i>
}</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO5-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>You can find the latest version in the <a href="https://plugins.gradle.org/plugin/co.elastic.apm.android" class="ulink" target="_top">Gradle plugin portal</a>.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO5-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>Defaults to your <code class="literal">android.defaultConfig.applicationId</code> value.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO5-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>Defaults to your <code class="literal">android.defaultConfig.versionName</code> value.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO5-4"><i class="conum" data-value="4"></i></a></p>
</td>
<td align="left" valign="top">
<p>Defaults to null.
More info on API Keys <a href="/guide/en/elasticsearch/reference/8.16/security-api-create-api-key.html" class="ulink" target="_top">here</a>.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO5-5"><i class="conum" data-value="5"></i></a></p>
</td>
<td align="left" valign="top">
<p>Defaults to null.</p>
</td>
</tr>
</table>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>When both <code class="literal">secretToken</code> and <code class="literal">apiKey</code> are provided, apiKey has priority and secretToken is ignored.</p>
</div>
</div>
<p><span class="strong strong"><strong>3. Initialize the agent</strong></span></p>
<p>After syncing your project with the Gradle changes above, the Elastic APM agent needs to be initialized within your <a href="https://developer.android.com/reference/android/app/Application" class="ulink" target="_top">Application class</a>.
This example shows the simplest way to configure the agent:</p>
<div class="pre_wrapper lang-java">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-java">// Your Application class

class MyApp extends android.app.Application {

    @Override
    public void onCreate() {
        super.onCreate();
        ElasticApmAgent.initialize(this); <a id="CO6-1"></a><i class="conum" data-value="1"></i>
    }
}</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO6-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>Initialize the Elastic APM agent once.</p>
</td>
</tr>
</table>
</div>
<p>All that&#8217;s left is to compile and run your application.
That&#8217;s it!</p>
<p><span class="strong strong"><strong>Learn more in the agent reference</strong></span></p>
<p>Read more in the <a href="/guide/en/apm/agent/android/current/intro.html" class="ulink" target="_top">APM Android Agent Reference</a>.</p>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="go-tab-install"
       aria-labelledby="go-install"
       hidden="">
<p><span class="strong strong"><strong>1. Install the agent</strong></span></p>
<p>Install the Elastic APM Go agent package using <code class="literal">go get</code>:</p>
<div class="pre_wrapper lang-bash">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-bash">go get -u go.elastic.co/apm/v2</pre>
</div>
<p><span class="strong strong"><strong>2. Configure the agent</strong></span></p>
<p>To simplify development and testing,
the agent defaults to sending data to the Elastic APM integration at <code class="literal">http://localhost:8200</code>.
To send data to an alternative location, you must configure <code class="literal">ELASTIC_APM_SERVER_URL</code>.</p>
<div class="pre_wrapper lang-go">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-go"># The APM integration host and port
export ELASTIC_APM_SERVER_URL=

# If you do not specify `ELASTIC_APM_SERVICE_NAME`, the Go agent will use the
# executable name. For example, if your executable is called "my-app.exe", then your
# service will be identified as "my-app".
export ELASTIC_APM_SERVICE_NAME=

# Secret tokens are used to authorize requests to the APM integration
export ELASTIC_APM_SECRET_TOKEN=</pre>
</div>
<p><span class="strong strong"><strong>3. Instrument your application</strong></span></p>
<p>Instrumentation is the process of extending your application’s code to report trace data to Elastic APM. Go applications must be instrumented manually at the source code level. To instrument your applications, use one of the following approaches:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="/guide/en/apm/agent/go/2.x/builtin-modules.html" class="ulink" target="_top">Built-in instrumentation modules</a>.
</li>
<li class="listitem">
<a href="/guide/en/apm/agent/go/2.x/custom-instrumentation.html" class="ulink" target="_top">Custom instrumentation</a> and context propagation with the Go Agent API.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Learn more in the agent reference</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="/guide/en/apm/agent/go/2.x/supported-tech.html" class="ulink" target="_top">Supported technologies</a>
</li>
<li class="listitem">
<a href="/guide/en/apm/agent/go/2.x/configuration.html" class="ulink" target="_top">Advanced configuration</a>
</li>
<li class="listitem">
<a href="/guide/en/apm/agent/go/2.x/getting-started.html" class="ulink" target="_top">Detailed guide to instrumenting Go source code</a>
</li>
</ul>
</div>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="ios-tab-install"
       aria-labelledby="ios-install"
       hidden="">
<p><span class="strong strong"><strong>1. Add the agent dependency to your project</strong></span></p>
<p>Add the Elastic APM iOS Agent to your Xcode project or your <code class="literal">Package.swift</code>.</p>
<p>Here are instructions for adding a <a href="https://developer.apple.com/documentation/swift_packages/adding_package_dependencies_to_your_app" class="ulink" target="_top">package dependency</a> to a standard Xcode project.</p>
<p>Refer to <a href="https://developer.apple.com/documentation/xcode/creating_a_standalone_swift_package_with_xcode#3578941" class="ulink" target="_top"><em>Add a Dependency on Another Swift Package</em></a> for details about adding dependencies to your <code class="literal">Package.swift</code>.
Here is a helpful code-snippet:</p>
<div class="pre_wrapper lang-swift">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-swift">Package(
    dependencies:[
         .package(name: "apm-agent-ios", url: "https://github.com/elastic/apm-agent-ios.git", from: "1.0.0"),
    ],
  targets:[
    .target(
        name: "MyApp",
        dependencies: [
            .product(name: "ElasticApm", package: "apm-agent-ios")
        ]
    ),
])</pre>
</div>
<p><span class="strong strong"><strong>2. Initialize the agent</strong></span></p>
<p>If you&#8217;re using <code class="literal">SwiftUI</code> to build your app, add the following to your <code class="literal">App.swift</code>:</p>
<div class="pre_wrapper lang-swift">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-swift">import SwiftUI
import ElasticApm

class AppDelegate : NSObject, UIApplicationDelegate {
    func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey : Any]? = nil) -&gt; Bool {
        var config = AgentConfigBuilder()
            .withServerUrl(URL(string:"http://127.0.0.1:8200")) <a id="CO7-1"></a><i class="conum" data-value="1"></i>
            .withSecretToken("&lt;SecretToken&gt;") <a id="CO7-2"></a><i class="conum" data-value="2"></i>
            .build()

        ElasticApmAgent.start(with: config)
        return true
    }
}

@main
struct MyApp: App {
    @UIApplicationDelegateAdaptor(AppDelegate.self) var appDelegate
    init() {
    }
    var body: some Scene {
        WindowGroup {
            ContentView()
        }
    }
}</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO7-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>The APM integration host and port</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO7-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>Secret token for APM integration connection</p>
</td>
</tr>
</table>
</div>
<p>If you&#8217;re not using <code class="literal">SwiftUI</code>, you can alternatively add the same thing to your <code class="literal">AppDelegate.swift</code> file:</p>
<div class="pre_wrapper lang-swift">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-swift">import UIKit
import ElasticApm
@main
class AppDelegate: UIResponder, UIApplicationDelegate {
    func application(_ application: UIApplication, didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey: Any]?) -&gt; Bool {
var config = AgentConfigBuilder()
                       .withServerUrl(URL(string:"http://127.0.0.1:8200")) <a id="CO8-1"></a><i class="conum" data-value="1"></i>
                       .withSecretToken("&lt;SecretToken&gt;") <a id="CO8-2"></a><i class="conum" data-value="2"></i>
                       .build()
        ElasticApmAgent.start(with: config)
        return true
    }
}</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO8-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>The APM integration host and port</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO8-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>Secret token for APM integration connection</p>
</td>
</tr>
</table>
</div>
<p><span class="strong strong"><strong>Learn more in the agent reference</strong></span></p>
<p>Read more in the <a href="/guide/en/apm/agent/swift/current/intro.html" class="ulink" target="_top">APM iOS Agent Reference</a>.</p>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="java-tab-install"
       aria-labelledby="java-install">
<p>Manually set up and configure the agent with the <code class="literal">-javaagent</code> JVM option. No application code change is required, but this requires an
application restart. See below for more information on this setup method.</p>
<p><span class="strong strong"><strong>1. Download the APM agent</strong></span></p>
<p>The first step in getting started with the Elastic APM Java agent is to retrieve a copy of the agent JAR.
Java agent releases are published to <a href="https://repo.maven.apache.org/maven2/" class="ulink" target="_top">Maven central</a>. In order to get a copy you can either:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
download the <a href="https://oss.sonatype.org/service/local/artifact/maven/redirect?r=releases&amp;g=co.elastic.apm&amp;a=elastic-apm-agent&amp;v=LATEST" class="ulink" target="_top">latest agent</a>
or <a href="https://mvnrepository.com/artifact/co.elastic.apm/elastic-apm-agent" class="ulink" target="_top">previous releases</a> from Maven central.
</li>
<li class="listitem">
<p>download with <code class="literal">curl</code>:</p>
<div class="pre_wrapper lang-bash">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-bash">curl -o 'elastic-apm-agent.jar' -L 'https://oss.sonatype.org/service/local/artifact/maven/redirect?r=releases&amp;g=co.elastic.apm&amp;a=elastic-apm-agent&amp;v=LATEST'</pre>
</div>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>2. Add <code class="literal">-javaagent</code> flag</strong></span></p>
<p>When starting your application, add the JVM flag <code class="literal">-javaagent:/path/to/elastic-apm-agent-&lt;version&gt;.jar</code></p>
<p><span class="strong strong"><strong>3. Configure</strong></span></p>
<p>Different application servers have different ways of setting the <code class="literal">-javaagent</code> flag and system properties.
Start your application (for example a Spring Boot application or other embedded servers) and add the <code class="literal">-javaagent</code> JVM flag.
Use the <code class="literal">-D</code> prefix to configure the agent using system properties:</p>
<div class="pre_wrapper lang-bash">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-bash">java -javaagent:/path/to/elastic-apm-agent-&lt;version&gt;.jar -Delastic.apm.service_name=my-cool-service -Delastic.apm.application_packages=org.example,org.another.example -Delastic.apm.server_url=http://127.0.0.1:8200 -jar my-application.jar</pre>
</div>
<p>Refer to <a href="/guide/en/apm/agent/java/1.x/setup-javaagent.html" class="ulink" target="_top">Manual setup with <code class="literal">-javaagent</code> flag</a> to learn more.</p>
<p><span class="strong strong"><strong>Alternate setup methods</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Automatic setup with <code class="literal">apm-agent-attach-cli.jar</code></strong></span><br>
Automatically set up the agent without needing to alter the configuration of your JVM or application server. This method requires no changes to application code
or JVM options, and allows attaching to a running JVM. Refer to the <a href="/guide/en/apm/agent/java/1.x/setup-attach-cli.html" class="ulink" target="_top">Java agent documentation</a> for more information on this setup method.
</li>
<li class="listitem">
<span class="strong strong"><strong>Programmatic API setup to self-attach</strong></span><br>
Set up the agent with a one-line code change and an extra <code class="literal">apm-agent-attach</code> dependency. This method requires no changes to JVM options, and
the agent artifact is embedded within the packaged application binary. Refer to the <a href="/guide/en/apm/agent/java/1.x/setup-attach-api.html" class="ulink" target="_top">Java agent documentation</a> for more information on this setup method.
</li>
</ul>
</div>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="net-tab-install"
       aria-labelledby="net-install"
       hidden="">
<p><span class="strong strong"><strong>Set up the APM agent</strong></span></p>
<p>The .NET agent can be added to an application in a few different ways:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Profiler runtime instrumentation</strong></span>:
The agent supports auto instrumentation without any code change and without
any recompilation of your projects. See <a href="/guide/en/apm/agent/dotnet/1.x/setup-auto-instrumentation.html" class="ulink" target="_top">Profiler auto instrumentation</a>.
</li>
<li class="listitem">
<span class="strong strong"><strong>NuGet packages</strong></span>:
The agent ships as a set of <a href="/guide/en/apm/agent/dotnet/1.x/packages.html" class="ulink" target="_top">NuGet packages</a> available on <a href="https://nuget.org" class="ulink" target="_top">nuget.org</a>.
You can add the Agent and specific instrumentations to a .NET application by
referencing one or more of these packages and following the package documentation.
</li>
<li class="listitem">
<span class="strong strong"><strong>Host startup hook</strong></span>:
On .NET Core 3.0+ or .NET 5+, the agent supports auto instrumentation without any code change and without
any recompilation of your projects. See <a href="/guide/en/apm/agent/dotnet/1.x/setup-dotnet-net-core.html" class="ulink" target="_top">Zero code change setup on .NET Core</a>
for more details.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Learn more in the agent reference</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="/guide/en/apm/agent/dotnet/1.x/supported-technologies.html" class="ulink" target="_top">Supported technologies</a>
</li>
<li class="listitem">
<a href="/guide/en/apm/agent/dotnet/1.x/configuration.html" class="ulink" target="_top">Advanced configuration</a>
</li>
</ul>
</div>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="node-tab-install"
       aria-labelledby="node-install"
       hidden="">
<p><span class="strong strong"><strong>1. Install the APM agent</strong></span></p>
<p>Install the APM agent for Node.js as a dependency to your application.</p>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">npm install elastic-apm-node --save</pre>
</div>
<p><span class="strong strong"><strong>2. Initialization</strong></span></p>
<p>It&#8217;s important that the agent is started before you require <span class="strong strong"><strong>any</strong></span> other modules in your Node.js application - i.e. before <code class="literal">http</code> and before your router etc.</p>
<p>This means that you should probably require and start the agent in your application&#8217;s main file (usually <code class="literal">index.js</code>, <code class="literal">server.js</code> or <code class="literal">app.js</code>).</p>
<p>Here&#8217;s a simple example of how Elastic APM is normally required and started:</p>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">// Add this to the VERY top of the first file loaded in your app
var apm = require('elastic-apm-node').start({
  // Override service name from package.json
  // Allowed characters: a-z, A-Z, 0-9, -, _, and space
  serviceName: '',

  // Use if APM integration requires a token
  secretToken: '',

  // Use if APM integration uses API keys for authentication
  apiKey: '',

  // Set custom APM integration host and port (default: http://127.0.0.1:8200)
  serverUrl: '',
})</pre>
</div>
<p>The agent will now monitor the performance of your application and record any uncaught exceptions.</p>
<p><span class="strong strong"><strong>Learn more in the agent reference</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="/guide/en/apm/agent/nodejs/4.x/supported-technologies.html" class="ulink" target="_top">Supported technologies</a>
</li>
<li class="listitem">
<a href="/guide/en/apm/agent/nodejs/4.x/advanced-setup.html" class="ulink" target="_top">Babel/ES Modules</a>
</li>
<li class="listitem">
<a href="/guide/en/apm/agent/nodejs/4.x/configuring-the-agent.html" class="ulink" target="_top">Advanced configuration</a>
</li>
</ul>
</div>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="php-tab-install"
       aria-labelledby="php-install"
       hidden="">
<p><span class="strong strong"><strong>1. Install the agent</strong></span></p>
<p>Install the agent using one of the <a href="https://github.com/elastic/apm-agent-php/releases/latest" class="ulink" target="_top">packages for supported platforms</a>.</p>
<p>To use the RPM Package (RHEL/CentOS and Fedora):</p>
<div class="pre_wrapper lang-bash">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-bash">rpm -ivh &lt;package-file&gt;.rpm</pre>
</div>
<p>To use the DEB package (Debian and Ubuntu):</p>
<div class="pre_wrapper lang-bash">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-bash">dpkg -i &lt;package-file&gt;.deb</pre>
</div>
<p>To use the APK package (Alpine):</p>
<div class="pre_wrapper lang-bash">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-bash">apk add --allow-untrusted &lt;package-file&gt;.apk</pre>
</div>
<p>If you can’t find your distribution, you can install the agent by building it from the source.
The following instructions will build the APM agent using the same docker environment that Elastic uses to build our official packages.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The agent is currently only available for Linux operating system.</p>
</div>
</div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Download the agent source from <a href="https://github.com/elastic/apm-agent-php/" class="ulink" target="_top">https://github.com/elastic/apm-agent-php/</a>.
</li>
<li class="listitem">
Execute the following commands to build the agent and install it:
</li>
</ol>
</div>
<div class="pre_wrapper lang-bash">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-bash">cd apm-agent-php
# for linux glibc - libc distributions (Ubuntu, Redhat, etc)
export BUILD_ARCHITECTURE=linux-x86-64
# for linux with musl - libc distributions (Alpine)
export BUILD_ARCHITECTURE=linuxmusl-x86-64
# provide a path to php-config tool
export PHP_CONFIG=php-config

# build extensions
make -f .ci/Makefile build

# run extension tests
PHP_VERSION=`$PHP_CONFIG --version | cut -d'.' -f 1,2` make -f .ci/Makefile run-phpt-tests

# install agent extensions
sudo cp agent/native/_build/${BUILD_ARCHITECTURE}-release/ext/elastic_apm-*.so `$PHP_CONFIG --extension-dir`

# install automatic loader
sudo cp agent/native/_build/${BUILD_ARCHITECTURE}-release/loader/code/elastic_apm_loader.so `$PHP_CONFIG --extension-dir`</pre>
</div>
<p><span class="strong strong"><strong>2. Enable and configure the APM agent</strong></span></p>
<p>Enable and configure your agent inside of the <code class="literal">php.ini</code> file:</p>
<div class="pre_wrapper lang-ini">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ini">extension=elastic_apm_loader.so
elastic_apm.bootstrap_php_part_file=&lt;repo root&gt;/agent/php/bootstrap_php_part.php</pre>
</div>
<p><span class="strong strong"><strong>Learn more in the agent reference</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="/guide/en/apm/agent/php/1.x/supported-technologies.html" class="ulink" target="_top">Supported technologies</a>
</li>
<li class="listitem">
<a href="/guide/en/apm/agent/php/1.x/configuration.html" class="ulink" target="_top">Configuration</a>
</li>
</ul>
</div>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="python-tab-install"
       aria-labelledby="python-install"
       hidden="">
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Django
</span>
</dt>
<dd>
<p><span class="strong strong"><strong>1. Install the APM agent</strong></span></p>
<p>Install the APM agent for Python as a dependency.</p>
<div class="pre_wrapper lang-python">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-python">$ pip install elastic-apm</pre>
</div>
<p><span class="strong strong"><strong>2. Configure the agent</strong></span></p>
<p>Agents are libraries that run inside of your application process.
APM services are created programmatically based on the <code class="literal">SERVICE_NAME</code>.</p>
<div class="pre_wrapper lang-python">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-python"># Add the agent to the installed apps
INSTALLED_APPS = (
  'elasticapm.contrib.django',
  # ...
)

ELASTIC_APM = {
  # Set required service name. Allowed characters:
  # a-z, A-Z, 0-9, -, _, and space
  'SERVICE_NAME': '',

  # Use if APM integration requires a token
  'SECRET_TOKEN': '',

  # Set custom APM integration host and port (default: http://localhost:8200)
  'SERVER_URL': '',
}

# To send performance metrics, add our tracing middleware:
MIDDLEWARE = (
  'elasticapm.contrib.django.middleware.TracingMiddleware',
  #...
)</pre>
</div>
</dd>
<dt>
<span class="term">
Flask
</span>
</dt>
<dd>
<p><span class="strong strong"><strong>1. Install the APM agent</strong></span></p>
<p>Install the APM agent for Python as a dependency.</p>
<div class="pre_wrapper lang-python">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-python">$ pip install elastic-apm[flask]</pre>
</div>
<p><span class="strong strong"><strong>2. Configure the agent</strong></span></p>
<p>Agents are libraries that run inside of your application process.
APM services are created programmatically based on the <code class="literal">SERVICE_NAME</code>.</p>
<div class="pre_wrapper lang-python">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-python"># initialize using environment variables
from elasticapm.contrib.flask import ElasticAPM
app = Flask(__name__)
apm = ElasticAPM(app)

# or configure to use ELASTIC_APM in your application settings
from elasticapm.contrib.flask import ElasticAPM
app.config['ELASTIC_APM'] = {
  # Set required service name. Allowed characters:
  # a-z, A-Z, 0-9, -, _, and space
  'SERVICE_NAME': '',

  # Use if APM integration requires a token
  'SECRET_TOKEN': '',

  # Set custom APM integration host and port (default: http://localhost:8200)
  'SERVER_URL': '',
}

apm = ElasticAPM(app)</pre>
</div>
</dd>
</dl>
</div>
<p><span class="strong strong"><strong>Learn more in the agent reference</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="/guide/en/apm/agent/python/6.x/supported-technologies.html" class="ulink" target="_top">Supported technologies</a>
</li>
<li class="listitem">
<a href="/guide/en/apm/agent/python/6.x/configuration.html" class="ulink" target="_top">Advanced configuration</a>
</li>
</ul>
</div>
  </div>
  <div tabindex="0"
       role="tabpanel"
       id="ruby-tab-install"
       aria-labelledby="ruby-install"
       hidden="">
<p><span class="strong strong"><strong>1. Install the APM agent</strong></span></p>
<p>Add the agent to your Gemfile.</p>
<div class="pre_wrapper lang-ruby">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ruby">gem 'elastic-apm'</pre>
</div>
<p><span class="strong strong"><strong>2. Configure the agent</strong></span></p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Ruby on Rails
</span>
</dt>
<dd>
<p>APM is automatically started when your app boots.
Configure the agent by creating the config file <code class="literal">config/elastic_apm.yml</code>:</p>
<div class="pre_wrapper lang-ruby">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ruby"># config/elastic_apm.yml:

# Set service name - allowed characters: a-z, A-Z, 0-9, -, _ and space
# Defaults to the name of your Rails app
service_name: 'my-service'

# Use if APM integration requires a token
secret_token: ''

# Set custom APM integration host and port (default: http://localhost:8200)
server_url: 'http://localhost:8200'</pre>
</div>
</dd>
<dt>
<span class="term">
Rack
</span>
</dt>
<dd>
<p>For Rack or a compatible framework, like Sinatra, include the middleware in your app and start the agent.</p>
<div class="pre_wrapper lang-ruby">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ruby"># config.ru

app = lambda do |env|
  [200, {'Content-Type' =&gt; 'text/plain'}, ['ok']]
end

# Wraps all requests in transactions and reports exceptions
use ElasticAPM::Middleware

# Start an instance of the Agent
ElasticAPM.start(service_name: 'NothingButRack')

run app

# Gracefully stop the agent when process exits.
# Makes sure any pending transactions are sent.
at_exit { ElasticAPM.stop }</pre>
</div>
<p><span class="strong strong"><strong>Create a config file</strong></span></p>
<p>Create a config file config/elastic_apm.yml:</p>
<div class="pre_wrapper lang-ruby">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-ruby"># config/elastic_apm.yml:

# Set service name - allowed characters: a-z, A-Z, 0-9, -, _ and space
# Defaults to the name of your Rack app's class.
service_name: 'my-service'

# Use if APM integration requires a token
secret_token: ''

# Set custom APM integration host and port (default: http://localhost:8200)
server_url: 'http://localhost:8200'</pre>
</div>
</dd>
</dl>
</div>
<p><span class="strong strong"><strong>Learn more in the agent reference</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="/guide/en/apm/agent/ruby/4.x/supported-technologies.html" class="ulink" target="_top">Supported technologies</a>
</li>
<li class="listitem">
<a href="/guide/en/apm/agent/ruby/4.x/configuration.html" class="ulink" target="_top">Advanced configuration</a>
</li>
</ul>
</div>
  </div>
  <div tabindex="0"
      role="tabpanel"
      id="rum-tab-install"
      aria-labelledby="rum-install"
      hidden="">
<p><span class="strong strong"><strong>1. Enable Real User Monitoring (RUM)</strong></span></p>
<p>RUM is disabled by default. Enable it by setting <code class="literal">Enable RUM</code> to <code class="literal">true</code>.</p>
<p><span class="strong strong"><strong>2. Set up the agent</strong></span></p>
<p>Set up the agent with <code class="literal">&lt;script&gt;</code> tags or by using a bundler.</p>
<p><em>Synchronous / Blocking Pattern</em></p>
<p>Add a &lt;script&gt; tag to load the bundle and use the <code class="literal">elasticApm</code> global
object to initialize the agent:</p>
<div class="pre_wrapper lang-html">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-html">&lt;script src="https://&lt;your-cdn-host&gt;.com/path/to/elastic-apm-rum.umd.min-&lt;version&gt;.js" crossorigin&gt;&lt;/script&gt;
&lt;script&gt;
  elasticApm.init({
    serviceName: '&lt;instrumented-app&gt;',
    serverUrl: '&lt;apm-server-url&gt;',
  })
&lt;/script&gt;</pre>
</div>
<p><em>Asynchronous / Non-Blocking Pattern</em></p>
<p>Loading the script asynchronously ensures the agent script will not block other
resources on the page, however, it will still block browsers <code class="literal">onload</code> event.</p>
<div class="pre_wrapper lang-html">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-html">&lt;script&gt;
  ;(function(d, s, c) {
    var j = d.createElement(s),
      t = d.getElementsByTagName(s)[0]

    j.src = 'https://&lt;your-cdn-host&gt;.com/path/to/elastic-apm-rum.umd.min-&lt;version&gt;.js'
    j.onload = function() {elasticApm.init(c)}
    t.parentNode.insertBefore(j, t)
  })(document, 'script', {serviceName: '&lt;instrumented-app&gt;', serverUrl: '&lt;apm-server-url&gt;'})
&lt;/script&gt;</pre>
</div>
<p><em>Using Bundlers</em></p>
<p>Install the Real User Monitoring APM agent as a dependency to your application:</p>
<div class="pre_wrapper lang-bash">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-bash">npm install @elastic/apm-rum --save</pre>
</div>
<p>Configure the agent:</p>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">import { init as initApm } from '@elastic/apm-rum'

const apm = initApm({

  // Set required service name (allowed characters: a-z, A-Z, 0-9, -, _, and space)
  serviceName: '',

  // Set custom APM integration host and port (default: http://localhost:8200)
  serverUrl: 'http://localhost:8200',

  // Set service version (required for sourcemap feature)
  serviceVersion: ''
})</pre>
</div>
<p><span class="strong strong"><strong>Learn more in the agent reference</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="/guide/en/apm/agent/rum-js/5.x/supported-technologies.html" class="ulink" target="_top">Supported technologies</a>
</li>
<li class="listitem">
<a href="/guide/en/apm/agent/rum-js/5.x/configuration.html" class="ulink" target="_top">Advanced configuration</a>
</li>
</ul>
</div>
  </div>
  <div tabindex="0"
      role="tabpanel"
      id="otel-tab-install"
      aria-labelledby="otel-install"
      hidden="">
<p>Elastic integrates with OpenTelemetry, allowing you to reuse your existing instrumentation
to easily send observability data to the Elastic Stack.</p>
<p>For more information on how to combine Elastic and OpenTelemetry,
see <a href="/guide/en/observability/8.16/apm-open-telemetry.html" class="ulink" target="_top">OpenTelemetry integration</a>.</p>
  </div>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="add-apm-integration.html">« Step 2: Add and configure the APM integration</a>
</span>
<span class="next">
<a href="_step_4_view_your_data.html">Step 4: View your data »</a>
</span>
</div>
</body>
</html>
