<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Cross-cluster search with application data | Elastic Observability [8.18] | Elastic</title>
<meta class="elastic" name="content" content="Cross-cluster search with application data | Elastic Observability [8.18]">

<link rel="home" href="index.html" title="Elastic Observability [8.18]"/>
<link rel="up" href="apm-filter-and-search-data.html" title="Filter and search application data"/>
<link rel="prev" href="apm-advanced-queries.html" title="Use advanced queries on your application data"/>
<link rel="next" href="apm-interpret-data.html" title="Interpret application data"/>
<meta class="elastic" name="product_version" content="8.18"/>
<meta class="elastic" name="product_name" content="Observability"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Observability/Guide/8.18"/>
<meta name="DC.subject" content="Observability"/>
<meta name="DC.identifier" content="8.18"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
This documentation contains work-in-progress information for future Elastic Stack and Cloud releases. Use the version selector to view supported release docs. It also contains some Elastic Cloud serverless information. Check out our <a href="https://www.elastic.co/docs/current/serverless">serverless docs</a> for more details.
</div>
<div class="navheader">
<span class="prev">
<a href="apm-advanced-queries.html">« Use advanced queries on your application data</a>
</span>
<span class="next">
<a href="apm-interpret-data.html">Interpret application data »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Observability [8.18]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="application-and-service-monitoring.html">Application and service monitoring</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="apm.html">Application performance monitoring (APM)</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="apm-view-and-analyze-data.html">View and analyze data</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="apm-filter-and-search-data.html">Filter and search application data</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Cross-cluster search with application data</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.18/docs/en/observability/apm/view-and-analyze/filter-and-search/cross-cluster-search.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h5 class="title"><a id="apm-cross-cluster-search"></a>Cross-cluster search with application data</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.18/docs/en/observability/apm/view-and-analyze/filter-and-search/cross-cluster-search.asciidoc">edit</a></div>
</div></div></div>

<p>Elastic APM utilizes Elasticsearch&#8217;s cross-cluster search functionality.
Cross-cluster search lets you run a single search request against one or more
<a href="/guide/en/elasticsearch/reference/8.18/modules-remote-clusters.html" class="ulink" target="_top">remote clusters</a>&#8201;&#8212;&#8201;making it easy to search APM data across multiple sources.
This means you can also have deployments per data type, making sizing and scaling more predictable,
and allowing for better performance while managing multiple observability use cases.</p>
<div class="position-relative"><h7><a id="apm-set-up-cross-cluster-search"></a>Set up cross-cluster search</h7><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.18/docs/en/observability/apm/view-and-analyze/filter-and-search/cross-cluster-search.asciidoc">edit</a></div>
<p><span class="strong strong"><strong>Step 1. Set up remote clusters.</strong></span></p>
<p>If you&#8217;re using the Hosted Elasticsearch Service, see <a href="/guide/en/cloud/current/ec-enable-ccs.html" class="ulink" target="_top">Enable cross-cluster search</a>.</p>
<p>To add remote clusters directly in Kibana, find <code class="literal">Remote Clusters</code> in the <a href="/guide/en/kibana/8.18/introduction.html#kibana-navigation-search" class="ulink" target="_top">global search field</a>.
All you need is a name for the remote cluster and the seed node(s).
Remember the names of your remote clusters, you&#8217;ll need them in step two.
See <a href="/guide/en/elasticsearch/reference/8.18/ccr-getting-started.html" class="ulink" target="_top">managing remote clusters</a> for detailed information on the setup process.</p>
<p>Alternatively, you can <a href="/guide/en/elasticsearch/reference/8.18/modules-remote-clusters.html#configuring-remote-clusters" class="ulink" target="_top">configure remote clusters</a>
in Elasticsearch&#8217;s <code class="literal">elasticsearch.yml</code> file.</p>
<p><span class="strong strong"><strong>Step 2. Edit the default Applications UI data views.</strong></span></p>
<p>Applications UI data views determine which clusters and indices to display data from.
Data views follow this convention: <code class="literal">&lt;cluster-name&gt;:&lt;index-pattern&gt;</code>.</p>
<p>To display data from all remote clusters and the local cluster,
duplicate and prepend the defaults with <code class="literal">*:</code>.
For example, the default data view for Error indices is <code class="literal">logs-apm*,apm*</code>.
To add all remote clusters, change this to <code class="literal">*:logs-apm*,*:apm*,logs-apm*,apm*</code></p>
<p>You can also specify certain clusters to display data from, for example,
<code class="literal">cluster-one:logs-apm*,cluster-one:apm*,logs-apm*,apm*</code>.</p>
<p>There are two ways to edit the default data view:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
In the Applications UI&#8201;&#8212;&#8201;Find <span class="strong strong"><strong>Applications</strong></span> in the main menu or use the <a href="/guide/en/kibana/8.18/introduction.html#kibana-navigation-search" class="ulink" target="_top">global search field</a>.
Go to <span class="strong strong"><strong>Settings</strong></span> → <span class="strong strong"><strong>Indices</strong></span> and change all <code class="literal">xpack.apm.indices.*</code> values to include remote clusters.
</li>
<li class="listitem">
In <code class="literal">kibana.yml</code>&#8201;&#8212;&#8201;Update the <a href="/guide/en/kibana/8.18/apm-settings-kb.html" class="ulink" target="_top"><code class="literal">xpack.apm.indices.*</code></a> configuration values to
include remote clusters.
</li>
</ul>
</div>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p class="admon_title">Exclude data tiers from search</p>
<p>In a cross-cluster search (CCS) environment, it&#8217;s possible for different clusters to serve different data tiers in responses.
If one of the requested clusters responds slowly, it can cause a timeout at the proxy after 320 seconds.
This results in 502 Bad Gateway server error responses presented as failure toast messages in the UI, and no data loaded.</p>
<p>To prevent this, you can exclude <a href="/guide/en/elasticsearch/reference/8.18/data-tiers.html" class="ulink" target="_top">data tiers</a> that might slow down responses from search: the <code class="literal">data_frozen</code> and <code class="literal">data_cold</code> tiers. To exclude data tiers from search in the APM UI:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
To open <span class="strong strong"><strong>Advanced settings</strong></span>, find <span class="strong strong"><strong>Stack Management</strong></span> in the main menu or use the <a href="/guide/en/kibana/8.18/introduction.html#kibana-navigation-search" class="ulink" target="_top">global search field</a>.
</li>
<li class="listitem">
In the <span class="strong strong"><strong>Observability</strong></span> section, update the <span class="strong strong"><strong>Excluded data tiers from search</strong></span> option with a list of data tiers.
</li>
</ol>
</div>
</div>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="apm-advanced-queries.html">« Use advanced queries on your application data</a>
</span>
<span class="next">
<a href="apm-interpret-data.html">Interpret application data »</a>
</span>
</div>
</body>
</html>
