<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="description" content="Learn configuration options for Elastic Serverless Forwarder and how to transform your AWS data as it is collected from Amazon Web Services (AWS).">
<meta name="keywords" content="serverless">
<title>JSON content discovery | Observability Guide [8.4] | Elastic</title>
<meta class="elastic" name="content" content="JSON content discovery | Observability Guide [8.4]">

<link rel="home" href="index.html" title="Observability Guide [8.4]"/>
<link rel="up" href="aws-elastic-serverless-forwarder-configuration.html" title="Configuration options for Elastic Serverless Forwarder"/>
<link rel="prev" href="aws-serverless-use-tags-filters.html" title="Use tags and filters"/>
<link rel="next" href="aws-serverless-manage-multiline-messages.html" title="Manage multiline messages"/>
<meta class="elastic" name="product_version" content="8.4"/>
<meta class="elastic" name="product_name" content="Observability"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Observability/Guide/8.4"/>
<meta name="DC.subject" content="Observability"/>
<meta name="DC.identifier" content="8.4"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body><div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Observability Guide [8.4]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="add-observability-data.html">Send data to Elasticsearch</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="aws-elastic-serverless-forwarder.html">Elastic Serverless Forwarder for AWS</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="aws-elastic-serverless-forwarder-configuration.html">Configuration options for Elastic Serverless Forwarder</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="aws-serverless-use-tags-filters.html">« Use tags and filters</a>
</span>
<span class="next">
<a href="aws-serverless-manage-multiline-messages.html">Manage multiline messages »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="aws-serverless-json-content"></a>JSON content discovery<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.4/docs/en/observability/aws-elastic-serverless-forwarder-configuration.asciidoc">edit</a></h4>
</div></div></div>
<p>The Elastic Serverless Forwarder is able to automatically discover JSON content in the payload of an input and collect the JSON objects contained in the payload.</p>
<p>The JSON objects can either be on a single line or spanning multiple lines. In the second case, the forwarder expects different JSON objects spanning multiple lines to be separated by a newline delimiter.</p>
<p>When JSON objects span multiple lines, a limit of 1000 lines is applied. Every JSON object spanning across more than 1000 lines will not be collected. Every line composing the whole JSON object will be forwarded individually instead.</p>
<p>If you have known payload content which includes single JSON objects that span more than 1000 lines, or if you find that relying on auto-discovery of JSON content has a big impact on performance, you can configure JSON content types within the inputs to address this. This will change the parsing logic and improve performance while overcoming the 1000 lines limit.</p>
<p>Where content is known to be plain text, you can improve overall performance by disabling automatic JSON content discovery completely.</p>
<p>To change this configuration option, set <code class="literal">inputs.[].json_content_type</code> to one of the following values:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>single</strong></span>: indicates that the content of a single item in the input payload is a single JSON object. The content can either be on a single line or spanning multiple lines. With this setting the whole content of the payload is decoded as a JSON object, with no limit on the number of lines the JSON object spans.
</li>
<li class="listitem">
<span class="strong strong"><strong>ndjson</strong></span>: indicates that the content of a single item in the input payload is a valid NDJSON format. Multiple single JSON objects formatted on a single line should be separated by a newline delimiter. With this setting each line will be decoded as JSON object, which improves the parsing performance.
</li>
<li class="listitem">
<span class="strong strong"><strong>disabled</strong></span>: instructs the forwarder not to attempt any automatic JSON content discovery and instead treat the content as plain text, which improves the parsing performance.
</li>
</ul>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>There is no need to configure the JSON content type when <a class="xref" href="aws-serverless-json-content.html#expanding-events-from-json-object-lists" title="Expanding events from JSON object lists">Expanding events from JSON object lists</a>, unless you have single JSON objects that span more than 1000 lines.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h5 class="title"><a id="expanding-events-from-json-object-lists"></a>Expanding events from JSON object lists<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.4/docs/en/observability/aws-elastic-serverless-forwarder-configuration.asciidoc">edit</a></h5>
</div></div></div>
<p>You can extract a list of events to be ingested from a specific field in the JSON file.</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">inputs:
  - type: "s3-sqs"
    id: "arn:aws:sqs:%REGION%:%ACCOUNT%:%QUEUENAME%"
    expand_event_list_from_field: "Records"
    outputs:
      - type: "elasticsearch"
        args:
          elasticsearch_url: "arn:aws:secretsmanager:eu-central-1:123456789:secret:es_url"
          username: "arn:aws:secretsmanager:eu-west-1:123456789:secret:es_secrets:username"
          password: "arn:aws:secretsmanager:eu-west-1:123456789:secret:es_secrets:password"
          es_datastream_name: "logs-generic-default"</pre>
</div>
<p>You can define <code class="literal">inputs.[].expand_event_list_from_field</code> as a string with the value of a key in the JSON that contains a list of elements that must be sent as events instead of the encompassing JSON.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>When <a class="xref" href="aws-serverless-route-service-logs.html" title="Route AWS service logs">routing service logs</a>, any value set for the <code class="literal">expand_event_list_from_field</code> configuration parameter will be ignored, because this will be automatically handled by the Elastic Serverless Forwarder.</p>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h5 class="title"><a id="_example"></a>Example<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.4/docs/en/observability/aws-elastic-serverless-forwarder-configuration.asciidoc">edit</a></h5>
</div></div></div>
<p>With the following input:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{"Records":[{"key": "value #1"},{"key": "value #2"}]}
{"Records":[{"key": "value #3"},{"key": "value #4"}]}</pre>
</div>
<p>Without setting <code class="literal">expand_event_list_from_field</code>, two events will be forwarded:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{"@timestamp": "2022-06-16T04:06:03.064Z", "message": "{\"Records\":[{\"key\": \"value #1\"},{\"key\": \"value #2\"}]}"}
{"@timestamp": "2022-06-16T04:06:13.888Z", "message": "{\"Records\":[{\"key\": \"value #3\"},{\"key\": \"value #4\"}]}"}</pre>
</div>
<p>If <code class="literal">expand_event_list_from_field</code> is set to <code class="literal">Records</code>, four events will be forwarded:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{"@timestamp": "2022-06-16T04:06:21.105Z", "message": "{\"key\": \"value #1\"}"}
{"@timestamp": "2022-06-16T04:06:27.204Z", "message": "{\"key\": \"value #2\"}"}
{"@timestamp": "2022-06-16T04:06:31.154Z", "message": "{\"key\": \"value #3\"}"}
{"@timestamp": "2022-06-16T04:06:36.189Z", "message": "{\"key\": \"value #4\"}"}</pre>
</div>
</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="aws-serverless-use-tags-filters.html">« Use tags and filters</a>
</span>
<span class="next">
<a href="aws-serverless-manage-multiline-messages.html">Manage multiline messages »</a>
</span>
</div>
</div>
</body>
</html>
