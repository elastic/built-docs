<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="description" content="Deploy the Elastic Serverless Forwarder using Kibana and the AWS Serverless Application Repository (SAR).">
<meta name="keywords" content="serverless, AWS, SAR">
<title>Deploy Elastic Serverless Forwarder directly | Observability Guide [8.5] | Elastic</title>
<meta class="elastic" name="content" content="Deploy Elastic Serverless Forwarder directly | Observability Guide [8.5]">

<link rel="home" href="index.html" title="Observability Guide [8.5]"/>
<link rel="up" href="aws-deploy-elastic-serverless-forwarder.html" title="Deploy Elastic Serverless Forwarder"/>
<link rel="prev" href="aws-serverless-forwarder-deploy-sar.html" title="Deploy Elastic Serverless Forwarder from SAR"/>
<link rel="next" href="aws-elastic-serverless-forwarder-configuration.html" title="Configuration options for Elastic Serverless Forwarder"/>
<meta class="elastic" name="product_version" content="8.5"/>
<meta class="elastic" name="product_name" content="Observability"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Observability/Guide/8.5"/>
<meta name="DC.subject" content="Observability"/>
<meta name="DC.identifier" content="8.5"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body><div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Observability Guide [8.5]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="add-observability-data.html">Send data to Elasticsearch</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="aws-elastic-serverless-forwarder.html">Elastic Serverless Forwarder for AWS</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="aws-deploy-elastic-serverless-forwarder.html">Deploy Elastic Serverless Forwarder</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="aws-serverless-forwarder-deploy-sar.html">« Deploy Elastic Serverless Forwarder from SAR</a>
</span>
<span class="next">
<a href="aws-elastic-serverless-forwarder-configuration.html">Configuration options for Elastic Serverless Forwarder »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="aws-serverless-forwarder-direct-deploy"></a>Deploy Elastic Serverless Forwarder directly<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.5/docs/en/observability/aws-deploy-elastic-serverless-forwarder.asciidoc">edit</a></h4>
</div></div></div>
<p>For more customisation options during deployment, from version <code class="literal">1.6.0</code> and above you can deploy the Elastic Serverless Forwarder directly to your AWS Account without using SAR. This enables you to customize the event source settings for the inputs (i.e. triggers) one-by-one.</p>
<p>To deploy the forwarder directly, you have to:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="aws-serverless-forwarder-deploy-kibana.html" title="Install AWS integration assets in Kibana">Install AWS integration assets in Kibana</a>
</li>
<li class="listitem">
<a class="xref" href="sample-s3-config-file.html" title="Create and upload config.yaml to S3 bucket">Create and upload <code class="literal">config.yaml</code> to S3 bucket</a>
</li>
<li class="listitem">
<a class="xref" href="aws-serverless-forwarder-direct-deploy.html#sample-direct-publish-config-file" title="Create publish-config.yaml for the publishing script">Create <code class="literal">publish-config.yaml</code> for the publishing script</a>
</li>
<li class="listitem">
<a class="xref" href="aws-serverless-forwarder-direct-deploy.html#aws-serverless-forwarder-run-publish-script" title="Run the publishing script">Run the publishing script</a>
</li>
</ul>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h5 class="title"><a id="sample-direct-publish-config-file"></a>Create <code class="literal">publish-config.yaml</code> for the publishing script<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.5/docs/en/observability/aws-deploy-elastic-serverless-forwarder.asciidoc">edit</a></h5>
</div></div></div>
<p>To deploy the forwarder directly, you need to define a <code class="literal">publish-config.yaml</code> file and pass this as an argument in the <a class="xref" href="aws-serverless-forwarder-direct-deploy.html#aws-serverless-forwarder-run-publish-script" title="Run the publishing script">publishing script</a>.</p>
<p>Save the following YAML content as <code class="literal">publish-config.yaml</code> and edit as required before running the publishing script. You should remove any inputs or arguments you are not using.</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">kinesis-data-stream:
    - arn: "arn:aws:kinesis:%REGION%:%ACCOUNT%:stream/%STREAMNAME%"
      batch_size: 10
      batching_window_in_second: 0
      starting_position: TRIM_HORIZON
      starting_position_timestamp: 0
      parallelization_factor: 1
sqs:
    - arn: "arn:aws:sqs:%REGION%:%ACCOUNT%:%QUEUENAME%"
      batch_size: 10
      batching_window_in_second: 0
s3-sqs:
    - arn: "arn:aws:sqs:%REGION%:%ACCOUNT%:%QUEUENAME%"
      batch_size: 10
      batching_window_in_second: 0
cloudwatch-logs:
    - arn: "arn:aws:logs:%AWS_REGION%:%AWS_ACCOUNT_ID%:log-group:%LOG_GROUP_NAME%:*"
    - arn: "arn:aws:logs:%AWS_REGION%:%AWS_ACCOUNT_ID%:log-group:%LOG_GROUP_NAME%:log-stream:%LOG_STREAM_NAME%"
ssm-secrets:
  - "arn:aws:secretsmanager:%AWS_REGION%:%AWS_ACCOUNT_ID%:secret:%SECRET_NAME%"
kms-keys:
    - "arn:aws:kms:%AWS_REGION%:%AWS_ACCOUNT_ID%:key/%KMS_KEY_UUID%"
s3-buckets:
    - "arn:aws:s3:::%BUCKET_NAME%"
subnets:
    - "%SUBNET_ID%"
security-groups:
    - "%SECURITY_ID%"
s3-config-file: "s3://%S3_CONFIG_BUCKET_NAME%/%S3_CONFIG_OBJECT_KEY%"
continuing-queue:
    batch_size: 10
    batching_window_in_second: 0</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h5 class="title"><a id="direct-publish-config-file-fields"></a>Fields<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.5/docs/en/observability/aws-deploy-elastic-serverless-forwarder.asciidoc">edit</a></h5>
</div></div></div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">kinesis-data-stream.[]</code></p></td>
<td align="left" valign="top"><p>List of <a class="xref" href="aws-elastic-serverless-forwarder.html#aws-serverless-forwarder-inputs-kinesis" title="Amazon Kinesis Data Streams">Amazon Kinesis Data Streams</a> (i.e. triggers) for the forwarder, matching those defined in your <a class="xref" href="sample-s3-config-file.html" title="Create and upload config.yaml to S3 bucket">Create and upload <code class="literal">config.yaml</code> to S3 bucket</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">kinesis-data-stream.[].arn</code></p></td>
<td align="left" valign="top"><p>ARN of the AWS Kinesis Data Stream.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">kinesis-data-stream.[].batch_size</code></p></td>
<td align="left" valign="top"><p>Set this value above the default (<code class="literal">10</code>) if you experience ingestion delays in your output <span class="strong strong"><strong>and</strong></span> <code class="literal">GetRecords.IteratorAgeMilliseconds</code> and <code class="literal">IncomingRecords</code> Kinesis CloudWatch metrics for the <a class="xref" href="aws-elastic-serverless-forwarder.html#aws-serverless-forwarder-inputs-kinesis" title="Amazon Kinesis Data Streams">Amazon Kinesis Data Streams</a> keep increasing <span class="strong strong"><strong>and</strong></span> the average execution time of the forwarder is below 14 minutes. This will increase the number of records the forwarder will process in a single execution for the <a class="xref" href="aws-elastic-serverless-forwarder.html#aws-serverless-forwarder-inputs-kinesis" title="Amazon Kinesis Data Streams">Amazon Kinesis Data Streams</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">kinesis-data-stream.[].batching_window_in_second</code></p></td>
<td align="left" valign="top"><p>Set this value above the default (<code class="literal">0</code>) if you experience ingestion delays in your output <span class="strong strong"><strong>and</strong></span> <code class="literal">GetRecords.IteratorAgeMilliseconds</code> and <code class="literal">IncomingRecords</code> Kinesis CloudWatch metrics for the <a class="xref" href="aws-elastic-serverless-forwarder.html#aws-serverless-forwarder-inputs-kinesis" title="Amazon Kinesis Data Streams">Amazon Kinesis Data Streams</a> keep increasing <span class="strong strong"><strong>and</strong></span> the average execution time of the forwarder is below 14 minutes. This will increase the number of records the forwarder will process in a single execution for the <a class="xref" href="aws-elastic-serverless-forwarder.html#aws-serverless-forwarder-inputs-kinesis" title="Amazon Kinesis Data Streams">Amazon Kinesis Data Streams</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">kinesis-data-stream.[].starting_position</code></p></td>
<td align="left" valign="top"><p>Change this value from the default (<code class="literal">TRIM_HORIZON</code>) if you want to change the starting position of the records processed by the forwarder for the <a class="xref" href="aws-elastic-serverless-forwarder.html#aws-serverless-forwarder-inputs-kinesis" title="Amazon Kinesis Data Streams">Amazon Kinesis Data Streams</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">kinesis-data-stream.[].starting_position_timestamp</code></p></td>
<td align="left" valign="top"><p>Set this value to the time from which to start reading (in Unix time seconds) if you set <code class="literal">ElasticServerlessForwarderKinesisStartingPosition</code> to "AT_TIMESTAMP".</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">kinesis-data-stream.[].parallelization_factor</code></p></td>
<td align="left" valign="top"><p>Defines the number of forwarder functions that can run concurrently per shard (default is <code class="literal">1</code>). Increase this value if you experience ingestion delays in your output <span class="strong strong"><strong>and</strong></span> <code class="literal">GetRecords.IteratorAgeMilliseconds</code> and <code class="literal">IncomingRecords</code> Kinesis CloudWatch metrics for the <a class="xref" href="aws-elastic-serverless-forwarder.html#aws-serverless-forwarder-inputs-kinesis" title="Amazon Kinesis Data Streams">Amazon Kinesis Data Streams</a> keep increasing <span class="strong strong"><strong>and</strong></span> the average execution time of the forwarder is below 14 minutes. This will increase the number of records processed concurrently for <a class="xref" href="aws-elastic-serverless-forwarder.html#aws-serverless-forwarder-inputs-kinesis" title="Amazon Kinesis Data Streams">Amazon Kinesis Data Streams</a>. For more info, refer to <a href="https://docs.aws.amazon.com/lambda/latest/dg/with-kinesis.html" class="ulink" target="_top">AWS Kinesis docs</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">sqs.[]</code></p></td>
<td align="left" valign="top"><p>List of <a class="xref" href="aws-elastic-serverless-forwarder.html#aws-serverless-forwarder-inputs-direct" title="Amazon SQS message payload">Amazon SQS message payload</a> (i.e. triggers) for the forwarder, matching those defined in your <a class="xref" href="sample-s3-config-file.html" title="Create and upload config.yaml to S3 bucket">Create and upload <code class="literal">config.yaml</code> to S3 bucket</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">sqs.[].arn</code></p></td>
<td align="left" valign="top"><p>ARN of the AWS SQS queue trigger input.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">sqs.[].batch_size</code></p></td>
<td align="left" valign="top"><p>Set this value above the default (<code class="literal">10</code>) if you experience ingestion delays in your output <span class="strong strong"><strong>and</strong></span> <code class="literal">ApproximateNumberOfMessagesVisible</code> and <code class="literal">ApproximateAgeOfOldestMessage</code> SQS CloudWatch metrics for the <a class="xref" href="aws-elastic-serverless-forwarder.html#aws-serverless-forwarder-inputs-direct" title="Amazon SQS message payload">Amazon SQS message payload</a> keep increasing <span class="strong strong"><strong>and</strong></span> the average execution time of the forwarder is below 14 minutes. This will increase the number of messages the forwarder will process in a single execution for the <a class="xref" href="aws-elastic-serverless-forwarder.html#aws-serverless-forwarder-inputs-direct" title="Amazon SQS message payload">Amazon SQS message payload</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">sqs.[].batching_window_in_second</code></p></td>
<td align="left" valign="top"><p>Set this value above the default (<code class="literal">0</code>) if you experience ingestion delays in your output <span class="strong strong"><strong>and</strong></span> <code class="literal">ApproximateNumberOfMessagesVisible</code> and <code class="literal">ApproximateAgeOfOldestMessage</code> SQS CloudWatch metrics for the <a class="xref" href="aws-elastic-serverless-forwarder.html#aws-serverless-forwarder-inputs-direct" title="Amazon SQS message payload">Amazon SQS message payload</a> keep increasing <span class="strong strong"><strong>and</strong></span> the average execution time of the forwarder is below 14 minutes. This will increase the number of messages the forwarder will process in a single execution for the <a class="xref" href="aws-elastic-serverless-forwarder.html#aws-serverless-forwarder-inputs-direct" title="Amazon SQS message payload">Amazon SQS message payload</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">s3-sqs.[]</code></p></td>
<td align="left" valign="top"><p>List of <a class="xref" href="aws-elastic-serverless-forwarder.html#aws-serverless-forwarder-inputs-s3" title="Amazon S3 (via SQS event notifications)">Amazon S3 (via SQS event notifications)</a> (i.e. triggers) for the forwarder, matching those defined in your <a class="xref" href="sample-s3-config-file.html" title="Create and upload config.yaml to S3 bucket">Create and upload <code class="literal">config.yaml</code> to S3 bucket</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">s3-sqs.[].arn</code></p></td>
<td align="left" valign="top"><p>ARN of the AWS SQS queue receiving S3 Notifications as trigger input.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">s3-sqs.[].batch_size</code></p></td>
<td align="left" valign="top"><p>Set this value above the default (<code class="literal">10</code>) if you experience ingestion delays in your output <span class="strong strong"><strong>and</strong></span> <code class="literal">ApproximateNumberOfMessagesVisible</code> and <code class="literal">ApproximateAgeOfOldestMessage</code> SQS CloudWatch metrics for the <a class="xref" href="aws-elastic-serverless-forwarder.html#aws-serverless-forwarder-inputs-s3" title="Amazon S3 (via SQS event notifications)">Amazon S3 (via SQS event notifications)</a> keep increasing <span class="strong strong"><strong>and</strong></span> the average execution time of the forwarder is below 14 minutes. This will increase the number of messages the forwarder will process in a single execution for the <a class="xref" href="aws-elastic-serverless-forwarder.html#aws-serverless-forwarder-inputs-s3" title="Amazon S3 (via SQS event notifications)">Amazon S3 (via SQS event notifications)</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">s3-sqs.[].batching_window_in_second</code></p></td>
<td align="left" valign="top"><p>Set this value above the default (<code class="literal">0</code>) if you experience ingestion delays in your output <span class="strong strong"><strong>and</strong></span> <code class="literal">ApproximateNumberOfMessagesVisible</code> and <code class="literal">ApproximateAgeOfOldestMessage</code> SQS CloudWatch metrics for the <a class="xref" href="aws-elastic-serverless-forwarder.html#aws-serverless-forwarder-inputs-s3" title="Amazon S3 (via SQS event notifications)">Amazon S3 (via SQS event notifications)</a> keep increasing <span class="strong strong"><strong>and</strong></span> the average execution time of the forwarder is below 14 minutes. This will increase the number of messages the forwarder will process in a single execution for the <a class="xref" href="aws-elastic-serverless-forwarder.html#aws-serverless-forwarder-inputs-s3" title="Amazon S3 (via SQS event notifications)">Amazon S3 (via SQS event notifications)</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">cloudwatch-logs.[]</code></p></td>
<td align="left" valign="top"><p>List of <a class="xref" href="aws-elastic-serverless-forwarder.html#aws-serverless-forwarder-inputs-cloudwatch" title="Amazon CloudWatch Logs subscription filters">Amazon CloudWatch Logs subscription filters</a> (i.e. triggers) for the forwarder, matching those defined in your <a class="xref" href="sample-s3-config-file.html" title="Create and upload config.yaml to S3 bucket">Create and upload <code class="literal">config.yaml</code> to S3 bucket</a>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">cloudwatch-logs.[].arn</code></p></td>
<td align="left" valign="top"><p>ARN of the AWS CloudWatch Logs trigger input (accepts both CloudWatch Logs Log Group and CloudWatch Logs Log Stream ARNs).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">ssm-secrets.[]</code></p></td>
<td align="left" valign="top"><p>List of AWS SSM Secrets ARNs used in your <code class="literal">config.yml</code> (if any).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">kms-keys.[]</code></p></td>
<td align="left" valign="top"><p>List of AWS KMS Keys ARNs to be used for decrypting AWS SSM Secrets, Kinesis Data Streams or SQS queues (if any).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">s3-buckets.[]</code></p></td>
<td align="left" valign="top"><p>List of S3 bucket ARNs that are sources for the S3 SQS Event Notifications (if any).</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">subnets.[]</code></p></td>
<td align="left" valign="top"><p>A list of subnets IDs for the forwarder. Along with <code class="literal">security-groups.[]</code>, these settings will define the AWS VPC the forwarder will belong to. Leave blank if you don&#8217;t want the forwarder to belong to any specific AWS VPC.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">security-groups.[]</code></p></td>
<td align="left" valign="top"><p>List of security group IDs to attach to the forwarder. Along with <code class="literal">subnets.[]</code>, these settings will define the AWS VPC the forwarder will belong to. Leave blank if you don&#8217;t want to have the forwarder belong to any specific AWS VPC.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">s3-config-file</code></p></td>
<td align="left" valign="top"><p>Set this value to the location of your forwarder configuration file in S3 URL format: <code class="literal">s3://bucket-name/config-file-name</code>. This will populate the <code class="literal">S3_CONFIG_FILE</code> environment variable for the forwarder.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">continuing-queue.batch_size</code></p></td>
<td align="left" valign="top"><p>Set this value above the default (<code class="literal">10</code>) if you experience ingestion delays in your output <span class="strong strong"><strong>and</strong></span> <code class="literal">ApproximateNumberOfMessagesVisible</code> and <code class="literal">ApproximateAgeOfOldestMessage</code> SQS CloudWatch metrics for the <em>Continuing queue</em> keep increasing <span class="strong strong"><strong>and</strong></span> the average execution time of the forwarder is below 14 minutes. This will increase the number of messages the forwarder will process in a single execution for the <em>Continuing queue</em>.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">continuing-queue.batching_window_in_second</code></p></td>
<td align="left" valign="top"><p>Set this value above the default (<code class="literal">0</code>) if you experience ingestion delays in your output <span class="strong strong"><strong>and</strong></span> <code class="literal">ApproximateNumberOfMessagesVisible</code> and <code class="literal">ApproximateAgeOfOldestMessage</code> SQS CloudWatch metrics for the <em>Continuing queue</em> keep increasing <span class="strong strong"><strong>and</strong></span> the average execution time of the forwarder is below 14 minutes. This will increase the number of messages the forwarder will process in a single execution for the <em>Continuing queue</em>.</p></td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h5 class="title"><a id="aws-serverless-forwarder-run-publish-script"></a>Run the publishing script<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.5/docs/en/observability/aws-deploy-elastic-serverless-forwarder.asciidoc">edit</a></h5>
</div></div></div>
<p>A bash script for publishing the Elastic Serverless Forwarder directly to your AWS account is available from the <a href="https://github.com/elastic/elastic-serverless-forwarder" class="ulink" target="_top">Elastic Serverless Forwarder repository</a>.</p>
<p>Download the <a href="https://raw.githubusercontent.com/elastic/elastic-serverless-forwarder/lambda-v1.6.0/publish_lambda.sh" class="ulink" target="_top"><code class="literal">publish_lambda.sh</code> script</a> and follow the instructions below.</p>
<div class="section">
<div class="titlepage"><div><div>
<h6 class="title"><a id="_script_arguments"></a>Script arguments<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.5/docs/en/observability/aws-deploy-elastic-serverless-forwarder.asciidoc">edit</a></h6>
</div></div></div>
<div class="pre_wrapper lang-bash">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-bash"> $ ./publish_lambda.sh
    AWS CLI (https://aws.amazon.com/cli/), SAM (https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/install-sam-cli.html) and Python3.9 with pip3 required
    Please, before launching the tool execute "$ pip3 install ruamel.yaml"
Usage: ./publish_lambda.sh config-path lambda-name forwarder-tag bucket-name region
    Arguments:
    config-path: full path to the publish configuration
    lambda-name: name of the lambda to be published in the account
    forwarder-tag: tag of the elastic serverless forwarder to publish
    bucket-name: bucket name where to store the zip artifact for the lambda
                 (it will be created if it doesn't exists, otherwise
                  you need already to have proper access to it)
    region: region where to publish in</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h6 class="title"><a id="_prerequisites"></a>Prerequisites<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.5/docs/en/observability/aws-deploy-elastic-serverless-forwarder.asciidoc">edit</a></h6>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Python3.9 with pip3 is required to run the script
</li>
<li class="listitem">
<a href="https://aws.amazon.com/cli/" class="ulink" target="_top">AWS CLI</a>, <a href="https://docs.aws.amazon.com/serverless-application-model/latest/developerguide/install-sam-cli.html" class="ulink" target="_top">SAM CLI</a> and the <a href="https://pypi.org/project/ruamel.yaml/" class="ulink" target="_top">ruamel.yaml package</a> must also be installed
</li>
</ul>
</div>
<div class="pre_wrapper lang-bash">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-bash">$ pip3 install awscli aws-sam-cli ruamel.yaml</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h6 class="title"><a id="_running_the_script"></a>Running the script<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.5/docs/en/observability/aws-deploy-elastic-serverless-forwarder.asciidoc">edit</a></h6>
</div></div></div>
<p>Assuming <code class="literal">publish-config.yaml</code> in saved in the same directory you intend to run <code class="literal">publish_lambda.sh</code> from, here&#8217;s an example:</p>
<div class="pre_wrapper lang-bash">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-bash">$ ./publish_lambda.sh publish-config.yaml forwarder-lambda lambda-v1.6.0 s3-lambda-artifact-bucket-name eu-central-1</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h6 class="title"><a id="_updating_to_a_new_version_via_script"></a>Updating to a new version via script<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.5/docs/en/observability/aws-deploy-elastic-serverless-forwarder.asciidoc">edit</a></h6>
</div></div></div>
<p>You can update the version of a published Elastic Serverless Forwarder without changing its configuration by running the publishing script again and passing a <span class="strong strong"><strong>new</strong></span> <a href="https://github.com/elastic/elastic-serverless-forwarder/tags" class="ulink" target="_top"><code class="literal">forwarder-tag</code></a>:</p>
<div class="pre_wrapper lang-bash">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-bash">$ ./publish_lambda.sh publish-config.yaml forwarder-lambda lambda-v1.7.0 s3-lambda-artifact-bucket-name eu-central-1</pre>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The above examples show the forwarder being updated from <code class="literal">lambda-v1.6.0</code> to <code class="literal">lambda-v1.7.0</code>.</p>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h6 class="title"><a id="_changing_configuration_via_script"></a>Changing configuration via script<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.5/docs/en/observability/aws-deploy-elastic-serverless-forwarder.asciidoc">edit</a></h6>
</div></div></div>
<p>If you want to change the configuration of a published Elastic Serverless Forwarder without changing its version, you can update the <code class="literal">publish-config.yaml</code> and run the script again using the <span class="strong strong"><strong>same</strong></span> <code class="literal">forwarder-tag</code>:</p>
<div class="pre_wrapper lang-bash">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-bash">$ ./publish_lambda.sh publish-config.yaml forwarder-lambda lambda-v1.6.0 s3-lambda-artifact-bucket-name eu-central-1</pre>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The above example shows an existing <code class="literal">lambda-v1.6.0</code> configuration being updated without changing version.</p>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h6 class="title"><a id="_using_the_script_for_multiple_deployments"></a>Using the script for multiple deployments<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.5/docs/en/observability/aws-deploy-elastic-serverless-forwarder.asciidoc">edit</a></h6>
</div></div></div>
<p>If you want to use the publish script for deploying the forwarder with different configurations, create two different <code class="literal">publish-config.yaml</code> files with unique names and run the publishing script twice, with correct references to the <code class="literal">config-path</code> and <code class="literal">lambda-name</code>:</p>
<div class="pre_wrapper lang-bash">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-bash">$ ./publish_lambda.sh publish-config-for-first-lambda.yaml first-lambda lambda-v1.6.0 s3-lambda-artifact-bucket-name eu-central-1

$ ./publish_lambda.sh publish-config-for-second-lambda.yaml second-lambda lambda-v1.6.0 ss3-lambda-artifact-bucket-name eu-central-1</pre>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The above example publishes two versions of the forwarder, each with different configurations i.e. <code class="literal">publish-config-for-first-lambda.yaml</code> and <code class="literal">first-lambda</code> vs. <code class="literal">publish-config-for-second-lambda.yaml</code> and <code class="literal">second-lambda</code>.</p>
</div>
</div>
</div>

</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="aws-serverless-forwarder-deploy-sar.html">« Deploy Elastic Serverless Forwarder from SAR</a>
</span>
<span class="next">
<a href="aws-elastic-serverless-forwarder-configuration.html">Configuration options for Elastic Serverless Forwarder »</a>
</span>
</div>
</div>
</body>
</html>
