<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Use advanced queries on your application data | Elastic Observability [8.x] | Elastic</title>
<meta class="elastic" name="content" content="Use advanced queries on your application data | Elastic Observability [8.x]">

<link rel="home" href="index.html" title="Elastic Observability [8.x]"/>
<link rel="up" href="apm-filter-and-search-data.html" title="Filter and search application data"/>
<link rel="prev" href="apm-filters.html" title="Filter application data"/>
<link rel="next" href="apm-cross-cluster-search.html" title="Cross-cluster search with application data"/>
<meta class="elastic" name="product_version" content="8.x"/>
<meta class="elastic" name="product_name" content="Observability"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Observability/Guide/8.x"/>
<meta name="DC.subject" content="Observability"/>
<meta name="DC.identifier" content="8.x"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
This documentation contains work-in-progress information for future Elastic Stack and Cloud releases. Use the version selector to view supported release docs. It also contains some Elastic Cloud serverless information. Check out our <a href="https://www.elastic.co/docs/current/serverless">serverless docs</a> for more details.
</div>
<div class="navheader">
<span class="prev">
<a href="apm-filters.html">« Filter application data</a>
</span>
<span class="next">
<a href="apm-cross-cluster-search.html">Cross-cluster search with application data »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Observability [8.x]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="application-and-service-monitoring.html">Application and service monitoring</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="apm.html">Application performance monitoring (APM)</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="apm-view-and-analyze-data.html">View and analyze data</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="apm-filter-and-search-data.html">Filter and search application data</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Use advanced queries on your application data</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.x/docs/en/observability/apm/view-and-analyze/filter-and-search/advanced-queries.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div id="url-to-v3" class="version-warning">
    <strong>IMPORTANT</strong>: This documentation is no longer updated. Refer to <a href="https://www.elastic.co/support/eol">Elastic's version policy</a> and the <a href="https://www.elastic.co/docs/solutions/observability/apps/use-advanced-queries-on-application-data">latest documentation</a>.
</div>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h5 class="title"><a id="apm-advanced-queries"></a>Use advanced queries on your application data</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.x/docs/en/observability/apm/view-and-analyze/filter-and-search/advanced-queries.asciidoc">edit</a></div>
</div></div></div>

<p>Querying your APM data is an essential tool that can make finding bottlenecks in your code even more straightforward.</p>
<p>Using the query bar, a powerful data query feature, you can pass advanced queries on your data
to filter on specific pieces of information you’re interested in.</p>
<p>The query bar comes with a handy autocomplete that helps find the fields and even provides suggestions to the data they include.
You can select the query bar and hit the down arrow on your keyboard to begin scanning recommendations.</p>
<div class="position-relative"><h7><a id="apm-app-advanced-queries"></a>Querying in the Applications UI</h7><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.x/docs/en/observability/apm/view-and-analyze/filter-and-search/advanced-queries.asciidoc">edit</a></div>
<p>When querying in the Applications UI, you’re merely searching and selecting data from fields in Elasticsearch documents. Queries entered
into the query bar are also added as parameters to the URL, so it’s easy to share a specific query or view with others.</p>
<p>When you type, you can begin to see some of the transaction fields available for filtering:</p>
<div class="imageblock screenshot">
<div class="content">
<img src="./images/apm-query-bar.png" alt="Example of the Kibana Query bar in Applications UI in Kibana">
</div>
</div>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>To learn more about the Kibana query language capabilities, see the <a href="/guide/en/kibana/8.x/kuery-query.html" class="ulink" target="_top">Kibana Query Language Enhancements</a> documentation.</p>
</div>
</div>
<div class="position-relative"><h8><a id="apm-app-queries"></a>Applications UI queries</h8><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.x/docs/en/observability/apm/view-and-analyze/filter-and-search/advanced-queries.asciidoc">edit</a></div>
<p>APM queries can be handy for removing noise from your data in the <a class="xref" href="apm-services.html" title="Services">Services</a>, <a class="xref" href="apm-transactions.html" title="Transactions">Transactions</a>,
<a class="xref" href="apm-errors.html" title="Errors">Errors</a>, <a class="xref" href="apm-metrics.html" title="Metrics">Metrics</a>, and <a class="xref" href="apm-traces.html" title="Traces">Traces</a> views.</p>
<p>For example, in the <span class="strong strong"><strong>Services</strong></span> view, you can quickly view a list of all the instrumented services running on your production
environment: <code class="literal">service.environment : production</code>. Or filter the list by including the APM agent&#8217;s name and the host it’s running on:
<code class="literal">service.environment : "production" and agent.name : "java" and host.name : "prod-server1"</code>.</p>
<p>On the <span class="strong strong"><strong>Traces</strong></span> view, you might want to view failed transaction results from any of your running containers:
<code class="literal">transaction.result :"FAILURE" and container.id : *</code>.</p>
<p>On the <span class="strong strong"><strong>Transactions</strong></span> view, you may want to list only the slower transactions than a specified time threshold: <code class="literal">transaction.duration.us &gt; 2000000</code>.
Or filter the list by including the service version and the Kubernetes pod it&#8217;s running on:
<code class="literal">transaction.duration.us &gt; 2000000 and service.version : "7.12.0" and kubernetes.pod.name : "pod-5468b47f57-pqk2m"</code>.</p>
<div class="position-relative"><h7><a id="discover-advanced-queries"></a>Querying in Discover</h7><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.x/docs/en/observability/apm/view-and-analyze/filter-and-search/advanced-queries.asciidoc">edit</a></div>
<p>Alternatively, you can query your APM documents in <a href="/guide/en/kibana/8.x/discover.html" class="ulink" target="_top"><span class="strong strong"><strong>Discover</strong></span></a>.
Querying documents in <span class="strong strong"><strong>Discover</strong></span> works the same way as queries in the Applications UI,
and <span class="strong strong"><strong>Discover</strong></span> supports all of the example Applications UI queries shown on this page.</p>
<div class="position-relative"><h8><a id="discover-queries"></a>Discover queries</h8><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/observability-docs/edit/8.x/docs/en/observability/apm/view-and-analyze/filter-and-search/advanced-queries.asciidoc">edit</a></div>
<p>One example where you may want to make use of <span class="strong strong"><strong>Discover</strong></span>
is to view  <em>all</em> transactions for an endpoint instead of just a sample.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>Starting in v7.6, you can view ten samples per bucket in the Applications UI, instead of just one.</p>
</div>
</div>
<p>Use the Applications UI to find a transaction name and time bucket that you&#8217;re interested in learning more about.
Then, switch to <span class="strong strong"><strong>Discover</strong></span> and make a search:</p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">processor.event: "transaction" AND transaction.name: "&lt;TRANSACTION_NAME_HERE&gt;" and transaction.duration.us &gt; 13000 and transaction.duration.us &lt; 14000`</pre>
</div>
<p>In this example, we&#8217;re interested in viewing all of the <code class="literal">APIRestController#customers</code> transactions
that took between 13 and 14 milliseconds. Here&#8217;s what Discover returns:</p>
<div class="imageblock screenshot">
<div class="content">
<img src="./images/advanced-discover.png" alt="View all transactions in bucket">
</div>
</div>
<p>You can now explore the data until you find a specific transaction that you&#8217;re interested in.
Copy that transaction&#8217;s <code class="literal">transaction.id</code> and paste it into the Applications UI to view the data in the context of the Applications UI:</p>
<div class="imageblock screenshot">
<div class="content">
<img src="./images/specific-transaction-search.png" alt="View specific transaction in Applications UI">
</div>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="./images/specific-transaction.png" alt="View specific transaction in Applications UI">
</div>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="apm-filters.html">« Filter application data</a>
</span>
<span class="next">
<a href="apm-cross-cluster-search.html">Cross-cluster search with application data »</a>
</span>
</div>
</body>
</html>
