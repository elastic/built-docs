<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Limitations | Elastic Observability [8.15] | Elastic</title>
<meta class="elastic" name="content" content="Limitations | Elastic Observability [8.15]">

<link rel="home" href="index.html" title="Elastic Observability [8.15]"/>
<link rel="up" href="apm-open-telemetry.html" title="OpenTelemetry integration"/>
<link rel="prev" href="apm-open-telemetry-collect-metrics.html" title="Collect metrics"/>
<link rel="next" href="apm-open-telemetry-resource-attributes.html" title="Resource attributes"/>
<meta class="elastic" name="product_version" content="8.15"/>
<meta class="elastic" name="product_name" content="Observability"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Observability/Guide/8.15"/>
<meta name="DC.subject" content="Observability"/>
<meta name="DC.identifier" content="8.15"/>
</head>
<body>
<div class="navheader">
<span class="prev">
<a href="apm-open-telemetry-collect-metrics.html">« Collect metrics</a>
</span>
<span class="next">
<a href="apm-open-telemetry-resource-attributes.html">Resource attributes »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Observability [8.15]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="apm.html">Application performance monitoring (APM)</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="apm-open-telemetry.html">OpenTelemetry integration</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Limitations</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/8.15/docs/en/observability/apm/otel-limitations.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="apm-open-telemetry-known-limitations"></a>Limitations<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/8.15/docs/en/observability/apm/otel-limitations.asciidoc">edit</a></h3>
</div></div></div>
<h5><a id="apm-open-telemetry-traces-limitations"></a>OpenTelemetry traces<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/8.15/docs/en/observability/apm/otel-limitations.asciidoc">edit</a></h5>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Traces of applications using <code class="literal">messaging</code> semantics might be wrongly displayed as <code class="literal">transactions</code> in the APM UI, while they should be considered <code class="literal">spans</code> (see issue <a href="https://github.com/elastic/apm-server/issues/7001" class="ulink" target="_top">#7001</a>).
</li>
<li class="listitem">
Inability to see Stack traces in spans.
</li>
<li class="listitem">
Inability in APM views to view the "Time Spent by Span Type"  (see issue <a href="https://github.com/elastic/apm-server/issues/5747" class="ulink" target="_top">#5747</a>).
</li>
</ul>
</div>
<h5><a id="apm-open-telemetry-metrics-limitations"></a>OpenTelemetry metrics<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/8.15/docs/en/observability/apm/otel-limitations.asciidoc">edit</a></h5>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Inability to see host metrics in Elastic Metrics Infrastructure view when using the OpenTelemetry Collector host metrics receiver (see issue <a href="https://github.com/elastic/apm-server/issues/5310" class="ulink" target="_top">#5310</a>).
</li>
</ul>
</div>
<h5><a id="apm-open-telemetry-logs-intake"></a>OpenTelemetry logs<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/8.15/docs/en/observability/apm/otel-limitations.asciidoc">edit</a></h5>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="Admonishment Admonishment--preview">
[<span class="Admonishment-title u-mono">preview</span>]
<span class="Admonishment-detail">
This functionality is in technical preview and may be changed or removed in a future release. Elastic will work to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.
</span>
</span> The OpenTelemetry logs intake via APM Server is in technical preview.
</li>
<li class="listitem">
The application logs data stream (<code class="literal">app_logs</code>) has dynamic mapping disabled. This means the automatic detection and mapping of new fields is disabled (see issue <a href="https://github.com/elastic/apm-server/issues/9093" class="ulink" target="_top">#9093</a>).
</li>
</ul>
</div>
<h5><a id="apm-open-telemetry-otlp-limitations"></a>OpenTelemetry Line Protocol (OTLP)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/8.15/docs/en/observability/apm/otel-limitations.asciidoc">edit</a></h5>
<p>APM Server supports both the  <a href="https://opentelemetry.io/docs/specs/otlp/#otlpgrpc" class="ulink" target="_top">OTLP/gRPC</a> and <a href="https://opentelemetry.io/docs/specs/otlp/#otlphttp" class="ulink" target="_top">OTLP/HTTP</a> protocol with ProtoBuf payload.
APM Server does not yet support JSON Encoding for OTLP/HTTP.</p>
<h5><a id="apm-open-telemetry-collector-exporter"></a>OpenTelemetry Collector exporter for Elastic<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/8.15/docs/en/observability/apm/otel-limitations.asciidoc">edit</a></h5>
<p>The <a href="https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/v0.57.2/exporter/elasticexporter" class="ulink" target="_top">OpenTelemetry Collector exporter for Elastic</a>
has been deprecated and replaced by the native support of the OpenTelemetry Line Protocol in Elastic Observability (OTLP).</p>
<p>The <a href="https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/exporter/elasticsearchexporter#elasticsearch-exporter" class="ulink" target="_top">Elasticsearch exporter for the OpenTelemetry Collector</a>
(which is different from the legacy exporter mentioned above) is not intended to be used with Elastic APM and Elastic Observability. Use <a class="xref" href="apm-open-telemetry-direct.html" title="OpenTelemetry native support">OpenTelemetry native support</a> instead.</p>
<h5><a id="apm-open-telemetry-tbs"></a>OpenTelemetry&#8217;s tail-based sampling<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/8.15/docs/en/observability/apm/otel-limitations.asciidoc">edit</a></h5>
<p>Tail-based sampling allows to make sampling decisions after all spans of a trace have been completed.
This allows for more powerful and informed sampling rules.</p>
<p>When using OpenTelemetry with Elastic APM, there are two different implementations available for tail-based sampling:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Tail-based sampling using the <a href="https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/processor/tailsamplingprocessor" class="ulink" target="_top">tailsamplingprocessor</a> in the OpenTelemetry Collector
</li>
<li class="listitem">
Native <a class="xref" href="apm-sampling.html#apm-tail-based-sampling" title="Tail-based sampling">tail-based sampling in the Elastic APM backend</a>
</li>
</ul>
</div>
<p>Using the <a href="https://github.com/open-telemetry/opentelemetry-collector-contrib/tree/main/processor/tailsamplingprocessor" class="ulink" target="_top">tailsamplingprocessor</a> in the OpenTelemetry Collector comes with an important limitation. Elastic&#8217;s APM backend calculates span and transaction metrics based on the incoming span events.
These metrics are accurate for 100% sampling scenarios. In scenarios with probabilistic sampling, Elastic&#8217;s APM backend is being informed about the sampling rate of spans and can extrapolate throughput metrics based on the incoming, partial data. However, with tail-based sampling there&#8217;s no clear probability for sampling decisions as the rules can be more complex and the OpenTelemetry Collector does not provide sampling probability information to the Elastic backend that could be used for extrapolation of data. Therefore, there&#8217;s no way for Elastic APM to properly extrapolate throughput and count metrics that are derived from span events that have been tail-based sampled in the OpenTelemetry Collector. In these scenarios, derived throughput and count metrics are likely to be inaccurate.</p>
<p>Therefore, we recommend using Elastic&#8217;s native tail-based sampling when integrating with OpenTelemetry.</p>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="apm-open-telemetry-collect-metrics.html">« Collect metrics</a>
</span>
<span class="next">
<a href="apm-open-telemetry-resource-attributes.html">Resource attributes »</a>
</span>
</div>
</body>
</html>
