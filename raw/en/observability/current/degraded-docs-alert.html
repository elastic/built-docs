<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Create a degraded docs rule | Elastic Observability [8.19] | Elastic</title>
<meta class="elastic" name="content" content="Create a degraded docs rule | Elastic Observability [8.19]">

<link rel="home" href="index.html" title="Elastic Observability [8.19]"/>
<link rel="up" href="create-alerts-rules.html" title="Create and manage rules"/>
<link rel="prev" href="slo-burn-rate-alert.html" title="Create a service-level objective (SLO) burn rate rule"/>
<link rel="next" href="aggregation-options.html" title="Aggregation options"/>
<meta class="elastic" name="product_version" content="8.19"/>
<meta class="elastic" name="product_name" content="Observability"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Observability/Guide/8.19"/>
<meta name="DC.subject" content="Observability"/>
<meta name="DC.identifier" content="8.19"/>
</head>
<body>
<div class="navheader">
<span class="prev">
<a href="slo-burn-rate-alert.html">« Create a service-level objective (SLO) burn rate rule</a>
</span>
<span class="next">
<a href="aggregation-options.html">Aggregation options »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Observability [8.19]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="incident-management.html">Incident management</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="create-alerts.html">Alerting</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="create-alerts-rules.html">Create and manage rules</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Create a degraded docs rule</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/8.19/docs/en/observability/degraded-docs-alert.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div id="url-to-v3" class="version-warning">
    <strong>IMPORTANT</strong>: This documentation is no longer updated. Refer to <a href="https://www.elastic.co/support/eol">Elastic's version policy</a> and the <a href="https://www.elastic.co/docs">latest documentation</a>.
</div>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h4 class="title"><a id="degraded-docs-alert"></a>Create a degraded docs rule</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/8.19/docs/en/observability/degraded-docs-alert.asciidoc">edit</a></div>
</div></div></div>

<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Users need the <span class="strong strong"><strong>Data Set Quality</strong></span> role with the <span class="strong strong"><strong>Manage rules</strong></span> privilege or the <span class="strong strong"><strong>Editor</strong></span> role or higher to create degraded docs rules. To learn more, refer to <a href="/guide/en/cloud/current/ec-user-privileges.html" class="ulink" target="_top">User roles and privileges</a>.</p>
</div>
</div>
<p>Based on the data found on the <a class="xref" href="monitor-datasets.html" title="Data set quality">Data set quality</a> page, you can create a rule to notify you when the percentage of degraded documents for a specific data view has exceeded a value over a specific time period.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/observability-degraded-docs-rule.png" alt="Host monitoring entry point">
</div>
</div>
<p>To access this rule from the <span class="strong strong"><strong>Alerts</strong></span> page:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Go to <span class="strong strong"><strong>Alerts</strong></span>.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Manage Rules</strong></span> → <span class="strong strong"><strong>Create rule</strong></span>.
</li>
<li class="listitem">
Under <span class="strong strong"><strong>Select rule type</strong></span>, select <span class="strong strong"><strong>Degraded docs</strong></span>.
</li>
</ol>
</div>
<p>You can also access this rule from the <span class="strong strong"><strong>Data Set Quality</strong></span> page:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Go to <span class="strong strong"><strong>Stack Management</strong></span> → <span class="strong strong"><strong>Data Set Quality</strong></span> or search for "Data Set Quality" using the <a href="/guide/en/kibana/8.19/introduction.html#kibana-navigation-search" class="ulink" target="_top">global search field</a>.
</li>
<li class="listitem">
Select a data set name from the data set table.
</li>
<li class="listitem">
Select <span class="strong strong"><strong>Actions</strong></span> in the upper-right corner of the page.
</li>
<li class="listitem">
Select <span class="strong strong"><strong>Create rule</strong></span>.
</li>
</ol>
</div>
<div class="position-relative"><h6><a id="action-types-degraded-docs-define-conditions"></a>Define the conditions</h6><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/8.19/docs/en/observability/degraded-docs-alert.asciidoc">edit</a></div>
<p>Define the following conditions for your rule:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Set the data view you want to create the rule for. If you access the rule from the <span class="strong strong"><strong>Data Set Quality</strong></span> page, the data view is automatically populated.
</li>
<li class="listitem">
Set the threshold percentage that, when exceeded for a period of time, the rule sends an alert.
</li>
<li class="listitem">
Specify how long the threshold must be exceeded before an alert is sent.
</li>
<li class="listitem">
(Optional) Set one or more <span class="strong strong"><strong>Group alerts by</strong></span> fields. Every unique value will create an alert.
</li>
<li class="listitem">
Set how often to check the rule conditions by selecting a time value and unit under <span class="strong strong"><strong>Rule schedule</strong></span>.
</li>
<li class="listitem">
<p>(Optional) Configure <span class="strong strong"><strong>Advanced options</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Define the number of consecutive matches required before an alert is triggered under <span class="strong strong"><strong>Alert delay</strong></span>.
</li>
<li class="listitem">
Enable or disable <span class="strong strong"><strong>Flapping Detection</strong></span> to reduce noise from frequently changing alerts. You can customize the flapping detection settings if you need different thresholds for detecting flapping behavior.
</li>
</ul>
</div>
</li>
</ol>
</div>
<details>
<summary class="title">Action types</summary>
<div class="content">
<p>You can extend your rules with actions that interact with third-party systems, write to logs or indices, or send user notifications. You can add an action to a rule at any time. You can create rules without adding actions, and you can also define multiple actions for a single rule.</p>
<p>To add actions to rules, you must first create a connector for that service (for example, an email or external incident management system), which you can then use for different rules, each with their own action frequency.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="/guide/en/kibana/8.19/d3security-action-type.html" class="ulink" target="_top">D3 Security</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.19/email-action-type.html" class="ulink" target="_top">Email</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.19/resilient-action-type.html" class="ulink" target="_top">IBM Resilient</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.19/index-action-type.html" class="ulink" target="_top">Index</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.19/jira-action-type.html" class="ulink" target="_top">Jira</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.19/teams-action-type.html" class="ulink" target="_top">Microsoft Teams</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.19/obs-ai-assistant-action-type.html" class="ulink" target="_top">Observability AI Assistant connector</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.19/opsgenie-action-type.html" class="ulink" target="_top">Opsgenie</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.19/pagerduty-action-type.html" class="ulink" target="_top">PagerDuty</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.19/server-log-action-type.html" class="ulink" target="_top">Server log</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.19/servicenow-itom-action-type.html" class="ulink" target="_top">ServiceNow ITOM</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.19/servicenow-action-type.html" class="ulink" target="_top">ServiceNow ITSM</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.19/servicenow-sir-action-type.html" class="ulink" target="_top">ServiceNow SecOps</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.19/slack-action-type.html" class="ulink" target="_top">Slack</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.19/swimlane-action-type.html" class="ulink" target="_top">Swimlane</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.19/torq-action-type.html" class="ulink" target="_top">Torq</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.19/webhook-action-type.html" class="ulink" target="_top">Webhook</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.19/xmatters-action-type.html" class="ulink" target="_top">xMatters</a>
</li>
</ul>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Some connector types are paid commercial features, while others are free.
For a comparison of the Elastic subscription levels, go to
<a href="/subscriptions" class="ulink" target="_top">the subscription page</a>.</p>
</div>
</div>
</div>
</details>
<details>
<summary class="title">Action frequency</summary>
<div class="content">
<p>After you select a connector, you must set the action frequency. You can choose to create a summary of alerts on each check interval or on a custom interval. Alternatively, you can set the action frequency such that you choose how often the action runs (for example, at each check interval, only when the alert status changes, or at a custom action interval). In this case, you must also select the specific threshold condition that affects when actions run: <code class="literal">Alert</code>, <code class="literal">No Data</code>, or <code class="literal">Recovered</code>.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/custom-threshold-run-when.png" alt="Configure when a rule is triggered">
</div>
</div>
<p>You can also further refine the conditions under which actions run by specifying that actions only run when they match a KQL query or when an alert occurs within a specific time frame:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>If alert matches query</strong></span>: Enter a KQL query that defines field-value pairs or query conditions that must be met for notifications to send. The query only searches alert documents in the indices specified for the rule.
</li>
<li class="listitem">
<span class="strong strong"><strong>If alert is generated during timeframe</strong></span>: Set timeframe details. Notifications are only sent if alerts are generated within the timeframe you define.
</li>
</ul>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="images/logs-threshold-conditional-alert.png" alt="Configure a conditional alert">
</div>
</div>
</div>
</details>
<details>
<summary class="title">Action variables</summary>
<div class="content">
<p>Use the default notification message or customize it. You can add more context to the message by clicking the Add variable icon ![Add variable](/solutions/images/serverless-indexOpen.svg "") and selecting from a list of available variables.</p>
<p>The following variables are specific to this rule type. You can also specify [variables common to all rules](/explore-analyze/alerts-cases/alerts/rule-action-variables.md).</p>
<p><code class="literal">context.alertDetailsUrl</code>
:   Link to the alert troubleshooting view for further context and details. This will be an empty string if the <code class="literal">server.publicBaseUrl</code> is not configured.</p>
<p><code class="literal">context.cloud</code>
:   The cloud object defined by ECS if available in the source.</p>
<p><code class="literal">context.container</code>
:   The container object defined by ECS if available in the source.</p>
<p><code class="literal">context.group</code>
:   The object containing groups that are reporting data.</p>
<p><code class="literal">context.host</code>
:   The host object defined by ECS if available in the source.</p>
<p><code class="literal">context.labels</code>
:   List of labels associated with the entity where this alert triggered.</p>
<p><code class="literal">context.orchestrator</code>
:   The orchestrator object defined by ECS if available in the source.</p>
<p><code class="literal">context.reason</code>
:   A concise description of the reason for the alert.</p>
<p><code class="literal">context.tags</code>
:   List of tags associated with the entity where this alert triggered.</p>
<p><code class="literal">context.timestamp</code>
:   A timestamp of when the alert was detected.</p>
<p><code class="literal">context.value</code>
:   List of the condition values.</p>
<p><code class="literal">context.viewInAppUrl</code>
:   Link to the alert source.</p>
</div>
</details>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="slo-burn-rate-alert.html">« Create a service-level objective (SLO) burn rate rule</a>
</span>
<span class="next">
<a href="aggregation-options.html">Aggregation options »</a>
</span>
</div>
</body>
</html>
