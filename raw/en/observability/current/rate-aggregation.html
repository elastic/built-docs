<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Rate aggregation | Elastic Observability [8.15] | Elastic</title>
<meta class="elastic" name="content" content="Rate aggregation | Elastic Observability [8.15]">

<link rel="home" href="index.html" title="Elastic Observability [8.15]"/>
<link rel="up" href="aggregation-options.html" title="Aggregation options"/>
<link rel="prev" href="aggregation-options.html" title="Aggregation options"/>
<link rel="next" href="view-observability-alerts.html" title="View alerts"/>
<meta class="elastic" name="product_version" content="8.15"/>
<meta class="elastic" name="product_name" content="Observability"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Observability/Guide/8.15"/>
<meta name="DC.subject" content="Observability"/>
<meta name="DC.identifier" content="8.15"/>
</head>
<body>
<div class="navheader">
<span class="prev">
<a href="aggregation-options.html">« Aggregation options</a>
</span>
<span class="next">
<a href="view-observability-alerts.html">View alerts »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Observability [8.15]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="create-alerts.html">Alerting</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="aggregation-options.html">Aggregation options</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Rate aggregation</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/8.15/docs/en/observability/rate-aggregations.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="rate-aggregation"></a>Rate aggregation<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/8.15/docs/en/observability/rate-aggregations.asciidoc">edit</a></h3>
</div></div></div>
<p>You can use a rate aggregation to analyze the rate at which a specific field changes over time.
This type of aggregation is useful when you want to analyze fields like counters.</p>
<p>For example, imagine you have a counter field called restarts that increments each time a service restarts.
You can use rate aggregation to get an alert if the service restarts more than X times within a specific time window (for example, per day).</p>
<h5><a id="how-rates-are-calculated"></a>How rates are calculated<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/8.15/docs/en/observability/rate-aggregations.asciidoc">edit</a></h5>
<p>Rates used in alerting rules are calculated by comparing the maximum value of the field in the previous bucket to the maximum value of the field in the current bucket and then dividing the result by the number of seconds in the selected interval.
For example, if the value of the restarts increases, the rate would be calculated as:</p>
<p><code class="literal">(max_value_in_current_bucket - max_value_in_previous_bucket)/interval_in_seconds</code></p>
<p>In this example, let’s assume you have one document per bucket with the following data:</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
"timestamp": 0000,
"restarts": 0
}

{
"timestamp": 60000,
"restarts": 1
}</pre>
</div>
<p>Let’s assume the timestamp is a UNIX timestamp in milliseconds,
and we started counting on Thursday, January 1, 1970 12:00:00 AM.
In that case, the rate will be calculated as follows:</p>
<p><code class="literal">(max_value_in_current_bucket - max_value_in_previous_bucket)/interval_in_seconds</code>, where:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">max_value_in_current_bucket</code> [now-1m → now]: 1
</li>
<li class="listitem">
<code class="literal">max_value_in_previous_bucket</code> [now-2m → now-1m]: 0
</li>
<li class="listitem">
<code class="literal">interval_in_seconds</code>: 60
</li>
</ul>
</div>
<p>The rate calculation would be: <code class="literal">(1 - 0) / 60 = 0.0166666666667</code></p>
<p>If you want to alert when the rate of restarts is above 1 within a 1-minute window, you would set the threshold above <code class="literal">0.0166666666667</code>.</p>
<p>The calculation you need to use depends on the interval that&#8217;s selected.</p>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="aggregation-options.html">« Aggregation options</a>
</span>
<span class="next">
<a href="view-observability-alerts.html">View alerts »</a>
</span>
</div>
</body>
</html>
