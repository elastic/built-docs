<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Use the Synthetics CLI | Elastic Observability [8.15] | Elastic</title>
<meta class="elastic" name="content" content="Use the Synthetics CLI | Elastic Observability [8.15]">

<link rel="home" href="index.html" title="Elastic Observability [8.15]"/>
<link rel="up" href="monitor-uptime-synthetics.html" title="Synthetic monitoring"/>
<link rel="prev" href="synthetics-private-location.html" title="Monitor resources on private networks"/>
<link rel="next" href="_filtering_monitors.html" title="Filtering monitors"/>
<meta class="elastic" name="product_version" content="8.15"/>
<meta class="elastic" name="product_name" content="Observability"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Observability/Guide/8.15"/>
<meta name="DC.subject" content="Observability"/>
<meta name="DC.identifier" content="8.15"/>
</head>
<body>
<div class="navheader">
<span class="prev">
<a href="synthetics-private-location.html">« Monitor resources on private networks</a>
</span>
<span class="next">
<a href="_filtering_monitors.html">Filtering monitors »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Observability [8.15]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="monitor-uptime-synthetics.html">Synthetic monitoring</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Use the Synthetics CLI</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/8.15/docs/en/observability/synthetics-command-reference.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="synthetics-command-reference"></a>Use the Synthetics CLI<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/8.15/docs/en/observability/synthetics-command-reference.asciidoc">edit</a></h2>
</div></div></div>

<h3><a id="elastic-synthetics-command"></a><code class="literal">@elastic/synthetics</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/8.15/docs/en/observability/synthetics-command-reference.asciidoc">edit</a></h3>
<p>The Synthetics app uses the
<a href="https://www.npmjs.com/package/@elastic/synthetics" class="ulink" target="_top">@elastic/synthetics</a> Node.js
library to run synthetic browser tests and report the test results.
The library also provides a CLI to help you scaffold, develop/run tests locally, and push tests to Kibana.</p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">npx @elastic/synthetics [options] [files] [dir]</pre>
</div>
<p>You will not need to use most command line flags&#8201;&#8212;&#8201;they have been implemented
purely to interact with the Synthetics app.
However, there are some you may find useful:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">--match &lt;string&gt;</code>
</span>
</dt>
<dd>
run tests with a name or tags that match the given glob pattern.
</dd>
<dt>
<span class="term">
<code class="literal">--tags Array&lt;string&gt;</code>
</span>
</dt>
<dd>
run tests with the given tags that match the given glob pattern.
</dd>
<dt>
<span class="term">
<code class="literal">--pattern &lt;string&gt;</code>
</span>
</dt>
<dd>
RegExp pattern to match journey files in the current working directory. Defaults
to <code class="literal">/*.journey.(ts|js)$/</code>, which matches files ending with <code class="literal">.journey.ts</code> or <code class="literal">.journey.js</code>.
</dd>
<dt>
<span class="term">
<code class="literal">--params &lt;jsonstring&gt;</code>
</span>
</dt>
<dd>
<p>
JSON object that defines any variables your tests require.
Read more in <a class="xref" href="synthetics-params-secrets.html" title="Work with params and secrets">Work with params and secrets</a>.
</p>
<p>Params passed will be merged with params defined in your
<a class="xref" href="synthetics-configuration.html#synthetics-configuration-params" title="params"><code class="literal">synthetics.config.js</code> file</a>.
Params defined via the CLI take precedence.</p>
</dd>
<dt>
<span class="term">
<code class="literal">--playwright-options &lt;jsonstring&gt;</code>
</span>
</dt>
<dd>
<p>
JSON object to pass in custom Playwright options for the agent.
For more details on relevant Playwright options, refer to the
<a class="xref" href="synthetics-configuration.html#synthetics-configuration-playwright-options" title="playwrightOptions">the configuration docs</a>.
</p>
<p>Options passed will be merged with Playwright options defined in your
<a class="xref" href="synthetics-configuration.html#synthetics-configuration-playwright-options" title="playwrightOptions"><code class="literal">synthetics.config.js</code> file</a>.
Options defined via the CLI take precedence.</p>
</dd>
<dt>
<span class="term">
<code class="literal">--screenshots &lt;on|off|only-on-failure&gt;</code>
</span>
</dt>
<dd>
<p>
Control whether or not to capture screenshots at the end of each step.
Options include <code class="literal">'on'</code>, <code class="literal">'off'</code>, or <code class="literal">'only-on-failure'</code>.
</p>
<p>This can also be set in the configuration file using
<a class="xref" href="synthetics-configuration.html#synthetics-configuration-monitor" title="monitor"><code class="literal">monitor.screenshot</code></a>.
The value defined via the CLI will take precedence.</p>
</dd>
<dt>
<span class="term">
<code class="literal">-c, --config &lt;string&gt;</code>
</span>
</dt>
<dd>
Path to the configuration file. By default, test runner looks for a
<code class="literal">synthetics.config.(js|ts)</code> file in the current directory. Synthetics
configuration provides options to configure how your tests are run and pushed to
Kibana. Allowed options are described in the <a class="xref" href="synthetics-configuration.html#synthetics-config-file">configuration file</a>.
</dd>
<dt>
<span class="term">
<code class="literal">--reporter &lt;json|junit|buildkite-cli|default&gt;</code>
</span>
</dt>
<dd>
One of <code class="literal">json</code>, <code class="literal">junit</code>, <code class="literal">buildkite-cli</code>, or <code class="literal">default</code>. Use the JUnit or Buildkite
reporter to provide easily parsed output to CI systems.
</dd>
<dt>
<span class="term">
<code class="literal">--inline</code>
</span>
</dt>
<dd>
Instead of reading from a file, <code class="literal">cat</code> inline scripted journeys and pipe them through <code class="literal">stdin</code>.
For example, <code class="literal">cat path/to/file.js | npx @elastic/synthetics --inline</code>.
</dd>
<dt>
<span class="term">
<code class="literal">--no-throttling</code>
</span>
</dt>
<dd>
<p>
Does not apply throttling.
</p>
<p>Throttling can also be disabled in the configuration file using
<a class="xref" href="synthetics-configuration.html#synthetics-configuration-monitor" title="monitor"><code class="literal">monitor.throttling</code></a>.
The value defined via the CLI will take precedence.</p>
</dd>
</dl>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Network throttling for browser based monitors is disabled.
See this <a href="https://github.com/elastic/synthetics/blob/main/docs/throttling.md" class="ulink" target="_top">documention</a> for more details.</p>
</div>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">--no-headless</code>
</span>
</dt>
<dd>
<p>
Runs with the browser in headful mode.
</p>
<p>This is the same as setting <a href="https://playwright.dev/docs/api/class-testoptions#test-options-headless" class="ulink" target="_top">Playwright&#8217;s <code class="literal">headless</code> option</a> to <code class="literal">false</code> by running <code class="literal">--playwright-options '{"headless": false}'</code>.</p>
</dd>
</dl>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Headful mode should only be used locally to see the browser and interact with DOM elements directly for testing purposes. Do not attempt to run in headful mode when running through Elastic&#8217;s global managed testing infrastructure or Private Locations as this is not supported.</p>
</div>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">-h, --help</code>
</span>
</dt>
<dd>
Shows help for the <code class="literal">npx @elastic/synthetics</code> command.
</dd>
</dl>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The <code class="literal">--pattern</code>, <code class="literal">--tags</code>, and <code class="literal">--match</code> flags for filtering are only supported when you
run synthetic tests locally or push them to Kibana. Filtering is <em>not</em> supported in any other subcommands
like <code class="literal">init</code> and <code class="literal">locations</code>.</p>
</div>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>For debugging synthetic tests locally, you can set an environment variable,
<code class="literal">DEBUG=synthetics npx @elastic/synthetics</code>, to capture Synthetics agent logs.</p>
</div>
</div>
<h3><a id="elastic-synthetics-init-command"></a><code class="literal">@elastic/synthetics init</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/8.15/docs/en/observability/synthetics-command-reference.asciidoc">edit</a></h3>
<p>Scaffold a new project using Elastic Synthetics.</p>
<p>This will create a template Node.js project that includes the synthetics agent, required dependencies,
a synthetics configuration file, and example browser and lightweight monitor files.
These files can be edited and then pushed to Kibana to create monitors.</p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">npx @elastic/synthetics init &lt;name-of-project&gt;</pre>
</div>
<p>Read more about what&#8217;s included in a template project in <a class="xref" href="synthetics-get-started-project.html#synthetics-get-started-project-init" title="Create a project">Create a project</a>.</p>
<h3><a id="elastic-synthetics-push-command"></a><code class="literal">@elastic/synthetics push</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/8.15/docs/en/observability/synthetics-command-reference.asciidoc">edit</a></h3>
<p>Create monitors in Kibana by using your local journeys. By default, running
<code class="literal">push</code> command will use the <code class="literal">project</code> settings field from the <code class="literal">synthetics.config.ts</code>
file, which is set up using the <code class="literal">init</code> command. However, you can override these
settings using the CLI flags.</p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">SYNTHETICS_API_KEY=&lt;api-key&gt; npx @elastic/synthetics push --url &lt;kibana-url&gt; --id &lt;id|name&gt;</pre>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The <code class="literal">push</code> command includes interactive prompts to prevent you from accidentally deleting or duplicating monitors.
You will see a prompt when:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
You <code class="literal">push</code> a project that used to contain one or more monitors but either no longer
  contains previously running monitors or has any monitors.
Select <code class="literal">yes</code> to delete the monitors associated with the project ID being pushed.
</li>
<li class="listitem">
You <code class="literal">push</code> a project that&#8217;s already been pushed using one project ID and then try to <code class="literal">push</code>
  it using a <em>different</em> ID.
Select <code class="literal">yes</code> to create duplicates of all monitors in the project.
</li>
</ul>
</div>
<p>You can set <code class="literal">DEBUG=synthetics</code> environment variable to capture the deleted monitors.</p>
</div>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>If the journey contains external NPM packages other than the <code class="literal">@elastic/synthetics</code>,
those packages will be bundled along with the journey code when the <code class="literal">push</code> command is invoked.
However there are some limitations when using external packages:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Bundled journeys after compression should not be more than 1500 Kilobytes.
</li>
<li class="listitem">
Native node modules will not work as expected due to platform inconsistency.
</li>
<li class="listitem">
Uploading files in journey scripts(via locator.setInputFiles) is not supported.
</li>
</ul>
</div>
</div>
</div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">--auth &lt;string&gt;</code>
</span>
</dt>
<dd>
<p>
API key used for <a href="/guide/en/kibana/8.15/api-keys.html" class="ulink" target="_top">Kibana authentication</a>. You can also set the API key via the <code class="literal">SYNTHETICS_API_KEY</code> environment variable.
</p>
<p>If you are pushing to a <a class="xref" href="synthetics-get-started-ui.html#private-locations">Private Location</a>, you must use an API key generated in 8.4 or higher.</p>
<p>To create an API key, you must be logged into Kibana as a user with the privileges described in
<a class="xref" href="synthetics-role-write.html" title="Writer role">Writer role</a>.</p>
</dd>
<dt>
<span class="term">
<code class="literal">--id &lt;string&gt;</code>
</span>
</dt>
<dd>
<p>
A unique id associated with your project.
It will be used for logically grouping monitors.
</p>
<p>If you used <a class="xref" href="synthetics-command-reference.html#elastic-synthetics-init-command" title="@elastic/synthetics init"><code class="literal">init</code> to create a project</a>, this is the <code class="literal">&lt;name-of-project&gt;</code> you specified.</p>
<p>This can also be set in the configuration file using
<a class="xref" href="synthetics-configuration.html#synthetics-configuration-project" title="project"><code class="literal">project.id</code></a>.
The value defined via the CLI will take precedence.</p>
</dd>
<dt>
<span class="term">
<code class="literal">--url &lt;string&gt;</code>
</span>
</dt>
<dd>
<p>
The Kibana URL for the deployment to which you want to upload the monitors.
</p>
<p>This can also be set in the configuration file using
<a class="xref" href="synthetics-configuration.html#synthetics-configuration-project" title="project"><code class="literal">project.url</code></a>.
The value defined via the CLI will take precedence.</p>
</dd>
<dt>
<span class="term">
<code class="literal">--space &lt;string&gt;</code>
</span>
</dt>
<dd>
<p>
The identifier of the target <a href="/guide/en/kibana/8.15/xpack-spaces.html" class="ulink" target="_top">Kibana space</a> for the pushed monitors.
Spaces help you organize pushed monitors.
Pushes to the "default" space if not specified.
</p>
<p>This can also be set in the configuration file using
<a class="xref" href="synthetics-configuration.html#synthetics-configuration-project" title="project"><code class="literal">project.space</code></a>.
The value defined via the CLI will take precedence.</p>
</dd>
<dt>
<span class="term">
<code class="literal">--schedule &lt;number&gt;</code>
</span>
</dt>
<dd>
<p>
The interval (in minutes) at which the monitor should run.
</p>
<p>This can also be set in the configuration file using
<a class="xref" href="synthetics-configuration.html#synthetics-configuration-monitor" title="monitor"><code class="literal">monitor.schedule</code></a>.
The value defined via the CLI will take precedence.</p>
</dd>
<dt>
<span class="term">
<a href="https://github.com/elastic/synthetics/blob/v1.3.0/src/locations/public-locations.ts#L28-L37" class="ulink" target="_top"><code class="literal">--locations Array&lt;SyntheticsLocationsType&gt;</code></a>
</span>
</dt>
<dd>
<p>
Where to deploy the monitor. Monitors can be deployed in multiple locations so that you can detect differences in availability and response times across those locations.
</p>
<p>To list available locations, refer to <a class="xref" href="_filtering_monitors.html#elastic-synthetics-locations-command" title="@elastic/synthetics locations"><code class="literal">@elastic/synthetics locations</code></a>.</p>
<p>This can also be set in the configuration file using
<a class="xref" href="synthetics-configuration.html#synthetics-configuration-monitor" title="monitor"><code class="literal">monitor.locations</code> in the configuration file</a>.
The value defined via the CLI will take precedence.</p>
</dd>
<dt>
<span class="term">
<code class="literal">--private-locations Array&lt;string&gt;</code>
</span>
</dt>
<dd>
<p>
The <a class="xref" href="synthetics-private-location.html" title="Monitor resources on private networks">Private Locations</a> to which the monitors will be deployed. These Private Locations refer to locations hosted and managed by you, whereas
<code class="literal">locations</code> are hosted by Elastic. You can specify a Private Location using the location&#8217;s name.
</p>
<p>To list available Private Locations, refer to <a class="xref" href="_filtering_monitors.html#elastic-synthetics-locations-command" title="@elastic/synthetics locations"><code class="literal">@elastic/synthetics locations</code></a>.</p>
<p>This can also be set in the configuration file using
<a class="xref" href="synthetics-configuration.html#synthetics-configuration-monitor" title="monitor"><code class="literal">monitor.privateLocations</code> in the configuration file</a>.
The value defined via the CLI will take precedence.</p>
</dd>
<dt>
<span class="term">
<code class="literal">--yes</code>
</span>
</dt>
<dd>
<p>
The <code class="literal">push</code> command includes interactive prompts to prevent you from accidentally deleting or duplicating monitors.
If running the CLI non-interactively, you can override these prompts using the <code class="literal">--yes</code> option.
When the <code class="literal">--yes</code> option is passed to <code class="literal">push</code>:
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If you <code class="literal">push</code> a project that used to contain one or more monitors but no longer contains any monitors,
all monitors associated with the project ID being pushed will be deleted.
</li>
<li class="listitem">
If you <code class="literal">push</code> a project that&#8217;s already been pushed using one project ID and then try to <code class="literal">push</code>
it using a <em>different</em> ID, it will create duplicates of all monitors in the
project.
</li>
</ul>
</div>
</dd>
</dl>
</div>
<h3><a id="tagging-and-filtering"></a>Tagging and Filtering monitors<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/8.15/docs/en/observability/synthetics-command-reference.asciidoc">edit</a></h3>
<p>Synthetics journeys can be tagged with one or more tags. Use tags to
filter journeys when running tests locally or pushing them to Kibana.</p>
<p>To add tags to a single journey, add the <code class="literal">tags</code> parameter to the <code class="literal">journey</code> function or
use the <code class="literal">monitor.use</code> method.</p>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">import {journey, monitor} from "@elastic/synthetics";

journey({name: "example journey", tags: ["env:qa"] }, ({ page }) =&gt; {
  monitor.use({
    tags: ["env:qa"]
  })
  // Add steps here
});</pre>
</div>
<p>For lightweight monitors, use the <code class="literal">tags</code> field in the yaml configuration file.</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">name: example monitor
tags:
  - env:qa</pre>
</div>
<p>To apply tags to all browser and lightweight monitors, configure using <a class="xref" href="synthetics-configuration.html#synthetics-configuration-monitor" title="monitor"><code class="literal">monitor.tags</code></a> field in the <code class="literal">synthetics.config.ts</code> file.</p>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="synthetics-private-location.html">« Monitor resources on private networks</a>
</span>
<span class="next">
<a href="_filtering_monitors.html">Filtering monitors »</a>
</span>
</div>
</body>
</html>
