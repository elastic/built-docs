<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Parse data using ingest pipelines | Elastic Observability [master] | Elastic</title>
<meta class="elastic" name="content" content="Parse data using ingest pipelines | Elastic Observability [master]">

<link rel="home" href="index.html" title="Elastic Observability [master]"/>
<link rel="up" href="apm-manage-storage.html" title="Manage storage"/>
<link rel="prev" href="apm-custom-index-template.html" title="View the Elasticsearch index template"/>
<link rel="next" href="apm-storage-guide.html" title="Storage and sizing guide"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="Observability"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Observability/Guide/master"/>
<meta name="DC.subject" content="Observability"/>
<meta name="DC.identifier" content="master"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
This documentation contains work-in-progress information for future Elastic Stack and Cloud releases. Use the version selector to view supported release docs. It also contains some Elastic Cloud serverless information. Check out our <a href="https://www.elastic.co/docs/current/serverless">serverless docs</a> for more details.
</div>
<div class="navheader">
<span class="prev">
<a href="apm-custom-index-template.html">« View the Elasticsearch index template</a>
</span>
<span class="next">
<a href="apm-storage-guide.html">Storage and sizing guide »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Observability [master]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="apm.html">Application performance monitoring (APM)</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="apm-manage-storage.html">Manage storage</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Parse data using ingest pipelines</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/observability/apm/ingest-pipelines.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="apm-ingest-pipelines"></a>Parse data using ingest pipelines<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/observability/apm/ingest-pipelines.asciidoc">edit</a></h3>
</div></div></div>
<p>Ingest pipelines preprocess and enrich APM documents before indexing them.
For example, a pipeline might define one processor that removes a field,
one that transforms a field, and another that renames a field.</p>
<p>The default APM pipelines are defined in index templates that Fleet loads into Elasticsearch.
Elasticsearch then uses the index pattern in these index templates to match pipelines to APM data streams.</p>
<h4><a id="custom-ingest-pipelines"></a>Custom ingest pipelines<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/observability/apm/ingest-pipelines.asciidoc">edit</a></h4>
<p>The Elastic APM integration supports custom ingest pipelines.
A custom pipeline allows you to transform data to better match your specific use case.
This can be useful, for example, to ensure data security by removing or obfuscating sensitive information.</p>
<p>Each data stream ships with a default pipeline.
This default pipeline calls an initially non-existent and non-versioned "<code class="literal">@custom</code>" ingest pipeline.
If left uncreated, this pipeline has no effect on your data. However, if utilized,
this pipeline can be used for custom data processing, adding fields, sanitizing data, and more.</p>
<p>In addition, ingest pipelines can also be used to direct application metrics (<code class="literal">metrics-apm.app.*</code>) to a data stream with a different dataset, e.g. to combine metrics for two applications.
Sending other APM data to alternate data streams, like traces (<code class="literal">traces-apm.*</code>), logs (<code class="literal">logs-apm.*</code>), and internal metrics (<code class="literal">metrics-apm.internal*</code>) is not currently supported.</p>
<h4><a id="custom-ingest-pipeline-naming"></a><code class="literal">@custom</code> ingest pipeline naming convention<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/observability/apm/ingest-pipelines.asciidoc">edit</a></h4>
<p><code class="literal">@custom</code> pipelines are specific to each data stream and follow a similar naming convention: <code class="literal">&lt;type&gt;-&lt;dataset&gt;@custom</code>.
As a reminder, the default APM data streams are:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Application traces: <code class="literal">traces-apm-&lt;namespace&gt;</code>
</li>
<li class="listitem">
RUM and iOS agent application traces: <code class="literal">traces-apm.rum-&lt;namespace&gt;</code>
</li>
<li class="listitem">
APM internal metrics: <code class="literal">metrics-apm.internal-&lt;namespace&gt;</code>
</li>
<li class="listitem">
APM transaction metrics: <code class="literal">metrics-apm.transaction.&lt;metricset.interval&gt;-&lt;namespace&gt;</code>
</li>
<li class="listitem">
APM service destination metrics: <code class="literal">metrics-apm.service_destination.&lt;metricset.interval&gt;-&lt;namespace&gt;</code>
</li>
<li class="listitem">
APM service transaction metrics: <code class="literal">metrics-apm.service_transaction.&lt;metricset.interval&gt;-&lt;namespace&gt;</code>
</li>
<li class="listitem">
APM service summary metrics: <code class="literal">metrics-apm.service_summary.&lt;metricset.interval&gt;-&lt;namespace&gt;</code>
</li>
<li class="listitem">
Application metrics: <code class="literal">metrics-apm.app.&lt;service.name&gt;-&lt;namespace&gt;</code>
</li>
<li class="listitem">
APM error/exception logging: <code class="literal">logs-apm.error-&lt;namespace&gt;</code>
</li>
<li class="listitem">
APM app logging: <code class="literal">logs-apm.app.&lt;service.name&gt;-&lt;namespace&gt;</code>
</li>
</ul>
</div>
<p>To match a custom ingest pipeline with a data stream, follow the <code class="literal">&lt;type&gt;-&lt;dataset&gt;@custom</code> template,
or replace <code class="literal">-namespace</code> with <code class="literal">@custom</code> in the table above.
For example, to target application traces, you&#8217;d create a pipeline named <code class="literal">traces-apm@custom</code>.</p>
<p>The <code class="literal">@custom</code> pipeline can directly contain processors or you can use the
pipeline processor to call other pipelines that can be shared across multiple data streams or integrations.
The <code class="literal">@custom</code> pipeline will persist across all version upgrades.</p>
<h4><a id="custom-ingest-pipeline-create"></a>Create a <code class="literal">@custom</code> ingest pipeline<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/observability/apm/ingest-pipelines.asciidoc">edit</a></h4>
<p>The process for creating a custom ingest pipeline is as follows:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Create a pipeline with processors specific to your use case
</li>
<li class="listitem">
Add the newly created pipeline to an <code class="literal">@custom</code> pipeline that matches an APM data stream
</li>
</ul>
</div>
<p>If you prefer more guidance, see one of these tutorials:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="apm-custom-filter.html#apm-filters-ingest-pipeline" title="Create an ingest pipeline filter">Create an ingest pipeline filter</a> — Learn how to obfuscate passwords stored in the <code class="literal">http.request.body.original</code> field.
</li>
<li class="listitem">
<a class="xref" href="apm-data-streams.html#apm-data-stream-rerouting" title="APM data stream rerouting">APM data stream rerouting</a> — Learn how rerouting APM data to user-defined APM data streams.
</li>
<li class="listitem">
<a href="/guide/en/fleet/master/data-streams-pipeline-tutorial.html" class="ulink" target="_top">Transform data with custom ingest pipelines</a> — A basic Elastic integration tutorial where you learn how to add a custom field to incoming data.
</li>
</ul>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="apm-custom-index-template.html">« View the Elasticsearch index template</a>
</span>
<span class="next">
<a href="apm-storage-guide.html">Storage and sizing guide »</a>
</span>
</div>
</body>
</html>
