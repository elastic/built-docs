<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Switch a self-installation to the APM integration | Elastic Observability [master] | Elastic</title>
<meta class="elastic" name="content" content="Switch a self-installation to the APM integration | Elastic Observability [master]">

<link rel="home" href="index.html" title="Elastic Observability [master]"/>
<link rel="up" href="apm-upgrade-to-apm-integration.html" title="Switch to the Elastic APM integration"/>
<link rel="prev" href="apm-upgrade-to-apm-integration.html" title="Switch to the Elastic APM integration"/>
<link rel="next" href="apm-integration-upgrade-steps-ess.html" title="Switch an Elastic Cloud cluster to the APM integration"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="Observability"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Observability/Guide/master"/>
<meta name="DC.subject" content="Observability"/>
<meta name="DC.identifier" content="master"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
This documentation contains work-in-progress information for future Elastic Stack and Cloud releases. Use the version selector to view supported release docs. It also contains some Elastic Cloud serverless information. Check out our <a href="https://www.elastic.co/docs/current/serverless">serverless docs</a> for more details.
</div>
<div class="navheader">
<span class="prev">
<a href="apm-upgrade-to-apm-integration.html">« Switch to the Elastic APM integration</a>
</span>
<span class="next">
<a href="apm-integration-upgrade-steps-ess.html">Switch an Elastic Cloud cluster to the APM integration »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Observability [master]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="apm.html">Application performance monitoring (APM)</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="apm-upgrade.html">Upgrade</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="apm-upgrade-to-apm-integration.html">Switch to the Elastic APM integration</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Switch a self-installation to the APM integration</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/observability/apm/upgrading-to-integration.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="apm-integration-upgrade-steps"></a>Switch a self-installation to the APM integration<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/observability/apm/upgrading-to-integration.asciidoc">edit</a></h4>
</div></div></div>

<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<a class="xref" href="apm-integration-upgrade-steps.html#apm-integration-upgrade-1" title="Upgrade the Elastic Stack">Upgrade the Elastic Stack</a>
</li>
<li class="listitem">
<a class="xref" href="apm-integration-upgrade-steps.html#apm-integration-upgrade-2" title="Add a Fleet Server">Add a Fleet Server</a>
</li>
<li class="listitem">
<a class="xref" href="apm-integration-upgrade-steps.html#apm-integration-upgrade-3" title="Install a Fleet-managed Elastic Agent">Install a Fleet-managed Elastic Agent</a>
</li>
<li class="listitem">
<a class="xref" href="apm-integration-upgrade-steps.html#apm-integration-upgrade-4" title="Add the APM integration">Add the APM integration</a>
</li>
<li class="listitem">
<a class="xref" href="apm-integration-upgrade-steps.html#apm-integration-upgrade-5" title="Stop the APM Server">Stop the APM Server</a>
</li>
</ol>
</div>
<h5><a id="apm-integration-upgrade-1"></a>Upgrade the Elastic Stack<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/observability/apm/upgrading-to-integration.asciidoc">edit</a></h5>
<p>The Elastic Stack (Elasticsearch and Kibana) must be upgraded to version 7.14 or higher.
See the <a href="/guide/en/elastic-stack/master/upgrading-elastic-stack.html" class="ulink" target="_top">Elastic Stack Installation and Upgrade Guide</a> for guidance.</p>
<p>Review the APM <a class="xref" href="apm-release-notes.html" title="Release notes">release notes</a>, <a class="xref" href="apm-breaking.html" title="Breaking Changes">breaking changes</a>,
and Observability <a href="/guide/en/observability/master/whats-new.html" class="ulink" target="_top">What&#8217;s new</a> content for important changes between
your current APM version and this one.</p>
<h5><a id="apm-integration-upgrade-2"></a>Add a Fleet Server<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/observability/apm/upgrading-to-integration.asciidoc">edit</a></h5>
<p>Fleet Server is a component of the Elastic Stack used to centrally manage Elastic Agents.
The APM integration requires a Fleet Server to be running and accessible to your hosts.
Add a Fleet Server by following <a href="/guide/en/fleet/master/add-a-fleet-server.html" class="ulink" target="_top">this guide</a>.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>If you&#8217;re upgrading a self-managed deployment of the Elastic Stack, you&#8217;ll need to enable
<a href="/guide/en/elasticsearch/reference/master/configuring-stack-security.html" class="ulink" target="_top">Elasticsearch security</a> and the
<a href="/guide/en/elasticsearch/reference/master/security-settings.html" class="ulink" target="_top">API key service</a>.</p>
</div>
</div>
<p>After adding your Fleet Server host and generating a service token, the in-product help in Kibana
will provide a command to run to start an Elastic Agent as a Fleet Server.
Commands may require administrator privileges.</p>
<p>Verify Fleet Server is running by navigating to <span class="strong strong"><strong>Fleet</strong></span> &gt; <span class="strong strong"><strong>Agents</strong></span> in Kibana.</p>
<h5><a id="apm-integration-upgrade-3"></a>Install a Fleet-managed Elastic Agent<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/observability/apm/upgrading-to-integration.asciidoc">edit</a></h5>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>It&#8217;s possible to install the Elastic APM integration on the same Elastic Agent that is running the Fleet Server integration. For this use case, skip this step.</p>
</div>
</div>
<p>The Fleet-managed Elastic Agent will run the Elastic APM integration on your edge nodes, next to your applications.
To install a Fleet-managed Elastic Agent, follow <a href="/guide/en/fleet/master/install-fleet-managed-elastic-agent.html" class="ulink" target="_top">this guide</a>.</p>
<h5><a id="apm-integration-upgrade-4"></a>Add the APM integration<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/observability/apm/upgrading-to-integration.asciidoc">edit</a></h5>
<p>The APM integration receives performance data from your APM agents,
validates and processes it, and then transforms the data into Elasticsearch documents.</p>
<p>To add the APM integration, see <a class="xref" href="traces-get-started.html#add-apm-integration" title="Step 1: Configure the APM integration">Step 1: Configure the APM integration</a>.
Only complete the linked step (not the entire quick start guide).
If you&#8217;re adding the APM integration to a Fleet-managed Elastic Agent, you can use the default policy.
If you&#8217;re adding the APM integration to the Fleet Server, use the policy that the Fleet Server is running on.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>You&#8217;ll configure the APM integration in this step.
See <a class="xref" href="apm-configuring-howto-apm-server.html" title="Configure">Configure</a> for a reference of all available settings.
As long as the APM integration is configured with the same secret token or you have API keys enabled on the same host,
no reconfiguration is required in your APM agents.</p>
</div>
</div>
<h5><a id="apm-integration-upgrade-5"></a>Stop the APM Server<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/observability/apm/upgrading-to-integration.asciidoc">edit</a></h5>
<p>Once data from upgraded APM agents is visible in the APM app,
it&#8217;s safe to stop the APM Server process.</p>
<p>Congratulations&#8201;&#8212;&#8201;you now have the latest and greatest in Elastic APM!</p>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="apm-upgrade-to-apm-integration.html">« Switch to the Elastic APM integration</a>
</span>
<span class="next">
<a href="apm-integration-upgrade-steps-ess.html">Switch an Elastic Cloud cluster to the APM integration »</a>
</span>
</div>
</body>
</html>
