<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Known issues | Elastic Observability [master] | Elastic</title>
<meta class="elastic" name="content" content="Known issues | Elastic Observability [master]">

<link rel="home" href="index.html" title="Elastic Observability [master]"/>
<link rel="up" href="apm.html" title="Application performance monitoring (APM)"/>
<link rel="prev" href="apm-release-notes-8.0.html" title="APM version 8.0"/>
<link rel="next" href="logs-checklist.html" title="Logs resource guide"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="Observability"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Observability/Guide/master"/>
<meta name="DC.subject" content="Observability"/>
<meta name="DC.identifier" content="master"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body><div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Observability [master]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="apm.html">Application performance monitoring (APM)</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="apm-release-notes-8.0.html">« APM version 8.0</a>
</span>
<span class="next">
<a href="logs-checklist.html">Logs resource guide »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="known-issues"></a>Known issues<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/observability/apm/known-issues.asciidoc">edit</a></h2>
</div></div></div>
<p>APM has the following known issues:</p>
<p><a id="apm-empty-metricset-values"></a><span class="strong strong"><strong>Upgrading APM Server to 8.11+ might break event intake from older APM Java agents</strong></span><br>
<em>APM Server versions: &gt;=8.11.0</em><br>
<em>Elastic APM Java agent versions: &lt; 1.43.0</em></p>
<p>If you are using APM Server (&gt; v8.11.0) and the Elastic APM Java agent (&lt; v1.43.0),
the agent may be sending empty histogram metricsets.</p>
<p>In previous APM Server versions some data validation was not properly applied,
leading the APM Server to accept empty histogram metricsets where it shouldn&#8217;t.
This bug was fixed in the APM Server in 8.11.0.</p>
<p>The APM Java agent (&lt; v1.43.0) was sending this kind of invalid data under certain circumstances.
If you upgrade the APM Server to v8.11.0+ <em>without</em> upgrading the APM Java agent version,
metricsets can be rejected by the APM Server and can result in additional error logs in the Java agent.</p>
<p>The fix is to upgrade the Elastic APM Java agent to a version &gt;= 1.43.0.
Find details in <a href="https://github.com/elastic/apm-data/pull/157" class="ulink" target="_top">elastic/apm-data#157</a>.</p>
<p><span class="strong strong"><strong>traces-apm@custom ingest pipeline applied to certain data streams unintentionally</strong></span><br>
<em>APM Server versions: 8.12.0</em><br></p>
<p>If you&#8217;re using the Elastic APM Server v8.12.0,
the <code class="literal">traces-apm@custom</code> ingest pipeline is now additionally applied to data streams <code class="literal">traces-apm.sampled-*</code>
and <code class="literal">traces-apm.rum-*</code>, and applied twice for <code class="literal">traces-apm-*</code>. This bug impacts users with a non-empty <code class="literal">traces-apm@custom</code> ingest pipeline.</p>
<p>If you rely on this unintended behavior in 8.12.0, please rename your pipeline to <code class="literal">traces-apm.integration@custom</code> to preserve this behavior in later versions.</p>
<p>A fix was released in 8.12.1: <a href="https://github.com/elastic/kibana/pull/175448" class="ulink" target="_top">elastic/kibana#175448</a>.</p>
<p><span class="strong strong"><strong>Ingesting new JVM metrics in 8.9 and 8.10 breaks upgrade to 8.11 and stops ingestion</strong></span><br>
<em>APM Server versions: 8.11.0, 8.11.1</em><br>
<em>Elastic APM Java agent versions: 1.39.0+</em></p>
<p>If you&#8217;re using the Elastic APM Java agent v1.39.0+ to send new JVM metrics to APM Server v8.9.x and v8.10.x,
upgrading to 8.11.0 or 8.11.1 will silently fail and stop ingesting APM metrics.</p>
<p>After upgrading, you will see the following errors:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>APM Server error logs:</p>
<div class="pre_wrapper lang-txt">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-txt">failed to index document in 'metrics-apm.internal-default' (fail_processor_exception): Document produced by APM Server v8.11.1, which is newer than the installed APM integration (v8.10.3-preview-1695284222). The APM integration must be upgraded.</pre>
</div>
</li>
<li class="listitem">
<p>Fleet error on integration package upgrade:</p>
<div class="pre_wrapper lang-txt">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-txt">Failed installing package [apm] due to error: [ResponseError: mapper_parsing_exception
	Root causes:
		mapper_parsing_exception: Field [jvm.memory.non_heap.pool.committed] attempted to shadow a time_series_metric]</pre>
</div>
</li>
</ul>
</div>
<p>A fix was released in 8.11.2: <a href="https://github.com/elastic/kibana/pull/171712" class="ulink" target="_top">elastic/kibana#171712</a>.</p>
<p><span class="strong strong"><strong>APM integration package upgrade through Fleet causes excessive data stream rollovers</strong></span><br>
<em>APM Server versions: &lt;= 8.12.1 +</em></p>
<p>If you&#8217;re upgrading APM integration package to any versions &lt;= 8.12.1,
in some rare cases, the upgrade fails with a mapping conflict error. The upgrade process keeps rolling
over the data stream in an unsuccessful attempt to work around the error. As a result, many empty backing indices for
APM data streams are created.</p>
<p>During upgrade, you will see errors similar to the one below:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Fleet error on integration package upgrade:</p>
<div class="pre_wrapper lang-txt">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-txt">Mappings update for metrics-apm.service_destination.10m-default failed due to ResponseError: illegal_argument_exception
	Root causes:
		illegal_argument_exception: Mapper for [metricset.interval] conflicts with existing mapper:
	Cannot update parameter [value] from [10m] to [null]</pre>
</div>
</li>
</ul>
</div>
<p>A fix was released in 8.12.2: <a href="https://github.com/elastic/apm-server/pull/12219" class="ulink" target="_top">elastic/apm-server#12219</a>.</p>
</div>
<div class="navfooter">
<span class="prev">
<a href="apm-release-notes-8.0.html">« APM version 8.0</a>
</span>
<span class="next">
<a href="logs-checklist.html">Logs resource guide »</a>
</span>
</div>
</div>
</body>
</html>
