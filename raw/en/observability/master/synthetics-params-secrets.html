<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Work with params and secrets | Elastic Observability [master] | Elastic</title>
<meta class="elastic" name="content" content="Work with params and secrets | Elastic Observability [master]">

<link rel="home" href="index.html" title="Elastic Observability [master]"/>
<link rel="up" href="monitor-uptime-synthetics.html" title="Synthetic monitoring"/>
<link rel="prev" href="synthetics-manage-monitors.html" title="Manage monitors"/>
<link rel="next" href="synthetics-analyze.html" title="Analyze data from synthetic monitors"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="Observability"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Observability/Guide/master"/>
<meta name="DC.subject" content="Observability"/>
<meta name="DC.identifier" content="master"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
This documentation contains work-in-progress information for future Elastic Stack and Cloud releases. Use the version selector to view supported release docs. It also contains some Elastic Cloud serverless information. Check out our <a href="https://www.elastic.co/docs/current/serverless">serverless docs</a> for more details.
</div>
<div class="navheader">
<span class="prev">
<a href="synthetics-manage-monitors.html">« Manage monitors</a>
</span>
<span class="next">
<a href="synthetics-analyze.html">Analyze data from synthetic monitors »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Observability [master]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="monitor-uptime-synthetics.html">Synthetic monitoring</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Work with params and secrets</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/observability/synthetics-params-secrets.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="synthetics-params-secrets"></a>Work with params and secrets<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/observability/synthetics-params-secrets.asciidoc">edit</a></h2>
</div></div></div>
<p>Params allow you to use dynamically defined values in your synthetic monitors.
For example, you may want to test a production website with a particular
demo account whose password is only known to the team managing the synthetic monitors.</p>
<p>For more information about security-sensitive use cases, refer to the <a class="xref" href="synthetics-params-secrets.html#synthetics-secrets-sensitive" title="Working with secrets and sensitive values">documentation about sensitive values</a>.</p>
<h3><a id="synthetics-params-secrets-define"></a>Define params<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/observability/synthetics-params-secrets.asciidoc">edit</a></h3>
<p>Param values can be declared by any of the following methods:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
In the <em>Global parameters</em> tab of the <a class="xref" href="synthetics-settings.html#synthetics-settings-global-parameters" title="Global parameters">Synthetics Settings page in Kibana</a>.
</li>
<li class="listitem">
Declaring a default value for the parameter in a <a class="xref" href="synthetics-params-secrets.html#synthetics-dynamic-configs" title="Project config file">configuration file</a>.
</li>
<li class="listitem">
Passing the <code class="literal">--params</code> <a class="xref" href="synthetics-params-secrets.html#synthetics-cli-params" title="CLI argument">CLI argument</a>.
</li>
</ul>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>If you are creating and managing synthetic monitors using
<a class="xref" href="synthetics-get-started-project.html" title="Create monitors with Project monitors">projects</a>, you can also use regular environment
variables via the standard node <code class="literal">process.env</code> global object.</p>
</div>
</div>
<p>The values in the configuration file are read in the following order:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<span class="strong strong"><strong>Global parameters in Kibana</strong></span>: The <em>Global parameters</em> set in Kibana are read first.
</li>
<li class="listitem">
<span class="strong strong"><strong>Configuration file</strong></span>: Then the <em>Global parameters</em> are merged with any parameters defined in a configuration file.
If a parameter is defined in both Kibana <span class="strong strong"><strong>and</strong></span> a configuration file,
the value in the configuration file will be used.
</li>
<li class="listitem">
<span class="strong strong"><strong>CLI</strong></span>: Then the parameters defined in the configuration are merged with any parameters passed to the CLI <code class="literal">--params</code> argument.
If a parameter is defined in a configuration file <span class="strong strong"><strong>and</strong></span> using the CLI argument,
the value defined using the CLI will be used.
When running a script using the CLI, Kibana-defined <em>Global parameters</em> have no impact
on the test because it won&#8217;t have access to Kibana.
</li>
</ol>
</div>
<h4><a id="synthetics-params-secrets-kibana"></a>Global parameters in Kibana<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/observability/synthetics-params-secrets.asciidoc">edit</a></h4>
<p>In the Synthetics app:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Go to <span class="strong strong"><strong>Settings</strong></span>.
</li>
<li class="listitem">
Go to the <span class="strong strong"><strong>Global parameters</strong></span> tab.
</li>
<li class="listitem">
Define parameters.
</li>
</ol>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="images/synthetics-params-secrets-kibana-define.png" alt="Global parameters tab on the Synthetics Settings page in Kibana">
</div>
</div>
<h4><a id="synthetics-dynamic-configs"></a>Project config file<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/observability/synthetics-params-secrets.asciidoc">edit</a></h4>
<p>Use a <code class="literal">synthetics.config.js</code> or <code class="literal">synthetics.config.ts</code> file to define variables required by your tests.
This file should be placed in the root of your synthetics project.</p>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">export default (env) =&gt; {
  let my_url = "http://localhost:8080";
  if (env === "production") {
    my_url = "https://elastic.github.io/synthetics-demo/"
  }
  return {
    params: {
      my_url,
    },
  };
};</pre>
</div>
<p>The example above uses the <code class="literal">env</code> variable, which corresponds to the value of the <code class="literal">NODE_ENV</code> environment variable.</p>
<h4><a id="synthetics-cli-params"></a>CLI argument<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/observability/synthetics-params-secrets.asciidoc">edit</a></h4>
<p>To set parameters when running <a class="xref" href="synthetics-command-reference.html" title="Use the Synthetics CLI"><code class="literal">npx @elastic/synthetics</code> on the command line</a>,
use the <code class="literal">--params</code> or <code class="literal">-p</code> flag. The provided map is merged over any existing variables defined in the <code class="literal">synthetics.config.{js,ts}</code> file.</p>
<p>For example, to override the <code class="literal">my_url</code> parameter, you would run:</p>
<div class="pre_wrapper lang-sh">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-sh">npx @elastic/synthetics . --params '{"my_url": "http://localhost:8080"}'</pre>
</div>
<h3><a id="synthetics-params-secrets-use"></a>Use params<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/observability/synthetics-params-secrets.asciidoc">edit</a></h3>
<p>You can use params in both lightweight and browser monitors created in
either a project or the Synthetics UI in Kibana.</p>
<h4><a id="synthetics-params-secrets-use-project"></a>In a project<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/observability/synthetics-params-secrets.asciidoc">edit</a></h4>
<p>For lightweight monitors in projects, wrap the name of the param in <code class="literal">${}</code> (for example, <code class="literal">${my_url}</code>).</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">- type: http
  name: Todos Lightweight
  id: todos-lightweight
  urls: ["${my_url}"]
  schedule: '@every 1m'</pre>
</div>
<p>In browser monitors, parameters can be referenced via the <code class="literal">params</code> property available within the
argument to a <code class="literal">journey</code>, <code class="literal">before</code>, <code class="literal">beforeAll</code>, <code class="literal">after</code>, or <code class="literal">afterAll</code> callback function.</p>
<p>Add <code class="literal">params.</code> before the name of the param (for example, <code class="literal">params.my_url</code>):</p>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">beforeAll(({params}) =&gt; {
  console.log(`Visiting ${params.my_url}`)
})

journey("My Journey", ({ page, params }) =&gt; {
  step('launch app', async () =&gt; {
    await page.goto(params.my_url) <a id="CO85-1"></a><i class="conum" data-value="1"></i>
  })
})</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO85-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>If you are using TypeScript, replace <code class="literal">params.my_url</code> with <code class="literal">params.my_url as string</code>.</p>
</td>
</tr>
</table>
</div>
<h4><a id="synthetics-params-secrets-use-ui"></a>In the UI<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/observability/synthetics-params-secrets.asciidoc">edit</a></h4>
<p>To use a param in a lightweight monitor that is created in the Synthetics UI,
wrap the name of the param in <code class="literal">${}</code> (for example, <code class="literal">${my_url}</code>).</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/synthetics-params-secrets-kibana-use-lightweight.png" alt="Use a param in a lightweight monitor created in the Synthetics UI">
</div>
</div>
<p>To use a param in a browser monitor that is created in the Synthetics UI,
add <code class="literal">params.</code> before the name of the param (for example, <code class="literal">params.my_url</code>).</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/synthetics-params-secrets-kibana-use-browser.png" alt="Use a param in a browser monitor created in the Synthetics UI">
</div>
</div>
<h3><a id="synthetics-secrets-sensitive"></a>Working with secrets and sensitive values<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/observability/synthetics-params-secrets.asciidoc">edit</a></h3>
<p>Your synthetics scripts may require the use of passwords or other sensitive secrets that are not known until runtime.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>Params are viewable in plain-text by administrators and other users with <code class="literal">all</code> privileges for
the Synthetics app.
Also note that synthetics scripts have no limitations on accessing these values, and a malicious script author could write a
synthetics journey that exfiltrates <code class="literal">params</code> and other data at runtime.
Do <span class="strong strong"><strong>not</strong></span> to use truly sensitive passwords (for example, an admin password or a real credit card)
in <span class="strong strong"><strong>any</strong></span> synthetics tools.
Instead, set up limited demo accounts, or fake credit cards with limited functionality.
If you want to limit access to parameters, ensure that users who are not supposed to access those values
do not have <code class="literal">all</code> privileges for the Synthetics app, and that any scripts that use those values
do not leak them in network requests or screenshots.</p>
</div>
</div>
<p>If you are managing monitors with projects, you can use environment variables
in your <code class="literal">synthetics.config.ts</code> or <code class="literal">synthetics.config.js</code> file.</p>
<p>The example below uses <code class="literal">process.env.MY_URL</code> to reference a variable named <code class="literal">MY_URL</code>
defined in the environment and assigns its value to a param. That param can then
be used in both lightweight and browser monitors that are managed in the project:</p>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">export default {
  params: {
    my_url: process.env.MY_URL
  }
};</pre>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="synthetics-manage-monitors.html">« Manage monitors</a>
</span>
<span class="next">
<a href="synthetics-analyze.html">Analyze data from synthetic monitors »</a>
</span>
</div>
</body>
</html>
