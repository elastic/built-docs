<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Troubleshoot mapping issues | Elastic Observability [master] | Elastic</title>
<meta class="elastic" name="content" content="Troubleshoot mapping issues | Elastic Observability [master]">

<link rel="home" href="index.html" title="Elastic Observability [master]"/>
<link rel="up" href="uptime-intro.html" title="Uptime monitoring (deprecated)"/>
<link rel="prev" href="configure-uptime-settings.html" title="Configure settings"/>
<link rel="next" href="monitor-java-app.html" title="Tutorial: Monitor a Java application"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="Observability"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Observability/Guide/master"/>
<meta name="DC.subject" content="Observability"/>
<meta name="DC.identifier" content="master"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
This documentation contains work-in-progress information for future Elastic Stack and Cloud releases. Use the version selector to view supported release docs. It also contains some Elastic Cloud serverless information. Check out our <a href="https://www.elastic.co/docs/current/serverless">serverless docs</a> for more details.
</div>
<div class="navheader">
<span class="prev">
<a href="configure-uptime-settings.html">« Configure settings</a>
</span>
<span class="next">
<a href="monitor-java-app.html">Tutorial: Monitor a Java application »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Observability [master]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="application-and-service-monitoring.html">Application and service monitoring</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="uptime-intro.html">Uptime monitoring (deprecated)</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Troubleshoot mapping issues</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/observability/troubleshoot-uptime-mapping-issues.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="troubleshoot-uptime-mapping-issues"></a>Troubleshoot mapping issues</h3><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/observability/troubleshoot-uptime-mapping-issues.asciidoc">edit</a></div>
</div></div></div>
<div class="position-relative"><h5><a id="_mapping_issues"></a>Mapping issues</h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/observability/troubleshoot-uptime-mapping-issues.asciidoc">edit</a></div>
<p>There are situations in which Heartbeat data can be indexed without the correct mappings applied.
These situations cannot occur with the Elastic Agent configured via Fleet, only with standalone Heartbeat or Elastic Agent running in standalone mode.
This can occur when the underlying <code class="literal">heartbeat-VERSION</code> ILM alias is deleted manually or when Heartbeat writes data
through an intermediary such as Logstash without the <code class="literal">setup</code> command being run.
When running Elastic Agent in standalone mode this can happen if manually setup data streams have incorrect mappings.</p>
<p>To fix this problem, you typically need to remove your Heartbeat indices and data streams.
Then you must create new ones with the appropriate mappings installed. To achieve this, follow the steps below.</p>
<div class="position-relative"><h6><a id="_stop_your_heartbeatelastic_agent_instances"></a>Stop your Heartbeat/Elastic Agent instances</h6><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/observability/troubleshoot-uptime-mapping-issues.asciidoc">edit</a></div>
<p>It is necessary to stop all Heartbeat/Elastic Agent instances that are targeting the cluster, so they will not write to or re-create indices prematurely.</p>
<div class="position-relative"><h6><a id="_delete_your_heartbeat_indices_elastic_agent_data_streams"></a>Delete your Heartbeat indices / Elastic Agent data streams</h6><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/observability/troubleshoot-uptime-mapping-issues.asciidoc">edit</a></div>
<p>To ensure the mapping is applied to all Heartbeat data going forward,
delete all the Heartbeat indices that match the pattern the Uptime app will use.</p>
<p>There are multiple ways to achieve this.
You can read about performing this using the <a href="/guide/en/elasticsearch/reference/master/index-mgmt.html" class="ulink" target="_top">Index Management UI</a> or with the <a href="/guide/en/elasticsearch/reference/master/indices-delete-index.html" class="ulink" target="_top">Delete index API</a>.</p>
<p>If using Elastic Agent you will want to fix any issues with custom data stream mappings. We encourage the use of Fleet to eliminate this issue.</p>
<div class="position-relative"><h6><a id="_if_using_heartbeat_perform_heartbeat_setup"></a>If using Heartbeat, perform Heartbeat setup</h6><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/observability/troubleshoot-uptime-mapping-issues.asciidoc">edit</a></div>
<p>The below command will cause Heartbeat to perform its setup processes and recreate the index template properly.</p>
<div class="pre_wrapper lang-bash">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-bash">./heartbeat setup -e</pre>
</div>
<p>For more information on how to use this command, or if you&#8217;re using DEB, RPM, or Windows, see the <a href="/guide/en/beats/heartbeat/master/heartbeat-installation-configuration.html" class="ulink" target="_top">Heartbeat quickstart guide</a>.</p>
<p>This command performs the necessary startup tasks and ensures that your indices have the appropriate mapping going forward.</p>
<div class="position-relative"><h6><a id="_run_heartbeatelastic_agent_again"></a>Run Heartbeat/Elastic Agent again</h6><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/observability/troubleshoot-uptime-mapping-issues.asciidoc">edit</a></div>
<p>Now, when you run Heartbeat/Elastic Agent, your data will be indexed with the appropriate mappings. When
the Uptime app attempts to fetch your data, it should be able to render without issues.</p>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="configure-uptime-settings.html">« Configure settings</a>
</span>
<span class="next">
<a href="monitor-java-app.html">Tutorial: Monitor a Java application »</a>
</span>
</div>
</body>
</html>
