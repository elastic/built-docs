<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Get started with CSPM for GCP | Elastic Security Solution [8.10] | Elastic</title>
<meta class="elastic" name="content" content="Get started with CSPM for GCP | Elastic Security Solution [8.10]">

<link rel="home" href="index.html" title="Elastic Security Solution [8.10]"/>
<link rel="up" href="cspm.html" title="Cloud security posture management"/>
<link rel="prev" href="cspm-get-started.html" title="Get started with CSPM for AWS"/>
<link rel="next" href="cspm-findings-page.html" title="Findings page"/>
<meta class="elastic" name="product_version" content="8.10"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.10"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.10"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body><div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [8.10]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="cloud-native-security-overview.html">Cloud native security</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="cspm.html">Cloud security posture management</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="cspm-get-started.html">« Get started with CSPM for AWS</a>
</span>
<span class="next">
<a href="cspm-findings-page.html">Findings page »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="cspm-get-started-gcp"></a>Get started with CSPM for GCP<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.10/docs/cloud-native-security/cspm-get-started-gcp.asciidoc">edit</a></h2>
</div></div></div>
<h4><a id="cspm-overview-gcp"></a>Overview<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.10/docs/cloud-native-security/cspm-get-started-gcp.asciidoc">edit</a></h4>
<p>This page explains how to get started monitoring the security posture of your cloud assets using the Cloud Security Posture Management (CSPM) feature.</p>
<div class="sidebar">
<div class="titlepage"><div><div>
<p class="title"><strong>Requirements</strong></p>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
The CSPM integration is available to all Elastic Cloud users. On-premise deployments require an <a href="/pricing" class="ulink" target="_top">Enterprise subscription</a>.
</li>
<li class="listitem">
CSPM only works in the <code class="literal">Default</code> Kibana space. Installing the CSPM integration on a different Kibana space will not work.
</li>
<li class="listitem">
CSPM is supported on commercial cloud only. Government cloud is not supported (<a href="https://github.com/elastic/enhancements" class="ulink" target="_top">request support</a>).
</li>
<li class="listitem">
<p>To view posture data, you need <code class="literal">read</code> privileges for the following Elasticsearch indices:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">logs-cloud_security_posture.findings_latest-*</code>
</li>
<li class="listitem">
<code class="literal">logs-cloud_security_posture.scores-*</code>
</li>
<li class="listitem">
<code class="literal">Logs-cloud_security_posture.findings</code>
</li>
</ul>
</div>
</li>
<li class="listitem">
The user who gives the CSPM integration GCP permissions must be a GCP project <code class="literal">admin</code>.
</li>
</ul>
</div>
</div>
<h4><a id="cspm-setup-gcp"></a>Set up CSPM for GCP<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.10/docs/cloud-native-security/cspm-get-started-gcp.asciidoc">edit</a></h4>
<p>To set up CSPM for GCP, first add the CSPM integration, then enable cloud account access.</p>
<h5><a id="cspm-add-and-name-integration-gcp"></a>Add your CSPM integration<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.10/docs/cloud-native-security/cspm-get-started-gcp.asciidoc">edit</a></h5>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
From the Elastic Security <span class="strong strong"><strong>Get started</strong></span> page, click <span class="strong strong"><strong>Add integrations</strong></span>.
</li>
<li class="listitem">
Search for <code class="literal">CSPM</code>, then click on the result.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Add Cloud Security Posture Management (CSPM)</strong></span>.
</li>
<li class="listitem">
Give your integration a name that matches the purpose or team of the GCP account you want to monitor, for example, <code class="literal">dev-gcp-project</code>.
</li>
</ol>
</div>
<h5><a id="cspm-set-up-cloud-access-section-gcp"></a>Set up cloud account access<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.10/docs/cloud-native-security/cspm-get-started-gcp.asciidoc">edit</a></h5>
<p>To setup CSPM for a GCP project, you will need to have admin privileges for the project.</p>
<p>For most users, the simplest option is to use a Google Cloud Shell script to automatically provision the necessary resources and permissions in your GCP account. This method, as well as two manual options, are described below.</p>
<h5><a id="cspm-set-up-cloudshell"></a>Cloud Shell script setup (recommended)<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.10/docs/cloud-native-security/cspm-get-started-gcp.asciidoc">edit</a></h5>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Under <span class="strong strong"><strong>Setup Access</strong></span>, select <span class="strong strong"><strong>Google Cloud Shell</strong></span>.
</li>
<li class="listitem">
<p>Under <span class="strong strong"><strong>Where to add this integration</strong></span>:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Select <span class="strong strong"><strong>New Hosts</strong></span>.
</li>
<li class="listitem">
Name the Elastic Agent policy. Use a name that matches the purpose or team of the cloud account or accounts you want to monitor. For example, <code class="literal">dev-gcp-account</code>.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Save and continue</strong></span>, then <span class="strong strong"><strong>Add Elastic Agent to your hosts</strong></span>. The <span class="strong strong"><strong>Add agent</strong></span> wizard appears and provides Elastic Agent binaries, which you can download and deploy to a VM in your GCP account.
</li>
</ol>
</div>
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Save and continue</strong></span>.
</li>
<li class="listitem">
Copy the command that appears, then click <span class="strong strong"><strong>Launch Google Cloud Shell</strong></span>. It opens in a new window.
</li>
<li class="listitem">
<p>Check the box to trust Elastic&#8217;s <code class="literal">cloudbeat</code> repo, then click <span class="strong strong"><strong>Confirm</strong></span></p>
<div class="imageblock">
<div class="content">
<img src="images/cspm-cloudshell-trust.png" alt="The cloud shell confirmation popup">
</div>
</div>
</li>
<li class="listitem">
In Google Cloud Shell, execute the command you copied earlier. Once it finishes, return to Kibana and wait for the confirmation of data received from your new integration. Then you can click <span class="strong strong"><strong>View Assets</strong></span> to see your data.
</li>
</ol>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>During Cloud Shell setup, the CSPM integration adds roles to Google&#8217;s default service account, which enables custom role creation and attachment of the service account to a compute instance.
After setup, these roles are removed from the service account. If you attempt to delete the deployment but find the deployment manager lacks necessary permissions, consider adding the missing roles to the service account:
<a href="https://cloud.google.com/iam/docs/understanding-roles#resourcemanager.projectIamAdmin" class="ulink" target="_top">Project IAM Admin</a>, <a href="https://cloud.google.com/iam/docs/understanding-roles#iam.roleAdmin" class="ulink" target="_top">Role Administrator</a>.</p>
</div>
</div>
<h5><a id="cspm-set-up-manual-gcp"></a>Manual authentication<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.10/docs/cloud-native-security/cspm-get-started-gcp.asciidoc">edit</a></h5>
<p>To authenticate manually, you&#8217;ll first need to generate credentials for a new GCP service account with the necessary roles, then provide those credentials to the CSPM integration.</p>
<p>Generate GCP credentials:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Access the GCP console and select your project.
</li>
<li class="listitem">
Navigate to <span class="strong strong"><strong>IAM &amp; Admin &#8594; Service accounts</strong></span>.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Create Service Account</strong></span>.
</li>
<li class="listitem">
Provide an account name.
</li>
<li class="listitem">
<p>Enable the required roles:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<code class="literal">Cloud Asset Viewer</code>: Grants read access to cloud asset metadata.
</li>
<li class="listitem">
<code class="literal">Browser</code>: Grants read access to the project hierarchy.
</li>
</ol>
</div>
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Continue</strong></span>, then click <span class="strong strong"><strong>Done</strong></span>.
</li>
<li class="listitem">
Select the new service account from the list.
</li>
<li class="listitem">
Go to the <span class="strong strong"><strong>KEYS</strong></span> tab, then click <span class="strong strong"><strong>ADD KEY</strong></span>.
</li>
<li class="listitem">
Select <span class="strong strong"><strong>JSON</strong></span> as the key type, then click <span class="strong strong"><strong>CREATE</strong></span>.
</li>
</ol>
</div>
<p>The credentials JSON will download to your local machine. Keep it secure since it provides access to your GCP resources.</p>
<p>Provide credentials to the CSPM integration:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
On the CSPM setup screen under <span class="strong strong"><strong>Setup Access</strong></span>, select <span class="strong strong"><strong>Manual</strong></span>.
</li>
<li class="listitem">
Enter your GCP <span class="strong strong"><strong>Project ID</strong></span>.
</li>
<li class="listitem">
Select either <span class="strong strong"><strong>Credentials File</strong></span> or <span class="strong strong"><strong>Credentials JSON</strong></span>, and enter the credentials information in your selected format.
</li>
<li class="listitem">
<p>Under <span class="strong strong"><strong>Where to add this integration</strong></span>:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>If you want to monitor a GCP project where you have not yet deployed Elastic Agent:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li class="listitem">
Select <span class="strong strong"><strong>New Hosts</strong></span>.
</li>
<li class="listitem">
Name the Elastic Agent policy. Use a name that matches the purpose or team of the cloud account or accounts you want to monitor. For example, <code class="literal">dev-gcp-account</code>.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Save and continue</strong></span>, then <span class="strong strong"><strong>Add Elastic Agent to your hosts</strong></span>. The <span class="strong strong"><strong>Add agent</strong></span> wizard appears and provides Elastic Agent binaries, which you can download and deploy to a VM in your GCP account.
</li>
</ol>
</div>
</li>
<li class="listitem">
<p>If you want to monitor a GCP project where you have already deployed Elastic Agent:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li class="listitem">
Select <span class="strong strong"><strong>Existing hosts</strong></span>.
</li>
<li class="listitem">
Select an agent policy that applies the GCP project you want to monitor.
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Save and continue</strong></span>.
</li>
</ol>
</div>
<p>Wait for the confirmation that Kibana received data from your new integration. Then you can click <span class="strong strong"><strong>View Assets</strong></span> to see your data.</p>
</div>
<div class="navfooter">
<span class="prev">
<a href="cspm-get-started.html">« Get started with CSPM for AWS</a>
</span>
<span class="next">
<a href="cspm-findings-page.html">Findings page »</a>
</span>
</div>
</div>
</body>
</html>
