<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Spike in Bytes Sent to an External Device | Elastic Security Solution [8.11] | Elastic</title>
<meta class="elastic" name="content" content="Spike in Bytes Sent to an External Device | Elastic Security Solution [8.11]">

<link rel="home" href="index.html" title="Elastic Security Solution [8.11]"/>
<link rel="up" href="prebuilt-rules.html" title="Prebuilt rule reference"/>
<link rel="prev" href="spike-in-aws-error-messages.html" title="Spike in AWS Error Messages"/>
<link rel="next" href="spike-in-bytes-sent-to-an-external-device-via-airdrop.html" title="Spike in Bytes Sent to an External Device via Airdrop"/>
<meta class="elastic" name="product_version" content="8.11"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.11"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.11"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body><div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [8.11]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="detection-engine-overview.html">Detections and alerts</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="prebuilt-rules.html">Prebuilt rule reference</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="spike-in-aws-error-messages.html">« Spike in AWS Error Messages</a>
</span>
<span class="next">
<a href="spike-in-bytes-sent-to-an-external-device-via-airdrop.html">Spike in Bytes Sent to an External Device via Airdrop »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="spike-in-bytes-sent-to-an-external-device"></a>Spike in Bytes Sent to an External Device<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.11/docs/detections/prebuilt-rules/rule-details/spike-in-bytes-sent-to-an-external-device.asciidoc">edit</a></h2>
</div></div></div>
<p>A machine learning job has detected high bytes of data written to an external device. In a typical operational setting, there is usually a predictable pattern or a certain range of data that is written to external devices. An unusually large amount of data being written is anomalous and can signal illicit data copying or transfer activities.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: machine_learning</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>: None</p>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 15m</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-2h (<a href="/guide/en/elasticsearch/reference/8.11/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule" title="Set the rule&#8217;s schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum alerts per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="/guide/en/security/current/prebuilt-ml-jobs.html" class="ulink" target="_top">https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html</a>
</li>
<li class="listitem">
<a href="https://docs.elastic.co/en/integrations/ded" class="ulink" target="_top">https://docs.elastic.co/en/integrations/ded</a>
</li>
<li class="listitem">
<a href="/blog/detect-data-exfiltration-activity-with-kibanas-new-integration" class="ulink" target="_top">https://www.elastic.co/blog/detect-data-exfiltration-activity-with-kibanas-new-integration</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Use Case: Data Exfiltration Detection
</li>
<li class="listitem">
Rule Type: ML
</li>
<li class="listitem">
Rule Type: Machine Learning
</li>
<li class="listitem">
Tactic: Exfiltration
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 3</p>
<p><span class="strong strong"><strong>Rule authors</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Rule license</strong></span>: Elastic License v2</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_setup_565"></a>Setup<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.11/docs/detections/prebuilt-rules/rule-details/spike-in-bytes-sent-to-an-external-device.asciidoc">edit</a></h3>
</div></div></div>
<p><span class="strong strong"><strong>Setup</strong></span></p>
<p>The rule requires the Data Exfiltration Detection integration assets to be installed, as well as network and file events collected by integrations such as Elastic Defend and Network Packet Capture (for network events only).</p>
<p><span class="strong strong"><strong>Data Exfiltration Detection Setup</strong></span></p>
<p>The Data Exfiltration Detection integration detects data exfiltration activity by identifying abnormalities in network and file events. Anomalies are detected using Elastic&#8217;s Anomaly Detection feature.</p>
<p><span class="strong strong"><strong>Prerequisite Requirements:</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Fleet is required for Data Exfiltration Detection.
</li>
<li class="listitem">
To configure Fleet Server refer to the <a href="/guide/en/fleet/current/fleet-server.html" class="ulink" target="_top">documentation</a>.
</li>
<li class="listitem">
File events collected by the Elastic Defend integration.
</li>
<li class="listitem">
To install Elastic Defend, refer to the <a href="/guide/en/security/current/install-endpoint.html" class="ulink" target="_top">documentation</a>.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>The following steps should be executed to install assets associated with the Data Exfiltration Detection integration:</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Go to the Kibana homepage. Under Management, click Integrations.
</li>
<li class="listitem">
In the query bar, search for Data Exfiltration Detection and select the integration to see more details about it.
</li>
<li class="listitem">
Under Settings, click Install Data Exfiltration Detection assets and follow the prompts to install the assets.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Anomaly Detection Setup</strong></span></p>
<p>Before you can enable rules for Data Exfiltration Detection, you&#8217;ll need to enable the corresponding Anomaly Detection jobs.
- Go to the Kibana homepage. Under Analytics, click Machine Learning.
- Under Anomaly Detection, click Jobs, and then click "Create job". Select the Data View containing your file events. For example, this would be <code class="literal">logs-endpoint.events.*</code> if you used Elastic Defend to collect events.
- If the selected Data View contains events that match the query in <a href="https://github.com/elastic/integrations/blob/main/packages/ded/kibana/ml_module/ded-ml.json" class="ulink" target="_top">this</a> configuration file, you will see a card for Data Exfiltration Detection under "Use preconfigured jobs".
- Keep the default settings and click "Create jobs" to start the anomaly detection jobs and datafeeds.</p>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Exfiltration
</li>
<li class="listitem">
ID: TA0010
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0010/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0010/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Exfiltration Over Physical Medium
</li>
<li class="listitem">
ID: T1052
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1052/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1052/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="spike-in-aws-error-messages.html">« Spike in AWS Error Messages</a>
</span>
<span class="next">
<a href="spike-in-bytes-sent-to-an-external-device-via-airdrop.html">Spike in Bytes Sent to an External Device via Airdrop »</a>
</span>
</div>
</div>
</body>
</html>
