<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Kernel Driver Load by non-root User | Elastic Security Solution [8.12] | Elastic</title>
<meta class="elastic" name="content" content="Kernel Driver Load by non-root User | Elastic Security Solution [8.12]">

<link rel="home" href="index.html" title="Elastic Security Solution [8.12]"/>
<link rel="up" href="prebuilt-rule-8-12-3-prebuilt-rules-8-12-3-appendix.html" title="Appendix V: Downloadable rule update v8.12.3"/>
<link rel="prev" href="prebuilt-rule-8-12-3-process-capability-enumeration.html" title="Process Capability Enumeration"/>
<link rel="next" href="prebuilt-rule-8-12-3-potential-privilege-escalation-via-linux-dac-permissions.html" title="Potential Privilege Escalation via Linux DAC permissions"/>
<meta class="elastic" name="product_version" content="8.12"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.12"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.12"/>
</head>
<body>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [8.12]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="prebuilt-rule-8-12-3-prebuilt-rules-8-12-3-appendix.html">Downloadable rule update v8.12.3</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="prebuilt-rule-8-12-3-process-capability-enumeration.html">« Process Capability Enumeration</a>
</span>
<span class="next">
<a href="prebuilt-rule-8-12-3-potential-privilege-escalation-via-linux-dac-permissions.html">Potential Privilege Escalation via Linux DAC permissions »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="prebuilt-rule-8-12-3-kernel-driver-load-by-non-root-user"></a>Kernel Driver Load by non-root User<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.12/docs/detections/prebuilt-rules/downloadable-packages/8-12-3/prebuilt-rule-8-12-3-kernel-driver-load-by-non-root-user.asciidoc">edit</a></h2>
</div></div></div>
<p>Detects the loading of a Linux kernel module by a non-root user through system calls. Threat actors may leverage Linux kernel modules to load a rootkit on a system providing them with complete control and the ability to hide from security products. As other rules monitor for the addition of Linux kernel modules through system utilities or .ko files, this rule covers the gap that evasive rootkits leverage by monitoring for kernel module additions on the lowest level through auditd_manager.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: eql</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
logs-auditd_manager.auditd-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5m</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-9m (<a href="/guide/en/elasticsearch/reference/8.12/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule" title="Set the rule&#8217;s schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum alerts per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>: None</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Domain: Endpoint
</li>
<li class="listitem">
OS: Linux
</li>
<li class="listitem">
Use Case: Threat Detection
</li>
<li class="listitem">
Tactic: Persistence
</li>
<li class="listitem">
Tactic: Defense Evasion
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Rule authors</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Rule license</strong></span>: Elastic License v2</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_rule_query_4590"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.12/docs/detections/prebuilt-rules/downloadable-packages/8-12-3/prebuilt-rule-8-12-3-kernel-driver-load-by-non-root-user.asciidoc">edit</a></h3>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">driver where host.os.type == "linux" and event.dataset == "auditd_manager.auditd" and
event.action == "loaded-kernel-module" and auditd.data.syscall in ("init_module", "finit_module") and user.id != "0"</pre>
</div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Persistence
</li>
<li class="listitem">
ID: TA0003
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0003/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0003/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Boot or Logon Autostart Execution
</li>
<li class="listitem">
ID: T1547
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1547/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1547/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Sub-technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Kernel Modules and Extensions
</li>
<li class="listitem">
ID: T1547.006
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1547/006/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1547/006/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Defense Evasion
</li>
<li class="listitem">
ID: TA0005
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0005/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0005/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Rootkit
</li>
<li class="listitem">
ID: T1014
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1014/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1014/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="prebuilt-rule-8-12-3-process-capability-enumeration.html">« Process Capability Enumeration</a>
</span>
<span class="next">
<a href="prebuilt-rule-8-12-3-potential-privilege-escalation-via-linux-dac-permissions.html">Potential Privilege Escalation via Linux DAC permissions »</a>
</span>
</div>
</div>
</body>
</html>
