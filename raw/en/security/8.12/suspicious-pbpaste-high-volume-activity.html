<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Suspicious pbpaste High Volume Activity | Elastic Security Solution [8.12] | Elastic</title>
<meta class="elastic" name="content" content="Suspicious pbpaste High Volume Activity | Elastic Security Solution [8.12]">

<link rel="home" href="index.html" title="Elastic Security Solution [8.12]"/>
<link rel="up" href="prebuilt-rules.html" title="Prebuilt rule reference"/>
<link rel="prev" href="suspicious-macos-ms-office-child-process.html" title="Suspicious macOS MS Office Child Process"/>
<link rel="next" href="suspicious-rc-local-error-message.html" title="Suspicious rc.local Error Message"/>
<meta class="elastic" name="product_version" content="8.12"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.12"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.12"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div class="navheader">
<span class="prev">
<a href="suspicious-macos-ms-office-child-process.html">« Suspicious macOS MS Office Child Process</a>
</span>
<span class="next">
<a href="suspicious-rc-local-error-message.html">Suspicious rc.local Error Message »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [8.12]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="detection-engine-overview.html">Detections and alerts</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="prebuilt-rules.html">Prebuilt rule reference</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Suspicious pbpaste High Volume Activity</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.12/docs/detections/prebuilt-rules/rule-details/suspicious-pbpaste-high-volume-activity.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="suspicious-pbpaste-high-volume-activity"></a>Suspicious pbpaste High Volume Activity</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.12/docs/detections/prebuilt-rules/rule-details/suspicious-pbpaste-high-volume-activity.asciidoc">edit</a></div>
</div></div></div>
<p>Identifies a high volume of <code class="literal">pbpaste</code> executions, which may indicate a bash loop continuously collecting clipboard contents, potentially allowing an attacker to harvest user credentials or other sensitive information.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: eql</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
logs-jamf_protect*
</li>
<li class="listitem">
logs-endpoint.events.process-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5m</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-9m (<a href="/guide/en/elasticsearch/reference/8.12/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule" title="Set the rule&#8217;s schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum alerts per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://www.loobins.io/binaries/pbpaste/" class="ulink" target="_top">https://www.loobins.io/binaries/pbpaste/</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Domain: Endpoint
</li>
<li class="listitem">
OS: macOS
</li>
<li class="listitem">
Use Case: Threat Detection
</li>
<li class="listitem">
Tactic: Credential Access
</li>
<li class="listitem">
Data Source: Jamf Protect
</li>
<li class="listitem">
Data Source: Elastic Defend
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Rule authors</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Thijs Xhaflaire
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Rule license</strong></span>: Elastic License v2</p>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_investigation_guide_471"></a>Investigation guide</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.12/docs/detections/prebuilt-rules/rule-details/suspicious-pbpaste-high-volume-activity.asciidoc">edit</a></div>
</div></div></div>
<p><span class="strong strong"><strong>Triage and analysis</strong></span></p>
<p>To investigate <code class="literal">pbpaste</code> activity, focus on determining whether the binary is being used maliciously to collect clipboard data. Follow these steps:</p>
<div class="quoteblock">
<blockquote>
<p><span class="strong strong"><strong>Note</strong></span>:
This investigation guide uses the <a href="/guide/en/security/master/interactive-investigation-guides.html" class="ulink" target="_top">Investigate Markdown Plugin</a> introduced in Elastic Stack version 8.8.0. Older Elastic Stack versions will display unrendered Markdown in this guide.</p>
</blockquote>
</div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p><span class="strong strong"><strong>Identify Frequency and Pattern of Execution:</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>What to check:</strong></span> Analyze the frequency and timing of <code class="literal">pbpaste</code> executions. Look for consistent intervals that might indicate a script or loop is running.
</li>
<li class="listitem">
<span class="strong strong"><strong>Why:</strong></span> A high volume of regular <code class="literal">pbpaste</code> executions could suggest a bash loop designed to continuously capture clipboard data.
</li>
</ul>
</div>
</li>
<li class="listitem">
<p><span class="strong strong"><strong>Examine Associated Scripts or Processes:</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>What to check:</strong></span> Investigate the parent processes or scripts invoking <code class="literal">pbpaste</code>. Look for any cron jobs, bash scripts, or automated tasks linked to these executions.
</li>
<li class="listitem">
<span class="strong strong"><strong>Why:</strong></span> Understanding what is triggering <code class="literal">pbpaste</code> can help determine if this activity is legitimate or part of a malicious attempt to gather sensitive information.
</li>
<li class="listitem">
!{investigate{"label":"Show events having the same parent process","providers":[[{"excluded":false,"field":"host.hostname","queryType":"phrase","value":"{{host.hostname}}","valueType":"string"},{"excluded":false,"field":"process.entity_id","queryType":"phrase","value":"{{process.parent.entity_id}}","valueType":"string"}]]}}
</li>
<li class="listitem">
$investigate_2
</li>
</ul>
</div>
</li>
<li class="listitem">
<p><span class="strong strong"><strong>Review Clipboard Contents:</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>What to check:</strong></span> If possible, capture and review the clipboard contents during <code class="literal">pbpaste</code> executions to identify if sensitive data, such as user credentials, is being targeted.
</li>
<li class="listitem">
<span class="strong strong"><strong>Why:</strong></span> Attackers may use <code class="literal">pbpaste</code> to harvest valuable information from the clipboard. Identifying the type of data being collected can indicate the severity of the threat.
</li>
</ul>
</div>
</li>
<li class="listitem">
<p><span class="strong strong"><strong>Check for Data Exfiltration:</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>What to check:</strong></span> Investigate any output files or network activity associated with <code class="literal">pbpaste</code> usage. Look for signs that the collected data is being saved to a file, transmitted over the network, or sent to an external location.
</li>
<li class="listitem">
<span class="strong strong"><strong>Why:</strong></span> If data is being stored or transmitted, it may be part of an exfiltration attempt. Identifying this can help prevent sensitive information from being leaked.
</li>
</ul>
</div>
</li>
<li class="listitem">
<p><span class="strong strong"><strong>Correlate with User Activity:</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>What to check:</strong></span> Compare the <code class="literal">pbpaste</code> activity with the user’s normal behavior and system usage patterns.
</li>
<li class="listitem">
<span class="strong strong"><strong>Why:</strong></span> If the <code class="literal">pbpaste</code> activity occurs during times when the user is not active, or if the user denies initiating such tasks, it could indicate unauthorized access or a compromised account.
</li>
</ul>
</div>
</li>
</ol>
</div>
<p>By thoroughly investigating these aspects of <code class="literal">pbpaste</code> activity, you can determine whether this is part of a legitimate process or a potential security threat that needs to be addressed.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_setup_696"></a>Setup</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.12/docs/detections/prebuilt-rules/rule-details/suspicious-pbpaste-high-volume-activity.asciidoc">edit</a></div>
</div></div></div>
<p><span class="strong strong"><strong>Setup</strong></span></p>
<p>This rule requires data coming in from Jamf Protect.</p>
<p><span class="strong strong"><strong>Jamf Protect Integration Setup</strong></span></p>
<p>Jamf Protect is integrated into the Elastic Agent using Fleet. Upon configuration, the integration allows the Elastic Agent to monitor events incoming events and send data to the Elastic.</p>
<p><span class="strong strong"><strong>Prerequisite Requirements:</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Fleet is required for Jamf Protect.
</li>
<li class="listitem">
To configure Fleet Server refer to the <a href="/guide/en/fleet/current/fleet-server.html" class="ulink" target="_top">documentation</a>.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>The following steps should be executed in order to add the Jamf Protect integration:</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Go to the Kibana home page and click "Add integrations".
</li>
<li class="listitem">
In the query bar, search for "Jamf Protect" and select the integration to see more details about it.
</li>
<li class="listitem">
Click "Add Jamf Protect".
</li>
<li class="listitem">
Configure the integration name.
</li>
<li class="listitem">
Click "Save and Continue".
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_rule_query_1002"></a>Rule query</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.12/docs/detections/prebuilt-rules/rule-details/suspicious-pbpaste-high-volume-activity.asciidoc">edit</a></div>
</div></div></div>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">sequence by host.hostname, host.id with maxspan=1m
[process where host.os.type == "macos" and event.type == "start" and event.action == "exec" and process.name: "pbpaste"] with runs = 5</pre>
</div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Credential Access
</li>
<li class="listitem">
ID: TA0006
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0006/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0006/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Input Capture
</li>
<li class="listitem">
ID: T1056
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1056/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1056/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="suspicious-macos-ms-office-child-process.html">« Suspicious macOS MS Office Child Process</a>
</span>
<span class="next">
<a href="suspicious-rc-local-error-message.html">Suspicious rc.local Error Message »</a>
</span>
</div>
</body>
</html>
