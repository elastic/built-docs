<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Entity risk scoring | Elastic Security Solution [8.13] | Elastic</title>
<meta class="elastic" name="content" content="Entity risk scoring | Elastic Security Solution [8.13]">

<link rel="home" href="index.html" title="Elastic Security Solution [8.13]"/>
<link rel="up" href="advanced-entity-analytics-overview.html" title="Advanced Entity Analytics"/>
<link rel="prev" href="advanced-entity-analytics-overview.html" title="Advanced Entity Analytics"/>
<link rel="next" href="asset-criticality.html" title="Asset criticality"/>
<meta class="elastic" name="product_version" content="8.13"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.13"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.13"/>
</head>
<body>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [8.13]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="advanced-entity-analytics-overview.html">Advanced Entity Analytics</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="advanced-entity-analytics-overview.html">« Advanced Entity Analytics</a>
</span>
<span class="next">
<a href="asset-criticality.html">Asset criticality »</a>
</span>
</div>
<div class="chapter">
<div class="titlepage"><div><div>
<h2 class="title"><a id="entity-risk-scoring"></a>Entity risk scoring<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.13/docs/advanced-entity-analytics/entity-risk-scoring.asciidoc">edit</a></h2>
</div></div></div>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in beta and is subject to change. The design and code is less mature than official GA features and is being provided as-is with no warranties. Beta features are not subject to the support SLA of official GA features.</p>
</div>
</div>
<p>Entity risk scoring is an advanced Elastic Security analytics feature that helps security analysts detect changes in an entity&#8217;s risk posture, hunt for new threats, and prioritize incident response.</p>
<p>Entity risk scoring allows you to monitor risk score changes of hosts and users in your environment. When generating advanced scoring analytics, the risk scoring engine utilizes threats from its end-to-end XDR use cases, such as SIEM, cloud, and endpoint. It leverages the Elastic SIEM detection engine to generate host and user risk scores from the last 30 days.</p>
<p>It also generates risk scores on a recurring interval, and allows for easy onboarding and management. The engine is built to factor in risks from all Elastic Security use cases, and allows you to customize and control how and when risk is calculated.</p>
<h3><a id="_risk_scoring_inputs"></a>Risk scoring inputs<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.13/docs/advanced-entity-analytics/entity-risk-scoring.asciidoc">edit</a></h3>
<p>Entity risk scores are determined by the following risk inputs:</p>
<div class="informaltable">
<table border="1" cellpadding="4px" width="100%">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Risk input</th>
<th align="left" valign="top">Storage location</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><a class="xref" href="alerts-ui-manage.html" title="Manage detection alerts">Alerts</a></p></td>
<td align="left" valign="top"><p><code class="literal">.alerts-security.alerts-&lt;space-id&gt;</code> index alias</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="asset-criticality.html" title="Asset criticality">Asset criticality level</a></p></td>
<td align="left" valign="top"><p><code class="literal">.asset-criticality.asset-criticality-&lt;space-id&gt;</code> index alias</p></td>
</tr>
</tbody>
</table>
</div>
<p>The resulting entity risk scores are stored in the <code class="literal">risk-score.risk-score-&lt;space-id&gt;</code> data stream alias.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Entities without any alerts, or with only <code class="literal">Closed</code> alerts, are not assigned a risk score.
</li>
<li class="listitem">
To use asset criticality, you must enable the <code class="literal">securitySolution:enableAssetCriticality</code> <a class="xref" href="advanced-settings.html#enable-asset-criticality" title="Enable asset criticality workflows">advanced setting</a>.
</li>
</ul>
</div>
</div>
</div>
<h3><a id="how-is-risk-score-calculated"></a>How is risk score calculated?<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.13/docs/advanced-entity-analytics/entity-risk-scoring.asciidoc">edit</a></h3>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
The risk scoring engine runs hourly to aggregate <code class="literal">Open</code> and <code class="literal">Acknowledged</code> alerts from the last 30 days.
</li>
<li class="listitem">
The engine groups alerts by <code class="literal">host.name</code> or <code class="literal">user.name</code>, and aggregates the individual alert risk scores (<code class="literal">kibana.alert.risk_score</code>) such that alerts with higher risk scores contribute more than alerts with lower risk scores. The resulting aggregated risk score is assigned to the <span class="strong strong"><strong>Alerts</strong></span> category in the entity&#8217;s <a class="xref" href="hosts-overview.html#host-risk-summary" title="Host risk summary">risk summary</a>.
</li>
<li class="listitem">
<p>The engine then verifies the entity&#8217;s <a class="xref" href="asset-criticality.html" title="Asset criticality">asset criticality level</a>. If there is no asset criticality assigned, the entity risk score remains equal to the aggregated score from the <span class="strong strong"><strong>Alerts</strong></span> category. If a criticality level is assigned, the engine updates the risk score based on the default risk weight for each criticality level. The asset criticality risk input is assigned to the <span class="strong strong"><strong>Asset Criticality</strong></span> category in the entity&#8217;s risk summary.</p>
<div class="informaltable">
<table border="1" cellpadding="4px" width="100%">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Asset criticality level</th>
<th align="left" valign="top">Default risk weight</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>Low impact</p></td>
<td align="left" valign="top"><p>0.5</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Medium impact</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>High impact</p></td>
<td align="left" valign="top"><p>1.5</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Extreme impact</p></td>
<td align="left" valign="top"><p>2</p></td>
</tr>
</tbody>
</table>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Asset criticality levels and default risk weights are subject to change.</p>
</div>
</div>
</li>
<li class="listitem">
<p>Based on the two risk inputs, the risk scoring engine generates a single entity risk score of 0-100. It assigns a risk level by mapping the risk score to one of these levels:</p>
<div class="informaltable">
<table border="1" cellpadding="4px" width="100%">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Risk level</th>
<th align="left" valign="top">Risk score</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>Unknown</p></td>
<td align="left" valign="top"><p>&lt; 20</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Low</p></td>
<td align="left" valign="top"><p>20-40</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Moderate</p></td>
<td align="left" valign="top"><p>40-70</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>High</p></td>
<td align="left" valign="top"><p>70-90</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Critical</p></td>
<td align="left" valign="top"><p>&gt; 90</p></td>
</tr>
</tbody>
</table>
</div>
</li>
</ol>
</div>
<details>
<summary class="title">Click for a risk score calculation example</summary>
<div class="content">
<p>This example shows how the risk scoring engine calculates the user risk score for <code class="literal">User_A</code>, whose asset criticality level is <span class="strong strong"><strong>Extreme impact</strong></span>.</p>
<p>There are 5 open alerts associated with <code class="literal">User_A</code>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Alert 1 with alert risk score 21
</li>
<li class="listitem">
Alert 2 with alert risk score 45
</li>
<li class="listitem">
Alert 3 with alert risk score 21
</li>
<li class="listitem">
Alert 4 with alert risk score 70
</li>
<li class="listitem">
Alert 5 with alert risk score 21
</li>
</ul>
</div>
<p>To calculate the user risk score, the risk scoring engine:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Sorts the associated alerts in descending order of alert risk score:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Alert 4 with alert risk score 70
</li>
<li class="listitem">
Alert 2 with alert risk score 45
</li>
<li class="listitem">
Alert 1 with alert risk score 21
</li>
<li class="listitem">
Alert 3 with alert risk score 21
</li>
<li class="listitem">
Alert 5 with alert risk score 21
</li>
</ul>
</div>
</li>
<li class="listitem">
Generates an aggregated risk score of 36.16, and assigns it to <code class="literal">User_A</code>'s <span class="strong strong"><strong>Alerts</strong></span> risk category.
</li>
<li class="listitem">
Looks up <code class="literal">User_A</code>'s asset criticality level, and identifies it as <span class="strong strong"><strong>Extreme impact</strong></span>.
</li>
<li class="listitem">
Generates a new risk input under the <span class="strong strong"><strong>Asset Criticality</strong></span> risk category, with a risk contribution score of 16.95.
</li>
<li class="listitem">
Increases the user risk score to 53.11, and assigns <code class="literal">User_A</code> a <span class="strong strong"><strong>Moderate</strong></span> user risk level.
</li>
</ol>
</div>
<p>If <code class="literal">User_A</code> had no asset criticality level assigned, the user risk score would remain unchanged at 36.16.</p>
</div>
</details>
<p>Learn how to <a class="xref" href="turn-on-risk-engine.html" title="Turn on the risk scoring engine">turn on the latest risk scoring engine</a>.</p>



</div>
<div class="navfooter">
<span class="prev">
<a href="advanced-entity-analytics-overview.html">« Advanced Entity Analytics</a>
</span>
<span class="next">
<a href="asset-criticality.html">Asset criticality »</a>
</span>
</div>
</div>
</body>
</html>
