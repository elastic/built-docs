<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Suppress detection alerts | Elastic Security Solution [8.14] | Elastic</title>
<meta class="elastic" name="content" content="Suppress detection alerts | Elastic Security Solution [8.14]">

<link rel="home" href="index.html" title="Elastic Security Solution [8.14]"/>
<link rel="up" href="alerts-ui-manage.html" title="Manage detection alerts"/>
<link rel="prev" href="signals-to-cases.html" title="Add detection alerts to cases"/>
<link rel="next" href="reduce-notifications-alerts.html" title="Reduce notifications and alerts"/>
<meta class="elastic" name="product_version" content="8.14"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.14"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.14"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body><div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [8.14]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="detection-engine-overview.html">Detections and alerts</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="alerts-ui-manage.html">Manage detection alerts</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="signals-to-cases.html">« Add detection alerts to cases</a>
</span>
<span class="next">
<a href="reduce-notifications-alerts.html">Reduce notifications and alerts »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="alert-suppression"></a>Suppress detection alerts<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.14/docs/detections/alert-suppression.asciidoc">edit</a></h2>
</div></div></div>
<div class="sidebar">
<div class="titlepage"><div><div>
<p class="title"><strong>Requirements and notices</strong></p>
</div></div></div>
<p>Alert suppression requires a <a href="/pricing" class="ulink" target="_top">Platinum or higher subscription</a>.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>Alert suppression is in technical preview for threshold, indicator match, event correlation, and new terms rules. The functionality may be changed or removed in a future release. Elastic will work to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.</p>
</div>
</div>
</div>
<p>Alert suppression allows you to reduce the number of repeated or duplicate detection alerts created by these detection rule types:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="rules-ui-create.html#create-custom-rule" title="Create a custom query rule">Custom query</a>
</li>
<li class="listitem">
<a class="xref" href="rules-ui-create.html#create-threshold-rule" title="Create a threshold rule">Threshold</a>
</li>
<li class="listitem">
<a class="xref" href="rules-ui-create.html#create-indicator-rule" title="Create an indicator match rule">Indicator match</a>
</li>
<li class="listitem">
<a class="xref" href="rules-ui-create.html#create-eql-rule" title="Create an event correlation rule">Event correlation</a> (non-sequence queries only)
</li>
<li class="listitem">
<a class="xref" href="rules-ui-create.html#create-new-terms-rule" title="Create a new terms rule">New terms</a>
</li>
</ul>
</div>
<p>Normally, when a rule meets its criteria repeatedly, it creates multiple alerts, one for each time the rule&#8217;s criteria are met. When alert suppression is configured, duplicate qualifying events are grouped, and only one alert is created for each group. Depending on the rule type, you can configure alert suppression to create alerts each time the rule runs, or once within a specified time window. You can also specify multiple fields to group events by unique combinations of values.</p>
<p>The Elastic Security app displays several indicators in the Alerts table and the alert details flyout when a detection alert is created with alert suppression enabled. You can view the original events associated with suppressed alerts by investigating the alert in Timeline.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Alert suppression is not available for Elastic prebuilt rules. However, if you want to suppress alerts for a prebuilt rule, you can duplicate it, then configure alert suppression on the duplicated rule.</p>
</div>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_configure_alert_suppression"></a>Configure alert suppression<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.14/docs/detections/alert-suppression.asciidoc">edit</a></h3>
</div></div></div>
<p>You can configure alert suppression when you create or edit a supported rule type. Refer to documentation for creating <a class="xref" href="rules-ui-create.html#create-custom-rule" title="Create a custom query rule">custom query</a>, <a class="xref" href="rules-ui-create.html#create-threshold-rule" title="Create a threshold rule">threshold</a>, <a class="xref" href="rules-ui-create.html#create-eql-rule" title="Create an event correlation rule">event correlation</a>, or <a class="xref" href="rules-ui-create.html#create-new-terms-rule" title="Create a new terms rule">new terms</a> rules for detailed instructions.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>When configuring the rule type (the <span class="strong strong"><strong>Define rule</strong></span> step for a new rule, or the <span class="strong strong"><strong>Definition</strong></span> tab for an existing rule), specify how you want to group events for alert suppression:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Custom query rule: In <span class="strong strong"><strong>Suppress alerts by</strong></span>, enter 1-3 field names to group events by the fields' values.
</li>
<li class="listitem">
Threshold rule: In <span class="strong strong"><strong>Group by</strong></span>, enter up to 3 field names to group events by the fields' values, or leave the setting empty to group all qualifying events together.
</li>
<li class="listitem">
Indicator match rule: In <span class="strong strong"><strong>Suppress alerts by</strong></span>, enter 1-3 field names to group events by the fields' values.
</li>
<li class="listitem">
Event correlation rule (non-sequence queries only): In <span class="strong strong"><strong>Suppress alerts by</strong></span>, enter 1-3 field names to group events by the fields' values.
</li>
<li class="listitem">
New terms rule: In <span class="strong strong"><strong>Suppress alerts by</strong></span>, enter 1-3 field names to group events by the fields' values.
</li>
</ul>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>If you specify a field with multiple values, alerts with that field are handled as follows:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Custom query or threshold rules</strong></span> - A group of alerts is created for each value. For example, if you suppress alerts by <code class="literal">destination.ip</code> of <code class="literal">[127.0.0.1, 127.0.0.2, 127.0.0.3]</code>, alerts will be suppressed separately for each value of <code class="literal">127.0.0.1</code>, <code class="literal">127.0.0.2</code>, and <code class="literal">127.0.0.3</code>.
</li>
<li class="listitem">
<span class="strong strong"><strong>Indicator match rule, event correlation (non-sequence queries only), or new terms rule</strong></span> - Alerts with the specified field name and identical array values are grouped together. For example, if you suppress alerts by <code class="literal">destination.ip</code> of <code class="literal">[127.0.0.1, 127.0.0.2, 127.0.0.3]</code>, alerts with the entire array are grouped and only one alert is created for the group.
</li>
</ul>
</div>
</div>
</div>
</li>
<li class="listitem">
<p>If available, select how often to create alerts for duplicate events:</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Both options are available for custom query, indicator match, event correlation, and new terms rules. Threshold rules only have the <span class="strong strong"><strong>Per time period</strong></span> option.</p>
</div>
</div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Per rule execution</strong></span>: Create an alert each time the rule runs and meets its criteria.
</li>
<li class="listitem">
<p><span class="strong strong"><strong>Per time period</strong></span>: Create one alert for all qualifying events that occur within a specified time window, beginning from when an event first meets the rule criteria and creates the alert.</p>
<p>For example, if a rule runs every 5 minutes but you don&#8217;t need alerts that frequently, you can set the suppression time period to a longer time, such as 1 hour. If the rule meets its criteria, it creates an alert at that time, and for the next hour, it&#8217;ll suppress any subsequent qualifying events.</p>
<div class="imageblock">
<div class="content">
<img src="images/alert-suppression-options.png" alt="Alert suppression options" width="400">
</div>
</div>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Under <span class="strong strong"><strong>If a suppression field is missing</strong></span>, choose how to handle events with missing suppression fields (events in which one or more of the <span class="strong strong"><strong>Suppress alerts by</strong></span> fields don&#8217;t exist):</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>These options are not available for threshold rules.</p>
</div>
</div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Suppress and group alerts for events with missing fields</strong></span>: Create one alert for each group of events with missing fields. Missing fields get a <code class="literal">null</code> value, which is used to group and suppress alerts.
</li>
<li class="listitem">
<span class="strong strong"><strong>Do not suppress alerts for events with missing fields</strong></span>: Create a separate alert for each matching event. This basically falls back to normal alert creation for events with missing suppression fields.
</li>
</ul>
</div>
</li>
<li class="listitem">
Configure other rule settings, then save and enable the rule.
</li>
</ol>
</div>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Use the <span class="strong strong"><strong>Rule preview</strong></span> before saving the rule to visualize how alert suppression will affect the alerts created, based on historical data.
</li>
<li class="listitem">
If a rule times out while suppression is turned on, try shortening the rule&#8217;s <a class="xref" href="rules-ui-create.html#rule-schedule" title="Set the rule&#8217;s schedule">look-back</a> time or turn off suppression to improve the rule&#8217;s performance.
</li>
</ul>
</div>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_confirm_suppressed_alerts"></a>Confirm suppressed alerts<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.14/docs/detections/alert-suppression.asciidoc">edit</a></h3>
</div></div></div>
<p>The Elastic Security app displays several indicators of whether a detection alert was created with alert suppression enabled, and how many duplicate alerts were suppressed.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p><span class="strong strong"><strong>Alerts</strong></span> table — Icon in the <span class="strong strong"><strong>Rule</strong></span> column. Hover to display the number of suppressed alerts:</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/suppressed-alerts-table.png" alt="Suppressed alerts icon and tooltip in Alerts table" width="75%">
</div>
</div>
</li>
<li class="listitem">
<p><span class="strong strong"><strong>Alerts</strong></span> table — Column for suppressed alerts count. Select <span class="strong strong"><strong>Fields</strong></span> to open the fields browser, then add <code class="literal">kibana.alert.suppression.docs_count</code> to the table.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/suppressed-alerts-table-column.png" alt="Suppressed alerts count field column in Alerts table" width="75%">
</div>
</div>
</li>
<li class="listitem">
<p>Alert details flyout — <span class="strong strong"><strong>Insights</strong></span> &#8594; <span class="strong strong"><strong>Correlations</strong></span> section:</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/suppressed-alerts-details.png" alt="Suppressed alerts in the Correlations section within the alert details flyout" width="75%">
</div>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_investigate_events_for_suppressed_alerts"></a>Investigate events for suppressed alerts<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.14/docs/detections/alert-suppression.asciidoc">edit</a></h3>
</div></div></div>
<p>With alert suppression, detection alerts aren&#8217;t created for the grouped source events, but you can still retrieve the events for further analysis or investigation. Do one of the following to open Timeline with the original events associated with both the created alert and the suppressed alerts:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p><span class="strong strong"><strong>Alerts</strong></span> table — Select <span class="strong strong"><strong>Investigate in timeline</strong></span> in the <span class="strong strong"><strong>Actions</strong></span> column.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/timeline-button.png" alt="Investigate in timeline button" width="200">
</div>
</div>
</li>
<li class="listitem">
Alert details flyout — Select <span class="strong strong"><strong>Take action</strong></span> &#8594; <span class="strong strong"><strong>Investigate in timeline</strong></span>.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_alert_suppression_limit_by_rule_type"></a>Alert suppression limit by rule type<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.14/docs/detections/alert-suppression.asciidoc">edit</a></h3>
</div></div></div>
<p>Some rule types have a maximum number of alerts that can be suppressed (custom query rules don&#8217;t have a suppression limit):</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Threshold and event correlation (non-sequence queries only)</strong></span> - The maximum number of alerts is the value you choose for the <a class="xref" href="rules-api-create.html#opt-fields-all" title="Optional fields for all rule types"><code class="literal">max_signals</code></a> setting, which is <code class="literal">100</code> by default.
</li>
<li class="listitem">
<span class="strong strong"><strong>Indicator match and new terms</strong></span> - The maximum number is five times the value you choose for the <a class="xref" href="rules-api-create.html#opt-fields-all" title="Optional fields for all rule types"><code class="literal">max_signals</code></a> setting. The default <code class="literal">max_signals</code> value is <code class="literal">100</code>, which means the default maximum limit for indicator match rules and new term rules is <code class="literal">500</code>.
</li>
</ul>
</div>
</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="signals-to-cases.html">« Add detection alerts to cases</a>
</span>
<span class="next">
<a href="reduce-notifications-alerts.html">Reduce notifications and alerts »</a>
</span>
</div>
</div>
</body>
</html>
