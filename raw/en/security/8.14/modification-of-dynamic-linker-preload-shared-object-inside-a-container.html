<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Modification of Dynamic Linker Preload Shared Object Inside A Container | Elastic Security Solution [8.14] | Elastic</title>
<meta class="elastic" name="content" content="Modification of Dynamic Linker Preload Shared Object Inside A Container | Elastic Security Solution [8.14]">

<link rel="home" href="index.html" title="Elastic Security Solution [8.14]"/>
<link rel="up" href="prebuilt-rules.html" title="Prebuilt rule reference"/>
<link rel="prev" href="modification-of-dynamic-linker-preload-shared-object.html" title="Modification of Dynamic Linker Preload Shared Object"/>
<link rel="next" href="modification-of-environment-variable-via-unsigned-or-untrusted-parent.html" title="Modification of Environment Variable via Unsigned or Untrusted Parent"/>
<meta class="elastic" name="product_version" content="8.14"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.14"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.14"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div class="navheader">
<span class="prev">
<a href="modification-of-dynamic-linker-preload-shared-object.html">« Modification of Dynamic Linker Preload Shared Object</a>
</span>
<span class="next">
<a href="modification-of-environment-variable-via-unsigned-or-untrusted-parent.html">Modification of Environment Variable via Unsigned or Untrusted Parent »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [8.14]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="detection-engine-overview.html">Detections and alerts</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="prebuilt-rules.html">Prebuilt rule reference</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Modification of Dynamic Linker Preload Shared Object Inside A Container</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.14/docs/detections/prebuilt-rules/rule-details/modification-of-dynamic-linker-preload-shared-object-inside-a-container.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="modification-of-dynamic-linker-preload-shared-object-inside-a-container"></a>Modification of Dynamic Linker Preload Shared Object Inside A Container</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.14/docs/detections/prebuilt-rules/rule-details/modification-of-dynamic-linker-preload-shared-object-inside-a-container.asciidoc">edit</a></div>
</div></div></div>
<p>This rule detects the creation or modification of the dynamic linker preload shared object (ld.so.preload) inside a container. The Linux dynamic linker is used to load libraries needed by a program at runtime. Adversaries may hijack the dynamic linker by modifying the /etc/ld.so.preload file to point to malicious libraries. This behavior can be used to grant unauthorized access to system resources and has been used to evade detection of malicious processes in container environments.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: eql</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
logs-cloud_defend*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: high</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 73</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5m</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/8.14/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule" title="Set the rule&#8217;s schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum alerts per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://unit42.paloaltonetworks.com/hildegard-malware-teamtnt/" class="ulink" target="_top">https://unit42.paloaltonetworks.com/hildegard-malware-teamtnt/</a>
</li>
<li class="listitem">
<a href="https://www.anomali.com/blog/rocke-evolves-its-arsenal-with-a-new-malware-family-written-in-golang/" class="ulink" target="_top">https://www.anomali.com/blog/rocke-evolves-its-arsenal-with-a-new-malware-family-written-in-golang/</a>
</li>
<li class="listitem">
<a href="https://sysdig.com/blog/threat-detection-aws-cloud-containers/" class="ulink" target="_top">https://sysdig.com/blog/threat-detection-aws-cloud-containers/</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Data Source: Elastic Defend for Containers
</li>
<li class="listitem">
Domain: Container
</li>
<li class="listitem">
Tactic: Defense Evasion
</li>
<li class="listitem">
Resources: Investigation Guide
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2</p>
<p><span class="strong strong"><strong>Rule authors</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Rule license</strong></span>: Elastic License v2</p>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_investigation_guide_533"></a>Investigation guide</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.14/docs/detections/prebuilt-rules/rule-details/modification-of-dynamic-linker-preload-shared-object-inside-a-container.asciidoc">edit</a></div>
</div></div></div>
<p><span class="strong strong"><strong>Triage and analysis</strong></span></p>
<div class="quoteblock">
<blockquote>
<p><span class="strong strong"><strong>Disclaimer</strong></span>:
This investigation guide was created using generative AI technology and has been reviewed to improve its accuracy and relevance. While every effort has been made to ensure its quality, we recommend validating the content and adapting it to suit your specific environment and operational needs.</p>
</blockquote>
</div>
<p><span class="strong strong"><strong>Investigating Modification of Dynamic Linker Preload Shared Object Inside A Container</strong></span></p>
<p>The dynamic linker in Linux loads necessary libraries for programs at runtime, with the <code class="literal">ld.so.preload</code> file specifying libraries to load first. Adversaries exploit this by redirecting it to malicious libraries, gaining unauthorized access and evading detection. The detection rule identifies suspicious modifications to this file within containers, signaling potential hijacking attempts.</p>
<p><span class="strong strong"><strong>Possible investigation steps</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Review the alert details to confirm the file path involved is "/etc/ld.so.preload" and the event type is not "deletion", as specified in the query.
</li>
<li class="listitem">
Examine the container&#8217;s metadata and context to identify the specific container where the modification occurred, including container ID, image, and host details.
</li>
<li class="listitem">
Investigate recent changes to the "/etc/ld.so.preload" file within the container by checking the file&#8217;s modification history and identifying the user or process responsible for the change.
</li>
<li class="listitem">
Analyze the contents of the modified "/etc/ld.so.preload" file to determine if it references any suspicious or unauthorized libraries.
</li>
<li class="listitem">
Correlate the event with other security logs and alerts to identify any related suspicious activities or patterns, such as unauthorized access attempts or execution of unknown processes within the container.
</li>
<li class="listitem">
Assess the potential impact of the modification by evaluating the libraries listed in the preload file and their potential to grant unauthorized access or evade detection.
</li>
<li class="listitem">
Consider isolating the affected container to prevent further unauthorized access or malicious activity while the investigation is ongoing.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>False positive analysis</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Routine system updates or maintenance activities may modify the ld.so.preload file. Users should verify if the changes coincide with scheduled updates and consider excluding these events if they are confirmed to be benign.
</li>
<li class="listitem">
Some containerized applications might legitimately modify the ld.so.preload file to optimize performance or load specific libraries. Users should identify these applications and create exceptions for their known behaviors to prevent false alerts.
</li>
<li class="listitem">
Automated configuration management tools might alter the ld.so.preload file as part of their normal operations. Users should review the tool&#8217;s activity logs and whitelist these actions if they are consistent with expected behavior.
</li>
<li class="listitem">
Development or testing environments often involve frequent changes to system files, including ld.so.preload. Users should differentiate between production and non-production environments and apply more lenient rules to the latter to reduce false positives.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Response and remediation</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Immediately isolate the affected container to prevent further unauthorized access or execution of malicious code. This can be done by stopping the container or disconnecting it from the network.
</li>
<li class="listitem">
Conduct a thorough review of the <code class="literal">/etc/ld.so.preload</code> file within the container to identify any unauthorized or malicious entries. Remove any entries that are not recognized or are confirmed to be malicious.
</li>
<li class="listitem">
Verify the integrity of the container&#8217;s base image and all installed libraries to ensure no other components have been tampered with. Rebuild the container from a trusted image if necessary.
</li>
<li class="listitem">
Implement monitoring and alerting for any future modifications to the <code class="literal">/etc/ld.so.preload</code> file across all containers to detect similar threats promptly.
</li>
<li class="listitem">
Review and tighten access controls and permissions for container environments to minimize the risk of unauthorized modifications to critical system files.
</li>
<li class="listitem">
Escalate the incident to the security operations team for further investigation and to determine if the threat has spread to other parts of the infrastructure.
</li>
<li class="listitem">
Document the incident, including the steps taken for containment and remediation, to improve response strategies and update incident response plans for future reference.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_rule_query_574"></a>Rule query</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.14/docs/detections/prebuilt-rules/rule-details/modification-of-dynamic-linker-preload-shared-object-inside-a-container.asciidoc">edit</a></div>
</div></div></div>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">file where event.module== "cloud_defend" and event.type != "deletion" and file.path== "/etc/ld.so.preload"</pre>
</div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Defense Evasion
</li>
<li class="listitem">
ID: TA0005
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0005/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0005/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Hijack Execution Flow
</li>
<li class="listitem">
ID: T1574
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1574/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1574/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Sub-technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Dynamic Linker Hijacking
</li>
<li class="listitem">
ID: T1574.006
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1574/006/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1574/006/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="modification-of-dynamic-linker-preload-shared-object.html">« Modification of Dynamic Linker Preload Shared Object</a>
</span>
<span class="next">
<a href="modification-of-environment-variable-via-unsigned-or-untrusted-parent.html">Modification of Environment Variable via Unsigned or Untrusted Parent »</a>
</span>
</div>
</body>
</html>
