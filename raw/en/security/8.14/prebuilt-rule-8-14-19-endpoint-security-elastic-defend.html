<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Endpoint Security (Elastic Defend) | Elastic Security Solution [8.14] | Elastic</title>
<meta class="elastic" name="content" content="Endpoint Security (Elastic Defend) | Elastic Security Solution [8.14]">

<link rel="home" href="index.html" title="Elastic Security Solution [8.14]"/>
<link rel="up" href="prebuilt-rule-8-14-19-prebuilt-rules-8-14-19-appendix.html" title="Appendix f: Downloadable rule update v8.14.19"/>
<link rel="prev" href="prebuilt-rule-8-14-19-rapid-secret-retrieval-attempts-from-aws-secretsmanager.html" title="Rapid Secret Retrieval Attempts from AWS SecretsManager"/>
<link rel="next" href="prebuilt-rule-8-14-19-potential-persistence-via-file-modification.html" title="Potential Persistence via File Modification"/>
<meta class="elastic" name="product_version" content="8.14"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.14"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.14"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div class="navheader">
<span class="prev">
<a href="prebuilt-rule-8-14-19-rapid-secret-retrieval-attempts-from-aws-secretsmanager.html">« Rapid Secret Retrieval Attempts from AWS SecretsManager</a>
</span>
<span class="next">
<a href="prebuilt-rule-8-14-19-potential-persistence-via-file-modification.html">Potential Persistence via File Modification »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [8.14]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="prebuilt-rule-8-14-19-prebuilt-rules-8-14-19-appendix.html">Downloadable rule update v8.14.19</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Endpoint Security (Elastic Defend)</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.14/docs/detections/prebuilt-rules/downloadable-packages/8-14-19/prebuilt-rule-8-14-19-endpoint-security-elastic-defend.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="prebuilt-rule-8-14-19-endpoint-security-elastic-defend"></a>Endpoint Security (Elastic Defend)</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.14/docs/detections/prebuilt-rules/downloadable-packages/8-14-19/prebuilt-rule-8-14-19-endpoint-security-elastic-defend.asciidoc">edit</a></div>
</div></div></div>
<p>Generates a detection alert each time an Elastic Defend alert is received. Enabling this rule allows you to immediately begin investigating your Endpoint alerts.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
logs-endpoint.alerts-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5m</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-10m (<a href="/guide/en/elasticsearch/reference/8.14/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule" title="Set the rule&#8217;s schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum alerts per execution</strong></span>: 10000</p>
<p><span class="strong strong"><strong>References</strong></span>: None</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Data Source: Elastic Defend
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 104</p>
<p><span class="strong strong"><strong>Rule authors</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Rule license</strong></span>: Elastic License v2</p>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_setup_1508"></a>Setup</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.14/docs/detections/prebuilt-rules/downloadable-packages/8-14-19/prebuilt-rule-8-14-19-endpoint-security-elastic-defend.asciidoc">edit</a></div>
</div></div></div>
<p><span class="strong strong"><strong>Setup</strong></span></p>
<p><span class="strong strong"><strong>Elastic Defend Alerts</strong></span></p>
<p>If this rule is disabled, you will not receive alerts for Elastic Defend alerts. This rule is designed to capture all alerts generated by Elastic Defend. For more granular alerting, consider using additional prebuilt-rules that capture specific Elastic Defend alerts.</p>
<p>If this rule is enabled, along with the related rules listed below, you will receive duplicate alerts for the same events. To avoid this, it is recommended to disable this generic rule and enable the more specific rules that capture these alerts separately.</p>
<p>Related rules:
- Behavior - Detected - Elastic Defend (UUID: 0f615fe4-eaa2-11ee-ae33-f661ea17fbce)
- Behavior - Prevented - Elastic Defend (UUID: eb804972-ea34-11ee-a417-f661ea17fbce)
- Malicious File - Detected - Elastic Defend (UUID: f2c3caa6-ea34-11ee-a417-f661ea17fbce)
- Malicious File - Prevented - Elastic Defend (UUID: f87e6122-ea34-11ee-a417-f661ea17fbce)
- Memory Threat - Detected - Elastic Defend (UUID: 017de1e4-ea35-11ee-a417-f661ea17fbce)
- Memory Threat - Prevented - Elastic Defend (UUID: 06f3a26c-ea35-11ee-a417-f661ea17fbce)
- Ransomware - Detected - Elastic Defend (UUID: 0c74cd7e-ea35-11ee-a417-f661ea17fbce)
- Ransomware - Prevented - Elastic Defend (UUID: 10f3d520-ea35-11ee-a417-f661ea17fbce)</p>
<p><span class="strong strong"><strong>Additional notes</strong></span></p>
<p>This rule is configured to generate more <span class="strong strong"><strong>Max alerts per run</strong></span> than the default 1000 alerts per run set for all rules. This is to ensure that it captures as many alerts as possible.</p>
<p><span class="strong strong"><strong>IMPORTANT:</strong></span> The rule&#8217;s <span class="strong strong"><strong>Max alerts per run</strong></span> setting can be superseded by the <code class="literal">xpack.alerting.rules.run.alerts.max</code> Kibana config setting, which determines the maximum alerts generated by <em>any</em> rule in the Kibana alerting framework. For example, if <code class="literal">xpack.alerting.rules.run.alerts.max</code> is set to 1000, this rule will still generate no more than 1000 alerts even if its own <span class="strong strong"><strong>Max alerts per run</strong></span> is set higher.</p>
<p>To make sure this rule can generate as many alerts as it&#8217;s configured in its own <span class="strong strong"><strong>Max alerts per run</strong></span> setting, increase the <code class="literal">xpack.alerting.rules.run.alerts.max</code> system setting accordingly.</p>
<p><span class="strong strong"><strong>NOTE:</strong></span> Changing <code class="literal">xpack.alerting.rules.run.alerts.max</code> is not possible in Serverless projects.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_rule_query_6099"></a>Rule query</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.14/docs/detections/prebuilt-rules/downloadable-packages/8-14-19/prebuilt-rule-8-14-19-endpoint-security-elastic-defend.asciidoc">edit</a></div>
</div></div></div>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">event.kind:alert and event.module:(endpoint and not endgame)</pre>
</div>
</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="prebuilt-rule-8-14-19-rapid-secret-retrieval-attempts-from-aws-secretsmanager.html">« Rapid Secret Retrieval Attempts from AWS SecretsManager</a>
</span>
<span class="next">
<a href="prebuilt-rule-8-14-19-potential-persistence-via-file-modification.html">Potential Persistence via File Modification »</a>
</span>
</div>
</body>
</html>
