<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Rapid7 Threat Command CVEs Correlation | Elastic Security Solution [8.15] | Elastic</title>
<meta class="elastic" name="content" content="Rapid7 Threat Command CVEs Correlation | Elastic Security Solution [8.15]">

<link rel="home" href="index.html" title="Elastic Security Solution [8.15]"/>
<link rel="up" href="prebuilt-rules.html" title="Prebuilt rule reference"/>
<link rel="prev" href="rapid-secret-retrieval-attempts-from-aws-secretsmanager.html" title="Rapid Secret Retrieval Attempts from AWS SecretsManager"/>
<link rel="next" href="rare-aws-error-code.html" title="Rare AWS Error Code"/>
<meta class="elastic" name="product_version" content="8.15"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.15"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.15"/>
</head>
<body>
<div class="navheader">
<span class="prev">
<a href="rapid-secret-retrieval-attempts-from-aws-secretsmanager.html">« Rapid Secret Retrieval Attempts from AWS SecretsManager</a>
</span>
<span class="next">
<a href="rare-aws-error-code.html">Rare AWS Error Code »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [8.15]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="detection-engine-overview.html">Detections and alerts</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="prebuilt-rules.html">Prebuilt rule reference</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Rapid7 Threat Command CVEs Correlation</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.15/docs/detections/prebuilt-rules/rule-details/rapid7-threat-command-cves-correlation.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="rapid7-threat-command-cves-correlation"></a>Rapid7 Threat Command CVEs Correlation</h2><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.15/docs/detections/prebuilt-rules/rule-details/rapid7-threat-command-cves-correlation.asciidoc">edit</a></div>
</div></div></div>
<p>This rule is triggered when CVEs collected from the Rapid7 Threat Command Integration have a match against vulnerabilities that were found in the customer environment.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: threat_match</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
auditbeat-*
</li>
<li class="listitem">
endgame-*
</li>
<li class="listitem">
filebeat-*
</li>
<li class="listitem">
logs-*
</li>
<li class="listitem">
packetbeat-*
</li>
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: critical</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 99</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 30m</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-35m (<a href="/guide/en/elasticsearch/reference/8.15/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule" title="Set the rule&#8217;s schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum alerts per execution</strong></span>: 10000</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="/guide/en/beats/filebeat/current/filebeat-module-threatintel.html" class="ulink" target="_top">https://www.elastic.co/guide/en/beats/filebeat/current/filebeat-module-threatintel.html</a>
</li>
<li class="listitem">
<a href="https://docs.elastic.co/integrations/ti_rapid7_threat_command" class="ulink" target="_top">https://docs.elastic.co/integrations/ti_rapid7_threat_command</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
OS: Windows
</li>
<li class="listitem">
Data Source: Elastic Endgame
</li>
<li class="listitem">
Data Source: Windows
</li>
<li class="listitem">
Data Source: Network
</li>
<li class="listitem">
Data Source: Rapid7 Threat Command
</li>
<li class="listitem">
Rule Type: Threat Match
</li>
<li class="listitem">
Resources: Investigation Guide
</li>
<li class="listitem">
Use Case: Vulnerability
</li>
<li class="listitem">
Use Case: Asset Visibility
</li>
<li class="listitem">
Use Case: Continuous Monitoring
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 103</p>
<p><span class="strong strong"><strong>Rule authors</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Rule license</strong></span>: Elastic License v2</p>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_investigation_guide_413"></a>Investigation guide</h3><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.15/docs/detections/prebuilt-rules/rule-details/rapid7-threat-command-cves-correlation.asciidoc">edit</a></div>
</div></div></div>
<p><span class="strong strong"><strong>Triage and Analysis</strong></span></p>
<p><span class="strong strong"><strong>Investigating Rapid7 Threat Command CVEs Correlation</strong></span></p>
<p>Rapid7 Threat Command CVEs Correlation rule allows matching CVEs from user indices within the vulnerabilities collected from Rapid7 Threat Command integrations.</p>
<p>The matches will be based on the latest values of CVEs from the last 180 days. So it&#8217;s essential to validate the data and review the results by investigating the associated activity to determine if it requires further investigation.</p>
<p>If a vulnerability matches a local observation, the following enriched fields will be generated to identify the vulnerability, field, and type matched.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">threat.indicator.matched.atomic</code> - this identifies the atomic vulnerability that matched the local observation
</li>
<li class="listitem">
<code class="literal">threat.indicator.matched.field</code> - this identifies the vulnerability field that matched the local observation
</li>
<li class="listitem">
<code class="literal">threat.indicator.matched.type</code> - this identifies the vulnerability type that matched the local observation
</li>
</ul>
</div>
<p>Additional investigation can be done by reviewing the source of the activity and considering the history of the vulnerability that was matched. This can help understand if the activity is related to legitimate behavior.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Investigation can be validated and reviewed based on the data that was matched and by viewing the source of that activity.
</li>
<li class="listitem">
Consider the history of the vulnerability that was matched. Has it happened before? Is it happening on multiple machines? These kinds of questions can help understand if the activity is related to legitimate behavior.
</li>
<li class="listitem">
Consider the user and their role within the company: is this something related to their job or work function?
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_setup_583"></a>Setup</h3><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.15/docs/detections/prebuilt-rules/rule-details/rapid7-threat-command-cves-correlation.asciidoc">edit</a></div>
</div></div></div>
<p><span class="strong strong"><strong>Setup</strong></span></p>
<p>This rule needs threat intelligence indicators to work.
Threat intelligence indicators can be collected using an <a href="/guide/en/security/current/es-threat-intel-integrations.html#agent-ti-integration" class="ulink" target="_top">Elastic Agent integration</a>,
the <a href="/guide/en/security/current/es-threat-intel-integrations.html#ti-mod-integration" class="ulink" target="_top">Threat Intel module</a>,
or a <a href="/guide/en/security/current/es-threat-intel-integrations.html#custom-ti-integration" class="ulink" target="_top">custom integration</a>.</p>
<p>More information can be found <a href="/guide/en/security/current/es-threat-intel-integrations.html" class="ulink" target="_top">here</a>.</p>
<p><span class="strong strong"><strong>Max Signals</strong></span></p>
<p>This rule is configured to generate more <span class="strong strong"><strong>Max alerts per run</strong></span> than the default 1000 alerts per run set for all rules. This is to ensure that it captures as many alerts as possible.</p>
<p><span class="strong strong"><strong>IMPORTANT:</strong></span> The rule&#8217;s <span class="strong strong"><strong>Max alerts per run</strong></span> setting can be superseded by the <code class="literal">xpack.alerting.rules.run.alerts.max</code> Kibana config setting, which determines the maximum alerts generated by <em>any</em> rule in the Kibana alerting framework. For example, if <code class="literal">xpack.alerting.rules.run.alerts.max</code> is set to 1000, this rule will still generate no more than 1000 alerts even if its own <span class="strong strong"><strong>Max alerts per run</strong></span> is set higher.</p>
<p>To make sure this rule can generate as many alerts as it&#8217;s configured in its own <span class="strong strong"><strong>Max alerts per run</strong></span> setting, increase the <code class="literal">xpack.alerting.rules.run.alerts.max</code> system setting accordingly.</p>
<p><span class="strong strong"><strong>NOTE:</strong></span> Changing <code class="literal">xpack.alerting.rules.run.alerts.max</code> is not possible in Serverless projects.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_rule_query_834"></a>Rule query</h3><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.15/docs/detections/prebuilt-rules/rule-details/rapid7-threat-command-cves-correlation.asciidoc">edit</a></div>
</div></div></div>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">vulnerability.id : *</pre>
</div>
</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="rapid-secret-retrieval-attempts-from-aws-secretsmanager.html">« Rapid Secret Retrieval Attempts from AWS SecretsManager</a>
</span>
<span class="next">
<a href="rare-aws-error-code.html">Rare AWS Error Code »</a>
</span>
</div>
</body>
</html>
