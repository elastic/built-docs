<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Create and manage value lists | Elastic Security Solution [8.15] | Elastic</title>
<meta class="elastic" name="content" content="Create and manage value lists | Elastic Security Solution [8.15]">

<link rel="home" href="index.html" title="Elastic Security Solution [8.15]"/>
<link rel="up" href="detections-ui-exceptions.html" title="Rule exceptions"/>
<link rel="prev" href="detections-ui-exceptions.html" title="Rule exceptions"/>
<link rel="next" href="add-exceptions.html" title="Add and manage exceptions"/>
<meta class="elastic" name="product_version" content="8.15"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.15"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.15"/>
</head>
<body>
<div class="navheader">
<span class="prev">
<a href="detections-ui-exceptions.html">« Rule exceptions</a>
</span>
<span class="next">
<a href="add-exceptions.html">Add and manage exceptions »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [8.15]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="detection-engine-overview.html">Detections and alerts</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="detections-ui-exceptions.html">Rule exceptions</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Create and manage value lists</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.15/docs/detections/value-list-exceptions.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="value-lists-exceptions"></a>Create and manage value lists</h2><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.15/docs/detections/value-list-exceptions.asciidoc">edit</a></div>
</div></div></div>
<p>Value lists hold multiple values of the same Elasticsearch data type, such as IP addresses, which are used to determine when an exception prevents an alert from being generated. You can use value lists to define exceptions for detection rules; however, you cannot use value lists to define endpoint rule exceptions.</p>
<p>Value lists are lists of items with the same Elasticsearch <a href="/guide/en/elasticsearch/reference/8.15/mapping-types.html" class="ulink" target="_top">data type</a>. You can create value lists with these types:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">Keywords</code> (many <a href="/guide/en/ecs/8.11/ecs-field-reference.html" class="ulink" target="_top">ECS fields</a> are keywords)
</li>
<li class="listitem">
<code class="literal">IP Addresses</code>
</li>
<li class="listitem">
<code class="literal">IP Ranges</code>
</li>
<li class="listitem">
<code class="literal">Text</code>
</li>
</ul>
</div>
<p>After creating value lists, you can use <code class="literal">is in list</code> and <code class="literal">is not in list</code> operators to <a class="xref" href="add-exceptions.html" title="Add and manage exceptions">define exceptions</a>.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>You can also use a value list as the <a class="xref" href="rules-ui-create.html#indicator-value-lists" title="Use value lists with indicator match rules">indicator match index</a> when creating an indicator match rule.</p>
</div>
</div>
<div class="position-relative"><h4><a id="create-value-lists"></a>Create value lists</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.15/docs/detections/value-list-exceptions.asciidoc">edit</a></div>
<p>When you create a value list for a rule exception, be mindful of the list&#8217;s size and data type. All rule types support value list exceptions, but extremely large lists or certain data types have limitations.</p>
<p>Custom query, machine learning, and indicator match rules support the following value list types and sizes:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Keywords</strong></span> or <span class="strong strong"><strong>IP addresses</strong></span> list types with more than 65,536 values
</li>
<li class="listitem">
<span class="strong strong"><strong>IP ranges</strong></span> list type with over 200 dash notation values (for example, <code class="literal">127.0.0.1-127.0.0.4</code> is one value) or more than 65,536 CIDR notation values
</li>
</ul>
</div>
<p>To create a value list:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Prepare a <code class="literal">txt</code> or <code class="literal">csv</code> file with all the values you want to use for
determining exceptions from a single list. If you use a <code class="literal">txt</code> file, new lines
act as delimiters.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
All values in the file must be of the same Elasticsearch type.
</li>
<li class="listitem">
Wildcards are not supported in value lists. Values must be literal values.
</li>
<li class="listitem">
The maximum accepted file size is 9 million bytes.
</li>
</ul>
</div>
</div>
</div>
</li>
<li class="listitem">
Go to <span class="strong strong"><strong>Rules</strong></span> &#8594; <span class="strong strong"><strong>Detection rules (SIEM)</strong></span>.
</li>
<li class="listitem">
<p>Click <span class="strong strong"><strong>Manage value lists</strong></span>. The <span class="strong strong"><strong>Manage value lists</strong></span> window opens.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/upload-lists-ui.png" alt="Manage value lists flyout" width="75%">
</div>
</div>
</li>
<li class="listitem">
Select the list type (<span class="strong strong"><strong>Keywords</strong></span>, <span class="strong strong"><strong>IP addresses</strong></span>, <span class="strong strong"><strong>IP ranges</strong></span>, or <span class="strong strong"><strong>Text</strong></span>) from the <span class="strong strong"><strong>Type of value list</strong></span> drop-down.
</li>
<li class="listitem">
Drag or select the <code class="literal">csv</code> or <code class="literal">txt</code> file that contains the values.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Import value list</strong></span>.
</li>
</ol>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>If you import a file with a name that already exists, a new list is not created. The imported values are added to the existing list instead.</p>
</div>
</div>
<div class="position-relative"><h4><a id="manage-value-lists"></a>Manage value lists</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.15/docs/detections/value-list-exceptions.asciidoc">edit</a></div>
<p>You can edit, remove, or export existing value lists.</p>
<div class="position-relative"><h5><a id="edit-value-lists"></a>Edit value lists</h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.15/docs/detections/value-list-exceptions.asciidoc">edit</a></div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Go to <span class="strong strong"><strong>Rules</strong></span> → <span class="strong strong"><strong>Detection rules (SIEM)</strong></span>.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Manage value lists</strong></span>. The <span class="strong strong"><strong>Manage value lists</strong></span> window opens.
</li>
<li class="listitem">
In the <span class="strong strong"><strong>Value lists</strong></span> table, click the value list you want to edit.
</li>
<li class="listitem">
<p>Do any of the following:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p><span class="strong strong"><strong>Filter items in the list</strong></span>: Use the KQL search bar to find values in the list. Depending on your list&#8217;s type, you can filter by the <code class="literal">keyword</code>, <code class="literal">ip_range</code>, <code class="literal">ip</code>, or <code class="literal">text</code> fields. For example, to filter by Gmail addresses in a value list of the <code class="literal">keyword</code> type, enter <code class="literal">keyword:*gmail.com</code> into the search bar.</p>
<p>You can also filter by the <code class="literal">updated_by</code> field (for example, <code class="literal">updated_by:testuser</code>), or the <code class="literal">updated at</code> field (for example, <code class="literal">updated_at &lt; now</code>).</p>
</li>
<li class="listitem">
<span class="strong strong"><strong>Add individual items to the list</strong></span>: Click <span class="strong strong"><strong>Create list item</strong></span>, enter a value, then click <span class="strong strong"><strong>Add list item</strong></span>.
</li>
<li class="listitem">
<span class="strong strong"><strong>Bulk upload list items</strong></span>: Drag or select the <code class="literal">csv</code> or <code class="literal">txt</code> file that contains the values that you want to add, then click <span class="strong strong"><strong>Upload</strong></span>.
</li>
<li class="listitem">
<span class="strong strong"><strong>Edit a value</strong></span>: In the Value column, go to the value you want to edit and click the <span class="strong strong"><strong>Edit</strong></span> button (<span class="image"><img src="images/edit-value-list-item.png" alt="Edit button from Manage value lists window" width="15" height="15"></span>). When you&#8217;re done editing, click the <span class="strong strong"><strong>Save</strong></span> button (<span class="image"><img src="images/save-value-list-item-changes.png" alt="Save button from Manage value lists window" width="18" height="18"></span>) to save your changes. Click the <span class="strong strong"><strong>Cancel</strong></span> button (<span class="image"><img src="images/cancel-value-list-item-changes.png" alt="Cancel button from Manage value lists window" width="18" height="18"></span>) to revert your changes.
</li>
<li class="listitem">
<span class="strong strong"><strong>Remove a value</strong></span>: Click the <span class="strong strong"><strong>Remove value</strong></span> button (<span class="image"><img src="images/remove-value-list-item.png" alt="Remove value list button from Manage value lists window" width="15" height="15"></span>) to delete a value from the list.
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="images/edit-value-lists.png" alt="Manage items in a value lists" width="75%">
</div>
</div>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>You can also edit value lists while creating and managing exceptions that use value lists.</p>
</div>
</div>
<div class="position-relative"><h5><a id="export-remove-value-lists"></a>Export or remove value lists</h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.15/docs/detections/value-list-exceptions.asciidoc">edit</a></div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Go to <span class="strong strong"><strong>Rules</strong></span> &#8594; <span class="strong strong"><strong>Detection rules (SIEM)</strong></span>.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Manage value lists</strong></span>. The <span class="strong strong"><strong>Manage value lists</strong></span> window opens.
</li>
<li class="listitem">
<p>From the <span class="strong strong"><strong>Value lists</strong></span> table, you can:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Click the <span class="strong strong"><strong>Export value list</strong></span> button (<span class="image"><img src="images/export-value-list.png" alt="Export button from Manage value lists window" width="15" height="15"></span>) to export the value list.
</li>
<li class="listitem">
<p>Click the <span class="strong strong"><strong>Remove value list</strong></span> button (<span class="image"><img src="images/remove-value-list.png" alt="Remove button from Manage value lists window" width="15" height="15"></span>) to delete the value list.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/manage-value-list.png" alt="Import value list flyout with action buttons highlighted" width="75%">
</div>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="detections-ui-exceptions.html">« Rule exceptions</a>
</span>
<span class="next">
<a href="add-exceptions.html">Add and manage exceptions »</a>
</span>
</div>
</body>
</html>
