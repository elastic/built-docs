<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>AWS IAM API Calls via Temporary Session Tokens | Elastic Security Solution [8.16] | Elastic</title>
<meta class="elastic" name="content" content="AWS IAM API Calls via Temporary Session Tokens | Elastic Security Solution [8.16]">

<link rel="home" href="index.html" title="Elastic Security Solution [8.16]"/>
<link rel="up" href="prebuilt-rule-8-16-11-prebuilt-rules-8-16-11-appendix.html" title="Appendix ^: Downloadable rule update v8.16.11"/>
<link rel="prev" href="prebuilt-rule-8-16-11-aws-iam-virtual-mfa-device-registration-attempt-with-session-token.html" title="AWS IAM Virtual MFA Device Registration Attempt with Session Token"/>
<link rel="next" href="prebuilt-rule-8-16-11-suspicious-azure-sign-in-via-visual-studio-code.html" title="Suspicious Azure Sign-in via Visual Studio Code"/>
<meta class="elastic" name="product_version" content="8.16"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.16"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.16"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div class="navheader">
<span class="prev">
<a href="prebuilt-rule-8-16-11-aws-iam-virtual-mfa-device-registration-attempt-with-session-token.html">« AWS IAM Virtual MFA Device Registration Attempt with Session Token</a>
</span>
<span class="next">
<a href="prebuilt-rule-8-16-11-suspicious-azure-sign-in-via-visual-studio-code.html">Suspicious Azure Sign-in via Visual Studio Code »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [8.16]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="prebuilt-rule-8-16-11-prebuilt-rules-8-16-11-appendix.html">Downloadable rule update v8.16.11</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>AWS IAM API Calls via Temporary Session Tokens</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.16/docs/detections/prebuilt-rules/downloadable-packages/8-16-11/prebuilt-rule-8-16-11-aws-iam-api-calls-via-temporary-session-tokens.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div id="url-to-v3" class="version-warning">
    <strong>IMPORTANT</strong>: This documentation is no longer updated. Refer to <a href="https://www.elastic.co/support/eol">Elastic's version policy</a> and the <a href="https://www.elastic.co/docs">latest documentation</a>.
</div>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="prebuilt-rule-8-16-11-aws-iam-api-calls-via-temporary-session-tokens"></a>AWS IAM API Calls via Temporary Session Tokens</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.16/docs/detections/prebuilt-rules/downloadable-packages/8-16-11/prebuilt-rule-8-16-11-aws-iam-api-calls-via-temporary-session-tokens.asciidoc">edit</a></div>
</div></div></div>
<p>Detects use of sensitive AWS STS or IAM API operations using temporary credentials (session tokens starting with <em>ASIA</em>). This may indicate credential theft or abuse of elevated access via a stolen session. It is not common for legitimate users to perform sensitive IAM operations with temporary session tokens.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: new_terms</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
filebeat-*
</li>
<li class="listitem">
logs-aws.cloudtrail-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5m</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-9m (<a href="/guide/en/elasticsearch/reference/8.16/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule" title="Set the rule&#8217;s schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum alerts per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://www.sygnia.co/blog/sygnia-investigation-bybit-hack/" class="ulink" target="_top">https://www.sygnia.co/blog/sygnia-investigation-bybit-hack/</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Domain: Cloud
</li>
<li class="listitem">
Data Source: AWS
</li>
<li class="listitem">
Data Source: Amazon Web Services
</li>
<li class="listitem">
Data Source: AWS CloudTrail
</li>
<li class="listitem">
Data Source: AWS IAM
</li>
<li class="listitem">
Data Source: AWS STS
</li>
<li class="listitem">
Tactic: Persistence
</li>
<li class="listitem">
Tactic: Privilege Escalation
</li>
<li class="listitem">
Resources: Investigation Guide
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2</p>
<p><span class="strong strong"><strong>Rule authors</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Rule license</strong></span>: Elastic License v2</p>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_investigation_guide_5617"></a>Investigation guide</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.16/docs/detections/prebuilt-rules/downloadable-packages/8-16-11/prebuilt-rule-8-16-11-aws-iam-api-calls-via-temporary-session-tokens.asciidoc">edit</a></div>
</div></div></div>
<p><span class="strong strong"><strong>Triage and analysis</strong></span></p>
<p><span class="strong strong"><strong>Investigating AWS IAM API Calls via Temporary Session Tokens</strong></span></p>
<p>This rule detects sensitive IAM API operations performed using temporary AWS credentials (session tokens starting with <em>ASIA</em>). These are short-lived credentials commonly obtained via sts:GetSessionToken, sts:AssumeRole, or AWS SSO login. While temporary credentials are often used for development and automation, they are rarely associated with direct IAM manipulation and may indicate credential theft, privilege escalation, or abuse of developer access.</p>
<p><span class="strong strong"><strong>Possible investigation steps:</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Review aws.cloudtrail.user_identity.arn to determine which IAM user or assumed role initiated the request.
</li>
<li class="listitem">
Check aws.cloudtrail.user_identity.access_key_id to confirm if the credential starts with <em>ASIA</em>, indicating a temporary session token.
</li>
<li class="listitem">
Examine aws.cloudtrail.user_identity.session_context.mfa_authenticated to verify whether MFA was present during session creation.
</li>
<li class="listitem">
Investigate source.ip to assess whether the request originated from a known network, office IP, or corporate VPN.
</li>
<li class="listitem">
Look at user_agent.original to determine if the API call came from a known CLI version or unexpected tool (e.g., unknown SDK, custom script).
</li>
<li class="listitem">
Confirm whether a recent sts:GetSessionToken, sts:AssumeRole, or AWS SSO login event issued the temporary credential.
</li>
<li class="listitem">
Correlate other events using the same access key ID to identify additional privileged actions, such as iam:CreateAccessKey, iam:PutUserPolicy, or iam:EnableMFADevice.
</li>
<li class="listitem">
Analyze timing via @timestamp to determine if the action occurred during off-hours or deviates from normal user behavior.
</li>
<li class="listitem">
Review the event.outcome to check if the API call was successful or failed, which may indicate unauthorized access attempts.
</li>
<li class="listitem">
Check for related events in the same session, such as iam:CreateUser, iam:AttachUserPolicy, or sts:GetCallerIdentity, to identify potential lateral movement or privilege escalation.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>False positive analysis:</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Determine if the IAM user or automation pipeline routinely performs privileged actions using temporary session tokens.
</li>
<li class="listitem">
Validate whether the MFA context and source IP match expected developer or CI/CD behavior.
</li>
<li class="listitem">
Review recent IAM policy changes or deployments that may explain the behavior.
</li>
<li class="listitem">
Confirm if the user has a legitimate reason to perform sensitive IAM operations with temporary credentials, such as during a deployment or maintenance window.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Response and remediation:</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Revoke the temporary session token and rotate long-term access keys for the associated user if the behavior is unauthorized.
</li>
<li class="listitem">
Audit related CloudTrail events within the same session to identify policy changes, resource creation, or lateral movement.
</li>
<li class="listitem">
Add explicit deny statements in IAM policies to prevent sensitive IAM actions when aws:authType is not "console".
</li>
<li class="listitem">
Implement IP restrictions for IAM and STS API actions using aws:SourceIp conditions.
</li>
<li class="listitem">
Strengthen monitoring for IAM activity initiated by session tokens with MFA to improve detection coverage.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_rule_query_6647"></a>Rule query</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.16/docs/detections/prebuilt-rules/downloadable-packages/8-16-11/prebuilt-rule-8-16-11-aws-iam-api-calls-via-temporary-session-tokens.asciidoc">edit</a></div>
</div></div></div>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">event.dataset: aws.cloudtrail
    and event.provider: ("iam.amazonaws.com")
    and aws.cloudtrail.user_identity.type: "IAMUser"
    and aws.cloudtrail.user_identity.access_key_id: ASIA*</pre>
</div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Persistence
</li>
<li class="listitem">
ID: TA0003
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0003/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0003/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Account Manipulation
</li>
<li class="listitem">
ID: T1098
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1098/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1098/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="prebuilt-rule-8-16-11-aws-iam-virtual-mfa-device-registration-attempt-with-session-token.html">« AWS IAM Virtual MFA Device Registration Attempt with Session Token</a>
</span>
<span class="next">
<a href="prebuilt-rule-8-16-11-suspicious-azure-sign-in-via-visual-studio-code.html">Suspicious Azure Sign-in via Visual Studio Code »</a>
</span>
</div>
</body>
</html>
