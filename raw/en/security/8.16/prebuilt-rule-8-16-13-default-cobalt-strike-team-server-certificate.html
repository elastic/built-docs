<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Default Cobalt Strike Team Server Certificate | Elastic Security Solution [8.16] | Elastic</title>
<meta class="elastic" name="content" content="Default Cobalt Strike Team Server Certificate | Elastic Security Solution [8.16]">

<link rel="home" href="index.html" title="Elastic Security Solution [8.16]"/>
<link rel="up" href="prebuilt-rule-8-16-13-prebuilt-rules-8-16-13-appendix.html" title="Appendix `: Downloadable rule update v8.16.13"/>
<link rel="prev" href="prebuilt-rule-8-16-13-suspicious-proc-maps-discovery.html" title="Suspicious /proc/maps Discovery"/>
<link rel="next" href="prebuilt-rule-8-16-13-vnc-virtual-network-computing-from-the-internet.html" title="VNC (Virtual Network Computing) from the Internet"/>
<meta class="elastic" name="product_version" content="8.16"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.16"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.16"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div class="navheader">
<span class="prev">
<a href="prebuilt-rule-8-16-13-suspicious-proc-maps-discovery.html">« Suspicious /proc/maps Discovery</a>
</span>
<span class="next">
<a href="prebuilt-rule-8-16-13-vnc-virtual-network-computing-from-the-internet.html">VNC (Virtual Network Computing) from the Internet »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [8.16]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="prebuilt-rule-8-16-13-prebuilt-rules-8-16-13-appendix.html">Downloadable rule update v8.16.13</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Default Cobalt Strike Team Server Certificate</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.16/docs/detections/prebuilt-rules/downloadable-packages/8-16-13/prebuilt-rule-8-16-13-default-cobalt-strike-team-server-certificate.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div id="url-to-v3" class="version-warning">
    <strong>IMPORTANT</strong>: This documentation is no longer updated. Refer to <a href="https://www.elastic.co/support/eol">Elastic's version policy</a> and the <a href="https://www.elastic.co/docs">latest documentation</a>.
</div>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="prebuilt-rule-8-16-13-default-cobalt-strike-team-server-certificate"></a>Default Cobalt Strike Team Server Certificate</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.16/docs/detections/prebuilt-rules/downloadable-packages/8-16-13/prebuilt-rule-8-16-13-default-cobalt-strike-team-server-certificate.asciidoc">edit</a></div>
</div></div></div>
<p>This rule detects the use of the default Cobalt Strike Team Server TLS certificate. Cobalt Strike is software for Adversary Simulations and Red Team Operations which are security assessments that replicate the tactics and techniques of an advanced adversary in a network. Modifications to the Packetbeat configuration can be made to include MD5 and SHA256 hashing algorithms (the default is SHA1). See the References section for additional information on module configuration.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
packetbeat-*
</li>
<li class="listitem">
auditbeat-*
</li>
<li class="listitem">
filebeat-*
</li>
<li class="listitem">
logs-network_traffic.*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: high</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 73</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5m</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-9m (<a href="/guide/en/elasticsearch/reference/8.16/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule" title="Set the rule&#8217;s schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum alerts per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://attack.mitre.org/software/S0154/" class="ulink" target="_top">https://attack.mitre.org/software/S0154/</a>
</li>
<li class="listitem">
<a href="https://www.cobaltstrike.com/help-setup-collaboration" class="ulink" target="_top">https://www.cobaltstrike.com/help-setup-collaboration</a>
</li>
<li class="listitem">
<a href="/guide/en/beats/packetbeat/current/configuration-tls.html" class="ulink" target="_top">https://www.elastic.co/guide/en/beats/packetbeat/current/configuration-tls.html</a>
</li>
<li class="listitem">
<a href="/guide/en/beats/filebeat/7.9/filebeat-module-suricata.html" class="ulink" target="_top">https://www.elastic.co/guide/en/beats/filebeat/7.9/filebeat-module-suricata.html</a>
</li>
<li class="listitem">
<a href="/guide/en/beats/filebeat/7.9/filebeat-module-zeek.html" class="ulink" target="_top">https://www.elastic.co/guide/en/beats/filebeat/7.9/filebeat-module-zeek.html</a>
</li>
<li class="listitem">
<a href="/security-labs/collecting-cobalt-strike-beacons-with-the-elastic-stack" class="ulink" target="_top">https://www.elastic.co/security-labs/collecting-cobalt-strike-beacons-with-the-elastic-stack</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Tactic: Command and Control
</li>
<li class="listitem">
Threat: Cobalt Strike
</li>
<li class="listitem">
Use Case: Threat Detection
</li>
<li class="listitem">
Domain: Endpoint
</li>
<li class="listitem">
Resources: Investigation Guide
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 108</p>
<p><span class="strong strong"><strong>Rule authors</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Rule license</strong></span>: Elastic License v2</p>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_investigation_guide_5723"></a>Investigation guide</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.16/docs/detections/prebuilt-rules/downloadable-packages/8-16-13/prebuilt-rule-8-16-13-default-cobalt-strike-team-server-certificate.asciidoc">edit</a></div>
</div></div></div>
<p><span class="strong strong"><strong>Triage and analysis</strong></span></p>
<div class="quoteblock">
<blockquote>
<p><span class="strong strong"><strong>Disclaimer</strong></span>:
This investigation guide was created using generative AI technology and has been reviewed to improve its accuracy and relevance. While every effort has been made to ensure its quality, we recommend validating the content and adapting it to suit your specific environment and operational needs.</p>
</blockquote>
</div>
<p><span class="strong strong"><strong>Investigating Default Cobalt Strike Team Server Certificate</strong></span></p>
<p>Cobalt Strike is a tool used for simulating advanced cyber threats, often employed by security teams to test defenses. However, adversaries can exploit its default server certificate to establish covert command and control channels. The detection rule identifies this misuse by monitoring network traffic for specific cryptographic hashes associated with the default certificate, flagging potential unauthorized Cobalt Strike activity.</p>
<p><span class="strong strong"><strong>Possible investigation steps</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Review the network traffic logs to identify any connections associated with the specific cryptographic hashes: MD5 (950098276A495286EB2A2556FBAB6D83), SHA1 (6ECE5ECE4192683D2D84E25B0BA7E04F9CB7EB7C), or SHA256 (87F2085C32B6A2CC709B365F55873E207A9CAA10BFFECF2FD16D3CF9D94D390C).
</li>
<li class="listitem">
Identify the source and destination IP addresses involved in the flagged network traffic to determine the potential origin and target of the Cobalt Strike activity.
</li>
<li class="listitem">
Correlate the identified IP addresses with known assets in the network to assess if any internal systems are potentially compromised.
</li>
<li class="listitem">
Check for any other suspicious or anomalous network activities around the same time as the alert to identify potential lateral movement or additional command and control channels.
</li>
<li class="listitem">
Investigate any associated processes or user accounts on the involved systems to determine if there are signs of compromise or unauthorized access.
</li>
<li class="listitem">
Review historical data to see if there have been previous alerts or similar activities involving the same cryptographic hashes or IP addresses, which might indicate a persistent threat.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>False positive analysis</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Legitimate security testing activities by internal teams using Cobalt Strike may trigger the rule. Coordinate with security teams to whitelist known testing IP addresses or certificate hashes.
</li>
<li class="listitem">
Some commercial penetration testing services may use Cobalt Strike with default certificates. Verify the legitimacy of such services and exclude their traffic from detection by adding their certificate hashes to an exception list.
</li>
<li class="listitem">
Network appliances or security tools that simulate adversary behavior for training purposes might use similar certificates. Identify these tools and configure exceptions for their specific network traffic patterns.
</li>
<li class="listitem">
In environments where Cobalt Strike is used for authorized red team exercises, ensure that the default certificate is replaced with a custom one to avoid false positives.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Response and remediation</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Immediately isolate the affected system from the network to prevent further communication with the potential Cobalt Strike server.
</li>
<li class="listitem">
Conduct a thorough forensic analysis of the isolated system to identify any malicious payloads or additional indicators of compromise.
</li>
<li class="listitem">
Revoke any compromised credentials and enforce a password reset for affected accounts to prevent unauthorized access.
</li>
<li class="listitem">
Update and patch all systems to the latest security standards to mitigate vulnerabilities that could be exploited by similar threats.
</li>
<li class="listitem">
Implement network segmentation to limit the lateral movement of threats within the network.
</li>
<li class="listitem">
Enhance monitoring and logging to capture detailed network traffic and endpoint activity, focusing on the identified cryptographic hashes.
</li>
<li class="listitem">
Escalate the incident to the security operations center (SOC) or incident response team for further investigation and coordination with external threat intelligence sources if necessary.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Threat intel</strong></span></p>
<p>While Cobalt Strike is intended to be used for penetration tests and IR training, it is frequently used by actual threat actors (TA) such as APT19, APT29, APT32, APT41, FIN6, DarkHydrus, CopyKittens, Cobalt Group, Leviathan, and many other unnamed criminal TAs. This rule uses high-confidence atomic indicators, so alerts should be investigated rapidly.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_rule_query_6809"></a>Rule query</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.16/docs/detections/prebuilt-rules/downloadable-packages/8-16-13/prebuilt-rule-8-16-13-default-cobalt-strike-team-server-certificate.asciidoc">edit</a></div>
</div></div></div>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">(event.dataset: network_traffic.tls or event.category: (network or network_traffic))
  and (tls.server.hash.md5:950098276A495286EB2A2556FBAB6D83
  or tls.server.hash.sha1:6ECE5ECE4192683D2D84E25B0BA7E04F9CB7EB7C
  or tls.server.hash.sha256:87F2085C32B6A2CC709B365F55873E207A9CAA10BFFECF2FD16D3CF9D94D390C)</pre>
</div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Command and Control
</li>
<li class="listitem">
ID: TA0011
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0011/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0011/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Application Layer Protocol
</li>
<li class="listitem">
ID: T1071
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1071/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1071/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Sub-technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Web Protocols
</li>
<li class="listitem">
ID: T1071.001
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1071/001/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1071/001/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="prebuilt-rule-8-16-13-suspicious-proc-maps-discovery.html">« Suspicious /proc/maps Discovery</a>
</span>
<span class="next">
<a href="prebuilt-rule-8-16-13-vnc-virtual-network-computing-from-the-internet.html">VNC (Virtual Network Computing) from the Internet »</a>
</span>
</div>
</body>
</html>
