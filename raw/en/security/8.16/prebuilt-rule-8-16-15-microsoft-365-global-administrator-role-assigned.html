<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Microsoft 365 Global Administrator Role Assigned | Elastic Security [8.16] | Elastic</title>
<meta class="elastic" name="content" content="Microsoft 365 Global Administrator Role Assigned | Elastic Security [8.16]">

<link rel="home" href="index.html" title="Elastic Security [8.16]"/>
<link rel="up" href="prebuilt-rule-8-16-15-prebuilt-rules-8-16-15-appendix.html" title="Appendix b: Downloadable rule update v8.16.15"/>
<link rel="prev" href="prebuilt-rule-8-16-15-microsoft-entra-id-service-principal-credentials-added-by-rare-user.html" title="Microsoft Entra ID Service Principal Credentials Added by Rare User"/>
<link rel="next" href="prebuilt-rule-8-16-15-account-discovery-command-via-system-account.html" title="Account Discovery Command via SYSTEM Account"/>
<meta class="elastic" name="product_version" content="8.16"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.16"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.16"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div class="navheader">
<span class="prev">
<a href="prebuilt-rule-8-16-15-microsoft-entra-id-service-principal-credentials-added-by-rare-user.html">« Microsoft Entra ID Service Principal Credentials Added by Rare User</a>
</span>
<span class="next">
<a href="prebuilt-rule-8-16-15-account-discovery-command-via-system-account.html">Account Discovery Command via SYSTEM Account »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security [8.16]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="prebuilt-rule-8-16-15-prebuilt-rules-8-16-15-appendix.html">Downloadable rule update v8.16.15</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Microsoft 365 Global Administrator Role Assigned</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.16/docs/detections/prebuilt-rules/downloadable-packages/8-16-15/prebuilt-rule-8-16-15-microsoft-365-global-administrator-role-assigned.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div id="url-to-v3" class="version-warning">
    <strong>IMPORTANT</strong>: This documentation is no longer updated. Refer to <a href="https://www.elastic.co/support/eol">Elastic's version policy</a> and the <a href="https://www.elastic.co/docs">latest documentation</a>.
</div>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="prebuilt-rule-8-16-15-microsoft-365-global-administrator-role-assigned"></a>Microsoft 365 Global Administrator Role Assigned</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.16/docs/detections/prebuilt-rules/downloadable-packages/8-16-15/prebuilt-rule-8-16-15-microsoft-365-global-administrator-role-assigned.asciidoc">edit</a></div>
</div></div></div>
<p>In Microsoft Entra ID, permissions to manage resources are assigned using roles. The Global Administrator / Company Administrator is a role that enables users to have access to all administrative features in Entra ID and services that use Entra ID identities like the Microsoft 365 Defender portal, the Microsoft 365 compliance center, Exchange, SharePoint Online, and Skype for Business Online. Adversaries can add users as Global Administrators to maintain access and manage all subscriptions and their settings and resources.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
filebeat-*
</li>
<li class="listitem">
logs-o365.audit-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5m</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-9m (<a href="/guide/en/elasticsearch/reference/8.16/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule" title="Set the rule&#8217;s schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum alerts per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://docs.microsoft.com/en-us/azure/active-directory/roles/permissions-reference#global-administrator" class="ulink" target="_top">https://docs.microsoft.com/en-us/azure/active-directory/roles/permissions-reference#global-administrator</a>
</li>
<li class="listitem">
<a href="https://learn.microsoft.com/en-us/purview/audit-log-activities" class="ulink" target="_top">https://learn.microsoft.com/en-us/purview/audit-log-activities</a>
</li>
<li class="listitem">
<a href="https://www.blackhat.com/us-24/briefings/schedule/#unoauthorized-a-technique-to-privilege-escalation-to-global-administrator-39231" class="ulink" target="_top">https://www.blackhat.com/us-24/briefings/schedule/#unoauthorized-a-technique-to-privilege-escalation-to-global-administrator-39231</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Domain: Cloud
</li>
<li class="listitem">
Domain: SaaS
</li>
<li class="listitem">
Data Source: Microsoft 365
</li>
<li class="listitem">
Data Source: Microsoft 365 Audit Logs
</li>
<li class="listitem">
Use Case: Identity and Access Audit
</li>
<li class="listitem">
Tactic: Persistence
</li>
<li class="listitem">
Resources: Investigation Guide
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 210</p>
<p><span class="strong strong"><strong>Rule authors</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Rule license</strong></span>: Elastic License v2</p>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_investigation_guide_5782"></a>Investigation guide</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.16/docs/detections/prebuilt-rules/downloadable-packages/8-16-15/prebuilt-rule-8-16-15-microsoft-365-global-administrator-role-assigned.asciidoc">edit</a></div>
</div></div></div>
<p><span class="strong strong"><strong>Triage and Analysis</strong></span></p>
<p><span class="strong strong"><strong>Investigating Microsoft 365 Global Administrator Role Assigned</strong></span></p>
<p>The Microsoft 365 Global Administrator role grants comprehensive administrative access across Entra ID and services such as Microsoft 365 Defender, Exchange, SharePoint, and Skype for Business. Adversaries who compromise an account may assign this role to themselves or other users to ensure persistent and privileged access. This rule identifies successful assignments of this role by inspecting audit logs from Azure Active Directory (Entra ID) where the role display name matches "Administrator."</p>
<p><span class="strong strong"><strong>Possible investigation steps</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Review the <code class="literal">user.id</code> and <code class="literal">user.name</code> fields to determine who performed the role assignment. Assess whether this user normally has permissions to modify high-privilege roles.
</li>
<li class="listitem">
Confirm the <code class="literal">event.action</code> is <code class="literal">"Add member to role."</code> and that the <code class="literal">Role_DisplayName.NewValue</code> is <code class="literal">"Global Administrator"</code> or a similarly privileged role.
</li>
<li class="listitem">
Review the <code class="literal">user.target.id</code> and <code class="literal">user.target.name</code> fields to identify the user or service principal that received the role.
</li>
<li class="listitem">
Inspect <code class="literal">o365.audit.ExtendedProperties.additionalDetails</code> for context on how the action was performed (e.g., via Admin Portal, Graph API).
</li>
<li class="listitem">
Pivot to sign-in logs for the assigning account to check for recent anomalies such as logins from new geolocations, unrecognized devices, or suspicious IP ranges.
</li>
<li class="listitem">
Investigate if the account assignment occurred outside of known change windows, during non-business hours, or by a user with no change history.
</li>
<li class="listitem">
Correlate with other role assignments or directory changes to check for broader role abuse or privilege escalation campaigns.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>False positive analysis</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Role assignments by IT administrators as part of routine maintenance or incident response may appear suspicious in environments without change tracking or ticket correlation.
</li>
<li class="listitem">
PIM (Privileged Identity Management) activations may temporarily elevate accounts to Global Administrator and then revoke the role afterward.
</li>
<li class="listitem">
Onboarding processes or internal audits may require temporary elevation to Global Administrator for legitimate users.
</li>
<li class="listitem">
Automation tools and scripts may trigger this alert if misconfigured to assign Global Administrator privileges during provisioning or sync jobs.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Response and remediation</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If the assignment is unapproved or suspicious, immediately revoke the Global Administrator role from the assigned user or service principal.
</li>
<li class="listitem">
Reset credentials and initiate containment steps for the assigning account, especially if compromise is suspected.
</li>
<li class="listitem">
Enable or verify enforcement of MFA for both assigning and assigned accounts.
</li>
<li class="listitem">
Review Azure AD activity logs for additional signs of privilege misuse or suspicious directory changes.
</li>
<li class="listitem">
Notify the appropriate identity and security operations teams to investigate further and begin incident response procedures.
</li>
<li class="listitem">
Limit the number of Global Administrator accounts and enforce role-based access control (RBAC) using least privilege principles.
</li>
<li class="listitem">
Consider implementing conditional access policies to limit role assignment actions to specific networks, devices, or user groups.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_rule_query_6873"></a>Rule query</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.16/docs/detections/prebuilt-rules/downloadable-packages/8-16-15/prebuilt-rule-8-16-15-microsoft-365-global-administrator-role-assigned.asciidoc">edit</a></div>
</div></div></div>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">event.dataset:o365.audit
    and event.code:"AzureActiveDirectory"
    and event.action:"Add member to role."
    and event.outcome: "success"
    and o365.audit.ModifiedProperties.Role_DisplayName.NewValue: (
        "Global Administrator" or "Company Administrator"
    )
    and o365.audit.AzureActiveDirectoryEventType: 1
    and o365.audit.RecordType: 8
    and not o365.audit.Target.Type: (4 or 5 or 6)</pre>
</div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Persistence
</li>
<li class="listitem">
ID: TA0003
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0003/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0003/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Account Manipulation
</li>
<li class="listitem">
ID: T1098
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1098/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1098/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Sub-technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Additional Cloud Roles
</li>
<li class="listitem">
ID: T1098.003
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1098/003/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1098/003/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="prebuilt-rule-8-16-15-microsoft-entra-id-service-principal-credentials-added-by-rare-user.html">« Microsoft Entra ID Service Principal Credentials Added by Rare User</a>
</span>
<span class="next">
<a href="prebuilt-rule-8-16-15-account-discovery-command-via-system-account.html">Account Discovery Command via SYSTEM Account »</a>
</span>
</div>
</body>
</html>
