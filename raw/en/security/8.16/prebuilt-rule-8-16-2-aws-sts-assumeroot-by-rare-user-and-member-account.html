<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>AWS STS AssumeRoot by Rare User and Member Account | Elastic Security Solution [8.16] | Elastic</title>
<meta class="elastic" name="content" content="AWS STS AssumeRoot by Rare User and Member Account | Elastic Security Solution [8.16]">

<link rel="home" href="index.html" title="Elastic Security Solution [8.16]"/>
<link rel="up" href="prebuilt-rule-8-16-2-prebuilt-rules-8-16-2-appendix.html" title="Appendix U: Downloadable rule update v8.16.2"/>
<link rel="prev" href="prebuilt-rule-8-16-2-prebuilt-rules-8-16-2-appendix.html" title="Appendix U: Downloadable rule update v8.16.2"/>
<link rel="next" href="prebuilt-rule-8-16-3-prebuilt-rules-8-16-3-appendix.html" title="Appendix V: Downloadable rule update v8.16.3"/>
<meta class="elastic" name="product_version" content="8.16"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.16"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.16"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div class="navheader">
<span class="prev">
<a href="prebuilt-rule-8-16-2-prebuilt-rules-8-16-2-appendix.html">« Appendix U: Downloadable rule update v8.16.2</a>
</span>
<span class="next">
<a href="prebuilt-rule-8-16-3-prebuilt-rules-8-16-3-appendix.html">Appendix V: Downloadable rule update v8.16.3 »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [8.16]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="prebuilt-rule-8-16-2-prebuilt-rules-8-16-2-appendix.html">Downloadable rule update v8.16.2</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>AWS STS AssumeRoot by Rare User and Member Account</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.16/docs/detections/prebuilt-rules/downloadable-packages/8-16-2/prebuilt-rule-8-16-2-aws-sts-assumeroot-by-rare-user-and-member-account.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div id="url-to-v3" class="version-warning">
    <strong>IMPORTANT</strong>: This documentation is no longer updated. Refer to <a href="https://www.elastic.co/support/eol">Elastic's version policy</a> and the <a href="https://www.elastic.co/docs">latest documentation</a>.
</div>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="prebuilt-rule-8-16-2-aws-sts-assumeroot-by-rare-user-and-member-account"></a>AWS STS AssumeRoot by Rare User and Member Account</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.16/docs/detections/prebuilt-rules/downloadable-packages/8-16-2/prebuilt-rule-8-16-2-aws-sts-assumeroot-by-rare-user-and-member-account.asciidoc">edit</a></div>
</div></div></div>
<p>Identifies when the STS <code class="literal">AssumeRoot</code> action is performed by a rare user in AWS. The AssumeRoot action allows users to assume the root member account role, granting elevated but specific permissions based on the task policy specified. Adversaries whom may have compromised user credentials, such as access and secret keys, can use this technique to escalate privileges and gain unauthorized access to AWS resources. This is a [New Terms](<a href="/guide/en/security/current/rules-ui-create.html#create-new-terms-rule" class="ulink" target="_top">https://www.elastic.co/guide/en/security/current/rules-ui-create.html#create-new-terms-rule</a>) rule that identifies when the STS <code class="literal">AssumeRoot</code> action is performed by a user that rarely assumes this role and specific member account.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: new_terms</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
filebeat-*
</li>
<li class="listitem">
logs-aws.cloudtrail-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5m</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-9m (<a href="/guide/en/elasticsearch/reference/8.16/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule" title="Set the rule&#8217;s schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum alerts per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://docs.aws.amazon.com/STS/latest/APIReference/API_AssumeRoot.html" class="ulink" target="_top">https://docs.aws.amazon.com/STS/latest/APIReference/API_AssumeRoot.html</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Domain: Cloud
</li>
<li class="listitem">
Data Source: AWS
</li>
<li class="listitem">
Data Source: Amazon Web Services
</li>
<li class="listitem">
Data Source: AWS STS
</li>
<li class="listitem">
Resources: Investigation Guide
</li>
<li class="listitem">
Use Case: Identity and Access Audit
</li>
<li class="listitem">
Tactic: Privilege Escalation
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Rule authors</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Rule license</strong></span>: Elastic License v2</p>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_investigation_guide_4013"></a>Investigation guide</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.16/docs/detections/prebuilt-rules/downloadable-packages/8-16-2/prebuilt-rule-8-16-2-aws-sts-assumeroot-by-rare-user-and-member-account.asciidoc">edit</a></div>
</div></div></div>
<p><span class="strong strong"><strong>Triage and Analysis</strong></span></p>
<p><span class="strong strong"><strong>Investigating AWS STS AssumeRoot by Rare User and Member Account</strong></span></p>
<p>This rule identifies instances where AWS STS (Security Token Service) is used to assume a root role, granting temporary credentials for AWS resource access. While this action is often legitimate, it can be exploited by adversaries to obtain unauthorized access, escalate privileges, or move laterally within an AWS environment.</p>
<p><span class="strong strong"><strong>Possible Investigation Steps</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Identify the Actor and Assumed Role</strong></span>:
</li>
<li class="listitem">
<span class="strong strong"><strong>User Identity</strong></span>: Review the <code class="literal">aws.cloudtrail.user_identity.arn</code> and <code class="literal">aws.cloudtrail.user_identity.type</code> fields to determine who initiated the <code class="literal">AssumeRoot</code> action.
</li>
<li class="listitem">
<span class="strong strong"><strong>Account Context</strong></span>: Check the <code class="literal">aws.cloudtrail.recipient_account_id</code> field for the account affected by the action. This is likely the management account.
</li>
<li class="listitem">
<span class="strong strong"><strong>Authentication</strong></span>: If available, review the <code class="literal">aws.cloudtrail.user_identity.access_key_id</code> to identify the access key used for the action. This key may be compromised in the case of unauthorized activity.
</li>
<li class="listitem">
<span class="strong strong"><strong>Resources</strong></span>: Inspect <code class="literal">aws.cloudtrail.resources.type</code> and <code class="literal">aws.cloudtrail.resources.arn</code> to determine the resource or role assumed. This is the member account where the root role was assumed.
</li>
<li class="listitem">
<span class="strong strong"><strong>Analyze Request Parameters</strong></span>:
</li>
<li class="listitem">
<span class="strong strong"><strong>Session Details</strong></span>: Check <code class="literal">aws.cloudtrail.flattened.request_parameters.durationSeconds</code> for session duration.
</li>
<li class="listitem">
<span class="strong strong"><strong>Permissions</strong></span>: Review <code class="literal">aws.cloudtrail.flattened.request_parameters.taskPolicyArn</code> for the associated policy. These policies are predefined and grant specific permissions to the assumed root account.
</li>
<li class="listitem">
<span class="strong strong"><strong>Target Entity</strong></span>: Inspect the <code class="literal">aws.cloudtrail.flattened.request_parameters.targetPrincipal</code> field for the entity being accessed. This is typically the member account.
</li>
<li class="listitem">
<span class="strong strong"><strong>Target Policy</strong></span>: Inspect the <code class="literal">aws.cloudtrail.flattened.request_parameters.targetPolicyArn</code> field for the policy applied to temporary root credentials. This can help determine the scope of the permissions granted.
</li>
<li class="listitem">
<span class="strong strong"><strong>Examine Response Details</strong></span>:
</li>
<li class="listitem">
<span class="strong strong"><strong>Credentials Issued</strong></span>: Review <code class="literal">aws.cloudtrail.flattened.response_elements.credentials</code> to confirm credentials were issued and note their expiration (<code class="literal">expiration</code> field). The temporary access key can be used to pivot into other actions done by the assumed root account by searching for the value in <code class="literal">aws.cloudtrail.user_identity.access_key_id</code>.
</li>
<li class="listitem">
<span class="strong strong"><strong>Inspect Source Details</strong></span>:
</li>
<li class="listitem">
<span class="strong strong"><strong>Source IP and Location</strong></span>: Evaluate <code class="literal">source.address</code> and <code class="literal">source.geo</code> fields to confirm the request&#8217;s origin. Unusual locations might indicate unauthorized activity.
</li>
<li class="listitem">
<span class="strong strong"><strong>User Agent</strong></span>: Analyze <code class="literal">user_agent.original</code> to determine the tool or application used (e.g., AWS CLI, SDK, or custom tooling).
</li>
<li class="listitem">
<span class="strong strong"><strong>Correlate with Related Events</strong></span>:
</li>
<li class="listitem">
<span class="strong strong"><strong>Concurrent Events</strong></span>: Look for surrounding CloudTrail events that indicate follow-up actions, such as access to sensitive resources or privilege escalation attempts.
</li>
<li class="listitem">
<span class="strong strong"><strong>Historical Activity</strong></span>: Review historical activity for the <code class="literal">aws.cloudtrail.user_identity.arn</code> to determine if this action is anomalous.
</li>
<li class="listitem">
<span class="strong strong"><strong>Evaluate Privilege Escalation Risk</strong></span>:
</li>
<li class="listitem">
<span class="strong strong"><strong>Role Privileges</strong></span>: Inspect the privileges granted by the assumed role or task policy (<code class="literal">aws.cloudtrail.flattened.request_parameters.taskPolicyArn</code>).
</li>
<li class="listitem">
<span class="strong strong"><strong>Operational Context</strong></span>: Confirm whether the action aligns with routine operations or is unusual.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>False Positive Analysis</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Authorized Administrative Activity</strong></span>:
</li>
<li class="listitem">
Verify if the activity was initiated by an AWS administrator for legitimate purposes.
</li>
<li class="listitem">
<span class="strong strong"><strong>Automated Workflows</strong></span>:
</li>
<li class="listitem">
Identify if the action was part of an automated process or workflow.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Response and Remediation</strong></span></p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p><span class="strong strong"><strong>Revoke Unauthorized Credentials</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If malicious activity is identified, immediately revoke the session tokens and access keys associated with the <code class="literal">AssumeRoot</code> action.
</li>
<li class="listitem">
It may be worth removing the compromised access key from the affected user or service account.
</li>
</ul>
</div>
</li>
<li class="listitem">
<p><span class="strong strong"><strong>Enhance Monitoring</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Increase the monitoring frequency for sensitive roles and actions, especially <code class="literal">AssumeRoot</code>.
</li>
</ul>
</div>
</li>
<li class="listitem">
<p><span class="strong strong"><strong>Review IAM Policies</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Limit permissions for accounts or roles to assume root and enforce multi-factor authentication (MFA) where applicable.
</li>
</ul>
</div>
</li>
<li class="listitem">
<p><span class="strong strong"><strong>Contain and Investigate</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Isolate affected accounts or roles and follow incident response procedures to determine the scope and impact of the activity.
</li>
</ul>
</div>
</li>
</ol>
</div>
<p><span class="strong strong"><strong>Additional Information</strong></span></p>
<p>For more information on AssumeRoot, refer to the <a href="https://docs.aws.amazon.com/STS/latest/APIReference/API_AssumeRoot.html" class="ulink" target="_top">AWS STS documentation</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_rule_query_4987"></a>Rule query</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.16/docs/detections/prebuilt-rules/downloadable-packages/8-16-2/prebuilt-rule-8-16-2-aws-sts-assumeroot-by-rare-user-and-member-account.asciidoc">edit</a></div>
</div></div></div>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">event.dataset: "aws.cloudtrail"
    and event.provider: "sts.amazonaws.com"
    and event.action: "AssumeRoot"
    and event.outcome: "success"</pre>
</div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Privilege Escalation
</li>
<li class="listitem">
ID: TA0004
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0004/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0004/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Abuse Elevation Control Mechanism
</li>
<li class="listitem">
ID: T1548
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1548/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1548/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Sub-technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Temporary Elevated Cloud Access
</li>
<li class="listitem">
ID: T1548.005
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1548/005/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1548/005/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Persistence
</li>
<li class="listitem">
ID: TA0003
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0003/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0003/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Account Manipulation
</li>
<li class="listitem">
ID: T1098
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1098/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1098/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Sub-technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Additional Cloud Roles
</li>
<li class="listitem">
ID: T1098.003
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1098/003/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1098/003/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="prebuilt-rule-8-16-2-prebuilt-rules-8-16-2-appendix.html">« Appendix U: Downloadable rule update v8.16.2</a>
</span>
<span class="next">
<a href="prebuilt-rule-8-16-3-prebuilt-rules-8-16-3-appendix.html">Appendix V: Downloadable rule update v8.16.3 »</a>
</span>
</div>
</body>
</html>
