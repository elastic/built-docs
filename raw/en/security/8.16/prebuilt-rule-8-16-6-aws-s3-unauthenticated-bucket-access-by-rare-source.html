<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>AWS S3 Unauthenticated Bucket Access by Rare Source | Elastic Security Solution [8.16] | Elastic</title>
<meta class="elastic" name="content" content="AWS S3 Unauthenticated Bucket Access by Rare Source | Elastic Security Solution [8.16]">

<link rel="home" href="index.html" title="Elastic Security Solution [8.16]"/>
<link rel="up" href="prebuilt-rule-8-16-6-prebuilt-rules-8-16-6-appendix.html" title="Appendix Y: Downloadable rule update v8.16.6"/>
<link rel="prev" href="prebuilt-rule-8-16-6-aws-cloudtrail-log-created.html" title="AWS CloudTrail Log Created"/>
<link rel="next" href="prebuilt-rule-8-16-6-aws-ec2-admin-credential-fetch-via-assumed-role.html" title="AWS EC2 Admin Credential Fetch via Assumed Role"/>
<meta class="elastic" name="product_version" content="8.16"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.16"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.16"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div class="navheader">
<span class="prev">
<a href="prebuilt-rule-8-16-6-aws-cloudtrail-log-created.html">« AWS CloudTrail Log Created</a>
</span>
<span class="next">
<a href="prebuilt-rule-8-16-6-aws-ec2-admin-credential-fetch-via-assumed-role.html">AWS EC2 Admin Credential Fetch via Assumed Role »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [8.16]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="prebuilt-rule-8-16-6-prebuilt-rules-8-16-6-appendix.html">Downloadable rule update v8.16.6</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>AWS S3 Unauthenticated Bucket Access by Rare Source</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.16/docs/detections/prebuilt-rules/downloadable-packages/8-16-6/prebuilt-rule-8-16-6-aws-s3-unauthenticated-bucket-access-by-rare-source.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div id="url-to-v3" class="version-warning">
    <strong>IMPORTANT</strong>: This documentation is no longer updated. Refer to <a href="https://www.elastic.co/support/eol">Elastic's version policy</a> and the <a href="https://www.elastic.co/docs">latest documentation</a>.
</div>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="prebuilt-rule-8-16-6-aws-s3-unauthenticated-bucket-access-by-rare-source"></a>AWS S3 Unauthenticated Bucket Access by Rare Source</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.16/docs/detections/prebuilt-rules/downloadable-packages/8-16-6/prebuilt-rule-8-16-6-aws-s3-unauthenticated-bucket-access-by-rare-source.asciidoc">edit</a></div>
</div></div></div>
<p>Identifies AWS CloudTrail events where an unauthenticated source is attempting to access an S3 bucket. This activity may indicate a misconfigured S3 bucket policy that allows public access to the bucket, potentially exposing sensitive data to unauthorized users. Adversaries can specify <code class="literal">--no-sign-request</code> in the AWS CLI to retrieve objects from an S3 bucket without authentication. This is a [New Terms](<a href="/guide/en/security/current/rules-ui-create.html#create-new-terms-rule" class="ulink" target="_top">https://www.elastic.co/guide/en/security/current/rules-ui-create.html#create-new-terms-rule</a>) rule, which means it will only trigger once for each unique value of the <code class="literal">source.address</code> field that has not been seen making this API request within the last 7 days. This field contains the IP address of the source making the request.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: new_terms</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
filebeat-*
</li>
<li class="listitem">
logs-aws.cloudtrail*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5m</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-9m (<a href="/guide/en/elasticsearch/reference/8.16/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule" title="Set the rule&#8217;s schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum alerts per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://hackingthe.cloud/aws/exploitation/Misconfigured_Resource-Based_Policies/exploting_public_resources_attack_playbook/" class="ulink" target="_top">https://hackingthe.cloud/aws/exploitation/Misconfigured_Resource-Based_Policies/exploting_public_resources_attack_playbook/</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Domain: Cloud
</li>
<li class="listitem">
Data Source: AWS
</li>
<li class="listitem">
Data Source: Amazon Web Services
</li>
<li class="listitem">
Data Source: Amazon S3
</li>
<li class="listitem">
Use Case: Asset Visibility
</li>
<li class="listitem">
Resources: Investigation Guide
</li>
<li class="listitem">
Tactic: Collection
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 2</p>
<p><span class="strong strong"><strong>Rule authors</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Rule license</strong></span>: Elastic License v2</p>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_investigation_guide_4107"></a>Investigation guide</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.16/docs/detections/prebuilt-rules/downloadable-packages/8-16-6/prebuilt-rule-8-16-6-aws-s3-unauthenticated-bucket-access-by-rare-source.asciidoc">edit</a></div>
</div></div></div>
<p><span class="strong strong"><strong>Triage and analysis</strong></span></p>
<div class="quoteblock">
<blockquote>
<p><span class="strong strong"><strong>Disclaimer</strong></span>:
This investigation guide was created using generative AI technology and has been reviewed to improve its accuracy and relevance. While every effort has been made to ensure its quality, we recommend validating the content and adapting it to suit your specific environment and operational needs.</p>
</blockquote>
</div>
<p><span class="strong strong"><strong>Investigating AWS S3 Unauthenticated Bucket Access by Rare Source</strong></span></p>
<p>Amazon S3 is a scalable storage service used for data storage and retrieval. Misconfigured bucket policies can inadvertently allow public access, posing a risk of unauthorized data exposure. Adversaries exploit this by using unauthenticated requests to access data. The detection rule identifies unusual access attempts from new IP addresses, signaling potential misuse and prompting further investigation.</p>
<p><span class="strong strong"><strong>Possible investigation steps</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Review the CloudTrail logs to identify the specific S3 bucket involved in the unauthenticated access attempt and determine the nature of the accessed data.
</li>
<li class="listitem">
Examine the source IP address from the <code class="literal">source.address</code> field to assess its origin and determine if it is associated with known malicious activity or if it is a legitimate but misconfigured source.
</li>
<li class="listitem">
Check the S3 bucket policy and permissions to identify any misconfigurations that might allow public access, focusing on policies that include "Principal": "*".
</li>
<li class="listitem">
Investigate the <code class="literal">aws.cloudtrail.user_identity.type</code> field to confirm if the access was made by an "AWSAccount" or "Unknown" identity, and determine if this aligns with expected behavior.
</li>
<li class="listitem">
Assess the <code class="literal">event.action</code> field to understand the type of operation performed (e.g., "GetObject", "PutObject") and evaluate the potential impact of the access.
</li>
<li class="listitem">
Review recent changes to the S3 bucket configuration or IAM policies that might have inadvertently allowed public access, and correlate these with the timing of the alert.
</li>
<li class="listitem">
If unauthorized access is confirmed, take immediate steps to secure the bucket by updating the bucket policy to restrict access and consider enabling logging and monitoring for future access attempts.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>False positive analysis</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Frequent access from known internal IP addresses may trigger the rule. To manage this, create exceptions for IP addresses that are part of your organization&#8217;s network and regularly access S3 buckets without authentication.
</li>
<li class="listitem">
Automated scripts or tools used for legitimate business processes might use unauthenticated requests. Identify these scripts and exclude their IP addresses from triggering the rule by adding them to an allowlist.
</li>
<li class="listitem">
Third-party services that require access to your S3 buckets might appear as unauthenticated sources. Verify these services and, if deemed safe, exclude their IP addresses from the rule to prevent false positives.
</li>
<li class="listitem">
Temporary testing environments or development setups might use unauthenticated access for convenience. Ensure these environments are documented and their IP addresses are excluded from the rule to avoid unnecessary alerts.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Response and remediation</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Immediately revoke public access to the affected S3 bucket by updating the bucket policy to restrict access to only authorized users and roles.
</li>
<li class="listitem">
Identify and terminate any unauthorized sessions or connections from the IP addresses flagged in the alert to prevent further unauthorized access.
</li>
<li class="listitem">
Conduct a thorough review of the S3 bucket&#8217;s access logs to determine the extent of data exposure and identify any sensitive data that may have been accessed.
</li>
<li class="listitem">
Notify the security team and relevant stakeholders about the potential data exposure incident and provide them with details of the affected resources and actions taken.
</li>
<li class="listitem">
Implement additional monitoring and alerting for unusual access patterns to S3 buckets, focusing on unauthenticated access attempts and access from rare IP addresses.
</li>
<li class="listitem">
Escalate the incident to the organization&#8217;s incident response team for further investigation and to determine if additional containment or remediation actions are necessary.
</li>
<li class="listitem">
Review and update the organization&#8217;s cloud security policies and access controls to prevent similar misconfigurations in the future, ensuring that all S3 buckets have appropriate access restrictions.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Investigating AWS S3 Unauthenticated Bucket Access by Rare Source</strong></span></p>
<p>This rule detects requests to an AWS S3 bucket by an unauthenticated source, which could indicate a misconfigured bucket policy allowing public access. Adversaries can exploit this misconfiguration by using tools or AWS CLI options like <code class="literal">--no-sign-request</code> to access bucket contents.</p>
<p>The rule triggers when an unauthenticated IP address retrieves an object, and that IP has not been seen in the last 7 days.</p>
<p><span class="strong strong"><strong>Possible Investigation Steps</strong></span></p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p><span class="strong strong"><strong>Identify the Source of the Request</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Review the <code class="literal">source.address</code> field to determine the IP address of the request source.
</li>
<li class="listitem">
Check <code class="literal">source.geo</code> fields for geographic details of the originating IP address.
</li>
<li class="listitem">
Analyze the <code class="literal">user_agent.original</code> field to identify the client or tool used (e.g., <code class="literal">Python Requests</code>, <code class="literal">aws-cli</code>, browser).
</li>
</ul>
</div>
</li>
<li class="listitem">
<p><span class="strong strong"><strong>Review the Accessed Bucket and Object</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyze the <code class="literal">aws.cloudtrail.resources.arn</code> field to identify the S3 bucket and object being accessed.
</li>
<li class="listitem">
Inspect <code class="literal">aws.cloudtrail.request_parameters</code> for bucket name and object key to determine which file was retrieved.
</li>
<li class="listitem">
Review the <code class="literal">even.action</code> field to identify which API call was made (e.g., <code class="literal">GetObject</code>, <code class="literal">ListObjects</code>, <code class="literal">PutObject</code>, <code class="literal">ListBucket</code>).
</li>
</ul>
</div>
</li>
<li class="listitem">
<p><span class="strong strong"><strong>Validate the Source IP and Context</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Determine if the IP address (<code class="literal">source.address</code>) has any prior activity in your environment.
</li>
<li class="listitem">
Correlate the IP with threat intelligence or blocklist databases to check for malicious indicators.
</li>
<li class="listitem">
Review CloudTrail logs for other activities originating from the same IP.
</li>
</ul>
</div>
</li>
<li class="listitem">
<p><span class="strong strong"><strong>Analyze the S3 Bucket Configuration</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Review the S3 bucket&#8217;s Access Control List (ACL) and bucket policy to check for misconfigurations allowing public or unauthenticated access.
</li>
<li class="listitem">
Look for overly permissive settings, such as <code class="literal">Principal: *</code> or <code class="literal">Effect: Allow</code> rules that expose the bucket.
</li>
</ul>
</div>
</li>
<li class="listitem">
<p><span class="strong strong"><strong>Investigate Additional Activity</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Check if there are subsequent actions, such as:
</li>
<li class="listitem">
<span class="strong strong"><strong>Additional <code class="literal">GetObject</code> API calls</strong></span>: Indicating further data exfiltration.
</li>
<li class="listitem">
<span class="strong strong"><strong>ListObjects requests</strong></span>: Attempting to enumerate the bucket&#8217;s contents.
</li>
<li class="listitem">
Correlate events within the same timeframe to identify related suspicious activity.
</li>
</ul>
</div>
</li>
<li class="listitem">
<p><span class="strong strong"><strong>Assess the Data Exposed</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Identify the retrieved object(s) and analyze their content to assess potential data exposure.
</li>
<li class="listitem">
Determine if the file contains sensitive information, such as credentials, intellectual property, or PII.
</li>
</ul>
</div>
</li>
</ol>
</div>
<p><span class="strong strong"><strong>False Positive Analysis</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Public Buckets by Design</strong></span>: Some S3 buckets may intentionally allow public access. Verify with the bucket owner if the access was expected.
</li>
<li class="listitem">
<span class="strong strong"><strong>Automated Tools</strong></span>: Security scanners or legitimate services may generate <code class="literal">GetObject</code> events to validate bucket configurations.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Response and Remediation</strong></span></p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p><span class="strong strong"><strong>Immediate Action</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Restrict or remove public access to the affected S3 bucket.
</li>
<li class="listitem">
Update the bucket policy to ensure access is restricted to trusted principals.
</li>
<li class="listitem">
Enable <span class="strong strong"><strong>S3 Block Public Access</strong></span> settings to prevent unintended public access.
</li>
</ul>
</div>
</li>
<li class="listitem">
<p><span class="strong strong"><strong>Monitoring and Detection</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Enable detailed logging and monitoring for all S3 bucket activities.
</li>
<li class="listitem">
Configure real-time alerts for unauthenticated <code class="literal">GetObject</code> or <code class="literal">ListObjects</code> events on sensitive S3 buckets.
</li>
</ul>
</div>
</li>
<li class="listitem">
<p><span class="strong strong"><strong>Security Audits</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Regularly audit S3 bucket policies and ACLs to ensure they adhere to AWS security best practices.
</li>
<li class="listitem">
Use AWS tools like <span class="strong strong"><strong>Trusted Advisor</strong></span> or <span class="strong strong"><strong>Access Analyzer</strong></span> to identify and address misconfigurations.
</li>
</ul>
</div>
</li>
<li class="listitem">
<p><span class="strong strong"><strong>Investigate for Data Exfiltration</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyze historical CloudTrail logs to determine if other sensitive files were accessed or exfiltrated.
</li>
<li class="listitem">
Assess the scope of the exposure and initiate further response if sensitive data was compromised.
</li>
</ul>
</div>
</li>
</ol>
</div>
<p><span class="strong strong"><strong>Additional Resources</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/example-bucket-policies.html" class="ulink" target="_top">AWS Documentation: S3 Bucket Policy Best Practices</a>
</li>
<li class="listitem">
<a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html" class="ulink" target="_top">AWS S3 Block Public Access</a>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_rule_query_5207"></a>Rule query</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.16/docs/detections/prebuilt-rules/downloadable-packages/8-16-6/prebuilt-rule-8-16-6-aws-s3-unauthenticated-bucket-access-by-rare-source.asciidoc">edit</a></div>
</div></div></div>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">event.dataset: "aws.cloudtrail"
    and event.provider: "s3.amazonaws.com"
    and event.action: (
        "GetObject" or
        "PutObject" or
        "ListObjects" or
        "DeleteObject" or
        "ListBucket")
    and event.outcome: "success"
    and aws.cloudtrail.user_identity.type: ("AWSAccount" or "Unknown")
    and cloud.account.id: "anonymous"</pre>
</div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Collection
</li>
<li class="listitem">
ID: TA0009
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0009/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0009/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Data from Cloud Storage
</li>
<li class="listitem">
ID: T1530
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1530/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1530/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Discovery
</li>
<li class="listitem">
ID: TA0007
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0007/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0007/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Cloud Storage Object Discovery
</li>
<li class="listitem">
ID: T1619
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1619/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1619/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Impact
</li>
<li class="listitem">
ID: TA0040
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0040/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0040/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Data Destruction
</li>
<li class="listitem">
ID: T1485
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1485/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1485/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="prebuilt-rule-8-16-6-aws-cloudtrail-log-created.html">« AWS CloudTrail Log Created</a>
</span>
<span class="next">
<a href="prebuilt-rule-8-16-6-aws-ec2-admin-credential-fetch-via-assumed-role.html">AWS EC2 Admin Credential Fetch via Assumed Role »</a>
</span>
</div>
</body>
</html>
