<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>External Alerts | Elastic Security Solution [8.16] | Elastic</title>
<meta class="elastic" name="content" content="External Alerts | Elastic Security Solution [8.16]">

<link rel="home" href="index.html" title="Elastic Security Solution [8.16]"/>
<link rel="up" href="prebuilt-rule-8-16-6-prebuilt-rules-8-16-6-appendix.html" title="Appendix Y: Downloadable rule update v8.16.6"/>
<link rel="prev" href="prebuilt-rule-8-16-6-exploit-prevented-elastic-endgame.html" title="Exploit - Prevented - Elastic Endgame"/>
<link rel="next" href="prebuilt-rule-8-16-6-credential-manipulation-detected-elastic-endgame.html" title="Credential Manipulation - Detected - Elastic Endgame"/>
<meta class="elastic" name="product_version" content="8.16"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.16"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.16"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div class="navheader">
<span class="prev">
<a href="prebuilt-rule-8-16-6-exploit-prevented-elastic-endgame.html">« Exploit - Prevented - Elastic Endgame</a>
</span>
<span class="next">
<a href="prebuilt-rule-8-16-6-credential-manipulation-detected-elastic-endgame.html">Credential Manipulation - Detected - Elastic Endgame »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [8.16]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="prebuilt-rule-8-16-6-prebuilt-rules-8-16-6-appendix.html">Downloadable rule update v8.16.6</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>External Alerts</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.16/docs/detections/prebuilt-rules/downloadable-packages/8-16-6/prebuilt-rule-8-16-6-external-alerts.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="prebuilt-rule-8-16-6-external-alerts"></a>External Alerts</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.16/docs/detections/prebuilt-rules/downloadable-packages/8-16-6/prebuilt-rule-8-16-6-external-alerts.asciidoc">edit</a></div>
</div></div></div>
<p>Generates a detection alert for each external alert written to the configured indices. Enabling this rule allows you to immediately begin investigating external alerts in the app.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
apm-<span class="strong strong"><strong>-transaction</strong></span>
</li>
<li class="listitem">
traces-apm*
</li>
<li class="listitem">
auditbeat-*
</li>
<li class="listitem">
filebeat-*
</li>
<li class="listitem">
logs-*
</li>
<li class="listitem">
packetbeat-*
</li>
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5m</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: None (<a href="/guide/en/elasticsearch/reference/8.16/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule" title="Set the rule&#8217;s schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum alerts per execution</strong></span>: 10000</p>
<p><span class="strong strong"><strong>References</strong></span>: None</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
OS: Windows
</li>
<li class="listitem">
Data Source: APM
</li>
<li class="listitem">
OS: macOS
</li>
<li class="listitem">
OS: Linux
</li>
<li class="listitem">
Resources: Investigation Guide
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 104</p>
<p><span class="strong strong"><strong>Rule authors</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Rule license</strong></span>: Elastic License v2</p>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_investigation_guide_4754"></a>Investigation guide</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.16/docs/detections/prebuilt-rules/downloadable-packages/8-16-6/prebuilt-rule-8-16-6-external-alerts.asciidoc">edit</a></div>
</div></div></div>
<p><span class="strong strong"><strong>Triage and analysis</strong></span></p>
<div class="quoteblock">
<blockquote>
<p><span class="strong strong"><strong>Disclaimer</strong></span>:
This investigation guide was created using generative AI technology and has been reviewed to improve its accuracy and relevance. While every effort has been made to ensure its quality, we recommend validating the content and adapting it to suit your specific environment and operational needs.</p>
</blockquote>
</div>
<p><span class="strong strong"><strong>Investigating External Alerts</strong></span></p>
<p>External alerts are crucial for identifying potential threats across diverse environments like Windows, macOS, and Linux. These alerts are generated from various sources, excluding specific modules like endpoint or cloud defend, to focus on broader threat landscapes. Adversaries may exploit vulnerabilities in these systems to execute unauthorized actions. The <em>External Alerts</em> detection rule filters and highlights such activities by focusing on alert events, enabling analysts to swiftly investigate and mitigate risks.</p>
<p><span class="strong strong"><strong>Possible investigation steps</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Review the alert details to identify the specific event.kind:alert that triggered the detection, ensuring it is not associated with the excluded modules (endgame, endpoint, or cloud_defend).
</li>
<li class="listitem">
Examine the source and context of the alert by checking the associated tags, such as <em>OS: Windows</em>, <em>OS: macOS</em>, or <em>OS: Linux</em>, to understand the environment affected.
</li>
<li class="listitem">
Gather additional context by correlating the alert with other logs or events from the same time frame or system to identify any related suspicious activities.
</li>
<li class="listitem">
Assess the risk score and severity level to prioritize the investigation and determine the potential impact on the organization.
</li>
<li class="listitem">
Investigate the origin of the alert by identifying the source IP, user account, or process involved, and check for any known vulnerabilities or exploits associated with them.
</li>
<li class="listitem">
Consult threat intelligence sources to determine if the alert corresponds to any known threat actors or campaigns targeting similar environments.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>False positive analysis</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Alerts from benign third-party applications may trigger false positives. Review and identify these applications, then create exceptions to exclude them from future alerts.
</li>
<li class="listitem">
Routine system updates or patches can generate alerts. Monitor update schedules and create exceptions for known update activities to reduce noise.
</li>
<li class="listitem">
Network monitoring tools might produce alerts due to their scanning activities. Verify these tools and exclude their activities if deemed non-threatening.
</li>
<li class="listitem">
Alerts from internal security testing or penetration testing exercises can be mistaken for threats. Coordinate with security teams to whitelist these activities during scheduled tests.
</li>
<li class="listitem">
Certain administrative scripts or automation tasks may trigger alerts. Evaluate these scripts and exclude them if they are part of regular operations and pose no risk.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Response and remediation</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Isolate affected systems immediately to prevent further unauthorized actions and contain the threat.
</li>
<li class="listitem">
Conduct a thorough review of the alert details to identify any specific vulnerabilities or exploits used by the adversary.
</li>
<li class="listitem">
Apply relevant patches or updates to the affected systems to remediate any identified vulnerabilities.
</li>
<li class="listitem">
Restore systems from a known good backup if unauthorized changes or actions have been detected.
</li>
<li class="listitem">
Monitor network traffic and system logs closely for any signs of further suspicious activity or attempts to exploit similar vulnerabilities.
</li>
<li class="listitem">
Escalate the incident to the appropriate security team or management if the threat appears to be part of a larger attack campaign or if additional resources are needed for remediation.
</li>
<li class="listitem">
Enhance detection capabilities by updating security tools and configurations to better identify similar threats in the future.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_setup_1514"></a>Setup</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.16/docs/detections/prebuilt-rules/downloadable-packages/8-16-6/prebuilt-rule-8-16-6-external-alerts.asciidoc">edit</a></div>
</div></div></div>
<p><span class="strong strong"><strong>Setup</strong></span></p>
<p>This rule is configured to generate more <span class="strong strong"><strong>Max alerts per run</strong></span> than the default 1000 alerts per run set for all rules. This is to ensure that it captures as many alerts as possible.</p>
<p><span class="strong strong"><strong>IMPORTANT:</strong></span> The rule&#8217;s <span class="strong strong"><strong>Max alerts per run</strong></span> setting can be superseded by the <code class="literal">xpack.alerting.rules.run.alerts.max</code> Kibana config setting, which determines the maximum alerts generated by <em>any</em> rule in the Kibana alerting framework. For example, if <code class="literal">xpack.alerting.rules.run.alerts.max</code> is set to 1000, this rule will still generate no more than 1000 alerts even if its own <span class="strong strong"><strong>Max alerts per run</strong></span> is set higher.</p>
<p>To make sure this rule can generate as many alerts as it&#8217;s configured in its own <span class="strong strong"><strong>Max alerts per run</strong></span> setting, increase the <code class="literal">xpack.alerting.rules.run.alerts.max</code> system setting accordingly.</p>
<p><span class="strong strong"><strong>NOTE:</strong></span> Changing <code class="literal">xpack.alerting.rules.run.alerts.max</code> is not possible in Serverless projects.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_rule_query_5764"></a>Rule query</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.16/docs/detections/prebuilt-rules/downloadable-packages/8-16-6/prebuilt-rule-8-16-6-external-alerts.asciidoc">edit</a></div>
</div></div></div>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">event.kind:alert and not event.module:(endgame or endpoint or cloud_defend)</pre>
</div>
</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="prebuilt-rule-8-16-6-exploit-prevented-elastic-endgame.html">« Exploit - Prevented - Elastic Endgame</a>
</span>
<span class="next">
<a href="prebuilt-rule-8-16-6-credential-manipulation-detected-elastic-endgame.html">Credential Manipulation - Detected - Elastic Endgame »</a>
</span>
</div>
</body>
</html>
