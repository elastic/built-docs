<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>AI Assistant Knowledge Base | Elastic Security Solution [8.17] | Elastic</title>
<meta class="elastic" name="content" content="AI Assistant Knowledge Base | Elastic Security Solution [8.17]">

<link rel="home" href="index.html" title="Elastic Security Solution [8.17]"/>
<link rel="up" href="security-assistant.html" title="AI Assistant"/>
<link rel="prev" href="security-assistant.html" title="AI Assistant"/>
<link rel="next" href="attack-discovery.html" title="Attack Discovery"/>
<meta class="elastic" name="product_version" content="8.17"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.17"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.17"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div class="navheader">
<span class="prev">
<a href="security-assistant.html">« AI Assistant</a>
</span>
<span class="next">
<a href="attack-discovery.html">Attack Discovery »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [8.17]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="ai-for-security.html">AI for Security</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="security-assistant.html">AI Assistant</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>AI Assistant Knowledge Base</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.17/docs/AI-for-security/knowledge-base.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div id="url-to-v3" class="version-warning">
    <strong>IMPORTANT</strong>: This documentation is no longer updated. Refer to <a href="https://www.elastic.co/support/eol">Elastic's version policy</a> and the <a href="https://www.elastic.co/docs/solutions/security/ai/ai-assistant-knowledge-base">latest documentation</a>.
</div>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="ai-assistant-knowledge-base"></a>AI Assistant Knowledge Base</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.17/docs/AI-for-security/knowledge-base.asciidoc">edit</a></div>
</div></div></div>
<p>AI Assistant&#8217;s Knowledge Base feature enables AI Assistant to recall specific documents and other specified information. This information, which can include everything from the location of your datacenters to the latest threat research, provides additional context that can improve the quality of AI Assistant&#8217;s responses to your queries. This topic describes how to enable and add information to Knowledge Base.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>When you upgrade from Elastic Security version 8.15 to a newer version, information previously stored by AI Assistant will be lost.</p>
</div>
</div>
<div class="sidebar">
<div class="titlepage"><div><div>
<p class="title"><strong>Requirements</strong></p>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
To use Knowledge Base, you need the <code class="literal">Elastic AI Assistant: All</code> privilege. To edit global Knowledge Base entries (information that will affect the AI Assistant experience for other users in the Kibana space), you need the <code class="literal">Allow Changes to Global Entries</code> privilege.
</li>
<li class="listitem">
You must <a class="xref" href="ml-requirements.html" title="Machine learning job and rule requirements">enable machine learning</a> with a minimum ML node size of 4 GB.
</li>
</ul>
</div>
</div>
<div class="position-relative"><h4><a id="knowledge-base-rbac"></a>Role-based access control (RBAC) for Knowledge Base</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.17/docs/AI-for-security/knowledge-base.asciidoc">edit</a></div>
<p>The <code class="literal">Elastic AI Assistant: All</code> role privilege allows you to use AI Assistant and access its settings. It has two sub-privileges, <code class="literal">Field Selection and Anonymization</code>, which allows you to customize which alert fields are sent to AI Assistant and Attack Discovery, and <code class="literal">Knowledge Base</code>, which allows you to edit and create new Knowledge Base entries.</p>
<div class="imageblock">
<div class="content">
<img src="images/knowledge-base-rbac.png" alt="Knowledge base&#8217;s RBAC settings" width="60%">
</div>
</div>
<div class="position-relative"><h4><a id="enable-knowledge-base"></a>Enable Knowledge Base</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.17/docs/AI-for-security/knowledge-base.asciidoc">edit</a></div>
<p>There are two ways to enable Knowledge Base.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>You must individually enable Knowledge Base for each Kibana space where you want to use it.</p>
</div>
</div>
<div class="position-relative"><h5><a id="_option_1_enable_knowledge_base_from_an_ai_assistant_conversation"></a>Option 1: Enable Knowledge Base from an AI Assistant conversation</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.17/docs/AI-for-security/knowledge-base.asciidoc">edit</a></div>
<p>Open a conversation with AI Assistant, select a large language model, then click <span class="strong strong"><strong>Setup Knowledge Base</strong></span>. If the button doesn&#8217;t appear, Knowledge Base is already enabled.</p>
<div class="imageblock">
<div class="content">
<img src="images/knowledge-base-assistant-setup-button.png" alt="An AI Assistant conversation showing the Setup Knowledge Base button">
</div>
</div>
<p>Knowledge base setup may take several minutes. It will continue in the background if you close the conversation. After setup is complete, you can access Knowledge Base settings from AI Assistant&#8217;s conversation settings menu (access the conversation settings menu by clicking the three dots button next to the model selection dropdown).</p>
<div class="imageblock">
<div class="content">
<img src="images/knowledge-base-assistant-menu-dropdown.png" alt="AI Assistant&#8217;s dropdown menu with the Knowledge Base option highlighted">
</div>
</div>
<div class="position-relative"><h5><a id="_option_2_enable_knowledge_base_from_the_security_ai_settings"></a>Option 2: Enable Knowledge Base from the Security AI settings</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.17/docs/AI-for-security/knowledge-base.asciidoc">edit</a></div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
To open <span class="strong strong"><strong>Security AI settings</strong></span>, use the <a href="/guide/en/kibana/8.17/introduction.html#kibana-navigation-search" class="ulink" target="_top">global search field</a> to find "AI Assistant for Security."
</li>
<li class="listitem">
On the <span class="strong strong"><strong>Knowledge Base</strong></span> tab, click <span class="strong strong"><strong>Setup Knowledge Base</strong></span>. If the button doesn&#8217;t appear, Knowledge Base is already enabled.
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/knowledge-base-assistant-settings-kb-tab.png" alt="AI Assistant&#8217;s settings menu open to the Knowledge Base tab">
</div>
</div>
<div class="position-relative"><h4><a id="rag-for-alerts"></a>Knowledge base for alerts</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.17/docs/AI-for-security/knowledge-base.asciidoc">edit</a></div>
<p>AI Assistant receives <code class="literal">open</code> or <code class="literal">acknowledged</code> alerts from your environment from the last 24 hours and uses them as context for your prompts. This enables it to answer questions about multiple alerts in your environment rather than just about individual alerts you choose to send it. It receives alerts ordered by risk score, then by the most recently generated. Building block alerts are excluded.</p>
<p>To configure alert access for Knowledge Base:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Go the <span class="strong strong"><strong>Security AI settings</strong></span> page. Use the <a href="/guide/en/kibana/8.17/introduction.html#kibana-navigation-search" class="ulink" target="_top">global search field</a> to find "AI Assistant for Security."
</li>
<li class="listitem">
On the <span class="strong strong"><strong>Knowledge Base</strong></span> tab, use the slider to select the number of alerts to send to AI Assistant.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Save</strong></span>.
</li>
</ol>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Including a large number of alerts may cause your request to exceed the maximum token length of your third-party generative AI provider. If this happens, try selecting a lower number of alerts to send.</p>
</div>
</div>
<div class="position-relative"><h4><a id="knowledge-base-add-knowledge"></a>Add knowledge</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.17/docs/AI-for-security/knowledge-base.asciidoc">edit</a></div>
<p>To view all knowledge base entries, go to <span class="strong strong"><strong>Security AI settings</strong></span> and select the <span class="strong strong"><strong>Knowledge Base</strong></span> tab. You can add individual documents or entire indices containing multiple documents. Each entry in the Knowledge Base (a document or index) has a <span class="strong strong"><strong>Sharing</strong></span> setting of <code class="literal">private</code> or <code class="literal">global</code>. Private entries apply to the current user only and do not affect other users in the Kibana space, whereas global entries affect all users. Each entry can also have a <code class="literal">Required knowledge</code> setting, which means it will be included as context for every message sent to AI Assistant.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>When you enable Knowledge Base, it comes pre-populated with articles from <a href="/security-labs" class="ulink" target="_top">Elastic Security Labs</a>, current through September 30, 2024, which allows AI Assistant to leverage Elastic&#8217;s security research during your conversations. This enables it to answer questions such as, “Are there any new tactics used against Windows hosts that I should be aware of when investigating my alerts?”</p>
</div>
</div>
<div class="position-relative"><h5><a id="knowledge-base-add-knowledge-document"></a>Add an individual document</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.17/docs/AI-for-security/knowledge-base.asciidoc">edit</a></div>
<p>Add an individual document to Knowledge Base when you want AI Assistant to remember a specific piece of information.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
To open <span class="strong strong"><strong>Security AI settings</strong></span>, use the <a href="/guide/en/kibana/8.17/introduction.html#kibana-navigation-search" class="ulink" target="_top">global search field</a> to find "AI Assistant for Security." Select the <span class="strong strong"><strong>Knowledge Base</strong></span> tab.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>New → Document</strong></span> and give it a name.
</li>
<li class="listitem">
Under <span class="strong strong"><strong>Sharing</strong></span>, select whether this knowledge should be <span class="strong strong"><strong>Global</strong></span> or <span class="strong strong"><strong>Private</strong></span>.
</li>
<li class="listitem">
Write the knowledge AI Assistant should remember in the <span class="strong strong"><strong>Markdown text</strong></span> field.
</li>
<li class="listitem">
In the <span class="strong strong"><strong>Markdown text</strong></span> field, enter the information you want AI Assistant to remember.
</li>
<li class="listitem">
If it should be <span class="strong strong"><strong>Required knowledge</strong></span>, select the option. Otherwise, leave it blank.
Alternatively, you can simply send a message to AI Assistant that instructs it to "Remember" the information. For example, "Remember that I changed my password today, October 24, 2024", or "Remember we always use the Threat Hunting Timeline template when investigating potential threats". Entries created in this way are private to you. By default they are not required knowledge, but you can make them required by instructing AI Assistant to "Always remember", for example "Always remember to address me as madam", or "Always remember that our primary data center is located in Austin, Texas".
</li>
</ol>
</div>
<p>Refer to the following video for an example of adding a document to Knowledge Base from the settings menu.</p>
<div class="exampleblock">
<div class="content">
<script type="text/javascript" async src="https://play.vidyard.com/embed/v4.js"></script>
<img
  style="width: 100%; margin: auto; display: block;"
  class="vidyard-player-embed"
  src="https://play.vidyard.com/rQsTujEfikpx3vv1vrbfde.jpg"
  data-uuid="rQsTujEfikpx3vv1vrbfde"
  data-v="4"
  data-type="inline"
/>
</br>
</div>
</div>
<div class="position-relative"><h5><a id="knowledge-base-add-knowledge-index"></a>Add an index</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.17/docs/AI-for-security/knowledge-base.asciidoc">edit</a></div>
<p>Add an index as a knowledge source when you want new information added to that index to automatically inform AI Assistant&#8217;s responses. Common security examples include asset inventories, network configuration information, on-call matrices, threat intelligence reports, and vulnerability scans.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Indices added to Knowledge Base must have at least one field mapped as <a href="/guide/en/elasticsearch/reference/8.17/semantic-text.html" class="ulink" target="_top">semantic text</a>.</p>
</div>
</div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
To open <span class="strong strong"><strong>Security AI settings</strong></span>, use the <a href="/guide/en/kibana/8.17/introduction.html#kibana-navigation-search" class="ulink" target="_top">global search field</a> to find "AI Assistant for Security." Select the <span class="strong strong"><strong>Knowledge Base</strong></span> tab.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>New → Index</strong></span>.
</li>
<li class="listitem">
Name the knowledge source.
</li>
<li class="listitem">
Under <span class="strong strong"><strong>Sharing</strong></span>, select whether this knowledge should be <span class="strong strong"><strong>Global</strong></span> or <span class="strong strong"><strong>Private</strong></span>.
</li>
<li class="listitem">
Under <span class="strong strong"><strong>Index</strong></span>, enter the name of the index you want to use as a knowledge source.
</li>
<li class="listitem">
Under <span class="strong strong"><strong>Field</strong></span>, enter the names of one or more semantic text fields within the index.
</li>
<li class="listitem">
Under <span class="strong strong"><strong>Data Description</strong></span>, describe when this information should be used by AI Assistant.
</li>
<li class="listitem">
Under <span class="strong strong"><strong>Query Instruction</strong></span>, describe how AI Assistant should query this index to retrieve relevant information.
</li>
<li class="listitem">
Under <span class="strong strong"><strong>Output Fields</strong></span>, list the fields which should be sent to AI Assistant. If none are listed, all fields will be sent.
</li>
</ol>
</div>
<div class="imageblock">
<div class="content">
<img src="images/knowledge-base-add-index-config.png" alt="Knowledge base&#8217;s Edit index entry menu" width="80%">
</div>
</div>
<p>Refer to the following video for an example of adding an index to Knowledge Base.</p>
<div class="exampleblock">
<div class="content">
<script type="text/javascript" async src="https://play.vidyard.com/embed/v4.js"></script>
<img
  style="width: 100%; margin: auto; display: block;"
  class="vidyard-player-embed"
  src="https://play.vidyard.com/Q5CjXMN4R2GYLGLUy5P177.jpg"
  data-uuid="Q5CjXMN4R2GYLGLUy5P177"
  data-v="4"
  data-type="inline"
/>
</br>
</div>
</div>
<div class="position-relative"><h5><a id="knowledge-base-crawler-or-connector"></a>Add knowledge with a connector or web crawler</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.17/docs/AI-for-security/knowledge-base.asciidoc">edit</a></div>
<p>You can use an Elasticsearch connector or web crawler to create an index that contains data you want to add to Knowledge Base.</p>
<p>This section provides an example of adding a threat intelligence feed to Knowledge Base using a web crawler. For more information on adding data to Elasticsearch using a connector, refer to <a href="/guide/en/elasticsearch/reference/8.17/es-connectors.html" class="ulink" target="_top">Ingest data with Elastic connectors</a>. For more information on web crawlers, refer to <a href="/guide/en/enterprise-search/8.17/crawler.html" class="ulink" target="_top">Elastic web crawler</a>.</p>
<div class="position-relative"><h6><a id="_use_a_web_crawler_to_add_threat_intelligence_to_knowledge_base"></a>Use a web crawler to add threat intelligence to Knowledge Base</h6><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.17/docs/AI-for-security/knowledge-base.asciidoc">edit</a></div>
<p>First, you&#8217;ll need to set up a web crawler to add the desired data to an index, then you&#8217;ll need to add that index to Knowledge Base.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
From the <span class="strong strong"><strong>Search</strong></span> section of Kibana, find <span class="strong strong"><strong>Web crawlers</strong></span> in the navigation menu or use the <a href="/guide/en/kibana/8.17/introduction.html#kibana-navigation-search" class="ulink" target="_top">global search field</a>.
</li>
<li class="listitem">
<p>Click <span class="strong strong"><strong>New web crawler</strong></span>.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Under <span class="strong strong"><strong>Index name</strong></span>, name the index where the data from your new web crawler will be stored, for example <code class="literal">threat_intelligence_feed_1</code>. Click <span class="strong strong"><strong>Create index</strong></span>.
</li>
<li class="listitem">
Under <span class="strong strong"><strong>Domain URL</strong></span>, enter the URL where the web crawler should collect data. Click <span class="strong strong"><strong>Validate Domain</strong></span> to test it, then <span class="strong strong"><strong>Add domain</strong></span>.
</li>
</ol>
</div>
</li>
<li class="listitem">
<p>The previous step opens a page with the details of your new index. Go to its <span class="strong strong"><strong>Mappings</strong></span> tab, then click <span class="strong strong"><strong>Add field</strong></span>.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Remember, each index added to Knowledge Base must have at least one semantic text field.</p>
</div>
</div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Under <span class="strong strong"><strong>Field type</strong></span>, select <code class="literal">Semantic text</code>. Under <span class="strong strong"><strong>Select an inference endpoint</strong></span>, select <code class="literal">elastic-security-ai-assistant-elser2</code>. Click <span class="strong strong"><strong>Add field</strong></span>, then <span class="strong strong"><strong>Save mapping</strong></span>.
</li>
</ol>
</div>
</li>
<li class="listitem">
Go to the <span class="strong strong"><strong>Scheduling</strong></span> tab. Enable the <span class="strong strong"><strong>Enable recurring crawls with the following schedule</strong></span> setting, and define your desired schedule.
</li>
<li class="listitem">
<p>Go to the <span class="strong strong"><strong>Manage Domains</strong></span> tab. Select the domain associated with your new web crawler, then go the its <span class="strong strong"><strong>Crawl rules</strong></span> tab and click <span class="strong strong"><strong>Add crawl rule</strong></span>. For more information, refer to <a href="/guide/en/enterprise-search/8.17/crawler-extraction-rules.html" class="ulink" target="_top">Web crawler content extraction rules</a>.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Click <span class="strong strong"><strong>Add crawl rule</strong></span> again. Under <span class="strong strong"><strong>Policy</strong></span>, select <code class="literal">Disallow</code>. Under <span class="strong strong"><strong>Rule</strong></span>, select <code class="literal">Regex</code>. Under <span class="strong strong"><strong>Path pattern</strong></span>, enter <code class="literal">.*</code>. Click <span class="strong strong"><strong>Save</strong></span>.
</li>
<li class="listitem">
Under <span class="strong strong"><strong>Policy</strong></span>, select <code class="literal">Allow</code>. Under <span class="strong strong"><strong>Rule</strong></span>, select <code class="literal">Contains</code>. Under <span class="strong strong"><strong>Path pattern</strong></span>, enter your path pattern, for example <code class="literal">threat-intelligence</code>. Click <span class="strong strong"><strong>Save</strong></span>. Make sure this rule appears below the rule created in the previous step on the list.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Crawl</strong></span>, then <span class="strong strong"><strong>Crawl all domains on this index</strong></span>. A success message appears. The crawl process will take longer for larger data sources. Once it finishes, your new web crawler&#8217;s index will contain documents provided by the crawler.
</li>
</ol>
</div>
</li>
<li class="listitem">
Finally, follow the instructions to <a class="xref" href="ai-assistant-knowledge-base.html#knowledge-base-add-knowledge-index" title="Add an index">add an index to Knowledge Base</a>. Add the index that contains the data from your new web crawler (<code class="literal">threat_intelligence_feed_1</code> in this example).
</li>
</ol>
</div>
<p>Your new threat intelligence data is now included in Knowledge Base and can inform AI Assistant&#8217;s responses.</p>
<p>Refer to the following video for an example of creating a web crawler to ingest threat intelligence data and adding it to Knowledge Base.</p>
<div class="exampleblock">
<div class="content">
<script type="text/javascript" async src="https://play.vidyard.com/embed/v4.js"></script>
<img
  style="width: 100%; margin: auto; display: block;"
  class="vidyard-player-embed"
  src="https://play.vidyard.com/eYo1e1ZRwT2mjfM7Yr9MuZ.jpg"
  data-uuid="eYo1e1ZRwT2mjfM7Yr9MuZ"
  data-v="4"
  data-type="inline"
/>
</br>
</div>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="security-assistant.html">« AI Assistant</a>
</span>
<span class="next">
<a href="attack-discovery.html">Attack Discovery »</a>
</span>
</div>
</body>
</html>
