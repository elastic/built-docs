<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Configure data volume for Elastic Endpoint | Elastic Security Solution [8.17] | Elastic</title>
<meta class="elastic" name="content" content="Configure data volume for Elastic Endpoint | Elastic Security Solution [8.17]">

<link rel="home" href="index.html" title="Elastic Security Solution [8.17]"/>
<link rel="up" href="configure-endpoint-integration-policy.html" title="Configure an integration policy for Elastic Defend"/>
<link rel="prev" href="linux-file-monitoring.html" title="Configure Linux file system monitoring"/>
<link rel="next" href="create-defend-policy-api.html" title="Create an Elastic Defend policy using API"/>
<meta class="elastic" name="product_version" content="8.17"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.17"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.17"/>
</head>
<body>
<div class="navheader">
<span class="prev">
<a href="linux-file-monitoring.html">« Configure Linux file system monitoring</a>
</span>
<span class="next">
<a href="create-defend-policy-api.html">Create an Elastic Defend policy using API »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [8.17]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="endpoint-protection-intro.html">Configure endpoint protection with Elastic Defend</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="configure-endpoint-integration-policy.html">Configure an integration policy for Elastic Defend</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Configure data volume for Elastic Endpoint</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.17/docs/getting-started/endpoint-data-volume.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="endpoint-data-volume"></a>Configure data volume for Elastic Endpoint</h2><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.17/docs/getting-started/endpoint-data-volume.asciidoc">edit</a></div>
</div></div></div>

<p>Elastic Endpoint, the installed component that performs Elastic Defend&#8217;s threat monitoring and prevention, is optimized to reduce data volume and CPU usage. You can disable or modify some of these optimizations by reconfiguring the following <a class="xref" href="configure-endpoint-integration-policy.html#adv-policy-settings" title="Advanced policy settings (optional)">advanced settings</a> in the Elastic Defend integration policy.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Modifying these advanced settings from their defaults will increase the volume of data that Elastic Endpoint processes and ingests, and increase Elastic Endpoint&#8217;s CPU usage. Make sure you&#8217;re aware of how these changes will affect your storage capabilities and performance.</p>
</div>
</div>
<p>Each setting has several OS-specific variants, represented by <code class="literal">[linux|mac|windows]</code> in the names listed below. Use the variant relevant to your hosts' operating system (for example, <code class="literal">windows.advanced.events.deduplicate_network_events</code> to configure network event deduplication for Windows hosts).</p>
<div class="position-relative"><h4><a id="network-event-deduplication"></a>Network event deduplication</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.17/docs/getting-started/endpoint-data-volume.asciidoc">edit</a></div>
<p><span class="Admonishment Admonishment--change">
[<span class="Admonishment-version u-mono">8.15</span>]
<span class="Admonishment-detail">
Added in 8.15.
</span>
</span> When repeated network connections are detected from the same process, Elastic Endpoint will not produce network events for subsequent connections. To disable or reduce deduplication of network events, use these advanced settings:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">[linux|mac|windows].advanced.events.deduplicate_network_events</code>
</span>
</dt>
<dd>
Enter <code class="literal">false</code> to completely disable network event deduplication. Default: <code class="literal">true</code>
</dd>
<dt>
<span class="term">
<code class="literal">[linux|mac|windows].advanced.events.deduplicate_network_events_below_bytes</code>
</span>
</dt>
<dd>
Enter a transfer size threshold (in bytes) for events you want to deduplicate. Connections below the threshold are deduplicated, and connections above it are not deduplicated. This allows you to suppress repeated connections for smaller data transfers but always generate events for larger transfers. Default: <code class="literal">1048576</code> (1MB)
</dd>
</dl>
</div>
<div class="position-relative"><h4><a id="host-fields"></a>Data in <code class="literal">host.*</code> fields</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.17/docs/getting-started/endpoint-data-volume.asciidoc">edit</a></div>
<p><span class="Admonishment Admonishment--change">
[<span class="Admonishment-version u-mono">8.18</span>]
<span class="Admonishment-detail">
Added in 8.18.
</span>
</span> Elastic Endpoint includes only a small subset of the data in the <code class="literal">host.*</code> fieldset in event documents. Full <code class="literal">host.*</code> information is still included in documents written to the <code class="literal">metrics-*</code> index pattern and in Elastic Endpoint alerts. To override this behavior and include all <code class="literal">host.*</code> data for events, use this advanced setting:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">[linux|mac|windows].advanced.set_extended_host_information</code>
</span>
</dt>
<dd>
Enter <code class="literal">true</code> to include all <code class="literal">host.*</code> event data. Default: <code class="literal">false</code>
</dd>
</dl>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Users should take note of how a lack of some <code class="literal">host.*</code> information may affect their <a class="xref" href="event-filters.html" title="Event filters">event filters</a> or <a class="xref" href="add-exceptions.html#endpoint-rule-exceptions" title="Add Elastic Endpoint exceptions">Endpoint alert exceptions</a>.</p>
</div>
</div>
<div class="position-relative"><h4><a id="merged-process-network"></a>Merged process and network events</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.17/docs/getting-started/endpoint-data-volume.asciidoc">edit</a></div>
<p><span class="Admonishment Admonishment--change">
[<span class="Admonishment-version u-mono">8.18</span>]
<span class="Admonishment-detail">
Added in 8.18.
</span>
</span> Elastic Endpoint merges process <code class="literal">create</code>/<code class="literal">terminate</code> events (Windows) and <code class="literal">fork</code>/<code class="literal">exec</code>/<code class="literal">end</code> events (macOS/Linux) when possible. This means short-lived processes only generate a single event containing the details from when the process terminated. Elastic Endpoint also merges network <code class="literal">connection/termination</code> events (Windows/macOS/Linux) when possible for short-lived connections. To disable this behavior, use these advanced settings:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">[linux|mac|windows].advanced.events.aggregate_process</code>
</span>
</dt>
<dd>
Enter <code class="literal">false</code> to disable merging of process events. Default: <code class="literal">true</code>
</dd>
<dt>
<span class="term">
<code class="literal">[linux|mac|windows].advanced.events.aggregate_network</code>
</span>
</dt>
<dd>
Enter <code class="literal">false</code> to disable merging of network events. Default: <code class="literal">true</code>
</dd>
</dl>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Merged events can affect the results of <a class="xref" href="event-filters.html" title="Event filters">event filters</a>. Notably, for merged events, <code class="literal">event.action</code> is an array containing all actions merged into the single event, such as <code class="literal">event.action=[fork, exec, end]</code>. In that example, if your event filter omits all fork events (<code class="literal">event.action : fork</code>), it will also filter out all merged events that include a <code class="literal">fork</code> action. To prevent such issues, you&#8217;ll need to modify your event filters accordingly, or set the <code class="literal">[linux|mac|windows].advanced.events.aggregate_process</code> and <code class="literal">[linux|mac|windows].advanced.events.aggregate_network</code> advanced settings to <code class="literal">false</code> to prevent Elastic Endpoint from merging events.</p>
</div>
</div>
<div class="position-relative"><h4><a id="md5-sha1-hashes"></a>MD5 and SHA-1 hashes</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.17/docs/getting-started/endpoint-data-volume.asciidoc">edit</a></div>
<p><span class="Admonishment Admonishment--change">
[<span class="Admonishment-version u-mono">8.18</span>]
<span class="Admonishment-detail">
Added in 8.18.
</span>
</span> Elastic Endpoint does not report MD5 and SHA-1 hashes in event data by default. These will still be reported if any <a class="xref" href="trusted-apps-ov.html" title="Trusted applications">trusted applications</a>, <a class="xref" href="blocklist.html" title="Blocklist">blocklist entries</a>, <a class="xref" href="event-filters.html" title="Event filters">event filters</a>, or <a class="xref" href="add-exceptions.html#endpoint-rule-exceptions" title="Add Elastic Endpoint exceptions">Endpoint exceptions</a> require them. To include these hashes in all event data, use these advanced settings:</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">[linux|mac|windows].advanced.events.hash.md5</code>
</span>
</dt>
<dd>
Enter <code class="literal">true</code> to compute and include MD5 hashes for processes and libraries in events. Default: <code class="literal">false</code>
</dd>
<dt>
<span class="term">
<code class="literal">[linux|mac|windows].advanced.events.hash.sha1</code>
</span>
</dt>
<dd>
Enter <code class="literal">true</code> to compute and include SHA-1 hashes for processes and libraries in events. Default: <code class="literal">false</code>
</dd>
<dt>
<span class="term">
<code class="literal">[linux|mac|windows].advanced.alerts.hash.md5</code>
</span>
</dt>
<dd>
Enter <code class="literal">true</code> to compute and include MD5 hashes for processes and libraries in alerts. Default: <code class="literal">false</code>
</dd>
<dt>
<span class="term">
<code class="literal">[linux|mac|windows].advanced.alerts.hash.sha1</code>
</span>
</dt>
<dd>
Enter <code class="literal">true</code> to compute and include SHA-1 hashes for processes and libraries in alerts. Default: <code class="literal">false</code>
</dd>
</dl>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="linux-file-monitoring.html">« Configure Linux file system monitoring</a>
</span>
<span class="next">
<a href="create-defend-policy-api.html">Create an Elastic Defend policy using API »</a>
</span>
</div>
</body>
</html>
