<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Entity risk scoring requirements | Elastic Security [8.17] | Elastic</title>
<meta class="elastic" name="content" content="Entity risk scoring requirements | Elastic Security [8.17]">

<link rel="home" href="index.html" title="Elastic Security [8.17]"/>
<link rel="up" href="entity-risk-scoring.html" title="Entity risk scoring"/>
<link rel="prev" href="entity-risk-scoring.html" title="Entity risk scoring"/>
<link rel="next" href="turn-on-risk-engine.html" title="Turn on the risk scoring engine"/>
<meta class="elastic" name="product_version" content="8.17"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.17"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.17"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div class="navheader">
<span class="prev">
<a href="entity-risk-scoring.html">« Entity risk scoring</a>
</span>
<span class="next">
<a href="turn-on-risk-engine.html">Turn on the risk scoring engine »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security [8.17]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="advanced-entity-analytics-overview.html">Advanced Entity Analytics</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="entity-risk-scoring.html">Entity risk scoring</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Entity risk scoring requirements</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.17/docs/advanced-entity-analytics/ers-req.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div id="url-to-v3" class="version-warning">
    <strong>IMPORTANT</strong>: This documentation is no longer updated. Refer to <a href="https://www.elastic.co/support/eol">Elastic's version policy</a> and the <a href="https://www.elastic.co/docs/solutions/security/advanced-entity-analytics/entity-risk-scoring-requirements">latest documentation</a>.
</div>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="ers-requirements"></a>Entity risk scoring requirements</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.17/docs/advanced-entity-analytics/ers-req.asciidoc">edit</a></div>
</div></div></div>
<p>To use entity risk scoring, asset criticality, and entity store, your role must have certain cluster, index, and Kibana privileges. These features require a <a href="/pricing" class="ulink" target="_top">Platinum subscription</a> or higher.</p>
<p>This page covers the requirements and guidelines for using the entity risk scoring, asset criticality, and entity store features, as well as their known limitations.</p>
<div class="position-relative"><h4><a id="_entity_risk_scoring"></a>Entity risk scoring</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.17/docs/advanced-entity-analytics/ers-req.asciidoc">edit</a></div>
<div class="position-relative"><h5><a id="_privileges"></a>Privileges</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.17/docs/advanced-entity-analytics/ers-req.asciidoc">edit</a></div>
<p>To turn on the risk scoring engine, you need the following privileges:</p>
<div class="informaltable">
<table border="1" cellpadding="4px" width="100%">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Cluster</th>
<th align="left" valign="top">Index</th>
<th align="left" valign="top">Kibana</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top">
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">manage_index_templates</code>
</li>
<li class="listitem">
<code class="literal">manage_transform</code>
</li>
</ul>
</div>
</td>
<td align="left" valign="top"><p><code class="literal">all</code> privilege for <code class="literal">risk-score.risk-score-*</code></p></td>
<td align="left" valign="top"><p><span class="strong strong"><strong>Read</strong></span> for the <span class="strong strong"><strong>Security</strong></span> feature</p></td>
</tr>
</tbody>
</table>
</div>
<div class="position-relative"><h5><a id="_elasticsearch_resource_guidelines"></a>Elasticsearch resource guidelines</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.17/docs/advanced-entity-analytics/ers-req.asciidoc">edit</a></div>
<p>Follow these guidelines to ensure clusters have adequate memory to handle data volume:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
With 2GB of Java Virtual Machine (JVM) heap memory, the risk scoring engine can safely process around 44 million documents, or 30 days of risk data with an ingest rate of 1000 documents per minute.
</li>
<li class="listitem">
With 1GB of JVM heap, the risk scoring engine can safely process around 20 million documents, or 30 days of risk data with an ingest rate of around 450 documents per minute.
</li>
</ul>
</div>
<div class="position-relative"><h5><a id="_known_limitations"></a>Known limitations</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.17/docs/advanced-entity-analytics/ers-req.asciidoc">edit</a></div>
<p>The risk scoring engine uses an internal user role to score all hosts and users, and doesn&#8217;t respect privileges applied to custom users or roles. After you turn on the risk scoring engine for a Kibana space, all alerts in the space will contribute to host and user risk scores.</p>
<div class="position-relative"><h4><a id="_asset_criticality"></a>Asset criticality</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.17/docs/advanced-entity-analytics/ers-req.asciidoc">edit</a></div>
<div class="position-relative"><h5><a id="_privileges_2"></a>Privileges</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.17/docs/advanced-entity-analytics/ers-req.asciidoc">edit</a></div>
<p>To use asset criticality, you need the following privileges for the <code class="literal">.asset-criticality.asset-criticality-&lt;space-id&gt;</code> index:</p>
<div class="informaltable">
<table border="1" cellpadding="4px" width="100%">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Action</th>
<th align="left" valign="top">Index privilege</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>View asset criticality</p></td>
<td align="left" valign="top"><p><code class="literal">read</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>View, assign, or change asset criticality</p></td>
<td align="left" valign="top"><p><code class="literal">read</code> and <code class="literal">write</code></p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Unassign asset criticality</p></td>
<td align="left" valign="top"><p><code class="literal">delete</code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="position-relative"><h4><a id="_entity_store"></a>Entity store</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.17/docs/advanced-entity-analytics/ers-req.asciidoc">edit</a></div>
<div class="position-relative"><h5><a id="_privileges_3"></a>Privileges</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.17/docs/advanced-entity-analytics/ers-req.asciidoc">edit</a></div>
<p>To use the entity store, you need the following privileges:</p>
<div class="informaltable">
<table border="1" cellpadding="4px" width="100%">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Cluster</th>
<th align="left" valign="top">Index</th>
<th align="left" valign="top">Kibana</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top">
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">manage_enrich</code>
</li>
<li class="listitem">
<code class="literal">manage_index_templates</code>
</li>
<li class="listitem">
<code class="literal">manage_ingest_pipelines</code>
</li>
<li class="listitem">
<code class="literal">manage_transform</code>
</li>
</ul>
</div>
</td>
<td align="left" valign="top">
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">read</code> and <code class="literal">view_index_metadata</code> for <code class="literal">.asset-criticality.asset-criticality-*</code>
</li>
<li class="listitem">
<code class="literal">read</code> and <code class="literal">manage</code> for <code class="literal">risk-score.risk-score-*</code>
</li>
<li class="listitem">
<code class="literal">read</code> and <code class="literal">manage</code> for <code class="literal">.entities.v1.latest.*</code>
</li>
<li class="listitem">
<code class="literal">read</code> and <code class="literal">view_index_metadata</code> for all Elastic Security indices
</li>
</ul>
</div>
</td>
<td align="left" valign="top"><p><span class="strong strong"><strong>All</strong></span> for the <span class="strong strong"><strong>Security</strong></span> and <span class="strong strong"><strong>Saved Objects Management</strong></span> features</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="entity-risk-scoring.html">« Entity risk scoring</a>
</span>
<span class="next">
<a href="turn-on-risk-engine.html">Turn on the risk scoring engine »</a>
</span>
</div>
</body>
</html>
