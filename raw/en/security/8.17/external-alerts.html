<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>External Alerts | Elastic Security Solution [8.17] | Elastic</title>
<meta class="elastic" name="content" content="External Alerts | Elastic Security Solution [8.17]">

<link rel="home" href="index.html" title="Elastic Security Solution [8.17]"/>
<link rel="up" href="prebuilt-rules.html" title="Prebuilt rule reference"/>
<link rel="prev" href="exporting-exchange-mailbox-via-powershell.html" title="Exporting Exchange Mailbox via PowerShell"/>
<link rel="next" href="external-ip-lookup-from-non-browser-process.html" title="External IP Lookup from Non-Browser Process"/>
<meta class="elastic" name="product_version" content="8.17"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.17"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.17"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div class="navheader">
<span class="prev">
<a href="exporting-exchange-mailbox-via-powershell.html">« Exporting Exchange Mailbox via PowerShell</a>
</span>
<span class="next">
<a href="external-ip-lookup-from-non-browser-process.html">External IP Lookup from Non-Browser Process »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [8.17]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="detection-engine-overview.html">Detections and alerts</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="prebuilt-rules.html">Prebuilt rule reference</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>External Alerts</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.17/docs/detections/prebuilt-rules/rule-details/external-alerts.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div id="url-to-v3" class="version-warning">
    <strong>IMPORTANT</strong>: This documentation is no longer updated. Refer to <a href="https://www.elastic.co/support/eol">Elastic's version policy</a> and the <a href="https://www.elastic.co/docs/reference/security/prebuilt-rules/rules/promotions/external_alerts">latest documentation</a>.
</div>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="external-alerts"></a>External Alerts</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.17/docs/detections/prebuilt-rules/rule-details/external-alerts.asciidoc">edit</a></div>
</div></div></div>
<p>Generates a detection alert for each external alert written to the configured indices. Enabling this rule allows you to immediately begin investigating external alerts in the app.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
apm-<span class="strong strong"><strong>-transaction</strong></span>
</li>
<li class="listitem">
traces-apm*
</li>
<li class="listitem">
auditbeat-*
</li>
<li class="listitem">
filebeat-*
</li>
<li class="listitem">
logs-*
</li>
<li class="listitem">
packetbeat-*
</li>
<li class="listitem">
winlogbeat-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 1m</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-2m (<a href="/guide/en/elasticsearch/reference/8.17/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule" title="Set the rule&#8217;s schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum alerts per execution</strong></span>: 1000</p>
<p><span class="strong strong"><strong>References</strong></span>: None</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
OS: Windows
</li>
<li class="listitem">
Data Source: APM
</li>
<li class="listitem">
OS: macOS
</li>
<li class="listitem">
OS: Linux
</li>
<li class="listitem">
Resources: Investigation Guide
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 105</p>
<p><span class="strong strong"><strong>Rule authors</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Rule license</strong></span>: Elastic License v2</p>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_investigation_guide_338"></a>Investigation guide</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.17/docs/detections/prebuilt-rules/rule-details/external-alerts.asciidoc">edit</a></div>
</div></div></div>
<p><span class="strong strong"><strong>Triage and analysis</strong></span></p>
<div class="quoteblock">
<blockquote>
<p><span class="strong strong"><strong>Disclaimer</strong></span>:
This investigation guide was created using generative AI technology and has been reviewed to improve its accuracy and relevance. While every effort has been made to ensure its quality, we recommend validating the content and adapting it to suit your specific environment and operational needs.</p>
</blockquote>
</div>
<p><span class="strong strong"><strong>Investigating External Alerts</strong></span></p>
<p>External alerts are crucial for identifying potential threats across diverse environments like Windows, macOS, and Linux. These alerts are generated from various sources, excluding specific modules like endpoint or cloud defend, to focus on broader threat landscapes. Adversaries may exploit vulnerabilities in these systems to execute unauthorized actions. The <em>External Alerts</em> detection rule filters and highlights such activities by focusing on alert events, enabling analysts to swiftly investigate and mitigate risks.</p>
<p><span class="strong strong"><strong>Possible investigation steps</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Review the alert details to identify the specific event.kind:alert that triggered the detection, ensuring it is not associated with the excluded modules (endgame, endpoint, or cloud_defend).
</li>
<li class="listitem">
Examine the source and context of the alert by checking the associated tags, such as <em>OS: Windows</em>, <em>OS: macOS</em>, or <em>OS: Linux</em>, to understand the environment affected.
</li>
<li class="listitem">
Gather additional context by correlating the alert with other logs or events from the same time frame or system to identify any related suspicious activities.
</li>
<li class="listitem">
Assess the risk score and severity level to prioritize the investigation and determine the potential impact on the organization.
</li>
<li class="listitem">
Investigate the origin of the alert by identifying the source IP, user account, or process involved, and check for any known vulnerabilities or exploits associated with them.
</li>
<li class="listitem">
Consult threat intelligence sources to determine if the alert corresponds to any known threat actors or campaigns targeting similar environments.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>False positive analysis</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Alerts from benign third-party applications may trigger false positives. Review and identify these applications, then create exceptions to exclude them from future alerts.
</li>
<li class="listitem">
Routine system updates or patches can generate alerts. Monitor update schedules and create exceptions for known update activities to reduce noise.
</li>
<li class="listitem">
Network monitoring tools might produce alerts due to their scanning activities. Verify these tools and exclude their activities if deemed non-threatening.
</li>
<li class="listitem">
Alerts from internal security testing or penetration testing exercises can be mistaken for threats. Coordinate with security teams to whitelist these activities during scheduled tests.
</li>
<li class="listitem">
Certain administrative scripts or automation tasks may trigger alerts. Evaluate these scripts and exclude them if they are part of regular operations and pose no risk.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Response and remediation</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Isolate affected systems immediately to prevent further unauthorized actions and contain the threat.
</li>
<li class="listitem">
Conduct a thorough review of the alert details to identify any specific vulnerabilities or exploits used by the adversary.
</li>
<li class="listitem">
Apply relevant patches or updates to the affected systems to remediate any identified vulnerabilities.
</li>
<li class="listitem">
Restore systems from a known good backup if unauthorized changes or actions have been detected.
</li>
<li class="listitem">
Monitor network traffic and system logs closely for any signs of further suspicious activity or attempts to exploit similar vulnerabilities.
</li>
<li class="listitem">
Escalate the incident to the appropriate security team or management if the threat appears to be part of a larger attack campaign or if additional resources are needed for remediation.
</li>
<li class="listitem">
Enhance detection capabilities by updating security tools and configurations to better identify similar threats in the future.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_setup_209"></a>Setup</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.17/docs/detections/prebuilt-rules/rule-details/external-alerts.asciidoc">edit</a></div>
</div></div></div>
<p><span class="strong strong"><strong>Setup</strong></span></p>
<p><span class="strong strong"><strong>Additional notes</strong></span></p>
<p>For information on troubleshooting the maximum alerts warning please refer to this <a href="/guide/en/security/current/alerts-ui-monitor.html#troubleshoot-max-alerts" class="ulink" target="_top">guide</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_rule_query_356"></a>Rule query</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.17/docs/detections/prebuilt-rules/rule-details/external-alerts.asciidoc">edit</a></div>
</div></div></div>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">event.kind:alert and not event.module:(endgame or endpoint or cloud_defend)</pre>
</div>
</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="exporting-exchange-mailbox-via-powershell.html">« Exporting Exchange Mailbox via PowerShell</a>
</span>
<span class="next">
<a href="external-ip-lookup-from-non-browser-process.html">External IP Lookup from Non-Browser Process »</a>
</span>
</div>
</body>
</html>
