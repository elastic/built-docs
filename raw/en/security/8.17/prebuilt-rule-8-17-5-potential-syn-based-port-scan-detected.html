<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Potential SYN-Based Port Scan Detected | Elastic Security Solution [8.17] | Elastic</title>
<meta class="elastic" name="content" content="Potential SYN-Based Port Scan Detected | Elastic Security Solution [8.17]">

<link rel="home" href="index.html" title="Elastic Security Solution [8.17]"/>
<link rel="up" href="prebuilt-rule-8-17-5-prebuilt-rules-8-17-5-appendix.html" title="Appendix X: Downloadable rule update v8.17.5"/>
<link rel="prev" href="prebuilt-rule-8-17-5-potential-network-scan-detected.html" title="Potential Network Scan Detected"/>
<link rel="next" href="prebuilt-rule-8-17-5-execution-of-a-downloaded-windows-script.html" title="Execution of a Downloaded Windows Script"/>
<meta class="elastic" name="product_version" content="8.17"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.17"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.17"/>
</head>
<body>
<div class="navheader">
<span class="prev">
<a href="prebuilt-rule-8-17-5-potential-network-scan-detected.html">« Potential Network Scan Detected</a>
</span>
<span class="next">
<a href="prebuilt-rule-8-17-5-execution-of-a-downloaded-windows-script.html">Execution of a Downloaded Windows Script »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [8.17]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="prebuilt-rule-8-17-5-prebuilt-rules-8-17-5-appendix.html">Downloadable rule update v8.17.5</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Potential SYN-Based Port Scan Detected</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.17/docs/detections/prebuilt-rules/downloadable-packages/8-17-5/prebuilt-rule-8-17-5-potential-syn-based-port-scan-detected.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="prebuilt-rule-8-17-5-potential-syn-based-port-scan-detected"></a>Potential SYN-Based Port Scan Detected</h2><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.17/docs/detections/prebuilt-rules/downloadable-packages/8-17-5/prebuilt-rule-8-17-5-potential-syn-based-port-scan-detected.asciidoc">edit</a></div>
</div></div></div>
<p>This rule identifies a potential SYN-Based port scan. A SYN port scan is a technique employed by attackers to scan a target network for open ports by sending SYN packets to multiple ports and observing the response. Attackers use this method to identify potential entry points or services that may be vulnerable to exploitation, allowing them to launch targeted attacks or gain unauthorized access to the system or network, compromising its security and potentially leading to data breaches or further malicious activities. This rule proposes threshold logic to check for connection attempts from one source host to 250 or more destination ports using 2 or less packets per port.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: threshold</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
logs-network_traffic.*
</li>
<li class="listitem">
packetbeat-*
</li>
<li class="listitem">
filebeat-*
</li>
<li class="listitem">
logs-panw.panos*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5m</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-9m (<a href="/guide/en/elasticsearch/reference/8.17/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule" title="Set the rule&#8217;s schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum alerts per execution</strong></span>: 5</p>
<p><span class="strong strong"><strong>References</strong></span>: None</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Domain: Network
</li>
<li class="listitem">
Tactic: Discovery
</li>
<li class="listitem">
Tactic: Reconnaissance
</li>
<li class="listitem">
Use Case: Network Security Monitoring
</li>
<li class="listitem">
Data Source: PAN-OS
</li>
<li class="listitem">
Resources: Investigation Guide
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 10</p>
<p><span class="strong strong"><strong>Rule authors</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Rule license</strong></span>: Elastic License v2</p>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_investigation_guide_5182"></a>Investigation guide</h3><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.17/docs/detections/prebuilt-rules/downloadable-packages/8-17-5/prebuilt-rule-8-17-5-potential-syn-based-port-scan-detected.asciidoc">edit</a></div>
</div></div></div>
<p><span class="strong strong"><strong>Triage and analysis</strong></span></p>
<div class="quoteblock">
<blockquote>
<p><span class="strong strong"><strong>Disclaimer</strong></span>:
This investigation guide was created using generative AI technology and has been reviewed to improve its accuracy and relevance. While every effort has been made to ensure its quality, we recommend validating the content and adapting it to suit your specific environment and operational needs.</p>
</blockquote>
</div>
<p><span class="strong strong"><strong>Investigating Potential SYN-Based Port Scan Detected</strong></span></p>
<p>SYN-based port scanning is a reconnaissance technique where attackers send SYN packets to multiple ports to identify open services. This method helps adversaries map network vulnerabilities for potential exploitation. The detection rule identifies such scans by flagging connection attempts from internal IPs to multiple ports with minimal packet exchange, indicating a low-risk reconnaissance activity.</p>
<p><span class="strong strong"><strong>Possible investigation steps</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Review the source IP address involved in the alert to determine if it belongs to a known or authorized device within the network. Check for any recent changes or unusual activity associated with this IP.
</li>
<li class="listitem">
Analyze the destination ports targeted by the scan to identify any patterns or specific services that may be of interest to the attacker. Determine if these ports are associated with critical or vulnerable services.
</li>
<li class="listitem">
Examine historical logs to identify any previous scanning activity from the same source IP or similar patterns of behavior. This can help establish whether the activity is part of a larger reconnaissance effort.
</li>
<li class="listitem">
Correlate the alert with other security events or alerts to assess if there is a broader attack campaign underway. Look for related alerts that might indicate subsequent exploitation attempts.
</li>
<li class="listitem">
Investigate the timing and frequency of the scan attempts to understand if they coincide with other suspicious activities or known attack windows. This can provide context on the attacker&#8217;s intent and urgency.
</li>
<li class="listitem">
Assess the network&#8217;s current security posture and ensure that appropriate defenses, such as firewalls and intrusion detection systems, are configured to mitigate potential exploitation of identified open ports.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>False positive analysis</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Internal network scanning tools or scripts used by IT teams for legitimate network mapping can trigger this rule. To manage this, create exceptions for known internal IP addresses or subnets used by IT for network discovery.
</li>
<li class="listitem">
Automated monitoring systems or security appliances that perform regular port checks might be flagged. Identify these systems and exclude their IP addresses from the rule to prevent false positives.
</li>
<li class="listitem">
Software updates or patch management systems that check multiple ports for service availability can be mistaken for a SYN-based port scan. Whitelist these systems to avoid unnecessary alerts.
</li>
<li class="listitem">
Load balancers or network devices that perform health checks across multiple ports may trigger the rule. Exclude these devices from the rule to ensure accurate detection.
</li>
<li class="listitem">
Development or testing environments where multiple port scans are part of routine operations can cause false positives. Implement exceptions for these environments to maintain focus on genuine threats.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Response and remediation</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Isolate the affected internal IP address to prevent further reconnaissance or potential exploitation of identified open ports.
</li>
<li class="listitem">
Conduct a thorough review of firewall and network access control lists to ensure that only necessary ports are open and accessible from internal networks.
</li>
<li class="listitem">
Implement rate limiting on SYN packets to reduce the risk of successful port scanning and reconnaissance activities.
</li>
<li class="listitem">
Monitor the network for any unusual outbound traffic from the affected IP address, which may indicate further malicious activity or data exfiltration attempts.
</li>
<li class="listitem">
Escalate the incident to the security operations team for further analysis and to determine if additional network segments or systems are affected.
</li>
<li class="listitem">
Update intrusion detection and prevention systems to enhance detection capabilities for similar SYN-based port scanning activities.
</li>
<li class="listitem">
Review and update network segmentation policies to limit the exposure of critical services and systems to internal reconnaissance activities.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_rule_query_6136"></a>Rule query</h3><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.17/docs/detections/prebuilt-rules/downloadable-packages/8-17-5/prebuilt-rule-8-17-5-potential-syn-based-port-scan-detected.asciidoc">edit</a></div>
</div></div></div>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">event.action:network_flow and destination.port:* and network.packets &lt;= 2 and source.ip:(10.0.0.0/8 or 172.16.0.0/12 or 192.168.0.0/16)</pre>
</div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Discovery
</li>
<li class="listitem">
ID: TA0007
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0007/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0007/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Network Service Discovery
</li>
<li class="listitem">
ID: T1046
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1046/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1046/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Reconnaissance
</li>
<li class="listitem">
ID: TA0043
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0043/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0043/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Active Scanning
</li>
<li class="listitem">
ID: T1595
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1595/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1595/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Sub-technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Scanning IP Blocks
</li>
<li class="listitem">
ID: T1595.001
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1595/001/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1595/001/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="prebuilt-rule-8-17-5-potential-network-scan-detected.html">« Potential Network Scan Detected</a>
</span>
<span class="next">
<a href="prebuilt-rule-8-17-5-execution-of-a-downloaded-windows-script.html">Execution of a Downloaded Windows Script »</a>
</span>
</div>
</body>
</html>
