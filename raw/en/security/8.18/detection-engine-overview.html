<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Detections and alerts | Elastic Security Solution [8.18] | Elastic</title>
<meta class="elastic" name="content" content="Detections and alerts | Elastic Security Solution [8.18]">

<link rel="home" href="index.html" title="Elastic Security Solution [8.18]"/>
<link rel="up" href="index.html" title="Elastic Security Solution [8.18]"/>
<link rel="prev" href="esql-queries-assistant.html" title="Generate, customize, and learn about ES|QL queries"/>
<link rel="next" href="detections-permissions-section.html" title="Detections requirements"/>
<meta class="elastic" name="product_version" content="8.18"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.18"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.18"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
This documentation contains work-in-progress information for future Elastic Stack and Cloud releases. Use the version selector to view supported release docs. It also contains some Elastic Cloud serverless information. Check out our <a href="https://www.elastic.co/docs/current/serverless">serverless docs</a> for more details.
</div>
<div class="navheader">
<span class="prev">
<a href="esql-queries-assistant.html">« Generate, customize, and learn about ES|QL queries</a>
</span>
<span class="next">
<a href="detections-permissions-section.html">Detections requirements »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [8.18]</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Detections and alerts</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.18/docs/detections/detection-engine-intro.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="part xpack">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="detection-engine-overview"></a>Detections and alerts</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.18/docs/detections/detection-engine-intro.asciidoc">edit</a></div>
</div></div></div>
<div class="openblock partintro">
<div class="content">
<p>Use the detection engine to create and manage rules and view the alerts
these rules create. Rules periodically search indices (such as <code class="literal">logs-*</code> and
<code class="literal">filebeat-*</code>) for suspicious source events and create alerts when a rule&#8217;s
conditions are met. When an alert is created, its status is <code class="literal">Open</code>. To help
track investigations, an alert&#8217;s <a class="xref" href="alerts-ui-manage.html#detection-alert-status" title="Change an alert&#8217;s status">status</a> can be set as
<code class="literal">Open</code>, <code class="literal">Acknowledged</code>, or <code class="literal">Closed</code>.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/alert-page.png" alt="Alerts page">
</div>
</div>
<p>In addition to creating <a class="xref" href="rules-ui-create.html" title="Create a detection rule">your own rules</a>, enable
<a class="xref" href="prebuilt-rules-management.html#load-prebuilt-rules" title="Install and enable Elastic prebuilt rules">Elastic prebuilt rules</a> to immediately start detecting
suspicious activity. For detailed information on all the prebuilt rules, see the
<a class="xref" href="prebuilt-rules.html" title="Prebuilt rule reference"><em>Prebuilt rule reference</em></a> section. Once the prebuilt rules are loaded and
running, <a class="xref" href="tuning-detection-signals.html" title="Tune detection rules"><em>Tune detection rules</em></a> and <a class="xref" href="add-exceptions.html" title="Add and manage exceptions">Add and manage exceptions</a> explain
how to modify the rules to reduce false positives and get a better set of
actionable alerts. You can also use exceptions and value lists when creating or
modifying your own rules.</p>
<p>There are several special prebuilt rules you need to know about:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="endpoint-protection-rules.html" title="Endpoint protection rules"><span class="strong strong"><strong>Endpoint protection rules</strong></span></a>: Automatically create alerts based on Elastic Defend&#8217;s threat monitoring and prevention.
</li>
<li class="listitem">
<a class="xref" href="external-alerts.html" title="External Alerts"><span class="strong strong"><strong>External Alerts</strong></span></a>: Automatically creates an alert for
all incoming third-party system alerts (for example, Suricata alerts).
</li>
</ul>
</div>
<p>If you want to receive notifications via external systems, such as Slack or
email, when alerts are created, use the Kibana
<a href="/guide/en/kibana/8.18/alerting-getting-started.html" class="ulink" target="_top">Alerting and Actions</a> framework.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>To use Kibana Alerting for detection alert notifications, you need the
<a href="/subscriptions" class="ulink" target="_top">appropriate license</a>.</p>
</div>
</div>
<p>After rules have started running, you can monitor their executions to verify
they are functioning correctly, as well as view, manage, and troubleshoot
alerts (see <a class="xref" href="alerts-ui-manage.html" title="Manage detection alerts"><em>Manage detection alerts</em></a> and <a class="xref" href="alerts-ui-monitor.html" title="Monitor and troubleshoot rule executions"><em>Monitor and troubleshoot rule executions</em></a>).</p>
<p>You can create and manage rules and alerts via the UI or the
<a class="xref" href="rule-api-overview.html" title="Detections API">Detections API</a>.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>To make sure you can access Detections and manage rules, see
<a class="xref" href="detections-permissions-section.html" title="Detections requirements"><em>Detections requirements</em></a>.</p>
</div>
</div>
<div class="position-relative"><h2><a id="cold-tier-detections"></a>Manage data in cold and frozen tiers</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.18/docs/detections/detection-engine-intro.asciidoc">edit</a></div>
<p>Cold <a href="/guide/en/elasticsearch/reference/8.18/data-tiers.html" class="ulink" target="_top">data tiers</a> store time series data that&#8217;s accessed infrequently and rarely updated, while frozen data tiers hold time series data that&#8217;s accessed even less frequently and never updated. If you&#8217;re automating searches across different data tiers using rules, consider the following best practices and limitations.</p>
<div class="position-relative"><h3><a id="best-practices-data-tiers"></a>Best practices</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.18/docs/detections/detection-engine-intro.asciidoc">edit</a></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Retention in hot tier</strong></span>: We recommend keeping data in the hot data tier (Index lifecycle management hot phase) for at least 24 hours. Index lifecycle management policies that move ingested data from the hot phase to another phase (for example, cold or frozen) in less than 24 hours may cause performance issues and/or rule execution errors.
</li>
<li class="listitem">
<span class="strong strong"><strong>Replicas for mission-critical data</strong></span>: Your data should have replicas if it must be highly available. Since frozen tiers don&#8217;t support replicas, shard unavailability can cause partial rule run failures if rules query frozen tiers. Shard unavailability may also occur during or after Elastic Stack upgrades. If this happens, you can <a class="xref" href="rules-ui-management.html#manually-run-rules" title="Run rules manually">manually rerun</a> rules over the affected time period once the shards are available.
</li>
</ul>
</div>
<div class="position-relative"><h3><a id="limitations-data-tiers"></a>Limitations</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.18/docs/detections/detection-engine-intro.asciidoc">edit</a></div>
<p>Data tiers are a powerful and useful tool. When using them, keep the following in mind:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
To avoid rule failures, do not modify index lifecycle management policies for Elastic Security-controlled indices, such as alert and list indices.
</li>
<li class="listitem">
Source data must have an index lifecycle management policy that keeps it in the hot or warm tiers for at least 24 hours before moving to cold or frozen tiers.
</li>
</ul>
</div>
<div class="position-relative"><h2><a id="support-indicator-rules"></a>Limited support for indicator match rules</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.18/docs/detections/detection-engine-intro.asciidoc">edit</a></div>
<p>Indicator match rules provide a powerful capability to search your security data; however, their queries can consume significant deployment resources. When creating an <a class="xref" href="rules-ui-create.html#create-indicator-rule" title="Create an indicator match rule">indicator match rule</a>, we recommend limiting the time range of the indicator index query to the minimum period necessary for the desired rule coverage. For example, the default indicator index query <code class="literal">@timestamp &gt; "now-30d/d"</code> searches specified indicator indices for indicators ingested during the past 30 days and rounds the query start time down to the nearest day (resolves to UTC <code class="literal">00:00:00</code>). Without this limitation, the rule will include all of the indicators in your indicator indices, which may extend the time it takes for the indicator index query to complete.</p>
<p>In addition, the following support restrictions are in place:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Indicator match rules don&#8217;t support cold or frozen data. Cold or frozen data in indices queried by indicator match rules must be older than the time range queried by the rule. If your data&#8217;s timestamps are unreliable, you can exclude cold and frozen tier data using a <a class="xref" href="exclude-cold-frozen-data-individual-rules.html" title="Exclude cold and frozen data from individual rules">Query DSL filter</a>.
</li>
<li class="listitem">
Indicator match rules with an additional look-back time value greater than 24 hours are not supported.
</li>
</ul>
</div>
<div class="position-relative"><h2><a id="detections-permissions"></a>Detections configuration and index privilege prerequisites</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.18/docs/detections/detection-engine-intro.asciidoc">edit</a></div>
<p><a class="xref" href="detections-permissions-section.html" title="Detections requirements"><em>Detections requirements</em></a> provides detailed information on all the
permissions required to initiate and use the Detections feature.</p>
<div class="position-relative"><h2><a id="_resolve_ui_error_messages"></a>Resolve UI error messages</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.18/docs/detections/detection-engine-intro.asciidoc">edit</a></div>
<p>Depending on your privileges and whether detection system indices have already
been created for the Kibana space, you might get one of these error messages when you
open the <span class="strong strong"><strong>Alerts</strong></span> or <span class="strong strong"><strong>Rules</strong></span> page:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p><span class="strong strong"><strong><code class="literal">Let’s set up your detection engine</code></strong></span></p>
<p>If you get this message, a user with specific privileges must visit the
<span class="strong strong"><strong>Alerts</strong></span> or <span class="strong strong"><strong>Rules</strong></span> page before you can view detection alerts and rules.
Refer to <a class="xref" href="detections-permissions-section.html#enable-detections-ui" title="Enable and access detections">Enable and access detections</a> for a list of all the requirements.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>For <span class="strong strong"><strong>self-managed</strong></span> Elastic Stack deployments only, this message may be displayed
when the
<a class="xref" href="detection-engine-overview.html#detections-permissions" title="Detections configuration and index privilege prerequisites"><code class="literal">xpack.encryptedSavedObjects.encryptionKey</code></a>
setting has not been added to the <code class="literal">kibana.yml</code> file. For more information, refer to <a class="xref" href="detections-permissions-section.html#detections-on-prem-requirements" title="Configure self-managed Elastic Stack deployments">Configure self-managed Elastic Stack deployments</a>.</p>
</div>
</div>
</li>
<li class="listitem">
<p><span class="strong strong"><strong><code class="literal">Detection engine permissions required</code></strong></span></p>
<p>If you get this message, you do not have the
<a class="xref" href="detection-engine-overview.html#detections-permissions" title="Detections configuration and index privilege prerequisites">required privileges</a> to view the <span class="strong strong"><strong>Detections</strong></span> feature,
and you should contact your Kibana administrator.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>For <span class="strong strong"><strong>self-managed</strong></span> Elastic Stack deployments only, this message may be
displayed when the <a class="xref" href="detection-engine-overview.html#detections-permissions" title="Detections configuration and index privilege prerequisites"><code class="literal">xpack.security.enabled</code></a>
setting is not enabled in the <code class="literal">elasticsearch.yml</code> file. For more information, refer to <a class="xref" href="detections-permissions-section.html#detections-on-prem-requirements" title="Configure self-managed Elastic Stack deployments">Configure self-managed Elastic Stack deployments</a>.</p>
</div>
</div>
</li>
</ul>
</div>
<div class="position-relative"><h2><a id="detections-logsdb-index-mode"></a>Using logsdb index mode</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.18/docs/detections/detection-engine-intro.asciidoc">edit</a></div>
<p>To learn how your rules and alerts are affected by using the <a href="/guide/en/elasticsearch/reference/8.18/logs-data-stream.html" class="ulink" target="_top">logsdb index mode</a>, refer to <a class="xref" href="detections-logsdb-index-mode-impact.html" title="Using logsdb index mode with Elastic Security"><em>Using logsdb index mode with Elastic Security</em></a>.</p>
<div class="position-relative"><h2><a id="manage-rule-dac"></a>Manage rules as code</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.18/docs/detections/detection-engine-intro.asciidoc">edit</a></div>
<p>Utilize the <a href="https://dac-reference.readthedocs.io/en/latest/dac_concept_and_workflows.html" class="ulink" target="_top">Detection-as-Code</a> (DaC) principles to externally manage your detection rules.</p>
<p>The Elastic Security Labs team uses the <a href="https://github.com/elastic/detection-rules" class="ulink" target="_top">detection-rules</a> repo to develop, test, and release Elastic Security&#8217;s <a class="xref" href="prebuilt-rules.html" title="Prebuilt rule reference">prebuilt rules</a>. The repo provides DaC features and allows you to customize settings to simplify the setup for managing user rules with the DaCe pipeline.</p>
<p>To get started, refer to the <a href="https://github.com/elastic/detection-rules/blob/main/README.md#detections-as-code-dac" class="ulink" target="_top">DaC documentation</a>.</p>
</div>
</div>
















</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="esql-queries-assistant.html">« Generate, customize, and learn about ES|QL queries</a>
</span>
<span class="next">
<a href="detections-permissions-section.html">Detections requirements »</a>
</span>
</div>
</body>
</html>
