<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Detections requirements | Elastic Security [8.18] | Elastic</title>
<meta class="elastic" name="content" content="Detections requirements | Elastic Security [8.18]">

<link rel="home" href="index.html" title="Elastic Security [8.18]"/>
<link rel="up" href="detection-engine-overview.html" title="Detections and alerts"/>
<link rel="prev" href="detection-engine-overview.html" title="Detections and alerts"/>
<link rel="next" href="detections-logsdb-index-mode-impact.html" title="Using logsdb index mode with Elastic Security"/>
<meta class="elastic" name="product_version" content="8.18"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.18"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.18"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div class="navheader">
<span class="prev">
<a href="detection-engine-overview.html">« Detections and alerts</a>
</span>
<span class="next">
<a href="detections-logsdb-index-mode-impact.html">Using logsdb index mode with Elastic Security »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security [8.18]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="detection-engine-overview.html">Detections and alerts</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Detections requirements</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.18/docs/detections/detections-req.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div id="url-to-v3" class="version-warning">
    A newer version is available. Check out the <a href="https://www.elastic.co/docs/solutions/security/detect-and-alert/detections-requirements">latest documentation</a>.
</div>
<div class="chapter">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="detections-permissions-section"></a>Detections requirements</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.18/docs/detections/detections-req.asciidoc">edit</a></div>
</div></div></div>
<p>To use the <a class="xref" href="detection-engine-overview.html" title="Detections and alerts">Detections feature</a>, you first need to
configure a few settings. You also need the <a href="/subscriptions" class="ulink" target="_top">appropriate license</a> to send
<a class="xref" href="rules-ui-create.html#rule-notifications" title="Set up rule actions (optional)">notifications</a> when detection alerts are generated.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Several steps are <span class="strong strong"><strong>only</strong></span> required for <span class="strong strong"><strong>self-managed</strong></span> Elastic Stack
deployments. If you&#8217;re using an Elastic Cloud deployment, you only need to
<a class="xref" href="detections-permissions-section.html#enable-detections-ui" title="Enable and access detections">enable detections</a>.</p>
</div>
</div>
<p>Additionally, there are some <a class="xref" href="detections-permissions-section.html#adv-list-settings" title="Configure list upload limits">advanced settings</a> used to
configure Kibana <a class="xref" href="value-lists-exceptions.html" title="Create and manage value lists">value list</a> upload limits.</p>
<div class="position-relative"><h3><a id="detections-on-prem-requirements"></a>Configure self-managed Elastic Stack deployments</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.18/docs/detections/detections-req.asciidoc">edit</a></div>
<p>These steps are only required for <span class="strong strong"><strong>self-managed</strong></span> deployments:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
HTTPS must be configured for communication between
<a href="/guide/en/kibana/8.18/configuring-tls.html#configuring-tls-kib-es" class="ulink" target="_top">Elasticsearch and Kibana</a>.
</li>
<li class="listitem">
<p>In the <code class="literal">kibana.yml</code> <a href="/guide/en/kibana/8.18/settings.html" class="ulink" target="_top">configuration file</a>, add the
<code class="literal">xpack.encryptedSavedObjects.encryptionKey</code> setting with any alphanumeric value
of at least 32 characters. For example:</p>
<p><code class="literal">xpack.encryptedSavedObjects.encryptionKey: 'fhjskloppd678ehkdfdlliverpoolfcr'</code></p>
</li>
<li class="listitem">
<p>In the <code class="literal">elasticsearch.yml</code> <a href="/guide/en/elasticsearch/reference/8.18/settings.html" class="ulink" target="_top">configuration</a> file:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Set the <code class="literal">xpack.security.enabled</code> setting to <code class="literal">true</code>. For more information, refer to <a href="/guide/en/elasticsearch/reference/8.18/security-settings.html" class="ulink" target="_top">general security settings in Elasticsearch</a>.
</li>
<li class="listitem">
If the <code class="literal">search.allow_expensive_queries</code> setting is set to <code class="literal">false</code>, remove it. If set to its default value of <code class="literal">true</code> or not included in the file, you don&#8217;t need to change it. This setting must be <code class="literal">true</code> for key detection features, such as <a href="/guide/en/kibana/8.18/alerting-getting-started.html#_rules" class="ulink" target="_top">alerting rules</a> and rule exceptions, to work.
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>After changing the <code class="literal">xpack.encryptedSavedObjects.encryptionKey</code> value
and restarting Kibana, you must restart all detection rules.</p>
</div>
</div>
<div class="position-relative"><h3><a id="enable-detections-ui"></a>Enable and access detections</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.18/docs/detections/detections-req.asciidoc">edit</a></div>
<p>To use the Detections feature, it must be enabled, your role must have access to rules and alerts, and your Kibana space must have <span class="strong strong"><strong>Data View Management</strong></span> <a href="/guide/en/kibana/8.18/xpack-spaces.html#spaces-control-feature-visibility" class="ulink" target="_top">feature visibility</a>. If your role doesn&#8217;t have the cluster and index privileges needed to enable this feature, you can request someone who has these privileges to visit your Kibana space, which will turn it on for you.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>For instructions about using machine learning jobs and rules, refer to <a class="xref" href="ml-requirements.html" title="Machine learning job and rule requirements">Machine learning job and rule requirements</a>.</p>
</div>
</div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>In Elastic Stack version 8.0.0, the <code class="literal">.siem-signals-&lt;space-id&gt;</code> index was renamed to <code class="literal">.alerts-security.alerts-&lt;space-id&gt;</code>. Detection alert indices are created for each Kibana space. For the default space, the alerts index is
named <code class="literal">.alerts-security.alerts-default</code>. If you&#8217;re upgrading to 8.0.0 or later, users should have privileges for the <code class="literal">.alerts-security.alerts-&lt;space-id&gt;</code> AND <code class="literal">.siem-signals-&lt;space-id&gt;</code> indices. If you&#8217;re newly installing the Elastic Stack, then users do not need privileges for the <code class="literal">.siem-signals-&lt;space-id&gt;</code> index.</p>
</div>
</div>
<p>The following table describes the required privileges to access the Detections feature, including rules and alerts. For more information on Kibana privileges, refer to <a href="/guide/en/kibana/8.18/xpack-spaces.html#spaces-control-user-access" class="ulink" target="_top">Feature access based on user privileges</a>.</p>
<div class="informaltable">
<table border="1" cellpadding="4px" width="100%">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Action</th>
<th align="left" valign="top">Cluster Privileges</th>
<th align="left" valign="top">Index Privileges</th>
<th align="left" valign="top">Kibana Privileges</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>Enable detections in your space</p></td>
<td align="left" valign="top"><p><code class="literal">manage</code></p></td>
<td align="left" valign="top">
<p><code class="literal">manage</code>, <code class="literal">write</code>, <code class="literal">read</code>, and <code class="literal">view_index_metadata</code> for these system indices and data streams, where <code class="literal">&lt;space-id&gt;</code> is the space name:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">.alerts-security.alerts-&lt;space-id&gt;</code>
</li>
<li class="listitem">
<code class="literal">.siem-signals-&lt;space-id&gt;</code> <sup>1</sup>
</li>
<li class="listitem">
<code class="literal">.lists-&lt;space-id&gt;</code>
</li>
<li class="listitem">
<code class="literal">.items-&lt;space-id&gt;</code>
</li>
</ul>
</div>
<p><sup>1</sup> <span class="strong strong"><strong>NOTE</strong></span>: If you&#8217;re upgrading to Elastic Stack 8.0.0 or later, users should have privileges for the <code class="literal">.alerts-security.alerts-&lt;space-id&gt;</code> AND <code class="literal">.siem-signals-&lt;space-id&gt;</code> indices. If you&#8217;re newly installing the Elastic Stack, then users do not need privileges for the <code class="literal">.siem-signals-&lt;space-id&gt;</code> index.</p>
</td>
<td align="left" valign="top"><p><code class="literal">All</code> for the <code class="literal">Security</code> feature</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Enable detections in all spaces</p>
<p><span class="strong strong"><strong>NOTE</strong></span>: To turn on detections, visit the Rules and Alerts pages for each space.</p></td>
<td align="left" valign="top"><p><code class="literal">manage</code></p></td>
<td align="left" valign="top">
<p><code class="literal">manage</code>, <code class="literal">write</code>, <code class="literal">read</code>, and <code class="literal">view_index_metadata</code> for these system indices and data streams:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">.alerts-security.alerts-&lt;space-id&gt;</code>
</li>
<li class="listitem">
<code class="literal">.siem-signals-&lt;space-id&gt;</code> <sup>1</sup>
</li>
<li class="listitem">
<code class="literal">.lists-&lt;space-id&gt;</code>
</li>
<li class="listitem">
<code class="literal">.items-&lt;space-id&gt;</code>
</li>
</ul>
</div>
<p><sup>1</sup> <span class="strong strong"><strong>NOTE</strong></span>: If you&#8217;re upgrading to Elastic Stack 8.0.0 or later, users should have privileges for the <code class="literal">.alerts-security.alerts-&lt;space-id&gt;</code> AND <code class="literal">.siem-signals-&lt;space-id&gt;</code> indices. If you&#8217;re newly installing the Elastic Stack, then users do not need privileges for the <code class="literal">.siem-signals-&lt;space-id&gt;</code> index.</p>
</td>
<td align="left" valign="top"><p><code class="literal">All</code> for the <code class="literal">Security</code> feature</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Preview rules</p></td>
<td align="left" valign="top"><p>N/A</p></td>
<td align="left" valign="top">
<p><code class="literal">read</code> for these indices:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">.preview.alerts-security.alerts-&lt;space-id&gt;</code>
</li>
<li class="listitem">
<code class="literal">.internal.preview.alerts-security.alerts-&lt;space-id&gt;-*</code>
</li>
</ul>
</div>
</td>
<td align="left" valign="top"><p><code class="literal">All</code> for the <code class="literal">Security</code> feature</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Manage rules</p></td>
<td align="left" valign="top"><p>N/A</p></td>
<td align="left" valign="top">
<p><code class="literal">manage</code>, <code class="literal">write</code>, <code class="literal">read</code>, and <code class="literal">view_index_metadata</code> for these system indices and data streams, where <code class="literal">&lt;space-id&gt;</code> is the space name:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">.alerts-security.alerts-&lt;space-id</code>
</li>
<li class="listitem">
<code class="literal">.siem-signals-&lt;space-id&gt;</code><sup>1</sup>
</li>
<li class="listitem">
<code class="literal">.lists-&lt;space-id&gt;</code>
</li>
<li class="listitem">
<code class="literal">.items-&lt;space-id&gt;</code>
</li>
</ul>
</div>
<p><sup>1</sup> <span class="strong strong"><strong>NOTE</strong></span>: If you&#8217;re upgrading to Elastic Stack 8.0.0 or later, users should have privileges for the <code class="literal">.alerts-security.alerts-&lt;space-id&gt;</code> AND <code class="literal">.siem-signals-&lt;space-id&gt;</code> indices. If you&#8217;re newly installing the Elastic Stack, then users do not need privileges for the <code class="literal">.siem-signals-&lt;space-id&gt;</code> index.</p>
</td>
<td align="left" valign="top">
<p><code class="literal">All</code> for the <code class="literal">Security</code> feature</p>
<p><span class="strong strong"><strong>NOTE:</strong></span> You need additional <code class="literal">Action and Connectors</code> feature privileges (<span class="strong strong"><strong>Management → Action and Connectors</strong></span>) to manage rules with actions and connectors:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
To provide full access to rule actions and connectors, give your role <code class="literal">All</code> privileges. With <code class="literal">Read</code> privileges, you can edit rule actions, but will have limited capabilities to manage connectors. For example, <code class="literal">Read</code> privileges allow you to add or remove an existing connector from a rule, but does not allow you to create a new connector.
</li>
<li class="listitem">
To import rules with actions, you need at least <code class="literal">Read</code> privileges for the <code class="literal">Action and Connectors</code> feature. To overwrite or add new connectors, you need <code class="literal">All</code> privileges for the <code class="literal">Actions and Connectors</code> feature. To import rules without actions,  you don&#8217;t need <code class="literal">Actions and Connectors</code> privileges.
</li>
</ul>
</div>
</td>
</tr>
<tr>
<td align="left" valign="top"><p>Manage alerts</p>
<p><span class="strong strong"><strong>NOTE</strong></span>: Allows you to manage alerts, but not modify rules.</p></td>
<td align="left" valign="top"><p>N/A</p></td>
<td align="left" valign="top">
<p><code class="literal">maintenance</code>, <code class="literal">write</code>, <code class="literal">read</code>, and <code class="literal">view_index_metadata</code> for these system indices and data streams, where <code class="literal">&lt;space-id&gt;</code> is the space name:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">.alerts-security.alerts-&lt;space-id&gt;</code>
</li>
<li class="listitem">
<code class="literal">.internal.alerts-security.alerts-&lt;space-id&gt;-*</code>
</li>
<li class="listitem">
<code class="literal">.siem-signals-&lt;space-id&gt;</code><sup>1</sup>
</li>
<li class="listitem">
<code class="literal">.lists-&lt;space-id&gt;</code>
</li>
<li class="listitem">
<code class="literal">.items-&lt;space-id&gt;</code>
</li>
</ul>
</div>
<p><sup>1</sup> <span class="strong strong"><strong>NOTE</strong></span>: If you&#8217;re upgrading to Elastic Stack 8.0.0 or later, users should have privileges for the <code class="literal">.alerts-security.alerts-&lt;space-id&gt;</code> AND <code class="literal">.siem-signals-&lt;space-id&gt;</code> indices. If you&#8217;re newly installing the Elastic Stack, then users do not need privileges for the <code class="literal">.siem-signals-&lt;space-id&gt;</code> index.</p>
</td>
<td align="left" valign="top"><p><code class="literal">Read</code> for the <code class="literal">Security</code> feature</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Create the <code class="literal">.lists</code> and <code class="literal">.items</code> data streams in your space</p>
<p><span class="strong strong"><strong>NOTE</strong></span>: To initiate the process that creates the data streams, you must visit the Rules page for each appropriate space.</p></td>
<td align="left" valign="top"><p><code class="literal">manage</code></p></td>
<td align="left" valign="top">
<p><code class="literal">manage</code>, <code class="literal">write</code>, <code class="literal">read</code>, and <code class="literal">view_index_metadata</code> for these data streams, where <code class="literal">&lt;space-id&gt;</code> is the space name:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">.lists-&lt;space-id&gt;</code>
</li>
<li class="listitem">
<code class="literal">.items-&lt;space-id&gt;</code>
</li>
</ul>
</div>
</td>
<td align="left" valign="top"><p><code class="literal">All</code> for the <code class="literal">Security</code> and <code class="literal">Saved Objects Management</code> features</p></td>
</tr>
</tbody>
</table>
</div>
<p>Here is an example of a user who has the Detections feature enabled in all Kibana spaces:</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/sec-admin-user.png" alt="Shows user with the Detections feature enabled in all Kibana spaces">
</div>
</div>
<div class="position-relative"><h4><a id="alerting-auth-model"></a>Authorization</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.18/docs/detections/detections-req.asciidoc">edit</a></div>
<p>Rules, including all background detection and the actions they generate, are authorized using an <a href="/guide/en/kibana/8.18/api-keys.html" class="ulink" target="_top">API key</a> associated with the last user to edit the rule. Upon creating or modifying a rule, an API key is generated for that user, capturing a snapshot of their privileges. The API key is then used to run all background tasks associated with the rule including detection checks and executing actions.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>If a rule requires certain privileges to run, such as index privileges, keep in mind that if a user without those privileges updates the rule, the rule will no longer function.</p>
</div>
</div>
<div class="position-relative"><h3><a id="adv-list-settings"></a>Configure list upload limits</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.18/docs/detections/detections-req.asciidoc">edit</a></div>
<p>You can set limits to the number of bytes and the buffer size used to upload
<a class="xref" href="value-lists-exceptions.html" title="Create and manage value lists">value lists</a> to Elastic Security.</p>
<p>To set the value:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Open <code class="literal">kibana.yml</code> <a href="/guide/en/kibana/8.18/settings.html" class="ulink" target="_top">configuration file</a> or edit your
Kibana cloud instance.
</li>
<li class="listitem">
<p>Add any of these settings and their required values:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p><code class="literal">xpack.lists.maxImportPayloadBytes</code>: Sets the number of bytes allowed for
uploading Elastic Security value lists (default <code class="literal">9000000</code>, maximum
<code class="literal">100000000</code>). For every 10 megabytes, it is recommended to have an additional 1
gigabyte of RAM reserved for Kibana.</p>
<p>For example, on a Kibana instance with 2 gigabytes of RAM, you can set this value up
to 20000000 (20 megabytes).</p>
</li>
<li class="listitem">
<code class="literal">xpack.lists.importBufferSize</code>: Sets the buffer size used for uploading
Elastic Security value lists (default <code class="literal">1000</code>). Change the value if you&#8217;re
experiencing slow upload speeds or larger than wanted memory usage when
uploading value lists. Set to a higher value to increase throughput at the
expense of using more Kibana memory, or a lower value to decrease throughput and
reduce memory usage.
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>For information on how to configure Elastic Cloud deployments, refer to
<a href="/guide/en/cloud/current/ec-manage-kibana-settings.html" class="ulink" target="_top">Add Kibana user settings</a>.</p>
</div>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="detection-engine-overview.html">« Detections and alerts</a>
</span>
<span class="next">
<a href="detections-logsdb-index-mode-impact.html">Using logsdb index mode with Elastic Security »</a>
</span>
</div>
</body>
</html>
