<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Microsoft Entra ID Elevated Access to User Access Administrator | Elastic Security Solution [8.18] | Elastic</title>
<meta class="elastic" name="content" content="Microsoft Entra ID Elevated Access to User Access Administrator | Elastic Security Solution [8.18]">

<link rel="home" href="index.html" title="Elastic Security Solution [8.18]"/>
<link rel="up" href="prebuilt-rules.html" title="Prebuilt rule reference"/>
<link rel="prev" href="microsoft-entra-id-conditional-access-policy-cap-modified.html" title="Microsoft Entra ID Conditional Access Policy (CAP) Modified"/>
<link rel="next" href="microsoft-entra-id-exccessive-account-lockouts-detected.html" title="Microsoft Entra ID Exccessive Account Lockouts Detected"/>
<meta class="elastic" name="product_version" content="8.18"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.18"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.18"/>
</head>
<body>
<div class="navheader">
<span class="prev">
<a href="microsoft-entra-id-conditional-access-policy-cap-modified.html">« Microsoft Entra ID Conditional Access Policy (CAP) Modified</a>
</span>
<span class="next">
<a href="microsoft-entra-id-exccessive-account-lockouts-detected.html">Microsoft Entra ID Exccessive Account Lockouts Detected »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [8.18]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="detection-engine-overview.html">Detections and alerts</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="prebuilt-rules.html">Prebuilt rule reference</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Microsoft Entra ID Elevated Access to User Access Administrator</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.18/docs/detections/prebuilt-rules/rule-details/microsoft-entra-id-elevated-access-to-user-access-administrator.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div id="url-to-v3" class="version-warning">
    A newer version is available. Check out the <a href="https://www.elastic.co/docs">latest documentation</a>.
</div>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="microsoft-entra-id-elevated-access-to-user-access-administrator"></a>Microsoft Entra ID Elevated Access to User Access Administrator</h2><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.18/docs/detections/prebuilt-rules/rule-details/microsoft-entra-id-elevated-access-to-user-access-administrator.asciidoc">edit</a></div>
</div></div></div>
<p>Identifies when a user has elevated their access to User Access Administrator for their Azure Resources. The User Access Administrator role allows users to manage user access to Azure resources, including the ability to assign roles and permissions. Adversaries may target an Entra ID Global Administrator or other privileged role to elevate their access to User Access Administrator, which can lead to further privilege escalation and unauthorized access to sensitive resources. This is a New Terms rule that only signals if the user principal name has not been seen doing this activity in the last 14 days.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: new_terms</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
filebeat-*
</li>
<li class="listitem">
logs-azure.auditlogs-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5m</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-9m (<a href="/guide/en/elasticsearch/reference/8.18/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule" title="Set the rule&#8217;s schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum alerts per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://learn.microsoft.com/en-us/azure/role-based-access-control/elevate-access-global-admin?tabs=azure-portal%2Centra-audit-logs/" class="ulink" target="_top">https://learn.microsoft.com/en-us/azure/role-based-access-control/elevate-access-global-admin?tabs=azure-portal%2Centra-audit-logs/</a>
</li>
<li class="listitem">
<a href="https://permiso.io/blog/azures-apex-permissions-elevate-access-the-logs-security-teams-overlook" class="ulink" target="_top">https://permiso.io/blog/azures-apex-permissions-elevate-access-the-logs-security-teams-overlook</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Domain: Cloud
</li>
<li class="listitem">
Data Source: Azure
</li>
<li class="listitem">
Data Source: Microsoft Entra ID
</li>
<li class="listitem">
Data Source: Microsoft Entra ID Audit Logs
</li>
<li class="listitem">
Use Case: Identity and Access Audit
</li>
<li class="listitem">
Tactic: Privilege Escalation
</li>
<li class="listitem">
Resources: Investigation Guide
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Rule authors</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Austin Songer
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Rule license</strong></span>: Elastic License v2</p>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_investigation_guide_555"></a>Investigation guide</h3><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.18/docs/detections/prebuilt-rules/rule-details/microsoft-entra-id-elevated-access-to-user-access-administrator.asciidoc">edit</a></div>
</div></div></div>
<p><span class="strong strong"><strong>Triage and Analysis</strong></span></p>
<p><span class="strong strong"><strong>Investigating Microsoft Entra ID Elevated Access to User Access Administrator</strong></span></p>
<p>This rule identifies when a user elevates their permissions to the "User Access Administrator" role in Microsoft Entra ID (Azure AD). This role allows full control over access management for Azure resources and can be abused by attackers for lateral movement, persistence, or privilege escalation. Since this is a <span class="strong strong"><strong>New Terms</strong></span> rule, the alert will only trigger if the user has not performed this elevation in the past 14 days, helping reduce alert fatigue.</p>
<p><span class="strong strong"><strong>Possible investigation steps</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Review the <code class="literal">azure.auditlogs.properties.initiated_by.user.userPrincipalName</code> field to identify the user who elevated access.
</li>
<li class="listitem">
Check <code class="literal">source.ip</code> and associated <code class="literal">source.geo.*</code> fields to determine the origin of the action. Confirm whether the IP, ASN, and location are expected for this user.
</li>
<li class="listitem">
Investigate the application ID from <code class="literal">azure.auditlogs.properties.additional_details.value</code> to determine which interface or method was used to elevate access.
</li>
<li class="listitem">
Pivot to Azure <code class="literal">signinlogs</code> or Entra <code class="literal">auditlogs</code> to:
</li>
<li class="listitem">
Review recent login history for the user.
</li>
<li class="listitem">
Look for unusual sign-in patterns or MFA prompts.
</li>
<li class="listitem">
Determine whether the account has performed any other privilege-related operations.
</li>
<li class="listitem">
Correlate with directory role assignments or role-based access control (RBAC) modifications to assess whether the elevated access was used to add roles or modify permissions.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>False positive analysis</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Legitimate admin actions may involve access elevation during maintenance, migration, or investigations.
</li>
<li class="listitem">
Some IT departments may elevate access temporarily without leaving structured change records.
</li>
<li class="listitem">
Review internal tickets, change logs, or admin activity dashboards for approved operations.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Response and remediation</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If elevation was not authorized:
</li>
<li class="listitem">
Immediately remove the User Access Administrator role from the account.
</li>
<li class="listitem">
Disable or lock the account and begin credential rotation.
</li>
<li class="listitem">
Audit activity performed by the account after elevation, especially changes to role assignments and resource access.
</li>
<li class="listitem">
If suspicious:
</li>
<li class="listitem">
Notify the user and confirm whether they performed the action.
</li>
<li class="listitem">
Check for any automation or scripts that could be exploiting unused elevated access paths.
</li>
<li class="listitem">
Review conditional access and PIM (Privileged Identity Management) configurations to limit elevation without approval.
</li>
<li class="listitem">
Strengthen posture:
</li>
<li class="listitem">
Require MFA and approval for all privilege escalation actions.
</li>
<li class="listitem">
Consider enabling JIT (Just-in-Time) access with expiration.
</li>
<li class="listitem">
Add alerts for repeated or unusual use of <code class="literal">Microsoft.Authorization/elevateAccess/action</code>.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_rule_query_600"></a>Rule query</h3><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.18/docs/detections/prebuilt-rules/rule-details/microsoft-entra-id-elevated-access-to-user-access-administrator.asciidoc">edit</a></div>
</div></div></div>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">event.dataset: azure.auditlogs
    and azure.auditlogs.operation_name: "User has elevated their access to User Access Administrator for their Azure Resources"
    and event.outcome: "success"</pre>
</div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Privilege Escalation
</li>
<li class="listitem">
ID: TA0004
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0004/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0004/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Account Manipulation
</li>
<li class="listitem">
ID: T1098
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1098/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1098/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Sub-technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Additional Cloud Roles
</li>
<li class="listitem">
ID: T1098.003
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1098/003/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1098/003/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="microsoft-entra-id-conditional-access-policy-cap-modified.html">« Microsoft Entra ID Conditional Access Policy (CAP) Modified</a>
</span>
<span class="next">
<a href="microsoft-entra-id-exccessive-account-lockouts-detected.html">Microsoft Entra ID Exccessive Account Lockouts Detected »</a>
</span>
</div>
</body>
</html>
