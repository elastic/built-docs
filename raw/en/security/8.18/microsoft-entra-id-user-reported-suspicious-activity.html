<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Microsoft Entra ID User Reported Suspicious Activity | Elastic Security Solution [8.18] | Elastic</title>
<meta class="elastic" name="content" content="Microsoft Entra ID User Reported Suspicious Activity | Elastic Security Solution [8.18]">

<link rel="home" href="index.html" title="Elastic Security Solution [8.18]"/>
<link rel="up" href="prebuilt-rules.html" title="Prebuilt rule reference"/>
<link rel="prev" href="microsoft-entra-id-sharepoint-access-for-user-principal-via-auth-broker.html" title="Microsoft Entra ID SharePoint Access for User Principal via Auth Broker"/>
<link rel="next" href="microsoft-exchange-server-um-spawning-suspicious-processes.html" title="Microsoft Exchange Server UM Spawning Suspicious Processes"/>
<meta class="elastic" name="product_version" content="8.18"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.18"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.18"/>
</head>
<body>
<div class="navheader">
<span class="prev">
<a href="microsoft-entra-id-sharepoint-access-for-user-principal-via-auth-broker.html">« Microsoft Entra ID SharePoint Access for User Principal via Auth Broker</a>
</span>
<span class="next">
<a href="microsoft-exchange-server-um-spawning-suspicious-processes.html">Microsoft Exchange Server UM Spawning Suspicious Processes »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [8.18]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="detection-engine-overview.html">Detections and alerts</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="prebuilt-rules.html">Prebuilt rule reference</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Microsoft Entra ID User Reported Suspicious Activity</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.18/docs/detections/prebuilt-rules/rule-details/microsoft-entra-id-user-reported-suspicious-activity.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div id="url-to-v3" class="version-warning">
    A newer version is available. Check out the <a href="https://www.elastic.co/docs">latest documentation</a>.
</div>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="microsoft-entra-id-user-reported-suspicious-activity"></a>Microsoft Entra ID User Reported Suspicious Activity</h2><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.18/docs/detections/prebuilt-rules/rule-details/microsoft-entra-id-user-reported-suspicious-activity.asciidoc">edit</a></div>
</div></div></div>
<p>Identifies suspicious activity reported by users in Microsoft Entra ID where users have reported suspicious activity related to their accounts, which may indicate potential compromise or unauthorized access attempts. Reported suspicious activity typically occurs during the authentication process and may involve various authentication methods, such as password resets, account recovery, or multi-factor authentication challenges. Adversaries may attempt to exploit user accounts by leveraging social engineering techniques or other methods to gain unauthorized access to sensitive information or resources.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
filebeat-*
</li>
<li class="listitem">
logs-azure.auditlogs-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5m</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-9m (<a href="/guide/en/elasticsearch/reference/8.18/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule" title="Set the rule&#8217;s schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum alerts per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://chris-brumm.medium.com/microsoft-entra-mfa-fraud-deep-dive-7764fd8f76ad" class="ulink" target="_top">https://chris-brumm.medium.com/microsoft-entra-mfa-fraud-deep-dive-7764fd8f76ad</a>
</li>
<li class="listitem">
<a href="https://janbakker.tech/report-suspicious-activity-fraud-alert-for-azure-mfa/" class="ulink" target="_top">https://janbakker.tech/report-suspicious-activity-fraud-alert-for-azure-mfa/</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Domain: Cloud
</li>
<li class="listitem">
Data Source: Azure
</li>
<li class="listitem">
Data Source: Microsoft Entra ID
</li>
<li class="listitem">
Data Source: Microsoft Entra ID Audit Logs
</li>
<li class="listitem">
Use Case: Identity and Access Audit
</li>
<li class="listitem">
Resources: Investigation Guide
</li>
<li class="listitem">
Tactic: Initial Access
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Rule authors</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Willem D&#8217;Haese
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Rule license</strong></span>: Elastic License v2</p>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_investigation_guide_560"></a>Investigation guide</h3><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.18/docs/detections/prebuilt-rules/rule-details/microsoft-entra-id-user-reported-suspicious-activity.asciidoc">edit</a></div>
</div></div></div>
<p><span class="strong strong"><strong>Triage and Analysis</strong></span></p>
<p><span class="strong strong"><strong>Investigating Microsoft Entra ID User Reported Suspicious Activity</strong></span></p>
<p>This rule detects when a user in Microsoft Entra ID reports suspicious activity associated with their account. This feature is often used to report MFA fatigue or unsolicited push notifications, and is logged during authentication flows involving methods like Microsoft Authenticator. Such events may indicate that an attacker attempted unauthorized access and triggered a push that was denied or flagged by the user.</p>
<p><span class="strong strong"><strong>Possible investigation steps</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Review the <code class="literal">azure.auditlogs.identity</code> field to identify the reporting user.
</li>
<li class="listitem">
Confirm that <code class="literal">event.action</code> is <code class="literal">"Suspicious activity reported"</code> and the result was <code class="literal">"success"</code>.
</li>
<li class="listitem">
Check the <code class="literal">azure.auditlogs.properties.additional_details</code> array for <code class="literal">AuthenticationMethod</code>, which shows how the login attempt was performed (e.g., <code class="literal">PhoneAppNotification</code>).
</li>
<li class="listitem">
Look at the <code class="literal">azure.auditlogs.properties.initiated_by.user.userPrincipalName</code> and <code class="literal">displayName</code> to confirm which user reported the suspicious activity.
</li>
<li class="listitem">
Investigate recent sign-in activity (<code class="literal">signinlogs</code>) for the same user. Focus on:
</li>
<li class="listitem">
IP address geolocation and ASN.
</li>
<li class="listitem">
Device, operating system, and browser.
</li>
<li class="listitem">
MFA prompt patterns or unusual login attempts.
</li>
<li class="listitem">
Determine whether the user actually initiated a login attempt, or if it was unexpected and aligns with MFA fatigue or phishing attempts.
</li>
<li class="listitem">
Correlate this report with any risky sign-in detections, conditional access blocks, or password resets in the past 24–48 hours.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>False positive analysis</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Users unfamiliar with MFA push notifications may mistakenly report legitimate sign-in attempts.
</li>
<li class="listitem">
Shared accounts or device switching can also trigger unintended notifications.
</li>
<li class="listitem">
Legitimate travel or network changes might confuse users into thinking activity was malicious.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Response and remediation</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Contact the user to validate the suspicious activity report and assess whether they were targeted or tricked by a malicious actor.
</li>
<li class="listitem">
If the report is confirmed to be valid:
</li>
<li class="listitem">
Reset the user’s credentials immediately.
</li>
<li class="listitem">
Revoke active sessions and refresh tokens.
</li>
<li class="listitem">
Review their activity across Microsoft 365 services for signs of compromise.
</li>
<li class="listitem">
If other users report similar behavior around the same time, assess for a broader MFA fatigue campaign or targeted phishing.
</li>
<li class="listitem">
Consider tuning conditional access policies to require number matching or stronger MFA mechanisms.
</li>
<li class="listitem">
Educate users on reporting suspicious MFA prompts and following up with IT/security teams promptly.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_rule_query_602"></a>Rule query</h3><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.18/docs/detections/prebuilt-rules/rule-details/microsoft-entra-id-user-reported-suspicious-activity.asciidoc">edit</a></div>
</div></div></div>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">event.dataset: "azure.auditlogs"
    and azure.auditlogs.operation_name: "Suspicious activity reported"
    and azure.auditlogs.properties.additional_details.key: "AuthenticationMethod"
    and azure.auditlogs.properties.target_resources.*.type: "User"
    and event.outcome: "success"</pre>
</div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Initial Access
</li>
<li class="listitem">
ID: TA0001
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0001/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0001/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Valid Accounts
</li>
<li class="listitem">
ID: T1078
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1078/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1078/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="microsoft-entra-id-sharepoint-access-for-user-principal-via-auth-broker.html">« Microsoft Entra ID SharePoint Access for User Principal via Auth Broker</a>
</span>
<span class="next">
<a href="microsoft-exchange-server-um-spawning-suspicious-processes.html">Microsoft Exchange Server UM Spawning Suspicious Processes »</a>
</span>
</div>
</body>
</html>
