<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Unusual Host Name for Okta Privileged Operations Detected | Elastic Security [8.18] | Elastic</title>
<meta class="elastic" name="content" content="Unusual Host Name for Okta Privileged Operations Detected | Elastic Security [8.18]">

<link rel="home" href="index.html" title="Elastic Security [8.18]"/>
<link rel="up" href="prebuilt-rule-8-18-1-prebuilt-rules-8-18-1-appendix.html" title="Appendix T: Downloadable rule update v8.18.1"/>
<link rel="prev" href="prebuilt-rule-8-18-1-unusual-spike-in-concurrent-active-sessions-by-a-user.html" title="Unusual Spike in Concurrent Active Sessions by a User"/>
<link rel="next" href="prebuilt-rule-8-18-1-unusual-region-name-for-okta-privileged-operations-detected.html" title="Unusual Region Name for Okta Privileged Operations Detected"/>
<meta class="elastic" name="product_version" content="8.18"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.18"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.18"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div class="navheader">
<span class="prev">
<a href="prebuilt-rule-8-18-1-unusual-spike-in-concurrent-active-sessions-by-a-user.html">« Unusual Spike in Concurrent Active Sessions by a User</a>
</span>
<span class="next">
<a href="prebuilt-rule-8-18-1-unusual-region-name-for-okta-privileged-operations-detected.html">Unusual Region Name for Okta Privileged Operations Detected »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security [8.18]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="prebuilt-rule-8-18-1-prebuilt-rules-8-18-1-appendix.html">Downloadable rule update v8.18.1</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Unusual Host Name for Okta Privileged Operations Detected</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.18/docs/detections/prebuilt-rules/downloadable-packages/8-18-1/prebuilt-rule-8-18-1-unusual-host-name-for-okta-privileged-operations-detected.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div id="url-to-v3" class="version-warning">
    A newer version is available. Check out the <a href="https://www.elastic.co/docs">latest documentation</a>.
</div>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="prebuilt-rule-8-18-1-unusual-host-name-for-okta-privileged-operations-detected"></a>Unusual Host Name for Okta Privileged Operations Detected</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.18/docs/detections/prebuilt-rules/downloadable-packages/8-18-1/prebuilt-rule-8-18-1-unusual-host-name-for-okta-privileged-operations-detected.asciidoc">edit</a></div>
</div></div></div>
<p>A machine learning job has identified a user performing privileged operations in Okta from an uncommon device, indicating potential privileged access activity. This could signal a compromised account, an attacker using stolen credentials, or an insider threat leveraging an unauthorized device to escalate privileges.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: machine_learning</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>: None</p>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 15m</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-1h (<a href="/guide/en/elasticsearch/reference/8.18/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule" title="Set the rule&#8217;s schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum alerts per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="/guide/en/security/current/prebuilt-ml-jobs.html" class="ulink" target="_top">https://www.elastic.co/guide/en/security/current/prebuilt-ml-jobs.html</a>
</li>
<li class="listitem">
<a href="https://docs.elastic.co/en/integrations/pad" class="ulink" target="_top">https://docs.elastic.co/en/integrations/pad</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Use Case: Privileged Access Detection
</li>
<li class="listitem">
Rule Type: ML
</li>
<li class="listitem">
Rule Type: Machine Learning
</li>
<li class="listitem">
Tactic: Privilege Escalation
</li>
<li class="listitem">
Resources: Investigation Guide
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 3</p>
<p><span class="strong strong"><strong>Rule authors</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Rule license</strong></span>: Elastic License v2</p>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_investigation_guide_4044"></a>Investigation guide</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.18/docs/detections/prebuilt-rules/downloadable-packages/8-18-1/prebuilt-rule-8-18-1-unusual-host-name-for-okta-privileged-operations-detected.asciidoc">edit</a></div>
</div></div></div>
<p><span class="strong strong"><strong>Triage and analysis</strong></span></p>
<div class="quoteblock">
<blockquote>
<p><span class="strong strong"><strong>Disclaimer</strong></span>:
This investigation guide was created using generative AI technology and has been reviewed to improve its accuracy and relevance. While every effort has been made to ensure its quality, we recommend validating the content and adapting it to suit your specific environment and operational needs.</p>
</blockquote>
</div>
<p><span class="strong strong"><strong>Investigating Unusual Host Name for Okta Privileged Operations Detected</strong></span></p>
<p>Okta is a widely used identity management service that facilitates secure user authentication and access control. Adversaries may exploit Okta by using stolen credentials or unauthorized devices to perform privileged operations, potentially leading to privilege escalation. The detection rule leverages machine learning to identify anomalies in host names associated with privileged actions, flagging unusual device usage that may indicate compromised accounts or insider threats.</p>
<p><span class="strong strong"><strong>Possible investigation steps</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Review the alert details to identify the specific user and host name involved in the unusual activity.
</li>
<li class="listitem">
Check the user&#8217;s recent login history and device usage patterns in Okta to determine if the host name has been used before or if it is indeed uncommon.
</li>
<li class="listitem">
Investigate the geographical location and IP address associated with the unusual host name to assess if it aligns with the user&#8217;s typical access patterns.
</li>
<li class="listitem">
Examine any recent changes to the user&#8217;s account, such as password resets or modifications to multi-factor authentication settings, to identify potential signs of compromise.
</li>
<li class="listitem">
Correlate the alert with other security logs and alerts to identify any related suspicious activities or patterns that could indicate a broader attack or insider threat.
</li>
<li class="listitem">
Contact the user to verify if they recognize the device and host name, and if they were performing the privileged operations at the time of the alert.
</li>
<li class="listitem">
If unauthorized access is confirmed, follow incident response procedures to secure the account, such as resetting credentials and reviewing access permissions.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>False positive analysis</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Users accessing Okta from new or temporary devices may trigger false positives. Regularly update the list of approved devices to include these new devices if they are legitimate.
</li>
<li class="listitem">
Employees traveling or working remotely might use different devices or networks, causing alerts. Implement a process to verify and whitelist these devices when travel or remote work is expected.
</li>
<li class="listitem">
IT staff performing legitimate administrative tasks from shared or uncommon devices can be mistaken for threats. Maintain a log of such activities and cross-reference with alerts to identify and exclude these benign actions.
</li>
<li class="listitem">
Changes in device naming conventions or system upgrades can result in unusual host names. Ensure that any planned changes are communicated and documented to adjust the detection parameters accordingly.
</li>
<li class="listitem">
Regularly review and refine the machine learning model&#8217;s training data to minimize false positives by incorporating feedback from security teams on legitimate activities that were incorrectly flagged.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Response and remediation</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Immediately isolate the device associated with the unusual host name from the network to prevent further unauthorized access or potential lateral movement.
</li>
<li class="listitem">
Revoke any active sessions and reset the credentials for the affected Okta account to prevent further unauthorized access.
</li>
<li class="listitem">
Conduct a thorough review of recent privileged operations performed by the affected account to identify any unauthorized changes or access.
</li>
<li class="listitem">
Notify the security operations team and relevant stakeholders about the potential compromise for further investigation and monitoring.
</li>
<li class="listitem">
Implement additional monitoring on the affected account and similar privileged accounts to detect any further suspicious activities.
</li>
<li class="listitem">
Review and update access controls and policies to ensure that only authorized devices can perform privileged operations in Okta.
</li>
<li class="listitem">
Consider enabling multi-factor authentication (MFA) for all privileged accounts to add an additional layer of security against unauthorized access.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_setup_861"></a>Setup</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.18/docs/detections/prebuilt-rules/downloadable-packages/8-18-1/prebuilt-rule-8-18-1-unusual-host-name-for-okta-privileged-operations-detected.asciidoc">edit</a></div>
</div></div></div>
<p><span class="strong strong"><strong>Setup</strong></span></p>
<p>The rule requires the Privileged Access Detection integration assets to be installed, as well as Okta logs collected by integrations such as Okta.</p>
<p><span class="strong strong"><strong>Privileged Access Detection Setup</strong></span></p>
<p>The Privileged Access Detection integration detects privileged access activity by identifying abnormalities in Windows, Linux and Okta events. Anomalies are detected using Elastic&#8217;s Anomaly Detection feature.</p>
<p><span class="strong strong"><strong>Prerequisite Requirements:</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Fleet is required for Privileged Access Detection.
</li>
<li class="listitem">
To configure Fleet Server refer to the <a href="/guide/en/fleet/current/fleet-server.html" class="ulink" target="_top">documentation</a>.
</li>
<li class="listitem">
Okta events collected by <a href="https://docs.elastic.co/en/integrations/okta" class="ulink" target="_top">Okta</a> integration.
</li>
<li class="listitem">
To add the Okta integration to an Elastic Agent policy, refer to <a href="/guide/en/fleet/current/add-integration-to-policy.html" class="ulink" target="_top">this</a> guide.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>The following steps should be executed to install assets associated with the Privileged Access Detection integration:</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Go to the Kibana homepage. Under Management, click Integrations.
</li>
<li class="listitem">
In the query bar, search for Privileged Access Detection and select the integration to see more details about it.
</li>
<li class="listitem">
Follow the instructions under the <span class="strong strong"><strong>Installation</strong></span> section.
</li>
<li class="listitem">
For this rule to work, complete the instructions through <span class="strong strong"><strong>Add preconfigured anomaly detection jobs</strong></span>.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Privilege Escalation
</li>
<li class="listitem">
ID: TA0004
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0004/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0004/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Valid Accounts
</li>
<li class="listitem">
ID: T1078
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1078/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1078/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="prebuilt-rule-8-18-1-unusual-spike-in-concurrent-active-sessions-by-a-user.html">« Unusual Spike in Concurrent Active Sessions by a User</a>
</span>
<span class="next">
<a href="prebuilt-rule-8-18-1-unusual-region-name-for-okta-privileged-operations-detected.html">Unusual Region Name for Okta Privileged Operations Detected »</a>
</span>
</div>
</body>
</html>
