<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Azure RBAC Built-In Administrator Roles Assigned | Elastic Security [8.18] | Elastic</title>
<meta class="elastic" name="content" content="Azure RBAC Built-In Administrator Roles Assigned | Elastic Security [8.18]">

<link rel="home" href="index.html" title="Elastic Security [8.18]"/>
<link rel="up" href="prebuilt-rule-8-18-15-prebuilt-rules-8-18-15-appendix.html" title="Appendix b: Downloadable rule update v8.18.15"/>
<link rel="prev" href="prebuilt-rule-8-18-15-microsoft-entra-id-protection-alert-and-device-registration.html" title="Microsoft Entra ID Protection Alert and Device Registration"/>
<link rel="next" href="prebuilt-rule-8-18-15-curl-or-wget-spawned-via-node-js.html" title="Curl or Wget Spawned via Node.js"/>
<meta class="elastic" name="product_version" content="8.18"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.18"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.18"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div class="navheader">
<span class="prev">
<a href="prebuilt-rule-8-18-15-microsoft-entra-id-protection-alert-and-device-registration.html">« Microsoft Entra ID Protection Alert and Device Registration</a>
</span>
<span class="next">
<a href="prebuilt-rule-8-18-15-curl-or-wget-spawned-via-node-js.html">Curl or Wget Spawned via Node.js »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security [8.18]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="prebuilt-rule-8-18-15-prebuilt-rules-8-18-15-appendix.html">Downloadable rule update v8.18.15</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Azure RBAC Built-In Administrator Roles Assigned</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.18/docs/detections/prebuilt-rules/downloadable-packages/8-18-15/prebuilt-rule-8-18-15-azure-rbac-built-in-administrator-roles-assigned.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div id="url-to-v3" class="version-warning">
    A newer version is available. Check out the <a href="https://www.elastic.co/docs">latest documentation</a>.
</div>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="prebuilt-rule-8-18-15-azure-rbac-built-in-administrator-roles-assigned"></a>Azure RBAC Built-In Administrator Roles Assigned</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.18/docs/detections/prebuilt-rules/downloadable-packages/8-18-15/prebuilt-rule-8-18-15-azure-rbac-built-in-administrator-roles-assigned.asciidoc">edit</a></div>
</div></div></div>
<p>Identifies when a user is assigned a built-in administrator role in Azure RBAC (Role-Based Access Control). These roles provide significant privileges and can be abused by attackers for lateral movement, persistence, or privilege escalation. The privileged built-in administrator roles include Owner, Contributor, User Access Administrator, Azure File Sync Administrator, Reservations Administrator, and Role Based Access Control Administrator.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
filebeat-*
</li>
<li class="listitem">
logs-azure.activitylogs-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: high</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 73</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5m</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-9m (<a href="/guide/en/elasticsearch/reference/8.18/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule" title="Set the rule&#8217;s schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum alerts per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles" class="ulink" target="_top">https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles</a>
</li>
<li class="listitem">
<a href="https://orca.security/resources/research-pod/azure-identity-access-management-iam-active-directory-ad/" class="ulink" target="_top">https://orca.security/resources/research-pod/azure-identity-access-management-iam-active-directory-ad/</a>
</li>
<li class="listitem">
<a href="https://www.microsoft.com/en-us/security/blog/2025/08/27/storm-0501s-evolving-techniques-lead-to-cloud-based-ransomware/" class="ulink" target="_top">https://www.microsoft.com/en-us/security/blog/2025/08/27/storm-0501s-evolving-techniques-lead-to-cloud-based-ransomware/</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Domain: Cloud
</li>
<li class="listitem">
Data Source: Azure
</li>
<li class="listitem">
Data Source: Azure Activity Logs
</li>
<li class="listitem">
Use Case: Identity and Access Audit
</li>
<li class="listitem">
Tactic: Privilege Escalation
</li>
<li class="listitem">
Resources: Investigation Guide
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Rule authors</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Rule license</strong></span>: Elastic License v2</p>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_investigation_guide_4838"></a>Investigation guide</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.18/docs/detections/prebuilt-rules/downloadable-packages/8-18-15/prebuilt-rule-8-18-15-azure-rbac-built-in-administrator-roles-assigned.asciidoc">edit</a></div>
</div></div></div>
<p><span class="strong strong"><strong>Triage and Analysis</strong></span></p>
<p><span class="strong strong"><strong>Investigating Azure RBAC Built-In Administrator Roles Assigned</strong></span></p>
<p>This rule identifies when a user is assigned a built-in administrator role in Azure RBAC (Role-Based Access Control). These roles provide significant privileges and can be abused by attackers for lateral movement, persistence, or privilege escalation. The privileged built-in administrator roles include Owner, Contributor, User Access Administrator, Azure File Sync Administrator, Reservations Administrator, and Role Based Access Control Administrator. Assignment can be done via the Azure portal, Azure CLI, PowerShell, or through API calls. Monitoring these assignments helps detect potential unauthorized privilege escalations.</p>
<p><span class="strong strong"><strong>Privileged Built-In Administrator Roles</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Contributor: b24988ac-6180-42a0-ab88-20f7382dd24c
</li>
<li class="listitem">
Owner: 8e3af657-a8ff-443c-a75c-2fe8c4bcb635
</li>
<li class="listitem">
Azure File Sync Administrator: 92b92042-07d9-4307-87f7-36a593fc5850
</li>
<li class="listitem">
Reservations Administrator: a8889054-8d42-49c9-bc1c-52486c10e7cd
</li>
<li class="listitem">
Role Based Access Control Administrator: f58310d9-a9f6-439a-9e8d-f62e7b41a168
</li>
<li class="listitem">
User Access Administrator: 18d7d88d-d35e-4fb5-a5c3-7773c20a72d9
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Possible investigation steps</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Identify the user who assigned the role and examine their recent activity for any suspicious actions.
</li>
<li class="listitem">
Review the source IP address and location associated with the role assignment event to assess if it aligns with expected user behavior or if it indicates potential unauthorized access.
</li>
<li class="listitem">
Check the history of role assignments for the user who was assigned the role to determine if this is a recurring pattern or a one-time event.
</li>
<li class="listitem">
Additionally, identify the lifetime of the targeted user account to determine if it is a newly created account or an existing one.
</li>
<li class="listitem">
Determine if the user assigning the role historically has the necessary permissions to assign such roles and has done so in the past.
</li>
<li class="listitem">
Investigate any recent changes or activities performed by the newly assigned administrator to identify any suspicious actions or configurations that may have been altered.
</li>
<li class="listitem">
Correlate with other logs, such as Microsoft Entra ID sign-in logs, to identify any unusual access patterns or behaviors for the user.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>False positive analysis</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Legitimate administrators may assign built-in administrator roles during routine operations, maintenance or as required for onboarding new staff.
</li>
<li class="listitem">
Review internal tickets, change logs, or admin activity dashboards for approved operations.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Response and remediation</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If administrative assignment was not authorized:
</li>
<li class="listitem">
Immediately remove the built-in administrator role from the account.
</li>
<li class="listitem">
Disable or lock the account and begin credential rotation.
</li>
<li class="listitem">
Audit activity performed by the account after elevation, especially changes to role assignments and resource access.
</li>
<li class="listitem">
If suspicious:
</li>
<li class="listitem">
Notify the user and confirm whether they performed the action.
</li>
<li class="listitem">
Check for any automation or scripts that could be exploiting unused elevated access paths.
</li>
<li class="listitem">
Review conditional access and PIM (Privileged Identity Management) configurations to limit elevation without approval.
</li>
<li class="listitem">
Strengthen posture:
</li>
<li class="listitem">
Require MFA and approval for all privilege escalation actions.
</li>
<li class="listitem">
Consider enabling JIT (Just-in-Time) access with expiration.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_rule_query_5727"></a>Rule query</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.18/docs/detections/prebuilt-rules/downloadable-packages/8-18-15/prebuilt-rule-8-18-15-azure-rbac-built-in-administrator-roles-assigned.asciidoc">edit</a></div>
</div></div></div>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">event.dataset: azure.activitylogs and
    event.action: "MICROSOFT.AUTHORIZATION/ROLEASSIGNMENTS/WRITE" and
    azure.activitylogs.properties.requestbody.properties.roleDefinitionId:
    (
      *18d7d88d-d35e-4fb5-a5c3-7773c20a72d9* or
      *f58310d9-a9f6-439a-9e8d-f62e7b41a168* or
      *b24988ac-6180-42a0-ab88-20f7382dd24c* or
      *8e3af657-a8ff-443c-a75c-2fe8c4bcb635* or
      *92b92042-07d9-4307-87f7-36a593fc5850* or
      *a8889054-8d42-49c9-bc1c-52486c10e7cd*
  )</pre>
</div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Privilege Escalation
</li>
<li class="listitem">
ID: TA0004
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0004/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0004/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Account Manipulation
</li>
<li class="listitem">
ID: T1098
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1098/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1098/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Sub-technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Additional Cloud Roles
</li>
<li class="listitem">
ID: T1098.003
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1098/003/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1098/003/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="prebuilt-rule-8-18-15-microsoft-entra-id-protection-alert-and-device-registration.html">« Microsoft Entra ID Protection Alert and Device Registration</a>
</span>
<span class="next">
<a href="prebuilt-rule-8-18-15-curl-or-wget-spawned-via-node-js.html">Curl or Wget Spawned via Node.js »</a>
</span>
</div>
</body>
</html>
