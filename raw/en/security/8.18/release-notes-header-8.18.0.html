<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>8.18 | Elastic Security Solution [8.18] | Elastic</title>
<meta class="elastic" name="content" content="8.18 | Elastic Security Solution [8.18]">

<link rel="home" href="index.html" title="Elastic Security Solution [8.18]"/>
<link rel="up" href="release-notes.html" title="Release notes"/>
<link rel="prev" href="release-notes.html" title="Release notes"/>
<link rel="next" href="release-notes-header-8.17.0.html" title="8.17"/>
<meta class="elastic" name="product_version" content="8.18"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.18"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.18"/>
</head>
<body>
<div class="navheader">
<span class="prev">
<a href="release-notes.html">« Release notes</a>
</span>
<span class="next">
<a href="release-notes-header-8.17.0.html">8.17 »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [8.18]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="release-notes.html">Release notes</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>8.18</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.18/docs/release-notes/8.18.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div id="url-to-v3" class="version-warning">
    A newer version is available. Check out the <a href="https://www.elastic.co/docs">latest documentation</a>.
</div>
<div class="chapter">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="release-notes-header-8.18.0"></a>8.18</h2><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.18/docs/release-notes/8.18.asciidoc">edit</a></div>
</div></div></div>
<div class="position-relative"><h3><a id="release-notes-8.18.3"></a>8.18.3</h3><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.18/docs/release-notes/8.18.asciidoc">edit</a></div>
<div class="position-relative"><h4><a id="known-issue-8.18.3"></a>Known issues</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.18/docs/release-notes/8.18.asciidoc">edit</a></div>
<details>
<summary class="title">Elastic Defend&#8217;s network driver may lead to bug checks</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
On July 8, 2025, a known issue was discovered in Elastic Defend&#8217;s network driver that may lead to kernel pool corruption, resulting in bug checks (BSODs) on Windows systems with a large number of long-lived network connections that remain inactive for 30+ minutes.</p>
<p>The system may bug check with any of a variety of codes such as <code class="literal">SYSTEM_SERVICE_EXCEPTION</code> or <code class="literal">PAGE_FAULT_IN_NONPAGED_AREA</code>.</p>
<p>For more information, check <a href="https://github.com/elastic/endpoint/issues/90" class="ulink" target="_top">#90</a></p>
<p><span class="strong strong"><strong>Workaround</strong></span><br>
Upgrade to the fixed version: <a href="/downloads/past-releases/elastic-agent-8-18-3+build202507101319" class="ulink" target="_top">8.18.3+build202507101319</a>.</p>
<p>If you&#8217;re unable to upgrade or downgrade, set the <code class="literal">advanced.kernel.network</code> advanced setting to <code class="literal">false</code> in your Elastic Defend integration policy.</p>
</div>
</details>
<div class="position-relative"><h4><a id="enhancements-8.18.3"></a>Enhancements</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.18/docs/release-notes/8.18.asciidoc">edit</a></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Adds <code class="literal">dns</code> event collection for macOS for Elastic Defend (<a href="https://github.com/elastic/kibana/pull/223566" class="ulink" target="_top">#223566</a>).
</li>
<li class="listitem">
Adds pricing information about Elastic Managed LLM in AI Assistant and Attack Discovery tours and callouts (<a href="https://github.com/elastic/kibana/pull/221566" class="ulink" target="_top">#221566</a>).
</li>
<li class="listitem">
Adds local file path support for <code class="literal">xpack.productDocBase.artifactRepositoryUrl</code> (<a href="https://github.com/elastic/kibana/pull/217046" class="ulink" target="_top">#217046</a>).
</li>
</ul>
</div>
<div class="position-relative"><h4><a id="bug-fixes-8.18.3"></a>Fixes</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.18/docs/release-notes/8.18.asciidoc">edit</a></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Fixes a bug where OSS models didn&#8217;t work when streaming was ON (<a href="https://github.com/elastic/kibana/pull/224129" class="ulink" target="_top">#224129</a>).
</li>
<li class="listitem">
Fixes a bug where cell actions didn&#8217;t work when opening a Timeline from specific rules (<a href="https://github.com/elastic/kibana/pull/223302" class="ulink" target="_top">#223302</a>).
</li>
<li class="listitem">
Fixes an issue where the entity risk score feature stopped persisting risk score documents (<a href="https://github.com/elastic/kibana/pull/221937" class="ulink" target="_top">#221937</a>).
</li>
<li class="listitem">
Fixes overflow issues with the threat match mapping component when you viewed the rule upgrade flyout on a smaller screen (<a href="https://github.com/elastic/kibana/pull/218628" class="ulink" target="_top">#218628</a>).
</li>
<li class="listitem">
Ensures the Amazon Bedrock connector respects the action proxy configuration (<a href="https://github.com/elastic/kibana/pull/224130" class="ulink" target="_top">#224130</a>).
</li>
<li class="listitem">
Ensures the OpenAI connector respects the action proxy configuration for all sub-actions (<a href="https://github.com/elastic/kibana/pull/219617" class="ulink" target="_top">#219617</a>).
</li>
</ul>
</div>
<div class="position-relative"><h3><a id="release-notes-8.18.2"></a>8.18.2</h3><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.18/docs/release-notes/8.18.asciidoc">edit</a></div>
<div class="position-relative"><h4><a id="known-issue-8.18.2"></a>Known issues</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.18/docs/release-notes/8.18.asciidoc">edit</a></div>
<details>
<summary class="title">The entity risk score feature may stop persisting risk score documents</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
On May 30, 2025, it was discovered that the entity risk score feature may stop persisting risk score documents if risk scoring was turned on before you upgraded to Elastic Stack 8.18.0 or higher.</p>
<p>This is due to a bug that prevents the <code class="literal">entity_analytics_create_eventIngest_from_timestamp-pipeline-&lt;space_name&gt;</code> ingest pipeline (which is set as a default pipeline for the risk scoring index in Elastic Stack 8.18.0) from being created when Kibana starts up.</p>
<p>While document persistence may initially succeed, it will eventually fail after 0 to 30 days. This is how long it takes for the risk score data stream to roll over and apply its underlying index settings to the new default pipeline.</p>
<p><span class="strong strong"><strong>Workaround</strong></span><br></p>
<p>To resolve this issue, apply the following workaround before or after upgrading to Elastic Stack 8.18.0 or higher.</p>
<p>First, manually create the ingest pipeline in each space that has entity risk scoring turned on. You can do this using a PUT request, which is described in the example below. When reviewing the example, note that <code class="literal">default</code> in the example ingest pipeline name below is the Kibana space ID.</p>
<pre class="screen">PUT /_ingest/pipeline/entity_analytics_create_eventIngest_from_timestamp-pipeline-default
{
  "_meta": {
    "managed_by": "entity_analytics",
    "managed": true
  },
  "description": "Pipeline for adding timestamp value to event.ingested",
  "processors": [
    {
      "set": {
        "field": "event.ingested",
        "value": "{{_ingest.timestamp}}"
      }
    }
  ]
}</pre>
<p>After you complete this step, risk scores should automatically begin to successfully persist during the entity risk engine&#8217;s next run. Details for the next run time are described on the <span class="strong strong"><strong>Entity risk score</strong></span> page, where you can also manually run the risk score by clicking <span class="strong strong"><strong>Run Engine</strong></span>.</p>
<p><span class="strong strong"><strong>Resolved</strong></span><br>
This issue is fixed in Elastic Stack version 8.18.3.</p>
</div>
</details>
<div class="position-relative"><h4><a id="bug-fixes-8.18.2"></a>Fixes</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.18/docs/release-notes/8.18.asciidoc">edit</a></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Improves error telemetry for the AI assistant (<a href="https://github.com/elastic/kibana/pull/220938" class="ulink" target="_top">#220938</a>).
</li>
<li class="listitem">
Simplifies and improves the rule import error message (<a href="https://github.com/elastic/kibana/pull/218701" class="ulink" target="_top">#218701</a>).
</li>
<li class="listitem">
Fixes a bug that caused the Dashboard overview page to crash when a Lens widget aggregation error occurred (<a href="https://github.com/elastic/kibana/pull/214888" class="ulink" target="_top">#214888</a>).
</li>
<li class="listitem">
Removes the technical preview badge from the alert suppression fields for event correlation rules.
</li>
<li class="listitem">
Fixes a bug in Elastic Defend 8.16.0 where Elastic Endpoint would incorrectly report some files as being <code class="literal">.NET</code>.
</li>
</ul>
</div>
<div class="position-relative"><h3><a id="release-notes-8.18.1"></a>8.18.1</h3><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.18/docs/release-notes/8.18.asciidoc">edit</a></div>
<div class="position-relative"><h4><a id="known-issue-8.18.1"></a>Known issues</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.18/docs/release-notes/8.18.asciidoc">edit</a></div>
<details>
<summary class="title">The entity risk score feature may stop persisting risk score documents</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
On May 30, 2025, it was discovered that the entity risk score feature may stop persisting risk score documents if risk scoring was turned on before you upgraded to Elastic Stack 8.18.0 or higher.</p>
<p>This is due to a bug that prevents the <code class="literal">entity_analytics_create_eventIngest_from_timestamp-pipeline-&lt;space_name&gt;</code> ingest pipeline (which is set as a default pipeline for the risk scoring index in Elastic Stack 8.18.0) from being created when Kibana starts up.</p>
<p>While document persistence may initially succeed, it will eventually fail after 0 to 30 days. This is how long it takes for the risk score data stream to roll over and apply its underlying index settings to the new default pipeline.</p>
<p><span class="strong strong"><strong>Workaround</strong></span><br></p>
<p>To resolve this issue, apply the following workaround before or after upgrading to Elastic Stack 8.18.0 or higher.</p>
<p>First, manually create the ingest pipeline in each space that has entity risk scoring turned on. You can do this using a PUT request, which is described in the example below. When reviewing the example, note that <code class="literal">default</code> in the example ingest pipeline name below is the Kibana space ID.</p>
<pre class="screen">PUT /_ingest/pipeline/entity_analytics_create_eventIngest_from_timestamp-pipeline-default
{
  "_meta": {
    "managed_by": "entity_analytics",
    "managed": true
  },
  "description": "Pipeline for adding timestamp value to event.ingested",
  "processors": [
    {
      "set": {
        "field": "event.ingested",
        "value": "{{_ingest.timestamp}}"
      }
    }
  ]
}</pre>
<p>After you complete this step, risk scores should automatically begin to successfully persist during the entity risk engine&#8217;s next run. Details for the next run time are described on the <span class="strong strong"><strong>Entity risk score</strong></span> page, where you can also manually run the risk score by clicking <span class="strong strong"><strong>Run Engine</strong></span>.</p>
<p><span class="strong strong"><strong>Resolved</strong></span><br>
This issue is fixed in Elastic Stack version 8.18.3.</p>
</div>
</details>
<details>
<summary class="title">The technical preview badge incorrectly displays on the alert suppression fields for event correlation rules</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
On April 8, 2025, it was discovered that alert suppression for event correlation rules is incorrectly shown as being in technical preview when you create a new rule. For more information, check <a href="https://github.com/elastic/docs-content/issues/1021" class="ulink" target="_top">#1021</a>.</p>
<p><span class="strong strong"><strong>Resolved</strong></span><br>
This issue is fixed in Elastic Stack version 8.18.2.</p>
</div>
</details>
<div class="position-relative"><h4><a id="enhancements-8.18.1"></a>Enhancements</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.18/docs/release-notes/8.18.asciidoc">edit</a></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Updates the <span class="strong strong"><strong>MITRE ATT&amp;CK® coverage</strong></span> page mapping to <code class="literal">v16.1</code> (<a href="https://github.com/elastic/kibana/pull/215026" class="ulink" target="_top">#215026</a>).
</li>
<li class="listitem">
Adds a background task to upgrade Agentless deployments after Kibana has been upgraded (<a href="https://github.com/elastic/kibana/pull/207143" class="ulink" target="_top">#207143</a>).
</li>
<li class="listitem">
Improves Elastic Defend&#8217;s CPU usage on systems with very high event volumes.
</li>
</ul>
</div>
<div class="position-relative"><h4><a id="bug-fixes-8.18.1"></a>Fixes</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.18/docs/release-notes/8.18.asciidoc">edit</a></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Removes the check for unused connector roles (<a href="https://github.com/elastic/kibana/pull/219358" class="ulink" target="_top">#219358</a>).
</li>
<li class="listitem">
Simplifies and improves the rule import error message (<a href="https://github.com/elastic/kibana/pull/218701" class="ulink" target="_top">#218701</a>).
</li>
<li class="listitem">
Fixes the related integrations render performance on rule editing pages (<a href="https://github.com/elastic/kibana/pull/217254" class="ulink" target="_top">#217254</a>).
</li>
<li class="listitem">
Prevents ES|QL rules from timing out if the rule query takes longer than five minutes to complete (<a href="https://github.com/elastic/kibana/pull/216667" class="ulink" target="_top">#216667</a>).
</li>
<li class="listitem">
Improves Elastic Defend&#8217;s call site analysis logic.
</li>
<li class="listitem">
Fixes a bug in Elastic Defend&#8217;s redaction of diagnostics bundles.
</li>
</ul>
</div>
<div class="position-relative"><h3><a id="release-notes-8.18.0"></a>8.18.0</h3><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.18/docs/release-notes/8.18.asciidoc">edit</a></div>
<div class="position-relative"><h4><a id="known-issue-8.18.0"></a>Known issues</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.18/docs/release-notes/8.18.asciidoc">edit</a></div>
<details>
<summary class="title">The entity risk score feature may stop persisting risk score documents</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
On May 30, 2025, it was discovered that the entity risk score feature may stop persisting risk score documents if risk scoring was turned on before you upgraded to Elastic Stack 8.18.0 or higher.</p>
<p>This is due to a bug that prevents the <code class="literal">entity_analytics_create_eventIngest_from_timestamp-pipeline-&lt;space_name&gt;</code> ingest pipeline (which is set as a default pipeline for the risk scoring index in Elastic Stack 8.18.0) from being created when Kibana starts up.</p>
<p>While document persistence may initially succeed, it will eventually fail after 0 to 30 days. This is how long it takes for the risk score data stream to roll over and apply its underlying index settings to the new default pipeline.</p>
<p><span class="strong strong"><strong>Workaround</strong></span><br></p>
<p>To resolve this issue, apply the following workaround before or after upgrading to Elastic Stack 8.18.0 or higher.</p>
<p>First, manually create the ingest pipeline in each space that has entity risk scoring turned on. You can do this using a PUT request, which is described in the example below. When reviewing the example, note that <code class="literal">default</code> in the example ingest pipeline name below is the Kibana space ID.</p>
<pre class="screen">PUT /_ingest/pipeline/entity_analytics_create_eventIngest_from_timestamp-pipeline-default
{
  "_meta": {
    "managed_by": "entity_analytics",
    "managed": true
  },
  "description": "Pipeline for adding timestamp value to event.ingested",
  "processors": [
    {
      "set": {
        "field": "event.ingested",
        "value": "{{_ingest.timestamp}}"
      }
    }
  ]
}</pre>
<p>After you complete this step, risk scores should automatically begin to successfully persist during the entity risk engine&#8217;s next run. Details for the next run time are described on the <span class="strong strong"><strong>Entity risk score</strong></span> page, where you can also manually run the risk score by clicking <span class="strong strong"><strong>Run Engine</strong></span>.</p>
<p><span class="strong strong"><strong>Resolved</strong></span><br>
This issue is fixed in Elastic Stack version 8.18.3.</p>
</div>
</details>
<details>
<summary class="title">Rules cannot be enabled if they&#8217;re corrupted while upgrading from 7.17.x to 8.x</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
If rule saved objects were corrupted when you upgraded from 7.17.x to 8.x, you may run into an error when turning on your rules.</p>
<p><span class="strong strong"><strong>Workaround</strong></span><br></p>
<p>Duplicate your rules and enable them.</p>
</div>
</details>
<details>
<summary class="title">The technical preview badge incorrectly displays on the alert suppression fields for event correlation rules</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
On April 8, 2025, it was discovered that alert suppression for event correlation rules is incorrectly shown as being in technical preview when you create a new rule. For more information, check <a href="https://github.com/elastic/docs-content/issues/1021" class="ulink" target="_top">#1021</a>.</p>
<p><span class="strong strong"><strong>Resolved</strong></span><br>
This issue is fixed in Elastic Stack version 8.18.2.</p>
</div>
</details>
<details>
<summary class="title">Installing an Elastic Defend integration or a new agent policy upgrades installed prebuilt rules, reverting user customizations and overwriting user-added actions and exceptions</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
When you install an Elastic Defend integration or a new agent policy for this integration, all the installed prebuilt detection rules are upgraded to their latest versions (if any new versions are available). The upgraded rules lose any user-added rule actions and exceptions, as well as any user customizations, if you customized any other rule fields.</p>
<p><span class="strong strong"><strong>Workaround</strong></span><br>
To resolve this issue, before you add an Elastic Defend integration to a policy in Fleet, apply any pending prebuilt rule updates. This will prevent rule actions, exceptions, and customizations from being overwritten.</p>
<p><span class="strong strong"><strong>Resolved</strong></span><br>
This issue is fixed in Elastic Stack versions 8.17.6, 8.18.1, and 9.0.1.</p>
</div>
</details>
<details>
<summary class="title">Interaction between Elastic Defend and Trellix Access Protection causes IRQL_NOT_LESS_EQUAL bugcheck</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br></p>
<p>An <code class="literal">IRQL_NOT_LESS_EQUAL</code> <a href="https://learn.microsoft.com/en-us/windows-hardware/drivers/debugger/bug-checks--\blue-screens-" class="ulink" target="_top">bugcheck</a> in the Elastic Defend driver happens due to an interaction with Trellix Access Protection (<code class="literal">mfehidk.sys</code>). This issue can occur when <code class="literal">elastic-endpoint-driver.sys</code> calls <a href="https://learn.microsoft.com/en-us/windows/win32/api/fwpmu/nf-fwpmu-fwpmtransactionbegin0" class="ulink" target="_top"><code class="literal">FwpmTransactionBegin0</code></a> to initialize its network driver. <code class="literal">FwpmTransactionBegin0</code> performs a synchronous RPC call to the user-mode Base Filtering Engine service. Trellix&#8217;s driver intercepts this service&#8217;s operations, causing <code class="literal">FwpmTransactionBegin0</code> to hang or slow significantly. This delay prevents Elastic Defend driver from properly initializing in a timely manner. Subsequent system activity can invoke Elastic Defend&#8217;s driver before it has fully initialized, leading to a <code class="literal">IRQL_NOT_LESS_EQUAL</code> bugcheck. This issue affects Elastic Defend versions 8.16.0-8.16.6, 8.17.0-8.17.5, 8.18.0, and 9.0.0.</p>
<p><span class="strong strong"><strong>Workaround</strong></span><br></p>
<p>If you can&#8217;t upgrade, either disable Trellix Access Protection or add a <a href="https://docs.trellix.com/bundle/endpoint-security-10.6.0-threat-prevention-client-interface-reference-guide-windows/page/GUID-6AC245A1-5E5D-4BAF-93B0-FE7FD33571E6.html" class="ulink" target="_top">Trellix Access Protection exclusion</a> for the Base Filtering Engine service (<code class="literal">C:\Windows\System32\svchost.exe</code>).</p>
<p><span class="strong strong"><strong>Resolved</strong></span><br>
This issue is fixed in Elastic Defend versions 8.17.6, 8.18.1, and 9.0.1.</p>
</div>
</details>
<details>
<summary class="title">Unbounded kernel non-paged memory growth issue in Elastic Defend&#8217;s kernal driver causes slow down on Windows systems</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br></p>
<p>An unbounded kernel non-paged memory growth issue in Elastic Defend&#8217;s kernel driver occurs during extremely high event load situations on Windows. Systems affected by this issue will slow down or become unresponsive until the triggering event load (for example, network activity) subsides. We are only aware of this issue occurring on very busy Windows Server systems running Elastic Defend versions 8.16.0-8.16.6, 8.17.0-8.17.5, 8.18.0, and 9.0.0.</p>
<p><span class="strong strong"><strong>Workaround</strong></span><br></p>
<p>If you can&#8217;t upgrade, turn off the relevant event source at the kernel level using your Elastic Defend <a class="xref" href="configure-endpoint-integration-policy.html#adv-policy-settings" title="Advanced policy settings (optional)">advanced policy settings</a>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Network Events - Set the <code class="literal">windows.advanced.kernel.network</code> advanced setting to <code class="literal">false</code>.
</li>
<li class="listitem">
Registry Events - Set the <code class="literal">windows.advanced.kernel.registry</code> advanced setting to <code class="literal">false</code>.
</li>
</ul>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Clearing the corresponding checkbox under <a class="xref" href="configure-endpoint-integration-policy.html#event-collection" title="Event collection">Event Collection</a> is insufficient, as Elastic Defend may still process these event sources internally to support other features.</p>
</div>
</div>
<p><span class="strong strong"><strong>Resolved</strong></span><br>
This issue is fixed in Elastic Defend versions 8.17.6, 8.18.1, and 9.0.1.</p>
</div>
</details>
<div class="position-relative"><h4><a id="deprecations-8.18.0"></a>Deprecations</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.18/docs/release-notes/8.18.asciidoc">edit</a></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
The user and host risk score modules are being deprecated (<a href="https://github.com/elastic/kibana/pull/202775" class="ulink" target="_top">#202775</a>).
</li>
<li class="listitem">
<p>The following SIEM signal migration endpoints were deprecated (<a href="https://github.com/elastic/kibana/pull/202662" class="ulink" target="_top">#202662</a>):</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
POST /api/detection_engine/signals/migrations
</li>
<li class="listitem">
DELETE /api/detection_engine/signals/migrations
</li>
<li class="listitem">
POST /api/detection_engine/signals/finalize_migrations
</li>
<li class="listitem">
GET /api/detection_engine/signals/migration_status
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="position-relative"><h4><a id="features-8.18.0"></a>New features</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.18/docs/release-notes/8.18.asciidoc">edit</a></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Provides automatic migration for detection rules to help convert existing SIEM rules into Elastic equivalents.
</li>
<li class="listitem">
The Automatic Import functionality is now generally available (<a href="https://github.com/elastic/kibana/pull/208523" class="ulink" target="_top">#208523</a>).
</li>
<li class="listitem">
Adds in-text citations to AI assistant responses whenever fact providers (such as the knowledge base or alert information) are used to generate the response (<a href="https://github.com/elastic/kibana/pull/206683" class="ulink" target="_top">#206683</a>).
</li>
<li class="listitem">
Allows you to <a href="https://github.com/elastic/kibana/issues/174168" class="ulink" target="_top">customize prebuilt rules</a>. You can modify most rule parameters, export and import prebuilt rules — including customized ones — and upgrade prebuilt rules while retaining customization settings (<a href="https://github.com/elastic/kibana/pull/212761" class="ulink" target="_top">#212761</a>).
</li>
<li class="listitem">
Adds initial support for the service entity type in the Entity Store, whereas previously, only user and host entity types were supported (<a href="https://github.com/elastic/kibana/pull/207336" class="ulink" target="_top">#207336</a>, <a href="https://github.com/elastic/kibana/pull/206582" class="ulink" target="_top">#206582</a>, <a href="https://github.com/elastic/kibana/pull/206268" class="ulink" target="_top">#206268</a>, <a href="https://github.com/elastic/kibana/pull/202344" class="ulink" target="_top">#202344</a>).
</li>
<li class="listitem">
Allows you to configure how often the enrich policy runs for the entity store (<a href="https://github.com/elastic/kibana/pull/207374" class="ulink" target="_top">#207374</a>, <a href="https://github.com/elastic/kibana/pull/204437" class="ulink" target="_top">#204437</a>).
</li>
<li class="listitem">
Provides configuration options to the entity store through additional API parameters (<a href="https://github.com/elastic/kibana/pull/206421" class="ulink" target="_top">#206421</a>).
</li>
<li class="listitem">
Introduces a status tab to the entity store management page (<a href="https://github.com/elastic/kibana/pull/201235" class="ulink" target="_top">#201235</a>).
</li>
<li class="listitem">
Allows you to install and reinstall entity stores from the Engine Status page (<a href="https://github.com/elastic/kibana/pull/208149" class="ulink" target="_top">#208149</a>).
</li>
<li class="listitem">
Introduces ways to monitor and fix gaps in rule executions, which can lead to missed alerts or reduced rule coverage (<a href="https://github.com/elastic/kibana/pull/206313" class="ulink" target="_top">#206313</a>).
</li>
<li class="listitem">
The manual runs functionality is now generally available (<a href="https://github.com/elastic/kibana/pull/209535" class="ulink" target="_top">#209535</a>).
</li>
<li class="listitem">
Allows you to preview logged Elasticsearch requests for new terms, threshold, custom, and machine learning rule types (<a href="https://github.com/elastic/kibana/pull/203320" class="ulink" target="_top">#203320</a>).
</li>
<li class="listitem">
Adds support for suppressing alerts generated from even correlation rules that are using sequence queries (<a href="https://github.com/elastic/kibana/pull/189725" class="ulink" target="_top">#189725</a>).
</li>
<li class="listitem">
Allows you to add common observables to any case and extend the types of observable case data to include custom options (<a href="https://github.com/elastic/kibana/pull/190237" class="ulink" target="_top">#190237</a>).
</li>
<li class="listitem">
Introduces privileges that let you control role access to Timeline and notes (<a href="https://github.com/elastic/kibana/pull/201780" class="ulink" target="_top">#201780</a>).
</li>
<li class="listitem">
Introduces privileges that let you control whether a role can assign users to a case (<a href="https://github.com/elastic/kibana/pull/201654" class="ulink" target="_top">#201654</a>).
</li>
<li class="listitem">
Re-adds details to the alert details flyout about the last time an alert&#8217;s status was changed (<a href="https://github.com/elastic/kibana/pull/205224" class="ulink" target="_top">#205224</a>).
</li>
<li class="listitem">
Introduces changes to the asset criticality and risk score data clients to use a new ingest pipeline for adding event timestamps (<a href="https://github.com/elastic/kibana/pull/203975" class="ulink" target="_top">#203975</a>).
</li>
<li class="listitem">
Adds new third-party actions to CrowdStrike response actions, which will allow you to execute remote commands using Crowdstrike agent through Elastic Security (<a href="https://github.com/elastic/kibana/pull/203101" class="ulink" target="_top">#203101</a>, <a href="https://github.com/elastic/kibana/pull/202012" class="ulink" target="_top">#202012</a>, <a href="https://github.com/elastic/kibana/pull/203420" class="ulink" target="_top">#203420</a>, <a href="https://github.com/elastic/kibana/pull/204044" class="ulink" target="_top">#204044</a>).
</li>
<li class="listitem">
Applies the latest Elastic UI (EUI) theme to multiple areas of Elastic Security (<a href="https://github.com/elastic/kibana/pull/204007" class="ulink" target="_top">#204007</a>, <a href="https://github.com/elastic/kibana/pull/204908" class="ulink" target="_top">#204908</a>).
</li>
<li class="listitem">
Elastic Defend will now graphically report its protection status when launched from Windows Security Center.
</li>
<li class="listitem">
Adds new Elastic Defend fields, <code class="literal">process.Ext.command_line_truncated</code> and <code class="literal">process.parent.Ext.command_line_truncated</code> to indicate when the command line gathered by event sources is truncated because of size limitations.
</li>
<li class="listitem">
Elastic Defend staged artifact rollout is now generally available. Staged artifact rollout incrementally updates global artifacts, including malware models and behavioral rules. Each update cycle begins with a small percentage of cloud-connected systems receiving new artifacts. These systems then report any stability, performance, and protection efficacy issues. Over time, additional systems will receive the updates until all systems are updated to the latest artifacts. If any issues are identified, Elastic may halt the update process and rollback all participating systems to prior known-good artifacts. To support this process, participating Elastic Defend endpoints will report health-related telemetry to <code class="literal">telemetry.elastic.co</code>. Customers can control this behavior using the <code class="literal">[os].advanced.artifacts.global.channel</code> <a class="xref" href="configure-endpoint-integration-policy.html#adv-policy-settings" title="Advanced policy settings (optional)">advanced policy setting</a> (<a href="https://github.com/elastic/kibana/pull/202674" class="ulink" target="_top">#202674</a>).
</li>
<li class="listitem">
Adds a new field to the metrics section of the Elastic Defend metadata document called <code class="literal">top_process_trees</code>. This section will contain a list of the top noisy processes on the system, with "noisy" being based on how many events they generate.
</li>
<li class="listitem">
<p>Introduces <a class="xref" href="endpoint-data-volume.html" title="Configure data volume for Elastic Endpoint">new advanced settings</a> in the Elastic Defend integration policy to reduce the volume of data that Elastic Endpoint processes and ingests. The following new behaviors are enabled by default. You can turn them off by configuring your Elastic Defend integration policy advanced settings:</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Elastic Endpoint behavior is preserved on existing Elastic Defend policies.</p>
</div>
</div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic Endpoint will merge short lived process <code class="literal">create/terminate</code> events and <code class="literal">network connect/terminate</code> events so only a single document is produced.
</li>
<li class="listitem">
Elastic Endpoint will only include a small subset of data in the <code class="literal">host.*</code> fieldset in event documents.
</li>
<li class="listitem">
Elastic Endpoint will not report MD5 and SHA-1 hashes in event data.
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="position-relative"><h4><a id="enhancements-8.18.0"></a>Enhancements</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.18/docs/release-notes/8.18.asciidoc">edit</a></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Enhances Attack discovery by providing you with additional control over which alerts are included as context to the large language model (LLM) (<a href="https://github.com/elastic/kibana/pull/205070" class="ulink" target="_top">#205070</a>).
</li>
<li class="listitem">
Provides APIs for AI Assistant Knowledge Base entries (<a href="https://github.com/elastic/kibana/pull/206407" class="ulink" target="_top">#206407</a>).
</li>
<li class="listitem">
Adds the product documentation tool to AI Assistant to ensure product docs are installed and can be properly retrieved (<a href="https://github.com/elastic/kibana/pull/199694" class="ulink" target="_top">#199694</a>).
</li>
<li class="listitem">
Introduces support for the future integration of AI Assistant prompts in Kibana. (<a href="https://github.com/elastic/kibana/pull/207138" class="ulink" target="_top">#207138</a>).
</li>
<li class="listitem">
Adds audit logging for changes to AI Assistant knowledge base entries (<a href="https://github.com/elastic/kibana/pull/203349" class="ulink" target="_top">#203349</a>).
</li>
<li class="listitem">
Adds a service example to the entity store upload page (<a href="https://github.com/elastic/kibana/pull/209023" class="ulink" target="_top">#209023</a>).
</li>
<li class="listitem">
Updates the entity insight badge to open entity flyouts (<a href="https://github.com/elastic/kibana/pull/208287" class="ulink" target="_top">#208287</a>).
</li>
<li class="listitem">
Introduces changes to the entity analytics feature to support <code class="literal">event.ingested</code> as a configurable timestamp field for init and enable endpoints (<a href="https://github.com/elastic/kibana/pull/208201" class="ulink" target="_top">#208201</a>).
</li>
<li class="listitem">
Allows you to include closed alerts in risk score calculations (<a href="https://github.com/elastic/kibana/pull/201909" class="ulink" target="_top">#201909</a>).
</li>
<li class="listitem">
Turns the <code class="literal">securitySolution:enableVisualizationsInFlyout</code> <a class="xref" href="advanced-settings.html#visualizations-in-flyout" title="Access the event analyzer and Session View from the event or alert details flyout">advanced setting</a> on by default, which allows you to access the event analyzer and Session View in the <span class="strong strong"><strong>Visualize</strong></span> tab on the alert or event details flyout (<a href="https://github.com/elastic/kibana/pull/211319" class="ulink" target="_top">#211319</a>).
</li>
<li class="listitem">
Reduces the system performance impact of Elastic Defend file events.
</li>
<li class="listitem">
Improves Elastic Defend&#8217;s resilience in low memory situations.
</li>
<li class="listitem">
Updates the Elastic Defend policy status message to show the Elastic Defend policy name, revision, and Elastic Agent policy revision.
</li>
<li class="listitem">
Ensures that the data view selector on the rule creation form shows data view names instead of their defined indices (<a href="https://github.com/elastic/kibana/pull/214495" class="ulink" target="_top">#214495</a>).
</li>
<li class="listitem">
Allows rule actions (except for <span class="strong strong"><strong>Summary of alerts</strong></span> actions that run at a custom frequency) to activate during manual rule runs (<a href="https://github.com/elastic/kibana/pull/200784" class="ulink" target="_top">#200784</a>).
</li>
<li class="listitem">
Implements various performance optimizations to reduce Elastic Defend&#8217;s CPU usage and improve system responsiveness.
</li>
<li class="listitem">
Includes the Elastic Defend policy name and ID in alerts.
</li>
<li class="listitem">
Adds the <code class="literal">allow_cloud_features</code> advanced policy setting, which lets you explicitly list which cloud resources can be reached by Elastic Defend (<a href="https://github.com/elastic/kibana/pull/205785" class="ulink" target="_top">#205785</a>).
</li>
<li class="listitem">
Adds a new set of Elastic Defend fields <code class="literal">call_stack_final_hook_module</code> to API event behavior alerts, and optionally API events. These fields aid triage by identifying the presence of Win32 API hooks, including malware and 3rd party security products.
</li>
<li class="listitem">
Improves Elastic Defend script visibility and adds a new API event for <code class="literal">AmsiScanBuffer</code>, as well as AMSI enrichments for API events.
</li>
<li class="listitem">
Enhances Elastic Defend by including an improved fingerprint for <code class="literal">Memory_protection.unique_key_v2</code>. We recommend that any <code class="literal">shellcode_thread</code> exceptions based on the old <code class="literal">unique_key_v1</code> field be updated.
</li>
<li class="listitem">
Adds the <code class="literal">process.Ext.memory_region.region_start_bytes</code> field to Elastic Defend Windows memory signature alerts.
</li>
<li class="listitem">
Improves Elastic Defend host information accuracy, such as IP addresses. Elastic Defend was updating this information only during new policy application or at least once ever 24 hours, so this information could have been inaccurate for several hours, especially on roaming endpoints.
</li>
</ul>
</div>
<div class="position-relative"><h4><a id="bug-fixes-8.18.0"></a>Bug fixes</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.18/docs/release-notes/8.18.asciidoc">edit</a></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Fixes the unstructured system log flow for Automatic Import (<a href="https://github.com/elastic/kibana/pull/213042" class="ulink" target="_top">#213042</a>).
</li>
<li class="listitem">
Fixes missing ECS mappings for Automatic Import (<a href="https://github.com/elastic/kibana/pull/209057" class="ulink" target="_top">#209057</a>).
</li>
<li class="listitem">
Fixes how Automatic Import generates accesses for the field names that are not valid Painless identifiers (<a href="https://github.com/elastic/kibana/pull/205220" class="ulink" target="_top">#205220</a>).
</li>
<li class="listitem">
Ensures that the field mapping for Automatic Import contains the <code class="literal">@timestamp</code> field whenever possible (<a href="https://github.com/elastic/kibana/pull/204931" class="ulink" target="_top">#204931</a>).
</li>
<li class="listitem">
Ensures that Automatic Import uses the provided data stream description in the integration readme (<a href="https://github.com/elastic/kibana/pull/203236" class="ulink" target="_top">#203236</a>).
</li>
<li class="listitem">
Fixes the countdown for the next scheduled risk engine run (<a href="https://github.com/elastic/kibana/pull/203212" class="ulink" target="_top">#203212</a>).
</li>
<li class="listitem">
Ensures that Automatic Import uses the data stream name that you provide instead of a generic placeholder (<a href="https://github.com/elastic/kibana/pull/203106" class="ulink" target="_top">#203106</a>).
</li>
<li class="listitem">
Fixes the bug where pressing Enter reloaded the Automatic Import (<a href="https://github.com/elastic/kibana/pull/199894" class="ulink" target="_top">#199894</a>).
</li>
<li class="listitem">
Fixes a bug that prevented you from being able to select a connector for AI Assistant from the Elastic Security landing page (<a href="https://github.com/elastic/kibana/pull/213969" class="ulink" target="_top">#213969</a>).
</li>
<li class="listitem">
Updates prompts that you can use with the Amazon Bedrock connector (<a href="https://github.com/elastic/kibana/pull/213160" class="ulink" target="_top">#213160</a>).
</li>
<li class="listitem">
Fixes a bug in AI Assistant that caused the Bedrock region to always be <code class="literal">us-east-1</code> (<a href="https://github.com/elastic/kibana/pull/214251" class="ulink" target="_top">#214251</a>).
</li>
<li class="listitem">
Adds the <code class="literal">organizationId</code> and <code class="literal">projectId</code> OpenAI headers and other arbitrary headers (<a href="https://github.com/elastic/kibana/pull/213117" class="ulink" target="_top">#213117</a>).
</li>
<li class="listitem">
Fixes a bug that sometimes caused generic error message to appear in OpenAI (<a href="https://github.com/elastic/kibana/pull/205665" class="ulink" target="_top">#205665</a>).
</li>
<li class="listitem">
Improves copy for the entity store feature on the Entity Analytics dashboard (<a href="https://github.com/elastic/kibana/pull/210991" class="ulink" target="_top">#210991</a>).
</li>
<li class="listitem">
Removes the critical services count from Entity Analytics dashboard summary panel (<a href="https://github.com/elastic/kibana/pull/210827" class="ulink" target="_top">#210827</a>).
</li>
<li class="listitem">
Removes the prompt on the Entity Analytics dashboard that asks you to turn on the risk engine even though you have already done it (<a href="https://github.com/elastic/kibana/pull/210430" class="ulink" target="_top">#210430</a>).
</li>
<li class="listitem">
Adds a filter to the entity definition schema so it can be used to further filter entity store data (<a href="https://github.com/elastic/kibana/pull/208588" class="ulink" target="_top">#208588</a>).
</li>
<li class="listitem">
Improves the navigation and page descriptions for the Entity Store and Entity Risk Score pages (<a href="https://github.com/elastic/kibana/pull/209130" class="ulink" target="_top">#209130</a>).
</li>
<li class="listitem">
Fixes a bug that prevented the <code class="literal">indexPattern</code> parameter from being respected when you refreshed a data view (<a href="https://github.com/elastic/kibana/pull/215151" class="ulink" target="_top">#215151</a>).
</li>
<li class="listitem">
Ensures that Kibana space IDs are dynamically retrieved for entity risk scores in the entity flyout (<a href="https://github.com/elastic/kibana/pull/216063" class="ulink" target="_top">#216063</a>).
</li>
<li class="listitem">
Uses data from the risk engine&#8217;s saved object instead of your browser&#8217;s local storage when loading the Entity Risk Score page (<a href="https://github.com/elastic/kibana/pull/215304" class="ulink" target="_top">#215304</a>).
</li>
<li class="listitem">
Improves the confirmation message that appears when you update the configuration for a risk engine saved object (<a href="https://github.com/elastic/kibana/pull/211372" class="ulink" target="_top">#211372</a>).
</li>
<li class="listitem">
Fixes a navigation issue with the host and user flyouts that prevented the flyout details from refreshing (<a href="https://github.com/elastic/kibana/pull/209863" class="ulink" target="_top">#209863</a>).
</li>
<li class="listitem">
Ensures that you stay on your current page in the Rules table after editing or updating a rule (<a href="https://github.com/elastic/kibana/pull/209537" class="ulink" target="_top">#209537</a>).
</li>
<li class="listitem">
Fixes a bug that caused the preview panel to incorrectly persist after you opened the session viewer preview (<a href="https://github.com/elastic/kibana/pull/213455" class="ulink" target="_top">#213455</a>).
</li>
<li class="listitem">
Adds a "no data" message to the expanded event analyzer view in the alert details flyout when the event analyzer isn&#8217;t turned on (<a href="https://github.com/elastic/kibana/pull/211981" class="ulink" target="_top">#211981</a>).
</li>
<li class="listitem">
Fixes the order of the alert insights so they&#8217;re now shown from low risk to critical risk(<a href="https://github.com/elastic/kibana/pull/212980" class="ulink" target="_top">#212980</a>).
</li>
<li class="listitem">
Fixes bugs that prevents cell action in the Alerts table from properly rendering in the event rendered view (<a href="https://github.com/elastic/kibana/pull/212721" class="ulink" target="_top">#212721</a>).
</li>
<li class="listitem">
Fixes a bug that incorrectly concealed the the isolate host panel if you used the isolate host action from the alert preview (<a href="https://github.com/elastic/kibana/pull/211853" class="ulink" target="_top">#211853</a>).
</li>
<li class="listitem">
Fixes a bug that prevented you from seeing alert assignee details from the Alerts table or the alert details flyout (<a href="https://github.com/elastic/kibana/pull/211824" class="ulink" target="_top">#211824</a>).
</li>
<li class="listitem">
Fixes the width of the alerts table in rule preview (<a href="https://github.com/elastic/kibana/pull/214028" class="ulink" target="_top">#214028</a>).
</li>
<li class="listitem">
Fixes a bug that prevented the rule creation form from properly validating EQL queries when you added filters to the query (<a href="https://github.com/elastic/kibana/pull/212117" class="ulink" target="_top">#212117</a>).
</li>
<li class="listitem">
Makes 7.x alert indices compatible with Alerts table so you can access alerts in legacy indices (<a href="https://github.com/elastic/kibana/pull/209936" class="ulink" target="_top">#209936</a>).
</li>
<li class="listitem">
Fixes a bug that didn&#8217;t allow you to generate ES|QL alerts from alert indices (<a href="https://github.com/elastic/kibana/pull/208894" class="ulink" target="_top">#208894</a>).
</li>
<li class="listitem">
Surfaces shard failure details for failed EQL non-sequence queries on the rule details page and in the event log (<a href="https://github.com/elastic/kibana/pull/207396" class="ulink" target="_top">#207396</a>).
</li>
<li class="listitem">
Fixes an Elastic Defend bug to ensure the first event&#8217;s timestamp is used as the timestamp for event aggregation.
</li>
<li class="listitem">
Updates the way Elastic Defend initially connects to Elastic Agent, which significantly improves the speed of connection.
</li>
<li class="listitem">
Fixes issues where uninstalling Elastic Defend on Windows leaves files within Elastic Defend&#8217;s directory that cannot be removed by administrators. These leftover files can prevent subsequent installs and upgrades.
</li>
<li class="listitem">
Improves Elastic Defend by increasing the size of command line capture from 800 to 2400 bytes for kprobe-based Linux process event collection running amd64 machines.
</li>
<li class="listitem">
Improves Elastic Defend by improving <code class="literal">entity_id</code> algorithm for Windows Server 2012 to prevent it from being vulnerable to PID reuse.
</li>
</ul>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="release-notes.html">« Release notes</a>
</span>
<span class="next">
<a href="release-notes-header-8.17.0.html">8.17 »</a>
</span>
</div>
</body>
</html>
