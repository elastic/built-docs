<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>AWS IAM AdministratorAccess Policy Attached to Role | Elastic Security [8.19] | Elastic</title>
<meta class="elastic" name="content" content="AWS IAM AdministratorAccess Policy Attached to Role | Elastic Security [8.19]">

<link rel="home" href="index.html" title="Elastic Security [8.19]"/>
<link rel="up" href="prebuilt-rules.html" title="Prebuilt rule reference"/>
<link rel="prev" href="aws-iam-administratoraccess-policy-attached-to-group.html" title="AWS IAM AdministratorAccess Policy Attached to Group"/>
<link rel="next" href="aws-iam-administratoraccess-policy-attached-to-user.html" title="AWS IAM AdministratorAccess Policy Attached to User"/>
<meta class="elastic" name="product_version" content="8.19"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.19"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.19"/>
</head>
<body>
<div class="navheader">
<span class="prev">
<a href="aws-iam-administratoraccess-policy-attached-to-group.html">« AWS IAM AdministratorAccess Policy Attached to Group</a>
</span>
<span class="next">
<a href="aws-iam-administratoraccess-policy-attached-to-user.html">AWS IAM AdministratorAccess Policy Attached to User »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security [8.19]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="detection-engine-overview.html">Detections and alerts</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="prebuilt-rules.html">Prebuilt rule reference</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>AWS IAM AdministratorAccess Policy Attached to Role</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.19/docs/detections/prebuilt-rules/rule-details/aws-iam-administratoraccess-policy-attached-to-role.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div id="url-to-v3" class="version-warning">
    <strong>IMPORTANT</strong>: This documentation is no longer updated. Refer to <a href="https://www.elastic.co/support/eol">Elastic's version policy</a> and the <a href="https://www.elastic.co/docs/reference/security/prebuilt-rules/rules/integrations/aws/privilege_escalation_iam_administratoraccess_policy_attached_to_role">latest documentation</a>.
</div>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="aws-iam-administratoraccess-policy-attached-to-role"></a>AWS IAM AdministratorAccess Policy Attached to Role</h2><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.19/docs/detections/prebuilt-rules/rule-details/aws-iam-administratoraccess-policy-attached-to-role.asciidoc">edit</a></div>
</div></div></div>
<p>An adversary with access to a set of compromised credentials may attempt to persist or escalate privileges by attaching additional permissions to compromised IAM roles. This rule looks for use of the IAM AttachRolePolicy API operation to attach the highly permissive AdministratorAccess AWS managed policy to an existing IAM role.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: eql</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
logs-aws.cloudtrail-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5m</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/8.19/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule" title="Set the rule&#8217;s schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum alerts per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://docs.aws.amazon.com/IAM/latest/APIReference/API_AttachRolePolicy.html" class="ulink" target="_top">https://docs.aws.amazon.com/IAM/latest/APIReference/API_AttachRolePolicy.html</a>
</li>
<li class="listitem">
<a href="https://docs.aws.amazon.com/aws-managed-policy/latest/reference/AdministratorAccess.html" class="ulink" target="_top">https://docs.aws.amazon.com/aws-managed-policy/latest/reference/AdministratorAccess.html</a>
</li>
<li class="listitem">
<a href="https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/" class="ulink" target="_top">https://hackingthe.cloud/aws/exploitation/iam_privilege_escalation/</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Domain: Cloud
</li>
<li class="listitem">
Data Source: AWS
</li>
<li class="listitem">
Data Source: Amazon Web Services
</li>
<li class="listitem">
Data Source: AWS IAM
</li>
<li class="listitem">
Use Case: Identity and Access Audit
</li>
<li class="listitem">
Tactic: Privilege Escalation
</li>
<li class="listitem">
Tactic: Persistence
</li>
<li class="listitem">
Resources: Investigation Guide
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 7</p>
<p><span class="strong strong"><strong>Rule authors</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Rule license</strong></span>: Elastic License v2</p>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_investigation_guide_51"></a>Investigation guide</h3><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.19/docs/detections/prebuilt-rules/rule-details/aws-iam-administratoraccess-policy-attached-to-role.asciidoc">edit</a></div>
</div></div></div>
<p><span class="strong strong"><strong>Triage and analysis</strong></span></p>
<div class="quoteblock">
<blockquote>
<p><span class="strong strong"><strong>Disclaimer</strong></span>:
This investigation guide was created using generative AI technology and has been reviewed to improve its accuracy and relevance. While every effort has been made to ensure its quality, we recommend validating the content and adapting it to suit your specific environment and operational needs.</p>
</blockquote>
</div>
<p><span class="strong strong"><strong>Investigating AWS IAM AdministratorAccess Policy Attached to Role</strong></span></p>
<p>The <code class="literal">AdministratorAccess</code> managed policy grants unrestricted privileges.
When attached to a role, it can enable privilege escalation or persistence, especially if the role is assumable by other accounts or services.
This rule detects <code class="literal">AttachRolePolicy</code> events where the <code class="literal">policyName</code> is <code class="literal">AdministratorAccess</code>.</p>
<p><span class="strong strong"><strong>Possible investigation steps</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Identify both identities.</strong></span>
Determine the calling user or role (<code class="literal">aws.cloudtrail.user_identity.arn</code>) and the target role (<code class="literal">aws.cloudtrail.request_parameters.roleName</code>).
Validate whether this change aligns with intended administrative actions.
</li>
<li class="listitem">
<span class="strong strong"><strong>Review the target role’s trust policy.</strong></span>
Examine who can assume the role (<code class="literal">AssumeRolePolicyDocument</code>).
If the role is assumable by external accounts, this may indicate a potential persistence or lateral movement path.
</li>
<li class="listitem">
<span class="strong strong"><strong>Review CloudTrail details.</strong></span>
Check <code class="literal">source.ip</code>, <code class="literal">user_agent.original</code>, and <code class="literal">source.geo</code> fields for anomalies.
Compare with historical operations by the same principal.
</li>
<li class="listitem">
<span class="strong strong"><strong>Correlate with adjacent IAM events.</strong></span>
Look for <code class="literal">UpdateAssumeRolePolicy</code>, <code class="literal">CreateAccessKey</code>, or <code class="literal">PassRole</code> calls.
These often accompany privilege escalation activity.
</li>
<li class="listitem">
<span class="strong strong"><strong>Inspect downstream activity.</strong></span>
Query CloudTrail for recent <code class="literal">AssumeRole</code> calls for the target role — determine if the newly elevated permissions were used.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>False positive analysis</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Delegated role management.</strong></span>
Cloud administrators may legitimately grant temporary AdministratorAccess for troubleshooting. Confirm through tickets or change logs.
</li>
<li class="listitem">
<span class="strong strong"><strong>Automation or service-linked roles.</strong></span>
Some services attach policies automatically for setup; verify whether the target is a service-linked role.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Response and remediation</strong></span></p>
<p><span class="strong strong"><strong>1. Immediate containment</strong></span>
- Detach the policy. Remove the <code class="literal">AdministratorAccess</code> policy from the target role.
- Restrict access. Temporarily revoke the caller’s IAM privileges until the legitimacy of the action is confirmed.
- Audit trust policies. Review the role’s trust relationships to ensure only approved principals can assume it.
- Rotate credentials for any principals who assumed the affected role during the period of elevated privileges.</p>
<p><span class="strong strong"><strong>2. Evidence preservation</strong></span>
- Export the triggering <code class="literal">AttachRolePolicy</code> event and related CloudTrail entries ±30 minutes from the alert.
- Preserve AWS Config snapshots and GuardDuty findings for traceability.</p>
<p><span class="strong strong"><strong>3. Scoping and investigation</strong></span>
- Identify if the elevated role was subsequently assumed.
  Correlate by matching <code class="literal">aws.cloudtrail.eventName:AssumeRole</code> with the target role ARN.
- Search for other recent IAM policy attachments or modifications by the same actor or IP.</p>
<p><span class="strong strong"><strong>4. Recovery and hardening</strong></span>
- Apply least privilege policies; limit who can attach or modify administrative policies.
- Enforce IAM Conditions such as <code class="literal">aws:PrincipalArn</code> or <code class="literal">aws:ResourceTag</code> to limit policy attachment scope.
- Enable CloudTrail, GuardDuty, and Security Hub across all regions.
- Implement SCPs at the organization level to restrict direct <code class="literal">AdministratorAccess</code> attachments.</p>
<p><span class="strong strong"><strong>Additional information</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
**https://github.com/aws-samples/aws-incident-response-playbooks/blob/c151b0dc091755fffd4d662a8f29e2f6794da52c/playbooks/[AWS IR Playbooks]: response steps related to IAM policy modification and unauthorized privilege escalation..
</li>
<li class="listitem">
**https://github.com/aws-samples/aws-customer-playbook-framework/[AWS Customer Playbook Framework]: for containment, analysis, and recovery guidance.
</li>
<li class="listitem">
<span class="strong strong"><strong>AWS Documentation:</strong></span> <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_job-functions.html#jf_administrator" class="ulink" target="_top">AdministratorAccess Policy</a>.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_rule_query_52"></a>Rule query</h3><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.19/docs/detections/prebuilt-rules/rule-details/aws-iam-administratoraccess-policy-attached-to-role.asciidoc">edit</a></div>
</div></div></div>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">iam where event.dataset == "aws.cloudtrail"
   and event.provider == "iam.amazonaws.com"
   and event.action == "AttachRolePolicy"
   and event.outcome == "success"
   and stringContains(aws.cloudtrail.request_parameters, "policyArn=arn:aws:iam::aws:policy/AdministratorAccess")</pre>
</div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Privilege Escalation
</li>
<li class="listitem">
ID: TA0004
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0004/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0004/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Account Manipulation
</li>
<li class="listitem">
ID: T1098
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1098/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1098/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Sub-technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Additional Cloud Roles
</li>
<li class="listitem">
ID: T1098.003
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1098/003/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1098/003/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Persistence
</li>
<li class="listitem">
ID: TA0003
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0003/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0003/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Account Manipulation
</li>
<li class="listitem">
ID: T1098
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1098/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1098/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Sub-technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Additional Cloud Roles
</li>
<li class="listitem">
ID: T1098.003
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1098/003/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1098/003/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="aws-iam-administratoraccess-policy-attached-to-group.html">« AWS IAM AdministratorAccess Policy Attached to Group</a>
</span>
<span class="next">
<a href="aws-iam-administratoraccess-policy-attached-to-user.html">AWS IAM AdministratorAccess Policy Attached to User »</a>
</span>
</div>
</body>
</html>
