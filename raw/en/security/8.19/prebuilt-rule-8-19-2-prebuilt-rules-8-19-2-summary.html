<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Update v8.19.2 | Elastic Security [8.19] | Elastic</title>
<meta class="elastic" name="content" content="Update v8.19.2 | Elastic Security [8.19]">

<link rel="home" href="index.html" title="Elastic Security [8.19]"/>
<link rel="up" href="prebuilt-rules-downloadable-updates.html" title="Downloadable rule updates"/>
<link rel="prev" href="prebuilt-rule-8-19-1-prebuilt-rules-8-19-1-summary.html" title="Update v8.19.1"/>
<link rel="next" href="endpoint-protection-intro.html" title="Configure endpoint protection with Elastic Defend"/>
<meta class="elastic" name="product_version" content="8.19"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.19"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.19"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
This documentation contains work-in-progress information for future Elastic Stack and Cloud releases. Use the version selector to view supported release docs. It also contains some Elastic Cloud serverless information. Check out our <a href="https://www.elastic.co/docs/current/serverless">serverless docs</a> for more details.
</div>
<div class="navheader">
<span class="prev">
<a href="prebuilt-rule-8-19-1-prebuilt-rules-8-19-1-summary.html">« Update v8.19.1</a>
</span>
<span class="next">
<a href="endpoint-protection-intro.html">Configure endpoint protection with Elastic Defend »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security [8.19]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="detection-engine-overview.html">Detections and alerts</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="prebuilt-rules-downloadable-updates.html">Downloadable rule updates</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Update v8.19.2</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.19/docs/detections/prebuilt-rules/downloadable-packages/8-19-2/prebuilt-rules-8-19-2-summary.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div id="url-to-v3" class="version-warning">
    <strong>IMPORTANT</strong>: This documentation is no longer updated. Refer to <a href="https://www.elastic.co/support/eol">Elastic's version policy</a> and the <a href="https://www.elastic.co/docs">latest documentation</a>.
</div>
<div class="section xpack">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="prebuilt-rule-8-19-2-prebuilt-rules-8-19-2-summary"></a>Update v8.19.2</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.19/docs/detections/prebuilt-rules/downloadable-packages/8-19-2/prebuilt-rules-8-19-2-summary.asciidoc">edit</a></div>
</div></div></div>
<p>This section lists all updates associated with version 8.19.2 of the Fleet integration <span class="strong strong"><strong>Prebuilt Security Detection Rules</strong></span>.</p>
<div class="informaltable">
<table border="1" cellpadding="4px" width="100%">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Rule</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Status</th>
<th align="left" valign="top">Version</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-19-2-excessive-secret-or-key-retrieval-from-azure-key-vault.html" title="Excessive Secret or Key Retrieval from Azure Key Vault">Excessive Secret or Key Retrieval from Azure Key Vault</a></p></td>
<td align="left" valign="top"><p>Identifies excessive secret or key retrieval operations from Azure Key Vault. This rule detects when a user principal retrieves secrets or keys from Azure Key Vault multiple times within a short time frame, which may indicate potential abuse or unauthorized access attempts. The rule focuses on high-frequency retrieval operations that deviate from normal user behavior, suggesting possible credential harvesting or misuse of sensitive information.</p></td>
<td align="left" valign="top"><p>new</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-19-2-azure-key-vault-secret-key-usage-by-unusual-identity.html" title="Azure Key Vault Secret Key Usage by Unusual Identity">Azure Key Vault Secret Key Usage by Unusual Identity</a></p></td>
<td align="left" valign="top"><p>Identifies secrets, keys, or certificates retrieval operations from Azure Key Vault by a user principal that has not been seen previously doing so in a certain amount of days. Azure Key Vault is a cloud service for securely storing and accessing secrets, keys, and certificates. Unauthorized or excessive retrievals may indicate potential abuse or unauthorized access attempts.</p></td>
<td align="left" valign="top"><p>new</p></td>
<td align="left" valign="top"><p>2</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-19-2-teamfiltration-user-agents-detected.html" title="TeamFiltration User-Agents Detected">TeamFiltration User-Agents Detected</a></p></td>
<td align="left" valign="top"><p>Identifies potential enumeration or password spraying activity using TeamFiltration tool. TeamFiltration is an open-source enumeration, password spraying and exfiltration tool designed for Entra ID and Microsoft 365. Adversaries are known to use TeamFiltration in-the-wild to enumerate users, groups, and roles, as well as to perform password spraying attacks against Microsoft Entra ID and Microsoft 365 accounts. This rule detects the use of TeamFiltration by monitoring for specific user-agent strings associated with the tool in Azure and Microsoft 365 logs.</p></td>
<td align="left" valign="top"><p>new</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-19-2-oidc-discovery-url-changed-in-entra-id.html" title="OIDC Discovery URL Changed in Entra ID">OIDC Discovery URL Changed in Entra ID</a></p></td>
<td align="left" valign="top"><p>Detects a change to the OpenID Connect (OIDC) discovery URL in the Entra ID Authentication Methods Policy. This behavior may indicate an attempt to federate Entra ID with an attacker-controlled identity provider, enabling bypass of multi-factor authentication (MFA) and unauthorized access through bring-your-own IdP (BYOIDP) methods.</p></td>
<td align="left" valign="top"><p>new</p></td>
<td align="left" valign="top"><p>2</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-19-2-external-authentication-method-addition-or-modification-in-entra-id.html" title="External Authentication Method Addition or Modification in Entra ID">External Authentication Method Addition or Modification in Entra ID</a></p></td>
<td align="left" valign="top"><p>Identifies when an external authentication method (EAM) is added or modified in Entra ID. EAM may allow adversaries to bypass multi-factor authentication (MFA) requirements, potentially leading to unauthorized access to user accounts and sensitive resources by using bring-your-own IdP (BYOIDP) methods.</p></td>
<td align="left" valign="top"><p>new</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-19-2-kubernetes-unusual-decision-by-user-agent.html" title="Kubernetes Unusual Decision by User Agent">Kubernetes Unusual Decision by User Agent</a></p></td>
<td align="left" valign="top"><p>This rule detects unusual request responses in Kubernetes audit logs through the use of the "new_terms" rule type. In production environments, default API requests are typically made by system components or trusted users, who are expected to have a consistent user agent and allowed response annotations. By monitoring for anomalies in the username and response annotations, this rule helps identify potential unauthorized access or misconfigurations in the Kubernetes environment.</p></td>
<td align="left" valign="top"><p>new</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-19-2-potential-impersonation-attempt-via-kubectl.html" title="Potential Impersonation Attempt via Kubectl">Potential Impersonation Attempt via Kubectl</a></p></td>
<td align="left" valign="top"><p>This rule detects potential impersonation attempts via the "kubectl" command in Linux environments. It identifies process events where "kubectl" is executed with arguments that suggest an attempt to impersonate another user or group, such as using "--kubeconfig", "--token", "--as", or "--as-group". This could indicate an adversary trying to gain unauthorized access or escalate privileges within a Kubernetes cluster. If this rule is triggered, in conjunction with rules related to secret access or kubeconfig file discovery, it may indicate a potential impersonation attempt.</p></td>
<td align="left" valign="top"><p>new</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-19-2-unusual-kill-signal.html" title="Unusual Kill Signal">Unusual Kill Signal</a></p></td>
<td align="left" valign="top"><p>This rule detects the use of unusual kill signals, specifically kill signals in the range of 32-64, which are not commonly used in standard operations. Rootkits may leverage these signals to conduct certain actions, such as manipulating processes in unexpected ways, potentially escalating privileges or evading detection.</p></td>
<td align="left" valign="top"><p>new</p></td>
<td align="left" valign="top"><p>1</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-19-2-sudoers-file-modification.html" title="Sudoers File Modification">Sudoers File Modification</a></p></td>
<td align="left" valign="top"><p>A sudoers file specifies the commands that users or groups can run and from which terminals. Adversaries can take advantage of these configurations to execute commands as other users or spawn processes with higher privileges.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>209</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-19-2-aws-systems-manager-securestring-parameter-request-with-decryption-flag.html" title="AWS Systems Manager SecureString Parameter Request with Decryption Flag">AWS Systems Manager SecureString Parameter Request with Decryption Flag</a></p></td>
<td align="left" valign="top"><p>Detects the first occurrence of a user identity accessing AWS Systems Manager (SSM) SecureString parameters using the GetParameter or GetParameters API actions with credentials in the request parameters. This could indicate that the user is accessing sensitive information. This rule detects when a user accesses a SecureString parameter with the withDecryption parameter set to true. This is a New Terms rule that detects the first occurrence of an AWS identity accessing SecureString parameters with decryption.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>6</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-19-2-insecure-aws-ec2-vpc-security-group-ingress-rule-added.html" title="Insecure AWS EC2 VPC Security Group Ingress Rule Added">Insecure AWS EC2 VPC Security Group Ingress Rule Added</a></p></td>
<td align="left" valign="top"><p>Identifies when a specified inbound (ingress) rule is added or adjusted for a VPC security group in AWS EC2. This rule detects when a security group rule is added that allows traffic from any IP address or from a specific IP address to common remote access ports, such as 22 (SSH) or 3389 (RDP). Adversaries may add these rules to allow remote access to VPC instances from any location, increasing the attack surface and potentially exposing the instances to unauthorized access.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>5</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-19-2-aws-ec2-deprecated-ami-discovery.html" title="AWS EC2 Deprecated AMI Discovery">AWS EC2 Deprecated AMI Discovery</a></p></td>
<td align="left" valign="top"><p>Identifies when a user has queried for deprecated Amazon Machine Images (AMIs) in AWS. This may indicate an adversary looking for outdated AMIs that may be vulnerable to exploitation. While deprecated AMIs are not inherently malicious or indicative of a breach, they may be more susceptible to vulnerabilities and should be investigated for potential security risks.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>6</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-19-2-aws-ec2-user-data-retrieval-for-ec2-instance.html" title="AWS EC2 User Data Retrieval for EC2 Instance">AWS EC2 User Data Retrieval for EC2 Instance</a></p></td>
<td align="left" valign="top"><p>Identifies discovery request DescribeInstanceAttribute with the attribute userData and instanceId in AWS CloudTrail logs. This may indicate an attempt to retrieve user data from an EC2 instance. Adversaries may use this information to gather sensitive data from the instance such as hardcoded credentials or to identify potential vulnerabilities. This is a New Terms rule that identifies the first time an IAM user or role requests the user data for a specific EC2 instance.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>7</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-19-2-aws-ssm-sendcommand-execution-by-rare-user.html" title="AWS SSM SendCommand Execution by Rare User">AWS SSM <code class="literal">SendCommand</code> Execution by Rare User</a></p></td>
<td align="left" valign="top"><p>Detects the execution of commands or scripts on EC2 instances using AWS Systems Manager (SSM), such as RunShellScript, RunPowerShellScript or custom documents. While legitimate users may employ these commands for management tasks, they can also be exploited by attackers with credentials to establish persistence, install malware, or execute reverse shells for further access to compromised instances. This is a New Terms rule that looks for the first instance of this behavior by a user or role.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>215</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-19-2-aws-dynamodb-table-exported-to-s3.html" title="AWS DynamoDB Table Exported to S3">AWS DynamoDB Table Exported to S3</a></p></td>
<td align="left" valign="top"><p>Identifies when an AWS DynamoDB table is exported to S3. Adversaries may use the ExportTableToPointInTime operation to collect sensitive information or exfiltrate data from DynamoDB tables. This rule detects unusual user activity by monitoring for the ExportTableToPointInTime action in CloudTrail logs. This is a New Terms rule that only flags when this behavior is observed by the "user.name" for the first time.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>4</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-19-2-aws-ec2-ami-shared-with-another-account.html" title="AWS EC2 AMI Shared with Another Account">AWS EC2 AMI Shared with Another Account</a></p></td>
<td align="left" valign="top"><p>Identifies an AWS Amazon Machine Image (AMI) being shared with another AWS account. Adversaries with access may share an AMI with an external AWS account as a means of data exfiltration. AMIs can contain secrets, bash histories, code artifacts, and other sensitive data that adversaries may abuse if shared with unauthorized accounts. AMIs can be made publicly available accidentally as well.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>6</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-19-2-excessive-aws-s3-object-encryption-with-sse-c.html" title="Excessive AWS S3 Object Encryption with SSE-C">Excessive AWS S3 Object Encryption with SSE-C</a></p></td>
<td align="left" valign="top"><p>Identifies a high-volume of AWS S3 objects stored in a bucket using using Server-Side Encryption with Customer-Provided Keys (SSE-C). Adversaries with compromised AWS credentials can encrypt objects in an S3 bucket using their own encryption keys, rendering the objects unreadable or recoverable without the key. This can be used as a form of ransomware to extort the bucket owner for the decryption key. This is a Threshold rule that triggers when this behavior is observed multiple times for a specific bucket in a short time-window.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>4</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-19-2-aws-s3-object-encryption-using-external-kms-key.html" title="AWS S3 Object Encryption Using External KMS Key">AWS S3 Object Encryption Using External KMS Key</a></p></td>
<td align="left" valign="top"><p>Identifies <code class="literal">CopyObject</code> events within an S3 bucket using an AWS KMS key from an external account for encryption. Adversaries with access to a misconfigured S3 bucket and the proper permissions may encrypt objects with an external KMS key to deny their victims access to their own data.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>5</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-19-2-unusual-aws-s3-object-encryption-with-sse-c.html" title="Unusual AWS S3 Object Encryption with SSE-C">Unusual AWS S3 Object Encryption with SSE-C</a></p></td>
<td align="left" valign="top"><p>Identifies when AWS S3 objects stored in a bucket are encrypted using Server-Side Encryption with Customer-Provided Keys (SSE-C). Adversaries with compromised AWS credentials can encrypt objects in an S3 bucket using their own encryption keys, rendering the objects unreadable or recoverable without the key. This can be used as a form of ransomware to extort the bucket owner for the decryption key. This is a New Terms rule that flags when this behavior is observed for the first time user and target bucket name.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>4</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-19-2-aws-ec2-security-group-configuration-change.html" title="AWS EC2 Security Group Configuration Change">AWS EC2 Security Group Configuration Change</a></p></td>
<td align="left" valign="top"><p>Identifies a change to an AWS Security Group Configuration. A security group is like a virtual firewall, and modifying configurations may allow unauthorized access. Threat actors may abuse this to establish persistence, exfiltrate data, or pivot in an AWS environment.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>211</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-19-2-aws-iam-api-calls-via-temporary-session-tokens.html" title="AWS IAM API Calls via Temporary Session Tokens">AWS IAM API Calls via Temporary Session Tokens</a></p></td>
<td align="left" valign="top"><p>Detects use of sensitive AWS IAM API operations using temporary credentials (session tokens starting with <em>ASIA</em>). This may indicate credential theft or abuse of elevated access via a stolen session. It is not common for legitimate users to perform sensitive IAM operations with temporary session tokens.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>3</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-19-2-aws-iam-user-created-access-keys-for-another-user.html" title="AWS IAM User Created Access Keys For Another User">AWS IAM User Created Access Keys For Another User</a></p></td>
<td align="left" valign="top"><p>An adversary with access to a set of compromised credentials may attempt to persist or escalate privileges by creating a new set of credentials for an existing user. This rule looks for use of the IAM <code class="literal">CreateAccessKey</code> API operation to create new programmatic access keys for another IAM user.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>7</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-19-2-aws-iam-administratoraccess-policy-attached-to-group.html" title="AWS IAM AdministratorAccess Policy Attached to Group">AWS IAM AdministratorAccess Policy Attached to Group</a></p></td>
<td align="left" valign="top"><p>An adversary with access to a set of compromised credentials may attempt to persist or escalate privileges by attaching additional permissions to user groups the compromised user account belongs to. This rule looks for use of the IAM <code class="literal">AttachGroupPolicy</code> API operation to attach the highly permissive <code class="literal">AdministratorAccess</code> AWS managed policy to an existing IAM user group.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>5</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-19-2-aws-iam-administratoraccess-policy-attached-to-role.html" title="AWS IAM AdministratorAccess Policy Attached to Role">AWS IAM AdministratorAccess Policy Attached to Role</a></p></td>
<td align="left" valign="top"><p>An adversary with access to a set of compromised credentials may attempt to persist or escalate privileges by attaching additional permissions to compromised IAM roles. This rule looks for use of the IAM <code class="literal">AttachRolePolicy</code> API operation to attach the highly permissive <code class="literal">AdministratorAccess</code> AWS managed policy to an existing IAM role.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>5</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-19-2-aws-iam-administratoraccess-policy-attached-to-user.html" title="AWS IAM AdministratorAccess Policy Attached to User">AWS IAM AdministratorAccess Policy Attached to User</a></p></td>
<td align="left" valign="top"><p>An adversary with access to a set of compromised credentials may attempt to persist or escalate privileges by attaching additional permissions to compromised user accounts. This rule looks for use of the IAM <code class="literal">AttachUserPolicy</code> API operation to attach the highly permissive <code class="literal">AdministratorAccess</code> AWS managed policy to an existing IAM user.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>6</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-19-2-aws-iam-customer-managed-policy-attached-to-role-by-rare-user.html" title="AWS IAM Customer-Managed Policy Attached to Role by Rare User">AWS IAM Customer-Managed Policy Attached to Role by Rare User</a></p></td>
<td align="left" valign="top"><p>Detects when an AWS Identity and Access Management (IAM) customer-managed policy is attached to a role by an unusual or unauthorized user. Customer-managed policies are policies created and controlled within an AWS account, granting specific permissions to roles or users when attached. This rule identifies potential privilege escalation by flagging cases where a customer-managed policy is attached to a role by an unexpected actor, which could signal unauthorized access or misuse. Attackers may attach policies to roles to expand permissions and elevate their privileges within the AWS environment. This is a New Terms rule that uses the "cloud.account.id", "user.name" and "target.entity.id" fields to check if the combination of the actor identity and target role name has not been seen before.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>5</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-19-2-aws-iam-assume-role-policy-update.html" title="AWS IAM Assume Role Policy Update">AWS IAM Assume Role Policy Update</a></p></td>
<td align="left" valign="top"><p>Identifies AWS CloudTrail events where an IAM role&#8217;s trust policy has been updated by an IAM user or Assumed Role identity. The trust policy is a JSON document that defines which principals are allowed to assume the role. An attacker may attempt to modify this policy to gain the privileges of the role. This is a New Terms rule, which means it will only trigger once for each unique combination of the "cloud.account.id", "user.name" and "target.entity.id" fields, that have not been seen making this API request.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>214</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-19-2-microsoft-entra-id-sign-in-brute-force-activity.html" title="Microsoft Entra ID Sign-In Brute Force Activity">Microsoft Entra ID Sign-In Brute Force Activity</a></p></td>
<td align="left" valign="top"><p>Identifies potential brute-force attacks targeting user accounts by analyzing failed sign-in patterns in Microsoft Entra ID Sign-In Logs. This detection focuses on a high volume of failed interactive or non-interactive authentication attempts within a short time window, often indicative of password spraying, credential stuffing, or password guessing. Adversaries may use these techniques to gain unauthorized access to applications integrated with Entra ID or to compromise valid user accounts.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>3</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-19-2-azure-key-vault-modified.html" title="Azure Key Vault Modified">Azure Key Vault Modified</a></p></td>
<td align="left" valign="top"><p>Identifies modifications to a Key Vault in Azure. The Key Vault is a service that safeguards encryption keys and secrets like certificates, connection strings, and passwords. Because this data is sensitive and business critical, access to key vaults should be secured to allow only authorized applications and users. This is a New Terms rule that detects when this activity hasn&#8217;t been seen by the user in a specified time frame.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>107</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-19-2-microsoft-entra-id-session-reuse-with-suspicious-graph-access.html" title="Microsoft Entra ID Session Reuse with Suspicious Graph Access">Microsoft Entra ID Session Reuse with Suspicious Graph Access</a></p></td>
<td align="left" valign="top"><p>Identifies potential session hijacking or token replay in Microsoft Entra ID. This rule detects cases where a user signs in and subsequently accesses Microsoft Graph from a different IP address using the same session ID within a short time window. This may indicate the use of a stolen refresh/access token or session cookie to impersonate the user and interact with Microsoft services.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>2</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-19-2-m365-onedrive-excessive-file-downloads-with-oauth-token.html" title="M365 OneDrive Excessive File Downloads with OAuth Token">M365 OneDrive Excessive File Downloads with OAuth Token</a></p></td>
<td align="left" valign="top"><p>Identifies when an excessive number of files are downloaded from OneDrive using OAuth authentication. Adversaries may conduct phishing campaigns to steal OAuth tokens and impersonate users. These access tokens can then be used to download files from OneDrive.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>2</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-19-2-multiple-microsoft-365-user-account-lockouts-in-short-time-window.html" title="Multiple Microsoft 365 User Account Lockouts in Short Time Window">Multiple Microsoft 365 User Account Lockouts in Short Time Window</a></p></td>
<td align="left" valign="top"><p>Detects a burst of Microsoft 365 user account lockouts within a short 5-minute window. A high number of IdsLocked login errors across multiple user accounts may indicate brute-force attempts for the same users resulting in lockouts.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>2</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-19-2-multiple-device-token-hashes-for-single-okta-session.html" title="Multiple Device Token Hashes for Single Okta Session">Multiple Device Token Hashes for Single Okta Session</a></p></td>
<td align="left" valign="top"><p>This rule detects when a specific Okta actor has multiple device token hashes for a single Okta session. This may indicate an authenticated session has been hijacked or is being used by multiple devices. Adversaries may hijack a session to gain unauthorized access to Okta admin console, applications, tenants, or other resources.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>306</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-19-2-multiple-okta-user-authentication-events-with-client-address.html" title="Multiple Okta User Authentication Events with Client Address">Multiple Okta User Authentication Events with Client Address</a></p></td>
<td align="left" valign="top"><p>Detects when a certain threshold of Okta user authentication events are reported for multiple users from the same client address. Adversaries may attempt to launch a credential stuffing or password spraying attack from the same device by using a list of known usernames and passwords to gain unauthorized access to user accounts.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>205</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-19-2-multiple-okta-user-authentication-events-with-same-device-token-hash.html" title="Multiple Okta User Authentication Events with Same Device Token Hash">Multiple Okta User Authentication Events with Same Device Token Hash</a></p></td>
<td align="left" valign="top"><p>Detects when a high number of Okta user authentication events are reported for multiple users in a short time frame. Adversaries may attempt to launch a credential stuffing or password spraying attack from the same device by using a list of known usernames and passwords to gain unauthorized access to user accounts.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>205</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-19-2-high-number-of-okta-device-token-cookies-generated-for-authentication.html" title="High Number of Okta Device Token Cookies Generated for Authentication">High Number of Okta Device Token Cookies Generated for Authentication</a></p></td>
<td align="left" valign="top"><p>Detects when an Okta client address has a certain threshold of Okta user authentication events with multiple device token hashes generated for single user authentication. Adversaries may attempt to launch a credential stuffing or password spraying attack from the same device by using a list of known usernames and passwords to gain unauthorized access to user accounts.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>205</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-19-2-okta-user-sessions-started-from-different-geolocations.html" title="Okta User Sessions Started from Different Geolocations">Okta User Sessions Started from Different Geolocations</a></p></td>
<td align="left" valign="top"><p>Detects when a specific Okta actor has multiple sessions started from different geolocations. Adversaries may attempt to launch an attack by using a list of known usernames and passwords to gain unauthorized access to user accounts from different locations.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>306</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-19-2-high-number-of-egress-network-connections-from-unusual-executable.html" title="High Number of Egress Network Connections from Unusual Executable">High Number of Egress Network Connections from Unusual Executable</a></p></td>
<td align="left" valign="top"><p>This rule detects a high number of egress network connections from an unusual executable on a Linux system. This could indicate a command and control (C2) communication attempt, a brute force attack via a malware infection, or other malicious activity. ESQL rules have limited fields available in its alert documents. Make sure to review the original documents to aid in the investigation of this alert.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>4</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-19-2-unusual-base64-encoding-decoding-activity.html" title="Unusual Base64 Encoding/Decoding Activity">Unusual Base64 Encoding/Decoding Activity</a></p></td>
<td align="left" valign="top"><p>This rule leverages ESQL to detect unusual base64 encoding/decoding activity on Linux systems. Attackers may use base64 encoding/decoding to obfuscate data, such as command and control traffic or payloads, to evade detection by host- or network-based security controls. ESQL rules have limited fields available in its alert documents. Make sure to review the original documents to aid in the investigation of this alert.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>4</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-19-2-potential-port-scanning-activity-from-compromised-host.html" title="Potential Port Scanning Activity from Compromised Host">Potential Port Scanning Activity from Compromised Host</a></p></td>
<td align="left" valign="top"><p>This rule detects potential port scanning activity from a compromised host. Port scanning is a common reconnaissance technique used by attackers to identify open ports and services on a target system. A compromised host may exhibit port scanning behavior when an attacker is attempting to map out the network topology, identify vulnerable services, or prepare for further exploitation. This rule identifies potential port scanning activity by monitoring network connection attempts from a single host to a large number of ports within a short time frame. ESQL rules have limited fields available in its alert documents. Make sure to review the original documents to aid in the investigation of this alert.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>4</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-19-2-potential-subnet-scanning-activity-from-compromised-host.html" title="Potential Subnet Scanning Activity from Compromised Host">Potential Subnet Scanning Activity from Compromised Host</a></p></td>
<td align="left" valign="top"><p>This rule detects potential subnet scanning activity from a compromised host. Subnet scanning is a common reconnaissance technique used by attackers to identify live hosts within a network range. A compromised host may exhibit subnet scanning behavior when an attacker is attempting to map out the network topology, identify vulnerable hosts, or prepare for further exploitation. This rule identifies potential subnet scanning activity by monitoring network connection attempts from a single host to a large number of hosts within a short time frame. ESQL rules have limited fields available in its alert documents. Make sure to review the original documents to aid in the investigation of this alert.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>4</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-19-2-unusual-file-transfer-utility-launched.html" title="Unusual File Transfer Utility Launched">Unusual File Transfer Utility Launched</a></p></td>
<td align="left" valign="top"><p>This rule leverages ESQL to detect the execution of unusual file transfer utilities on Linux systems. Attackers may use these utilities to exfiltrate data from a compromised system. ESQL rules have limited fields available in its alert documents. Make sure to review the original documents to aid in the investigation of this alert.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>4</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-19-2-potential-malware-driven-ssh-brute-force-attempt.html" title="Potential Malware-Driven SSH Brute Force Attempt">Potential Malware-Driven SSH Brute Force Attempt</a></p></td>
<td align="left" valign="top"><p>This detection identifies a Linux host that has potentially been infected with malware and is being used to conduct brute-force attacks against external systems over SSH (port 22 and common alternative SSH ports). The detection looks for a high volume of outbound connection attempts to non-private IP addresses from a single process. A compromised host may be part of a botnet or controlled by an attacker, attempting to gain unauthorized access to remote systems. This behavior is commonly observed in SSH brute-force campaigns where malware hijacks vulnerable machines to expand its attack surface. ESQL rules have limited fields available in its alert documents. Make sure to review the original documents to aid in the investigation of this alert.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>4</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-19-2-unusual-process-spawned-from-web-server-parent.html" title="Unusual Process Spawned from Web Server Parent">Unusual Process Spawned from Web Server Parent</a></p></td>
<td align="left" valign="top"><p>This rule detects unusual processes spawned from a web server parent process by identifying low frequency counts of process spawning activity. Unusual process spawning activity may indicate an attacker attempting to establish persistence, execute malicious commands, or establish command and control channels on the host system. ESQL rules have limited fields available in its alert documents. Make sure to review the original documents to aid in the investigation of this alert.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>4</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><a class="xref" href="prebuilt-rule-8-19-2-unusual-command-execution-from-web-server-parent.html" title="Unusual Command Execution from Web Server Parent">Unusual Command Execution from Web Server Parent</a></p></td>
<td align="left" valign="top"><p>This rule detects potential command execution from a web server parent process on a Linux host. Adversaries may attempt to execute commands from a web server parent process to blend in with normal web server activity and evade detection. This behavior is commonly observed in web shell attacks where adversaries exploit web server vulnerabilities to execute arbitrary commands on the host. The detection rule identifies unusual command execution from web server parent processes, which may indicate a compromised host or an ongoing attack. ESQL rules have limited fields available in its alert documents. Make sure to review the original documents to aid in the investigation of this alert.</p></td>
<td align="left" valign="top"><p>update</p></td>
<td align="left" valign="top"><p>4</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="prebuilt-rule-8-19-1-prebuilt-rules-8-19-1-summary.html">« Update v8.19.1</a>
</span>
<span class="next">
<a href="endpoint-protection-intro.html">Configure endpoint protection with Elastic Defend »</a>
</span>
</div>
</body>
</html>
