<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Run Osquery | Elastic Security Solution [8.3] | Elastic</title>
<link rel="home" href="index.html" title="Elastic Security Solution [8.3]"/>
<link rel="up" href="alerts-ui-manage.html" title="Manage detection alerts"/>
<link rel="prev" href="alerts-ui-manage.html" title="Manage detection alerts"/>
<link rel="next" href="visual-event-analyzer.html" title="Visual event analyzer"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.3"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.3"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body><div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [8.3]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="detection-engine-overview.html">Detections and alerts</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="alerts-ui-manage.html">Manage detection alerts</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="alerts-ui-manage.html">« Manage detection alerts</a>
</span>
<span class="next">
<a href="visual-event-analyzer.html">Visual event analyzer »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="alerts-run-osquery"></a>Run Osquery<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.3/docs/detections/alerts-run-osquery.asciidoc">edit</a></h2>
</div></div></div>
<p><a href="/guide/en/kibana/8.3/osquery.html" class="ulink" target="_top">Osquery</a> allows you to run live queries against an alert&#8217;s host to learn more about your infrastructure and operating systems. For example, with Osquery, you can search your system for indicators of compromise that might have contributed to the alert. You can then use this data to form your investigation and alert triage efforts.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>You must complete the following to access Osquery and run searches against your hosts:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Enable the <a href="/guide/en/kibana/8.3/manage-osquery-integration.html" class="ulink" target="_top">Osquery manager integration</a> on the host associated with the alert.
</li>
<li class="listitem">
Update your <a href="/guide/en/kibana/8.3/osquery.html" class="ulink" target="_top">role&#8217;s privileges</a> to allow access to Osquery.
</li>
<li class="listitem">
Verify that <a href="/guide/en/fleet/8.3/view-elastic-agent-status.html" class="ulink" target="_top">Elastic Agent&#8217;s status</a> is <span class="strong strong"><strong>Healthy</strong></span>. Refer to <a href="/guide/en/fleet/8.3/fleet-troubleshooting.html" class="ulink" target="_top">Fleet Troubleshooting</a> if it is not.
</li>
</ul>
</div>
</div>
</div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Do one of the following from the Alerts table:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Click the <span class="strong strong"><strong>View details</strong></span> button to open the Alert details flyout, then click <span class="strong strong"><strong>Take action &#8594; Run Osquery</strong></span>.
</li>
<li class="listitem">
Select the <span class="strong strong"><strong>More actions</strong></span> menu (<span class="strong strong"><strong>&#8230;&#8203;</strong></span>), then select <span class="strong strong"><strong>Run Osquery</strong></span>.
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Select one or more Elastic Agents or groups to query. Start typing in the search field to get suggestions for Elastic Agents by name, ID, platform, and policy.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The host associated with the alert is automatically selected. You can specify additional hosts to query.</p>
</div>
</div>
</li>
<li class="listitem">
<p>Enter a new query or select a saved query.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/setup-query.png" alt="setup query" width="80%][height=80%][Shows how to set up the query">
</div>
</div>
</li>
<li class="listitem">
(Optional) Expand the <span class="strong strong"><strong>Advanced</strong></span> section to view or set <a href="/guide/en/kibana/8.3/osquery.html#osquery-map-fields" class="ulink" target="_top">mapped ECS fields</a> included in the results from the live query.
</li>
<li class="listitem">
<p>Click <span class="strong strong"><strong>Submit</strong></span>.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>To save the query for future use, click <span class="strong strong"><strong>Save for later</strong></span> and define the ID,
description, and other <a href="/guide/en/kibana/8.3/osquery.html#osquery-manage-query" class="ulink" target="_top">details</a>.</p>
</div>
</div>
</li>
<li class="listitem">
<p>Review the results in the table. You can also:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Navigate to <span class="strong strong"><strong>Discover</strong></span> to dive deeper into the response.
</li>
<li class="listitem">
Use the drag-and-drop <span class="strong strong"><strong>Lens</strong></span> editor to create visualizations.
</li>
<li class="listitem">
Click the <span class="strong strong"><strong>Timeline</strong></span> button (<span class="image"><img src="images/timeline-button-osquery.png" alt="Click markdown icon" width="20" height="20"></span>) to investigate a single query result in Timeline or <span class="strong strong"><strong>Add to timeline investigation</strong></span> to investigate all results.
</li>
</ul>
</div>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>An <code class="literal">action_ID</code> is generated when you run an Osquery query. The <code class="literal">action_ID</code> field and value pair is passed to the Timeline&#8217;s KQL filter when you select the option to open all results in Timeline.</p>
</div>
</div>
</li>
<li class="listitem">
<p>To view more information about the request, such as failures, open the <span class="strong strong"><strong>Status</strong></span> tab in the results table.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/query-results.png" alt="query results" width="80%][height=80%][Shows query results">
</div>
</div>
</li>
</ol>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="alerts-ui-manage.html">« Manage detection alerts</a>
</span>
<span class="next">
<a href="visual-event-analyzer.html">Visual event analyzer »</a>
</span>
</div>
</div>
</body>
</html>
