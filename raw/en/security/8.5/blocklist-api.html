<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Blocklist | Elastic Security Solution [8.5] | Elastic</title>
<meta class="elastic" name="content" content="Blocklist | Elastic Security Solution [8.5]">

<link rel="home" href="index.html" title="Elastic Security Solution [8.5]"/>
<link rel="up" href="management-api-overview.html" title="Endpoint management API"/>
<link rel="prev" href="host-isolation-exceptions-api.html" title="Host isolation exceptions"/>
<link rel="next" href="get-action-api.html" title="Get action details"/>
<meta class="elastic" name="product_version" content="8.5"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.5"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.5"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body><div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [8.5]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="security-apis.html">Elastic Security APIs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="management-api-overview.html">Endpoint management API</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="host-isolation-exceptions-api.html">« Host isolation exceptions</a>
</span>
<span class="next">
<a href="get-action-api.html">Get action details »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="blocklist-api"></a>Blocklist<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/management/api/blocklist-api.asciidoc">edit</a></h2>
</div></div></div>
<p>Create, retrieve, update, and delete endpoint <a class="xref" href="blocklist.html" title="Blocklist"><em>Blocklist</em></a> entries with the <a class="xref" href="exceptions-api-overview.html" title="Exceptions API"><em>Exceptions API</em></a>. Endpoint blocklist entries are managed using a static container id (<code class="literal">list_id</code>) of <code class="literal">endpoint_blocklists</code>, which must be created prior to adding the blocklist entries. To use these APIs, you must have privileges to manage endpoints. Refer to <a class="xref" href="admin-page-ov.html" title="Endpoints">Endpoints</a> for more information.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_create_blocklist_entries_container"></a>Create blocklist entries container<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/management/api/blocklist-api.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">POST &lt;kibana host&gt;:&lt;port&gt;/api/exception_lists</code></p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_request_body_40"></a>Request body<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/management/api/blocklist-api.asciidoc">edit</a></h4>
</div></div></div>
<p>A JSON object containing the fields listed below. The request must have the following:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
The <code class="literal">list_id</code> value must be <code class="literal">endpoint_blocklists</code>.
</li>
<li class="listitem">
The <code class="literal">namespace_type</code> value must be <code class="literal">agnostic</code>.
</li>
<li class="listitem">
The <code class="literal">type</code> value must be <code class="literal">endpoint</code>.
</li>
</ul>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px" width="100%">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Required</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">description</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>Describes the blocklist entries container.</p></td>
<td align="left" valign="top"><p>Yes</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">list_id</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top">
<p>Must be set to <code class="literal">endpoint_blocklists</code>.</p>
</td>
<td align="left" valign="top"><p>Yes</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">meta</code></p></td>
<td align="left" valign="top"><p>Object</p></td>
<td align="left" valign="top"><p>Placeholder for metadata about the list container.</p></td>
<td align="left" valign="top"><p>No</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">name</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>The blocklist entries container&#8217;s name.</p></td>
<td align="left" valign="top"><p>Yes</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">namespace_type</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top">
<p>Must be set to <code class="literal">agnostic</code>.</p>
</td>
<td align="left" valign="top"><p>Yes</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tags</code></p></td>
<td align="left" valign="top"><p>String[]</p></td>
<td align="left" valign="top"><p>String array containing words and phrases to help categorize the
blocklist entries container.</p></td>
<td align="left" valign="top"><p>No</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">type</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top">
<p>Must be set to <code class="literal">endpoint</code>.</p>
</td>
<td align="left" valign="top"><p>Yes</p></td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_example_request_54"></a>Example request<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/management/api/blocklist-api.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-kibana">
<pre class="programlisting prettyprint lang-kibana">POST api/exception_lists
{
  "description": "Elastic Defend Blocklists List",
  "name": "Elastic Defend Blocklists List",
  "list_id": "endpoint_blocklists",
  "type": "endpoint_blocklists",
  "namespace_type": "agnostic"
}</pre>
</div>
<div class="kibana_widget" data-snippet="snippets/120.kibana"></div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_response_code_76"></a>Response code<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/management/api/blocklist-api.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">200</code>
</span>
</dt>
<dd>
Indicates a successful call.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_response_payload_58"></a>Response payload<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/management/api/blocklist-api.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
 "_version": "WzcsMV0=",
  "created_at": "2020-07-13T09:33:46.187Z",
  "created_by": "elastic",
  "description": "Elastic Defend Blocklists List",
  "id": "f320c070-c4eb-11ea-80bb-11861bae2798",
  "immutable": false,
  "list_id": "endpoint_blocklists",
  "name": "Elastic Defend Blocklists List",
  "namespace_type": "agnostic",
  "os_types": [],
  "tags": [],
  "tie_breaker_id": "2c08d5a5-2ecc-4d5a-acfb-0a367f25b3f3",
  "type": "endpoint_blocklists",
  "updated_at": "2020-07-13T09:33:46.359Z",
  "updated_by": "elastic",
  "version": 1
}</pre>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="create-blocklist-item-api"></a>Create blocklist entry<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/management/api/blocklist-api.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">POST &lt;kibana host&gt;:&lt;port&gt;/api/exception_lists/items</code></p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_request_body_41"></a>Request body<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/management/api/blocklist-api.asciidoc">edit</a></h4>
</div></div></div>
<p>A JSON object containing the fields listed below. The request must have the following:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
The <code class="literal">list_id</code> value must be <code class="literal">endpoint_blocklists</code>.
</li>
<li class="listitem">
The <code class="literal">namespace_type</code> value must be <code class="literal">agnostic</code>.
</li>
<li class="listitem">
The <code class="literal">type</code> value must be <code class="literal">simple</code>.
</li>
</ul>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px" width="100%">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Required</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">comments</code></p></td>
<td align="left" valign="top"><p><a class="xref" href="blocklist-api.html#exception-blocklist-item-comment-schema" title="comment object schema">comment</a>[]</p></td>
<td align="left" valign="top">
<p>Array of <a class="xref" href="blocklist-api.html#exception-blocklist-item-comment-schema" title="comment object schema"><code class="literal">comment</code></a> objects.</p>
</td>
<td align="left" valign="top"><p>No, defaults to empty array.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">description</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>Describes the blocklist entry item.</p></td>
<td align="left" valign="top"><p>Yes</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">entries</code></p></td>
<td align="left" valign="top"><p><a class="xref" href="blocklist-api.html#exception-blocklist-item-entry-schema" title="entry object schema">entry</a>[]</p></td>
<td align="left" valign="top"><p>Array containing the blocklist entry query conditions. See <a class="xref" href="blocklist-api.html#exception-blocklist-item-entry-schema" title="entry object schema"><code class="literal">entry</code> object schema</a> for more details.</p></td>
<td align="left" valign="top"><p>Yes.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">list_id</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top">
<p>Must be set to <code class="literal">endpoint_blocklists</code>.</p>
</td>
<td align="left" valign="top"><p>Yes</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">item_id</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>Unique identifier of the exception item.</p></td>
<td align="left" valign="top"><p>No, automatically
created when it is not provided.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">meta</code></p></td>
<td align="left" valign="top"><p>Object</p></td>
<td align="left" valign="top"><p>Placeholder for metadata about the exception item.</p></td>
<td align="left" valign="top"><p>No</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">name</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>The blocklist entry name.</p></td>
<td align="left" valign="top"><p>Yes</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">namespace_type</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top">
<p>Must be set to <code class="literal">agnostic</code> for endpoint artifacts.</p>
</td>
<td align="left" valign="top"><p>Yes</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">os_types</code></p></td>
<td align="left" valign="top"><p><a class="xref" href="blocklist-api.html#exception-blocklist-item-os-types" title="os_types values">os_type</a>[]</p></td>
<td align="left" valign="top"><p>Array of <a class="xref" href="blocklist-api.html#exception-blocklist-item-os-types" title="os_types values">os_type</a> values.</p></td>
<td align="left" valign="top"><p>Yes</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tags</code></p></td>
<td align="left" valign="top"><p>String[]</p></td>
<td align="left" valign="top"><p>An array of strings containing words and phrases to help categorize
exception items. Tags can also be used to define the blocklist entry as either globally applicable to all policies or assigned to one or more policies (per policy). See <a class="xref" href="blocklist-api.html#exception-blocklist-item-scope-assignment-tags" title="Scope assignment">Scope assignment</a> for more details.</p></td>
<td align="left" valign="top"><p>No</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">type</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top">
<p>Must be set to <code class="literal">simple</code>.</p>
</td>
<td align="left" valign="top"><p>Yes</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h5 class="title"><a id="_example_request_55"></a>Example request<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/management/api/blocklist-api.asciidoc">edit</a></h5>
</div></div></div>
<div class="pre_wrapper lang-kibana">
<pre class="programlisting prettyprint lang-kibana">POST api/exception_lists/items

{
    "comments": [],
    "description": "some description about this entry",
    "entries": [
        {
            "field": "file.path",
            "value": [
                "c:/path/to/file.exe",
                "c:/path/to/file2.exe"
            ],
            "type": "match_any",
            "operator": "included"
        }
    ],
    "list_id": "endpoint_blocklists",
    "name": "Some name for this item",
    "namespace_type": "agnostic",
    "os_types": [
        "windows"
    ],
    "tags": [
        "policy:all"
    ],
    "type": "simple"
}</pre>
</div>
<div class="kibana_widget" data-snippet="snippets/121.kibana"></div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_response_code_77"></a>Response code<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/management/api/blocklist-api.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">200</code>
</span>
</dt>
<dd>
Indicates a successful call.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_response_payload_59"></a>Response payload<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/management/api/blocklist-api.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
    "_version": "WzEzNjIsMV0=",
    "comments": [],
    "created_at": "2022-03-01T16:24:39.471Z",
    "created_by": "elastic",
    "description": "some description about this entry",
    "entries": [
        {
            "field": "file.path",
            "value": [
                "c:/path/to/file.exe",
                "c:/path/to/file2.exe"
            ],
            "type": "match_any",
            "operator": "included"
        }
    ],
    "id": "17ba1bf0-997c-11ec-b212-9f4ed8b5942f",
    "item_id": "29f480e6-6d34-4bc7-9038-f809f11cb679",
    "list_id": "endpoint_blocklists",
    "name": "Some name for this item",
    "namespace_type": "agnostic",
    "os_types": [
        "windows"
    ],
    "tags": [
        "policy:all"
    ],
    "tie_breaker_id": "c6bedf22-2292-4d4a-8eb8-e29a50b5b519",
    "type": "simple",
    "updated_at": "2022-03-01T16:24:39.475Z",
    "updated_by": "elastic"
}</pre>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="update-blocklist-item-api"></a>Update blocklist entry<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/management/api/blocklist-api.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">PUT &lt;kibana host&gt;:&lt;port&gt;/api/exception_lists/items</code></p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_request_body_42"></a>Request body<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/management/api/blocklist-api.asciidoc">edit</a></h4>
</div></div></div>
<p>A JSON object containing the fields listed below. The request must have the following:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
The <code class="literal">list_id</code> value must be <code class="literal">endpoint_blocklists</code>.
</li>
<li class="listitem">
The <code class="literal">namespace_type</code> value must be <code class="literal">agnostic</code>.
</li>
<li class="listitem">
The <code class="literal">type</code> value must be <code class="literal">simple</code>.
</li>
</ul>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px" width="100%">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Required</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">comments</code></p></td>
<td align="left" valign="top"><p><a class="xref" href="blocklist-api.html#exception-blocklist-item-comment-schema" title="comment object schema">comment</a>[]</p></td>
<td align="left" valign="top">
<p>Array of <a class="xref" href="blocklist-api.html#exception-blocklist-item-comment-schema" title="comment object schema"><code class="literal">comment</code></a> objects.</p>
</td>
<td align="left" valign="top"><p>No, defaults to empty array.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">description</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>Describes the blocklist entry.</p></td>
<td align="left" valign="top"><p>Yes</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">entries</code></p></td>
<td align="left" valign="top"><p><a class="xref" href="blocklist-api.html#exception-blocklist-item-entry-schema" title="entry object schema">entry</a>[]</p></td>
<td align="left" valign="top"><p>Array containing the blocklist entry query conditions. See <a class="xref" href="blocklist-api.html#exception-blocklist-item-entry-schema" title="entry object schema"><code class="literal">entry</code> object schema</a> for more details.</p></td>
<td align="left" valign="top"><p>Yes.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">id</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>The item&#8217;s unique identifier.</p></td>
<td align="left" valign="top">
<p>Yes, when the item&#8217;s <code class="literal">item_id</code> field is not used.</p>
</td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">item_id</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top">
<p>The <code class="literal">item_id</code> of the item you are updating.</p>
</td>
<td align="left" valign="top">
<p>Yes, when the item&#8217;s <code class="literal">id</code> field is not used.</p>
</td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">meta</code></p></td>
<td align="left" valign="top"><p>Object</p></td>
<td align="left" valign="top"><p>Placeholder for metadata about the exception item.</p></td>
<td align="left" valign="top"><p>No</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">name</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>The blocklist entry name.</p></td>
<td align="left" valign="top"><p>Yes</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">namespace_type</code></p></td>
<td align="left" valign="top">
<p>String</p>
</td>
<td align="left" valign="top">
<p>Must be set to <code class="literal">agnostic</code>.</p>
</td>
<td align="left" valign="top"><p>Yes</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">os_types</code></p></td>
<td align="left" valign="top"><p><a class="xref" href="blocklist-api.html#exception-blocklist-item-os-types" title="os_types values">os_type</a>[]</p></td>
<td align="left" valign="top"><p>Array of <a class="xref" href="blocklist-api.html#exception-blocklist-item-os-types" title="os_types values">os_type</a> values.</p></td>
<td align="left" valign="top"><p>Yes</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tags</code></p></td>
<td align="left" valign="top"><p>String[]</p></td>
<td align="left" valign="top"><p>An array of strings containing words and phrases to help categorize
exception items. Tags can also be used to define the blocklist entry as either globally applicable to all policies or assigned to one or more policies (per policy). See <a class="xref" href="blocklist-api.html#exception-blocklist-item-scope-assignment-tags" title="Scope assignment">Scope assignment</a> for more details.</p></td>
<td align="left" valign="top"><p>No</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">type</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top">
<p>Must be <code class="literal">simple</code>.</p>
</td>
<td align="left" valign="top"><p>Yes</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">_version</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top">
<p>The version id, normally returned by the API when the item was retrieved. Use it ensure updates are done against the latest version.</p>
</td>
<td align="left" valign="top"><p>No</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h5 class="title"><a id="_example_request_56"></a>Example request<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/management/api/blocklist-api.asciidoc">edit</a></h5>
</div></div></div>
<p>Updates the <code class="literal">entries</code>:</p>
<div class="pre_wrapper lang-kibana">
<pre class="programlisting prettyprint lang-kibana">PUT api/exception_lists/items
{
    "_version": "WzEzNjIsMV0=",
    "name": "ABC blocklist",
    "description": "These applications must be blocked",
    "entries": [
        {
            "field": "file.path",
            "value": [
                "c:/path/to/file.exe",
                "c:/path/to/file2.exe"
                "c:/path/to/file3.exe"
            ],
            "type": "match_any",
            "operator": "included"
        }
    ],
    "os_types": [
        "windows"
    ],
    "tags": [
        "policy:all"
    ],
    "id": "17ba1bf0-997c-11ec-b212-9f4ed8b5942f",
    "comments": [],
    "item_id": "29f480e6-6d34-4bc7-9038-f809f11cb679",
    "namespace_type": "agnostic",
    "type": "simple"
}</pre>
</div>
<div class="kibana_widget" data-snippet="snippets/122.kibana"></div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_response_code_78"></a>Response code<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/management/api/blocklist-api.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">200</code>
</span>
</dt>
<dd>
Indicates a successful call.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_response_payload_60"></a>Response payload<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/management/api/blocklist-api.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
    "_version": "WzEzNjcsMV0=",
    "comments": [],
    "created_at": "2022-03-01T16:24:39.471Z",
    "created_by": "elastic",
    "description": "These applications must be blocked",
    "entries": [
        {
            "field": "file.path",
            "value": [
                "c:/path/to/file.exe",
                "c:/path/to/file2.exe"
                "c:/path/to/file3.exe"
            ],
            "type": "match_any",
            "operator": "included"
        }
    ],
    "id": "17ba1bf0-997c-11ec-b212-9f4ed8b5942f",
    "item_id": "29f480e6-6d34-4bc7-9038-f809f11cb679",
    "list_id": "endpoint_blocklists",
    "name": "ABC blocklist",
    "namespace_type": "agnostic",
    "os_types": [
        "windows"
    ],
    "tags": [
        "policy:all"
    ],
    "tie_breaker_id": "c6bedf22-2292-4d4a-8eb8-e29a50b5b519",
    "type": "simple",
    "updated_at": "2022-03-01T17:21:07.273Z",
    "updated_by": "elastic"
}</pre>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_delete_blocklist_entry"></a>Delete blocklist entry<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/management/api/blocklist-api.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">DELETE &lt;kibana host&gt;:&lt;port&gt;/api/exception_lists/items</code></p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_url_query_parameters_31"></a>URL query parameters<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/management/api/blocklist-api.asciidoc">edit</a></h4>
</div></div></div>
<p>The URL query must include one of the following:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">id</code> - the <code class="literal">id</code> of the item, or
</li>
<li class="listitem">
<code class="literal">item_id</code> -  the <code class="literal">item_id</code> of the item
</li>
</ul>
</div>
<p>In addition to the above, <code class="literal">namespace_type</code> URL query parameter is also required with a value of <code class="literal">agnostic</code>.</p>
<div class="section">
<div class="titlepage"><div><div>
<h5 class="title"><a id="_example_request_57"></a>Example request<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/management/api/blocklist-api.asciidoc">edit</a></h5>
</div></div></div>
<p>Deletes the blocklist entry with <code class="literal">item_id</code> of <code class="literal">29f480e6-6d34-4bc7-9038-f809f11cb679</code>:</p>
<div class="pre_wrapper lang-kibana">
<pre class="programlisting prettyprint lang-kibana">DELETE api/exception_lists/items?item_id=29f480e6-6d34-4bc7-9038-f809f11cb679&amp;namespace_type=agnostic</pre>
</div>
<div class="kibana_widget" data-snippet="snippets/123.kibana"></div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_response_code_79"></a>Response code<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/management/api/blocklist-api.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">200</code>
</span>
</dt>
<dd>
Indicates a successful call.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_response_payload_61"></a>Response payload<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/management/api/blocklist-api.asciidoc">edit</a></h4>
</div></div></div>
<p>The item that was deleted:</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
  "_version": "WzEzNjcsMV0=",
  "comments": [],
  "created_at": "2022-03-01T16:24:39.471Z",
  "created_by": "elastic",
  "description": "These applications must be blocked",
  "entries": [
     {
            "field": "file.path",
            "value": [
                "c:/path/to/file.exe",
                "c:/path/to/file2.exe"
                "c:/path/to/file3.exe"
            ],
            "type": "match_any",
            "operator": "included"
      }
  ],
  "id": "17ba1bf0-997c-11ec-b212-9f4ed8b5942f",
  "item_id": "29f480e6-6d34-4bc7-9038-f809f11cb679",
  "list_id": "endpoint_blocklists",
  "name": "ABC blocklist",
  "namespace_type": "agnostic",
  "os_types": [
    "windows"
  ],
  "tags": [
    "policy:all"
  ],
  "tie_breaker_id": "c6bedf22-2292-4d4a-8eb8-e29a50b5b519",
  "type": "simple",
  "updated_at": "2022-03-01T17:21:07.273Z",
  "updated_by": "elastic"
}</pre>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_retrieve_single_blocklist_entry"></a>Retrieve single blocklist entry<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/management/api/blocklist-api.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">GET &lt;kibana host&gt;:&lt;port&gt;/api/exception_lists/items</code></p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_url_query_parameters_32"></a>URL query parameters<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/management/api/blocklist-api.asciidoc">edit</a></h4>
</div></div></div>
<p>The URL query must include one of the following:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">id</code> - the <code class="literal">id</code> of the item, or
</li>
<li class="listitem">
<code class="literal">item_id</code> -  the <code class="literal">item_id</code> of the item
</li>
</ul>
</div>
<p>In addition to the above, <code class="literal">namespace_type</code> URL query parameter is also required with a value of <code class="literal">agnostic</code>.</p>
<div class="section">
<div class="titlepage"><div><div>
<h5 class="title"><a id="_example_request_58"></a>Example request<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/management/api/blocklist-api.asciidoc">edit</a></h5>
</div></div></div>
<div class="pre_wrapper lang-kibana">
<pre class="programlisting prettyprint lang-kibana">GET api/exception_lists/items?item_id=29f480e6-6d34-4bc7-9038-f809f11cb679&amp;namespace_type=agnostic</pre>
</div>
<div class="kibana_widget" data-snippet="snippets/124.kibana"></div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_response_code_80"></a>Response code<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/management/api/blocklist-api.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">200</code>
</span>
</dt>
<dd>
Indicates a successful call.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_response_payload_62"></a>Response payload<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/management/api/blocklist-api.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
  "_version": "WzEzNjcsMV0=",
  "comments": [],
  "created_at": "2022-03-01T16:24:39.471Z",
  "created_by": "elastic",
  "description": "These applications must be blocked",
  "entries": [
    {
            "field": "file.path",
            "value": [
                "c:/path/to/file.exe",
                "c:/path/to/file2.exe"
                "c:/path/to/file3.exe"
            ],
            "type": "match_any",
            "operator": "included"
      }
  ],
  "id": "17ba1bf0-997c-11ec-b212-9f4ed8b5942f",
  "item_id": "29f480e6-6d34-4bc7-9038-f809f11cb679",
  "list_id": "endpoint_blocklists",
  "name": "ABC blocklist",
  "namespace_type": "agnostic",
  "os_types": [
    "windows"
  ],
  "tags": [
    "policy:all"
  ],
  "tie_breaker_id": "c6bedf22-2292-4d4a-8eb8-e29a50b5b519",
  "type": "simple",
  "updated_at": "2022-03-01T17:21:07.273Z",
  "updated_by": "elastic"
}</pre>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_find_blocklist_entries"></a>Find blocklist entries<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/management/api/blocklist-api.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">GET &lt;kibana host&gt;:&lt;port&gt;/api/exception_lists/items/_find</code></p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_url_query_parameters_33"></a>URL query parameters<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/management/api/blocklist-api.asciidoc">edit</a></h4>
</div></div></div>
<div class="informaltable">
<table border="1" cellpadding="4px" width="100%">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Required</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">list_id</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top">
<p>Must be set to <code class="literal">endpoint_blocklists</code>.</p>
</td>
<td align="left" valign="top"><p>Yes</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">namespace_type</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top">
<p>Must be set to <code class="literal">agnostic</code>.</p>
</td>
<td align="left" valign="top"><p>Yes</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">page</code></p></td>
<td align="left" valign="top"><p>Integer</p></td>
<td align="left" valign="top"><p>The page number to return.</p></td>
<td align="left" valign="top"><p>No</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">per_page</code></p></td>
<td align="left" valign="top"><p>Integer</p></td>
<td align="left" valign="top"><p>The number of items to return per page.</p></td>
<td align="left" valign="top"><p>No</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">sort_field</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>Determines which field is used to sort the results.</p></td>
<td align="left" valign="top"><p>No</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">sort_order</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top">
<p>Determines the sort order, which can be <code class="literal">desc</code> or <code class="literal">asc</code>.</p>
</td>
<td align="left" valign="top"><p>No</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">filter</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>A <a href="/guide/en/kibana/8.5/kuery-query.html" class="ulink" target="_top">Kibana Query Language (KQL)</a> string to filter the results down.</p></td>
<td align="left" valign="top"><p>No</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h5 class="title"><a id="_example_request_59"></a>Example request<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/management/api/blocklist-api.asciidoc">edit</a></h5>
</div></div></div>
<div class="pre_wrapper lang-kibana">
<pre class="programlisting prettyprint lang-kibana">GET api/exception_lists/items/_find?page=1&amp;per_page=10&amp;sort_field=name&amp;sort_order=asc&amp;list_id=endpoint_blocklists&amp;namespace_type=agnostic</pre>
</div>
<div class="kibana_widget" data-snippet="snippets/125.kibana"></div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_response_code_81"></a>Response code<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/management/api/blocklist-api.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">200</code>
</span>
</dt>
<dd>
Indicates a successful call.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_response_payload_63"></a>Response payload<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/management/api/blocklist-api.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
  "data": [
    {
      "_version": "WzEzNjcsMV0=",
      "comments": [],
      "created_at": "2022-03-01T16:24:39.471Z",
      "created_by": "elastic",
      "description": "These applications must be blocked",
      "entries": [
        {
            "field": "file.path",
            "value": [
                "c:/path/to/file.exe",
                "c:/path/to/file2.exe"
                "c:/path/to/file3.exe"
            ],
            "type": "match_any",
            "operator": "included"
        }
      ],
      "id": "17ba1bf0-997c-11ec-b212-9f4ed8b5942f",
      "item_id": "29f480e6-6d34-4bc7-9038-f809f11cb679",
      "list_id": "endpoint_blocklists",
      "name": "ABC blocklist",
      "namespace_type": "agnostic",
      "os_types": [
        "windows"
      ],
      "tags": [
        "policy:all"
      ],
      "tie_breaker_id": "c6bedf22-2292-4d4a-8eb8-e29a50b5b519",
      "type": "simple",
      "updated_at": "2022-03-01T17:21:07.273Z",
      "updated_by": "elastic"
    }
  ],
  "page": 1,
  "per_page": 10,
  "total": 1
}</pre>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_value_types_4"></a>Value types<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/management/api/_exceptions-api-reusable-content.asciidoc">edit</a></h3>
</div></div></div>
<p>The following describes the types that can be defined when using the <a class="xref" href="blocklist-api.html#create-blocklist-item-api" title="Create blocklist entry">create</a> or <a class="xref" href="blocklist-api.html#update-blocklist-item-api" title="Update blocklist entry">update</a> blocklist entries APIs:</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="exception-blocklist-item-comment-schema"></a><code class="literal">comment</code> object schema<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/management/api/_exceptions-api-reusable-content.asciidoc">edit</a></h4>
</div></div></div>
<p>Comments are JSON objects containing the following structure:</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
    "comment": "some comment here"
}</pre>
</div>
<p>When used with the update API, existing comments can be updated by using their associated <code class="literal">id</code>, while any comment without the <code class="literal">id</code> attribute will be added as a new comment:</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
    "comment": "some comment here - updated",
    "id": "1078cf59-5893-4143-acf7-40a40af16bee"
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="exception-blocklist-item-os-types"></a><code class="literal">os_types</code> values<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/management/api/_exceptions-api-reusable-content.asciidoc">edit</a></h4>
</div></div></div>
<p>The following are the valid OS types that can be used when creating blocklist entries:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">windows</code>
</li>
<li class="listitem">
<code class="literal">linux</code>
</li>
<li class="listitem">
<code class="literal">macos</code>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="exception-blocklist-item-scope-assignment-tags"></a>Scope assignment<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/management/api/_exceptions-api-reusable-content.asciidoc">edit</a></h4>
</div></div></div>
<p>Blocklist entries can be assigned globally across all endpoint policies, or assigned to specific policies. You can assign the blocklist entry by defining one or more tags with a prefix of <code class="literal">policy:</code>. Note that the blocklist entry can be either global or per policy, but not <span class="strong strong"><strong>both</strong></span>. The following tags are available for use in order to control the assignment scope:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">policy:all</code> : Blocklist entry is global to all policies. If used, no other <code class="literal">policy:</code> tag is allowed.
</li>
<li class="listitem">
<code class="literal">policy:&lt;endpoint-policy-id&gt;</code> : Blocklist entry is assigned to a policy. Multiple <code class="literal">per policy</code> tags can be used to associate the blocklist entry to multiple policies.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="exception-blocklist-item-entry-schema"></a><code class="literal">entry</code> object schema<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/management/api/blocklist-api.asciidoc">edit</a></h4>
</div></div></div>
<p>At least 3 conditions can be defined on an endpoint blocklist entry. Duplicates are not allowed. The following entries are supported by blocklist entries:</p>
<div class="section">
<div class="titlepage"><div><div>
<h5 class="title"><a id="_file_hashes"></a>File hashes<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/management/api/blocklist-api.asciidoc">edit</a></h5>
</div></div></div>
<p>File hashes are supported by all <a class="xref" href="blocklist-api.html#exception-blocklist-item-os-types" title="os_types values">OS types</a>. A file hash entry has the following structure:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">field</code> : The <code class="literal">file.hash.md5</code>, <code class="literal">file.hash.sha1</code> or <code class="literal">file.hash.sha256</code> values are supported.
</li>
<li class="listitem">
<code class="literal">value</code> : An array of hash values associated with the <code class="literal">field</code>.
</li>
<li class="listitem">
<code class="literal">type</code> : Must be <code class="literal">match_any</code>.
</li>
<li class="listitem">
<code class="literal">operator</code> : Must be <code class="literal">included</code>.
</li>
</ul>
</div>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
    "field": "file.hash.md5",
    "value": [
        "741462ab431a22233C787BAAB9B653C7"
    ],
    "type": "match_any",
    "operator": "included"
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h5 class="title"><a id="_process_file_path_2"></a>Process file path<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/management/api/blocklist-api.asciidoc">edit</a></h5>
</div></div></div>
<p>Process file paths are supported by all <a class="xref" href="blocklist-api.html#exception-blocklist-item-os-types" title="os_types values">OS types</a>. A file path entry has the following structure:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">field</code> : Must be <code class="literal">file.path</code>.
</li>
<li class="listitem">
<code class="literal">value</code> : An array of file paths to match on.
</li>
<li class="listitem">
<code class="literal">type</code> : Must be <code class="literal">match_any</code>.
</li>
<li class="listitem">
<code class="literal">operator</code> : Must be <code class="literal">included</code>.
</li>
</ul>
</div>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
  "field": "file.path",
  "value": "c:/path/to/file.exe",
  "type": "match_any",
  "operator": "included"
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h5 class="title"><a id="_process_signature_2"></a>Process signature<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/management/api/blocklist-api.asciidoc">edit</a></h5>
</div></div></div>
<p>Process signature is supported for Windows <a class="xref" href="blocklist-api.html#exception-blocklist-item-os-types" title="os_types values">OS type</a> only. A signature entry has the following structure:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">field</code> : Must be set to <code class="literal">process.Ext.code_signature</code>.
</li>
<li class="listitem">
<code class="literal">type</code> : Must be set to <code class="literal">nested</code>.
</li>
<li class="listitem">
<code class="literal">entries</code>: An array with 1 <code class="literal">entry</code> item.
</li>
<li class="listitem">
<p><code class="literal">entries[0]</code> : The entry defining the signature to be matched upon:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">field</code>: Must be set to <code class="literal">subject_name</code>.
</li>
<li class="listitem">
<code class="literal">value</code> : An array of signature names to match on.
</li>
<li class="listitem">
<code class="literal">type</code> : Must be set to <code class="literal">match_any</code>.
</li>
<li class="listitem">
<code class="literal">operator</code> : Must be set to <code class="literal">included</code>.
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
    "field": "file.Ext.code_signature",
    "entries": [
        {
            "field": "subject_name",
            "value": [
                "test1",
                "test2"
            ],
            "type": "match_any",
            "operator": "included"
        }
    ],
    "type": "nested"
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h5 class="title"><a id="_examples_for_a_windows_blocklist_entry"></a>Examples for a Windows blocklist entry.<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/management/api/blocklist-api.asciidoc">edit</a></h5>
</div></div></div>
<p>Only one entry of <code class="literal">file.path</code> or <code class="literal">file.Ext.code_signature</code> is allowed per blocklist item. The <code class="literal">file.hash.*</code> entry is also supported and accepts up to three values. The allowed hash types for <code class="literal">file.hash.*</code> are <code class="literal">md5</code>, <code class="literal">sha1</code>, or <code class="literal">sha256</code>.</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">[
 {
      "field": "file.hash.md5",
      "value": [
          "741462ab431a22233C787BAAB9B653C7"
      ],
      "type": "match_any",
      "operator": "included"
  },
  {
      "field": "file.hash.sha1",
      "value": [
          "aedb279e378BED6C2DB3C9DC9e12ba635e0b391c"
      ],
      "type": "match_any",
      "operator": "included"
  },
  {
      "field": "file.hash.sha256",
      "value": [
          "a665a45920422f9d417e4867efdc4fb8a04a1f3fff1fa07e998e86f7f7a27ae3"
      ],
      "type": "match_any",
      "operator": "included"
  }
]</pre>
</div>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">[
 {
    "field": "file.Ext.code_signature",
    "entries": [
        {
            "field": "subject_name",
            "value": [
                "test1",
                "test2"
            ],
            "type": "match_any",
            "operator": "included"
        }
    ],
    "type": "nested"
 }
]</pre>
</div>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">[
  {
    "field": "file.path",
    "value": "c:/path/to/file.exe",
    "type": "match_any",
    "operator": "included"
  }
]</pre>
</div>
</div>

</div>

</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="host-isolation-exceptions-api.html">« Host isolation exceptions</a>
</span>
<span class="next">
<a href="get-action-api.html">Get action details »</a>
</span>
</div>
</div>
</body>
</html>
