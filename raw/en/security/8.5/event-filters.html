<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Event filters | Elastic Security Solution [8.5] | Elastic</title>
<link rel="home" href="index.html" title="Elastic Security Solution [8.5]"/>
<link rel="up" href="sec-manage-intro.html" title="Endpoint management"/>
<link rel="prev" href="trusted-apps-ov.html" title="Trusted applications"/>
<link rel="next" href="host-isolation-exceptions.html" title="Host isolation exceptions"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.5"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.5"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body><div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [8.5]</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="sec-manage-intro.html">Endpoint management</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="trusted-apps-ov.html">« Trusted applications</a>
</span>
<span class="next">
<a href="host-isolation-exceptions.html">Host isolation exceptions »</a>
</span>
</div>
<div class="chapter xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="event-filters"></a>Event filters<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/management/admin/event-filters.asciidoc">edit</a></h2>
</div></div></div>
<p>Event filters allow you to filter endpoint events that you do not need or want stored in Elasticsearch&#8201;&#8212;&#8201;for example, high-volume events. By creating event filters, you can optimize your storage in Elasticsearch.</p>
<p>Event filters do not lower CPU usage on hosts; Elastic Endpoint still monitors events to detect and prevent possible threats, but without writing event data to Elasticsearch. To compare event filters with other endpoint artifacts, refer to <a class="xref" href="endpoint-artifacts.html" title="Optimize Elastic Defend"><em>Optimize Elastic Defend</em></a>.</p>
<div class="sidebar">
<div class="titlepage"><div><div>
<p class="title"><strong>Requirements</strong></p>
</div></div></div>
<p>You must have the <code class="literal">superuser</code> <a href="/guide/en/elasticsearch/reference/8.5/built-in-roles.html" class="ulink" target="_top">built-in user role</a> to access this feature.</p>
</div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Since an event filter blocks an event from streaming to Elasticsearch, be conscious of event filter conditions you set and any existing rule conditions. If there is too much overlap, the rule may run less frequently than specified and, therefore, will not trigger the corresponding alert for that rule. This is the expected behavior of event filters.</p>
</div>
</div>
<p>By default, event filters are recognized globally across all hosts running Elastic Defend. If you have a <a href="/pricing" class="ulink" target="_top">Platinum or Enterprise subscription</a>, you can also assign an event filter to a specific Elastic Defend integration policy, which would filter endpoint events from the hosts assigned to that policy.</p>
<p>Create event filters from the Hosts page or the Event filters page.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Do one of the following:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>To create an event filter from the Hosts page:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Go to <span class="strong strong"><strong>Explore</strong></span> &#8594; <span class="strong strong"><strong>Hosts</strong></span>.
</li>
<li class="listitem">
Select the <span class="strong strong"><strong>Events</strong></span> tab to view the Events table.
</li>
<li class="listitem">
<p>Find the event to filter, click the <span class="strong strong"><strong>More actions</strong></span> menu (<span class="strong strong"><strong>&#8230;&#8203;</strong></span>), then select <span class="strong strong"><strong>Add Endpoint event filter</strong></span>.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>Since you can only create filters for endpoint events, be sure to filter the Events table to display events generated by the Elastic Endpoint.<br>
For example, in the KQL search bar, enter the following query to find endpoint network events: <code class="literal">event.dataset : endpoint.events.network</code>.</p>
</div>
</div>
</li>
</ol>
</div>
</li>
<li class="listitem">
<p>To create an event filter from the Event filters page:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Go to <span class="strong strong"><strong>Manage</strong></span> &#8594; <span class="strong strong"><strong>Event filters</strong></span>.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Add Event Filter</strong></span>. The <span class="strong strong"><strong>Add event filter</strong></span> flyout opens.
</li>
</ol>
</div>
</li>
</ul>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="images/event-filter.png" alt="event filter">
</div>
</div>
</li>
<li class="listitem">
<p>Fill in these fields in the <span class="strong strong"><strong>Details</strong></span> section:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<code class="literal">Name your event filter</code>: Enter a name for the event filter.
</li>
<li class="listitem">
<code class="literal">Description</code>: Enter a filter description (optional).
</li>
</ol>
</div>
</li>
<li class="listitem">
<p>In the <span class="strong strong"><strong>Conditions</strong></span> section, depending which page you&#8217;re using to create the filter, either modify the pre-populated conditions or add new conditions to define how Elastic Security will filter events. Use these settings:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<code class="literal">Select operating system</code>: Select the appropriate operating system.
</li>
<li class="listitem">
<code class="literal">Field</code>: Select a field to identify the event being filtered.
</li>
<li class="listitem">
<p><code class="literal">Operator</code>: Select an operator to define the condition. Available options are:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">is</code>
</li>
<li class="listitem">
<code class="literal">is not</code>
</li>
<li class="listitem">
<code class="literal">is one of</code>
</li>
<li class="listitem">
<code class="literal">is not one of</code>
</li>
<li class="listitem">
<p><code class="literal">matches</code>: This is only available for the <code class="literal">file.path.text</code> field, and allows you to use wildcards in <code class="literal">Value</code>, such as <code class="literal">C:\path\*\app.exe</code>.  Available wildcards are <code class="literal">?</code> (match one character) and <code class="literal">*</code> (match zero or more characters).</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Using wildcards in file paths can impact performance. To create a more efficient event filter using wildcards, use multiple conditions and make them as specific as possible. For example, adding conditions using <code class="literal">process.name</code> or <code class="literal">file.name</code> can help limit the scope of wildcard matching.</p>
</div>
</div>
</li>
</ul>
</div>
</li>
<li class="listitem">
<code class="literal">Value</code>: Enter the value associated with the <code class="literal">Field</code>. To enter multiple values (when using <code class="literal">is one of</code> or <code class="literal">is not one of</code>), enter each value, then press <span class="strong strong"><strong>Return</strong></span>.
</li>
</ol>
</div>
</li>
<li class="listitem">
To define multiple conditions, click the <code class="literal">AND</code> button and configure a new condition. You can also add nested conditions with the <code class="literal">Add nested condition</code> button. For example, the event filter pictured above excludes events whose <code class="literal">event.category</code> field is <code class="literal">network</code>, and whose <code class="literal">process.executable</code> field is as specified.
</li>
<li class="listitem">
<p>Select an option in the <span class="strong strong"><strong>Assignment</strong></span> section to assign the event filter to a specific integration policy:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">Global</code>: Assign the event filter to all integration policies for Elastic Defend.
</li>
<li class="listitem">
<p><code class="literal">Per Policy</code> (Platinum or Enterprise subscription only): Assign the event filter to one or more specific Elastic Defend integration policies. Select each policy in which you want the events to be filtered.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>You can also select the <code class="literal">Per Policy</code> option without immediately assigning a policy to the event filter. For example, you could do this to create and review your event filter configurations before putting them into action with a policy.</p>
</div>
</div>
</li>
</ul>
</div>
</li>
<li class="listitem">
Add a comment if you want to provide more information about the event filter (optional).
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Add event filter</strong></span>. The new filter is added to the <span class="strong strong"><strong>Event filters</strong></span> list.
</li>
</ol>
</div>
<h3><a id="manage-event-filters"></a>View and manage event filters<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/management/admin/event-filters.asciidoc">edit</a></h3>
<p>The <span class="strong strong"><strong>Event filters</strong></span> page displays all the event filters that have been added to the Elastic Security app. To refine the list, use the search bar to search by filter name, description, comments, or field value.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/event-filters-list.png" alt="event filters list">
</div>
</div>
<h4><a id="edit-event-filter"></a>Edit an event filter<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/management/admin/event-filters.asciidoc">edit</a></h4>
<p>You can individually modify each event filter. With a Platinum or Enterprise subscription, you can also change the policies that an event filter is assigned to.</p>
<p>To edit an event filter:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Click the actions menu (<span class="strong strong"><strong>&#8230;&#8203;</strong></span>) for the event filter you want to edit, then select <span class="strong strong"><strong>Edit event filter</strong></span>.
</li>
<li class="listitem">
Modify details or conditions as needed.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Save</strong></span>.
</li>
</ol>
</div>
<h4><a id="delete-event-filter"></a>Delete an event filter<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.5/docs/management/admin/event-filters.asciidoc">edit</a></h4>
<p>You can delete an event filter, which removes it entirely from all Elastic Defend integration policies.</p>
<p>To delete an event filter:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Click the actions menu (<span class="strong strong"><strong>&#8230;&#8203;</strong></span>) on the event filter you want to delete, then select <span class="strong strong"><strong>Delete event filter</strong></span>.
</li>
<li class="listitem">
On the dialog that opens, verify that you are removing the correct event filter, then click <span class="strong strong"><strong>Delete</strong></span>. A confirmation message is displayed.
</li>
</ol>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="trusted-apps-ov.html">« Trusted applications</a>
</span>
<span class="next">
<a href="host-isolation-exceptions.html">Host isolation exceptions »</a>
</span>
</div>
</div>
</body>
</html>
