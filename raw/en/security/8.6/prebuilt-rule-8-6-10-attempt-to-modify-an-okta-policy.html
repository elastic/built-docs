<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Attempt to Modify an Okta Policy | Elastic Security Solution [8.6] | Elastic</title>
<meta class="elastic" name="content" content="Attempt to Modify an Okta Policy | Elastic Security Solution [8.6]">

<link rel="home" href="index.html" title="Elastic Security Solution [8.6]"/>
<link rel="up" href="prebuilt-rule-8-6-10-prebuilt-rules-8-6-10-appendix.html" title="Appendix [: Downloadable rule update v8.6.10"/>
<link rel="prev" href="prebuilt-rule-8-6-10-attempt-to-modify-an-okta-network-zone.html" title="Attempt to Modify an Okta Network Zone"/>
<link rel="next" href="prebuilt-rule-8-6-10-attempt-to-modify-an-okta-policy-rule.html" title="Attempt to Modify an Okta Policy Rule"/>
<meta class="elastic" name="product_version" content="8.6"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.6"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.6"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body><div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [8.6]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="prebuilt-rule-8-6-10-prebuilt-rules-8-6-10-appendix.html">Downloadable rule update v8.6.10</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="prebuilt-rule-8-6-10-attempt-to-modify-an-okta-network-zone.html">« Attempt to Modify an Okta Network Zone</a>
</span>
<span class="next">
<a href="prebuilt-rule-8-6-10-attempt-to-modify-an-okta-policy-rule.html">Attempt to Modify an Okta Policy Rule »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="prebuilt-rule-8-6-10-attempt-to-modify-an-okta-policy"></a>Attempt to Modify an Okta Policy<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.6/docs/detections/prebuilt-rules/downloadable-packages/8-6-10/prebuilt-rule-8-6-10-attempt-to-modify-an-okta-policy.asciidoc">edit</a></h2>
</div></div></div>
<p>Detects attempts to modify an Okta policy. An adversary may attempt to modify an Okta policy in order to weaken an organization&#8217;s security controls. For example, an adversary may attempt to modify an Okta multi-factor authentication (MFA) policy in order to weaken the authentication requirements for user accounts.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
filebeat-*
</li>
<li class="listitem">
logs-okta*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5m</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: None (<a href="/guide/en/elasticsearch/reference/8.6/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule" title="Set the rule&#8217;s schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum alerts per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://developer.okta.com/docs/reference/api/system-log/" class="ulink" target="_top">https://developer.okta.com/docs/reference/api/system-log/</a>
</li>
<li class="listitem">
<a href="https://developer.okta.com/docs/reference/api/event-types/" class="ulink" target="_top">https://developer.okta.com/docs/reference/api/event-types/</a>
</li>
<li class="listitem">
<a href="/security-labs/testing-okta-visibility-and-detection-dorothy" class="ulink" target="_top">https://www.elastic.co/security-labs/testing-okta-visibility-and-detection-dorothy</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Use Case: Identity and Access Audit
</li>
<li class="listitem">
Data Source: Okta
</li>
<li class="listitem">
Tactic: Defense Evasion
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 104</p>
<p><span class="strong strong"><strong>Rule authors</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Rule license</strong></span>: Elastic License v2</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_investigation_guide_4252"></a>Investigation guide<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.6/docs/detections/prebuilt-rules/downloadable-packages/8-6-10/prebuilt-rule-8-6-10-attempt-to-modify-an-okta-policy.asciidoc">edit</a></h3>
</div></div></div>
<div class="pre_wrapper lang-markdown">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-markdown">## Triage and analysis

### Investigating Attempt to Modify an Okta Policy

Modifications to Okta policies may indicate attempts to weaken an organization's security controls. If such an attempt is detected, consider the following steps for investigation.

#### Possible investigation steps:
- Identify the actor associated with the event. Check the fields `okta.actor.id`, `okta.actor.type`, `okta.actor.alternate_id`, and `okta.actor.display_name`.
- Determine the client used by the actor. You can look at `okta.client.device`, `okta.client.ip`, `okta.client.user_agent.raw_user_agent`, `okta.client.ip_chain.ip`, and `okta.client.geographical_context`.
- Check the nature of the policy modification. You can review the `okta.target` field, especially `okta.target.display_name` and `okta.target.id`.
- Examine the `okta.outcome.result` and `okta.outcome.reason` fields to understand the outcome of the modification attempt.
- Check if there have been other similar modification attempts in a short time span from the same actor or IP address.

### False positive analysis:
- This alert might be a false positive if Okta policies are regularly updated in your organization as a part of normal operations.
- Check if the actor associated with the event has legitimate rights to modify the Okta policies.
- Verify the actor's geographical location and the time of the modification attempt. If these align with the actor's regular behavior, it could be a false positive.

### Response and remediation:
- If unauthorized modification is confirmed, initiate the incident response process.
- Lock the actor's account and enforce password change as an immediate response.
- Reset MFA tokens for the actor and enforce re-enrollment, if applicable.
- Review any other actions taken by the actor to assess the overall impact.
- If the attack was facilitated by a particular technique, ensure your systems are patched or configured to prevent such techniques.
- Consider a security review of your Okta policies and rules to ensure they follow security best practices.</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_rule_query_5688"></a>Rule query<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.6/docs/detections/prebuilt-rules/downloadable-packages/8-6-10/prebuilt-rule-8-6-10-attempt-to-modify-an-okta-policy.asciidoc">edit</a></h3>
</div></div></div>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">event.dataset:okta.system and event.action:policy.lifecycle.update</pre>
</div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Defense Evasion
</li>
<li class="listitem">
ID: TA0005
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0005/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0005/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Impair Defenses
</li>
<li class="listitem">
ID: T1562
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1562/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1562/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Sub-technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Disable or Modify Cloud Firewall
</li>
<li class="listitem">
ID: T1562.007
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1562/007/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1562/007/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="prebuilt-rule-8-6-10-attempt-to-modify-an-okta-network-zone.html">« Attempt to Modify an Okta Network Zone</a>
</span>
<span class="next">
<a href="prebuilt-rule-8-6-10-attempt-to-modify-an-okta-policy-rule.html">Attempt to Modify an Okta Policy Rule »</a>
</span>
</div>
</div>
</body>
</html>
