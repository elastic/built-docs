<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Trusted applications | Elastic Security Solution [8.6] | Elastic</title>
<meta class="elastic" name="content" content="Trusted applications | Elastic Security Solution [8.6]">

<link rel="home" href="index.html" title="Elastic Security Solution [8.6]"/>
<link rel="up" href="management-api-overview.html" title="Endpoint management API"/>
<link rel="prev" href="running-procs-api.html" title="Get processes"/>
<link rel="next" href="event-filters-api.html" title="Event filters"/>
<meta class="elastic" name="product_version" content="8.6"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.6"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.6"/>
</head>
<body>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [8.6]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="security-apis.html">Elastic Security APIs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="management-api-overview.html">Endpoint management API</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="running-procs-api.html">« Get processes</a>
</span>
<span class="next">
<a href="event-filters-api.html">Event filters »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="trusted-applications-api"></a>Trusted applications<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.6/docs/management/api/trusted-apps-api.asciidoc">edit</a></h2>
</div></div></div>
<p>Create, retrieve, update, and delete endpoint <a class="xref" href="trusted-apps-ov.html" title="Trusted applications"><em>Trusted applications</em></a> via API. Endpoint trusted applications are managed via the <a class="xref" href="exceptions-api-overview.html" title="Exceptions API"><em>Exceptions API</em></a> using a static container id (<code class="literal">list_id</code>) of <code class="literal">endpoint_trusted_apps</code>, which must be created prior to adding the trusted applications. Access to these APIs requires that a user has authorization to manage endpoints.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_create_trusted_applications_container"></a>Create trusted applications container<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.6/docs/management/api/trusted-apps-api.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">POST &lt;kibana host&gt;:&lt;port&gt;/api/exception_lists</code></p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_request_body_31"></a>Request body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.6/docs/management/api/trusted-apps-api.asciidoc">edit</a></h4>
</div></div></div>
<p>A JSON object containing the fields listed below. The request must have the following:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
The <code class="literal">list_id</code> value must be <code class="literal">endpoint_trusted_apps</code>.
</li>
<li class="listitem">
The <code class="literal">namespace_type</code> value must be <code class="literal">agnostic</code>.
</li>
<li class="listitem">
The <code class="literal">type</code> value must be <code class="literal">endpoint</code>.
</li>
</ul>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px" width="100%">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Required</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">description</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>Describes the trusted applications container.</p></td>
<td align="left" valign="top"><p>Yes</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">list_id</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top">
<p>Must be set to <code class="literal">endpoint_trusted_apps</code>.</p>
</td>
<td align="left" valign="top"><p>Yes</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">meta</code></p></td>
<td align="left" valign="top"><p>Object</p></td>
<td align="left" valign="top"><p>Placeholder for metadata about the list container.</p></td>
<td align="left" valign="top"><p>No</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">name</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>The trusted applications container&#8217;s name.</p></td>
<td align="left" valign="top"><p>Yes</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">namespace_type</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top">
<p>Must be set to <code class="literal">agnostic</code>.</p>
</td>
<td align="left" valign="top"><p>Yes</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tags</code></p></td>
<td align="left" valign="top"><p>String[]</p></td>
<td align="left" valign="top"><p>String array containing words and phrases to help categorize the
trusted applications container.</p></td>
<td align="left" valign="top"><p>No</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">type</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top">
<p>Must be set to <code class="literal">endpoint_events</code>.</p>
</td>
<td align="left" valign="top"><p>Yes</p></td>
</tr>
</tbody>
</table>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_example_request_38"></a>Example request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.6/docs/management/api/trusted-apps-api.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-kibana">
<pre class="programlisting prettyprint lang-kibana">POST api/exception_lists
{
  "description": "Elastic Defend Trusted Apps List",
  "name": "Elastic Defend Trusted Apps List",
  "list_id": "endpoint_trusted_apps",
  "type": "endpoint",
  "namespace_type": "agnostic"
}</pre>
</div>
<div class="kibana_widget" data-snippet="snippets/106.kibana"></div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_response_code_60"></a>Response code<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.6/docs/management/api/trusted-apps-api.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">200</code>
</span>
</dt>
<dd>
Indicates a successful call.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_response_payload_42"></a>Response payload<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.6/docs/management/api/trusted-apps-api.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
  "_tags": [],
  "created_at": "2020-07-13T09:33:46.187Z",
  "created_by": "elastic",
  "description": "Elastic Defend Trusted Apps List",
  "name": "Elastic Defend Trusted Apps List",
  "list_id": "endpoint_trusted_apps",
  "type": "endpoint",
  "namespace_type": "agnostic",
  "id": "f320c070-c4eb-11ea-80bb-11861bae2798",
  "tags": [],
  "tie_breaker_id": "2c08d5a5-2ecc-4d5a-acfb-0a367f25b3f3",
  "updated_at": "2020-07-13T09:33:46.359Z",
  "updated_by": "elastic"
}</pre>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="create-trusted-application-item-api"></a>Create trusted application<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.6/docs/management/api/trusted-apps-api.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">POST &lt;kibana host&gt;:&lt;port&gt;/api/exception_lists/items</code></p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_request_body_32"></a>Request body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.6/docs/management/api/trusted-apps-api.asciidoc">edit</a></h4>
</div></div></div>
<p>A JSON object containing the fields listed below. The request must have the following:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
The <code class="literal">list_id</code> value must be <code class="literal">endpoint_trusted_apps</code>.
</li>
<li class="listitem">
The <code class="literal">namespace_type</code> value must be <code class="literal">agnostic</code>.
</li>
<li class="listitem">
The <code class="literal">type</code> value must be <code class="literal">simple</code>.
</li>
</ul>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px" width="100%">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Required</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">comments</code></p></td>
<td align="left" valign="top"><p><a class="xref" href="trusted-applications-api.html#exception-trusted-application-item-comment-schema" title="comment object schema">comment</a>[]</p></td>
<td align="left" valign="top">
<p>Array of <a class="xref" href="trusted-applications-api.html#exception-trusted-application-item-comment-schema" title="comment object schema"><code class="literal">comment</code></a> objects.</p>
</td>
<td align="left" valign="top"><p>No, defaults to empty array.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">description</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>Describes the trusted application item.</p></td>
<td align="left" valign="top"><p>Yes</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">entries</code></p></td>
<td align="left" valign="top"><p><a class="xref" href="trusted-applications-api.html#exception-trusted-application-item-entry-schema" title="entry object schema">entry</a>[]</p></td>
<td align="left" valign="top"><p>Array containing the trusted application query conditions. See <a class="xref" href="trusted-applications-api.html#exception-trusted-application-item-entry-schema" title="entry object schema"><code class="literal">entry</code> object schema</a> for more details.</p></td>
<td align="left" valign="top"><p>Yes.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">list_id</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top">
<p>Must be set to <code class="literal">endpoint_trusted_apps</code>.</p>
</td>
<td align="left" valign="top"><p>Yes</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">item_id</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>Unique identifier of the exception item.</p></td>
<td align="left" valign="top"><p>No, automatically
created when it is not provided.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">meta</code></p></td>
<td align="left" valign="top"><p>Object</p></td>
<td align="left" valign="top"><p>Placeholder for metadata about the exception item.</p></td>
<td align="left" valign="top"><p>No</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">name</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>The trusted application name.</p></td>
<td align="left" valign="top"><p>Yes</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">namespace_type</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top">
<p>Must be set to <code class="literal">agnostic</code> for endpoint artifacts.</p>
</td>
<td align="left" valign="top"><p>Yes</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">os_types</code></p></td>
<td align="left" valign="top"><p><a class="xref" href="trusted-applications-api.html#exception-trusted-application-item-os-types" title="os_types values">os_type</a>[]</p></td>
<td align="left" valign="top"><p>Use this field to specify the <a class="xref" href="trusted-applications-api.html#exception-trusted-application-item-os-types" title="os_types values">operating system</a>. Only enter one value.</p></td>
<td align="left" valign="top"><p>Yes</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tags</code></p></td>
<td align="left" valign="top"><p>String[]</p></td>
<td align="left" valign="top"><p>An array of strings containing words and phrases to help categorize
exception items. Tags can also be used to define the trusted application as either globally applicable to all policies or assigned to one or more policies (per policy). See <a class="xref" href="trusted-applications-api.html#exception-trusted-application-item-scope-assignment-tags" title="Scope assignment">Scope assignment</a> for more details.</p></td>
<td align="left" valign="top"><p>No</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">type</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top">
<p>Must be set to <code class="literal">simple</code>.</p>
</td>
<td align="left" valign="top"><p>Yes</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h5 class="title"><a id="_example_request_39"></a>Example request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.6/docs/management/api/trusted-apps-api.asciidoc">edit</a></h5>
</div></div></div>
<div class="pre_wrapper lang-kibana">
<pre class="programlisting prettyprint lang-kibana">POST api/exception_lists/items
{
    "comments": [],
    "description": "some description about this entry",
    "entries": [
        {
            "field": "process.executable.caseless",
            "value": "c:\\applications\\elastic\\foo.exe",
            "type": "match",
            "operator": "included"
        }
    ],
    "list_id": "endpoint_trusted_apps",
    "name": "Some name for this item",
    "namespace_type": "agnostic",
    "os_types": [
        "windows"
    ],
    "tags": [
        "policy:all"
    ],
    "type": "simple"
}</pre>
</div>
<div class="kibana_widget" data-snippet="snippets/107.kibana"></div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_response_code_61"></a>Response code<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.6/docs/management/api/trusted-apps-api.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">200</code>
</span>
</dt>
<dd>
Indicates a successful call.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_response_payload_43"></a>Response payload<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.6/docs/management/api/trusted-apps-api.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
    "_version": "WzEzNjIsMV0=",
    "comments": [],
    "created_at": "2022-03-01T16:24:39.471Z",
    "created_by": "elastic",
    "description": "some description about this entry",
    "entries": [
        {
            "field": "process.executable.caseless",
            "value": "c:\\applications\\elastic\\foo.exe",
            "type": "match",
            "operator": "included"
        }
    ],
    "id": "17ba1bf0-997c-11ec-b212-9f4ed8b5942f",
    "item_id": "29f480e6-6d34-4bc7-9038-f809f11cb679",
    "list_id": "endpoint_trusted_apps",
    "name": "Some name for this item",
    "namespace_type": "agnostic",
    "os_types": [
        "windows"
    ],
    "tags": [
        "policy:all"
    ],
    "tie_breaker_id": "c6bedf22-2292-4d4a-8eb8-e29a50b5b519",
    "type": "simple",
    "updated_at": "2022-03-01T16:24:39.475Z",
    "updated_by": "elastic"
}</pre>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="update-trusted-application-item-api"></a>Update trusted application<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.6/docs/management/api/trusted-apps-api.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">PUT &lt;kibana host&gt;:&lt;port&gt;/api/exception_lists/items</code></p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_request_body_33"></a>Request body<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.6/docs/management/api/trusted-apps-api.asciidoc">edit</a></h4>
</div></div></div>
<p>A JSON object containing the fields listed below. The request must have the following:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
The <code class="literal">list_id</code> value must be <code class="literal">endpoint_trusted_apps</code>.
</li>
<li class="listitem">
The <code class="literal">namespace_type</code> value must be <code class="literal">agnostic</code>.
</li>
<li class="listitem">
The <code class="literal">type</code> value must be <code class="literal">simple</code>.
</li>
</ul>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px" width="100%">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Required</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">comments</code></p></td>
<td align="left" valign="top"><p><a class="xref" href="trusted-applications-api.html#exception-trusted-application-item-comment-schema" title="comment object schema">comment</a>[]</p></td>
<td align="left" valign="top">
<p>Array of <a class="xref" href="trusted-applications-api.html#exception-trusted-application-item-comment-schema" title="comment object schema"><code class="literal">comment</code></a> objects.</p>
</td>
<td align="left" valign="top"><p>No, defaults to empty array.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">description</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>Describes the trusted application.</p></td>
<td align="left" valign="top"><p>Yes</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">entries</code></p></td>
<td align="left" valign="top"><p><a class="xref" href="trusted-applications-api.html#exception-trusted-application-item-entry-schema" title="entry object schema">entry</a>[]</p></td>
<td align="left" valign="top"><p>Array containing the trusted application query conditions. See <a class="xref" href="trusted-applications-api.html#exception-trusted-application-item-entry-schema" title="entry object schema"><code class="literal">entry</code> object schema</a> for more details.</p></td>
<td align="left" valign="top"><p>Yes.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">id</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>The item&#8217;s unique identifier.</p></td>
<td align="left" valign="top">
<p>Yes, when the item&#8217;s <code class="literal">item_id</code> field is not used.</p>
</td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">item_id</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top">
<p>The <code class="literal">item_id</code> of the item you are updating.</p>
</td>
<td align="left" valign="top">
<p>Yes, when the item&#8217;s <code class="literal">id</code> field is not used.</p>
</td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">meta</code></p></td>
<td align="left" valign="top"><p>Object</p></td>
<td align="left" valign="top"><p>Placeholder for metadata about the exception item.</p></td>
<td align="left" valign="top"><p>No</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">name</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>The trusted application name.</p></td>
<td align="left" valign="top"><p>Yes</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">namespace_type</code></p></td>
<td align="left" valign="top">
<p>String</p>
</td>
<td align="left" valign="top">
<p>Must be set to <code class="literal">agnostic</code>.</p>
</td>
<td align="left" valign="top"><p>Yes</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">os_types</code></p></td>
<td align="left" valign="top"><p><a class="xref" href="trusted-applications-api.html#exception-trusted-application-item-os-types" title="os_types values">os_type</a>[]</p></td>
<td align="left" valign="top"><p>Array of <a class="xref" href="trusted-applications-api.html#exception-trusted-application-item-os-types" title="os_types values">os_type</a> values.</p></td>
<td align="left" valign="top"><p>Yes</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">tags</code></p></td>
<td align="left" valign="top"><p>String[]</p></td>
<td align="left" valign="top"><p>An array of strings containing words and phrases to help categorize
exception items. Tags can also be used to define the trusted application as either globally applicable to all policies or assigned to one or more policies (per policy). See <a class="xref" href="trusted-applications-api.html#exception-trusted-application-item-scope-assignment-tags" title="Scope assignment">Scope assignment</a> for more details.</p></td>
<td align="left" valign="top"><p>No</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">type</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top">
<p>Must be <code class="literal">simple</code>.</p>
</td>
<td align="left" valign="top"><p>Yes</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">_version</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top">
<p>The version id, normally returned by the API when the item was retrieved. Use it ensure updates are done against the latest version.</p>
</td>
<td align="left" valign="top"><p>No</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h5 class="title"><a id="_example_request_40"></a>Example request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.6/docs/management/api/trusted-apps-api.asciidoc">edit</a></h5>
</div></div></div>
<p>Updates the <code class="literal">entries</code>:</p>
<div class="pre_wrapper lang-kibana">
<pre class="programlisting prettyprint lang-kibana">PUT api/exception_lists/items
{
    "_version": "WzEzNjIsMV0=",
    "name": "App ABC",
    "description": "This app is good",
    "entries": [
        {
            "field": "process.hash.sha1",
            "value": "aedb279e378bed6c2db3c9dc9e12ba635e0b391c",
            "type": "match",
            "operator": "included"
        }
    ],
    "os_types": [
        "windows"
    ],
    "tags": [
        "policy:all"
    ],
    "id": "17ba1bf0-997c-11ec-b212-9f4ed8b5942f",
    "comments": [],
    "item_id": "29f480e6-6d34-4bc7-9038-f809f11cb679",
    "namespace_type": "agnostic",
    "type": "simple"
}</pre>
</div>
<div class="kibana_widget" data-snippet="snippets/108.kibana"></div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_response_code_62"></a>Response code<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.6/docs/management/api/trusted-apps-api.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">200</code>
</span>
</dt>
<dd>
Indicates a successful call.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_response_payload_44"></a>Response payload<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.6/docs/management/api/trusted-apps-api.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
    "_version": "WzEzNjcsMV0=",
    "comments": [],
    "created_at": "2022-03-01T16:24:39.471Z",
    "created_by": "elastic",
    "description": "This app is good",
    "entries": [
        {
            "field": "process.hash.sha1",
            "value": "aedb279e378bed6c2db3c9dc9e12ba635e0b391c",
            "type": "match",
            "operator": "included"
        }
    ],
    "id": "17ba1bf0-997c-11ec-b212-9f4ed8b5942f",
    "item_id": "29f480e6-6d34-4bc7-9038-f809f11cb679",
    "list_id": "endpoint_trusted_apps",
    "name": "App ABC",
    "namespace_type": "agnostic",
    "os_types": [
        "windows"
    ],
    "tags": [
        "policy:all"
    ],
    "tie_breaker_id": "c6bedf22-2292-4d4a-8eb8-e29a50b5b519",
    "type": "simple",
    "updated_at": "2022-03-01T17:21:07.273Z",
    "updated_by": "elastic"
}</pre>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_delete_trusted_application"></a>Delete trusted application<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.6/docs/management/api/trusted-apps-api.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">DELETE &lt;kibana host&gt;:&lt;port&gt;/api/exception_lists/items</code></p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_url_query_parameters_23"></a>URL query parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.6/docs/management/api/trusted-apps-api.asciidoc">edit</a></h4>
</div></div></div>
<p>The URL query must include one of the following:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">id</code> - the <code class="literal">id</code> of the item, or
</li>
<li class="listitem">
<code class="literal">item_id</code> -  the <code class="literal">item_id</code> of the item
</li>
</ul>
</div>
<p>In addition to the above, <code class="literal">namespace_type</code> URL query parameter is also required with a value of <code class="literal">agnostic</code>.</p>
<div class="section">
<div class="titlepage"><div><div>
<h5 class="title"><a id="_example_request_41"></a>Example request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.6/docs/management/api/trusted-apps-api.asciidoc">edit</a></h5>
</div></div></div>
<p>Deletes the trusted application with <code class="literal">item_id</code> of <code class="literal">29f480e6-6d34-4bc7-9038-f809f11cb679</code>:</p>
<div class="pre_wrapper lang-kibana">
<pre class="programlisting prettyprint lang-kibana">DELETE api/exception_lists/items?item_id=29f480e6-6d34-4bc7-9038-f809f11cb679&amp;namespace_type=agnostic</pre>
</div>
<div class="kibana_widget" data-snippet="snippets/109.kibana"></div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_response_code_63"></a>Response code<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.6/docs/management/api/trusted-apps-api.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">200</code>
</span>
</dt>
<dd>
Indicates a successful call.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_response_payload_45"></a>Response payload<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.6/docs/management/api/trusted-apps-api.asciidoc">edit</a></h4>
</div></div></div>
<p>The item that was deleted:</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
  "_version": "WzEzNjcsMV0=",
  "comments": [],
  "created_at": "2022-03-01T16:24:39.471Z",
  "created_by": "elastic",
  "description": "This app is good",
  "entries": [
    {
      "field": "process.hash.sha1",
      "type": "match",
      "value": "aedb279e378bed6c2db3c9dc9e12ba635e0b391c",
      "operator": "included"
    }
  ],
  "id": "17ba1bf0-997c-11ec-b212-9f4ed8b5942f",
  "item_id": "29f480e6-6d34-4bc7-9038-f809f11cb679",
  "list_id": "endpoint_trusted_apps",
  "name": "App ABC",
  "namespace_type": "agnostic",
  "os_types": [
    "windows"
  ],
  "tags": [
    "policy:all"
  ],
  "tie_breaker_id": "c6bedf22-2292-4d4a-8eb8-e29a50b5b519",
  "type": "simple",
  "updated_at": "2022-03-01T17:21:07.273Z",
  "updated_by": "elastic"
}</pre>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_retrieve_single_trusted_application"></a>Retrieve single trusted application<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.6/docs/management/api/trusted-apps-api.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">GET &lt;kibana host&gt;:&lt;port&gt;/api/exception_lists/items</code></p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_url_query_parameters_24"></a>URL query parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.6/docs/management/api/trusted-apps-api.asciidoc">edit</a></h4>
</div></div></div>
<p>The URL query must include one of the following:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">id</code> - the <code class="literal">id</code> of the item, or
</li>
<li class="listitem">
<code class="literal">item_id</code> -  the <code class="literal">item_id</code> of the item
</li>
</ul>
</div>
<p>In addition to the above, <code class="literal">namespace_type</code> URL query parameter is also required with a value of <code class="literal">agnostic</code>.</p>
<div class="section">
<div class="titlepage"><div><div>
<h5 class="title"><a id="_example_request_42"></a>Example request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.6/docs/management/api/trusted-apps-api.asciidoc">edit</a></h5>
</div></div></div>
<div class="pre_wrapper lang-kibana">
<pre class="programlisting prettyprint lang-kibana">GET api/exception_lists/items?item_id=29f480e6-6d34-4bc7-9038-f809f11cb679&amp;namespace_type=agnostic</pre>
</div>
<div class="kibana_widget" data-snippet="snippets/110.kibana"></div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_response_code_64"></a>Response code<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.6/docs/management/api/trusted-apps-api.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">200</code>
</span>
</dt>
<dd>
Indicates a successful call.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_response_payload_46"></a>Response payload<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.6/docs/management/api/trusted-apps-api.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
  "_version": "WzEzNjcsMV0=",
  "comments": [],
  "created_at": "2022-03-01T16:24:39.471Z",
  "created_by": "elastic",
  "description": "This app is good",
  "entries": [
    {
      "field": "process.hash.sha1",
      "type": "match",
      "value": "aedb279e378bed6c2db3c9dc9e12ba635e0b391c",
      "operator": "included"
    }
  ],
  "id": "17ba1bf0-997c-11ec-b212-9f4ed8b5942f",
  "item_id": "29f480e6-6d34-4bc7-9038-f809f11cb679",
  "list_id": "endpoint_trusted_apps",
  "name": "App ABC",
  "namespace_type": "agnostic",
  "os_types": [
    "windows"
  ],
  "tags": [
    "policy:all"
  ],
  "tie_breaker_id": "c6bedf22-2292-4d4a-8eb8-e29a50b5b519",
  "type": "simple",
  "updated_at": "2022-03-01T17:21:07.273Z",
  "updated_by": "elastic"
}</pre>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_find_trusted_applications"></a>Find trusted applications<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.6/docs/management/api/trusted-apps-api.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">GET &lt;kibana host&gt;:&lt;port&gt;/api/exception_lists/items/_find</code></p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_url_query_parameters_25"></a>URL query parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.6/docs/management/api/trusted-apps-api.asciidoc">edit</a></h4>
</div></div></div>
<div class="informaltable">
<table border="1" cellpadding="4px" width="100%">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Required</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">list_id</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top">
<p>Must be set to <code class="literal">endpoint_trusted_apps</code>.</p>
</td>
<td align="left" valign="top"><p>Yes</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">namespace_type</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top">
<p>Must be set to <code class="literal">agnostic</code>.</p>
</td>
<td align="left" valign="top"><p>Yes</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">page</code></p></td>
<td align="left" valign="top"><p>Integer</p></td>
<td align="left" valign="top"><p>The page number to return.</p></td>
<td align="left" valign="top"><p>No</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">per_page</code></p></td>
<td align="left" valign="top"><p>Integer</p></td>
<td align="left" valign="top"><p>The number of items to return per page.</p></td>
<td align="left" valign="top"><p>No</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">sort_field</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>Determines which field is used to sort the results.</p></td>
<td align="left" valign="top"><p>No</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">sort_order</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top">
<p>Determines the sort order, which can be <code class="literal">desc</code> or <code class="literal">asc</code>.</p>
</td>
<td align="left" valign="top"><p>No</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">filter</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>A <a href="/guide/en/kibana/8.6/kuery-query.html" class="ulink" target="_top">Kibana Query Language (KQL)</a> string to filter the results down.</p></td>
<td align="left" valign="top"><p>No</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h5 class="title"><a id="_example_request_43"></a>Example request<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.6/docs/management/api/trusted-apps-api.asciidoc">edit</a></h5>
</div></div></div>
<div class="pre_wrapper lang-kibana">
<pre class="programlisting prettyprint lang-kibana">GET api/exception_lists/items/_find?page=1&amp;per_page=10&amp;sort_field=name&amp;sort_order=asc&amp;list_id=endpoint_trusted_apps&amp;namespace_type=agnostic</pre>
</div>
<div class="kibana_widget" data-snippet="snippets/111.kibana"></div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_response_code_65"></a>Response code<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.6/docs/management/api/trusted-apps-api.asciidoc">edit</a></h4>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">200</code>
</span>
</dt>
<dd>
Indicates a successful call.
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="_response_payload_47"></a>Response payload<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.6/docs/management/api/trusted-apps-api.asciidoc">edit</a></h4>
</div></div></div>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
  "data": [
    {
      "_version": "WzEzNjcsMV0=",
      "comments": [],
      "created_at": "2022-03-01T16:24:39.471Z",
      "created_by": "elastic",
      "description": "This app is good",
      "entries": [
        {
          "field": "process.hash.sha1",
          "type": "match",
          "value": "aedb279e378bed6c2db3c9dc9e12ba635e0b391c",
          "operator": "included"
        }
      ],
      "id": "17ba1bf0-997c-11ec-b212-9f4ed8b5942f",
      "item_id": "29f480e6-6d34-4bc7-9038-f809f11cb679",
      "list_id": "endpoint_trusted_apps",
      "name": "App ABC",
      "namespace_type": "agnostic",
      "os_types": [
        "windows"
      ],
      "tags": [
        "policy:all"
      ],
      "tie_breaker_id": "c6bedf22-2292-4d4a-8eb8-e29a50b5b519",
      "type": "simple",
      "updated_at": "2022-03-01T17:21:07.273Z",
      "updated_by": "elastic"
    }
  ],
  "page": 1,
  "per_page": 10,
  "total": 1
}</pre>
</div>
</div>

</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_value_types"></a>Value types<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.6/docs/management/api/_exceptions-api-reusable-content.asciidoc">edit</a></h3>
</div></div></div>
<p>The following describes the types that can be defined when using the <a class="xref" href="trusted-applications-api.html#create-trusted-application-item-api" title="Create trusted application">create</a> or <a class="xref" href="trusted-applications-api.html#update-trusted-application-item-api" title="Update trusted application">update</a> trusted applications APIs:</p>
<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="exception-trusted-application-item-comment-schema"></a><code class="literal">comment</code> object schema<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.6/docs/management/api/_exceptions-api-reusable-content.asciidoc">edit</a></h4>
</div></div></div>
<p>Comments are JSON objects containing the following structure:</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
    "comment": "some comment here"
}</pre>
</div>
<p>When used with the update API, existing comments can be updated by using their associated <code class="literal">id</code>, while any comment without the <code class="literal">id</code> attribute will be added as a new comment:</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
    "comment": "some comment here - updated",
    "id": "1078cf59-5893-4143-acf7-40a40af16bee"
}</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="exception-trusted-application-item-os-types"></a><code class="literal">os_types</code> values<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.6/docs/management/api/_exceptions-api-reusable-content.asciidoc">edit</a></h4>
</div></div></div>
<p>The following are the valid OS types that can be used when creating trusted applications:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">windows</code>
</li>
<li class="listitem">
<code class="literal">linux</code>
</li>
<li class="listitem">
<code class="literal">macos</code>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="exception-trusted-application-item-scope-assignment-tags"></a>Scope assignment<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.6/docs/management/api/_exceptions-api-reusable-content.asciidoc">edit</a></h4>
</div></div></div>
<p>Trusted applications can be assigned globally across all endpoint policies, or assigned to specific policies. You can assign the trusted application by defining one or more tags with a prefix of <code class="literal">policy:</code>. Note that the trusted application can be either global or per policy, but not <span class="strong strong"><strong>both</strong></span>. The following tags are available for use in order to control the assignment scope:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">policy:all</code> : Trusted application is global to all policies. If used, no other <code class="literal">policy:</code> tag is allowed.
</li>
<li class="listitem">
<code class="literal">policy:&lt;endpoint-policy-id&gt;</code> : Trusted application is assigned to a policy. Multiple <code class="literal">per policy</code> tags can be used to associate the trusted application to multiple policies.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h4 class="title"><a id="exception-trusted-application-item-entry-schema"></a><code class="literal">entry</code> object schema<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.6/docs/management/api/trusted-apps-api.asciidoc">edit</a></h4>
</div></div></div>
<p>Endpoint trusted applications allow for at most 3 conditions to be defined. No duplicates are allowed. The following entries are supported by trusted applications:</p>
<div class="section">
<div class="titlepage"><div><div>
<h5 class="title"><a id="_process_hashes"></a>Process hashes<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.6/docs/management/api/trusted-apps-api.asciidoc">edit</a></h5>
</div></div></div>
<p>Process hashes are supported by all <a class="xref" href="trusted-applications-api.html#exception-trusted-application-item-os-types" title="os_types values">OS types</a>. A hash entry has the following structure:</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
  "field": "process.hash.sha1",
  "value": "aedb279e378bed6c2db3c9dc9e12ba635e0b391c",
  "type": "match",
  "operator": "included"
}</pre>
</div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">field</code> : The following values are supported: <code class="literal">process.hash.md5</code>, <code class="literal">process.hash.sha1</code> or <code class="literal">process.hash.sha256</code>.
</li>
<li class="listitem">
<code class="literal">value</code> : The hash value associated with the <code class="literal">field</code>.
</li>
<li class="listitem">
<code class="literal">type</code> : Must be <code class="literal">match</code>.
</li>
<li class="listitem">
<code class="literal">operator</code> : Must be <code class="literal">included</code>.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h5 class="title"><a id="_process_file_path"></a>Process file path<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.6/docs/management/api/trusted-apps-api.asciidoc">edit</a></h5>
</div></div></div>
<p>Process file paths are supported by all <a class="xref" href="trusted-applications-api.html#exception-trusted-application-item-os-types" title="os_types values">OS types</a>. A file path entry has the following structure:</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
  "field": "process.executable.caseless",
  "value": "c:/path/to/file.exe",
  "type": "match",
  "operator": "included"
}</pre>
</div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">field</code> : Must be <code class="literal">process.executable.caseless</code>.
</li>
<li class="listitem">
<code class="literal">value</code> : The file path to match on.
</li>
<li class="listitem">
<code class="literal">type</code> : Can be set to <code class="literal">match</code> (exact match) or <code class="literal">wildcard</code>. When using <code class="literal">wildcard</code>, the <code class="literal">*</code> can be used in the path <code class="literal">value</code>.
</li>
<li class="listitem">
<code class="literal">operator</code> : Must be <code class="literal">included</code>.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h5 class="title"><a id="_process_signature"></a>Process signature<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.6/docs/management/api/trusted-apps-api.asciidoc">edit</a></h5>
</div></div></div>
<p>Process signature is supported only for Windows <a class="xref" href="trusted-applications-api.html#exception-trusted-application-item-os-types" title="os_types values">OS type</a>. A signature entry has the following structure:</p>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
  "field": "process.Ext.code_signature",
  "type": "nested",
  "entries": [
    {
      "field": "trusted",
      "value": "true",
      "type": "match",
      "operator": "included"
    },
    {
      "field": "subject_name",
      "value": "elastic",
      "type": "match",
      "operator": "included"
    }
  ]
}</pre>
</div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">field</code> : Must be set to <code class="literal">process.Ext.code_signature</code>.
</li>
<li class="listitem">
<code class="literal">type</code> : Must be set to <code class="literal">nested</code>.
</li>
<li class="listitem">
<code class="literal">entries</code>: An array with 2 <code class="literal">entry</code> items.
</li>
<li class="listitem">
<code class="literal">entries[0]</code> : An entry with <code class="literal">{ "field": "trusted", "value": "true", "type": "match", "operator": "included" }</code>.
</li>
<li class="listitem">
<p><code class="literal">entries[1]</code> : The entry defining the signature to be matched upon:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">field</code>: Must be set to <code class="literal">subject_name</code>.
</li>
<li class="listitem">
<code class="literal">value</code> : The signature name to match on.
</li>
<li class="listitem">
<code class="literal">type</code> : Must be set to <code class="literal">match</code>.
</li>
<li class="listitem">
<code class="literal">operator</code> : Must be set to <code class="literal">included</code>.
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h5 class="title"><a id="_example_for_a_windows_trusted_application"></a>Example for a Windows trusted application:<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.6/docs/management/api/trusted-apps-api.asciidoc">edit</a></h5>
</div></div></div>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">[
  {
    "field": "process.hash.sha1",
    "value": "aedb279e378bed6c2db3c9dc9e12ba635e0b391c",
    "type": "match",
    "operator": "included"
  },
  {
    "field": "process.executable.caseless",
    "value": "c:/path/to/file.exe",
    "type": "match",
    "operator": "included"
  },
  {
    "field": "process.Ext.code_signature",
    "entries": [
      {
        "field": "trusted",
        "value": "true",
        "type": "match",
        "operator": "included"
      },
      {
        "field": "subject_name",
        "value": "elastic",
        "type": "match",
        "operator": "included"
      }
    ],
    "type": "nested"
  }
]</pre>
</div>
</div>

</div>

</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="running-procs-api.html">« Get processes</a>
</span>
<span class="next">
<a href="event-filters-api.html">Event filters »</a>
</span>
</div>
</div>
</body>
</html>
