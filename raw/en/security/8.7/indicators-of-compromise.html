<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Indicators of compromise | Elastic Security Solution [8.7] | Elastic</title>
<meta class="elastic" name="content" content="Indicators of compromise | Elastic Security Solution [8.7]">

<link rel="home" href="index.html" title="Elastic Security Solution [8.7]"/>
<link rel="up" href="investigate-events.html" title="Investigate"/>
<link rel="prev" href="cases-ui-integrations.html" title="Configure external connections"/>
<link rel="next" href="use-osquery.html" title="Osquery"/>
<meta class="elastic" name="product_version" content="8.7"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.7"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.7"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body><div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [8.7]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="investigate-events.html">Investigate</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="cases-ui-integrations.html">« Configure external connections</a>
</span>
<span class="next">
<a href="use-osquery.html">Osquery »</a>
</span>
</div>
<div class="chapter">
<div class="titlepage"><div><div>
<h2 class="title"><a id="indicators-of-compromise"></a>Indicators of compromise<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.7/docs/cases/indicators-of-compromise.asciidoc">edit</a></h2>
</div></div></div>
<p>The Indicators page (<span class="strong strong"><strong>Intelligence &#8594; Indicators</strong></span>) collects data from enabled threat intelligence feeds and provides a centralized view of indicators, also known as indicators of compromise (IoCs). This topic helps you set up the Indicators page and explains how to work with IoCs.</p>
<div class="sidebar">
<div class="titlepage"><div><div>
<p class="title"><strong>Requirements</strong></p>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
The Indicators page is an <a href="/pricing" class="ulink" target="_top">Enterprise subscription</a> feature.
</li>
<li class="listitem">
<p>You must have <em>one</em> of the following installed on the hosts you want to monitor:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Elastic Agent</strong></span> - Install a <a href="/guide/en/fleet/8.7/install-fleet-managed-elastic-agent.html" class="ulink" target="_top">Fleet-managed Elastic Agent</a> and ensure the agent&#8217;s status is <code class="literal">Healthy</code>. Refer to <a href="/guide/en/fleet/8.7/fleet-troubleshooting.html" class="ulink" target="_top">Fleet Troubleshooting</a> if it isn&#8217;t.
</li>
<li class="listitem">
<span class="strong strong"><strong>Filebeat</strong></span> - Install <a href="/guide/en/beats/filebeat/8.7/filebeat-installation-configuration.html" class="ulink" target="_top">Filebeat</a> version 8.x or later. Earlier Filebeat versions are incompatible with ECS and will prevent indicator data from displaying in the Indicators table.
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="images/indicators-table.png" alt="Shows the Indicators page">
</div>
</div>
<h3><a id="ti-indicators"></a>Threat intelligence and indicators<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.7/docs/cases/indicators-of-compromise.asciidoc">edit</a></h3>
<p>Threat intelligence is a research function that analyzes current and emerging threats and recommends appropriate actions to strengthen a company&#8217;s security posture. Threat intelligence requires proactivity to be useful, such as gathering, analyzing, and investigating various threat and vulnerability data sources.</p>
<p>An indicator, also referred to as an IoC, is a piece of information associated with a known threat or reported vulnerability. There are many types of indicators, including URLs, files, domains, email addresses, and more. Within SOC teams, threat intelligence analysts use indicators to detect, assess, and respond to threats.</p>
<h3><a id="setup-indicators-page"></a>Set up the Indicators page<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.7/docs/cases/indicators-of-compromise.asciidoc">edit</a></h3>
<p>Install a threat intelligence integration to add indicators to the Indicators page.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Choose one of the following:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
From the Elastic Security app main menu, go to <span class="strong strong"><strong>Intelligence</strong></span> &#8594; <span class="strong strong"><strong>Indicators</strong></span> &#8594; <span class="strong strong"><strong>Add Integrations</strong></span>.
</li>
<li class="listitem">
From the Kibana main menu, click <span class="strong strong"><strong>Add integrations</strong></span>. Scroll down the list of integration categories and select <span class="strong strong"><strong>Threat Intelligence</strong></span> to filter by threat intelligence integrations.
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Select a threat intelligence integration, then complete the integration&#8217;s guided installation.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>For more information about available fields, go to the <a href="https://docs.elastic.co/integrations" class="ulink" target="_top">Elastic integration documentation</a> and search for a specific threat intelligence integration.</p>
</div>
</div>
</li>
<li class="listitem">
Return to the Indicators page in Elastic Security. Refresh the page if indicator data isn&#8217;t displaying.
</li>
</ol>
</div>
<h4><a id="troubleshoot-indicators-page"></a>Troubleshooting<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.7/docs/cases/indicators-of-compromise.asciidoc">edit</a></h4>
<p>If indicator data is not appearing in the Indicators table after you installed a threat intelligence integration:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Verify that the index storing indicator documents is included in the <a class="xref" href="advanced-settings.html#update-sec-indices" title="Update default Elastic Security indices">default Elastic Security indices</a> (<code class="literal">securitySolution:defaultIndex</code>). The index storing indicator documents will differ based on the way you&#8217;re collecting indicator data:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Elastic Agent integrations</strong></span> - <code class="literal">logs_ti*</code>
</li>
<li class="listitem">
<span class="strong strong"><strong>Filebeat integrations</strong></span> - <code class="literal">filebeat-*</code>
</li>
</ul>
</div>
</li>
<li class="listitem">
Ensure the indicator data you&#8217;re ingesting is mapped to <a href="/guide/en/ecs/8.7" class="ulink" target="_top">Elastic Common Schema (ECS)</a>.
</li>
</ul>
</div>
<h3><a id="intelligence-page-ui"></a>Indicators page UI<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.7/docs/cases/indicators-of-compromise.asciidoc">edit</a></h3>
<p>After you add indicators to the Indicators page, you can <a class="xref" href="indicators-of-compromise.html#examine-indicator-details" title="Examine indicator details">examine</a>, search, filter, and take action on indicator data. Indicators also appear in the Trend view, which shows the total values in the legend.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/interact-with-indicators-table.gif" alt="interact with indicators table" width="90%][height=90%][Shows how to interact with the Intelligence page">
</div>
</div>
<h4><a id="examine-indicator-details"></a>Examine indicator details<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.7/docs/cases/indicators-of-compromise.asciidoc">edit</a></h4>
<p>Learn more about an indicator by clicking <span class="strong strong"><strong>View details</strong></span>, then opening the Indicator details flyout. The flyout contains these informational tabs:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p><span class="strong strong"><strong>Overview</strong></span>: A summary of the indicator, including the indicator&#8217;s name, the threat intelligence feed it came from, the indicator type, and additional relevant data.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Some threat intelligence feeds provide  <a href="https://www.cisa.gov/tlp#:~:text=Introduction,shared%20with%20the%20appropriate%20audience" class="ulink" target="_top">Traffic Light Protocol (TLP) markings</a>. The <code class="literal">TLP Marking</code> and <code class="literal">Confidence</code> fields will be empty if the feed doesn&#8217;t provide that data.</p>
</div>
</div>
</li>
<li class="listitem">
<span class="strong strong"><strong>Table</strong></span>: The indicator data in table format.
</li>
<li class="listitem">
<p><span class="strong strong"><strong>JSON</strong></span>: The indicator data in JSON format.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/indicator-details-flyout.png" alt="Shows the Indicator details flyout" width="600">
</div>
</div>
</li>
</ul>
</div>
<h3><a id="find-related-sec-events"></a>Find related security events<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.7/docs/cases/indicators-of-compromise.asciidoc">edit</a></h3>
<p>Investigate an indicator in <a class="xref" href="timelines-ui.html" title="Investigate events in Timeline">Timeline</a> to identify and predict related events in your environment. You can add an indicator to Timeline from the Indicators table or the Indicator details flyout.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/indicator-query-timeline.png" alt="Shows the results of an indicator being investigated in Timeline">
</div>
</div>
<p>When you add an indicator to Timeline, a new Timeline opens with an auto-generated KQL query. The query contains the indicator field-value pair that you selected plus the field-value pair of the automatically mapped source event. By default, the query&#8217;s time range is set to seven days before and after the indicator&#8217;s <code class="literal">timestamp</code>.</p>
<h4><a id="example-indicator-timeline"></a>Example indicator Timeline investigation<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.7/docs/cases/indicators-of-compromise.asciidoc">edit</a></h4>
<p>The following image shows a file hash indictor being investigated in Timeline. The indicator field-value pair is:</p>
<p><code class="literal">threat.indicator.file.hash.sha256 : c207213257a63589b1e1bd2f459b47becd000c1af8ea7983dd9541aff145c3ba</code></p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/indicator-in-timeline.png" alt="Shows the results of an indicator being investigated in Timeline">
</div>
</div>
<p>The auto-generated query contains the indicator field-value pair (mentioned previously) and the auto-mapped source event field-value pair, which is:</p>
<p><code class="literal">file.hash.sha256 : c207213257a63589b1e1bd2f459b47becd000c1af8ea7983dd9541aff145c3ba</code></p>
<p>The query results show an alert with a matching <code class="literal">file.hash.sha256</code> field value, which may indicate suspicious or malicious activity in the environment.</p>
<h3><a id="attach-indicator-to-case"></a>Attach indicators to cases<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.7/docs/cases/indicators-of-compromise.asciidoc">edit</a></h3>
<p>Attaching indicators to cases provides more context and available actions for your investigations. This feature allows you to easily share or escalate threat intelligence to other teams.</p>
<p>To add indicators to cases:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
From the Indicators table, click the <span class="strong strong"><strong>More actions</strong></span> (<span class="strong strong"><strong>&#8230;&#8203;​</strong></span>) menu. Alternatively, open an indicator&#8217;s details, then select <span class="strong strong"><strong>Take action</strong></span>.
</li>
<li class="listitem">
<p>Select one of the following:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Add to existing case</strong></span>: From the <span class="strong strong"><strong>Select case</strong></span> dialog box, select the case to which you want to attach the indicator.
</li>
<li class="listitem">
<span class="strong strong"><strong>Add to new case</strong></span>: Configure the case details. Refer to <a class="xref" href="cases-open-manage.html#cases-ui-open" title="Open a new case">Open a new case</a> to learn more about opening a new case.
</li>
</ul>
</div>
<p>The indicator is added to the case as a new comment.</p>
</li>
</ol>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="images/indicator-added-to-case.png" alt="An indicator attached to a case">
</div>
</div>
<h4><a id="review-indicator-in-case"></a>Review indicator details in cases<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.7/docs/cases/indicators-of-compromise.asciidoc">edit</a></h4>
<p>When you attach an indicator to a case, the indicator is added as a new comment with the following details:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p><span class="strong strong"><strong>Indicator name</strong></span>: Click the linked name to open the Indicator details flyout, which contains the following tabs:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p><span class="strong strong"><strong>Overview</strong></span>: A summary of the threat indicator, including its name and type, which threat intelligence feed it came from, and additional relevant data.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Some threat intelligence feeds provide  <a href="https://www.cisa.gov/tlp#:~:text=Introduction,shared%20with%20the%20appropriate%20audience" class="ulink" target="_top">Traffic Light Protocol (TLP) markings</a>. The <code class="literal">TLP Marking</code> and <code class="literal">Confidence</code> fields will be empty if the feed doesn&#8217;t provide that data.</p>
</div>
</div>
</li>
<li class="listitem">
<span class="strong strong"><strong>Table</strong></span>: The indicator data in table format.
</li>
<li class="listitem">
<span class="strong strong"><strong>JSON</strong></span>: The indicator data in JSON format.
</li>
</ul>
</div>
</li>
<li class="listitem">
<span class="strong strong"><strong>Feed name</strong></span>: The threat feed from which the indicator was ingested.
</li>
<li class="listitem">
<span class="strong strong"><strong>Indicator type</strong></span>: The indicator type, for example, <code class="literal">file</code> or <code class="literal">.exe</code>.
</li>
</ul>
</div>
<h4><a id="delete-indicator-from-case"></a>Remove indicators from cases<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.7/docs/cases/indicators-of-compromise.asciidoc">edit</a></h4>
<p>To remove an indicator attached to a case, click the <span class="strong strong"><strong>More actions</strong></span> (<span class="strong strong"><strong>&#8230;&#8203;​</strong></span>) menu &#8594; <span class="strong strong"><strong>Delete attachment</strong></span> in the case comment.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/remove-indicator.png" alt="Removing an indicator from a case">
</div>
</div>
<h3><a id="add-indicator-to-blocklist"></a>Use data from indicators to expand the blocklist<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.7/docs/cases/indicators-of-compromise.asciidoc">edit</a></h3>
<p>Add indicator values to the <a class="xref" href="blocklist.html" title="Blocklist">blocklist</a> to prevent selected applications from running on your hosts. You can use MD5, SHA-1, or SHA-256 hash values from <code class="literal">file</code> type indicators.</p>
<p>You can add indicator values to the blocklist from the Indicators table or the Indicator details flyout. From the Indicators table, select the <span class="strong strong"><strong>More actions</strong></span> (<span class="strong strong"><strong>&#8230;&#8203;​</strong></span>) menu &#8594; <span class="strong strong"><strong>Add blocklist entry</strong></span>.  Alternatively, open an indicator&#8217;s details, then select the <span class="strong strong"><strong>Take action</strong></span> menu &#8594; <span class="strong strong"><strong>Add blocklist entry</strong></span>.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Refer to <a class="xref" href="blocklist.html" title="Blocklist">Blocklist</a> for more information about blocklist entries.</p>
</div>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="cases-ui-integrations.html">« Configure external connections</a>
</span>
<span class="next">
<a href="use-osquery.html">Osquery »</a>
</span>
</div>
</div>
</body>
</html>
