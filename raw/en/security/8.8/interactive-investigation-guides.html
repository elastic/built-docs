<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Interactive investigation guides | Elastic Security Solution [8.8] | Elastic</title>
<meta class="elastic" name="content" content="Interactive investigation guides | Elastic Security Solution [8.8]">

<link rel="home" href="index.html" title="Elastic Security Solution [8.8]"/>
<link rel="up" href="sec-experimental-intro.html" title="Technical preview"/>
<link rel="prev" href="network-beaconing-framework.html" title="Network Beaconing"/>
<link rel="next" href="release-notes.html" title="Release notes"/>
<meta class="elastic" name="product_version" content="8.8"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.8"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.8"/>
</head>
<body>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [8.8]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="sec-experimental-intro.html">Technical preview</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="network-beaconing-framework.html">« Network Beaconing</a>
</span>
<span class="next">
<a href="release-notes.html">Release notes »</a>
</span>
</div>
<div class="chapter">
<div class="titlepage"><div><div>
<h2 class="title"><a id="interactive-investigation-guides"></a>Interactive investigation guides<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.8/docs/experimental-features/investigation-guide-actions.asciidoc">edit</a></h2>
</div></div></div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>This feature is available for Elastic Stack versions 8.6.0 and newer. Additionally, interactive investigation guides are not compatible between release versions, so query buttons created in 8.6.0 won&#8217;t render correctly in 8.8.0 and vice versa.</p>
</div>
</div>
<p>Detection rule investigation guides suggest steps for triaging, analyzing, and responding to potential security issues. For custom rules, you can create an interactive investigation guide that includes buttons for launching runtime queries in <a class="xref" href="timelines-ui.html" title="Investigate events in Timeline">Timeline</a>, using alert data and hard-coded literal values. This allows you to start detailed Timeline investigations directly from an alert using relevant data.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/ig-alert-flyout.png" alt="Alert details flyout with interactive investigation guide" width="550">
</div>
</div>
<p>Each query button displays the number of event documents found. Click the button to automatically load the query in Timeline based on configuration settings in the investigation guide.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/ig-timeline.png" alt="Timeline with query pre-loaded from investigation guide action">
</div>
</div>
<h3><a id="add-ig-actions-rule"></a>Add investigation guide actions to a rule<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.8/docs/experimental-features/investigation-guide-actions.asciidoc">edit</a></h3>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>You can only create interactive investigation guides with custom rules because Elastic prebuilt rules can&#8217;t be edited. However, you can duplicate a prebuilt rule, then configure the investigation guide for the duplicated rule.</p>
</div>
</div>
<p>You can configure an interactive investigation guide when you <a class="xref" href="rules-ui-create.html" title="Create a detection rule">create a new rule</a> or <a class="xref" href="rules-ui-management.html#edit-rules-settings" title="Modify existing rules settings">edit an existing rule</a>.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>When configuring the rule&#8217;s settings (the <span class="strong strong"><strong>About rule</strong></span> step for a new rule, or the <span class="strong strong"><strong>About</strong></span> tab for an existing rule), expand the <span class="strong strong"><strong>Advanced settings</strong></span>, then scroll down to the <span class="strong strong"><strong>Investigation guide</strong></span> Markdown editor.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/ig-investigation-guide-editor.png" alt="Investigation guide editor field">
</div>
</div>
</li>
<li class="listitem">
<p>Place the editor cursor where you want to add the query button in the investigation guide, then select the Insights icon (<span class="image"><img src="images/ig-insights-icon.png" alt="Insights icon" width="16" height="15"></span>) in the toolbar. The <span class="strong strong"><strong>Add investigation query</strong></span> builder form appears.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/ig-investigation-query-builder.png" alt="Add investigation guide UI" width="600">
</div>
</div>
</li>
<li class="listitem">
<p>Complete the query builder form to create an investigation query:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<span class="strong strong"><strong>Label</strong></span>: Enter the text to appear on the query button.
</li>
<li class="listitem">
<span class="strong strong"><strong>Description</strong></span>: (Optional) Enter additional text to include with the button.
</li>
<li class="listitem">
<p><span class="strong strong"><strong>Filters</strong></span>: Select fields, operators, and values to build the query. Click <span class="strong strong"><strong>OR</strong></span> or <span class="strong strong"><strong>AND</strong></span> to create multiple filters and define their relationships.</p>
<p>To use a field value from the alert as a query parameter, enter the field name surrounded by double curly brackets — such as <code class="literal">{{kibana.alert.example}}</code> — as a custom option for the filter value.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/ig-filters-field-custom-value.png" alt="Add investigation guide UI" width="600">
</div>
</div>
</li>
<li class="listitem">
<span class="strong strong"><strong>Relative time range</strong></span>: (Optional) Select a time range to limit the query, relative to the alert&#8217;s creation time.
</li>
</ol>
</div>
</li>
<li class="listitem">
<p>Click <span class="strong strong"><strong>Save changes</strong></span>. The syntax is added to the investigation guide editor.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>If you need to change the query button&#8217;s configuration, you can either edit the syntax directly in the editor (refer to the <a class="xref" href="interactive-investigation-guides.html#query-button-syntax" title="Query button syntax">syntax reference</a> below), or delete the syntax and use the query builder form to recreate the query.</p>
</div>
</div>
</li>
<li class="listitem">
Save and enable the rule.
</li>
</ol>
</div>
<h4><a id="query-button-syntax"></a>Query button syntax<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.8/docs/experimental-features/investigation-guide-actions.asciidoc">edit</a></h4>
<p>The following syntax defines a query button in an interactive investigation guide.</p>
<div class="informaltable">
<table border="1" cellpadding="4px" width="100%">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Field</th>
<th align="left" valign="top">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">!{investigate{ }}</code></p></td>
<td align="left" valign="top"><p>The container object holding all the query button&#8217;s configuration attributes.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">label</code></p></td>
<td align="left" valign="top"><p>Identifying text on the button.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">description</code></p></td>
<td align="left" valign="top"><p>Additional text included with the button.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">providers</code></p></td>
<td align="left" valign="top">
<p>A two-level nested array that defines the query to run in Timeline. Similar to the structure of queries in Timeline, items in the outer level are joined by an <code class="literal">OR</code> relationship, and items in the inner level are joined by an <code class="literal">AND</code> relationship.</p>
<p>Each item in <code class="literal">providers</code> corresponds to a filter created in the query builder UI and is defined by these attributes:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">field</code>: The name of the field to query.
</li>
<li class="listitem">
<code class="literal">excluded</code>: Whether the query result is excluded (such as <span class="strong strong"><strong>is not one of</strong></span>) or included (<span class="strong strong"><strong>is one of</strong></span>).
</li>
<li class="listitem">
<code class="literal">queryType</code>: The query type used to filter events, based on the filter&#8217;s operator. For example, <code class="literal">phrase</code> or <code class="literal">range</code>.
</li>
<li class="listitem">
<code class="literal">value</code>: The value to search for. Either a hard-coded literal value, or the name of an alert field (in double curly brackets) whose value you want to use as a query parameter.
</li>
<li class="listitem">
<code class="literal">valueType</code>: The data type of <code class="literal">value</code>, such as <code class="literal">string</code> or <code class="literal">boolean</code>.
</li>
</ul>
</div>
</td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">relativeFrom</code>, <code class="literal">relativeTo</code></p></td>
<td align="left" valign="top"><p>(Optional) The start and end, respectively, of the relative time range for the query. Times are relative to the alert&#8217;s creation time, represented as <code class="literal">now</code> in <a href="/guide/en/elasticsearch/reference/8.8/common-options.html#date-math" class="ulink" target="_top">date math</a> format. For example, selecting <span class="strong strong"><strong>Last 15 minutes</strong></span> in the query builder form creates the syntax <code class="literal">"relativeFrom": "now-15m", "relativeTo": "now"</code>.</p></td>
</tr>
</tbody>
</table>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Some characters must be escaped with a backslash, such as <code class="literal">\"</code> for a quotation mark and <code class="literal">\\</code> for a literal backslash. Divide Windows paths with double backslashes (for example, <code class="literal">C:\\Windows\\explorer.exe</code>), and paths that already include double backslashes might require four backslashes for each divider. A clickable error icon (<span class="image"><img src="images/ig-error-icon.png" alt="Error icon" width="19" height="18"></span>) displays below the Markdown editor if there are any syntax errors.</p>
</div>
</div>
<h4><a id="_example_syntax"></a>Example syntax<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.8/docs/experimental-features/investigation-guide-actions.asciidoc">edit</a></h4>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">!{investigate{
  "label": "Test action",
  "description": "Click to investigate.",
  "providers": [
    [
      {"field": "event.id", "excluded": false, "queryType": "phrase", "value": "{{event.id}}", "valueType": "string"}
    ],
    [
      {"field": "event.action", "excluded": false, "queryType": "phrase", "value": "rename", "valueType": "string"},
      {"field": "process.pid", "excluded": false, "queryType": "phrase", "value": "{{process.pid}}", "valueType": "string"}
    ]
  ],
  "relativeFrom": "now-15m",
  "relativeTo": "now"
}}</pre>
</div>
<p>This example creates the following Timeline query, as illustrated below:</p>
<p><code class="literal">(event.id : &lt;alert value&gt;)</code><br>
<code class="literal">OR (event.action : "rename" AND process.pid : &lt;alert value&gt;)</code></p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/ig-timeline-query.png" alt="Timeline query" width="500">
</div>
</div>
<h4><a id="_timeline_template_fields"></a>Timeline template fields<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.8/docs/experimental-features/investigation-guide-actions.asciidoc">edit</a></h4>
<p>When viewing an interactive investigation guide in contexts unconnected to a specific alert (such a rule&#8217;s details page), queries open as <a class="xref" href="timeline-templates-ui.html" title="About Timeline templates">Timeline templates</a>, and <code class="literal">parameter</code> fields are treated as Timeline template fields.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/ig-timeline-template-fields.png" alt="Timeline template" width="500">
</div>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="network-beaconing-framework.html">« Network Beaconing</a>
</span>
<span class="next">
<a href="release-notes.html">Release notes »</a>
</span>
</div>
</div>
</body>
</html>
