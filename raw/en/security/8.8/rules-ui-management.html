<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Manage detection rules | Elastic Security [8.8] | Elastic</title>
<meta class="elastic" name="content" content="Manage detection rules | Elastic Security [8.8]">

<link rel="home" href="index.html" title="Elastic Security [8.8]"/>
<link rel="up" href="detection-engine-overview.html" title="Detections and alerts"/>
<link rel="prev" href="rules-cross-cluster-search.html" title="Cross-cluster search and detection rules"/>
<link rel="next" href="alerts-ui-monitor.html" title="Monitor and troubleshoot rule executions"/>
<meta class="elastic" name="product_version" content="8.8"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.8"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.8"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
<strong>IMPORTANT</strong>: No additional bug fixes or documentation updates
will be released for this version. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div class="navheader">
<span class="prev">
<a href="rules-cross-cluster-search.html">« Cross-cluster search and detection rules</a>
</span>
<span class="next">
<a href="alerts-ui-monitor.html">Monitor and troubleshoot rule executions »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security [8.8]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="detection-engine-overview.html">Detections and alerts</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Manage detection rules</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.8/docs/detections/rules-ui-manage.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div id="url-to-v3" class="version-warning">
    <strong>IMPORTANT</strong>: This documentation is no longer updated. Refer to <a href="https://www.elastic.co/support/eol">Elastic's version policy</a> and the <a href="https://www.elastic.co/docs/solutions/security/detect-and-alert/manage-detection-rules">latest documentation</a>.
</div>
<div class="chapter xpack">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="rules-ui-management"></a>Manage detection rules</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.8/docs/detections/rules-ui-manage.asciidoc">edit</a></div>
</div></div></div>
<p>The Rules page allows you to view and manage all prebuilt and custom detection rules.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/all-rules.png" alt="The Rules page">
</div>
</div>
<p>On the Rules page, you can:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="rules-ui-management.html#sort-filter-rules" title="Sort and filter the rules list">Sort and filter the rules list</a>
</li>
<li class="listitem">
<a class="xref" href="rules-ui-management.html#rule-status" title="Check the current status of rules">Check the current status of rules</a>
</li>
<li class="listitem">
<a class="xref" href="rules-ui-management.html#load-prebuilt-rules" title="Load and activate Elastic prebuilt rules">Load and activate Elastic prebuilt rules</a>
</li>
<li class="listitem">
<a class="xref" href="rules-ui-management.html#prebuilt-rule-tags" title="Prebuilt rule tags">Prebuilt rule tags</a>
</li>
<li class="listitem">
<a class="xref" href="rules-ui-management.html#select-all-prebuilt-rules" title="Select and duplicate all prebuilt rules">Select and duplicate all prebuilt rules</a>
</li>
<li class="listitem">
<a class="xref" href="rules-ui-management.html#download-prebuilt-rules" title="Download latest Elastic prebuilt rules">Download latest Elastic prebuilt rules</a>
</li>
<li class="listitem">
<a class="xref" href="rules-ui-management.html#rule-prerequisites" title="Confirm rule prerequisites">Confirm rule prerequisites</a>
</li>
<li class="listitem">
<a class="xref" href="rules-ui-management.html#edit-rules-settings" title="Modify existing rules settings">Modify existing rules settings</a>
</li>
<li class="listitem">
<a class="xref" href="rules-ui-management.html#manage-rules-ui" title="Manage rules">Manage rules</a>
</li>
<li class="listitem">
<a class="xref" href="rules-ui-management.html#snooze-rule-actions" title="Snooze rule actions">Snooze rule actions</a>
</li>
<li class="listitem">
<a class="xref" href="rules-ui-management.html#import-export-rules-ui" title="Export and import rules">Export and import rules</a>
</li>
<li class="listitem">
<a class="xref" href="alerts-ui-monitor.html#troubleshoot-signals" title="Troubleshoot missing alerts">Troubleshoot missing alerts</a>
</li>
</ul>
</div>
<div class="position-relative"><h3><a id="sort-filter-rules"></a>Sort and filter the rules list</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.8/docs/detections/rules-ui-manage.asciidoc">edit</a></div>
<p>To sort the rules list, click any column header. To sort in descending order, click the column header again.</p>
<p>To filter the rules list, enter a search term in the search bar and press <span class="strong strong"><strong>Return</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Rule name — Enter a word or phrase from a rule&#8217;s name.
</li>
<li class="listitem">
Index pattern — Enter an index pattern (such as <code class="literal">filebeat-*</code>) to display all rules that use it.
</li>
<li class="listitem">
MITRE ATT&amp;CK tactic or technique — Enter a MITRE ATT&amp;CK tactic name (such as <code class="literal">Defense Evasion</code>) or technique number (such as <code class="literal">TA0005</code>) to display all associated rules.
</li>
</ul>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Searches for index patterns and MITRE ATT&amp;CK tactics and techniques must match exactly, are case sensitive, and do <em>not</em> support wildcards. For example, to find rules using the <code class="literal">filebeat-*</code> index pattern, the search term <code class="literal">filebeat-*</code> is valid, but <code class="literal">filebeat</code> and <code class="literal">file*</code> are not because they don&#8217;t exactly match the index pattern. Likewise, the MITRE ATT&amp;CK tactic <code class="literal">Defense Evasion</code> is valid, but <code class="literal">Defense</code>, <code class="literal">defense evasion</code>, and <code class="literal">Defense*</code> are not.</p>
</div>
</div>
<p>You can also filter the rules list by selecting the <span class="strong strong"><strong>Tags</strong></span>, <span class="strong strong"><strong>Elastic rules</strong></span>, <span class="strong strong"><strong>Custom rules</strong></span>, <span class="strong strong"><strong>Enabled rules</strong></span>, and <span class="strong strong"><strong>Disabled rules</strong></span> filters next to the search bar.</p>
<p>The rules list retains your sorting and filtering settings when you navigate away and return to the page. These settings are also preserved when you copy the page&#8217;s URL and paste into another browser. Select <span class="strong strong"><strong>Clear filters</strong></span> above the table to revert to the default view.</p>
<div class="position-relative"><h3><a id="rule-status"></a>Check the current status of rules</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.8/docs/detections/rules-ui-manage.asciidoc">edit</a></div>
<p>The <span class="strong strong"><strong>Last response</strong></span> column displays the current status of each rule, based on the most recent attempt to run the rule:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Succeeded</strong></span>: The rule completed its defined search. This doesn&#8217;t necessarily mean it generated an alert, just that it ran without error.
</li>
<li class="listitem">
<span class="strong strong"><strong>Failed</strong></span>: The rule encountered an error that prevented it from running. For example, a machine learning rule whose corresponding machine learning job wasn&#8217;t running.
</li>
<li class="listitem">
<span class="strong strong"><strong>Warning</strong></span>: Nothing prevented the rule from running, but it might have returned unexpected results. For example, a custom query rule tried to search an index pattern that couldn&#8217;t be found in Elasticsearch.
</li>
</ul>
</div>
<p>For machine learning rules, an indicator icon (<span class="image"><img src="images/rules-table-error-icon.png" alt="Error icon from Rules table" width="15" height="15"></span>) also appears in this column if a required machine learning job isn&#8217;t running. Click the icon to list the affected jobs, then click <span class="strong strong"><strong>Visit rule details page to investigate</strong></span> to open the rule&#8217;s details page, where you can start the machine learning job.</p>
<div class="position-relative"><h3><a id="load-prebuilt-rules"></a>Load and activate Elastic prebuilt rules</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.8/docs/detections/rules-ui-manage.asciidoc">edit</a></div>
<p>To load the Elastic Security app&#8217;s <a class="xref" href="prebuilt-rules.html" title="Prebuilt rule reference">prebuilt rules</a>, go to <span class="strong strong"><strong>Manage</strong></span> &#8594; <span class="strong strong"><strong>Rules</strong></span> &#8594; <span class="strong strong"><strong>Load Elastic prebuilt rules and Timeline templates</strong></span>.</p>
<p>You can then activate whichever rules you want. If you delete any prebuilt rules, a button appears that enables you to reload all of the deleted ones.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Apart from the Elastic Endpoint rule, prebuilt rules are not activated by
default. If you want to modify a prebuilt rule, you must first duplicate it, then make your changes to the duplicated rule. All Elastic prebuilt rules are tagged with the word <code class="literal">Elastic</code>.</p>
<p>To learn how to enable detection rules in Elastic Security, watch the <a class="xref" href="rules-ui-management.html#enable-detection-rules" title="Tutorial: Enable detection rules">tutorial</a> at the end of this topic.</p>
</li>
<li class="listitem">
Automatic updates of Elastic prebuilt rules are supported for the current Elastic Security version and the latest three previous minor releases. For example, if you’re on Elastic Security 8.10, you’ll be able to use the Rules UI to update your prebuilt rules until Elastic Security 8.14 is released. After that point, you can still manually download and install updated prebuilt rules, but you must upgrade to the latest Elastic Security version to receive automatic updates.
</li>
</ul>
</div>
</div>
</div>
<div class="position-relative"><h3><a id="prebuilt-rule-tags"></a>Prebuilt rule tags</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.8/docs/detections/rules-ui-manage.asciidoc">edit</a></div>
<p>Each prebuilt rule includes several tags identifying the rule&#8217;s purpose, detection method, associated resources, and other information to help categorize your rules. These tags are category-value pairs; for example, <code class="literal">OS: Windows</code> indicates rules designed for Windows endpoints. Categories include:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">Data Source</code>: The application, cloud provider, data shipper, or Elastic integration providing data for the rule.
</li>
<li class="listitem">
<code class="literal">Domain</code>: A general category of data source types (such as cloud, endpoint, or network).
</li>
<li class="listitem">
<code class="literal">OS</code>: The host operating system, which could be considered another data source type.
</li>
<li class="listitem">
<code class="literal">Resources</code>: Additional rule resources such as investigation guides.
</li>
<li class="listitem">
<code class="literal">Rule Type</code>: Identifies if the rule depends on specialized resources (such as machine learning jobs or threat intelligence indicators), or if it&#8217;s a higher-order rule built from other rules' alerts.
</li>
<li class="listitem">
<code class="literal">Tactic</code>: MITRE ATT&amp;CK tactics that the rule addresses.
</li>
<li class="listitem">
<code class="literal">Threat</code>: Specific threats the rule detects (such as Cobalt Strike or BPFDoor).
</li>
<li class="listitem">
<p><code class="literal">Use Case</code>: The type of activity the rule detects and its purpose. Use cases include:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">Active Directory Monitoring</code>: Detects changes related to Active Directory.
</li>
<li class="listitem">
<code class="literal">Asset Visibility</code>: Detects changes to specified asset types.
</li>
<li class="listitem">
<code class="literal">Configuration Audit</code>: Detects undesirable configuration changes.
</li>
<li class="listitem">
<code class="literal">Guided Onboarding</code>: Example rule, used for Elastic Security&#8217;s guided onboarding tour.
</li>
<li class="listitem">
<code class="literal">Identity and Access Audit</code>: Detects activity related to identity and access management (IAM).
</li>
<li class="listitem">
<code class="literal">Log Auditing</code>: Detects activity on log configurations or storage.
</li>
<li class="listitem">
<code class="literal">Network Security Monitoring</code>: Detects network security configuration activity.
</li>
<li class="listitem">
<code class="literal">Threat Detection</code>: Detects threats.
</li>
<li class="listitem">
<code class="literal">Vulnerability</code>: Detects exploitation of specific vulnerabilities.
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="position-relative"><h3><a id="select-all-prebuilt-rules"></a>Select and duplicate all prebuilt rules</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.8/docs/detections/rules-ui-manage.asciidoc">edit</a></div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Go to <span class="strong strong"><strong>Manage</strong></span> &#8594; <span class="strong strong"><strong>Rules</strong></span>.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Select all <em>x</em> rules</strong></span> above the rules table.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Bulk actions</strong></span> &#8594; <span class="strong strong"><strong>Duplicate</strong></span>.
</li>
<li class="listitem">
Select the <span class="strong strong"><strong>Custom rules</strong></span> tab.
</li>
</ol>
</div>
<p>You can then modify the duplicated rules and, if required, delete the prebuilt ones.</p>
<div class="position-relative"><h3><a id="download-prebuilt-rules"></a>Download latest Elastic prebuilt rules</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.8/docs/detections/rules-ui-manage.asciidoc">edit</a></div>
<p>As of Elastic Stack &gt;=7.13.0, you can download the latest version of Elastic prebuilt rules outside of a regular release cycle. This feature ensures you have the latest detection capabilities before upgrading to the latest Elastic Stack.</p>
<p>To download the latest version of prebuilt rules:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
In Kibana, go to <span class="strong strong"><strong>Management</strong></span> &#8594; <span class="strong strong"><strong>Integrations</strong></span>.
</li>
<li class="listitem">
Search for "Prebuilt Security Detection Rules."
</li>
<li class="listitem">
<p>Select the integration, then select the <span class="strong strong"><strong>Settings</strong></span> tab. The integration settings page is displayed.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/install-prebuilt-settings.png" alt="install prebuilt settings">
</div>
</div>
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Install Prebuilt Security Detection Rules assets</strong></span>.
</li>
<li class="listitem">
<p>Click <span class="strong strong"><strong>Install Prebuilt Security Detection Rules</strong></span> to confirm the installation.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/install-prebuilt-rules.png" alt="install prebuilt rules">
</div>
</div>
</li>
</ol>
</div>
<div class="position-relative"><h3><a id="rule-prerequisites"></a>Confirm rule prerequisites</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.8/docs/detections/rules-ui-manage.asciidoc">edit</a></div>
<p>Many Elastic prebuilt rules are designed to work with specific Elastic integrations and data fields. These prerequisites are identified in the <span class="strong strong"><strong>Related integrations</strong></span> and <span class="strong strong"><strong>Required fields</strong></span> fields on a rule&#8217;s details page (<span class="strong strong"><strong>Manage</strong></span> &#8594; <span class="strong strong"><strong>Rules</strong></span>, then click a rule&#8217;s name). <span class="strong strong"><strong>Related integrations</strong></span> also displays each integration&#8217;s installation status and includes links for installing and configuring the listed integrations.</p>
<p>Additionally, the <span class="strong strong"><strong>Setup guide</strong></span> section provides guidance on setting up the rule&#8217;s requirements.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/rule-details-prerequisites.png" alt="Rule details page with Related integrations" width="Required fields" height="and Setup guide highlighted">
</div>
</div>
<p>You can also check rules' related integrations in the <span class="strong strong"><strong>Rules</strong></span> and <span class="strong strong"><strong>Rule Monitoring</strong></span> tables. Click the <span class="strong strong"><strong>integrations</strong></span> badge to display the related integrations in a popup.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/rules-table-related-integrations.png" alt="Rules table with related integrations popup" width="75%">
</div>
</div>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>You can hide the <span class="strong strong"><strong>integrations</strong></span> badge in the Rules tables. Go to <span class="strong strong"><strong>Kibana</strong></span> &#8594; <span class="strong strong"><strong>Stack Management</strong></span> &#8594; <span class="strong strong"><strong>Advanced Settings</strong></span>, then turn off <code class="literal">securitySolution:showRelatedIntegrations</code>.</p>
</div>
</div>
<div class="position-relative"><h3><a id="edit-rules-settings"></a>Modify existing rules settings</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.8/docs/detections/rules-ui-manage.asciidoc">edit</a></div>
<p>You can edit an existing rule&#8217;s settings, and can bulk edit settings for multiple rules at once.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>For prebuilt Elastic rules, you can&#8217;t modify most settings. You can only edit <a class="xref" href="rules-ui-create.html#rule-schedule" title="Set the rule&#8217;s schedule">rule actions</a> and <a class="xref" href="add-exceptions.html" title="Add and manage exceptions">add exceptions</a>. If you try to bulk edit with both prebuilt and custom rules selected, the action will affect only the rules that can be modified.</p>
<p>Similarly, rules will be skipped if they can&#8217;t be modified by a bulk edit. For example, if you try to apply a tag to rules that already have that tag, or apply an index pattern to rules that use data views.</p>
</div>
</div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Go to <span class="strong strong"><strong>Manage</strong></span> &#8594; <span class="strong strong"><strong>Rules</strong></span>.
</li>
<li class="listitem">
<p>Do one of the following:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Edit a single rule: Select the <span class="strong strong"><strong>All actions</strong></span> menu (<span class="strong strong"><strong>&#8230;&#8203;</strong></span>) on a rule, then select <span class="strong strong"><strong>Edit rule settings</strong></span>. The <span class="strong strong"><strong>Edit rule settings</strong></span> view opens, where you can modify the <a class="xref" href="rules-ui-create.html" title="Create a detection rule">rule&#8217;s settings</a>.
</li>
<li class="listitem">
<p>Bulk edit multiple rules: Select the rules you want to edit, then select an action from the <span class="strong strong"><strong>Bulk actions</strong></span> menu:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Index patterns</strong></span>: Add or delete the index patterns used by all selected rules.
</li>
<li class="listitem">
<span class="strong strong"><strong>Tags</strong></span>: Add or delete tags on all selected rules.
</li>
<li class="listitem">
<span class="strong strong"><strong>Add rule actions</strong></span>: Add <a class="xref" href="rules-ui-create.html#rule-notifications" title="Set up alert notifications (optional)">rule actions</a> on all selected rules. If you add multiple actions, you can specify an action frequency for each of them. To overwrite the frequency of existing actions select the option to <span class="strong strong"><strong>Overwrite all selected rules actions</strong></span>.
</li>
</ul>
</div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>After upgrading to 8.8 or later, frequency settings for rule actions created in 8.7 or earlier are moved from the rule level to the action level. The action schedules remain the same and will continue to run on their previously specified frequency (<code class="literal">On each rule execution</code>, <code class="literal">Hourly</code>, <code class="literal">Daily</code>, or <code class="literal">Weekly</code>).</p>
</div>
</div>
</li>
</ul>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Rule actions won&#8217;t run during a <a href="/guide/en/kibana/8.8/maintenance-windows.html" class="ulink" target="_top">maintenance window</a>. They&#8217;ll resume running after the maintenance window ends.</p>
</div>
</div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Update rule schedules</strong></span>: Update the <a class="xref" href="rules-ui-create.html#rule-schedule" title="Set the rule&#8217;s schedule">schedules</a> and look-back times on all selected rules.
</li>
<li class="listitem">
<span class="strong strong"><strong>Apply Timeline template</strong></span>: Apply a specified <a class="xref" href="timeline-templates-ui.html" title="About Timeline templates">Timeline template</a> to the selected rules. You can also choose <span class="strong strong"><strong>None</strong></span> to remove Timeline templates from the selected rules.
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>On the flyout that opens, update the rule settings and actions.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>To <a class="xref" href="rules-ui-management.html#snooze-rule-actions" title="Snooze rule actions">snooze</a> rule actions, go to the <span class="strong strong"><strong>Actions</strong></span> tab and click the bell icon.</p>
</div>
</div>
</li>
<li class="listitem">
If available, select <span class="strong strong"><strong>Overwrite all selected <em>x</em></strong></span> to overwrite the settings on the rules. For example, if you&#8217;re adding tags to multiple rules, selecting <span class="strong strong"><strong>Overwrite all selected rules tags</strong></span> removes all the rules' original tags and replaces them with the tags you specify.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Save</strong></span>.
</li>
</ol>
</div>
<div class="position-relative"><h3><a id="manage-rules-ui"></a>Manage rules</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.8/docs/detections/rules-ui-manage.asciidoc">edit</a></div>
<p>You can duplicate, enable, disable, delete, and snooze actions for rules:</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>When duplicating a rule with exceptions, you can choose to duplicate the rule and its exceptions (active and expired), the rule and active exceptions only, or only the rule. If you duplicate the rule and its exceptions, copies of the exceptions are created and added to the duplicated rule&#8217;s <a class="xref" href="detections-ui-exceptions.html" title="Rule exceptions">default rule list</a>. If the original rule used exceptions from a shared exception list, the duplicated rule will reference the same shared exception list.</p>
</div>
</div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Go to <span class="strong strong"><strong>Manage</strong></span> &#8594; <span class="strong strong"><strong>Rules</strong></span>.
</li>
<li class="listitem">
<p>Do one of the following:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Select the <span class="strong strong"><strong>All actions</strong></span> menu (<span class="strong strong"><strong>&#8230;&#8203;</strong></span>) on a rule, then select an action.
</li>
<li class="listitem">
Select all the rules you want to modify, then select an action from the <span class="strong strong"><strong>Bulk actions</strong></span> menu.
</li>
<li class="listitem">
To enable or disable a single rule, switch on the rule&#8217;s <span class="strong strong"><strong>Enabled</strong></span> toggle.
</li>
<li class="listitem">
To <a class="xref" href="rules-ui-management.html#snooze-rule-actions" title="Snooze rule actions">snooze</a> actions for rules, click the bell icon.
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="position-relative"><h3><a id="snooze-rule-actions"></a>Snooze rule actions</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.8/docs/detections/rules-ui-manage.asciidoc">edit</a></div>
<p>Instead of turning rules off to stop alert notifications, you can snooze rule actions for a specified time period. When you snooze rule actions, the rule continues to run on its defined schedule, but won&#8217;t perform any actions or send alert notifications.</p>
<p>You can snooze notifications temporarily or indefinitely. When actions are snoozed, you can cancel or change the duration of the snoozed state. You can also schedule and manage recurring downtime for actions.</p>
<p>You can snooze rule notifications from the Rules table, the rule details page, or the <span class="strong strong"><strong>Actions</strong></span> tab when editing a rule.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/rule-snoozing.png" alt="Rules snooze options" width="65%">
</div>
</div>
<div class="position-relative"><h3><a id="import-export-rules-ui"></a>Export and import rules</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.8/docs/detections/rules-ui-manage.asciidoc">edit</a></div>
<p>You can export custom detection rules to an <code class="literal">.ndjson</code> file, which you can then import into another Elastic Security environment.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>You cannot export Elastic prebuilt rules, but you can duplicate a prebuilt rule, then export the duplicated rule.</p>
<p>If you try to export with both prebuilt and custom rules selected, only the custom rules are exported.</p>
</div>
</div>
<p>The <code class="literal">.ndjson</code> file also includes any actions, connectors, and exception lists related to the exported rules. However, other configuration items require additional handling when exporting and importing rules:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p><span class="strong strong"><strong>Data views</strong></span>: For rules that use a Kibana data view as a data source, the exported file contains the associated <code class="literal">data_view_id</code>, but does <em>not</em> include any other data view configuration. To export/import between Kibana spaces, first use the <a href="/guide/en/kibana/8.8/managing-saved-objects.html#managing-saved-objects-share-to-space" class="ulink" target="_top">Saved Objects</a> UI (<span class="strong strong"><strong>Stack Management</strong></span> &#8594; <span class="strong strong"><strong>Kibana</strong></span> &#8594; <span class="strong strong"><strong>Saved Objects</strong></span>) to share the data view with the destination space.</p>
<p>To import into a different Elastic Stack deployment, the destination cluster must include a data view with a matching data view ID (configured in the <a href="/guide/en/kibana/8.8/data-views.html" class="ulink" target="_top">data view&#8217;s advanced settings</a>). Alternatively, after importing, you can manually reconfigure the rule to use an appropriate data view in the destination system.</p>
</li>
<li class="listitem">
<p><span class="strong strong"><strong>Actions and connectors</strong></span>: Rule actions and connectors are included in the exported file, but sensitive information about the connector (such as authentication credentials) <em>is not</em> included. You must re-add missing connector details after importing detection rules.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>You can also use Kibana&#8217;s <a href="/guide/en/kibana/8.8/managing-saved-objects.html#managing-saved-objects-export-objects" class="ulink" target="_top">Saved Objects</a> UI (<span class="strong strong"><strong>Stack Management</strong></span> &#8594; <span class="strong strong"><strong>Kibana</strong></span> &#8594; <span class="strong strong"><strong>Saved Objects</strong></span>) to export and import necessary connectors before importing detection rules.</p>
</div>
</div>
</li>
<li class="listitem">
<span class="strong strong"><strong>Value lists</strong></span>: Any value lists used for rule exceptions are <em>not</em> included in rule exports or imports. Use the <a class="xref" href="value-lists-exceptions.html#edit-value-lists" title="Manage value lists">Import value lists</a> UI (<span class="strong strong"><strong>Manage</strong></span> &#8594; <span class="strong strong"><strong>Rules</strong></span> &#8594; <span class="strong strong"><strong>Import value lists</strong></span>) to export and import value lists separately.
</li>
</ul>
</div>
<p>To export and import detection rules:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Go to <span class="strong strong"><strong>Manage</strong></span> &#8594; <span class="strong strong"><strong>Rules</strong></span>.
</li>
<li class="listitem">
<p>To export rules:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
In the rules table, select the rules you want to export.
</li>
<li class="listitem">
Select <span class="strong strong"><strong>Bulk actions</strong></span> &#8594; <span class="strong strong"><strong>Export</strong></span>, then save the exported file.
</li>
</ol>
</div>
</li>
<li class="listitem">
<p>To import rules:</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>To import rules with actions, you need at least <code class="literal">Read</code> privileges for the <code class="literal">Action and Connectors</code> feature. To overwrite or add new connectors, you need <code class="literal">All</code> privileges for the <code class="literal">Actions and Connectors</code> feature. To import rules without actions,  you don&#8217;t need <code class="literal">Actions and Connectors</code> privileges. Refer to <a class="xref" href="detections-permissions-section.html#enable-detections-ui" title="Enable and access detections">Enable and access detections</a> for more information.</p>
</div>
</div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Click <span class="strong strong"><strong>Import rules</strong></span>.
</li>
<li class="listitem">
<p>Drag and drop the file that contains the detection rules.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Imported rules must be in an <code class="literal">.ndjson</code> file.</p>
</div>
</div>
</li>
<li class="listitem">
(Optional) Select <span class="strong strong"><strong>Overwrite existing detection rules with conflicting "rule_id"</strong></span> to update existing rules if they match the <code class="literal">rule_id</code> value of any rules in the import file. Configuration data included with the rules, such as actions, is also overwritten.
</li>
<li class="listitem">
(Optional) Select <span class="strong strong"><strong>Overwrite existing exception lists with conflicting "list_id"</strong></span> to replace existing exception lists with exception lists from the import file if they have a matching <code class="literal">list_id</code> value.
</li>
<li class="listitem">
(Optional) Select <span class="strong strong"><strong>Overwrite existing connectors with conflicting action "id"</strong></span> to update existing connectors if they match the <code class="literal">action id</code> value of any rule actions in the import file. Configuration data included with the actions is also overwritten.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Import rule</strong></span>.
</li>
<li class="listitem">
(Optional) If a connector is missing sensitive information after the import, a warning displays and you&#8217;re prompted to fix the connector. In the warning, click <span class="strong strong"><strong>Go to connector</strong></span>. On the Connectors page, find the connector that needs to be updated, click <span class="strong strong"><strong>Fix</strong></span>, then add the necessary details.
</li>
</ol>
</div>
</li>
</ol>
</div>
<div class="position-relative"><h3><a id="enable-detection-rules"></a>Tutorial: Enable detection rules</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.8/docs/detections/rules-ui-manage.asciidoc">edit</a></div>
<p>To learn how to enable detection rules in Elastic Security, watch the following tutorial.</p>
<script type="text/javascript" async src="https://play.vidyard.com/embed/v4.js"></script>
<img
  style="width: 100%; margin: auto; display: block;"
  class="vidyard-player-embed"
  src="https://play.vidyard.com/9Kcg8qJcHdcF9bXUc1XEQZ.jpg"
  data-uuid="9Kcg8qJcHdcF9bXUc1XEQZ"
  data-v="4"
  data-type="inline"
/>
</br>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="rules-cross-cluster-search.html">« Cross-cluster search and detection rules</a>
</span>
<span class="next">
<a href="alerts-ui-monitor.html">Monitor and troubleshoot rule executions »</a>
</span>
</div>
</body>
</html>
