<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Bulk anonymization field actions | Elastic Security Solution [8.x] | Elastic</title>
<meta class="elastic" name="content" content="Bulk anonymization field actions | Elastic Security Solution [8.x]">

<link rel="home" href="index.html" title="Elastic Security Solution [8.x]"/>
<link rel="up" href="assistant-api-overview.html" title="Elastic AI Assistant API"/>
<link rel="prev" href="anonymization-fields-api-find.html" title="Find anonymization fields"/>
<link rel="next" href="security-ref-intro.html" title="Elastic Security fields and object schemas"/>
<meta class="elastic" name="product_version" content="8.x"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.x"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.x"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
This documentation contains work-in-progress information for future Elastic Stack and Cloud releases. Use the version selector to view supported release docs. It also contains some Elastic Cloud serverless information. Check out our <a href="https://www.elastic.co/docs/current/serverless">serverless docs</a> for more details.
</div>
<div class="navheader">
<span class="prev">
<a href="anonymization-fields-api-find.html">« Find anonymization fields</a>
</span>
<span class="next">
<a href="security-ref-intro.html">Elastic Security fields and object schemas »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [8.x]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="security-apis.html">Elastic Security APIs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="assistant-api-overview.html">Elastic AI Assistant API</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Bulk anonymization field actions</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.x/docs/AI-for-security/api/bulk-actions-anonymization-fields-api.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="bulk-actions-anonymization-fields-api"></a>Bulk anonymization field actions</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.x/docs/AI-for-security/api/bulk-actions-anonymization-fields-api.asciidoc">edit</a></div>
</div></div></div>
<div class="sidebar">
<div class="titlepage"><div><div>
<p class="title"><strong>New API Reference</strong></p>
</div></div></div>
<p>For the most up-to-date API details, refer to <a href="/docs/api/doc/kibana/v8/group/endpoint-security-ai-assistant-api" class="ulink" target="_top">AI Assistant APIs</a>.</p>
</div>
<p>Apply a bulk action (create, update, or delete) to multiple anonymization fields. The bulk action is applied to all anonymization fields that match the filter or to the list of anonymization fields by their IDs.</p>
<div class="position-relative"><h5><a id="_request_url_72"></a>Request URL</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.x/docs/AI-for-security/api/bulk-actions-anonymization-fields-api.asciidoc">edit</a></div>
<p><code class="literal">POST &lt;kibana host&gt;:&lt;port&gt;/api/security_ai_assistant/anonymization_fields/_bulk_action</code></p>
<div class="position-relative"><h5><a id="_request_body_35"></a>Request body</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.x/docs/AI-for-security/api/bulk-actions-anonymization-fields-api.asciidoc">edit</a></div>
<p>A JSON object with the following properties:</p>
<div class="informaltable">
<table border="1" cellpadding="4px" width="100%">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Required</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">create</code></p></td>
<td align="left" valign="top"><p><a class="xref" href="bulk-actions-anonymization-fields-api.html#bulk-create-anonymization-fields-schema" title="BulkCreateAction object">BulkCreateAction[]</a></p></td>
<td align="left" valign="top"><p>Array of anonymization field objects to create.</p></td>
<td align="left" valign="top"><p>No</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">delete</code></p></td>
<td align="left" valign="top"><p>String[]</p></td>
<td align="left" valign="top"><p>Array of IDs of the anonymization fields to delete.</p></td>
<td align="left" valign="top"><p>No</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">update</code></p></td>
<td align="left" valign="top"><p><a class="xref" href="bulk-actions-anonymization-fields-api.html#bulk-update-anonymization-fields-schema" title="BulkUpdateAction object">BulkUpdateAction[]</a></p></td>
<td align="left" valign="top"><p>Array of anonymization field objects with the fields to update.</p></td>
<td align="left" valign="top"><p>No</p></td>
</tr>
</tbody>
</table>
</div>
<div class="position-relative"><h4><a id="bulk-create-anonymization-fields-schema"></a>BulkCreateAction object</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.x/docs/AI-for-security/api/bulk-actions-anonymization-fields-api.asciidoc">edit</a></div>
<div class="informaltable">
<table border="1" cellpadding="4px" width="100%">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Required</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">field</code></p></td>
<td align="left" valign="top"><p>String</p></td>
<td align="left" valign="top"><p>A field&#8217;s name.</p></td>
<td align="left" valign="top"><p>Yes</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">allowed</code></p></td>
<td align="left" valign="top"><p>Boolean</p></td>
<td align="left" valign="top"><p>Defines whether the field will get sent to the LLM.</p></td>
<td align="left" valign="top"><p>Yes</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">anonymized</code></p></td>
<td align="left" valign="top"><p>Boolean</p></td>
<td align="left" valign="top"><p>Defines whether the field will be anonymized if sent to the LLM. Defaults to <code class="literal">false</code>.</p></td>
<td align="left" valign="top"><p>Yes</p></td>
</tr>
</tbody>
</table>
</div>
<div class="position-relative"><h4><a id="bulk-update-anonymization-fields-schema"></a>BulkUpdateAction object</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.x/docs/AI-for-security/api/bulk-actions-anonymization-fields-api.asciidoc">edit</a></div>
<div class="informaltable">
<table border="1" cellpadding="4px" width="100%">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Type</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Required</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">allowed</code></p></td>
<td align="left" valign="top"><p>Boolean</p></td>
<td align="left" valign="top"><p>Defines whether the field will get sent to the LLM.</p></td>
<td align="left" valign="top"><p>No</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">anonymized</code></p></td>
<td align="left" valign="top"><p>Boolean</p></td>
<td align="left" valign="top"><p>Defines whether the field will be anonymized if sent to the LLM. Defaults to <code class="literal">false</code>.</p></td>
<td align="left" valign="top"><p>No</p></td>
</tr>
</tbody>
</table>
</div>
<div class="position-relative"><h5><a id="_example_requests_33"></a>Example requests</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.x/docs/AI-for-security/api/bulk-actions-anonymization-fields-api.asciidoc">edit</a></div>
<p><span class="strong strong"><strong>Example 1</strong></span></p>
<p>The following request creates two anonymization fields:</p>
<div class="pre_wrapper lang-console">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console">POST api/security_ai_assistant/anonymization_fields/_bulk_action
{
  "create": [
    {
      "field": "agent.type",
      "allowed": true,
      "anonymized": false
    },
    {
      "field": "agent.name",
      "allowed": true,
      "anonymized": true
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/121.console"></div>
<div class="position-relative"><h5><a id="_response_code_75"></a>Response code</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.x/docs/AI-for-security/api/bulk-actions-anonymization-fields-api.asciidoc">edit</a></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">200</code>
</span>
</dt>
<dd>
Indicates a successful call.
</dd>
</dl>
</div>
<div class="position-relative"><h5><a id="_response_payload_55"></a>Response payload</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.x/docs/AI-for-security/api/bulk-actions-anonymization-fields-api.asciidoc">edit</a></div>
<p>JSON object containing the action&#8217;s outcome:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">attributes.summary.total</code>: Total number of anonymization fields matching the bulk action
</li>
<li class="listitem">
<code class="literal">attributes.summary.succeeded</code>: Number of successful outcomes (number of anonymization fields that were created, deleted, or updated)
</li>
<li class="listitem">
<code class="literal">attributes.summary.failed</code>: Number of failed outcomes
</li>
<li class="listitem">
<code class="literal">attributes.summary.skipped</code>: Number of anonymization fields that were skipped due to various reasons (explained below)
</li>
<li class="listitem">
<code class="literal">attributes.results.created</code>: Anonymization field objects that were created during the action&#8217;s execution
</li>
<li class="listitem">
<code class="literal">attributes.results.updated</code>: Anonymization field objects that were updated during the action&#8217;s execution
</li>
<li class="listitem">
<code class="literal">attributes.results.deleted</code>: Anonymization field objects that were deleted during the action&#8217;s execution
</li>
<li class="listitem">
<code class="literal">attributes.results.skipped</code>: Anonymization fields that were skipped during the action&#8217;s execution
</li>
</ul>
</div>
<p>An anonymization field can only be <code class="literal">skipped</code> when the bulk action to be performed on it results in nothing being done. For example, if the <code class="literal">update</code> action is used to update a field that already has the specified value. Objects returned in <code class="literal">attributes.results.skipped</code> will only include an anonymization field&#8217;s <code class="literal">id</code>, <code class="literal">name</code>, and <code class="literal">skip_reason</code>.</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
  "success": true,
  "anonymization_fields_count": 2,
  "attributes": {
    "results": {
      "updated": [],
      "created": [
        {
          "timestamp": "2024-08-13T20:54:23.125Z",
          "createdAt": "2024-08-13T20:54:23.125Z",
          "field": "agent.type",
          "allowed": true,
          "anonymized": false,
          "updatedAt": "2024-08-13T20:54:23.125Z",
          "id": "cB2FTZEBYaDeA-NhPHqW"
        },
        {
          "timestamp": "2024-08-13T20:54:23.125Z",
          "createdAt": "2024-08-13T20:54:23.125Z",
          "field": "agent.name",
          "allowed": true,
          "anonymized": true,
          "updatedAt": "2024-08-13T20:54:23.125Z",
          "id": "cR2FTZEBYaDeA-NhPHqW"
        }
      ],
      "deleted": [],
      "skipped": []
    },
    "summary": {
      "failed": 0,
      "succeeded": 2,
      "skipped": 0,
      "total": 2
    }
  }
}</pre>
</div>
<p><span class="strong strong"><strong>Example 2: Partial failure</strong></span></p>
<p>The following request:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
deletes the anonymization field with the ID value of <code class="literal">cR2FTZEBYaDeA-NhPHqW</code>
</li>
<li class="listitem">
updates the <code class="literal">allowed</code> value for the anonymization field with the ID of <code class="literal">lh12SZEBYaDeA-NhmkwG</code>
</li>
<li class="listitem">
updates the <code class="literal">anonymized</code> value for the anonymization field with the ID of <code class="literal">lR12SZEBYaDeA-NhmkwG</code>
</li>
</ul>
</div>
<div class="pre_wrapper lang-console">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console">POST api/security_ai_assistant/anonymization_fields/_bulk_action
{
  "delete": {
    "ids": [
      "cR2FTZEBYaDeA-NhPHqW"
    ]
  },
  "update": [
    {
      "id": "lh12SZEBYaDeA-NhmkwG",
      "allowed": false
    },
    {
      "id": "lR12SZEBYaDeA-NhmkwG",
      "anonymized": true
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/122.console"></div>
<div class="position-relative"><h5><a id="_response_code_76"></a>Response code</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.x/docs/AI-for-security/api/bulk-actions-anonymization-fields-api.asciidoc">edit</a></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">500</code>
</span>
</dt>
<dd>
Indicates partial bulk action failure.
</dd>
</dl>
</div>
<div class="position-relative"><h5><a id="_response_payload_56"></a>Response payload</h5><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.x/docs/AI-for-security/api/bulk-actions-anonymization-fields-api.asciidoc">edit</a></div>
<p>If the processing of any anonymization fields fails, the response outputs a partial error, with the ID and/or name of the affected anonymization field and the corresponding error message. The response also includes successfully processed anonymization fields, in the same format as a successful <code class="literal">200</code> request.</p>
<div class="pre_wrapper lang-json">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-json">{
  "message": "Bulk delete partially failed",
  "status_code": 500,
  "attributes": {
    "errors": [
      {
        "message": "Some error happened here",
        "status_code": 500,
        "anonymization_fields": [
          {
            "id": "cR2FTZEBYaDeA-NhPHqW",
            "field": "test"
          }
        ]
      }
    ],
    "results": {
      "updated": [
        {
          "timestamp": "2024-08-13T01:59:55.141Z",
          "createdAt": "2024-08-13T01:59:55.141Z",
          "field": "@timestamp",
          "allowed": false,
          "anonymized": false,
          "updatedAt": "2024-08-13T21:00:37.502Z",
          "namespace": "default"
        },
        {
          "timestamp": "2024-08-13T01:59:55.141Z",
          "createdAt": "2024-08-13T01:59:55.141Z",
          "field": "_id",
          "allowed": true,
          "anonymized": true,
          "updatedAt": "2024-08-13T21:00:37.502Z",
          "namespace": "default"
        }
      ],
      "created": [],
      "deleted": [],
      "skipped": []
    },
    "summary": {
      "failed": 1,
      "succeeded": 1,
      "skipped": 0,
      "total": 2
    }
  }
}</pre>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>For the Fleet APIs, see the
<a href="/guide/en/fleet/8.x/fleet-api-docs.html" class="ulink" target="_top">Fleet API Documentation</a>.</p>
</div>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="anonymization-fields-api-find.html">« Find anonymization fields</a>
</span>
<span class="next">
<a href="security-ref-intro.html">Elastic Security fields and object schemas »</a>
</span>
</div>
</body>
</html>
