<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>8.16 | Elastic Security Solution [8.x] | Elastic</title>
<meta class="elastic" name="content" content="8.16 | Elastic Security Solution [8.x]">

<link rel="home" href="index.html" title="Elastic Security Solution [8.x]"/>
<link rel="up" href="release-notes.html" title="Release notes"/>
<link rel="prev" href="release-notes-header-8.17.0.html" title="8.17"/>
<link rel="next" href="release-notes-header-8.15.0.html" title="8.15"/>
<meta class="elastic" name="product_version" content="8.x"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.x"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.x"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
This documentation contains work-in-progress information for future Elastic Stack and Cloud releases. Use the version selector to view supported release docs. It also contains some Elastic Cloud serverless information. Check out our <a href="https://www.elastic.co/docs/current/serverless">serverless docs</a> for more details.
</div>
<div class="navheader">
<span class="prev">
<a href="release-notes-header-8.17.0.html">« 8.17</a>
</span>
<span class="next">
<a href="release-notes-header-8.15.0.html">8.15 »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [8.x]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="release-notes.html">Release notes</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>8.16</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.x/docs/release-notes/8.16.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="chapter">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="release-notes-header-8.16.0"></a>8.16</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.x/docs/release-notes/8.16.asciidoc">edit</a></div>
</div></div></div>
<div class="position-relative"><h3><a id="release-notes-8.16.3"></a>8.16.3</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.x/docs/release-notes/8.16.asciidoc">edit</a></div>
<div class="position-relative"><h4><a id="known-issue-8.16.3"></a>Known issues</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.x/docs/release-notes/8.16.asciidoc">edit</a></div>
<details>
<summary class="title">Duplicate alerts can be produced from manually running threshold rules</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
On November 12, 2024, it was discovered that manually running threshold rules could produce duplicate alerts if the date range was already covered by a scheduled rule execution.</p>
</div>
</details>
<details>
<summary class="title">Manually running custom query rules with suppression could suppress more alerts than expected</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
On November 12, 2024, it was discovered that manually running a custom query rule with suppression could incorrectly inflate the number of suppressed alerts.</p>
</div>
</details>
<div class="position-relative"><h4><a id="bug-fixes-8.16.3"></a>Bug fixes</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.x/docs/release-notes/8.16.asciidoc">edit</a></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Fixes Integration and Datastream name validation (<a href="https://github.com/elastic/kibana/pull/204943" class="ulink" target="_top">#204943</a>).
</li>
<li class="listitem">
Improves how the rule query field handles whitespace for long pre-formatted texts. This fix only applies to Firefox, not Chrome or Safari (<a href="https://github.com/elastic/kibana/pull/203993" class="ulink" target="_top">#203993</a>).
</li>
<li class="listitem">
Adds role-based access control to the Automatic Import APIs (<a href="https://github.com/elastic/kibana/pull/203882" class="ulink" target="_top">#203882</a>).
</li>
<li class="listitem">
Changes the validation for API responses from SentinelOne and Crowdstrike. This fix allows for non-JSON responses, such as stream, to be returned (<a href="https://github.com/elastic/kibana/pull/203820" class="ulink" target="_top">#203820</a>).
</li>
<li class="listitem">
Fixes a bug that caused a warning to display when you modified the index patterns of a rule that had a filter using <code class="literal">AND</code> or <code class="literal">OR</code> conditions (<a href="https://github.com/elastic/kibana/pull/201776" class="ulink" target="_top">#201776</a>).
</li>
<li class="listitem">
Fixes a bug that caused the diff view to incorrectly mark certain characters as changed in specific cases (<a href="https://github.com/elastic/kibana/pull/205138" class="ulink" target="_top">#205138</a>).
</li>
<li class="listitem">
Lists all policies to ensure that integrations are properly displayed (<a href="https://github.com/elastic/kibana/pull/205103" class="ulink" target="_top">#205103</a>).
</li>
<li class="listitem">
<p>Fixes incompatibility issues with Elastic Defend. In 8.16.2 and 8.17.0, a portion of the Windows kernel driver was refactored to work around an incompatibility with CrowdStrike Falcon which could result in a <code class="literal">CRITICAL_PROCESS_DIED</code> bugcheck. It was discovered that this incompatibility could also be triggered by Memory Protection, so a portion of the kernel driver was refactored to avoid this conflict.</p>
<p>Affected users who are unable to upgrade should set one or both of the following in their Elastic Defend advanced policy, depending on their version:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">windows.advanced.events.process.creation_flags: false</code> (8.13.0 - 8.16.1)
</li>
<li class="listitem">
<code class="literal">windows.advanced.memory_protection.shellcode_trampoline_detection: false</code> (8.12.0 - 8.16.2)
</li>
</ul>
</div>
</li>
<li class="listitem">
Fixes an Elastic Defend bug that could cause the Windows API event call stack enrichment to fail for processes that started before Elastic Defend and if another security product was present and hooking system DLLs.
</li>
<li class="listitem">
Fixes an Elastic Defend bug that caused Windows API events involving <code class="literal">mswsock.dll</code> to be mislabeled with the <code class="literal">proxy_call</code> behavior.
</li>
</ul>
</div>
<div class="position-relative"><h3><a id="release-notes-8.16.2"></a>8.16.2</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.x/docs/release-notes/8.16.asciidoc">edit</a></div>
<div class="position-relative"><h4><a id="known-issue-8.16.2"></a>Known issues</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.x/docs/release-notes/8.16.asciidoc">edit</a></div>
<details>
<summary class="title">Duplicate alerts can be produced from manually running threshold rules</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
On November 12, 2024, it was discovered that manually running threshold rules could produce duplicate alerts if the date range was already covered by a scheduled rule execution.</p>
</div>
</details>
<details>
<summary class="title">Manually running custom query rules with suppression could suppress more alerts than expected</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
On November 12, 2024, it was discovered that manually running a custom query rule with suppression could incorrectly inflate the number of suppressed alerts.</p>
</div>
</details>
<div class="position-relative"><h4><a id="bug-fixes-8.16.2"></a>Bug fixes</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.x/docs/release-notes/8.16.asciidoc">edit</a></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Rejects CEF logs from Automatic Import and redirects you to the CEF integration instead (<a href="https://github.com/elastic/kibana/pull/201792" class="ulink" target="_top">#201792</a>, <a href="https://github.com/elastic/kibana/pull/202994" class="ulink" target="_top">#202994</a>).
</li>
<li class="listitem">
Fixes an issue that could interfere with Knowledge Base setup (<a href="https://github.com/elastic/kibana/pull/201175" class="ulink" target="_top">#201175</a>).
</li>
<li class="listitem">
Modifies the empty state message that appears when installing prebuilt rules (<a href="https://github.com/elastic/kibana/pull/202226" class="ulink" target="_top">#202226</a>).
</li>
<li class="listitem">
Turns off the <span class="strong strong"><strong>Install All</strong></span> button on the <span class="strong strong"><strong>Add Elastic Rules</strong></span> page while rules are being installed (<a href="https://github.com/elastic/kibana/pull/201731" class="ulink" target="_top">#201731</a>).
</li>
<li class="listitem">
Removes fields with an <code class="literal">@</code> from the script processor (<a href="https://github.com/elastic/kibana/pull/201548" class="ulink" target="_top">#201548</a>).
</li>
<li class="listitem">
Fixes a bug with threshold rules that prevented cardinality details from appearing (<a href="https://github.com/elastic/kibana/pull/201162" class="ulink" target="_top">#201162</a>).
</li>
<li class="listitem">
Fixes an exceptions bug that prevented the <span class="strong strong"><strong>Exceptions</strong></span> tab from properly loading if exceptions contained comments with newline characters (<code class="literal">\n</code>) (<a href="https://github.com/elastic/kibana/pull/202063" class="ulink" target="_top">#202063</a>).
</li>
<li class="listitem">
Fixes a bug that caused an entity engine to get stuck in the <code class="literal">Installing</code> status if the default Security data view didn&#8217;t exist. With this fix, engines now correctly report the <code class="literal">Error</code> state (<a href="https://github.com/elastic/kibana/pull/201140" class="ulink" target="_top">#201140</a>).
</li>
<li class="listitem">
Fixes an issue that prevented you from successfully importing TSV files with asset criticality data if you&#8217;re on Windows (<a href="https://github.com/elastic/kibana/pull/199791" class="ulink" target="_top">#199791</a>).
</li>
<li class="listitem">
Improves Elastic Defend by refactoring the kernel driver to work around a <code class="literal">CRITICAL_PROCESS_DIED</code> bug check (BSOD) that can occur due to a conflict with CrowdStrike Falcon.
</li>
<li class="listitem">
Fixes an Elastic Defend bug that caused the <span class="strong strong"><strong>Open Elastic Security</strong></span> button in the Windows Security Center to be non-functional. Now, you&#8217;re informed that Elastic Defend is managed by your system administrator.
</li>
</ul>
</div>
<div class="position-relative"><h3><a id="release-notes-8.16.1"></a>8.16.1</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.x/docs/release-notes/8.16.asciidoc">edit</a></div>
<div class="position-relative"><h4><a id="known-issue-8.16.1"></a>Known issues</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.x/docs/release-notes/8.16.asciidoc">edit</a></div>
<details>
<summary class="title">The <span class="strong strong"><strong>Exceptions</strong></span> tab won&#8217;t properly load if exceptions contain comments with newline characters (<code class="literal">\n</code>)</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
On December 5, 2024, it was discovered that the <span class="strong strong"><strong>Exceptions</strong></span> tab won&#8217;t load properly if any exceptions contain comments with newline characters (<code class="literal">\n</code>). This issue occurs when you upgrade to 8.16.0 or later (<a href="https://github.com/elastic/kibana/issues/201820" class="ulink" target="_top">#201820</a>).</p>
<p><span class="strong strong"><strong>Workaround</strong></span><br>
Upgrade to 8.16.2, or follow the workarounds below.</p>
<p>For custom rules:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
From the <span class="strong strong"><strong>Rules</strong></span> page, <a class="xref" href="rules-ui-management.html#import-export-rules-ui" title="Export and import rules">export</a> the rule or rules with the affected exception lists.
</li>
<li class="listitem">
Modify the <code class="literal">.ndjson</code> file so <code class="literal">comments</code> no longer contain newline characters.
</li>
<li class="listitem">
Return to the <span class="strong strong"><strong>Rules</strong></span> page and <a class="xref" href="rules-ui-management.html#import-export-rules-ui" title="Export and import rules">re-import</a> the rules. Make sure to select the <span class="strong strong"><strong>Overwrite existing exception lists with conflicting "list_id"</strong></span> option.
</li>
</ol>
</div>
<p>For prebuilt rules:</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>If you only need to fix exceptions for the Elastic Endpoint rule, you can export and re-import its exception list from the <a class="xref" href="shared-exception-lists.html" title="Create and manage shared exception lists"><span class="strong strong"><strong>Shared Exception Lists</strong></span></a> page.</p>
</div>
</div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Follow these steps to fetch the affected exception list ID or IDs that are associated with the rule:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Find the affected rule&#8217;s ID (<code class="literal">id</code>). From the <span class="strong strong"><strong>Rules</strong></span> page, open the details of a rule, go to the page URL, and copy the string at the end. For example, in the URL <a href="http://host.name/app/security/rules/id/167a5f6f-2148-4792-8226-b5e7a58ef46e" class="ulink" target="_top">http://host.name/app/security/rules/id/167a5f6f-2148-4792-8226-b5e7a58ef46e</a>, the string at the end (<code class="literal">167a5f6f-2148-4792-8226-b5e7a58ef46e</code>) is the <code class="literal">id</code>.
</li>
<li class="listitem">
<p>Specify the <code class="literal">id</code> when fetching the rule&#8217;s details using the <a href="/docs/api/doc/kibana/v8/operation/operation-readrule" class="ulink" target="_top">Retrieve a detection rule API</a>. Here is an example request that includes the <code class="literal">id</code>:</p>
<div class="pre_wrapper lang-console">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console">curl -H 'Authorization: ApiKey API_KEY_HERE' -H 'kbn-xsrf: true' -H 'elastic-api-version: 2023-10-31' '${KIBANA_URL}/api/detection_engine/rules?id=167a5f6f-2148-4792-8226-b5e7a58ef46e</pre>
</div>
<div class="console_widget" data-snippet="snippets/169.console"></div>
</li>
<li class="listitem">
<p>The JSON response contains the <code class="literal">id</code>, <code class="literal">list_id</code>, and <code class="literal">namespace_type</code> values within the <code class="literal">exceptions_list</code> key (as shown below). You need these values when using the Exception list API to retrieve the affected exception list.</p>
<div class="pre_wrapper lang-console">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console">{
  "id": "167a5f6f-2148-4792-8226-b5e7a58ef46e",
  "exceptions_list": [
    {
      "id": "490525a2-eb66-4320-95b5-88bdd1302dc4",
      "list_id": "f75aae6f-0229-413f-881d-81cb3abfbe2d",
      "namespace_type": "single"
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/170.console"></div>
</li>
</ol>
</div>
</li>
<li class="listitem">
<p>Use the export exceptions API to retrieve the affected exception list. Insert the values for the <code class="literal">id</code>, <code class="literal">list_id</code>, and <code class="literal">namespace_type</code> parameters into the following API call:</p>
<div class="pre_wrapper lang-console">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console">curl -XPOST -H 'Authorization: ApiKey API_KEY_HERE' -H 'kbn-xsrf: true' -H 'elastic-api-version: 2023-10-31' '${KIBANA_URL}/api/exception_lists/_export?list_id=f75aae6f-0229-413f-881d-81cb3abfbe2d&amp;id=490525a2-eb66-4320-95b5-88bdd1302dc4&amp;namespace_type=single' -o list.ndjson</pre>
</div>
<div class="console_widget" data-snippet="snippets/171.console"></div>
</li>
<li class="listitem">
Modify the exception list&#8217;s <code class="literal">.ndjson</code> file to ensure <code class="literal">comments[].comment</code> values don&#8217;t contain newline characters (<code class="literal">\n</code>).
</li>
<li class="listitem">
Re-import the modified exception list using <span class="strong strong"><strong>Import exception lists</strong></span> option on the <a class="xref" href="shared-exception-lists.html" title="Create and manage shared exception lists"><span class="strong strong"><strong>Shared Exception Lists</strong></span></a> page. The import will initially fail because the exception list already exists, and an option to overwrite the existing list will appear. Select the option, then resubmit the request to import the corrected exception list.
</li>
</ol>
</div>
<p><span class="strong strong"><strong>Resolved</strong></span><br>
On December 17, 2024, this issue was resolved.</p>
</div>
</details>
<details>
<summary class="title">Manually running threshold rules may generate duplicate alerts</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
On November 12, 2024, it was discovered that manually running threshold rules could generate duplicate alerts if the date range was already covered in a scheduled rule execution.</p>
</div>
</details>
<details>
<summary class="title">Manually running custom query rules with suppression could suppress more alerts than expected</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
On November 12, 2024, it was discovered that manually running a custom query rule with suppression could incorrectly inflate the number of suppressed alerts.</p>
</div>
</details>
<div class="position-relative"><h4><a id="bug-fixes-8.16.1"></a>Bug fixes</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.x/docs/release-notes/8.16.asciidoc">edit</a></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Fixes a bug that caused the <span class="strong strong"><strong>Alerts</strong></span> page to crash if you upgraded to 8.16 and accessed the page in a non-default Kibana space (<a href="https://github.com/elastic/kibana/pull/200058" class="ulink" target="_top">#200058</a>).
</li>
<li class="listitem">
Fixes a bug that caused the Elastic AI Assistant Knowledge Base to fail if the current user had a colon (<code class="literal">:</code>) in their username and attempted to access Knowledge Base entries (<a href="https://github.com/elastic/kibana/pull/200131" class="ulink" target="_top">#200131</a>).
</li>
<li class="listitem">
Fixes a bug that made values unavailable for the Knowledge Base <span class="strong strong"><strong>Index</strong></span> field, which lets you specify an index as a knowledge source (<a href="https://github.com/elastic/kibana/pull/199990" class="ulink" target="_top">#199990</a>).
</li>
<li class="listitem">
Fixes a bug in Automatic Import where icons were not shown after the integration was installed (<a href="https://github.com/elastic/kibana/pull/201139" class="ulink" target="_top">#201139</a>).
</li>
<li class="listitem">
Fixes a bug that unset the <code class="literal">required_fields</code> field if you updated a rule by sending a <code class="literal">PATCH</code> request that didn&#8217;t contain the <code class="literal">required_fields</code> field (<a href="https://github.com/elastic/kibana/pull/199901" class="ulink" target="_top">#199901</a>).
</li>
<li class="listitem">
Fixes the entity store initialization error that was caused by risk engine failures. Now, when you upgrade to 8.16.1, or follow the standard flow for initializing the entity store, the risk engine no longer fails while deleting the component template. In addition, the index template will correctly reference the new component template, ensuring the successful initialization of the entity store (<a href="https://github.com/elastic/kibana/pull/199734" class="ulink" target="_top">#199734</a>).
</li>
<li class="listitem">
Improves the warning message that displays when asset criticality assignments are duplicated during the bulk assignment flow (<a href="https://github.com/elastic/kibana/pull/199651" class="ulink" target="_top">#199651</a>).
</li>
<li class="listitem">
Fixes a time skew bug that occurred when Linux virtual machines using eBPF event probes were suspended and then resumed.
</li>
</ul>
</div>
<div class="position-relative"><h3><a id="release-notes-8.16.0"></a>8.16.0</h3><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.x/docs/release-notes/8.16.asciidoc">edit</a></div>
<div class="position-relative"><h4><a id="known-issue-8.16.0"></a>Known issues</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.x/docs/release-notes/8.16.asciidoc">edit</a></div>
<details>
<summary class="title">The <span class="strong strong"><strong>Exceptions</strong></span> tab won&#8217;t properly load if exceptions contain comments with newline characters (<code class="literal">\n</code>)</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
On December 5, 2024, it was discovered that the <span class="strong strong"><strong>Exceptions</strong></span> tab won&#8217;t load properly if any exceptions contain comments with newline characters (<code class="literal">\n</code>). This issue occurs when you upgrade to 8.16.0 or later (<a href="https://github.com/elastic/kibana/issues/201820" class="ulink" target="_top">#201820</a>).</p>
<p><span class="strong strong"><strong>Workaround</strong></span><br>
Upgrade to 8.16.2, or follow the workarounds below.</p>
<p>For custom rules:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
From the <span class="strong strong"><strong>Rules</strong></span> page, <a class="xref" href="rules-ui-management.html#import-export-rules-ui" title="Export and import rules">export</a> the rule or rules with the affected exception lists.
</li>
<li class="listitem">
Modify the <code class="literal">.ndjson</code> file so <code class="literal">comments</code> no longer contain newline characters.
</li>
<li class="listitem">
Return to the <span class="strong strong"><strong>Rules</strong></span> page and <a class="xref" href="rules-ui-management.html#import-export-rules-ui" title="Export and import rules">re-import</a> the rules. Make sure to select the <span class="strong strong"><strong>Overwrite existing exception lists with conflicting "list_id"</strong></span> option.
</li>
</ol>
</div>
<p>For prebuilt rules:</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>If you only need to fix exceptions for the Elastic Endpoint rule, you can export and re-import its exception list from the <a class="xref" href="shared-exception-lists.html" title="Create and manage shared exception lists"><span class="strong strong"><strong>Shared Exception Lists</strong></span></a> page.</p>
</div>
</div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Follow these steps to fetch the affected exception list ID or IDs that are associated with the rule:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Find the affected rule&#8217;s ID (<code class="literal">id</code>). From the <span class="strong strong"><strong>Rules</strong></span> page, open the details of a rule, go to the page URL, and copy the string at the end. For example, in the URL <a href="http://host.name/app/security/rules/id/167a5f6f-2148-4792-8226-b5e7a58ef46e" class="ulink" target="_top">http://host.name/app/security/rules/id/167a5f6f-2148-4792-8226-b5e7a58ef46e</a>, the string at the end (<code class="literal">167a5f6f-2148-4792-8226-b5e7a58ef46e</code>) is the <code class="literal">id</code>.
</li>
<li class="listitem">
<p>Specify the <code class="literal">id</code> when fetching the rule&#8217;s details using the <a href="/docs/api/doc/kibana/v8/operation/operation-readrule" class="ulink" target="_top">Retrieve a detection rule API</a>. Here is an example request that includes the <code class="literal">id</code>:</p>
<div class="pre_wrapper lang-console">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console">curl -H 'Authorization: ApiKey API_KEY_HERE' -H 'kbn-xsrf: true' -H 'elastic-api-version: 2023-10-31' '${KIBANA_URL}/api/detection_engine/rules?id=167a5f6f-2148-4792-8226-b5e7a58ef46e</pre>
</div>
<div class="console_widget" data-snippet="snippets/172.console"></div>
</li>
<li class="listitem">
<p>The JSON response contains the <code class="literal">id</code>, <code class="literal">list_id</code>, and <code class="literal">namespace_type</code> values within the <code class="literal">exceptions_list</code> key (as shown below). You need these values when using the Exception list API to retrieve the affected exception list.</p>
<div class="pre_wrapper lang-console">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console">{
  "id": "167a5f6f-2148-4792-8226-b5e7a58ef46e",
  "exceptions_list": [
    {
      "id": "490525a2-eb66-4320-95b5-88bdd1302dc4",
      "list_id": "f75aae6f-0229-413f-881d-81cb3abfbe2d",
      "namespace_type": "single"
    }
  ]
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/173.console"></div>
</li>
</ol>
</div>
</li>
<li class="listitem">
<p>Use the export exceptions API to retrieve the affected exception list. Insert the values for the <code class="literal">id</code>, <code class="literal">list_id</code>, and <code class="literal">namespace_type</code> parameters into the following API call:</p>
<div class="pre_wrapper lang-console">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-console">curl -XPOST -H 'Authorization: ApiKey API_KEY_HERE' -H 'kbn-xsrf: true' -H 'elastic-api-version: 2023-10-31' '${KIBANA_URL}/api/exception_lists/_export?list_id=f75aae6f-0229-413f-881d-81cb3abfbe2d&amp;id=490525a2-eb66-4320-95b5-88bdd1302dc4&amp;namespace_type=single' -o list.ndjson</pre>
</div>
<div class="console_widget" data-snippet="snippets/174.console"></div>
</li>
<li class="listitem">
Modify the exception list&#8217;s <code class="literal">.ndjson</code> file to ensure <code class="literal">comments[].comment</code> values don&#8217;t contain newline characters (<code class="literal">\n</code>).
</li>
<li class="listitem">
Re-import the modified exception list using <span class="strong strong"><strong>Import exception lists</strong></span> option on the <a class="xref" href="shared-exception-lists.html" title="Create and manage shared exception lists"><span class="strong strong"><strong>Shared Exception Lists</strong></span></a> page. The import will initially fail because the exception list already exists, and an option to overwrite the existing list will appear. Select the option, then resubmit the request to import the corrected exception list.
</li>
</ol>
</div>
<p><span class="strong strong"><strong>Resolved</strong></span><br>
On December 17, 2024, this issue was resolved.</p>
</div>
</details>
<details>
<summary class="title">Attempting to edit an Elastic AI Assistant Knowledge Base index results in an error</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
Updating a Knowledge Base entry of type "index" results in an error.</p>
<p><span class="strong strong"><strong>Workaround</strong></span><br>
Instead of updating an "index" entry, delete it and add it again with the desired changes.</p>
</div>
</details>
<details>
<summary class="title">Manually running threshold rules may generate duplicate alerts</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
On November 12, 2024, it was discovered that manually running threshold rules could generate duplicate alerts if the date range was already covered in a scheduled rule execution.</p>
</div>
</details>
<details>
<summary class="title">Manually running custom query rules with suppression could suppress more alerts than expected</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
On November 12, 2024, it was discovered that manually running a custom query rule with suppression could incorrectly inflate the number of suppressed alerts.</p>
</div>
</details>
<details>
<summary class="title">Alerts page crashes if you upgrade to 8.16 and access it in a non-default Kibana space</summary>
<div class="content">
<p><span class="strong strong"><strong>Details</strong></span><br>
On November 14, 2024, it was discovered that the <span class="strong strong"><strong>Alerts</strong></span> page would crash and display an <code class="literal">Unable to load</code> error if you upgraded to 8.16 and accessed the page in a non-default Kibana space.</p>
<p><span class="strong strong"><strong>Workaround</strong></span><br>
Manually edit your browser&#8217;s local storage and refresh the <span class="strong strong"><strong>Alerts</strong></span> page:</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>These instructions only apply to the Google Chrome browser. Modify the steps based on the browser you&#8217;re using.</p>
</div>
</div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Right-click anywhere on the <span class="strong strong"><strong>Alerts</strong></span> page, then select <span class="strong strong"><strong>Inspect</strong></span> to open Chrome&#8217;s Developer Tools.
</li>
<li class="listitem">
Go to <span class="strong strong"><strong>Application &#8594; Storage</strong></span>, then expand <span class="strong strong"><strong>Local Storage</strong></span>.
</li>
<li class="listitem">
Click on the name of your Kibana instance, for example, <a href="http://localhost:1234" class="ulink" target="_top">http://localhost:1234</a>.
</li>
<li class="listitem">
Search for the <code class="literal">siem.&lt;space_name&gt;.pageFilters</code> key, right-click on the value, then click <span class="strong strong"><strong>Delete</strong></span>. If you have multiple non-default spaces, do this for each space.
</li>
<li class="listitem">
Refresh the <span class="strong strong"><strong>Alerts</strong></span> page to reload it.
</li>
</ol>
</div>
</div>
</details>
<div class="position-relative"><h4><a id="breaking-changes-8.16.0"></a>Breaking changes</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.x/docs/release-notes/8.16.asciidoc">edit</a></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
During shutdown, Kibana now waits for all the ongoing requests to complete according to the <code class="literal">server.shutdownTimeout</code> setting. During that period, the incoming socket is closed and any new incoming requests are rejected. Before this update, new incoming requests received a response with the status code 503 and body <code class="literal">{ "message": "{kib} is shutting down and not accepting new incoming requests" }</code>.
</li>
</ul>
</div>
<div class="position-relative"><h4><a id="features-8.16.0"></a>New features</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.x/docs/release-notes/8.16.asciidoc">edit</a></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Introduces Knowledge Base for Elastic AI Assistant, which allows you to specify information for AI Assistant to remember when responding to your queries (<a href="https://github.com/elastic/kibana/pull/186566" class="ulink" target="_top">#186566</a>, <a href="https://github.com/elastic/kibana/pull/192665" class="ulink" target="_top">#192665</a>).
</li>
<li class="listitem">
Enables agentless deployment for Elastic&#8217;s Cloud Security Posture Management integration and the new Cloud Asset Inventory integration (<a href="https://github.com/elastic/kibana/pull/191557" class="ulink" target="_top">#191557</a>).
</li>
<li class="listitem">
Enables data collected by the Wiz and AWS Security Hub integrations to appear on the Findings page and in entity details flyouts (<a href="https://github.com/elastic/integrations/pull/10790" class="ulink" target="_top">#10790</a>, <a href="https://github.com/elastic/integrations/pull/11158" class="ulink" target="_top">#11158</a>).
</li>
<li class="listitem">
Enables alerts collected by the Falco integration to appear on the Alerts page (<a href="https://github.com/elastic/integrations/pull/9619" class="ulink" target="_top">#9619</a>, <a href="https://github.com/elastic/integrations/pull/11051" class="ulink" target="_top">#11051</a>).
</li>
<li class="listitem">
Adds ability to manually run rules for a specified time period, either for testing purposes or to generate alerts for past events.
</li>
<li class="listitem">
Adds historical results to the Data Quality dashboard and updates its UI (<a href="https://github.com/elastic/kibana/pull/191898" class="ulink" target="_top">#191898</a>, <a href="https://github.com/elastic/kibana/pull/196127" class="ulink" target="_top">#196127</a>).
</li>
<li class="listitem">
Adds the ability to attach notes to alerts and events and introduces the Notes page, which allows you to manage all existing notes (<a href="https://github.com/elastic/kibana/pull/186787" class="ulink" target="_top">#186787</a>, <a href="https://github.com/elastic/kibana/pull/186807" class="ulink" target="_top">#186807</a>, <a href="https://github.com/elastic/kibana/pull/186931" class="ulink" target="_top">#186931</a>, <a href="https://github.com/elastic/kibana/pull/186946" class="ulink" target="_top">#186946</a>, <a href="https://github.com/elastic/kibana/pull/187214" class="ulink" target="_top">#187214</a>, <a href="https://github.com/elastic/kibana/pull/193373" class="ulink" target="_top">#193373</a>).
</li>
<li class="listitem">
Enables detection rules to automatically execute system actions, such as opening a case (<a href="https://github.com/elastic/kibana/pull/183937" class="ulink" target="_top">#183937</a>).
</li>
<li class="listitem">
Adds role-based access control (RBAC) for Elastic AI Assistant&#8217;s knowledge base (<a href="https://github.com/elastic/kibana/pull/195733" class="ulink" target="_top">#195733</a>).
</li>
<li class="listitem">
Adds RBAC for Attack Discovery (<a href="https://github.com/elastic/kibana/pull/188788" class="ulink" target="_top">#188788</a>).
</li>
<li class="listitem">
Removes the <code class="literal">securitySolution:enableAssetCriticality</code> advanced setting and enables <a class="xref" href="asset-criticality.html" title="Asset criticality">asset criticality</a> workflows by default (<a href="https://github.com/elastic/kibana/pull/196270" class="ulink" target="_top">#196270</a>).
</li>
<li class="listitem">
Introduces the entity store as a technical preview feature, which allows observed, imported, integrated, or uploaded entities to be stored persistently (<a href="https://github.com/elastic/kibana/pull/192806" class="ulink" target="_top">#192806</a>).
</li>
<li class="listitem">
Adds syntax validation for ES|QL queries (<a href="https://github.com/elastic/kibana/pull/189780" class="ulink" target="_top">#189780</a>).
</li>
<li class="listitem">
Allows you to view Elasticsearch queries that run during rule execution. This option is provided for ES|QL and EQL rules only (<a href="https://github.com/elastic/kibana/pull/191107" class="ulink" target="_top">#191107</a>).
</li>
<li class="listitem">
Allows you to create and update a rule even when some data-related validation errors are present in the query field (<a href="https://github.com/elastic/kibana/pull/191487" class="ulink" target="_top">#191487</a>).
</li>
<li class="listitem">
Introduces a new advanced setting, <code class="literal">securitySolution:enableVisualizationsInFlyout</code>. When enabled, you can examine alerts and events in the <span class="strong strong"><strong>Visualize</strong></span> tab, which provides a more detailed view of the event analyzer and Session View (<a href="https://github.com/elastic/kibana/pull/194012" class="ulink" target="_top">#194012</a>, <a href="https://github.com/elastic/kibana/pull/192531" class="ulink" target="_top">#192531</a>, <a href="https://github.com/elastic/kibana/pull/192643" class="ulink" target="_top">#192643</a>).
</li>
<li class="listitem">
<p>Creates a new advanced setting <code class="literal">securitySolution:excludedDataTiersForRuleExecution</code> that allows you to exclude cold and frozen data from rule executions (<a href="https://github.com/elastic/kibana/pull/186908" class="ulink" target="_top">#186908</a>).</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Even when the <code class="literal">excludedDataTiersForRuleExecution</code> advanced setting is enabled, indicator match, event correlation, and ES|QL rules may still fail if a frozen or cold shard that matches the rule&#8217;s specified index pattern is unavailable during rule executions. If failures occur, we recommend modifying the rule&#8217;s index patterns to only match indices containing hot tier data.</p>
</div>
</div>
</li>
<li class="listitem">
Enhances the Insights section of the alert and event details flyouts by providing available misconfiguration and vulnerabilities findings (<a href="https://github.com/elastic/kibana/pull/195509" class="ulink" target="_top">#195509</a>).
</li>
<li class="listitem">
Turns off the host field size reduction setting on Elastic Defend&#8217;s integration policy by default. To turn it on, configure the <code class="literal">[os].advanced.set_extended_host_information</code> <a class="xref" href="configure-endpoint-integration-policy.html#adv-policy-settings" title="Advanced policy settings (optional)">advanced policy setting</a>.
</li>
<li class="listitem">
Allows you to reduce CPU usage, I/O, and event sizes by turning on process event aggregation when configuring your Elastic Defend integration policy. Related process events that occur in rapid succession are combined into fewer aggregate events. To turn on process event aggregation, configure the <code class="literal">advanced.events.aggregate_process</code> <a class="xref" href="configure-endpoint-integration-policy.html#adv-policy-settings" title="Advanced policy settings (optional)">advanced policy setting</a>.
</li>
<li class="listitem">
Allows you to reduce CPU usage, I/O, and event sizes by turning off MD5, SHA-1, and SHA-256 hashes in events when configuring your Elastic Defend integration policy. Example fields include <code class="literal">process.hash.md5</code> and <code class="literal">file.hash.sha1</code>.
</li>
<li class="listitem">
<p>Allows you to configure your Elastic Defend integration policy to collect SHA-256 file hashes in file events. Before doing so, consider the following caveats:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
This can greatly increase Elastic Defend&#8217;s CPU and I/O utilization and impact system responsiveness.
</li>
<li class="listitem">
This can significantly delay event enrichment and lead to Behavioral Protection rules firing too late to effectively stop malicious behavior.
</li>
<li class="listitem">
This can cause event processing queues to overflow and lead to dropped events.
</li>
<li class="listitem">
Many file events won&#8217;t contain hashes. Hash collection is the best effort and is not guaranteed to be present in every event. Hashes are collected asynchronously and shortly after the file activity. Hashes might be missing if the file was rapidly renamed, moved, deleted, or (on Windows) opened by another process without <a href="https://learn.microsoft.com/en-us/windows/win32/fileio/creating-and-opening-files" class="ulink" target="_top">read sharing</a>.
</li>
</ul>
</div>
</li>
<li class="listitem">
Improves Elastic Defend by enabling the use of dynamic <a href="/guide/en/beats/filebeat/8.x/kafka-output.html#topic-option-kafka" class="ulink" target="_top">topics</a> for the Kafka output.
</li>
<li class="listitem">
Improves Elastic Defend by integrating a new Event Tracing for Windows (ETW) provider (Microsoft-Windows-WMI-Activity) to create new event types that can be used by prebuilt endpoint rules to detect malicious WMI activity.
</li>
</ul>
</div>
<div class="position-relative"><h4><a id="enhancements-8.16.0"></a>Enhancements</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.x/docs/release-notes/8.16.asciidoc">edit</a></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Removes Elastic AI Assistant&#8217;s default system prompts. The instructions previously contained in those prompts are now automatically included without user interaction, so Elastic AI Assistant will remain focused on relevant topics. Custom system prompts are still available (<a href="https://github.com/elastic/kibana/pull/191847" class="ulink" target="_top">#191847</a>).
</li>
<li class="listitem">
Improves Elastic AI Assistant&#8217;s ability to generate ES|QL queries (<a href="https://github.com/elastic/kibana/pull/195480" class="ulink" target="_top">#195480</a>, <a href="https://github.com/elastic/kibana/pull/188492" class="ulink" target="_top">#188492</a>).
</li>
<li class="listitem">
Adds a button that lets you quickly add queries generated by Elastic AI Assistant to a rule&#8217;s definition (<a href="https://github.com/elastic/kibana/pull/190963" class="ulink" target="_top">#190963</a>).
</li>
<li class="listitem">
Adds an <span class="strong strong"><strong>Other</strong></span> option to the OpenAI connector&#8217;s <span class="strong strong"><strong>Select an OpenAI provider</strong></span> dropdown menu. Select this option when <a class="xref" href="connect-to-byo-llm.html" title="Connect to your own local LLM">connecting to your own custom LLM</a> (<a href="https://github.com/elastic/kibana/pull/194831" class="ulink" target="_top">#194831</a>).
</li>
<li class="listitem">
Adds a Kibana advanced setting <code class="literal">securitySolution:maxUnassociatedNotes</code>, which allows you to set the maximum number of notes that can be attached to alerts and events (<a href="https://github.com/elastic/kibana/pull/194947" class="ulink" target="_top">#194947</a>).
</li>
<li class="listitem">
Adds an <span class="strong strong"><strong>Install and enable</strong></span> button to the <span class="strong strong"><strong>Add Elastic Rules</strong></span> page, which allows for rules to be immediately enabled after they&#8217;re installed (<a href="https://github.com/elastic/kibana/pull/191529" class="ulink" target="_top">#191529</a>).
</li>
<li class="listitem">
Adds the <span class="strong strong"><strong>Alert Suppression</strong></span> and <span class="strong strong"><strong>Investigative guide</strong></span> fields to the rule upgrade workflow (<a href="https://github.com/elastic/kibana/pull/195499" class="ulink" target="_top">#195499</a>).
</li>
<li class="listitem">
Adds the <code class="literal">IS</code> operator as an option when configuring a Windows signature blocklist entry (<a href="https://github.com/elastic/kibana/pull/190515" class="ulink" target="_top">#190515</a>).
</li>
<li class="listitem">
<p>Improves Attack Discovery in the following ways (<a href="https://github.com/elastic/kibana/pull/195669" class="ulink" target="_top">#195669</a>):</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Attack Discovery can now process up to 500 alerts (previous maximum: 100). This setting can now be adjusted directly from the Attack Discovery page and is stored locally instead of in Elasticsearch.
</li>
<li class="listitem">
Attack Discovery now combines related discoveries that would previously have appeared separately.
</li>
<li class="listitem">
Attack Discovery now detects and displays an error instead of hallucinated output.
</li>
</ul>
</div>
</li>
<li class="listitem">
Updates the Get Started tour for Elastic Security (<a href="https://github.com/elastic/kibana/pull/192247" class="ulink" target="_top">#192247</a>).
</li>
<li class="listitem">
Improves loading performance for various pages in Kibana (<a href="https://github.com/elastic/kibana/pull/194241" class="ulink" target="_top">#194241</a>).
</li>
<li class="listitem">
Adds User and Global Artifacts to the Fleet Policy Response flyout and to the Endpoint details flyout (<a href="https://github.com/elastic/kibana/pull/184125" class="ulink" target="_top">#184125</a>).
</li>
<li class="listitem">
Allows you to recalculate entity risk scores immediately after you upload asset criticality data (<a href="https://github.com/elastic/kibana/pull/187577" class="ulink" target="_top">#187577</a>).
</li>
<li class="listitem">
Allows you to enable entity risk scoring in multiple Kibana spaces (<a href="https://github.com/elastic/kibana/pull/192671" class="ulink" target="_top">#192671</a>).
</li>
<li class="listitem">
Creates a new API endpoint for cleaning up entity risk scoring data: <code class="literal">DELETE /api/risk_score/engine/dangerously_delete_data</code> (<a href="https://github.com/elastic/kibana/pull/191843" class="ulink" target="_top">#191843</a>, <a href="https://github.com/elastic/kibana/pull/189872" class="ulink" target="_top">#189872</a>).
</li>
<li class="listitem">
Allows Automatic Import to analyze a larger number of sample events when generating a new integration (<a href="https://github.com/elastic/kibana/pull/196233" class="ulink" target="_top">#196233</a>).
</li>
<li class="listitem">
Allows Automatic Import to recognize CSV logs and create integrations for CSV data (<a href="https://github.com/elastic/kibana/pull/196228" class="ulink" target="_top">#196228</a>, <a href="https://github.com/elastic/kibana/pull/194386" class="ulink" target="_top">#194386</a>).
</li>
<li class="listitem">
Allows you to open the rule details flyout from the Alerts table (<a href="https://github.com/elastic/kibana/pull/191764" class="ulink" target="_top">#191764</a>).
</li>
<li class="listitem">
Allows you to resize the alert and event details flyouts and choose how it&#8217;s displayed in relation to the Alerts table (over or next to it) (<a href="https://github.com/elastic/kibana/pull/192906" class="ulink" target="_top">#192906</a>, <a href="https://github.com/elastic/kibana/pull/182615" class="ulink" target="_top">#182615</a>).
</li>
<li class="listitem">
Improves network previews in the alert details flyout (<a href="https://github.com/elastic/kibana/pull/190560" class="ulink" target="_top">#190560</a>).
</li>
<li class="listitem">
Adds support in all detection rule types for Elastic Defend&#8217;s automated response actions (<a href="https://github.com/elastic/kibana/pull/193390" class="ulink" target="_top">#193390</a>, <a href="https://github.com/elastic/kibana/pull/191874" class="ulink" target="_top">#191874</a>).
</li>
<li class="listitem">
Enhances Elastic Defend by improving the <code class="literal">call_stack_final_user_module</code> attribution where potential <code class="literal">proxy_call</code> modules are encountered during Windows call stack analysis.
</li>
<li class="listitem">
Adds new fields to Elastic Defend API events to improve context for the triage of Behavior Alerts. The new <code class="literal">call_stack_final_user_module</code> fields are <code class="literal">allocation_private_bytes</code>, <code class="literal">protection</code>, <code class="literal">protection_provenance_path</code>, and <code class="literal">reason</code>.
</li>
<li class="listitem">
Adds a new Elastic Defend API event for <a href="https://learn.microsoft.com/en-us/windows/win32/api/ioapiset/nf-ioapiset-deviceiocontrol" class="ulink" target="_top"><code class="literal">DeviceIoControl</code></a> calls to support the detection of driver abuse. This feature is only supported on Windows 11 Desktop versions.
</li>
<li class="listitem">
Ensures security artifacts are updated when the Elastic Defend service starts.
</li>
<li class="listitem">
Improves error messages that are returned when Elastic Defend receives invalid or unsupported cryptographic keys from the Elastic Defend policy.
</li>
<li class="listitem">
Ensures that Elastic Defend tells Fleet that it&#8217;s <code class="literal">orphaned</code> if the connection between Elastic Defend and Elastic Agent stops for an extended period of time. Fleet uses this information to provide you with additional troubleshooting context.
</li>
<li class="listitem">
Adds SOCKS5 proxy support to Elastic Defend&#8217;s Logstash output.
</li>
<li class="listitem">
Ensures that on Windows, Elastic Defend uses <a href="/security-labs/finding-truth-in-the-shadows" class="ulink" target="_top">Intel CET and AMD Shadow Stacks</a> to collect call stacks, where supported. This improves performance and enables the detection of certain defense evasions. You can turn this feature off in Elastic Defend <a class="xref" href="configure-endpoint-integration-policy.html#adv-policy-settings" title="Advanced policy settings (optional)">advanced policy settings</a> (<a href="https://github.com/elastic/kibana/pull/190553" class="ulink" target="_top">#190553</a>).
</li>
<li class="listitem">
Restores Elastic Defend&#8217;s support for Windows Server 2012, which was removed in 8.13.0.
</li>
<li class="listitem">
Improves Elastic Defend&#8217;s caching to reduce memory usage on Windows.
</li>
<li class="listitem">
Enhances Elastic Defend by reducing the size of process events, which reduces excessive process ancestry entries and shortens the entity ID.
</li>
<li class="listitem">
Improves the reliability and system resource usage of Elastic Defend&#8217;s Windows network driver.
</li>
</ul>
</div>
<div class="position-relative"><h4><a id="bug-fixes-8.16.0"></a>Bug fixes</h4><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/security-docs/edit/8.x/docs/release-notes/8.16.asciidoc">edit</a></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Prevents an empty warning message from appearing for rule executions (<a href="https://github.com/elastic/kibana/pull/186096" class="ulink" target="_top">#186096</a>).
</li>
<li class="listitem">
Fixes an error that could occur during rule execution when the source index had a non-ECS-compliant text field (<a href="https://github.com/elastic/kibana/pull/187673" class="ulink" target="_top">#187673</a>).
</li>
<li class="listitem">
Fixes an issue that could cause fields for all indices to appear when you tried to add a rule filter (<a href="https://github.com/elastic/kibana/pull/194678" class="ulink" target="_top">#194678</a>).
</li>
<li class="listitem">
Removes unnecessary empty space below the title of the Open Timeline modal (<a href="https://github.com/elastic/kibana/pull/188837" class="ulink" target="_top">#188837</a>).
</li>
<li class="listitem">
Improves the performance of the Alerts table (<a href="https://github.com/elastic/kibana/pull/192827" class="ulink" target="_top">#192827</a>).
</li>
<li class="listitem">
Removes the requirement that you have unnecessary Kibana Fleet privileges to access some cloud security posture findings (<a href="https://github.com/elastic/kibana/pull/194069" class="ulink" target="_top">#194069</a>).
</li>
<li class="listitem">
Fixes an Elastic Defend bug where network event deduplication logic could incorrectly drop Linux network events.
</li>
<li class="listitem">
Fixes an Elastic Defend bug where Windows API events might be dropped if they contain Unicode characters that can&#8217;t be converted to ANSI.
</li>
<li class="listitem">
Ensures that Elastic Defend does not emit an empty <code class="literal">memory_region</code> if it can&#8217;t enrich a memory region in an API event. With this fix, Elastic Defend removes these fields.
</li>
<li class="listitem">
Fixes a bug where Elastic Defend could fail to properly enrich Windows API events for short-lived processes on older operating systems that don&#8217;t natively include this telemetry, such as Windows Server 2019. This might result in dropped or unattributed API events.
</li>
<li class="listitem">
Fixes a bug that prevented host name uniformity with Beats products. If you request Elastic Defend to use the fully qualified domain name (FQDN) in the <code class="literal">host.name</code> field, Elastic Defend now reports the FQDN exactly as the OS reports it, instead of lowercasing by default.
</li>
<li class="listitem">
Fixes an Elastic Defend bug in behavior protection alerts, where prevention alerts could mistakenly be labeled as detection alerts.
</li>
<li class="listitem">
Fixes a bug that caused Elastic Defend to crash if a Kafka connection is busy.
</li>
<li class="listitem">
Fixes a race condition that could allow an attacker with administrative rights to disable Elastic Defend on Windows. We would like to acknowledge Sean Moore (@Fr0g) at <a href="https://strafecybersecurity.com" class="ulink" target="_top">strafecybersecurity.com</a> for their assistance.
</li>
<li class="listitem">
Fixes scenarios where Automatic Import could generate invalid processors containing array access (<a href="https://github.com/elastic/kibana/pull/196207" class="ulink" target="_top">#196207</a>).
</li>
<li class="listitem">
Improves Timeline&#8217;s table performance when row renderers are switched on (<a href="https://github.com/elastic/kibana/pull/193316" class="ulink" target="_top">#193316</a>).
</li>
<li class="listitem">
Fixes misaligned filter control labels on the Alerts page (<a href="https://github.com/elastic/kibana/pull/192094" class="ulink" target="_top">#192094</a>).
</li>
</ul>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="release-notes-header-8.17.0.html">« 8.17</a>
</span>
<span class="next">
<a href="release-notes-header-8.15.0.html">8.15 »</a>
</span>
</div>
</body>
</html>
