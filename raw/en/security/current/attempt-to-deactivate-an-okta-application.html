<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Attempt to Deactivate an Okta Application | Elastic Security Solution [8.11] | Elastic</title>
<meta class="elastic" name="content" content="Attempt to Deactivate an Okta Application | Elastic Security Solution [8.11]">

<link rel="home" href="index.html" title="Elastic Security Solution [8.11]"/>
<link rel="up" href="prebuilt-rules.html" title="Prebuilt rule reference"/>
<link rel="prev" href="attempt-to-create-okta-api-token.html" title="Attempt to Create Okta API Token"/>
<link rel="next" href="attempt-to-deactivate-an-okta-network-zone.html" title="Attempt to Deactivate an Okta Network Zone"/>
<meta class="elastic" name="product_version" content="8.11"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.11"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.11"/>
</head>
<body>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [8.11]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="detection-engine-overview.html">Detections and alerts</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="prebuilt-rules.html">Prebuilt rule reference</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="attempt-to-create-okta-api-token.html">« Attempt to Create Okta API Token</a>
</span>
<span class="next">
<a href="attempt-to-deactivate-an-okta-network-zone.html">Attempt to Deactivate an Okta Network Zone »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="attempt-to-deactivate-an-okta-application"></a>Attempt to Deactivate an Okta Application<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.11/docs/detections/prebuilt-rules/rule-details/attempt-to-deactivate-an-okta-application.asciidoc">edit</a></h2>
</div></div></div>
<p>Detects attempts to deactivate an Okta application. An adversary may attempt to modify, deactivate, or delete an Okta application in order to weaken an organization&#8217;s security controls or disrupt their business operations.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
filebeat-*
</li>
<li class="listitem">
logs-okta*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: low</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 21</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5m</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: None (<a href="/guide/en/elasticsearch/reference/8.11/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule" title="Set the rule&#8217;s schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum alerts per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://help.okta.com/en/prod/Content/Topics/Apps/Apps_Apps.htm" class="ulink" target="_top">https://help.okta.com/en/prod/Content/Topics/Apps/Apps_Apps.htm</a>
</li>
<li class="listitem">
<a href="https://developer.okta.com/docs/reference/api/system-log/" class="ulink" target="_top">https://developer.okta.com/docs/reference/api/system-log/</a>
</li>
<li class="listitem">
<a href="https://developer.okta.com/docs/reference/api/event-types/" class="ulink" target="_top">https://developer.okta.com/docs/reference/api/event-types/</a>
</li>
<li class="listitem">
<a href="/security-labs/testing-okta-visibility-and-detection-dorothy" class="ulink" target="_top">https://www.elastic.co/security-labs/testing-okta-visibility-and-detection-dorothy</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Use Case: Identity and Access Audit
</li>
<li class="listitem">
Data Source: Okta
</li>
<li class="listitem">
Tactic: Impact
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 206</p>
<p><span class="strong strong"><strong>Rule authors</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Rule license</strong></span>: Elastic License v2</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_investigation_guide_72"></a>Investigation guide<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.11/docs/detections/prebuilt-rules/rule-details/attempt-to-deactivate-an-okta-application.asciidoc">edit</a></h3>
</div></div></div>
<div class="pre_wrapper lang-markdown">
<pre class="programlisting prettyprint lang-markdown">## Triage and analysis

### Investigating Attempt to Deactivate an Okta Application

This rule detects attempts to deactivate an Okta application. Unauthorized deactivation could lead to disruption of services and pose a significant risk to the organization.

#### Possible investigation steps:
- Identify the actor associated with the deactivation attempt by examining the `okta.actor.id`, `okta.actor.type`, `okta.actor.alternate_id`, and `okta.actor.display_name` fields.
- Determine the client used by the actor. Review the `okta.client.ip`, `okta.client.user_agent.raw_user_agent`, `okta.client.zone`, `okta.client.device`, and `okta.client.id` fields.
- If the client is a device, check the `okta.device.id`, `okta.device.name`, `okta.device.os_platform`, `okta.device.os_version`, and `okta.device.managed` fields.
- Understand the context of the event from the `okta.debug_context.debug_data` and `okta.authentication_context` fields.
- Check the `okta.outcome.result` and `okta.outcome.reason` fields to see if the attempt was successful or failed.
- Review the past activities of the actor involved in this action by checking their previous actions logged in the `okta.target` field.
- Analyze the `okta.transaction.id` and `okta.transaction.type` fields to understand the context of the transaction.
- Evaluate the actions that happened just before and after this event in the `okta.event_type` field to help understand the full context of the activity.

### False positive analysis:
- It might be a false positive if the action was part of a planned activity, performed by an authorized person, or if the `okta.outcome.result` field shows a failure.
- An unsuccessful attempt might also indicate an authorized user having trouble rather than a malicious activity.

### Response and remediation:
- If unauthorized deactivation attempts are confirmed, initiate the incident response process.
- Block the IP address or device used in the attempts if they appear suspicious, using the data from the `okta.client.ip` and `okta.device.id` fields.
- Reset the user's password and enforce MFA re-enrollment, if applicable.
- Conduct a review of Okta policies and ensure they are in accordance with security best practices.
- If the deactivated application was crucial for business operations, coordinate with the relevant team to reactivate it and minimize the impact.</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_rule_query_87"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.11/docs/detections/prebuilt-rules/rule-details/attempt-to-deactivate-an-okta-application.asciidoc">edit</a></h3>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.dataset:okta.system and event.action:application.lifecycle.deactivate</pre>
</div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Impact
</li>
<li class="listitem">
ID: TA0040
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0040/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0040/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Service Stop
</li>
<li class="listitem">
ID: T1489
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1489/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1489/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="attempt-to-create-okta-api-token.html">« Attempt to Create Okta API Token</a>
</span>
<span class="next">
<a href="attempt-to-deactivate-an-okta-network-zone.html">Attempt to Deactivate an Okta Network Zone »</a>
</span>
</div>
</div>
</body>
</html>
