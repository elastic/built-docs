<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>AWS S3 Unauthenticated Bucket Access by Rare Source | Elastic Security Solution [8.17] | Elastic</title>
<meta class="elastic" name="content" content="AWS S3 Unauthenticated Bucket Access by Rare Source | Elastic Security Solution [8.17]">

<link rel="home" href="index.html" title="Elastic Security Solution [8.17]"/>
<link rel="up" href="prebuilt-rules.html" title="Prebuilt rule reference"/>
<link rel="prev" href="aws-s3-object-versioning-suspended.html" title="AWS S3 Object Versioning Suspended"/>
<link rel="next" href="aws-sns-email-subscription-by-rare-user.html" title="AWS SNS Email Subscription by Rare User"/>
<meta class="elastic" name="product_version" content="8.17"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.17"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.17"/>
</head>
<body>
<div class="navheader">
<span class="prev">
<a href="aws-s3-object-versioning-suspended.html">« AWS S3 Object Versioning Suspended</a>
</span>
<span class="next">
<a href="aws-sns-email-subscription-by-rare-user.html">AWS SNS Email Subscription by Rare User »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [8.17]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="detection-engine-overview.html">Detections and alerts</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="prebuilt-rules.html">Prebuilt rule reference</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>AWS S3 Unauthenticated Bucket Access by Rare Source</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.17/docs/detections/prebuilt-rules/rule-details/aws-s3-unauthenticated-bucket-access-by-rare-source.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="aws-s3-unauthenticated-bucket-access-by-rare-source"></a>AWS S3 Unauthenticated Bucket Access by Rare Source</h2><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.17/docs/detections/prebuilt-rules/rule-details/aws-s3-unauthenticated-bucket-access-by-rare-source.asciidoc">edit</a></div>
</div></div></div>
<p>Identifies AWS CloudTrail events where an unauthenticated source is attempting to access an S3 bucket. This activity may indicate a misconfigured S3 bucket policy that allows public access to the bucket, potentially exposing sensitive data to unauthorized users. Adversaries can specify <code class="literal">--no-sign-request</code> in the AWS CLI to retrieve objects from an S3 bucket without authentication. This is a [New Terms](<a href="/guide/en/security/current/rules-ui-create.html#create-new-terms-rule" class="ulink" target="_top">https://www.elastic.co/guide/en/security/current/rules-ui-create.html#create-new-terms-rule</a>) rule, which means it will only trigger once for each unique value of the <code class="literal">source.address</code> field that has not been seen making this API request within the last 7 days. This field contains the IP address of the source making the request.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: new_terms</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
filebeat-*
</li>
<li class="listitem">
logs-aws.cloudtrail*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5m</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-9m (<a href="/guide/en/elasticsearch/reference/8.17/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule" title="Set the rule&#8217;s schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum alerts per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://hackingthe.cloud/aws/exploitation/Misconfigured_Resource-Based_Policies/exploting_public_resources_attack_playbook/" class="ulink" target="_top">https://hackingthe.cloud/aws/exploitation/Misconfigured_Resource-Based_Policies/exploting_public_resources_attack_playbook/</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Domain: Cloud
</li>
<li class="listitem">
Data Source: AWS
</li>
<li class="listitem">
Data Source: Amazon Web Services
</li>
<li class="listitem">
Data Source: Amazon S3
</li>
<li class="listitem">
Use Case: Asset Visibility
</li>
<li class="listitem">
Resources: Investigation Guide
</li>
<li class="listitem">
Tactic: Collection
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Rule authors</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Rule license</strong></span>: Elastic License v2</p>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_investigation_guide_82"></a>Investigation guide</h3><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.17/docs/detections/prebuilt-rules/rule-details/aws-s3-unauthenticated-bucket-access-by-rare-source.asciidoc">edit</a></div>
</div></div></div>
<p><span class="strong strong"><strong>Investigating AWS S3 Unauthenticated Bucket Access by Rare Source</strong></span></p>
<p>This rule detects requests to an AWS S3 bucket by an unauthenticated source, which could indicate a misconfigured bucket policy allowing public access. Adversaries can exploit this misconfiguration by using tools or AWS CLI options like <code class="literal">--no-sign-request</code> to access bucket contents.</p>
<p>The rule triggers when an unauthenticated IP address retrieves an object, and that IP has not been seen in the last 7 days.</p>
<p><span class="strong strong"><strong>Possible Investigation Steps</strong></span></p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p><span class="strong strong"><strong>Identify the Source of the Request</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Review the <code class="literal">source.address</code> field to determine the IP address of the request source.
</li>
<li class="listitem">
Check <code class="literal">source.geo</code> fields for geographic details of the originating IP address.
</li>
<li class="listitem">
Analyze the <code class="literal">user_agent.original</code> field to identify the client or tool used (e.g., <code class="literal">Python Requests</code>, <code class="literal">aws-cli</code>, browser).
</li>
</ul>
</div>
</li>
<li class="listitem">
<p><span class="strong strong"><strong>Review the Accessed Bucket and Object</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyze the <code class="literal">aws.cloudtrail.resources.arn</code> field to identify the S3 bucket and object being accessed.
</li>
<li class="listitem">
Inspect <code class="literal">aws.cloudtrail.request_parameters</code> for bucket name and object key to determine which file was retrieved.
</li>
<li class="listitem">
Review the <code class="literal">even.action</code> field to identify which API call was made (e.g., <code class="literal">GetObject</code>, <code class="literal">ListObjects</code>, <code class="literal">PutObject</code>, <code class="literal">ListBucket</code>).
</li>
</ul>
</div>
</li>
<li class="listitem">
<p><span class="strong strong"><strong>Validate the Source IP and Context</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Determine if the IP address (<code class="literal">source.address</code>) has any prior activity in your environment.
</li>
<li class="listitem">
Correlate the IP with threat intelligence or blocklist databases to check for malicious indicators.
</li>
<li class="listitem">
Review CloudTrail logs for other activities originating from the same IP.
</li>
</ul>
</div>
</li>
<li class="listitem">
<p><span class="strong strong"><strong>Analyze the S3 Bucket Configuration</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Review the S3 bucket&#8217;s Access Control List (ACL) and bucket policy to check for misconfigurations allowing public or unauthenticated access.
</li>
<li class="listitem">
Look for overly permissive settings, such as <code class="literal">Principal: *</code> or <code class="literal">Effect: Allow</code> rules that expose the bucket.
</li>
</ul>
</div>
</li>
<li class="listitem">
<p><span class="strong strong"><strong>Investigate Additional Activity</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Check if there are subsequent actions, such as:
</li>
<li class="listitem">
<span class="strong strong"><strong>Additional <code class="literal">GetObject</code> API calls</strong></span>: Indicating further data exfiltration.
</li>
<li class="listitem">
<span class="strong strong"><strong>ListObjects requests</strong></span>: Attempting to enumerate the bucket&#8217;s contents.
</li>
<li class="listitem">
Correlate events within the same timeframe to identify related suspicious activity.
</li>
</ul>
</div>
</li>
<li class="listitem">
<p><span class="strong strong"><strong>Assess the Data Exposed</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Identify the retrieved object(s) and analyze their content to assess potential data exposure.
</li>
<li class="listitem">
Determine if the file contains sensitive information, such as credentials, intellectual property, or PII.
</li>
</ul>
</div>
</li>
</ol>
</div>
<p><span class="strong strong"><strong>False Positive Analysis</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Public Buckets by Design</strong></span>: Some S3 buckets may intentionally allow public access. Verify with the bucket owner if the access was expected.
</li>
<li class="listitem">
<span class="strong strong"><strong>Automated Tools</strong></span>: Security scanners or legitimate services may generate <code class="literal">GetObject</code> events to validate bucket configurations.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Response and Remediation</strong></span></p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p><span class="strong strong"><strong>Immediate Action</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Restrict or remove public access to the affected S3 bucket.
</li>
<li class="listitem">
Update the bucket policy to ensure access is restricted to trusted principals.
</li>
<li class="listitem">
Enable <span class="strong strong"><strong>S3 Block Public Access</strong></span> settings to prevent unintended public access.
</li>
</ul>
</div>
</li>
<li class="listitem">
<p><span class="strong strong"><strong>Monitoring and Detection</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Enable detailed logging and monitoring for all S3 bucket activities.
</li>
<li class="listitem">
Configure real-time alerts for unauthenticated <code class="literal">GetObject</code> or <code class="literal">ListObjects</code> events on sensitive S3 buckets.
</li>
</ul>
</div>
</li>
<li class="listitem">
<p><span class="strong strong"><strong>Security Audits</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Regularly audit S3 bucket policies and ACLs to ensure they adhere to AWS security best practices.
</li>
<li class="listitem">
Use AWS tools like <span class="strong strong"><strong>Trusted Advisor</strong></span> or <span class="strong strong"><strong>Access Analyzer</strong></span> to identify and address misconfigurations.
</li>
</ul>
</div>
</li>
<li class="listitem">
<p><span class="strong strong"><strong>Investigate for Data Exfiltration</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Analyze historical CloudTrail logs to determine if other sensitive files were accessed or exfiltrated.
</li>
<li class="listitem">
Assess the scope of the exposure and initiate further response if sensitive data was compromised.
</li>
</ul>
</div>
</li>
</ol>
</div>
<p><span class="strong strong"><strong>Additional Resources</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/example-bucket-policies.html" class="ulink" target="_top">AWS Documentation: S3 Bucket Policy Best Practices</a>
</li>
<li class="listitem">
<a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/access-control-block-public-access.html" class="ulink" target="_top">AWS S3 Block Public Access</a>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_rule_query_94"></a>Rule query</h3><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.17/docs/detections/prebuilt-rules/rule-details/aws-s3-unauthenticated-bucket-access-by-rare-source.asciidoc">edit</a></div>
</div></div></div>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">event.dataset: "aws.cloudtrail"
    and event.provider: "s3.amazonaws.com"
    and event.action: (
        "GetObject" or
        "PutObject" or
        "ListObjects" or
        "DeleteObject" or
        "ListBucket")
    and event.outcome: "success"
    and aws.cloudtrail.user_identity.type: ("AWSAccount" or "Unknown")
    and cloud.account.id: "anonymous"</pre>
</div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Collection
</li>
<li class="listitem">
ID: TA0009
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0009/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0009/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Data from Cloud Storage
</li>
<li class="listitem">
ID: T1530
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1530/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1530/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Discovery
</li>
<li class="listitem">
ID: TA0007
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0007/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0007/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Cloud Storage Object Discovery
</li>
<li class="listitem">
ID: T1619
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1619/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1619/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Impact
</li>
<li class="listitem">
ID: TA0040
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0040/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0040/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Data Destruction
</li>
<li class="listitem">
ID: T1485
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1485/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1485/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="aws-s3-object-versioning-suspended.html">« AWS S3 Object Versioning Suspended</a>
</span>
<span class="next">
<a href="aws-sns-email-subscription-by-rare-user.html">AWS SNS Email Subscription by Rare User »</a>
</span>
</div>
</body>
</html>
