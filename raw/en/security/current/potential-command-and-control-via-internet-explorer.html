<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Potential Command and Control via Internet Explorer | Elastic Security Solution [8.6] | Elastic</title>
<link rel="home" href="index.html" title="Elastic Security Solution [8.6]"/>
<link rel="up" href="prebuilt-rules.html" title="Prebuilt rule reference"/>
<link rel="prev" href="potential-application-shimming-via-sdbinst.html" title="Potential Application Shimming via Sdbinst"/>
<link rel="next" href="potential-cookies-theft-via-browser-debugging.html" title="Potential Cookies Theft via Browser Debugging"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.6"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.6"/>
</head>
<body>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [8.6]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="detection-engine-overview.html">Detections and alerts</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="prebuilt-rules.html">Prebuilt rule reference</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="potential-application-shimming-via-sdbinst.html">« Potential Application Shimming via Sdbinst</a>
</span>
<span class="next">
<a href="potential-cookies-theft-via-browser-debugging.html">Potential Cookies Theft via Browser Debugging »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="potential-command-and-control-via-internet-explorer"></a>Potential Command and Control via Internet Explorer<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.6/docs/detections/prebuilt-rules/rule-details/potential-command-and-control-via-internet-explorer.asciidoc">edit</a></h2>
</div></div></div>
<p>Identifies instances of Internet Explorer (iexplore.exe) being started via the Component Object Model (COM) making unusual network connections. Adversaries could abuse Internet Explorer via COM to avoid suspicious processes making network connections and bypass host-based firewall restrictions.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: eql</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
winlogbeat-*
</li>
<li class="listitem">
logs-endpoint.events.*
</li>
<li class="listitem">
logs-windows.*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-9m (<a href="/guide/en/elasticsearch/reference/8.6/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule" title="Set the rule&#8217;s schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum alerts per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Host
</li>
<li class="listitem">
Windows
</li>
<li class="listitem">
Threat Detection
</li>
<li class="listitem">
Command and Control
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 100 (<a class="xref" href="potential-command-and-control-via-internet-explorer.html#potential-command-and-control-via-internet-explorer-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.11.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 8.5.0</p>
<p><span class="strong strong"><strong>Rule authors</strong></span>: Elastic</p>
<p><span class="strong strong"><strong>Rule license</strong></span>: Elastic License v2</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_potential_false_positives_247"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.6/docs/detections/prebuilt-rules/rule-details/potential-command-and-control-via-internet-explorer.asciidoc">edit</a></h3>
</div></div></div>
<p>Processes such as MS Office using IEproxy to render HTML content.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_rule_query_412"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.6/docs/detections/prebuilt-rules/rule-details/potential-command-and-control-via-internet-explorer.asciidoc">edit</a></h3>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">sequence by host.id, user.name with maxspan = 5s [library where
dll.name : "IEProxy.dll" and process.name : ("rundll32.exe",
"regsvr32.exe")] [process where event.type == "start" and
process.parent.name : "iexplore.exe" and process.parent.args :
"-Embedding"] /* IE started via COM in normal conditions makes few
connections, mainly to Microsoft and OCSP related domains, add FPs
here */ [network where network.protocol == "dns" and process.name :
"iexplore.exe" and not dns.question.name : (
"*.microsoft.com", "*.digicert.com", "*.msocsp.com",
"*.windowsupdate.com", "*.bing.com", "*.identrust.com",
"*.sharepoint.com", "*.office365.com", "*.office.com" )
] /* with runs=5 */</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_threat_mapping_405"></a>Threat mapping<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.6/docs/detections/prebuilt-rules/rule-details/potential-command-and-control-via-internet-explorer.asciidoc">edit</a></h3>
</div></div></div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Command and Control
</li>
<li class="listitem">
ID: TA0011
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0011/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0011/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Application Layer Protocol
</li>
<li class="listitem">
ID: T1071
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1071/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1071/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Execution
</li>
<li class="listitem">
ID: TA0002
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0002/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0002/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Inter-Process Communication
</li>
<li class="listitem">
ID: T1559
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1559/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1559/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="potential-command-and-control-via-internet-explorer-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.6/docs/detections/prebuilt-rules/rule-details/potential-command-and-control-via-internet-explorer.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 100 (8.5.0 release)
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Formatting only
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Version 6 (8.4.0 release)
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Formatting only
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Version 5 (8.1.0 release)
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Updated query, changed from:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">sequence by host.id, user.id with maxspan = 5s [library where
dll.name : "IEProxy.dll" and process.name : ("rundll32.exe",
"regsvr32.exe")] [process where event.type == "start" and
process.parent.name : "iexplore.exe" and process.parent.args :
"-Embedding"] /* IE started via COM in normal conditions makes few
connections, mainly to Microsoft and OCSP related domains, add FPs
here */ [network where network.protocol == "dns" and process.name :
"iexplore.exe" and not dns.question.name : (
"*.microsoft.com", "*.digicert.com", "*.msocsp.com",
"*.windowsupdate.com", "*.bing.com", "*.identrust.com",
"*.sharepoint.com", "*.office365.com", "*.office.com" )
]</pre>
</div>
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Version 4 (7.16.0 release)
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Formatting only
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Version 3 (7.13.0 release)
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Updated query, changed from:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">sequence by host.id, process.entity_id with maxspan = 1s [process
where event.type == "start" and process.parent.name : "iexplore.exe"
and process.parent.args : "-Embedding"] /* IE started via COM in
normal conditions makes few connections, mainly to Microsoft and OCSP
related domains, add FPs here */ [network where network.protocol ==
"dns" and process.name : "iexplore.exe" and not dns.question.name :
( "*.microsoft.com", "*.digicert.com", "*.msocsp.com",
"*.windowsupdate.com", "*.bing.com", "*.identrust.com" )
]</pre>
</div>
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Version 2 (7.12.0 release)
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Updated query, changed from:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">sequence by host.id, process.entity_id with maxspan = 1s [process
where event.type:"start" and process.parent.name:"iexplore.exe" and
process.parent.args:"-Embedding"] /* IE started via COM in normal
conditions makes few connections, mainly to Microsoft and OCSP related
domains, add FPs here */ [network where network.protocol : "dns" and
process.name:"iexplore.exe" and not wildcard(dns.question.name,
"*.microsoft.com",
"*.digicert.com", "*.msocsp.com",
"*.windowsupdate.com",
"*.bing.com", "*.identrust.com")
]</pre>
</div>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="potential-application-shimming-via-sdbinst.html">« Potential Application Shimming via Sdbinst</a>
</span>
<span class="next">
<a href="potential-cookies-theft-via-browser-debugging.html">Potential Cookies Theft via Browser Debugging »</a>
</span>
</div>
</div>
</body>
</html>
