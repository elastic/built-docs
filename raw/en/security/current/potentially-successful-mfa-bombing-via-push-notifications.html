<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Potentially Successful MFA Bombing via Push Notifications | Elastic Security Solution [8.14] | Elastic</title>
<meta class="elastic" name="content" content="Potentially Successful MFA Bombing via Push Notifications | Elastic Security Solution [8.14]">

<link rel="home" href="index.html" title="Elastic Security Solution [8.14]"/>
<link rel="up" href="prebuilt-rules.html" title="Prebuilt rule reference"/>
<link rel="prev" href="potential-privilege-escalation-via-cve-2022-38028.html" title="Potential privilege escalation via CVE-2022-38028"/>
<link rel="next" href="potentially-suspicious-process-started-via-tmux-or-screen.html" title="Potentially Suspicious Process Started via tmux or screen"/>
<meta class="elastic" name="product_version" content="8.14"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.14"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.14"/>
</head>
<body>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [8.14]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="detection-engine-overview.html">Detections and alerts</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="prebuilt-rules.html">Prebuilt rule reference</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="potential-privilege-escalation-via-cve-2022-38028.html">« Potential privilege escalation via CVE-2022-38028</a>
</span>
<span class="next">
<a href="potentially-suspicious-process-started-via-tmux-or-screen.html">Potentially Suspicious Process Started via tmux or screen »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="potentially-successful-mfa-bombing-via-push-notifications"></a>Potentially Successful MFA Bombing via Push Notifications<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.14/docs/detections/prebuilt-rules/rule-details/potentially-successful-mfa-bombing-via-push-notifications.asciidoc">edit</a></h2>
</div></div></div>
<p>Detects when an attacker abuses the Multi-Factor authentication mechanism by repeatedly issuing login requests until the user eventually accepts the Okta push notification. An adversary may attempt to bypass the Okta MFA policies configured for an organization to obtain unauthorized access.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: eql</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
filebeat-*
</li>
<li class="listitem">
logs-okta*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: high</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 73</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5m</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: None (<a href="/guide/en/elasticsearch/reference/8.14/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule" title="Set the rule&#8217;s schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum alerts per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://www.mandiant.com/resources/russian-targeting-gov-business" class="ulink" target="_top">https://www.mandiant.com/resources/russian-targeting-gov-business</a>
</li>
<li class="listitem">
<a href="/security-labs/testing-okta-visibility-and-detection-dorothy" class="ulink" target="_top">https://www.elastic.co/security-labs/testing-okta-visibility-and-detection-dorothy</a>
</li>
<li class="listitem">
<a href="https://sec.okta.com/articles/2023/08/cross-tenant-impersonation-prevention-and-detection" class="ulink" target="_top">https://sec.okta.com/articles/2023/08/cross-tenant-impersonation-prevention-and-detection</a>
</li>
<li class="listitem">
<a href="https://www.rezonate.io/blog/okta-logs-decoded-unveiling-identity-threats-through-threat-hunting/" class="ulink" target="_top">https://www.rezonate.io/blog/okta-logs-decoded-unveiling-identity-threats-through-threat-hunting/</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Use Case: Identity and Access Audit
</li>
<li class="listitem">
Tactic: Credential Access
</li>
<li class="listitem">
Data Source: Okta
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 209</p>
<p><span class="strong strong"><strong>Rule authors</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Rule license</strong></span>: Elastic License v2</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_investigation_guide_366"></a>Investigation guide<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.14/docs/detections/prebuilt-rules/rule-details/potentially-successful-mfa-bombing-via-push-notifications.asciidoc">edit</a></h3>
</div></div></div>
<p><span class="strong strong"><strong>Triage and analysis</strong></span></p>
<p><span class="strong strong"><strong>Investigating Potential Abuse of Repeated MFA Push Notifications</strong></span></p>
<p>Multi-Factor Authentication (MFA) is an effective method to prevent unauthorized access. However, some adversaries may abuse the system by repeatedly sending MFA push notifications until the user unwittingly approves the access.</p>
<p>This rule detects when a user denies MFA Okta Verify push notifications twice, followed by a successful authentication event within a 10-minute window. This sequence could indicate an adversary&#8217;s attempt to bypass the Okta MFA policy.</p>
<p><span class="strong strong"><strong>Possible investigation steps:</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Identify the user who received the MFA notifications by reviewing the <code class="literal">user.email</code> field.
</li>
<li class="listitem">
Identify the time, source IP, and geographical location of the MFA requests and the subsequent successful login.
</li>
<li class="listitem">
Review the <code class="literal">event.action</code> field to understand the nature of the events. It should include two <code class="literal">user.mfa.okta_verify.deny_push</code> actions and one <code class="literal">user.authentication.sso</code> action.
</li>
<li class="listitem">
Ask the user if they remember receiving the MFA notifications and subsequently logging into their account.
</li>
<li class="listitem">
Check if the MFA requests and the successful login occurred during the user&#8217;s regular activity hours.
</li>
<li class="listitem">
Look for any other suspicious activity on the account around the same time.
</li>
<li class="listitem">
Identify whether the same pattern is repeated for other users in your organization. Multiple users receiving push notifications simultaneously might indicate a larger attack.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>False positive analysis:</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Determine if the MFA push notifications were legitimate. Sometimes, users accidentally trigger MFA requests or deny them unintentionally and later approve them.
</li>
<li class="listitem">
Check if there are known issues with the MFA system causing false denials.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Response and remediation:</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If unauthorized access is confirmed, initiate your incident response process.
</li>
<li class="listitem">
Alert the user and your IT department immediately.
</li>
<li class="listitem">
If possible, isolate the user&#8217;s account until the issue is resolved.
</li>
<li class="listitem">
Investigate the source of the unauthorized access.
</li>
<li class="listitem">
If the account was accessed by an unauthorized party, determine the actions they took after logging in.
</li>
<li class="listitem">
Consider enhancing your MFA policy to prevent such incidents in the future.
</li>
<li class="listitem">
Encourage users to report any unexpected MFA notifications immediately.
</li>
<li class="listitem">
Review and update your incident response plans and security policies based on the findings from the incident.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_setup_514"></a>Setup<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.14/docs/detections/prebuilt-rules/rule-details/potentially-successful-mfa-bombing-via-push-notifications.asciidoc">edit</a></h3>
</div></div></div>
<p>The Okta Fleet integration, Filebeat module, or similarly structured data is required to be compatible with this rule.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_rule_query_703"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.14/docs/detections/prebuilt-rules/rule-details/potentially-successful-mfa-bombing-via-push-notifications.asciidoc">edit</a></h3>
</div></div></div>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">sequence by okta.actor.id with maxspan=10m
  [authentication where event.dataset == "okta.system" and event.module == "okta"
    and event.action == "user.mfa.okta_verify.deny_push"] with runs=3
  [authentication where event.dataset == "okta.system" and event.module == "okta"
    and (event.action : (
      "user.authentication.sso",
      "user.authentication.auth_via_mfa",
      "user.authentication.verify",
      "user.session.start") and okta.outcome.result == "SUCCESS")]</pre>
</div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Credential Access
</li>
<li class="listitem">
ID: TA0006
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0006/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0006/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Multi-Factor Authentication Request Generation
</li>
<li class="listitem">
ID: T1621
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1621/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1621/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="potential-privilege-escalation-via-cve-2022-38028.html">« Potential privilege escalation via CVE-2022-38028</a>
</span>
<span class="next">
<a href="potentially-suspicious-process-started-via-tmux-or-screen.html">Potentially Suspicious Process Started via tmux or screen »</a>
</span>
</div>
</div>
</body>
</html>
