<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>AWS S3 Bucket Server Access Logging Disabled | Elastic Security Solution [8.15] | Elastic</title>
<meta class="elastic" name="content" content="AWS S3 Bucket Server Access Logging Disabled | Elastic Security Solution [8.15]">

<link rel="home" href="index.html" title="Elastic Security Solution [8.15]"/>
<link rel="up" href="prebuilt-rule-8-15-1-prebuilt-rules-8-15-1-appendix.html" title="Appendix T: Downloadable rule update v8.15.1"/>
<link rel="prev" href="prebuilt-rule-8-15-1-active-directory-forced-authentication-from-linux-host-smb-named-pipes.html" title="Active Directory Forced Authentication from Linux Host - SMB Named Pipes"/>
<link rel="next" href="prebuilt-rule-8-15-1-aws-s3-bucket-replicated-to-another-account.html" title="AWS S3 Bucket Replicated to Another Account"/>
<meta class="elastic" name="product_version" content="8.15"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.15"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.15"/>
</head>
<body>
<div class="navheader">
<span class="prev">
<a href="prebuilt-rule-8-15-1-active-directory-forced-authentication-from-linux-host-smb-named-pipes.html">« Active Directory Forced Authentication from Linux Host - SMB Named Pipes</a>
</span>
<span class="next">
<a href="prebuilt-rule-8-15-1-aws-s3-bucket-replicated-to-another-account.html">AWS S3 Bucket Replicated to Another Account »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [8.15]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="prebuilt-rule-8-15-1-prebuilt-rules-8-15-1-appendix.html">Downloadable rule update v8.15.1</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>AWS S3 Bucket Server Access Logging Disabled</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.15/docs/detections/prebuilt-rules/downloadable-packages/8-15-1/prebuilt-rule-8-15-1-aws-s3-bucket-server-access-logging-disabled.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="prebuilt-rule-8-15-1-aws-s3-bucket-server-access-logging-disabled"></a>AWS S3 Bucket Server Access Logging Disabled<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.15/docs/detections/prebuilt-rules/downloadable-packages/8-15-1/prebuilt-rule-8-15-1-aws-s3-bucket-server-access-logging-disabled.asciidoc">edit</a></h2>
</div></div></div>
<p>Identifies when server access logging is disabled for an Amazon S3 bucket. Server access logs provide a detailed record of requests made to an S3 bucket. When server access logging is disabled for a bucket, it could indicate an adversary&#8217;s attempt to impair defenses by disabling logs that contain evidence of malicious activity.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: eql</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
filebeat-*
</li>
<li class="listitem">
logs-aws.cloudtrail*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5m</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-6m (<a href="/guide/en/elasticsearch/reference/8.15/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule" title="Set the rule&#8217;s schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum alerts per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://docs.aws.amazon.com/AmazonS3/latest/API/API_PutBucketLogging.html" class="ulink" target="_top">https://docs.aws.amazon.com/AmazonS3/latest/API/API_PutBucketLogging.html</a>
</li>
<li class="listitem">
<a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/enable-server-access-logging.html" class="ulink" target="_top">https://docs.aws.amazon.com/AmazonS3/latest/userguide/enable-server-access-logging.html</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Domain: Cloud
</li>
<li class="listitem">
Data Source: AWS
</li>
<li class="listitem">
Data Source: Amazon Web Services
</li>
<li class="listitem">
Data Source: Amazon S3
</li>
<li class="listitem">
Use Case: Asset Visibility
</li>
<li class="listitem">
Tactic: Defense Evasion
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Rule authors</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Rule license</strong></span>: Elastic License v2</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_investigation_guide_3215"></a>Investigation guide<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.15/docs/detections/prebuilt-rules/downloadable-packages/8-15-1/prebuilt-rule-8-15-1-aws-s3-bucket-server-access-logging-disabled.asciidoc">edit</a></h3>
</div></div></div>
<p><span class="strong strong"><strong>Triage and Analysis</strong></span></p>
<p><span class="strong strong"><strong>Investigating AWS S3 Bucket Server Access Logging Disabled</strong></span></p>
<p>This rule detects when server access logging is disabled for an S3 bucket in AWS. Such configurations could potentially hide evidence of unauthorized access or malicious activity by preventing the recording of those requests.</p>
<p><span class="strong strong"><strong>Detailed Investigation Steps</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Review the Affected S3 Bucket</strong></span>: Check the bucket details (<code class="literal">bucketName</code>) where server access logging has been disabled.
</li>
<li class="listitem">
Determine the contents and importance of the data stored in this bucket to assess the impact of disabled logging.
</li>
<li class="listitem">
<span class="strong strong"><strong>Review User Identity and Activity</strong></span>:
</li>
<li class="listitem">
Investigate the user (<code class="literal">user_identity.arn</code>) who made the change. Determine whether this user&#8217;s role typically involves managing S3 bucket configurations.
</li>
<li class="listitem">
Examine the authentication method and whether the access key used (<code class="literal">access_key_id</code>) is routinely used for such configurations or if it has deviated from normal usage patterns.
</li>
<li class="listitem">
Contact the account owner and confirm whether they are aware of this activity.
</li>
<li class="listitem">
Considering the source IP address and geolocation of the user who issued the command:
</li>
<li class="listitem">
Do they look normal for the calling user?
</li>
<li class="listitem">
If the source is an EC2 IP address, is it associated with an EC2 instance in one of your accounts or is the source IP from an EC2 instance that&#8217;s not under your control?
</li>
<li class="listitem">
If it is an authorized EC2 instance, is the activity associated with normal behavior for the instance role or roles? Are there any other alerts or signs of suspicious activity involving this instance?
</li>
<li class="listitem">
<span class="strong strong"><strong>Contextualize with Recent Changes</strong></span>: Compare this event against recent changes in S3 configurations. Look for any other recent permissions changes or unusual administrative actions.
</li>
<li class="listitem">
<span class="strong strong"><strong>Correlate with Other Activities</strong></span>: Search for related CloudTrail events before and after this change to see if the same actor or IP address engaged in other potentially suspicious activities.
</li>
<li class="listitem">
Assess whether this behavior is prevalent in the environment by looking for similar occurrences involving other users.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>False Positive Analysis</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Verify the operational requirements that might necessitate disabling access logging, especially in environments where data retention policies are strictly governed for compliance and cost-saving reasons.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Response and Remediation</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Immediate Review</strong></span>: If the change was unauthorized, consider reverting the change immediately to prevent potential data loss.
</li>
<li class="listitem">
<span class="strong strong"><strong>Enhance Monitoring</strong></span>: Implement monitoring to alert on changes to logging configurations across your S3 environments.
</li>
<li class="listitem">
<span class="strong strong"><strong>User Education</strong></span>: Ensure that users with access to critical resources like S3 buckets are aware of the best practices and company policies regarding data retention and security.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Additional Information</strong></span></p>
<p>For further guidance on monitoring Amazon S3 and ensuring compliance with organizational data retention and security policies, refer to the AWS official documentation on <a href="https://docs.aws.amazon.com/AmazonS3/latest/userguide/monitoring-overview.html" class="ulink" target="_top">Monitoring Amazon S3</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_rule_query_4659"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.15/docs/detections/prebuilt-rules/downloadable-packages/8-15-1/prebuilt-rule-8-15-1-aws-s3-bucket-server-access-logging-disabled.asciidoc">edit</a></h3>
</div></div></div>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">any where event.dataset == "aws.cloudtrail"
   and event.action == "PutBucketLogging"
   and event.outcome == "success"
   and not stringContains(aws.cloudtrail.request_parameters, "LoggingEnabled")</pre>
</div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Defense Evasion
</li>
<li class="listitem">
ID: TA0005
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0005/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0005/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Impair Defenses
</li>
<li class="listitem">
ID: T1562
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1562/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1562/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Sub-technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Disable or Modify Cloud Logs
</li>
<li class="listitem">
ID: T1562.008
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1562/008/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1562/008/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="prebuilt-rule-8-15-1-active-directory-forced-authentication-from-linux-host-smb-named-pipes.html">« Active Directory Forced Authentication from Linux Host - SMB Named Pipes</a>
</span>
<span class="next">
<a href="prebuilt-rule-8-15-1-aws-s3-bucket-replicated-to-another-account.html">AWS S3 Bucket Replicated to Another Account »</a>
</span>
</div>
</body>
</html>
