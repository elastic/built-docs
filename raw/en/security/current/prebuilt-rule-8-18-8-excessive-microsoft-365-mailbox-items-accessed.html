<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Excessive Microsoft 365 Mailbox Items Accessed | Elastic Security Solution [8.18] | Elastic</title>
<meta class="elastic" name="content" content="Excessive Microsoft 365 Mailbox Items Accessed | Elastic Security Solution [8.18]">

<link rel="home" href="index.html" title="Elastic Security Solution [8.18]"/>
<link rel="up" href="prebuilt-rule-8-18-8-prebuilt-rules-8-18-8-appendix.html" title="Appendix [: Downloadable rule update v8.18.8"/>
<link rel="prev" href="prebuilt-rule-8-18-8-forbidden-request-from-unusual-user-agent-in-kubernetes.html" title="Forbidden Request from Unusual User Agent in Kubernetes"/>
<link rel="next" href="prebuilt-rule-8-18-8-kubectl-network-configuration-modification.html" title="Kubectl Network Configuration Modification"/>
<meta class="elastic" name="product_version" content="8.18"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.18"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.18"/>
</head>
<body>
<div class="navheader">
<span class="prev">
<a href="prebuilt-rule-8-18-8-forbidden-request-from-unusual-user-agent-in-kubernetes.html">« Forbidden Request from Unusual User Agent in Kubernetes</a>
</span>
<span class="next">
<a href="prebuilt-rule-8-18-8-kubectl-network-configuration-modification.html">Kubectl Network Configuration Modification »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [8.18]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="prebuilt-rule-8-18-8-prebuilt-rules-8-18-8-appendix.html">Downloadable rule update v8.18.8</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Excessive Microsoft 365 Mailbox Items Accessed</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.18/docs/detections/prebuilt-rules/downloadable-packages/8-18-8/prebuilt-rule-8-18-8-excessive-microsoft-365-mailbox-items-accessed.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div id="url-to-v3" class="version-warning">
    A newer version is available. Check out the <a href="https://www.elastic.co/docs">latest documentation</a>.
</div>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="prebuilt-rule-8-18-8-excessive-microsoft-365-mailbox-items-accessed"></a>Excessive Microsoft 365 Mailbox Items Accessed</h2><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.18/docs/detections/prebuilt-rules/downloadable-packages/8-18-8/prebuilt-rule-8-18-8-excessive-microsoft-365-mailbox-items-accessed.asciidoc">edit</a></div>
</div></div></div>
<p>Identifies an excessive number of Microsoft 365 mailbox items accessed by a user either via aggregated counts or throttling. Microsoft audits mailbox access via the MailItemsAccessed event, which is triggered when a user accesses mailbox items. If more than 1000 mailbox items are accessed within a 24-hour period, it is then throttled. Excessive mailbox access may indicate an adversary attempting to exfiltrate sensitive information or perform reconnaissance on a target&#8217;s mailbox. This rule detects both the throttled and unthrottled events with a high threshold.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: query</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
filebeat-*
</li>
<li class="listitem">
logs-o365.audit-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5m</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-9m (<a href="/guide/en/elasticsearch/reference/8.18/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule" title="Set the rule&#8217;s schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum alerts per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://learn.microsoft.com/en-us/purview/audit-log-investigate-accounts#use-mailitemsaccessed-audit-records-for-forensic-investigations" class="ulink" target="_top">https://learn.microsoft.com/en-us/purview/audit-log-investigate-accounts#use-mailitemsaccessed-audit-records-for-forensic-investigations</a>
</li>
<li class="listitem">
<a href="https://www.microsoft.com/en-us/security/blog/2025/05/27/new-russia-affiliated-actor-void-blizzard-targets-critical-sectors-for-espionage/" class="ulink" target="_top">https://www.microsoft.com/en-us/security/blog/2025/05/27/new-russia-affiliated-actor-void-blizzard-targets-critical-sectors-for-espionage/</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Domain: Cloud
</li>
<li class="listitem">
Domain: Email
</li>
<li class="listitem">
Data Source: Microsoft 365
</li>
<li class="listitem">
Data Source: Microsoft 365 Audit Logs
</li>
<li class="listitem">
Use Case: Threat Detection
</li>
<li class="listitem">
Tactic: Collection
</li>
<li class="listitem">
Resources: Investigation Guide
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Rule authors</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Rule license</strong></span>: Elastic License v2</p>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_investigation_guide_4328"></a>Investigation guide</h3><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.18/docs/detections/prebuilt-rules/downloadable-packages/8-18-8/prebuilt-rule-8-18-8-excessive-microsoft-365-mailbox-items-accessed.asciidoc">edit</a></div>
</div></div></div>
<p><span class="strong strong"><strong>Triage and analysis</strong></span></p>
<p><span class="strong strong"><strong>Investigating Excessive Microsoft 365 Mailbox Items Accessed</strong></span></p>
<p>Identifies an excessive number of Microsoft 365 mailbox items accessed by a user either via aggregated counts or throttling. Microsoft audits mailbox access via the MailItemsAccessed event, which is triggered when a user accesses mailbox items. If more than 1000 mailbox items are accessed within a 24-hour period, it is then throttled. Excessive mailbox access may indicate an adversary attempting to exfiltrate sensitive information or perform reconnaissance on a target&#8217;s mailbox. This rule detects both the throttled and unthrottled events with a high threshold.</p>
<p><span class="strong strong"><strong>Possible investigation steps</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Review <code class="literal">host.name</code> to identify the tenant where the mailbox access occurred.
</li>
<li class="listitem">
Review <code class="literal">o365.audit.UserId</code> or <code class="literal">o365.audit.MailboxOwnerUPN</code> to identify the user associated with the mailbox access.
</li>
<li class="listitem">
Examine <code class="literal">o365.audit.ExternalAccess</code> to determine if the mailbox access was performed by an external user or application.
</li>
<li class="listitem">
Check the geolocation data to identify the location from which the mailbox access occurred. Is this an expected location for the user?
</li>
<li class="listitem">
Check <code class="literal">o365.audit.ClientAppId</code> to identify the application used for mailbox access. Look for any unusual or unexpected applications but be aware that some legitimate applications may also trigger this rule if OAuth phishing was used.
</li>
<li class="listitem">
Review <code class="literal">o365.audit.Folders.Path</code> and <code class="literal">o365.audit.Folders.FolderItems.Id</code> to identify the specific folders and items accessed within the mailbox. Look for any sensitive or high-value folders that may indicate targeted access.
</li>
<li class="listitem">
For specific items accessed, examine <code class="literal">o365.audit.Folders.FolderItems.Id</code> to gather more context on the accessed mailbox items.
</li>
<li class="listitem">
User types can be identified by checking <code class="literal">o365.audit.UserType</code>. Review if the mailbox of the user is a member, admin or delegate.
</li>
<li class="listitem">
If Entra ID logs are available, checking the risk status via <code class="literal">azure.signinlogs.properties.risk_state</code> and <code class="literal">azure.signinlogs.properties.risk_level</code> can provide additional context on the user&#8217;s risk status during the mailbox access.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>False positive analysis</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Legitimate users may access a large number of mailbox items in a short period, especially in environments with high email volume or during data migrations. If this is expected behavior, consider adjusting the rule or adding exceptions for specific users or groups.
</li>
<li class="listitem">
Automated processes or scripts that access mailbox items may also trigger this rule. If these processes are legitimate and necessary, consider adding exceptions for the specific applications or users involved.
</li>
<li class="listitem">
Users with high email activity, such as helpdesk or support roles, may trigger this rule due to their job responsibilities. If this is expected behavior, consider adjusting the rule or adding exceptions for specific users or groups.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Response and remediation</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Investigate the user account associated with the excessive mailbox access to determine if it has been compromised or if the activity is expected behavior.
</li>
<li class="listitem">
If the mailbox access is confirmed to be suspicious or unauthorized, take immediate action to revoke the access token and prevent further access.
</li>
<li class="listitem">
Disable the user account temporarily to prevent any potential compromise or unauthorized access.
</li>
<li class="listitem">
Review the user&#8217;s recent sign-in activity and access patterns to identify any potential compromise or unauthorized access.
</li>
<li class="listitem">
If the user account is compromised, initiate a password reset and enforce multi-factor authentication (MFA) for the user.
</li>
<li class="listitem">
Review the conditional access policies in place to ensure they are sufficient to prevent unauthorized access to sensitive resources.
</li>
<li class="listitem">
Examine how the mailbox access was performed. If it was done via a third-party application, review the permissions granted to that application and consider revoking them if they are not necessary.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_rule_query_5217"></a>Rule query</h3><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.18/docs/detections/prebuilt-rules/downloadable-packages/8-18-8/prebuilt-rule-8-18-8-excessive-microsoft-365-mailbox-items-accessed.asciidoc">edit</a></div>
</div></div></div>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">event.dataset: "o365.audit" and
    event.provider: "Exchange" and
    event.action: "MailItemsAccessed" and
    event.code: "ExchangeItemAggregated" and
    (
        (
            o365.audit.OperationProperties.Name: "IsThrottled" and
            o365.audit.OperationProperties.Value: "True"
        ) or o365.audit.OperationCount &gt;= 100
    )</pre>
</div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Collection
</li>
<li class="listitem">
ID: TA0009
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0009/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0009/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Email Collection
</li>
<li class="listitem">
ID: T1114
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1114/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1114/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Sub-technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Remote Email Collection
</li>
<li class="listitem">
ID: T1114.002
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1114/002/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1114/002/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="prebuilt-rule-8-18-8-forbidden-request-from-unusual-user-agent-in-kubernetes.html">« Forbidden Request from Unusual User Agent in Kubernetes</a>
</span>
<span class="next">
<a href="prebuilt-rule-8-18-8-kubectl-network-configuration-modification.html">Kubectl Network Configuration Modification »</a>
</span>
</div>
</body>
</html>
