<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Azure Storage Account Deletion by Unusual User | Elastic Security [8.19] | Elastic</title>
<meta class="elastic" name="content" content="Azure Storage Account Deletion by Unusual User | Elastic Security [8.19]">

<link rel="home" href="index.html" title="Elastic Security [8.19]"/>
<link rel="up" href="prebuilt-rule-8-19-9-prebuilt-rules-8-19-9-appendix.html" title="Appendix \: Downloadable rule update v8.19.9"/>
<link rel="prev" href="prebuilt-rule-8-19-9-azure-compute-restore-point-collections-deleted.html" title="Azure Compute Restore Point Collections Deleted"/>
<link rel="next" href="prebuilt-rule-8-19-9-azure-storage-account-deletions-by-user.html" title="Azure Storage Account Deletions by User"/>
<meta class="elastic" name="product_version" content="8.19"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.19"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.19"/>
</head>
<body>
<div class="navheader">
<span class="prev">
<a href="prebuilt-rule-8-19-9-azure-compute-restore-point-collections-deleted.html">« Azure Compute Restore Point Collections Deleted</a>
</span>
<span class="next">
<a href="prebuilt-rule-8-19-9-azure-storage-account-deletions-by-user.html">Azure Storage Account Deletions by User »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security [8.19]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="prebuilt-rule-8-19-9-prebuilt-rules-8-19-9-appendix.html">Downloadable rule update v8.19.9</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Azure Storage Account Deletion by Unusual User</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.19/docs/detections/prebuilt-rules/downloadable-packages/8-19-9/prebuilt-rule-8-19-9-azure-storage-account-deletion-by-unusual-user.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div id="url-to-v3" class="version-warning">
    <strong>IMPORTANT</strong>: This documentation is no longer updated. Refer to <a href="https://www.elastic.co/support/eol">Elastic's version policy</a> and the <a href="https://www.elastic.co/docs">latest documentation</a>.
</div>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="prebuilt-rule-8-19-9-azure-storage-account-deletion-by-unusual-user"></a>Azure Storage Account Deletion by Unusual User</h2><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.19/docs/detections/prebuilt-rules/downloadable-packages/8-19-9/prebuilt-rule-8-19-9-azure-storage-account-deletion-by-unusual-user.asciidoc">edit</a></div>
</div></div></div>
<p>Identifies when an Azure Storage Account is deleted. Adversaries may delete storage accounts to disrupt operations, destroy evidence, or cause denial of service. This activity could indicate an attacker attempting to cover their tracks after data exfiltration or as part of a destructive attack. Monitoring storage account deletions is critical for detecting potential impact on business operations and data availability.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: new_terms</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
logs-azure.activitylogs-*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5m</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-9m (<a href="/guide/en/elasticsearch/reference/8.19/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule" title="Set the rule&#8217;s schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum alerts per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="https://www.microsoft.com/en-us/security/blog/2025/08/27/storm-0501s-evolving-techniques-lead-to-cloud-based-ransomware/" class="ulink" target="_top">https://www.microsoft.com/en-us/security/blog/2025/08/27/storm-0501s-evolving-techniques-lead-to-cloud-based-ransomware/</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Domain: Cloud
</li>
<li class="listitem">
Domain: Storage
</li>
<li class="listitem">
Data Source: Azure
</li>
<li class="listitem">
Data Source: Azure Activity Logs
</li>
<li class="listitem">
Use Case: Threat Detection
</li>
<li class="listitem">
Tactic: Impact
</li>
<li class="listitem">
Resources: Investigation Guide
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 1</p>
<p><span class="strong strong"><strong>Rule authors</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Rule license</strong></span>: Elastic License v2</p>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_investigation_guide_4668"></a>Investigation guide</h3><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.19/docs/detections/prebuilt-rules/downloadable-packages/8-19-9/prebuilt-rule-8-19-9-azure-storage-account-deletion-by-unusual-user.asciidoc">edit</a></div>
</div></div></div>
<p><span class="strong strong"><strong>Triage and analysis</strong></span></p>
<p><span class="strong strong"><strong>Investigating Azure Storage Account Deletion by Unusual User</strong></span></p>
<p>Azure Storage Accounts provide scalable cloud storage for applications and services. Deletion of storage accounts is a high-impact operation that permanently removes all contained data including blobs, files, queues, and tables. Adversaries may delete storage accounts to destroy evidence of their activities, disrupt business operations, or cause denial of service as part of ransomware or destructive attacks. This detection monitors for successful storage account deletion operations to identify potential malicious activity.</p>
<p><span class="strong strong"><strong>Possible investigation steps</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Review the Azure activity logs to identify the user or service principal that initiated the storage account deletion by examining the principal ID, UPN and user agent fields.
</li>
<li class="listitem">
Check the specific storage account name in <code class="literal">azure.resource.name</code> to understand which storage resources were deleted and assess the business impact.
</li>
<li class="listitem">
Investigate the timing of the event to correlate with any other suspicious activities, such as unusual login patterns, privilege escalation attempts, or other resource deletions.
</li>
<li class="listitem">
Examine the user&#8217;s recent activity history to identify any other storage accounts or Azure resources that were deleted or modified by the same principal.
</li>
<li class="listitem">
Verify if the storage account deletion aligns with approved change requests or maintenance windows in your organization.
</li>
<li class="listitem">
Check if the deleted storage account contained critical data and whether backups are available for recovery.
</li>
<li class="listitem">
Review any related alerts or activities such as data exfiltration, configuration changes, or access policy modifications that occurred before the deletion.
</li>
<li class="listitem">
Investigate if the account was recently compromised by checking for suspicious authentication events or privilege escalations.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>False positive analysis</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Legitimate decommissioning of unused storage accounts may trigger this alert. Document approved storage account cleanup activities and coordinate with infrastructure teams to understand planned deletions.
</li>
<li class="listitem">
DevOps automation tools might delete temporary storage accounts as part of infrastructure lifecycle management. Identify service principals used by CI/CD pipelines and consider creating exceptions for these automated processes.
</li>
<li class="listitem">
Testing and development environments may have frequent storage account creation and deletion cycles. Consider filtering out non-production storage accounts if appropriate for your environment.
</li>
<li class="listitem">
Cost optimization initiatives may involve deleting unused or redundant storage accounts. Coordinate with finance and infrastructure teams to understand planned resource optimization activities.
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Response and remediation</strong></span></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Immediately investigate whether the deletion was authorized by verifying with the account owner or relevant stakeholders.
</li>
<li class="listitem">
If the deletion was unauthorized, attempt to recover the storage account if soft-delete is enabled, or restore data from backups.
</li>
<li class="listitem">
Disable the compromised user account or service principal if unauthorized activity is confirmed and investigate how the credentials were obtained.
</li>
<li class="listitem">
Review and restrict Azure RBAC permissions to ensure only authorized users have storage account deletion capabilities (requires Contributor or Owner role).
</li>
<li class="listitem">
Implement Azure Resource Locks to prevent accidental or malicious deletion of critical storage accounts.
</li>
<li class="listitem">
Configure Azure Activity Log alerts to notify security teams immediately when storage accounts are deleted.
</li>
<li class="listitem">
Conduct a full security assessment to identify any other compromised resources or accounts and look for indicators of broader compromise.
</li>
<li class="listitem">
Document the incident and update security policies and procedures to prevent similar incidents in the future.
</li>
</ul>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="_rule_query_5545"></a>Rule query</h3><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.19/docs/detections/prebuilt-rules/downloadable-packages/8-19-9/prebuilt-rule-8-19-9-azure-storage-account-deletion-by-unusual-user.asciidoc">edit</a></div>
</div></div></div>
<div class="pre_wrapper lang-js">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-js">event.dataset: azure.activitylogs and
    azure.activitylogs.operation_name: "MICROSOFT.STORAGE/STORAGEACCOUNTS/DELETE" and
    azure.activitylogs.identity.claims_initiated_by_user.name: *</pre>
</div>
<p><span class="strong strong"><strong>Framework</strong></span>: MITRE ATT&amp;CK<sup>TM</sup></p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Tactic:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Impact
</li>
<li class="listitem">
ID: TA0040
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/tactics/TA0040/" class="ulink" target="_top">https://attack.mitre.org/tactics/TA0040/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Data Destruction
</li>
<li class="listitem">
ID: T1485
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1485/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1485/</a>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Technique:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Name: Service Stop
</li>
<li class="listitem">
ID: T1489
</li>
<li class="listitem">
Reference URL: <a href="https://attack.mitre.org/techniques/T1489/" class="ulink" target="_top">https://attack.mitre.org/techniques/T1489/</a>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="prebuilt-rule-8-19-9-azure-compute-restore-point-collections-deleted.html">« Azure Compute Restore Point Collections Deleted</a>
</span>
<span class="next">
<a href="prebuilt-rule-8-19-9-azure-storage-account-deletions-by-user.html">Azure Storage Account Deletions by User »</a>
</span>
</div>
</body>
</html>
