<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Create and manage shared exception lists | Elastic Security Solution [8.6] | Elastic</title>
<link rel="home" href="index.html" title="Elastic Security Solution [8.6]"/>
<link rel="up" href="detections-ui-exceptions.html" title="Rule exceptions"/>
<link rel="prev" href="add-exceptions.html" title="Add and manage exceptions"/>
<link rel="next" href="building-block-rule.html" title="About building block rules"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/8.6"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="8.6"/>
</head>
<body>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [8.6]</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="detection-engine-overview.html">Detections and alerts</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="detections-ui-exceptions.html">Rule exceptions</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="add-exceptions.html">« Add and manage exceptions</a>
</span>
<span class="next">
<a href="building-block-rule.html">About building block rules »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="shared-exception-lists"></a>Create and manage shared exception lists<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.6/docs/detections/shared-exception-lists.asciidoc">edit</a></h2>
</div></div></div>
<p>Shared exception lists allow you to group exceptions together and then apply them to multiple rules. Use the Shared Exception Lists page to set up shared exception lists.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Exception lists created in 8.5 and earlier become shared exception lists in 8.6 or later. You can access all shared exception lists from the Shared Exception Lists page.</p>
</div>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="images/rule-exceptions-page.png" alt="Shared Exception Lists page">
</div>
</div>
<h4><a id="create-shared-exception-list"></a>Create shared exception lists<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.6/docs/detections/shared-exception-lists.asciidoc">edit</a></h4>
<p>Set up shared exception lists to contain exception items:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Go to <span class="strong strong"><strong>Manage</strong></span> &#8594; <span class="strong strong"><strong>Shared Exception Lists</strong></span>.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Create shared exception list</strong></span> &#8594; <span class="strong strong"><strong>Create shared list</strong></span>.
</li>
<li class="listitem">
Give the shared exception list a name.
</li>
<li class="listitem">
(Optional) Provide a description.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Create shared exception list</strong></span>.
</li>
</ol>
</div>
<h4><a id="add-exception-items"></a>Add exception items to shared exception lists<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.6/docs/detections/shared-exception-lists.asciidoc">edit</a></h4>
<p>Add exception items:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Go to <span class="strong strong"><strong>Manage</strong></span> &#8594; <span class="strong strong"><strong>Shared Exception Lists</strong></span>.
</li>
<li class="listitem">
<p>Click <span class="strong strong"><strong>Create shared exception list</strong></span> &#8594; <span class="strong strong"><strong>Create exception item</strong></span>.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>You can add exceptions to an empty shared exception list by expanding the list, or viewing its details page and clicking <span class="strong strong"><strong>Create rule exception</strong></span>. After creating an exception, you can associate the shared exception list with rules. Refer to <a class="xref" href="shared-exception-lists.html#link-shared-exception-lists" title="Associate shared exception lists with rules">Associate shared exception lists with rules</a> to learn more.</p>
</div>
</div>
</li>
<li class="listitem">
<p>In the <span class="strong strong"><strong>Add rule exception</strong></span> flyout, name the exception item and add conditions that define when the exception prevents alerts. When the exception&#8217;s query conditions are met (the query evaluates to <code class="literal">true</code>), rules do not generate alerts even when other rule criteria are met.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<span class="strong strong"><strong>Field</strong></span>: Select a field to identify the event being filtered.
</li>
<li class="listitem">
<p><span class="strong strong"><strong>Operator</strong></span>: Select an operator to define the condition:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">is</code> | <code class="literal">is not</code> — Must be an exact match of the defined value.
</li>
<li class="listitem">
<code class="literal">is one of</code> | <code class="literal">is not one of</code> — Matches any of the defined values.
</li>
<li class="listitem">
<code class="literal">exists</code> | <code class="literal">does not exist</code> — The field exists.
</li>
<li class="listitem">
<p><code class="literal">is in list</code> | <code class="literal">is not in list</code> — Matches values in a value list.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
An exception defined by a value list must use <code class="literal">is in list</code> or <code class="literal">is not in list</code> in all conditions.
</li>
<li class="listitem">
Wildcards are not supported in value lists.
</li>
<li class="listitem">
If a value list can&#8217;t be used due to <a class="xref" href="value-lists-exceptions.html#manage-value-lists" title="Create value lists">size or data type</a>, it&#8217;ll be unavailable in the <span class="strong strong"><strong>Value</strong></span> menu.
</li>
</ul>
</div>
</div>
</div>
</li>
<li class="listitem">
<p><code class="literal">matches</code> | <code class="literal">does not match</code> — Allows you to use wildcards in <span class="strong strong"><strong>Value</strong></span>, such as <code class="literal">C:\path\*\app.exe</code>. Available wildcards are <code class="literal">?</code> (match one character) and <code class="literal">*</code> (match zero or more characters). The selected <span class="strong strong"><strong>Field</strong></span> data type must be <a href="/guide/en/elasticsearch/reference/8.6/keyword.html#keyword-field-type" class="ulink" target="_top">keyword</a>, <a href="/guide/en/elasticsearch/reference/8.6/text.html#text-field-type" class="ulink" target="_top">text</a>, or <a href="/guide/en/elasticsearch/reference/8.6/keyword.html#wildcard-field-type" class="ulink" target="_top">wildcard</a>.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Using wildcards can impact performance. To create a more efficient exception using wildcards, use multiple conditions and make them as specific as possible. For example, adding conditions using <code class="literal">process.name</code> or <code class="literal">file.name</code> can help limit the scope of wildcard matching.</p>
</div>
</div>
</li>
</ul>
</div>
</li>
<li class="listitem">
<span class="strong strong"><strong>Value</strong></span>: Enter the value associated with the <span class="strong strong"><strong>Field</strong></span>. To enter multiple values (when using <code class="literal">is one of</code> or <code class="literal">is not one of</code>), enter each value, then press <span class="strong strong"><strong>Return</strong></span>.
</li>
</ol>
</div>
</li>
<li class="listitem">
Click <span class="strong strong"><strong>AND</strong></span> or <span class="strong strong"><strong>OR</strong></span> to create multiple conditions and define their relationships.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Add nested condition</strong></span> to create conditions using nested fields. This is only required for
<a class="xref" href="add-exceptions.html#nested-field-list">these nested fields</a>. For all other fields, nested conditions should not be used.
</li>
<li class="listitem">
<p>Choose to add the exception to shared exception lists.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This option will be unavailable if a shared exception list doesn&#8217;t exist. In addition, you can&#8217;t add an endpoint exception item to the Endpoint Security Exception List from this UI. Refer to <a class="xref" href="add-exceptions.html#endpoint-rule-exceptions" title="Add Elastic Endpoint exceptions">Add Elastic Endpoint exceptions</a> for instructions about creating endpoint exceptions.</p>
</div>
</div>
</li>
<li class="listitem">
(Optional) Enter a comment describing the exception.
</li>
<li class="listitem">
(Optional) <span class="strong strong"><strong>Close all alerts that match this exception and were generated by this rule</strong></span>:
Closes all alerts that match the exception&#8217;s conditions and were generated only by the current rule.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Add rule exception</strong></span>.
</li>
</ol>
</div>
<h4><a id="link-shared-exception-lists"></a>Associate shared exception lists with rules<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.6/docs/detections/shared-exception-lists.asciidoc">edit</a></h4>
<p>Apply shared exception lists to rules:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Go to <span class="strong strong"><strong>Manage</strong></span> &#8594; <span class="strong strong"><strong>Shared Exception Lists</strong></span>.
</li>
<li class="listitem">
<p>Do one of the following:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Select a shared exception list&#8217;s name to open its details page, then click <span class="strong strong"><strong>Manage rules</strong></span>.
</li>
<li class="listitem">
Find the shared exception list you want to assign to rules, then click <span class="strong strong"><strong>More actions</strong></span> (<span class="strong strong"><strong>&#8230;&#8203;</strong></span>) &#8594; <span class="strong strong"><strong>Manage rules</strong></span>.
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Click the toggles in the <span class="strong strong"><strong>Link</strong></span> column to select the rules you want to link to the exception list.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>If you know a rule&#8217;s name, you can enter it into the search bar.</p>
</div>
</div>
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Save</strong></span>.
</li>
<li class="listitem">
<p>(Optional) To verify that the shared exception list was added to the rules you selected:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Open a rule’s details page (<span class="strong strong"><strong>Manage → Rules → <em>Rule name</em></strong></span>).
</li>
<li class="listitem">
Scroll down the page, and then select the <span class="strong strong"><strong>Rule exceptions</strong></span> tab.
</li>
<li class="listitem">
<p>Navigate to the exception items that are included in the shared exception list. Click the <span class="strong strong"><strong>Affects shared list</strong></span> link to view the associated shared exception lists.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/associated-shared-exception-list.png" alt="Associated shared exceptions">
</div>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
<h4><a id="view-shared-exception-lists"></a>View and filter exception lists<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.6/docs/detections/shared-exception-lists.asciidoc">edit</a></h4>
<p>The Shared Exception Lists page displays each shared exception list on an individual row, with the most recently created list at the top. Each row contains these details about the shared exception list:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Shared exception list name
</li>
<li class="listitem">
Date the list was created
</li>
<li class="listitem">
Username of the user who created the list
</li>
<li class="listitem">
Number of exception items in the shared exception list
</li>
<li class="listitem">
Number of rules the shared exception list affects
</li>
</ul>
</div>
<p>To view the details of an exception item within a shared exception list, expand a row.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/view-filter-shared-exception.png" alt="Associated shared exceptions">
</div>
</div>
<p>To filter exception lists by a specific value, enter a value in the search bar. You can search the following attributes:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">name</code>
</li>
<li class="listitem">
<code class="literal">list_id</code>
</li>
<li class="listitem">
<code class="literal">created_by</code>
</li>
</ul>
</div>
<p>If no attribute is selected, the app searches the list name by default.</p>
<h4><a id="manage-exception-lists"></a>Manage shared exception lists<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/8.6/docs/detections/shared-exception-lists.asciidoc">edit</a></h4>
<p>You can edit, export, import, and delete shared exception lists from the Shared Exception Lists page.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Exception lists created in 8.5 and earlier become shared exception lists in 8.6 or later. You can access all shared exception lists from the Shared Exception Lists page.</p>
</div>
</div>
<p>To export or delete an exception list, select the required action button on the appropriate list. Note the following:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Exception lists are exported to <code class="literal">.ndjson</code> files.
</li>
<li class="listitem">
Exception lists are also exported as part of any exported detection rules configured with exceptions. Refer to <a class="xref" href="rules-ui-management.html#import-export-rules-ui" title="Export and import rules">Export and import rules</a>.
</li>
<li class="listitem">
If an exception list is linked to any rules, you&#8217;ll get a warning asking you to confirm the deletion.
</li>
</ul>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="images/actions-exception-list.png" alt="Detail of Exception lists table with export and delete buttons highlighted">
</div>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="add-exceptions.html">« Add and manage exceptions</a>
</span>
<span class="next">
<a href="building-block-rule.html">About building block rules »</a>
</span>
</div>
</div>
</body>
</html>
