<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>About detection rules | Elastic Security Solution [master] | Elastic</title>
<meta class="elastic" name="content" content="About detection rules | Elastic Security Solution [master]">

<link rel="home" href="index.html" title="Elastic Security Solution [master]"/>
<link rel="up" href="detection-engine-overview.html" title="Detections and alerts"/>
<link rel="prev" href="detection-engine-overview.html" title="Detections and alerts"/>
<link rel="next" href="rules-ui-create.html" title="Create a detection rule"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/master"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="master"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
This documentation contains work-in-progress information for future Elastic Stack and Cloud releases. Use the version selector to view supported release docs. It also contains some Elastic Cloud serverless information. Check out our <a href="https://www.elastic.co/docs/current/serverless">serverless docs</a> for more details.
</div>
<div class="navheader">
<span class="prev">
<a href="detection-engine-overview.html">« Detections and alerts</a>
</span>
<span class="next">
<a href="rules-ui-create.html">Create a detection rule »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [master]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="detection-engine-overview.html">Detections and alerts</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>About detection rules</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/detections/about-rules.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="chapter xpack">
<div class="titlepage"><div><div>
<h2 class="title"><a id="about-rules"></a>About detection rules<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/detections/about-rules.asciidoc">edit</a></h2>
</div></div></div>
<p>Rules run periodically and search for source events, matches, sequences, or machine learning job anomaly results
that meet their criteria. When a rule&#8217;s criteria are met, a detection alert is
created.</p>
<h3><a id="rule-types"></a>Rule types<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/detections/about-rules.asciidoc">edit</a></h3>
<p>You can create the following types of rules:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="rules-ui-create.html#create-custom-rule" title="Create a custom query rule"><span class="strong strong"><strong>Custom query</strong></span></a>: Query-based rule, which searches the defined indices and
creates an alert when one or more documents match the rule&#8217;s query.
</li>
<li class="listitem">
<p><a class="xref" href="rules-ui-create.html#create-ml-rule" title="Create a machine learning rule"><span class="strong strong"><strong>Machine learning</a></strong></span>: Machine learning rule, which creates an alert when a machine learning job
discovers an anomaly above the defined threshold (see <a class="xref" href="machine-learning.html" title="Anomaly detection">Anomaly detection</a>).</p>
<p>For machine learning rules, the associated machine learning job must be running. If the machine learning job isn&#8217;t
running, the rule will:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Run and create alerts if existing anomaly results with scores above the defined threshold
are discovered.
</li>
<li class="listitem">
Issue an error stating the machine learning job was not running when the rule executed.
</li>
</ul>
</div>
</li>
<li class="listitem">
<p><a class="xref" href="rules-ui-create.html#create-threshold-rule" title="Create a threshold rule"><span class="strong strong"><strong>Threshold</strong></span></a>: Searches the defined indices and creates a detections alert
when the number of times the specified field&#8217;s value is present and meets the threshold during
a single execution. When multiple values meet the threshold, an alert is
generated for each value.</p>
<p>For example, if the threshold <code class="literal">field</code> is <code class="literal">source.ip</code> and its <code class="literal">value</code> is <code class="literal">10</code>, an
alert is generated for every source IP address that appears in at least 10 of
the rule&#8217;s search results.</p>
</li>
<li class="listitem">
<a class="xref" href="rules-ui-create.html#create-eql-rule" title="Create an event correlation rule"><span class="strong strong"><strong>Event correlation</strong></span></a>: Searches the defined indices and creates an alert when results match an
<a href="/guide/en/elasticsearch/reference/master/eql.html" class="ulink" target="_top">Event Query Language (EQL)</a> query.
</li>
<li class="listitem">
<p><a class="xref" href="rules-ui-create.html#create-indicator-rule" title="Create an indicator match rule"><span class="strong strong"><strong>Indicator match</strong></span></a>: Creates an alert when Elastic Security index field values match field values defined in the specified indicator index patterns. For example, you can create an indicator index for IP addresses and use this index to create an alert whenever an event&#8217;s <code class="literal">destination.ip</code> equals a value in the index. Indicator index field mappings should be <a href="/guide/en/ecs/8.11" class="ulink" target="_top">ECS-compliant</a>. For information on creating Elasticsearch indices and field types, see
<a href="/guide/en/elasticsearch/reference/master/getting-started-index.html" class="ulink" target="_top">Index some documents</a>,
<a href="/guide/en/elasticsearch/reference/master/indices-create-index.html" class="ulink" target="_top">Create index API</a>, and
<a href="/guide/en/elasticsearch/reference/master/mapping-types.html" class="ulink" target="_top">Field data types</a>. If you have indicators in a standard file format, such as CSV or JSON, you can also use the Machine Learning Data Visualizer to import your indicators into an indicator index. See <a href="/guide/en/machine-learning/master/ml-getting-started.html#sample-data-visualizer" class="ulink" target="_top">Explore the data in Kibana</a> and use the <span class="strong strong"><strong>Import Data</strong></span> option to import your indicators.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>You can also use value lists as the indicator match index. See <a class="xref" href="rules-ui-create.html#indicator-value-lists" title="Use value lists with indicator match rules">Use value lists with indicator match rules</a> at the end of this topic for more information.</p>
</div>
</div>
</li>
<li class="listitem">
<a class="xref" href="rules-ui-create.html#create-new-terms-rule" title="Create a new terms rule"><span class="strong strong"><strong>New terms</strong></span></a>: Generates an alert for each new term detected in source documents within a specified time range. You can also detect a combination of up to three new terms (for example, a <code class="literal">host.ip</code> and <code class="literal">host.id</code> that have never been observed together before).
</li>
<li class="listitem">
<p><a class="xref" href="rules-ui-create.html#create-esql-rule" title="Create an ES|QL rule"><span class="strong strong"><strong>ES|QL</strong></span></a>: Searches the defined indices and creates an alert when results match an <a href="/guide/en/elasticsearch/reference/master/esql.html" class="ulink" target="_top">Elasticsearch Query Language (ES|QL)</a> query.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>ES|QL is enabled by default in Kibana. It can be
disabled using the <code class="literal">enableESQL</code> setting from the
<a href="/guide/en/kibana/master/advanced-options.html" class="ulink" target="_top">Advanced Settings</a>. This will hide the ES|QL user interface from various applications. However, users will be able to access existing ES|QL artifacts like saved searches and visualizations.</p>
</div>
</div>
</li>
</ul>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="images/all-rules.png" alt="Shows the Rules page">
</div>
</div>
<h3><a id="views-index-patterns"></a>Data views and index patterns<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/detections/about-rules.asciidoc">edit</a></h3>
<p>When you create a rule, you must either specify the Elasticsearch index pattens for which you&#8217;d like the rule to run, or select a <a class="xref" href="data-views-in-sec.html" title="Data views in Elastic Security">data view field</a> as the data source. If you select a data view, you can select <a class="xref" href="runtime-fields.html" title="Create runtime fields in Elastic Security">runtime fields</a> associated with that data view to create a query for the rule (with the exception of machine learning rules, which do not use queries).</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>To access data views, ensure you have the <a href="/guide/en/kibana/master/data-views.html#data-views-read-only-access" class="ulink" target="_top">required permissions</a>.</p>
</div>
</div>
<h3><a id="about-notifications"></a>Notifications<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/detections/about-rules.asciidoc">edit</a></h3>
<p>For both prebuilt and custom rules, you can send notifications when alerts are created. Notifications can be sent via Jira, Microsoft Teams, PagerDuty, Slack, and others, and can be configured when you create or edit a rule.</p>
<h3><a id="alerting-authorization-model"></a>Authorization<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/detections/about-rules.asciidoc">edit</a></h3>
<p>Rules, including all background detection and the actions they generate, are authorized using an <a href="/guide/en/kibana/master/api-keys.html" class="ulink" target="_top">API key</a> associated with the last user to edit the rule. Upon creating or modifying a rule, an API key is generated for that user, capturing a snapshot of their privileges. The API key is then used to run all background tasks associated with the rule including detection checks and executing actions.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>If a rule requires certain privileges to run, such as index privileges, keep in mind that if a user without those privileges updates the rule, the rule will no longer function.</p>
</div>
</div>
<h3><a id="about-exceptions"></a>Exceptions<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/detections/about-rules.asciidoc">edit</a></h3>
<p>When modifying rules or managing detection alerts, you can <a class="xref" href="add-exceptions.html" title="Add and manage exceptions">add exceptions</a> that prevent a rule from generating alerts even when its criteria are met. This is useful for reducing noise, such as preventing alerts from trusted processes and internal IP addresses.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>You can add exceptions to custom query, machine learning, event correlation, and indicator match rule types.</p>
</div>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="detection-engine-overview.html">« Detections and alerts</a>
</span>
<span class="next">
<a href="rules-ui-create.html">Create a detection rule »</a>
</span>
</div>
</body>
</html>
