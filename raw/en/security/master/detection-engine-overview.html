<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Detections and Alerts (beta) | Elastic Security Solution [master] | Elastic</title>
<link rel="home" href="index.html" title="Elastic Security Solution [master]"/>
<link rel="up" href="index.html" title="Elastic Security Solution [master]"/>
<link rel="prev" href="tuning-anomaly-results.html" title="Optimizing anomaly results"/>
<link rel="next" href="rules-ui-create.html" title="Creating detection rules"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/master"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="master"/>
</head>
<body><div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [master]</a></span>
»
<span class="breadcrumb-node">Detections and Alerts (beta)</span>
</div>
<div class="navheader">
<span class="prev">
<a href="tuning-anomaly-results.html">« Optimizing anomaly results</a>
</span>
<span class="next">
<a href="rules-ui-create.html">Creating detection rules »</a>
</span>
</div>
<div class="part xpack">
<div class="titlepage"><div><div>
<h1 class="title"><a id="detection-engine-overview"></a>Detections and Alerts (beta)<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/detections/detection-engine-intro.asciidoc">edit</a><a class="xpack_tag" href="/subscriptions"></a></h1>
</div></div></div>
<div class="openblock partintro">
<div class="content">
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in beta and is subject to change. The design and code is less mature than official GA features and is being provided as-is with no warranties. Beta features are not subject to the support SLA of official GA features.</p>
</div>
</div>
<p>Use the Detections feature to create and manage rules, and view the alerts
these rules create. Rules periodically search indices (such as <code class="literal">endgame-*</code> and
<code class="literal">filebeat-*</code>) for suspicious source events, and create alerts when a rule&#8217;s
conditions are met. When an alert is created, its status is <code class="literal">Open</code>. To help
track investigations, an alert&#8217;s status can be set as <code class="literal">Open</code>, <code class="literal">In progress</code>, or
<code class="literal">Closed</code> (see <a class="xref" href="alerts-ui-manage.html#detection-alert-status" title="Change alert statuses">Change alert statuses</a>).</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/detections-ui.png" alt="detections ui">
</div>
</div>
<p>In addition to creating <a class="xref" href="rules-ui-create.html" title="Creating detection rules">your own rules</a>, enable
<a class="xref" href="rules-ui-management.html#load-prebuilt-rules" title="Load and activate prebuilt Elastic rules">Elastic prebuilt rules</a> to immediately start detecting
suspicious activity. For detailed information on all the prebuilt rules, see the
<a class="xref" href="prebuilt-rules.html" title="Prebuilt rule reference"><em>Prebuilt rule reference</em></a> section. Once the prebuilt rules are loaded and
running, <a class="xref" href="tuning-detection-signals.html" title="Tuning prebuilt detection rules"><em>Tuning prebuilt detection rules</em></a> and <a class="xref" href="detections-ui-exceptions.html" title="Rule exceptions and value lists"><em>Rule exceptions and value lists</em></a> explain
how to modify the rules to reduce false positives and get a better set of
actionable alerts. You can also use exceptions and value lists when creating or
modifying your own rules.</p>
<p>There are two special prebuilt rules you need to know about:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p><a class="xref" href="elastic-endpoint-security.html" title="Elastic Endpoint Security"><span class="strong strong"><strong>Elastic Endpoint Security</strong></span></a>:
Automatically creates an alert from all incoming Elastic Endpoint alerts. To
receive Elastic Endpoint alerts, you must install the Endpoint agent on your
hosts (see <a class="xref" href="install-endpoint.html" title="Configure and install Elastic Endpoint Integration (beta)"><em>Configure and install Elastic Endpoint Integration (beta)</em></a>).</p>
<p>When this rule is enabled, the following Endpoint events are displayed as
detection alerts:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Malware Prevention Alert
</li>
<li class="listitem">
<p>Malware Detection Alert</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>When you load the prebuilt rules, this is the only rule that is enabled
by default.</p>
</div>
</div>
</li>
</ul>
</div>
</li>
<li class="listitem">
<a class="xref" href="external-alerts.html" title="External Alerts"><span class="strong strong"><strong>External Alerts</strong></span></a>: Automatically creates an alert for
all incoming third-party system alerts (for example, Suricata alerts).
</li>
</ul>
</div>
<p>If you want to receive notifications via external systems, such as Slack or
email, when alerts are created, use the Kibana
<a href="/guide/en/kibana/master/alerting-getting-started.html" class="ulink" target="_top">Alerting and Actions</a> framework.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>To use Kibana Alerting for detection alert notifications, you need the
<a href="/subscriptions" class="ulink" target="_top">appropriate license</a>.</p>
</div>
</div>
<p>After rules have started running, you can monitor their executions to verify
they are functioning correctly, as well as view, manage, and troubleshoot
alerts (see <a class="xref" href="alerts-ui-manage.html" title="Managing detection alerts"><em>Managing detection alerts</em></a> and <a class="xref" href="alerts-ui-monitor.html" title="Monitoring and troubleshooting rule executions"><em>Monitoring and troubleshooting rule executions</em></a>).</p>
<p>You can create and manage rules and alerts via the UI or the
<a class="xref" href="rule-api-overview.html" title="Detections API">Detections API</a>.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>To make sure you can access Detections and manage rules, see
<a class="xref" href="detections-permissions-section.html" title="Detections prerequisites and requirements">Detections prerequisites and requirements</a>.</p>
</div>
</div>
<h2><a id="det-engine-terminology"></a>Terminology<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/detections/detection-engine-intro.asciidoc">edit</a></h2>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Actions
</span>
</dt>
<dd>
Sends notifications via other systems when a detection alert is created, such
as email, Slack, PagerDuty, and Webhook.
</dd>
</dl>
</div>
<div class="variablelist">
<a id="detection-alert-def"></a>
<dl class="variablelist">
<dt>
<span class="term">
Detection alerts
</span>
</dt>
<dd>
<p>
Elastic Security produced alerts. Detection alerts are never received from external
systems. When a rule&#8217;s conditions are met, Elastic Security writes a detection alert to
an Elasticsearch <code class="literal">.signals</code> index.
</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Detection alert indices are created for each Kibana space. The naming convention
is: <code class="literal">.siem-signals-&lt;space name&gt;</code>. For the default space, the alerts index is
named <code class="literal">.siem-signals-default</code>.</p>
</div>
</div>
</dd>
<dt>
<span class="term">
Detection rules
</span>
</dt>
<dd>
Background tasks that run periodically and produce alerts when suspicious
activity is detected.
</dd>
<dt>
<span class="term">
Endpoint exceptions
</span>
</dt>
<dd>
<p>
<a class="xref" href="detection-engine-overview.html#term-exceptions">Exceptions</a> added to both rules and Endpoint agents on
hosts. Endpoint exceptions can only be added when:
</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Endpoint agents are installed on the hosts.
</li>
<li class="listitem">
The Elastic Endpoint Security rule is activated.
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="variablelist">
<a id="term-exceptions"></a>
<dl class="variablelist">
<dt>
<span class="term">
Exceptions
</span>
</dt>
<dd>
Added to rules to prevent specific source event field values from generating
alerts.
</dd>
<dt>
<span class="term">
External alerts
</span>
</dt>
<dd>
Alerts Elastic Security receives from external systems, such as Suricata.
</dd>
</dl>
</div>
<h2><a id="detections-permissions"></a>Detections configuration and index privilege prerequisites<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/detections/detection-engine-intro.asciidoc">edit</a></h2>
<p><a class="xref" href="detections-permissions-section.html" title="Detections prerequisites and requirements">Detections prerequisites and requirements</a> provides detailed information on all the
permissions required to initiate and use the Detections feature.</p>
<h2><a id="malware-prevention"></a>Malware prevention<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/detections/detection-engine-intro.asciidoc">edit</a></h2>
<p>Malware, short for malicious software, is any software program designed to damage or execute unauthorized actions on a
computer system. Examples of malware include viruses, worms, Trojan horses, adware, scareware, and spyware. Some
malware, such as viruses, can severely damage a computer&#8217;s hard drive by deleting files or directory information. Other
malware, such as spyware, can obtain user data without their knowledge.</p>
<p>Malware may be stealthy and appear as legitimate executable code, scripts, active content, and other software. It is also
often embedded in non-malicious files, non-suspicious websites, and standard programs — sometimes making the root
source difficult to identify. If infected and not resolved promptly, malware can cause irreparable damage to a computer
network.</p>
<p>For information on how to enable malware protection on your host, see <a class="xref" href="install-endpoint.html#configure-malware" title="Configure Malware detect or prevent">Configure Malware detect or prevent</a>.</p>
<h3><a id="_machine_learning_model"></a>Machine Learning Model<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/detections/detection-engine-intro.asciidoc">edit</a></h3>
<p>To determine if a file is malicious or benign, a machine learning model looks for static attributes of files (without executing
the file) that include file structure, layout, and content. This includes information such as file header data, imports, exports,
section names, and file size. These attributes are extracted from millions of benign and malicious file samples, which then
are passed to a machine-learning algorithm that distinguishes a benign file from a malicious one. The machine learning
model is updated as new data is procured and analyzed.</p>
<h3><a id="_threshold"></a>Threshold<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/detections/detection-engine-intro.asciidoc">edit</a></h3>
<p>A malware threshold determines the action the agent should take if malware is detected. The Elastic Agent uses a recommended threshold level that generates a balanced number of alerts with a low probability of undetected malware. This threshold also minimizes the number of false positive alerts.</p>
<h3><a id="_resolve_ui_error_messages"></a>Resolve UI error messages<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/detections/detection-engine-intro.asciidoc">edit</a></h3>
<p>Depending on your privileges and whether detection system indices have already
been created for the Kibana space, you might see an error message  when you try
to open the <span class="strong strong"><strong>Detections</strong></span> page.</p>
<p><span class="strong strong"><strong><code class="literal">Let’s set up your detection engine</code></strong></span></p>
<p>If you see this message, a user with specific privileges must visit the
<span class="strong strong"><strong>Detections</strong></span> page before you can view detection rules and alerts.
See <a class="xref" href="detections-permissions-section.html#enable-detections-ui" title="Enable Detections">Enable Detections</a> for a list of all the requirements.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>For <span class="strong strong"><strong>on-premises</strong></span> Elastic Stack deployments only, this message may be displayed
when the
<a class="xref" href="detection-engine-overview.html#detections-permissions" title="Detections configuration and index privilege prerequisites"><code class="literal">xpack.encryptedSavedObjects.encryptionKey</code></a>
setting has not been added to the <code class="literal">kibana.yml</code> file. For more information, see <a class="xref" href="detections-permissions-section.html#detections-on-prem-requirements" title="Configure on-premises Elastic Stack deployments">Configure on-premises Elastic Stack deployments</a>.</p>
</div>
</div>
<p><span class="strong strong"><strong><code class="literal">Detection engine permissions required</code></strong></span></p>
<p>If you see this message, you do not have the
<a class="xref" href="detection-engine-overview.html#detections-permissions" title="Detections configuration and index privilege prerequisites">required privileges</a> to view the <span class="strong strong"><strong>Detections</strong></span> page,
and you should contact your Kibana administrator.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>For <span class="strong strong"><strong>on-premises</strong></span> Elastic Stack deployments only, this message may be
displayed when the <a class="xref" href="detection-engine-overview.html#detections-permissions" title="Detections configuration and index privilege prerequisites"><code class="literal">xpack.security.enabled</code></a>
setting is not enabled in the <code class="literal">elasticsearch.yml</code> file. For more information, see <a class="xref" href="detections-permissions-section.html#detections-on-prem-requirements" title="Configure on-premises Elastic Stack deployments">Configure on-premises Elastic Stack deployments</a>.</p>
</div>
</div>
</div>
</div>









</div>
<div class="navfooter">
<span class="prev">
<a href="tuning-anomaly-results.html">« Optimizing anomaly results</a>
</span>
<span class="next">
<a href="rules-ui-create.html">Creating detection rules »</a>
</span>
</div>
</div>
</body>
</html>
