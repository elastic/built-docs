<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Detections prerequisites and requirements | Elastic Security Solution [master] | Elastic</title>
<link rel="home" href="index.html" title="Elastic Security Solution [master]"/>
<link rel="up" href="sec-requirements.html" title="Elastic Security system requirements"/>
<link rel="prev" href="sec-requirements.html" title="Elastic Security system requirements"/>
<link rel="next" href="case-permissions.html" title="Cases prerequisites"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/master"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="master"/>
</head>
<body><div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [master]</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="getting-started.html">Get started with Elastic Security</a></span><span class="chevron-right">›</span>
<span class="breadcrumb-link"><a href="sec-requirements.html">Elastic Security system requirements</a></span>
</div>
<div class="navheader">
<span class="prev">
<a href="sec-requirements.html">« Elastic Security system requirements</a>
</span>
<span class="next">
<a href="case-permissions.html">Cases prerequisites »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="detections-permissions-section"></a>Detections prerequisites and requirements<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/getting-started/detections-req.asciidoc">edit</a></h2>
</div></div></div>
<p>To use the <a class="xref" href="detection-engine-overview.html" title="Detections and alerts">Detections feature</a>, you first need to
configure a few settings. You also need the <a href="/subscriptions" class="ulink" target="_top">appropriate license</a> to send
<a class="xref" href="rules-ui-create.html#rule-notifications" title="Set up alert notifications (optional)">notifications</a> when detection alerts are generated.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Several steps are <span class="strong strong"><strong>only</strong></span> required for <span class="strong strong"><strong>self-managed</strong></span> Elastic Stack
deployments. If you&#8217;re using an Elastic Cloud deployment, you only need to
<a class="xref" href="detections-permissions-section.html#enable-detections-ui" title="Enable and access detections">enable detections</a>.</p>
</div>
</div>
<p>Additionally, there are some <a class="xref" href="detections-permissions-section.html#adv-list-settings" title="Configure list upload limits">advanced settings</a> used to
configure Kibana <a class="xref" href="value-lists-exceptions.html" title="Create and manage value lists">value list</a> upload limits.</p>
<h4><a id="detections-on-prem-requirements"></a>Configure self-managed Elastic Stack deployments<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/getting-started/detections-req.asciidoc">edit</a></h4>
<p>These steps are only required for <span class="strong strong"><strong>self-managed</strong></span> deployments:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
HTTPS must be configured for communication between
<a href="/guide/en/kibana/master/configuring-tls.html#configuring-tls-kib-es" class="ulink" target="_top">Elasticsearch and Kibana</a>.
</li>
<li class="listitem">
In the <code class="literal">elasticsearch.yml</code> configuration file, set the
<code class="literal">xpack.security.enabled</code> setting to <code class="literal">true</code>. For more information, refer to
<a href="/guide/en/elasticsearch/reference/master/settings.html" class="ulink" target="_top">Configuring Elasticsearch</a> and
<a href="/guide/en/elasticsearch/reference/master/security-settings.html" class="ulink" target="_top">Security settings in Elasticsearch</a>.
</li>
<li class="listitem">
<p>In the <code class="literal">kibana.yml</code> <a href="/guide/en/kibana/master/settings.html" class="ulink" target="_top">configuration file</a>, add the
<code class="literal">xpack.encryptedSavedObjects.encryptionKey</code> setting with any alphanumeric value
of at least 32 characters. For example:</p>
<p><code class="literal">xpack.encryptedSavedObjects.encryptionKey: 'fhjskloppd678ehkdfdlliverpoolfcr'</code></p>
</li>
</ul>
</div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>After changing the <code class="literal">xpack.encryptedSavedObjects.encryptionKey</code> value
and restarting Kibana, you must restart all detection rules.</p>
</div>
</div>
<h4><a id="enable-detections-ui"></a>Enable and access detections<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/getting-started/detections-req.asciidoc">edit</a></h4>
<p>To use the Detections feature, it must be enabled and your role must have access to rules and alerts. If your role does not have the cluster and index privileges needed to enable this feature, you can request someone who has these privileges to visit your Kibana space, which will turn it on for you. The following table describes the required privileges to access the Detections page, including rules and alerts.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>For instructions about using Machine Learning jobs and rules, refer to <a class="xref" href="ml-requirements.html" title="Machine learning job and rule requirements">Machine learning job and rule requirements</a>.</p>
</div>
</div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>In Elastic Stack version 8.0.0, the <code class="literal">.siem-signals-&lt;space-id&gt;</code> index was renamed to <code class="literal">.alerts-security.alerts-&lt;space-id&gt;</code>. Detection alert indices are created for each Kibana space. For the default space, the alerts index is
named <code class="literal">.alerts-security.alerts-default</code>. If you&#8217;re upgrading to 8.0.0 or later, users should have privileges for the <code class="literal">.alerts-security.alerts-&lt;space-id&gt;</code> AND <code class="literal">.siem-signals-&lt;space-id&gt;</code> indices. If you&#8217;re newly installing the Elastic Stack, then users do not need privileges for the <code class="literal">.siem-signals-&lt;space-id&gt;</code> index.</p>
</div>
</div>
<div class="informaltable">
<table border="1" cellpadding="4px" width="100%">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Action</th>
<th align="left" valign="top">Cluster Privileges</th>
<th align="left" valign="top">Index Privileges</th>
<th align="left" valign="top">Kibana Privileges</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>Enable the Detections feature in your Kibana space</p></td>
<td align="left" valign="top"><p>The <code class="literal">manage</code> privilege</p></td>
<td align="left" valign="top">
<p>The <code class="literal">manage</code>, <code class="literal">write</code>,<code class="literal">read</code>, and <code class="literal">view_index_metadata</code> index privileges for the following system indices, where <code class="literal">&lt;space-id&gt;</code> is the Kibana space name:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">.alerts-security.alerts-&lt;space-id&gt;</code>
</li>
<li class="listitem">
<code class="literal">.siem-signals-&lt;space-id&gt;</code> <sup>1</sup>
</li>
<li class="listitem">
<code class="literal">.lists-&lt;space-id&gt;</code>
</li>
<li class="listitem">
<code class="literal">.items-&lt;space-id&gt;</code>
</li>
</ul>
</div>
<p><sup>1</sup> <span class="strong strong"><strong>NOTE</strong></span>: If you&#8217;re upgrading to Elastic Stack 8.0.0 or later, users should have privileges for the <code class="literal">.alerts-security.alerts-&lt;space-id&gt;</code> AND <code class="literal">.siem-signals-&lt;space-id&gt;</code> indices. If you&#8217;re newly installing the Elastic Stack, then users do not need privileges for the <code class="literal">.siem-signals-&lt;space-id&gt;</code> index.</p>
</td>
<td align="left" valign="top"><p>Kibana space <code class="literal">All</code> privileges for the <code class="literal">Security</code> feature (refer to
<a href="/guide/en/kibana/master/xpack-spaces.html#spaces-control-user-access" class="ulink" target="_top">Feature access based on user privileges</a>)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Enable the Detections feature in all Kibana spaces</p>
<p><span class="strong strong"><strong>NOTE</strong></span>: To turn on the Detections feature, visit the Detections page for each appropriate Kibana space.</p></td>
<td align="left" valign="top"><p>The <code class="literal">manage</code> privilege</p></td>
<td align="left" valign="top">
<p>The <code class="literal">manage</code>, <code class="literal">write</code>,<code class="literal">read</code>, and <code class="literal">view_index_metadata</code> index privileges for the following system indices:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">.alerts-security.alerts-&lt;space-id&gt;</code>
</li>
<li class="listitem">
<code class="literal">.siem-signals-&lt;space-id&gt;</code> <sup>1</sup>
</li>
<li class="listitem">
<code class="literal">.lists-&lt;space-id&gt;</code>
</li>
<li class="listitem">
<code class="literal">.items-&lt;space-id&gt;</code>
</li>
</ul>
</div>
<p><sup>1</sup> <span class="strong strong"><strong>NOTE</strong></span>: If you&#8217;re upgrading to Elastic Stack 8.0.0 or later, users should have privileges for the <code class="literal">.alerts-security.alerts-&lt;space-id&gt;</code> AND <code class="literal">.siem-signals-&lt;space-id&gt;</code> indices. If you&#8217;re newly installing the Elastic Stack, then users do not need privileges for the <code class="literal">.siem-signals-&lt;space-id&gt;</code> index.</p>
</td>
<td align="left" valign="top"><p>Kibana space <code class="literal">All</code> privileges for the <code class="literal">Security</code> feature (refer to
<a href="/guide/en/kibana/master/xpack-spaces.html#spaces-control-user-access" class="ulink" target="_top">Feature access based on user privileges</a>)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Preview rules</p></td>
<td align="left" valign="top"><p>N/A</p></td>
<td align="left" valign="top">
<p>The <code class="literal">read</code> privilege for the <code class="literal">.preview.alerts-security.alerts-&lt;space-id&gt;</code> index</p>
</td>
<td align="left" valign="top"><p>Kibana space <code class="literal">All</code> privileges for the <code class="literal">Security</code> feature (refer to
<a href="/guide/en/kibana/master/xpack-spaces.html#spaces-control-user-access" class="ulink" target="_top">Feature access based on user privileges</a>)</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Manage rules</p></td>
<td align="left" valign="top"><p>N/A</p></td>
<td align="left" valign="top">
<p>The <code class="literal">manage</code>, <code class="literal">write</code>,<code class="literal">read</code>, and <code class="literal">view_index_metadata</code> index privileges for the following system indices, where <code class="literal">&lt;space-id&gt;</code> is the Kibana space name:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">.alerts-security.alerts-&lt;space-id</code>
</li>
<li class="listitem">
<code class="literal">.siem-signals-&lt;space-id&gt;</code><sup>1</sup>
</li>
<li class="listitem">
<code class="literal">.lists-&lt;space-id&gt;</code>
</li>
<li class="listitem">
<code class="literal">.items-&lt;space-id&gt;</code>
</li>
</ul>
</div>
<p><sup>1</sup> <span class="strong strong"><strong>NOTE</strong></span>: If you&#8217;re upgrading to Elastic Stack 8.0.0 or later, users should have privileges for the <code class="literal">.alerts-security.alerts-&lt;space-id&gt;</code> AND <code class="literal">.siem-signals-&lt;space-id&gt;</code> indices. If you&#8217;re newly installing the Elastic Stack, then users do not need privileges for the <code class="literal">.siem-signals-&lt;space-id&gt;</code> index.</p>
</td>
<td align="left" valign="top">
<p>Kibana space <code class="literal">All</code> privileges for the <code class="literal">Security</code> feature (refer to
<a href="/guide/en/kibana/master/xpack-spaces.html#spaces-control-user-access" class="ulink" target="_top">Feature access based on user privileges</a>)</p>
<p><span class="strong strong"><strong>NOTE:</strong></span> You need additional <code class="literal">Action and Connectors</code> feature privileges (<span class="strong strong"><strong>Management → Action and Connectors</strong></span>) to manage rules with actions and connectors:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
To provide full access to rule actions and connectors, give your role <code class="literal">All</code> privileges. With <code class="literal">Read</code> privileges, you can edit rule actions, but will have limited capabilities to manage connectors. For example, <code class="literal">Read</code> privileges allow you to add or remove an existing connector from a rule, but does not allow you to create a new connector.
</li>
<li class="listitem">
To import rules with actions and connectors, your role needs at least <code class="literal">Read</code> privileges. To import rules without actions or connectors, your role does not require <code class="literal">Action and Connectors</code> feature privileges.
</li>
</ul>
</div>
</td>
</tr>
<tr>
<td align="left" valign="top"><p>Manage alerts</p>
<p><span class="strong strong"><strong>NOTE</strong></span>: Allows you to manage alerts, but not modify rules.</p></td>
<td align="left" valign="top"><p>N/A</p></td>
<td align="left" valign="top">
<p>The <code class="literal">maintenance</code>, <code class="literal">write</code>,<code class="literal">read</code>, and <code class="literal">view_index_metadata</code> index privileges for the following system indices, where <code class="literal">&lt;space-id&gt;</code> is the Kibana space name:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">.alerts-security.alerts-&lt;space-id&gt;</code>
</li>
<li class="listitem">
<code class="literal">.internal.alerts-security.alerts-&lt;space-id&gt;-*</code>
</li>
<li class="listitem">
<code class="literal">.siem-signals-&lt;space-id&gt;</code><sup>1</sup>
</li>
<li class="listitem">
<code class="literal">.lists-&lt;space-id&gt;</code>
</li>
<li class="listitem">
<code class="literal">.items-&lt;space-id&gt;</code>
</li>
</ul>
</div>
<p><sup>1</sup> <span class="strong strong"><strong>NOTE</strong></span>: If you&#8217;re upgrading to Elastic Stack 8.0.0 or later, users should have privileges for the <code class="literal">.alerts-security.alerts-&lt;space-id&gt;</code> AND <code class="literal">.siem-signals-&lt;space-id&gt;</code> indices. If you&#8217;re newly installing the Elastic Stack, then users do not need privileges for the <code class="literal">.siem-signals-&lt;space-id&gt;</code> index.</p>
</td>
<td align="left" valign="top"><p>Kibana space <code class="literal">Read</code> privileges for the <code class="literal">Security</code> feature (refer to
<a href="/guide/en/kibana/master/xpack-spaces.html#spaces-control-user-access" class="ulink" target="_top">Feature access based on user privileges</a>)</p></td>
</tr>
</tbody>
</table>
</div>
<p>Here is an example of a user who has the Detections feature enabled in all Kibana spaces:</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/sec-admin-user.png" alt="Shows user with the Detections feature enabled in all Kibana spaces">
</div>
</div>
<h5><a id="alerting-auth-model"></a>Authorization<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/getting-started/detections-req.asciidoc">edit</a></h5>
<p>Rules, including all background detection and the actions they generate, are authorized using an <a href="/guide/en/kibana/master/api-keys.html" class="ulink" target="_top">API key</a> associated with the last user to edit the rule. Upon creating or modifying a rule, an API key is generated for that user, capturing a snapshot of their privileges. The API key is then used to run all background tasks associated with the rule including detection checks and executing actions.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>If a rule requires certain privileges to run, such as index privileges, keep in mind that if a user without those privileges updates the rule, the rule will no longer function.</p>
</div>
</div>
<h4><a id="adv-list-settings"></a>Configure list upload limits<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/getting-started/detections-req.asciidoc">edit</a></h4>
<p>You can set limits to the number of bytes and the buffer size used to upload
<a class="xref" href="value-lists-exceptions.html" title="Create and manage value lists">value lists</a> to Elastic Security.</p>
<p>To set the value:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Open <code class="literal">kibana.yml</code> <a href="/guide/en/kibana/master/settings.html" class="ulink" target="_top">configuration file</a> or edit your
Kibana cloud instance.
</li>
<li class="listitem">
<p>Add any of these settings and their required values:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p><code class="literal">xpack.lists.maxImportPayloadBytes</code>: Sets the number of bytes allowed for
uploading Elastic Security value lists (default <code class="literal">9000000</code>, maximum
<code class="literal">100000000</code>). For every 10 megabytes, it is recommended to have an additional 1
gigabyte of RAM reserved for Kibana.</p>
<p>For example, on a Kibana instance with 2 gigabytes of RAM, you can set this value up
to 20000000 (20 megabytes).</p>
</li>
<li class="listitem">
<code class="literal">xpack.lists.importBufferSize</code>: Sets the buffer size used for uploading
Elastic Security value lists (default <code class="literal">1000</code>). Change the value if you&#8217;re
experiencing slow upload speeds or larger than wanted memory usage when
uploading value lists. Set to a higher value to increase throughput at the
expense of using more Kibana memory, or a lower value to decrease throughput and
reduce memory usage.
</li>
</ul>
</div>
</li>
</ol>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>For information on how to configure Elastic Cloud deployments, refer to
<a href="/guide/en/cloud/current/ec-manage-kibana-settings.html" class="ulink" target="_top">Add Kibana user settings</a>.</p>
</div>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="sec-requirements.html">« Elastic Security system requirements</a>
</span>
<span class="next">
<a href="case-permissions.html">Cases prerequisites »</a>
</span>
</div>
</div>
</body>
</html>
