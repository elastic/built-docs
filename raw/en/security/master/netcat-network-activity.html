<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Netcat Network Activity | Elastic Security Solution [master] | Elastic</title>
<link rel="home" href="index.html" title="Elastic Security Solution [master]"/>
<link rel="up" href="prebuilt-rules.html" title="Prebuilt rule reference"/>
<link rel="prev" href="net-command-via-system-account.html" title="Net command via SYSTEM account"/>
<link rel="next" href="network-connection-via-certutil.html" title="Network Connection via Certutil"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/master"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="master"/>
</head>
<body><div class="page_header">
You are looking at preliminary documentation for a future release.
Not what you want? See the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [master]</a></span>
»
<span class="breadcrumb-link"><a href="detection-engine-overview.html">Detections and Alerts</a></span>
»
<span class="breadcrumb-link"><a href="prebuilt-rules.html">Prebuilt rule reference</a></span>
»
<span class="breadcrumb-node">Netcat Network Activity</span>
</div>
<div class="navheader">
<span class="prev">
<a href="net-command-via-system-account.html">« Net command via SYSTEM account</a>
</span>
<span class="next">
<a href="network-connection-via-certutil.html">Network Connection via Certutil »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="netcat-network-activity"></a>Netcat Network Activity<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/detections/prebuilt-rules/rule-details/netcat-network-activity.asciidoc">edit</a></h2>
</div></div></div>
<p>A <code class="literal">netcat</code> process is engaging in network activity on a Linux host. Netcat is
often used as a persistence mechanism by exporting a reverse shell or by serving
a shell on a listening port. Netcat is also sometimes used for data
exfiltration.</p>
<p><span class="strong strong"><strong>Rule type</strong></span>: eql</p>
<p><span class="strong strong"><strong>Rule indices</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
auditbeat-*
</li>
<li class="listitem">
logs-endpoint.events.*
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Severity</strong></span>: medium</p>
<p><span class="strong strong"><strong>Risk score</strong></span>: 47</p>
<p><span class="strong strong"><strong>Runs every</strong></span>: 5 minutes</p>
<p><span class="strong strong"><strong>Searches indices from</strong></span>: now-9m (<a href="/guide/en/elasticsearch/reference/master/common-options.html#date-math" class="ulink" target="_top">Date Math format</a>, see also <a class="xref" href="rules-ui-create.html#rule-schedule" title="Set the rule&#8217;s schedule"><code class="literal">Additional look-back time</code></a>)</p>
<p><span class="strong strong"><strong>Maximum alerts per execution</strong></span>: 100</p>
<p><span class="strong strong"><strong>References</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet" class="ulink" target="_top">http://pentestmonkey.net/cheat-sheet/shells/reverse-shell-cheat-sheet</a>
</li>
<li class="listitem">
<a href="https://www.sans.org/security-resources/sec560/netcat_cheat_sheet_v1.pdf" class="ulink" target="_top">https://www.sans.org/security-resources/sec560/netcat_cheat_sheet_v1.pdf</a>
</li>
<li class="listitem">
<a href="https://en.wikipedia.org/wiki/Netcat" class="ulink" target="_top">https://en.wikipedia.org/wiki/Netcat</a>
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Tags</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Elastic
</li>
<li class="listitem">
Host
</li>
<li class="listitem">
Linux
</li>
<li class="listitem">
Threat Detection
</li>
</ul>
</div>
<p><span class="strong strong"><strong>Version</strong></span>: 5 (<a class="xref" href="netcat-network-activity.html#netcat-network-activity-history" title="Rule version history">version history</a>)</p>
<p><span class="strong strong"><strong>Added (Elastic Stack release)</strong></span>: 7.6.0</p>
<p><span class="strong strong"><strong>Last modified (Elastic Stack release)</strong></span>: 7.10.0</p>
<p><span class="strong strong"><strong>Rule authors</strong></span>: Elastic</p>
<p><span class="strong strong"><strong>Rule license</strong></span>: Elastic License</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_potential_false_positives_156"></a>Potential false positives<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/detections/prebuilt-rules/rule-details/netcat-network-activity.asciidoc">edit</a></h3>
</div></div></div>
<p>Netcat is a dual-use tool that can be used for benign or malicious activity. Netcat is included in some Linux distributions so its presence is not necessarily suspicious. Some normal use of this program, while uncommon, may originate from scripts, automation tools, and frameworks.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_rule_query_237"></a>Rule query<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/detections/prebuilt-rules/rule-details/netcat-network-activity.asciidoc">edit</a></h3>
</div></div></div>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">sequence by process.entity_id [process where (process.name == "nc"
or process.name == "ncat" or process.name == "netcat" or
process.name == "netcat.openbsd" or process.name ==
"netcat.traditional") and event.type == "start"] [network where
(process.name == "nc" or process.name == "ncat" or process.name ==
"netcat" or process.name == "netcat.openbsd" or
process.name == "netcat.traditional")]</pre>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="netcat-network-activity-history"></a>Rule version history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/master/docs/detections/prebuilt-rules/rule-details/netcat-network-activity.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
Version 5 (7.10.0 release)
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Updated query, changed from:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">event.category:network and event.type:(access or connection or start)
and process.name:(nc or ncat or netcat or netcat.openbsd or
netcat.traditional)</pre>
</div>
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Version 4 (7.9.1 release)
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Formatting only
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Version 3 (7.9.0 release)
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Updated query, changed from:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">process.name:(nc or ncat or netcat or netcat.openbsd or
netcat.traditional) and event.action:(bound-socket or connected-to or
socket_opened)</pre>
</div>
</li>
</ul>
</div>
</dd>
<dt>
<span class="term">
Version 2 (7.7.0 release)
</span>
</dt>
<dd>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>Updated query, changed from:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">process.name: (nc or ncat or netcat or netcat.openbsd or
netcat.traditional) and event.action: (connected-to or bound-socket or
socket_opened)</pre>
</div>
</li>
</ul>
</div>
</dd>
</dl>
</div>
</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="net-command-via-system-account.html">« Net command via SYSTEM account</a>
</span>
<span class="next">
<a href="network-connection-via-certutil.html">Network Connection via Certutil »</a>
</span>
</div>
</div>
</body>
</html>
