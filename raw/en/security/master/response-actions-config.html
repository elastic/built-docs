<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Configure third-party response actions | Elastic Security Solution [master] | Elastic</title>
<meta class="elastic" name="content" content="Configure third-party response actions | Elastic Security Solution [master]">

<link rel="home" href="index.html" title="Elastic Security Solution [master]"/>
<link rel="up" href="response-actions.html" title="Endpoint response actions"/>
<link rel="prev" href="third-party-actions.html" title="Third-party response actions"/>
<link rel="next" href="sec-manage-intro.html" title="Manage endpoint protection"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/master"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="master"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
This documentation contains work-in-progress information for future Elastic Stack and Cloud releases. Use the version selector to view supported release docs. It also contains some Elastic Cloud serverless information. Check out our <a href="https://www.elastic.co/docs/current/serverless">serverless docs</a> for more details.
</div>
<div class="navheader">
<span class="prev">
<a href="third-party-actions.html">« Third-party response actions</a>
</span>
<span class="next">
<a href="sec-manage-intro.html">Manage endpoint protection »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [master]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="response-actions.html">Endpoint response actions</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Configure third-party response actions</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/management/admin/response-actions-config.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="chapter">
<div class="titlepage"><div><div>
<h2 class="title"><a id="response-actions-config"></a>Configure third-party response actions<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/management/admin/response-actions-config.asciidoc">edit</a></h2>
</div></div></div>
<p>Endpoint response actions involving third-party systems require additional configuration. This page explains the high-level steps you&#8217;ll need to take to enable these response actions.</p>
<h3><a id="configure-sentinelone-response-actions"></a>Configure SentinelOne response actions<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/management/admin/response-actions-config.asciidoc">edit</a></h3>
<p>You can direct SentinelOne to perform response actions on protected hosts, such as isolating a suspicious endpoint from your network, without needing to leave the Elastic Security UI.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This functionality is in technical preview and may be changed or removed in a future release. Elastic will work to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.</p>
</div>
</div>
<div class="sidebar">
<div class="titlepage"><div><div>
<p class="title"><strong>Prerequisites</strong></p>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="/pricing" class="ulink" target="_top">Subscription level</a>: Enterprise
</li>
<li class="listitem">
<a href="/guide/en/kibana/master/kibana-role-management.html#adding_kibana_privileges" class="ulink" target="_top">Kibana feature privilege</a>: <span class="strong strong"><strong>Actions and Connectors : All</strong></span>.
</li>
<li class="listitem">
<a class="xref" href="endpoint-management-req.html" title="Elastic Defend feature privileges">Elastic Security feature privileges</a>: <span class="strong strong"><strong>All</strong></span> for the response action features, such as <span class="strong strong"><strong>Host Isolation</strong></span>, that you want to perform.
</li>
<li class="listitem">
Endpoints must have actively running SentinelOne agents installed.
</li>
</ul>
</div>
</div>
<p>Configuration requires the following general steps. Expand the steps and follow the links for detailed instructions:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p><span class="strong strong"><strong>Generate API access tokens in SentinelOne.</strong></span> You&#8217;ll need these tokens in later steps, and they allow Elastic Security to collect data and perform actions in SentinelOne.</p>
<details>
<summary class="title">Expand for details</summary>
<div class="content">
<p>Create two API tokens in SentinelOne, and give them the least privilege required by the Elastic components that will use them:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
SentinelOne integration: Permission to read SentinelOne data.
</li>
<li class="listitem">
SentinelOne connector: Permission to read SentinelOne data and perform actions on SentinelOne-protected hosts (for example, isolating and releasing an endpoint).
</li>
</ul>
</div>
<p>Refer to the <a href="https://docs.elastic.co/en/integrations/sentinel_one" class="ulink" target="_top">SentinelOne integration docs</a> or SentinelOne&#8217;s docs for details on generating API tokens.</p>
</div>
</details>
</li>
<li class="listitem">
<p><span class="strong strong"><strong>Install the SentinelOne integration and Elastic Agent.</strong></span> Elastic&#8217;s <a href="https://docs.elastic.co/en/integrations/sentinel_one" class="ulink" target="_top">SentinelOne integration</a> collects and ingests logs into Elastic Security.</p>
<details>
<summary class="title">Expand for details</summary>
<div class="content">
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
In Kibana, go to <span class="strong strong"><strong>Integrations</strong></span>, search for and select <span class="strong strong"><strong>SentinelOne</strong></span>, then select <span class="strong strong"><strong>Add SentinelOne</strong></span>.
</li>
<li class="listitem">
Configure the integration with an <span class="strong strong"><strong>Integration name</strong></span> and optional <span class="strong strong"><strong>Description</strong></span>.
</li>
<li class="listitem">
<p>Ensure that <span class="strong strong"><strong>Collect SentinelOne logs via API</strong></span> is selected, and enter the required <span class="strong strong"><strong>Settings</strong></span>:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>URL</strong></span>: The SentinelOne console URL.
</li>
<li class="listitem">
<span class="strong strong"><strong>API Token</strong></span>: The SentinelOne API access token you generated previously, with permission to read SentinelOne data.
</li>
</ul>
</div>
</li>
<li class="listitem">
Scroll down and enter a name for the agent policy in <span class="strong strong"><strong>New agent policy name</strong></span>. If other agent policies already exist, you can click the <span class="strong strong"><strong>Existing hosts</strong></span> tab and select an existing policy instead. For more details on Elastic Agent configuration settings, refer to <a href="/guide/en/fleet/master/agent-policy.html" class="ulink" target="_top">Elastic Agent policies</a>.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Save and continue</strong></span>.
</li>
<li class="listitem">
Select <span class="strong strong"><strong>Add Elastic Agent to your hosts</strong></span> and continue with the <a class="xref" href="install-endpoint.html#enroll-agent" title="Add the Elastic Agent">Elastic Agent installation steps</a> to install Elastic Agent on a resource in your network (such as a server or VM). Elastic Agent will act as a bridge collecting data from SentinelOne and sending it to Elastic Security.
</li>
</ol>
</div>
</div>
</details>
</li>
<li class="listitem">
<p><span class="strong strong"><strong>Create a SentinelOne connector.</strong></span> Elastic&#8217;s <a href="/guide/en/kibana/master/sentinelone-action-type.html" class="ulink" target="_top">SentinelOne connector</a> enables Elastic Security to perform actions on SentinelOne-protected hosts.</p>
<details>
<summary class="title">Expand for details</summary>
<div class="content">
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Do not create more than one SentinelOne connector.</p>
</div>
</div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
In Kibana, go to <span class="strong strong"><strong>Stack Management</strong></span> → <span class="strong strong"><strong>Connectors</strong></span>, then select <span class="strong strong"><strong>Create connector</strong></span>.
</li>
<li class="listitem">
Select the <span class="strong strong"><strong>SentinelOne</strong></span> connector.
</li>
<li class="listitem">
<p>Enter the configuration information:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Connector name</strong></span>: A name to identify the connector.
</li>
<li class="listitem">
<span class="strong strong"><strong>SentinelOne tenant URL</strong></span>: The SentinelOne tenant URL.
</li>
<li class="listitem">
<span class="strong strong"><strong>API token</strong></span>: The SentinelOne API access token you generated previously, with permission to read SentinelOne data and perform actions on SentinelOne-protected hosts.
</li>
</ul>
</div>
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Save</strong></span>.
</li>
</ol>
</div>
</div>
</details>
</li>
<li class="listitem">
<p><span class="strong strong"><strong>Create and enable a rule to generate Elastic Security alerts.</strong></span> Create a <a class="xref" href="rules-ui-create.html#create-custom-rule" title="Create a custom query rule">custom query detection rule</a> to generate Elastic Security alerts whenever SentinelOne generates alerts.</p>
<details>
<summary class="title">Expand for details</summary>
<div class="content">
<p>Use these settings when creating the custom query rule to target the data collected from SentinelOne:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Index patterns</strong></span>: <code class="literal">logs-sentinel_one.alert*</code>
</li>
<li class="listitem">
<span class="strong strong"><strong>Custom query</strong></span>: <code class="literal">observer.serial_number:*</code>
</li>
</ul>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Do not include any other index patterns or query parameters.</p>
</div>
</div>
<p>This rule will give you visibility into SentinelOne without needing to leave Elastic Security. You can perform supported endpoint response actions directly from alerts that the rule creates, by using the <span class="strong strong"><strong>Take action</strong></span> menu on the alert details flyout.</p>
</div>
</details>
</li>
</ol>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="third-party-actions.html">« Third-party response actions</a>
</span>
<span class="next">
<a href="sec-manage-intro.html">Manage endpoint protection »</a>
</span>
</div>
</body>
</html>
