<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Endpoint response actions | Elastic Security Solution [master] | Elastic</title>
<meta class="elastic" name="content" content="Endpoint response actions | Elastic Security Solution [master]">

<link rel="home" href="index.html" title="Elastic Security Solution [master]"/>
<link rel="up" href="index.html" title="Elastic Security Solution [master]"/>
<link rel="prev" href="osquery-placeholder-fields.html" title="Use placeholder fields in Osquery queries"/>
<link rel="next" href="automated-response-actions.html" title="Automated response actions"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/master"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="master"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
This documentation contains work-in-progress information for future Elastic Stack and Cloud releases. Use the version selector to view supported release docs. It also contains some Elastic Cloud serverless information. Check out our <a href="https://www.elastic.co/docs/current/serverless">serverless docs</a> for more details.
</div>
<div class="navheader">
<span class="prev">
<a href="osquery-placeholder-fields.html">« Use placeholder fields in Osquery queries</a>
</span>
<span class="next">
<a href="automated-response-actions.html">Automated response actions »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [master]</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Endpoint response actions</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/management/admin/response-actions.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="part">
<div class="titlepage"><div><div>
<h2 class="title"><a id="response-actions"></a>Endpoint response actions<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/management/admin/response-actions.asciidoc">edit</a></h2>
</div></div></div>
<div class="openblock partintro">
<div class="content">
<p>The response console allows you to perform response actions on an endpoint using a terminal-like interface. You can enter action commands and get near-instant feedback on them. Actions are also recorded in the endpoint&#8217;s <a class="xref" href="response-actions.html#actions-log" title="Response actions history">response actions history</a> for reference.</p>
<p>Response actions are supported on all endpoint platforms (Linux, macOS, and Windows).</p>
<div class="sidebar">
<div class="titlepage"><div><div>
<p class="title"><strong>Requirements</strong></p>
</div></div></div>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Response actions and the response console UI are <a href="/pricing" class="ulink" target="_top">Enterprise subscription</a> features.
</li>
<li class="listitem">
Endpoints must have Elastic Agent version 8.4 or higher installed with the Elastic Defend integration to receive response actions.
</li>
<li class="listitem">
Some response actions require specific <a class="xref" href="endpoint-management-req.html" title="Elastic Defend feature privileges">privileges</a>, indicated below. These are required to perform actions both in the response console and in other areas of the Elastic Security app (such as isolating a host from a detection alert).
</li>
<li class="listitem">
Users must have privileges for at least one response action to access the response console.
</li>
</ul>
</div>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="images/response-console.png" alt="Response console UI">
</div>
</div>
<p>Launch the response console from any of the following places in Elastic Security:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Endpoints</strong></span> page &#8594; <span class="strong strong"><strong>Actions</strong></span> menu (<span class="strong strong"><strong>&#8230;&#8203;</strong></span>) &#8594; <span class="strong strong"><strong>Respond</strong></span>
</li>
<li class="listitem">
Endpoint details flyout &#8594; <span class="strong strong"><strong>Take action</strong></span> &#8594; <span class="strong strong"><strong>Respond</strong></span>
</li>
<li class="listitem">
Alert details flyout &#8594; <span class="strong strong"><strong>Take action</strong></span> &#8594; <span class="strong strong"><strong>Respond</strong></span>
</li>
<li class="listitem">
Host details page → <span class="strong strong"><strong>Respond</strong></span>
</li>
</ul>
</div>
<p>To perform an action on the endpoint, enter a <a class="xref" href="response-actions.html#response-action-commands" title="Response action commands">response action command</a> in the input area at the bottom of the console, then press <span class="strong strong"><strong>Return</strong></span>. Output from the action is displayed in the console.</p>
<p>If a host is unavailable, pending actions will execute once the host comes online. Pending actions expire after two weeks and can be tracked in the response actions history.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Some response actions may take a few seconds to complete. Once you enter a command, you can immediately enter another command while the previous action is running.</p>
</div>
</div>
<p>Activity in the response console is persistent, so you can navigate away from the page and any pending actions you&#8217;ve submitted will continue to run. To confirm that an action completed, return to the response console to view the console output or check the <a class="xref" href="response-actions.html#actions-log" title="Response actions history">response actions history</a>.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Once you submit a response action, you can&#8217;t cancel it, even if the action is pending for an offline host.</p>
</div>
</div>
<h2><a id="response-action-commands"></a>Response action commands<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/management/admin/response-actions.asciidoc">edit</a></h2>
<p>The following response action commands are available in the response console.</p>
<h3><a id="_isolate"></a><code class="literal">isolate</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/management/admin/response-actions.asciidoc">edit</a></h3>
<p><a class="xref" href="host-isolation-ov.html" title="Isolate a host">Isolate the host</a>, blocking communication with other hosts on the network.</p>
<p>Required privilege: <span class="strong strong"><strong>Host Isolation</strong></span></p>
<p>Example: <code class="literal">isolate --comment "Isolate host related to detection alerts"</code></p>
<h3><a id="_release"></a><code class="literal">release</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/management/admin/response-actions.asciidoc">edit</a></h3>
<p>Release an isolated host, allowing it to communicate with the network again.</p>
<p>Required privilege: <span class="strong strong"><strong>Host Isolation</strong></span></p>
<p>Example: <code class="literal">release --comment "Release host, everything looks OK"</code></p>
<h3><a id="_status"></a><code class="literal">status</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/management/admin/response-actions.asciidoc">edit</a></h3>
<p>Show information about the host&#8217;s status, including: Elastic Agent status and version, the Elastic Defend integration&#8217;s policy status, and when the host was last active.</p>
<h3><a id="_processes"></a><code class="literal">processes</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/management/admin/response-actions.asciidoc">edit</a></h3>
<p>Show a list of all processes running on the host. This action may take a minute or so to complete.</p>
<p>Required privilege: <span class="strong strong"><strong>Process Operations</strong></span></p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>Use this command to get current PID or entity ID values, which are required for other response actions such as <code class="literal">kill-process</code> and <code class="literal">suspend-process</code>.</p>
<p>Entity IDs may be more reliable than PIDs, because entity IDs are unique values on the host, while PID values can be reused by the operating system.</p>
</div>
</div>
<h3><a id="_kill_process"></a><code class="literal">kill-process</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/management/admin/response-actions.asciidoc">edit</a></h3>
<p>Terminate a process. You must include one of the following parameters to identify the process to terminate:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">--pid</code> : A process ID (PID) representing the process to terminate.
</li>
<li class="listitem">
<code class="literal">--entityId</code> : An entity ID representing the process to terminate.
</li>
</ul>
</div>
<p>Required privilege: <span class="strong strong"><strong>Process Operations</strong></span></p>
<p>Example: <code class="literal">kill-process --pid 123 --comment "Terminate suspicious process"</code></p>
<h3><a id="_suspend_process"></a><code class="literal">suspend-process</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/management/admin/response-actions.asciidoc">edit</a></h3>
<p>Suspend a process. You must include one of the following parameters to identify the process to suspend:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">--pid</code> : A process ID (PID) representing the process to suspend.
</li>
<li class="listitem">
<code class="literal">--entityId</code> : An entity ID representing the process to suspend.
</li>
</ul>
</div>
<p>Required privilege: <span class="strong strong"><strong>Process Operations</strong></span></p>
<p>Example: <code class="literal">suspend-process --pid 123 --comment "Suspend suspicious process"</code></p>
<h3><a id="get-file"></a><code class="literal">get-file</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/management/admin/response-actions.asciidoc">edit</a></h3>
<p>Retrieve a file from a host. Files are downloaded in a password-protected <code class="literal">.zip</code> archive to prevent the file from running. Use password <code class="literal">elastic</code> to open the <code class="literal">.zip</code> in a safe environment.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Files retrieved from third-party-protected hosts require a different password. Refer to <a class="xref" href="third-party-actions.html" title="Third-party response actions"><em>Third-party response actions</em></a> for your system&#8217;s password.</p>
</div>
</div>
<p>You must include the following parameter to specify the file&#8217;s location on the host:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">--path</code> : The file&#8217;s full path (including the file name).
</li>
</ul>
</div>
<p>Required privilege: <span class="strong strong"><strong>File Operations</strong></span></p>
<p>Example: <code class="literal">get-file --path "/full/path/to/file.txt" --comment "Possible malware"</code></p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>You can use the <a class="xref" href="use-osquery.html" title="Osquery">Osquery manager integration</a> to query a host&#8217;s operating system and gain insight into its files and directories, then use <code class="literal">get-file</code> to retrieve specific files.</p>
</div>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>When Elastic Defend prevents file activity due to <a class="xref" href="configure-endpoint-integration-policy.html#malware-protection" title="Malware protection">malware prevention</a>, the file is quarantined on the host and a malware prevention alert is created. To retrieve this file with <code class="literal">get-file</code>, copy the path from the alert&#8217;s <span class="strong strong"><strong>Quarantined file path</strong></span> field (<code class="literal">file.Ext.quarantine_path</code>), which appears under <span class="strong strong"><strong>Highlighted fields</strong></span> in the alert details flyout. Then paste the value into the <code class="literal">--path</code> parameter.</p>
</div>
</div>
<h3><a id="_execute"></a><code class="literal">execute</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/management/admin/response-actions.asciidoc">edit</a></h3>
<p>Run a shell command on the host. The command&#8217;s output and any errors appear in the response console, up to 2000 characters. The complete output (stdout and stderr) are also saved to a downloadable <code class="literal">.zip</code> archive (password: <code class="literal">elastic</code>). Use these parameters:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p><code class="literal">--command</code> : (Required) A shell command to run on the host. The command must be supported by <code class="literal">bash</code> for Linux and macOS hosts, and <code class="literal">cmd.exe</code> for Windows.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Multiple consecutive dashes in the value must be escaped; single dashes do not need to be escaped. For example, to represent a directory named <code class="literal">/opt/directory--name</code>, use the following: <code class="literal">/opt/directory\-\-name</code>.
</li>
<li class="listitem">
You can use quotation marks without escaping. For example:<br>
<code class="literal">execute --command "cd "C:\Program Files\directory""</code>
</li>
</ul>
</div>
</div>
</div>
</li>
<li class="listitem">
<code class="literal">--timeout</code> : (Optional) How long the host should wait for the command to complete. Use <code class="literal">h</code> for hours, <code class="literal">m</code> for minutes, <code class="literal">s</code> for seconds (for example, <code class="literal">2s</code> is two seconds). If no timeout is specified, it defaults to four hours.
</li>
</ul>
</div>
<p>Required privilege: <span class="strong strong"><strong>Execute Operations</strong></span></p>
<p>Example: <code class="literal">execute --command "ls -al" --timeout 2s --comment "Get list of all files"</code></p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>This response action runs commands on the host using the same user account running the Elastic Defend integration, which normally has full control over the system. Be careful with any commands that could cause irrevocable changes.</p>
</div>
</div>
<h3><a id="_upload"></a><code class="literal">upload</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/management/admin/response-actions.asciidoc">edit</a></h3>
<p>Upload a file to the host. The file is saved to the location on the host where Elastic Endpoint is installed. After you run the command, the full path is returned in the console for reference. Use these parameters:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">--file</code> : (Required) The file to send to the host. As soon as you type this parameter, a popup appears — select it to navigate to the file, or drag and drop the file onto the popup.
</li>
<li class="listitem">
<code class="literal">--overwrite</code> : (Optional) Overwrite the file on the host if it already exists.
</li>
</ul>
</div>
<p>Required privilege: <span class="strong strong"><strong>File Operations</strong></span></p>
<p>Example: <code class="literal">upload --file --comment "Upload remediation script"</code></p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>You can follow this with the <code class="literal">execute</code> response action to upload and run scripts for mitigation or other purposes.</p>
</div>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The default file size maximum is 25 MB, configurable in <code class="literal">kibana.yml</code> with the <code class="literal">maxUploadResponseActionFileBytes</code> setting. You must enter the value in bytes (the maximum is <code class="literal">104857600</code> bytes, or 100 MB).</p>
</div>
</div>
<h3><a id="_scan"></a><code class="literal">scan</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/management/admin/response-actions.asciidoc">edit</a></h3>
<p>Scan a specific file or directory on the host for malware. The scan uses the <a class="xref" href="configure-endpoint-integration-policy.html#malware-protection" title="Malware protection">malware protection settings</a> (such as <span class="strong strong"><strong>Detect</strong></span> or <span class="strong strong"><strong>Prevent</strong></span> options, or enabling the blocklist) as configured in the host&#8217;s associated Elastic Defend integration policy. Use these parameters:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">--path</code> : (Required) The absolute path to a file or directory to be scanned.
</li>
</ul>
</div>
<p>Required privilege: <span class="strong strong"><strong>Scan Operations</strong></span></p>
<p>Example: <code class="literal">scan --path "/Users/username/Downloads" --comment "Scan Downloads folder for malware"</code></p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Scanning can take longer for directories containing a lot of files.</p>
</div>
</div>
<h2><a id="supporting-commands-parameters"></a>Supporting commands and parameters<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/management/admin/response-actions.asciidoc">edit</a></h2>
<h3><a id="_comment"></a><code class="literal">--comment</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/management/admin/response-actions.asciidoc">edit</a></h3>
<p>Add to a command to include a comment explaining or describing the action. Comments are included in the response actions history.</p>
<h3><a id="_help"></a><code class="literal">--help</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/management/admin/response-actions.asciidoc">edit</a></h3>
<p>Add to a command to get help for that command.</p>
<p>Example: <code class="literal">isolate --help</code></p>
<h3><a id="_clear"></a><code class="literal">clear</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/management/admin/response-actions.asciidoc">edit</a></h3>
<p>Clear all output from the response console.</p>
<h3><a id="_help_2"></a><code class="literal">help</code><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/management/admin/response-actions.asciidoc">edit</a></h3>
<p>List supported commands in the console output area.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>You can also get a list of commands in the <a class="xref" href="response-actions.html#help-panel" title="Help panel">Help panel</a>, which stays on the screen independently of the output area.</p>
</div>
</div>
<h2><a id="help-panel"></a>Help panel<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/management/admin/response-actions.asciidoc">edit</a></h2>
<p>Click <span class="image"><img src="images/help-icon.png" alt="Help icon" width="17" height="18"></span> <span class="strong strong"><strong>Help</strong></span> in the upper-right to open the <span class="strong strong"><strong>Help</strong></span> panel, which lists available response action commands and parameters as a reference.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This panel displays only the response actions that the user has privileges to perform.</p>
</div>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="images/response-console-help-panel.png" alt="Help panel" width="50%">
</div>
</div>
<p>You can use this panel to build commands with less typing. Click the add icon (<span class="image"><img src="images/add-command-icon.png" alt="Add icon" width="17" height="17"></span>) to add a command to the input area, enter any additional parameters or a comment, then press <span class="strong strong"><strong>Return</strong></span> to run the command.</p>
<p>If the endpoint is running an older version of Elastic Agent, some response actions may not be supported, as indicated by an informational icon and tooltip. <a href="/guide/en/fleet/master/upgrade-elastic-agent.html" class="ulink" target="_top">Upgrade Elastic Agent</a> on the endpoint to be able to use the latest response actions.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/response-console-unsupported-command.png" alt="Unsupported response action with tooltip" width="350">
</div>
</div>
<h2><a id="actions-log"></a>Response actions history<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/management/admin/response-actions.asciidoc">edit</a></h2>
<p>Click <span class="strong strong"><strong>Response actions history</strong></span> to display a log of the response actions performed on the endpoint, such as isolating a host or terminating a process. You can filter the information displayed in this view. Refer to <a class="xref" href="response-actions-history.html" title="Response actions history"><em>Response actions history</em></a> for more details.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/response-actions-history-console.png" alt="Response actions history with a few past actions" width="85%">
</div>
</div>
</div>
</div>





</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="osquery-placeholder-fields.html">« Use placeholder fields in Osquery queries</a>
</span>
<span class="next">
<a href="automated-response-actions.html">Automated response actions »</a>
</span>
</div>
</body>
</html>
