<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Upgrade from 7.17 to an 8.x version | Elastic Security Solution [master] | Elastic</title>
<meta class="elastic" name="content" content="Upgrade from 7.17 to an 8.x version | Elastic Security Solution [master]">

<link rel="home" href="index.html" title="Elastic Security Solution [master]"/>
<link rel="up" href="upgrade-intro.html" title="Upgrade Elastic Security to 8.16.0"/>
<link rel="prev" href="upgrade-intro.html" title="Upgrade Elastic Security to 8.16.0"/>
<link rel="next" href="post-upgrade-intro.html" title="Post-upgrade steps (optional)"/>
<meta class="elastic" name="product_version" content="master"/>
<meta class="elastic" name="product_name" content="Security"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Security/Guide/master"/>
<meta name="DC.subject" content="Security"/>
<meta name="DC.identifier" content="master"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
This documentation contains work-in-progress information for future Elastic Stack and Cloud releases. Use the version selector to view supported release docs. It also contains some Elastic Cloud serverless information. Check out our <a href="https://www.elastic.co/docs/current/serverless">serverless docs</a> for more details.
</div>
<div class="navheader">
<span class="prev">
<a href="upgrade-intro.html">« Upgrade Elastic Security to 8.16.0</a>
</span>
<span class="next">
<a href="post-upgrade-intro.html">Post-upgrade steps (optional) »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Elastic Security Solution [master]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="upgrade-intro.html">Upgrade Elastic Security to 8.16.0</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Upgrade from 7.17 to an 8.x version</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/upgrade/upgrade-7.17-8.x.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="chapter">
<div class="titlepage"><div><div>
<h2 class="title"><a id="upgrade-7.17-8x"></a>Upgrade from 7.17 to an 8.x version<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/upgrade/upgrade-7.17-8.x.asciidoc">edit</a></h2>
</div></div></div>
<h3><a id="_why_its_important_to_upgrade"></a>Why it&#8217;s important to upgrade<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/upgrade/upgrade-7.17-8.x.asciidoc">edit</a></h3>
<p>Upgrading provides you access to Elastic Security&#8217;s latest features, enhancements, and bug fixes, many of which enable you to save your organization money, respond faster to potential threats, and improve the tools you use to investigate and analyze your data. For more benefits, check out our blog, <a href="/blog/top-5-reasons-to-upgrade-elastic-security" class="ulink" target="_top">Top 5 reasons to upgrade Elastic Security</a>. Also, it&#8217;s important to ensure that your deployment is fully maintained and supported. For more information, refer to <a href="/support/eol" class="ulink" target="_top">Elastic&#8217;s Product End of Life Dates</a>.</p>
<h3><a id="_plan_for_your_upgrade"></a>Plan for your upgrade<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/upgrade/upgrade-7.17-8.x.asciidoc">edit</a></h3>
<p>Before upgrading to Elastic Security 8.x, consider the following recommendations:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Plan for an appropriate amount of time to complete the upgrade. Depending on your configuration and the size of your cluster, the process can take up to a week to complete.
</li>
<li class="listitem">
Open a <a href="https://support.elastic.co" class="ulink" target="_top">support case</a> with Elastic to alert our Elastic Support team of your system change. If you need additional assistance, <a href="/consulting" class="ulink" target="_top">Elastic Consulting Services</a> provides the technical expertise and step-by-step approach for upgrading your Elastic deployment.
</li>
<li class="listitem">
Choose a version to upgrade to. We recommend the latest minor and patch version. Be sure to upgrade your development or non-production deployment to the same version as your production deployment.
</li>
<li class="listitem">
Ensure that you have <a href="/guide/en/kibana/master/xpack-monitoring.html" class="ulink" target="_top">stack monitoring</a> enabled in Kibana. Take note of your current index and search rate.
</li>
<li class="listitem">
Review your selected version&#8217;s features, Elastic connectors, integrations, and detection rules to determine if you can replace any customized content with out-of-the-box functionality. This can help reduce your workload and the complexity of your upgrade.
</li>
<li class="listitem">
If your organization sends alerts (formerly known as signals) to an external SOAR (security orchestration, automation, and response) platform, you may need to change your workflows to accommodate the new <a class="xref" href="alert-schema.html" title="Alert schema">alert schema</a> used in 8.x.
</li>
<li class="listitem">
Review release notes, deprecations, and breaking changes for <a href="/guide/en/security/master/release-notes.html" class="ulink" target="_top">Elastic Security</a>, <a href="/guide/en/elasticsearch/reference/master/es-release-notes.html" class="ulink" target="_top">Elasticsearch</a>, <a href="/guide/en/kibana/master/release-notes.html" class="ulink" target="_top">Kibana</a>, and, if applicable, <a href="/guide/en/fleet/master/release-notes.html" class="ulink" target="_top">Fleet and Elastic Agent</a>, <a href="/guide/en/beats/libbeat/master/release-notes.html" class="ulink" target="_top">Beats</a>, and <a href="/guide/en/logstash/master/releasenotes.html" class="ulink" target="_top">Logstash</a>. Identify any issues that might affect your deployment. Work with your Elastic team on any questions you may have. Start with breaking changes for your solution and platform components, such as Elasticsearch and Kibana.
</li>
<li class="listitem">
Schedule a system maintenance window within your organization.
</li>
</ul>
</div>
<h3><a id="_pre_upgrade_steps"></a>Pre-upgrade steps<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/upgrade/upgrade-7.17-8.x.asciidoc">edit</a></h3>
<p>To prepare for the upgrade process, follow these steps before you start:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Do a software version inventory across your entire Elastic deployment, including Elasticsearch, Kibana, Elastic Agent, Beats, and Logstash.
</li>
<li class="listitem">
<p>If you&#8217;re running any versions earlier than 7.17, you must first upgrade them all to the latest 7.17.x patch release before upgrading to 8.x. This enables you to use the Upgrade Assistant to upgrade to 8.x.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>If you&#8217;re managing your deployments using <a href="/guide/en/cloud-enterprise/current/ece-upgrade.html" class="ulink" target="_top">Elastic Cloud Enterprise</a> (ECE) or <a href="/guide/en/cloud-on-k8s/current/k8s-upgrading-eck.html" class="ulink" target="_top">Elastic Cloud on Kubernetes</a> (ECK), you may need to upgrade the system clusters first.</p>
</div>
</div>
</li>
<li class="listitem">
Note that alerts in 8.x are written using the <code class="literal">kibana_system</code> user instead of the <code class="literal">current user</code>, so any user-modified ingest pipelines configured against the alert index (this is uncommon) will use the <code class="literal">kibana_system</code> user privileges, which may break your ingest pipeline. If you encounter this issue, please do not update your ingest pipeline. Instead, contact your Elastic Support rep for assistance.
</li>
<li class="listitem">
<p>Run the <a href="/guide/en/kibana/master/upgrade-assistant.html" class="ulink" target="_top">Upgrade Assistant</a>. Take note of any critical error messages, then work with your Elastic Support rep to resolve them.</p>
<div class="sidebar">
<div class="titlepage"><div><div>
<p class="title"><strong>Requirements</strong></p>
</div></div></div>
<p>To run the Upgrade Assistant, you must have the <code class="literal">superuser</code> role on the cluster.</p>
</div>
</li>
<li class="listitem">
If you&#8217;re not using <a href="/guide/en/elasticsearch/reference/master/snapshots-take-snapshot.html#automate-snapshots-slm" class="ulink" target="_top">snapshot lifecycle management (SLM)</a>, you must set up and configure a policy, then run the policy to create at least one <a href="/guide/en/elasticsearch/reference/master/snapshot-restore.html" class="ulink" target="_top">snapshot</a>&#8201;&#8212;&#8201;a backup of indices taken from a running cluster. If you need to roll back during the upgrade process, use a recent snapshot to avoid data loss. Snapshots are <a href="/guide/en/elasticsearch/reference/master/snapshot-restore.html#how-snapshots-work" class="ulink" target="_top">incremental</a>&#8201;&#8212;&#8201;depending on the cluster size and the input/output rate, the initial snapshot may take several hours to complete. If you&#8217;re using SLM, <a href="/guide/en/elasticsearch/reference/master/snapshots-take-snapshot.html#check-slm-history" class="ulink" target="_top">check the SLM history</a> to ensure that snapshots are completing successfully.
</li>
</ol>
</div>
<h3><a id="_perform_an_8_x_upgrade_on_a_deployment"></a>Perform an 8.x upgrade on a deployment<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/upgrade/upgrade-7.17-8.x.asciidoc">edit</a></h3>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>We strongly recommend performing the following steps on a non-production deployment first to address any potential issues before upgrading your production deployments. If you&#8217;re using a cross-cluster search environment, upgrade your remote deployments first.</p>
</div>
</div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
If you haven&#8217;t already done so, back up your cluster data to a <a href="/guide/en/elasticsearch/reference/master/snapshots-take-snapshot.html" class="ulink" target="_top">snapshot</a>.
</li>
<li class="listitem">
We recommend you <a class="xref" href="rules-api-export.html" title="Export rules">export all your custom detection rules</a> in case there are issues with the detection engine after the upgrade.
</li>
<li class="listitem">
<p>Upgrade Elasticsearch.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If you&#8217;re using Elastic Cloud, we recommend upgrades with no downtime. Refer to <a href="/guide/en/cloud/current/ec-upgrade-deployment.html" class="ulink" target="_top">these instructions</a>.
</li>
<li class="listitem">
If you&#8217;re using Elastic Cloud Enterprise (ECE), refer to <a href="/guide/en/cloud-enterprise/current/ece-upgrade-deployment.html" class="ulink" target="_top">these instructions</a>.
</li>
<li class="listitem">
If you&#8217;re using Elastic Cloud on Kubernetes (ECK), refer to <a href="/guide/en/cloud-on-k8s/current/k8s-upgrading-stack.html" class="ulink" target="_top">these instructions</a>.
</li>
<li class="listitem">
<p>If you&#8217;re upgrading a self-orchestrated deployment, refer to <a href="/guide/en/elastic-stack/master/upgrading-elasticsearch.html" class="ulink" target="_top">these instructions</a> and upgrade the data nodes tier by tier in this order:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li class="listitem">
Frozen tier
</li>
<li class="listitem">
Cold tier
</li>
<li class="listitem">
Warm tier
</li>
<li class="listitem">
Hot tier
</li>
<li class="listitem">
Any other nodes not in a tier
</li>
<li class="listitem">
All remaining nodes that are neither master-eligible nor data nodes
</li>
<li class="listitem">
Master-eligible nodes
</li>
</ol>
</div>
</li>
</ul>
</div>
</li>
<li class="listitem">
<p>Upgrade Kibana. Refer to <a href="/guide/en/elastic-stack/master/upgrading-kibana.html" class="ulink" target="_top">these instructions</a>.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>If you&#8217;re using Elastic Cloud Hosted or Elastic Cloud Enterprise, this is already included in the Elasticsearch upgrade.</p>
</div>
</div>
</li>
<li class="listitem">
<p>Validate that Elasticsearch and Kibana are operating as expected by completing the following checks:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>For Elasticsearch:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li class="listitem">
Check the status of your clusters and ensure that they&#8217;re green by running a <code class="literal">GET _cat/health</code> API request. For more information, refer to the <a href="/guide/en/elasticsearch/reference/master/cat-health.html" class="ulink" target="_top">cat health API documentation</a>.
</li>
<li class="listitem">
<p>Ensure that the index and search rate are close to what they were before upgrading. Go to <span class="strong strong"><strong>Stack Monitoring</strong></span> &#8594; <span class="strong strong"><strong>Elasticsearch</strong></span> &#8594; <span class="strong strong"><strong>Overview</strong></span>.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>You can also check the index document count using the <a href="/guide/en/elasticsearch/reference/master/cat-indices.html" class="ulink" target="_top">cat index API</a>.</p>
</div>
</div>
</li>
<li class="listitem">
Verify that SLM is taking snapshots by <a href="/guide/en/elasticsearch/reference/master/snapshots-take-snapshot.html#check-slm-history" class="ulink" target="_top">checking the SLM history</a>.
</li>
<li class="listitem">
If you use machine learning, ensure that it is up and running.
</li>
</ol>
</div>
</li>
<li class="listitem">
<p>For Kibana:</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li class="listitem">
Ensure that you and your users can successfully log in to Kibana and access desired pages.
</li>
<li class="listitem">
Check <a href="/guide/en/kibana/master/discover.html" class="ulink" target="_top">Discover</a> and verify that the index patterns you typically use are available.
</li>
<li class="listitem">
Verify that your commonly used <a href="/guide/en/kibana/master/dashboard.html" class="ulink" target="_top">dashboards</a> are available and working properly.
</li>
<li class="listitem">
If you use any Watcher-based Kibana scheduled <a href="/guide/en/kibana/master/reporting-getting-started.html" class="ulink" target="_top">reporting</a>, ensure that it&#8217;s working properly.
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
<li class="listitem">
Upgrade your ingest components (such as Logstash, Fleet and Elastic Agent, Beats, etc.). For details, refer to the <a href="/guide/en/elastic-stack/master/upgrading-elastic-stack.html" class="ulink" target="_top">Elastic Stack upgrade docs</a>.
</li>
<li class="listitem">
<p>Validate that Ingest is operating correctly.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Open <span class="strong strong"><strong>Discover</strong></span>, go through data views for each of your expected ingest data streams, and ensure that data is being ingested in the expected format and volume.
</li>
</ol>
</div>
</li>
<li class="listitem">
<p>Validate that Elastic Security is operating correctly.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Re-enable your desired SIEM detection rules (rule management), and ensure that enabled rules are running without errors or warnings (rule monitoring).
</li>
<li class="listitem">
Ensure that any SOAR workflows that consume alerts are working.
</li>
<li class="listitem">
Verify that any custom dashboards your team has created are working properly, especially if they operate on alert documents.
</li>
</ol>
</div>
</li>
<li class="listitem">
If you performed these steps on a non-production deployment, repeat these same steps on your production environment. If you&#8217;re using a cross-cluster search environment and performed these steps on your remote clusters, repeat these same steps on your other deployments.
</li>
<li class="listitem">
Confirm with your appropriate stakeholders that the upgrade process has been successful.
</li>
</ol>
</div>
<h3><a id="_post_upgrade_steps"></a>Post-upgrade steps<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/upgrade/upgrade-7.17-8.x.asciidoc">edit</a></h3>
<p>The following sections describe procedures to complete after upgrading Elastic Security to 8.x.</p>
<h4><a id="reenable-rules-upgrade"></a>Re-enable disabled rules<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/upgrade/upgrade-7.17-8.x.asciidoc">edit</a></h4>
<p>Any active rules when you upgrade from 7.17 to 8.0.1 or newer are automatically disabled, and a tag named <code class="literal">auto_disabled_8.0</code> is added to those rules for tracking purposes. Once the upgrade is complete, you can filter rules by the new tag, then use bulk actions to re-enable them:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Go to the Rules page (<span class="strong strong"><strong>Detect &#8594; Rules</strong></span>).
</li>
<li class="listitem">
From the <span class="strong strong"><strong>Tags</strong></span> dropdown, search for <code class="literal">auto_disabled_8.0</code>.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Select all <em>x</em> rules</strong></span>, or individually select the rules you want to re-enable.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Bulk actions &#8594; Enable</strong></span> to re-enable the rules.
</li>
</ol>
</div>
<p>Alternatively, you can use the <a class="xref" href="bulk-actions-rules-api.html" title="Bulk rule actions">Bulk rule actions</a> API to re-enable rules.</p>
<h4><a id="fda-upgrade"></a>Full Disk Access (FDA) approval for Elastic Endpoint<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/upgrade/upgrade-7.17-8.x.asciidoc">edit</a></h4>
<p>When you manually install Elastic Endpoint, you must approve a system extension, kernel extension, and enable Full Disk Access (FDA). There is a new FDA requirement in 8.x. Refer to <a class="xref" href="elastic-endpoint-deploy-reqs.html" title="Elastic Endpoint requirements"><em>Elastic Endpoint requirements</em></a> to review the required permissions.</p>
<h4><a id="data-views-upgrade"></a>Requirements to display Data views in the Elastic Security app<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/upgrade/upgrade-7.17-8.x.asciidoc">edit</a></h4>
<p>To make the <span class="strong strong"><strong>Data view</strong></span> option appear in an environment with legacy alerts, a user with elevated role privileges must visit the Elastic Security app, open a page that displays alert data (at least one alert must be present), and then refresh the page. The user&#8217;s role privileges must allow them to enable the detections feature in a Kibana space. For more information, refer to <a class="xref" href="detections-permissions-section.html#enable-detections-ui" title="Enable and access detections">Enable and access detections</a>.</p>
<h4><a id="alert-schema-upgrade"></a>New alert schema<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/upgrade/upgrade-7.17-8.x.asciidoc">edit</a></h4>
<p>The system index for detection alerts has been renamed from <code class="literal">.siem-signals-&lt;space-id&gt;</code> to <code class="literal">.alerts-security.alerts-&lt;space-id&gt;</code> and is now a hidden index. Therefore, the schema used for alert documents in Elastic Security has changed. Users that access documents in the <code class="literal">.siem-signals</code> indices using the Elastic Security API must modify their API queries and scripts to operate properly on the new 8.x alert documents. Refer to <a class="xref" href="query-alert-indices.html" title="Query alert indices">how to query alert indices</a> and review the new <a class="xref" href="alert-schema.html" title="Alert schema">Alert schema</a>.</p>
<h4><a id="preview-upgrade"></a>New privileges required to view alerts and preview rules<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/upgrade/upgrade-7.17-8.x.asciidoc">edit</a></h4>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
To view alerts, users need <code class="literal">manage</code>, <code class="literal">write</code>, <code class="literal">read</code>, and <code class="literal">view_index_metadata</code> privileges for two new indices, <code class="literal">.alerts-security.alerts</code> and <code class="literal">.internal.alerts-security.alerts</code>. Existing users who are upgrading to 8.x can retain their privileges to the <code class="literal">.siem-signals</code> index.
</li>
<li class="listitem">
To <a class="xref" href="rules-ui-create.html#preview-rules" title="Preview your rule (optional)">preview rules</a>, users need <code class="literal">read</code> access to the new <code class="literal">.preview.alerts-security.alerts</code> index. Refer to <a class="xref" href="detections-permissions-section.html" title="Detections prerequisites and requirements">Detections prerequisites and requirements</a> for more information.
</li>
</ul>
</div>
<h4><a id="im-rules-upgrade"></a>Updates to indicator match rules<a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/upgrade/upgrade-7.17-8.x.asciidoc">edit</a></h4>
<p>Changes to the indicator match rule type&#8217;s <a class="xref" href="rules-ui-create.html#rule-ui-advanced-params" title="Configure advanced rule settings (optional)">default threat indicator path</a> might require you to update existing rules or create new ones after upgrading to 8.x. Be mindful of the following:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If an indicator match rule&#8217;s default threat indicator path was not defined before the upgrade, it will default to <code class="literal">threatintel.indicator</code> after the upgrade. This allows the rule to continue using indicator data ingested by Filebeat version 7.x. If a custom value was defined before the upgrade, the value will not change.
</li>
<li class="listitem">
If an existing indicator match rule was configured to use threat indicator indices generated from Filebeat version 7.x, updating the default threat indicator path to <code class="literal">threat.indicator</code> after you upgrade to Elastic Stack version 8.x and Elastic Agent or Filebeat version 8.x configures the rule to use threat indicator indices generated by those later versions.
</li>
<li class="listitem">
You must create separate rules to query threat intelligence indices created by Filebeat version 7.x and version 8.x because each version requires a different default threat indicator path value. Review the recommendations for <a class="xref" href="query-alert-indices.html" title="Query alert indices">querying alert indices</a>.
</li>
</ul>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="upgrade-intro.html">« Upgrade Elastic Security to 8.16.0</a>
</span>
<span class="next">
<a href="post-upgrade-intro.html">Post-upgrade steps (optional) »</a>
</span>
</div>
</body>
</html>
