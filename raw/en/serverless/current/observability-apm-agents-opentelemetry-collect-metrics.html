<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Collect metrics | Serverless | Elastic</title>
<meta class="elastic" name="content" content="Collect metrics | Serverless">

<link rel="home" href="index.html" title="Serverless"/>
<link rel="up" href="observability-apm-agents-opentelemetry.html" title="Use OpenTelemetry with APM"/>
<link rel="prev" href="observability-apm-agents-opentelemetry-opentelemetry-native-support.html" title="Upstream OpenTelemetry Collectors and language SDKs"/>
<link rel="next" href="observability-apm-agents-opentelemetry-limitations.html" title="Limitations"/>
<meta class="elastic" name="product_version" content="main"/>
<meta class="elastic" name="product_name" content="Serverless"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Serverless/Guide"/>
<meta name="DC.subject" content="Serverless"/>
<meta name="DC.identifier" content="main"/>
</head>
<body>
<div class="navheader">
<span class="prev">
<a href="observability-apm-agents-opentelemetry-opentelemetry-native-support.html">« Upstream OpenTelemetry Collectors and language SDKs</a>
</span>
<span class="next">
<a href="observability-apm-agents-opentelemetry-limitations.html">Limitations »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Serverless</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="what-is-observability-serverless.html">Elastic Observability Serverless</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="application-and-service-monitoring.html">Application and service monitoring</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="observability-apm.html">Application performance monitoring (APM)</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="observability-apm-send-data-to-elastic.html">Send APM data to Elastic</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="observability-apm-agents-opentelemetry.html">Use OpenTelemetry with APM</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Collect metrics</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/serverless/apm-agents/apm-agents-opentelemetry-collect-metrics.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h6 class="title"><a id="observability-apm-agents-opentelemetry-collect-metrics"></a>Collect metrics</h6><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/serverless/apm-agents/apm-agents-opentelemetry-collect-metrics.asciidoc">edit</a></div>
</div></div></div>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>When collecting metrics, please note that the <a href="https://www.javadoc.io/doc/io.opentelemetry/opentelemetry-api/latest/io/opentelemetry/api/metrics/DoubleValueRecorder.html" class="ulink" target="_top"><code class="literal">DoubleValueRecorder</code></a>
and <a href="https://www.javadoc.io/doc/io.opentelemetry/opentelemetry-api/latest/io/opentelemetry/api/metrics/LongValueObserver.html" class="ulink" target="_top"><code class="literal">LongValueRecorder</code></a> metrics are not yet supported.</p>
</div>
</div>
<p>Here&#8217;s an example of how to capture business metrics from a Java application.</p>
<div class="pre_wrapper lang-java">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-java">// initialize metric
Meter meter = GlobalMetricsProvider.getMeter("my-frontend");
DoubleCounter orderValueCounter = meter.doubleCounterBuilder("order_value").build();

public void createOrder(HttpServletRequest request) {

   // create order in the database
   ...
   // increment business metrics for monitoring
   orderValueCounter.add(orderPrice);
}</pre>
</div>
<p>See the <a href="https://github.com/open-telemetry/opentelemetry-specification/blob/main/specification/metrics/api.md" class="ulink" target="_top">Open Telemetry Metrics API</a>
for more information.</p>
<div class="position-relative"><h8><a id="open-telemetry-verify-metrics"></a>Verify OpenTelemetry metrics data</h8><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/serverless/apm-agents/apm-agents-opentelemetry-collect-metrics.asciidoc">edit</a></div>
<p>Use <span class="strong strong"><strong>Discover</strong></span> to validate that metrics are successfully reported to your project.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Open your Observability project.
</li>
<li class="listitem">
In your Elastic Observability Serverless project, go to <span class="strong strong"><strong>Discover</strong></span>, and select the <span class="strong strong"><strong>Logs Explorer</strong></span> tab.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>All logs</strong></span> → <span class="strong strong"><strong>Data Views</strong></span> then select <span class="strong strong"><strong>APM</strong></span>.
</li>
<li class="listitem">
Filter the data to only show documents with metrics: <code class="literal">processor.name :"metric"</code>
</li>
<li class="listitem">
Narrow your search with a known OpenTelemetry field. For example, if you have an <code class="literal">order_value</code> field, add <code class="literal">order_value: *</code> to your search to return
only OpenTelemetry metrics documents.
</li>
</ol>
</div>
<div class="position-relative"><h8><a id="open-telemetry-visualize"></a>Visualize</h8><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/serverless/apm-agents/apm-agents-opentelemetry-collect-metrics.asciidoc">edit</a></div>
<p>Use <span class="strong strong"><strong>Lens</strong></span> to create visualizations for OpenTelemetry metrics. Lens enables you to build visualizations by dragging and dropping data fields. It makes smart visualization suggestions for your data, allowing you to switch between visualization types.</p>
<p>To get started with a new Lens visualization:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
In your Elastic Observability Serverless project, go to <span class="strong strong"><strong>Visualizations</strong></span>.
</li>
<li class="listitem">
Click <span class="strong strong"><strong>Create new visualization</strong></span>.
</li>
<li class="listitem">
Select <span class="strong strong"><strong>Lens</strong></span>.
</li>
</ol>
</div>
<p>For more information on using Lens, refer to the <a href="/guide/en/kibana/8.16/lens.html" class="ulink" target="_top">Lens documentation</a>.</p>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="observability-apm-agents-opentelemetry-opentelemetry-native-support.html">« Upstream OpenTelemetry Collectors and language SDKs</a>
</span>
<span class="next">
<a href="observability-apm-agents-opentelemetry-limitations.html">Limitations »</a>
</span>
</div>
</body>
</html>
