<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Prevent Elastic Agent uninstallation | Serverless | Elastic</title>
<meta class="elastic" name="content" content="Prevent Elastic Agent uninstallation | Serverless">

<link rel="home" href="index.html" title="Serverless"/>
<link rel="up" href="security-install-edr.html" title="Install the Elastic Defend integration"/>
<link rel="prev" href="security-deploy-with-mdm.html" title="Deploy Elastic Defend on macOS with mobile device management"/>
<link rel="next" href="security-endpoint-management-req.html" title="Elastic Defend feature privileges"/>
<meta class="elastic" name="product_version" content="main"/>
<meta class="elastic" name="product_name" content="Serverless"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Serverless/Guide"/>
<meta name="DC.subject" content="Serverless"/>
<meta name="DC.identifier" content="main"/>
</head>
<body>
<div class="navheader">
<span class="prev">
<a href="security-deploy-with-mdm.html">« Deploy Elastic Defend on macOS with mobile device management</a>
</span>
<span class="next">
<a href="security-endpoint-management-req.html">Elastic Defend feature privileges »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Serverless</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="what-is-security-serverless.html">Elastic Security serverless</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="security-endpoint-protection-intro.html">Configure endpoint protection with Elastic Defend</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="security-install-edr.html">Install the Elastic Defend integration</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Prevent Elastic Agent uninstallation</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/serverless/edr-install-config/agent-tamper-protection.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h4 class="title"><a id="security-agent-tamper-protection"></a>Prevent Elastic Agent uninstallation</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/serverless/edr-install-config/agent-tamper-protection.asciidoc">edit</a></div>
</div></div></div>
<p>For hosts enrolled in Elastic Defend, you can prevent unauthorized attempts to uninstall Elastic Agent and Elastic Endpoint by enabling <span class="strong strong"><strong>Agent tamper protection</strong></span> on the Agent policy. This offers an additional layer of security by preventing users from bypassing or disabling Elastic Defend&#8217;s endpoint protections.</p>
<p>When enabled, Elastic Agent and Elastic Endpoint can only be uninstalled on the host by including an uninstall token in the uninstall CLI command. One unique uninstall token is generated per Agent policy, and you can retrieve uninstall tokens in an Agent policy&#8217;s settings or in the Fleet UI.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p class="admon_title">Requirements</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Agent tamper protection requires the Endpoint Protection Complete <a class="xref" href="elasticsearch-manage-project.html" title="Manage performance and general settings">project feature</a>.
</li>
<li class="listitem">
Hosts must be enrolled in the Elastic Defend integration.
</li>
<li class="listitem">
Elastic Agents must be version 8.11.0 or later.
</li>
<li class="listitem">
This feature is supported for all operating systems.
</li>
</ul>
</div>
</div>
</div>
<div class="imageblock screenshot">
<div class="content">
<img src="images/agent-tamper-protection/agent-tamper-protection.png" alt="Agent tamper protection setting highlighted on Agent policy settings page">
</div>
</div>
<div class="position-relative"><h6><a id="enable-agent-tamper-protection"></a>Enable Agent tamper protection</h6><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/serverless/edr-install-config/agent-tamper-protection.asciidoc">edit</a></div>
<p>You can enable Agent tamper protection by configuring the Elastic Agent policy.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Go to <span class="strong strong"><strong>Fleet</strong></span> &#8594; <span class="strong strong"><strong>Agent policies</strong></span>, then select the Agent policy you want to configure.
</li>
<li class="listitem">
Select the <span class="strong strong"><strong>Settings</strong></span> tab on the policy details page.
</li>
<li class="listitem">
<p>In the <span class="strong strong"><strong>Agent tamper protection</strong></span> section, turn on the <span class="strong strong"><strong>Prevent agent tampering</strong></span> setting.</p>
<p>This makes the <span class="strong strong"><strong>Get uninstall command</strong></span> link available, which you can follow to get the uninstall token and CLI command if you need to <a class="xref" href="security-uninstall-agent.html" title="Uninstall Elastic Agent">uninstall an Agent</a> on this policy.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>You can also access an Agent policy&#8217;s uninstall tokens on the <span class="strong strong"><strong>Uninstall tokens</strong></span> tab on the <span class="strong strong"><strong>Fleet</strong></span> page. Refer to <a class="xref" href="security-agent-tamper-protection.html#fleet-uninstall-tokens" title="Access uninstall tokens">Access uninstall tokens</a> for more information.</p>
</div>
</div>
</li>
<li class="listitem">
Select <span class="strong strong"><strong>Save changes</strong></span>.
</li>
</ol>
</div>
<div class="position-relative"><h6><a id="fleet-uninstall-tokens"></a>Access uninstall tokens</h6><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/serverless/edr-install-config/agent-tamper-protection.asciidoc">edit</a></div>
<p>If you need the uninstall token to remove Elastic Agent from an endpoint, you can find it in several ways:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>On the Agent policy</strong></span> — Go to the Agent policy&#8217;s <span class="strong strong"><strong>Settings</strong></span> tab, then click the <span class="strong strong"><strong>Get uninstall command</strong></span> link. The <span class="strong strong"><strong>Uninstall agent</strong></span> flyout opens, containing the full uninstall command with the token.
</li>
<li class="listitem">
<p><span class="strong strong"><strong>On the Fleet page</strong></span> — Go to <span class="strong strong"><strong>Fleet</strong></span> &#8594; <span class="strong strong"><strong>Uninstall tokens</strong></span> for a list of the uninstall tokens generated for your Agent policies. You can:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Click the <span class="strong strong"><strong>Show token</strong></span> icon in the <span class="strong strong"><strong>Token</strong></span> column to reveal a specific token.
</li>
<li class="listitem">
Click the <span class="strong strong"><strong>View uninstall command</strong></span> icon in the <span class="strong strong"><strong>Actions</strong></span> column to open the <span class="strong strong"><strong>Uninstall agent</strong></span> flyout, containing the full uninstall command with the token.
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="security-deploy-with-mdm.html">« Deploy Elastic Defend on macOS with mobile device management</a>
</span>
<span class="next">
<a href="security-endpoint-management-req.html">Elastic Defend feature privileges »</a>
</span>
</div>
</body>
</html>
