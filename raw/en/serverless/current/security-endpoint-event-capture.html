<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="description" content="">
<title>Event capture and Elastic Defend | Serverless | Elastic</title>
<meta class="elastic" name="content" content="Event capture and Elastic Defend | Serverless">

<link rel="home" href="index.html" title="Serverless"/>
<link rel="up" href="security-manage-endpoint-protection.html" title="Manage Elastic Defend"/>
<link rel="prev" href="security-optimize-edr.html" title="Optimize Elastic Defend"/>
<link rel="next" href="security-allowlist-endpoint.html" title="Allowlist Elastic Endpoint in third-party antivirus apps"/>
<meta class="elastic" name="product_version" content="main"/>
<meta class="elastic" name="product_name" content="Serverless"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Serverless/Guide"/>
<meta name="DC.subject" content="Serverless"/>
<meta name="DC.identifier" content="main"/>
</head>
<body>
<div class="navheader">
<span class="prev">
<a href="security-optimize-edr.html">« Optimize Elastic Defend</a>
</span>
<span class="next">
<a href="security-allowlist-endpoint.html">Allowlist Elastic Endpoint in third-party antivirus apps »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Serverless</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="what-is-security-serverless.html">Elastic Security serverless</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="security-manage-endpoint-protection.html">Manage Elastic Defend</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Event capture and Elastic Defend</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/serverless/edr-manage/endpoint-event-capture.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="security-endpoint-event-capture"></a>Event capture and Elastic Defend</h3><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/serverless/edr-manage/endpoint-event-capture.asciidoc">edit</a></div>
</div></div></div>
<p>Elastic Defend collects select data on system activity in order to detect and prevent as many threats as possible, while balancing storage and performance overhead. To that end, Elastic Defend isn&#8217;t designed to capture all system events. Some event data that Elastic Defend generates gets aggregated, truncated, or deduplicated as needed to optimize threat detection and prevention.</p>
<p>You can supplement Elastic Defend&#8217;s protection capabilities with <a href="https://docs.elastic.co/en/integrations" class="ulink" target="_top">Elastic integrations</a> and tools that provide more visibility and historical data. Consult the following sections to expand data collection for specific types of system events.</p>
<div class="position-relative"><h5><a id="security-endpoint-event-capture-network-port-creation-and-deletion"></a>Network port creation and deletion</h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/serverless/edr-manage/endpoint-event-capture.asciidoc">edit</a></div>
<p>Elastic Defend tracks TCP connections. If a port is created but no traffic flows, no events are generated.</p>
<p>For complete capture of network port creation and deletion, consider capturing Windows event ID 5158 using the <a href="https://docs.elastic.co/en/integrations/winlog" class="ulink" target="_top">Custom Windows Event Logs</a> integration.</p>
<div class="position-relative"><h5><a id="security-endpoint-event-capture-network-inout-connections"></a>Network in/out connections</h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/serverless/edr-manage/endpoint-event-capture.asciidoc">edit</a></div>
<p>Elastic Defend tracks TCP connections, which don&#8217;t include network in/out connections.</p>
<p>For complete network capture, consider deploying Packetbeat using the <a href="https://docs.elastic.co/en/integrations/network_traffic" class="ulink" target="_top">Network Packet Capture</a> integration.</p>
<div class="position-relative"><h5><a id="security-endpoint-event-capture-user-behavior"></a>User behavior</h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/serverless/edr-manage/endpoint-event-capture.asciidoc">edit</a></div>
<p>Elastic Defend only captures user security events required by its behavioral protection. This doesn&#8217;t include every user event such as logins and logouts, or every time a user account is created, deleted, or modified.</p>
<p>For complete capture of all or specific Windows security events, consider the <a href="https://docs.elastic.co/en/integrations/winlog" class="ulink" target="_top">Custom Windows Event Logs</a> integration.</p>
<div class="position-relative"><h5><a id="security-endpoint-event-capture-system-service-registration-deletion-and-modification"></a>System service registration, deletion, and modification</h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/serverless/edr-manage/endpoint-event-capture.asciidoc">edit</a></div>
<p>Elastic Defend only captures system service security events required by its behavioral protection engine. Service creation and modification can also be detected in registry activity, for which Elastic Defend has internal rules such as <a href="https://github.com/elastic/protections-artifacts/blob/6d54ae289b290b1d42a7717569483f6ce907200a/behavior/rules/persistence_registry_or_file_modification_from_suspicious_memory.toml" class="ulink" target="_top">Registry or File Modification from Suspicious Memory</a>.</p>
<p>For complete capture of all or specific Windows security events, consider the <a href="https://docs.elastic.co/en/integrations/winlog" class="ulink" target="_top">Custom Windows Event Logs</a> integration. In particular, capture events such as <a href="https://learn.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4697" class="ulink" target="_top">Windows event ID 4697</a>.</p>
<div class="position-relative"><h5><a id="security-endpoint-event-capture-kernel-driver-registration-deletion-and-queries"></a>Kernel driver registration, deletion, and queries</h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/serverless/edr-manage/endpoint-event-capture.asciidoc">edit</a></div>
<p>Elastic Defend scans every driver as it is loaded, but it doesn&#8217;t generate an event each time.</p>
<p>Drivers are registered in the system as system services. You can capture this with Windows event ID 4697 using the <a href="https://docs.elastic.co/en/integrations/winlog" class="ulink" target="_top">Custom Windows Event Logs</a> integration.</p>
<p>Also consider capturing Windows event ID 6 using Winlogbeat&#8217;s <a href="/guide/en/beats/winlogbeat/master/winlogbeat-module-sysmon.html" class="ulink" target="_top">Sysmon module</a>.</p>
<div class="position-relative"><h5><a id="security-endpoint-event-capture-system-configuration-file-creation-modification-and-deletion"></a>System configuration file creation, modification, and deletion</h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/serverless/edr-manage/endpoint-event-capture.asciidoc">edit</a></div>
<p>Elastic Defend tracks creation, modification, and deletion of all files on the system. However, as mentioned above, the data might be aggregated, truncated, or deduplicated to provide only what&#8217;s required for threat detection and prevention.</p>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="security-optimize-edr.html">« Optimize Elastic Defend</a>
</span>
<span class="next">
<a href="security-allowlist-endpoint.html">Allowlist Elastic Endpoint in third-party antivirus apps »</a>
</span>
</div>
</body>
</html>
