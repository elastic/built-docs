<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Enable threat intelligence integrations | Serverless | Elastic</title>
<meta class="elastic" name="content" content="Enable threat intelligence integrations | Serverless">

<link rel="home" href="index.html" title="Serverless"/>
<link rel="up" href="security-ingest-data.html" title="Ingest data to Elastic Security"/>
<link rel="prev" href="security-ingest-data.html" title="Ingest data to Elastic Security"/>
<link rel="next" href="security-automatic-import.html" title="Automatic Import"/>
<meta class="elastic" name="product_version" content="main"/>
<meta class="elastic" name="product_name" content="Serverless"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Serverless/Guide"/>
<meta name="DC.subject" content="Serverless"/>
<meta name="DC.identifier" content="main"/>
</head>
<body>
<div class="navheader">
<span class="prev">
<a href="security-ingest-data.html">« Ingest data to Elastic Security</a>
</span>
<span class="next">
<a href="security-automatic-import.html">Automatic Import »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Serverless</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="what-is-security-serverless.html">Elastic Security Serverless</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="security-ingest-data.html">Ingest data to Elastic Security</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Enable threat intelligence integrations</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/serverless/ingest/threat-intelligence.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="security-threat-intelligence"></a>Enable threat intelligence integrations</h3><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/serverless/ingest/threat-intelligence.asciidoc">edit</a></div>
</div></div></div>
<p>The Threat Intelligence view provides a streamlined way to collect threat intelligence data that you can use for threat detection and matching. Threat intelligence data consists of  <a class="xref" href="security-indicators-of-compromise.html#ti-indicators" title="Threat intelligence and indicators">threat indicators</a> ingested from third-party threat intelligence sources.</p>
<p>Threat indicators describe potential threats, unusual behavior, or malicious activity on a network or in an environment. They are commonly used in indicator match rules to detect and match known threats. When an indicator match rule generates an alert, it includes information about the matched threat indicator.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>To learn more about alerts with threat intelligence, visit <a class="xref" href="security-view-alert-details.html" title="View detection alert details">View alert details</a>.</p>
</div>
</div>
<p>Refer to the following sections to learn how to connect to threat intelligence sources using an <a class="xref" href="security-threat-intelligence.html#agent-ti-integration" title="Add an Elastic Agent integration">Elastic Agent integration</a>, the <a class="xref" href="security-threat-intelligence.html#ti-mod-integration" title="Add a Filebeat Threat Intel module integration">Threat Intel module</a>, or a <a class="xref" href="security-threat-intelligence.html#custom-ti-integration" title="Add a custom integration">custom integration</a>.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/es-threat-intel-integrations/-getting-started-threat-intelligence-view.png" alt="The Threat Intelligence view on the Overview dashboard">
</div>
</div>
<p>There are a few scenarios when data won&#8217;t display in the Threat Intelligence view:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
If you&#8217;ve chosen a time range that doesn&#8217;t contain threat indicator event data, you are prompted to choose a different range. Use the date and time picker in the Elastic Security app to select a new range to analyze.
</li>
<li class="listitem">
If the Elastic Agent or Filebeat agent hasn&#8217;t ingested Threat Intel module data yet, the threat indicator event counts won&#8217;t load. You can wait for data to be ingested or reach out to your administrator for help resolving this.
</li>
</ul>
</div>
<div class="position-relative"><h5><a id="agent-ti-integration"></a>Add an Elastic Agent integration</h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/serverless/ingest/threat-intelligence.asciidoc">edit</a></div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Install a <a href="/guide/en/fleet/master/install-fleet-managed-elastic-agent.html" class="ulink" target="_top">Fleet-managed Elastic Agent</a> on the hosts you want to monitor.
</li>
<li class="listitem">
<p>In the Threat Intelligence view, click <span class="strong strong"><strong>Enable sources</strong></span> to view the Integrations page. Scroll down and select <span class="strong strong"><strong>Elastic Agent only</strong></span> to filter by Elastic Agent integrations.</p>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>If you know the name of Elastic Agent integration you want to install, you can search for it directly. Alternatively, choose the <span class="strong strong"><strong>Threat Intelligence</strong></span> category to display a list of available <a href="https://docs.elastic.co/en/integrations/threat-intelligence-intro" class="ulink" target="_top">threat intelligence integrations</a>.</p>
</div>
</div>
</li>
<li class="listitem">
Select an Elastic Agent integration, then complete the installation steps.
</li>
<li class="listitem">
Return to the Threat Intelligence view on the Overview dashboard. If indicator data isn&#8217;t displaying, refresh the page or refer to these <a class="xref" href="security-indicators-of-compromise.html#troubleshoot-indicators-page" title="Troubleshooting">troubleshooting steps</a>.
</li>
</ol>
</div>
<div class="position-relative"><h5><a id="ti-mod-integration"></a>Add a Filebeat Threat Intel module integration</h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/serverless/ingest/threat-intelligence.asciidoc">edit</a></div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<p>Set up the <a href="/guide/en/beats/filebeat/master/filebeat-installation-configuration.html" class="ulink" target="_top">Filebeat agent</a> and enable the Threat Intel module.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>For more information about enabling available threat intelligence filesets, refer to <a href="/guide/en/beats/filebeat/master/filebeat-module-threatintel.html" class="ulink" target="_top">Threat Intel module</a>.</p>
</div>
</div>
</li>
<li class="listitem">
<p>Update the <code class="literal">securitySolution:defaultThreatIndex</code> <a class="xref" href="security-advanced-settings.html#update-threat-intel-indices" title="Update default Elastic Security threat intelligence indices">advanced setting</a> by adding the appropriate index pattern name after the default Fleet threat intelligence index pattern (<code class="literal">logs-ti*</code>):</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
If you&#8217;re <em>only</em> using Filebeat version 8.x, add the appropriate Filebeat threat intelligence index pattern. For example, <code class="literal">logs-ti*</code>, <code class="literal">filebeat-8*</code>.
</li>
<li class="listitem">
If you&#8217;re using a previous version of Filebeat <em>and</em> a current one, differentiate between the threat intelligence indices by using unique index pattern names. For example, if you’re using Filebeat version 7.0.0 and 8.0.0, update the setting to <code class="literal">logs-ti*</code>,<code class="literal">filebeat-7*</code>,<code class="literal">filebeat-8*</code>.
</li>
</ol>
</div>
</li>
<li class="listitem">
Return to the Threat Intelligence view on the Overview dashboard. Refresh the page if indicator data isn&#8217;t displaying.
</li>
</ol>
</div>
<div class="position-relative"><h5><a id="custom-ti-integration"></a>Add a custom integration</h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/serverless/ingest/threat-intelligence.asciidoc">edit</a></div>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Set up a way to <a class="xref" href="security-ingest-data.html" title="Ingest data to Elastic Security">ingest data</a> into your system.
</li>
<li class="listitem">
<p>Update the <code class="literal">securitySolution:defaultThreatIndex</code> <a class="xref" href="security-advanced-settings.html#update-threat-intel-indices" title="Update default Elastic Security threat intelligence indices">advanced setting</a> by adding the appropriate index pattern name after the default Fleet threat intelligence index pattern (<code class="literal">logs-ti*</code>), for example, <code class="literal">logs-ti*</code>,<code class="literal">custom-ti-index*</code>.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Threat intelligence indices aren’t required to be ECS compatible. However, we strongly recommend compatibility if you’d like your alerts to be enriched with relevant threat indicator information. You can find a list of ECS-compliant threat intelligence fields at <a href="/guide/en/ecs/8.17/ecs-threat.html" class="ulink" target="_top">Threat Fields</a>.</p>
</div>
</div>
</li>
<li class="listitem">
<p>Return to the Threat Intelligence view on the Overview dashboard (<span class="strong strong"><strong>Dashboards</strong></span> → <span class="strong strong"><strong>Overview</strong></span>). Refresh the page if indicator data isn&#8217;t displaying.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The Threat Intelligence view searches for a <code class="literal">threat.feed.name</code> field value to define the source name in the <span class="strong strong"><strong>Name</strong></span> column. If a custom source doesn&#8217;t have the <code class="literal">threat.feed.name</code> field or hasn&#8217;t defined a <code class="literal">threat.feed.name</code> field value, it&#8217;s considered unnamed and labeled as <span class="strong strong"><strong>Other</strong></span>. Dashboards aren&#8217;t created for unnamed sources unless the <code class="literal">threat.feed.dashboard_id</code> field is defined.</p>
</div>
</div>
</li>
</ol>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="security-ingest-data.html">« Ingest data to Elastic Security</a>
</span>
<span class="next">
<a href="security-automatic-import.html">Automatic Import »</a>
</span>
</div>
</body>
</html>
