<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Create an APM anomaly rule | Serverless | Elastic</title>
<meta class="elastic" name="content" content="Create an APM anomaly rule | Serverless">

<link rel="home" href="index.html" title="Serverless"/>
<link rel="up" href="observability-create-manage-rules.html" title="Create and manage rules"/>
<link rel="prev" href="observability-aiops-generate-anomaly-alerts.html" title="Create an anomaly detection rule"/>
<link rel="next" href="observability-create-custom-threshold-alert-rule.html" title="Create a custom threshold rule"/>
<meta class="elastic" name="product_version" content="main"/>
<meta class="elastic" name="product_name" content="Serverless"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Serverless/Guide"/>
<meta name="DC.subject" content="Serverless"/>
<meta name="DC.identifier" content="main"/>
</head>
<body>
<div class="navheader">
<span class="prev">
<a href="observability-aiops-generate-anomaly-alerts.html">« Create an anomaly detection rule</a>
</span>
<span class="next">
<a href="observability-create-custom-threshold-alert-rule.html">Create a custom threshold rule »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Serverless</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="what-is-observability-serverless.html">Elastic Observability serverless</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="observability-alerting.html">Alerting</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="observability-create-manage-rules.html">Create and manage rules</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Create an APM anomaly rule</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/serverless/alerting/create-anomaly-alert-rule.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h4 class="title"><a id="observability-create-anomaly-alert-rule"></a>Create an APM anomaly rule</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/serverless/alerting/create-anomaly-alert-rule.asciidoc">edit</a></div>
</div></div></div>

<p><span class="Admonishment Admonishment--preview">
[<span class="Admonishment-title u-mono">preview</span>]
<span class="Admonishment-detail">
This functionality is in technical preview and may be changed or removed in a future release. Elastic will work to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.
</span>
</span></p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p class="admon_title">Required role</p>
<p>The <span class="strong strong"><strong>Editor</strong></span> role or higher is required to create anomaly rules. To learn more, refer to <a class="xref" href="general-assign-user-roles.html" title="Assign user roles and privileges">Assign user roles and privileges</a>.</p>
</div>
</div>
<p>You can create an anomaly rule to alert you when either the latency, throughput, or failed transaction rate of a service is abnormal. Anomaly rules can be set at different levels: environment, service, and/or transaction type. Add actions to raise alerts via services or third-party integrations (for example, send an email or create a Jira issue).</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/alerts-create-apm-anomaly.png" alt="Create rule for APM anomaly alert">
</div>
</div>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>These steps show how to use the <span class="strong strong"><strong>Alerts</strong></span> UI.
You can also create an anomaly rule directly from any page within <span class="strong strong"><strong>Applications</strong></span>. Click the <span class="strong strong"><strong>Alerts and rules</strong></span> button, and select <span class="strong strong"><strong>Create anomaly rule</strong></span>. When you create a rule this way, the <span class="strong strong"><strong>Name</strong></span> and <span class="strong strong"><strong>Tags</strong></span> fields will be prepopulated but you can still change these.</p>
</div>
</div>
<p>To create your anomaly rule:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
In your Elastic Observability Serverless project, go to <span class="strong strong"><strong>Alerts</strong></span>.
</li>
<li class="listitem">
Select <span class="strong strong"><strong>Manage Rules</strong></span> from the <span class="strong strong"><strong>Alerts</strong></span> page, and select <span class="strong strong"><strong>Create rule</strong></span>.
</li>
<li class="listitem">
Enter a <span class="strong strong"><strong>Name</strong></span> for your rule, and any optional <span class="strong strong"><strong>Tags</strong></span> for more granular reporting (leave blank if unsure).
</li>
<li class="listitem">
Select the <span class="strong strong"><strong>APM Anomaly</strong></span> rule type.
</li>
<li class="listitem">
Select the appropriate <span class="strong strong"><strong>Service</strong></span>, <span class="strong strong"><strong>Type</strong></span>, and <span class="strong strong"><strong>Environment</strong></span> (or leave <span class="strong strong"><strong>ALL</strong></span> to include all options).
</li>
<li class="listitem">
Select the desired severity (critical, major, minor, warning) from <span class="strong strong"><strong>Has anomaly with severity</strong></span>.
</li>
<li class="listitem">
Define the interval to check the rule (for example, check every 1 minute).
</li>
<li class="listitem">
(Optional) Set up <span class="strong strong"><strong>Actions</strong></span>.
</li>
<li class="listitem">
<span class="strong strong"><strong>Save</strong></span> your rule.
</li>
</ol>
</div>
<div class="position-relative"><h6><a id="observability-create-anomaly-alert-rule-add-actions"></a>Add actions</h6><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/serverless/alerting/create-anomaly-alert-rule.asciidoc">edit</a></div>
<p>You can extend your rules with actions that interact with third-party systems, write to logs or indices, or send user notifications. You can add an action to a rule at any time. You can create rules without adding actions, and you can also define multiple actions for a single rule.</p>
<p>To add actions to rules, you must first create a connector for that service (for example, an email or external incident management system), which you can then use for different rules, each with their own action frequency.</p>
<details>
<summary class="title">Connector types</summary>
<div class="content">
<p>Connectors provide a central place to store connection information for services and integrations with third party systems.
The following connectors are available when defining actions for alerting rules:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="/guide/en/kibana/8.15/cases-action-type.html" class="ulink" target="_top">Cases</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.15/d3security-action-type.html" class="ulink" target="_top">D3 Security</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.15/email-action-type.html" class="ulink" target="_top">Email</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.15/resilient-action-type.html" class="ulink" target="_top">IBM Resilient</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.15/index-action-type.html" class="ulink" target="_top">Index</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.15/jira-action-type.html" class="ulink" target="_top">Jira</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.15/teams-action-type.html" class="ulink" target="_top">Microsoft Teams</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.15/obs-ai-assistant-action-type.html" class="ulink" target="_top">Observability AI Assistant</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.15/opsgenie-action-type.html" class="ulink" target="_top">Opsgenie</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.15/pagerduty-action-type.html" class="ulink" target="_top">PagerDuty</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.15/server-log-action-type.html" class="ulink" target="_top">Server log</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.15/servicenow-itom-action-type.html" class="ulink" target="_top">ServiceNow ITOM</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.15/servicenow-action-type.html" class="ulink" target="_top">ServiceNow ITSM</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.15/servicenow-sir-action-type.html" class="ulink" target="_top">ServiceNow SecOps</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.15/slack-action-type.html" class="ulink" target="_top">Slack</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.15/swimlane-action-type.html" class="ulink" target="_top">Swimlane</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.15/torq-action-type.html" class="ulink" target="_top">Torq</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.15/webhook-action-type.html" class="ulink" target="_top">Webhook</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/8.15/xmatters-action-type.html" class="ulink" target="_top">xMatters</a>
</li>
</ul>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Some connector types are paid commercial features, while others are free.
For a comparison of the Elastic subscription levels, go to
<a href="/subscriptions" class="ulink" target="_top">the subscription page</a>.</p>
</div>
</div>
<p>For more information on creating connectors, refer to <a class="xref" href="action-connectors.html" title="Connectors">Connectors</a>.</p>
</div>
</details>
<details>
<summary class="title">Action frequency</summary>
<div class="content">
<p>After you select a connector, you must set the action frequency. You can choose to create a <span class="strong strong"><strong>Summary of alerts</strong></span> on each check interval or on a custom interval. For example, you can send email notifications that summarize the new, ongoing, and recovered alerts every twelve hours.</p>
<p>Alternatively, you can set the action frequency to <span class="strong strong"><strong>For each alert</strong></span> and specify the conditions each alert must meet for the action to run. For example, you can send an email only when the alert status changes to critical.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/alert-action-frequency.png" alt="Configure when a rule is triggered">
</div>
</div>
<p>With the <span class="strong strong"><strong>Run when</strong></span> menu you can choose if an action runs when the threshold for an alert is reached, or when the alert is recovered. For example, you can add a corresponding action for each state to ensure you are alerted when the rule is triggered and also when it recovers.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/alert-apm-action-frequency-recovered.png" alt="Choose between threshold met or recovered">
</div>
</div>
</div>
</details>
<details>
<summary class="title">Action variables</summary>
<div class="content">
<p>Use the default notification message or customize it.
You can add more context to the message by clicking the Add variable icon <span class="image"><img src="images/icons/indexOpen.svg" alt="Add variable"></span> and selecting from a list of available variables.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/action-variables-popup.png" alt="Action variables list">
</div>
</div>
<p>The following variables are specific to this rule type.
You can also specify <a href="/guide/en/kibana/8.15/rule-action-variables.html" class="ulink" target="_top">variables common to all rules</a>.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">context.alertDetailsUrl</code>
</span>
</dt>
<dd>
Link to the alert troubleshooting view for further context and details. This will be an empty string if the <code class="literal">server.publicBaseUrl</code> is not configured.
</dd>
<dt>
<span class="term">
<code class="literal">context.environment</code>
</span>
</dt>
<dd>
The transaction type the alert is created for.
</dd>
<dt>
<span class="term">
<code class="literal">context.reason</code>
</span>
</dt>
<dd>
A concise description of the reason for the alert.
</dd>
<dt>
<span class="term">
<code class="literal">context.serviceName</code>
</span>
</dt>
<dd>
The service the alert is created for.
</dd>
<dt>
<span class="term">
<code class="literal">context.threshold</code>
</span>
</dt>
<dd>
Any trigger value above this value will cause the alert to fire.
</dd>
<dt>
<span class="term">
<code class="literal">context.transactionType</code>
</span>
</dt>
<dd>
The transaction type the alert is created for.
</dd>
<dt>
<span class="term">
<code class="literal">context.triggerValue</code>
</span>
</dt>
<dd>
The value that breached the threshold and triggered the alert.
</dd>
<dt>
<span class="term">
<code class="literal">context.viewInAppUrl</code>
</span>
</dt>
<dd>
Link to the alert source.
</dd>
</dl>
</div>
</div>
</details>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="observability-aiops-generate-anomaly-alerts.html">« Create an anomaly detection rule</a>
</span>
<span class="next">
<a href="observability-create-custom-threshold-alert-rule.html">Create a custom threshold rule »</a>
</span>
</div>
</body>
</html>
