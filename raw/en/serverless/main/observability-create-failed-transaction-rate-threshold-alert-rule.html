<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Create a failed transaction rate threshold rule | Serverless | Elastic</title>
<meta class="elastic" name="content" content="Create a failed transaction rate threshold rule | Serverless">

<link rel="home" href="index.html" title="Serverless"/>
<link rel="up" href="observability-create-manage-rules.html" title="Create and manage rules"/>
<link rel="prev" href="observability-create-error-count-threshold-alert-rule.html" title="Create an error count threshold rule"/>
<link rel="next" href="observability-create-inventory-threshold-alert-rule.html" title="Create an inventory rule"/>
<meta class="elastic" name="product_version" content="main"/>
<meta class="elastic" name="product_name" content="Serverless"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Serverless/Guide"/>
<meta name="DC.subject" content="Serverless"/>
<meta name="DC.identifier" content="main"/>
</head>
<body>
<div class="navheader">
<span class="prev">
<a href="observability-create-error-count-threshold-alert-rule.html">« Create an error count threshold rule</a>
</span>
<span class="next">
<a href="observability-create-inventory-threshold-alert-rule.html">Create an inventory rule »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Serverless</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="what-is-observability-serverless.html">Elastic Observability serverless</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="observability-alerting.html">Alerting</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="observability-create-manage-rules.html">Create and manage rules</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Create a failed transaction rate threshold rule</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/serverless/alerting/create-failed-transaction-rate-threshold-alert-rule.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h4 class="title"><a id="observability-create-failed-transaction-rate-threshold-alert-rule"></a>Create a failed transaction rate threshold rule</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/serverless/alerting/create-failed-transaction-rate-threshold-alert-rule.asciidoc">edit</a></div>
</div></div></div>

<p><span class="Admonishment Admonishment--preview">
[<span class="Admonishment-title u-mono">preview</span>]
<span class="Admonishment-detail">
This functionality is in technical preview and may be changed or removed in a future release. Elastic will work to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.
</span>
</span></p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<h3>Required role</h3>
<p>The <span class="strong strong"><strong>Editor</strong></span> role or higher is required to create failed transaction rate threshold rules. To learn more, refer to <a class="xref" href="general-assign-user-roles.html" title="Assign user roles and privileges">Assign user roles and privileges</a>.</p>
</div>
</div>
<p>You can create a failed transaction rate threshold rule to alert you when the rate of transaction errors in a service exceeds a defined threshold. Threshold rules can be set at different levels: environment, service, transaction type, and/or transaction name. Add actions to raise alerts via services or third-party integrations e.g. mail, Slack, Jira.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/alerts-create-rule-failed-transaction-rate.png" alt="Create rule for failed transaction rate threshold alert">
</div>
</div>
<div class="tip admon">
<div class="icon"></div>
<div class="admon_content">
<p>These steps show how to use the <span class="strong strong"><strong>Alerts</strong></span> UI.
You can also create a failed transaction rate threshold rule directly from any page within <span class="strong strong"><strong>Applications</strong></span>. Click the <span class="strong strong"><strong>Alerts and rules</strong></span> button, and select <span class="strong strong"><strong>Create threshold rule</strong></span> and then <span class="strong strong"><strong>Failed transaction rate</strong></span>. When you create a rule this way, the <span class="strong strong"><strong>Name</strong></span> and <span class="strong strong"><strong>Tags</strong></span> fields will be prepopulated but you can still change these.</p>
</div>
</div>
<p>To create your failed transaction rate threshold rule:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
In your Observability project, go to <span class="strong strong"><strong>Alerts</strong></span>.
</li>
<li class="listitem">
Select <span class="strong strong"><strong>Manage Rules</strong></span> from the <span class="strong strong"><strong>Alerts</strong></span> page, and select <span class="strong strong"><strong>Create rule</strong></span>.
</li>
<li class="listitem">
Enter a <span class="strong strong"><strong>Name</strong></span> for your rule, and any optional <span class="strong strong"><strong>Tags</strong></span> for more granular reporting (leave blank if unsure).
</li>
<li class="listitem">
Select the <span class="strong strong"><strong>Failed transaction rate threshold</strong></span> rule type from the APM use case.
</li>
<li class="listitem">
Select the appropriate <span class="strong strong"><strong>Service</strong></span>, <span class="strong strong"><strong>Type</strong></span>, <span class="strong strong"><strong>Environment</strong></span> and <span class="strong strong"><strong>Name</strong></span> (or leave <span class="strong strong"><strong>ALL</strong></span> to include all options). Alternatively, you can select <span class="strong strong"><strong>Use KQL Filter</strong></span> and enter a KQL expression to limit the scope of your rule.
</li>
<li class="listitem">
Enter a fail rate in the <span class="strong strong"><strong>Is Above</strong></span> (defaults to 30%).
</li>
<li class="listitem">
Define the period to be assessed in <span class="strong strong"><strong>For the last</strong></span> (defaults to last 5 minutes).
</li>
<li class="listitem">
Choose how to <span class="strong strong"><strong>Group alerts by</strong></span>. Every unique value will create an alert.
</li>
<li class="listitem">
Define the interval to check the rule (for example, check every 1 minute).
</li>
<li class="listitem">
(Optional) Set up <span class="strong strong"><strong>Actions</strong></span>.
</li>
<li class="listitem">
<span class="strong strong"><strong>Save</strong></span> your rule.
</li>
</ol>
</div>
<div class="position-relative"><h6><a id="observability-create-failed-transaction-rate-threshold-alert-rule-add-actions"></a>Add actions</h6><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/serverless/alerting/create-failed-transaction-rate-threshold-alert-rule.asciidoc">edit</a></div>
<p>You can extend your rules with actions that interact with third-party systems, write to logs or indices, or send user notifications. You can add an action to a rule at any time. You can create rules without adding actions, and you can also define multiple actions for a single rule.</p>
<p>To add actions to rules, you must first create a connector for that service (for example, an email or external incident management system), which you can then use for different rules, each with their own action frequency.</p>
<details>
<summary class="title">Connector types</summary>
<div class="content">
<p>Connectors provide a central place to store connection information for services and integrations with third party systems.
The following connectors are available when defining actions for alerting rules:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a href="/guide/en/kibana/master/cases-action-type.html" class="ulink" target="_top">Cases</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/master/d3security-action-type.html" class="ulink" target="_top">D3 Security</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/master/email-action-type.html" class="ulink" target="_top">Email</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/master/resilient-action-type.html" class="ulink" target="_top">IBM Resilient</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/master/index-action-type.html" class="ulink" target="_top">Index</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/master/jira-action-type.html" class="ulink" target="_top">Jira</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/master/teams-action-type.html" class="ulink" target="_top">Microsoft Teams</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/master/obs-ai-assistant-action-type.html" class="ulink" target="_top">Observability AI Assistant</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/master/opsgenie-action-type.html" class="ulink" target="_top">Opsgenie</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/master/pagerduty-action-type.html" class="ulink" target="_top">PagerDuty</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/master/server-log-action-type.html" class="ulink" target="_top">Server log</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/master/servicenow-itom-action-type.html" class="ulink" target="_top">ServiceNow ITOM</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/master/servicenow-action-type.html" class="ulink" target="_top">ServiceNow ITSM</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/master/servicenow-sir-action-type.html" class="ulink" target="_top">ServiceNow SecOps</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/master/slack-action-type.html" class="ulink" target="_top">Slack</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/master/swimlane-action-type.html" class="ulink" target="_top">Swimlane</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/master/torq-action-type.html" class="ulink" target="_top">Torq</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/master/webhook-action-type.html" class="ulink" target="_top">Webhook</a>
</li>
<li class="listitem">
<a href="/guide/en/kibana/master/xmatters-action-type.html" class="ulink" target="_top">xMatters</a>
</li>
</ul>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Some connector types are paid commercial features, while others are free.
For a comparison of the Elastic subscription levels, go to
<a href="/subscriptions" class="ulink" target="_top">the subscription page</a>.</p>
</div>
</div>
<p>For more information on creating connectors, refer to <a class="xref" href="action-connectors.html" title="Connectors">Connectors</a>.</p>
</div>
</details>
<details>
<summary class="title">Action frequency</summary>
<div class="content">
<p>After you select a connector, you must set the action frequency. You can choose to create a <span class="strong strong"><strong>Summary of alerts</strong></span> on each check interval or on a custom interval. For example, you can send email notifications that summarize the new, ongoing, and recovered alerts every twelve hours.</p>
<p>Alternatively, you can set the action frequency to <span class="strong strong"><strong>For each alert</strong></span> and specify the conditions each alert must meet for the action to run. For example, you can send an email only when the alert status changes to critical.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/alert-action-frequency.png" alt="Configure when a rule is triggered">
</div>
</div>
<p>With the <span class="strong strong"><strong>Run when</strong></span> menu you can choose if an action runs when the threshold for an alert is reached, or when the alert is recovered. For example, you can add a corresponding action for each state to ensure you are alerted when the rule is triggered and also when it recovers.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/alert-apm-action-frequency-recovered.png" alt="Choose between threshold met or recovered">
</div>
</div>
</div>
</details>
<details>
<summary class="title">Action variables</summary>
<div class="content">
<p>Use the default notification message or customize it.
You can add more context to the message by clicking the Add variable icon <span class="image"><img src="images/icons/indexOpen.svg" alt="Add variable"></span> and selecting from a list of available variables.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/action-variables-popup.png" alt="Action variables list">
</div>
</div>
<p>The following variables are specific to this rule type.
You can also specify <a href="/guide/en/kibana/master/rule-action-variables.html" class="ulink" target="_top">variables common to all rules</a>.</p>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">context.alertDetailsUrl</code>
</span>
</dt>
<dd>
Link to the alert troubleshooting view for further context and details. This will be an empty string if the <code class="literal">server.publicBaseUrl</code> is not configured.
</dd>
<dt>
<span class="term">
<code class="literal">context.environment</code>
</span>
</dt>
<dd>
The transaction type the alert is created for.
</dd>
<dt>
<span class="term">
<code class="literal">context.interval</code>
</span>
</dt>
<dd>
The length and unit of time period where the alert conditions were met.
</dd>
<dt>
<span class="term">
<code class="literal">context.reason</code>
</span>
</dt>
<dd>
A concise description of the reason for the alert.
</dd>
<dt>
<span class="term">
<code class="literal">context.serviceName</code>
</span>
</dt>
<dd>
The service the alert is created for.
</dd>
<dt>
<span class="term">
<code class="literal">context.threshold</code>
</span>
</dt>
<dd>
Any trigger value above this value will cause the alert to fire.
</dd>
<dt>
<span class="term">
<code class="literal">context.transactionName</code>
</span>
</dt>
<dd>
The transaction name the alert is created for.
</dd>
<dt>
<span class="term">
<code class="literal">context.transactionType</code>
</span>
</dt>
<dd>
The transaction type the alert is created for.
</dd>
<dt>
<span class="term">
<code class="literal">context.triggerValue</code>
</span>
</dt>
<dd>
The value that breached the threshold and triggered the alert.
</dd>
<dt>
<span class="term">
<code class="literal">context.viewInAppUrl</code>
</span>
</dt>
<dd>
Link to the alert source.
</dd>
</dl>
</div>
</div>
</details>
<div class="position-relative"><h6><a id="create-failed-transaction-rate-threshold-example"></a>Example</h6><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/observability-docs/edit/main/docs/en/serverless/alerting/create-failed-transaction-rate-threshold-alert-rule.asciidoc">edit</a></div>
<p>The failed transaction rate threshold alert triggers when the number of transaction errors in a service exceeds a defined threshold.</p>
<p>Before continuing, identify the service name, environment name, and transaction type that you’d like to create a failed transaction rate threshold rule for.</p>
<p>This guide will create an alert for an error group ID based on the following criteria:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Service: <code class="literal">{your_service.name}</code>
</li>
<li class="listitem">
Transaction: <code class="literal">{your_transaction.name}</code>
</li>
<li class="listitem">
Environment: <code class="literal">{your_service.environment}</code>
</li>
<li class="listitem">
Error rate is above 30% for the last five minutes
</li>
<li class="listitem">
Group alerts by <code class="literal">service.name</code> and <code class="literal">service.environment</code>
</li>
<li class="listitem">
Check every 1 minute
</li>
<li class="listitem">
Send the alert via email to the site reliability team
</li>
</ul>
</div>
<p>From any page in <span class="strong strong"><strong>Applications</strong></span>, select <span class="strong strong"><strong>Alerts and rules</strong></span> → <span class="strong strong"><strong>Create threshold rule</strong></span> → <span class="strong strong"><strong>Failed transaction rate</strong></span>. Change the name of the alert (if you wish), but do not edit the tags.</p>
<p>Based on the criteria above, define the following rule details:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Service</strong></span>: <code class="literal">{your_service.name}</code>
</li>
<li class="listitem">
<span class="strong strong"><strong>Type</strong></span>: <code class="literal">{your_transaction.name}</code>
</li>
<li class="listitem">
<span class="strong strong"><strong>Environment</strong></span>: <code class="literal">{your_service.environment}</code>
</li>
<li class="listitem">
<span class="strong strong"><strong>Is above:</strong></span> <code class="literal">30%</code>
</li>
<li class="listitem">
<span class="strong strong"><strong>For the last:</strong></span> <code class="literal">5 minutes</code>
</li>
<li class="listitem">
<span class="strong strong"><strong>Group alerts by:</strong></span> <code class="literal">service.name</code> <code class="literal">service.environment</code>
</li>
<li class="listitem">
<span class="strong strong"><strong>Check every:</strong></span> <code class="literal">1 minute</code>
</li>
</ul>
</div>
<p>Next, select the <span class="strong strong"><strong>Email</strong></span> connector and click <span class="strong strong"><strong>Create a connector</strong></span>. Fill out the required details: sender, host, port, etc., and select <span class="strong strong"><strong>Save</strong></span>.</p>
<p>A default message is provided as a starting point for your alert. You can use the Mustache template syntax (<code class="literal">{{variable}}</code>) to pass additional alert values at the time a condition is detected to an action. A list of available variables can be accessed by clicking the Add variable icon <span class="image"><img src="images/icons/indexOpen.svg" alt="Add variable"></span>.</p>
<p>Select <span class="strong strong"><strong>Save</strong></span>. The alert has been created and is now active!</p>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="observability-create-error-count-threshold-alert-rule.html">« Create an error count threshold rule</a>
</span>
<span class="next">
<a href="observability-create-inventory-threshold-alert-rule.html">Create an inventory rule »</a>
</span>
</div>
</body>
</html>
