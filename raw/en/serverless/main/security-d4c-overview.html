<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="description" content="">
<title>Container workload protection | Serverless | Elastic</title>
<meta class="elastic" name="content" content="Container workload protection | Serverless">

<link rel="home" href="index.html" title="Serverless"/>
<link rel="up" href="security-cloud-native-security-overview.html" title="Secure cloud native resources"/>
<link rel="prev" href="security-vuln-management-faq.html" title="Frequently asked questions (FAQ)"/>
<link rel="next" href="security-d4c-get-started.html" title="Get started with CWP"/>
<meta class="elastic" name="product_version" content="main"/>
<meta class="elastic" name="product_name" content="Serverless"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Serverless/Guide"/>
<meta name="DC.subject" content="Serverless"/>
<meta name="DC.identifier" content="main"/>
</head>
<body>
<div class="navheader">
<span class="prev">
<a href="security-vuln-management-faq.html">« Frequently asked questions (FAQ)</a>
</span>
<span class="next">
<a href="security-d4c-get-started.html">Get started with CWP »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Serverless</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="what-is-security-serverless.html">Elastic Security serverless</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="security-cloud-native-security-overview.html">Secure cloud native resources</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Container workload protection</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/serverless/cloud-native-security/d4c-overview.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="security-d4c-overview"></a>Container workload protection</h3><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/serverless/cloud-native-security/d4c-overview.asciidoc">edit</a></div>
</div></div></div>
<p><span class="Admonishment Admonishment--beta">
[<span class="Admonishment-title u-mono">beta</span>]
<span class="Admonishment-detail">
This functionality is in beta and is subject to change. The design and code is less mature than official GA features and is being provided as-is with no warranties. Beta features are not subject to the support SLA of official GA features.
</span>
</span></p>
<p>Elastic Cloud Workload Protection (CWP) for Kubernetes provides cloud-native runtime protections for containerized environments by identifying and optionally blocking unexpected system behavior in Kubernetes containers.</p>
<div class="position-relative"><h5><a id="d4c-use-cases"></a>Use cases</h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/serverless/cloud-native-security/d4c-overview.asciidoc">edit</a></div>
<div class="position-relative"><h6><a id="security-d4c-overview-threat-detection-and-threat-hunting"></a>Threat detection &amp; threat hunting</h6><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/serverless/cloud-native-security/d4c-overview.asciidoc">edit</a></div>
<p>CWP for Kubernetes sends system events from your containers to Elasticsearch. Elastic Security&#8217;s prebuilt security rules include many designed to detect malicious behavior in container runtimes. These can help you detect events that should never occur in containers, such as reverse shell executions, privilege escalation, container escape attempts, and more.</p>
<div class="position-relative"><h6><a id="security-d4c-overview-drift-detection-and-prevention"></a>Drift detection &amp; prevention</h6><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/serverless/cloud-native-security/d4c-overview.asciidoc">edit</a></div>
<p>Cloud-native containers should be immutable, meaning that their file systems should not change during normal operations. By leveraging this principle, security teams can detect unusual system behavior with a high degree of accuracy — without relying on more resource-intensive techniques like memory scanning or attack signature detection. Elastic’s Drift Detection mechanism has a low rate of false positives, so you can deploy it in most environments without worrying about creating excessive alerts.</p>
<div class="position-relative"><h6><a id="security-d4c-overview-workload-protection-policies"></a>Workload protection policies</h6><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/serverless/cloud-native-security/d4c-overview.asciidoc">edit</a></div>
<p>CWP for Kubernetes uses a flexible policy language to restrict container workloads to a set of allowlisted capabilities chosen by you. When employed with Drift and Threat Detection, this can provide multiple layers of defense.</p>
<div class="position-relative"><h5><a id="security-d4c-overview-support-matrix"></a>Support matrix:</h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/serverless/cloud-native-security/d4c-overview.asciidoc">edit</a></div>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top"></th>
<th align="left" valign="top">EKS 1.24-1.27 (AL2022)</th>
<th align="left" valign="top">GKE 1.24-1.27 (COS)</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>Process event exports</p></td>
<td align="left" valign="top"><p>✓</p></td>
<td align="left" valign="top"><p>✓</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Network event exports</p></td>
<td align="left" valign="top"><p>✓</p></td>
<td align="left" valign="top"><p>✓</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>File event exports</p></td>
<td align="left" valign="top"><p>✓</p></td>
<td align="left" valign="top"><p>✓</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>File blocking</p></td>
<td align="left" valign="top"><p>✓</p></td>
<td align="left" valign="top"><p>✓</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Process blocking</p></td>
<td align="left" valign="top"><p>✓</p></td>
<td align="left" valign="top"><p>✓</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Network blocking</p></td>
<td align="left" valign="top"><p>✗</p></td>
<td align="left" valign="top"><p>✗</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Drift prevention</p></td>
<td align="left" valign="top"><p>✓</p></td>
<td align="left" valign="top"><p>✓</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Mount point awareness</p></td>
<td align="left" valign="top"><p>✓</p></td>
<td align="left" valign="top"><p>✓</p></td>
</tr>
</tbody>
</table>
</div>
<div class="position-relative"><h5><a id="security-d4c-overview-how-cwp-for-kubernetes-works"></a>How CWP for Kubernetes works</h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/serverless/cloud-native-security/d4c-overview.asciidoc">edit</a></div>
<p>CWP for Kubernetes uses a lightweight integration, Defend for Containers (D4C). When you set up the D4C integration, it gets deployed by Elastic Agent. Specifically, the Elastic Agent is installed as a DaemonSet on your Kubernetes clusters, where it enables D4C to use eBPF Linux Security Modules (<a href="https://docs.kernel.org/bpf/prog_lsm.html" class="ulink" target="_top">LSM</a>) and tracepoint probes to record system events. Events are evaluated against LSM hook points, enabling Elastic Agent to evaluate system activity against your policy before allowing it to proceed.</p>
<p>Your D4C integration policy determines which system behaviors (for example, process execution or file creation or deletion) will result in which actions. <em>Selectors</em> and <em>responses</em> define each policy. Selectors define the conditions which cause the associated responses to run. Responses are associated with one or more selectors, and specify one or more actions (such as <code class="literal">log</code>, <code class="literal">alert</code>, or <code class="literal">block</code>) that will occur when the conditions defined in an associated selector are met.</p>
<p>The default D4C policy sends data about all running processes to your Elasticsearch cluster. This data is used by Elastic Security&#8217;s prebuilt detection rules to detect malicious behavior in container workloads.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>To learn more about D4C policies, including how to create your own, refer to the <a class="xref" href="security-d4c-policy-guide.html" title="Container workload protection policies">D4C policies guide</a>.</p>
</div>
</div>



</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="security-vuln-management-faq.html">« Frequently asked questions (FAQ)</a>
</span>
<span class="next">
<a href="security-d4c-get-started.html">Get started with CWP »</a>
</span>
</div>
</body>
</html>
