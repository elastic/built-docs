<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="description" content="">
<title>Detections requirements | Serverless | Elastic</title>
<meta class="elastic" name="content" content="Detections requirements | Serverless">

<link rel="home" href="index.html" title="Serverless"/>
<link rel="up" href="security-detection-engine-overview.html" title="Detection engine overview"/>
<link rel="prev" href="security-detection-engine-overview.html" title="Detection engine overview"/>
<link rel="next" href="security-about-rules.html" title="About detection rules"/>
<meta class="elastic" name="product_version" content="main"/>
<meta class="elastic" name="product_name" content="Serverless"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Serverless/Guide"/>
<meta name="DC.subject" content="Serverless"/>
<meta name="DC.identifier" content="main"/>
</head>
<body>
<div class="navheader">
<span class="prev">
<a href="security-detection-engine-overview.html">« Detection engine overview</a>
</span>
<span class="next">
<a href="security-about-rules.html">About detection rules »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Serverless</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="what-is-security-serverless.html">Elastic Security serverless</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="security-detection-engine-overview.html">Detection engine overview</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Detections requirements</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/serverless/rules/detections-permissions-section.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h3 class="title"><a id="security-detections-requirements"></a>Detections requirements</h3><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/serverless/rules/detections-permissions-section.asciidoc">edit</a></div>
</div></div></div>
<p><span class="Admonishment Admonishment--preview">
[<span class="Admonishment-title u-mono">preview</span>]
<span class="Admonishment-detail">
This functionality is in technical preview and may be changed or removed in a future release. Elastic will work to fix any issues, but features in technical preview are not subject to the support SLA of official GA features.
</span>
</span></p>
<p>To use the <a class="xref" href="security-detection-engine-overview.html" title="Detection engine overview">Detections feature</a>, you first need to
configure a few settings. You also need the appropriate role to send
<a class="xref" href="security-rules-create.html" title="Create a detection rule">notifications</a> when detection alerts are generated.</p>
<p>Additionally, there are some <a class="xref" href="security-detections-requirements.html" title="Detections requirements">advanced settings</a> used to
configure <a class="xref" href="security-value-lists-exceptions.html" title="Create and manage value lists">value list</a> upload limits.</p>
<div class="position-relative"><h5><a id="enable-detections-ui"></a>Enable and access detections</h5><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/serverless/rules/detections-permissions-section.asciidoc">edit</a></div>
<p>To use the Detections feature, it must be enabled and you must have either the appropriate <a class="xref" href="general-assign-user-roles.html" title="Assign user roles and privileges">predefined Security user role</a> or a <a class="xref" href="custom-roles.html" title="Custom roles">custom role</a> with privileges to access rules and alerts. If your role doesn&#8217;t have the privileges needed to enable this feature, you can request someone who has these privileges to visit your Kibana space, which will turn it on for you.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>For instructions about using machine learning jobs and rules, refer to <a class="xref" href="security-ml-requirements.html" title="Machine learning job and rule requirements">Machine learning job and rule requirements</a>.</p>
</div>
</div>
<div class="position-relative"><h6><a id="security-detections-requirements-custom-role-privileges"></a>Custom role privileges</h6><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/serverless/rules/detections-permissions-section.asciidoc">edit</a></div>
<p>The following table describes the required custom role privileges to access the Detections feature, including rules and alerts. For more information on Kibana privileges, refer to <a class="xref" href="custom-roles.html" title="Custom roles">Custom roles</a>.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
<col class="col_4"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Action</th>
<th align="left" valign="top">Cluster Privilege</th>
<th align="left" valign="top">Index Privileges</th>
<th align="left" valign="top">Kibana Privileges</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p>Enable detections in your space</p></td>
<td align="left" valign="top"><p><code class="literal">manage</code></p></td>
<td align="left" valign="top">
<p><code class="literal">manage</code>, <code class="literal">write</code>, <code class="literal">read</code>, and <code class="literal">view_index_metadata</code> for these system indices and data streams, where <code class="literal">&lt;space-id&gt;</code> is the space name:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">.alerts-security.alerts-&lt;space-id&gt;</code>
</li>
<li class="listitem">
<code class="literal">.lists-&lt;space-id&gt;</code>
</li>
<li class="listitem">
<code class="literal">.items-&lt;space-id&gt;</code>
</li>
</ul>
</div>
</td>
<td align="left" valign="top"><p><code class="literal">All</code> for the <code class="literal">Security</code> feature</p></td>
</tr>
<tr>
<td align="left" valign="top">
<p>Enable detections in all spaces</p>
<p><span class="strong strong"><strong>NOTE:</strong></span> To turn on detections, visit the Rules and Alerts pages for each space.</p>
</td>
<td align="left" valign="top"><p><code class="literal">manage</code></p></td>
<td align="left" valign="top">
<p><code class="literal">manage</code>, <code class="literal">write</code>, <code class="literal">read</code>, and <code class="literal">view_index_metadata</code> for these system indices and data streams:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">.alerts-security.alerts-&lt;space-id&gt;</code>
</li>
<li class="listitem">
<code class="literal">.lists-&lt;space-id&gt;</code>
</li>
<li class="listitem">
<code class="literal">.items-&lt;space-id&gt;</code>
</li>
</ul>
</div>
</td>
<td align="left" valign="top"><p><code class="literal">All</code> for the <code class="literal">Security</code> feature</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Preview rules</p></td>
<td align="left" valign="top"><p>N/A</p></td>
<td align="left" valign="top">
<p><code class="literal">read</code> for these indices:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">.preview.alerts-security.alerts-&lt;space-id&gt;</code>
</li>
<li class="listitem">
<code class="literal">.internal.preview.alerts-security.alerts-&lt;space-id&gt;-*</code>
</li>
</ul>
</div>
</td>
<td align="left" valign="top"><p><code class="literal">All</code> for the <code class="literal">Security</code> feature</p></td>
</tr>
<tr>
<td align="left" valign="top"><p>Manage rules</p></td>
<td align="left" valign="top"><p>N/A</p></td>
<td align="left" valign="top">
<p><code class="literal">manage</code>, <code class="literal">write</code>, <code class="literal">read</code>, and <code class="literal">view_index_metadata</code> for these system indices and data streams, where <code class="literal">&lt;space-id&gt;</code> is the space name:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">.alerts-security.alerts-&lt;space-id</code>
</li>
<li class="listitem">
<code class="literal">.lists-&lt;space-id&gt;</code>
</li>
<li class="listitem">
<code class="literal">.items-&lt;space-id&gt;</code>
</li>
</ul>
</div>
</td>
<td align="left" valign="top">
<p><code class="literal">All</code> for the <code class="literal">Security</code> feature</p>
<p><span class="strong strong"><strong>NOTE:</strong></span> You need additional <code class="literal">Action and Connectors</code> feature privileges (<span class="strong strong"><strong>Management → Action and Connectors</strong></span>) to manage rules with actions and connectors:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
To provide full access to rule actions and connectors, give your role <code class="literal">All</code> privileges. With <code class="literal">Read</code> privileges, you can edit rule actions, but will have limited capabilities to manage connectors. For example, <code class="literal">Read</code> privileges allow you to add or remove an existing connector from a rule, but does not allow you to create a new connector.
</li>
<li class="listitem">
To import rules with actions, you need at least <code class="literal">Read</code> privileges for the <code class="literal">Action and Connectors</code> feature. To overwrite or add new connectors, you need <code class="literal">All</code> privileges for the <code class="literal">Actions and Connectors</code> feature. To import rules without actions,  you don&#8217;t need <code class="literal">Actions and Connectors</code> privileges.
</li>
</ul>
</div>
</td>
</tr>
<tr>
<td align="left" valign="top">
<p>Manage alerts</p>
<p><span class="strong strong"><strong>NOTE</strong></span>: Allows you to manage alerts, but not modify rules.</p>
</td>
<td align="left" valign="top"><p>N/A</p></td>
<td align="left" valign="top">
<p><code class="literal">maintenance</code>, <code class="literal">write</code>, <code class="literal">read</code>, and <code class="literal">view_index_metadata</code> for these system indices and data streams, where <code class="literal">&lt;space-id&gt;</code> is the space name:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">.alerts-security.alerts-&lt;space-id&gt;</code>
</li>
<li class="listitem">
<code class="literal">.internal.alerts-security.alerts-&lt;space-id&gt;-*</code>
</li>
<li class="listitem">
<code class="literal">.lists-&lt;space-id&gt;</code>
</li>
<li class="listitem">
<code class="literal">.items-&lt;space-id&gt;</code>
</li>
</ul>
</div>
</td>
<td align="left" valign="top"><p><code class="literal">Read</code> for the <code class="literal">Security</code> feature</p></td>
</tr>
<tr>
<td align="left" valign="top">
<p>Create the <code class="literal">.lists</code> and <code class="literal">.items</code> data streams in your space</p>
<p><span class="strong strong"><strong>NOTE</strong></span>: To initiate the process that creates the data streams, you must visit the Rules page for each appropriate space.</p>
</td>
<td align="left" valign="top"><p><code class="literal">manage</code></p></td>
<td align="left" valign="top">
<p><code class="literal">manage</code>, <code class="literal">write</code>, <code class="literal">read</code>, and <code class="literal">view_index_metadata</code> for these data streams, where <code class="literal">&lt;space-id&gt;</code> is the space name:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<code class="literal">.lists-&lt;space-id&gt;</code>
</li>
<li class="listitem">
<code class="literal">.items-&lt;space-id&gt;</code>
</li>
</ul>
</div>
</td>
<td align="left" valign="top"><p><code class="literal">All</code> for the <code class="literal">Security</code> and <code class="literal">Saved Objects Management</code> features</p></td>
</tr>
</tbody>
</table>
</div>
<div class="position-relative"><h6><a id="alerting-auth-model"></a>Authorization</h6><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/serverless/rules/detections-permissions-section.asciidoc">edit</a></div>
<p>Rules, including all background detection and the actions they generate, are authorized using an <a href="/guide/en/kibana/master/api-keys.html" class="ulink" target="_top">API key</a> associated with the last user to edit the rule. Upon creating or modifying a rule, an API key is generated for that user, capturing a snapshot of their privileges. The API key is then used to run all background tasks associated with the rule including detection checks and executing actions.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>If a rule requires certain privileges to run, such as index privileges, keep in mind that if a user without those privileges updates the rule, the rule will no longer function.</p>
</div>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="security-detection-engine-overview.html">« Detection engine overview</a>
</span>
<span class="next">
<a href="security-about-rules.html">About detection rules »</a>
</span>
</div>
</body>
</html>
