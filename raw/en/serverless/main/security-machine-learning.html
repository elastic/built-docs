<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="description" content="">
<title>Detect anomalies | Serverless | Elastic</title>
<meta class="elastic" name="content" content="Detect anomalies | Serverless">

<link rel="home" href="index.html" title="Serverless"/>
<link rel="up" href="security-advanced-behavioral-detections.html" title="Advanced behavioral detections"/>
<link rel="prev" href="security-ml-requirements.html" title="Machine learning job and rule requirements"/>
<link rel="next" href="security-tuning-anomaly-results.html" title="Optimizing anomaly results"/>
<meta class="elastic" name="product_version" content="main"/>
<meta class="elastic" name="product_name" content="Serverless"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Serverless/Guide"/>
<meta name="DC.subject" content="Serverless"/>
<meta name="DC.identifier" content="main"/>
</head>
<body>
<div class="navheader">
<span class="prev">
<a href="security-ml-requirements.html">« Machine learning job and rule requirements</a>
</span>
<span class="next">
<a href="security-tuning-anomaly-results.html">Optimizing anomaly results »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Serverless</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="what-is-security-serverless.html">Elastic Security Serverless</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="security-advanced-entity-analytics.html">Advanced Entity Analytics</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="security-advanced-behavioral-detections.html">Advanced behavioral detections</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Detect anomalies</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/serverless/advanced-entity-analytics/machine-learning.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h4 class="title"><a id="security-machine-learning"></a>Detect anomalies</h4><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/serverless/advanced-entity-analytics/machine-learning.asciidoc">edit</a></div>
</div></div></div>
<p><a href="/guide/en/machine-learning/master/ml-ad-overview.html" class="ulink" target="_top">Machine learning</a> functionality is available when
you have the appropriate role. Refer to <a class="xref" href="security-ml-requirements.html" title="Machine learning job and rule requirements">Machine learning job and rule requirements</a> for more information.</p>
<p>You can view the details of detected anomalies within the <code class="literal">Anomalies</code> table
widget shown on the Hosts, Network, and associated details pages, or even narrow
to the specific date range of an anomaly from the <code class="literal">Max anomaly score by job</code> field
in the overview of the details pages for hosts and IPs. These interfaces also
offer the ability to drag and drop details of the anomaly to Timeline, such as
the <code class="literal">Entity</code> itself, or any of the associated <code class="literal">Influencers</code>.</p>
<div class="position-relative"><h6><a id="manage-jobs"></a>Manage machine learning jobs</h6><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/serverless/advanced-entity-analytics/machine-learning.asciidoc">edit</a></div>
<p>If you have the <code class="literal">machine_learning_admin</code> role, you can use the <span class="strong strong"><strong>ML job settings</strong></span> interface on the <span class="strong strong"><strong>Alerts</strong></span>, <span class="strong strong"><strong>Rules</strong></span>, and <span class="strong strong"><strong>Rule Exceptions</strong></span> pages to view, start, and stop Elastic Security machine learning jobs.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/machine-learning/-detections-machine-learning-ml-ui.png" alt="ML job settings UI on the Alerts page">
</div>
</div>
<div class="position-relative"><h7><a id="manage-ml-rules"></a>Manage machine learning detection rules</h7><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/serverless/advanced-entity-analytics/machine-learning.asciidoc">edit</a></div>
<p>You can also check the status of machine learning detection rules, and start or stop their associated machine learning jobs:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<p>On the <span class="strong strong"><strong>Rules</strong></span> page, the <span class="strong strong"><strong>Last response</strong></span> column displays the rule&#8217;s current <a class="xref" href="security-rules-ui-management.html#rule-status" title="Check the current status of rules">status</a>. An indicator icon (<span class="image"><img src="images/icons/warning.svg" alt="Error"></span>) also appears if a required machine learning job isn&#8217;t running. Click the icon to list the affected jobs, then click <span class="strong strong"><strong>Visit rule details page to investigate</strong></span> to open the rule&#8217;s details page.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/machine-learning/-detections-machine-learning-rules-table-ml-job-error.png" alt="Rules table machine learning job error">
</div>
</div>
</li>
<li class="listitem">
<p>On a rule&#8217;s details page, check the <span class="strong strong"><strong>Definition</strong></span> section to confirm whether the required machine learning jobs are running. Switch the toggles on or off to run or stop each job.</p>
<div class="imageblock screenshot">
<div class="content">
<img src="images/machine-learning/-troubleshooting-rules-ts-ml-job-stopped.png" alt="Rule details page with ML job stopped">
</div>
</div>
</li>
</ul>
</div>
<div class="position-relative"><h7><a id="included-jobs"></a>Prebuilt jobs</h7><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/serverless/advanced-entity-analytics/machine-learning.asciidoc">edit</a></div>
<p>Elastic Security comes with prebuilt machine learning anomaly detection jobs for automatically detecting
host and network anomalies. The jobs are displayed in the <code class="literal">Anomaly Detection</code>
interface. They are available when either:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
You ship data using <a href="/products/beats" class="ulink" target="_top">Beats</a> or the
<a class="xref" href="security-install-edr.html" title="Install the Elastic Defend integration">Elastic Agent</a>, and Kibana is configured with the required index
patterns (such as <code class="literal">auditbeat-*</code>, <code class="literal">filebeat-*</code>, <code class="literal">packetbeat-*</code>, or <code class="literal">winlogbeat-*</code>
in <span class="strong strong"><strong>Project settings</strong></span> → <span class="strong strong"><strong>Management</strong></span> → <span class="strong strong"><strong>Index Management</strong></span>).
</li>
</ul>
</div>
<p>Or</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
Your shipped data is ECS-compliant, and Kibana is configured with the shipped
data&#8217;s index patterns in <span class="strong strong"><strong>Project settings</strong></span> → <span class="strong strong"><strong>Management</strong></span> → <span class="strong strong"><strong>Index Management</strong></span>.
</li>
</ul>
</div>
<p>Or</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
You install one or more of the <a class="xref" href="security-behavioral-detection-use-cases.html#security-behavioral-detection-use-cases-elastic-integrations-for-behavioral-detection-use-cases" title="Elastic integrations for behavioral detection use cases">Advanced Analytics integrations</a>.
</li>
</ul>
</div>
<p><a class="xref" href="security-prebuilt-ml-jobs.html" title="Prebuilt ML job reference">Prebuilt job reference</a> describes all available machine learning jobs and lists which ECS
fields are required on your hosts when you are not using Beats or the Elastic Agent
to ship your data. For information on tuning anomaly results to reduce the
number of false positives, see <a class="xref" href="security-tuning-anomaly-results.html" title="Optimizing anomaly results">Optimizing anomaly results</a>.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Machine learning jobs look back and analyze two weeks of historical data
prior to the time they are enabled. After jobs are enabled, they continuously
analyze incoming data. When jobs are stopped and restarted within the two-week
time frame, previously analyzed data is not processed again.</p>
</div>
</div>
<div class="position-relative"><h6><a id="view-anomalies"></a>View detected anomalies</h6><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/security-docs/edit/main/docs/serverless/advanced-entity-analytics/machine-learning.asciidoc">edit</a></div>
<p>To view the <code class="literal">Anomalies</code> table widget and <code class="literal">Max Anomaly Score By Job</code> details,
the user must have the <code class="literal">machine_learning_admin</code> or <code class="literal">machine_learning_user</code> role.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>To adjust the <code class="literal">score</code> threshold that determines which anomalies are shown,
you can modify the <span class="strong strong"><strong><code class="literal">securitySolution:defaultAnomalyScore</code></strong></span> advanced setting.</p>
</div>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="security-ml-requirements.html">« Machine learning job and rule requirements</a>
</span>
<span class="next">
<a href="security-tuning-anomaly-results.html">Optimizing anomaly results »</a>
</span>
</div>
</body>
</html>
