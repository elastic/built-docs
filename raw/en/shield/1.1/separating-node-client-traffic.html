<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Separating node to node and client traffic | Shield - Elasticsearch Security Plugin [1.1] | Elastic</title>
<meta class="elastic" name="content" content="Separating node to node and client traffic | Shield - Elasticsearch Security Plugin [1.1]">

<link rel="home" href="index.html" title="Shield - Elasticsearch Security Plugin [1.1]"/>
<link rel="up" href="securing-nodes.html" title="Securing Nodes"/>
<link rel="prev" href="ciphers.html" title="Enabling Cipher Suites for Stronger Encryption"/>
<link rel="next" href="ip-filtering.html" title="IP filtering"/>
<meta class="elastic" name="product_version" content="1.1"/>
<meta class="elastic" name="product_name" content="Shield"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/Legacy/Shield/Reference/1.1"/>
<meta name="DC.subject" content="Shield"/>
<meta name="DC.identifier" content="1.1"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
From version 5.0 onward, Shield is part of X-Pack. For more information, see
<a href=https://www.elastic.co/guide/en/elastic-stack-overview/current/elasticsearch-security.html>
    Securing the Elastic Stack</a>.
</div>
<div class="navheader">
<span class="prev">
<a href="ciphers.html">« Enabling Cipher Suites for Stronger Encryption</a>
</span>
<span class="next">
<a href="ip-filtering.html">IP filtering »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="index.html">Shield - Elasticsearch Security Plugin [1.1]</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="securing-nodes.html">Securing Nodes</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Separating node to node and client traffic</h1><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/x-pack/edit/shield-1.1/docs/public/shield/07-securing-nodes.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div id="url-to-v3" class="version-warning">
    <strong>IMPORTANT</strong>: This documentation is no longer updated. Refer to <a href="https://www.elastic.co/support/eol">Elastic's version policy</a> and the <a href="https://www.elastic.co/docs">latest documentation</a>.
</div>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="separating-node-client-traffic"></a>Separating node to node and client traffic</h2><a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/x-pack/edit/shield-1.1/docs/public/shield/07-securing-nodes.asciidoc">edit</a></div>
</div></div></div>
<p>Elasticsearch has the feature of so called <a href="http://www.elastic.co/guide/en/elasticsearch/reference/1.7/modules-transport.html#_tcp_transport_profiles" class="ulink" target="_top">tcp transport profiles</a>.
This allows elasticsearch to bind to several ports and addresses. Shield extends on this functionality to enhance the
security of the cluster by enabling the separation of node to node transport traffic from client transport traffic. This
is important if the client transport traffic is not trusted and could potentially be malicious. To separate the node to
node traffic from the client traffic, add the following to <code class="literal">elasticsearch.yml</code>:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">transport.profiles.client: <a id="CO16-1"></a><i class="conum" data-value="1"></i>
  port: 9500-9600 <a id="CO16-2"></a><i class="conum" data-value="2"></i>
  shield:
    type: client <a id="CO16-3"></a><i class="conum" data-value="3"></i></pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO16-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p><code class="literal">client</code> is the name of this example profile</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO16-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>The port range that will be used by transport clients to communicate with this cluster</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO16-3"><i class="conum" data-value="3"></i></a></p>
</td>
<td align="left" valign="top">
<p>A type of <code class="literal">client</code> enables additional filters for added security by denying internal cluster operations (e.g shard
level actions and ping requests)</p>
</td>
</tr>
</table>
</div>
<p>If supported by your environment, an internal network can be used for node to node traffic and public network can be
used for client traffic by adding the following to <code class="literal">elasticsearch.yml</code>:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">transport.profiles.default.bind_host: 10.0.0.1 <a id="CO17-1"></a><i class="conum" data-value="1"></i>
transport.profiles.client.bind_host: 1.1.1.1 <a id="CO17-2"></a><i class="conum" data-value="2"></i></pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO17-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>The bind address for the network that will be used for node to node communication</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO17-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>The bind address for the network used for client communication</p>
</td>
</tr>
</table>
</div>
<p>If separate networks are not available, then <a class="xref" href="ip-filtering.html" title="IP filtering">IP Filtering</a> can be enabled to limit access to the profiles.</p>
<p>The tcp transport profiles also allow for enabling SSL on a per profile basis. This is useful if you have a secured network
for the node to node communication, but the client is on an unsecured network. To enable SSL on a client profile when SSL is
disabled for node to node communication, add the following to <code class="literal">elasticsearch.yml</code>:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">transport.profiles.client.ssl: true <a id="CO18-1"></a><i class="conum" data-value="1"></i></pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO18-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>This enables SSL on the client profile. The default value for this setting is the value of <code class="literal">shield.transport.ssl</code>.</p>
</td>
</tr>
</table>
</div>
<p>When using SSL for transport, a different set of certificates can also be used for the client traffic by adding the
following to <code class="literal">elasticsearch.yml</code>:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">transport.profiles.client.shield.truststore:
  path: /path/to/another/truststore
  password: changeme

transport.profiles.client.shield.keystore:
  path: /path/to/another/keystore
  password: changeme</pre>
</div>
<p>To change the default behavior that requires certificates for transport clients, set the following value in the <code class="literal">elasticsearch.yml</code>
file:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">transport.profiles.client.shield.ssl.client.auth: false</pre>
</div>
<p>This setting keeps certificate authentication active for node-to-node traffic, but removes the requirement to distribute
a signed certificate to transport clients. Please see the <a class="xref" href="_java_clients.html#transport-client" title="Transport Client">Transport Client</a> section.</p>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="ciphers.html">« Enabling Cipher Suites for Stronger Encryption</a>
</span>
<span class="next">
<a href="ip-filtering.html">IP filtering »</a>
</span>
</div>
</body>
</html>
