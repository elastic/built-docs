<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>External Identities API Reference | Workplace Search Guide [7.9] | Elastic</title>
<link rel="home" href="index.html" title="Workplace Search Guide [7.9]"/>
<link rel="up" href="workplace-search-api-overview.html" title="Workplace Search API Reference"/>
<link rel="prev" href="workplace-search-document-permissions-api.html" title="Custom Sources Document Permissions API Reference"/>
<link rel="next" href="workplace-search-search-api.html" title="Search API Reference"/>
<meta name="DC.type" content="Learn/Docs/Workplace Search/Guide/7.9"/>
<meta name="DC.subject" content="Workplace Search"/>
<meta name="DC.identifier" content="7.9"/>
</head>
<body><div class="page_header">
A newer version is available. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">Workplace Search Guide [7.9]</a></span>
»
<span class="breadcrumb-link"><a href="workplace-search-api-overview.html">Workplace Search API Reference</a></span>
»
<span class="breadcrumb-node">External Identities API Reference</span>
</div>
<div class="navheader">
<span class="prev">
<a href="workplace-search-document-permissions-api.html">« Custom Sources Document Permissions API Reference</a>
</span>
<span class="next">
<a href="workplace-search-search-api.html">Search API Reference »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="workplace-search-external-identities-api"></a>External Identities API Reference<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/7.9/workplace-search-docs/api/external-identities.asciidoc">edit</a></h2>
</div></div></div>

<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Refer to the <a class="xref" href="workplace-search-sources-document-permissions.html" title="Managing Document Access &amp; Permissions for Content Sources">Document access strategies for content sources</a> for the conceptual walkthrough related to this API reference.</p>
</div>
</div>
<h3><a id="external-identities-toc"></a>In this API reference<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/7.9/workplace-search-docs/api/external-identities.asciidoc">edit</a></h3>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="workplace-search-external-identities-api.html#add-external-identity" title="Add an external identity">Add an external identity</a>
</li>
<li class="listitem">
<a class="xref" href="workplace-search-external-identities-api.html#show-external-identity" title="Show an external identity">Show an external identity</a>
</li>
<li class="listitem">
<a class="xref" href="workplace-search-external-identities-api.html#list-external-identities" title="List all external identities">List all external identities</a>
</li>
<li class="listitem">
<a class="xref" href="workplace-search-external-identities-api.html#update-external-identity" title="Update an external identity">Update an external identity</a>
</li>
<li class="listitem">
<a class="xref" href="workplace-search-external-identities-api.html#remove-external-identity" title="Remove an external identity">Remove an external identity</a>
</li>
</ul>
</div>
<h3><a id="external-identities-overview"></a>External Identities API Overview<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/7.9/workplace-search-docs/api/external-identities.asciidoc">edit</a></h3>
<p>An external identity is a mapping from external to internal users.
They are bound to a content source.
You will need to set up external identities for all users if you are connecting a content source with permissions enabled.</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">content_source_key</code></p></td>
<td align="left" valign="top"><p>required</p></td>
<td align="left" valign="top"><p>Unique key for a Custom API source, provided upon creation of a Custom API Source.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">access_token</code></p></td>
<td align="left" valign="top"><p>required</p></td>
<td align="left" valign="top"><p>Must be included in HTTP authorization headers.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">user</code></p></td>
<td align="left" valign="top"><p>required</p></td>
<td align="left" valign="top"><p>The <code class="literal">[USER_NAME]</code> can be placed into the request URL or in the request <code class="literal">user</code> field in the request body. You need to include a username, but where you put it is up to you. Username might reflect an Elasticsearch user: <code class="literal">example.mcname</code>, or whatever convention you&#8217;ve chosen to use.</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">source_user_id</code></p></td>
<td align="left" valign="top"><p>required</p></td>
<td align="left" valign="top"><p>The username or identifier for this user at the external source. For example for Google Drive this field is the e-mail used.</p></td>
</tr>
</tbody>
</table>
</div>
<h3><a id="add-external-identity"></a>Add an external identity<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/7.9/workplace-search-docs/api/external-identities.asciidoc">edit</a></h3>
<p><code class="literal">POST /api/ws/v1/sources/[CONTENT_SOURCE_KEY]/external_identities</code></p>
<p>Adds a new external identity.</p>
<div class="pre_wrapper lang-bash">
<pre class="programlisting prettyprint lang-bash">curl -X POST http://localhost:3002/api/ws/v1/sources/[CONTENT_SOURCE_KEY]/external_identities \
-H "Authorization: Bearer [ACCESS_TOKEN]" \
-H "Content-Type: application/json" \
-d '{
  "user": "john.doe",
  "source_user_id": "john.doe@example.com"
}'</pre>
</div>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
  "source_user_id": "john.doe@example.com",
  "user": "john.doe"
}</pre>
</div>
<h3><a id="show-external-identity"></a>Show an external identity<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/7.9/workplace-search-docs/api/external-identities.asciidoc">edit</a></h3>
<p><code class="literal">GET /api/ws/v1/sources/[CONTENT_SOURCE_KEY]/external_identities/[USER]</code></p>
<p>Retrieves an external identity.</p>
<div class="pre_wrapper lang-bash">
<pre class="programlisting prettyprint lang-bash">curl -X GET http://localhost:3002/api/ws/v1/sources/[CONTENT_SOURCE_KEY]/external_identities/john%2Edoe \
-H "Authorization: Bearer [ACCESS_TOKEN]"</pre>
</div>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
  "source_user_id": "john.doe@example.com",
  "user": "john.doe"
}</pre>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>The user should be URL encoded.</p>
</div>
</div>
<h3><a id="list-external-identities"></a>List all external identities<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/7.9/workplace-search-docs/api/external-identities.asciidoc">edit</a></h3>
<p><code class="literal">GET /api/ws/v1/sources/[CONTENT_SOURCE_KEY]/external_identities</code></p>
<p>Retrieves all external identities.</p>
<div class="pre_wrapper lang-bash">
<pre class="programlisting prettyprint lang-bash">curl -X GET http://localhost:3002/api/ws/v1/sources/[CONTENT_SOURCE_KEY]/external_identities
-H "Authorization: Bearer [ACCESS_TOKEN]"</pre>
</div>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
  "meta": {
    "page": {
      "current": 1,
      "total_pages": 1,
      "total_results": 1,
      "size": 25
    }
  },
  "results": [
    { "source_user_id": "john.doe@example.com", "user": "john.doe" }
  ]
}</pre>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>This endpoint can be paginated with <code class="literal">current</code> and <code class="literal">size</code> query paramters.</p>
</div>
</div>
<h3><a id="update-external-identity"></a>Update an external identity<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/7.9/workplace-search-docs/api/external-identities.asciidoc">edit</a></h3>
<p><code class="literal">PUT /api/ws/v1/sources/[CONTENT_SOURCE_KEY]/external_identities/[USER]</code></p>
<p>Updates an external identity.</p>
<div class="pre_wrapper lang-bash">
<pre class="programlisting prettyprint lang-bash">curl -X PUT http://localhost:3002/api/ws/v1/sources/[CONTENT_SOURCE_KEY]/external_identities/john%2Edoe \
-H "Authorization: Bearer [ACCESS_TOKEN]" \
-H "Content-Type: application/json" \
-d '{
  "source_user_id": "john.doe2@example.com"
}'</pre>
</div>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">{
  "source_user_id": "john.doe2@example.com",
  "user": "john.doe"
}</pre>
</div>
<h3><a id="remove-external-identity"></a>Remove an external identity<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/enterprise-search-pubs/edit/7.9/workplace-search-docs/api/external-identities.asciidoc">edit</a></h3>
<p><code class="literal">DELETE /api/ws/v1/sources/[CONTENT_SOURCE_KEY]/external_identities/[USER]</code></p>
<p>Deletes an external identity.</p>
<div class="warning admon">
<div class="icon"></div>
<div class="admon_content">
<p>Deleting an external identity in Enterprise Search 7.8.0 does not remove the permissions granted to the linked Workplace Search user.
To prevent the user from searching the corresponding content source, an admin must stop sharing the content source with the Workplace Search user.
The forthcoming Enterprise Search 7.8.1 release fixes this issue.</p>
</div>
</div>
<div class="pre_wrapper lang-bash">
<pre class="programlisting prettyprint lang-bash">curl -X DELETE http://localhost:3002/api/ws/v1/sources/[CONTENT_SOURCE_KEY]/external_identities/john%2Edoe \
-H "Authorization: Bearer [ACCESS_TOKEN]"</pre>
</div>
<div class="pre_wrapper lang-json">
<pre class="programlisting prettyprint lang-json">"ok"</pre>
</div>
</div>
<div class="navfooter">
<span class="prev">
<a href="workplace-search-document-permissions-api.html">« Custom Sources Document Permissions API Reference</a>
</span>
<span class="next">
<a href="workplace-search-search-api.html">Search API Reference »</a>
</span>
</div>
</div>
</body>
</html>
