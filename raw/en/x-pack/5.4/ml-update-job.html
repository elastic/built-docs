<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Update Jobs | X-Pack for the Elastic Stack [5.4] | Elastic</title>
<link rel="home" href="index.html" title="X-Pack for the Elastic Stack [5.4]"/>
<link rel="up" href="ml-apis.html" title="Machine Learning APIs"/>
<link rel="prev" href="ml-update-datafeed.html" title="Update Datafeeds"/>
<link rel="next" href="ml-update-snapshot.html" title="Update Model Snapshots"/>
<meta name="DC.type" content="Learn/Docs/Legacy/XPack/Reference/5.4"/>
<meta name="DC.subject" content="X-Pack"/>
<meta name="DC.identifier" content="5.4"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body><div class="page_header">
<p>
  <strong>WARNING</strong>: Version 5.4 of the Elastic Stack has passed its 
  <a href="https://www.elastic.co/support/eol">EOL date</a>. 
</p>  
<p>
  This documentation is no longer being maintained and may be removed. 
  If you are running this version, we strongly advise you to upgrade. 
  For the latest information, see the 
<a href="https://www.elastic.co/guide/index.html">current release documentation</a>.
</p>
</div>
<div id="content">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="index.html">X-Pack for the Elastic Stack [5.4]</a></span>
»
<span class="breadcrumb-link"><a href="xpack-api.html">X-Pack APIs</a></span>
»
<span class="breadcrumb-link"><a href="ml-apis.html">Machine Learning APIs</a></span>
»
<span class="breadcrumb-node">Update Jobs</span>
</div>
<div class="navheader">
<span class="prev">
<a href="ml-update-datafeed.html">« Update Datafeeds</a>
</span>
<span class="next">
<a href="ml-update-snapshot.html">Update Model Snapshots »</a>
</span>
</div>
<div class="section">
<div class="titlepage"><div><div>
<h2 class="title"><a id="ml-update-job"></a>Update Jobs<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/x-pack-elasticsearch/edit/5.4/docs/en/rest-api/ml/update-job.asciidoc">edit</a></h2>
</div></div></div>
<p>The update job API enables you to update certain properties of a job.</p>
<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_request_24"></a>Request<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/x-pack-elasticsearch/edit/5.4/docs/en/rest-api/ml/update-job.asciidoc">edit</a></h3>
</div></div></div>
<p><code class="literal">POST _xpack/ml/anomaly_detectors/&lt;job_id&gt;/_update</code></p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_path_parameters_24"></a>Path Parameters<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/x-pack-elasticsearch/edit/5.4/docs/en/rest-api/ml/update-job.asciidoc">edit</a></h3>
</div></div></div>
<div class="variablelist">
<dl class="variablelist">
<dt>
<span class="term">
<code class="literal">job_id</code> (required)
</span>
</dt>
<dd>
(string) Identifier for the job
</dd>
</dl>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_request_body_14"></a>Request Body<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/x-pack-elasticsearch/edit/5.4/docs/en/rest-api/ml/update-job.asciidoc">edit</a></h3>
</div></div></div>
<p>The following properties can be updated after the job is created:</p>
<div class="informaltable">
<table border="1" cellpadding="4px">
<colgroup>
<col class="col_1"/>
<col class="col_2"/>
<col class="col_3"/>
</colgroup>
<thead>
<tr>
<th align="left" valign="top">Name</th>
<th align="left" valign="top">Description</th>
<th align="left" valign="top">Requires Restart</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left" valign="top"><p><code class="literal">analysis_limits</code>: <code class="literal">model_memory_limit</code></p></td>
<td align="left" valign="top"><p>The approximate maximum amount of
memory resources required for analytical processing, in MiB.
See <a class="xref" href="ml-job-resource.html#ml-apilimits" title="Analysis Limits">Analysis Limits</a>.</p></td>
<td align="left" valign="top"><p>Yes</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">background_persist_interval</code></p></td>
<td align="left" valign="top"><p>Advanced configuration option. The time between
each periodic persistence of the model. See <a class="xref" href="ml-job-resource.html" title="Job Resources">Job Resources</a>.</p></td>
<td align="left" valign="top"><p>Yes</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">custom_settings</code></p></td>
<td align="left" valign="top"><p>Contains custom meta data about the job.</p></td>
<td align="left" valign="top"><p>No</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">description</code></p></td>
<td align="left" valign="top"><p>An optional description of the job.
See <a class="xref" href="ml-job-resource.html" title="Job Resources">Job Resources</a>.</p></td>
<td align="left" valign="top"><p>No</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">model_plot_config</code>: <code class="literal">enabled</code></p></td>
<td align="left" valign="top"><p>If true, enables calculation and storage of the
model bounds for each entity that is being analyzed.
See <a class="xref" href="ml-job-resource.html#ml-apimodelplotconfig" title="Model Plot Config">Model Plot Config</a>.</p></td>
<td align="left" valign="top"><p>No</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">model_snapshot_retention_days</code></p></td>
<td align="left" valign="top"><p>The time in days that model snapshots are
retained for the job. See <a class="xref" href="ml-job-resource.html" title="Job Resources">Job Resources</a>.</p></td>
<td align="left" valign="top"><p>Yes</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">renormalization_window_days</code></p></td>
<td align="left" valign="top"><p>Advanced configuration option. The period over
which adjustments to the score are applied, as new data is seen.
See <a class="xref" href="ml-job-resource.html" title="Job Resources">Job Resources</a>.</p></td>
<td align="left" valign="top"><p>Yes</p></td>
</tr>
<tr>
<td align="left" valign="top"><p><code class="literal">results_retention_days</code></p></td>
<td align="left" valign="top"><p>Advanced configuration option. The number of days
for which job results are retained. See <a class="xref" href="ml-job-resource.html" title="Job Resources">Job Resources</a>.</p></td>
<td align="left" valign="top"><p>Yes</p></td>
</tr>
</tbody>
</table>
</div>
<p>For those properties that have <code class="literal">Requires Restart</code> set to <code class="literal">Yes</code> in this table,
if the job is open when you make the update, you must stop the data feed, close
the job, then restart the data feed and open the job for the changes to take
effect.</p>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
You can update the <code class="literal">analysis_limits</code> only while the job is closed.
</li>
<li class="listitem">
The <code class="literal">model_memory_limit</code> property value cannot be decreased.
</li>
<li class="listitem">
If the <code class="literal">memory_status</code> property in the <code class="literal">model_size_stats</code> object has a value
of <code class="literal">hard_limit</code>, this means that it was unable to process some data. You might
want to re-run this job with an increased <code class="literal">model_memory_limit</code>.
</li>
</ul>
</div>
</div>
</div>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_authorization_25"></a>Authorization<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/x-pack-elasticsearch/edit/5.4/docs/en/rest-api/ml/update-job.asciidoc">edit</a></h3>
</div></div></div>
<p>You must have <code class="literal">manage_ml</code>, or <code class="literal">manage</code> cluster privileges to use this API.
For more information, see <a class="xref" href="security-privileges.html#privileges-list-cluster" title="Cluster Privileges">Cluster Privileges</a>.</p>
</div>

<div class="section">
<div class="titlepage"><div><div>
<h3 class="title"><a id="_examples_24"></a>Examples<a class="edit_me edit_me_private" rel="nofollow" title="Editing on GitHub is available to Elastic" href="https://github.com/elastic/x-pack-elasticsearch/edit/5.4/docs/en/rest-api/ml/update-job.asciidoc">edit</a></h3>
</div></div></div>
<p>The following example updates the <code class="literal">it_ops_new_logs</code> job:</p>
<div class="pre_wrapper lang-console">
<pre class="programlisting prettyprint lang-console">POST _xpack/ml/anomaly_detectors/it_ops_new_logs/_update
{
  "description":"An updated job",
  "model_plot_config": {
    "enabled": true
  },
  "analysis_limits": {
    "model_memory_limit": 1024
  },
  "renormalization_window_days": 30,
  "background_persist_interval": "2h",
  "model_snapshot_retention_days": 7,
  "results_retention_days": 60,
  "custom_settings": {
    "custom_urls" : [{
      "url_name" : "Lookup IP",
      "url_value" : "http://geoiplookup.net/ip/$clientip$"
    }]
  }
}</pre>
</div>
<div class="console_widget" data-snippet="snippets/150.console"></div>
<p>When the job is updated, you receive a summary of the job configuration
information, including the updated property values. For example:</p>
<div class="pre_wrapper lang-js">
<pre class="programlisting prettyprint lang-js">{
  "job_id": "it_ops_new_logs",
  "job_type": "anomaly_detector",
  "description": "An updated job",
  "create_time": 1493678314204,
  "finished_time": 1493678315850,
  "analysis_config": {
    "bucket_span": "1800s",
    "categorization_field_name": "message",
    "detectors": [
      {
        "detector_description": "Unusual message counts",
        "function": "count",
        "by_field_name": "mlcategory",
        "detector_rules": []
      }
    ],
    "influencers": []
  },
  "analysis_limits": {
    "model_memory_limit": 1024
  },
  "data_description": {
    "time_field": "time",
    "time_format": "epoch_ms"
  },
  "model_plot_config": {
    "enabled": true
  },
  "renormalization_window_days": 30,
  "background_persist_interval": "2h",
  "model_snapshot_retention_days": 7,
  "results_retention_days": 60,
  "custom_settings": {
    "custom_urls": [
      {
        "url_name": "Lookup IP",
        "url_value": "http://geoiplookup.net/ip/$clientip$"
      }
    ]
  },
  "model_snapshot_id": "1493678315",
  "results_index_name": "shared"
}</pre>
</div>
</div>

</div>
<div class="navfooter">
<span class="prev">
<a href="ml-update-datafeed.html">« Update Datafeeds</a>
</span>
<span class="next">
<a href="ml-update-snapshot.html">Update Model Snapshots »</a>
</span>
</div>
</div>
</body>
</html>
