<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Common problems | APM Server Reference [6.3] | Elastic</title>
<meta class="elastic" name="content" content="Common problems | APM Server Reference [6.3]">

<link rel="home" href="index.html" title="APM Server Reference [6.3]"/>
<link rel="up" href="troubleshooting.html" title="Troubleshooting"/>
<link rel="prev" href="troubleshooting.html" title="Troubleshooting"/>
<link rel="next" href="getting-help.html" title="Get help"/>
<meta class="elastic" name="product_version" content="6.3"/>
<meta class="elastic" name="product_name" content="APM"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/APM Server/Reference/6.3"/>
<meta name="DC.subject" content="APM"/>
<meta name="DC.identifier" content="6.3"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
A newer version is available. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div class="navheader">
<span class="prev">
<a href="troubleshooting.html">« Troubleshooting</a>
</span>
<span class="next">
<a href="getting-help.html">Get help »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link">
  <div id="related-products" class="dropdown">
  <div class="related-products-title">APM:</div>
  <div class="dropdown-anchor" tabindex="0">Server Reference<span class="dropdown-icon"></span></div>
  <div class="dropdown-content">
  <ul>
  <li class="dropdown-category">APM</li>
  <ul>
  <li><a href="/guide/en/observability/current/apm.html">Observability › APM</a></li>
  </ul>
  <li class="dropdown-category">APM agents</li>
  <ul>
  <li><a href="/guide/en/apm/agent/android/current/intro.html">Android Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/go/current/introduction.html">Go Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/swift/current/intro.html">iOS Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/java/current/intro.html">Java Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/dotnet/current/intro.html">.NET Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/nodejs/current/intro.html">Node.js Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/php/current/intro.html">PHP Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/python/current/getting-started.html">Python Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/ruby/current/introduction.html">Ruby Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/rum-js/current/intro.html">Real User Monitoring JavaScript Agent Reference</a></li>
  </ul>
  <li class="dropdown-category">APM extensions</li>
  <ul>
  <li><a href="/guide/en/apm/lambda/current/aws-lambda-arch.html">AWS Lambda extension</a></li>
  <li><a href="/guide/en/apm/attacher/current/apm-attacher.html">Attacher</a></li>
  </ul>
  </ul>
  </div>
  </div>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="troubleshooting.html">Troubleshooting</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Common problems</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/6.3/docs/common-problems.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="chapter">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="common-problems"></a>Common problems</h2><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/6.3/docs/common-problems.asciidoc">edit</a></div>
</div></div></div>
<p>This section describes common problems you might encounter with APM Server.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="common-problems.html#queue-full" title="HTTP 503: Queue is full">HTTP 503: Queue is full</a>
</li>
<li class="listitem">
<a class="xref" href="common-problems.html#request-timed-out" title="HTTP 503: Request timed out waiting to be processed">HTTP 503: Request timed out waiting to be processed</a>
</li>
</ul>
</div>
<div class="position-relative"><h3><a id="queue-full"></a>HTTP 503: Queue is full</h3><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/6.3/docs/common-problems.asciidoc">edit</a></div>
<p>APM Server has an internal queue that buffers documents until they can be delivered to Elasticsearch.
The internal queue helps to:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
alleviate problems that might occur if Elasticsearch is intermittently unavailable
</li>
<li class="listitem">
handle large spikes of data arriving at the APM Server at the same time
</li>
<li class="listitem">
send documents to Elasticsearch in bulk, instead of individually
</li>
</ul>
</div>
<p>When the internal queue has reached the maximum buffer size,
APM Server returns an HTTP 503 status with the message "Queue is full".</p>
<p>A full queue generally means that the agents collect more data than APM server is able to deliver to Elasticsearch.
This might happen when APM Server is not configured properly for the size of your Elasticsearch cluster,
or because your Elasticsearch cluster is underpowered or not configured properly for the given workload.</p>
<p>The queue can also fill up if Elasticsearch is unavailable for a prolonged period,
it runs out of disk space,
or a sudden spike of data arrives at the APM Server.</p>
<p>If the APM Server only returns 503 responses, it might indicate that an Elasticsearch disk is full.
If the APM Server returns interleaved 503 and 202 responses, it might indicate that the APM Server can&#8217;t process that much data.</p>
<p>You have a few options to solve this problem:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="reduce-storage.html" title="Reduce storage">Reduce storage</a>
</li>
<li class="listitem">
<a class="xref" href="tune-apm-server.html#tune-output-config" title="Tune APM Server output parameters for your Elasticsearch cluster">Tune APM Server output parameters for your Elasticsearch cluster</a>
</li>
<li class="listitem">
<a class="xref" href="tune-apm-server.html#adjust-queue-size" title="Adjust internal queue size">Adjust internal queue size</a>
</li>
<li class="listitem">
<a class="xref" href="tune-es.html" title="Tune Elasticsearch">Tune Elasticsearch for higher ingestion</a>
</li>
</ul>
</div>
<div class="position-relative"><h3><a id="request-timed-out"></a>HTTP 503: Request timed out waiting to be processed</h3><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/6.3/docs/common-problems.asciidoc">edit</a></div>
<p>There is a limit to the number of requests that the APM Server can process concurrently.
The APM Server returns an HTTP 503 status with the message "Request timed out waiting to be processed" when the limit is reached and the request from an agent is blocked.
This limit is determined by the <code class="literal">apm-server.concurrent_requests</code> configuration parameter.</p>
<p>To alleviate this problem,
you can try to:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<a class="xref" href="reduce-storage.html#reduce-sample-rate" title="Reduce the sample rate">Reduce the sample rate</a>
</li>
<li class="listitem">
<a class="xref" href="reduce-storage.html#reduce-stacktrace" title="Reduce collected stacktrace information">Reduce collected stacktrace information</a>
</li>
<li class="listitem">
<a class="xref" href="tune-apm-server.html#reduce-payload-size" title="Reduce the payload size">Reduce the payload size</a>
</li>
<li class="listitem">
<a class="xref" href="tune-apm-server.html#adjust-concurrent-requests" title="Adjust concurrent requests">Adjust concurrent requests</a>
</li>
<li class="listitem">
<a class="xref" href="tune-apm-server.html#add-apm-server-nodes" title="Add APM Server nodes">Add APM Server nodes</a>
</li>
</ul>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="troubleshooting.html">« Troubleshooting</a>
</span>
<span class="next">
<a href="getting-help.html">Get help »</a>
</span>
</div>
</body>
</html>
