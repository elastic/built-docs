<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Collect APM Server monitoring data with internal collectors | APM Server Reference [7.5] | Elastic</title>
<meta class="elastic" name="content" content="Collect APM Server monitoring data with internal collectors | APM Server Reference [7.5]">

<link rel="home" href="index.html" title="APM Server Reference [7.5]"/>
<link rel="up" href="monitoring.html" title="Monitoring APM Server"/>
<link rel="prev" href="monitoring.html" title="Monitoring APM Server"/>
<link rel="next" href="configuration-monitor.html" title="Settings for internal monitoring collection"/>
<meta class="elastic" name="product_version" content="7.5"/>
<meta class="elastic" name="product_name" content="APM"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/APM Server/Reference/7.5"/>
<meta name="DC.subject" content="APM"/>
<meta name="DC.identifier" content="7.5"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
A newer version is available. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div class="navheader">
<span class="prev">
<a href="monitoring.html">« Monitoring APM Server</a>
</span>
<span class="next">
<a href="configuration-monitor.html">Settings for internal monitoring collection »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link">
  <div id="related-products" class="dropdown">
  <div class="related-products-title">APM:</div>
  <div class="dropdown-anchor" tabindex="0">Server Reference<span class="dropdown-icon"></span></div>
  <div class="dropdown-content">
  <ul>
  <li class="dropdown-category">APM</li>
  <ul>
  <li><a href="/guide/en/observability/current/apm.html">Observability › APM</a></li>
  </ul>
  <li class="dropdown-category">APM agents</li>
  <ul>
  <li><a href="/guide/en/apm/agent/android/current/intro.html">Android Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/go/current/introduction.html">Go Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/swift/current/intro.html">iOS Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/java/current/intro.html">Java Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/dotnet/current/intro.html">.NET Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/nodejs/current/intro.html">Node.js Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/php/current/intro.html">PHP Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/python/current/getting-started.html">Python Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/ruby/current/introduction.html">Ruby Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/rum-js/current/intro.html">Real User Monitoring JavaScript Agent Reference</a></li>
  </ul>
  <li class="dropdown-category">APM extensions</li>
  <ul>
  <li><a href="/guide/en/apm/lambda/current/aws-lambda-arch.html">AWS Lambda extension</a></li>
  <li><a href="/guide/en/apm/attacher/current/apm-attacher.html">Attacher</a></li>
  </ul>
  </ul>
  </div>
  </div>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="monitoring.html">Monitoring APM Server</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Collect APM Server monitoring data with internal collectors</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/7.5/docs/copied-from-beats/docs/monitoring/monitoring-internal-collection.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div class="chapter xpack">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="monitoring-internal-collection"></a>Collect APM Server monitoring data with internal collectors<a class="xpack_tag" href="/subscriptions"></a></h2><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/7.5/docs/copied-from-beats/docs/monitoring/monitoring-internal-collection.asciidoc">edit</a></div>
</div></div></div>

<p>The following method involves sending the metrics to the production cluster,
which ultimately routes them to the monitoring cluster.
For an alternative method, see <a class="xref" href="monitoring-metricbeat-collection.html" title="Collect APM Server monitoring data with Metricbeat"><em>Metricbeat collection</em></a>.</p>
<p>To learn about monitoring in general, see
<a href="/guide/en/elasticsearch/reference/7.5/monitor-elasticsearch-cluster.html" class="ulink" target="_top">Monitoring a cluster</a>.</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
Create a user that has appropriate authority to send system-level monitoring
data to Elasticsearch. For example, you can use the built-in <code class="literal">apm_system</code> user or
assign the built-in <code class="literal">apm_system</code> role to another user. For more
information, see
<a href="/guide/en/elasticsearch/reference/7.5/setting-up-authentication.html" class="ulink" target="_top">User authentication</a> and
<a href="/guide/en/elasticsearch/reference/7.5/built-in-roles.html" class="ulink" target="_top">Built-in roles</a>.
</li>
<li class="listitem">
<p>Add the <code class="literal">monitoring</code> settings in the APM Server configuration file. If you
configured the Elasticsearch output and want to send APM Server monitoring events to
the same Elasticsearch cluster, specify the following minimal configuration:</p>
<div class="pre_wrapper lang-yml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yml">monitoring:
  enabled: true
  elasticsearch:
    username: apm_system
    password: somepassword</pre>
</div>
<p>If you
configured a different output, such as Logstash or you
want to send APM Server monitoring events to a separate Elasticsearch cluster
(referred to as the <em>monitoring cluster</em>), you must specify additional
configuration options. For example:</p>
<div class="pre_wrapper lang-yml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yml">monitoring:
  enabled: true
  cluster_uuid: PRODUCTION_ES_CLUSTER_UUID <a id="CO10-1"></a><i class="conum" data-value="1"></i>
  elasticsearch:
    hosts: ["https://example.com:9200", "https://example2.com:9200"] <a id="CO10-2"></a><i class="conum" data-value="2"></i>
    username: apm_system
    password: somepassword</pre>
</div>
<div class="calloutlist">
<table border="0" summary="Callout list">
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO10-1"><i class="conum" data-value="1"></i></a></p>
</td>
<td align="left" valign="top">
<p>This setting identifies the Elasticsearch cluster under which the
monitoring data for this APM Server instance will appear in the
Stack Monitoring UI. To get a cluster&#8217;s <code class="literal">cluster_uuid</code>,
call the <code class="literal">GET /</code> API against that cluster.</p>
</td>
</tr>
<tr>
<td align="left" valign="top" width="5%">
<p><a href="#CO10-2"><i class="conum" data-value="2"></i></a></p>
</td>
<td align="left" valign="top">
<p>This setting identifies the hosts and port numbers of Elasticsearch nodes
that are part of the monitoring cluster.</p>
</td>
</tr>
</table>
</div>
</li>
<li class="listitem">
Start APM Server.
</li>
<li class="listitem">
<a href="/guide/en/kibana/7.5/monitoring-data.html" class="ulink" target="_top">View the monitoring data in Kibana</a>.
</li>
</ol>
</div>

</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="monitoring.html">« Monitoring APM Server</a>
</span>
<span class="next">
<a href="configuration-monitor.html">Settings for internal monitoring collection »</a>
</span>
</div>
</body>
</html>
