<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Secret token | APM Server Reference [7.8] | Elastic</title>
<meta class="elastic" name="content" content="Secret token | APM Server Reference [7.8]">

<link rel="home" href="index.html" title="APM Server Reference [7.8]"/>
<link rel="up" href="secure-communication-agents.html" title="Secure communication with APM Agents"/>
<link rel="prev" href="api-key-settings.html" title="api_key.* configuration options"/>
<link rel="next" href="securing-communication-elasticsearch.html" title="Secure communication with Elasticsearch"/>
<meta class="elastic" name="product_version" content="7.8"/>
<meta class="elastic" name="product_name" content="APM"/>
<meta class="elastic" name="website_area" content="documentation"/>
<meta name="DC.type" content="Learn/Docs/APM Server/Reference/7.8"/>
<meta name="DC.subject" content="APM"/>
<meta name="DC.identifier" content="7.8"/>
<meta name="robots" content="noindex,nofollow"/>
</head>
<body>
<div class="page_header">
A newer version is available. For the latest information, see the
<a href="../current/index.html">current release documentation</a>.
</div>
<div class="navheader">
<span class="prev">
<a href="api-key-settings.html">« <code class="literal">api_key.*</code> configuration options</a>
</span>
<span class="next">
<a href="securing-communication-elasticsearch.html">Secure communication with Elasticsearch »</a>
</span>
</div>
<div class="book" lang="en">
<div class="titlepage">
<div class="breadcrumbs">
<span class="breadcrumb-link"><a href="/guide/">Elastic Docs</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link">
  <div id="related-products" class="dropdown">
  <div class="related-products-title">APM:</div>
  <div class="dropdown-anchor" tabindex="0">Server Reference<span class="dropdown-icon"></span></div>
  <div class="dropdown-content">
  <ul>
  <li class="dropdown-category">APM</li>
  <ul>
  <li><a href="/guide/en/observability/current/apm.html">Observability › APM</a></li>
  </ul>
  <li class="dropdown-category">APM agents</li>
  <ul>
  <li><a href="/guide/en/apm/agent/android/current/intro.html">Android Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/go/current/introduction.html">Go Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/swift/current/intro.html">iOS Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/java/current/intro.html">Java Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/dotnet/current/intro.html">.NET Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/nodejs/current/intro.html">Node.js Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/php/current/intro.html">PHP Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/python/current/getting-started.html">Python Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/ruby/current/introduction.html">Ruby Agent Reference</a></li>
  <li><a href="/guide/en/apm/agent/rum-js/current/intro.html">Real User Monitoring JavaScript Agent Reference</a></li>
  </ul>
  <li class="dropdown-category">APM extensions</li>
  <ul>
  <li><a href="/guide/en/apm/lambda/current/aws-lambda-arch.html">AWS Lambda extension</a></li>
  <li><a href="/guide/en/apm/attacher/current/apm-attacher.html">Attacher</a></li>
  </ul>
  </ul>
  </div>
  </div>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="securing-apm-server.html">Secure APM Server</a></span>
<span class="chevron-right">›</span><span class="breadcrumb-link"><a href="secure-communication-agents.html">Secure communication with APM Agents</a></span>
</div>
<div>
<div><h1 class="title"><a id="id-1"></a>Secret token</h1><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/7.8/docs/secure-communication-agents.asciidoc">edit</a></div>
</div>
<!--EXTRA-->
</div>
<div id="content">
<div id="url-to-v3" class="version-warning">
    <strong>IMPORTANT</strong>: This documentation is no longer updated. Refer to <a href="https://www.elastic.co/support/eol">Elastic's version policy</a> and the <a href="https://www.elastic.co/docs">latest documentation</a>.
</div>
<div class="section">
<div class="titlepage"><div><div>
<div class="position-relative"><h2 class="title"><a id="secret-token"></a>Secret token</h2><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/7.8/docs/secure-communication-agents.asciidoc">edit</a></div>
</div></div></div>
<p>You can configure a secret token to authorize requests to the APM Server.
This ensures that only your agents are able to send data to your APM servers.
Both the agents and the APM servers have to be configured with the same secret token,
and secret tokens only provide security when used in combination with SSL/TLS.</p>
<p>To secure the communication between APM Agents and the APM Server with a secret token:</p>
<div class="olist orderedlist">
<ol class="orderedlist">
<li class="listitem">
<a class="xref" href="secret-token.html#ssl-setup-token" title="SSL/TLS communication in APM Server">Enable SSL/TLS in APM Server</a>
</li>
<li class="listitem">
<a class="xref" href="secret-token.html#set-secret-token" title="Set a secret token">Set a secret token in your Agents and Server</a>
</li>
<li class="listitem">
<a class="xref" href="secret-token.html#https-in-agents" title="HTTPS communication in APM Agents">Enable HTTPS in your APM Agents</a>
</li>
</ol>
</div>
<div class="note admon">
<div class="icon"></div>
<div class="admon_content">
<p>Secret tokens are not applicable for the RUM Agent,
as there is no way to prevent them from being publicly exposed.</p>
</div>
</div>
<div class="position-relative"><h3><a id="ssl-setup-token"></a>SSL/TLS communication in APM Server</h3><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/7.8/docs/secure-communication-agents.asciidoc">edit</a></div>
<p>To enable SSL/TLS, you need to enable SSL and provide both a private key and a certificate
issued by a certificate authority (CA).
You can then specify the path to those files in your configuration properties.
This will make APM Server serve HTTPS requests instead of HTTP.</p>
<p>Here&#8217;s a basic APM Server SSL config with secure communication enabled:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">apm-server.ssl.enabled: true
apm-server.ssl.key: "/etc/pki/key.pem"
apm-server.ssl.certificate: "/etc/pki/apm-server.pem"</pre>
</div>
<p>A full list of configuration options is available in <a class="xref" href="agent-server-ssl.html" title="SSL input settings">SSL input settings</a>.</p>
<div class="position-relative"><h3><a id="set-secret-token"></a>Set a secret token</h3><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/7.8/docs/secure-communication-agents.asciidoc">edit</a></div>
<p><span class="strong strong"><strong>APM Server configuration</strong></span></p>
<p>Here&#8217;s how you set the secret token in APM Server:</p>
<div class="pre_wrapper lang-yaml">
<div class="console_code_copy" title="Copy to clipboard"></div>
<pre class="programlisting prettyprint lang-yaml">apm-server.secret_token: &lt;secret-token&gt;</pre>
</div>
<p>We recommend saving the token in the APM Server <a class="xref" href="keystore.html" title="Secrets keystore for secure settings">Secrets keystore</a>.</p>
<div class="important admon">
<div class="icon"></div>
<div class="admon_content">
<p>Secret tokens are not applicable for the RUM Agent,
as there is no way to prevent them from being publicly exposed.</p>
</div>
</div>
<p><span class="strong strong"><strong>Agent specific configuration</strong></span></p>
<p>Each Agent has a configuration for setting the value of the secret token:</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Go Agent</strong></span>: <a href="/guide/en/apm/agent/go/current/configuration.html#config-secret-token" class="ulink" target="_top"><code class="literal">ELASTIC_APM_SECRET_TOKEN</code></a>
</li>
<li class="listitem">
<span class="strong strong"><strong>Java Agent</strong></span>: <a href="/guide/en/apm/agent/java/current/config-reporter.html#config-secret-token" class="ulink" target="_top"><code class="literal">secret_token</code></a>
</li>
<li class="listitem">
<span class="strong strong"><strong>.NET Agent</strong></span>: <a href="/guide/en/apm/agent/dotnet/current/config-reporter.html#config-secret-token" class="ulink" target="_top"><code class="literal">ELASTIC_APM_SECRET_TOKEN</code></a>
</li>
<li class="listitem">
<span class="strong strong"><strong>Node.js Agent</strong></span>: <a href="/guide/en/apm/agent/nodejs/current/configuration.html#secret-token" class="ulink" target="_top"><code class="literal">Secret Token</code></a>
</li>
<li class="listitem">
<span class="strong strong"><strong>Python Agent</strong></span>: <a href="/guide/en/apm/agent/python/current/configuration.html#config-secret-token" class="ulink" target="_top"><code class="literal">secret_token</code></a>
</li>
<li class="listitem">
<span class="strong strong"><strong>Ruby Agent</strong></span>: <a href="/guide/en/apm/agent/ruby/current/configuration.html#config-secret-token" class="ulink" target="_top"><code class="literal">secret_token</code></a>
</li>
</ul>
</div>
<div class="position-relative"><h3><a id="https-in-agents"></a>HTTPS communication in APM Agents</h3><a class="edit_me" rel="nofollow" title="Edit this page on GitHub" href="https://github.com/elastic/apm-server/edit/7.8/docs/secure-communication-agents.asciidoc">edit</a></div>
<p>To enable secure communication in your Agents, you need to update the configured server URL to use <code class="literal">HTTPS</code> instead of <code class="literal">HTTP</code>.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Go Agent</strong></span>: <a href="/guide/en/apm/agent/go/current/configuration.html#config-server-url" class="ulink" target="_top"><code class="literal">ELASTIC_APM_SERVER_URL</code></a>
</li>
<li class="listitem">
<span class="strong strong"><strong>Java Agent</strong></span>: <a href="/guide/en/apm/agent/java/current/config-reporter.html#config-server-urls" class="ulink" target="_top"><code class="literal">server_urls</code></a>
</li>
<li class="listitem">
<span class="strong strong"><strong>.NET Agent</strong></span>: <a href="/guide/en/apm/agent/dotnet/current/config-reporter.html#config-server-url" class="ulink" target="_top"><code class="literal">ServerUrl</code></a>
</li>
<li class="listitem">
<span class="strong strong"><strong>Node.js Agent</strong></span>: <a href="/guide/en/apm/agent/nodejs/current/configuration.html#server-url" class="ulink" target="_top"><code class="literal">serverUrl</code></a>
</li>
<li class="listitem">
<span class="strong strong"><strong>Python Agent</strong></span>: <a href="/guide/en/apm/agent/python/current/" class="ulink" target="_top"><code class="literal">server_url</code></a>
</li>
<li class="listitem">
<span class="strong strong"><strong>Ruby Agent</strong></span>: <a href="/guide/en/apm/agent/ruby/current/configuration.html#config-server-url" class="ulink" target="_top"><code class="literal">server_url</code></a>
</li>
</ul>
</div>
<p>Some Agents also allow you to specify a custom certificate authority for connecting to APM Server.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Go Agent</strong></span>: <a href="/guide/en/apm/agent/go/current/configuration.html#config-server-cert" class="ulink" target="_top"><code class="literal">ELASTIC_APM_SERVER_CERT</code></a>
</li>
<li class="listitem">
<span class="strong strong"><strong>Python Agent</strong></span>: <a href="/guide/en/apm/agent/python/current/configuration.html#config-server-cert" class="ulink" target="_top"><code class="literal">ELASTIC_APM_SERVER_CERT</code></a>
</li>
<li class="listitem">
<span class="strong strong"><strong>Ruby Agent</strong></span>: <a href="/guide/en/apm/agent/ruby/current/configuration.html#config-ssl-ca-cert" class="ulink" target="_top"><code class="literal">server_ca_certedit</code></a>
</li>
</ul>
</div>
<p>Most Agents that don&#8217;t allow you specify a custom certificate will allow you to
disable verification of the SSL certificate.
This ensures encryption, but does not verify that you are sending data to the correct APM Server.</p>
<div class="ulist itemizedlist">
<ul class="itemizedlist">
<li class="listitem">
<span class="strong strong"><strong>Java Agent</strong></span>: <a href="/guide/en/apm/agent/java/current/config-reporter.html#config-verify-server-cert" class="ulink" target="_top"><code class="literal">verify_server_cert</code></a>
</li>
<li class="listitem">
<span class="strong strong"><strong>Node.js Agent</strong></span>: <a href="/guide/en/apm/agent/nodejs/current/configuration.html#validate-server-cert" class="ulink" target="_top"><code class="literal">verifyServerCert</code></a>
</li>
<li class="listitem">
<span class="strong strong"><strong>.NET Agent</strong></span>: <a href="/guide/en/apm/agent/dotnet/current/config-reporter.html#config-verify-server-cert" class="ulink" target="_top"><code class="literal">VerifyServerCert</code></a>
</li>
</ul>
</div>
</div>
</div>
</div><div class="navfooter">
<span class="prev">
<a href="api-key-settings.html">« <code class="literal">api_key.*</code> configuration options</a>
</span>
<span class="next">
<a href="securing-communication-elasticsearch.html">Secure communication with Elasticsearch »</a>
</span>
</div>
</body>
</html>
